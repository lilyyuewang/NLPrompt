***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '47']
output_dir: output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: DescribableTextures
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 47
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: DescribableTextures
Reading split from /home/convex/datasets/nlprompt/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/dtd/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 23
Data loader size: 2
Data loader size: 17
---------  -------------------
Dataset    DescribableTextures
# classes  47
# train_x  752
# val      188
# test     1,692
---------  -------------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 569
confident_label rate tensor(0.1104, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 83
clean true:78
clean false:5
clean_rate:0.9397590361445783
noisy true:105
noisy false:564
after delete: len(clean_dataset) 83
after delete: len(noisy_dataset) 669
epoch [1/200] batch [1/2] time 0.420 (0.420) data 0.234 (0.234) loss_x loss_x 2.5918 (2.5918) acc_x 50.0000 (50.0000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/2] time 0.346 (0.383) data 0.264 (0.249) loss_x loss_x 2.5449 (2.5684) acc_x 53.1250 (51.5625) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 547
confident_label rate tensor(0.1210, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 91
clean true:86
clean false:5
clean_rate:0.945054945054945
noisy true:119
noisy false:542
after delete: len(clean_dataset) 91
after delete: len(noisy_dataset) 661
epoch [2/200] batch [1/2] time 0.306 (0.306) data 0.230 (0.230) loss_x loss_x 2.3652 (2.3652) acc_x 62.5000 (62.5000) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [2/2] time 0.337 (0.321) data 0.257 (0.244) loss_x loss_x 2.6504 (2.5078) acc_x 31.2500 (46.8750) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 503
confident_label rate tensor(0.1449, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 109
clean true:105
clean false:4
clean_rate:0.963302752293578
noisy true:144
noisy false:499
after delete: len(clean_dataset) 109
after delete: len(noisy_dataset) 643
epoch [3/200] batch [1/3] time 0.363 (0.363) data 0.288 (0.288) loss_x loss_x 1.9658 (1.9658) acc_x 53.1250 (53.1250) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [2/3] time 0.344 (0.354) data 0.267 (0.278) loss_x loss_x 1.3867 (1.6763) acc_x 62.5000 (57.8125) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [3/3] time 0.294 (0.334) data 0.213 (0.256) loss_x loss_x 0.7651 (1.3726) acc_x 75.0000 (63.5417) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 458
confident_label rate tensor(0.1835, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 138
clean true:130
clean false:8
clean_rate:0.9420289855072463
noisy true:164
noisy false:450
after delete: len(clean_dataset) 138
after delete: len(noisy_dataset) 614
epoch [4/200] batch [1/4] time 0.286 (0.286) data 0.207 (0.207) loss_x loss_x 0.9927 (0.9927) acc_x 75.0000 (75.0000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [2/4] time 0.320 (0.303) data 0.243 (0.225) loss_x loss_x 1.0840 (1.0383) acc_x 65.6250 (70.3125) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [3/4] time 0.342 (0.316) data 0.262 (0.237) loss_x loss_x 1.2734 (1.1167) acc_x 62.5000 (67.7083) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [4/4] time 0.329 (0.320) data 0.253 (0.241) loss_x loss_x 0.7842 (1.0336) acc_x 78.1250 (70.3125) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 456
confident_label rate tensor(0.1995, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 150
clean true:144
clean false:6
clean_rate:0.96
noisy true:152
noisy false:450
after delete: len(clean_dataset) 150
after delete: len(noisy_dataset) 602
epoch [5/200] batch [1/4] time 0.357 (0.357) data 0.284 (0.284) loss_x loss_x 0.7783 (0.7783) acc_x 78.1250 (78.1250) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [2/4] time 0.368 (0.363) data 0.291 (0.287) loss_x loss_x 0.6953 (0.7368) acc_x 81.2500 (79.6875) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [3/4] time 0.355 (0.360) data 0.275 (0.283) loss_x loss_x 0.6094 (0.6943) acc_x 81.2500 (80.2083) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [4/4] time 0.337 (0.354) data 0.255 (0.276) loss_x loss_x 0.7358 (0.7047) acc_x 75.0000 (78.9062) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 457
confident_label rate tensor(0.1915, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 144
clean true:136
clean false:8
clean_rate:0.9444444444444444
noisy true:159
noisy false:449
after delete: len(clean_dataset) 144
after delete: len(noisy_dataset) 608
epoch [6/200] batch [1/4] time 0.233 (0.233) data 0.186 (0.186) loss_x loss_x 0.8291 (0.8291) acc_x 78.1250 (78.1250) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [2/4] time 0.363 (0.298) data 0.286 (0.236) loss_x loss_x 1.2949 (1.0620) acc_x 68.7500 (73.4375) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [3/4] time 0.347 (0.315) data 0.271 (0.248) loss_x loss_x 0.8911 (1.0050) acc_x 84.3750 (77.0833) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [4/4] time 0.369 (0.328) data 0.293 (0.259) loss_x loss_x 0.5366 (0.8879) acc_x 87.5000 (79.6875) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 435
confident_label rate tensor(0.1981, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 149
clean true:144
clean false:5
clean_rate:0.9664429530201343
noisy true:173
noisy false:430
after delete: len(clean_dataset) 149
after delete: len(noisy_dataset) 603
epoch [7/200] batch [1/4] time 0.379 (0.379) data 0.301 (0.301) loss_x loss_x 0.7944 (0.7944) acc_x 81.2500 (81.2500) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [2/4] time 0.332 (0.355) data 0.250 (0.276) loss_x loss_x 0.5972 (0.6958) acc_x 84.3750 (82.8125) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [3/4] time 0.301 (0.337) data 0.224 (0.259) loss_x loss_x 0.9189 (0.7702) acc_x 78.1250 (81.2500) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [4/4] time 0.349 (0.340) data 0.269 (0.261) loss_x loss_x 0.7041 (0.7537) acc_x 81.2500 (81.2500) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 436
confident_label rate tensor(0.2074, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 156
clean true:151
clean false:5
clean_rate:0.967948717948718
noisy true:165
noisy false:431
after delete: len(clean_dataset) 156
after delete: len(noisy_dataset) 596
epoch [8/200] batch [1/4] time 0.345 (0.345) data 0.267 (0.267) loss_x loss_x 0.3933 (0.3933) acc_x 93.7500 (93.7500) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [2/4] time 0.300 (0.322) data 0.253 (0.260) loss_x loss_x 0.8696 (0.6315) acc_x 75.0000 (84.3750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [3/4] time 0.362 (0.335) data 0.252 (0.257) loss_x loss_x 0.4421 (0.5684) acc_x 93.7500 (87.5000) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [4/4] time 0.357 (0.341) data 0.277 (0.262) loss_x loss_x 0.5791 (0.5710) acc_x 87.5000 (87.5000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 420
confident_label rate tensor(0.2340, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 176
clean true:169
clean false:7
clean_rate:0.9602272727272727
noisy true:163
noisy false:413
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 576
epoch [9/200] batch [5/5] time 0.352 (0.333) data 0.278 (0.263) loss_x loss_x 1.1104 (0.7528) acc_x 68.7500 (80.6250) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 437
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 164
clean true:159
clean false:5
clean_rate:0.9695121951219512
noisy true:156
noisy false:432
after delete: len(clean_dataset) 164
after delete: len(noisy_dataset) 588
epoch [10/200] batch [5/5] time 0.378 (0.342) data 0.303 (0.266) loss_x loss_x 1.3359 (0.7917) acc_x 78.1250 (85.0000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 431
confident_label rate tensor(0.2168, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 163
clean true:156
clean false:7
clean_rate:0.9570552147239264
noisy true:165
noisy false:424
after delete: len(clean_dataset) 163
after delete: len(noisy_dataset) 589
epoch [11/200] batch [5/5] time 0.323 (0.330) data 0.248 (0.253) loss_x loss_x 0.3569 (0.5565) acc_x 96.8750 (89.3750) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 408
confident_label rate tensor(0.2447, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 184
clean true:175
clean false:9
clean_rate:0.9510869565217391
noisy true:169
noisy false:399
after delete: len(clean_dataset) 184
after delete: len(noisy_dataset) 568
epoch [12/200] batch [5/5] time 0.289 (0.343) data 0.241 (0.272) loss_x loss_x 0.3286 (0.5226) acc_x 93.7500 (85.6250) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 408
confident_label rate tensor(0.2473, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 186
clean true:179
clean false:7
clean_rate:0.9623655913978495
noisy true:165
noisy false:401
after delete: len(clean_dataset) 186
after delete: len(noisy_dataset) 566
epoch [13/200] batch [5/5] time 0.332 (0.340) data 0.252 (0.263) loss_x loss_x 0.3494 (0.4919) acc_x 93.7500 (86.2500) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 403
confident_label rate tensor(0.2367, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 178
clean true:174
clean false:4
clean_rate:0.9775280898876404
noisy true:175
noisy false:399
after delete: len(clean_dataset) 178
after delete: len(noisy_dataset) 574
epoch [14/200] batch [5/5] time 0.318 (0.354) data 0.244 (0.278) loss_x loss_x 0.4126 (0.5287) acc_x 96.8750 (86.8750) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 394
confident_label rate tensor(0.2620, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 197
clean true:191
clean false:6
clean_rate:0.9695431472081218
noisy true:167
noisy false:388
after delete: len(clean_dataset) 197
after delete: len(noisy_dataset) 555
epoch [15/200] batch [5/6] time 0.338 (0.327) data 0.262 (0.250) loss_x loss_x 0.4648 (0.5441) acc_x 78.1250 (86.2500) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 385
confident_label rate tensor(0.2660, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 200
clean true:196
clean false:4
clean_rate:0.98
noisy true:171
noisy false:381
after delete: len(clean_dataset) 200
after delete: len(noisy_dataset) 552
epoch [16/200] batch [5/6] time 0.330 (0.332) data 0.253 (0.256) loss_x loss_x 0.8638 (0.5823) acc_x 75.0000 (81.8750) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2699, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 203
clean true:195
clean false:8
clean_rate:0.9605911330049262
noisy true:181
noisy false:368
after delete: len(clean_dataset) 203
after delete: len(noisy_dataset) 549
epoch [17/200] batch [5/6] time 0.337 (0.335) data 0.260 (0.258) loss_x loss_x 0.8511 (0.4860) acc_x 84.3750 (88.7500) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 380
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 208
clean true:202
clean false:6
clean_rate:0.9711538461538461
noisy true:170
noisy false:374
after delete: len(clean_dataset) 208
after delete: len(noisy_dataset) 544
epoch [18/200] batch [5/6] time 0.365 (0.350) data 0.287 (0.272) loss_x loss_x 0.5938 (0.4885) acc_x 87.5000 (86.8750) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 376
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:197
clean false:7
clean_rate:0.9656862745098039
noisy true:179
noisy false:369
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [19/200] batch [5/6] time 0.306 (0.328) data 0.230 (0.257) loss_x loss_x 0.5054 (0.4505) acc_x 90.6250 (89.3750) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 355
confident_label rate tensor(0.2832, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 213
clean true:206
clean false:7
clean_rate:0.9671361502347418
noisy true:191
noisy false:348
after delete: len(clean_dataset) 213
after delete: len(noisy_dataset) 539
epoch [20/200] batch [5/6] time 0.306 (0.332) data 0.232 (0.256) loss_x loss_x 0.5176 (0.4047) acc_x 87.5000 (89.3750) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 347
confident_label rate tensor(0.2886, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 217
clean true:212
clean false:5
clean_rate:0.9769585253456221
noisy true:193
noisy false:342
after delete: len(clean_dataset) 217
after delete: len(noisy_dataset) 535
epoch [21/200] batch [5/6] time 0.422 (0.348) data 0.347 (0.272) loss_x loss_x 0.6177 (0.4952) acc_x 81.2500 (86.8750) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 356
confident_label rate tensor(0.2832, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 213
clean true:207
clean false:6
clean_rate:0.971830985915493
noisy true:189
noisy false:350
after delete: len(clean_dataset) 213
after delete: len(noisy_dataset) 539
epoch [22/200] batch [5/6] time 0.304 (0.316) data 0.229 (0.240) loss_x loss_x 0.6860 (0.4909) acc_x 81.2500 (86.8750) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 353
confident_label rate tensor(0.2979, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 224
clean true:215
clean false:9
clean_rate:0.9598214285714286
noisy true:184
noisy false:344
after delete: len(clean_dataset) 224
after delete: len(noisy_dataset) 528
epoch [23/200] batch [5/7] time 0.290 (0.314) data 0.211 (0.238) loss_x loss_x 0.2084 (0.4862) acc_x 96.8750 (89.3750) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 351
confident_label rate tensor(0.3019, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 227
clean true:220
clean false:7
clean_rate:0.9691629955947136
noisy true:181
noisy false:344
after delete: len(clean_dataset) 227
after delete: len(noisy_dataset) 525
epoch [24/200] batch [5/7] time 0.321 (0.305) data 0.242 (0.226) loss_x loss_x 0.4497 (0.3893) acc_x 87.5000 (92.5000) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 340
confident_label rate tensor(0.3072, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 231
clean true:224
clean false:7
clean_rate:0.9696969696969697
noisy true:188
noisy false:333
after delete: len(clean_dataset) 231
after delete: len(noisy_dataset) 521
epoch [25/200] batch [5/7] time 0.353 (0.328) data 0.277 (0.252) loss_x loss_x 0.3611 (0.3973) acc_x 90.6250 (90.6250) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 340
confident_label rate tensor(0.3112, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 234
clean true:225
clean false:9
clean_rate:0.9615384615384616
noisy true:187
noisy false:331
after delete: len(clean_dataset) 234
after delete: len(noisy_dataset) 518
epoch [26/200] batch [5/7] time 0.369 (0.341) data 0.294 (0.259) loss_x loss_x 0.2603 (0.4691) acc_x 93.7500 (88.7500) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 325
confident_label rate tensor(0.3191, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 240
clean true:228
clean false:12
clean_rate:0.95
noisy true:199
noisy false:313
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 512
epoch [27/200] batch [5/7] time 0.350 (0.334) data 0.275 (0.258) loss_x loss_x 0.4307 (0.4020) acc_x 90.6250 (90.0000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 340
confident_label rate tensor(0.3138, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 236
clean true:229
clean false:7
clean_rate:0.9703389830508474
noisy true:183
noisy false:333
after delete: len(clean_dataset) 236
after delete: len(noisy_dataset) 516
epoch [28/200] batch [5/7] time 0.322 (0.331) data 0.245 (0.257) loss_x loss_x 0.3088 (0.3636) acc_x 90.6250 (91.8750) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 344
confident_label rate tensor(0.3152, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 237
clean true:226
clean false:11
clean_rate:0.9535864978902954
noisy true:182
noisy false:333
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 515
epoch [29/200] batch [5/7] time 0.346 (0.350) data 0.270 (0.274) loss_x loss_x 0.4895 (0.3350) acc_x 84.3750 (91.2500) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 329
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:239
clean false:11
clean_rate:0.956
noisy true:184
noisy false:318
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [30/200] batch [5/7] time 0.351 (0.333) data 0.274 (0.256) loss_x loss_x 0.3887 (0.4104) acc_x 87.5000 (88.7500) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 324
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:244
clean false:12
clean_rate:0.953125
noisy true:184
noisy false:312
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [31/200] batch [5/8] time 0.293 (0.340) data 0.226 (0.266) loss_x loss_x 0.2419 (0.4358) acc_x 93.7500 (90.6250) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 316
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:246
clean false:11
clean_rate:0.9571984435797666
noisy true:190
noisy false:305
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [32/200] batch [5/8] time 0.345 (0.316) data 0.270 (0.241) loss_x loss_x 0.4763 (0.4680) acc_x 84.3750 (89.3750) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:239
clean false:11
clean_rate:0.956
noisy true:187
noisy false:315
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [33/200] batch [5/7] time 0.310 (0.345) data 0.238 (0.269) loss_x loss_x 0.1561 (0.3237) acc_x 100.0000 (92.5000) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 307
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 248
clean true:239
clean false:9
clean_rate:0.9637096774193549
noisy true:206
noisy false:298
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 504
epoch [34/200] batch [5/7] time 0.340 (0.324) data 0.264 (0.247) loss_x loss_x 0.4995 (0.3818) acc_x 90.6250 (90.0000) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 307
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:246
clean false:12
clean_rate:0.9534883720930233
noisy true:199
noisy false:295
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [35/200] batch [5/8] time 0.316 (0.348) data 0.238 (0.271) loss_x loss_x 0.3687 (0.4179) acc_x 81.2500 (88.1250) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:250
clean false:9
clean_rate:0.9652509652509652
noisy true:208
noisy false:285
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [36/200] batch [5/8] time 0.351 (0.335) data 0.274 (0.258) loss_x loss_x 0.5234 (0.3941) acc_x 90.6250 (90.6250) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 311
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 260
clean true:249
clean false:11
clean_rate:0.9576923076923077
noisy true:192
noisy false:300
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 492
epoch [37/200] batch [5/8] time 0.291 (0.307) data 0.216 (0.232) loss_x loss_x 0.5254 (0.3829) acc_x 84.3750 (90.6250) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 318
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 252
clean true:244
clean false:8
clean_rate:0.9682539682539683
noisy true:190
noisy false:310
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 500
epoch [38/200] batch [5/7] time 0.282 (0.341) data 0.208 (0.271) loss_x loss_x 0.6226 (0.4290) acc_x 87.5000 (87.5000) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 307
confident_label rate tensor(0.3484, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 262
clean true:254
clean false:8
clean_rate:0.9694656488549618
noisy true:191
noisy false:299
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 490
epoch [39/200] batch [5/8] time 0.366 (0.349) data 0.285 (0.272) loss_x loss_x 0.2351 (0.3086) acc_x 96.8750 (92.5000) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 305
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:249
clean false:9
clean_rate:0.9651162790697675
noisy true:198
noisy false:296
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [40/200] batch [5/8] time 0.387 (0.352) data 0.309 (0.277) loss_x loss_x 0.3604 (0.2586) acc_x 90.6250 (94.3750) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 264
clean true:254
clean false:10
clean_rate:0.9621212121212122
noisy true:213
noisy false:275
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 488
epoch [41/200] batch [5/8] time 0.293 (0.338) data 0.220 (0.264) loss_x loss_x 0.3762 (0.3498) acc_x 90.6250 (91.2500) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 298
confident_label rate tensor(0.3524, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 265
clean true:254
clean false:11
clean_rate:0.9584905660377359
noisy true:200
noisy false:287
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 487
epoch [42/200] batch [5/8] time 0.351 (0.339) data 0.274 (0.262) loss_x loss_x 0.3372 (0.4064) acc_x 93.7500 (87.5000) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 305
confident_label rate tensor(0.3484, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 262
clean true:250
clean false:12
clean_rate:0.9541984732824428
noisy true:197
noisy false:293
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 490
epoch [43/200] batch [5/8] time 0.330 (0.310) data 0.253 (0.234) loss_x loss_x 0.3706 (0.3187) acc_x 90.6250 (91.8750) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3590, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 270
clean true:258
clean false:12
clean_rate:0.9555555555555556
noisy true:200
noisy false:282
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 482
epoch [44/200] batch [5/8] time 0.354 (0.342) data 0.281 (0.263) loss_x loss_x 0.2289 (0.3600) acc_x 93.7500 (90.0000) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3551, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 267
clean true:254
clean false:13
clean_rate:0.951310861423221
noisy true:204
noisy false:281
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 485
epoch [45/200] batch [5/8] time 0.333 (0.331) data 0.258 (0.254) loss_x loss_x 0.3215 (0.3146) acc_x 90.6250 (90.6250) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 275
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 274
clean true:265
clean false:9
clean_rate:0.9671532846715328
noisy true:212
noisy false:266
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 478
epoch [46/200] batch [5/8] time 0.298 (0.332) data 0.217 (0.253) loss_x loss_x 0.2123 (0.2858) acc_x 93.7500 (93.1250) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 275
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:264
clean false:9
clean_rate:0.967032967032967
noisy true:213
noisy false:266
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [47/200] batch [5/8] time 0.339 (0.335) data 0.259 (0.257) loss_x loss_x 0.1600 (0.2893) acc_x 96.8750 (91.8750) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 270
confident_label rate tensor(0.3737, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 281
clean true:272
clean false:9
clean_rate:0.9679715302491103
noisy true:210
noisy false:261
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 471
epoch [48/200] batch [5/8] time 0.325 (0.336) data 0.247 (0.265) loss_x loss_x 0.1971 (0.2542) acc_x 96.8750 (93.7500) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 295
confident_label rate tensor(0.3604, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 271
clean true:262
clean false:9
clean_rate:0.966789667896679
noisy true:195
noisy false:286
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 481
epoch [49/200] batch [5/8] time 0.389 (0.360) data 0.308 (0.283) loss_x loss_x 0.3362 (0.2658) acc_x 90.6250 (92.5000) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 281
confident_label rate tensor(0.3737, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 281
clean true:271
clean false:10
clean_rate:0.9644128113879004
noisy true:200
noisy false:271
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 471
epoch [50/200] batch [5/8] time 0.338 (0.361) data 0.259 (0.284) loss_x loss_x 0.3230 (0.2712) acc_x 93.7500 (92.5000) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 275
confident_label rate tensor(0.3737, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 281
clean true:273
clean false:8
clean_rate:0.9715302491103203
noisy true:204
noisy false:267
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 471
epoch [51/200] batch [5/8] time 0.374 (0.357) data 0.296 (0.280) loss_x loss_x 0.2078 (0.2286) acc_x 96.8750 (93.7500) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 267
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:277
clean false:8
clean_rate:0.9719298245614035
noisy true:208
noisy false:259
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [52/200] batch [5/8] time 0.329 (0.337) data 0.253 (0.261) loss_x loss_x 0.6929 (0.3860) acc_x 84.3750 (91.8750) lr 1.7071e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 257
confident_label rate tensor(0.3870, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 291
clean true:283
clean false:8
clean_rate:0.9725085910652921
noisy true:212
noisy false:249
after delete: len(clean_dataset) 291
after delete: len(noisy_dataset) 461
epoch [53/200] batch [5/9] time 0.355 (0.355) data 0.278 (0.277) loss_x loss_x 0.4529 (0.3185) acc_x 84.3750 (90.6250) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 253
confident_label rate tensor(0.3803, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 286
clean true:278
clean false:8
clean_rate:0.972027972027972
noisy true:221
noisy false:245
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 466
epoch [54/200] batch [5/8] time 0.310 (0.342) data 0.236 (0.271) loss_x loss_x 0.1838 (0.2200) acc_x 93.7500 (95.0000) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 275
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 282
clean true:275
clean false:7
clean_rate:0.975177304964539
noisy true:202
noisy false:268
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 470
epoch [55/200] batch [5/8] time 0.374 (0.346) data 0.297 (0.268) loss_x loss_x 0.2495 (0.2882) acc_x 93.7500 (94.3750) lr 1.6730e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 263
confident_label rate tensor(0.3963, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 298
clean true:287
clean false:11
clean_rate:0.9630872483221476
noisy true:202
noisy false:252
after delete: len(clean_dataset) 298
after delete: len(noisy_dataset) 454
epoch [56/200] batch [5/9] time 0.347 (0.334) data 0.271 (0.257) loss_x loss_x 0.5234 (0.3445) acc_x 84.3750 (90.6250) lr 1.6613e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 270
confident_label rate tensor(0.3883, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 292
clean true:279
clean false:13
clean_rate:0.9554794520547946
noisy true:203
noisy false:257
after delete: len(clean_dataset) 292
after delete: len(noisy_dataset) 460
epoch [57/200] batch [5/9] time 0.332 (0.331) data 0.254 (0.259) loss_x loss_x 0.1914 (0.2687) acc_x 93.7500 (91.8750) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 268
confident_label rate tensor(0.3737, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 281
clean true:270
clean false:11
clean_rate:0.9608540925266904
noisy true:214
noisy false:257
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 471
epoch [58/200] batch [5/8] time 0.277 (0.317) data 0.202 (0.247) loss_x loss_x 0.2465 (0.2600) acc_x 96.8750 (95.6250) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 266
confident_label rate tensor(0.3723, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 280
clean true:274
clean false:6
clean_rate:0.9785714285714285
noisy true:212
noisy false:260
after delete: len(clean_dataset) 280
after delete: len(noisy_dataset) 472
epoch [59/200] batch [5/8] time 0.347 (0.330) data 0.269 (0.254) loss_x loss_x 0.3096 (0.3588) acc_x 93.7500 (91.2500) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 268
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:275
clean false:10
clean_rate:0.9649122807017544
noisy true:209
noisy false:258
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [60/200] batch [5/8] time 0.365 (0.329) data 0.287 (0.245) loss_x loss_x 0.2532 (0.2250) acc_x 96.8750 (96.2500) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 274
confident_label rate tensor(0.3777, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 284
clean true:276
clean false:8
clean_rate:0.971830985915493
noisy true:202
noisy false:266
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 468
epoch [61/200] batch [5/8] time 0.328 (0.339) data 0.251 (0.256) loss_x loss_x 0.4905 (0.2598) acc_x 87.5000 (95.0000) lr 1.6004e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 268
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 288
clean true:276
clean false:12
clean_rate:0.9583333333333334
noisy true:208
noisy false:256
after delete: len(clean_dataset) 288
after delete: len(noisy_dataset) 464
epoch [62/200] batch [5/9] time 0.308 (0.346) data 0.234 (0.269) loss_x loss_x 0.2334 (0.2327) acc_x 96.8750 (94.3750) lr 1.5878e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 267
confident_label rate tensor(0.3896, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 293
clean true:281
clean false:12
clean_rate:0.9590443686006825
noisy true:204
noisy false:255
after delete: len(clean_dataset) 293
after delete: len(noisy_dataset) 459
epoch [63/200] batch [5/9] time 0.316 (0.339) data 0.239 (0.261) loss_x loss_x 0.3147 (0.2785) acc_x 93.7500 (95.6250) lr 1.5750e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 244
confident_label rate tensor(0.3989, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 300
clean true:290
clean false:10
clean_rate:0.9666666666666667
noisy true:218
noisy false:234
after delete: len(clean_dataset) 300
after delete: len(noisy_dataset) 452
epoch [64/200] batch [5/9] time 0.344 (0.347) data 0.269 (0.270) loss_x loss_x 0.2749 (0.2685) acc_x 90.6250 (94.3750) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 263
confident_label rate tensor(0.3949, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 297
clean true:286
clean false:11
clean_rate:0.9629629629629629
noisy true:203
noisy false:252
after delete: len(clean_dataset) 297
after delete: len(noisy_dataset) 455
epoch [65/200] batch [5/9] time 0.284 (0.328) data 0.236 (0.258) loss_x loss_x 0.2471 (0.2834) acc_x 93.7500 (92.5000) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 265
confident_label rate tensor(0.3963, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 298
clean true:286
clean false:12
clean_rate:0.959731543624161
noisy true:201
noisy false:253
after delete: len(clean_dataset) 298
after delete: len(noisy_dataset) 454
epoch [66/200] batch [5/9] time 0.326 (0.353) data 0.252 (0.276) loss_x loss_x 0.3035 (0.2683) acc_x 90.6250 (93.1250) lr 1.5358e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 255
confident_label rate tensor(0.3976, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 299
clean true:285
clean false:14
clean_rate:0.9531772575250836
noisy true:212
noisy false:241
after delete: len(clean_dataset) 299
after delete: len(noisy_dataset) 453
epoch [67/200] batch [5/9] time 0.310 (0.342) data 0.234 (0.264) loss_x loss_x 0.2367 (0.1905) acc_x 93.7500 (96.2500) lr 1.5225e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 260
confident_label rate tensor(0.3989, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 300
clean true:287
clean false:13
clean_rate:0.9566666666666667
noisy true:205
noisy false:247
after delete: len(clean_dataset) 300
after delete: len(noisy_dataset) 452
epoch [68/200] batch [5/9] time 0.334 (0.322) data 0.261 (0.251) loss_x loss_x 0.1708 (0.2217) acc_x 93.7500 (92.5000) lr 1.5090e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 249
confident_label rate tensor(0.3936, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 296
clean true:284
clean false:12
clean_rate:0.9594594594594594
noisy true:219
noisy false:237
after delete: len(clean_dataset) 296
after delete: len(noisy_dataset) 456
epoch [69/200] batch [5/9] time 0.365 (0.324) data 0.286 (0.247) loss_x loss_x 0.2615 (0.2302) acc_x 90.6250 (93.1250) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 251
confident_label rate tensor(0.3936, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 296
clean true:285
clean false:11
clean_rate:0.9628378378378378
noisy true:216
noisy false:240
after delete: len(clean_dataset) 296
after delete: len(noisy_dataset) 456
epoch [70/200] batch [5/9] time 0.267 (0.325) data 0.189 (0.249) loss_x loss_x 0.1923 (0.3015) acc_x 93.7500 (91.2500) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 264
confident_label rate tensor(0.3989, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 300
clean true:287
clean false:13
clean_rate:0.9566666666666667
noisy true:201
noisy false:251
after delete: len(clean_dataset) 300
after delete: len(noisy_dataset) 452
epoch [71/200] batch [5/9] time 0.319 (0.330) data 0.237 (0.253) loss_x loss_x 0.2534 (0.2819) acc_x 93.7500 (93.1250) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 259
confident_label rate tensor(0.3963, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 298
clean true:286
clean false:12
clean_rate:0.959731543624161
noisy true:207
noisy false:247
after delete: len(clean_dataset) 298
after delete: len(noisy_dataset) 454
epoch [72/200] batch [5/9] time 0.302 (0.304) data 0.224 (0.230) loss_x loss_x 0.1552 (0.1520) acc_x 100.0000 (98.1250) lr 1.4540e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 239
confident_label rate tensor(0.4016, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 302
clean true:290
clean false:12
clean_rate:0.9602649006622517
noisy true:223
noisy false:227
after delete: len(clean_dataset) 302
after delete: len(noisy_dataset) 450
epoch [73/200] batch [5/9] time 0.388 (0.361) data 0.312 (0.285) loss_x loss_x 0.4060 (0.2713) acc_x 84.3750 (92.5000) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 258
confident_label rate tensor(0.4082, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 307
clean true:296
clean false:11
clean_rate:0.9641693811074918
noisy true:198
noisy false:247
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 445
epoch [74/200] batch [5/9] time 0.370 (0.347) data 0.293 (0.271) loss_x loss_x 0.2615 (0.1941) acc_x 93.7500 (95.0000) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 260
confident_label rate tensor(0.4003, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 301
clean true:289
clean false:12
clean_rate:0.9601328903654485
noisy true:203
noisy false:248
after delete: len(clean_dataset) 301
after delete: len(noisy_dataset) 451
epoch [75/200] batch [5/9] time 0.262 (0.319) data 0.188 (0.244) loss_x loss_x 0.3333 (0.2031) acc_x 90.6250 (95.6250) lr 1.4115e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 255
confident_label rate tensor(0.3976, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 299
clean true:284
clean false:15
clean_rate:0.9498327759197325
noisy true:213
noisy false:240
after delete: len(clean_dataset) 299
after delete: len(noisy_dataset) 453
epoch [76/200] batch [5/9] time 0.335 (0.320) data 0.263 (0.245) loss_x loss_x 0.2471 (0.2840) acc_x 90.6250 (91.8750) lr 1.3971e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 251
confident_label rate tensor(0.4082, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 307
clean true:291
clean false:16
clean_rate:0.9478827361563518
noisy true:210
noisy false:235
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 445
epoch [77/200] batch [5/9] time 0.328 (0.335) data 0.249 (0.261) loss_x loss_x 0.1759 (0.2466) acc_x 96.8750 (95.6250) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 254
confident_label rate tensor(0.4109, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 309
clean true:296
clean false:13
clean_rate:0.9579288025889967
noisy true:202
noisy false:241
after delete: len(clean_dataset) 309
after delete: len(noisy_dataset) 443
epoch [78/200] batch [5/9] time 0.390 (0.357) data 0.280 (0.279) loss_x loss_x 0.1943 (0.2594) acc_x 96.8750 (96.8750) lr 1.3681e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 257
confident_label rate tensor(0.4003, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 301
clean true:288
clean false:13
clean_rate:0.9568106312292359
noisy true:207
noisy false:244
after delete: len(clean_dataset) 301
after delete: len(noisy_dataset) 451
epoch [79/200] batch [5/9] time 0.343 (0.355) data 0.270 (0.279) loss_x loss_x 0.4192 (0.3546) acc_x 84.3750 (90.6250) lr 1.3535e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 260
confident_label rate tensor(0.4043, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 304
clean true:290
clean false:14
clean_rate:0.9539473684210527
noisy true:202
noisy false:246
after delete: len(clean_dataset) 304
after delete: len(noisy_dataset) 448
epoch [80/200] batch [5/9] time 0.313 (0.338) data 0.232 (0.261) loss_x loss_x 0.1387 (0.2253) acc_x 96.8750 (95.0000) lr 1.3387e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 243
confident_label rate tensor(0.4016, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 302
clean true:291
clean false:11
clean_rate:0.9635761589403974
noisy true:218
noisy false:232
after delete: len(clean_dataset) 302
after delete: len(noisy_dataset) 450
epoch [81/200] batch [5/9] time 0.326 (0.315) data 0.252 (0.240) loss_x loss_x 0.1705 (0.1745) acc_x 96.8750 (94.3750) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 255
confident_label rate tensor(0.3989, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 300
clean true:288
clean false:12
clean_rate:0.96
noisy true:209
noisy false:243
after delete: len(clean_dataset) 300
after delete: len(noisy_dataset) 452
epoch [82/200] batch [5/9] time 0.340 (0.332) data 0.267 (0.262) loss_x loss_x 0.3530 (0.2442) acc_x 90.6250 (94.3750) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 246
confident_label rate tensor(0.4136, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 311
clean true:298
clean false:13
clean_rate:0.9581993569131833
noisy true:208
noisy false:233
after delete: len(clean_dataset) 311
after delete: len(noisy_dataset) 441
epoch [83/200] batch [5/9] time 0.347 (0.339) data 0.269 (0.269) loss_x loss_x 0.2466 (0.2223) acc_x 96.8750 (95.0000) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 244
confident_label rate tensor(0.4096, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 308
clean true:296
clean false:12
clean_rate:0.961038961038961
noisy true:212
noisy false:232
after delete: len(clean_dataset) 308
after delete: len(noisy_dataset) 444
epoch [84/200] batch [5/9] time 0.344 (0.342) data 0.267 (0.265) loss_x loss_x 0.3315 (0.2367) acc_x 93.7500 (96.2500) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 257
confident_label rate tensor(0.4069, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 306
clean true:294
clean false:12
clean_rate:0.9607843137254902
noisy true:201
noisy false:245
after delete: len(clean_dataset) 306
after delete: len(noisy_dataset) 446
epoch [85/200] batch [5/9] time 0.348 (0.332) data 0.270 (0.263) loss_x loss_x 0.3008 (0.1978) acc_x 93.7500 (95.6250) lr 1.2639e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 241
confident_label rate tensor(0.4082, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 307
clean true:295
clean false:12
clean_rate:0.9609120521172638
noisy true:216
noisy false:229
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 445
epoch [86/200] batch [5/9] time 0.345 (0.330) data 0.270 (0.255) loss_x loss_x 0.1469 (0.2021) acc_x 100.0000 (95.6250) lr 1.2487e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 258
confident_label rate tensor(0.4069, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 306
clean true:293
clean false:13
clean_rate:0.9575163398692811
noisy true:201
noisy false:245
after delete: len(clean_dataset) 306
after delete: len(noisy_dataset) 446
epoch [87/200] batch [5/9] time 0.349 (0.342) data 0.273 (0.266) loss_x loss_x 0.1512 (0.1555) acc_x 100.0000 (98.1250) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 243
confident_label rate tensor(0.4096, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 308
clean true:296
clean false:12
clean_rate:0.961038961038961
noisy true:213
noisy false:231
after delete: len(clean_dataset) 308
after delete: len(noisy_dataset) 444
epoch [88/200] batch [5/9] time 0.310 (0.345) data 0.233 (0.262) loss_x loss_x 0.1310 (0.2299) acc_x 96.8750 (95.0000) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 238
confident_label rate tensor(0.4082, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 307
clean true:295
clean false:12
clean_rate:0.9609120521172638
noisy true:219
noisy false:226
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 445
epoch [89/200] batch [5/9] time 0.355 (0.349) data 0.282 (0.280) loss_x loss_x 0.1820 (0.2209) acc_x 96.8750 (94.3750) lr 1.2028e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 254
confident_label rate tensor(0.3936, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 296
clean true:287
clean false:9
clean_rate:0.9695945945945946
noisy true:211
noisy false:245
after delete: len(clean_dataset) 296
after delete: len(noisy_dataset) 456
epoch [90/200] batch [5/9] time 0.266 (0.300) data 0.189 (0.224) loss_x loss_x 0.1611 (0.1583) acc_x 96.8750 (96.8750) lr 1.1874e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 240
confident_label rate tensor(0.4149, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 312
clean true:298
clean false:14
clean_rate:0.9551282051282052
noisy true:214
noisy false:226
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 440
epoch [91/200] batch [5/9] time 0.372 (0.328) data 0.295 (0.252) loss_x loss_x 0.2324 (0.2068) acc_x 93.7500 (95.0000) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 244
confident_label rate tensor(0.4043, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 304
clean true:293
clean false:11
clean_rate:0.9638157894736842
noisy true:215
noisy false:233
after delete: len(clean_dataset) 304
after delete: len(noisy_dataset) 448
epoch [92/200] batch [5/9] time 0.338 (0.296) data 0.265 (0.220) loss_x loss_x 0.1405 (0.1878) acc_x 96.8750 (95.6250) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 236
confident_label rate tensor(0.4202, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 316
clean true:302
clean false:14
clean_rate:0.9556962025316456
noisy true:214
noisy false:222
after delete: len(clean_dataset) 316
after delete: len(noisy_dataset) 436
epoch [93/200] batch [5/9] time 0.345 (0.319) data 0.268 (0.241) loss_x loss_x 0.3416 (0.1793) acc_x 90.6250 (94.3750) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 252
confident_label rate tensor(0.3989, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 300
clean true:291
clean false:9
clean_rate:0.97
noisy true:209
noisy false:243
after delete: len(clean_dataset) 300
after delete: len(noisy_dataset) 452
epoch [94/200] batch [5/9] time 0.356 (0.345) data 0.277 (0.267) loss_x loss_x 0.3259 (0.2406) acc_x 90.6250 (94.3750) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 249
confident_label rate tensor(0.4149, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 312
clean true:297
clean false:15
clean_rate:0.9519230769230769
noisy true:206
noisy false:234
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 440
epoch [95/200] batch [5/9] time 0.330 (0.359) data 0.255 (0.283) loss_x loss_x 0.1797 (0.2040) acc_x 93.7500 (95.0000) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 246
confident_label rate tensor(0.4136, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 311
clean true:296
clean false:15
clean_rate:0.9517684887459807
noisy true:210
noisy false:231
after delete: len(clean_dataset) 311
after delete: len(noisy_dataset) 441
epoch [96/200] batch [5/9] time 0.383 (0.348) data 0.305 (0.270) loss_x loss_x 0.1718 (0.2118) acc_x 96.8750 (96.2500) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 239
confident_label rate tensor(0.4149, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 312
clean true:298
clean false:14
clean_rate:0.9551282051282052
noisy true:215
noisy false:225
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 440
epoch [97/200] batch [5/9] time 0.356 (0.343) data 0.278 (0.267) loss_x loss_x 0.1070 (0.1819) acc_x 100.0000 (96.2500) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 237
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 313
clean true:297
clean false:16
clean_rate:0.9488817891373802
noisy true:218
noisy false:221
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 439
epoch [98/200] batch [5/9] time 0.349 (0.358) data 0.273 (0.282) loss_x loss_x 0.1875 (0.1981) acc_x 93.7500 (94.3750) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 252
confident_label rate tensor(0.4176, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 314
clean true:299
clean false:15
clean_rate:0.9522292993630573
noisy true:201
noisy false:237
after delete: len(clean_dataset) 314
after delete: len(noisy_dataset) 438
epoch [99/200] batch [5/9] time 0.354 (0.359) data 0.282 (0.285) loss_x loss_x 0.3813 (0.2230) acc_x 90.6250 (93.1250) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 242
confident_label rate tensor(0.4043, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 304
clean true:290
clean false:14
clean_rate:0.9539473684210527
noisy true:220
noisy false:228
all clean rate:  [0.9397590361445783, 0.945054945054945, 0.963302752293578, 0.9420289855072463, 0.96, 0.9444444444444444, 0.9664429530201343, 0.967948717948718, 0.9602272727272727, 0.9695121951219512, 0.9570552147239264, 0.9510869565217391, 0.9623655913978495, 0.9775280898876404, 0.9695431472081218, 0.98, 0.9605911330049262, 0.9711538461538461, 0.9656862745098039, 0.9671361502347418, 0.9769585253456221, 0.971830985915493, 0.9598214285714286, 0.9691629955947136, 0.9696969696969697, 0.9615384615384616, 0.95, 0.9703389830508474, 0.9535864978902954, 0.956, 0.953125, 0.9571984435797666, 0.956, 0.9637096774193549, 0.9534883720930233, 0.9652509652509652, 0.9576923076923077, 0.9682539682539683, 0.9694656488549618, 0.9651162790697675, 0.9621212121212122, 0.9584905660377359, 0.9541984732824428, 0.9555555555555556, 0.951310861423221, 0.9671532846715328, 0.967032967032967, 0.9679715302491103, 0.966789667896679, 0.9644128113879004, 0.9715302491103203, 0.9719298245614035, 0.9725085910652921, 0.972027972027972, 0.975177304964539, 0.9630872483221476, 0.9554794520547946, 0.9608540925266904, 0.9785714285714285, 0.9649122807017544, 0.971830985915493, 0.9583333333333334, 0.9590443686006825, 0.9666666666666667, 0.9629629629629629, 0.959731543624161, 0.9531772575250836, 0.9566666666666667, 0.9594594594594594, 0.9628378378378378, 0.9566666666666667, 0.959731543624161, 0.9602649006622517, 0.9641693811074918, 0.9601328903654485, 0.9498327759197325, 0.9478827361563518, 0.9579288025889967, 0.9568106312292359, 0.9539473684210527, 0.9635761589403974, 0.96, 0.9581993569131833, 0.961038961038961, 0.9607843137254902, 0.9609120521172638, 0.9575163398692811, 0.961038961038961, 0.9609120521172638, 0.9695945945945946, 0.9551282051282052, 0.9638157894736842, 0.9556962025316456, 0.97, 0.9519230769230769, 0.9517684887459807, 0.9551282051282052, 0.9488817891373802, 0.9522292993630573, 0.9539473684210527]
after delete: len(clean_dataset) 304
after delete: len(noisy_dataset) 448
epoch [100/200] batch [5/9] time 0.281 (0.334) data 0.205 (0.258) loss_x loss_x 0.1198 (0.1711) acc_x 100.0000 (96.2500) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 241
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 315
clean true:300
clean false:15
clean_rate:0.9523809523809523
noisy true:211
noisy false:226
after delete: len(clean_dataset) 315
after delete: len(noisy_dataset) 437
epoch [101/200] batch [5/9] time 0.348 (0.343) data 0.267 (0.260) loss_x loss_x 0.3230 (0.1849) acc_x 90.6250 (96.2500) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 236
confident_label rate tensor(0.4215, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 317
clean true:301
clean false:16
clean_rate:0.9495268138801262
noisy true:215
noisy false:220
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 435
epoch [102/200] batch [5/9] time 0.341 (0.330) data 0.267 (0.255) loss_x loss_x 0.1577 (0.2297) acc_x 93.7500 (94.3750) lr 1.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 244
confident_label rate tensor(0.4136, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 311
clean true:300
clean false:11
clean_rate:0.9646302250803859
noisy true:208
noisy false:233
after delete: len(clean_dataset) 311
after delete: len(noisy_dataset) 441
epoch [103/200] batch [5/9] time 0.365 (0.350) data 0.283 (0.267) loss_x loss_x 0.1049 (0.1198) acc_x 96.8750 (97.5000) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 236
confident_label rate tensor(0.4215, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 317
clean true:302
clean false:15
clean_rate:0.9526813880126183
noisy true:214
noisy false:221
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 435
epoch [104/200] batch [5/9] time 0.367 (0.334) data 0.289 (0.262) loss_x loss_x 0.1716 (0.1719) acc_x 93.7500 (95.0000) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 239
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 315
clean true:299
clean false:16
clean_rate:0.9492063492063492
noisy true:214
noisy false:223
after delete: len(clean_dataset) 315
after delete: len(noisy_dataset) 437
epoch [105/200] batch [5/9] time 0.374 (0.330) data 0.297 (0.253) loss_x loss_x 0.0754 (0.1114) acc_x 100.0000 (98.1250) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 229
confident_label rate tensor(0.4122, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 310
clean true:297
clean false:13
clean_rate:0.9580645161290322
noisy true:226
noisy false:216
after delete: len(clean_dataset) 310
after delete: len(noisy_dataset) 442
epoch [106/200] batch [5/9] time 0.348 (0.334) data 0.270 (0.256) loss_x loss_x 0.1703 (0.1929) acc_x 100.0000 (96.8750) lr 9.3721e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 240
confident_label rate tensor(0.4096, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 308
clean true:293
clean false:15
clean_rate:0.9512987012987013
noisy true:219
noisy false:225
after delete: len(clean_dataset) 308
after delete: len(noisy_dataset) 444
epoch [107/200] batch [5/9] time 0.329 (0.306) data 0.253 (0.234) loss_x loss_x 0.1654 (0.1965) acc_x 96.8750 (95.6250) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4242, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 319
clean true:305
clean false:14
clean_rate:0.9561128526645768
noisy true:213
noisy false:220
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 433
epoch [108/200] batch [5/9] time 0.285 (0.304) data 0.209 (0.228) loss_x loss_x 0.4583 (0.2147) acc_x 84.3750 (95.0000) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 237
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 313
clean true:299
clean false:14
clean_rate:0.9552715654952076
noisy true:216
noisy false:223
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 439
epoch [109/200] batch [5/9] time 0.318 (0.322) data 0.239 (0.244) loss_x loss_x 0.1907 (0.1693) acc_x 93.7500 (96.2500) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 238
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 315
clean true:302
clean false:13
clean_rate:0.9587301587301588
noisy true:212
noisy false:225
after delete: len(clean_dataset) 315
after delete: len(noisy_dataset) 437
epoch [110/200] batch [5/9] time 0.303 (0.337) data 0.224 (0.260) loss_x loss_x 0.1188 (0.1858) acc_x 100.0000 (98.1250) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 244
confident_label rate tensor(0.4202, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 316
clean true:300
clean false:16
clean_rate:0.9493670886075949
noisy true:208
noisy false:228
after delete: len(clean_dataset) 316
after delete: len(noisy_dataset) 436
epoch [111/200] batch [5/9] time 0.333 (0.331) data 0.255 (0.260) loss_x loss_x 0.0734 (0.1211) acc_x 100.0000 (98.7500) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 235
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 322
clean true:305
clean false:17
clean_rate:0.9472049689440993
noisy true:212
noisy false:218
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 430
epoch [112/200] batch [5/10] time 0.304 (0.327) data 0.229 (0.251) loss_x loss_x 0.2524 (0.1842) acc_x 93.7500 (95.6250) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/10] time 0.338 (0.338) data 0.262 (0.264) loss_x loss_x 0.1539 (0.1927) acc_x 96.8750 (95.9375) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 232
confident_label rate tensor(0.4215, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 317
clean true:303
clean false:14
clean_rate:0.9558359621451105
noisy true:217
noisy false:218
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 435
epoch [113/200] batch [5/9] time 0.364 (0.353) data 0.286 (0.277) loss_x loss_x 0.0648 (0.1186) acc_x 100.0000 (98.1250) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 231
confident_label rate tensor(0.4242, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 319
clean true:302
clean false:17
clean_rate:0.9467084639498433
noisy true:219
noisy false:214
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 433
epoch [114/200] batch [5/9] time 0.341 (0.342) data 0.266 (0.266) loss_x loss_x 0.0750 (0.1397) acc_x 96.8750 (96.8750) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 241
confident_label rate tensor(0.4215, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 317
clean true:299
clean false:18
clean_rate:0.943217665615142
noisy true:212
noisy false:223
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 435
epoch [115/200] batch [5/9] time 0.312 (0.330) data 0.238 (0.255) loss_x loss_x 0.2959 (0.1454) acc_x 90.6250 (96.2500) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 322
clean true:304
clean false:18
clean_rate:0.9440993788819876
noisy true:214
noisy false:216
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 430
epoch [116/200] batch [5/10] time 0.319 (0.341) data 0.240 (0.265) loss_x loss_x 0.1115 (0.3426) acc_x 100.0000 (96.2500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/10] time 0.339 (0.330) data 0.262 (0.253) loss_x loss_x 0.1433 (0.2319) acc_x 96.8750 (96.8750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 231
confident_label rate tensor(0.4269, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 321
clean true:305
clean false:16
clean_rate:0.9501557632398754
noisy true:216
noisy false:215
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 431
epoch [117/200] batch [5/10] time 0.344 (0.330) data 0.266 (0.253) loss_x loss_x 0.2083 (0.1270) acc_x 90.6250 (96.8750) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/10] time 0.338 (0.346) data 0.266 (0.269) loss_x loss_x 0.1008 (0.1813) acc_x 100.0000 (96.5625) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 240
confident_label rate tensor(0.4229, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 318
clean true:300
clean false:18
clean_rate:0.9433962264150944
noisy true:212
noisy false:222
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 434
epoch [118/200] batch [5/9] time 0.339 (0.361) data 0.260 (0.285) loss_x loss_x 0.1203 (0.1519) acc_x 100.0000 (95.6250) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 237
confident_label rate tensor(0.4242, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 319
clean true:301
clean false:18
clean_rate:0.9435736677115988
noisy true:214
noisy false:219
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 433
epoch [119/200] batch [5/9] time 0.350 (0.335) data 0.276 (0.259) loss_x loss_x 0.1132 (0.1488) acc_x 100.0000 (97.5000) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 232
confident_label rate tensor(0.4309, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 324
clean true:307
clean false:17
clean_rate:0.9475308641975309
noisy true:213
noisy false:215
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 428
epoch [120/200] batch [5/10] time 0.348 (0.329) data 0.271 (0.252) loss_x loss_x 0.1532 (0.1315) acc_x 96.8750 (98.1250) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/10] time 0.304 (0.330) data 0.228 (0.254) loss_x loss_x 0.1221 (0.1492) acc_x 93.7500 (97.1875) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 242
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 315
clean true:299
clean false:16
clean_rate:0.9492063492063492
noisy true:211
noisy false:226
after delete: len(clean_dataset) 315
after delete: len(noisy_dataset) 437
epoch [121/200] batch [5/9] time 0.351 (0.335) data 0.241 (0.258) loss_x loss_x 0.0579 (0.1197) acc_x 100.0000 (98.7500) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 232
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 322
clean true:305
clean false:17
clean_rate:0.9472049689440993
noisy true:215
noisy false:215
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 430
epoch [122/200] batch [5/10] time 0.338 (0.341) data 0.261 (0.265) loss_x loss_x 0.3687 (0.1820) acc_x 93.7500 (95.6250) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/10] time 0.305 (0.339) data 0.215 (0.264) loss_x loss_x 0.0948 (0.1767) acc_x 100.0000 (96.2500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 237
confident_label rate tensor(0.4215, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 317
clean true:302
clean false:15
clean_rate:0.9526813880126183
noisy true:213
noisy false:222
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 435
epoch [123/200] batch [5/9] time 0.347 (0.321) data 0.268 (0.245) loss_x loss_x 0.0842 (0.1462) acc_x 96.8750 (97.5000) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 236
confident_label rate tensor(0.4215, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 317
clean true:302
clean false:15
clean_rate:0.9526813880126183
noisy true:214
noisy false:221
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 435
epoch [124/200] batch [5/9] time 0.323 (0.359) data 0.276 (0.288) loss_x loss_x 0.2588 (0.1348) acc_x 90.6250 (96.8750) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 226
confident_label rate tensor(0.4242, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 319
clean true:306
clean false:13
clean_rate:0.9592476489028213
noisy true:220
noisy false:213
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 433
epoch [125/200] batch [5/9] time 0.275 (0.329) data 0.199 (0.253) loss_x loss_x 0.2061 (0.2966) acc_x 96.8750 (95.0000) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4255, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 320
clean true:304
clean false:16
clean_rate:0.95
noisy true:214
noisy false:218
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 432
epoch [126/200] batch [5/10] time 0.348 (0.348) data 0.274 (0.278) loss_x loss_x 0.1924 (0.1337) acc_x 96.8750 (98.7500) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/10] time 0.357 (0.342) data 0.280 (0.268) loss_x loss_x 0.3828 (0.1779) acc_x 90.6250 (97.1875) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 231
confident_label rate tensor(0.4309, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 324
clean true:307
clean false:17
clean_rate:0.9475308641975309
noisy true:214
noisy false:214
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 428
epoch [127/200] batch [5/10] time 0.333 (0.327) data 0.258 (0.252) loss_x loss_x 0.1251 (0.1912) acc_x 96.8750 (98.1250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/10] time 0.398 (0.350) data 0.325 (0.275) loss_x loss_x 0.2216 (0.1811) acc_x 96.8750 (96.8750) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 221
confident_label rate tensor(0.4309, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 324
clean true:307
clean false:17
clean_rate:0.9475308641975309
noisy true:224
noisy false:204
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 428
epoch [128/200] batch [5/10] time 0.312 (0.327) data 0.237 (0.250) loss_x loss_x 0.1523 (0.1474) acc_x 96.8750 (96.8750) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/10] time 0.385 (0.330) data 0.307 (0.253) loss_x loss_x 0.2781 (0.1669) acc_x 93.7500 (96.8750) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 224
confident_label rate tensor(0.4242, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 319
clean true:303
clean false:16
clean_rate:0.9498432601880877
noisy true:225
noisy false:208
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 433
epoch [129/200] batch [5/9] time 0.322 (0.340) data 0.248 (0.269) loss_x loss_x 0.1265 (0.1861) acc_x 96.8750 (98.1250) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 229
confident_label rate tensor(0.4162, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 313
clean true:301
clean false:12
clean_rate:0.9616613418530351
noisy true:222
noisy false:217
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 439
epoch [130/200] batch [5/9] time 0.345 (0.347) data 0.268 (0.272) loss_x loss_x 0.3059 (0.2117) acc_x 93.7500 (95.6250) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 238
confident_label rate tensor(0.4309, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 324
clean true:309
clean false:15
clean_rate:0.9537037037037037
noisy true:205
noisy false:223
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 428
epoch [131/200] batch [5/10] time 0.330 (0.335) data 0.254 (0.265) loss_x loss_x 0.1074 (0.1727) acc_x 100.0000 (96.8750) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/10] time 0.350 (0.326) data 0.277 (0.254) loss_x loss_x 0.3953 (0.1827) acc_x 90.6250 (96.2500) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 240
confident_label rate tensor(0.4255, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 320
clean true:302
clean false:18
clean_rate:0.94375
noisy true:210
noisy false:222
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 432
epoch [132/200] batch [5/10] time 0.324 (0.332) data 0.250 (0.257) loss_x loss_x 0.2369 (0.1532) acc_x 93.7500 (97.5000) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [10/10] time 0.392 (0.339) data 0.315 (0.263) loss_x loss_x 0.1265 (0.1449) acc_x 100.0000 (97.1875) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 231
confident_label rate tensor(0.4335, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 326
clean true:313
clean false:13
clean_rate:0.9601226993865031
noisy true:208
noisy false:218
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 426
epoch [133/200] batch [5/10] time 0.335 (0.340) data 0.256 (0.263) loss_x loss_x 0.1429 (0.1191) acc_x 96.8750 (97.5000) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/10] time 0.334 (0.336) data 0.254 (0.260) loss_x loss_x 0.1058 (0.1566) acc_x 100.0000 (97.1875) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 224
confident_label rate tensor(0.4255, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 320
clean true:304
clean false:16
clean_rate:0.95
noisy true:224
noisy false:208
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 432
epoch [134/200] batch [5/10] time 0.358 (0.342) data 0.283 (0.265) loss_x loss_x 0.0957 (0.1101) acc_x 100.0000 (97.5000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/10] time 0.311 (0.343) data 0.237 (0.266) loss_x loss_x 0.1667 (0.1484) acc_x 96.8750 (96.2500) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 232
confident_label rate tensor(0.4335, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 326
clean true:310
clean false:16
clean_rate:0.950920245398773
noisy true:210
noisy false:216
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 426
epoch [135/200] batch [5/10] time 0.371 (0.340) data 0.296 (0.263) loss_x loss_x 0.0779 (0.1226) acc_x 100.0000 (96.8750) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/10] time 0.338 (0.336) data 0.258 (0.259) loss_x loss_x 0.1326 (0.1262) acc_x 96.8750 (96.8750) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 242
confident_label rate tensor(0.4269, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 321
clean true:304
clean false:17
clean_rate:0.9470404984423676
noisy true:206
noisy false:225
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 431
epoch [136/200] batch [5/10] time 0.354 (0.338) data 0.277 (0.261) loss_x loss_x 0.1138 (0.1706) acc_x 100.0000 (98.1250) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/10] time 0.333 (0.333) data 0.256 (0.256) loss_x loss_x 0.1059 (0.1906) acc_x 96.8750 (95.9375) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 323
clean true:307
clean false:16
clean_rate:0.9504643962848297
noisy true:211
noisy false:218
after delete: len(clean_dataset) 323
after delete: len(noisy_dataset) 429
epoch [137/200] batch [5/10] time 0.301 (0.355) data 0.254 (0.285) loss_x loss_x 0.2466 (0.1366) acc_x 93.7500 (97.5000) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/10] time 0.348 (0.355) data 0.272 (0.279) loss_x loss_x 0.3115 (0.1623) acc_x 93.7500 (97.1875) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 239
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 322
clean true:303
clean false:19
clean_rate:0.9409937888198758
noisy true:210
noisy false:220
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 430
epoch [138/200] batch [5/10] time 0.331 (0.344) data 0.253 (0.263) loss_x loss_x 0.2155 (0.1868) acc_x 96.8750 (96.8750) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/10] time 0.370 (0.348) data 0.293 (0.270) loss_x loss_x 0.0941 (0.1704) acc_x 100.0000 (97.5000) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4242, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 319
clean true:301
clean false:18
clean_rate:0.9435736677115988
noisy true:217
noisy false:216
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 433
epoch [139/200] batch [5/9] time 0.376 (0.367) data 0.299 (0.284) loss_x loss_x 0.1147 (0.1693) acc_x 100.0000 (97.5000) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 233
confident_label rate tensor(0.4415, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 332
clean true:313
clean false:19
clean_rate:0.9427710843373494
noisy true:206
noisy false:214
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 420
epoch [140/200] batch [5/10] time 0.358 (0.351) data 0.280 (0.275) loss_x loss_x 0.1210 (0.1806) acc_x 96.8750 (95.0000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/10] time 0.346 (0.343) data 0.265 (0.266) loss_x loss_x 0.0971 (0.1646) acc_x 100.0000 (96.2500) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 233
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:309
clean false:18
clean_rate:0.944954128440367
noisy true:210
noisy false:215
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [141/200] batch [5/10] time 0.348 (0.315) data 0.272 (0.239) loss_x loss_x 0.1198 (0.1994) acc_x 100.0000 (95.6250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/10] time 0.331 (0.329) data 0.255 (0.256) loss_x loss_x 0.3933 (0.2558) acc_x 96.8750 (95.9375) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4335, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 326
clean true:308
clean false:18
clean_rate:0.9447852760736196
noisy true:210
noisy false:216
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 426
epoch [142/200] batch [5/10] time 0.330 (0.349) data 0.256 (0.273) loss_x loss_x 0.3069 (0.1771) acc_x 87.5000 (95.6250) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/10] time 0.282 (0.341) data 0.232 (0.267) loss_x loss_x 0.0810 (0.1620) acc_x 100.0000 (96.5625) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 240
confident_label rate tensor(0.4362, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 328
clean true:311
clean false:17
clean_rate:0.948170731707317
noisy true:201
noisy false:223
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 424
epoch [143/200] batch [5/10] time 0.330 (0.348) data 0.255 (0.266) loss_x loss_x 0.1370 (0.1399) acc_x 96.8750 (96.8750) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/10] time 0.361 (0.338) data 0.285 (0.259) loss_x loss_x 0.1018 (0.1905) acc_x 100.0000 (95.6250) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 218
confident_label rate tensor(0.4335, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 326
clean true:309
clean false:17
clean_rate:0.9478527607361963
noisy true:225
noisy false:201
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 426
epoch [144/200] batch [5/10] time 0.295 (0.332) data 0.219 (0.255) loss_x loss_x 0.0889 (0.2029) acc_x 100.0000 (95.6250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/10] time 0.351 (0.327) data 0.275 (0.250) loss_x loss_x 0.1164 (0.1606) acc_x 100.0000 (97.5000) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 231
confident_label rate tensor(0.4322, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 325
clean true:309
clean false:16
clean_rate:0.9507692307692308
noisy true:212
noisy false:215
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 427
epoch [145/200] batch [5/10] time 0.325 (0.345) data 0.253 (0.270) loss_x loss_x 0.0576 (0.1450) acc_x 100.0000 (97.5000) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/10] time 0.330 (0.344) data 0.257 (0.268) loss_x loss_x 0.3813 (0.1773) acc_x 96.8750 (97.1875) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 229
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:310
clean false:17
clean_rate:0.9480122324159022
noisy true:213
noisy false:212
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [146/200] batch [5/10] time 0.276 (0.334) data 0.200 (0.257) loss_x loss_x 0.2637 (0.1413) acc_x 93.7500 (97.5000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/10] time 0.369 (0.338) data 0.294 (0.265) loss_x loss_x 0.1948 (0.1559) acc_x 96.8750 (97.8125) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 243
confident_label rate tensor(0.4242, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 319
clean true:301
clean false:18
clean_rate:0.9435736677115988
noisy true:208
noisy false:225
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 433
epoch [147/200] batch [5/9] time 0.382 (0.354) data 0.307 (0.283) loss_x loss_x 0.1109 (0.1278) acc_x 96.8750 (96.8750) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 231
confident_label rate tensor(0.4322, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 325
clean true:307
clean false:18
clean_rate:0.9446153846153846
noisy true:214
noisy false:213
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 427
epoch [148/200] batch [5/10] time 0.303 (0.340) data 0.225 (0.264) loss_x loss_x 0.1346 (0.1301) acc_x 93.7500 (96.8750) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/10] time 0.335 (0.343) data 0.257 (0.266) loss_x loss_x 0.3369 (0.2009) acc_x 96.8750 (96.2500) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 238
confident_label rate tensor(0.4362, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 328
clean true:310
clean false:18
clean_rate:0.9451219512195121
noisy true:204
noisy false:220
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 424
epoch [149/200] batch [5/10] time 0.354 (0.354) data 0.278 (0.276) loss_x loss_x 0.1202 (0.1411) acc_x 96.8750 (97.5000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/10] time 0.363 (0.351) data 0.286 (0.274) loss_x loss_x 0.0976 (0.1406) acc_x 96.8750 (97.5000) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 220
confident_label rate tensor(0.4309, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 324
clean true:305
clean false:19
clean_rate:0.941358024691358
noisy true:227
noisy false:201
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 428
epoch [150/200] batch [5/10] time 0.344 (0.359) data 0.266 (0.282) loss_x loss_x 0.0530 (0.1351) acc_x 100.0000 (96.8750) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/10] time 0.332 (0.331) data 0.285 (0.257) loss_x loss_x 0.0793 (0.2487) acc_x 100.0000 (94.6875) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 221
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 335
clean true:316
clean false:19
clean_rate:0.9432835820895522
noisy true:215
noisy false:202
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 417
epoch [151/200] batch [5/10] time 0.353 (0.339) data 0.273 (0.262) loss_x loss_x 0.1345 (0.1592) acc_x 96.8750 (95.6250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/10] time 0.324 (0.326) data 0.247 (0.252) loss_x loss_x 0.0769 (0.2284) acc_x 100.0000 (95.0000) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 232
confident_label rate tensor(0.4242, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 319
clean true:303
clean false:16
clean_rate:0.9498432601880877
noisy true:217
noisy false:216
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 433
epoch [152/200] batch [5/9] time 0.343 (0.351) data 0.267 (0.274) loss_x loss_x 0.1237 (0.1231) acc_x 96.8750 (96.8750) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 226
confident_label rate tensor(0.4362, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 328
clean true:309
clean false:19
clean_rate:0.9420731707317073
noisy true:217
noisy false:207
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 424
epoch [153/200] batch [5/10] time 0.367 (0.348) data 0.289 (0.273) loss_x loss_x 0.1031 (0.1818) acc_x 100.0000 (96.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/10] time 0.344 (0.328) data 0.266 (0.252) loss_x loss_x 0.1248 (0.1844) acc_x 100.0000 (96.8750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 219
confident_label rate tensor(0.4441, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 334
clean true:317
clean false:17
clean_rate:0.9491017964071856
noisy true:216
noisy false:202
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 418
epoch [154/200] batch [5/10] time 0.386 (0.335) data 0.306 (0.257) loss_x loss_x 0.0803 (0.1914) acc_x 100.0000 (98.1250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/10] time 0.352 (0.329) data 0.277 (0.252) loss_x loss_x 0.1304 (0.1744) acc_x 93.7500 (96.8750) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 237
confident_label rate tensor(0.4322, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 325
clean true:308
clean false:17
clean_rate:0.9476923076923077
noisy true:207
noisy false:220
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 427
epoch [155/200] batch [5/10] time 0.396 (0.345) data 0.322 (0.275) loss_x loss_x 0.0988 (0.1327) acc_x 100.0000 (98.1250) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/10] time 0.366 (0.341) data 0.289 (0.267) loss_x loss_x 0.1198 (0.1189) acc_x 96.8750 (98.1250) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:309
clean false:18
clean_rate:0.944954128440367
noisy true:209
noisy false:216
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [156/200] batch [5/10] time 0.331 (0.354) data 0.252 (0.278) loss_x loss_x 0.2812 (0.2073) acc_x 96.8750 (96.8750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/10] time 0.317 (0.346) data 0.243 (0.266) loss_x loss_x 0.0692 (0.2455) acc_x 100.0000 (95.9375) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 226
confident_label rate tensor(0.4402, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 331
clean true:314
clean false:17
clean_rate:0.9486404833836858
noisy true:212
noisy false:209
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 421
epoch [157/200] batch [5/10] time 0.360 (0.343) data 0.285 (0.265) loss_x loss_x 0.1202 (0.1233) acc_x 96.8750 (98.7500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/10] time 0.330 (0.337) data 0.257 (0.260) loss_x loss_x 0.1976 (0.1714) acc_x 93.7500 (96.8750) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 224
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:309
clean false:18
clean_rate:0.944954128440367
noisy true:219
noisy false:206
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [158/200] batch [5/10] time 0.316 (0.331) data 0.241 (0.255) loss_x loss_x 0.0978 (0.1066) acc_x 100.0000 (99.3750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/10] time 0.346 (0.320) data 0.267 (0.243) loss_x loss_x 0.1249 (0.1394) acc_x 100.0000 (97.8125) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:311
clean false:16
clean_rate:0.9510703363914373
noisy true:207
noisy false:218
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [159/200] batch [5/10] time 0.290 (0.290) data 0.215 (0.214) loss_x loss_x 0.0907 (0.1387) acc_x 100.0000 (97.5000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/10] time 0.274 (0.289) data 0.196 (0.213) loss_x loss_x 0.1212 (0.1476) acc_x 100.0000 (97.8125) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 228
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 329
clean true:311
clean false:18
clean_rate:0.9452887537993921
noisy true:213
noisy false:210
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 423
epoch [160/200] batch [5/10] time 0.307 (0.293) data 0.230 (0.214) loss_x loss_x 0.2219 (0.1487) acc_x 96.8750 (98.1250) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/10] time 0.288 (0.291) data 0.206 (0.211) loss_x loss_x 0.1511 (0.1282) acc_x 96.8750 (98.4375) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 239
confident_label rate tensor(0.4255, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 320
clean true:303
clean false:17
clean_rate:0.946875
noisy true:210
noisy false:222
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 432
epoch [161/200] batch [5/10] time 0.280 (0.306) data 0.202 (0.220) loss_x loss_x 0.1116 (0.1976) acc_x 96.8750 (96.2500) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [10/10] time 0.326 (0.315) data 0.246 (0.232) loss_x loss_x 0.0955 (0.1514) acc_x 100.0000 (97.5000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 223
confident_label rate tensor(0.4415, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 332
clean true:314
clean false:18
clean_rate:0.9457831325301205
noisy true:215
noisy false:205
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 420
epoch [162/200] batch [5/10] time 0.293 (0.298) data 0.216 (0.226) loss_x loss_x 0.0912 (0.2138) acc_x 100.0000 (96.8750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/10] time 0.285 (0.294) data 0.208 (0.218) loss_x loss_x 0.1164 (0.1950) acc_x 96.8750 (96.2500) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 229
confident_label rate tensor(0.4362, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 328
clean true:311
clean false:17
clean_rate:0.948170731707317
noisy true:212
noisy false:212
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 424
epoch [163/200] batch [5/10] time 0.272 (0.318) data 0.191 (0.239) loss_x loss_x 0.1154 (0.1154) acc_x 100.0000 (98.1250) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/10] time 0.304 (0.314) data 0.226 (0.235) loss_x loss_x 0.1171 (0.1439) acc_x 96.8750 (97.1875) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 323
clean true:309
clean false:14
clean_rate:0.9566563467492261
noisy true:209
noisy false:220
after delete: len(clean_dataset) 323
after delete: len(noisy_dataset) 429
epoch [164/200] batch [5/10] time 0.342 (0.317) data 0.266 (0.241) loss_x loss_x 0.1976 (0.1279) acc_x 96.8750 (96.8750) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/10] time 0.308 (0.311) data 0.235 (0.237) loss_x loss_x 0.0963 (0.1300) acc_x 100.0000 (97.8125) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 226
confident_label rate tensor(0.4335, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 326
clean true:309
clean false:17
clean_rate:0.9478527607361963
noisy true:217
noisy false:209
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 426
epoch [165/200] batch [5/10] time 0.317 (0.318) data 0.240 (0.241) loss_x loss_x 0.1689 (0.1358) acc_x 93.7500 (96.2500) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/10] time 0.348 (0.319) data 0.272 (0.242) loss_x loss_x 0.1422 (0.1555) acc_x 100.0000 (96.2500) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 224
confident_label rate tensor(0.4362, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 328
clean true:310
clean false:18
clean_rate:0.9451219512195121
noisy true:218
noisy false:206
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 424
epoch [166/200] batch [5/10] time 0.310 (0.317) data 0.229 (0.244) loss_x loss_x 0.1735 (0.2258) acc_x 96.8750 (96.8750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/10] time 0.325 (0.310) data 0.246 (0.234) loss_x loss_x 0.0626 (0.1632) acc_x 100.0000 (97.8125) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 229
confident_label rate tensor(0.4362, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 328
clean true:310
clean false:18
clean_rate:0.9451219512195121
noisy true:213
noisy false:211
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 424
epoch [167/200] batch [5/10] time 0.285 (0.307) data 0.211 (0.231) loss_x loss_x 0.0770 (0.1662) acc_x 100.0000 (96.2500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/10] time 0.344 (0.312) data 0.267 (0.235) loss_x loss_x 0.0943 (0.1369) acc_x 100.0000 (97.8125) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 225
confident_label rate tensor(0.4362, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 328
clean true:312
clean false:16
clean_rate:0.9512195121951219
noisy true:215
noisy false:209
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 424
epoch [168/200] batch [5/10] time 0.343 (0.321) data 0.266 (0.243) loss_x loss_x 0.0612 (0.2501) acc_x 100.0000 (96.8750) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/10] time 0.300 (0.314) data 0.224 (0.236) loss_x loss_x 0.0659 (0.1714) acc_x 96.8750 (97.8125) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 235
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:310
clean false:17
clean_rate:0.9480122324159022
noisy true:207
noisy false:218
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [169/200] batch [5/10] time 0.286 (0.313) data 0.239 (0.243) loss_x loss_x 0.1445 (0.1540) acc_x 93.7500 (95.6250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/10] time 0.327 (0.318) data 0.253 (0.244) loss_x loss_x 0.0607 (0.1360) acc_x 100.0000 (96.8750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 230
confident_label rate tensor(0.4335, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 326
clean true:309
clean false:17
clean_rate:0.9478527607361963
noisy true:213
noisy false:213
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 426
epoch [170/200] batch [5/10] time 0.337 (0.323) data 0.263 (0.246) loss_x loss_x 0.1890 (0.1149) acc_x 96.8750 (97.5000) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/10] time 0.306 (0.316) data 0.227 (0.239) loss_x loss_x 0.1224 (0.1277) acc_x 96.8750 (98.1250) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 215
confident_label rate tensor(0.4402, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 331
clean true:316
clean false:15
clean_rate:0.9546827794561934
noisy true:221
noisy false:200
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 421
epoch [171/200] batch [5/10] time 0.299 (0.303) data 0.222 (0.226) loss_x loss_x 0.1736 (0.1286) acc_x 93.7500 (98.1250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/10] time 0.351 (0.318) data 0.272 (0.240) loss_x loss_x 0.0526 (0.1237) acc_x 100.0000 (98.1250) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 220
confident_label rate tensor(0.4402, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 331
clean true:313
clean false:18
clean_rate:0.945619335347432
noisy true:219
noisy false:202
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 421
epoch [172/200] batch [5/10] time 0.329 (0.314) data 0.255 (0.238) loss_x loss_x 0.0693 (0.1299) acc_x 100.0000 (96.8750) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/10] time 0.310 (0.299) data 0.235 (0.223) loss_x loss_x 0.1049 (0.1353) acc_x 100.0000 (97.5000) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 238
confident_label rate tensor(0.4362, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 328
clean true:308
clean false:20
clean_rate:0.9390243902439024
noisy true:206
noisy false:218
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 424
epoch [173/200] batch [5/10] time 0.356 (0.305) data 0.281 (0.229) loss_x loss_x 0.1156 (0.2205) acc_x 96.8750 (96.8750) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/10] time 0.314 (0.311) data 0.233 (0.234) loss_x loss_x 0.0943 (0.1648) acc_x 100.0000 (97.8125) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 225
confident_label rate tensor(0.4415, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 332
clean true:314
clean false:18
clean_rate:0.9457831325301205
noisy true:213
noisy false:207
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 420
epoch [174/200] batch [5/10] time 0.348 (0.331) data 0.272 (0.253) loss_x loss_x 0.1141 (0.1620) acc_x 96.8750 (97.5000) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/10] time 0.342 (0.329) data 0.264 (0.252) loss_x loss_x 0.1384 (0.1943) acc_x 100.0000 (97.1875) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 230
confident_label rate tensor(0.4388, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 330
clean true:311
clean false:19
clean_rate:0.9424242424242424
noisy true:211
noisy false:211
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 422
epoch [175/200] batch [5/10] time 0.321 (0.319) data 0.246 (0.242) loss_x loss_x 0.1776 (0.1303) acc_x 93.7500 (96.8750) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/10] time 0.326 (0.321) data 0.252 (0.247) loss_x loss_x 0.1035 (0.1207) acc_x 100.0000 (97.5000) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 231
confident_label rate tensor(0.4309, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 324
clean true:307
clean false:17
clean_rate:0.9475308641975309
noisy true:214
noisy false:214
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 428
epoch [176/200] batch [5/10] time 0.263 (0.281) data 0.188 (0.204) loss_x loss_x 0.0573 (0.1141) acc_x 100.0000 (98.7500) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/10] time 0.269 (0.284) data 0.193 (0.207) loss_x loss_x 0.0905 (0.1169) acc_x 100.0000 (98.7500) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 232
confident_label rate tensor(0.4428, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 333
clean true:313
clean false:20
clean_rate:0.93993993993994
noisy true:207
noisy false:212
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 419
epoch [177/200] batch [5/10] time 0.264 (0.272) data 0.189 (0.197) loss_x loss_x 0.1067 (0.1619) acc_x 93.7500 (96.2500) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/10] time 0.287 (0.281) data 0.213 (0.205) loss_x loss_x 0.1401 (0.1810) acc_x 96.8750 (95.9375) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 238
confident_label rate tensor(0.4415, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 332
clean true:312
clean false:20
clean_rate:0.9397590361445783
noisy true:202
noisy false:218
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 420
epoch [178/200] batch [5/10] time 0.256 (0.282) data 0.179 (0.204) loss_x loss_x 0.3381 (0.2222) acc_x 87.5000 (94.3750) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [10/10] time 0.287 (0.283) data 0.210 (0.208) loss_x loss_x 0.0451 (0.1611) acc_x 100.0000 (96.8750) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 224
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 329
clean true:310
clean false:19
clean_rate:0.9422492401215805
noisy true:218
noisy false:205
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 423
epoch [179/200] batch [5/10] time 0.294 (0.273) data 0.198 (0.199) loss_x loss_x 0.1874 (0.1212) acc_x 96.8750 (98.1250) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/10] time 0.284 (0.283) data 0.208 (0.207) loss_x loss_x 0.0913 (0.1347) acc_x 100.0000 (97.5000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 220
confident_label rate tensor(0.4441, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 334
clean true:314
clean false:20
clean_rate:0.9401197604790419
noisy true:218
noisy false:200
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 418
epoch [180/200] batch [5/10] time 0.298 (0.296) data 0.223 (0.219) loss_x loss_x 0.3176 (0.1992) acc_x 96.8750 (96.8750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/10] time 0.300 (0.290) data 0.225 (0.212) loss_x loss_x 0.1232 (0.1629) acc_x 96.8750 (96.8750) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 223
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:309
clean false:18
clean_rate:0.944954128440367
noisy true:220
noisy false:205
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [181/200] batch [5/10] time 0.263 (0.269) data 0.188 (0.198) loss_x loss_x 0.1322 (0.1708) acc_x 96.8750 (96.8750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [10/10] time 0.298 (0.279) data 0.223 (0.204) loss_x loss_x 0.0981 (0.1783) acc_x 96.8750 (97.1875) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4362, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 328
clean true:308
clean false:20
clean_rate:0.9390243902439024
noisy true:210
noisy false:214
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 424
epoch [182/200] batch [5/10] time 0.262 (0.270) data 0.187 (0.198) loss_x loss_x 0.0687 (0.1542) acc_x 100.0000 (98.7500) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/10] time 0.296 (0.280) data 0.217 (0.205) loss_x loss_x 0.1351 (0.1474) acc_x 96.8750 (98.1250) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 233
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 323
clean true:305
clean false:18
clean_rate:0.9442724458204335
noisy true:214
noisy false:215
after delete: len(clean_dataset) 323
after delete: len(noisy_dataset) 429
epoch [183/200] batch [5/10] time 0.268 (0.280) data 0.189 (0.201) loss_x loss_x 0.0840 (0.1226) acc_x 100.0000 (98.1250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/10] time 0.251 (0.286) data 0.174 (0.208) loss_x loss_x 0.1344 (0.1213) acc_x 96.8750 (97.5000) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 223
confident_label rate tensor(0.4415, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 332
clean true:313
clean false:19
clean_rate:0.9427710843373494
noisy true:216
noisy false:204
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 420
epoch [184/200] batch [5/10] time 0.281 (0.287) data 0.200 (0.208) loss_x loss_x 0.0934 (0.1014) acc_x 100.0000 (99.3750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [10/10] time 0.277 (0.288) data 0.200 (0.210) loss_x loss_x 0.1459 (0.1446) acc_x 96.8750 (97.1875) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 232
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 329
clean true:309
clean false:20
clean_rate:0.939209726443769
noisy true:211
noisy false:212
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 423
epoch [185/200] batch [5/10] time 0.259 (0.284) data 0.182 (0.208) loss_x loss_x 0.1503 (0.1356) acc_x 96.8750 (96.8750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/10] time 0.296 (0.284) data 0.216 (0.207) loss_x loss_x 0.1741 (0.1366) acc_x 96.8750 (97.5000) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 225
confident_label rate tensor(0.4402, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 331
clean true:313
clean false:18
clean_rate:0.945619335347432
noisy true:214
noisy false:207
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 421
epoch [186/200] batch [5/10] time 0.259 (0.271) data 0.180 (0.198) loss_x loss_x 0.0809 (0.1644) acc_x 100.0000 (96.8750) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [10/10] time 0.256 (0.265) data 0.180 (0.192) loss_x loss_x 0.0690 (0.1731) acc_x 100.0000 (97.5000) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 238
confident_label rate tensor(0.4335, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 326
clean true:306
clean false:20
clean_rate:0.9386503067484663
noisy true:208
noisy false:218
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 426
epoch [187/200] batch [5/10] time 0.252 (0.271) data 0.177 (0.194) loss_x loss_x 0.1357 (0.1388) acc_x 96.8750 (96.8750) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/10] time 0.285 (0.269) data 0.204 (0.192) loss_x loss_x 0.1140 (0.1182) acc_x 96.8750 (97.8125) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 229
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 329
clean true:310
clean false:19
clean_rate:0.9422492401215805
noisy true:213
noisy false:210
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 423
epoch [188/200] batch [5/10] time 0.281 (0.276) data 0.205 (0.198) loss_x loss_x 0.0844 (0.1822) acc_x 100.0000 (97.5000) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/10] time 0.273 (0.271) data 0.195 (0.196) loss_x loss_x 0.0608 (0.1451) acc_x 96.8750 (97.8125) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 232
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:309
clean false:18
clean_rate:0.944954128440367
noisy true:211
noisy false:214
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [189/200] batch [5/10] time 0.254 (0.272) data 0.179 (0.198) loss_x loss_x 0.0864 (0.1798) acc_x 100.0000 (97.5000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/10] time 0.263 (0.271) data 0.187 (0.195) loss_x loss_x 0.0920 (0.1701) acc_x 100.0000 (97.8125) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 227
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 329
clean true:309
clean false:20
clean_rate:0.939209726443769
noisy true:216
noisy false:207
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 423
epoch [190/200] batch [5/10] time 0.275 (0.280) data 0.198 (0.202) loss_x loss_x 0.1517 (0.1214) acc_x 93.7500 (97.5000) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/10] time 0.264 (0.272) data 0.186 (0.195) loss_x loss_x 0.2487 (0.1432) acc_x 93.7500 (96.8750) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 218
confident_label rate tensor(0.4428, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 333
clean true:315
clean false:18
clean_rate:0.9459459459459459
noisy true:219
noisy false:200
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 419
epoch [191/200] batch [5/10] time 0.249 (0.264) data 0.174 (0.188) loss_x loss_x 0.0948 (0.1346) acc_x 96.8750 (97.5000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/10] time 0.257 (0.263) data 0.181 (0.189) loss_x loss_x 0.1152 (0.1452) acc_x 96.8750 (97.5000) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 223
confident_label rate tensor(0.4335, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 326
clean true:309
clean false:17
clean_rate:0.9478527607361963
noisy true:220
noisy false:206
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 426
epoch [192/200] batch [5/10] time 0.282 (0.274) data 0.202 (0.194) loss_x loss_x 0.1361 (0.1752) acc_x 96.8750 (95.0000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [10/10] time 0.255 (0.271) data 0.179 (0.192) loss_x loss_x 0.1709 (0.1512) acc_x 96.8750 (96.5625) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 233
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:310
clean false:17
clean_rate:0.9480122324159022
noisy true:209
noisy false:216
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [193/200] batch [5/10] time 0.275 (0.271) data 0.196 (0.195) loss_x loss_x 0.1095 (0.0919) acc_x 100.0000 (98.7500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/10] time 0.273 (0.270) data 0.196 (0.192) loss_x loss_x 0.0864 (0.1016) acc_x 100.0000 (98.4375) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 224
confident_label rate tensor(0.4402, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 331
clean true:314
clean false:17
clean_rate:0.9486404833836858
noisy true:214
noisy false:207
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 421
epoch [194/200] batch [5/10] time 0.264 (0.271) data 0.184 (0.194) loss_x loss_x 0.2610 (0.2040) acc_x 93.7500 (96.8750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/10] time 0.258 (0.268) data 0.190 (0.192) loss_x loss_x 0.0792 (0.1810) acc_x 100.0000 (96.5625) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 217
confident_label rate tensor(0.4348, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 327
clean true:311
clean false:16
clean_rate:0.9510703363914373
noisy true:224
noisy false:201
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 425
epoch [195/200] batch [5/10] time 0.248 (0.264) data 0.168 (0.186) loss_x loss_x 0.5518 (0.2493) acc_x 96.8750 (96.2500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/10] time 0.277 (0.271) data 0.201 (0.193) loss_x loss_x 0.2028 (0.2020) acc_x 96.8750 (96.8750) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 229
confident_label rate tensor(0.4428, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 333
clean true:315
clean false:18
clean_rate:0.9459459459459459
noisy true:208
noisy false:211
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 419
epoch [196/200] batch [5/10] time 0.274 (0.276) data 0.198 (0.197) loss_x loss_x 0.1367 (0.1563) acc_x 96.8750 (96.2500) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/10] time 0.279 (0.272) data 0.202 (0.194) loss_x loss_x 0.1117 (0.1500) acc_x 96.8750 (96.5625) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4322, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 325
clean true:306
clean false:19
clean_rate:0.9415384615384615
noisy true:212
noisy false:215
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 427
epoch [197/200] batch [5/10] time 0.255 (0.273) data 0.179 (0.195) loss_x loss_x 0.3237 (0.2234) acc_x 87.5000 (96.2500) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [10/10] time 0.317 (0.273) data 0.210 (0.195) loss_x loss_x 0.0817 (0.1503) acc_x 100.0000 (97.8125) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 234
confident_label rate tensor(0.4269, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 321
clean true:304
clean false:17
clean_rate:0.9470404984423676
noisy true:214
noisy false:217
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 431
epoch [198/200] batch [5/10] time 0.273 (0.280) data 0.194 (0.202) loss_x loss_x 0.1036 (0.1973) acc_x 100.0000 (98.1250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/10] time 0.273 (0.270) data 0.196 (0.193) loss_x loss_x 0.1232 (0.1619) acc_x 96.8750 (97.8125) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 228
confident_label rate tensor(0.4415, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 332
clean true:313
clean false:19
clean_rate:0.9427710843373494
noisy true:211
noisy false:209
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 420
epoch [199/200] batch [5/10] time 0.308 (0.273) data 0.229 (0.196) loss_x loss_x 0.1271 (0.1460) acc_x 96.8750 (96.8750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/10] time 0.274 (0.274) data 0.194 (0.196) loss_x loss_x 0.0894 (0.1656) acc_x 100.0000 (96.2500) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 231
confident_label rate tensor(0.4322, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 325
clean true:309
clean false:16
clean_rate:0.9507692307692308
noisy true:212
noisy false:215
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 427
epoch [200/200] batch [5/10] time 0.252 (0.270) data 0.172 (0.191) loss_x loss_x 0.1138 (0.1810) acc_x 100.0000 (96.2500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/10] time 0.268 (0.271) data 0.191 (0.192) loss_x loss_x 0.1521 (0.1619) acc_x 96.8750 (96.8750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 1,692
* correct: 939
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 54.9%
Elapsed: 0:44:12
