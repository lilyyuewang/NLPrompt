***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '47']
output_dir: output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: DescribableTextures
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 47
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: DescribableTextures
Reading split from /home/convex/datasets/nlprompt/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/dtd/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 23
Data loader size: 2
Data loader size: 17
---------  -------------------
Dataset    DescribableTextures
# classes  47
# train_x  752
# val      188
# test     1,692
---------  -------------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 569
confident_label rate tensor(0.0931, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 70
clean true:58
clean false:12
clean_rate:0.8285714285714286
noisy true:125
noisy false:557
after delete: len(clean_dataset) 70
after delete: len(noisy_dataset) 682
epoch [1/200] batch [1/2] time 0.432 (0.432) data 0.296 (0.296) loss_x loss_x 2.5879 (2.5879) acc_x 53.1250 (53.1250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/2] time 0.334 (0.383) data 0.286 (0.291) loss_x loss_x 2.5938 (2.5908) acc_x 46.8750 (50.0000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 570
confident_label rate tensor(0.0824, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 62
clean true:55
clean false:7
clean_rate:0.8870967741935484
noisy true:127
noisy false:563
after delete: len(clean_dataset) 62
after delete: len(noisy_dataset) 690
epoch [2/200] batch [1/1] time 0.290 (0.290) data 0.243 (0.243) loss_x loss_x 2.5703 (2.5703) acc_x 46.8750 (46.8750) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 534
confident_label rate tensor(0.1024, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 77
clean true:71
clean false:6
clean_rate:0.922077922077922
noisy true:147
noisy false:528
after delete: len(clean_dataset) 77
after delete: len(noisy_dataset) 675
epoch [3/200] batch [1/2] time 0.368 (0.368) data 0.321 (0.321) loss_x loss_x 2.9805 (2.9805) acc_x 25.0000 (25.0000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [2/2] time 0.359 (0.364) data 0.312 (0.317) loss_x loss_x 1.7207 (2.3506) acc_x 56.2500 (40.6250) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 479
confident_label rate tensor(0.1250, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 94
clean true:88
clean false:6
clean_rate:0.9361702127659575
noisy true:185
noisy false:473
after delete: len(clean_dataset) 94
after delete: len(noisy_dataset) 658
epoch [4/200] batch [1/2] time 0.324 (0.324) data 0.277 (0.277) loss_x loss_x 1.2549 (1.2549) acc_x 68.7500 (68.7500) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [2/2] time 0.294 (0.309) data 0.247 (0.262) loss_x loss_x 1.4277 (1.3413) acc_x 62.5000 (65.6250) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 487
confident_label rate tensor(0.1277, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 96
clean true:89
clean false:7
clean_rate:0.9270833333333334
noisy true:176
noisy false:480
after delete: len(clean_dataset) 96
after delete: len(noisy_dataset) 656
epoch [5/200] batch [1/3] time 0.307 (0.307) data 0.259 (0.259) loss_x loss_x 1.0059 (1.0059) acc_x 68.7500 (68.7500) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [2/3] time 0.283 (0.295) data 0.236 (0.247) loss_x loss_x 1.2715 (1.1387) acc_x 62.5000 (65.6250) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [3/3] time 0.330 (0.307) data 0.283 (0.259) loss_x loss_x 0.8237 (1.0337) acc_x 78.1250 (69.7917) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 485
confident_label rate tensor(0.1316, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 99
clean true:90
clean false:9
clean_rate:0.9090909090909091
noisy true:177
noisy false:476
after delete: len(clean_dataset) 99
after delete: len(noisy_dataset) 653
epoch [6/200] batch [1/3] time 0.300 (0.300) data 0.253 (0.253) loss_x loss_x 0.8853 (0.8853) acc_x 78.1250 (78.1250) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [2/3] time 0.294 (0.297) data 0.247 (0.250) loss_x loss_x 1.0654 (0.9753) acc_x 68.7500 (73.4375) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [3/3] time 0.289 (0.294) data 0.242 (0.247) loss_x loss_x 0.5425 (0.8311) acc_x 87.5000 (78.1250) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 471
confident_label rate tensor(0.1250, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 94
clean true:91
clean false:3
clean_rate:0.9680851063829787
noisy true:190
noisy false:468
after delete: len(clean_dataset) 94
after delete: len(noisy_dataset) 658
epoch [7/200] batch [1/2] time 0.358 (0.358) data 0.311 (0.311) loss_x loss_x 0.5996 (0.5996) acc_x 87.5000 (87.5000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [2/2] time 0.360 (0.359) data 0.313 (0.312) loss_x loss_x 0.4285 (0.5140) acc_x 87.5000 (87.5000) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 461
confident_label rate tensor(0.1436, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 108
clean true:103
clean false:5
clean_rate:0.9537037037037037
noisy true:188
noisy false:456
after delete: len(clean_dataset) 108
after delete: len(noisy_dataset) 644
epoch [8/200] batch [1/3] time 0.290 (0.290) data 0.240 (0.240) loss_x loss_x 0.8369 (0.8369) acc_x 75.0000 (75.0000) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [2/3] time 0.284 (0.287) data 0.234 (0.237) loss_x loss_x 1.1270 (0.9819) acc_x 84.3750 (79.6875) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [3/3] time 0.260 (0.278) data 0.211 (0.229) loss_x loss_x 1.0039 (0.9893) acc_x 65.6250 (75.0000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 465
confident_label rate tensor(0.1463, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 110
clean true:103
clean false:7
clean_rate:0.9363636363636364
noisy true:184
noisy false:458
after delete: len(clean_dataset) 110
after delete: len(noisy_dataset) 642
epoch [9/200] batch [1/3] time 0.374 (0.374) data 0.326 (0.326) loss_x loss_x 0.7051 (0.7051) acc_x 78.1250 (78.1250) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [2/3] time 0.294 (0.334) data 0.248 (0.287) loss_x loss_x 0.6328 (0.6689) acc_x 81.2500 (79.6875) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [3/3] time 0.326 (0.331) data 0.276 (0.283) loss_x loss_x 0.5815 (0.6398) acc_x 87.5000 (82.2917) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 449
confident_label rate tensor(0.1543, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 116
clean true:108
clean false:8
clean_rate:0.9310344827586207
noisy true:195
noisy false:441
after delete: len(clean_dataset) 116
after delete: len(noisy_dataset) 636
epoch [10/200] batch [1/3] time 0.302 (0.302) data 0.254 (0.254) loss_x loss_x 0.3560 (0.3560) acc_x 96.8750 (96.8750) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [2/3] time 0.280 (0.291) data 0.233 (0.244) loss_x loss_x 0.9438 (0.6499) acc_x 62.5000 (79.6875) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [3/3] time 0.274 (0.285) data 0.227 (0.238) loss_x loss_x 0.6279 (0.6426) acc_x 81.2500 (80.2083) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 444
confident_label rate tensor(0.1715, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 129
clean true:119
clean false:10
clean_rate:0.9224806201550387
noisy true:189
noisy false:434
after delete: len(clean_dataset) 129
after delete: len(noisy_dataset) 623
epoch [11/200] batch [1/4] time 0.274 (0.274) data 0.227 (0.227) loss_x loss_x 0.6934 (0.6934) acc_x 84.3750 (84.3750) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [2/4] time 0.268 (0.271) data 0.221 (0.224) loss_x loss_x 0.7183 (0.7058) acc_x 87.5000 (85.9375) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [3/4] time 0.282 (0.275) data 0.235 (0.228) loss_x loss_x 1.2051 (0.8722) acc_x 84.3750 (85.4167) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [4/4] time 0.295 (0.280) data 0.248 (0.233) loss_x loss_x 0.5005 (0.7793) acc_x 87.5000 (85.9375) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 425
confident_label rate tensor(0.1649, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 124
clean true:114
clean false:10
clean_rate:0.9193548387096774
noisy true:213
noisy false:415
after delete: len(clean_dataset) 124
after delete: len(noisy_dataset) 628
epoch [12/200] batch [1/3] time 0.270 (0.270) data 0.223 (0.223) loss_x loss_x 0.7632 (0.7632) acc_x 84.3750 (84.3750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [2/3] time 0.359 (0.314) data 0.312 (0.267) loss_x loss_x 0.6494 (0.7063) acc_x 81.2500 (82.8125) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [3/3] time 0.332 (0.320) data 0.285 (0.273) loss_x loss_x 0.4087 (0.6071) acc_x 87.5000 (84.3750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 431
confident_label rate tensor(0.1795, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 135
clean true:125
clean false:10
clean_rate:0.9259259259259259
noisy true:196
noisy false:421
after delete: len(clean_dataset) 135
after delete: len(noisy_dataset) 617
epoch [13/200] batch [1/4] time 0.364 (0.364) data 0.248 (0.248) loss_x loss_x 0.8892 (0.8892) acc_x 65.6250 (65.6250) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [2/4] time 0.263 (0.314) data 0.216 (0.232) loss_x loss_x 0.6138 (0.7515) acc_x 87.5000 (76.5625) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [3/4] time 0.285 (0.304) data 0.236 (0.233) loss_x loss_x 0.7368 (0.7466) acc_x 81.2500 (78.1250) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [4/4] time 0.305 (0.304) data 0.258 (0.240) loss_x loss_x 0.6968 (0.7341) acc_x 78.1250 (78.1250) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 421
confident_label rate tensor(0.1715, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 129
clean true:120
clean false:9
clean_rate:0.9302325581395349
noisy true:211
noisy false:412
after delete: len(clean_dataset) 129
after delete: len(noisy_dataset) 623
epoch [14/200] batch [1/4] time 0.315 (0.315) data 0.267 (0.267) loss_x loss_x 0.3872 (0.3872) acc_x 87.5000 (87.5000) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [2/4] time 0.313 (0.314) data 0.266 (0.266) loss_x loss_x 0.6304 (0.5088) acc_x 87.5000 (87.5000) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [3/4] time 0.248 (0.292) data 0.201 (0.245) loss_x loss_x 0.9150 (0.6442) acc_x 78.1250 (84.3750) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [4/4] time 0.303 (0.295) data 0.256 (0.247) loss_x loss_x 0.4932 (0.6064) acc_x 84.3750 (84.3750) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 424
confident_label rate tensor(0.1715, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 129
clean true:119
clean false:10
clean_rate:0.9224806201550387
noisy true:209
noisy false:414
after delete: len(clean_dataset) 129
after delete: len(noisy_dataset) 623
epoch [15/200] batch [1/4] time 0.394 (0.394) data 0.274 (0.274) loss_x loss_x 0.4795 (0.4795) acc_x 81.2500 (81.2500) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [2/4] time 0.286 (0.340) data 0.238 (0.256) loss_x loss_x 0.6709 (0.5752) acc_x 84.3750 (82.8125) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [3/4] time 0.263 (0.314) data 0.214 (0.242) loss_x loss_x 0.5400 (0.5635) acc_x 87.5000 (84.3750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [4/4] time 0.281 (0.306) data 0.234 (0.240) loss_x loss_x 0.4016 (0.5230) acc_x 93.7500 (86.7188) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 421
confident_label rate tensor(0.1795, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 135
clean true:124
clean false:11
clean_rate:0.9185185185185185
noisy true:207
noisy false:410
after delete: len(clean_dataset) 135
after delete: len(noisy_dataset) 617
epoch [16/200] batch [1/4] time 0.258 (0.258) data 0.208 (0.208) loss_x loss_x 0.4417 (0.4417) acc_x 93.7500 (93.7500) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [2/4] time 0.260 (0.259) data 0.213 (0.210) loss_x loss_x 0.5791 (0.5104) acc_x 84.3750 (89.0625) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [3/4] time 0.248 (0.255) data 0.200 (0.207) loss_x loss_x 0.6680 (0.5629) acc_x 78.1250 (85.4167) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [4/4] time 0.256 (0.256) data 0.208 (0.207) loss_x loss_x 0.4282 (0.5292) acc_x 96.8750 (88.2812) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 419
confident_label rate tensor(0.1941, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 146
clean true:132
clean false:14
clean_rate:0.9041095890410958
noisy true:201
noisy false:405
after delete: len(clean_dataset) 146
after delete: len(noisy_dataset) 606
epoch [17/200] batch [1/4] time 0.319 (0.319) data 0.271 (0.271) loss_x loss_x 0.7666 (0.7666) acc_x 81.2500 (81.2500) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [2/4] time 0.326 (0.322) data 0.279 (0.275) loss_x loss_x 0.3472 (0.5569) acc_x 93.7500 (87.5000) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [3/4] time 0.317 (0.320) data 0.269 (0.273) loss_x loss_x 0.5483 (0.5540) acc_x 84.3750 (86.4583) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [4/4] time 0.291 (0.313) data 0.243 (0.266) loss_x loss_x 0.6309 (0.5732) acc_x 84.3750 (85.9375) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 399
confident_label rate tensor(0.2048, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 154
clean true:139
clean false:15
clean_rate:0.9025974025974026
noisy true:214
noisy false:384
after delete: len(clean_dataset) 154
after delete: len(noisy_dataset) 598
epoch [18/200] batch [1/4] time 0.259 (0.259) data 0.211 (0.211) loss_x loss_x 0.7358 (0.7358) acc_x 84.3750 (84.3750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [2/4] time 0.275 (0.267) data 0.227 (0.219) loss_x loss_x 0.6182 (0.6770) acc_x 75.0000 (79.6875) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [3/4] time 0.305 (0.280) data 0.258 (0.232) loss_x loss_x 0.6133 (0.6558) acc_x 81.2500 (80.2083) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [4/4] time 0.304 (0.286) data 0.257 (0.238) loss_x loss_x 0.4753 (0.6107) acc_x 90.6250 (82.8125) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 409
confident_label rate tensor(0.2008, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 151
clean true:135
clean false:16
clean_rate:0.8940397350993378
noisy true:208
noisy false:393
after delete: len(clean_dataset) 151
after delete: len(noisy_dataset) 601
epoch [19/200] batch [1/4] time 0.314 (0.314) data 0.266 (0.266) loss_x loss_x 0.3547 (0.3547) acc_x 90.6250 (90.6250) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [2/4] time 0.289 (0.302) data 0.242 (0.254) loss_x loss_x 0.6865 (0.5206) acc_x 78.1250 (84.3750) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [3/4] time 0.311 (0.305) data 0.264 (0.257) loss_x loss_x 0.4180 (0.4864) acc_x 87.5000 (85.4167) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [4/4] time 0.345 (0.315) data 0.298 (0.267) loss_x loss_x 0.4175 (0.4692) acc_x 84.3750 (85.1562) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 411
confident_label rate tensor(0.2035, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 153
clean true:140
clean false:13
clean_rate:0.9150326797385621
noisy true:201
noisy false:398
after delete: len(clean_dataset) 153
after delete: len(noisy_dataset) 599
epoch [20/200] batch [1/4] time 0.299 (0.299) data 0.250 (0.250) loss_x loss_x 0.2144 (0.2144) acc_x 96.8750 (96.8750) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [2/4] time 0.320 (0.309) data 0.272 (0.261) loss_x loss_x 0.4680 (0.3412) acc_x 87.5000 (92.1875) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [3/4] time 0.293 (0.304) data 0.246 (0.256) loss_x loss_x 0.4421 (0.3748) acc_x 90.6250 (91.6667) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [4/4] time 0.286 (0.299) data 0.238 (0.252) loss_x loss_x 0.8306 (0.4888) acc_x 84.3750 (89.8438) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 388
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 161
clean true:145
clean false:16
clean_rate:0.9006211180124224
noisy true:219
noisy false:372
after delete: len(clean_dataset) 161
after delete: len(noisy_dataset) 591
epoch [21/200] batch [5/5] time 0.278 (0.288) data 0.230 (0.240) loss_x loss_x 0.5923 (0.5404) acc_x 84.3750 (87.5000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 384
confident_label rate tensor(0.2207, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 166
clean true:148
clean false:18
clean_rate:0.891566265060241
noisy true:220
noisy false:366
after delete: len(clean_dataset) 166
after delete: len(noisy_dataset) 586
epoch [22/200] batch [5/5] time 0.330 (0.316) data 0.283 (0.267) loss_x loss_x 0.4182 (0.3622) acc_x 96.8750 (94.3750) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 390
confident_label rate tensor(0.2367, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 178
clean true:155
clean false:23
clean_rate:0.8707865168539326
noisy true:207
noisy false:367
after delete: len(clean_dataset) 178
after delete: len(noisy_dataset) 574
epoch [23/200] batch [5/5] time 0.279 (0.304) data 0.231 (0.257) loss_x loss_x 0.4707 (0.5407) acc_x 87.5000 (86.2500) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 389
confident_label rate tensor(0.2234, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 168
clean true:146
clean false:22
clean_rate:0.8690476190476191
noisy true:217
noisy false:367
after delete: len(clean_dataset) 168
after delete: len(noisy_dataset) 584
epoch [24/200] batch [5/5] time 0.329 (0.319) data 0.281 (0.272) loss_x loss_x 0.5586 (0.5439) acc_x 87.5000 (86.8750) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 388
confident_label rate tensor(0.2394, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 180
clean true:156
clean false:24
clean_rate:0.8666666666666667
noisy true:208
noisy false:364
after delete: len(clean_dataset) 180
after delete: len(noisy_dataset) 572
epoch [25/200] batch [5/5] time 0.293 (0.302) data 0.245 (0.254) loss_x loss_x 0.3464 (0.3277) acc_x 90.6250 (91.8750) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 389
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 174
clean true:149
clean false:25
clean_rate:0.8563218390804598
noisy true:214
noisy false:364
after delete: len(clean_dataset) 174
after delete: len(noisy_dataset) 578
epoch [26/200] batch [5/5] time 0.306 (0.253) data 0.258 (0.205) loss_x loss_x 0.1927 (0.3635) acc_x 96.8750 (90.6250) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 394
confident_label rate tensor(0.2301, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 173
clean true:148
clean false:25
clean_rate:0.8554913294797688
noisy true:210
noisy false:369
after delete: len(clean_dataset) 173
after delete: len(noisy_dataset) 579
epoch [27/200] batch [5/5] time 0.288 (0.276) data 0.241 (0.229) loss_x loss_x 0.3931 (0.4091) acc_x 90.6250 (88.7500) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 390
confident_label rate tensor(0.2380, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 179
clean true:151
clean false:28
clean_rate:0.8435754189944135
noisy true:211
noisy false:362
after delete: len(clean_dataset) 179
after delete: len(noisy_dataset) 573
epoch [28/200] batch [5/5] time 0.309 (0.295) data 0.259 (0.245) loss_x loss_x 0.1853 (0.3311) acc_x 96.8750 (91.2500) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 379
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:157
clean false:25
clean_rate:0.8626373626373627
noisy true:216
noisy false:354
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [29/200] batch [5/5] time 0.299 (0.293) data 0.252 (0.232) loss_x loss_x 0.3376 (0.5003) acc_x 93.7500 (89.3750) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 383
confident_label rate tensor(0.2407, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 181
clean true:152
clean false:29
clean_rate:0.8397790055248618
noisy true:217
noisy false:354
after delete: len(clean_dataset) 181
after delete: len(noisy_dataset) 571
epoch [30/200] batch [5/5] time 0.327 (0.316) data 0.280 (0.269) loss_x loss_x 0.4465 (0.3695) acc_x 87.5000 (91.2500) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 382
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:156
clean false:27
clean_rate:0.8524590163934426
noisy true:214
noisy false:355
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [31/200] batch [5/5] time 0.332 (0.284) data 0.285 (0.237) loss_x loss_x 0.2881 (0.4000) acc_x 100.0000 (90.6250) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:155
clean false:28
clean_rate:0.8469945355191257
noisy true:224
noisy false:345
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [32/200] batch [5/5] time 0.279 (0.283) data 0.232 (0.236) loss_x loss_x 0.3433 (0.4161) acc_x 90.6250 (88.7500) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 361
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:161
clean false:26
clean_rate:0.8609625668449198
noisy true:230
noisy false:335
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [33/200] batch [5/5] time 0.273 (0.303) data 0.226 (0.256) loss_x loss_x 0.2305 (0.3212) acc_x 93.7500 (90.6250) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 188
clean true:151
clean false:37
clean_rate:0.8031914893617021
noisy true:223
noisy false:341
after delete: len(clean_dataset) 188
after delete: len(noisy_dataset) 564
epoch [34/200] batch [5/5] time 0.333 (0.326) data 0.285 (0.278) loss_x loss_x 0.4641 (0.4522) acc_x 90.6250 (89.3750) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2540, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 191
clean true:158
clean false:33
clean_rate:0.8272251308900523
noisy true:226
noisy false:335
after delete: len(clean_dataset) 191
after delete: len(noisy_dataset) 561
epoch [35/200] batch [5/5] time 0.433 (0.350) data 0.385 (0.302) loss_x loss_x 0.2979 (0.4300) acc_x 90.6250 (88.7500) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 378
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:153
clean false:30
clean_rate:0.8360655737704918
noisy true:221
noisy false:348
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [36/200] batch [5/5] time 0.266 (0.339) data 0.218 (0.291) loss_x loss_x 0.4258 (0.4456) acc_x 87.5000 (88.7500) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 188
clean true:155
clean false:33
clean_rate:0.824468085106383
noisy true:224
noisy false:340
after delete: len(clean_dataset) 188
after delete: len(noisy_dataset) 564
epoch [37/200] batch [5/5] time 0.323 (0.317) data 0.275 (0.270) loss_x loss_x 0.2019 (0.3304) acc_x 96.8750 (90.6250) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 363
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 189
clean true:158
clean false:31
clean_rate:0.8359788359788359
noisy true:231
noisy false:332
after delete: len(clean_dataset) 189
after delete: len(noisy_dataset) 563
epoch [38/200] batch [5/5] time 0.273 (0.288) data 0.225 (0.241) loss_x loss_x 0.4634 (0.3327) acc_x 87.5000 (92.5000) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 368
confident_label rate tensor(0.2566, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 193
clean true:164
clean false:29
clean_rate:0.8497409326424871
noisy true:220
noisy false:339
after delete: len(clean_dataset) 193
after delete: len(noisy_dataset) 559
epoch [39/200] batch [5/6] time 0.302 (0.296) data 0.255 (0.249) loss_x loss_x 0.4495 (0.3042) acc_x 81.2500 (92.5000) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 355
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 202
clean true:167
clean false:35
clean_rate:0.8267326732673267
noisy true:230
noisy false:320
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 550
epoch [40/200] batch [5/6] time 0.300 (0.316) data 0.253 (0.269) loss_x loss_x 0.6694 (0.3556) acc_x 81.2500 (91.8750) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 361
confident_label rate tensor(0.2646, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 199
clean true:167
clean false:32
clean_rate:0.8391959798994975
noisy true:224
noisy false:329
after delete: len(clean_dataset) 199
after delete: len(noisy_dataset) 553
epoch [41/200] batch [5/6] time 0.300 (0.296) data 0.253 (0.249) loss_x loss_x 0.4067 (0.4915) acc_x 93.7500 (90.0000) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 361
confident_label rate tensor(0.2753, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 207
clean true:167
clean false:40
clean_rate:0.8067632850241546
noisy true:224
noisy false:321
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 545
epoch [42/200] batch [5/6] time 0.309 (0.292) data 0.262 (0.245) loss_x loss_x 0.8403 (0.4418) acc_x 78.1250 (86.8750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 354
confident_label rate tensor(0.2793, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 210
clean true:170
clean false:40
clean_rate:0.8095238095238095
noisy true:228
noisy false:314
after delete: len(clean_dataset) 210
after delete: len(noisy_dataset) 542
epoch [43/200] batch [5/6] time 0.273 (0.319) data 0.226 (0.257) loss_x loss_x 0.5332 (0.5212) acc_x 90.6250 (87.5000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 348
confident_label rate tensor(0.2753, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 207
clean true:178
clean false:29
clean_rate:0.8599033816425121
noisy true:226
noisy false:319
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 545
epoch [44/200] batch [5/6] time 0.291 (0.294) data 0.243 (0.246) loss_x loss_x 0.4458 (0.3700) acc_x 81.2500 (90.0000) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 358
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:168
clean false:36
clean_rate:0.8235294117647058
noisy true:226
noisy false:322
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [45/200] batch [5/6] time 0.296 (0.281) data 0.248 (0.233) loss_x loss_x 0.4351 (0.3370) acc_x 90.6250 (91.2500) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 351
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 211
clean true:175
clean false:36
clean_rate:0.8293838862559242
noisy true:226
noisy false:315
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 541
epoch [46/200] batch [5/6] time 0.305 (0.317) data 0.257 (0.261) loss_x loss_x 0.3835 (0.4947) acc_x 93.7500 (88.7500) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 353
confident_label rate tensor(0.2726, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 205
clean true:171
clean false:34
clean_rate:0.8341463414634146
noisy true:228
noisy false:319
after delete: len(clean_dataset) 205
after delete: len(noisy_dataset) 547
epoch [47/200] batch [5/6] time 0.311 (0.314) data 0.265 (0.266) loss_x loss_x 0.3552 (0.3672) acc_x 90.6250 (90.0000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 350
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 208
clean true:173
clean false:35
clean_rate:0.8317307692307693
noisy true:229
noisy false:315
after delete: len(clean_dataset) 208
after delete: len(noisy_dataset) 544
epoch [48/200] batch [5/6] time 0.289 (0.315) data 0.241 (0.267) loss_x loss_x 0.5122 (0.3590) acc_x 84.3750 (93.7500) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 349
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:173
clean false:31
clean_rate:0.8480392156862745
noisy true:230
noisy false:318
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [49/200] batch [5/6] time 0.272 (0.315) data 0.222 (0.252) loss_x loss_x 0.3298 (0.3126) acc_x 93.7500 (90.6250) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.2926, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 220
clean true:186
clean false:34
clean_rate:0.8454545454545455
noisy true:236
noisy false:296
after delete: len(clean_dataset) 220
after delete: len(noisy_dataset) 532
epoch [50/200] batch [5/6] time 0.272 (0.280) data 0.225 (0.233) loss_x loss_x 0.5200 (0.3424) acc_x 81.2500 (91.2500) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 341
confident_label rate tensor(0.2806, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 211
clean true:178
clean false:33
clean_rate:0.8436018957345972
noisy true:233
noisy false:308
after delete: len(clean_dataset) 211
after delete: len(noisy_dataset) 541
epoch [51/200] batch [5/6] time 0.281 (0.259) data 0.233 (0.211) loss_x loss_x 0.2461 (0.2806) acc_x 93.7500 (93.1250) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 345
confident_label rate tensor(0.2846, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 214
clean true:181
clean false:33
clean_rate:0.8457943925233645
noisy true:226
noisy false:312
after delete: len(clean_dataset) 214
after delete: len(noisy_dataset) 538
epoch [52/200] batch [5/6] time 0.316 (0.312) data 0.266 (0.263) loss_x loss_x 0.4114 (0.3922) acc_x 87.5000 (90.0000) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 345
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 215
clean true:186
clean false:29
clean_rate:0.8651162790697674
noisy true:221
noisy false:316
after delete: len(clean_dataset) 215
after delete: len(noisy_dataset) 537
epoch [53/200] batch [5/6] time 0.323 (0.311) data 0.275 (0.263) loss_x loss_x 0.3882 (0.3072) acc_x 93.7500 (95.0000) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 352
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 212
clean true:178
clean false:34
clean_rate:0.839622641509434
noisy true:222
noisy false:318
after delete: len(clean_dataset) 212
after delete: len(noisy_dataset) 540
epoch [54/200] batch [5/6] time 0.340 (0.303) data 0.293 (0.256) loss_x loss_x 0.2411 (0.2589) acc_x 96.8750 (93.1250) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.2992, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 225
clean true:192
clean false:33
clean_rate:0.8533333333333334
noisy true:225
noisy false:302
after delete: len(clean_dataset) 225
after delete: len(noisy_dataset) 527
epoch [55/200] batch [5/7] time 0.307 (0.329) data 0.257 (0.267) loss_x loss_x 0.1896 (0.2621) acc_x 100.0000 (95.6250) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.2886, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 217
clean true:182
clean false:35
clean_rate:0.8387096774193549
noisy true:237
noisy false:298
after delete: len(clean_dataset) 217
after delete: len(noisy_dataset) 535
epoch [56/200] batch [5/6] time 0.373 (0.319) data 0.325 (0.272) loss_x loss_x 0.5400 (0.3109) acc_x 87.5000 (94.3750) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 339
confident_label rate tensor(0.2992, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 225
clean true:185
clean false:40
clean_rate:0.8222222222222222
noisy true:228
noisy false:299
after delete: len(clean_dataset) 225
after delete: len(noisy_dataset) 527
epoch [57/200] batch [5/7] time 0.356 (0.345) data 0.309 (0.298) loss_x loss_x 0.2910 (0.3033) acc_x 90.6250 (90.6250) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 342
confident_label rate tensor(0.2926, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 220
clean true:181
clean false:39
clean_rate:0.8227272727272728
noisy true:229
noisy false:303
after delete: len(clean_dataset) 220
after delete: len(noisy_dataset) 532
epoch [58/200] batch [5/6] time 0.289 (0.276) data 0.242 (0.228) loss_x loss_x 0.3774 (0.3122) acc_x 87.5000 (91.8750) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 215
clean true:181
clean false:34
clean_rate:0.8418604651162791
noisy true:236
noisy false:301
after delete: len(clean_dataset) 215
after delete: len(noisy_dataset) 537
epoch [59/200] batch [5/6] time 0.279 (0.298) data 0.232 (0.250) loss_x loss_x 0.2595 (0.2570) acc_x 93.7500 (92.5000) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 342
confident_label rate tensor(0.2965, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 223
clean true:184
clean false:39
clean_rate:0.8251121076233184
noisy true:226
noisy false:303
after delete: len(clean_dataset) 223
after delete: len(noisy_dataset) 529
epoch [60/200] batch [5/6] time 0.299 (0.308) data 0.251 (0.261) loss_x loss_x 0.3101 (0.3434) acc_x 90.6250 (91.2500) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 334
confident_label rate tensor(0.3138, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 236
clean true:195
clean false:41
clean_rate:0.826271186440678
noisy true:223
noisy false:293
after delete: len(clean_dataset) 236
after delete: len(noisy_dataset) 516
epoch [61/200] batch [5/7] time 0.258 (0.299) data 0.211 (0.243) loss_x loss_x 0.1957 (0.2095) acc_x 100.0000 (94.3750) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 338
confident_label rate tensor(0.2899, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 218
clean true:183
clean false:35
clean_rate:0.8394495412844036
noisy true:231
noisy false:303
after delete: len(clean_dataset) 218
after delete: len(noisy_dataset) 534
epoch [62/200] batch [5/6] time 0.292 (0.314) data 0.245 (0.266) loss_x loss_x 0.1664 (0.2210) acc_x 96.8750 (92.5000) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 343
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 229
clean true:190
clean false:39
clean_rate:0.8296943231441049
noisy true:219
noisy false:304
after delete: len(clean_dataset) 229
after delete: len(noisy_dataset) 523
epoch [63/200] batch [5/7] time 0.260 (0.292) data 0.212 (0.245) loss_x loss_x 0.3206 (0.2918) acc_x 96.8750 (94.3750) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 347
confident_label rate tensor(0.3005, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 226
clean true:184
clean false:42
clean_rate:0.8141592920353983
noisy true:221
noisy false:305
after delete: len(clean_dataset) 226
after delete: len(noisy_dataset) 526
epoch [64/200] batch [5/7] time 0.285 (0.297) data 0.238 (0.250) loss_x loss_x 0.3933 (0.3500) acc_x 90.6250 (90.6250) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 340
confident_label rate tensor(0.3085, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 232
clean true:193
clean false:39
clean_rate:0.8318965517241379
noisy true:219
noisy false:301
after delete: len(clean_dataset) 232
after delete: len(noisy_dataset) 520
epoch [65/200] batch [5/7] time 0.281 (0.272) data 0.231 (0.224) loss_x loss_x 0.2159 (0.2759) acc_x 96.8750 (95.0000) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3059, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 230
clean true:192
clean false:38
clean_rate:0.8347826086956521
noisy true:230
noisy false:292
after delete: len(clean_dataset) 230
after delete: len(noisy_dataset) 522
epoch [66/200] batch [5/7] time 0.247 (0.291) data 0.197 (0.243) loss_x loss_x 0.2097 (0.3167) acc_x 93.7500 (93.7500) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.2965, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 223
clean true:185
clean false:38
clean_rate:0.8295964125560538
noisy true:241
noisy false:288
after delete: len(clean_dataset) 223
after delete: len(noisy_dataset) 529
epoch [67/200] batch [5/6] time 0.267 (0.294) data 0.220 (0.247) loss_x loss_x 0.4453 (0.2826) acc_x 90.6250 (93.1250) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 329
confident_label rate tensor(0.3019, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 227
clean true:186
clean false:41
clean_rate:0.8193832599118943
noisy true:237
noisy false:288
after delete: len(clean_dataset) 227
after delete: len(noisy_dataset) 525
epoch [68/200] batch [5/7] time 0.354 (0.318) data 0.307 (0.270) loss_x loss_x 0.3342 (0.2774) acc_x 93.7500 (92.5000) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3032, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 228
clean true:188
clean false:40
clean_rate:0.8245614035087719
noisy true:234
noisy false:290
after delete: len(clean_dataset) 228
after delete: len(noisy_dataset) 524
epoch [69/200] batch [5/7] time 0.389 (0.338) data 0.342 (0.291) loss_x loss_x 0.3523 (0.2259) acc_x 90.6250 (95.0000) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.3138, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 236
clean true:196
clean false:40
clean_rate:0.8305084745762712
noisy true:223
noisy false:293
after delete: len(clean_dataset) 236
after delete: len(noisy_dataset) 516
epoch [70/200] batch [5/7] time 0.376 (0.322) data 0.329 (0.274) loss_x loss_x 0.2622 (0.2518) acc_x 96.8750 (95.0000) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 337
confident_label rate tensor(0.3165, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 238
clean true:196
clean false:42
clean_rate:0.8235294117647058
noisy true:219
noisy false:295
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 514
epoch [71/200] batch [5/7] time 0.296 (0.297) data 0.249 (0.250) loss_x loss_x 0.4355 (0.3314) acc_x 90.6250 (91.2500) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 348
confident_label rate tensor(0.3178, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 239
clean true:193
clean false:46
clean_rate:0.8075313807531381
noisy true:211
noisy false:302
after delete: len(clean_dataset) 239
after delete: len(noisy_dataset) 513
epoch [72/200] batch [5/7] time 0.303 (0.271) data 0.255 (0.223) loss_x loss_x 0.2764 (0.2655) acc_x 96.8750 (94.3750) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 342
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 241
clean true:195
clean false:46
clean_rate:0.8091286307053942
noisy true:215
noisy false:296
after delete: len(clean_dataset) 241
after delete: len(noisy_dataset) 511
epoch [73/200] batch [5/7] time 0.304 (0.302) data 0.257 (0.255) loss_x loss_x 0.1571 (0.2365) acc_x 100.0000 (95.0000) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 334
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 243
clean true:196
clean false:47
clean_rate:0.8065843621399177
noisy true:222
noisy false:287
after delete: len(clean_dataset) 243
after delete: len(noisy_dataset) 509
epoch [74/200] batch [5/7] time 0.289 (0.300) data 0.242 (0.252) loss_x loss_x 0.2634 (0.2995) acc_x 93.7500 (92.5000) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 328
confident_label rate tensor(0.3085, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 232
clean true:189
clean false:43
clean_rate:0.8146551724137931
noisy true:235
noisy false:285
after delete: len(clean_dataset) 232
after delete: len(noisy_dataset) 520
epoch [75/200] batch [5/7] time 0.261 (0.271) data 0.214 (0.223) loss_x loss_x 0.5317 (0.3975) acc_x 87.5000 (92.5000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.3258, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 245
clean true:198
clean false:47
clean_rate:0.8081632653061225
noisy true:228
noisy false:279
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 507
epoch [76/200] batch [5/7] time 0.257 (0.300) data 0.207 (0.238) loss_x loss_x 0.1216 (0.2103) acc_x 100.0000 (96.8750) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 341
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 242
clean true:195
clean false:47
clean_rate:0.8057851239669421
noisy true:216
noisy false:294
after delete: len(clean_dataset) 242
after delete: len(noisy_dataset) 510
epoch [77/200] batch [5/7] time 0.349 (0.328) data 0.301 (0.267) loss_x loss_x 0.2842 (0.3306) acc_x 93.7500 (91.8750) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 338
confident_label rate tensor(0.3271, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 246
clean true:200
clean false:46
clean_rate:0.8130081300813008
noisy true:214
noisy false:292
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 506
epoch [78/200] batch [5/7] time 0.297 (0.309) data 0.250 (0.262) loss_x loss_x 0.4177 (0.3096) acc_x 90.6250 (92.5000) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 345
confident_label rate tensor(0.3178, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 239
clean true:195
clean false:44
clean_rate:0.8158995815899581
noisy true:212
noisy false:301
after delete: len(clean_dataset) 239
after delete: len(noisy_dataset) 513
epoch [79/200] batch [5/7] time 0.233 (0.299) data 0.185 (0.251) loss_x loss_x 0.2742 (0.2455) acc_x 96.8750 (93.1250) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 331
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 242
clean true:192
clean false:50
clean_rate:0.7933884297520661
noisy true:229
noisy false:281
after delete: len(clean_dataset) 242
after delete: len(noisy_dataset) 510
epoch [80/200] batch [5/7] time 0.296 (0.293) data 0.249 (0.246) loss_x loss_x 0.1120 (0.1675) acc_x 100.0000 (96.8750) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3271, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 246
clean true:195
clean false:51
clean_rate:0.7926829268292683
noisy true:227
noisy false:279
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 506
epoch [81/200] batch [5/7] time 0.335 (0.329) data 0.287 (0.268) loss_x loss_x 0.6616 (0.3551) acc_x 96.8750 (96.2500) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 342
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:197
clean false:57
clean_rate:0.7755905511811023
noisy true:213
noisy false:285
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [82/200] batch [5/7] time 0.276 (0.299) data 0.229 (0.252) loss_x loss_x 0.4104 (0.2547) acc_x 93.7500 (93.7500) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 344
confident_label rate tensor(0.3338, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 251
clean true:199
clean false:52
clean_rate:0.7928286852589641
noisy true:209
noisy false:292
after delete: len(clean_dataset) 251
after delete: len(noisy_dataset) 501
epoch [83/200] batch [5/7] time 0.277 (0.303) data 0.230 (0.255) loss_x loss_x 0.1479 (0.1701) acc_x 100.0000 (96.2500) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 340
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 241
clean true:192
clean false:49
clean_rate:0.7966804979253111
noisy true:220
noisy false:291
after delete: len(clean_dataset) 241
after delete: len(noisy_dataset) 511
epoch [84/200] batch [5/7] time 0.320 (0.299) data 0.272 (0.252) loss_x loss_x 0.1218 (0.2621) acc_x 100.0000 (95.6250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 339
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 252
clean true:200
clean false:52
clean_rate:0.7936507936507936
noisy true:213
noisy false:287
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 500
epoch [85/200] batch [5/7] time 0.293 (0.295) data 0.246 (0.248) loss_x loss_x 0.4011 (0.3259) acc_x 90.6250 (90.0000) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 334
confident_label rate tensor(0.3338, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 251
clean true:199
clean false:52
clean_rate:0.7928286852589641
noisy true:219
noisy false:282
after delete: len(clean_dataset) 251
after delete: len(noisy_dataset) 501
epoch [86/200] batch [5/7] time 0.280 (0.296) data 0.233 (0.249) loss_x loss_x 0.1427 (0.3942) acc_x 96.8750 (92.5000) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 324
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:196
clean false:54
clean_rate:0.784
noisy true:232
noisy false:270
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [87/200] batch [5/7] time 0.350 (0.315) data 0.303 (0.268) loss_x loss_x 0.2471 (0.2799) acc_x 96.8750 (95.6250) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3271, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 246
clean true:192
clean false:54
clean_rate:0.7804878048780488
noisy true:230
noisy false:276
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 506
epoch [88/200] batch [5/7] time 0.300 (0.302) data 0.254 (0.254) loss_x loss_x 0.1032 (0.2141) acc_x 96.8750 (95.0000) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:200
clean false:54
clean_rate:0.7874015748031497
noisy true:222
noisy false:276
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [89/200] batch [5/7] time 0.271 (0.309) data 0.224 (0.262) loss_x loss_x 0.1127 (0.2647) acc_x 100.0000 (95.0000) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 334
confident_label rate tensor(0.3338, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 251
clean true:197
clean false:54
clean_rate:0.7848605577689243
noisy true:221
noisy false:280
after delete: len(clean_dataset) 251
after delete: len(noisy_dataset) 501
epoch [90/200] batch [5/7] time 0.267 (0.293) data 0.217 (0.244) loss_x loss_x 0.3396 (0.2445) acc_x 90.6250 (95.0000) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 350
confident_label rate tensor(0.3338, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 251
clean true:197
clean false:54
clean_rate:0.7848605577689243
noisy true:205
noisy false:296
after delete: len(clean_dataset) 251
after delete: len(noisy_dataset) 501
epoch [91/200] batch [5/7] time 0.306 (0.316) data 0.259 (0.268) loss_x loss_x 0.5190 (0.3127) acc_x 84.3750 (91.8750) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 339
confident_label rate tensor(0.3285, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 247
clean true:197
clean false:50
clean_rate:0.7975708502024291
noisy true:216
noisy false:289
after delete: len(clean_dataset) 247
after delete: len(noisy_dataset) 505
epoch [92/200] batch [5/7] time 0.291 (0.313) data 0.244 (0.266) loss_x loss_x 0.2325 (0.1745) acc_x 93.7500 (96.2500) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 341
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 248
clean true:197
clean false:51
clean_rate:0.7943548387096774
noisy true:214
noisy false:290
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 504
epoch [93/200] batch [5/7] time 0.310 (0.306) data 0.264 (0.258) loss_x loss_x 0.3296 (0.2259) acc_x 90.6250 (93.7500) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 337
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:200
clean false:54
clean_rate:0.7874015748031497
noisy true:215
noisy false:283
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [94/200] batch [5/7] time 0.287 (0.300) data 0.240 (0.243) loss_x loss_x 0.2117 (0.1672) acc_x 96.8750 (97.5000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 338
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 252
clean true:200
clean false:52
clean_rate:0.7936507936507936
noisy true:214
noisy false:286
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 500
epoch [95/200] batch [5/7] time 0.297 (0.272) data 0.250 (0.224) loss_x loss_x 0.2235 (0.2334) acc_x 93.7500 (93.7500) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 323
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 264
clean true:207
clean false:57
clean_rate:0.7840909090909091
noisy true:222
noisy false:266
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 488
epoch [96/200] batch [5/8] time 0.228 (0.277) data 0.179 (0.228) loss_x loss_x 0.5137 (0.2908) acc_x 84.3750 (92.5000) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 331
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:201
clean false:53
clean_rate:0.7913385826771654
noisy true:220
noisy false:278
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [97/200] batch [5/7] time 0.246 (0.283) data 0.199 (0.236) loss_x loss_x 0.1526 (0.1902) acc_x 96.8750 (96.8750) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 260
clean true:203
clean false:57
clean_rate:0.7807692307692308
noisy true:223
noisy false:269
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 492
epoch [98/200] batch [5/8] time 0.336 (0.311) data 0.287 (0.263) loss_x loss_x 0.2045 (0.2493) acc_x 96.8750 (93.1250) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 345
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:198
clean false:60
clean_rate:0.7674418604651163
noisy true:209
noisy false:285
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [99/200] batch [5/8] time 0.304 (0.292) data 0.257 (0.245) loss_x loss_x 0.2576 (0.2591) acc_x 90.6250 (94.3750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 318
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:206
clean false:53
clean_rate:0.7953667953667953
noisy true:228
noisy false:265
all clean rate:  [0.8285714285714286, 0.8870967741935484, 0.922077922077922, 0.9361702127659575, 0.9270833333333334, 0.9090909090909091, 0.9680851063829787, 0.9537037037037037, 0.9363636363636364, 0.9310344827586207, 0.9224806201550387, 0.9193548387096774, 0.9259259259259259, 0.9302325581395349, 0.9224806201550387, 0.9185185185185185, 0.9041095890410958, 0.9025974025974026, 0.8940397350993378, 0.9150326797385621, 0.9006211180124224, 0.891566265060241, 0.8707865168539326, 0.8690476190476191, 0.8666666666666667, 0.8563218390804598, 0.8554913294797688, 0.8435754189944135, 0.8626373626373627, 0.8397790055248618, 0.8524590163934426, 0.8469945355191257, 0.8609625668449198, 0.8031914893617021, 0.8272251308900523, 0.8360655737704918, 0.824468085106383, 0.8359788359788359, 0.8497409326424871, 0.8267326732673267, 0.8391959798994975, 0.8067632850241546, 0.8095238095238095, 0.8599033816425121, 0.8235294117647058, 0.8293838862559242, 0.8341463414634146, 0.8317307692307693, 0.8480392156862745, 0.8454545454545455, 0.8436018957345972, 0.8457943925233645, 0.8651162790697674, 0.839622641509434, 0.8533333333333334, 0.8387096774193549, 0.8222222222222222, 0.8227272727272728, 0.8418604651162791, 0.8251121076233184, 0.826271186440678, 0.8394495412844036, 0.8296943231441049, 0.8141592920353983, 0.8318965517241379, 0.8347826086956521, 0.8295964125560538, 0.8193832599118943, 0.8245614035087719, 0.8305084745762712, 0.8235294117647058, 0.8075313807531381, 0.8091286307053942, 0.8065843621399177, 0.8146551724137931, 0.8081632653061225, 0.8057851239669421, 0.8130081300813008, 0.8158995815899581, 0.7933884297520661, 0.7926829268292683, 0.7755905511811023, 0.7928286852589641, 0.7966804979253111, 0.7936507936507936, 0.7928286852589641, 0.784, 0.7804878048780488, 0.7874015748031497, 0.7848605577689243, 0.7848605577689243, 0.7975708502024291, 0.7943548387096774, 0.7874015748031497, 0.7936507936507936, 0.7840909090909091, 0.7913385826771654, 0.7807692307692308, 0.7674418604651163, 0.7953667953667953]
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [100/200] batch [5/8] time 0.277 (0.290) data 0.230 (0.242) loss_x loss_x 0.1522 (0.1575) acc_x 96.8750 (97.5000) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 332
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:198
clean false:56
clean_rate:0.7795275590551181
noisy true:222
noisy false:276
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [101/200] batch [5/7] time 0.288 (0.301) data 0.240 (0.254) loss_x loss_x 0.2720 (0.3027) acc_x 96.8750 (94.3750) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 264
clean true:205
clean false:59
clean_rate:0.7765151515151515
noisy true:214
noisy false:274
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 488
epoch [102/200] batch [5/8] time 0.282 (0.316) data 0.235 (0.269) loss_x loss_x 0.3438 (0.3476) acc_x 90.6250 (91.2500) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 332
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:201
clean false:58
clean_rate:0.7760617760617761
noisy true:219
noisy false:274
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [103/200] batch [5/8] time 0.285 (0.301) data 0.238 (0.254) loss_x loss_x 0.1747 (0.2460) acc_x 93.7500 (95.0000) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 339
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 255
clean true:197
clean false:58
clean_rate:0.7725490196078432
noisy true:216
noisy false:281
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 497
epoch [104/200] batch [5/7] time 0.287 (0.309) data 0.240 (0.248) loss_x loss_x 0.1709 (0.2056) acc_x 96.8750 (96.8750) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 338
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:203
clean false:60
clean_rate:0.7718631178707225
noisy true:211
noisy false:278
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [105/200] batch [5/8] time 0.318 (0.338) data 0.271 (0.291) loss_x loss_x 0.1779 (0.2281) acc_x 93.7500 (94.3750) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:201
clean false:62
clean_rate:0.7642585551330798
noisy true:221
noisy false:268
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [106/200] batch [5/8] time 0.319 (0.313) data 0.271 (0.266) loss_x loss_x 0.1188 (0.2121) acc_x 100.0000 (95.0000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 345
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 264
clean true:203
clean false:61
clean_rate:0.7689393939393939
noisy true:204
noisy false:284
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 488
epoch [107/200] batch [5/8] time 0.295 (0.310) data 0.248 (0.263) loss_x loss_x 0.1276 (0.3002) acc_x 100.0000 (95.0000) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 342
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:200
clean false:63
clean_rate:0.7604562737642585
noisy true:210
noisy false:279
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [108/200] batch [5/8] time 0.267 (0.305) data 0.220 (0.258) loss_x loss_x 0.1945 (0.2108) acc_x 90.6250 (95.0000) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 345
confident_label rate tensor(0.3471, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 261
clean true:202
clean false:59
clean_rate:0.7739463601532567
noisy true:205
noisy false:286
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 491
epoch [109/200] batch [5/8] time 0.318 (0.287) data 0.268 (0.239) loss_x loss_x 0.4768 (0.1954) acc_x 96.8750 (98.7500) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 342
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 260
clean true:201
clean false:59
clean_rate:0.7730769230769231
noisy true:209
noisy false:283
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 492
epoch [110/200] batch [5/8] time 0.289 (0.309) data 0.242 (0.262) loss_x loss_x 0.2625 (0.1731) acc_x 90.6250 (95.6250) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 343
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:203
clean false:65
clean_rate:0.7574626865671642
noisy true:206
noisy false:278
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [111/200] batch [5/8] time 0.309 (0.326) data 0.261 (0.264) loss_x loss_x 0.3215 (0.1498) acc_x 84.3750 (95.6250) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 337
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:196
clean false:61
clean_rate:0.7626459143968871
noisy true:219
noisy false:276
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [112/200] batch [5/8] time 0.320 (0.307) data 0.273 (0.260) loss_x loss_x 0.2389 (0.2069) acc_x 96.8750 (96.2500) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 352
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 264
clean true:201
clean false:63
clean_rate:0.7613636363636364
noisy true:199
noisy false:289
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 488
epoch [113/200] batch [5/8] time 0.280 (0.284) data 0.234 (0.236) loss_x loss_x 0.1206 (0.2213) acc_x 100.0000 (96.2500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 353
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:198
clean false:60
clean_rate:0.7674418604651163
noisy true:201
noisy false:293
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [114/200] batch [5/8] time 0.310 (0.329) data 0.262 (0.281) loss_x loss_x 0.2367 (0.1564) acc_x 90.6250 (93.7500) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 336
confident_label rate tensor(0.3524, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 265
clean true:203
clean false:62
clean_rate:0.7660377358490567
noisy true:213
noisy false:274
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 487
epoch [115/200] batch [5/8] time 0.348 (0.316) data 0.301 (0.269) loss_x loss_x 0.1323 (0.2283) acc_x 96.8750 (94.3750) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 260
clean true:203
clean false:57
clean_rate:0.7807692307692308
noisy true:219
noisy false:273
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 492
epoch [116/200] batch [5/8] time 0.332 (0.325) data 0.285 (0.274) loss_x loss_x 0.2300 (0.1560) acc_x 93.7500 (96.8750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 264
clean true:204
clean false:60
clean_rate:0.7727272727272727
noisy true:213
noisy false:275
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 488
epoch [117/200] batch [5/8] time 0.250 (0.309) data 0.202 (0.247) loss_x loss_x 0.1322 (0.1975) acc_x 96.8750 (95.0000) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 341
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 264
clean true:204
clean false:60
clean_rate:0.7727272727272727
noisy true:207
noisy false:281
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 488
epoch [118/200] batch [5/8] time 0.289 (0.311) data 0.242 (0.264) loss_x loss_x 0.1456 (0.2384) acc_x 96.8750 (94.3750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 338
confident_label rate tensor(0.3590, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 270
clean true:207
clean false:63
clean_rate:0.7666666666666667
noisy true:207
noisy false:275
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 482
epoch [119/200] batch [5/8] time 0.302 (0.295) data 0.255 (0.248) loss_x loss_x 0.4006 (0.2330) acc_x 87.5000 (93.7500) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 260
clean true:198
clean false:62
clean_rate:0.7615384615384615
noisy true:219
noisy false:273
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 492
epoch [120/200] batch [5/8] time 0.304 (0.307) data 0.257 (0.259) loss_x loss_x 0.2100 (0.1799) acc_x 93.7500 (96.8750) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 264
clean true:202
clean false:62
clean_rate:0.7651515151515151
noisy true:220
noisy false:268
after delete: len(clean_dataset) 264
after delete: len(noisy_dataset) 488
epoch [121/200] batch [5/8] time 0.317 (0.306) data 0.269 (0.258) loss_x loss_x 0.1212 (0.1841) acc_x 96.8750 (96.8750) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 332
confident_label rate tensor(0.3524, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 265
clean true:202
clean false:63
clean_rate:0.7622641509433963
noisy true:218
noisy false:269
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 487
epoch [122/200] batch [5/8] time 0.340 (0.337) data 0.293 (0.288) loss_x loss_x 0.3677 (0.1851) acc_x 87.5000 (95.0000) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:206
clean false:62
clean_rate:0.7686567164179104
noisy true:211
noisy false:273
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [123/200] batch [5/8] time 0.394 (0.341) data 0.346 (0.294) loss_x loss_x 0.1187 (0.1417) acc_x 96.8750 (96.8750) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 337
confident_label rate tensor(0.3604, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 271
clean true:208
clean false:63
clean_rate:0.7675276752767528
noisy true:207
noisy false:274
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 481
epoch [124/200] batch [5/8] time 0.335 (0.314) data 0.287 (0.266) loss_x loss_x 0.2573 (0.1690) acc_x 93.7500 (96.8750) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 340
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:203
clean false:60
clean_rate:0.7718631178707225
noisy true:209
noisy false:280
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [125/200] batch [5/8] time 0.289 (0.304) data 0.242 (0.257) loss_x loss_x 0.1852 (0.2459) acc_x 96.8750 (96.2500) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 322
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:209
clean false:66
clean_rate:0.76
noisy true:221
noisy false:256
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [126/200] batch [5/8] time 0.274 (0.305) data 0.225 (0.257) loss_x loss_x 0.1064 (0.1848) acc_x 96.8750 (95.6250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 328
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:206
clean false:67
clean_rate:0.7545787545787546
noisy true:218
noisy false:261
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [127/200] batch [5/8] time 0.290 (0.299) data 0.243 (0.251) loss_x loss_x 0.1854 (0.1527) acc_x 96.8750 (98.1250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 328
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:204
clean false:64
clean_rate:0.7611940298507462
noisy true:220
noisy false:264
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [128/200] batch [5/8] time 0.320 (0.320) data 0.272 (0.273) loss_x loss_x 0.0933 (0.1160) acc_x 100.0000 (99.3750) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:198
clean false:61
clean_rate:0.7644787644787645
noisy true:219
noisy false:274
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [129/200] batch [5/8] time 0.347 (0.304) data 0.299 (0.256) loss_x loss_x 0.1024 (0.1428) acc_x 96.8750 (96.8750) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 342
confident_label rate tensor(0.3524, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 265
clean true:202
clean false:63
clean_rate:0.7622641509433963
noisy true:208
noisy false:279
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 487
epoch [130/200] batch [5/8] time 0.340 (0.319) data 0.292 (0.271) loss_x loss_x 0.0672 (0.1105) acc_x 100.0000 (98.1250) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 328
confident_label rate tensor(0.3537, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 266
clean true:205
clean false:61
clean_rate:0.7706766917293233
noisy true:219
noisy false:267
after delete: len(clean_dataset) 266
after delete: len(noisy_dataset) 486
epoch [131/200] batch [5/8] time 0.311 (0.306) data 0.263 (0.253) loss_x loss_x 0.0980 (0.1296) acc_x 100.0000 (98.7500) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 325
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:209
clean false:68
clean_rate:0.7545126353790613
noisy true:218
noisy false:257
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [132/200] batch [5/8] time 0.328 (0.298) data 0.281 (0.251) loss_x loss_x 0.1742 (0.1953) acc_x 96.8750 (96.2500) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.3617, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 272
clean true:211
clean false:61
clean_rate:0.7757352941176471
noisy true:208
noisy false:272
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 480
epoch [133/200] batch [5/8] time 0.327 (0.294) data 0.280 (0.239) loss_x loss_x 0.1403 (0.1284) acc_x 100.0000 (98.1250) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 337
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 274
clean true:207
clean false:67
clean_rate:0.7554744525547445
noisy true:208
noisy false:270
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 478
epoch [134/200] batch [5/8] time 0.249 (0.272) data 0.201 (0.225) loss_x loss_x 0.0658 (0.1313) acc_x 100.0000 (96.2500) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 322
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 274
clean true:206
clean false:68
clean_rate:0.7518248175182481
noisy true:224
noisy false:254
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 478
epoch [135/200] batch [5/8] time 0.329 (0.342) data 0.281 (0.280) loss_x loss_x 0.2251 (0.1788) acc_x 96.8750 (96.8750) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 339
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:204
clean false:64
clean_rate:0.7611940298507462
noisy true:209
noisy false:275
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [136/200] batch [5/8] time 0.279 (0.315) data 0.232 (0.268) loss_x loss_x 0.1576 (0.1208) acc_x 96.8750 (98.7500) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 319
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 274
clean true:212
clean false:62
clean_rate:0.7737226277372263
noisy true:221
noisy false:257
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 478
epoch [137/200] batch [5/8] time 0.288 (0.322) data 0.239 (0.274) loss_x loss_x 0.0467 (0.1549) acc_x 100.0000 (95.6250) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 325
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 274
clean true:208
clean false:66
clean_rate:0.7591240875912408
noisy true:219
noisy false:259
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 478
epoch [138/200] batch [5/8] time 0.291 (0.322) data 0.244 (0.261) loss_x loss_x 0.2556 (0.2450) acc_x 90.6250 (94.3750) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 341
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:203
clean false:65
clean_rate:0.7574626865671642
noisy true:208
noisy false:276
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [139/200] batch [5/8] time 0.284 (0.286) data 0.237 (0.239) loss_x loss_x 0.2249 (0.2120) acc_x 87.5000 (95.0000) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 346
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:203
clean false:65
clean_rate:0.7574626865671642
noisy true:203
noisy false:281
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [140/200] batch [5/8] time 0.317 (0.315) data 0.232 (0.260) loss_x loss_x 0.0695 (0.1677) acc_x 100.0000 (96.2500) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:211
clean false:64
clean_rate:0.7672727272727272
noisy true:208
noisy false:269
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [141/200] batch [5/8] time 0.284 (0.302) data 0.237 (0.255) loss_x loss_x 0.1764 (0.2573) acc_x 93.7500 (95.6250) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 337
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:210
clean false:66
clean_rate:0.7608695652173914
noisy true:205
noisy false:271
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [142/200] batch [5/8] time 0.311 (0.318) data 0.263 (0.270) loss_x loss_x 0.0972 (0.3031) acc_x 100.0000 (92.5000) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 319
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:209
clean false:67
clean_rate:0.7572463768115942
noisy true:224
noisy false:252
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [143/200] batch [5/8] time 0.324 (0.329) data 0.277 (0.282) loss_x loss_x 0.1913 (0.2111) acc_x 100.0000 (96.8750) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:211
clean false:62
clean_rate:0.7728937728937729
noisy true:215
noisy false:264
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [144/200] batch [5/8] time 0.319 (0.325) data 0.272 (0.277) loss_x loss_x 0.1595 (0.1846) acc_x 96.8750 (96.8750) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 322
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:200
clean false:63
clean_rate:0.7604562737642585
noisy true:230
noisy false:259
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [145/200] batch [5/8] time 0.333 (0.307) data 0.286 (0.260) loss_x loss_x 0.1006 (0.1690) acc_x 100.0000 (95.6250) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 325
confident_label rate tensor(0.3590, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 270
clean true:207
clean false:63
clean_rate:0.7666666666666667
noisy true:220
noisy false:262
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 482
epoch [146/200] batch [5/8] time 0.325 (0.317) data 0.233 (0.261) loss_x loss_x 0.1278 (0.2196) acc_x 96.8750 (93.7500) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:202
clean false:66
clean_rate:0.753731343283582
noisy true:215
noisy false:269
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [147/200] batch [5/8] time 0.297 (0.323) data 0.249 (0.261) loss_x loss_x 0.1021 (0.2105) acc_x 100.0000 (95.0000) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 338
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:205
clean false:63
clean_rate:0.7649253731343284
noisy true:209
noisy false:275
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [148/200] batch [5/8] time 0.300 (0.298) data 0.252 (0.251) loss_x loss_x 0.1389 (0.2167) acc_x 96.8750 (95.6250) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 327
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:208
clean false:65
clean_rate:0.7619047619047619
noisy true:217
noisy false:262
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [149/200] batch [5/8] time 0.305 (0.326) data 0.258 (0.279) loss_x loss_x 0.2908 (0.1398) acc_x 93.7500 (98.1250) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 337
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:209
clean false:67
clean_rate:0.7572463768115942
noisy true:206
noisy false:270
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [150/200] batch [5/8] time 0.320 (0.335) data 0.271 (0.287) loss_x loss_x 0.0659 (0.2008) acc_x 100.0000 (96.2500) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 329
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:213
clean false:64
clean_rate:0.7689530685920578
noisy true:210
noisy false:265
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [151/200] batch [5/8] time 0.287 (0.305) data 0.239 (0.257) loss_x loss_x 0.1879 (0.2495) acc_x 96.8750 (94.3750) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:206
clean false:69
clean_rate:0.7490909090909091
noisy true:216
noisy false:261
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [152/200] batch [5/8] time 0.322 (0.294) data 0.275 (0.246) loss_x loss_x 0.1041 (0.3099) acc_x 100.0000 (95.6250) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 340
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:207
clean false:66
clean_rate:0.7582417582417582
noisy true:205
noisy false:274
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [153/200] batch [5/8] time 0.295 (0.308) data 0.248 (0.261) loss_x loss_x 0.2803 (0.1620) acc_x 93.7500 (96.8750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 323
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:206
clean false:67
clean_rate:0.7545787545787546
noisy true:223
noisy false:256
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [154/200] batch [5/8] time 0.315 (0.309) data 0.268 (0.262) loss_x loss_x 0.0656 (0.1259) acc_x 100.0000 (97.5000) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 331
confident_label rate tensor(0.3697, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 278
clean true:212
clean false:66
clean_rate:0.762589928057554
noisy true:209
noisy false:265
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 474
epoch [155/200] batch [5/8] time 0.274 (0.306) data 0.226 (0.259) loss_x loss_x 0.1162 (0.1519) acc_x 96.8750 (97.5000) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3604, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 271
clean true:205
clean false:66
clean_rate:0.7564575645756457
noisy true:212
noisy false:269
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 481
epoch [156/200] batch [5/8] time 0.270 (0.287) data 0.223 (0.240) loss_x loss_x 0.2209 (0.1607) acc_x 93.7500 (96.8750) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3590, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 270
clean true:207
clean false:63
clean_rate:0.7666666666666667
noisy true:210
noisy false:272
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 482
epoch [157/200] batch [5/8] time 0.291 (0.300) data 0.244 (0.253) loss_x loss_x 0.0958 (0.0961) acc_x 100.0000 (100.0000) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:209
clean false:64
clean_rate:0.7655677655677655
noisy true:213
noisy false:266
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [158/200] batch [5/8] time 0.283 (0.306) data 0.236 (0.257) loss_x loss_x 0.1624 (0.1861) acc_x 96.8750 (95.0000) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 336
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:204
clean false:69
clean_rate:0.7472527472527473
noisy true:212
noisy false:267
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [159/200] batch [5/8] time 0.239 (0.298) data 0.191 (0.243) loss_x loss_x 0.1428 (0.1203) acc_x 96.8750 (98.7500) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.3604, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 271
clean true:206
clean false:65
clean_rate:0.7601476014760148
noisy true:220
noisy false:261
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 481
epoch [160/200] batch [5/8] time 0.343 (0.318) data 0.296 (0.271) loss_x loss_x 0.1324 (0.1611) acc_x 96.8750 (96.2500) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 324
confident_label rate tensor(0.3617, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 272
clean true:207
clean false:65
clean_rate:0.7610294117647058
noisy true:221
noisy false:259
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 480
epoch [161/200] batch [5/8] time 0.262 (0.294) data 0.216 (0.247) loss_x loss_x 0.1306 (0.1344) acc_x 96.8750 (97.5000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 329
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:209
clean false:68
clean_rate:0.7545126353790613
noisy true:214
noisy false:261
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [162/200] batch [5/8] time 0.323 (0.310) data 0.275 (0.262) loss_x loss_x 0.5005 (0.2242) acc_x 93.7500 (96.2500) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 323
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:208
clean false:67
clean_rate:0.7563636363636363
noisy true:221
noisy false:256
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [163/200] batch [5/8] time 0.303 (0.322) data 0.255 (0.274) loss_x loss_x 0.2278 (0.1299) acc_x 96.8750 (97.5000) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3577, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 269
clean true:203
clean false:66
clean_rate:0.7546468401486989
noisy true:214
noisy false:269
after delete: len(clean_dataset) 269
after delete: len(noisy_dataset) 483
epoch [164/200] batch [5/8] time 0.296 (0.327) data 0.249 (0.279) loss_x loss_x 0.2085 (0.1327) acc_x 93.7500 (97.5000) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 336
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 268
clean true:206
clean false:62
clean_rate:0.7686567164179104
noisy true:210
noisy false:274
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 484
epoch [165/200] batch [5/8] time 0.303 (0.323) data 0.256 (0.275) loss_x loss_x 0.0876 (0.1219) acc_x 100.0000 (98.1250) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 321
confident_label rate tensor(0.3617, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 272
clean true:211
clean false:61
clean_rate:0.7757352941176471
noisy true:220
noisy false:260
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 480
epoch [166/200] batch [5/8] time 0.307 (0.334) data 0.257 (0.287) loss_x loss_x 0.1309 (0.1336) acc_x 96.8750 (97.5000) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 334
confident_label rate tensor(0.3590, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 270
clean true:205
clean false:65
clean_rate:0.7592592592592593
noisy true:213
noisy false:269
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 482
epoch [167/200] batch [5/8] time 0.349 (0.332) data 0.302 (0.285) loss_x loss_x 0.1663 (0.1238) acc_x 96.8750 (97.5000) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.3697, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 278
clean true:214
clean false:64
clean_rate:0.7697841726618705
noisy true:212
noisy false:262
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 474
epoch [168/200] batch [5/8] time 0.277 (0.302) data 0.229 (0.255) loss_x loss_x 0.2019 (0.1123) acc_x 96.8750 (98.7500) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 342
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:204
clean false:71
clean_rate:0.7418181818181818
noisy true:206
noisy false:271
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [169/200] batch [5/8] time 0.330 (0.328) data 0.282 (0.281) loss_x loss_x 0.2571 (0.1264) acc_x 96.8750 (98.7500) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 325
confident_label rate tensor(0.3697, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 278
clean true:211
clean false:67
clean_rate:0.7589928057553957
noisy true:216
noisy false:258
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 474
epoch [170/200] batch [5/8] time 0.345 (0.323) data 0.298 (0.276) loss_x loss_x 0.1799 (0.1318) acc_x 96.8750 (96.8750) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 338
confident_label rate tensor(0.3697, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 278
clean true:209
clean false:69
clean_rate:0.7517985611510791
noisy true:205
noisy false:269
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 474
epoch [171/200] batch [5/8] time 0.308 (0.325) data 0.260 (0.277) loss_x loss_x 0.0901 (0.1132) acc_x 100.0000 (99.3750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 331
confident_label rate tensor(0.3710, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 279
clean true:210
clean false:69
clean_rate:0.7526881720430108
noisy true:211
noisy false:262
after delete: len(clean_dataset) 279
after delete: len(noisy_dataset) 473
epoch [172/200] batch [5/8] time 0.283 (0.300) data 0.235 (0.237) loss_x loss_x 0.1036 (0.2181) acc_x 100.0000 (98.1250) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 323
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:212
clean false:65
clean_rate:0.7653429602888087
noisy true:217
noisy false:258
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [173/200] batch [5/8] time 0.296 (0.258) data 0.249 (0.210) loss_x loss_x 0.1503 (0.1175) acc_x 93.7500 (96.8750) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 331
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:208
clean false:68
clean_rate:0.7536231884057971
noisy true:213
noisy false:263
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [174/200] batch [5/8] time 0.266 (0.305) data 0.218 (0.257) loss_x loss_x 0.3210 (0.2392) acc_x 90.6250 (93.7500) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 332
confident_label rate tensor(0.3697, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 278
clean true:206
clean false:72
clean_rate:0.7410071942446043
noisy true:214
noisy false:260
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 474
epoch [175/200] batch [5/8] time 0.299 (0.303) data 0.251 (0.254) loss_x loss_x 0.0961 (0.1939) acc_x 100.0000 (98.1250) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 327
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:209
clean false:64
clean_rate:0.7655677655677655
noisy true:216
noisy false:263
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [176/200] batch [5/8] time 0.322 (0.317) data 0.274 (0.270) loss_x loss_x 0.0721 (0.1371) acc_x 100.0000 (97.5000) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3630, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 273
clean true:204
clean false:69
clean_rate:0.7472527472527473
noisy true:213
noisy false:266
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 479
epoch [177/200] batch [5/8] time 0.333 (0.320) data 0.285 (0.272) loss_x loss_x 0.0685 (0.1196) acc_x 100.0000 (98.7500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 334
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:208
clean false:69
clean_rate:0.7509025270758123
noisy true:210
noisy false:265
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [178/200] batch [5/8] time 0.250 (0.265) data 0.202 (0.217) loss_x loss_x 0.0982 (0.1935) acc_x 100.0000 (94.3750) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3644, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 274
clean true:209
clean false:65
clean_rate:0.7627737226277372
noisy true:213
noisy false:265
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 478
epoch [179/200] batch [5/8] time 0.272 (0.330) data 0.224 (0.282) loss_x loss_x 0.1371 (0.1124) acc_x 96.8750 (98.1250) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 328
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:207
clean false:70
clean_rate:0.7472924187725631
noisy true:217
noisy false:258
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [180/200] batch [5/8] time 0.301 (0.310) data 0.251 (0.262) loss_x loss_x 0.1730 (0.1091) acc_x 96.8750 (99.3750) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 338
confident_label rate tensor(0.3684, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 277
clean true:208
clean false:69
clean_rate:0.7509025270758123
noisy true:206
noisy false:269
after delete: len(clean_dataset) 277
after delete: len(noisy_dataset) 475
epoch [181/200] batch [5/8] time 0.329 (0.305) data 0.282 (0.256) loss_x loss_x 0.2480 (0.1560) acc_x 90.6250 (96.2500) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 319
confident_label rate tensor(0.3737, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 281
clean true:210
clean false:71
clean_rate:0.7473309608540926
noisy true:223
noisy false:248
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 471
epoch [182/200] batch [5/8] time 0.334 (0.313) data 0.287 (0.265) loss_x loss_x 0.2024 (0.1828) acc_x 96.8750 (93.7500) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3737, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 281
clean true:213
clean false:68
clean_rate:0.7580071174377224
noisy true:209
noisy false:262
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 471
epoch [183/200] batch [5/8] time 0.359 (0.309) data 0.239 (0.247) loss_x loss_x 0.0781 (0.1541) acc_x 100.0000 (95.6250) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 337
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:208
clean false:67
clean_rate:0.7563636363636363
noisy true:207
noisy false:270
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [184/200] batch [5/8] time 0.275 (0.317) data 0.228 (0.258) loss_x loss_x 0.1285 (0.2301) acc_x 100.0000 (95.6250) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 341
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:209
clean false:66
clean_rate:0.76
noisy true:202
noisy false:275
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [185/200] batch [5/8] time 0.249 (0.289) data 0.202 (0.241) loss_x loss_x 0.1409 (0.1577) acc_x 96.8750 (95.6250) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 282
clean true:213
clean false:69
clean_rate:0.7553191489361702
noisy true:206
noisy false:264
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 470
epoch [186/200] batch [5/8] time 0.320 (0.331) data 0.273 (0.270) loss_x loss_x 0.2079 (0.1337) acc_x 93.7500 (97.5000) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 331
confident_label rate tensor(0.3710, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 279
clean true:211
clean false:68
clean_rate:0.7562724014336918
noisy true:210
noisy false:263
after delete: len(clean_dataset) 279
after delete: len(noisy_dataset) 473
epoch [187/200] batch [5/8] time 0.317 (0.316) data 0.269 (0.269) loss_x loss_x 0.2007 (0.1990) acc_x 96.8750 (96.2500) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 329
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:208
clean false:68
clean_rate:0.7536231884057971
noisy true:215
noisy false:261
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [188/200] batch [5/8] time 0.293 (0.286) data 0.247 (0.238) loss_x loss_x 0.1837 (0.2049) acc_x 93.7500 (95.6250) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3790, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 285
clean true:212
clean false:73
clean_rate:0.743859649122807
noisy true:205
noisy false:262
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 467
epoch [189/200] batch [5/8] time 0.279 (0.291) data 0.232 (0.244) loss_x loss_x 0.2225 (0.3004) acc_x 93.7500 (93.7500) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:209
clean false:66
clean_rate:0.76
noisy true:210
noisy false:267
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [190/200] batch [5/8] time 0.283 (0.315) data 0.236 (0.253) loss_x loss_x 0.1356 (0.1813) acc_x 96.8750 (95.6250) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:210
clean false:66
clean_rate:0.7608695652173914
noisy true:212
noisy false:264
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [191/200] batch [5/8] time 0.313 (0.312) data 0.266 (0.250) loss_x loss_x 0.1986 (0.2157) acc_x 93.7500 (95.0000) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 331
confident_label rate tensor(0.3617, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 272
clean true:206
clean false:66
clean_rate:0.7573529411764706
noisy true:215
noisy false:265
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 480
epoch [192/200] batch [5/8] time 0.247 (0.275) data 0.200 (0.227) loss_x loss_x 0.1228 (0.1319) acc_x 96.8750 (97.5000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 335
confident_label rate tensor(0.3710, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 279
clean true:211
clean false:68
clean_rate:0.7562724014336918
noisy true:206
noisy false:267
after delete: len(clean_dataset) 279
after delete: len(noisy_dataset) 473
epoch [193/200] batch [5/8] time 0.270 (0.258) data 0.223 (0.211) loss_x loss_x 0.2146 (0.1494) acc_x 96.8750 (96.8750) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 323
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:213
clean false:63
clean_rate:0.7717391304347826
noisy true:216
noisy false:260
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [194/200] batch [5/8] time 0.319 (0.303) data 0.270 (0.255) loss_x loss_x 0.1522 (0.1346) acc_x 96.8750 (98.7500) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 332
confident_label rate tensor(0.3697, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 278
clean true:207
clean false:71
clean_rate:0.7446043165467626
noisy true:213
noisy false:261
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 474
epoch [195/200] batch [5/8] time 0.363 (0.314) data 0.244 (0.252) loss_x loss_x 0.1731 (0.1641) acc_x 96.8750 (96.8750) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 276
clean true:207
clean false:69
clean_rate:0.75
noisy true:215
noisy false:261
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 476
epoch [196/200] batch [5/8] time 0.319 (0.332) data 0.272 (0.270) loss_x loss_x 0.0978 (0.1165) acc_x 100.0000 (98.7500) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.3737, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 281
clean true:212
clean false:69
clean_rate:0.7544483985765125
noisy true:210
noisy false:261
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 471
epoch [197/200] batch [5/8] time 0.210 (0.264) data 0.163 (0.216) loss_x loss_x 0.0478 (0.1119) acc_x 100.0000 (97.5000) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 327
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 275
clean true:209
clean false:66
clean_rate:0.76
noisy true:216
noisy false:261
after delete: len(clean_dataset) 275
after delete: len(noisy_dataset) 477
epoch [198/200] batch [5/8] time 0.265 (0.307) data 0.217 (0.245) loss_x loss_x 0.6226 (0.2239) acc_x 93.7500 (97.5000) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 325
confident_label rate tensor(0.3723, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 280
clean true:210
clean false:70
clean_rate:0.75
noisy true:217
noisy false:255
after delete: len(clean_dataset) 280
after delete: len(noisy_dataset) 472
epoch [199/200] batch [5/8] time 0.301 (0.293) data 0.253 (0.246) loss_x loss_x 0.1216 (0.1929) acc_x 96.8750 (94.3750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 343
confident_label rate tensor(0.3617, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 272
clean true:203
clean false:69
clean_rate:0.7463235294117647
noisy true:206
noisy false:274
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 480
epoch [200/200] batch [5/8] time 0.271 (0.284) data 0.223 (0.237) loss_x loss_x 0.2314 (0.1433) acc_x 90.6250 (96.2500) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 1,692
* correct: 835
* accuracy: 49.3%
* error: 50.7%
* macro_f1: 48.6%
Elapsed: 0:34:23
