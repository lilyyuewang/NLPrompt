***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/dtd.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '47']
output_dir: output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: DescribableTextures
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 47
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: DescribableTextures
Reading split from /home/convex/datasets/nlprompt/dtd/split_zhou_DescribableTextures.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/dtd/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 23
Data loader size: 2
Data loader size: 17
---------  -------------------
Dataset    DescribableTextures
# classes  47
# train_x  752
# val      188
# test     1,692
---------  -------------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 569
confident_label rate tensor(0.0931, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 70
clean true:58
clean false:12
clean_rate:0.8285714285714286
noisy true:125
noisy false:557
after delete: len(clean_dataset) 70
after delete: len(noisy_dataset) 682
epoch [1/200] batch [1/2] time 0.386 (0.386) data 0.235 (0.235) loss_x loss_x 2.5547 (2.5547) acc_x 59.3750 (59.3750) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/2] time 0.327 (0.357) data 0.279 (0.257) loss_x loss_x 2.7559 (2.6553) acc_x 37.5000 (48.4375) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 573
confident_label rate tensor(0.0811, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 61
clean true:54
clean false:7
clean_rate:0.8852459016393442
noisy true:125
noisy false:566
after delete: len(clean_dataset) 61
after delete: len(noisy_dataset) 691
epoch [2/200] batch [1/1] time 0.280 (0.280) data 0.232 (0.232) loss_x loss_x 2.5566 (2.5566) acc_x 53.1250 (53.1250) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 503
confident_label rate tensor(0.1011, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 76
clean true:74
clean false:2
clean_rate:0.9736842105263158
noisy true:175
noisy false:501
after delete: len(clean_dataset) 76
after delete: len(noisy_dataset) 676
epoch [3/200] batch [1/2] time 0.296 (0.296) data 0.248 (0.248) loss_x loss_x 2.1387 (2.1387) acc_x 56.2500 (56.2500) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [2/2] time 0.291 (0.294) data 0.243 (0.246) loss_x loss_x 1.2979 (1.7183) acc_x 71.8750 (64.0625) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 452
confident_label rate tensor(0.1343, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 101
clean true:96
clean false:5
clean_rate:0.9504950495049505
noisy true:204
noisy false:447
after delete: len(clean_dataset) 101
after delete: len(noisy_dataset) 651
epoch [4/200] batch [1/3] time 0.320 (0.320) data 0.270 (0.270) loss_x loss_x 1.3848 (1.3848) acc_x 56.2500 (56.2500) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [2/3] time 0.304 (0.312) data 0.256 (0.263) loss_x loss_x 1.1904 (1.2876) acc_x 75.0000 (65.6250) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [3/3] time 0.244 (0.289) data 0.196 (0.241) loss_x loss_x 1.0586 (1.2113) acc_x 62.5000 (64.5833) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 480
confident_label rate tensor(0.1330, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 100
clean true:92
clean false:8
clean_rate:0.92
noisy true:180
noisy false:472
after delete: len(clean_dataset) 100
after delete: len(noisy_dataset) 652
epoch [5/200] batch [1/3] time 0.303 (0.303) data 0.255 (0.255) loss_x loss_x 1.3320 (1.3320) acc_x 62.5000 (62.5000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [2/3] time 0.291 (0.297) data 0.243 (0.249) loss_x loss_x 1.1494 (1.2407) acc_x 62.5000 (62.5000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [3/3] time 0.274 (0.289) data 0.227 (0.241) loss_x loss_x 1.1562 (1.2126) acc_x 62.5000 (62.5000) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 468
confident_label rate tensor(0.1436, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 108
clean true:99
clean false:9
clean_rate:0.9166666666666666
noisy true:185
noisy false:459
after delete: len(clean_dataset) 108
after delete: len(noisy_dataset) 644
epoch [6/200] batch [1/3] time 0.236 (0.236) data 0.188 (0.188) loss_x loss_x 0.6606 (0.6606) acc_x 84.3750 (84.3750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [2/3] time 0.253 (0.244) data 0.204 (0.196) loss_x loss_x 1.5859 (1.1233) acc_x 56.2500 (70.3125) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [3/3] time 0.258 (0.249) data 0.210 (0.201) loss_x loss_x 0.8677 (1.0381) acc_x 71.8750 (70.8333) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 454
confident_label rate tensor(0.1529, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 115
clean true:108
clean false:7
clean_rate:0.9391304347826087
noisy true:190
noisy false:447
after delete: len(clean_dataset) 115
after delete: len(noisy_dataset) 637
epoch [7/200] batch [1/3] time 0.280 (0.280) data 0.232 (0.232) loss_x loss_x 1.0566 (1.0566) acc_x 71.8750 (71.8750) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [2/3] time 0.315 (0.298) data 0.268 (0.250) loss_x loss_x 0.8423 (0.9495) acc_x 81.2500 (76.5625) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [3/3] time 0.312 (0.302) data 0.264 (0.255) loss_x loss_x 1.0068 (0.9686) acc_x 75.0000 (76.0417) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 450
confident_label rate tensor(0.1529, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 115
clean true:106
clean false:9
clean_rate:0.9217391304347826
noisy true:196
noisy false:441
after delete: len(clean_dataset) 115
after delete: len(noisy_dataset) 637
epoch [8/200] batch [1/3] time 0.303 (0.303) data 0.254 (0.254) loss_x loss_x 0.7305 (0.7305) acc_x 78.1250 (78.1250) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [2/3] time 0.345 (0.324) data 0.297 (0.276) loss_x loss_x 0.9336 (0.8320) acc_x 75.0000 (76.5625) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [3/3] time 0.353 (0.334) data 0.306 (0.286) loss_x loss_x 0.7056 (0.7899) acc_x 84.3750 (79.1667) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 443
confident_label rate tensor(0.1729, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 130
clean true:122
clean false:8
clean_rate:0.9384615384615385
noisy true:187
noisy false:435
after delete: len(clean_dataset) 130
after delete: len(noisy_dataset) 622
epoch [9/200] batch [1/4] time 0.234 (0.234) data 0.186 (0.186) loss_x loss_x 0.6001 (0.6001) acc_x 87.5000 (87.5000) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [2/4] time 0.263 (0.249) data 0.215 (0.201) loss_x loss_x 0.6353 (0.6177) acc_x 84.3750 (85.9375) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [3/4] time 0.253 (0.250) data 0.205 (0.202) loss_x loss_x 0.9658 (0.7337) acc_x 81.2500 (84.3750) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [4/4] time 0.276 (0.257) data 0.228 (0.209) loss_x loss_x 1.0869 (0.8220) acc_x 68.7500 (80.4688) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 452
confident_label rate tensor(0.1596, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 120
clean true:114
clean false:6
clean_rate:0.95
noisy true:186
noisy false:446
after delete: len(clean_dataset) 120
after delete: len(noisy_dataset) 632
epoch [10/200] batch [1/3] time 0.363 (0.363) data 0.314 (0.314) loss_x loss_x 0.3645 (0.3645) acc_x 90.6250 (90.6250) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [2/3] time 0.261 (0.312) data 0.214 (0.264) loss_x loss_x 0.7271 (0.5458) acc_x 81.2500 (85.9375) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [3/3] time 0.278 (0.301) data 0.230 (0.253) loss_x loss_x 0.9810 (0.6908) acc_x 75.0000 (82.2917) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 434
confident_label rate tensor(0.1636, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 123
clean true:118
clean false:5
clean_rate:0.959349593495935
noisy true:200
noisy false:429
after delete: len(clean_dataset) 123
after delete: len(noisy_dataset) 629
epoch [11/200] batch [1/3] time 0.326 (0.326) data 0.278 (0.278) loss_x loss_x 0.8027 (0.8027) acc_x 71.8750 (71.8750) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [2/3] time 0.292 (0.309) data 0.244 (0.261) loss_x loss_x 0.4521 (0.6274) acc_x 84.3750 (78.1250) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [3/3] time 0.262 (0.293) data 0.214 (0.245) loss_x loss_x 0.8018 (0.6855) acc_x 81.2500 (79.1667) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 435
confident_label rate tensor(0.1582, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 119
clean true:115
clean false:4
clean_rate:0.9663865546218487
noisy true:202
noisy false:431
after delete: len(clean_dataset) 119
after delete: len(noisy_dataset) 633
epoch [12/200] batch [1/3] time 0.249 (0.249) data 0.202 (0.202) loss_x loss_x 0.7339 (0.7339) acc_x 78.1250 (78.1250) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [2/3] time 0.243 (0.246) data 0.192 (0.197) loss_x loss_x 0.5459 (0.6399) acc_x 93.7500 (85.9375) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [3/3] time 0.231 (0.241) data 0.181 (0.192) loss_x loss_x 0.4897 (0.5898) acc_x 87.5000 (86.4583) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 427
confident_label rate tensor(0.1689, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 127
clean true:120
clean false:7
clean_rate:0.9448818897637795
noisy true:205
noisy false:420
after delete: len(clean_dataset) 127
after delete: len(noisy_dataset) 625
epoch [13/200] batch [1/3] time 0.296 (0.296) data 0.245 (0.245) loss_x loss_x 0.3496 (0.3496) acc_x 90.6250 (90.6250) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [2/3] time 0.234 (0.265) data 0.185 (0.215) loss_x loss_x 0.4861 (0.4178) acc_x 87.5000 (89.0625) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [3/3] time 0.287 (0.272) data 0.239 (0.223) loss_x loss_x 0.9907 (0.6088) acc_x 68.7500 (82.2917) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 430
confident_label rate tensor(0.1715, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 129
clean true:124
clean false:5
clean_rate:0.9612403100775194
noisy true:198
noisy false:425
after delete: len(clean_dataset) 129
after delete: len(noisy_dataset) 623
epoch [14/200] batch [1/4] time 0.288 (0.288) data 0.240 (0.240) loss_x loss_x 0.6353 (0.6353) acc_x 75.0000 (75.0000) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [2/4] time 0.302 (0.295) data 0.255 (0.247) loss_x loss_x 0.3311 (0.4832) acc_x 87.5000 (81.2500) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [3/4] time 0.324 (0.305) data 0.276 (0.257) loss_x loss_x 0.4202 (0.4622) acc_x 93.7500 (85.4167) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [4/4] time 0.322 (0.309) data 0.275 (0.261) loss_x loss_x 0.4734 (0.4650) acc_x 84.3750 (85.1562) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 432
confident_label rate tensor(0.1769, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 133
clean true:126
clean false:7
clean_rate:0.9473684210526315
noisy true:194
noisy false:425
after delete: len(clean_dataset) 133
after delete: len(noisy_dataset) 619
epoch [15/200] batch [1/4] time 0.287 (0.287) data 0.239 (0.239) loss_x loss_x 0.6313 (0.6313) acc_x 75.0000 (75.0000) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [2/4] time 0.284 (0.286) data 0.236 (0.238) loss_x loss_x 0.4873 (0.5593) acc_x 84.3750 (79.6875) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [3/4] time 0.264 (0.278) data 0.216 (0.230) loss_x loss_x 0.3506 (0.4897) acc_x 93.7500 (84.3750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [4/4] time 0.253 (0.272) data 0.206 (0.224) loss_x loss_x 0.3872 (0.4641) acc_x 90.6250 (85.9375) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 403
confident_label rate tensor(0.1968, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 148
clean true:141
clean false:7
clean_rate:0.9527027027027027
noisy true:208
noisy false:396
after delete: len(clean_dataset) 148
after delete: len(noisy_dataset) 604
epoch [16/200] batch [1/4] time 0.314 (0.314) data 0.266 (0.266) loss_x loss_x 0.6094 (0.6094) acc_x 84.3750 (84.3750) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [2/4] time 0.306 (0.310) data 0.258 (0.262) loss_x loss_x 0.6938 (0.6516) acc_x 78.1250 (81.2500) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [3/4] time 0.346 (0.322) data 0.298 (0.274) loss_x loss_x 0.8037 (0.7023) acc_x 75.0000 (79.1667) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [4/4] time 0.300 (0.316) data 0.252 (0.268) loss_x loss_x 0.7026 (0.7024) acc_x 84.3750 (80.4688) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 400
confident_label rate tensor(0.1902, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 143
clean true:135
clean false:8
clean_rate:0.9440559440559441
noisy true:217
noisy false:392
after delete: len(clean_dataset) 143
after delete: len(noisy_dataset) 609
epoch [17/200] batch [1/4] time 0.295 (0.295) data 0.247 (0.247) loss_x loss_x 0.2622 (0.2622) acc_x 93.7500 (93.7500) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [2/4] time 0.303 (0.299) data 0.253 (0.250) loss_x loss_x 0.8174 (0.5398) acc_x 78.1250 (85.9375) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [3/4] time 0.350 (0.316) data 0.301 (0.267) loss_x loss_x 0.6162 (0.5653) acc_x 87.5000 (86.4583) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [4/4] time 0.321 (0.317) data 0.273 (0.269) loss_x loss_x 0.7852 (0.6202) acc_x 81.2500 (85.1562) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 391
confident_label rate tensor(0.1888, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 142
clean true:135
clean false:7
clean_rate:0.9507042253521126
noisy true:226
noisy false:384
after delete: len(clean_dataset) 142
after delete: len(noisy_dataset) 610
epoch [18/200] batch [1/4] time 0.274 (0.274) data 0.227 (0.227) loss_x loss_x 0.6172 (0.6172) acc_x 81.2500 (81.2500) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [2/4] time 0.279 (0.277) data 0.231 (0.229) loss_x loss_x 0.7695 (0.6934) acc_x 75.0000 (78.1250) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [3/4] time 0.286 (0.280) data 0.236 (0.231) loss_x loss_x 0.4851 (0.6239) acc_x 81.2500 (79.1667) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [4/4] time 0.246 (0.271) data 0.197 (0.223) loss_x loss_x 0.4375 (0.5773) acc_x 87.5000 (81.2500) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 397
confident_label rate tensor(0.1915, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 144
clean true:138
clean false:6
clean_rate:0.9583333333333334
noisy true:217
noisy false:391
after delete: len(clean_dataset) 144
after delete: len(noisy_dataset) 608
epoch [19/200] batch [1/4] time 0.288 (0.288) data 0.240 (0.240) loss_x loss_x 0.2379 (0.2379) acc_x 93.7500 (93.7500) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [2/4] time 0.332 (0.310) data 0.285 (0.263) loss_x loss_x 0.5479 (0.3929) acc_x 87.5000 (90.6250) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [3/4] time 0.288 (0.303) data 0.240 (0.255) loss_x loss_x 0.7905 (0.5254) acc_x 75.0000 (85.4167) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [4/4] time 0.280 (0.297) data 0.232 (0.249) loss_x loss_x 0.4775 (0.5135) acc_x 90.6250 (86.7188) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 387
confident_label rate tensor(0.2074, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 156
clean true:148
clean false:8
clean_rate:0.9487179487179487
noisy true:217
noisy false:379
after delete: len(clean_dataset) 156
after delete: len(noisy_dataset) 596
epoch [20/200] batch [1/4] time 0.298 (0.298) data 0.250 (0.250) loss_x loss_x 0.6797 (0.6797) acc_x 81.2500 (81.2500) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [2/4] time 0.274 (0.286) data 0.226 (0.238) loss_x loss_x 0.8662 (0.7729) acc_x 71.8750 (76.5625) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [3/4] time 0.273 (0.281) data 0.225 (0.234) loss_x loss_x 0.6001 (0.7153) acc_x 87.5000 (80.2083) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [4/4] time 0.310 (0.289) data 0.262 (0.241) loss_x loss_x 0.5962 (0.6855) acc_x 81.2500 (80.4688) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 389
confident_label rate tensor(0.1968, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 148
clean true:141
clean false:7
clean_rate:0.9527027027027027
noisy true:222
noisy false:382
after delete: len(clean_dataset) 148
after delete: len(noisy_dataset) 604
epoch [21/200] batch [1/4] time 0.320 (0.320) data 0.269 (0.269) loss_x loss_x 0.7886 (0.7886) acc_x 90.6250 (90.6250) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [2/4] time 0.252 (0.286) data 0.201 (0.235) loss_x loss_x 0.2756 (0.5321) acc_x 96.8750 (93.7500) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [3/4] time 0.241 (0.271) data 0.190 (0.220) loss_x loss_x 0.9414 (0.6685) acc_x 75.0000 (87.5000) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [4/4] time 0.259 (0.268) data 0.209 (0.217) loss_x loss_x 0.7515 (0.6893) acc_x 84.3750 (86.7188) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.1981, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 149
clean true:142
clean false:7
clean_rate:0.9530201342281879
noisy true:235
noisy false:368
after delete: len(clean_dataset) 149
after delete: len(noisy_dataset) 603
epoch [22/200] batch [1/4] time 0.290 (0.290) data 0.241 (0.241) loss_x loss_x 0.2812 (0.2812) acc_x 90.6250 (90.6250) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [2/4] time 0.248 (0.269) data 0.197 (0.219) loss_x loss_x 0.4846 (0.3829) acc_x 90.6250 (90.6250) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [3/4] time 0.265 (0.268) data 0.213 (0.217) loss_x loss_x 0.4583 (0.4080) acc_x 87.5000 (89.5833) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [4/4] time 0.324 (0.282) data 0.276 (0.232) loss_x loss_x 0.7158 (0.4850) acc_x 78.1250 (86.7188) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 374
confident_label rate tensor(0.2035, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 153
clean true:146
clean false:7
clean_rate:0.954248366013072
noisy true:232
noisy false:367
after delete: len(clean_dataset) 153
after delete: len(noisy_dataset) 599
epoch [23/200] batch [1/4] time 0.305 (0.305) data 0.255 (0.255) loss_x loss_x 0.3508 (0.3508) acc_x 93.7500 (93.7500) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [2/4] time 0.277 (0.291) data 0.229 (0.242) loss_x loss_x 0.4756 (0.4132) acc_x 84.3750 (89.0625) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [3/4] time 0.265 (0.283) data 0.215 (0.233) loss_x loss_x 0.8804 (0.5689) acc_x 84.3750 (87.5000) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [4/4] time 0.254 (0.275) data 0.203 (0.226) loss_x loss_x 0.4653 (0.5430) acc_x 90.6250 (88.2812) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2061, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 155
clean true:148
clean false:7
clean_rate:0.9548387096774194
noisy true:231
noisy false:366
after delete: len(clean_dataset) 155
after delete: len(noisy_dataset) 597
epoch [24/200] batch [1/4] time 0.273 (0.273) data 0.225 (0.225) loss_x loss_x 0.2452 (0.2452) acc_x 96.8750 (96.8750) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [2/4] time 0.289 (0.281) data 0.242 (0.233) loss_x loss_x 0.6025 (0.4239) acc_x 78.1250 (87.5000) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [3/4] time 0.302 (0.288) data 0.254 (0.240) loss_x loss_x 0.7188 (0.5222) acc_x 84.3750 (86.4583) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [4/4] time 0.280 (0.286) data 0.232 (0.238) loss_x loss_x 0.4424 (0.5022) acc_x 87.5000 (86.7188) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 159
clean true:149
clean false:10
clean_rate:0.9371069182389937
noisy true:231
noisy false:362
after delete: len(clean_dataset) 159
after delete: len(noisy_dataset) 593
epoch [25/200] batch [1/4] time 0.359 (0.359) data 0.308 (0.308) loss_x loss_x 0.2622 (0.2622) acc_x 93.7500 (93.7500) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [2/4] time 0.300 (0.329) data 0.252 (0.280) loss_x loss_x 0.7153 (0.4888) acc_x 75.0000 (84.3750) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [3/4] time 0.288 (0.315) data 0.240 (0.267) loss_x loss_x 0.5352 (0.5042) acc_x 87.5000 (85.4167) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [4/4] time 0.323 (0.317) data 0.275 (0.269) loss_x loss_x 0.5850 (0.5244) acc_x 90.6250 (86.7188) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2128, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 160
clean true:152
clean false:8
clean_rate:0.95
noisy true:227
noisy false:365
after delete: len(clean_dataset) 160
after delete: len(noisy_dataset) 592
epoch [26/200] batch [5/5] time 0.312 (0.326) data 0.264 (0.277) loss_x loss_x 0.3530 (0.5657) acc_x 93.7500 (85.0000) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 373
confident_label rate tensor(0.2207, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 166
clean true:157
clean false:9
clean_rate:0.9457831325301205
noisy true:222
noisy false:364
after delete: len(clean_dataset) 166
after delete: len(noisy_dataset) 586
epoch [27/200] batch [5/5] time 0.282 (0.257) data 0.234 (0.209) loss_x loss_x 0.4478 (0.4786) acc_x 87.5000 (88.1250) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 371
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 165
clean true:153
clean false:12
clean_rate:0.9272727272727272
noisy true:228
noisy false:359
after delete: len(clean_dataset) 165
after delete: len(noisy_dataset) 587
epoch [28/200] batch [5/5] time 0.360 (0.323) data 0.312 (0.275) loss_x loss_x 0.6553 (0.6420) acc_x 68.7500 (84.3750) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 161
clean true:152
clean false:9
clean_rate:0.9440993788819876
noisy true:228
noisy false:363
after delete: len(clean_dataset) 161
after delete: len(noisy_dataset) 591
epoch [29/200] batch [5/5] time 0.295 (0.300) data 0.245 (0.251) loss_x loss_x 0.4487 (0.3888) acc_x 81.2500 (88.7500) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 356
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 165
clean true:157
clean false:8
clean_rate:0.9515151515151515
noisy true:239
noisy false:348
after delete: len(clean_dataset) 165
after delete: len(noisy_dataset) 587
epoch [30/200] batch [5/5] time 0.251 (0.268) data 0.203 (0.220) loss_x loss_x 0.2900 (0.3233) acc_x 93.7500 (93.1250) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2221, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 167
clean true:157
clean false:10
clean_rate:0.9401197604790419
noisy true:233
noisy false:352
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 585
epoch [31/200] batch [5/5] time 0.335 (0.315) data 0.287 (0.267) loss_x loss_x 0.5908 (0.4451) acc_x 90.6250 (90.6250) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 355
confident_label rate tensor(0.2340, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 176
clean true:166
clean false:10
clean_rate:0.9431818181818182
noisy true:231
noisy false:345
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 576
epoch [32/200] batch [5/5] time 0.286 (0.274) data 0.238 (0.226) loss_x loss_x 0.4333 (0.3984) acc_x 84.3750 (90.0000) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 372
confident_label rate tensor(0.2207, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 166
clean true:154
clean false:12
clean_rate:0.927710843373494
noisy true:226
noisy false:360
after delete: len(clean_dataset) 166
after delete: len(noisy_dataset) 586
epoch [33/200] batch [5/5] time 0.281 (0.282) data 0.233 (0.234) loss_x loss_x 0.6113 (0.3742) acc_x 84.3750 (91.2500) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 356
confident_label rate tensor(0.2354, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 177
clean true:166
clean false:11
clean_rate:0.9378531073446328
noisy true:230
noisy false:345
after delete: len(clean_dataset) 177
after delete: len(noisy_dataset) 575
epoch [34/200] batch [5/5] time 0.339 (0.305) data 0.291 (0.257) loss_x loss_x 0.3975 (0.4330) acc_x 90.6250 (89.3750) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 354
confident_label rate tensor(0.2340, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 176
clean true:165
clean false:11
clean_rate:0.9375
noisy true:233
noisy false:343
after delete: len(clean_dataset) 176
after delete: len(noisy_dataset) 576
epoch [35/200] batch [5/5] time 0.317 (0.300) data 0.270 (0.251) loss_x loss_x 0.2347 (0.4898) acc_x 93.7500 (88.7500) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 375
confident_label rate tensor(0.2274, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 171
clean true:159
clean false:12
clean_rate:0.9298245614035088
noisy true:218
noisy false:363
after delete: len(clean_dataset) 171
after delete: len(noisy_dataset) 581
epoch [36/200] batch [5/5] time 0.282 (0.319) data 0.234 (0.271) loss_x loss_x 0.5474 (0.4829) acc_x 96.8750 (90.0000) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 381
confident_label rate tensor(0.2301, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 173
clean true:162
clean false:11
clean_rate:0.9364161849710982
noisy true:209
noisy false:370
after delete: len(clean_dataset) 173
after delete: len(noisy_dataset) 579
epoch [37/200] batch [5/5] time 0.302 (0.299) data 0.254 (0.251) loss_x loss_x 0.3950 (0.4071) acc_x 87.5000 (88.7500) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 360
confident_label rate tensor(0.2221, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 167
clean true:159
clean false:8
clean_rate:0.9520958083832335
noisy true:233
noisy false:352
after delete: len(clean_dataset) 167
after delete: len(noisy_dataset) 585
epoch [38/200] batch [5/5] time 0.328 (0.325) data 0.279 (0.276) loss_x loss_x 0.4265 (0.2802) acc_x 90.6250 (94.3750) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 348
confident_label rate tensor(0.2513, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 189
clean true:177
clean false:12
clean_rate:0.9365079365079365
noisy true:227
noisy false:336
after delete: len(clean_dataset) 189
after delete: len(noisy_dataset) 563
epoch [39/200] batch [5/5] time 0.265 (0.311) data 0.217 (0.263) loss_x loss_x 0.2303 (0.4805) acc_x 93.7500 (88.1250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 362
confident_label rate tensor(0.2434, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 183
clean true:172
clean false:11
clean_rate:0.9398907103825137
noisy true:218
noisy false:351
after delete: len(clean_dataset) 183
after delete: len(noisy_dataset) 569
epoch [40/200] batch [5/5] time 0.335 (0.297) data 0.288 (0.249) loss_x loss_x 0.3206 (0.4597) acc_x 96.8750 (87.5000) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 351
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 182
clean true:169
clean false:13
clean_rate:0.9285714285714286
noisy true:232
noisy false:338
after delete: len(clean_dataset) 182
after delete: len(noisy_dataset) 570
epoch [41/200] batch [5/5] time 0.297 (0.311) data 0.249 (0.263) loss_x loss_x 0.2625 (0.4368) acc_x 93.7500 (88.1250) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 349
confident_label rate tensor(0.2527, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 190
clean true:178
clean false:12
clean_rate:0.9368421052631579
noisy true:225
noisy false:337
after delete: len(clean_dataset) 190
after delete: len(noisy_dataset) 562
epoch [42/200] batch [5/5] time 0.301 (0.308) data 0.254 (0.258) loss_x loss_x 0.5645 (0.4751) acc_x 87.5000 (89.3750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 354
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:173
clean false:14
clean_rate:0.9251336898395722
noisy true:225
noisy false:340
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [43/200] batch [5/5] time 0.331 (0.301) data 0.283 (0.253) loss_x loss_x 0.2983 (0.3639) acc_x 90.6250 (90.6250) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 344
confident_label rate tensor(0.2540, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 191
clean true:177
clean false:14
clean_rate:0.9267015706806283
noisy true:231
noisy false:330
after delete: len(clean_dataset) 191
after delete: len(noisy_dataset) 561
epoch [44/200] batch [5/5] time 0.331 (0.327) data 0.284 (0.278) loss_x loss_x 0.3408 (0.3388) acc_x 90.6250 (91.8750) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 348
confident_label rate tensor(0.2527, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 190
clean true:174
clean false:16
clean_rate:0.9157894736842105
noisy true:230
noisy false:332
after delete: len(clean_dataset) 190
after delete: len(noisy_dataset) 562
epoch [45/200] batch [5/5] time 0.301 (0.300) data 0.254 (0.251) loss_x loss_x 0.3379 (0.4111) acc_x 93.7500 (90.6250) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 354
confident_label rate tensor(0.2540, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 191
clean true:174
clean false:17
clean_rate:0.9109947643979057
noisy true:224
noisy false:337
after delete: len(clean_dataset) 191
after delete: len(noisy_dataset) 561
epoch [46/200] batch [5/5] time 0.299 (0.301) data 0.251 (0.254) loss_x loss_x 0.2365 (0.3823) acc_x 93.7500 (92.5000) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 356
confident_label rate tensor(0.2487, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 187
clean true:177
clean false:10
clean_rate:0.946524064171123
noisy true:219
noisy false:346
after delete: len(clean_dataset) 187
after delete: len(noisy_dataset) 565
epoch [47/200] batch [5/5] time 0.314 (0.320) data 0.266 (0.272) loss_x loss_x 0.1281 (0.2380) acc_x 96.8750 (95.0000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 348
confident_label rate tensor(0.2633, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 198
clean true:186
clean false:12
clean_rate:0.9393939393939394
noisy true:218
noisy false:336
after delete: len(clean_dataset) 198
after delete: len(noisy_dataset) 554
epoch [48/200] batch [5/6] time 0.297 (0.315) data 0.250 (0.267) loss_x loss_x 0.2786 (0.3455) acc_x 93.7500 (91.8750) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 350
confident_label rate tensor(0.2527, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 190
clean true:178
clean false:12
clean_rate:0.9368421052631579
noisy true:224
noisy false:338
after delete: len(clean_dataset) 190
after delete: len(noisy_dataset) 562
epoch [49/200] batch [5/5] time 0.308 (0.294) data 0.260 (0.246) loss_x loss_x 0.6895 (0.4427) acc_x 87.5000 (91.8750) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.2606, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 196
clean true:185
clean false:11
clean_rate:0.9438775510204082
noisy true:241
noisy false:315
after delete: len(clean_dataset) 196
after delete: len(noisy_dataset) 556
epoch [50/200] batch [5/6] time 0.290 (0.311) data 0.242 (0.262) loss_x loss_x 0.2898 (0.2828) acc_x 93.7500 (93.1250) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 343
confident_label rate tensor(0.2580, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 194
clean true:180
clean false:14
clean_rate:0.9278350515463918
noisy true:229
noisy false:329
after delete: len(clean_dataset) 194
after delete: len(noisy_dataset) 558
epoch [51/200] batch [5/6] time 0.303 (0.320) data 0.255 (0.273) loss_x loss_x 0.4417 (0.3672) acc_x 90.6250 (89.3750) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.2606, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 196
clean true:183
clean false:13
clean_rate:0.9336734693877551
noisy true:236
noisy false:320
after delete: len(clean_dataset) 196
after delete: len(noisy_dataset) 556
epoch [52/200] batch [5/6] time 0.315 (0.305) data 0.267 (0.257) loss_x loss_x 0.2352 (0.3290) acc_x 93.7500 (93.1250) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.2646, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 199
clean true:181
clean false:18
clean_rate:0.9095477386934674
noisy true:241
noisy false:312
after delete: len(clean_dataset) 199
after delete: len(noisy_dataset) 553
epoch [53/200] batch [5/6] time 0.324 (0.327) data 0.277 (0.279) loss_x loss_x 0.4795 (0.4750) acc_x 87.5000 (88.7500) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 334
confident_label rate tensor(0.2753, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 207
clean true:191
clean false:16
clean_rate:0.9227053140096618
noisy true:227
noisy false:318
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 545
epoch [54/200] batch [5/6] time 0.336 (0.303) data 0.288 (0.254) loss_x loss_x 0.2168 (0.3809) acc_x 96.8750 (90.0000) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 329
confident_label rate tensor(0.2753, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 207
clean true:191
clean false:16
clean_rate:0.9227053140096618
noisy true:232
noisy false:313
after delete: len(clean_dataset) 207
after delete: len(noisy_dataset) 545
epoch [55/200] batch [5/6] time 0.299 (0.309) data 0.251 (0.261) loss_x loss_x 0.2360 (0.3759) acc_x 96.8750 (90.6250) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 326
confident_label rate tensor(0.2793, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 210
clean true:193
clean false:17
clean_rate:0.919047619047619
noisy true:233
noisy false:309
after delete: len(clean_dataset) 210
after delete: len(noisy_dataset) 542
epoch [56/200] batch [5/6] time 0.269 (0.296) data 0.221 (0.248) loss_x loss_x 0.1225 (0.3078) acc_x 96.8750 (94.3750) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 333
confident_label rate tensor(0.2726, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 205
clean true:190
clean false:15
clean_rate:0.926829268292683
noisy true:229
noisy false:318
after delete: len(clean_dataset) 205
after delete: len(noisy_dataset) 547
epoch [57/200] batch [5/6] time 0.297 (0.298) data 0.249 (0.250) loss_x loss_x 0.3918 (0.4325) acc_x 90.6250 (86.8750) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 332
confident_label rate tensor(0.2713, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 204
clean true:191
clean false:13
clean_rate:0.9362745098039216
noisy true:229
noisy false:319
after delete: len(clean_dataset) 204
after delete: len(noisy_dataset) 548
epoch [58/200] batch [5/6] time 0.315 (0.304) data 0.268 (0.256) loss_x loss_x 0.3010 (0.2692) acc_x 93.7500 (93.7500) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 327
confident_label rate tensor(0.2739, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 206
clean true:189
clean false:17
clean_rate:0.9174757281553398
noisy true:236
noisy false:310
after delete: len(clean_dataset) 206
after delete: len(noisy_dataset) 546
epoch [59/200] batch [5/6] time 0.264 (0.282) data 0.216 (0.234) loss_x loss_x 0.3518 (0.2855) acc_x 90.6250 (92.5000) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 332
confident_label rate tensor(0.2779, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 209
clean true:194
clean false:15
clean_rate:0.9282296650717703
noisy true:226
noisy false:317
after delete: len(clean_dataset) 209
after delete: len(noisy_dataset) 543
epoch [60/200] batch [5/6] time 0.323 (0.314) data 0.276 (0.266) loss_x loss_x 0.3501 (0.2841) acc_x 93.7500 (93.1250) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 317
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 215
clean true:197
clean false:18
clean_rate:0.9162790697674419
noisy true:238
noisy false:299
after delete: len(clean_dataset) 215
after delete: len(noisy_dataset) 537
epoch [61/200] batch [5/6] time 0.288 (0.307) data 0.238 (0.259) loss_x loss_x 0.1703 (0.3015) acc_x 96.8750 (91.8750) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 312
confident_label rate tensor(0.2912, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 219
clean true:199
clean false:20
clean_rate:0.908675799086758
noisy true:241
noisy false:292
after delete: len(clean_dataset) 219
after delete: len(noisy_dataset) 533
epoch [62/200] batch [5/6] time 0.268 (0.299) data 0.220 (0.251) loss_x loss_x 0.4680 (0.3925) acc_x 93.7500 (91.8750) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 319
confident_label rate tensor(0.2832, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 213
clean true:196
clean false:17
clean_rate:0.92018779342723
noisy true:237
noisy false:302
after delete: len(clean_dataset) 213
after delete: len(noisy_dataset) 539
epoch [63/200] batch [5/6] time 0.271 (0.327) data 0.223 (0.279) loss_x loss_x 0.2583 (0.2556) acc_x 93.7500 (95.0000) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 324
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 215
clean true:194
clean false:21
clean_rate:0.9023255813953488
noisy true:234
noisy false:303
after delete: len(clean_dataset) 215
after delete: len(noisy_dataset) 537
epoch [64/200] batch [5/6] time 0.339 (0.303) data 0.291 (0.255) loss_x loss_x 0.2534 (0.2876) acc_x 96.8750 (91.8750) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 321
confident_label rate tensor(0.3005, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 226
clean true:201
clean false:25
clean_rate:0.8893805309734514
noisy true:230
noisy false:296
after delete: len(clean_dataset) 226
after delete: len(noisy_dataset) 526
epoch [65/200] batch [5/7] time 0.331 (0.309) data 0.280 (0.261) loss_x loss_x 0.3518 (0.3176) acc_x 87.5000 (91.8750) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 330
confident_label rate tensor(0.2872, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 216
clean true:198
clean false:18
clean_rate:0.9166666666666666
noisy true:224
noisy false:312
after delete: len(clean_dataset) 216
after delete: len(noisy_dataset) 536
epoch [66/200] batch [5/6] time 0.278 (0.322) data 0.230 (0.275) loss_x loss_x 0.2041 (0.2117) acc_x 96.8750 (96.8750) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 320
confident_label rate tensor(0.2979, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 224
clean true:201
clean false:23
clean_rate:0.8973214285714286
noisy true:231
noisy false:297
after delete: len(clean_dataset) 224
after delete: len(noisy_dataset) 528
epoch [67/200] batch [5/7] time 0.269 (0.312) data 0.221 (0.264) loss_x loss_x 0.3347 (0.3205) acc_x 93.7500 (91.8750) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 322
confident_label rate tensor(0.2926, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 220
clean true:198
clean false:22
clean_rate:0.9
noisy true:232
noisy false:300
after delete: len(clean_dataset) 220
after delete: len(noisy_dataset) 532
epoch [68/200] batch [5/6] time 0.280 (0.290) data 0.232 (0.242) loss_x loss_x 0.2744 (0.3145) acc_x 90.6250 (91.2500) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 322
confident_label rate tensor(0.3005, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 226
clean true:204
clean false:22
clean_rate:0.9026548672566371
noisy true:226
noisy false:300
after delete: len(clean_dataset) 226
after delete: len(noisy_dataset) 526
epoch [69/200] batch [5/7] time 0.367 (0.324) data 0.319 (0.276) loss_x loss_x 0.2004 (0.4094) acc_x 93.7500 (88.1250) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 311
confident_label rate tensor(0.2939, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 221
clean true:204
clean false:17
clean_rate:0.9230769230769231
noisy true:237
noisy false:294
after delete: len(clean_dataset) 221
after delete: len(noisy_dataset) 531
epoch [70/200] batch [5/6] time 0.302 (0.310) data 0.254 (0.262) loss_x loss_x 0.1945 (0.2755) acc_x 96.8750 (93.1250) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 300
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 229
clean true:208
clean false:21
clean_rate:0.9082969432314411
noisy true:244
noisy false:279
after delete: len(clean_dataset) 229
after delete: len(noisy_dataset) 523
epoch [71/200] batch [5/7] time 0.277 (0.305) data 0.226 (0.255) loss_x loss_x 0.1882 (0.4413) acc_x 96.8750 (90.0000) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 308
confident_label rate tensor(0.2952, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 222
clean true:200
clean false:22
clean_rate:0.9009009009009009
noisy true:244
noisy false:286
after delete: len(clean_dataset) 222
after delete: len(noisy_dataset) 530
epoch [72/200] batch [5/6] time 0.328 (0.311) data 0.280 (0.262) loss_x loss_x 0.3276 (0.4076) acc_x 87.5000 (90.6250) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3085, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 232
clean true:211
clean false:21
clean_rate:0.9094827586206896
noisy true:247
noisy false:273
after delete: len(clean_dataset) 232
after delete: len(noisy_dataset) 520
epoch [73/200] batch [5/7] time 0.331 (0.307) data 0.284 (0.258) loss_x loss_x 0.6201 (0.3776) acc_x 87.5000 (90.0000) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 278
confident_label rate tensor(0.3152, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 237
clean true:216
clean false:21
clean_rate:0.9113924050632911
noisy true:258
noisy false:257
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 515
epoch [74/200] batch [5/7] time 0.259 (0.285) data 0.212 (0.236) loss_x loss_x 0.4973 (0.3970) acc_x 96.8750 (94.3750) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 304
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 229
clean true:207
clean false:22
clean_rate:0.9039301310043668
noisy true:241
noisy false:282
after delete: len(clean_dataset) 229
after delete: len(noisy_dataset) 523
epoch [75/200] batch [5/7] time 0.302 (0.304) data 0.254 (0.256) loss_x loss_x 0.5063 (0.2683) acc_x 87.5000 (95.0000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 305
confident_label rate tensor(0.3098, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 233
clean true:209
clean false:24
clean_rate:0.8969957081545065
noisy true:238
noisy false:281
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 519
epoch [76/200] batch [5/7] time 0.291 (0.293) data 0.242 (0.244) loss_x loss_x 0.3843 (0.2780) acc_x 93.7500 (93.7500) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 309
confident_label rate tensor(0.2979, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 224
clean true:201
clean false:23
clean_rate:0.8973214285714286
noisy true:242
noisy false:286
after delete: len(clean_dataset) 224
after delete: len(noisy_dataset) 528
epoch [77/200] batch [5/7] time 0.303 (0.313) data 0.255 (0.265) loss_x loss_x 0.2607 (0.2937) acc_x 96.8750 (93.1250) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 316
confident_label rate tensor(0.2979, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 224
clean true:202
clean false:22
clean_rate:0.9017857142857143
noisy true:234
noisy false:294
after delete: len(clean_dataset) 224
after delete: len(noisy_dataset) 528
epoch [78/200] batch [5/7] time 0.298 (0.301) data 0.251 (0.252) loss_x loss_x 0.1322 (0.2564) acc_x 100.0000 (93.7500) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 315
confident_label rate tensor(0.2992, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 225
clean true:197
clean false:28
clean_rate:0.8755555555555555
noisy true:240
noisy false:287
after delete: len(clean_dataset) 225
after delete: len(noisy_dataset) 527
epoch [79/200] batch [5/7] time 0.367 (0.320) data 0.318 (0.271) loss_x loss_x 0.3345 (0.3302) acc_x 87.5000 (89.3750) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 300
confident_label rate tensor(0.3112, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 234
clean true:211
clean false:23
clean_rate:0.9017094017094017
noisy true:241
noisy false:277
after delete: len(clean_dataset) 234
after delete: len(noisy_dataset) 518
epoch [80/200] batch [5/7] time 0.260 (0.283) data 0.212 (0.235) loss_x loss_x 0.4253 (0.2594) acc_x 87.5000 (96.2500) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 305
confident_label rate tensor(0.3059, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 230
clean true:207
clean false:23
clean_rate:0.9
noisy true:240
noisy false:282
after delete: len(clean_dataset) 230
after delete: len(noisy_dataset) 522
epoch [81/200] batch [5/7] time 0.329 (0.317) data 0.281 (0.269) loss_x loss_x 0.3079 (0.2364) acc_x 93.7500 (95.0000) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 291
confident_label rate tensor(0.3165, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 238
clean true:216
clean false:22
clean_rate:0.907563025210084
noisy true:245
noisy false:269
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 514
epoch [82/200] batch [5/7] time 0.254 (0.256) data 0.206 (0.208) loss_x loss_x 0.2407 (0.2220) acc_x 96.8750 (95.6250) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3112, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 234
clean true:210
clean false:24
clean_rate:0.8974358974358975
noisy true:249
noisy false:269
after delete: len(clean_dataset) 234
after delete: len(noisy_dataset) 518
epoch [83/200] batch [5/7] time 0.294 (0.283) data 0.246 (0.236) loss_x loss_x 0.2590 (0.2931) acc_x 93.7500 (92.5000) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 307
confident_label rate tensor(0.3072, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 231
clean true:206
clean false:25
clean_rate:0.8917748917748918
noisy true:239
noisy false:282
after delete: len(clean_dataset) 231
after delete: len(noisy_dataset) 521
epoch [84/200] batch [5/7] time 0.348 (0.308) data 0.300 (0.260) loss_x loss_x 0.1826 (0.2701) acc_x 96.8750 (93.1250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 299
confident_label rate tensor(0.3098, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 233
clean true:209
clean false:24
clean_rate:0.8969957081545065
noisy true:244
noisy false:275
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 519
epoch [85/200] batch [5/7] time 0.323 (0.306) data 0.275 (0.258) loss_x loss_x 0.1438 (0.3437) acc_x 96.8750 (91.2500) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 301
confident_label rate tensor(0.3072, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 231
clean true:209
clean false:22
clean_rate:0.9047619047619048
noisy true:242
noisy false:279
after delete: len(clean_dataset) 231
after delete: len(noisy_dataset) 521
epoch [86/200] batch [5/7] time 0.326 (0.322) data 0.279 (0.274) loss_x loss_x 0.2114 (0.2238) acc_x 93.7500 (96.8750) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 300
confident_label rate tensor(0.3165, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 238
clean true:211
clean false:27
clean_rate:0.8865546218487395
noisy true:241
noisy false:273
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 514
epoch [87/200] batch [5/7] time 0.311 (0.303) data 0.263 (0.255) loss_x loss_x 0.2424 (0.2969) acc_x 96.8750 (91.2500) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 242
clean true:214
clean false:28
clean_rate:0.8842975206611571
noisy true:244
noisy false:266
after delete: len(clean_dataset) 242
after delete: len(noisy_dataset) 510
epoch [88/200] batch [5/7] time 0.316 (0.317) data 0.268 (0.268) loss_x loss_x 0.2588 (0.2524) acc_x 93.7500 (95.0000) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 300
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 235
clean true:209
clean false:26
clean_rate:0.8893617021276595
noisy true:243
noisy false:274
after delete: len(clean_dataset) 235
after delete: len(noisy_dataset) 517
epoch [89/200] batch [5/7] time 0.271 (0.275) data 0.224 (0.227) loss_x loss_x 0.1967 (0.2208) acc_x 93.7500 (95.0000) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 295
confident_label rate tensor(0.3178, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 239
clean true:216
clean false:23
clean_rate:0.9037656903765691
noisy true:241
noisy false:272
after delete: len(clean_dataset) 239
after delete: len(noisy_dataset) 513
epoch [90/200] batch [5/7] time 0.265 (0.257) data 0.214 (0.206) loss_x loss_x 0.4524 (0.3406) acc_x 87.5000 (88.7500) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 280
confident_label rate tensor(0.3271, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 246
clean true:221
clean false:25
clean_rate:0.8983739837398373
noisy true:251
noisy false:255
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 506
epoch [91/200] batch [5/7] time 0.346 (0.318) data 0.298 (0.271) loss_x loss_x 0.1597 (0.2032) acc_x 96.8750 (95.0000) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3138, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 236
clean true:211
clean false:25
clean_rate:0.8940677966101694
noisy true:256
noisy false:260
after delete: len(clean_dataset) 236
after delete: len(noisy_dataset) 516
epoch [92/200] batch [5/7] time 0.292 (0.324) data 0.242 (0.276) loss_x loss_x 0.0864 (0.1407) acc_x 100.0000 (98.1250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 249
clean true:220
clean false:29
clean_rate:0.8835341365461847
noisy true:240
noisy false:263
after delete: len(clean_dataset) 249
after delete: len(noisy_dataset) 503
epoch [93/200] batch [5/7] time 0.264 (0.261) data 0.214 (0.211) loss_x loss_x 0.2036 (0.2911) acc_x 100.0000 (95.0000) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 242
clean true:219
clean false:23
clean_rate:0.9049586776859504
noisy true:247
noisy false:263
after delete: len(clean_dataset) 242
after delete: len(noisy_dataset) 510
epoch [94/200] batch [5/7] time 0.356 (0.333) data 0.308 (0.285) loss_x loss_x 0.2335 (0.2794) acc_x 100.0000 (96.2500) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3165, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 238
clean true:211
clean false:27
clean_rate:0.8865546218487395
noisy true:249
noisy false:265
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 514
epoch [95/200] batch [5/7] time 0.268 (0.316) data 0.220 (0.268) loss_x loss_x 0.3025 (0.2789) acc_x 87.5000 (95.0000) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 252
clean true:225
clean false:27
clean_rate:0.8928571428571429
noisy true:245
noisy false:255
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 500
epoch [96/200] batch [5/7] time 0.314 (0.331) data 0.266 (0.283) loss_x loss_x 0.2086 (0.2848) acc_x 96.8750 (93.7500) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3285, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 247
clean true:219
clean false:28
clean_rate:0.8866396761133604
noisy true:239
noisy false:266
after delete: len(clean_dataset) 247
after delete: len(noisy_dataset) 505
epoch [97/200] batch [5/7] time 0.247 (0.258) data 0.199 (0.210) loss_x loss_x 0.2363 (0.2100) acc_x 93.7500 (95.6250) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 295
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 243
clean true:214
clean false:29
clean_rate:0.8806584362139918
noisy true:243
noisy false:266
after delete: len(clean_dataset) 243
after delete: len(noisy_dataset) 509
epoch [98/200] batch [5/7] time 0.324 (0.334) data 0.276 (0.286) loss_x loss_x 0.3936 (0.2819) acc_x 93.7500 (95.6250) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3258, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 245
clean true:217
clean false:28
clean_rate:0.8857142857142857
noisy true:245
noisy false:262
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 507
epoch [99/200] batch [5/7] time 0.302 (0.306) data 0.254 (0.258) loss_x loss_x 0.2062 (0.2015) acc_x 96.8750 (95.0000) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:227
clean false:30
clean_rate:0.8832684824902723
noisy true:240
noisy false:255
all clean rate:  [0.8285714285714286, 0.8852459016393442, 0.9736842105263158, 0.9504950495049505, 0.92, 0.9166666666666666, 0.9391304347826087, 0.9217391304347826, 0.9384615384615385, 0.95, 0.959349593495935, 0.9663865546218487, 0.9448818897637795, 0.9612403100775194, 0.9473684210526315, 0.9527027027027027, 0.9440559440559441, 0.9507042253521126, 0.9583333333333334, 0.9487179487179487, 0.9527027027027027, 0.9530201342281879, 0.954248366013072, 0.9548387096774194, 0.9371069182389937, 0.95, 0.9457831325301205, 0.9272727272727272, 0.9440993788819876, 0.9515151515151515, 0.9401197604790419, 0.9431818181818182, 0.927710843373494, 0.9378531073446328, 0.9375, 0.9298245614035088, 0.9364161849710982, 0.9520958083832335, 0.9365079365079365, 0.9398907103825137, 0.9285714285714286, 0.9368421052631579, 0.9251336898395722, 0.9267015706806283, 0.9157894736842105, 0.9109947643979057, 0.946524064171123, 0.9393939393939394, 0.9368421052631579, 0.9438775510204082, 0.9278350515463918, 0.9336734693877551, 0.9095477386934674, 0.9227053140096618, 0.9227053140096618, 0.919047619047619, 0.926829268292683, 0.9362745098039216, 0.9174757281553398, 0.9282296650717703, 0.9162790697674419, 0.908675799086758, 0.92018779342723, 0.9023255813953488, 0.8893805309734514, 0.9166666666666666, 0.8973214285714286, 0.9, 0.9026548672566371, 0.9230769230769231, 0.9082969432314411, 0.9009009009009009, 0.9094827586206896, 0.9113924050632911, 0.9039301310043668, 0.8969957081545065, 0.8973214285714286, 0.9017857142857143, 0.8755555555555555, 0.9017094017094017, 0.9, 0.907563025210084, 0.8974358974358975, 0.8917748917748918, 0.8969957081545065, 0.9047619047619048, 0.8865546218487395, 0.8842975206611571, 0.8893617021276595, 0.9037656903765691, 0.8983739837398373, 0.8940677966101694, 0.8835341365461847, 0.9049586776859504, 0.8865546218487395, 0.8928571428571429, 0.8866396761133604, 0.8806584362139918, 0.8857142857142857, 0.8832684824902723]
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [100/200] batch [5/8] time 0.292 (0.293) data 0.245 (0.245) loss_x loss_x 0.4482 (0.2961) acc_x 87.5000 (93.1250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3258, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 245
clean true:214
clean false:31
clean_rate:0.8734693877551021
noisy true:244
noisy false:263
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 507
epoch [101/200] batch [5/7] time 0.284 (0.306) data 0.237 (0.259) loss_x loss_x 0.1605 (0.2389) acc_x 100.0000 (96.8750) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3231, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 243
clean true:216
clean false:27
clean_rate:0.8888888888888888
noisy true:242
noisy false:267
after delete: len(clean_dataset) 243
after delete: len(noisy_dataset) 509
epoch [102/200] batch [5/7] time 0.358 (0.342) data 0.310 (0.294) loss_x loss_x 0.1519 (0.1644) acc_x 96.8750 (98.1250) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 306
confident_label rate tensor(0.3245, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 244
clean true:216
clean false:28
clean_rate:0.8852459016393442
noisy true:230
noisy false:278
after delete: len(clean_dataset) 244
after delete: len(noisy_dataset) 508
epoch [103/200] batch [5/7] time 0.289 (0.305) data 0.241 (0.257) loss_x loss_x 0.3740 (0.2399) acc_x 87.5000 (94.3750) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 308
confident_label rate tensor(0.3059, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 230
clean true:204
clean false:26
clean_rate:0.8869565217391304
noisy true:240
noisy false:282
after delete: len(clean_dataset) 230
after delete: len(noisy_dataset) 522
epoch [104/200] batch [5/7] time 0.281 (0.262) data 0.232 (0.213) loss_x loss_x 0.1669 (0.1778) acc_x 96.8750 (96.2500) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 295
confident_label rate tensor(0.3165, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 238
clean true:210
clean false:28
clean_rate:0.8823529411764706
noisy true:247
noisy false:267
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 514
epoch [105/200] batch [5/7] time 0.377 (0.328) data 0.328 (0.279) loss_x loss_x 0.4207 (0.2107) acc_x 93.7500 (96.2500) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 248
clean true:218
clean false:30
clean_rate:0.8790322580645161
noisy true:245
noisy false:259
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 504
epoch [106/200] batch [5/7] time 0.297 (0.330) data 0.248 (0.281) loss_x loss_x 0.2324 (0.1612) acc_x 93.7500 (97.5000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:221
clean false:29
clean_rate:0.884
noisy true:249
noisy false:253
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [107/200] batch [5/7] time 0.279 (0.274) data 0.229 (0.225) loss_x loss_x 0.5190 (0.2254) acc_x 81.2500 (94.3750) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 291
confident_label rate tensor(0.3258, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 245
clean true:215
clean false:30
clean_rate:0.8775510204081632
noisy true:246
noisy false:261
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 507
epoch [108/200] batch [5/7] time 0.330 (0.331) data 0.282 (0.282) loss_x loss_x 0.1438 (0.2123) acc_x 100.0000 (94.3750) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 241
clean true:215
clean false:26
clean_rate:0.8921161825726142
noisy true:247
noisy false:264
after delete: len(clean_dataset) 241
after delete: len(noisy_dataset) 511
epoch [109/200] batch [5/7] time 0.302 (0.297) data 0.254 (0.248) loss_x loss_x 0.1015 (0.1252) acc_x 100.0000 (98.1250) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 241
clean true:215
clean false:26
clean_rate:0.8921161825726142
noisy true:249
noisy false:262
after delete: len(clean_dataset) 241
after delete: len(noisy_dataset) 511
epoch [110/200] batch [5/7] time 0.276 (0.274) data 0.228 (0.226) loss_x loss_x 0.2289 (0.2118) acc_x 93.7500 (94.3750) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3285, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 247
clean true:221
clean false:26
clean_rate:0.8947368421052632
noisy true:243
noisy false:262
after delete: len(clean_dataset) 247
after delete: len(noisy_dataset) 505
epoch [111/200] batch [5/7] time 0.282 (0.326) data 0.234 (0.277) loss_x loss_x 0.3423 (0.2755) acc_x 90.6250 (93.1250) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3152, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 237
clean true:210
clean false:27
clean_rate:0.8860759493670886
noisy true:249
noisy false:266
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 515
epoch [112/200] batch [5/7] time 0.263 (0.294) data 0.215 (0.246) loss_x loss_x 0.1744 (0.2370) acc_x 96.8750 (95.6250) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 296
confident_label rate tensor(0.3191, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 240
clean true:214
clean false:26
clean_rate:0.8916666666666667
noisy true:242
noisy false:270
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 512
epoch [113/200] batch [5/7] time 0.304 (0.315) data 0.255 (0.266) loss_x loss_x 0.2068 (0.2446) acc_x 96.8750 (93.7500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 272
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 249
clean true:221
clean false:28
clean_rate:0.8875502008032129
noisy true:259
noisy false:244
after delete: len(clean_dataset) 249
after delete: len(noisy_dataset) 503
epoch [114/200] batch [5/7] time 0.283 (0.311) data 0.235 (0.263) loss_x loss_x 0.4861 (0.2348) acc_x 96.8750 (96.8750) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 242
clean true:216
clean false:26
clean_rate:0.8925619834710744
noisy true:248
noisy false:262
after delete: len(clean_dataset) 242
after delete: len(noisy_dataset) 510
epoch [115/200] batch [5/7] time 0.301 (0.305) data 0.253 (0.257) loss_x loss_x 0.1581 (0.2010) acc_x 93.7500 (95.0000) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 242
clean true:212
clean false:30
clean_rate:0.8760330578512396
noisy true:253
noisy false:257
after delete: len(clean_dataset) 242
after delete: len(noisy_dataset) 510
epoch [116/200] batch [5/7] time 0.259 (0.328) data 0.208 (0.279) loss_x loss_x 0.1775 (0.1663) acc_x 90.6250 (96.2500) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3271, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 246
clean true:216
clean false:30
clean_rate:0.8780487804878049
noisy true:243
noisy false:263
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 506
epoch [117/200] batch [5/7] time 0.302 (0.304) data 0.254 (0.256) loss_x loss_x 0.1377 (0.1902) acc_x 100.0000 (96.2500) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 281
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 248
clean true:218
clean false:30
clean_rate:0.8790322580645161
noisy true:253
noisy false:251
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 504
epoch [118/200] batch [5/7] time 0.281 (0.310) data 0.233 (0.261) loss_x loss_x 0.1542 (0.2812) acc_x 96.8750 (95.0000) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:219
clean false:31
clean_rate:0.876
noisy true:245
noisy false:257
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [119/200] batch [5/7] time 0.282 (0.282) data 0.234 (0.234) loss_x loss_x 0.2571 (0.1817) acc_x 90.6250 (95.0000) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 291
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:219
clean false:31
clean_rate:0.876
noisy true:242
noisy false:260
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [120/200] batch [5/7] time 0.265 (0.325) data 0.214 (0.277) loss_x loss_x 0.1646 (0.1766) acc_x 96.8750 (95.0000) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3191, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 240
clean true:211
clean false:29
clean_rate:0.8791666666666667
noisy true:247
noisy false:265
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 512
epoch [121/200] batch [5/7] time 0.342 (0.331) data 0.295 (0.283) loss_x loss_x 0.2473 (0.1757) acc_x 93.7500 (96.8750) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 297
confident_label rate tensor(0.3258, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 245
clean true:214
clean false:31
clean_rate:0.8734693877551021
noisy true:241
noisy false:266
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 507
epoch [122/200] batch [5/7] time 0.275 (0.268) data 0.224 (0.218) loss_x loss_x 0.1816 (0.1699) acc_x 93.7500 (96.2500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 301
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 249
clean true:219
clean false:30
clean_rate:0.8795180722891566
noisy true:232
noisy false:271
after delete: len(clean_dataset) 249
after delete: len(noisy_dataset) 503
epoch [123/200] batch [5/7] time 0.301 (0.320) data 0.254 (0.272) loss_x loss_x 0.1766 (0.1534) acc_x 96.8750 (96.8750) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 253
clean true:224
clean false:29
clean_rate:0.8853754940711462
noisy true:240
noisy false:259
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 499
epoch [124/200] batch [5/7] time 0.325 (0.313) data 0.278 (0.265) loss_x loss_x 0.1345 (0.2012) acc_x 96.8750 (96.8750) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 248
clean true:217
clean false:31
clean_rate:0.875
noisy true:241
noisy false:263
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 504
epoch [125/200] batch [5/7] time 0.289 (0.304) data 0.242 (0.257) loss_x loss_x 0.1396 (0.1546) acc_x 100.0000 (98.1250) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 248
clean true:219
clean false:29
clean_rate:0.8830645161290323
noisy true:246
noisy false:258
after delete: len(clean_dataset) 248
after delete: len(noisy_dataset) 504
epoch [126/200] batch [5/7] time 0.321 (0.312) data 0.273 (0.264) loss_x loss_x 0.1442 (0.1888) acc_x 96.8750 (95.6250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 302
confident_label rate tensor(0.3285, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 247
clean true:216
clean false:31
clean_rate:0.8744939271255061
noisy true:234
noisy false:271
after delete: len(clean_dataset) 247
after delete: len(noisy_dataset) 505
epoch [127/200] batch [5/7] time 0.252 (0.265) data 0.202 (0.215) loss_x loss_x 0.0992 (0.1710) acc_x 100.0000 (96.2500) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3338, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 251
clean true:220
clean false:31
clean_rate:0.8764940239043825
noisy true:242
noisy false:259
after delete: len(clean_dataset) 251
after delete: len(noisy_dataset) 501
epoch [128/200] batch [5/7] time 0.372 (0.324) data 0.324 (0.276) loss_x loss_x 0.1159 (0.1684) acc_x 100.0000 (97.5000) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3338, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 251
clean true:220
clean false:31
clean_rate:0.8764940239043825
noisy true:244
noisy false:257
after delete: len(clean_dataset) 251
after delete: len(noisy_dataset) 501
epoch [129/200] batch [5/7] time 0.343 (0.323) data 0.296 (0.275) loss_x loss_x 0.1881 (0.1696) acc_x 96.8750 (97.5000) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 277
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 242
clean true:217
clean false:25
clean_rate:0.8966942148760331
noisy true:258
noisy false:252
after delete: len(clean_dataset) 242
after delete: len(noisy_dataset) 510
epoch [130/200] batch [5/7] time 0.252 (0.266) data 0.205 (0.218) loss_x loss_x 0.2834 (0.1584) acc_x 90.6250 (96.2500) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 278
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:230
clean false:29
clean_rate:0.888030888030888
noisy true:244
noisy false:249
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [131/200] batch [5/8] time 0.292 (0.309) data 0.244 (0.261) loss_x loss_x 0.0925 (0.1668) acc_x 100.0000 (98.7500) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:228
clean false:28
clean_rate:0.890625
noisy true:241
noisy false:255
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [132/200] batch [5/8] time 0.274 (0.305) data 0.226 (0.256) loss_x loss_x 0.0709 (0.1396) acc_x 100.0000 (97.5000) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 291
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 253
clean true:223
clean false:30
clean_rate:0.8814229249011858
noisy true:238
noisy false:261
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 499
epoch [133/200] batch [5/7] time 0.256 (0.271) data 0.206 (0.219) loss_x loss_x 0.1276 (0.1393) acc_x 100.0000 (96.8750) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 291
confident_label rate tensor(0.3338, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 251
clean true:220
clean false:31
clean_rate:0.8764940239043825
noisy true:241
noisy false:260
after delete: len(clean_dataset) 251
after delete: len(noisy_dataset) 501
epoch [134/200] batch [5/7] time 0.312 (0.328) data 0.264 (0.280) loss_x loss_x 0.1074 (0.1373) acc_x 100.0000 (96.2500) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 276
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 249
clean true:220
clean false:29
clean_rate:0.8835341365461847
noisy true:256
noisy false:247
after delete: len(clean_dataset) 249
after delete: len(noisy_dataset) 503
epoch [135/200] batch [5/7] time 0.327 (0.320) data 0.279 (0.271) loss_x loss_x 0.3528 (0.2797) acc_x 96.8750 (96.2500) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 278
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:223
clean false:31
clean_rate:0.8779527559055118
noisy true:251
noisy false:247
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [136/200] batch [5/7] time 0.271 (0.251) data 0.223 (0.203) loss_x loss_x 0.0898 (0.1734) acc_x 96.8750 (95.0000) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:224
clean false:33
clean_rate:0.8715953307392996
noisy true:241
noisy false:254
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [137/200] batch [5/8] time 0.277 (0.299) data 0.229 (0.251) loss_x loss_x 0.2493 (0.1647) acc_x 93.7500 (96.2500) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 272
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:224
clean false:33
clean_rate:0.8715953307392996
noisy true:256
noisy false:239
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [138/200] batch [5/8] time 0.276 (0.311) data 0.228 (0.262) loss_x loss_x 0.1205 (0.1067) acc_x 96.8750 (98.7500) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:227
clean false:31
clean_rate:0.8798449612403101
noisy true:242
noisy false:252
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [139/200] batch [5/8] time 0.284 (0.255) data 0.236 (0.207) loss_x loss_x 0.0994 (0.1908) acc_x 100.0000 (95.6250) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 293
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:222
clean false:32
clean_rate:0.8740157480314961
noisy true:237
noisy false:261
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [140/200] batch [5/7] time 0.325 (0.315) data 0.277 (0.267) loss_x loss_x 0.1576 (0.1423) acc_x 100.0000 (98.1250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3285, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 247
clean true:214
clean false:33
clean_rate:0.8663967611336032
noisy true:251
noisy false:254
after delete: len(clean_dataset) 247
after delete: len(noisy_dataset) 505
epoch [141/200] batch [5/7] time 0.316 (0.309) data 0.267 (0.261) loss_x loss_x 0.1210 (0.1669) acc_x 96.8750 (97.5000) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:221
clean false:29
clean_rate:0.884
noisy true:249
noisy false:253
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [142/200] batch [5/7] time 0.286 (0.286) data 0.239 (0.238) loss_x loss_x 0.2091 (0.1925) acc_x 93.7500 (95.0000) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3351, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 252
clean true:221
clean false:31
clean_rate:0.876984126984127
noisy true:248
noisy false:252
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 500
epoch [143/200] batch [5/7] time 0.310 (0.329) data 0.262 (0.282) loss_x loss_x 0.1476 (0.1182) acc_x 100.0000 (98.7500) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 280
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:224
clean false:32
clean_rate:0.875
noisy true:248
noisy false:248
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [144/200] batch [5/8] time 0.330 (0.328) data 0.282 (0.280) loss_x loss_x 0.0554 (0.1615) acc_x 100.0000 (97.5000) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 276
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 255
clean true:223
clean false:32
clean_rate:0.8745098039215686
noisy true:253
noisy false:244
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 497
epoch [145/200] batch [5/7] time 0.322 (0.318) data 0.271 (0.270) loss_x loss_x 0.1644 (0.2069) acc_x 96.8750 (96.8750) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:223
clean false:31
clean_rate:0.8779527559055118
noisy true:241
noisy false:257
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [146/200] batch [5/7] time 0.321 (0.310) data 0.272 (0.262) loss_x loss_x 0.4050 (0.1710) acc_x 87.5000 (96.2500) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 249
clean true:221
clean false:28
clean_rate:0.8875502008032129
noisy true:241
noisy false:262
after delete: len(clean_dataset) 249
after delete: len(noisy_dataset) 503
epoch [147/200] batch [5/7] time 0.319 (0.317) data 0.271 (0.268) loss_x loss_x 0.2150 (0.1535) acc_x 90.6250 (96.8750) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 276
confident_label rate tensor(0.3484, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 262
clean true:228
clean false:34
clean_rate:0.8702290076335878
noisy true:248
noisy false:242
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 490
epoch [148/200] batch [5/8] time 0.284 (0.290) data 0.237 (0.242) loss_x loss_x 0.1179 (0.2140) acc_x 100.0000 (98.1250) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:223
clean false:33
clean_rate:0.87109375
noisy true:243
noisy false:253
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [149/200] batch [5/8] time 0.334 (0.313) data 0.286 (0.265) loss_x loss_x 0.3672 (0.1845) acc_x 90.6250 (96.8750) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:223
clean false:33
clean_rate:0.87109375
noisy true:239
noisy false:257
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [150/200] batch [5/8] time 0.304 (0.324) data 0.256 (0.276) loss_x loss_x 0.0696 (0.1435) acc_x 100.0000 (97.5000) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:222
clean false:34
clean_rate:0.8671875
noisy true:238
noisy false:258
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [151/200] batch [5/8] time 0.307 (0.315) data 0.258 (0.267) loss_x loss_x 0.1199 (0.2144) acc_x 96.8750 (96.8750) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 273
confident_label rate tensor(0.3471, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 261
clean true:231
clean false:30
clean_rate:0.8850574712643678
noisy true:248
noisy false:243
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 491
epoch [152/200] batch [5/8] time 0.329 (0.302) data 0.280 (0.254) loss_x loss_x 0.1541 (0.1657) acc_x 96.8750 (96.2500) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 301
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:218
clean false:32
clean_rate:0.872
noisy true:233
noisy false:269
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [153/200] batch [5/7] time 0.275 (0.334) data 0.228 (0.285) loss_x loss_x 0.0829 (0.0844) acc_x 100.0000 (99.3750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 280
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 260
clean true:228
clean false:32
clean_rate:0.8769230769230769
noisy true:244
noisy false:248
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 492
epoch [154/200] batch [5/8] time 0.296 (0.323) data 0.248 (0.275) loss_x loss_x 0.1864 (0.2111) acc_x 93.7500 (95.0000) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 255
clean true:225
clean false:30
clean_rate:0.8823529411764706
noisy true:238
noisy false:259
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 497
epoch [155/200] batch [5/7] time 0.313 (0.299) data 0.265 (0.251) loss_x loss_x 0.0904 (0.1232) acc_x 100.0000 (98.1250) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:228
clean false:29
clean_rate:0.8871595330739299
noisy true:239
noisy false:256
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [156/200] batch [5/8] time 0.246 (0.258) data 0.198 (0.211) loss_x loss_x 0.1575 (0.1089) acc_x 96.8750 (98.7500) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:225
clean false:32
clean_rate:0.8754863813229572
noisy true:245
noisy false:250
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [157/200] batch [5/8] time 0.331 (0.319) data 0.282 (0.271) loss_x loss_x 0.2505 (0.1809) acc_x 93.7500 (96.2500) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:224
clean false:34
clean_rate:0.8682170542635659
noisy true:246
noisy false:248
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [158/200] batch [5/8] time 0.296 (0.328) data 0.246 (0.279) loss_x loss_x 0.0943 (0.1911) acc_x 96.8750 (97.5000) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 249
clean true:218
clean false:31
clean_rate:0.8755020080321285
noisy true:248
noisy false:255
after delete: len(clean_dataset) 249
after delete: len(noisy_dataset) 503
epoch [159/200] batch [5/7] time 0.297 (0.258) data 0.250 (0.210) loss_x loss_x 0.0814 (0.1251) acc_x 96.8750 (97.5000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 281
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 255
clean true:220
clean false:35
clean_rate:0.8627450980392157
noisy true:251
noisy false:246
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 497
epoch [160/200] batch [5/7] time 0.273 (0.301) data 0.225 (0.253) loss_x loss_x 0.2203 (0.2275) acc_x 93.7500 (94.3750) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 255
clean true:222
clean false:33
clean_rate:0.8705882352941177
noisy true:244
noisy false:253
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 497
epoch [161/200] batch [5/7] time 0.273 (0.307) data 0.225 (0.258) loss_x loss_x 0.1469 (0.1582) acc_x 96.8750 (96.2500) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 275
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:224
clean false:33
clean_rate:0.8715953307392996
noisy true:253
noisy false:242
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [162/200] batch [5/8] time 0.254 (0.264) data 0.203 (0.215) loss_x loss_x 0.0740 (0.2037) acc_x 100.0000 (96.8750) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:223
clean false:35
clean_rate:0.8643410852713178
noisy true:243
noisy false:251
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [163/200] batch [5/8] time 0.281 (0.312) data 0.233 (0.263) loss_x loss_x 0.2095 (0.1681) acc_x 96.8750 (98.1250) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 281
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:223
clean false:31
clean_rate:0.8779527559055118
noisy true:248
noisy false:250
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [164/200] batch [5/7] time 0.265 (0.310) data 0.217 (0.262) loss_x loss_x 0.1403 (0.1525) acc_x 93.7500 (96.8750) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 268
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:229
clean false:29
clean_rate:0.8875968992248062
noisy true:255
noisy false:239
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [165/200] batch [5/8] time 0.273 (0.262) data 0.225 (0.212) loss_x loss_x 0.1615 (0.1516) acc_x 96.8750 (96.8750) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 273
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:226
clean false:31
clean_rate:0.8793774319066148
noisy true:253
noisy false:242
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [166/200] batch [5/8] time 0.288 (0.320) data 0.240 (0.272) loss_x loss_x 0.3369 (0.1686) acc_x 90.6250 (96.8750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:225
clean false:34
clean_rate:0.8687258687258688
noisy true:239
noisy false:254
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [167/200] batch [5/8] time 0.350 (0.322) data 0.302 (0.274) loss_x loss_x 0.0724 (0.2301) acc_x 100.0000 (95.6250) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:225
clean false:31
clean_rate:0.87890625
noisy true:239
noisy false:257
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [168/200] batch [5/8] time 0.262 (0.265) data 0.214 (0.218) loss_x loss_x 0.0709 (0.1264) acc_x 100.0000 (98.1250) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3324, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 250
clean true:223
clean false:27
clean_rate:0.892
noisy true:247
noisy false:255
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 502
epoch [169/200] batch [5/7] time 0.332 (0.327) data 0.284 (0.278) loss_x loss_x 0.0685 (0.0982) acc_x 100.0000 (99.3750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 279
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:225
clean false:32
clean_rate:0.8754863813229572
noisy true:248
noisy false:247
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [170/200] batch [5/8] time 0.378 (0.319) data 0.330 (0.270) loss_x loss_x 0.3088 (0.1353) acc_x 90.6250 (96.8750) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 253
clean true:218
clean false:35
clean_rate:0.8616600790513834
noisy true:244
noisy false:255
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 499
epoch [171/200] batch [5/7] time 0.259 (0.263) data 0.212 (0.216) loss_x loss_x 0.2810 (0.1777) acc_x 96.8750 (96.8750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 287
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:226
clean false:32
clean_rate:0.875968992248062
noisy true:239
noisy false:255
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [172/200] batch [5/8] time 0.332 (0.310) data 0.283 (0.262) loss_x loss_x 0.1731 (0.1224) acc_x 96.8750 (98.7500) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 292
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 253
clean true:221
clean false:32
clean_rate:0.8735177865612648
noisy true:239
noisy false:260
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 499
epoch [173/200] batch [5/7] time 0.330 (0.321) data 0.279 (0.272) loss_x loss_x 0.1681 (0.2060) acc_x 96.8750 (95.6250) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 276
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:226
clean false:30
clean_rate:0.8828125
noisy true:250
noisy false:246
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [174/200] batch [5/8] time 0.318 (0.308) data 0.270 (0.260) loss_x loss_x 0.0612 (0.1449) acc_x 100.0000 (96.8750) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3484, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 262
clean true:226
clean false:36
clean_rate:0.8625954198473282
noisy true:238
noisy false:252
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 490
epoch [175/200] batch [5/8] time 0.324 (0.328) data 0.276 (0.280) loss_x loss_x 0.2450 (0.1348) acc_x 93.7500 (98.1250) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3471, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 261
clean true:226
clean false:35
clean_rate:0.8659003831417624
noisy true:232
noisy false:259
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 491
epoch [176/200] batch [5/8] time 0.298 (0.320) data 0.250 (0.272) loss_x loss_x 0.1937 (0.1894) acc_x 93.7500 (95.0000) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 285
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 259
clean true:228
clean false:31
clean_rate:0.8803088803088803
noisy true:239
noisy false:254
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 493
epoch [177/200] batch [5/8] time 0.299 (0.315) data 0.251 (0.267) loss_x loss_x 0.0949 (0.1314) acc_x 100.0000 (97.5000) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 291
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 253
clean true:221
clean false:32
clean_rate:0.8735177865612648
noisy true:240
noisy false:259
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 499
epoch [178/200] batch [5/7] time 0.248 (0.278) data 0.199 (0.230) loss_x loss_x 0.2242 (0.1691) acc_x 96.8750 (98.1250) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3484, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 262
clean true:228
clean false:34
clean_rate:0.8702290076335878
noisy true:236
noisy false:254
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 490
epoch [179/200] batch [5/8] time 0.311 (0.307) data 0.262 (0.259) loss_x loss_x 0.0663 (0.1187) acc_x 100.0000 (98.7500) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 288
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:226
clean false:31
clean_rate:0.8793774319066148
noisy true:238
noisy false:257
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [180/200] batch [5/8] time 0.272 (0.282) data 0.224 (0.234) loss_x loss_x 0.3154 (0.1704) acc_x 93.7500 (97.5000) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 279
confident_label rate tensor(0.3497, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 263
clean true:227
clean false:36
clean_rate:0.8631178707224335
noisy true:246
noisy false:243
after delete: len(clean_dataset) 263
after delete: len(noisy_dataset) 489
epoch [181/200] batch [5/8] time 0.260 (0.252) data 0.212 (0.204) loss_x loss_x 0.1065 (0.1809) acc_x 100.0000 (96.2500) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 299
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:225
clean false:33
clean_rate:0.872093023255814
noisy true:228
noisy false:266
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [182/200] batch [5/8] time 0.272 (0.297) data 0.225 (0.250) loss_x loss_x 0.0359 (0.1133) acc_x 100.0000 (98.1250) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 282
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 253
clean true:221
clean false:32
clean_rate:0.8735177865612648
noisy true:249
noisy false:250
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 499
epoch [183/200] batch [5/7] time 0.331 (0.298) data 0.283 (0.250) loss_x loss_x 0.2500 (0.1637) acc_x 93.7500 (95.6250) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:226
clean false:32
clean_rate:0.875968992248062
noisy true:236
noisy false:258
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [184/200] batch [5/8] time 0.267 (0.278) data 0.219 (0.229) loss_x loss_x 0.1154 (0.1387) acc_x 100.0000 (95.6250) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 277
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:228
clean false:30
clean_rate:0.8837209302325582
noisy true:247
noisy false:247
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [185/200] batch [5/8] time 0.268 (0.256) data 0.221 (0.207) loss_x loss_x 0.0935 (0.0920) acc_x 100.0000 (98.7500) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 260
clean true:223
clean false:37
clean_rate:0.8576923076923076
noisy true:246
noisy false:246
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 492
epoch [186/200] batch [5/8] time 0.286 (0.295) data 0.238 (0.247) loss_x loss_x 0.2195 (0.2210) acc_x 96.8750 (96.8750) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 277
confident_label rate tensor(0.3537, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 266
clean true:233
clean false:33
clean_rate:0.8759398496240601
noisy true:242
noisy false:244
after delete: len(clean_dataset) 266
after delete: len(noisy_dataset) 486
epoch [187/200] batch [5/8] time 0.258 (0.284) data 0.210 (0.236) loss_x loss_x 0.1006 (0.1082) acc_x 100.0000 (98.7500) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3471, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 261
clean true:226
clean false:35
clean_rate:0.8659003831417624
noisy true:243
noisy false:248
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 491
epoch [188/200] batch [5/8] time 0.269 (0.271) data 0.222 (0.224) loss_x loss_x 0.0875 (0.1743) acc_x 100.0000 (96.2500) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 284
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:223
clean false:31
clean_rate:0.8779527559055118
noisy true:245
noisy false:253
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [189/200] batch [5/7] time 0.233 (0.275) data 0.185 (0.227) loss_x loss_x 0.1901 (0.1635) acc_x 96.8750 (97.5000) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:225
clean false:31
clean_rate:0.87890625
noisy true:238
noisy false:258
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [190/200] batch [5/8] time 0.260 (0.264) data 0.212 (0.216) loss_x loss_x 0.0801 (0.1495) acc_x 100.0000 (96.8750) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 294
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:223
clean false:34
clean_rate:0.867704280155642
noisy true:235
noisy false:260
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [191/200] batch [5/8] time 0.245 (0.252) data 0.197 (0.204) loss_x loss_x 0.1046 (0.1568) acc_x 100.0000 (96.8750) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 255
clean true:224
clean false:31
clean_rate:0.8784313725490196
noisy true:245
noisy false:252
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 497
epoch [192/200] batch [5/7] time 0.250 (0.287) data 0.202 (0.240) loss_x loss_x 0.0714 (0.1214) acc_x 100.0000 (97.5000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 289
confident_label rate tensor(0.3471, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 261
clean true:229
clean false:32
clean_rate:0.8773946360153256
noisy true:234
noisy false:257
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 491
epoch [193/200] batch [5/8] time 0.279 (0.267) data 0.231 (0.219) loss_x loss_x 0.3230 (0.1481) acc_x 90.6250 (97.5000) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 283
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 258
clean true:225
clean false:33
clean_rate:0.872093023255814
noisy true:244
noisy false:250
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 494
epoch [194/200] batch [5/8] time 0.269 (0.272) data 0.221 (0.224) loss_x loss_x 0.0554 (0.0903) acc_x 100.0000 (99.3750) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 286
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 255
clean true:222
clean false:33
clean_rate:0.8705882352941177
noisy true:244
noisy false:253
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 497
epoch [195/200] batch [5/7] time 0.261 (0.259) data 0.213 (0.212) loss_x loss_x 0.0962 (0.0921) acc_x 100.0000 (98.7500) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3457, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 260
clean true:225
clean false:35
clean_rate:0.8653846153846154
noisy true:237
noisy false:255
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 492
epoch [196/200] batch [5/8] time 0.301 (0.260) data 0.252 (0.212) loss_x loss_x 0.0850 (0.1428) acc_x 100.0000 (96.2500) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 273
confident_label rate tensor(0.3378, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 254
clean true:224
clean false:30
clean_rate:0.8818897637795275
noisy true:255
noisy false:243
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 498
epoch [197/200] batch [5/7] time 0.234 (0.264) data 0.187 (0.216) loss_x loss_x 0.2037 (0.1575) acc_x 93.7500 (96.8750) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 270
confident_label rate tensor(0.3404, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 256
clean true:223
clean false:33
clean_rate:0.87109375
noisy true:259
noisy false:237
after delete: len(clean_dataset) 256
after delete: len(noisy_dataset) 496
epoch [198/200] batch [5/8] time 0.262 (0.266) data 0.215 (0.218) loss_x loss_x 0.2053 (0.1507) acc_x 93.7500 (95.6250) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 290
confident_label rate tensor(0.3418, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 257
clean true:227
clean false:30
clean_rate:0.8832684824902723
noisy true:235
noisy false:260
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 495
epoch [199/200] batch [5/8] time 0.245 (0.260) data 0.197 (0.213) loss_x loss_x 0.0859 (0.0917) acc_x 100.0000 (99.3750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
[OT_PL] Loading all features and outputs... Total samples: 736
[OT_PL] Features shape: torch.Size([736, 1024]), Outputs shape: torch.Size([736, 47])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([736, 47]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([736]), b.shape=torch.Size([47]), P.shape=torch.Size([736, 47]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([736, 47])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 752
before epoch:different number: 276
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 752
before: len of confident samples 255
clean true:224
clean false:31
clean_rate:0.8784313725490196
noisy true:252
noisy false:245
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 497
epoch [200/200] batch [5/7] time 0.254 (0.261) data 0.206 (0.214) loss_x loss_x 0.1410 (0.1240) acc_x 96.8750 (98.7500) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/dtd/NLPrompt/rn50_16shots/noise_sym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 752
after epoch: len(noisy dataset) 752
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 1,692
* correct: 862
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 50.9%
Elapsed: 0:32:53
