***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '101']
output_dir: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.1572, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 254
clean true:249
clean false:5
clean_rate:0.9803149606299213
noisy true:263
noisy false:1099
after delete: len(clean_dataset) 254
after delete: len(noisy_dataset) 1362
epoch [1/200] batch [5/7] time 0.231 (0.258) data 0.105 (0.114) loss_x loss_x 2.4023 (2.5742) acc_x 65.6250 (50.0000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1021
confident_label rate tensor(0.1832, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 296
clean true:294
clean false:2
clean_rate:0.9932432432432432
noisy true:301
noisy false:1019
after delete: len(clean_dataset) 296
after delete: len(noisy_dataset) 1320
epoch [2/200] batch [5/9] time 0.214 (0.217) data 0.087 (0.100) loss_x loss_x 1.3506 (1.5871) acc_x 65.6250 (62.5000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 861
confident_label rate tensor(0.2364, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 382
clean true:377
clean false:5
clean_rate:0.9869109947643979
noisy true:378
noisy false:856
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1234
epoch [3/200] batch [5/11] time 0.229 (0.227) data 0.105 (0.102) loss_x loss_x 1.8145 (1.3958) acc_x 62.5000 (66.2500) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/11] time 0.210 (0.222) data 0.087 (0.098) loss_x loss_x 1.6768 (1.3776) acc_x 62.5000 (66.5625) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 826
confident_label rate tensor(0.2481, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 401
clean true:398
clean false:3
clean_rate:0.9925187032418953
noisy true:392
noisy false:823
after delete: len(clean_dataset) 401
after delete: len(noisy_dataset) 1215
epoch [4/200] batch [5/12] time 0.232 (0.227) data 0.109 (0.097) loss_x loss_x 1.3740 (1.2754) acc_x 59.3750 (67.5000) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/12] time 0.227 (0.226) data 0.105 (0.099) loss_x loss_x 1.4961 (1.2797) acc_x 65.6250 (70.0000) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 824
confident_label rate tensor(0.2512, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 406
clean true:401
clean false:5
clean_rate:0.9876847290640394
noisy true:391
noisy false:819
after delete: len(clean_dataset) 406
after delete: len(noisy_dataset) 1210
epoch [5/200] batch [5/12] time 0.224 (0.237) data 0.100 (0.113) loss_x loss_x 1.2637 (1.2092) acc_x 62.5000 (67.5000) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/12] time 0.256 (0.236) data 0.133 (0.112) loss_x loss_x 0.5127 (1.0775) acc_x 87.5000 (72.5000) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 803
confident_label rate tensor(0.2488, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 402
clean true:399
clean false:3
clean_rate:0.9925373134328358
noisy true:414
noisy false:800
after delete: len(clean_dataset) 402
after delete: len(noisy_dataset) 1214
epoch [6/200] batch [5/12] time 0.223 (0.231) data 0.096 (0.106) loss_x loss_x 1.2510 (1.1391) acc_x 75.0000 (72.5000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/12] time 0.222 (0.230) data 0.095 (0.105) loss_x loss_x 0.4375 (1.0573) acc_x 90.6250 (74.0625) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 776
confident_label rate tensor(0.2525, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 408
clean true:404
clean false:4
clean_rate:0.9901960784313726
noisy true:436
noisy false:772
after delete: len(clean_dataset) 408
after delete: len(noisy_dataset) 1208
epoch [7/200] batch [5/12] time 0.211 (0.216) data 0.084 (0.091) loss_x loss_x 1.2480 (0.9496) acc_x 78.1250 (80.0000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/12] time 0.183 (0.209) data 0.106 (0.093) loss_x loss_x 0.9297 (0.9629) acc_x 78.1250 (75.0000) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 759
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 437
clean true:434
clean false:3
clean_rate:0.9931350114416476
noisy true:423
noisy false:756
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1179
epoch [8/200] batch [5/13] time 0.207 (0.220) data 0.082 (0.102) loss_x loss_x 1.2480 (1.1253) acc_x 68.7500 (70.0000) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/13] time 0.218 (0.221) data 0.091 (0.100) loss_x loss_x 1.2041 (1.1441) acc_x 68.7500 (69.0625) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 797
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 409
clean true:405
clean false:4
clean_rate:0.9902200488997555
noisy true:414
noisy false:793
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1207
epoch [9/200] batch [5/12] time 0.235 (0.234) data 0.109 (0.121) loss_x loss_x 1.1729 (1.1251) acc_x 68.7500 (73.1250) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [10/12] time 0.242 (0.233) data 0.116 (0.114) loss_x loss_x 1.3105 (1.1526) acc_x 71.8750 (70.9375) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 777
confident_label rate tensor(0.2636, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 426
clean true:422
clean false:4
clean_rate:0.9906103286384976
noisy true:417
noisy false:773
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1190
epoch [10/200] batch [5/13] time 0.232 (0.213) data 0.108 (0.107) loss_x loss_x 1.2422 (1.0710) acc_x 68.7500 (72.5000) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/13] time 0.224 (0.225) data 0.097 (0.109) loss_x loss_x 1.6504 (1.1578) acc_x 62.5000 (70.0000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 786
confident_label rate tensor(0.2723, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 440
clean true:435
clean false:5
clean_rate:0.9886363636363636
noisy true:395
noisy false:781
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 1176
epoch [11/200] batch [5/13] time 0.206 (0.233) data 0.082 (0.108) loss_x loss_x 1.0801 (1.1191) acc_x 68.7500 (74.3750) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/13] time 0.213 (0.229) data 0.090 (0.105) loss_x loss_x 0.7188 (1.0001) acc_x 87.5000 (76.5625) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 761
confident_label rate tensor(0.2679, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 433
clean true:431
clean false:2
clean_rate:0.9953810623556582
noisy true:424
noisy false:759
after delete: len(clean_dataset) 433
after delete: len(noisy_dataset) 1183
epoch [12/200] batch [5/13] time 0.285 (0.255) data 0.164 (0.132) loss_x loss_x 0.5977 (0.6976) acc_x 87.5000 (83.7500) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/13] time 0.216 (0.239) data 0.103 (0.118) loss_x loss_x 1.3730 (0.9303) acc_x 65.6250 (78.1250) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 737
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 456
clean true:449
clean false:7
clean_rate:0.9846491228070176
noisy true:430
noisy false:730
after delete: len(clean_dataset) 456
after delete: len(noisy_dataset) 1160
epoch [13/200] batch [5/14] time 0.230 (0.232) data 0.106 (0.107) loss_x loss_x 1.0107 (1.0324) acc_x 71.8750 (71.2500) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/14] time 0.204 (0.228) data 0.081 (0.104) loss_x loss_x 1.2236 (1.0292) acc_x 71.8750 (73.1250) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 778
confident_label rate tensor(0.2661, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 430
clean true:427
clean false:3
clean_rate:0.9930232558139535
noisy true:411
noisy false:775
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1186
epoch [14/200] batch [5/13] time 0.221 (0.208) data 0.098 (0.084) loss_x loss_x 0.8325 (0.9281) acc_x 81.2500 (74.3750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/13] time 0.206 (0.214) data 0.082 (0.091) loss_x loss_x 1.1289 (1.0310) acc_x 75.0000 (72.1875) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 753
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 437
clean true:435
clean false:2
clean_rate:0.9954233409610984
noisy true:428
noisy false:751
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1179
epoch [15/200] batch [5/13] time 0.288 (0.238) data 0.161 (0.121) loss_x loss_x 0.7339 (1.0050) acc_x 81.2500 (73.1250) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [10/13] time 0.220 (0.233) data 0.095 (0.112) loss_x loss_x 0.9258 (0.9264) acc_x 84.3750 (77.1875) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 739
confident_label rate tensor(0.2748, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 444
clean true:442
clean false:2
clean_rate:0.9954954954954955
noisy true:435
noisy false:737
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 1172
epoch [16/200] batch [5/13] time 0.222 (0.219) data 0.096 (0.109) loss_x loss_x 1.1289 (0.9515) acc_x 71.8750 (75.6250) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [10/13] time 0.224 (0.222) data 0.096 (0.105) loss_x loss_x 1.2666 (0.9730) acc_x 71.8750 (75.6250) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 476
clean true:474
clean false:2
clean_rate:0.9957983193277311
noisy true:449
noisy false:691
after delete: len(clean_dataset) 476
after delete: len(noisy_dataset) 1140
epoch [17/200] batch [5/14] time 0.208 (0.222) data 0.082 (0.097) loss_x loss_x 1.1299 (0.9800) acc_x 68.7500 (75.0000) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/14] time 0.208 (0.220) data 0.087 (0.095) loss_x loss_x 0.8525 (1.0088) acc_x 81.2500 (73.7500) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 726
confident_label rate tensor(0.2809, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 454
clean true:449
clean false:5
clean_rate:0.9889867841409692
noisy true:441
noisy false:721
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1162
epoch [18/200] batch [5/14] time 0.216 (0.203) data 0.092 (0.097) loss_x loss_x 0.7681 (1.0351) acc_x 68.7500 (70.6250) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/14] time 0.253 (0.219) data 0.128 (0.103) loss_x loss_x 0.6812 (0.9739) acc_x 81.2500 (72.5000) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 740
confident_label rate tensor(0.2754, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 445
clean true:442
clean false:3
clean_rate:0.9932584269662922
noisy true:434
noisy false:737
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1171
epoch [19/200] batch [5/13] time 0.234 (0.233) data 0.109 (0.109) loss_x loss_x 1.0156 (1.1221) acc_x 68.7500 (74.3750) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/13] time 0.233 (0.228) data 0.110 (0.110) loss_x loss_x 1.1709 (1.0396) acc_x 78.1250 (75.3125) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 722
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 456
clean true:451
clean false:5
clean_rate:0.9890350877192983
noisy true:443
noisy false:717
after delete: len(clean_dataset) 456
after delete: len(noisy_dataset) 1160
epoch [20/200] batch [5/14] time 0.225 (0.230) data 0.100 (0.104) loss_x loss_x 1.0371 (0.9114) acc_x 68.7500 (77.5000) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/14] time 0.220 (0.231) data 0.098 (0.106) loss_x loss_x 1.0254 (0.9227) acc_x 78.1250 (76.8750) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 723
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 456
clean true:454
clean false:2
clean_rate:0.9956140350877193
noisy true:439
noisy false:721
after delete: len(clean_dataset) 456
after delete: len(noisy_dataset) 1160
epoch [21/200] batch [5/14] time 0.225 (0.218) data 0.099 (0.093) loss_x loss_x 0.7622 (0.9247) acc_x 81.2500 (77.5000) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/14] time 0.232 (0.221) data 0.107 (0.097) loss_x loss_x 1.1230 (0.9056) acc_x 71.8750 (76.2500) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 709
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 471
clean true:467
clean false:4
clean_rate:0.9915074309978769
noisy true:440
noisy false:705
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1145
epoch [22/200] batch [5/14] time 0.230 (0.231) data 0.107 (0.106) loss_x loss_x 1.3848 (1.0238) acc_x 59.3750 (72.5000) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/14] time 0.226 (0.227) data 0.102 (0.102) loss_x loss_x 1.0596 (0.9220) acc_x 68.7500 (74.6875) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 720
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 456
clean true:453
clean false:3
clean_rate:0.993421052631579
noisy true:443
noisy false:717
after delete: len(clean_dataset) 456
after delete: len(noisy_dataset) 1160
epoch [23/200] batch [5/14] time 0.237 (0.225) data 0.112 (0.100) loss_x loss_x 1.2490 (0.8391) acc_x 62.5000 (77.5000) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/14] time 0.222 (0.231) data 0.100 (0.107) loss_x loss_x 1.1445 (0.8757) acc_x 65.6250 (75.9375) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 709
confident_label rate tensor(0.2847, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 460
clean true:459
clean false:1
clean_rate:0.9978260869565218
noisy true:448
noisy false:708
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1156
epoch [24/200] batch [5/14] time 0.219 (0.242) data 0.096 (0.117) loss_x loss_x 0.5576 (0.8912) acc_x 78.1250 (73.1250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/14] time 0.247 (0.234) data 0.122 (0.110) loss_x loss_x 0.6250 (0.9144) acc_x 87.5000 (73.4375) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 683
confident_label rate tensor(0.3032, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 490
clean true:486
clean false:4
clean_rate:0.9918367346938776
noisy true:447
noisy false:679
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1126
epoch [25/200] batch [5/15] time 0.214 (0.218) data 0.087 (0.092) loss_x loss_x 0.8564 (0.7323) acc_x 78.1250 (80.6250) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/15] time 0.208 (0.202) data 0.082 (0.089) loss_x loss_x 0.9360 (0.8706) acc_x 71.8750 (77.8125) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [15/15] time 0.236 (0.210) data 0.112 (0.093) loss_x loss_x 1.4404 (0.8857) acc_x 65.6250 (78.3333) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 696
confident_label rate tensor(0.2976, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 481
clean true:478
clean false:3
clean_rate:0.9937629937629938
noisy true:442
noisy false:693
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1135
epoch [26/200] batch [5/15] time 0.233 (0.231) data 0.107 (0.107) loss_x loss_x 0.9546 (0.8687) acc_x 71.8750 (78.1250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/15] time 0.315 (0.237) data 0.190 (0.113) loss_x loss_x 0.7329 (0.9207) acc_x 87.5000 (78.1250) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/15] time 0.208 (0.230) data 0.086 (0.106) loss_x loss_x 0.9058 (0.9302) acc_x 71.8750 (76.8750) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.3026, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 489
clean true:485
clean false:4
clean_rate:0.9918200408997955
noisy true:455
noisy false:672
after delete: len(clean_dataset) 489
after delete: len(noisy_dataset) 1127
epoch [27/200] batch [5/15] time 0.249 (0.240) data 0.126 (0.116) loss_x loss_x 1.6191 (1.1031) acc_x 65.6250 (73.1250) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/15] time 0.244 (0.237) data 0.115 (0.111) loss_x loss_x 0.8750 (1.0366) acc_x 65.6250 (72.8125) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/15] time 0.258 (0.235) data 0.132 (0.111) loss_x loss_x 0.6162 (0.9738) acc_x 87.5000 (74.3750) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.3051, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 493
clean true:489
clean false:4
clean_rate:0.9918864097363083
noisy true:475
noisy false:648
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1123
epoch [28/200] batch [5/15] time 0.199 (0.236) data 0.117 (0.119) loss_x loss_x 1.3340 (1.0069) acc_x 59.3750 (73.7500) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/15] time 0.226 (0.216) data 0.102 (0.108) loss_x loss_x 1.3320 (0.9123) acc_x 65.6250 (78.1250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/15] time 0.233 (0.218) data 0.109 (0.105) loss_x loss_x 0.5942 (0.8884) acc_x 75.0000 (77.0833) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.3069, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 496
clean true:492
clean false:4
clean_rate:0.9919354838709677
noisy true:465
noisy false:655
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1120
epoch [29/200] batch [5/15] time 0.230 (0.238) data 0.108 (0.114) loss_x loss_x 0.6895 (0.7050) acc_x 75.0000 (80.6250) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/15] time 0.231 (0.237) data 0.107 (0.113) loss_x loss_x 0.7461 (0.8818) acc_x 81.2500 (76.5625) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/15] time 0.231 (0.230) data 0.107 (0.110) loss_x loss_x 0.4851 (0.8553) acc_x 84.3750 (77.2917) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 673
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:497
clean false:2
clean_rate:0.9959919839679359
noisy true:446
noisy false:671
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [30/200] batch [5/15] time 0.211 (0.231) data 0.086 (0.108) loss_x loss_x 0.6641 (0.9201) acc_x 81.2500 (79.3750) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/15] time 0.230 (0.230) data 0.108 (0.106) loss_x loss_x 0.7373 (0.7938) acc_x 81.2500 (80.6250) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/15] time 0.224 (0.230) data 0.100 (0.106) loss_x loss_x 0.5737 (0.8080) acc_x 84.3750 (80.0000) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 672
confident_label rate tensor(0.3001, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 485
clean true:483
clean false:2
clean_rate:0.9958762886597938
noisy true:461
noisy false:670
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1131
epoch [31/200] batch [5/15] time 0.229 (0.230) data 0.105 (0.106) loss_x loss_x 0.6636 (0.9654) acc_x 90.6250 (76.8750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/15] time 0.249 (0.224) data 0.122 (0.099) loss_x loss_x 0.7275 (0.8828) acc_x 78.1250 (78.7500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/15] time 0.219 (0.222) data 0.092 (0.101) loss_x loss_x 0.8003 (0.9192) acc_x 75.0000 (77.9167) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 658
confident_label rate tensor(0.3082, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 498
clean true:496
clean false:2
clean_rate:0.9959839357429718
noisy true:462
noisy false:656
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1118
epoch [32/200] batch [5/15] time 0.212 (0.208) data 0.087 (0.099) loss_x loss_x 0.9185 (0.8536) acc_x 75.0000 (78.7500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/15] time 0.238 (0.217) data 0.115 (0.101) loss_x loss_x 0.7236 (0.8322) acc_x 81.2500 (79.0625) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/15] time 0.217 (0.220) data 0.093 (0.101) loss_x loss_x 0.9277 (0.8514) acc_x 75.0000 (77.5000) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 641
confident_label rate tensor(0.3193, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 516
clean true:513
clean false:3
clean_rate:0.9941860465116279
noisy true:462
noisy false:638
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1100
epoch [33/200] batch [5/16] time 0.242 (0.228) data 0.117 (0.116) loss_x loss_x 1.1650 (0.9203) acc_x 68.7500 (78.1250) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/16] time 0.233 (0.232) data 0.108 (0.114) loss_x loss_x 1.1104 (0.8740) acc_x 65.6250 (77.5000) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/16] time 0.217 (0.230) data 0.091 (0.110) loss_x loss_x 0.6445 (0.8449) acc_x 81.2500 (78.7500) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.2995, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 484
clean true:483
clean false:1
clean_rate:0.9979338842975206
noisy true:462
noisy false:670
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1132
epoch [34/200] batch [5/15] time 0.271 (0.237) data 0.125 (0.126) loss_x loss_x 1.5518 (0.9867) acc_x 59.3750 (76.2500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/15] time 0.211 (0.236) data 0.087 (0.118) loss_x loss_x 0.3564 (0.8673) acc_x 93.7500 (77.8125) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/15] time 0.216 (0.234) data 0.091 (0.114) loss_x loss_x 0.5649 (0.8495) acc_x 87.5000 (78.3333) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 641
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:499
clean false:2
clean_rate:0.9960079840319361
noisy true:476
noisy false:639
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [35/200] batch [5/15] time 0.225 (0.233) data 0.101 (0.116) loss_x loss_x 0.6899 (0.7295) acc_x 81.2500 (81.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/15] time 0.247 (0.231) data 0.122 (0.109) loss_x loss_x 0.5684 (0.7634) acc_x 84.3750 (78.4375) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/15] time 0.215 (0.226) data 0.090 (0.104) loss_x loss_x 0.6479 (0.8303) acc_x 87.5000 (77.7083) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:492
clean false:2
clean_rate:0.9959514170040485
noisy true:442
noisy false:680
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [36/200] batch [5/15] time 0.245 (0.226) data 0.121 (0.113) loss_x loss_x 0.5830 (0.7587) acc_x 84.3750 (83.1250) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/15] time 0.223 (0.227) data 0.099 (0.109) loss_x loss_x 0.9907 (0.8332) acc_x 78.1250 (80.6250) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/15] time 0.234 (0.226) data 0.111 (0.106) loss_x loss_x 0.8198 (0.8126) acc_x 81.2500 (80.4167) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 665
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:498
clean false:3
clean_rate:0.9940119760479041
noisy true:453
noisy false:662
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [37/200] batch [5/15] time 0.237 (0.224) data 0.111 (0.110) loss_x loss_x 0.9087 (0.7541) acc_x 78.1250 (82.5000) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/15] time 0.220 (0.233) data 0.098 (0.114) loss_x loss_x 1.0781 (0.9080) acc_x 68.7500 (77.5000) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/15] time 0.227 (0.234) data 0.104 (0.113) loss_x loss_x 1.5918 (0.9859) acc_x 65.6250 (74.7917) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 691
confident_label rate tensor(0.3020, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 488
clean true:485
clean false:3
clean_rate:0.9938524590163934
noisy true:440
noisy false:688
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1128
epoch [38/200] batch [5/15] time 0.219 (0.225) data 0.095 (0.102) loss_x loss_x 0.8018 (0.9505) acc_x 75.0000 (75.0000) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/15] time 0.219 (0.213) data 0.095 (0.099) loss_x loss_x 1.1201 (0.8399) acc_x 71.8750 (77.5000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/15] time 0.212 (0.217) data 0.088 (0.100) loss_x loss_x 0.5898 (0.8670) acc_x 81.2500 (76.4583) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 661
confident_label rate tensor(0.3026, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 489
clean true:486
clean false:3
clean_rate:0.9938650306748467
noisy true:469
noisy false:658
after delete: len(clean_dataset) 489
after delete: len(noisy_dataset) 1127
epoch [39/200] batch [5/15] time 0.229 (0.245) data 0.101 (0.118) loss_x loss_x 1.0967 (0.8525) acc_x 75.0000 (80.6250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/15] time 0.233 (0.238) data 0.103 (0.111) loss_x loss_x 0.9585 (0.8357) acc_x 71.8750 (79.6875) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/15] time 0.235 (0.236) data 0.109 (0.110) loss_x loss_x 0.7773 (0.8590) acc_x 81.2500 (78.1250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 505
clean true:500
clean false:5
clean_rate:0.9900990099009901
noisy true:471
noisy false:640
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1111
epoch [40/200] batch [5/15] time 0.224 (0.216) data 0.147 (0.115) loss_x loss_x 0.5957 (0.7033) acc_x 90.6250 (83.7500) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/15] time 0.228 (0.224) data 0.103 (0.108) loss_x loss_x 0.6260 (0.7840) acc_x 90.6250 (81.2500) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/15] time 0.219 (0.223) data 0.092 (0.104) loss_x loss_x 0.7256 (0.8045) acc_x 78.1250 (79.5833) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 654
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:502
clean false:5
clean_rate:0.9901380670611439
noisy true:460
noisy false:649
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [41/200] batch [5/15] time 0.235 (0.241) data 0.108 (0.115) loss_x loss_x 0.7280 (0.8354) acc_x 84.3750 (77.5000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/15] time 0.229 (0.239) data 0.107 (0.114) loss_x loss_x 0.8940 (0.8426) acc_x 68.7500 (77.5000) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/15] time 0.229 (0.236) data 0.106 (0.111) loss_x loss_x 0.7954 (0.8671) acc_x 71.8750 (76.2500) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 641
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 509
clean true:508
clean false:1
clean_rate:0.9980353634577603
noisy true:467
noisy false:640
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1107
epoch [42/200] batch [5/15] time 0.218 (0.241) data 0.092 (0.114) loss_x loss_x 0.8687 (0.9908) acc_x 81.2500 (76.8750) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/15] time 0.181 (0.228) data 0.105 (0.108) loss_x loss_x 0.3311 (0.7919) acc_x 93.7500 (80.3125) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/15] time 0.232 (0.228) data 0.105 (0.107) loss_x loss_x 0.6348 (0.7884) acc_x 78.1250 (79.7917) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:516
clean false:6
clean_rate:0.9885057471264368
noisy true:456
noisy false:638
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [43/200] batch [5/16] time 0.230 (0.231) data 0.108 (0.114) loss_x loss_x 0.4824 (0.7094) acc_x 87.5000 (83.1250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/16] time 0.229 (0.232) data 0.107 (0.112) loss_x loss_x 1.1318 (0.8260) acc_x 71.8750 (79.6875) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/16] time 0.230 (0.233) data 0.107 (0.112) loss_x loss_x 0.8101 (0.8251) acc_x 71.8750 (80.4167) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 524
clean true:521
clean false:3
clean_rate:0.9942748091603053
noisy true:449
noisy false:643
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1092
epoch [44/200] batch [5/16] time 0.221 (0.232) data 0.096 (0.114) loss_x loss_x 0.9434 (1.0146) acc_x 78.1250 (69.3750) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/16] time 0.225 (0.235) data 0.101 (0.114) loss_x loss_x 0.7061 (0.9976) acc_x 78.1250 (72.5000) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/16] time 0.207 (0.230) data 0.084 (0.108) loss_x loss_x 0.8438 (0.9645) acc_x 75.0000 (73.9583) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 653
confident_label rate tensor(0.3168, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 512
clean true:510
clean false:2
clean_rate:0.99609375
noisy true:453
noisy false:651
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1104
epoch [45/200] batch [5/16] time 0.224 (0.228) data 0.098 (0.102) loss_x loss_x 0.5034 (0.5977) acc_x 81.2500 (84.3750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/16] time 0.234 (0.225) data 0.110 (0.100) loss_x loss_x 0.7153 (0.6381) acc_x 78.1250 (82.8125) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/16] time 0.237 (0.227) data 0.108 (0.101) loss_x loss_x 0.8618 (0.6679) acc_x 78.1250 (82.0833) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:502
clean false:5
clean_rate:0.9901380670611439
noisy true:455
noisy false:654
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [46/200] batch [5/15] time 0.221 (0.225) data 0.096 (0.100) loss_x loss_x 0.5161 (0.7229) acc_x 90.6250 (83.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/15] time 0.219 (0.225) data 0.091 (0.100) loss_x loss_x 0.8887 (0.7501) acc_x 78.1250 (82.5000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/15] time 0.167 (0.217) data 0.088 (0.099) loss_x loss_x 0.6206 (0.7693) acc_x 84.3750 (81.8750) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:519
clean false:3
clean_rate:0.9942528735632183
noisy true:460
noisy false:634
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [47/200] batch [5/16] time 0.168 (0.212) data 0.091 (0.097) loss_x loss_x 0.8032 (0.7808) acc_x 78.1250 (80.0000) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/16] time 0.221 (0.216) data 0.099 (0.097) loss_x loss_x 1.2803 (0.9201) acc_x 68.7500 (76.8750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/16] time 0.229 (0.220) data 0.108 (0.100) loss_x loss_x 0.7305 (0.8621) acc_x 81.2500 (78.1250) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:506
clean false:5
clean_rate:0.9902152641878669
noisy true:461
noisy false:644
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [48/200] batch [5/15] time 0.245 (0.224) data 0.119 (0.107) loss_x loss_x 1.1064 (0.7177) acc_x 68.7500 (81.8750) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/15] time 0.234 (0.226) data 0.108 (0.106) loss_x loss_x 0.4109 (0.7592) acc_x 93.7500 (80.0000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/15] time 0.274 (0.233) data 0.148 (0.111) loss_x loss_x 0.6099 (0.7189) acc_x 78.1250 (80.4167) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 643
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:510
clean false:4
clean_rate:0.9922178988326849
noisy true:463
noisy false:639
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [49/200] batch [5/16] time 0.227 (0.197) data 0.101 (0.092) loss_x loss_x 0.7344 (0.7143) acc_x 78.1250 (80.6250) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/16] time 0.217 (0.209) data 0.092 (0.093) loss_x loss_x 0.9780 (0.7038) acc_x 71.8750 (80.3125) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/16] time 0.230 (0.215) data 0.106 (0.097) loss_x loss_x 0.5806 (0.7088) acc_x 90.6250 (82.2917) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:526
clean false:5
clean_rate:0.9905838041431262
noisy true:453
noisy false:632
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [50/200] batch [5/16] time 0.243 (0.232) data 0.115 (0.106) loss_x loss_x 0.6392 (0.9239) acc_x 84.3750 (78.1250) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/16] time 0.218 (0.228) data 0.090 (0.102) loss_x loss_x 0.7124 (0.7924) acc_x 84.3750 (80.9375) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/16] time 0.218 (0.227) data 0.093 (0.102) loss_x loss_x 0.6577 (0.7642) acc_x 87.5000 (81.6667) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:543
clean false:4
clean_rate:0.9926873857404022
noisy true:460
noisy false:609
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [51/200] batch [5/17] time 0.266 (0.238) data 0.139 (0.113) loss_x loss_x 0.9429 (0.7281) acc_x 78.1250 (84.3750) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/17] time 0.255 (0.234) data 0.132 (0.109) loss_x loss_x 0.8950 (0.7566) acc_x 78.1250 (80.9375) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/17] time 0.230 (0.233) data 0.107 (0.109) loss_x loss_x 0.5537 (0.7658) acc_x 81.2500 (79.5833) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.3280, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 530
clean true:526
clean false:4
clean_rate:0.9924528301886792
noisy true:480
noisy false:606
after delete: len(clean_dataset) 530
after delete: len(noisy_dataset) 1086
epoch [52/200] batch [5/16] time 0.220 (0.237) data 0.095 (0.113) loss_x loss_x 0.8472 (0.8808) acc_x 84.3750 (76.8750) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/16] time 0.240 (0.237) data 0.114 (0.112) loss_x loss_x 1.0156 (0.8939) acc_x 78.1250 (77.1875) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/16] time 0.226 (0.229) data 0.103 (0.110) loss_x loss_x 1.0293 (0.8659) acc_x 68.7500 (77.9167) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.3342, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 540
clean true:537
clean false:3
clean_rate:0.9944444444444445
noisy true:462
noisy false:614
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 1076
epoch [53/200] batch [5/16] time 0.225 (0.230) data 0.101 (0.106) loss_x loss_x 0.9976 (0.7602) acc_x 71.8750 (77.5000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/16] time 0.231 (0.226) data 0.107 (0.103) loss_x loss_x 0.5049 (0.8204) acc_x 84.3750 (76.8750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/16] time 0.234 (0.226) data 0.110 (0.102) loss_x loss_x 0.5845 (0.8454) acc_x 78.1250 (76.6667) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 634
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 518
clean true:514
clean false:4
clean_rate:0.9922779922779923
noisy true:468
noisy false:630
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1098
epoch [54/200] batch [5/16] time 0.159 (0.216) data 0.082 (0.099) loss_x loss_x 0.6846 (0.8415) acc_x 78.1250 (75.0000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/16] time 0.276 (0.232) data 0.147 (0.113) loss_x loss_x 0.2756 (0.7358) acc_x 90.6250 (80.6250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/16] time 0.225 (0.229) data 0.102 (0.108) loss_x loss_x 0.7588 (0.7411) acc_x 84.3750 (79.7917) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.3236, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 523
clean true:519
clean false:4
clean_rate:0.9923518164435946
noisy true:448
noisy false:645
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1093
epoch [55/200] batch [5/16] time 0.229 (0.226) data 0.104 (0.102) loss_x loss_x 0.6855 (0.7108) acc_x 81.2500 (82.5000) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/16] time 0.217 (0.219) data 0.094 (0.095) loss_x loss_x 0.4541 (0.6752) acc_x 90.6250 (83.1250) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/16] time 0.221 (0.223) data 0.094 (0.099) loss_x loss_x 0.6133 (0.6578) acc_x 84.3750 (83.5417) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 640
confident_label rate tensor(0.3274, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 529
clean true:526
clean false:3
clean_rate:0.994328922495274
noisy true:450
noisy false:637
after delete: len(clean_dataset) 529
after delete: len(noisy_dataset) 1087
epoch [56/200] batch [5/16] time 0.220 (0.233) data 0.097 (0.110) loss_x loss_x 0.7944 (0.6202) acc_x 84.3750 (84.3750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/16] time 0.225 (0.228) data 0.101 (0.107) loss_x loss_x 0.5933 (0.7351) acc_x 87.5000 (82.5000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/16] time 0.257 (0.229) data 0.133 (0.108) loss_x loss_x 0.7808 (0.7604) acc_x 81.2500 (80.8333) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 643
confident_label rate tensor(0.3280, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 530
clean true:527
clean false:3
clean_rate:0.9943396226415094
noisy true:446
noisy false:640
after delete: len(clean_dataset) 530
after delete: len(noisy_dataset) 1086
epoch [57/200] batch [5/16] time 0.174 (0.199) data 0.091 (0.101) loss_x loss_x 0.8281 (0.7946) acc_x 71.8750 (76.8750) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/16] time 0.225 (0.212) data 0.099 (0.100) loss_x loss_x 0.9316 (0.8657) acc_x 78.1250 (78.1250) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/16] time 0.220 (0.214) data 0.097 (0.098) loss_x loss_x 0.6875 (0.8263) acc_x 81.2500 (79.5833) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:540
clean false:8
clean_rate:0.9854014598540146
noisy true:480
noisy false:588
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [58/200] batch [5/17] time 0.244 (0.213) data 0.117 (0.108) loss_x loss_x 1.0693 (0.9007) acc_x 71.8750 (78.7500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/17] time 0.233 (0.220) data 0.107 (0.105) loss_x loss_x 0.8452 (0.8211) acc_x 68.7500 (78.4375) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/17] time 0.220 (0.224) data 0.100 (0.106) loss_x loss_x 0.8403 (0.7982) acc_x 78.1250 (78.9583) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 541
clean true:539
clean false:2
clean_rate:0.9963031423290203
noisy true:472
noisy false:603
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1075
epoch [59/200] batch [5/16] time 0.230 (0.220) data 0.105 (0.101) loss_x loss_x 1.0391 (0.8206) acc_x 78.1250 (78.1250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/16] time 0.211 (0.220) data 0.087 (0.098) loss_x loss_x 0.9404 (0.8648) acc_x 71.8750 (78.4375) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/16] time 0.222 (0.225) data 0.099 (0.103) loss_x loss_x 0.8501 (0.8470) acc_x 75.0000 (78.3333) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.3397, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 549
clean true:546
clean false:3
clean_rate:0.994535519125683
noisy true:474
noisy false:593
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1067
epoch [60/200] batch [5/17] time 0.183 (0.217) data 0.107 (0.101) loss_x loss_x 0.6157 (0.7901) acc_x 84.3750 (81.2500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/17] time 0.241 (0.214) data 0.114 (0.101) loss_x loss_x 0.6699 (0.8008) acc_x 90.6250 (81.2500) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/17] time 0.230 (0.220) data 0.105 (0.102) loss_x loss_x 0.5913 (0.7735) acc_x 90.6250 (80.8333) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.3274, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 529
clean true:526
clean false:3
clean_rate:0.994328922495274
noisy true:451
noisy false:636
after delete: len(clean_dataset) 529
after delete: len(noisy_dataset) 1087
epoch [61/200] batch [5/16] time 0.227 (0.223) data 0.101 (0.098) loss_x loss_x 0.4055 (0.5552) acc_x 90.6250 (85.0000) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/16] time 0.233 (0.223) data 0.109 (0.098) loss_x loss_x 0.5518 (0.6200) acc_x 84.3750 (84.3750) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/16] time 0.220 (0.224) data 0.095 (0.098) loss_x loss_x 0.6279 (0.7155) acc_x 78.1250 (81.4583) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 553
clean true:549
clean false:4
clean_rate:0.9927667269439421
noisy true:446
noisy false:617
after delete: len(clean_dataset) 553
after delete: len(noisy_dataset) 1063
epoch [62/200] batch [5/17] time 0.236 (0.226) data 0.108 (0.102) loss_x loss_x 0.8545 (0.8113) acc_x 87.5000 (82.5000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/17] time 0.240 (0.215) data 0.112 (0.100) loss_x loss_x 0.5459 (0.7802) acc_x 87.5000 (81.8750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/17] time 0.230 (0.220) data 0.105 (0.102) loss_x loss_x 0.5845 (0.7629) acc_x 81.2500 (82.0833) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.3236, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 523
clean true:522
clean false:1
clean_rate:0.9980879541108987
noisy true:474
noisy false:619
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1093
epoch [63/200] batch [5/16] time 0.218 (0.215) data 0.089 (0.105) loss_x loss_x 0.8569 (0.8709) acc_x 75.0000 (77.5000) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/16] time 0.224 (0.223) data 0.102 (0.105) loss_x loss_x 0.9185 (0.8826) acc_x 75.0000 (77.5000) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/16] time 0.229 (0.228) data 0.103 (0.109) loss_x loss_x 0.4104 (0.8503) acc_x 90.6250 (78.5417) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 611
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 537
clean true:534
clean false:3
clean_rate:0.994413407821229
noisy true:471
noisy false:608
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1079
epoch [64/200] batch [5/16] time 0.226 (0.213) data 0.100 (0.106) loss_x loss_x 0.3711 (0.6742) acc_x 93.7500 (80.6250) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/16] time 0.231 (0.227) data 0.108 (0.111) loss_x loss_x 0.2974 (0.6479) acc_x 93.7500 (83.1250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/16] time 0.233 (0.227) data 0.109 (0.109) loss_x loss_x 0.5234 (0.6475) acc_x 84.3750 (82.2917) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 612
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:541
clean false:6
clean_rate:0.9890310786106032
noisy true:463
noisy false:606
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [65/200] batch [5/17] time 0.235 (0.228) data 0.112 (0.110) loss_x loss_x 1.3994 (1.1018) acc_x 62.5000 (72.5000) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/17] time 0.226 (0.231) data 0.102 (0.110) loss_x loss_x 0.4458 (0.8942) acc_x 90.6250 (76.5625) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/17] time 0.216 (0.226) data 0.093 (0.104) loss_x loss_x 0.4539 (0.8519) acc_x 87.5000 (78.9583) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 601
confident_label rate tensor(0.3410, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 551
clean true:545
clean false:6
clean_rate:0.9891107078039928
noisy true:470
noisy false:595
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1065
epoch [66/200] batch [5/17] time 0.248 (0.239) data 0.124 (0.114) loss_x loss_x 0.2129 (0.6174) acc_x 93.7500 (84.3750) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/17] time 0.227 (0.236) data 0.105 (0.112) loss_x loss_x 1.4121 (0.7734) acc_x 59.3750 (79.6875) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/17] time 0.238 (0.236) data 0.112 (0.112) loss_x loss_x 1.1162 (0.7784) acc_x 59.3750 (79.5833) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.3304, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 534
clean true:532
clean false:2
clean_rate:0.9962546816479401
noisy true:478
noisy false:604
after delete: len(clean_dataset) 534
after delete: len(noisy_dataset) 1082
epoch [67/200] batch [5/16] time 0.232 (0.199) data 0.107 (0.101) loss_x loss_x 0.7207 (0.5384) acc_x 81.2500 (86.2500) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/16] time 0.227 (0.215) data 0.101 (0.103) loss_x loss_x 0.5981 (0.6573) acc_x 78.1250 (82.8125) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/16] time 0.237 (0.220) data 0.113 (0.104) loss_x loss_x 0.9512 (0.6535) acc_x 78.1250 (82.7083) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 622
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:527
clean false:4
clean_rate:0.992467043314501
noisy true:467
noisy false:618
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [68/200] batch [5/16] time 0.247 (0.235) data 0.124 (0.106) loss_x loss_x 0.9741 (0.7554) acc_x 68.7500 (79.3750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/16] time 0.233 (0.230) data 0.109 (0.103) loss_x loss_x 0.7241 (0.7106) acc_x 84.3750 (81.8750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/16] time 0.229 (0.230) data 0.106 (0.105) loss_x loss_x 0.4011 (0.6878) acc_x 81.2500 (80.8333) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.3354, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 542
clean true:540
clean false:2
clean_rate:0.996309963099631
noisy true:458
noisy false:616
after delete: len(clean_dataset) 542
after delete: len(noisy_dataset) 1074
epoch [69/200] batch [5/16] time 0.221 (0.188) data 0.096 (0.089) loss_x loss_x 0.6631 (0.6353) acc_x 78.1250 (83.7500) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/16] time 0.237 (0.212) data 0.112 (0.100) loss_x loss_x 0.8022 (0.7104) acc_x 81.2500 (81.5625) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/16] time 0.229 (0.223) data 0.107 (0.107) loss_x loss_x 0.4534 (0.6782) acc_x 87.5000 (82.5000) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 565
confident_label rate tensor(0.3509, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 567
clean true:563
clean false:4
clean_rate:0.9929453262786596
noisy true:488
noisy false:561
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1049
epoch [70/200] batch [5/17] time 0.217 (0.225) data 0.092 (0.107) loss_x loss_x 0.7119 (0.7071) acc_x 81.2500 (78.7500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/17] time 0.258 (0.223) data 0.131 (0.101) loss_x loss_x 0.6265 (0.7695) acc_x 84.3750 (79.0625) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/17] time 0.231 (0.224) data 0.104 (0.102) loss_x loss_x 0.8770 (0.7931) acc_x 81.2500 (78.9583) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 533
clean true:529
clean false:4
clean_rate:0.9924953095684803
noisy true:493
noisy false:590
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1083
epoch [71/200] batch [5/16] time 0.248 (0.228) data 0.121 (0.099) loss_x loss_x 0.5508 (0.6087) acc_x 84.3750 (86.8750) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/16] time 0.233 (0.236) data 0.107 (0.108) loss_x loss_x 0.5601 (0.6980) acc_x 90.6250 (85.0000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/16] time 0.228 (0.233) data 0.102 (0.106) loss_x loss_x 0.7471 (0.6864) acc_x 81.2500 (84.3750) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 608
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:544
clean false:4
clean_rate:0.9927007299270073
noisy true:464
noisy false:604
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [72/200] batch [5/17] time 0.230 (0.240) data 0.105 (0.108) loss_x loss_x 0.6694 (0.6931) acc_x 84.3750 (80.0000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/17] time 0.233 (0.236) data 0.108 (0.108) loss_x loss_x 0.6362 (0.7409) acc_x 87.5000 (81.5625) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/17] time 0.234 (0.236) data 0.109 (0.110) loss_x loss_x 0.6821 (0.7488) acc_x 81.2500 (81.0417) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:544
clean false:3
clean_rate:0.9945155393053017
noisy true:459
noisy false:610
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [73/200] batch [5/17] time 0.236 (0.226) data 0.113 (0.103) loss_x loss_x 0.6836 (0.5855) acc_x 81.2500 (83.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/17] time 0.219 (0.225) data 0.094 (0.101) loss_x loss_x 1.0400 (0.6639) acc_x 75.0000 (82.1875) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/17] time 0.220 (0.224) data 0.095 (0.100) loss_x loss_x 0.4741 (0.6829) acc_x 84.3750 (81.2500) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.3403, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 550
clean true:547
clean false:3
clean_rate:0.9945454545454545
noisy true:470
noisy false:596
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1066
epoch [74/200] batch [5/17] time 0.187 (0.219) data 0.111 (0.102) loss_x loss_x 0.4719 (0.6525) acc_x 93.7500 (86.8750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/17] time 0.287 (0.217) data 0.164 (0.104) loss_x loss_x 0.9717 (0.6928) acc_x 75.0000 (83.1250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/17] time 0.227 (0.223) data 0.104 (0.107) loss_x loss_x 0.7622 (0.7125) acc_x 81.2500 (81.4583) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 553
clean true:546
clean false:7
clean_rate:0.9873417721518988
noisy true:468
noisy false:595
after delete: len(clean_dataset) 553
after delete: len(noisy_dataset) 1063
epoch [75/200] batch [5/17] time 0.250 (0.230) data 0.127 (0.118) loss_x loss_x 0.6938 (0.7678) acc_x 78.1250 (83.7500) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/17] time 0.232 (0.232) data 0.107 (0.113) loss_x loss_x 0.8857 (0.7954) acc_x 81.2500 (82.1875) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/17] time 0.217 (0.231) data 0.091 (0.110) loss_x loss_x 0.8955 (0.8429) acc_x 78.1250 (80.6250) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 608
confident_label rate tensor(0.3379, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 546
clean true:540
clean false:6
clean_rate:0.989010989010989
noisy true:468
noisy false:602
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 1070
epoch [76/200] batch [5/17] time 0.225 (0.220) data 0.100 (0.095) loss_x loss_x 0.5977 (0.8244) acc_x 87.5000 (77.5000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/17] time 0.270 (0.238) data 0.146 (0.113) loss_x loss_x 0.6265 (0.7059) acc_x 81.2500 (81.5625) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/17] time 0.234 (0.239) data 0.108 (0.113) loss_x loss_x 0.4897 (0.7285) acc_x 93.7500 (81.2500) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 580
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 576
clean true:573
clean false:3
clean_rate:0.9947916666666666
noisy true:463
noisy false:577
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1040
epoch [77/200] batch [5/18] time 0.231 (0.233) data 0.106 (0.108) loss_x loss_x 0.4817 (0.6482) acc_x 81.2500 (81.2500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/18] time 0.222 (0.231) data 0.095 (0.105) loss_x loss_x 0.8979 (0.7464) acc_x 75.0000 (80.0000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/18] time 0.238 (0.230) data 0.113 (0.105) loss_x loss_x 0.7891 (0.7723) acc_x 81.2500 (80.6250) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.3472, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 561
clean true:555
clean false:6
clean_rate:0.9893048128342246
noisy true:451
noisy false:604
after delete: len(clean_dataset) 561
after delete: len(noisy_dataset) 1055
epoch [78/200] batch [5/17] time 0.229 (0.233) data 0.106 (0.109) loss_x loss_x 1.0557 (0.7971) acc_x 68.7500 (80.0000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/17] time 0.217 (0.231) data 0.091 (0.107) loss_x loss_x 0.6021 (0.7129) acc_x 84.3750 (83.4375) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/17] time 0.231 (0.230) data 0.108 (0.106) loss_x loss_x 0.9839 (0.7058) acc_x 71.8750 (82.9167) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 555
clean true:550
clean false:5
clean_rate:0.990990990990991
noisy true:461
noisy false:600
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1061
epoch [79/200] batch [5/17] time 0.229 (0.229) data 0.106 (0.109) loss_x loss_x 0.6357 (0.8366) acc_x 84.3750 (84.3750) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/17] time 0.265 (0.232) data 0.143 (0.111) loss_x loss_x 0.5996 (0.7041) acc_x 93.7500 (85.9375) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/17] time 0.232 (0.240) data 0.108 (0.119) loss_x loss_x 0.6455 (0.7048) acc_x 84.3750 (83.3333) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.3478, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 562
clean true:555
clean false:7
clean_rate:0.9875444839857651
noisy true:479
noisy false:575
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1054
epoch [80/200] batch [5/17] time 0.159 (0.194) data 0.083 (0.098) loss_x loss_x 0.5928 (0.7894) acc_x 84.3750 (79.3750) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/17] time 0.225 (0.219) data 0.100 (0.106) loss_x loss_x 0.3091 (0.7364) acc_x 93.7500 (80.9375) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/17] time 0.237 (0.226) data 0.112 (0.109) loss_x loss_x 0.3572 (0.7414) acc_x 96.8750 (82.2917) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 568
confident_label rate tensor(0.3521, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 569
clean true:566
clean false:3
clean_rate:0.9947275922671354
noisy true:482
noisy false:565
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1047
epoch [81/200] batch [5/17] time 0.253 (0.238) data 0.129 (0.114) loss_x loss_x 0.5454 (0.8179) acc_x 87.5000 (79.3750) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/17] time 0.237 (0.235) data 0.113 (0.111) loss_x loss_x 0.7266 (0.7159) acc_x 78.1250 (81.8750) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/17] time 0.185 (0.231) data 0.108 (0.110) loss_x loss_x 1.2988 (0.7499) acc_x 71.8750 (81.6667) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.3496, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 565
clean true:561
clean false:4
clean_rate:0.9929203539823008
noisy true:477
noisy false:574
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1051
epoch [82/200] batch [5/17] time 0.193 (0.218) data 0.117 (0.102) loss_x loss_x 0.8286 (0.5356) acc_x 78.1250 (84.3750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/17] time 0.230 (0.211) data 0.105 (0.099) loss_x loss_x 0.9399 (0.6299) acc_x 81.2500 (83.1250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/17] time 0.220 (0.212) data 0.097 (0.096) loss_x loss_x 0.7715 (0.6185) acc_x 81.2500 (83.7500) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.3373, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 545
clean true:545
clean false:0
clean_rate:1.0
noisy true:482
noisy false:589
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1071
epoch [83/200] batch [5/17] time 0.233 (0.238) data 0.110 (0.113) loss_x loss_x 0.6816 (0.8989) acc_x 81.2500 (78.1250) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/17] time 0.245 (0.229) data 0.119 (0.112) loss_x loss_x 0.3831 (0.8625) acc_x 87.5000 (78.4375) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/17] time 0.236 (0.231) data 0.112 (0.111) loss_x loss_x 0.9507 (0.8425) acc_x 75.0000 (78.5417) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.3478, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 562
clean true:557
clean false:5
clean_rate:0.9911032028469751
noisy true:473
noisy false:581
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1054
epoch [84/200] batch [5/17] time 0.243 (0.246) data 0.120 (0.121) loss_x loss_x 0.9165 (0.6918) acc_x 78.1250 (81.2500) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [10/17] time 0.235 (0.240) data 0.106 (0.115) loss_x loss_x 0.3445 (0.6184) acc_x 93.7500 (82.1875) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/17] time 0.232 (0.238) data 0.106 (0.113) loss_x loss_x 0.6079 (0.6615) acc_x 81.2500 (82.0833) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 576
confident_label rate tensor(0.3552, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 574
clean true:570
clean false:4
clean_rate:0.9930313588850174
noisy true:470
noisy false:572
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1042
epoch [85/200] batch [5/17] time 0.241 (0.242) data 0.113 (0.117) loss_x loss_x 0.6309 (0.7673) acc_x 84.3750 (79.3750) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/17] time 0.231 (0.241) data 0.107 (0.116) loss_x loss_x 1.0840 (0.7464) acc_x 78.1250 (81.8750) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/17] time 0.210 (0.236) data 0.085 (0.111) loss_x loss_x 1.3516 (0.8015) acc_x 75.0000 (81.0417) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 579
confident_label rate tensor(0.3459, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 559
clean true:556
clean false:3
clean_rate:0.9946332737030411
noisy true:481
noisy false:576
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1057
epoch [86/200] batch [5/17] time 0.227 (0.224) data 0.104 (0.113) loss_x loss_x 0.3796 (0.6581) acc_x 93.7500 (83.7500) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/17] time 0.250 (0.237) data 0.128 (0.120) loss_x loss_x 0.7944 (0.6086) acc_x 71.8750 (83.1250) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/17] time 0.219 (0.236) data 0.095 (0.116) loss_x loss_x 0.9004 (0.6769) acc_x 81.2500 (82.2917) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.3478, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 562
clean true:557
clean false:5
clean_rate:0.9911032028469751
noisy true:463
noisy false:591
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1054
epoch [87/200] batch [5/17] time 0.246 (0.241) data 0.122 (0.116) loss_x loss_x 0.3472 (0.6356) acc_x 87.5000 (83.7500) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/17] time 0.223 (0.233) data 0.099 (0.109) loss_x loss_x 0.7012 (0.6977) acc_x 84.3750 (83.1250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/17] time 0.233 (0.230) data 0.108 (0.105) loss_x loss_x 0.7886 (0.7022) acc_x 87.5000 (83.1250) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.3521, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 569
clean true:563
clean false:6
clean_rate:0.9894551845342706
noisy true:484
noisy false:563
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1047
epoch [88/200] batch [5/17] time 0.242 (0.233) data 0.119 (0.108) loss_x loss_x 0.6611 (0.6805) acc_x 87.5000 (85.0000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/17] time 0.236 (0.231) data 0.109 (0.106) loss_x loss_x 1.1230 (0.7963) acc_x 81.2500 (83.4375) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/17] time 0.222 (0.231) data 0.097 (0.106) loss_x loss_x 0.6714 (0.7567) acc_x 81.2500 (82.9167) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3484, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 563
clean true:559
clean false:4
clean_rate:0.9928952042628775
noisy true:485
noisy false:568
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1053
epoch [89/200] batch [5/17] time 0.218 (0.225) data 0.094 (0.100) loss_x loss_x 0.4197 (0.6568) acc_x 84.3750 (81.8750) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/17] time 0.228 (0.225) data 0.102 (0.100) loss_x loss_x 0.3921 (0.6552) acc_x 90.6250 (82.1875) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/17] time 0.257 (0.230) data 0.129 (0.105) loss_x loss_x 0.6538 (0.6271) acc_x 87.5000 (82.9167) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 568
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:545
clean false:3
clean_rate:0.9945255474452555
noisy true:503
noisy false:565
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [90/200] batch [5/17] time 0.243 (0.217) data 0.120 (0.102) loss_x loss_x 0.6978 (0.5817) acc_x 84.3750 (86.8750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/17] time 0.240 (0.227) data 0.114 (0.108) loss_x loss_x 0.5713 (0.7058) acc_x 81.2500 (83.4375) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/17] time 0.230 (0.230) data 0.108 (0.110) loss_x loss_x 0.6094 (0.6795) acc_x 93.7500 (85.0000) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.3478, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 562
clean true:557
clean false:5
clean_rate:0.9911032028469751
noisy true:507
noisy false:547
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1054
epoch [91/200] batch [5/17] time 0.232 (0.239) data 0.108 (0.119) loss_x loss_x 1.3408 (0.7656) acc_x 75.0000 (82.5000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/17] time 0.226 (0.234) data 0.102 (0.113) loss_x loss_x 0.5718 (0.7328) acc_x 81.2500 (81.5625) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/17] time 0.226 (0.236) data 0.104 (0.115) loss_x loss_x 0.5850 (0.6877) acc_x 87.5000 (82.9167) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.3552, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 574
clean true:567
clean false:7
clean_rate:0.9878048780487805
noisy true:483
noisy false:559
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1042
epoch [92/200] batch [5/17] time 0.255 (0.232) data 0.130 (0.106) loss_x loss_x 0.5474 (0.7114) acc_x 84.3750 (80.6250) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/17] time 0.212 (0.212) data 0.085 (0.100) loss_x loss_x 0.5464 (0.6940) acc_x 90.6250 (82.1875) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [15/17] time 0.203 (0.214) data 0.079 (0.098) loss_x loss_x 0.8799 (0.6727) acc_x 78.1250 (82.9167) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 562
confident_label rate tensor(0.3546, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 573
clean true:566
clean false:7
clean_rate:0.987783595113438
noisy true:488
noisy false:555
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1043
epoch [93/200] batch [5/17] time 0.277 (0.245) data 0.151 (0.116) loss_x loss_x 0.7856 (0.7179) acc_x 78.1250 (82.5000) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/17] time 0.234 (0.244) data 0.110 (0.118) loss_x loss_x 0.8081 (0.7613) acc_x 75.0000 (81.2500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/17] time 0.218 (0.240) data 0.094 (0.115) loss_x loss_x 0.5342 (0.7183) acc_x 78.1250 (81.8750) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.3484, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 563
clean true:560
clean false:3
clean_rate:0.9946714031971581
noisy true:475
noisy false:578
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1053
epoch [94/200] batch [5/17] time 0.237 (0.221) data 0.110 (0.101) loss_x loss_x 1.0898 (0.7301) acc_x 75.0000 (84.3750) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/17] time 0.224 (0.224) data 0.097 (0.101) loss_x loss_x 0.7017 (0.8099) acc_x 84.3750 (80.9375) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [15/17] time 0.234 (0.225) data 0.109 (0.102) loss_x loss_x 0.7329 (0.7742) acc_x 71.8750 (80.4167) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 577
confident_label rate tensor(0.3490, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 564
clean true:562
clean false:2
clean_rate:0.9964539007092199
noisy true:477
noisy false:575
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1052
epoch [95/200] batch [5/17] time 0.224 (0.214) data 0.099 (0.098) loss_x loss_x 0.8989 (0.8315) acc_x 78.1250 (80.0000) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/17] time 0.231 (0.219) data 0.106 (0.099) loss_x loss_x 0.9209 (0.7403) acc_x 87.5000 (81.5625) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/17] time 0.257 (0.226) data 0.130 (0.103) loss_x loss_x 0.6914 (0.6989) acc_x 78.1250 (82.0833) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 576
clean true:574
clean false:2
clean_rate:0.9965277777777778
noisy true:479
noisy false:561
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1040
epoch [96/200] batch [5/18] time 0.239 (0.242) data 0.113 (0.111) loss_x loss_x 0.5205 (0.7373) acc_x 90.6250 (81.8750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/18] time 0.228 (0.234) data 0.106 (0.106) loss_x loss_x 0.4438 (0.6104) acc_x 90.6250 (84.6875) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/18] time 0.237 (0.239) data 0.113 (0.112) loss_x loss_x 0.9556 (0.6761) acc_x 81.2500 (83.1250) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:567
clean false:4
clean_rate:0.9929947460595446
noisy true:483
noisy false:562
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [97/200] batch [5/17] time 0.254 (0.220) data 0.131 (0.114) loss_x loss_x 0.4004 (0.6346) acc_x 87.5000 (85.0000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/17] time 0.264 (0.232) data 0.138 (0.116) loss_x loss_x 1.1533 (0.7616) acc_x 78.1250 (83.1250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/17] time 0.228 (0.232) data 0.107 (0.114) loss_x loss_x 0.8965 (0.7481) acc_x 75.0000 (81.4583) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 577
clean true:574
clean false:3
clean_rate:0.9948006932409013
noisy true:494
noisy false:545
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1039
epoch [98/200] batch [5/18] time 0.245 (0.249) data 0.120 (0.125) loss_x loss_x 0.7573 (0.6564) acc_x 81.2500 (82.5000) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/18] time 0.213 (0.239) data 0.089 (0.115) loss_x loss_x 0.6074 (0.6637) acc_x 81.2500 (81.5625) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/18] time 0.230 (0.238) data 0.105 (0.114) loss_x loss_x 0.6704 (0.6522) acc_x 87.5000 (83.1250) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3515, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 568
clean true:559
clean false:9
clean_rate:0.9841549295774648
noisy true:485
noisy false:563
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1048
epoch [99/200] batch [5/17] time 0.228 (0.242) data 0.108 (0.129) loss_x loss_x 0.7559 (0.7675) acc_x 90.6250 (81.8750) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/17] time 0.217 (0.241) data 0.093 (0.122) loss_x loss_x 0.6616 (0.7768) acc_x 84.3750 (81.5625) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/17] time 0.226 (0.236) data 0.097 (0.115) loss_x loss_x 0.6699 (0.8145) acc_x 84.3750 (81.0417) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.3608, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 583
clean true:577
clean false:6
clean_rate:0.9897084048027445
noisy true:466
noisy false:567
all clean rate:  [0.9803149606299213, 0.9932432432432432, 0.9869109947643979, 0.9925187032418953, 0.9876847290640394, 0.9925373134328358, 0.9901960784313726, 0.9931350114416476, 0.9902200488997555, 0.9906103286384976, 0.9886363636363636, 0.9953810623556582, 0.9846491228070176, 0.9930232558139535, 0.9954233409610984, 0.9954954954954955, 0.9957983193277311, 0.9889867841409692, 0.9932584269662922, 0.9890350877192983, 0.9956140350877193, 0.9915074309978769, 0.993421052631579, 0.9978260869565218, 0.9918367346938776, 0.9937629937629938, 0.9918200408997955, 0.9918864097363083, 0.9919354838709677, 0.9959919839679359, 0.9958762886597938, 0.9959839357429718, 0.9941860465116279, 0.9979338842975206, 0.9960079840319361, 0.9959514170040485, 0.9940119760479041, 0.9938524590163934, 0.9938650306748467, 0.9900990099009901, 0.9901380670611439, 0.9980353634577603, 0.9885057471264368, 0.9942748091603053, 0.99609375, 0.9901380670611439, 0.9942528735632183, 0.9902152641878669, 0.9922178988326849, 0.9905838041431262, 0.9926873857404022, 0.9924528301886792, 0.9944444444444445, 0.9922779922779923, 0.9923518164435946, 0.994328922495274, 0.9943396226415094, 0.9854014598540146, 0.9963031423290203, 0.994535519125683, 0.994328922495274, 0.9927667269439421, 0.9980879541108987, 0.994413407821229, 0.9890310786106032, 0.9891107078039928, 0.9962546816479401, 0.992467043314501, 0.996309963099631, 0.9929453262786596, 0.9924953095684803, 0.9927007299270073, 0.9945155393053017, 0.9945454545454545, 0.9873417721518988, 0.989010989010989, 0.9947916666666666, 0.9893048128342246, 0.990990990990991, 0.9875444839857651, 0.9947275922671354, 0.9929203539823008, 1.0, 0.9911032028469751, 0.9930313588850174, 0.9946332737030411, 0.9911032028469751, 0.9894551845342706, 0.9928952042628775, 0.9945255474452555, 0.9911032028469751, 0.9878048780487805, 0.987783595113438, 0.9946714031971581, 0.9964539007092199, 0.9965277777777778, 0.9929947460595446, 0.9948006932409013, 0.9841549295774648, 0.9897084048027445]
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1033
epoch [100/200] batch [5/18] time 0.232 (0.216) data 0.108 (0.100) loss_x loss_x 0.3760 (0.6992) acc_x 96.8750 (85.0000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/18] time 0.231 (0.229) data 0.108 (0.109) loss_x loss_x 1.3037 (0.7503) acc_x 68.7500 (80.3125) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/18] time 0.233 (0.233) data 0.110 (0.112) loss_x loss_x 0.6353 (0.7115) acc_x 84.3750 (81.0417) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 576
clean true:569
clean false:7
clean_rate:0.9878472222222222
noisy true:498
noisy false:542
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1040
epoch [101/200] batch [5/18] time 0.244 (0.242) data 0.119 (0.117) loss_x loss_x 1.2500 (0.7621) acc_x 81.2500 (83.1250) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/18] time 0.182 (0.231) data 0.106 (0.115) loss_x loss_x 0.7788 (0.7899) acc_x 75.0000 (80.6250) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [15/18] time 0.225 (0.232) data 0.101 (0.112) loss_x loss_x 0.6230 (0.7060) acc_x 75.0000 (81.0417) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 587
clean true:582
clean false:5
clean_rate:0.9914821124361158
noisy true:482
noisy false:547
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1029
epoch [102/200] batch [5/18] time 0.241 (0.237) data 0.118 (0.114) loss_x loss_x 1.0557 (0.7825) acc_x 75.0000 (81.2500) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/18] time 0.228 (0.237) data 0.106 (0.117) loss_x loss_x 0.5073 (0.8061) acc_x 87.5000 (81.2500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/18] time 0.276 (0.237) data 0.149 (0.116) loss_x loss_x 0.9243 (0.8218) acc_x 78.1250 (79.5833) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.3546, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 573
clean true:569
clean false:4
clean_rate:0.9930191972076788
noisy true:489
noisy false:554
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1043
epoch [103/200] batch [5/17] time 0.221 (0.219) data 0.096 (0.094) loss_x loss_x 0.7739 (0.7838) acc_x 75.0000 (76.2500) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/17] time 0.240 (0.225) data 0.114 (0.100) loss_x loss_x 0.5845 (0.7177) acc_x 81.2500 (79.6875) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [15/17] time 0.239 (0.231) data 0.115 (0.106) loss_x loss_x 0.7705 (0.7033) acc_x 84.3750 (81.6667) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 555
confident_label rate tensor(0.3502, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 566
clean true:563
clean false:3
clean_rate:0.9946996466431095
noisy true:498
noisy false:552
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1050
epoch [104/200] batch [5/17] time 0.261 (0.240) data 0.133 (0.115) loss_x loss_x 0.6050 (0.6335) acc_x 84.3750 (83.1250) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/17] time 0.220 (0.237) data 0.095 (0.112) loss_x loss_x 0.9370 (0.6161) acc_x 78.1250 (84.3750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/17] time 0.231 (0.234) data 0.105 (0.109) loss_x loss_x 0.5156 (0.6451) acc_x 75.0000 (82.5000) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:565
clean false:6
clean_rate:0.989492119089317
noisy true:480
noisy false:565
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [105/200] batch [5/17] time 0.229 (0.231) data 0.106 (0.105) loss_x loss_x 0.8267 (0.6098) acc_x 81.2500 (85.0000) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/17] time 0.234 (0.230) data 0.109 (0.105) loss_x loss_x 0.6362 (0.6064) acc_x 84.3750 (85.6250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [15/17] time 0.232 (0.232) data 0.105 (0.106) loss_x loss_x 0.6851 (0.6360) acc_x 84.3750 (85.2083) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.3608, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 583
clean true:574
clean false:9
clean_rate:0.9845626072041166
noisy true:485
noisy false:548
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1033
epoch [106/200] batch [5/18] time 0.242 (0.242) data 0.119 (0.117) loss_x loss_x 0.5991 (0.6720) acc_x 84.3750 (83.7500) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/18] time 0.243 (0.235) data 0.118 (0.116) loss_x loss_x 0.5386 (0.6976) acc_x 78.1250 (83.1250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/18] time 0.230 (0.237) data 0.106 (0.117) loss_x loss_x 0.5537 (0.7093) acc_x 93.7500 (83.3333) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.3676, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 594
clean true:589
clean false:5
clean_rate:0.9915824915824916
noisy true:488
noisy false:534
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1022
epoch [107/200] batch [5/18] time 0.213 (0.216) data 0.087 (0.090) loss_x loss_x 0.7617 (0.6123) acc_x 81.2500 (82.5000) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/18] time 0.218 (0.221) data 0.095 (0.096) loss_x loss_x 0.6660 (0.6201) acc_x 84.3750 (83.4375) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/18] time 0.220 (0.224) data 0.094 (0.098) loss_x loss_x 0.5830 (0.6406) acc_x 78.1250 (82.9167) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.3595, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 581
clean true:577
clean false:4
clean_rate:0.9931153184165232
noisy true:486
noisy false:549
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1035
epoch [108/200] batch [5/18] time 0.208 (0.227) data 0.086 (0.103) loss_x loss_x 0.1924 (0.4849) acc_x 96.8750 (85.6250) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/18] time 0.230 (0.227) data 0.105 (0.103) loss_x loss_x 0.6157 (0.5622) acc_x 87.5000 (85.3125) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/18] time 0.224 (0.225) data 0.100 (0.101) loss_x loss_x 0.5474 (0.6081) acc_x 87.5000 (85.2083) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 547
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:579
clean false:7
clean_rate:0.9880546075085325
noisy true:490
noisy false:540
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [109/200] batch [5/18] time 0.229 (0.234) data 0.105 (0.109) loss_x loss_x 0.6523 (0.6172) acc_x 81.2500 (85.6250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/18] time 0.238 (0.236) data 0.112 (0.111) loss_x loss_x 0.4094 (0.5659) acc_x 90.6250 (85.9375) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/18] time 0.241 (0.240) data 0.116 (0.115) loss_x loss_x 0.6641 (0.6264) acc_x 87.5000 (83.9583) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.3589, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 580
clean true:576
clean false:4
clean_rate:0.993103448275862
noisy true:503
noisy false:533
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1036
epoch [110/200] batch [5/18] time 0.236 (0.233) data 0.110 (0.118) loss_x loss_x 0.9531 (0.7215) acc_x 81.2500 (81.2500) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/18] time 0.242 (0.234) data 0.117 (0.113) loss_x loss_x 0.7354 (0.6550) acc_x 84.3750 (83.4375) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/18] time 0.218 (0.230) data 0.095 (0.108) loss_x loss_x 0.5352 (0.6783) acc_x 90.6250 (83.9583) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.3589, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 580
clean true:575
clean false:5
clean_rate:0.9913793103448276
noisy true:504
noisy false:532
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1036
epoch [111/200] batch [5/18] time 0.219 (0.235) data 0.092 (0.109) loss_x loss_x 0.7979 (0.7615) acc_x 81.2500 (80.6250) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/18] time 0.231 (0.236) data 0.107 (0.111) loss_x loss_x 0.7930 (0.7709) acc_x 81.2500 (82.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/18] time 0.238 (0.237) data 0.113 (0.113) loss_x loss_x 0.5068 (0.7348) acc_x 81.2500 (82.5000) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.3620, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 585
clean true:579
clean false:6
clean_rate:0.9897435897435898
noisy true:478
noisy false:553
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1031
epoch [112/200] batch [5/18] time 0.212 (0.213) data 0.087 (0.107) loss_x loss_x 0.7056 (0.8049) acc_x 84.3750 (80.6250) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/18] time 0.228 (0.218) data 0.102 (0.103) loss_x loss_x 0.1852 (0.7114) acc_x 96.8750 (82.1875) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [15/18] time 0.237 (0.219) data 0.112 (0.101) loss_x loss_x 0.0967 (0.6519) acc_x 93.7500 (83.7500) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:568
clean false:3
clean_rate:0.9947460595446584
noisy true:488
noisy false:557
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [113/200] batch [5/17] time 0.230 (0.224) data 0.106 (0.114) loss_x loss_x 0.8682 (0.5582) acc_x 84.3750 (86.8750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/17] time 0.233 (0.229) data 0.104 (0.111) loss_x loss_x 1.1455 (0.6332) acc_x 78.1250 (84.6875) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [15/17] time 0.269 (0.236) data 0.140 (0.116) loss_x loss_x 0.4558 (0.6541) acc_x 87.5000 (84.3750) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.3583, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 579
clean true:573
clean false:6
clean_rate:0.9896373056994818
noisy true:472
noisy false:565
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1037
epoch [114/200] batch [5/18] time 0.220 (0.229) data 0.095 (0.102) loss_x loss_x 0.5894 (0.5836) acc_x 87.5000 (87.5000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/18] time 0.223 (0.228) data 0.099 (0.103) loss_x loss_x 0.3174 (0.5336) acc_x 93.7500 (87.5000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [15/18] time 0.232 (0.232) data 0.108 (0.107) loss_x loss_x 0.4275 (0.5797) acc_x 84.3750 (86.0417) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.3639, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 588
clean true:584
clean false:4
clean_rate:0.9931972789115646
noisy true:488
noisy false:540
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1028
epoch [115/200] batch [5/18] time 0.259 (0.244) data 0.133 (0.120) loss_x loss_x 0.7827 (0.6313) acc_x 81.2500 (83.1250) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/18] time 0.238 (0.244) data 0.113 (0.120) loss_x loss_x 0.6611 (0.6465) acc_x 84.3750 (83.1250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/18] time 0.236 (0.241) data 0.111 (0.117) loss_x loss_x 0.4846 (0.6488) acc_x 90.6250 (81.4583) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:581
clean false:9
clean_rate:0.9847457627118644
noisy true:463
noisy false:563
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [116/200] batch [5/18] time 0.214 (0.211) data 0.087 (0.087) loss_x loss_x 0.5645 (0.5586) acc_x 84.3750 (85.0000) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/18] time 0.208 (0.212) data 0.083 (0.087) loss_x loss_x 0.5933 (0.7099) acc_x 84.3750 (80.6250) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/18] time 0.229 (0.221) data 0.101 (0.096) loss_x loss_x 0.5679 (0.7330) acc_x 87.5000 (80.4167) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 562
confident_label rate tensor(0.3601, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 582
clean true:575
clean false:7
clean_rate:0.9879725085910653
noisy true:479
noisy false:555
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1034
epoch [117/200] batch [5/18] time 0.216 (0.222) data 0.091 (0.098) loss_x loss_x 0.7427 (0.7460) acc_x 90.6250 (81.8750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/18] time 0.230 (0.224) data 0.106 (0.100) loss_x loss_x 0.4790 (0.7189) acc_x 93.7500 (81.5625) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [15/18] time 0.229 (0.219) data 0.103 (0.100) loss_x loss_x 0.7368 (0.6792) acc_x 78.1250 (82.2917) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 607
clean true:600
clean false:7
clean_rate:0.9884678747940692
noisy true:468
noisy false:541
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1009
epoch [118/200] batch [5/18] time 0.248 (0.231) data 0.124 (0.107) loss_x loss_x 0.6265 (0.6010) acc_x 87.5000 (85.6250) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/18] time 0.227 (0.233) data 0.103 (0.109) loss_x loss_x 0.9390 (0.6366) acc_x 68.7500 (83.4375) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/18] time 0.224 (0.231) data 0.098 (0.106) loss_x loss_x 0.4785 (0.6282) acc_x 90.6250 (84.1667) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3663, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 592
clean true:587
clean false:5
clean_rate:0.9915540540540541
noisy true:478
noisy false:546
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1024
epoch [119/200] batch [5/18] time 0.230 (0.225) data 0.106 (0.101) loss_x loss_x 0.6406 (0.6502) acc_x 81.2500 (84.3750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/18] time 0.231 (0.229) data 0.107 (0.104) loss_x loss_x 0.2793 (0.6215) acc_x 93.7500 (83.7500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [15/18] time 0.209 (0.223) data 0.085 (0.098) loss_x loss_x 0.6821 (0.6537) acc_x 81.2500 (82.9167) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.3552, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 574
clean true:569
clean false:5
clean_rate:0.9912891986062717
noisy true:511
noisy false:531
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1042
epoch [120/200] batch [5/17] time 0.222 (0.240) data 0.098 (0.106) loss_x loss_x 0.6577 (0.5912) acc_x 84.3750 (85.0000) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/17] time 0.231 (0.234) data 0.106 (0.105) loss_x loss_x 0.8291 (0.6765) acc_x 81.2500 (83.7500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [15/17] time 0.224 (0.233) data 0.098 (0.105) loss_x loss_x 0.4551 (0.6620) acc_x 90.6250 (84.1667) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.3601, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 582
clean true:576
clean false:6
clean_rate:0.9896907216494846
noisy true:479
noisy false:555
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1034
epoch [121/200] batch [5/18] time 0.219 (0.222) data 0.097 (0.096) loss_x loss_x 0.6299 (0.6153) acc_x 87.5000 (82.5000) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [10/18] time 0.224 (0.221) data 0.099 (0.097) loss_x loss_x 0.6621 (0.6527) acc_x 78.1250 (81.2500) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/18] time 0.239 (0.223) data 0.114 (0.099) loss_x loss_x 0.3235 (0.6147) acc_x 90.6250 (83.1250) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.3540, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 572
clean true:570
clean false:2
clean_rate:0.9965034965034965
noisy true:494
noisy false:550
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 1044
epoch [122/200] batch [5/17] time 0.236 (0.228) data 0.111 (0.102) loss_x loss_x 0.4058 (0.6677) acc_x 93.7500 (86.2500) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/17] time 0.237 (0.230) data 0.111 (0.105) loss_x loss_x 0.9541 (0.6656) acc_x 75.0000 (85.3125) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [15/17] time 0.244 (0.233) data 0.120 (0.108) loss_x loss_x 0.1729 (0.6499) acc_x 96.8750 (84.5833) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 554
confident_label rate tensor(0.3663, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 592
clean true:588
clean false:4
clean_rate:0.9932432432432432
noisy true:474
noisy false:550
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1024
epoch [123/200] batch [5/18] time 0.217 (0.223) data 0.092 (0.098) loss_x loss_x 0.6426 (0.7543) acc_x 90.6250 (81.2500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/18] time 0.216 (0.223) data 0.092 (0.098) loss_x loss_x 0.7485 (0.7114) acc_x 75.0000 (80.3125) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/18] time 0.228 (0.226) data 0.102 (0.101) loss_x loss_x 0.5859 (0.6696) acc_x 81.2500 (82.0833) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 576
clean true:572
clean false:4
clean_rate:0.9930555555555556
noisy true:485
noisy false:555
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1040
epoch [124/200] batch [5/18] time 0.234 (0.231) data 0.108 (0.106) loss_x loss_x 0.6426 (0.5270) acc_x 87.5000 (86.2500) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/18] time 0.212 (0.236) data 0.087 (0.111) loss_x loss_x 0.4976 (0.6617) acc_x 87.5000 (83.4375) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [15/18] time 0.217 (0.234) data 0.093 (0.110) loss_x loss_x 1.0361 (0.6507) acc_x 75.0000 (83.9583) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 587
clean true:581
clean false:6
clean_rate:0.989778534923339
noisy true:499
noisy false:530
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1029
epoch [125/200] batch [5/18] time 0.223 (0.229) data 0.101 (0.112) loss_x loss_x 0.6406 (0.6894) acc_x 81.2500 (85.0000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/18] time 0.245 (0.233) data 0.121 (0.113) loss_x loss_x 0.5776 (0.7719) acc_x 81.2500 (82.1875) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [15/18] time 0.217 (0.230) data 0.092 (0.108) loss_x loss_x 0.9473 (0.8086) acc_x 75.0000 (79.5833) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.3558, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 575
clean true:571
clean false:4
clean_rate:0.9930434782608696
noisy true:485
noisy false:556
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1041
epoch [126/200] batch [5/17] time 0.233 (0.256) data 0.109 (0.127) loss_x loss_x 0.8511 (0.6581) acc_x 75.0000 (83.7500) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/17] time 0.236 (0.242) data 0.107 (0.115) loss_x loss_x 0.5234 (0.6079) acc_x 87.5000 (85.3125) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [15/17] time 0.217 (0.238) data 0.091 (0.112) loss_x loss_x 0.3091 (0.5676) acc_x 96.8750 (85.6250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.3583, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 579
clean true:573
clean false:6
clean_rate:0.9896373056994818
noisy true:498
noisy false:539
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1037
epoch [127/200] batch [5/18] time 0.250 (0.244) data 0.126 (0.119) loss_x loss_x 0.6416 (0.6535) acc_x 81.2500 (82.5000) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/18] time 0.184 (0.240) data 0.107 (0.119) loss_x loss_x 0.8662 (0.6914) acc_x 75.0000 (81.5625) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [15/18] time 0.226 (0.242) data 0.100 (0.126) loss_x loss_x 0.6064 (0.6737) acc_x 84.3750 (82.5000) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 554
confident_label rate tensor(0.3608, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 583
clean true:578
clean false:5
clean_rate:0.9914236706689536
noisy true:484
noisy false:549
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1033
epoch [128/200] batch [5/18] time 0.185 (0.216) data 0.109 (0.111) loss_x loss_x 0.8638 (0.5707) acc_x 84.3750 (88.7500) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/18] time 0.233 (0.230) data 0.109 (0.113) loss_x loss_x 0.8105 (0.6079) acc_x 78.1250 (85.6250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [15/18] time 0.250 (0.232) data 0.120 (0.113) loss_x loss_x 1.0146 (0.6649) acc_x 75.0000 (83.5417) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 606
clean true:601
clean false:5
clean_rate:0.9917491749174917
noisy true:486
noisy false:524
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1010
epoch [129/200] batch [5/18] time 0.227 (0.226) data 0.103 (0.101) loss_x loss_x 0.6123 (0.6063) acc_x 87.5000 (85.0000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/18] time 0.195 (0.219) data 0.117 (0.106) loss_x loss_x 0.3750 (0.6711) acc_x 93.7500 (83.7500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [15/18] time 0.224 (0.224) data 0.094 (0.104) loss_x loss_x 0.4858 (0.6552) acc_x 81.2500 (83.1250) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:596
clean false:7
clean_rate:0.988391376451078
noisy true:481
noisy false:532
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [130/200] batch [5/18] time 0.239 (0.235) data 0.115 (0.109) loss_x loss_x 0.8516 (0.6471) acc_x 75.0000 (84.3750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/18] time 0.234 (0.241) data 0.109 (0.115) loss_x loss_x 0.4468 (0.7458) acc_x 90.6250 (82.5000) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/18] time 0.232 (0.240) data 0.109 (0.114) loss_x loss_x 0.5933 (0.7292) acc_x 84.3750 (82.7083) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:595
clean false:6
clean_rate:0.9900166389351082
noisy true:476
noisy false:539
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [131/200] batch [5/18] time 0.250 (0.219) data 0.125 (0.110) loss_x loss_x 0.9165 (0.7224) acc_x 81.2500 (81.8750) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/18] time 0.217 (0.221) data 0.089 (0.104) loss_x loss_x 0.2527 (0.6214) acc_x 96.8750 (83.1250) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/18] time 0.231 (0.222) data 0.106 (0.102) loss_x loss_x 1.1553 (0.6699) acc_x 75.0000 (83.1250) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.3639, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 588
clean true:584
clean false:4
clean_rate:0.9931972789115646
noisy true:507
noisy false:521
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1028
epoch [132/200] batch [5/18] time 0.227 (0.232) data 0.103 (0.107) loss_x loss_x 0.9492 (0.7274) acc_x 65.6250 (78.7500) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/18] time 0.232 (0.232) data 0.105 (0.107) loss_x loss_x 0.8335 (0.7000) acc_x 78.1250 (79.6875) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/18] time 0.229 (0.235) data 0.104 (0.110) loss_x loss_x 0.8628 (0.6771) acc_x 75.0000 (81.4583) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.3639, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 588
clean true:583
clean false:5
clean_rate:0.9914965986394558
noisy true:488
noisy false:540
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1028
epoch [133/200] batch [5/18] time 0.221 (0.218) data 0.099 (0.095) loss_x loss_x 0.5835 (0.6644) acc_x 87.5000 (84.3750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/18] time 0.218 (0.222) data 0.090 (0.098) loss_x loss_x 0.5967 (0.6736) acc_x 87.5000 (83.7500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [15/18] time 0.216 (0.225) data 0.091 (0.100) loss_x loss_x 0.4226 (0.6119) acc_x 84.3750 (85.2083) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:590
clean false:7
clean_rate:0.9882747068676717
noisy true:473
noisy false:546
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [134/200] batch [5/18] time 0.220 (0.230) data 0.096 (0.104) loss_x loss_x 0.3374 (0.5839) acc_x 90.6250 (88.1250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/18] time 0.224 (0.229) data 0.101 (0.104) loss_x loss_x 0.5142 (0.5401) acc_x 93.7500 (88.4375) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [15/18] time 0.234 (0.229) data 0.105 (0.104) loss_x loss_x 0.5317 (0.5526) acc_x 87.5000 (87.7083) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 610
clean true:605
clean false:5
clean_rate:0.9918032786885246
noisy true:459
noisy false:547
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1006
epoch [135/200] batch [5/19] time 0.246 (0.248) data 0.120 (0.122) loss_x loss_x 0.3164 (0.5390) acc_x 93.7500 (86.2500) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/19] time 0.240 (0.242) data 0.113 (0.116) loss_x loss_x 0.3628 (0.4826) acc_x 87.5000 (88.7500) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/19] time 0.234 (0.240) data 0.106 (0.115) loss_x loss_x 0.5356 (0.5078) acc_x 87.5000 (87.9167) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 562
confident_label rate tensor(0.3583, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 579
clean true:574
clean false:5
clean_rate:0.9913644214162349
noisy true:480
noisy false:557
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1037
epoch [136/200] batch [5/18] time 0.220 (0.222) data 0.095 (0.097) loss_x loss_x 0.8286 (0.5780) acc_x 81.2500 (83.7500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/18] time 0.230 (0.222) data 0.104 (0.097) loss_x loss_x 0.7861 (0.6598) acc_x 84.3750 (84.0625) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [15/18] time 0.241 (0.227) data 0.116 (0.102) loss_x loss_x 0.3223 (0.5963) acc_x 90.6250 (85.2083) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:566
clean false:5
clean_rate:0.9912434325744308
noisy true:498
noisy false:547
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [137/200] batch [5/17] time 0.233 (0.232) data 0.108 (0.113) loss_x loss_x 0.9741 (0.6250) acc_x 78.1250 (83.1250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/17] time 0.233 (0.231) data 0.109 (0.109) loss_x loss_x 0.3228 (0.5478) acc_x 90.6250 (86.5625) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [15/17] time 0.232 (0.232) data 0.108 (0.109) loss_x loss_x 1.1807 (0.5813) acc_x 71.8750 (85.6250) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:583
clean false:7
clean_rate:0.988135593220339
noisy true:491
noisy false:535
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [138/200] batch [5/18] time 0.223 (0.233) data 0.098 (0.106) loss_x loss_x 0.6040 (0.7271) acc_x 90.6250 (84.3750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/18] time 0.232 (0.230) data 0.108 (0.104) loss_x loss_x 0.9136 (0.6850) acc_x 84.3750 (85.9375) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/18] time 0.181 (0.223) data 0.105 (0.105) loss_x loss_x 0.3542 (0.7042) acc_x 87.5000 (84.3750) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:598
clean false:5
clean_rate:0.9917081260364843
noisy true:493
noisy false:520
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [139/200] batch [5/18] time 0.226 (0.230) data 0.102 (0.106) loss_x loss_x 0.5146 (0.6145) acc_x 90.6250 (86.8750) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [10/18] time 0.225 (0.219) data 0.099 (0.105) loss_x loss_x 0.6719 (0.6543) acc_x 84.3750 (84.3750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [15/18] time 0.226 (0.220) data 0.104 (0.103) loss_x loss_x 0.5244 (0.6343) acc_x 81.2500 (83.9583) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 540
confident_label rate tensor(0.3676, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 594
clean true:590
clean false:4
clean_rate:0.9932659932659933
noisy true:486
noisy false:536
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1022
epoch [140/200] batch [5/18] time 0.278 (0.252) data 0.154 (0.126) loss_x loss_x 0.5342 (0.5702) acc_x 84.3750 (87.5000) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/18] time 0.221 (0.236) data 0.096 (0.111) loss_x loss_x 0.3828 (0.5651) acc_x 90.6250 (87.1875) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/18] time 0.220 (0.233) data 0.093 (0.108) loss_x loss_x 0.6323 (0.6147) acc_x 81.2500 (85.8333) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.3688, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 596
clean true:593
clean false:3
clean_rate:0.9949664429530202
noisy true:495
noisy false:525
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1020
epoch [141/200] batch [5/18] time 0.231 (0.243) data 0.108 (0.119) loss_x loss_x 0.7271 (0.5741) acc_x 78.1250 (84.3750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/18] time 0.238 (0.235) data 0.113 (0.110) loss_x loss_x 0.6714 (0.6351) acc_x 87.5000 (83.1250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [15/18] time 0.226 (0.233) data 0.100 (0.108) loss_x loss_x 0.5312 (0.6200) acc_x 84.3750 (83.3333) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.3645, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 589
clean true:585
clean false:4
clean_rate:0.9932088285229203
noisy true:496
noisy false:531
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 1027
epoch [142/200] batch [5/18] time 0.239 (0.243) data 0.110 (0.113) loss_x loss_x 0.8574 (0.7357) acc_x 78.1250 (80.6250) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/18] time 0.234 (0.239) data 0.108 (0.111) loss_x loss_x 0.5298 (0.6323) acc_x 84.3750 (82.8125) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [15/18] time 0.235 (0.241) data 0.110 (0.114) loss_x loss_x 0.5269 (0.6268) acc_x 78.1250 (82.5000) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.3595, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 581
clean true:579
clean false:2
clean_rate:0.9965576592082617
noisy true:488
noisy false:547
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1035
epoch [143/200] batch [5/18] time 0.210 (0.217) data 0.087 (0.100) loss_x loss_x 0.5884 (0.4838) acc_x 90.6250 (88.7500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/18] time 0.224 (0.223) data 0.102 (0.101) loss_x loss_x 0.3740 (0.5492) acc_x 84.3750 (85.6250) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [15/18] time 0.231 (0.226) data 0.107 (0.103) loss_x loss_x 0.8765 (0.6137) acc_x 78.1250 (83.9583) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 531
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 591
clean true:586
clean false:5
clean_rate:0.9915397631133672
noisy true:499
noisy false:526
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1025
epoch [144/200] batch [5/18] time 0.238 (0.243) data 0.115 (0.115) loss_x loss_x 0.5625 (0.5022) acc_x 84.3750 (86.8750) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/18] time 0.234 (0.237) data 0.109 (0.111) loss_x loss_x 0.4604 (0.5264) acc_x 84.3750 (86.8750) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [15/18] time 0.227 (0.237) data 0.103 (0.111) loss_x loss_x 0.7256 (0.5545) acc_x 81.2500 (85.6250) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 593
clean true:587
clean false:6
clean_rate:0.9898819561551433
noisy true:505
noisy false:518
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1023
epoch [145/200] batch [5/18] time 0.228 (0.225) data 0.103 (0.117) loss_x loss_x 0.6733 (0.4690) acc_x 84.3750 (89.3750) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/18] time 0.229 (0.226) data 0.105 (0.111) loss_x loss_x 0.8311 (0.5335) acc_x 75.0000 (86.2500) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [15/18] time 0.259 (0.228) data 0.134 (0.109) loss_x loss_x 0.5200 (0.5874) acc_x 90.6250 (85.6250) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 595
clean true:590
clean false:5
clean_rate:0.9915966386554622
noisy true:491
noisy false:530
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1021
epoch [146/200] batch [5/18] time 0.218 (0.226) data 0.093 (0.102) loss_x loss_x 0.6074 (0.5742) acc_x 84.3750 (87.5000) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/18] time 0.207 (0.225) data 0.084 (0.101) loss_x loss_x 0.4702 (0.6233) acc_x 87.5000 (85.0000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [15/18] time 0.215 (0.224) data 0.090 (0.098) loss_x loss_x 0.5693 (0.6496) acc_x 84.3750 (84.3750) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 541
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:586
clean false:4
clean_rate:0.9932203389830508
noisy true:489
noisy false:537
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [147/200] batch [5/18] time 0.219 (0.221) data 0.094 (0.097) loss_x loss_x 0.6592 (0.5137) acc_x 87.5000 (89.3750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/18] time 0.261 (0.230) data 0.137 (0.105) loss_x loss_x 0.5391 (0.5601) acc_x 84.3750 (87.1875) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [15/18] time 0.225 (0.228) data 0.102 (0.103) loss_x loss_x 0.6694 (0.6878) acc_x 81.2500 (83.5417) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:601
clean false:4
clean_rate:0.9933884297520661
noisy true:489
noisy false:522
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [148/200] batch [5/18] time 0.232 (0.234) data 0.107 (0.108) loss_x loss_x 0.7119 (0.7738) acc_x 81.2500 (80.0000) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/18] time 0.234 (0.234) data 0.107 (0.109) loss_x loss_x 0.4358 (0.7043) acc_x 90.6250 (82.8125) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [15/18] time 0.227 (0.233) data 0.099 (0.107) loss_x loss_x 0.7183 (0.6759) acc_x 81.2500 (83.1250) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:600
clean false:5
clean_rate:0.9917355371900827
noisy true:481
noisy false:530
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [149/200] batch [5/18] time 0.216 (0.240) data 0.092 (0.113) loss_x loss_x 0.5786 (0.6022) acc_x 84.3750 (85.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/18] time 0.218 (0.232) data 0.095 (0.106) loss_x loss_x 0.7524 (0.6164) acc_x 81.2500 (85.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [15/18] time 0.235 (0.234) data 0.111 (0.109) loss_x loss_x 0.7300 (0.6729) acc_x 81.2500 (83.3333) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:580
clean false:6
clean_rate:0.9897610921501706
noisy true:488
noisy false:542
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [150/200] batch [5/18] time 0.230 (0.235) data 0.104 (0.110) loss_x loss_x 0.7651 (0.6475) acc_x 78.1250 (80.6250) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/18] time 0.162 (0.224) data 0.083 (0.107) loss_x loss_x 0.4277 (0.6252) acc_x 87.5000 (82.8125) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/18] time 0.230 (0.223) data 0.107 (0.107) loss_x loss_x 0.9863 (0.6974) acc_x 68.7500 (81.2500) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:598
clean false:3
clean_rate:0.9950083194675541
noisy true:492
noisy false:523
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [151/200] batch [5/18] time 0.239 (0.237) data 0.114 (0.112) loss_x loss_x 0.2510 (0.5245) acc_x 96.8750 (87.5000) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/18] time 0.217 (0.233) data 0.092 (0.109) loss_x loss_x 0.5195 (0.5128) acc_x 90.6250 (87.1875) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [15/18] time 0.226 (0.231) data 0.101 (0.106) loss_x loss_x 0.4019 (0.4960) acc_x 90.6250 (87.9167) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 508
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:603
clean false:2
clean_rate:0.996694214876033
noisy true:505
noisy false:506
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [152/200] batch [5/18] time 0.231 (0.194) data 0.105 (0.095) loss_x loss_x 0.8462 (0.5281) acc_x 87.5000 (88.7500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/18] time 0.246 (0.213) data 0.118 (0.101) loss_x loss_x 0.7007 (0.5870) acc_x 84.3750 (85.6250) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/18] time 0.211 (0.216) data 0.085 (0.099) loss_x loss_x 0.5029 (0.5703) acc_x 84.3750 (85.4167) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.3707, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 599
clean true:594
clean false:5
clean_rate:0.991652754590985
noisy true:495
noisy false:522
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1017
epoch [153/200] batch [5/18] time 0.232 (0.237) data 0.106 (0.112) loss_x loss_x 0.3848 (0.5672) acc_x 93.7500 (86.2500) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/18] time 0.208 (0.229) data 0.082 (0.103) loss_x loss_x 0.4333 (0.5731) acc_x 93.7500 (86.5625) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [15/18] time 0.233 (0.227) data 0.107 (0.101) loss_x loss_x 0.5581 (0.5600) acc_x 78.1250 (86.6667) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.3614, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 584
clean true:583
clean false:1
clean_rate:0.9982876712328768
noisy true:506
noisy false:526
after delete: len(clean_dataset) 584
after delete: len(noisy_dataset) 1032
epoch [154/200] batch [5/18] time 0.232 (0.236) data 0.109 (0.111) loss_x loss_x 0.4392 (0.5766) acc_x 87.5000 (85.6250) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/18] time 0.233 (0.235) data 0.108 (0.109) loss_x loss_x 0.5801 (0.6843) acc_x 81.2500 (80.9375) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [15/18] time 0.243 (0.230) data 0.121 (0.110) loss_x loss_x 1.0146 (0.6469) acc_x 75.0000 (82.7083) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 604
clean true:601
clean false:3
clean_rate:0.9950331125827815
noisy true:498
noisy false:514
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1012
epoch [155/200] batch [5/18] time 0.237 (0.234) data 0.107 (0.109) loss_x loss_x 0.3923 (0.4623) acc_x 93.7500 (88.1250) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/18] time 0.236 (0.234) data 0.110 (0.109) loss_x loss_x 0.5601 (0.4725) acc_x 87.5000 (87.8125) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [15/18] time 0.238 (0.236) data 0.113 (0.111) loss_x loss_x 1.0820 (0.5295) acc_x 78.1250 (87.7083) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:592
clean false:5
clean_rate:0.9916247906197655
noisy true:506
noisy false:513
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [156/200] batch [5/18] time 0.236 (0.255) data 0.107 (0.129) loss_x loss_x 0.4897 (0.7351) acc_x 90.6250 (81.8750) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/18] time 0.219 (0.240) data 0.095 (0.114) loss_x loss_x 0.6064 (0.6219) acc_x 81.2500 (84.0625) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [15/18] time 0.235 (0.235) data 0.111 (0.110) loss_x loss_x 0.3271 (0.5783) acc_x 90.6250 (85.6250) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 600
clean true:595
clean false:5
clean_rate:0.9916666666666667
noisy true:493
noisy false:523
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1016
epoch [157/200] batch [5/18] time 0.223 (0.220) data 0.099 (0.094) loss_x loss_x 0.4438 (0.4395) acc_x 87.5000 (88.7500) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/18] time 0.208 (0.213) data 0.084 (0.088) loss_x loss_x 0.3071 (0.5654) acc_x 93.7500 (86.2500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/18] time 0.207 (0.211) data 0.082 (0.086) loss_x loss_x 0.4370 (0.5855) acc_x 87.5000 (85.2083) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 595
clean true:589
clean false:6
clean_rate:0.9899159663865547
noisy true:482
noisy false:539
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1021
epoch [158/200] batch [5/18] time 0.214 (0.225) data 0.086 (0.100) loss_x loss_x 0.5972 (0.5686) acc_x 84.3750 (86.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/18] time 0.206 (0.218) data 0.082 (0.094) loss_x loss_x 0.6196 (0.5244) acc_x 87.5000 (87.5000) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [15/18] time 0.218 (0.216) data 0.089 (0.091) loss_x loss_x 0.6372 (0.5623) acc_x 84.3750 (86.0417) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:592
clean false:5
clean_rate:0.9916247906197655
noisy true:502
noisy false:517
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [159/200] batch [5/18] time 0.208 (0.208) data 0.083 (0.082) loss_x loss_x 0.4949 (0.7265) acc_x 84.3750 (80.6250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/18] time 0.210 (0.208) data 0.085 (0.083) loss_x loss_x 0.2035 (0.6411) acc_x 96.8750 (83.1250) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [15/18] time 0.206 (0.208) data 0.081 (0.083) loss_x loss_x 0.5190 (0.6078) acc_x 90.6250 (85.0000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 547
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:584
clean false:2
clean_rate:0.9965870307167235
noisy true:485
noisy false:545
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [160/200] batch [5/18] time 0.233 (0.233) data 0.108 (0.107) loss_x loss_x 0.6011 (0.6684) acc_x 87.5000 (84.3750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/18] time 0.231 (0.233) data 0.107 (0.108) loss_x loss_x 0.6445 (0.6221) acc_x 84.3750 (85.6250) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/18] time 0.231 (0.233) data 0.108 (0.107) loss_x loss_x 1.2217 (0.6888) acc_x 75.0000 (83.5417) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:591
clean false:6
clean_rate:0.9899497487437185
noisy true:501
noisy false:518
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [161/200] batch [5/18] time 0.209 (0.199) data 0.083 (0.083) loss_x loss_x 0.6675 (0.5728) acc_x 90.6250 (88.1250) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/18] time 0.160 (0.200) data 0.082 (0.083) loss_x loss_x 0.7251 (0.5717) acc_x 81.2500 (86.8750) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/18] time 0.209 (0.203) data 0.082 (0.083) loss_x loss_x 0.6094 (0.5579) acc_x 84.3750 (87.0833) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:594
clean false:3
clean_rate:0.9949748743718593
noisy true:498
noisy false:521
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [162/200] batch [5/18] time 0.209 (0.210) data 0.084 (0.086) loss_x loss_x 0.4258 (0.6674) acc_x 87.5000 (83.1250) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/18] time 0.208 (0.210) data 0.086 (0.086) loss_x loss_x 0.5791 (0.5990) acc_x 84.3750 (84.6875) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/18] time 0.274 (0.212) data 0.097 (0.087) loss_x loss_x 0.5396 (0.5986) acc_x 84.3750 (84.5833) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 507
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:611
clean false:6
clean_rate:0.9902755267423015
noisy true:498
noisy false:501
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [163/200] batch [5/19] time 0.207 (0.203) data 0.082 (0.081) loss_x loss_x 0.5195 (0.5185) acc_x 87.5000 (85.6250) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/19] time 0.206 (0.205) data 0.081 (0.081) loss_x loss_x 0.9141 (0.5985) acc_x 81.2500 (85.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/19] time 0.207 (0.206) data 0.082 (0.081) loss_x loss_x 0.8276 (0.6814) acc_x 87.5000 (83.3333) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 495
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 610
clean true:605
clean false:5
clean_rate:0.9918032786885246
noisy true:516
noisy false:490
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1006
epoch [164/200] batch [5/19] time 0.207 (0.215) data 0.083 (0.082) loss_x loss_x 0.6064 (0.6255) acc_x 84.3750 (85.6250) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/19] time 0.210 (0.211) data 0.083 (0.082) loss_x loss_x 0.4954 (0.6163) acc_x 90.6250 (85.9375) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [15/19] time 0.207 (0.210) data 0.081 (0.082) loss_x loss_x 0.7920 (0.6116) acc_x 75.0000 (84.3750) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:592
clean false:5
clean_rate:0.9916247906197655
noisy true:488
noisy false:531
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [165/200] batch [5/18] time 0.203 (0.205) data 0.080 (0.081) loss_x loss_x 0.3467 (0.5535) acc_x 90.6250 (86.2500) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/18] time 0.207 (0.206) data 0.082 (0.081) loss_x loss_x 0.6709 (0.6690) acc_x 87.5000 (83.7500) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/18] time 0.204 (0.206) data 0.079 (0.081) loss_x loss_x 0.5776 (0.6548) acc_x 78.1250 (83.5417) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 546
confident_label rate tensor(0.3589, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 580
clean true:577
clean false:3
clean_rate:0.9948275862068966
noisy true:493
noisy false:543
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1036
epoch [166/200] batch [5/18] time 0.211 (0.210) data 0.083 (0.084) loss_x loss_x 0.5698 (0.5689) acc_x 84.3750 (84.3750) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [10/18] time 0.209 (0.210) data 0.084 (0.084) loss_x loss_x 0.3960 (0.5736) acc_x 90.6250 (86.2500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [15/18] time 0.212 (0.207) data 0.085 (0.085) loss_x loss_x 0.9224 (0.6170) acc_x 78.1250 (85.2083) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:596
clean false:6
clean_rate:0.9900332225913622
noisy true:485
noisy false:529
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [167/200] batch [5/18] time 0.159 (0.199) data 0.082 (0.082) loss_x loss_x 0.3118 (0.5890) acc_x 90.6250 (86.2500) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [10/18] time 0.205 (0.203) data 0.078 (0.082) loss_x loss_x 1.2314 (0.6478) acc_x 71.8750 (84.0625) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [15/18] time 0.199 (0.204) data 0.077 (0.081) loss_x loss_x 0.7764 (0.5965) acc_x 78.1250 (85.2083) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 598
clean true:594
clean false:4
clean_rate:0.9933110367892977
noisy true:489
noisy false:529
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1018
epoch [168/200] batch [5/18] time 0.204 (0.208) data 0.079 (0.082) loss_x loss_x 0.4250 (0.5764) acc_x 96.8750 (86.2500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/18] time 0.207 (0.208) data 0.082 (0.082) loss_x loss_x 0.6738 (0.6021) acc_x 84.3750 (85.0000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/18] time 0.206 (0.208) data 0.079 (0.082) loss_x loss_x 0.3491 (0.5792) acc_x 93.7500 (85.2083) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:597
clean false:5
clean_rate:0.9916943521594684
noisy true:482
noisy false:532
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [169/200] batch [5/18] time 0.208 (0.206) data 0.082 (0.080) loss_x loss_x 0.6484 (0.6097) acc_x 87.5000 (85.6250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/18] time 0.201 (0.206) data 0.076 (0.080) loss_x loss_x 0.7598 (0.5735) acc_x 81.2500 (85.9375) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/18] time 0.209 (0.206) data 0.083 (0.080) loss_x loss_x 0.7886 (0.5754) acc_x 81.2500 (85.6250) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:594
clean false:3
clean_rate:0.9949748743718593
noisy true:510
noisy false:509
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [170/200] batch [5/18] time 0.198 (0.205) data 0.077 (0.081) loss_x loss_x 0.6758 (0.6450) acc_x 87.5000 (81.8750) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/18] time 0.203 (0.205) data 0.080 (0.081) loss_x loss_x 1.0918 (0.6424) acc_x 71.8750 (82.8125) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/18] time 0.207 (0.205) data 0.083 (0.081) loss_x loss_x 0.5503 (0.6383) acc_x 87.5000 (83.9583) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 509
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:609
clean false:4
clean_rate:0.9934747145187602
noisy true:498
noisy false:505
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [171/200] batch [5/19] time 0.206 (0.206) data 0.082 (0.082) loss_x loss_x 0.6372 (0.6214) acc_x 87.5000 (81.8750) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/19] time 0.203 (0.206) data 0.081 (0.082) loss_x loss_x 0.5215 (0.5683) acc_x 84.3750 (84.6875) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [15/19] time 0.225 (0.204) data 0.082 (0.082) loss_x loss_x 0.8018 (0.6036) acc_x 81.2500 (84.7917) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:581
clean false:9
clean_rate:0.9847457627118644
noisy true:506
noisy false:520
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [172/200] batch [5/18] time 0.209 (0.206) data 0.080 (0.080) loss_x loss_x 0.6890 (0.6373) acc_x 84.3750 (84.3750) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/18] time 0.157 (0.201) data 0.079 (0.080) loss_x loss_x 0.4634 (0.6011) acc_x 90.6250 (86.5625) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/18] time 0.204 (0.202) data 0.078 (0.079) loss_x loss_x 1.0664 (0.6466) acc_x 84.3750 (86.2500) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 600
clean true:591
clean false:9
clean_rate:0.985
noisy true:490
noisy false:526
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1016
epoch [173/200] batch [5/18] time 0.206 (0.203) data 0.081 (0.079) loss_x loss_x 0.4507 (0.6756) acc_x 93.7500 (84.3750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/18] time 0.206 (0.197) data 0.081 (0.079) loss_x loss_x 0.4600 (0.6101) acc_x 84.3750 (85.6250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/18] time 0.203 (0.199) data 0.079 (0.080) loss_x loss_x 0.7554 (0.5685) acc_x 84.3750 (87.0833) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:596
clean false:5
clean_rate:0.9916805324459235
noisy true:495
noisy false:520
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [174/200] batch [5/18] time 0.207 (0.193) data 0.080 (0.080) loss_x loss_x 0.5288 (0.7704) acc_x 90.6250 (80.0000) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/18] time 0.204 (0.199) data 0.081 (0.080) loss_x loss_x 0.5078 (0.6485) acc_x 90.6250 (84.0625) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [15/18] time 0.204 (0.201) data 0.079 (0.080) loss_x loss_x 0.4421 (0.5745) acc_x 90.6250 (85.8333) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:599
clean false:4
clean_rate:0.9933665008291874
noisy true:505
noisy false:508
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [175/200] batch [5/18] time 0.202 (0.193) data 0.079 (0.080) loss_x loss_x 0.7314 (0.5085) acc_x 71.8750 (86.8750) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/18] time 0.206 (0.199) data 0.081 (0.080) loss_x loss_x 0.8613 (0.5990) acc_x 81.2500 (84.6875) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [15/18] time 0.205 (0.201) data 0.080 (0.080) loss_x loss_x 0.5142 (0.5768) acc_x 87.5000 (86.0417) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:598
clean false:5
clean_rate:0.9917081260364843
noisy true:491
noisy false:522
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [176/200] batch [5/18] time 0.200 (0.198) data 0.078 (0.079) loss_x loss_x 0.8384 (0.5104) acc_x 75.0000 (85.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/18] time 0.204 (0.200) data 0.077 (0.078) loss_x loss_x 0.3757 (0.4790) acc_x 90.6250 (85.9375) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [15/18] time 0.202 (0.201) data 0.078 (0.079) loss_x loss_x 0.4753 (0.5098) acc_x 90.6250 (86.8750) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 614
clean true:609
clean false:5
clean_rate:0.99185667752443
noisy true:510
noisy false:492
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1002
epoch [177/200] batch [5/19] time 0.206 (0.209) data 0.078 (0.078) loss_x loss_x 0.4619 (0.5149) acc_x 87.5000 (85.6250) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/19] time 0.203 (0.206) data 0.079 (0.078) loss_x loss_x 0.5024 (0.5267) acc_x 87.5000 (86.2500) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/19] time 0.201 (0.205) data 0.078 (0.078) loss_x loss_x 1.1533 (0.6181) acc_x 71.8750 (83.9583) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.3639, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 588
clean true:581
clean false:7
clean_rate:0.9880952380952381
noisy true:501
noisy false:527
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1028
epoch [178/200] batch [5/18] time 0.201 (0.189) data 0.078 (0.078) loss_x loss_x 0.5244 (0.5424) acc_x 93.7500 (88.7500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/18] time 0.204 (0.197) data 0.077 (0.079) loss_x loss_x 0.5688 (0.5025) acc_x 90.6250 (89.6875) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/18] time 0.207 (0.199) data 0.081 (0.078) loss_x loss_x 0.5752 (0.6181) acc_x 84.3750 (85.4167) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:598
clean false:5
clean_rate:0.9917081260364843
noisy true:485
noisy false:528
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [179/200] batch [5/18] time 0.206 (0.200) data 0.078 (0.080) loss_x loss_x 0.6460 (0.7438) acc_x 81.2500 (83.7500) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/18] time 0.201 (0.200) data 0.076 (0.078) loss_x loss_x 0.4338 (0.6272) acc_x 90.6250 (85.9375) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/18] time 0.201 (0.201) data 0.075 (0.079) loss_x loss_x 0.6479 (0.5723) acc_x 81.2500 (86.2500) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 619
clean true:613
clean false:6
clean_rate:0.9903069466882067
noisy true:485
noisy false:512
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 997
epoch [180/200] batch [5/19] time 0.200 (0.196) data 0.078 (0.079) loss_x loss_x 0.7876 (0.6782) acc_x 78.1250 (84.3750) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/19] time 0.202 (0.200) data 0.078 (0.079) loss_x loss_x 0.6353 (0.7168) acc_x 93.7500 (83.7500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [15/19] time 0.201 (0.201) data 0.078 (0.079) loss_x loss_x 0.4641 (0.7031) acc_x 84.3750 (83.1250) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:607
clean false:8
clean_rate:0.9869918699186991
noisy true:493
noisy false:508
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [181/200] batch [5/19] time 0.157 (0.186) data 0.081 (0.079) loss_x loss_x 0.4248 (0.5821) acc_x 93.7500 (86.2500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/19] time 0.206 (0.195) data 0.080 (0.079) loss_x loss_x 0.4070 (0.5832) acc_x 84.3750 (85.0000) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/19] time 0.205 (0.199) data 0.079 (0.079) loss_x loss_x 0.8364 (0.5540) acc_x 78.1250 (85.4167) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 612
clean true:607
clean false:5
clean_rate:0.9918300653594772
noisy true:483
noisy false:521
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1004
epoch [182/200] batch [5/19] time 0.205 (0.205) data 0.077 (0.079) loss_x loss_x 0.2600 (0.7211) acc_x 93.7500 (80.6250) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/19] time 0.228 (0.196) data 0.078 (0.078) loss_x loss_x 0.8052 (0.7361) acc_x 84.3750 (80.6250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/19] time 0.205 (0.199) data 0.078 (0.078) loss_x loss_x 0.5142 (0.6487) acc_x 87.5000 (83.3333) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 626
clean true:618
clean false:8
clean_rate:0.987220447284345
noisy true:488
noisy false:502
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 990
epoch [183/200] batch [5/19] time 0.199 (0.201) data 0.077 (0.077) loss_x loss_x 0.3105 (0.5066) acc_x 90.6250 (86.2500) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/19] time 0.205 (0.201) data 0.079 (0.077) loss_x loss_x 0.4292 (0.5091) acc_x 93.7500 (86.2500) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [15/19] time 0.202 (0.201) data 0.077 (0.077) loss_x loss_x 0.7349 (0.5335) acc_x 81.2500 (85.2083) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 598
clean true:594
clean false:4
clean_rate:0.9933110367892977
noisy true:510
noisy false:508
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1018
epoch [184/200] batch [5/18] time 0.213 (0.204) data 0.086 (0.080) loss_x loss_x 0.6313 (0.5402) acc_x 87.5000 (88.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/18] time 0.203 (0.203) data 0.077 (0.078) loss_x loss_x 0.4373 (0.5385) acc_x 90.6250 (87.5000) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/18] time 0.205 (0.203) data 0.076 (0.078) loss_x loss_x 0.7808 (0.5321) acc_x 78.1250 (87.7083) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 610
clean true:605
clean false:5
clean_rate:0.9918032786885246
noisy true:469
noisy false:537
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1006
epoch [185/200] batch [5/19] time 0.198 (0.206) data 0.076 (0.077) loss_x loss_x 1.0615 (0.7121) acc_x 68.7500 (80.6250) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [10/19] time 0.206 (0.204) data 0.080 (0.078) loss_x loss_x 0.3621 (0.6295) acc_x 90.6250 (83.1250) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/19] time 0.200 (0.203) data 0.076 (0.078) loss_x loss_x 0.6890 (0.5966) acc_x 81.2500 (84.3750) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 495
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:599
clean false:6
clean_rate:0.9900826446280991
noisy true:522
noisy false:489
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [186/200] batch [5/18] time 0.202 (0.202) data 0.077 (0.078) loss_x loss_x 0.4822 (0.6531) acc_x 84.3750 (83.7500) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/18] time 0.203 (0.202) data 0.078 (0.078) loss_x loss_x 0.2307 (0.5208) acc_x 96.8750 (86.2500) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/18] time 0.206 (0.202) data 0.078 (0.078) loss_x loss_x 0.7393 (0.5760) acc_x 81.2500 (85.6250) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 587
clean true:581
clean false:6
clean_rate:0.989778534923339
noisy true:484
noisy false:545
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1029
epoch [187/200] batch [5/18] time 0.205 (0.204) data 0.077 (0.078) loss_x loss_x 0.5171 (0.4685) acc_x 84.3750 (88.7500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/18] time 0.208 (0.205) data 0.078 (0.078) loss_x loss_x 0.2356 (0.4493) acc_x 96.8750 (88.7500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/18] time 0.204 (0.204) data 0.078 (0.078) loss_x loss_x 0.4131 (0.5579) acc_x 90.6250 (86.2500) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 598
clean true:595
clean false:3
clean_rate:0.9949832775919732
noisy true:504
noisy false:514
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1018
epoch [188/200] batch [5/18] time 0.202 (0.203) data 0.078 (0.078) loss_x loss_x 0.4053 (0.4893) acc_x 90.6250 (88.7500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/18] time 0.201 (0.202) data 0.077 (0.077) loss_x loss_x 0.4553 (0.5622) acc_x 87.5000 (85.9375) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/18] time 0.203 (0.202) data 0.078 (0.077) loss_x loss_x 0.2869 (0.5622) acc_x 96.8750 (85.8333) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:599
clean false:4
clean_rate:0.9933665008291874
noisy true:506
noisy false:507
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [189/200] batch [5/18] time 0.204 (0.203) data 0.078 (0.078) loss_x loss_x 0.4141 (0.4578) acc_x 93.7500 (88.1250) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/18] time 0.201 (0.203) data 0.078 (0.078) loss_x loss_x 0.8101 (0.5170) acc_x 78.1250 (86.8750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/18] time 0.202 (0.202) data 0.077 (0.077) loss_x loss_x 0.5957 (0.5358) acc_x 87.5000 (86.4583) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 538
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:595
clean false:7
clean_rate:0.9883720930232558
noisy true:483
noisy false:531
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [190/200] batch [5/18] time 0.205 (0.204) data 0.079 (0.078) loss_x loss_x 0.5815 (0.4960) acc_x 84.3750 (87.5000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/18] time 0.203 (0.203) data 0.077 (0.077) loss_x loss_x 0.6626 (0.5641) acc_x 84.3750 (87.5000) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/18] time 0.200 (0.198) data 0.077 (0.077) loss_x loss_x 0.4395 (0.5926) acc_x 84.3750 (86.8750) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 513
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 610
clean true:603
clean false:7
clean_rate:0.9885245901639345
noisy true:500
noisy false:506
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1006
epoch [191/200] batch [5/19] time 0.200 (0.203) data 0.077 (0.078) loss_x loss_x 0.9341 (0.6056) acc_x 75.0000 (82.5000) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/19] time 0.200 (0.203) data 0.076 (0.078) loss_x loss_x 0.5933 (0.6368) acc_x 84.3750 (82.8125) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/19] time 0.200 (0.202) data 0.075 (0.078) loss_x loss_x 0.8984 (0.6255) acc_x 78.1250 (83.9583) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 593
clean true:589
clean false:4
clean_rate:0.9932546374367622
noisy true:490
noisy false:533
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1023
epoch [192/200] batch [5/18] time 0.202 (0.198) data 0.076 (0.077) loss_x loss_x 0.9155 (0.7596) acc_x 81.2500 (80.6250) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/18] time 0.203 (0.200) data 0.077 (0.077) loss_x loss_x 0.6348 (0.6083) acc_x 84.3750 (83.4375) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/18] time 0.202 (0.201) data 0.077 (0.077) loss_x loss_x 0.7290 (0.6092) acc_x 78.1250 (83.9583) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 513
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:609
clean false:4
clean_rate:0.9934747145187602
noisy true:494
noisy false:509
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [193/200] batch [5/19] time 0.216 (0.206) data 0.086 (0.079) loss_x loss_x 0.3318 (0.6391) acc_x 90.6250 (85.6250) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/19] time 0.203 (0.204) data 0.078 (0.078) loss_x loss_x 0.3147 (0.6833) acc_x 96.8750 (86.2500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/19] time 0.203 (0.204) data 0.076 (0.078) loss_x loss_x 0.4358 (0.6300) acc_x 93.7500 (87.5000) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 608
clean true:604
clean false:4
clean_rate:0.993421052631579
noisy true:476
noisy false:532
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1008
epoch [194/200] batch [5/19] time 0.202 (0.202) data 0.077 (0.077) loss_x loss_x 0.3333 (0.3427) acc_x 93.7500 (91.2500) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/19] time 0.203 (0.202) data 0.078 (0.077) loss_x loss_x 0.5264 (0.4187) acc_x 87.5000 (89.0625) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/19] time 0.199 (0.202) data 0.077 (0.077) loss_x loss_x 0.6401 (0.4843) acc_x 84.3750 (87.7083) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 618
clean true:612
clean false:6
clean_rate:0.9902912621359223
noisy true:488
noisy false:510
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 998
epoch [195/200] batch [5/19] time 0.201 (0.202) data 0.078 (0.077) loss_x loss_x 0.5771 (0.5861) acc_x 90.6250 (88.7500) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/19] time 0.202 (0.202) data 0.079 (0.077) loss_x loss_x 0.5620 (0.6177) acc_x 90.6250 (85.9375) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/19] time 0.203 (0.202) data 0.079 (0.077) loss_x loss_x 0.4128 (0.6463) acc_x 90.6250 (85.0000) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:600
clean false:3
clean_rate:0.9950248756218906
noisy true:482
noisy false:531
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [196/200] batch [5/18] time 0.201 (0.201) data 0.076 (0.077) loss_x loss_x 0.3606 (0.5454) acc_x 90.6250 (85.6250) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/18] time 0.201 (0.201) data 0.075 (0.077) loss_x loss_x 0.6768 (0.5262) acc_x 78.1250 (86.2500) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/18] time 0.202 (0.201) data 0.077 (0.077) loss_x loss_x 0.4692 (0.6297) acc_x 90.6250 (83.5417) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:598
clean false:7
clean_rate:0.9884297520661157
noisy true:498
noisy false:513
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [197/200] batch [5/18] time 0.155 (0.189) data 0.078 (0.078) loss_x loss_x 0.7427 (0.5198) acc_x 81.2500 (85.6250) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/18] time 0.205 (0.199) data 0.081 (0.079) loss_x loss_x 0.5122 (0.5707) acc_x 87.5000 (84.0625) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/18] time 0.202 (0.200) data 0.078 (0.078) loss_x loss_x 0.3931 (0.6045) acc_x 96.8750 (84.3750) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 600
clean true:596
clean false:4
clean_rate:0.9933333333333333
noisy true:508
noisy false:508
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1016
epoch [198/200] batch [5/18] time 0.203 (0.199) data 0.077 (0.078) loss_x loss_x 0.7041 (0.5709) acc_x 87.5000 (89.3750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/18] time 0.205 (0.201) data 0.080 (0.078) loss_x loss_x 0.5010 (0.5442) acc_x 84.3750 (87.5000) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/18] time 0.202 (0.202) data 0.078 (0.078) loss_x loss_x 0.3198 (0.5408) acc_x 93.7500 (87.2917) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 604
clean true:600
clean false:4
clean_rate:0.9933774834437086
noisy true:482
noisy false:530
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1012
epoch [199/200] batch [5/18] time 0.201 (0.208) data 0.077 (0.077) loss_x loss_x 0.6719 (0.5677) acc_x 81.2500 (83.7500) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/18] time 0.201 (0.205) data 0.078 (0.077) loss_x loss_x 0.5640 (0.5062) acc_x 84.3750 (85.6250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/18] time 0.201 (0.204) data 0.077 (0.077) loss_x loss_x 0.7676 (0.5581) acc_x 87.5000 (84.5833) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 591
clean true:588
clean false:3
clean_rate:0.9949238578680203
noisy true:506
noisy false:519
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1025
epoch [200/200] batch [5/18] time 0.203 (0.205) data 0.077 (0.077) loss_x loss_x 0.5952 (0.7185) acc_x 87.5000 (81.8750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/18] time 0.201 (0.203) data 0.076 (0.077) loss_x loss_x 0.5449 (0.6634) acc_x 84.3750 (81.8750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/18] time 0.205 (0.203) data 0.076 (0.077) loss_x loss_x 0.6484 (0.6484) acc_x 87.5000 (82.9167) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,626
* accuracy: 69.4%
* error: 30.6%
* macro_f1: 67.2%
Elapsed: 0:53:38
