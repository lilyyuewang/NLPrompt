***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.125', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '101']
output_dir: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.125
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.2735, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 442
clean true:439
clean false:3
clean_rate:0.9932126696832579
noisy true:73
noisy false:1101
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1174
epoch [1/200] batch [5/13] time 0.189 (0.207) data 0.112 (0.112) loss_x loss_x 2.4961 (2.4586) acc_x 40.6250 (50.6250) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/13] time 0.189 (0.198) data 0.112 (0.112) loss_x loss_x 2.3672 (2.4764) acc_x 50.0000 (52.1875) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 995
confident_label rate tensor(0.3274, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 529
clean true:527
clean false:2
clean_rate:0.996219281663516
noisy true:94
noisy false:993
after delete: len(clean_dataset) 529
after delete: len(noisy_dataset) 1087
epoch [2/200] batch [5/16] time 0.186 (0.186) data 0.109 (0.108) loss_x loss_x 1.4873 (1.5957) acc_x 59.3750 (65.6250) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/16] time 0.186 (0.185) data 0.108 (0.107) loss_x loss_x 1.0049 (1.4122) acc_x 84.3750 (68.1250) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [15/16] time 0.185 (0.183) data 0.107 (0.105) loss_x loss_x 1.3643 (1.3254) acc_x 65.6250 (68.5417) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 850
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 659
clean true:656
clean false:3
clean_rate:0.9954476479514416
noisy true:110
noisy false:847
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 957
epoch [3/200] batch [5/20] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.9819 (1.2161) acc_x 78.1250 (70.6250) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/20] time 0.200 (0.186) data 0.123 (0.108) loss_x loss_x 1.2793 (1.3566) acc_x 75.0000 (66.8750) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/20] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.9795 (1.3022) acc_x 78.1250 (66.8750) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [20/20] time 0.179 (0.184) data 0.102 (0.106) loss_x loss_x 1.1279 (1.2577) acc_x 75.0000 (68.4375) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 790
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 714
clean true:712
clean false:2
clean_rate:0.9971988795518207
noisy true:114
noisy false:788
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 902
epoch [4/200] batch [5/22] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.5459 (0.9928) acc_x 84.3750 (75.0000) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/22] time 0.185 (0.180) data 0.108 (0.102) loss_x loss_x 1.2070 (1.0202) acc_x 65.6250 (72.1875) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/22] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 1.1855 (1.1109) acc_x 65.6250 (69.7917) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [20/22] time 0.193 (0.185) data 0.115 (0.108) loss_x loss_x 1.6553 (1.1475) acc_x 56.2500 (69.3750) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 784
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 718
clean true:716
clean false:2
clean_rate:0.9972144846796658
noisy true:116
noisy false:782
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 898
epoch [5/200] batch [5/22] time 0.158 (0.159) data 0.081 (0.081) loss_x loss_x 1.3584 (1.1950) acc_x 68.7500 (70.6250) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/22] time 0.159 (0.162) data 0.082 (0.084) loss_x loss_x 1.0215 (1.1357) acc_x 75.0000 (71.2500) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/22] time 0.161 (0.166) data 0.083 (0.088) loss_x loss_x 1.2139 (1.0992) acc_x 65.6250 (72.2917) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/22] time 0.216 (0.169) data 0.138 (0.092) loss_x loss_x 1.1631 (1.0567) acc_x 75.0000 (74.3750) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 768
confident_label rate tensor(0.4517, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 730
clean true:728
clean false:2
clean_rate:0.9972602739726028
noisy true:120
noisy false:766
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 886
epoch [6/200] batch [5/22] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 1.1465 (0.8886) acc_x 78.1250 (77.5000) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/22] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.7837 (0.9343) acc_x 71.8750 (75.6250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/22] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 1.0205 (0.9806) acc_x 75.0000 (74.7917) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/22] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 1.1094 (0.9671) acc_x 68.7500 (75.1562) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 779
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 719
clean true:717
clean false:2
clean_rate:0.9972183588317107
noisy true:120
noisy false:777
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 897
epoch [7/200] batch [5/22] time 0.173 (0.182) data 0.096 (0.105) loss_x loss_x 0.8164 (0.8500) acc_x 78.1250 (78.1250) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/22] time 0.179 (0.182) data 0.102 (0.104) loss_x loss_x 0.8389 (0.8164) acc_x 75.0000 (78.4375) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/22] time 0.161 (0.179) data 0.084 (0.101) loss_x loss_x 0.6807 (0.8269) acc_x 78.1250 (78.1250) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/22] time 0.161 (0.174) data 0.083 (0.096) loss_x loss_x 1.3760 (0.9566) acc_x 65.6250 (75.7812) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 780
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 716
clean true:714
clean false:2
clean_rate:0.9972067039106145
noisy true:122
noisy false:778
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 900
epoch [8/200] batch [5/22] time 0.185 (0.169) data 0.107 (0.091) loss_x loss_x 0.4917 (0.8515) acc_x 90.6250 (78.1250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/22] time 0.216 (0.183) data 0.139 (0.105) loss_x loss_x 0.8530 (0.9622) acc_x 75.0000 (74.6875) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/22] time 0.182 (0.188) data 0.105 (0.110) loss_x loss_x 1.1641 (0.9996) acc_x 65.6250 (73.1250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/22] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.9365 (0.9852) acc_x 75.0000 (74.0625) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 762
confident_label rate tensor(0.4554, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 736
clean true:734
clean false:2
clean_rate:0.9972826086956522
noisy true:120
noisy false:760
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 880
epoch [9/200] batch [5/23] time 0.210 (0.188) data 0.133 (0.110) loss_x loss_x 1.0732 (1.0703) acc_x 71.8750 (73.7500) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/23] time 0.186 (0.184) data 0.109 (0.106) loss_x loss_x 0.9980 (1.0804) acc_x 81.2500 (73.4375) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/23] time 0.188 (0.187) data 0.111 (0.109) loss_x loss_x 1.4746 (1.0821) acc_x 71.8750 (74.5833) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/23] time 0.186 (0.186) data 0.108 (0.109) loss_x loss_x 0.6460 (1.0052) acc_x 81.2500 (75.4688) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 748
confident_label rate tensor(0.4623, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 747
clean true:745
clean false:2
clean_rate:0.9973226238286479
noisy true:123
noisy false:746
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 869
epoch [10/200] batch [5/23] time 0.183 (0.195) data 0.106 (0.117) loss_x loss_x 1.2041 (1.0398) acc_x 65.6250 (73.7500) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/23] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.4968 (1.0065) acc_x 87.5000 (75.6250) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/23] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 1.1631 (1.0211) acc_x 62.5000 (74.3750) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/23] time 0.177 (0.186) data 0.100 (0.109) loss_x loss_x 0.7974 (1.0293) acc_x 78.1250 (74.6875) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 729
confident_label rate tensor(0.4746, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 767
clean true:766
clean false:1
clean_rate:0.9986962190352021
noisy true:121
noisy false:728
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 849
epoch [11/200] batch [5/23] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 1.1934 (1.1023) acc_x 78.1250 (75.6250) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/23] time 0.159 (0.175) data 0.083 (0.097) loss_x loss_x 1.2090 (1.0488) acc_x 65.6250 (74.3750) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/23] time 0.183 (0.171) data 0.105 (0.094) loss_x loss_x 1.2598 (1.0281) acc_x 68.7500 (73.9583) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/23] time 0.181 (0.173) data 0.103 (0.096) loss_x loss_x 1.2109 (1.0339) acc_x 71.8750 (74.0625) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 763
confident_label rate tensor(0.4623, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 747
clean true:745
clean false:2
clean_rate:0.9973226238286479
noisy true:108
noisy false:761
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 869
epoch [12/200] batch [5/23] time 0.184 (0.186) data 0.106 (0.108) loss_x loss_x 0.8926 (0.9464) acc_x 81.2500 (74.3750) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/23] time 0.162 (0.175) data 0.084 (0.097) loss_x loss_x 1.2402 (0.9240) acc_x 78.1250 (77.5000) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/23] time 0.162 (0.170) data 0.084 (0.093) loss_x loss_x 0.6377 (0.9123) acc_x 84.3750 (76.6667) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/23] time 0.160 (0.168) data 0.082 (0.091) loss_x loss_x 0.8247 (0.9054) acc_x 81.2500 (76.7188) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 738
confident_label rate tensor(0.4709, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 761
clean true:761
clean false:0
clean_rate:1.0
noisy true:117
noisy false:738
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 855
epoch [13/200] batch [5/23] time 0.189 (0.189) data 0.112 (0.111) loss_x loss_x 0.4810 (0.8005) acc_x 90.6250 (81.2500) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/23] time 0.171 (0.185) data 0.093 (0.107) loss_x loss_x 1.4004 (0.9260) acc_x 71.8750 (80.0000) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/23] time 0.196 (0.187) data 0.118 (0.109) loss_x loss_x 1.0283 (0.9349) acc_x 71.8750 (78.9583) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/23] time 0.175 (0.186) data 0.098 (0.109) loss_x loss_x 0.8823 (0.9679) acc_x 84.3750 (77.3438) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 720
confident_label rate tensor(0.4814, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 778
clean true:778
clean false:0
clean_rate:1.0
noisy true:118
noisy false:720
after delete: len(clean_dataset) 778
after delete: len(noisy_dataset) 838
epoch [14/200] batch [5/24] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.7871 (0.8518) acc_x 71.8750 (80.6250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/24] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 1.1064 (0.9243) acc_x 65.6250 (77.1875) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/24] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.7910 (0.9491) acc_x 75.0000 (75.6250) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/24] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.8306 (0.9586) acc_x 78.1250 (74.8438) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 715
confident_label rate tensor(0.4821, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 779
clean true:778
clean false:1
clean_rate:0.9987163029525032
noisy true:123
noisy false:714
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 837
epoch [15/200] batch [5/24] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 1.0977 (1.0825) acc_x 71.8750 (74.3750) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/24] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.5244 (0.9202) acc_x 87.5000 (78.1250) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/24] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 1.2627 (0.9623) acc_x 65.6250 (76.2500) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/24] time 0.176 (0.182) data 0.098 (0.105) loss_x loss_x 1.2695 (0.9755) acc_x 68.7500 (75.4688) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 727
confident_label rate tensor(0.4740, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 766
clean true:764
clean false:2
clean_rate:0.9973890339425587
noisy true:125
noisy false:725
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 850
epoch [16/200] batch [5/23] time 0.181 (0.171) data 0.104 (0.093) loss_x loss_x 1.1572 (0.9773) acc_x 68.7500 (75.0000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/23] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 1.2080 (0.9270) acc_x 68.7500 (75.3125) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/23] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.4709 (0.8490) acc_x 84.3750 (76.0417) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/23] time 0.182 (0.181) data 0.105 (0.103) loss_x loss_x 1.0732 (0.8675) acc_x 65.6250 (75.6250) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 715
confident_label rate tensor(0.4777, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 772
clean true:772
clean false:0
clean_rate:1.0
noisy true:129
noisy false:715
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 844
epoch [17/200] batch [5/24] time 0.178 (0.197) data 0.101 (0.120) loss_x loss_x 1.0693 (1.0548) acc_x 75.0000 (72.5000) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/24] time 0.178 (0.186) data 0.100 (0.109) loss_x loss_x 0.8843 (0.9963) acc_x 81.2500 (74.3750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/24] time 0.162 (0.182) data 0.084 (0.105) loss_x loss_x 0.9902 (0.9943) acc_x 71.8750 (74.1667) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/24] time 0.179 (0.180) data 0.102 (0.102) loss_x loss_x 0.8188 (1.0029) acc_x 78.1250 (72.8125) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 699
confident_label rate tensor(0.4926, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 796
clean true:795
clean false:1
clean_rate:0.9987437185929648
noisy true:122
noisy false:698
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 820
epoch [18/200] batch [5/24] time 0.161 (0.168) data 0.083 (0.090) loss_x loss_x 0.8970 (1.1765) acc_x 75.0000 (72.5000) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/24] time 0.167 (0.169) data 0.089 (0.092) loss_x loss_x 0.8921 (1.0201) acc_x 81.2500 (75.0000) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/24] time 0.182 (0.174) data 0.104 (0.096) loss_x loss_x 1.0742 (0.9113) acc_x 65.6250 (76.8750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/24] time 0.188 (0.179) data 0.111 (0.101) loss_x loss_x 1.0039 (0.8971) acc_x 71.8750 (76.0938) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 706
confident_label rate tensor(0.4882, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 789
clean true:789
clean false:0
clean_rate:1.0
noisy true:121
noisy false:706
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 827
epoch [19/200] batch [5/24] time 0.159 (0.159) data 0.081 (0.081) loss_x loss_x 0.7710 (0.8861) acc_x 84.3750 (76.8750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/24] time 0.181 (0.161) data 0.104 (0.083) loss_x loss_x 0.4929 (0.8680) acc_x 87.5000 (77.5000) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/24] time 0.183 (0.168) data 0.105 (0.091) loss_x loss_x 0.7173 (0.8471) acc_x 68.7500 (77.5000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/24] time 0.185 (0.171) data 0.107 (0.094) loss_x loss_x 0.7993 (0.8818) acc_x 71.8750 (76.8750) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 701
confident_label rate tensor(0.4932, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 797
clean true:794
clean false:3
clean_rate:0.9962358845671268
noisy true:121
noisy false:698
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 819
epoch [20/200] batch [5/24] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.6362 (0.7670) acc_x 84.3750 (80.0000) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/24] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.9316 (0.8868) acc_x 75.0000 (76.2500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/24] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.9702 (0.8813) acc_x 65.6250 (75.8333) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/24] time 0.183 (0.183) data 0.105 (0.106) loss_x loss_x 1.4336 (0.9178) acc_x 65.6250 (75.6250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 711
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 773
clean true:772
clean false:1
clean_rate:0.9987063389391979
noisy true:133
noisy false:710
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 843
epoch [21/200] batch [5/24] time 0.182 (0.178) data 0.105 (0.100) loss_x loss_x 0.8970 (1.0441) acc_x 75.0000 (74.3750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/24] time 0.188 (0.187) data 0.112 (0.109) loss_x loss_x 0.8296 (0.9081) acc_x 78.1250 (75.3125) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/24] time 0.178 (0.186) data 0.101 (0.109) loss_x loss_x 1.0127 (0.9259) acc_x 78.1250 (75.6250) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/24] time 0.230 (0.187) data 0.153 (0.109) loss_x loss_x 0.6118 (0.9038) acc_x 84.3750 (75.9375) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 700
confident_label rate tensor(0.4913, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 794
clean true:794
clean false:0
clean_rate:1.0
noisy true:122
noisy false:700
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 822
epoch [22/200] batch [5/24] time 0.183 (0.183) data 0.106 (0.105) loss_x loss_x 0.7695 (0.9781) acc_x 78.1250 (72.5000) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/24] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 1.0830 (0.9198) acc_x 68.7500 (75.3125) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/24] time 0.195 (0.187) data 0.118 (0.110) loss_x loss_x 1.0186 (0.8931) acc_x 81.2500 (77.0833) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/24] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 1.1934 (0.9380) acc_x 68.7500 (75.9375) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:807
clean false:1
clean_rate:0.9987623762376238
noisy true:131
noisy false:677
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [23/200] batch [5/25] time 0.173 (0.190) data 0.095 (0.113) loss_x loss_x 0.8926 (0.9150) acc_x 78.1250 (78.1250) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/25] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 1.2725 (0.8968) acc_x 71.8750 (78.4375) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/25] time 0.182 (0.187) data 0.104 (0.110) loss_x loss_x 1.1357 (0.9560) acc_x 71.8750 (76.2500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/25] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.4280 (0.8946) acc_x 87.5000 (76.8750) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [25/25] time 0.159 (0.183) data 0.082 (0.105) loss_x loss_x 1.1475 (0.8988) acc_x 75.0000 (77.0000) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 822
clean true:819
clean false:3
clean_rate:0.9963503649635036
noisy true:129
noisy false:665
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 794
epoch [24/200] batch [5/25] time 0.162 (0.163) data 0.084 (0.086) loss_x loss_x 0.5830 (0.9350) acc_x 90.6250 (78.7500) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/25] time 0.165 (0.170) data 0.088 (0.092) loss_x loss_x 0.9565 (0.9544) acc_x 78.1250 (77.1875) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/25] time 0.179 (0.171) data 0.101 (0.093) loss_x loss_x 0.6128 (0.8735) acc_x 84.3750 (78.1250) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [20/25] time 0.183 (0.172) data 0.106 (0.095) loss_x loss_x 0.8960 (0.8628) acc_x 71.8750 (78.4375) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [25/25] time 0.181 (0.174) data 0.103 (0.097) loss_x loss_x 0.8105 (0.8644) acc_x 71.8750 (77.6250) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 809
clean true:807
clean false:2
clean_rate:0.9975278121137207
noisy true:123
noisy false:684
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 807
epoch [25/200] batch [5/25] time 0.181 (0.182) data 0.103 (0.104) loss_x loss_x 0.6533 (0.8026) acc_x 90.6250 (81.8750) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/25] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.9409 (0.8688) acc_x 78.1250 (80.6250) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/25] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 1.0098 (0.8819) acc_x 75.0000 (78.3333) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/25] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.9600 (0.9171) acc_x 78.1250 (78.1250) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [25/25] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6992 (0.9224) acc_x 84.3750 (77.6250) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.5068, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 819
clean true:818
clean false:1
clean_rate:0.9987789987789988
noisy true:130
noisy false:667
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 797
epoch [26/200] batch [5/25] time 0.184 (0.190) data 0.107 (0.112) loss_x loss_x 0.8584 (0.9118) acc_x 78.1250 (77.5000) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/25] time 0.209 (0.189) data 0.131 (0.112) loss_x loss_x 0.5664 (0.8063) acc_x 84.3750 (77.8125) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/25] time 0.161 (0.183) data 0.084 (0.105) loss_x loss_x 0.9536 (0.8740) acc_x 78.1250 (77.0833) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/25] time 0.164 (0.178) data 0.087 (0.100) loss_x loss_x 0.8706 (0.8801) acc_x 78.1250 (76.7188) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [25/25] time 0.164 (0.178) data 0.087 (0.101) loss_x loss_x 1.0371 (0.8957) acc_x 75.0000 (76.2500) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 666
confident_label rate tensor(0.5093, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 823
clean true:821
clean false:2
clean_rate:0.9975698663426489
noisy true:129
noisy false:664
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 793
epoch [27/200] batch [5/25] time 0.204 (0.182) data 0.126 (0.105) loss_x loss_x 0.6211 (0.8163) acc_x 84.3750 (79.3750) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/25] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.5366 (0.8052) acc_x 90.6250 (80.0000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/25] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 0.8389 (0.8474) acc_x 75.0000 (77.7083) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/25] time 0.183 (0.183) data 0.106 (0.105) loss_x loss_x 0.6670 (0.8432) acc_x 81.2500 (77.8125) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [25/25] time 0.160 (0.179) data 0.082 (0.101) loss_x loss_x 0.8359 (0.8607) acc_x 78.1250 (77.6250) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 641
confident_label rate tensor(0.5179, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 837
clean true:836
clean false:1
clean_rate:0.998805256869773
noisy true:139
noisy false:640
after delete: len(clean_dataset) 837
after delete: len(noisy_dataset) 779
epoch [28/200] batch [5/26] time 0.220 (0.191) data 0.143 (0.114) loss_x loss_x 0.8164 (0.7204) acc_x 75.0000 (81.8750) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/26] time 0.181 (0.189) data 0.103 (0.111) loss_x loss_x 1.0801 (0.8811) acc_x 65.6250 (75.3125) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/26] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 1.2930 (0.8905) acc_x 68.7500 (75.6250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/26] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 1.2373 (0.8827) acc_x 68.7500 (76.0938) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [25/26] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5449 (0.8822) acc_x 81.2500 (75.5000) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.5266, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 851
clean true:850
clean false:1
clean_rate:0.9988249118683902
noisy true:122
noisy false:643
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 765
epoch [29/200] batch [5/26] time 0.188 (0.187) data 0.110 (0.109) loss_x loss_x 0.9292 (0.8473) acc_x 81.2500 (77.5000) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/26] time 0.180 (0.187) data 0.102 (0.110) loss_x loss_x 0.8926 (0.9080) acc_x 78.1250 (74.6875) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/26] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.7036 (0.8941) acc_x 78.1250 (74.7917) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/26] time 0.189 (0.182) data 0.112 (0.105) loss_x loss_x 0.6621 (0.8543) acc_x 84.3750 (75.9375) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [25/26] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 1.1445 (0.8490) acc_x 65.6250 (75.7500) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.5272, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 852
clean true:852
clean false:0
clean_rate:1.0
noisy true:127
noisy false:637
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 764
epoch [30/200] batch [5/26] time 0.184 (0.186) data 0.106 (0.108) loss_x loss_x 0.8960 (0.8568) acc_x 75.0000 (78.7500) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/26] time 0.183 (0.185) data 0.106 (0.107) loss_x loss_x 0.5215 (0.8078) acc_x 84.3750 (79.0625) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/26] time 0.183 (0.185) data 0.105 (0.107) loss_x loss_x 0.9331 (0.8297) acc_x 71.8750 (77.2917) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/26] time 0.172 (0.183) data 0.094 (0.106) loss_x loss_x 0.9238 (0.8414) acc_x 75.0000 (76.8750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [25/26] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.9155 (0.8345) acc_x 68.7500 (77.0000) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 661
confident_label rate tensor(0.5173, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 836
clean true:834
clean false:2
clean_rate:0.9976076555023924
noisy true:121
noisy false:659
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 780
epoch [31/200] batch [5/26] time 0.159 (0.160) data 0.081 (0.082) loss_x loss_x 0.8486 (0.8405) acc_x 75.0000 (78.7500) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/26] time 0.214 (0.168) data 0.136 (0.090) loss_x loss_x 0.7417 (0.7434) acc_x 84.3750 (81.8750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/26] time 0.240 (0.175) data 0.162 (0.098) loss_x loss_x 0.6465 (0.7539) acc_x 81.2500 (79.7917) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/26] time 0.210 (0.180) data 0.133 (0.103) loss_x loss_x 1.2832 (0.7607) acc_x 75.0000 (80.1562) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [25/26] time 0.160 (0.179) data 0.083 (0.102) loss_x loss_x 0.8350 (0.7820) acc_x 78.1250 (79.2500) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.5278, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 853
clean true:853
clean false:0
clean_rate:1.0
noisy true:126
noisy false:637
after delete: len(clean_dataset) 853
after delete: len(noisy_dataset) 763
epoch [32/200] batch [5/26] time 0.183 (0.173) data 0.105 (0.096) loss_x loss_x 0.9771 (0.8672) acc_x 65.6250 (75.6250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/26] time 0.159 (0.171) data 0.081 (0.094) loss_x loss_x 0.6509 (0.7909) acc_x 81.2500 (79.3750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/26] time 0.159 (0.168) data 0.082 (0.090) loss_x loss_x 1.0332 (0.7762) acc_x 78.1250 (80.6250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/26] time 0.174 (0.170) data 0.097 (0.092) loss_x loss_x 0.7729 (0.7908) acc_x 78.1250 (80.4688) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [25/26] time 0.178 (0.170) data 0.100 (0.093) loss_x loss_x 0.9507 (0.8193) acc_x 71.8750 (79.0000) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.5093, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 823
clean true:823
clean false:0
clean_rate:1.0
noisy true:125
noisy false:668
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 793
epoch [33/200] batch [5/25] time 0.186 (0.176) data 0.109 (0.099) loss_x loss_x 0.8262 (0.7279) acc_x 81.2500 (82.5000) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/25] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.7632 (0.8580) acc_x 81.2500 (77.8125) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/25] time 0.178 (0.181) data 0.100 (0.104) loss_x loss_x 0.9146 (0.8849) acc_x 75.0000 (76.8750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/25] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.5864 (0.8777) acc_x 84.3750 (77.3438) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [25/25] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 1.0166 (0.8552) acc_x 75.0000 (78.1250) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.5198, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 840
clean true:839
clean false:1
clean_rate:0.9988095238095238
noisy true:131
noisy false:645
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 776
epoch [34/200] batch [5/26] time 0.188 (0.181) data 0.110 (0.103) loss_x loss_x 0.7886 (0.8005) acc_x 78.1250 (77.5000) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/26] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.9482 (0.8230) acc_x 78.1250 (77.8125) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/26] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.8960 (0.8044) acc_x 78.1250 (78.9583) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/26] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.9341 (0.7837) acc_x 78.1250 (79.3750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [25/26] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.9077 (0.8477) acc_x 81.2500 (78.0000) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 630
confident_label rate tensor(0.5309, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 858
clean true:856
clean false:2
clean_rate:0.9976689976689976
noisy true:130
noisy false:628
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 758
epoch [35/200] batch [5/26] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.9941 (0.9405) acc_x 71.8750 (73.7500) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/26] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 0.8105 (0.9071) acc_x 84.3750 (76.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/26] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.8135 (0.9127) acc_x 84.3750 (76.6667) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/26] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.7593 (0.8656) acc_x 81.2500 (77.8125) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [25/26] time 0.174 (0.176) data 0.096 (0.099) loss_x loss_x 0.6938 (0.8564) acc_x 81.2500 (78.6250) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.5217, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 843
clean true:841
clean false:2
clean_rate:0.9976275207591934
noisy true:123
noisy false:650
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 773
epoch [36/200] batch [5/26] time 0.171 (0.182) data 0.093 (0.104) loss_x loss_x 1.1182 (0.8066) acc_x 65.6250 (78.7500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/26] time 0.178 (0.184) data 0.100 (0.107) loss_x loss_x 0.4380 (0.7479) acc_x 90.6250 (80.6250) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/26] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 1.2021 (0.8035) acc_x 71.8750 (79.1667) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/26] time 0.185 (0.187) data 0.107 (0.109) loss_x loss_x 0.8843 (0.8481) acc_x 84.3750 (79.0625) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [25/26] time 0.186 (0.187) data 0.107 (0.109) loss_x loss_x 1.1465 (0.8487) acc_x 68.7500 (78.5000) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 600
confident_label rate tensor(0.5408, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 874
clean true:874
clean false:0
clean_rate:1.0
noisy true:142
noisy false:600
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 742
epoch [37/200] batch [5/27] time 0.180 (0.184) data 0.103 (0.106) loss_x loss_x 1.3662 (1.0255) acc_x 65.6250 (76.8750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/27] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 1.2627 (0.9908) acc_x 62.5000 (75.6250) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/27] time 0.204 (0.186) data 0.126 (0.109) loss_x loss_x 0.8604 (0.9316) acc_x 78.1250 (76.0417) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/27] time 0.243 (0.187) data 0.166 (0.109) loss_x loss_x 0.9248 (0.9432) acc_x 71.8750 (75.4688) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [25/27] time 0.183 (0.186) data 0.104 (0.109) loss_x loss_x 0.4692 (0.9078) acc_x 90.6250 (76.0000) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.5334, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 862
clean true:860
clean false:2
clean_rate:0.9976798143851509
noisy true:131
noisy false:623
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 754
epoch [38/200] batch [5/26] time 0.161 (0.159) data 0.084 (0.081) loss_x loss_x 0.7319 (0.8527) acc_x 78.1250 (79.3750) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/26] time 0.158 (0.159) data 0.081 (0.081) loss_x loss_x 0.8159 (0.8167) acc_x 75.0000 (78.1250) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/26] time 0.172 (0.160) data 0.095 (0.083) loss_x loss_x 1.1719 (0.9121) acc_x 71.8750 (75.4167) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/26] time 0.159 (0.167) data 0.082 (0.090) loss_x loss_x 0.4568 (0.8311) acc_x 87.5000 (77.5000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [25/26] time 0.163 (0.168) data 0.085 (0.090) loss_x loss_x 1.2793 (0.8395) acc_x 62.5000 (78.0000) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.5316, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 859
clean true:857
clean false:2
clean_rate:0.9976717112922002
noisy true:133
noisy false:624
after delete: len(clean_dataset) 859
after delete: len(noisy_dataset) 757
epoch [39/200] batch [5/26] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.8511 (0.7227) acc_x 75.0000 (81.2500) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/26] time 0.185 (0.180) data 0.107 (0.102) loss_x loss_x 0.8276 (0.7380) acc_x 78.1250 (80.9375) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/26] time 0.159 (0.179) data 0.082 (0.102) loss_x loss_x 1.1045 (0.7449) acc_x 71.8750 (81.2500) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/26] time 0.158 (0.175) data 0.082 (0.097) loss_x loss_x 0.8057 (0.7499) acc_x 78.1250 (80.4688) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [25/26] time 0.158 (0.171) data 0.081 (0.094) loss_x loss_x 0.7695 (0.7827) acc_x 78.1250 (79.3750) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 614
confident_label rate tensor(0.5359, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 866
clean true:865
clean false:1
clean_rate:0.9988452655889145
noisy true:137
noisy false:613
after delete: len(clean_dataset) 866
after delete: len(noisy_dataset) 750
epoch [40/200] batch [5/27] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5078 (0.7352) acc_x 87.5000 (81.8750) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/27] time 0.174 (0.182) data 0.096 (0.105) loss_x loss_x 0.8774 (0.7737) acc_x 75.0000 (78.4375) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [15/27] time 0.170 (0.178) data 0.092 (0.101) loss_x loss_x 0.7852 (0.8191) acc_x 71.8750 (76.6667) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [20/27] time 0.189 (0.178) data 0.112 (0.101) loss_x loss_x 0.9150 (0.8306) acc_x 75.0000 (77.3438) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [25/27] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.7744 (0.8347) acc_x 81.2500 (77.7500) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.5377, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 869
clean true:868
clean false:1
clean_rate:0.998849252013809
noisy true:125
noisy false:622
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 747
epoch [41/200] batch [5/27] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.9912 (0.7923) acc_x 75.0000 (76.8750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/27] time 0.182 (0.172) data 0.105 (0.094) loss_x loss_x 0.9150 (0.8542) acc_x 78.1250 (77.8125) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/27] time 0.186 (0.176) data 0.109 (0.098) loss_x loss_x 0.6089 (0.8372) acc_x 78.1250 (76.8750) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/27] time 0.183 (0.178) data 0.105 (0.101) loss_x loss_x 0.5669 (0.7908) acc_x 87.5000 (79.2188) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [25/27] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.5864 (0.7958) acc_x 87.5000 (79.3750) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 601
confident_label rate tensor(0.5526, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 893
clean true:893
clean false:0
clean_rate:1.0
noisy true:122
noisy false:601
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 723
epoch [42/200] batch [5/27] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.6689 (0.7600) acc_x 81.2500 (80.6250) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/27] time 0.181 (0.178) data 0.103 (0.101) loss_x loss_x 0.5664 (0.8115) acc_x 90.6250 (80.6250) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/27] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.8716 (0.8855) acc_x 75.0000 (78.7500) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/27] time 0.183 (0.182) data 0.105 (0.104) loss_x loss_x 1.1475 (0.9011) acc_x 62.5000 (77.5000) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [25/27] time 0.182 (0.185) data 0.105 (0.107) loss_x loss_x 1.2432 (0.8945) acc_x 65.6250 (77.7500) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.5452, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 881
clean true:879
clean false:2
clean_rate:0.9977298524404086
noisy true:141
noisy false:594
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 735
epoch [43/200] batch [5/27] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 1.0801 (0.8025) acc_x 84.3750 (84.3750) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/27] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.8979 (0.8211) acc_x 81.2500 (81.2500) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/27] time 0.185 (0.187) data 0.107 (0.109) loss_x loss_x 0.5381 (0.7974) acc_x 90.6250 (80.6250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [20/27] time 0.172 (0.183) data 0.094 (0.105) loss_x loss_x 0.9980 (0.8126) acc_x 81.2500 (80.4688) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [25/27] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 1.0381 (0.8320) acc_x 78.1250 (79.5000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 595
confident_label rate tensor(0.5476, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 885
clean true:885
clean false:0
clean_rate:1.0
noisy true:136
noisy false:595
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 731
epoch [44/200] batch [5/27] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.8643 (0.8445) acc_x 75.0000 (76.8750) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/27] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 1.0156 (0.8265) acc_x 65.6250 (77.8125) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/27] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.8940 (0.8674) acc_x 78.1250 (77.5000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [20/27] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.7300 (0.8302) acc_x 78.1250 (78.2812) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [25/27] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.9546 (0.8626) acc_x 71.8750 (77.7500) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.5446, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 880
clean true:879
clean false:1
clean_rate:0.9988636363636364
noisy true:132
noisy false:604
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 736
epoch [45/200] batch [5/27] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.9209 (0.9800) acc_x 78.1250 (75.0000) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/27] time 0.207 (0.188) data 0.129 (0.111) loss_x loss_x 1.0801 (0.8497) acc_x 71.8750 (76.8750) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/27] time 0.184 (0.191) data 0.107 (0.114) loss_x loss_x 1.0723 (0.8524) acc_x 75.0000 (76.8750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/27] time 0.183 (0.192) data 0.105 (0.115) loss_x loss_x 0.6880 (0.8450) acc_x 78.1250 (77.8125) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/27] time 0.184 (0.190) data 0.107 (0.113) loss_x loss_x 0.8892 (0.8513) acc_x 81.2500 (77.3750) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.5495, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 888
clean true:887
clean false:1
clean_rate:0.9988738738738738
noisy true:133
noisy false:595
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 728
epoch [46/200] batch [5/27] time 0.184 (0.189) data 0.107 (0.111) loss_x loss_x 0.5659 (0.8047) acc_x 84.3750 (78.1250) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [10/27] time 0.181 (0.186) data 0.104 (0.108) loss_x loss_x 0.6636 (0.8174) acc_x 81.2500 (78.4375) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/27] time 0.172 (0.185) data 0.095 (0.107) loss_x loss_x 0.8921 (0.8121) acc_x 78.1250 (77.5000) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/27] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.7573 (0.7602) acc_x 78.1250 (78.2812) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [25/27] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.7461 (0.7653) acc_x 84.3750 (78.7500) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 612
confident_label rate tensor(0.5452, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 881
clean true:879
clean false:2
clean_rate:0.9977298524404086
noisy true:125
noisy false:610
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 735
epoch [47/200] batch [5/27] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 1.1680 (0.9008) acc_x 78.1250 (75.0000) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/27] time 0.174 (0.182) data 0.096 (0.105) loss_x loss_x 1.4512 (0.9263) acc_x 71.8750 (75.3125) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/27] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.7031 (0.8871) acc_x 75.0000 (77.2917) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/27] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 0.9136 (0.8818) acc_x 68.7500 (76.8750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [25/27] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.9736 (0.8764) acc_x 81.2500 (78.2500) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 604
confident_label rate tensor(0.5433, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 878
clean true:878
clean false:0
clean_rate:1.0
noisy true:134
noisy false:604
after delete: len(clean_dataset) 878
after delete: len(noisy_dataset) 738
epoch [48/200] batch [5/27] time 0.181 (0.177) data 0.103 (0.100) loss_x loss_x 0.5259 (0.7001) acc_x 78.1250 (79.3750) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/27] time 0.183 (0.180) data 0.105 (0.103) loss_x loss_x 0.3162 (0.6818) acc_x 90.6250 (81.2500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/27] time 0.160 (0.177) data 0.083 (0.099) loss_x loss_x 0.8657 (0.7097) acc_x 81.2500 (80.6250) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/27] time 0.188 (0.176) data 0.111 (0.099) loss_x loss_x 0.8491 (0.7366) acc_x 75.0000 (80.1562) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [25/27] time 0.182 (0.178) data 0.104 (0.100) loss_x loss_x 1.1162 (0.7619) acc_x 78.1250 (80.3750) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.5452, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 881
clean true:879
clean false:2
clean_rate:0.9977298524404086
noisy true:131
noisy false:604
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 735
epoch [49/200] batch [5/27] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 1.1826 (0.8658) acc_x 71.8750 (79.3750) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [10/27] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4761 (0.7793) acc_x 90.6250 (81.5625) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/27] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.6919 (0.7333) acc_x 87.5000 (82.2917) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/27] time 0.198 (0.184) data 0.120 (0.106) loss_x loss_x 0.8159 (0.7525) acc_x 65.6250 (81.2500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [25/27] time 0.211 (0.185) data 0.133 (0.107) loss_x loss_x 0.3918 (0.7445) acc_x 90.6250 (81.7500) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 905
clean true:900
clean false:5
clean_rate:0.994475138121547
noisy true:125
noisy false:586
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 711
epoch [50/200] batch [5/28] time 0.158 (0.174) data 0.080 (0.096) loss_x loss_x 0.8789 (0.6481) acc_x 84.3750 (85.0000) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/28] time 0.161 (0.167) data 0.083 (0.089) loss_x loss_x 0.5718 (0.6095) acc_x 84.3750 (84.6875) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/28] time 0.163 (0.165) data 0.085 (0.087) loss_x loss_x 0.6768 (0.6729) acc_x 78.1250 (82.0833) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/28] time 0.160 (0.164) data 0.082 (0.087) loss_x loss_x 0.7559 (0.6970) acc_x 75.0000 (80.6250) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [25/28] time 0.158 (0.163) data 0.081 (0.086) loss_x loss_x 0.5581 (0.7079) acc_x 87.5000 (80.8750) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.5495, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 888
clean true:887
clean false:1
clean_rate:0.9988738738738738
noisy true:140
noisy false:588
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 728
epoch [51/200] batch [5/27] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8643 (0.6979) acc_x 78.1250 (79.3750) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/27] time 0.165 (0.178) data 0.087 (0.100) loss_x loss_x 0.6694 (0.7349) acc_x 84.3750 (80.6250) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/27] time 0.162 (0.174) data 0.085 (0.096) loss_x loss_x 0.7144 (0.7752) acc_x 84.3750 (79.7917) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [20/27] time 0.184 (0.175) data 0.106 (0.097) loss_x loss_x 0.5815 (0.7875) acc_x 78.1250 (78.9062) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [25/27] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.6807 (0.7805) acc_x 78.1250 (79.5000) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 564
confident_label rate tensor(0.5644, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 912
clean true:912
clean false:0
clean_rate:1.0
noisy true:140
noisy false:564
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 704
epoch [52/200] batch [5/28] time 0.159 (0.177) data 0.081 (0.100) loss_x loss_x 0.8657 (0.7671) acc_x 78.1250 (80.6250) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/28] time 0.159 (0.168) data 0.082 (0.091) loss_x loss_x 0.6675 (0.8123) acc_x 81.2500 (78.7500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/28] time 0.186 (0.178) data 0.108 (0.100) loss_x loss_x 1.0225 (0.8188) acc_x 65.6250 (78.5417) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [20/28] time 0.169 (0.177) data 0.091 (0.099) loss_x loss_x 0.5835 (0.8396) acc_x 84.3750 (78.2812) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [25/28] time 0.171 (0.177) data 0.093 (0.099) loss_x loss_x 1.0439 (0.8550) acc_x 81.2500 (78.6250) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.5514, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 891
clean true:888
clean false:3
clean_rate:0.9966329966329966
noisy true:130
noisy false:595
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 725
epoch [53/200] batch [5/27] time 0.187 (0.186) data 0.109 (0.108) loss_x loss_x 0.3018 (0.6428) acc_x 93.7500 (86.2500) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/27] time 0.198 (0.186) data 0.121 (0.109) loss_x loss_x 0.5820 (0.6796) acc_x 87.5000 (82.5000) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/27] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.9683 (0.7333) acc_x 78.1250 (81.4583) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [20/27] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5132 (0.7917) acc_x 87.5000 (80.1562) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [25/27] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4585 (0.7634) acc_x 90.6250 (80.6250) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.5656, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 914
clean true:913
clean false:1
clean_rate:0.9989059080962801
noisy true:136
noisy false:566
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 702
epoch [54/200] batch [5/28] time 0.160 (0.159) data 0.082 (0.082) loss_x loss_x 0.6948 (0.8551) acc_x 81.2500 (77.5000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/28] time 0.180 (0.175) data 0.102 (0.097) loss_x loss_x 0.8579 (0.7858) acc_x 87.5000 (80.9375) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/28] time 0.166 (0.173) data 0.089 (0.095) loss_x loss_x 0.6138 (0.7846) acc_x 81.2500 (80.4167) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/28] time 0.162 (0.173) data 0.084 (0.095) loss_x loss_x 1.0381 (0.8293) acc_x 84.3750 (79.8438) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [25/28] time 0.209 (0.174) data 0.132 (0.097) loss_x loss_x 0.8843 (0.8178) acc_x 75.0000 (80.1250) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 579
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 909
clean true:908
clean false:1
clean_rate:0.9988998899889989
noisy true:129
noisy false:578
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 707
epoch [55/200] batch [5/28] time 0.160 (0.164) data 0.082 (0.087) loss_x loss_x 0.6494 (0.8088) acc_x 81.2500 (76.2500) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/28] time 0.159 (0.162) data 0.083 (0.085) loss_x loss_x 0.7383 (0.8052) acc_x 75.0000 (78.4375) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/28] time 0.159 (0.161) data 0.082 (0.084) loss_x loss_x 0.7769 (0.8322) acc_x 81.2500 (78.9583) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/28] time 0.158 (0.161) data 0.081 (0.083) loss_x loss_x 0.4868 (0.8254) acc_x 84.3750 (79.0625) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [25/28] time 0.195 (0.162) data 0.118 (0.085) loss_x loss_x 0.4399 (0.7842) acc_x 84.3750 (79.7500) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.5644, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 912
clean true:909
clean false:3
clean_rate:0.9967105263157895
noisy true:135
noisy false:569
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 704
epoch [56/200] batch [5/28] time 0.168 (0.171) data 0.091 (0.094) loss_x loss_x 0.6436 (0.8791) acc_x 84.3750 (75.6250) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/28] time 0.189 (0.178) data 0.112 (0.101) loss_x loss_x 0.9546 (0.8758) acc_x 81.2500 (77.5000) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [15/28] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.6416 (0.8575) acc_x 81.2500 (77.5000) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/28] time 0.179 (0.181) data 0.102 (0.103) loss_x loss_x 1.3066 (0.9148) acc_x 65.6250 (75.6250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [25/28] time 0.183 (0.181) data 0.105 (0.103) loss_x loss_x 0.4636 (0.8618) acc_x 93.7500 (77.2500) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 565
confident_label rate tensor(0.5675, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 917
clean true:917
clean false:0
clean_rate:1.0
noisy true:134
noisy false:565
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 699
epoch [57/200] batch [5/28] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.7085 (0.7998) acc_x 87.5000 (81.2500) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/28] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.5430 (0.7122) acc_x 90.6250 (82.5000) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/28] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.5444 (0.7526) acc_x 84.3750 (79.7917) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [20/28] time 0.176 (0.182) data 0.098 (0.105) loss_x loss_x 0.6230 (0.7596) acc_x 81.2500 (79.8438) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [25/28] time 0.163 (0.180) data 0.085 (0.103) loss_x loss_x 0.5825 (0.7411) acc_x 84.3750 (80.3750) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 562
confident_label rate tensor(0.5774, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 933
clean true:931
clean false:2
clean_rate:0.9978563772775991
noisy true:123
noisy false:560
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 683
epoch [58/200] batch [5/29] time 0.174 (0.181) data 0.097 (0.104) loss_x loss_x 0.2246 (0.7030) acc_x 93.7500 (78.1250) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/29] time 0.161 (0.173) data 0.083 (0.096) loss_x loss_x 0.5947 (0.7082) acc_x 87.5000 (80.3125) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/29] time 0.162 (0.170) data 0.084 (0.092) loss_x loss_x 0.7007 (0.7380) acc_x 81.2500 (80.2083) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [20/29] time 0.182 (0.173) data 0.104 (0.095) loss_x loss_x 0.8433 (0.7506) acc_x 75.0000 (80.0000) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [25/29] time 0.165 (0.171) data 0.088 (0.093) loss_x loss_x 0.8086 (0.7692) acc_x 78.1250 (79.5000) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.5668, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 916
clean true:915
clean false:1
clean_rate:0.9989082969432315
noisy true:140
noisy false:560
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 700
epoch [59/200] batch [5/28] time 0.168 (0.170) data 0.091 (0.092) loss_x loss_x 0.6328 (0.5991) acc_x 84.3750 (84.3750) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/28] time 0.181 (0.168) data 0.104 (0.091) loss_x loss_x 0.8608 (0.5669) acc_x 78.1250 (85.9375) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/28] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.7129 (0.5826) acc_x 81.2500 (83.5417) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/28] time 0.183 (0.177) data 0.104 (0.099) loss_x loss_x 1.0742 (0.6460) acc_x 68.7500 (81.8750) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [25/28] time 0.182 (0.178) data 0.104 (0.100) loss_x loss_x 1.0049 (0.6720) acc_x 68.7500 (81.5000) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.5848, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 945
clean true:941
clean false:4
clean_rate:0.9957671957671957
noisy true:138
noisy false:533
after delete: len(clean_dataset) 945
after delete: len(noisy_dataset) 671
epoch [60/200] batch [5/29] time 0.184 (0.182) data 0.106 (0.105) loss_x loss_x 1.3135 (0.9144) acc_x 62.5000 (74.3750) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/29] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.5332 (0.7731) acc_x 87.5000 (79.0625) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/29] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.3889 (0.6980) acc_x 87.5000 (80.4167) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/29] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.4792 (0.7609) acc_x 87.5000 (79.8438) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [25/29] time 0.170 (0.183) data 0.093 (0.105) loss_x loss_x 0.9224 (0.7651) acc_x 71.8750 (78.8750) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.5705, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 922
clean true:920
clean false:2
clean_rate:0.9978308026030369
noisy true:138
noisy false:556
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 694
epoch [61/200] batch [5/28] time 0.186 (0.187) data 0.108 (0.109) loss_x loss_x 0.3491 (0.6883) acc_x 90.6250 (78.7500) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/28] time 0.183 (0.185) data 0.105 (0.107) loss_x loss_x 0.6074 (0.7949) acc_x 84.3750 (78.4375) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/28] time 0.182 (0.180) data 0.105 (0.102) loss_x loss_x 0.9683 (0.7964) acc_x 78.1250 (78.1250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/28] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.5728 (0.7388) acc_x 90.6250 (80.3125) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/28] time 0.164 (0.180) data 0.086 (0.102) loss_x loss_x 0.8438 (0.7620) acc_x 75.0000 (79.1250) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.5780, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 934
clean true:933
clean false:1
clean_rate:0.9989293361884368
noisy true:130
noisy false:552
after delete: len(clean_dataset) 934
after delete: len(noisy_dataset) 682
epoch [62/200] batch [5/29] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.3394 (0.7114) acc_x 90.6250 (81.2500) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/29] time 0.186 (0.185) data 0.109 (0.107) loss_x loss_x 0.3130 (0.7523) acc_x 93.7500 (80.0000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/29] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 0.6401 (0.7430) acc_x 81.2500 (80.6250) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/29] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.5371 (0.7412) acc_x 81.2500 (80.1562) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [25/29] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.6875 (0.7271) acc_x 87.5000 (80.6250) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 556
confident_label rate tensor(0.5749, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 929
clean true:927
clean false:2
clean_rate:0.9978471474703983
noisy true:133
noisy false:554
after delete: len(clean_dataset) 929
after delete: len(noisy_dataset) 687
epoch [63/200] batch [5/29] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.6382 (0.6689) acc_x 84.3750 (83.7500) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/29] time 0.162 (0.175) data 0.085 (0.098) loss_x loss_x 0.7495 (0.6942) acc_x 78.1250 (83.1250) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/29] time 0.172 (0.172) data 0.095 (0.095) loss_x loss_x 0.6382 (0.6786) acc_x 84.3750 (82.9167) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/29] time 0.158 (0.169) data 0.081 (0.091) loss_x loss_x 0.6807 (0.6708) acc_x 81.2500 (83.2812) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/29] time 0.161 (0.167) data 0.083 (0.090) loss_x loss_x 0.5688 (0.6381) acc_x 87.5000 (83.7500) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.5613, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 907
clean true:905
clean false:2
clean_rate:0.9977949283351709
noisy true:142
noisy false:567
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 709
epoch [64/200] batch [5/28] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.9390 (0.6917) acc_x 78.1250 (83.7500) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/28] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.7256 (0.6779) acc_x 78.1250 (82.8125) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/28] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.6885 (0.7122) acc_x 87.5000 (82.7083) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/28] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.9785 (0.7453) acc_x 68.7500 (80.7812) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [25/28] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.7417 (0.7357) acc_x 78.1250 (80.3750) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 547
confident_label rate tensor(0.5780, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 934
clean true:932
clean false:2
clean_rate:0.9978586723768736
noisy true:137
noisy false:545
after delete: len(clean_dataset) 934
after delete: len(noisy_dataset) 682
epoch [65/200] batch [5/29] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.7593 (0.8220) acc_x 87.5000 (80.0000) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/29] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 0.7192 (0.7609) acc_x 75.0000 (80.6250) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/29] time 0.173 (0.184) data 0.095 (0.106) loss_x loss_x 1.3164 (0.7881) acc_x 65.6250 (80.2083) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/29] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.9014 (0.8406) acc_x 75.0000 (79.8438) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [25/29] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 1.1543 (0.8338) acc_x 75.0000 (80.2500) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.5792, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 936
clean true:936
clean false:0
clean_rate:1.0
noisy true:145
noisy false:535
after delete: len(clean_dataset) 936
after delete: len(noisy_dataset) 680
epoch [66/200] batch [5/29] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.9092 (0.7702) acc_x 81.2500 (82.5000) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/29] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 1.0381 (0.7387) acc_x 71.8750 (81.8750) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/29] time 0.185 (0.184) data 0.107 (0.106) loss_x loss_x 0.7285 (0.7413) acc_x 75.0000 (80.6250) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/29] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.6934 (0.7129) acc_x 75.0000 (81.2500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [25/29] time 0.225 (0.184) data 0.148 (0.107) loss_x loss_x 0.5845 (0.7052) acc_x 87.5000 (81.8750) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.5644, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 912
clean true:909
clean false:3
clean_rate:0.9967105263157895
noisy true:134
noisy false:570
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 704
epoch [67/200] batch [5/28] time 0.180 (0.182) data 0.102 (0.105) loss_x loss_x 0.7158 (0.7727) acc_x 68.7500 (73.7500) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/28] time 0.176 (0.184) data 0.099 (0.107) loss_x loss_x 0.7432 (0.7815) acc_x 78.1250 (75.3125) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/28] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.9722 (0.7539) acc_x 71.8750 (77.7083) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/28] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.8130 (0.7336) acc_x 81.2500 (80.0000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/28] time 0.181 (0.185) data 0.103 (0.108) loss_x loss_x 1.1924 (0.7428) acc_x 65.6250 (79.1250) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 556
confident_label rate tensor(0.5699, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 921
clean true:918
clean false:3
clean_rate:0.996742671009772
noisy true:142
noisy false:553
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 695
epoch [68/200] batch [5/28] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.4399 (0.6522) acc_x 87.5000 (80.0000) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [10/28] time 0.165 (0.175) data 0.088 (0.098) loss_x loss_x 0.7788 (0.7523) acc_x 84.3750 (78.1250) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/28] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.8159 (0.7228) acc_x 78.1250 (79.5833) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/28] time 0.184 (0.180) data 0.106 (0.102) loss_x loss_x 0.6138 (0.7123) acc_x 81.2500 (79.6875) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [25/28] time 0.184 (0.181) data 0.107 (0.103) loss_x loss_x 0.6577 (0.6997) acc_x 84.3750 (81.2500) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.5774, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 933
clean true:931
clean false:2
clean_rate:0.9978563772775991
noisy true:136
noisy false:547
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 683
epoch [69/200] batch [5/29] time 0.186 (0.184) data 0.108 (0.106) loss_x loss_x 0.7593 (0.6881) acc_x 71.8750 (79.3750) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/29] time 0.187 (0.185) data 0.110 (0.107) loss_x loss_x 0.4194 (0.6614) acc_x 90.6250 (81.5625) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/29] time 0.184 (0.187) data 0.107 (0.109) loss_x loss_x 0.7871 (0.6629) acc_x 75.0000 (81.6667) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/29] time 0.172 (0.185) data 0.095 (0.108) loss_x loss_x 0.5317 (0.6518) acc_x 90.6250 (82.3438) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/29] time 0.182 (0.185) data 0.104 (0.107) loss_x loss_x 1.2344 (0.6907) acc_x 71.8750 (82.1250) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.5829, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 942
clean true:939
clean false:3
clean_rate:0.9968152866242038
noisy true:132
noisy false:542
after delete: len(clean_dataset) 942
after delete: len(noisy_dataset) 674
epoch [70/200] batch [5/29] time 0.161 (0.161) data 0.084 (0.083) loss_x loss_x 0.9258 (0.7586) acc_x 75.0000 (80.0000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/29] time 0.187 (0.163) data 0.110 (0.085) loss_x loss_x 1.4209 (0.8691) acc_x 59.3750 (77.5000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/29] time 0.176 (0.167) data 0.099 (0.089) loss_x loss_x 0.9512 (0.8263) acc_x 71.8750 (78.1250) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/29] time 0.167 (0.169) data 0.089 (0.091) loss_x loss_x 0.8521 (0.8043) acc_x 75.0000 (78.5938) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [25/29] time 0.185 (0.170) data 0.108 (0.093) loss_x loss_x 0.7886 (0.8045) acc_x 78.1250 (78.2500) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.5798, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 937
clean true:935
clean false:2
clean_rate:0.9978655282817502
noisy true:128
noisy false:551
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 679
epoch [71/200] batch [5/29] time 0.181 (0.182) data 0.103 (0.105) loss_x loss_x 0.7300 (0.6792) acc_x 75.0000 (83.1250) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/29] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.2634 (0.7082) acc_x 96.8750 (81.5625) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/29] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.7896 (0.7112) acc_x 75.0000 (81.8750) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/29] time 0.167 (0.171) data 0.089 (0.094) loss_x loss_x 0.7573 (0.7561) acc_x 87.5000 (80.6250) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/29] time 0.159 (0.170) data 0.082 (0.093) loss_x loss_x 1.1191 (0.7670) acc_x 62.5000 (80.1250) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.5910, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 955
clean true:952
clean false:3
clean_rate:0.9968586387434555
noisy true:135
noisy false:526
after delete: len(clean_dataset) 955
after delete: len(noisy_dataset) 661
epoch [72/200] batch [5/29] time 0.168 (0.174) data 0.090 (0.096) loss_x loss_x 0.3845 (0.7712) acc_x 90.6250 (83.7500) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [10/29] time 0.181 (0.174) data 0.104 (0.096) loss_x loss_x 0.5903 (0.7581) acc_x 84.3750 (80.0000) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [15/29] time 0.176 (0.176) data 0.098 (0.099) loss_x loss_x 0.9121 (0.8198) acc_x 78.1250 (78.5417) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/29] time 0.181 (0.177) data 0.103 (0.099) loss_x loss_x 0.6836 (0.7827) acc_x 87.5000 (79.3750) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/29] time 0.158 (0.175) data 0.081 (0.098) loss_x loss_x 0.8374 (0.7974) acc_x 75.0000 (78.8750) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 546
confident_label rate tensor(0.5767, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 932
clean true:931
clean false:1
clean_rate:0.9989270386266095
noisy true:139
noisy false:545
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 684
epoch [73/200] batch [5/29] time 0.190 (0.185) data 0.112 (0.108) loss_x loss_x 0.6152 (0.6415) acc_x 84.3750 (83.1250) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [10/29] time 0.184 (0.183) data 0.107 (0.105) loss_x loss_x 0.6543 (0.6067) acc_x 93.7500 (84.0625) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/29] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5586 (0.6354) acc_x 84.3750 (83.3333) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/29] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.6982 (0.6929) acc_x 84.3750 (81.8750) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [25/29] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.6816 (0.6911) acc_x 87.5000 (81.3750) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.5854, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 946
clean true:943
clean false:3
clean_rate:0.9968287526427061
noisy true:134
noisy false:536
after delete: len(clean_dataset) 946
after delete: len(noisy_dataset) 670
epoch [74/200] batch [5/29] time 0.180 (0.171) data 0.102 (0.093) loss_x loss_x 0.2981 (0.7117) acc_x 90.6250 (80.6250) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/29] time 0.203 (0.179) data 0.126 (0.102) loss_x loss_x 0.3135 (0.6412) acc_x 90.6250 (82.8125) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/29] time 0.175 (0.179) data 0.097 (0.102) loss_x loss_x 0.4214 (0.7238) acc_x 87.5000 (82.9167) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/29] time 0.165 (0.176) data 0.088 (0.098) loss_x loss_x 1.2402 (0.7748) acc_x 71.8750 (81.8750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [25/29] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 1.1934 (0.7994) acc_x 62.5000 (80.2500) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.5860, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 947
clean true:945
clean false:2
clean_rate:0.9978880675818373
noisy true:138
noisy false:531
after delete: len(clean_dataset) 947
after delete: len(noisy_dataset) 669
epoch [75/200] batch [5/29] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.2705 (0.5819) acc_x 96.8750 (85.0000) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/29] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.7656 (0.6874) acc_x 75.0000 (81.5625) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/29] time 0.160 (0.181) data 0.082 (0.103) loss_x loss_x 0.7412 (0.7391) acc_x 87.5000 (81.8750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/29] time 0.162 (0.177) data 0.084 (0.100) loss_x loss_x 0.5669 (0.7213) acc_x 81.2500 (81.2500) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [25/29] time 0.187 (0.177) data 0.109 (0.100) loss_x loss_x 0.4624 (0.6823) acc_x 84.3750 (82.0000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.5941, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 960
clean true:956
clean false:4
clean_rate:0.9958333333333333
noisy true:128
noisy false:528
after delete: len(clean_dataset) 960
after delete: len(noisy_dataset) 656
epoch [76/200] batch [5/30] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 0.6538 (0.6794) acc_x 90.6250 (86.2500) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/30] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4592 (0.6502) acc_x 81.2500 (83.7500) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/30] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7847 (0.6599) acc_x 71.8750 (82.5000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/30] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.7471 (0.6778) acc_x 81.2500 (82.0312) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [25/30] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.5537 (0.6978) acc_x 81.2500 (81.6250) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [30/30] time 0.164 (0.183) data 0.086 (0.106) loss_x loss_x 0.9380 (0.7081) acc_x 78.1250 (81.3542) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.6040, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 976
clean true:973
clean false:3
clean_rate:0.9969262295081968
noisy true:139
noisy false:501
after delete: len(clean_dataset) 976
after delete: len(noisy_dataset) 640
epoch [77/200] batch [5/30] time 0.183 (0.185) data 0.105 (0.108) loss_x loss_x 0.8164 (0.6942) acc_x 71.8750 (78.1250) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [10/30] time 0.182 (0.184) data 0.105 (0.106) loss_x loss_x 0.4939 (0.6968) acc_x 84.3750 (79.3750) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/30] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6885 (0.7318) acc_x 75.0000 (79.3750) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/30] time 0.186 (0.184) data 0.109 (0.106) loss_x loss_x 0.4705 (0.7251) acc_x 90.6250 (79.8438) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [25/30] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7285 (0.7371) acc_x 87.5000 (80.1250) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [30/30] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.9932 (0.7507) acc_x 75.0000 (79.8958) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.5978, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 966
clean true:964
clean false:2
clean_rate:0.9979296066252588
noisy true:123
noisy false:527
after delete: len(clean_dataset) 966
after delete: len(noisy_dataset) 650
epoch [78/200] batch [5/30] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 1.1240 (0.7186) acc_x 71.8750 (80.6250) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [10/30] time 0.181 (0.183) data 0.103 (0.106) loss_x loss_x 0.4185 (0.6699) acc_x 87.5000 (82.5000) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/30] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.4302 (0.6826) acc_x 90.6250 (82.5000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/30] time 0.162 (0.182) data 0.085 (0.105) loss_x loss_x 0.6699 (0.7124) acc_x 81.2500 (81.5625) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [25/30] time 0.159 (0.178) data 0.082 (0.100) loss_x loss_x 0.7603 (0.7087) acc_x 78.1250 (82.0000) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [30/30] time 0.189 (0.177) data 0.111 (0.100) loss_x loss_x 0.4204 (0.7145) acc_x 90.6250 (81.7708) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.5996, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 969
clean true:964
clean false:5
clean_rate:0.9948400412796697
noisy true:132
noisy false:515
after delete: len(clean_dataset) 969
after delete: len(noisy_dataset) 647
epoch [79/200] batch [5/30] time 0.186 (0.187) data 0.109 (0.109) loss_x loss_x 0.6758 (0.6488) acc_x 87.5000 (83.1250) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/30] time 0.160 (0.183) data 0.082 (0.105) loss_x loss_x 0.8154 (0.7144) acc_x 75.0000 (80.6250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/30] time 0.172 (0.181) data 0.094 (0.103) loss_x loss_x 0.9170 (0.6975) acc_x 75.0000 (81.2500) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/30] time 0.162 (0.179) data 0.084 (0.101) loss_x loss_x 0.6025 (0.6896) acc_x 78.1250 (81.5625) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [25/30] time 0.161 (0.176) data 0.083 (0.098) loss_x loss_x 0.5176 (0.6769) acc_x 87.5000 (81.5000) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [30/30] time 0.159 (0.173) data 0.082 (0.096) loss_x loss_x 0.2793 (0.6640) acc_x 90.6250 (81.7708) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.5786, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 935
clean true:930
clean false:5
clean_rate:0.9946524064171123
noisy true:141
noisy false:540
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 681
epoch [80/200] batch [5/29] time 0.182 (0.189) data 0.105 (0.112) loss_x loss_x 0.9805 (0.7045) acc_x 71.8750 (83.1250) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/29] time 0.187 (0.186) data 0.109 (0.109) loss_x loss_x 0.1871 (0.6344) acc_x 100.0000 (85.0000) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [15/29] time 0.185 (0.186) data 0.107 (0.108) loss_x loss_x 1.0068 (0.6991) acc_x 81.2500 (82.7083) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/29] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.7603 (0.6898) acc_x 84.3750 (83.2812) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/29] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.5967 (0.6908) acc_x 90.6250 (83.5000) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.5934, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 959
clean true:958
clean false:1
clean_rate:0.9989572471324296
noisy true:130
noisy false:527
after delete: len(clean_dataset) 959
after delete: len(noisy_dataset) 657
epoch [81/200] batch [5/29] time 0.191 (0.183) data 0.114 (0.106) loss_x loss_x 0.5073 (0.7662) acc_x 84.3750 (80.6250) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/29] time 0.191 (0.184) data 0.113 (0.107) loss_x loss_x 0.6260 (0.6275) acc_x 81.2500 (84.0625) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/29] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.2825 (0.5648) acc_x 100.0000 (86.6667) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/29] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.6006 (0.6074) acc_x 90.6250 (85.1562) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [25/29] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.6475 (0.6046) acc_x 84.3750 (85.0000) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.6052, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 978
clean true:974
clean false:4
clean_rate:0.9959100204498977
noisy true:131
noisy false:507
after delete: len(clean_dataset) 978
after delete: len(noisy_dataset) 638
epoch [82/200] batch [5/30] time 0.173 (0.182) data 0.096 (0.104) loss_x loss_x 1.0908 (0.6455) acc_x 78.1250 (84.3750) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [10/30] time 0.202 (0.182) data 0.125 (0.104) loss_x loss_x 0.6465 (0.6707) acc_x 84.3750 (85.6250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [15/30] time 0.198 (0.184) data 0.121 (0.107) loss_x loss_x 0.6382 (0.6274) acc_x 84.3750 (84.1667) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/30] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6982 (0.6474) acc_x 81.2500 (83.1250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [25/30] time 0.186 (0.185) data 0.108 (0.107) loss_x loss_x 0.7397 (0.6555) acc_x 81.2500 (83.3750) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [30/30] time 0.191 (0.185) data 0.114 (0.108) loss_x loss_x 0.9854 (0.6832) acc_x 75.0000 (82.3958) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.6058, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 979
clean true:977
clean false:2
clean_rate:0.9979570990806946
noisy true:134
noisy false:503
after delete: len(clean_dataset) 979
after delete: len(noisy_dataset) 637
epoch [83/200] batch [5/30] time 0.190 (0.185) data 0.112 (0.108) loss_x loss_x 0.8994 (0.7708) acc_x 84.3750 (82.5000) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [10/30] time 0.183 (0.189) data 0.106 (0.112) loss_x loss_x 0.5957 (0.7792) acc_x 87.5000 (81.2500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/30] time 0.182 (0.188) data 0.104 (0.111) loss_x loss_x 0.6826 (0.7740) acc_x 87.5000 (82.2917) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/30] time 0.168 (0.186) data 0.091 (0.109) loss_x loss_x 0.7319 (0.7485) acc_x 78.1250 (81.8750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/30] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6367 (0.7324) acc_x 90.6250 (82.1250) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [30/30] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 0.4167 (0.7076) acc_x 84.3750 (82.5000) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.6077, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 982
clean true:980
clean false:2
clean_rate:0.9979633401221996
noisy true:132
noisy false:502
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 634
epoch [84/200] batch [5/30] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.4500 (0.5922) acc_x 84.3750 (83.7500) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/30] time 0.160 (0.169) data 0.082 (0.091) loss_x loss_x 0.8037 (0.6573) acc_x 81.2500 (80.9375) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/30] time 0.183 (0.169) data 0.105 (0.092) loss_x loss_x 0.4526 (0.6847) acc_x 87.5000 (80.2083) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/30] time 0.183 (0.173) data 0.106 (0.095) loss_x loss_x 0.8877 (0.6501) acc_x 78.1250 (81.7188) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [25/30] time 0.168 (0.173) data 0.090 (0.095) loss_x loss_x 0.4316 (0.6526) acc_x 81.2500 (81.1250) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [30/30] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.8438 (0.6575) acc_x 81.2500 (81.1458) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.6033, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 975
clean true:973
clean false:2
clean_rate:0.997948717948718
noisy true:139
noisy false:502
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 641
epoch [85/200] batch [5/30] time 0.164 (0.167) data 0.086 (0.090) loss_x loss_x 0.7671 (0.7252) acc_x 84.3750 (82.5000) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [10/30] time 0.169 (0.176) data 0.091 (0.098) loss_x loss_x 0.3909 (0.7286) acc_x 93.7500 (81.8750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [15/30] time 0.183 (0.176) data 0.105 (0.098) loss_x loss_x 0.5493 (0.7100) acc_x 90.6250 (82.7083) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [20/30] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.6948 (0.7393) acc_x 75.0000 (81.8750) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [25/30] time 0.159 (0.174) data 0.081 (0.097) loss_x loss_x 0.5444 (0.7583) acc_x 87.5000 (81.6250) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [30/30] time 0.179 (0.174) data 0.102 (0.097) loss_x loss_x 0.8306 (0.7605) acc_x 75.0000 (81.0417) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.6101, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 986
clean true:983
clean false:3
clean_rate:0.9969574036511156
noisy true:140
noisy false:490
after delete: len(clean_dataset) 986
after delete: len(noisy_dataset) 630
epoch [86/200] batch [5/30] time 0.162 (0.160) data 0.084 (0.082) loss_x loss_x 0.7056 (0.6878) acc_x 78.1250 (81.8750) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/30] time 0.158 (0.160) data 0.080 (0.082) loss_x loss_x 0.6426 (0.6987) acc_x 78.1250 (82.1875) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [15/30] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.8447 (0.6896) acc_x 75.0000 (82.7083) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/30] time 0.173 (0.162) data 0.095 (0.084) loss_x loss_x 0.5327 (0.6968) acc_x 84.3750 (82.5000) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [25/30] time 0.168 (0.163) data 0.091 (0.086) loss_x loss_x 0.4741 (0.6778) acc_x 87.5000 (82.7500) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [30/30] time 0.172 (0.164) data 0.096 (0.087) loss_x loss_x 1.0605 (0.6888) acc_x 75.0000 (82.1875) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.5996, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 969
clean true:968
clean false:1
clean_rate:0.9989680082559339
noisy true:137
noisy false:510
after delete: len(clean_dataset) 969
after delete: len(noisy_dataset) 647
epoch [87/200] batch [5/30] time 0.160 (0.175) data 0.083 (0.098) loss_x loss_x 0.6577 (0.7244) acc_x 81.2500 (76.8750) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [10/30] time 0.178 (0.175) data 0.100 (0.098) loss_x loss_x 0.7173 (0.6869) acc_x 84.3750 (80.0000) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [15/30] time 0.191 (0.178) data 0.113 (0.101) loss_x loss_x 0.4753 (0.6130) acc_x 93.7500 (83.5417) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/30] time 0.157 (0.175) data 0.080 (0.097) loss_x loss_x 0.6592 (0.6402) acc_x 81.2500 (83.2812) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [25/30] time 0.157 (0.171) data 0.081 (0.094) loss_x loss_x 0.4639 (0.6456) acc_x 87.5000 (82.8750) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [30/30] time 0.159 (0.169) data 0.081 (0.092) loss_x loss_x 1.0742 (0.6773) acc_x 71.8750 (82.7083) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 509
confident_label rate tensor(0.6002, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 970
clean true:968
clean false:2
clean_rate:0.9979381443298969
noisy true:139
noisy false:507
after delete: len(clean_dataset) 970
after delete: len(noisy_dataset) 646
epoch [88/200] batch [5/30] time 0.185 (0.181) data 0.107 (0.103) loss_x loss_x 0.6353 (0.6130) acc_x 90.6250 (86.2500) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/30] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.4666 (0.6561) acc_x 93.7500 (85.6250) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [15/30] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 1.4189 (0.7072) acc_x 75.0000 (84.3750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/30] time 0.172 (0.176) data 0.095 (0.098) loss_x loss_x 0.6182 (0.7194) acc_x 87.5000 (83.9062) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [25/30] time 0.175 (0.174) data 0.097 (0.097) loss_x loss_x 0.3684 (0.7050) acc_x 93.7500 (83.3750) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [30/30] time 0.172 (0.174) data 0.093 (0.096) loss_x loss_x 0.3635 (0.6700) acc_x 90.6250 (83.8542) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.5959, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 963
clean true:960
clean false:3
clean_rate:0.9968847352024922
noisy true:138
noisy false:515
after delete: len(clean_dataset) 963
after delete: len(noisy_dataset) 653
epoch [89/200] batch [5/30] time 0.179 (0.171) data 0.102 (0.094) loss_x loss_x 0.6011 (0.6179) acc_x 87.5000 (87.5000) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [10/30] time 0.162 (0.166) data 0.084 (0.089) loss_x loss_x 0.2336 (0.7131) acc_x 96.8750 (83.4375) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [15/30] time 0.162 (0.167) data 0.085 (0.089) loss_x loss_x 0.6167 (0.6941) acc_x 90.6250 (84.1667) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/30] time 0.186 (0.166) data 0.109 (0.089) loss_x loss_x 0.4983 (0.6821) acc_x 84.3750 (83.9062) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [25/30] time 0.191 (0.170) data 0.114 (0.093) loss_x loss_x 0.5293 (0.6801) acc_x 81.2500 (83.8750) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [30/30] time 0.192 (0.173) data 0.114 (0.096) loss_x loss_x 0.4250 (0.6982) acc_x 93.7500 (83.8542) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.6033, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 975
clean true:972
clean false:3
clean_rate:0.9969230769230769
noisy true:139
noisy false:502
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 641
epoch [90/200] batch [5/30] time 0.159 (0.160) data 0.082 (0.082) loss_x loss_x 0.3708 (0.5935) acc_x 87.5000 (82.5000) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/30] time 0.158 (0.169) data 0.081 (0.092) loss_x loss_x 0.4104 (0.6419) acc_x 87.5000 (81.5625) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [15/30] time 0.182 (0.174) data 0.105 (0.096) loss_x loss_x 0.4067 (0.6691) acc_x 90.6250 (82.7083) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [20/30] time 0.182 (0.178) data 0.104 (0.100) loss_x loss_x 0.8296 (0.6898) acc_x 78.1250 (81.8750) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [25/30] time 0.182 (0.179) data 0.104 (0.102) loss_x loss_x 0.8340 (0.6918) acc_x 78.1250 (81.3750) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [30/30] time 0.182 (0.180) data 0.105 (0.102) loss_x loss_x 0.9297 (0.6968) acc_x 75.0000 (81.3542) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.6120, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 989
clean true:986
clean false:3
clean_rate:0.9969666329625885
noisy true:146
noisy false:481
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 627
epoch [91/200] batch [5/30] time 0.183 (0.183) data 0.105 (0.106) loss_x loss_x 0.7910 (0.6928) acc_x 68.7500 (80.0000) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [10/30] time 0.166 (0.181) data 0.088 (0.104) loss_x loss_x 0.7378 (0.6743) acc_x 81.2500 (81.8750) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/30] time 0.160 (0.174) data 0.082 (0.096) loss_x loss_x 0.7417 (0.6626) acc_x 75.0000 (81.6667) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/30] time 0.159 (0.170) data 0.081 (0.093) loss_x loss_x 0.7070 (0.7031) acc_x 81.2500 (81.5625) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [25/30] time 0.160 (0.168) data 0.083 (0.090) loss_x loss_x 0.4763 (0.7079) acc_x 90.6250 (82.1250) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [30/30] time 0.180 (0.168) data 0.102 (0.090) loss_x loss_x 0.7788 (0.7137) acc_x 81.2500 (81.3542) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.6182, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 999
clean true:996
clean false:3
clean_rate:0.996996996996997
noisy true:134
noisy false:483
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 617
epoch [92/200] batch [5/31] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.9790 (0.8079) acc_x 78.1250 (76.2500) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [10/31] time 0.181 (0.183) data 0.103 (0.106) loss_x loss_x 0.7188 (0.6685) acc_x 81.2500 (80.3125) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [15/31] time 0.183 (0.181) data 0.105 (0.104) loss_x loss_x 0.4290 (0.6581) acc_x 84.3750 (80.8333) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/31] time 0.185 (0.182) data 0.107 (0.105) loss_x loss_x 0.8823 (0.6530) acc_x 75.0000 (81.4062) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/31] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.5703 (0.6234) acc_x 81.2500 (82.1250) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [30/31] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.9780 (0.6254) acc_x 71.8750 (82.3958) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.6126, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 990
clean true:987
clean false:3
clean_rate:0.996969696969697
noisy true:129
noisy false:497
after delete: len(clean_dataset) 990
after delete: len(noisy_dataset) 626
epoch [93/200] batch [5/30] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.7754 (0.6150) acc_x 78.1250 (83.7500) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [10/30] time 0.183 (0.186) data 0.106 (0.108) loss_x loss_x 0.5312 (0.6424) acc_x 81.2500 (82.1875) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [15/30] time 0.181 (0.186) data 0.103 (0.108) loss_x loss_x 0.4634 (0.6251) acc_x 84.3750 (82.2917) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/30] time 0.219 (0.188) data 0.141 (0.111) loss_x loss_x 0.7520 (0.6358) acc_x 78.1250 (82.3438) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [25/30] time 0.173 (0.184) data 0.096 (0.107) loss_x loss_x 0.3870 (0.6342) acc_x 90.6250 (82.3750) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [30/30] time 0.187 (0.185) data 0.110 (0.107) loss_x loss_x 1.0283 (0.6560) acc_x 78.1250 (81.8750) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.6170, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 997
clean true:994
clean false:3
clean_rate:0.9969909729187563
noisy true:140
noisy false:479
after delete: len(clean_dataset) 997
after delete: len(noisy_dataset) 619
epoch [94/200] batch [5/31] time 0.160 (0.166) data 0.083 (0.088) loss_x loss_x 0.3860 (0.7190) acc_x 87.5000 (78.1250) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [10/31] time 0.182 (0.167) data 0.104 (0.090) loss_x loss_x 0.8457 (0.7190) acc_x 78.1250 (79.0625) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [15/31] time 0.186 (0.173) data 0.108 (0.096) loss_x loss_x 0.7891 (0.6700) acc_x 84.3750 (81.6667) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/31] time 0.184 (0.176) data 0.106 (0.098) loss_x loss_x 1.0498 (0.6598) acc_x 68.7500 (81.5625) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [25/31] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.4285 (0.6650) acc_x 87.5000 (81.2500) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/31] time 0.187 (0.177) data 0.109 (0.100) loss_x loss_x 0.6045 (0.6844) acc_x 81.2500 (80.6250) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.6132, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 991
clean true:988
clean false:3
clean_rate:0.9969727547931383
noisy true:142
noisy false:483
after delete: len(clean_dataset) 991
after delete: len(noisy_dataset) 625
epoch [95/200] batch [5/30] time 0.194 (0.167) data 0.117 (0.090) loss_x loss_x 0.6655 (0.6196) acc_x 81.2500 (83.1250) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/30] time 0.185 (0.178) data 0.108 (0.100) loss_x loss_x 0.4844 (0.5904) acc_x 84.3750 (83.7500) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [15/30] time 0.181 (0.180) data 0.104 (0.102) loss_x loss_x 0.8218 (0.5972) acc_x 75.0000 (83.3333) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/30] time 0.177 (0.180) data 0.099 (0.103) loss_x loss_x 0.9419 (0.6794) acc_x 75.0000 (81.8750) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [25/30] time 0.182 (0.179) data 0.105 (0.101) loss_x loss_x 0.7598 (0.6799) acc_x 78.1250 (81.3750) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [30/30] time 0.190 (0.180) data 0.113 (0.103) loss_x loss_x 0.6147 (0.6733) acc_x 81.2500 (81.1458) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.6238, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1008
clean true:1005
clean false:3
clean_rate:0.9970238095238095
noisy true:129
noisy false:479
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 608
epoch [96/200] batch [5/31] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.5835 (0.7939) acc_x 84.3750 (77.5000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/31] time 0.185 (0.187) data 0.107 (0.110) loss_x loss_x 0.4587 (0.7294) acc_x 93.7500 (80.9375) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/31] time 0.188 (0.190) data 0.111 (0.112) loss_x loss_x 0.4260 (0.6903) acc_x 87.5000 (81.8750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/31] time 0.189 (0.188) data 0.112 (0.111) loss_x loss_x 0.8730 (0.6922) acc_x 84.3750 (82.3438) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/31] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.6699 (0.7185) acc_x 81.2500 (81.5000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/31] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.9722 (0.7137) acc_x 75.0000 (81.5625) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 467
confident_label rate tensor(0.6225, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1006
clean true:1001
clean false:5
clean_rate:0.9950298210735586
noisy true:148
noisy false:462
after delete: len(clean_dataset) 1006
after delete: len(noisy_dataset) 610
epoch [97/200] batch [5/31] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.9224 (0.8468) acc_x 78.1250 (78.1250) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [10/31] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.5708 (0.7727) acc_x 78.1250 (78.1250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [15/31] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.5425 (0.7117) acc_x 87.5000 (79.7917) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/31] time 0.188 (0.184) data 0.109 (0.106) loss_x loss_x 0.3896 (0.6718) acc_x 93.7500 (80.9375) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/31] time 0.185 (0.184) data 0.107 (0.106) loss_x loss_x 0.5693 (0.6586) acc_x 84.3750 (81.3750) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [30/31] time 0.183 (0.185) data 0.105 (0.107) loss_x loss_x 0.7241 (0.6526) acc_x 81.2500 (81.8750) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.6182, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 999
clean true:999
clean false:0
clean_rate:1.0
noisy true:137
noisy false:480
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 617
epoch [98/200] batch [5/31] time 0.188 (0.188) data 0.110 (0.110) loss_x loss_x 0.8496 (0.7084) acc_x 71.8750 (80.6250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [10/31] time 0.184 (0.188) data 0.107 (0.110) loss_x loss_x 0.5166 (0.7235) acc_x 87.5000 (81.2500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [15/31] time 0.185 (0.186) data 0.107 (0.109) loss_x loss_x 0.6431 (0.6734) acc_x 87.5000 (82.7083) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/31] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.3870 (0.6192) acc_x 93.7500 (83.4375) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/31] time 0.182 (0.185) data 0.104 (0.107) loss_x loss_x 1.0117 (0.6700) acc_x 59.3750 (82.5000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [30/31] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.2981 (0.6625) acc_x 90.6250 (82.7083) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.6151, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 994
clean true:989
clean false:5
clean_rate:0.9949698189134809
noisy true:145
noisy false:477
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 622
epoch [99/200] batch [5/31] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.4902 (0.6772) acc_x 84.3750 (80.6250) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/31] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.6714 (0.6274) acc_x 81.2500 (81.5625) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [15/31] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.5635 (0.6644) acc_x 87.5000 (81.8750) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/31] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8003 (0.6862) acc_x 75.0000 (81.2500) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/31] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.4949 (0.7027) acc_x 87.5000 (81.5000) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/31] time 0.179 (0.176) data 0.101 (0.099) loss_x loss_x 0.9019 (0.7240) acc_x 84.3750 (81.6667) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.6207, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1003
clean true:1000
clean false:3
clean_rate:0.9970089730807578
noisy true:140
noisy false:473
all clean rate:  [0.9932126696832579, 0.996219281663516, 0.9954476479514416, 0.9971988795518207, 0.9972144846796658, 0.9972602739726028, 0.9972183588317107, 0.9972067039106145, 0.9972826086956522, 0.9973226238286479, 0.9986962190352021, 0.9973226238286479, 1.0, 1.0, 0.9987163029525032, 0.9973890339425587, 1.0, 0.9987437185929648, 1.0, 0.9962358845671268, 0.9987063389391979, 1.0, 0.9987623762376238, 0.9963503649635036, 0.9975278121137207, 0.9987789987789988, 0.9975698663426489, 0.998805256869773, 0.9988249118683902, 1.0, 0.9976076555023924, 1.0, 1.0, 0.9988095238095238, 0.9976689976689976, 0.9976275207591934, 1.0, 0.9976798143851509, 0.9976717112922002, 0.9988452655889145, 0.998849252013809, 1.0, 0.9977298524404086, 1.0, 0.9988636363636364, 0.9988738738738738, 0.9977298524404086, 1.0, 0.9977298524404086, 0.994475138121547, 0.9988738738738738, 1.0, 0.9966329966329966, 0.9989059080962801, 0.9988998899889989, 0.9967105263157895, 1.0, 0.9978563772775991, 0.9989082969432315, 0.9957671957671957, 0.9978308026030369, 0.9989293361884368, 0.9978471474703983, 0.9977949283351709, 0.9978586723768736, 1.0, 0.9967105263157895, 0.996742671009772, 0.9978563772775991, 0.9968152866242038, 0.9978655282817502, 0.9968586387434555, 0.9989270386266095, 0.9968287526427061, 0.9978880675818373, 0.9958333333333333, 0.9969262295081968, 0.9979296066252588, 0.9948400412796697, 0.9946524064171123, 0.9989572471324296, 0.9959100204498977, 0.9979570990806946, 0.9979633401221996, 0.997948717948718, 0.9969574036511156, 0.9989680082559339, 0.9979381443298969, 0.9968847352024922, 0.9969230769230769, 0.9969666329625885, 0.996996996996997, 0.996969696969697, 0.9969909729187563, 0.9969727547931383, 0.9970238095238095, 0.9950298210735586, 1.0, 0.9949698189134809, 0.9970089730807578]
after delete: len(clean_dataset) 1003
after delete: len(noisy_dataset) 613
epoch [100/200] batch [5/31] time 0.200 (0.187) data 0.123 (0.110) loss_x loss_x 0.3853 (0.5324) acc_x 90.6250 (86.8750) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [10/31] time 0.194 (0.189) data 0.116 (0.112) loss_x loss_x 0.9282 (0.6389) acc_x 75.0000 (83.4375) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [15/31] time 0.188 (0.188) data 0.110 (0.111) loss_x loss_x 0.7837 (0.5921) acc_x 84.3750 (85.4167) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/31] time 0.183 (0.185) data 0.105 (0.108) loss_x loss_x 0.7266 (0.5973) acc_x 78.1250 (85.1562) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/31] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.8877 (0.6163) acc_x 71.8750 (84.1250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [30/31] time 0.160 (0.183) data 0.082 (0.106) loss_x loss_x 0.6704 (0.6327) acc_x 75.0000 (83.7500) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 465
confident_label rate tensor(0.6269, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1013
clean true:1009
clean false:4
clean_rate:0.9960513326752222
noisy true:142
noisy false:461
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 603
epoch [101/200] batch [5/31] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.3838 (0.5476) acc_x 90.6250 (86.2500) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/31] time 0.187 (0.184) data 0.109 (0.106) loss_x loss_x 0.7412 (0.5745) acc_x 87.5000 (86.5625) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [15/31] time 0.166 (0.184) data 0.088 (0.107) loss_x loss_x 0.6724 (0.5982) acc_x 78.1250 (85.4167) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/31] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.6860 (0.5966) acc_x 90.6250 (85.7812) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/31] time 0.194 (0.184) data 0.117 (0.106) loss_x loss_x 0.5347 (0.6192) acc_x 84.3750 (85.0000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [30/31] time 0.179 (0.184) data 0.102 (0.106) loss_x loss_x 0.4250 (0.6096) acc_x 90.6250 (84.8958) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.6256, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1011
clean true:1008
clean false:3
clean_rate:0.9970326409495549
noisy true:144
noisy false:461
after delete: len(clean_dataset) 1011
after delete: len(noisy_dataset) 605
epoch [102/200] batch [5/31] time 0.184 (0.167) data 0.106 (0.089) loss_x loss_x 0.5698 (0.6729) acc_x 87.5000 (83.1250) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/31] time 0.186 (0.171) data 0.109 (0.094) loss_x loss_x 0.3904 (0.6288) acc_x 90.6250 (83.7500) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [15/31] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.4465 (0.6799) acc_x 90.6250 (83.7500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/31] time 0.187 (0.177) data 0.110 (0.100) loss_x loss_x 0.7256 (0.6761) acc_x 78.1250 (82.5000) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [25/31] time 0.183 (0.179) data 0.106 (0.101) loss_x loss_x 0.5190 (0.6792) acc_x 84.3750 (82.2500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [30/31] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.6646 (0.6884) acc_x 84.3750 (81.7708) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 446
confident_label rate tensor(0.6361, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1028
clean true:1025
clean false:3
clean_rate:0.9970817120622568
noisy true:145
noisy false:443
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 588
epoch [103/200] batch [5/32] time 0.195 (0.186) data 0.117 (0.109) loss_x loss_x 0.6577 (0.7589) acc_x 84.3750 (80.0000) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/32] time 0.217 (0.185) data 0.140 (0.108) loss_x loss_x 0.6924 (0.7163) acc_x 75.0000 (80.3125) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/32] time 0.176 (0.184) data 0.098 (0.106) loss_x loss_x 0.6401 (0.7161) acc_x 84.3750 (79.7917) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/32] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 1.1240 (0.7278) acc_x 68.7500 (80.1562) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/32] time 0.162 (0.185) data 0.085 (0.108) loss_x loss_x 0.4939 (0.7012) acc_x 87.5000 (80.7500) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [30/32] time 0.159 (0.182) data 0.082 (0.105) loss_x loss_x 0.7866 (0.6793) acc_x 81.2500 (81.1458) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 449
confident_label rate tensor(0.6399, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1034
clean true:1031
clean false:3
clean_rate:0.9970986460348162
noisy true:136
noisy false:446
after delete: len(clean_dataset) 1034
after delete: len(noisy_dataset) 582
epoch [104/200] batch [5/32] time 0.185 (0.165) data 0.107 (0.088) loss_x loss_x 0.7295 (0.7834) acc_x 87.5000 (82.5000) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/32] time 0.207 (0.180) data 0.129 (0.103) loss_x loss_x 0.4492 (0.6897) acc_x 90.6250 (84.3750) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [15/32] time 0.184 (0.181) data 0.106 (0.103) loss_x loss_x 0.7847 (0.7091) acc_x 71.8750 (82.0833) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/32] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 0.7490 (0.7044) acc_x 75.0000 (82.0312) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/32] time 0.177 (0.178) data 0.099 (0.100) loss_x loss_x 0.5459 (0.6756) acc_x 84.3750 (82.8750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/32] time 0.182 (0.177) data 0.104 (0.100) loss_x loss_x 0.5205 (0.6464) acc_x 84.3750 (83.5417) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 462
confident_label rate tensor(0.6262, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1012
clean true:1011
clean false:1
clean_rate:0.9990118577075099
noisy true:143
noisy false:461
after delete: len(clean_dataset) 1012
after delete: len(noisy_dataset) 604
epoch [105/200] batch [5/31] time 0.182 (0.184) data 0.104 (0.106) loss_x loss_x 0.8691 (0.6604) acc_x 78.1250 (80.0000) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/31] time 0.160 (0.177) data 0.082 (0.099) loss_x loss_x 0.5674 (0.6479) acc_x 81.2500 (80.9375) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [15/31] time 0.184 (0.178) data 0.107 (0.100) loss_x loss_x 0.4917 (0.6521) acc_x 87.5000 (81.4583) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/31] time 0.173 (0.179) data 0.096 (0.101) loss_x loss_x 0.9214 (0.6827) acc_x 71.8750 (81.0938) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [25/31] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.6445 (0.7115) acc_x 84.3750 (80.8750) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [30/31] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.5303 (0.6812) acc_x 90.6250 (81.8750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 444
confident_label rate tensor(0.6374, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1030
clean true:1027
clean false:3
clean_rate:0.9970873786407767
noisy true:145
noisy false:441
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 586
epoch [106/200] batch [5/32] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 0.5054 (0.6079) acc_x 87.5000 (83.1250) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [10/32] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 0.6099 (0.7045) acc_x 87.5000 (83.1250) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/32] time 0.161 (0.177) data 0.084 (0.099) loss_x loss_x 0.7607 (0.7306) acc_x 84.3750 (82.2917) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/32] time 0.161 (0.173) data 0.084 (0.095) loss_x loss_x 0.7124 (0.7232) acc_x 81.2500 (82.0312) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/32] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.5830 (0.7323) acc_x 87.5000 (81.2500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/32] time 0.179 (0.169) data 0.102 (0.092) loss_x loss_x 0.8262 (0.7388) acc_x 78.1250 (81.2500) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.6176, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 998
clean true:998
clean false:0
clean_rate:1.0
noisy true:142
noisy false:476
after delete: len(clean_dataset) 998
after delete: len(noisy_dataset) 618
epoch [107/200] batch [5/31] time 0.179 (0.181) data 0.101 (0.103) loss_x loss_x 0.4736 (0.8055) acc_x 90.6250 (81.2500) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [10/31] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.3381 (0.7487) acc_x 96.8750 (82.5000) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [15/31] time 0.183 (0.177) data 0.105 (0.099) loss_x loss_x 0.6035 (0.7577) acc_x 84.3750 (82.0833) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/31] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.7227 (0.7428) acc_x 84.3750 (81.5625) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [25/31] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.5132 (0.7301) acc_x 87.5000 (81.7500) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/31] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 0.6284 (0.7101) acc_x 78.1250 (81.6667) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 460
confident_label rate tensor(0.6281, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1015
clean true:1012
clean false:3
clean_rate:0.9970443349753695
noisy true:144
noisy false:457
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 601
epoch [108/200] batch [5/31] time 0.177 (0.171) data 0.099 (0.093) loss_x loss_x 0.3787 (0.5828) acc_x 87.5000 (83.7500) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [10/31] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.5122 (0.6478) acc_x 87.5000 (80.3125) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/31] time 0.184 (0.179) data 0.108 (0.101) loss_x loss_x 0.7808 (0.6934) acc_x 78.1250 (79.7917) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/31] time 0.162 (0.179) data 0.085 (0.102) loss_x loss_x 0.7964 (0.7056) acc_x 71.8750 (80.1562) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [25/31] time 0.191 (0.178) data 0.114 (0.101) loss_x loss_x 0.7490 (0.6925) acc_x 84.3750 (80.6250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [30/31] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.2839 (0.6408) acc_x 96.8750 (82.2917) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.6275, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1014
clean true:1011
clean false:3
clean_rate:0.9970414201183432
noisy true:133
noisy false:469
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 602
epoch [109/200] batch [5/31] time 0.181 (0.184) data 0.103 (0.107) loss_x loss_x 0.5259 (0.5420) acc_x 84.3750 (85.6250) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [10/31] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 1.0195 (0.7093) acc_x 71.8750 (79.3750) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [15/31] time 0.183 (0.187) data 0.106 (0.109) loss_x loss_x 0.5957 (0.7307) acc_x 84.3750 (80.4167) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [20/31] time 0.214 (0.187) data 0.137 (0.110) loss_x loss_x 1.0293 (0.7341) acc_x 75.0000 (80.6250) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/31] time 0.181 (0.187) data 0.104 (0.110) loss_x loss_x 0.9556 (0.7320) acc_x 71.8750 (80.8750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [30/31] time 0.186 (0.189) data 0.109 (0.112) loss_x loss_x 0.5991 (0.6984) acc_x 81.2500 (81.5625) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.6293, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1017
clean true:1012
clean false:5
clean_rate:0.9950835791543756
noisy true:132
noisy false:467
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 599
epoch [110/200] batch [5/31] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.6528 (0.7207) acc_x 81.2500 (83.1250) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/31] time 0.208 (0.182) data 0.131 (0.104) loss_x loss_x 0.5146 (0.6515) acc_x 84.3750 (84.6875) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [15/31] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.4875 (0.6902) acc_x 87.5000 (83.9583) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [20/31] time 0.179 (0.178) data 0.101 (0.101) loss_x loss_x 0.5898 (0.7037) acc_x 87.5000 (82.3438) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [25/31] time 0.183 (0.177) data 0.105 (0.100) loss_x loss_x 0.4878 (0.6955) acc_x 81.2500 (82.2500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/31] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.3911 (0.6749) acc_x 81.2500 (82.5000) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.6337, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1024
clean true:1021
clean false:3
clean_rate:0.9970703125
noisy true:142
noisy false:450
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 592
epoch [111/200] batch [5/32] time 0.171 (0.183) data 0.094 (0.105) loss_x loss_x 0.6904 (0.6675) acc_x 81.2500 (83.7500) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/32] time 0.162 (0.179) data 0.084 (0.101) loss_x loss_x 1.0635 (0.7014) acc_x 71.8750 (81.5625) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [15/32] time 0.175 (0.175) data 0.099 (0.097) loss_x loss_x 1.0498 (0.7200) acc_x 78.1250 (81.4583) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [20/32] time 0.189 (0.175) data 0.112 (0.098) loss_x loss_x 0.6533 (0.6968) acc_x 75.0000 (82.1875) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/32] time 0.181 (0.176) data 0.104 (0.098) loss_x loss_x 0.4570 (0.6654) acc_x 90.6250 (83.1250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [30/32] time 0.179 (0.177) data 0.101 (0.100) loss_x loss_x 0.8999 (0.6644) acc_x 75.0000 (82.9167) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.6244, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1009
clean true:1006
clean false:3
clean_rate:0.9970267591674926
noisy true:138
noisy false:469
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 607
epoch [112/200] batch [5/31] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6509 (0.6105) acc_x 81.2500 (83.1250) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/31] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5098 (0.6229) acc_x 87.5000 (82.8125) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [15/31] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.3445 (0.5501) acc_x 90.6250 (85.2083) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [20/31] time 0.175 (0.183) data 0.098 (0.106) loss_x loss_x 0.4421 (0.5674) acc_x 87.5000 (85.4688) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/31] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.4231 (0.5912) acc_x 84.3750 (84.5000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/31] time 0.160 (0.180) data 0.083 (0.102) loss_x loss_x 0.6152 (0.6055) acc_x 87.5000 (84.2708) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 470
confident_label rate tensor(0.6256, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1011
clean true:1010
clean false:1
clean_rate:0.9990108803165183
noisy true:136
noisy false:469
after delete: len(clean_dataset) 1011
after delete: len(noisy_dataset) 605
epoch [113/200] batch [5/31] time 0.162 (0.169) data 0.085 (0.092) loss_x loss_x 1.0107 (0.6869) acc_x 78.1250 (82.5000) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/31] time 0.175 (0.170) data 0.098 (0.092) loss_x loss_x 0.3813 (0.6001) acc_x 87.5000 (85.3125) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [15/31] time 0.180 (0.173) data 0.102 (0.096) loss_x loss_x 0.9458 (0.6484) acc_x 65.6250 (83.5417) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/31] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.8911 (0.6408) acc_x 81.2500 (83.7500) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [25/31] time 0.174 (0.175) data 0.096 (0.098) loss_x loss_x 0.6841 (0.6465) acc_x 84.3750 (84.0000) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [30/31] time 0.175 (0.175) data 0.097 (0.098) loss_x loss_x 0.5684 (0.6447) acc_x 87.5000 (83.8542) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.6238, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1008
clean true:1003
clean false:5
clean_rate:0.9950396825396826
noisy true:137
noisy false:471
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 608
epoch [114/200] batch [5/31] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.7407 (0.6949) acc_x 87.5000 (83.7500) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/31] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.7134 (0.7231) acc_x 75.0000 (81.5625) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [15/31] time 0.192 (0.185) data 0.115 (0.107) loss_x loss_x 1.0752 (0.6895) acc_x 75.0000 (82.2917) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/31] time 0.184 (0.182) data 0.107 (0.104) loss_x loss_x 0.4482 (0.6574) acc_x 87.5000 (83.7500) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [25/31] time 0.183 (0.182) data 0.106 (0.104) loss_x loss_x 0.4058 (0.6438) acc_x 90.6250 (83.6250) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [30/31] time 0.157 (0.179) data 0.080 (0.102) loss_x loss_x 0.7837 (0.6371) acc_x 84.3750 (83.9583) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.6337, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1024
clean true:1020
clean false:4
clean_rate:0.99609375
noisy true:143
noisy false:449
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 592
epoch [115/200] batch [5/32] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.8369 (0.6314) acc_x 78.1250 (81.8750) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/32] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.9795 (0.7334) acc_x 84.3750 (81.2500) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/32] time 0.185 (0.189) data 0.108 (0.112) loss_x loss_x 0.3638 (0.6963) acc_x 90.6250 (82.5000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/32] time 0.180 (0.187) data 0.103 (0.110) loss_x loss_x 1.2021 (0.7154) acc_x 68.7500 (82.3438) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/32] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.3796 (0.6830) acc_x 90.6250 (82.8750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/32] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.7827 (0.6716) acc_x 78.1250 (82.8125) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.6182, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 999
clean true:996
clean false:3
clean_rate:0.996996996996997
noisy true:144
noisy false:473
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 617
epoch [116/200] batch [5/31] time 0.186 (0.188) data 0.109 (0.110) loss_x loss_x 0.4104 (0.5747) acc_x 90.6250 (85.6250) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [10/31] time 0.204 (0.188) data 0.127 (0.111) loss_x loss_x 0.8706 (0.5677) acc_x 75.0000 (84.6875) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [15/31] time 0.182 (0.186) data 0.105 (0.108) loss_x loss_x 0.7666 (0.6024) acc_x 78.1250 (84.5833) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/31] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 0.4016 (0.5782) acc_x 90.6250 (84.2188) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/31] time 0.180 (0.185) data 0.103 (0.108) loss_x loss_x 1.0225 (0.5861) acc_x 75.0000 (84.2500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [30/31] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 1.0420 (0.6145) acc_x 78.1250 (83.8542) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 475
confident_label rate tensor(0.6244, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1009
clean true:1008
clean false:1
clean_rate:0.9990089197224975
noisy true:133
noisy false:474
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 607
epoch [117/200] batch [5/31] time 0.185 (0.189) data 0.108 (0.112) loss_x loss_x 1.0898 (0.7458) acc_x 62.5000 (77.5000) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [10/31] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 1.0713 (0.7773) acc_x 75.0000 (78.4375) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [15/31] time 0.185 (0.179) data 0.107 (0.102) loss_x loss_x 0.3293 (0.6838) acc_x 96.8750 (81.8750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/31] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 0.3428 (0.6465) acc_x 93.7500 (83.1250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [25/31] time 0.185 (0.178) data 0.107 (0.101) loss_x loss_x 0.9312 (0.6703) acc_x 75.0000 (82.6250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [30/31] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.5347 (0.6766) acc_x 84.3750 (82.5000) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 483
confident_label rate tensor(0.6194, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1001
clean true:997
clean false:4
clean_rate:0.996003996003996
noisy true:136
noisy false:479
after delete: len(clean_dataset) 1001
after delete: len(noisy_dataset) 615
epoch [118/200] batch [5/31] time 0.173 (0.172) data 0.096 (0.095) loss_x loss_x 0.9893 (0.7796) acc_x 75.0000 (78.1250) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/31] time 0.175 (0.176) data 0.097 (0.099) loss_x loss_x 0.5620 (0.7431) acc_x 81.2500 (79.3750) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [15/31] time 0.186 (0.178) data 0.108 (0.101) loss_x loss_x 0.9150 (0.7211) acc_x 75.0000 (80.4167) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/31] time 0.169 (0.180) data 0.092 (0.103) loss_x loss_x 0.5088 (0.6583) acc_x 90.6250 (82.1875) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [25/31] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.0885 (0.6329) acc_x 100.0000 (83.1250) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [30/31] time 0.186 (0.180) data 0.108 (0.103) loss_x loss_x 0.5410 (0.6594) acc_x 78.1250 (83.0208) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 466
confident_label rate tensor(0.6269, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1013
clean true:1011
clean false:2
clean_rate:0.998025666337611
noisy true:139
noisy false:464
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 603
epoch [119/200] batch [5/31] time 0.162 (0.163) data 0.084 (0.086) loss_x loss_x 0.5732 (0.4566) acc_x 87.5000 (88.7500) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/31] time 0.163 (0.163) data 0.086 (0.086) loss_x loss_x 0.3013 (0.5392) acc_x 93.7500 (87.1875) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [15/31] time 0.162 (0.163) data 0.085 (0.086) loss_x loss_x 0.8364 (0.5884) acc_x 84.3750 (86.0417) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [20/31] time 0.161 (0.163) data 0.084 (0.085) loss_x loss_x 0.3320 (0.5704) acc_x 93.7500 (86.0938) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [25/31] time 0.198 (0.167) data 0.121 (0.090) loss_x loss_x 0.4690 (0.5612) acc_x 93.7500 (86.8750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [30/31] time 0.184 (0.171) data 0.106 (0.093) loss_x loss_x 0.4116 (0.5679) acc_x 87.5000 (86.3542) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 447
confident_label rate tensor(0.6392, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1033
clean true:1029
clean false:4
clean_rate:0.9961277831558567
noisy true:140
noisy false:443
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 583
epoch [120/200] batch [5/32] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.4451 (0.4952) acc_x 87.5000 (86.8750) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/32] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.6870 (0.5990) acc_x 81.2500 (85.3125) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/32] time 0.181 (0.184) data 0.104 (0.106) loss_x loss_x 0.9048 (0.7259) acc_x 68.7500 (82.5000) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/32] time 0.182 (0.184) data 0.105 (0.106) loss_x loss_x 0.5044 (0.7128) acc_x 81.2500 (82.0312) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/32] time 0.185 (0.184) data 0.107 (0.106) loss_x loss_x 0.6826 (0.6883) acc_x 87.5000 (82.3750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [30/32] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.6416 (0.6878) acc_x 81.2500 (82.2917) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 454
confident_label rate tensor(0.6300, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1018
clean true:1015
clean false:3
clean_rate:0.9970530451866405
noisy true:147
noisy false:451
after delete: len(clean_dataset) 1018
after delete: len(noisy_dataset) 598
epoch [121/200] batch [5/31] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.4150 (0.6117) acc_x 87.5000 (83.1250) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/31] time 0.182 (0.184) data 0.104 (0.106) loss_x loss_x 1.2334 (0.7318) acc_x 68.7500 (81.5625) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [15/31] time 0.188 (0.185) data 0.110 (0.107) loss_x loss_x 0.5181 (0.6241) acc_x 87.5000 (84.5833) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/31] time 0.185 (0.186) data 0.107 (0.108) loss_x loss_x 0.8760 (0.6436) acc_x 78.1250 (84.8438) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/31] time 0.168 (0.183) data 0.090 (0.106) loss_x loss_x 0.5400 (0.6250) acc_x 84.3750 (84.6250) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/31] time 0.180 (0.181) data 0.102 (0.103) loss_x loss_x 0.6113 (0.6367) acc_x 90.6250 (84.2708) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 428
confident_label rate tensor(0.6460, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1044
clean true:1041
clean false:3
clean_rate:0.9971264367816092
noisy true:147
noisy false:425
after delete: len(clean_dataset) 1044
after delete: len(noisy_dataset) 572
epoch [122/200] batch [5/32] time 0.160 (0.174) data 0.083 (0.096) loss_x loss_x 0.5415 (0.7754) acc_x 87.5000 (79.3750) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/32] time 0.164 (0.174) data 0.086 (0.096) loss_x loss_x 0.8872 (0.7421) acc_x 78.1250 (80.0000) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/32] time 0.183 (0.177) data 0.106 (0.099) loss_x loss_x 0.6514 (0.7500) acc_x 87.5000 (80.6250) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/32] time 0.184 (0.178) data 0.106 (0.101) loss_x loss_x 0.4080 (0.7573) acc_x 87.5000 (80.4688) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/32] time 0.183 (0.179) data 0.105 (0.102) loss_x loss_x 0.8018 (0.7218) acc_x 78.1250 (81.1250) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [30/32] time 0.183 (0.180) data 0.106 (0.102) loss_x loss_x 0.5513 (0.7206) acc_x 81.2500 (80.9375) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.6454, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1043
clean true:1038
clean false:5
clean_rate:0.9952061361457335
noisy true:137
noisy false:436
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 573
epoch [123/200] batch [5/32] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.9092 (0.6962) acc_x 75.0000 (81.8750) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/32] time 0.173 (0.171) data 0.096 (0.094) loss_x loss_x 0.7397 (0.6766) acc_x 84.3750 (82.1875) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/32] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.7158 (0.6372) acc_x 81.2500 (82.7083) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/32] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.5962 (0.6302) acc_x 75.0000 (82.9688) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/32] time 0.160 (0.172) data 0.082 (0.095) loss_x loss_x 0.9033 (0.6693) acc_x 75.0000 (82.5000) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/32] time 0.184 (0.171) data 0.107 (0.094) loss_x loss_x 0.7402 (0.6651) acc_x 75.0000 (82.5000) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 434
confident_label rate tensor(0.6485, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1048
clean true:1047
clean false:1
clean_rate:0.9990458015267175
noisy true:135
noisy false:433
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 568
epoch [124/200] batch [5/32] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.3782 (0.5351) acc_x 90.6250 (85.6250) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/32] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.5215 (0.6241) acc_x 87.5000 (83.7500) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/32] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.4746 (0.6171) acc_x 87.5000 (84.1667) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/32] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.8325 (0.6437) acc_x 81.2500 (82.9688) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/32] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.8594 (0.6115) acc_x 81.2500 (84.2500) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [30/32] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.9292 (0.6372) acc_x 71.8750 (83.1250) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 433
confident_label rate tensor(0.6448, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1042
clean true:1039
clean false:3
clean_rate:0.9971209213051824
noisy true:144
noisy false:430
after delete: len(clean_dataset) 1042
after delete: len(noisy_dataset) 574
epoch [125/200] batch [5/32] time 0.173 (0.164) data 0.096 (0.086) loss_x loss_x 0.3303 (0.6461) acc_x 84.3750 (78.1250) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/32] time 0.189 (0.176) data 0.111 (0.098) loss_x loss_x 0.4832 (0.6053) acc_x 84.3750 (81.5625) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [15/32] time 0.167 (0.178) data 0.090 (0.101) loss_x loss_x 0.9971 (0.6119) acc_x 71.8750 (81.6667) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/32] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.7407 (0.6348) acc_x 75.0000 (81.0938) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/32] time 0.182 (0.177) data 0.105 (0.099) loss_x loss_x 0.6919 (0.6921) acc_x 78.1250 (79.8750) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [30/32] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.7549 (0.6773) acc_x 81.2500 (80.5208) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 460
confident_label rate tensor(0.6281, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1015
clean true:1012
clean false:3
clean_rate:0.9970443349753695
noisy true:144
noisy false:457
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 601
epoch [126/200] batch [5/31] time 0.190 (0.167) data 0.112 (0.090) loss_x loss_x 0.8091 (0.6324) acc_x 81.2500 (84.3750) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/31] time 0.175 (0.174) data 0.098 (0.097) loss_x loss_x 0.8110 (0.7016) acc_x 81.2500 (83.1250) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [15/31] time 0.185 (0.175) data 0.107 (0.098) loss_x loss_x 0.6899 (0.6896) acc_x 81.2500 (82.7083) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/31] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.6729 (0.6832) acc_x 81.2500 (82.6562) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [25/31] time 0.183 (0.179) data 0.105 (0.101) loss_x loss_x 0.9561 (0.6732) acc_x 84.3750 (83.2500) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [30/31] time 0.183 (0.180) data 0.106 (0.102) loss_x loss_x 0.9712 (0.6708) acc_x 78.1250 (83.4375) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.6442, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1041
clean true:1036
clean false:5
clean_rate:0.9951969260326609
noisy true:139
noisy false:436
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 575
epoch [127/200] batch [5/32] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 1.1436 (0.6780) acc_x 78.1250 (83.7500) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/32] time 0.162 (0.167) data 0.084 (0.090) loss_x loss_x 0.7012 (0.6549) acc_x 84.3750 (83.7500) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [15/32] time 0.223 (0.170) data 0.145 (0.093) loss_x loss_x 0.3787 (0.6732) acc_x 90.6250 (83.5417) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/32] time 0.185 (0.174) data 0.107 (0.097) loss_x loss_x 0.4668 (0.6532) acc_x 90.6250 (83.1250) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/32] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.8892 (0.6567) acc_x 78.1250 (83.5000) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [30/32] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.5991 (0.6667) acc_x 84.3750 (82.8125) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.6176, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 998
clean true:998
clean false:0
clean_rate:1.0
noisy true:146
noisy false:472
after delete: len(clean_dataset) 998
after delete: len(noisy_dataset) 618
epoch [128/200] batch [5/31] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 0.5508 (0.6710) acc_x 90.6250 (83.1250) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/31] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4282 (0.6321) acc_x 90.6250 (85.0000) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [15/31] time 0.159 (0.176) data 0.081 (0.099) loss_x loss_x 0.4438 (0.5634) acc_x 93.7500 (86.0417) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/31] time 0.182 (0.177) data 0.104 (0.099) loss_x loss_x 0.8901 (0.5615) acc_x 75.0000 (85.3125) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [25/31] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.8027 (0.5802) acc_x 78.1250 (84.7500) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/31] time 0.177 (0.178) data 0.099 (0.100) loss_x loss_x 1.1826 (0.6019) acc_x 75.0000 (84.7917) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 429
confident_label rate tensor(0.6491, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1049
clean true:1047
clean false:2
clean_rate:0.998093422306959
noisy true:140
noisy false:427
after delete: len(clean_dataset) 1049
after delete: len(noisy_dataset) 567
epoch [129/200] batch [5/32] time 0.187 (0.185) data 0.109 (0.108) loss_x loss_x 0.4907 (0.5261) acc_x 84.3750 (85.6250) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [10/32] time 0.187 (0.186) data 0.110 (0.108) loss_x loss_x 0.3655 (0.4949) acc_x 90.6250 (86.8750) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/32] time 0.192 (0.185) data 0.115 (0.108) loss_x loss_x 0.6372 (0.5240) acc_x 84.3750 (86.0417) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/32] time 0.173 (0.184) data 0.096 (0.107) loss_x loss_x 0.4629 (0.5431) acc_x 84.3750 (85.4688) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/32] time 0.159 (0.181) data 0.081 (0.104) loss_x loss_x 0.8584 (0.5673) acc_x 75.0000 (85.7500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/32] time 0.185 (0.178) data 0.107 (0.101) loss_x loss_x 0.4285 (0.5778) acc_x 84.3750 (85.1042) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 419
confident_label rate tensor(0.6535, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1056
clean true:1053
clean false:3
clean_rate:0.9971590909090909
noisy true:144
noisy false:416
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 560
epoch [130/200] batch [5/33] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.9111 (0.7398) acc_x 78.1250 (80.0000) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [10/33] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.7954 (0.6704) acc_x 78.1250 (81.5625) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/33] time 0.171 (0.180) data 0.094 (0.102) loss_x loss_x 0.3633 (0.6910) acc_x 96.8750 (82.5000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/33] time 0.178 (0.176) data 0.100 (0.099) loss_x loss_x 0.8066 (0.6495) acc_x 71.8750 (83.4375) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/33] time 0.171 (0.175) data 0.093 (0.097) loss_x loss_x 0.9067 (0.6820) acc_x 78.1250 (82.6250) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/33] time 0.184 (0.176) data 0.106 (0.099) loss_x loss_x 0.6553 (0.6602) acc_x 81.2500 (83.3333) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 468
confident_label rate tensor(0.6269, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1013
clean true:1011
clean false:2
clean_rate:0.998025666337611
noisy true:137
noisy false:466
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 603
epoch [131/200] batch [5/31] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.7051 (0.5255) acc_x 78.1250 (84.3750) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/31] time 0.158 (0.179) data 0.080 (0.102) loss_x loss_x 0.5132 (0.6336) acc_x 84.3750 (82.8125) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [15/31] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.8848 (0.6239) acc_x 81.2500 (82.7083) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/31] time 0.181 (0.180) data 0.103 (0.103) loss_x loss_x 1.0742 (0.6370) acc_x 84.3750 (83.2812) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [25/31] time 0.184 (0.181) data 0.107 (0.103) loss_x loss_x 0.4524 (0.6217) acc_x 87.5000 (83.6250) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/31] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.3845 (0.6352) acc_x 90.6250 (83.6458) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 450
confident_label rate tensor(0.6337, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1024
clean true:1021
clean false:3
clean_rate:0.9970703125
noisy true:145
noisy false:447
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 592
epoch [132/200] batch [5/32] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 1.1133 (0.7260) acc_x 71.8750 (80.6250) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/32] time 0.187 (0.184) data 0.110 (0.106) loss_x loss_x 0.2551 (0.6395) acc_x 96.8750 (83.4375) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/32] time 0.189 (0.184) data 0.111 (0.107) loss_x loss_x 0.6646 (0.6534) acc_x 84.3750 (83.1250) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/32] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.6299 (0.6502) acc_x 87.5000 (83.2812) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/32] time 0.181 (0.185) data 0.104 (0.107) loss_x loss_x 0.6270 (0.6307) acc_x 81.2500 (84.0000) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [30/32] time 0.160 (0.183) data 0.082 (0.106) loss_x loss_x 1.0391 (0.6256) acc_x 71.8750 (84.2708) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 479
confident_label rate tensor(0.6188, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1000
clean true:998
clean false:2
clean_rate:0.998
noisy true:139
noisy false:477
after delete: len(clean_dataset) 1000
after delete: len(noisy_dataset) 616
epoch [133/200] batch [5/31] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.4172 (0.5129) acc_x 93.7500 (87.5000) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/31] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.4629 (0.5426) acc_x 90.6250 (86.8750) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [15/31] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.5981 (0.5352) acc_x 81.2500 (86.4583) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/31] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.4082 (0.5052) acc_x 87.5000 (86.8750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/31] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.4104 (0.5206) acc_x 90.6250 (86.1250) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [30/31] time 0.186 (0.183) data 0.109 (0.105) loss_x loss_x 0.8096 (0.5337) acc_x 81.2500 (85.9375) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.6250, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1010
clean true:1009
clean false:1
clean_rate:0.999009900990099
noisy true:135
noisy false:471
after delete: len(clean_dataset) 1010
after delete: len(noisy_dataset) 606
epoch [134/200] batch [5/31] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 0.4224 (0.5381) acc_x 90.6250 (86.8750) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/31] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.3940 (0.5387) acc_x 87.5000 (85.9375) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [15/31] time 0.181 (0.183) data 0.103 (0.106) loss_x loss_x 0.6704 (0.5632) acc_x 81.2500 (83.9583) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/31] time 0.160 (0.181) data 0.083 (0.104) loss_x loss_x 0.8271 (0.5587) acc_x 78.1250 (84.3750) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [25/31] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.2644 (0.5608) acc_x 90.6250 (84.6250) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/31] time 0.182 (0.182) data 0.105 (0.104) loss_x loss_x 0.7886 (0.6077) acc_x 75.0000 (83.4375) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 448
confident_label rate tensor(0.6374, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1030
clean true:1028
clean false:2
clean_rate:0.9980582524271845
noisy true:140
noisy false:446
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 586
epoch [135/200] batch [5/32] time 0.179 (0.163) data 0.101 (0.086) loss_x loss_x 0.6602 (0.5931) acc_x 84.3750 (83.1250) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/32] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 0.5986 (0.6493) acc_x 84.3750 (83.1250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [15/32] time 0.184 (0.175) data 0.106 (0.098) loss_x loss_x 0.5166 (0.6605) acc_x 90.6250 (83.7500) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/32] time 0.182 (0.177) data 0.104 (0.100) loss_x loss_x 0.1577 (0.6336) acc_x 96.8750 (84.2188) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/32] time 0.182 (0.178) data 0.106 (0.101) loss_x loss_x 0.6270 (0.6508) acc_x 84.3750 (83.3750) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/32] time 0.184 (0.179) data 0.107 (0.101) loss_x loss_x 0.9116 (0.6471) acc_x 81.2500 (83.6458) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 456
confident_label rate tensor(0.6324, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1022
clean true:1017
clean false:5
clean_rate:0.9951076320939335
noisy true:143
noisy false:451
after delete: len(clean_dataset) 1022
after delete: len(noisy_dataset) 594
epoch [136/200] batch [5/31] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.3970 (0.7587) acc_x 90.6250 (80.0000) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/31] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.6240 (0.6840) acc_x 81.2500 (80.9375) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/31] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.7612 (0.6787) acc_x 81.2500 (81.8750) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/31] time 0.185 (0.183) data 0.109 (0.106) loss_x loss_x 0.6055 (0.7045) acc_x 81.2500 (81.2500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/31] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.7256 (0.6937) acc_x 87.5000 (82.0000) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [30/31] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.5039 (0.6851) acc_x 90.6250 (82.0833) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.6405, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1035
clean true:1032
clean false:3
clean_rate:0.9971014492753624
noisy true:143
noisy false:438
after delete: len(clean_dataset) 1035
after delete: len(noisy_dataset) 581
epoch [137/200] batch [5/32] time 0.178 (0.186) data 0.101 (0.108) loss_x loss_x 0.4685 (0.5637) acc_x 90.6250 (84.3750) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/32] time 0.180 (0.184) data 0.102 (0.106) loss_x loss_x 0.5361 (0.5476) acc_x 87.5000 (85.3125) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/32] time 0.187 (0.181) data 0.110 (0.104) loss_x loss_x 0.4822 (0.5591) acc_x 87.5000 (84.7917) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/32] time 0.227 (0.186) data 0.150 (0.109) loss_x loss_x 0.4636 (0.5518) acc_x 87.5000 (85.1562) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/32] time 0.182 (0.186) data 0.105 (0.108) loss_x loss_x 0.9111 (0.5649) acc_x 81.2500 (85.7500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/32] time 0.174 (0.185) data 0.097 (0.108) loss_x loss_x 0.2722 (0.5542) acc_x 93.7500 (86.0417) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 437
confident_label rate tensor(0.6411, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1036
clean true:1035
clean false:1
clean_rate:0.999034749034749
noisy true:144
noisy false:436
after delete: len(clean_dataset) 1036
after delete: len(noisy_dataset) 580
epoch [138/200] batch [5/32] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8398 (0.5667) acc_x 75.0000 (84.3750) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/32] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4155 (0.5834) acc_x 87.5000 (84.6875) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/32] time 0.161 (0.182) data 0.084 (0.105) loss_x loss_x 0.3853 (0.5747) acc_x 78.1250 (84.3750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/32] time 0.181 (0.181) data 0.103 (0.104) loss_x loss_x 0.7876 (0.5823) acc_x 84.3750 (85.0000) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/32] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.3992 (0.5688) acc_x 93.7500 (85.1250) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/32] time 0.183 (0.182) data 0.105 (0.104) loss_x loss_x 0.7744 (0.5627) acc_x 81.2500 (85.4167) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.6541, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1057
clean true:1054
clean false:3
clean_rate:0.9971617786187322
noisy true:137
noisy false:422
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 559
epoch [139/200] batch [5/33] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.6514 (0.5581) acc_x 81.2500 (83.7500) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [10/33] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3645 (0.5588) acc_x 90.6250 (86.2500) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/33] time 0.182 (0.181) data 0.105 (0.103) loss_x loss_x 0.8330 (0.6339) acc_x 71.8750 (83.1250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/33] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.6172 (0.6653) acc_x 81.2500 (82.6562) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/33] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.6167 (0.6413) acc_x 78.1250 (82.7500) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/33] time 0.160 (0.180) data 0.084 (0.103) loss_x loss_x 0.5693 (0.6437) acc_x 84.3750 (82.9167) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 440
confident_label rate tensor(0.6479, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1047
clean true:1044
clean false:3
clean_rate:0.997134670487106
noisy true:132
noisy false:437
after delete: len(clean_dataset) 1047
after delete: len(noisy_dataset) 569
epoch [140/200] batch [5/32] time 0.183 (0.186) data 0.105 (0.108) loss_x loss_x 0.7305 (0.6479) acc_x 84.3750 (84.3750) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/32] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.3875 (0.6513) acc_x 90.6250 (83.4375) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/32] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6562 (0.6615) acc_x 81.2500 (82.0833) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/32] time 0.182 (0.184) data 0.105 (0.106) loss_x loss_x 0.5479 (0.6209) acc_x 81.2500 (83.1250) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/32] time 0.186 (0.184) data 0.109 (0.106) loss_x loss_x 0.3445 (0.6152) acc_x 93.7500 (83.6250) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/32] time 0.170 (0.183) data 0.091 (0.105) loss_x loss_x 0.5264 (0.6397) acc_x 90.6250 (83.1250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 444
confident_label rate tensor(0.6374, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1030
clean true:1027
clean false:3
clean_rate:0.9970873786407767
noisy true:145
noisy false:441
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 586
epoch [141/200] batch [5/32] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.8813 (0.6147) acc_x 81.2500 (84.3750) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/32] time 0.160 (0.183) data 0.083 (0.106) loss_x loss_x 1.0059 (0.6548) acc_x 75.0000 (82.8125) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/32] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.3494 (0.5862) acc_x 90.6250 (84.7917) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/32] time 0.159 (0.178) data 0.082 (0.100) loss_x loss_x 0.7183 (0.5957) acc_x 84.3750 (84.8438) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/32] time 0.182 (0.175) data 0.104 (0.098) loss_x loss_x 0.7285 (0.5999) acc_x 78.1250 (84.5000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/32] time 0.186 (0.175) data 0.108 (0.098) loss_x loss_x 0.4768 (0.5818) acc_x 84.3750 (85.1042) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.6498, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1050
clean true:1045
clean false:5
clean_rate:0.9952380952380953
noisy true:153
noisy false:413
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 566
epoch [142/200] batch [5/32] time 0.203 (0.187) data 0.125 (0.110) loss_x loss_x 0.1910 (0.5763) acc_x 93.7500 (86.2500) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/32] time 0.184 (0.187) data 0.108 (0.109) loss_x loss_x 0.5444 (0.5735) acc_x 87.5000 (85.6250) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/32] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.4995 (0.5384) acc_x 90.6250 (87.0833) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/32] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6094 (0.5412) acc_x 84.3750 (87.0312) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/32] time 0.181 (0.185) data 0.104 (0.107) loss_x loss_x 0.4436 (0.5799) acc_x 90.6250 (86.2500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/32] time 0.159 (0.182) data 0.082 (0.104) loss_x loss_x 0.5786 (0.5803) acc_x 81.2500 (85.6250) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 447
confident_label rate tensor(0.6337, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1024
clean true:1022
clean false:2
clean_rate:0.998046875
noisy true:147
noisy false:445
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 592
epoch [143/200] batch [5/32] time 0.168 (0.177) data 0.090 (0.100) loss_x loss_x 0.5996 (0.7042) acc_x 87.5000 (83.1250) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/32] time 0.160 (0.169) data 0.083 (0.091) loss_x loss_x 0.6553 (0.6834) acc_x 84.3750 (83.7500) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [15/32] time 0.161 (0.166) data 0.083 (0.088) loss_x loss_x 0.4236 (0.6193) acc_x 84.3750 (84.7917) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/32] time 0.170 (0.165) data 0.092 (0.087) loss_x loss_x 0.3379 (0.6328) acc_x 90.6250 (84.6875) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [25/32] time 0.184 (0.167) data 0.106 (0.089) loss_x loss_x 1.0039 (0.6493) acc_x 78.1250 (84.2500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/32] time 0.176 (0.169) data 0.098 (0.092) loss_x loss_x 0.6558 (0.6447) acc_x 84.3750 (84.2708) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 433
confident_label rate tensor(0.6467, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1045
clean true:1040
clean false:5
clean_rate:0.9952153110047847
noisy true:143
noisy false:428
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 571
epoch [144/200] batch [5/32] time 0.211 (0.189) data 0.134 (0.112) loss_x loss_x 0.1825 (0.5098) acc_x 100.0000 (88.7500) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [10/32] time 0.159 (0.180) data 0.082 (0.103) loss_x loss_x 0.5562 (0.5622) acc_x 81.2500 (86.8750) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/32] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.4985 (0.5753) acc_x 87.5000 (86.0417) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/32] time 0.183 (0.181) data 0.105 (0.103) loss_x loss_x 0.7983 (0.6209) acc_x 78.1250 (84.6875) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/32] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.4622 (0.6442) acc_x 87.5000 (84.0000) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/32] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.5723 (0.6175) acc_x 87.5000 (85.2083) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.6510, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1052
clean true:1049
clean false:3
clean_rate:0.997148288973384
noisy true:142
noisy false:422
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 564
epoch [145/200] batch [5/32] time 0.195 (0.168) data 0.118 (0.090) loss_x loss_x 0.8174 (0.7130) acc_x 81.2500 (81.8750) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/32] time 0.186 (0.167) data 0.108 (0.089) loss_x loss_x 0.9487 (0.6161) acc_x 75.0000 (84.3750) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [15/32] time 0.182 (0.172) data 0.105 (0.095) loss_x loss_x 0.6118 (0.5618) acc_x 81.2500 (85.6250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/32] time 0.167 (0.173) data 0.090 (0.095) loss_x loss_x 0.4880 (0.5812) acc_x 87.5000 (85.1562) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/32] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.4082 (0.5602) acc_x 87.5000 (85.3750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [30/32] time 0.184 (0.171) data 0.106 (0.094) loss_x loss_x 0.5957 (0.5745) acc_x 84.3750 (85.0000) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 450
confident_label rate tensor(0.6337, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1024
clean true:1021
clean false:3
clean_rate:0.9970703125
noisy true:145
noisy false:447
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 592
epoch [146/200] batch [5/32] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.2529 (0.4496) acc_x 90.6250 (85.0000) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/32] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.2168 (0.5288) acc_x 96.8750 (85.3125) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/32] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.8921 (0.5784) acc_x 81.2500 (85.4167) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/32] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.9136 (0.5802) acc_x 71.8750 (84.5312) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/32] time 0.195 (0.185) data 0.117 (0.108) loss_x loss_x 0.8208 (0.5745) acc_x 81.2500 (85.0000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/32] time 0.213 (0.186) data 0.136 (0.109) loss_x loss_x 0.4233 (0.5641) acc_x 87.5000 (85.3125) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 436
confident_label rate tensor(0.6467, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1045
clean true:1042
clean false:3
clean_rate:0.9971291866028709
noisy true:138
noisy false:433
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 571
epoch [147/200] batch [5/32] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.5415 (0.5312) acc_x 87.5000 (85.6250) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/32] time 0.184 (0.168) data 0.107 (0.091) loss_x loss_x 0.5352 (0.5448) acc_x 90.6250 (86.8750) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/32] time 0.182 (0.174) data 0.105 (0.096) loss_x loss_x 0.2944 (0.5131) acc_x 81.2500 (86.6667) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/32] time 0.181 (0.176) data 0.104 (0.099) loss_x loss_x 0.8345 (0.6112) acc_x 75.0000 (84.5312) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/32] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.8555 (0.6164) acc_x 75.0000 (84.0000) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/32] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.4673 (0.6087) acc_x 84.3750 (83.8542) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 415
confident_label rate tensor(0.6528, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1055
clean true:1052
clean false:3
clean_rate:0.9971563981042654
noisy true:149
noisy false:412
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 561
epoch [148/200] batch [5/32] time 0.160 (0.161) data 0.083 (0.084) loss_x loss_x 0.6572 (0.4605) acc_x 81.2500 (86.8750) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/32] time 0.172 (0.167) data 0.094 (0.090) loss_x loss_x 0.9902 (0.5609) acc_x 81.2500 (85.6250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [15/32] time 0.179 (0.169) data 0.102 (0.092) loss_x loss_x 0.9873 (0.5979) acc_x 78.1250 (84.5833) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/32] time 0.178 (0.171) data 0.100 (0.093) loss_x loss_x 0.7192 (0.6259) acc_x 78.1250 (83.2812) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/32] time 0.180 (0.172) data 0.102 (0.095) loss_x loss_x 0.5444 (0.6318) acc_x 87.5000 (83.0000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/32] time 0.160 (0.172) data 0.082 (0.095) loss_x loss_x 0.5098 (0.6257) acc_x 90.6250 (83.2292) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 448
confident_label rate tensor(0.6411, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1036
clean true:1032
clean false:4
clean_rate:0.9961389961389961
noisy true:136
noisy false:444
after delete: len(clean_dataset) 1036
after delete: len(noisy_dataset) 580
epoch [149/200] batch [5/32] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.4382 (0.5767) acc_x 87.5000 (81.8750) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [10/32] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.7109 (0.6184) acc_x 78.1250 (82.8125) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/32] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.3386 (0.6134) acc_x 93.7500 (83.7500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/32] time 0.157 (0.180) data 0.080 (0.102) loss_x loss_x 0.8750 (0.6014) acc_x 78.1250 (83.5938) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/32] time 0.184 (0.177) data 0.107 (0.099) loss_x loss_x 0.8027 (0.5940) acc_x 75.0000 (83.7500) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/32] time 0.165 (0.176) data 0.087 (0.098) loss_x loss_x 0.6040 (0.5745) acc_x 81.2500 (84.0625) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 417
confident_label rate tensor(0.6535, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1056
clean true:1053
clean false:3
clean_rate:0.9971590909090909
noisy true:146
noisy false:414
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 560
epoch [150/200] batch [5/33] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.4028 (0.4853) acc_x 87.5000 (86.8750) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/33] time 0.187 (0.185) data 0.109 (0.108) loss_x loss_x 0.3442 (0.5508) acc_x 90.6250 (85.3125) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/33] time 0.170 (0.183) data 0.093 (0.105) loss_x loss_x 0.6133 (0.5840) acc_x 84.3750 (84.7917) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/33] time 0.181 (0.180) data 0.103 (0.103) loss_x loss_x 0.6206 (0.5745) acc_x 87.5000 (85.1562) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/33] time 0.161 (0.180) data 0.083 (0.102) loss_x loss_x 0.4519 (0.5823) acc_x 90.6250 (85.1250) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/33] time 0.163 (0.177) data 0.085 (0.099) loss_x loss_x 0.7007 (0.6025) acc_x 75.0000 (84.2708) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 450
confident_label rate tensor(0.6442, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1041
clean true:1039
clean false:2
clean_rate:0.9980787704130644
noisy true:127
noisy false:448
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 575
epoch [151/200] batch [5/32] time 0.219 (0.193) data 0.142 (0.116) loss_x loss_x 0.8623 (0.6489) acc_x 81.2500 (83.1250) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [10/32] time 0.184 (0.190) data 0.107 (0.113) loss_x loss_x 0.3923 (0.5563) acc_x 87.5000 (85.9375) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/32] time 0.182 (0.189) data 0.105 (0.112) loss_x loss_x 0.5820 (0.5612) acc_x 87.5000 (85.8333) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/32] time 0.183 (0.188) data 0.107 (0.111) loss_x loss_x 0.3501 (0.6065) acc_x 90.6250 (84.2188) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/32] time 0.184 (0.187) data 0.107 (0.111) loss_x loss_x 0.7983 (0.6172) acc_x 84.3750 (84.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/32] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.9849 (0.6356) acc_x 84.3750 (84.0625) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 465
confident_label rate tensor(0.6300, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1018
clean true:1013
clean false:5
clean_rate:0.9950884086444007
noisy true:138
noisy false:460
after delete: len(clean_dataset) 1018
after delete: len(noisy_dataset) 598
epoch [152/200] batch [5/31] time 0.188 (0.189) data 0.111 (0.112) loss_x loss_x 0.5020 (0.5803) acc_x 84.3750 (83.7500) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/31] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.6055 (0.6370) acc_x 84.3750 (82.8125) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [15/31] time 0.178 (0.185) data 0.102 (0.107) loss_x loss_x 0.2771 (0.6112) acc_x 96.8750 (84.3750) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/31] time 0.188 (0.185) data 0.110 (0.108) loss_x loss_x 0.8760 (0.5941) acc_x 71.8750 (84.6875) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/31] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.3071 (0.6010) acc_x 90.6250 (84.2500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/31] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 1.1367 (0.6178) acc_x 62.5000 (83.3333) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 416
confident_label rate tensor(0.6572, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1062
clean true:1059
clean false:3
clean_rate:0.9971751412429378
noisy true:141
noisy false:413
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 554
epoch [153/200] batch [5/33] time 0.183 (0.188) data 0.106 (0.110) loss_x loss_x 0.8140 (0.6327) acc_x 78.1250 (82.5000) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [10/33] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.6025 (0.6014) acc_x 87.5000 (84.0625) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/33] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.7700 (0.6580) acc_x 81.2500 (84.1667) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/33] time 0.178 (0.183) data 0.100 (0.105) loss_x loss_x 0.2766 (0.6689) acc_x 96.8750 (83.4375) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/33] time 0.186 (0.183) data 0.108 (0.105) loss_x loss_x 0.3599 (0.6140) acc_x 90.6250 (84.6250) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/33] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.4614 (0.6220) acc_x 87.5000 (83.9583) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 412
confident_label rate tensor(0.6553, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1059
clean true:1055
clean false:4
clean_rate:0.996222851746931
noisy true:149
noisy false:408
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 557
epoch [154/200] batch [5/33] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.6421 (0.5632) acc_x 87.5000 (85.6250) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [10/33] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 1.1055 (0.7011) acc_x 78.1250 (83.1250) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/33] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.5146 (0.7106) acc_x 84.3750 (82.2917) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/33] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.2500 (0.6614) acc_x 96.8750 (83.4375) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/33] time 0.184 (0.182) data 0.106 (0.105) loss_x loss_x 0.5571 (0.6531) acc_x 90.6250 (83.7500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/33] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.2686 (0.6214) acc_x 90.6250 (84.2708) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.6380, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1031
clean true:1028
clean false:3
clean_rate:0.997090203685742
noisy true:146
noisy false:439
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 585
epoch [155/200] batch [5/32] time 0.181 (0.179) data 0.104 (0.101) loss_x loss_x 0.6479 (0.6736) acc_x 84.3750 (83.7500) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/32] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.3342 (0.5739) acc_x 90.6250 (85.9375) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [15/32] time 0.184 (0.182) data 0.106 (0.105) loss_x loss_x 0.5264 (0.5820) acc_x 87.5000 (86.0417) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/32] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 1.0146 (0.6168) acc_x 71.8750 (84.5312) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/32] time 0.183 (0.183) data 0.106 (0.105) loss_x loss_x 0.4600 (0.6212) acc_x 87.5000 (85.3750) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/32] time 0.161 (0.182) data 0.084 (0.104) loss_x loss_x 0.5264 (0.6154) acc_x 84.3750 (85.1042) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 430
confident_label rate tensor(0.6479, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1047
clean true:1043
clean false:4
clean_rate:0.9961795606494747
noisy true:143
noisy false:426
after delete: len(clean_dataset) 1047
after delete: len(noisy_dataset) 569
epoch [156/200] batch [5/32] time 0.161 (0.161) data 0.084 (0.083) loss_x loss_x 0.3828 (0.4572) acc_x 90.6250 (86.2500) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/32] time 0.159 (0.160) data 0.083 (0.083) loss_x loss_x 0.5742 (0.4413) acc_x 87.5000 (88.1250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/32] time 0.159 (0.160) data 0.081 (0.083) loss_x loss_x 0.3706 (0.4410) acc_x 96.8750 (89.5833) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/32] time 0.182 (0.164) data 0.104 (0.087) loss_x loss_x 0.2930 (0.4573) acc_x 96.8750 (88.7500) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [25/32] time 0.159 (0.167) data 0.082 (0.090) loss_x loss_x 0.7178 (0.4880) acc_x 78.1250 (88.2500) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/32] time 0.184 (0.170) data 0.106 (0.093) loss_x loss_x 0.3765 (0.5122) acc_x 87.5000 (87.0833) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 435
confident_label rate tensor(0.6473, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1046
clean true:1041
clean false:5
clean_rate:0.9952198852772467
noisy true:140
noisy false:430
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 570
epoch [157/200] batch [5/32] time 0.160 (0.179) data 0.082 (0.101) loss_x loss_x 1.0498 (0.7155) acc_x 68.7500 (80.6250) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/32] time 0.183 (0.179) data 0.105 (0.101) loss_x loss_x 0.7905 (0.7236) acc_x 81.2500 (81.2500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/32] time 0.160 (0.175) data 0.083 (0.098) loss_x loss_x 0.3960 (0.6420) acc_x 87.5000 (83.3333) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/32] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 0.5527 (0.6137) acc_x 90.6250 (85.0000) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/32] time 0.160 (0.169) data 0.083 (0.092) loss_x loss_x 0.3457 (0.6242) acc_x 90.6250 (85.0000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/32] time 0.161 (0.168) data 0.084 (0.090) loss_x loss_x 0.8008 (0.6452) acc_x 84.3750 (85.1042) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 424
confident_label rate tensor(0.6498, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1050
clean true:1046
clean false:4
clean_rate:0.9961904761904762
noisy true:146
noisy false:420
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 566
epoch [158/200] batch [5/32] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.4436 (0.6813) acc_x 87.5000 (85.0000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/32] time 0.183 (0.185) data 0.106 (0.107) loss_x loss_x 0.9800 (0.6375) acc_x 84.3750 (84.6875) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/32] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.9478 (0.6380) acc_x 71.8750 (82.7083) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/32] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.5615 (0.6084) acc_x 84.3750 (82.9688) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/32] time 0.187 (0.185) data 0.109 (0.107) loss_x loss_x 0.5039 (0.6203) acc_x 84.3750 (82.6250) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/32] time 0.171 (0.184) data 0.093 (0.106) loss_x loss_x 0.6084 (0.6023) acc_x 81.2500 (83.2292) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 439
confident_label rate tensor(0.6436, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1040
clean true:1034
clean false:6
clean_rate:0.9942307692307693
noisy true:143
noisy false:433
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 576
epoch [159/200] batch [5/32] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.8188 (0.5699) acc_x 75.0000 (86.2500) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [10/32] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.5649 (0.5917) acc_x 90.6250 (85.3125) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/32] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.4019 (0.5733) acc_x 90.6250 (86.0417) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/32] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.6851 (0.5683) acc_x 81.2500 (86.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/32] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7598 (0.5413) acc_x 65.6250 (86.0000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/32] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.2935 (0.5311) acc_x 87.5000 (86.0417) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 402
confident_label rate tensor(0.6621, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1070
clean true:1067
clean false:3
clean_rate:0.997196261682243
noisy true:147
noisy false:399
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 546
epoch [160/200] batch [5/33] time 0.175 (0.181) data 0.097 (0.103) loss_x loss_x 0.6289 (0.6642) acc_x 84.3750 (83.1250) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [10/33] time 0.179 (0.181) data 0.103 (0.103) loss_x loss_x 0.8223 (0.6095) acc_x 78.1250 (83.7500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/33] time 0.192 (0.183) data 0.115 (0.105) loss_x loss_x 0.4031 (0.6137) acc_x 87.5000 (83.7500) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/33] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.8687 (0.6280) acc_x 78.1250 (83.2812) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/33] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.3293 (0.5793) acc_x 93.7500 (84.8750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [30/33] time 0.185 (0.186) data 0.107 (0.108) loss_x loss_x 0.3728 (0.5810) acc_x 93.7500 (84.5833) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 428
confident_label rate tensor(0.6528, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1055
clean true:1053
clean false:2
clean_rate:0.9981042654028436
noisy true:135
noisy false:426
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 561
epoch [161/200] batch [5/32] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 0.9517 (0.5502) acc_x 75.0000 (87.5000) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/32] time 0.177 (0.177) data 0.099 (0.099) loss_x loss_x 1.0234 (0.5495) acc_x 81.2500 (87.8125) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [15/32] time 0.162 (0.173) data 0.084 (0.095) loss_x loss_x 0.5967 (0.5632) acc_x 84.3750 (86.6667) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/32] time 0.193 (0.177) data 0.115 (0.099) loss_x loss_x 0.4592 (0.5700) acc_x 90.6250 (86.2500) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/32] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.4707 (0.5582) acc_x 81.2500 (86.0000) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/32] time 0.182 (0.179) data 0.104 (0.102) loss_x loss_x 0.5430 (0.5886) acc_x 87.5000 (85.4167) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.6429, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1039
clean true:1034
clean false:5
clean_rate:0.9951876804619827
noisy true:141
noisy false:436
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 577
epoch [162/200] batch [5/32] time 0.202 (0.187) data 0.124 (0.109) loss_x loss_x 0.5801 (0.7638) acc_x 87.5000 (80.0000) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [10/32] time 0.197 (0.184) data 0.119 (0.107) loss_x loss_x 0.6123 (0.6649) acc_x 93.7500 (84.3750) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/32] time 0.174 (0.184) data 0.097 (0.107) loss_x loss_x 0.4004 (0.6068) acc_x 90.6250 (85.2083) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/32] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.4985 (0.6065) acc_x 87.5000 (84.8438) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/32] time 0.172 (0.181) data 0.094 (0.104) loss_x loss_x 0.3948 (0.5913) acc_x 90.6250 (85.1250) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [30/32] time 0.196 (0.182) data 0.119 (0.104) loss_x loss_x 0.6152 (0.5912) acc_x 81.2500 (84.4792) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.6392, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1033
clean true:1031
clean false:2
clean_rate:0.9980638915779284
noisy true:147
noisy false:436
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 583
epoch [163/200] batch [5/32] time 0.160 (0.162) data 0.083 (0.085) loss_x loss_x 0.5762 (0.4713) acc_x 87.5000 (87.5000) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/32] time 0.163 (0.162) data 0.085 (0.085) loss_x loss_x 0.5659 (0.4617) acc_x 84.3750 (87.5000) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [15/32] time 0.160 (0.161) data 0.082 (0.084) loss_x loss_x 0.6401 (0.5167) acc_x 81.2500 (86.4583) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/32] time 0.182 (0.162) data 0.105 (0.085) loss_x loss_x 0.5078 (0.5776) acc_x 84.3750 (84.5312) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [25/32] time 0.182 (0.166) data 0.104 (0.088) loss_x loss_x 0.7700 (0.5891) acc_x 78.1250 (84.3750) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/32] time 0.186 (0.168) data 0.109 (0.090) loss_x loss_x 0.7427 (0.6181) acc_x 81.2500 (84.0625) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.6566, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1061
clean true:1056
clean false:5
clean_rate:0.9952874646559849
noisy true:134
noisy false:421
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 555
epoch [164/200] batch [5/33] time 0.185 (0.183) data 0.107 (0.105) loss_x loss_x 0.9819 (0.6247) acc_x 78.1250 (82.5000) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [10/33] time 0.157 (0.176) data 0.079 (0.098) loss_x loss_x 1.0957 (0.6217) acc_x 71.8750 (83.1250) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/33] time 0.161 (0.171) data 0.083 (0.093) loss_x loss_x 0.6050 (0.6522) acc_x 81.2500 (82.9167) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/33] time 0.165 (0.169) data 0.086 (0.091) loss_x loss_x 0.8428 (0.6323) acc_x 81.2500 (83.7500) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/33] time 0.167 (0.172) data 0.088 (0.094) loss_x loss_x 0.7891 (0.6464) acc_x 78.1250 (83.0000) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/33] time 0.171 (0.172) data 0.093 (0.094) loss_x loss_x 0.4243 (0.6341) acc_x 90.6250 (83.9583) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.6411, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1036
clean true:1032
clean false:4
clean_rate:0.9961389961389961
noisy true:146
noisy false:434
after delete: len(clean_dataset) 1036
after delete: len(noisy_dataset) 580
epoch [165/200] batch [5/32] time 0.197 (0.183) data 0.119 (0.105) loss_x loss_x 0.4075 (0.4312) acc_x 90.6250 (90.6250) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/32] time 0.199 (0.184) data 0.121 (0.107) loss_x loss_x 0.6631 (0.4856) acc_x 84.3750 (88.4375) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/32] time 0.187 (0.183) data 0.110 (0.105) loss_x loss_x 0.3047 (0.4854) acc_x 93.7500 (88.5417) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/32] time 0.179 (0.180) data 0.102 (0.102) loss_x loss_x 0.3586 (0.5012) acc_x 87.5000 (88.1250) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/32] time 0.165 (0.178) data 0.087 (0.100) loss_x loss_x 0.6250 (0.5280) acc_x 81.2500 (87.3750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/32] time 0.184 (0.177) data 0.106 (0.099) loss_x loss_x 0.3059 (0.5382) acc_x 93.7500 (86.9792) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 427
confident_label rate tensor(0.6436, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1040
clean true:1037
clean false:3
clean_rate:0.9971153846153846
noisy true:152
noisy false:424
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 576
epoch [166/200] batch [5/32] time 0.178 (0.176) data 0.099 (0.097) loss_x loss_x 0.8887 (0.8403) acc_x 75.0000 (78.7500) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/32] time 0.228 (0.190) data 0.150 (0.112) loss_x loss_x 0.6182 (0.7843) acc_x 87.5000 (81.2500) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/32] time 0.184 (0.186) data 0.106 (0.108) loss_x loss_x 0.7393 (0.7331) acc_x 84.3750 (82.2917) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/32] time 0.169 (0.184) data 0.091 (0.105) loss_x loss_x 0.5454 (0.7344) acc_x 81.2500 (81.8750) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/32] time 0.176 (0.182) data 0.099 (0.103) loss_x loss_x 0.5811 (0.7058) acc_x 81.2500 (82.3750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/32] time 0.174 (0.180) data 0.097 (0.102) loss_x loss_x 0.5415 (0.7026) acc_x 87.5000 (82.2917) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 413
confident_label rate tensor(0.6559, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1060
clean true:1056
clean false:4
clean_rate:0.9962264150943396
noisy true:147
noisy false:409
after delete: len(clean_dataset) 1060
after delete: len(noisy_dataset) 556
epoch [167/200] batch [5/33] time 0.188 (0.181) data 0.110 (0.103) loss_x loss_x 1.0469 (0.8211) acc_x 78.1250 (81.2500) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [10/33] time 0.178 (0.183) data 0.101 (0.105) loss_x loss_x 0.5259 (0.6545) acc_x 90.6250 (83.7500) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/33] time 0.185 (0.180) data 0.106 (0.102) loss_x loss_x 0.5308 (0.5703) acc_x 81.2500 (85.2083) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/33] time 0.192 (0.182) data 0.114 (0.104) loss_x loss_x 0.4482 (0.5407) acc_x 87.5000 (86.0938) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/33] time 0.190 (0.182) data 0.112 (0.104) loss_x loss_x 0.7646 (0.5288) acc_x 84.3750 (86.8750) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/33] time 0.179 (0.181) data 0.100 (0.103) loss_x loss_x 0.5649 (0.5344) acc_x 81.2500 (86.4583) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.6498, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1050
clean true:1047
clean false:3
clean_rate:0.9971428571428571
noisy true:144
noisy false:422
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 566
epoch [168/200] batch [5/32] time 0.169 (0.174) data 0.091 (0.096) loss_x loss_x 0.5396 (0.5661) acc_x 81.2500 (84.3750) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/32] time 0.169 (0.171) data 0.091 (0.093) loss_x loss_x 0.5684 (0.5442) acc_x 87.5000 (86.8750) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/32] time 0.160 (0.171) data 0.082 (0.093) loss_x loss_x 0.6362 (0.6278) acc_x 81.2500 (83.3333) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/32] time 0.175 (0.172) data 0.096 (0.094) loss_x loss_x 0.3459 (0.6009) acc_x 93.7500 (83.7500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/32] time 0.173 (0.173) data 0.095 (0.095) loss_x loss_x 0.6133 (0.5993) acc_x 78.1250 (83.7500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/32] time 0.194 (0.175) data 0.116 (0.097) loss_x loss_x 0.2258 (0.5813) acc_x 93.7500 (84.4792) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.6535, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1056
clean true:1053
clean false:3
clean_rate:0.9971590909090909
noisy true:143
noisy false:417
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 560
epoch [169/200] batch [5/33] time 0.187 (0.185) data 0.109 (0.107) loss_x loss_x 0.3350 (0.5200) acc_x 93.7500 (86.8750) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [10/33] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.3303 (0.4219) acc_x 93.7500 (90.6250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/33] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 1.1270 (0.5081) acc_x 68.7500 (87.9167) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/33] time 0.176 (0.188) data 0.096 (0.110) loss_x loss_x 0.6304 (0.5286) acc_x 84.3750 (87.1875) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/33] time 0.189 (0.187) data 0.111 (0.109) loss_x loss_x 0.3743 (0.5445) acc_x 93.7500 (86.3750) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/33] time 0.188 (0.186) data 0.109 (0.108) loss_x loss_x 0.6812 (0.5412) acc_x 78.1250 (86.1458) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.6504, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1051
clean true:1048
clean false:3
clean_rate:0.9971455756422455
noisy true:142
noisy false:423
after delete: len(clean_dataset) 1051
after delete: len(noisy_dataset) 565
epoch [170/200] batch [5/32] time 0.165 (0.167) data 0.087 (0.090) loss_x loss_x 0.2881 (0.4392) acc_x 93.7500 (85.6250) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/32] time 0.184 (0.174) data 0.106 (0.096) loss_x loss_x 0.4346 (0.4716) acc_x 87.5000 (86.8750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/32] time 0.180 (0.177) data 0.102 (0.099) loss_x loss_x 0.8018 (0.5187) acc_x 81.2500 (86.4583) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/32] time 0.213 (0.180) data 0.134 (0.102) loss_x loss_x 0.6089 (0.5643) acc_x 84.3750 (85.3125) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/32] time 0.178 (0.178) data 0.100 (0.100) loss_x loss_x 0.5850 (0.5590) acc_x 81.2500 (85.7500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/32] time 0.176 (0.179) data 0.097 (0.100) loss_x loss_x 0.3936 (0.5815) acc_x 90.6250 (85.6250) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 434
confident_label rate tensor(0.6479, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1047
clean true:1044
clean false:3
clean_rate:0.997134670487106
noisy true:138
noisy false:431
after delete: len(clean_dataset) 1047
after delete: len(noisy_dataset) 569
epoch [171/200] batch [5/32] time 0.173 (0.173) data 0.095 (0.095) loss_x loss_x 1.0117 (0.5958) acc_x 68.7500 (83.7500) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [10/32] time 0.184 (0.175) data 0.107 (0.097) loss_x loss_x 0.6001 (0.6411) acc_x 78.1250 (81.2500) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [15/32] time 0.184 (0.174) data 0.106 (0.096) loss_x loss_x 0.5952 (0.6400) acc_x 87.5000 (82.0833) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/32] time 0.179 (0.176) data 0.100 (0.098) loss_x loss_x 0.5859 (0.6113) acc_x 81.2500 (83.2812) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/32] time 0.176 (0.176) data 0.099 (0.098) loss_x loss_x 0.6636 (0.5893) acc_x 84.3750 (84.1250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/32] time 0.171 (0.176) data 0.093 (0.098) loss_x loss_x 0.5439 (0.5859) acc_x 84.3750 (84.1667) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 449
confident_label rate tensor(0.6392, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1033
clean true:1028
clean false:5
clean_rate:0.995159728944821
noisy true:139
noisy false:444
after delete: len(clean_dataset) 1033
after delete: len(noisy_dataset) 583
epoch [172/200] batch [5/32] time 0.172 (0.163) data 0.095 (0.085) loss_x loss_x 0.4536 (0.5235) acc_x 90.6250 (85.6250) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/32] time 0.163 (0.167) data 0.084 (0.089) loss_x loss_x 0.7090 (0.6295) acc_x 75.0000 (83.4375) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/32] time 0.233 (0.175) data 0.154 (0.097) loss_x loss_x 0.5605 (0.5981) acc_x 81.2500 (83.1250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/32] time 0.219 (0.187) data 0.140 (0.109) loss_x loss_x 0.7344 (0.6217) acc_x 84.3750 (82.3438) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/32] time 0.159 (0.188) data 0.081 (0.110) loss_x loss_x 0.5488 (0.6035) acc_x 81.2500 (82.5000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/32] time 0.161 (0.185) data 0.084 (0.107) loss_x loss_x 0.5723 (0.5960) acc_x 84.3750 (83.4375) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.6485, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1048
clean true:1045
clean false:3
clean_rate:0.9971374045801527
noisy true:139
noisy false:429
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 568
epoch [173/200] batch [5/32] time 0.184 (0.182) data 0.106 (0.104) loss_x loss_x 0.2527 (0.4898) acc_x 93.7500 (85.6250) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/32] time 0.170 (0.173) data 0.091 (0.095) loss_x loss_x 0.2891 (0.5000) acc_x 93.7500 (86.2500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/32] time 0.159 (0.170) data 0.081 (0.092) loss_x loss_x 0.5752 (0.4976) acc_x 81.2500 (86.8750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/32] time 0.169 (0.169) data 0.092 (0.091) loss_x loss_x 0.3293 (0.4826) acc_x 96.8750 (87.8125) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/32] time 0.172 (0.168) data 0.094 (0.089) loss_x loss_x 0.6763 (0.5087) acc_x 84.3750 (87.1250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/32] time 0.169 (0.168) data 0.091 (0.090) loss_x loss_x 0.3813 (0.5215) acc_x 90.6250 (86.4583) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.6510, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1052
clean true:1049
clean false:3
clean_rate:0.997148288973384
noisy true:141
noisy false:423
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 564
epoch [174/200] batch [5/32] time 0.184 (0.171) data 0.106 (0.093) loss_x loss_x 0.4790 (0.4230) acc_x 87.5000 (88.1250) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/32] time 0.172 (0.176) data 0.094 (0.098) loss_x loss_x 0.4670 (0.5021) acc_x 81.2500 (86.2500) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [15/32] time 0.187 (0.178) data 0.107 (0.099) loss_x loss_x 0.9429 (0.5190) acc_x 71.8750 (85.8333) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/32] time 0.191 (0.180) data 0.113 (0.102) loss_x loss_x 0.6523 (0.5806) acc_x 84.3750 (84.3750) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/32] time 0.160 (0.179) data 0.081 (0.100) loss_x loss_x 0.6606 (0.5450) acc_x 87.5000 (85.7500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/32] time 0.180 (0.179) data 0.102 (0.101) loss_x loss_x 0.5972 (0.5415) acc_x 87.5000 (86.0417) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.6584, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1064
clean true:1058
clean false:6
clean_rate:0.9943609022556391
noisy true:140
noisy false:412
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 552
epoch [175/200] batch [5/33] time 0.185 (0.185) data 0.107 (0.106) loss_x loss_x 0.4788 (0.4890) acc_x 90.6250 (87.5000) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [10/33] time 0.184 (0.181) data 0.106 (0.103) loss_x loss_x 0.5815 (0.5576) acc_x 84.3750 (84.6875) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/33] time 0.169 (0.179) data 0.091 (0.100) loss_x loss_x 0.6069 (0.5555) acc_x 84.3750 (85.4167) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/33] time 0.184 (0.179) data 0.105 (0.101) loss_x loss_x 0.7246 (0.5368) acc_x 81.2500 (85.7812) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/33] time 0.193 (0.179) data 0.115 (0.101) loss_x loss_x 0.6724 (0.5657) acc_x 81.2500 (85.5000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/33] time 0.170 (0.178) data 0.092 (0.100) loss_x loss_x 0.4702 (0.5608) acc_x 90.6250 (85.8333) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 427
confident_label rate tensor(0.6498, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1050
clean true:1047
clean false:3
clean_rate:0.9971428571428571
noisy true:142
noisy false:424
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 566
epoch [176/200] batch [5/32] time 0.178 (0.183) data 0.100 (0.105) loss_x loss_x 0.2607 (0.5829) acc_x 90.6250 (86.8750) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/32] time 0.219 (0.190) data 0.141 (0.112) loss_x loss_x 0.5483 (0.5236) acc_x 84.3750 (85.9375) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/32] time 0.177 (0.184) data 0.099 (0.106) loss_x loss_x 0.7935 (0.5260) acc_x 75.0000 (85.2083) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/32] time 0.181 (0.183) data 0.104 (0.105) loss_x loss_x 0.3865 (0.5215) acc_x 87.5000 (85.4688) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/32] time 0.183 (0.181) data 0.104 (0.103) loss_x loss_x 0.8677 (0.5436) acc_x 78.1250 (85.3750) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/32] time 0.182 (0.182) data 0.104 (0.104) loss_x loss_x 0.7451 (0.5660) acc_x 81.2500 (84.6875) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.6528, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1055
clean true:1050
clean false:5
clean_rate:0.995260663507109
noisy true:144
noisy false:417
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 561
epoch [177/200] batch [5/32] time 0.192 (0.195) data 0.114 (0.117) loss_x loss_x 0.3491 (0.5560) acc_x 87.5000 (85.0000) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [10/32] time 0.184 (0.191) data 0.105 (0.113) loss_x loss_x 0.3281 (0.5968) acc_x 87.5000 (85.3125) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/32] time 0.194 (0.192) data 0.115 (0.114) loss_x loss_x 0.7451 (0.6154) acc_x 78.1250 (85.0000) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/32] time 0.178 (0.191) data 0.099 (0.112) loss_x loss_x 0.5669 (0.5793) acc_x 87.5000 (85.3125) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/32] time 0.186 (0.190) data 0.107 (0.112) loss_x loss_x 0.5737 (0.5578) acc_x 84.3750 (85.6250) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [30/32] time 0.186 (0.190) data 0.108 (0.111) loss_x loss_x 0.5234 (0.5699) acc_x 90.6250 (85.5208) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 446
confident_label rate tensor(0.6423, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1038
clean true:1033
clean false:5
clean_rate:0.9951830443159922
noisy true:137
noisy false:441
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 578
epoch [178/200] batch [5/32] time 0.188 (0.184) data 0.110 (0.106) loss_x loss_x 0.9648 (0.6321) acc_x 68.7500 (82.5000) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/32] time 0.170 (0.180) data 0.092 (0.102) loss_x loss_x 0.7466 (0.6298) acc_x 78.1250 (82.1875) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/32] time 0.175 (0.180) data 0.094 (0.102) loss_x loss_x 0.3613 (0.5778) acc_x 93.7500 (84.7917) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/32] time 0.190 (0.179) data 0.111 (0.101) loss_x loss_x 0.5112 (0.5548) acc_x 90.6250 (86.2500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/32] time 0.175 (0.177) data 0.097 (0.099) loss_x loss_x 0.4312 (0.5529) acc_x 87.5000 (85.7500) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/32] time 0.186 (0.177) data 0.109 (0.099) loss_x loss_x 0.3523 (0.5411) acc_x 87.5000 (86.0417) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 439
confident_label rate tensor(0.6429, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1039
clean true:1036
clean false:3
clean_rate:0.9971126082771896
noisy true:141
noisy false:436
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 577
epoch [179/200] batch [5/32] time 0.176 (0.181) data 0.098 (0.103) loss_x loss_x 0.2004 (0.5832) acc_x 100.0000 (85.0000) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/32] time 0.160 (0.172) data 0.082 (0.093) loss_x loss_x 0.5059 (0.5986) acc_x 90.6250 (85.6250) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/32] time 0.160 (0.172) data 0.082 (0.094) loss_x loss_x 0.4458 (0.5789) acc_x 87.5000 (85.6250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/32] time 0.177 (0.173) data 0.100 (0.095) loss_x loss_x 0.5747 (0.6173) acc_x 87.5000 (85.1562) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/32] time 0.177 (0.174) data 0.098 (0.096) loss_x loss_x 0.5220 (0.5966) acc_x 84.3750 (85.7500) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/32] time 0.170 (0.174) data 0.091 (0.096) loss_x loss_x 0.5410 (0.5858) acc_x 84.3750 (85.6250) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 421
confident_label rate tensor(0.6541, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1057
clean true:1056
clean false:1
clean_rate:0.9990539262062441
noisy true:139
noisy false:420
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 559
epoch [180/200] batch [5/33] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 0.3096 (0.6370) acc_x 90.6250 (83.1250) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [10/33] time 0.171 (0.179) data 0.093 (0.101) loss_x loss_x 0.5054 (0.6900) acc_x 87.5000 (81.8750) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/33] time 0.170 (0.176) data 0.091 (0.097) loss_x loss_x 0.4858 (0.6382) acc_x 84.3750 (82.7083) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/33] time 0.171 (0.174) data 0.092 (0.095) loss_x loss_x 0.5029 (0.6219) acc_x 90.6250 (82.8125) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/33] time 0.171 (0.174) data 0.093 (0.095) loss_x loss_x 0.3162 (0.5896) acc_x 90.6250 (83.8750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [30/33] time 0.164 (0.173) data 0.085 (0.095) loss_x loss_x 0.7852 (0.6037) acc_x 71.8750 (83.1250) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 412
confident_label rate tensor(0.6597, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1066
clean true:1063
clean false:3
clean_rate:0.9971857410881801
noisy true:141
noisy false:409
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 550
epoch [181/200] batch [5/33] time 0.189 (0.184) data 0.110 (0.105) loss_x loss_x 0.7881 (0.7016) acc_x 71.8750 (83.7500) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [10/33] time 0.163 (0.182) data 0.086 (0.104) loss_x loss_x 0.4341 (0.5735) acc_x 90.6250 (85.6250) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/33] time 0.188 (0.181) data 0.111 (0.104) loss_x loss_x 0.7036 (0.5533) acc_x 81.2500 (86.0417) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/33] time 0.172 (0.179) data 0.095 (0.101) loss_x loss_x 0.6538 (0.5738) acc_x 81.2500 (84.8438) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/33] time 0.172 (0.178) data 0.095 (0.100) loss_x loss_x 0.4165 (0.5619) acc_x 90.6250 (85.2500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [30/33] time 0.186 (0.179) data 0.108 (0.101) loss_x loss_x 0.8169 (0.5609) acc_x 81.2500 (85.2083) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 414
confident_label rate tensor(0.6553, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1059
clean true:1056
clean false:3
clean_rate:0.9971671388101983
noisy true:146
noisy false:411
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 557
epoch [182/200] batch [5/33] time 0.172 (0.171) data 0.094 (0.094) loss_x loss_x 0.2286 (0.4323) acc_x 90.6250 (85.6250) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/33] time 0.188 (0.176) data 0.110 (0.098) loss_x loss_x 0.5220 (0.4620) acc_x 84.3750 (86.5625) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/33] time 0.162 (0.175) data 0.084 (0.097) loss_x loss_x 0.4739 (0.4977) acc_x 87.5000 (86.0417) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/33] time 0.211 (0.180) data 0.133 (0.102) loss_x loss_x 0.8140 (0.5069) acc_x 75.0000 (86.0938) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/33] time 0.207 (0.181) data 0.128 (0.103) loss_x loss_x 0.7412 (0.5289) acc_x 84.3750 (85.8750) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [30/33] time 0.172 (0.182) data 0.094 (0.103) loss_x loss_x 0.2206 (0.5321) acc_x 96.8750 (86.1458) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 401
confident_label rate tensor(0.6615, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1069
clean true:1065
clean false:4
clean_rate:0.9962581852198317
noisy true:150
noisy false:397
after delete: len(clean_dataset) 1069
after delete: len(noisy_dataset) 547
epoch [183/200] batch [5/33] time 0.172 (0.174) data 0.095 (0.096) loss_x loss_x 0.7324 (0.6616) acc_x 78.1250 (81.8750) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/33] time 0.170 (0.174) data 0.093 (0.096) loss_x loss_x 0.6748 (0.6112) acc_x 78.1250 (83.4375) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/33] time 0.181 (0.174) data 0.103 (0.096) loss_x loss_x 0.5391 (0.6287) acc_x 84.3750 (82.0833) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/33] time 0.180 (0.179) data 0.101 (0.101) loss_x loss_x 0.4636 (0.6123) acc_x 87.5000 (82.9688) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/33] time 0.166 (0.179) data 0.088 (0.101) loss_x loss_x 0.8105 (0.6309) acc_x 75.0000 (82.8750) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [30/33] time 0.169 (0.178) data 0.089 (0.100) loss_x loss_x 0.3555 (0.6231) acc_x 84.3750 (83.2292) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 408
confident_label rate tensor(0.6597, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1066
clean true:1065
clean false:1
clean_rate:0.99906191369606
noisy true:143
noisy false:407
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 550
epoch [184/200] batch [5/33] time 0.156 (0.157) data 0.079 (0.080) loss_x loss_x 0.6265 (0.6370) acc_x 78.1250 (83.1250) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/33] time 0.162 (0.159) data 0.084 (0.081) loss_x loss_x 0.6616 (0.6070) acc_x 81.2500 (83.7500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/33] time 0.163 (0.159) data 0.084 (0.081) loss_x loss_x 0.6689 (0.5757) acc_x 81.2500 (83.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/33] time 0.160 (0.159) data 0.082 (0.081) loss_x loss_x 1.0820 (0.6443) acc_x 71.8750 (82.0312) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/33] time 0.159 (0.159) data 0.081 (0.082) loss_x loss_x 0.8867 (0.6493) acc_x 71.8750 (81.6250) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [30/33] time 0.160 (0.159) data 0.082 (0.082) loss_x loss_x 0.6572 (0.6304) acc_x 81.2500 (82.1875) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 400
confident_label rate tensor(0.6640, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1073
clean true:1070
clean false:3
clean_rate:0.9972041006523765
noisy true:146
noisy false:397
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 543
epoch [185/200] batch [5/33] time 0.161 (0.161) data 0.083 (0.083) loss_x loss_x 0.7324 (0.6828) acc_x 75.0000 (81.2500) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/33] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.7212 (0.5700) acc_x 78.1250 (84.3750) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/33] time 0.162 (0.160) data 0.085 (0.082) loss_x loss_x 0.4041 (0.5982) acc_x 90.6250 (84.1667) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/33] time 0.161 (0.160) data 0.083 (0.082) loss_x loss_x 0.9082 (0.5950) acc_x 78.1250 (84.3750) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/33] time 0.160 (0.160) data 0.082 (0.082) loss_x loss_x 0.2141 (0.5882) acc_x 96.8750 (85.0000) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [30/33] time 0.160 (0.160) data 0.082 (0.082) loss_x loss_x 0.4246 (0.5825) acc_x 90.6250 (85.2083) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.6528, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1055
clean true:1054
clean false:1
clean_rate:0.9990521327014218
noisy true:140
noisy false:421
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 561
epoch [186/200] batch [5/32] time 0.158 (0.159) data 0.079 (0.081) loss_x loss_x 0.7109 (0.7323) acc_x 87.5000 (82.5000) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/32] time 0.161 (0.160) data 0.082 (0.082) loss_x loss_x 0.3452 (0.6289) acc_x 87.5000 (83.7500) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/32] time 0.163 (0.160) data 0.085 (0.082) loss_x loss_x 0.3950 (0.5757) acc_x 90.6250 (85.0000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/32] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.1841 (0.5740) acc_x 96.8750 (85.4688) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [25/32] time 0.159 (0.159) data 0.080 (0.082) loss_x loss_x 0.6772 (0.5910) acc_x 78.1250 (85.2500) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [30/32] time 0.160 (0.160) data 0.082 (0.082) loss_x loss_x 0.3794 (0.5933) acc_x 90.6250 (85.3125) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 415
confident_label rate tensor(0.6590, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1065
clean true:1060
clean false:5
clean_rate:0.9953051643192489
noisy true:141
noisy false:410
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 551
epoch [187/200] batch [5/33] time 0.158 (0.159) data 0.080 (0.082) loss_x loss_x 0.3831 (0.6208) acc_x 93.7500 (84.3750) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/33] time 0.161 (0.160) data 0.082 (0.082) loss_x loss_x 0.6528 (0.6283) acc_x 84.3750 (82.5000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/33] time 0.161 (0.160) data 0.083 (0.082) loss_x loss_x 1.2822 (0.6285) acc_x 75.0000 (83.5417) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/33] time 0.161 (0.160) data 0.083 (0.082) loss_x loss_x 0.4695 (0.6361) acc_x 87.5000 (83.2812) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/33] time 0.160 (0.160) data 0.082 (0.082) loss_x loss_x 0.6860 (0.6047) acc_x 81.2500 (84.2500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [30/33] time 0.160 (0.160) data 0.083 (0.082) loss_x loss_x 0.3296 (0.5805) acc_x 93.7500 (84.4792) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 436
confident_label rate tensor(0.6429, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1039
clean true:1035
clean false:4
clean_rate:0.9961501443695862
noisy true:145
noisy false:432
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 577
epoch [188/200] batch [5/32] time 0.158 (0.162) data 0.080 (0.084) loss_x loss_x 0.6172 (0.4203) acc_x 87.5000 (91.8750) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/32] time 0.182 (0.163) data 0.104 (0.085) loss_x loss_x 0.4341 (0.5380) acc_x 90.6250 (87.1875) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/32] time 0.172 (0.167) data 0.094 (0.089) loss_x loss_x 0.3755 (0.5279) acc_x 90.6250 (87.9167) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/32] time 0.178 (0.169) data 0.100 (0.091) loss_x loss_x 0.5767 (0.5358) acc_x 87.5000 (87.6562) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/32] time 0.167 (0.169) data 0.090 (0.091) loss_x loss_x 0.8188 (0.5537) acc_x 78.1250 (87.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [30/32] time 0.159 (0.169) data 0.081 (0.091) loss_x loss_x 0.1260 (0.5599) acc_x 100.0000 (86.6667) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 415
confident_label rate tensor(0.6615, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1069
clean true:1065
clean false:4
clean_rate:0.9962581852198317
noisy true:136
noisy false:411
after delete: len(clean_dataset) 1069
after delete: len(noisy_dataset) 547
epoch [189/200] batch [5/33] time 0.161 (0.161) data 0.082 (0.083) loss_x loss_x 0.5454 (0.5266) acc_x 84.3750 (86.8750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/33] time 0.161 (0.162) data 0.082 (0.083) loss_x loss_x 0.5093 (0.5254) acc_x 81.2500 (87.1875) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/33] time 0.162 (0.162) data 0.084 (0.083) loss_x loss_x 0.6196 (0.5307) acc_x 84.3750 (87.7083) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/33] time 0.160 (0.162) data 0.082 (0.083) loss_x loss_x 0.4231 (0.5494) acc_x 90.6250 (86.8750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/33] time 0.160 (0.162) data 0.082 (0.083) loss_x loss_x 0.4221 (0.5575) acc_x 93.7500 (87.5000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [30/33] time 0.161 (0.162) data 0.083 (0.083) loss_x loss_x 0.5874 (0.5659) acc_x 84.3750 (86.7708) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.6522, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1054
clean true:1051
clean false:3
clean_rate:0.9971537001897534
noisy true:143
noisy false:419
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 562
epoch [190/200] batch [5/32] time 0.158 (0.158) data 0.080 (0.080) loss_x loss_x 0.4875 (0.5740) acc_x 84.3750 (82.5000) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/32] time 0.158 (0.161) data 0.080 (0.083) loss_x loss_x 0.8198 (0.5812) acc_x 81.2500 (84.0625) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/32] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.9287 (0.5574) acc_x 81.2500 (85.4167) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/32] time 0.156 (0.159) data 0.079 (0.081) loss_x loss_x 0.9414 (0.5549) acc_x 75.0000 (85.9375) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/32] time 0.157 (0.159) data 0.079 (0.081) loss_x loss_x 0.4875 (0.5238) acc_x 87.5000 (87.1250) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [30/32] time 0.155 (0.159) data 0.078 (0.081) loss_x loss_x 0.9707 (0.5178) acc_x 78.1250 (86.9792) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 437
confident_label rate tensor(0.6485, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1048
clean true:1045
clean false:3
clean_rate:0.9971374045801527
noisy true:134
noisy false:434
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 568
epoch [191/200] batch [5/32] time 0.156 (0.157) data 0.078 (0.079) loss_x loss_x 0.6172 (0.5726) acc_x 84.3750 (88.1250) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/32] time 0.158 (0.157) data 0.079 (0.079) loss_x loss_x 0.7617 (0.6135) acc_x 71.8750 (85.6250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/32] time 0.157 (0.157) data 0.080 (0.079) loss_x loss_x 0.8096 (0.6144) acc_x 87.5000 (85.8333) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/32] time 0.157 (0.157) data 0.078 (0.079) loss_x loss_x 0.6489 (0.5879) acc_x 87.5000 (86.2500) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/32] time 0.156 (0.157) data 0.079 (0.079) loss_x loss_x 0.7710 (0.5908) acc_x 84.3750 (86.3750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [30/32] time 0.155 (0.156) data 0.078 (0.079) loss_x loss_x 0.5542 (0.5978) acc_x 81.2500 (85.8333) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 394
confident_label rate tensor(0.6627, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1071
clean true:1068
clean false:3
clean_rate:0.9971988795518207
noisy true:154
noisy false:391
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 545
epoch [192/200] batch [5/33] time 0.156 (0.156) data 0.078 (0.078) loss_x loss_x 1.0713 (0.5775) acc_x 84.3750 (86.2500) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/33] time 0.156 (0.156) data 0.078 (0.078) loss_x loss_x 0.5674 (0.5205) acc_x 87.5000 (87.1875) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/33] time 0.154 (0.156) data 0.077 (0.078) loss_x loss_x 0.9497 (0.5352) acc_x 75.0000 (86.6667) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/33] time 0.158 (0.156) data 0.081 (0.079) loss_x loss_x 0.5454 (0.5560) acc_x 81.2500 (86.2500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/33] time 0.156 (0.157) data 0.079 (0.079) loss_x loss_x 0.5386 (0.5717) acc_x 81.2500 (85.8750) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [30/33] time 0.158 (0.157) data 0.079 (0.079) loss_x loss_x 0.4680 (0.5813) acc_x 84.3750 (85.8333) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 450
confident_label rate tensor(0.6454, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1043
clean true:1038
clean false:5
clean_rate:0.9952061361457335
noisy true:128
noisy false:445
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 573
epoch [193/200] batch [5/32] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.5903 (0.7409) acc_x 90.6250 (81.8750) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/32] time 0.156 (0.157) data 0.078 (0.080) loss_x loss_x 0.5903 (0.6292) acc_x 90.6250 (84.6875) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/32] time 0.160 (0.158) data 0.082 (0.080) loss_x loss_x 0.4199 (0.6394) acc_x 90.6250 (84.5833) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/32] time 0.158 (0.158) data 0.080 (0.080) loss_x loss_x 0.4846 (0.6298) acc_x 87.5000 (84.8438) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/32] time 0.156 (0.158) data 0.079 (0.080) loss_x loss_x 0.4851 (0.6227) acc_x 84.3750 (84.5000) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [30/32] time 0.156 (0.158) data 0.078 (0.080) loss_x loss_x 0.4541 (0.6111) acc_x 84.3750 (84.2708) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 417
confident_label rate tensor(0.6578, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1063
clean true:1059
clean false:4
clean_rate:0.9962370649106302
noisy true:140
noisy false:413
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 553
epoch [194/200] batch [5/33] time 0.160 (0.159) data 0.082 (0.081) loss_x loss_x 0.5322 (0.6292) acc_x 84.3750 (86.2500) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/33] time 0.158 (0.159) data 0.081 (0.081) loss_x loss_x 0.1542 (0.5869) acc_x 100.0000 (88.1250) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/33] time 0.155 (0.159) data 0.078 (0.081) loss_x loss_x 0.5312 (0.5870) acc_x 87.5000 (87.5000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/33] time 0.160 (0.159) data 0.082 (0.081) loss_x loss_x 0.6406 (0.5985) acc_x 81.2500 (86.0938) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/33] time 0.158 (0.159) data 0.080 (0.081) loss_x loss_x 0.4966 (0.5990) acc_x 84.3750 (85.7500) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [30/33] time 0.157 (0.159) data 0.080 (0.081) loss_x loss_x 0.4224 (0.6038) acc_x 90.6250 (85.4167) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 409
confident_label rate tensor(0.6615, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1069
clean true:1066
clean false:3
clean_rate:0.9971936389148737
noisy true:141
noisy false:406
after delete: len(clean_dataset) 1069
after delete: len(noisy_dataset) 547
epoch [195/200] batch [5/33] time 0.158 (0.157) data 0.080 (0.079) loss_x loss_x 0.4897 (0.6011) acc_x 90.6250 (85.0000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/33] time 0.160 (0.158) data 0.081 (0.080) loss_x loss_x 0.7041 (0.6923) acc_x 81.2500 (82.1875) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/33] time 0.157 (0.158) data 0.080 (0.080) loss_x loss_x 0.3748 (0.6730) acc_x 93.7500 (83.5417) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/33] time 0.158 (0.158) data 0.080 (0.080) loss_x loss_x 1.1211 (0.6798) acc_x 71.8750 (82.9688) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/33] time 0.158 (0.159) data 0.080 (0.081) loss_x loss_x 0.9805 (0.6626) acc_x 71.8750 (83.0000) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [30/33] time 0.157 (0.159) data 0.080 (0.081) loss_x loss_x 0.5903 (0.6506) acc_x 81.2500 (83.0208) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 435
confident_label rate tensor(0.6429, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1039
clean true:1036
clean false:3
clean_rate:0.9971126082771896
noisy true:145
noisy false:432
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 577
epoch [196/200] batch [5/32] time 0.158 (0.158) data 0.081 (0.080) loss_x loss_x 0.5337 (0.5310) acc_x 87.5000 (88.1250) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/32] time 0.156 (0.158) data 0.078 (0.080) loss_x loss_x 0.7231 (0.5237) acc_x 75.0000 (87.1875) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/32] time 0.160 (0.158) data 0.082 (0.080) loss_x loss_x 0.7466 (0.6272) acc_x 78.1250 (84.7917) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/32] time 0.159 (0.159) data 0.082 (0.081) loss_x loss_x 0.5410 (0.6251) acc_x 84.3750 (84.2188) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/32] time 0.158 (0.159) data 0.081 (0.081) loss_x loss_x 0.7427 (0.6175) acc_x 84.3750 (84.0000) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/32] time 0.159 (0.158) data 0.081 (0.081) loss_x loss_x 0.6279 (0.6079) acc_x 87.5000 (84.6875) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.6541, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1057
clean true:1054
clean false:3
clean_rate:0.9971617786187322
noisy true:137
noisy false:422
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 559
epoch [197/200] batch [5/33] time 0.155 (0.156) data 0.077 (0.078) loss_x loss_x 1.7754 (0.7855) acc_x 62.5000 (80.0000) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/33] time 0.156 (0.156) data 0.077 (0.078) loss_x loss_x 0.3271 (0.6550) acc_x 90.6250 (83.1250) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/33] time 0.160 (0.157) data 0.082 (0.078) loss_x loss_x 0.8867 (0.6688) acc_x 75.0000 (82.7083) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/33] time 0.159 (0.157) data 0.081 (0.079) loss_x loss_x 0.7666 (0.6939) acc_x 78.1250 (82.1875) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/33] time 0.159 (0.157) data 0.082 (0.079) loss_x loss_x 0.3936 (0.6435) acc_x 84.3750 (82.7500) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [30/33] time 0.155 (0.157) data 0.078 (0.079) loss_x loss_x 0.5942 (0.6413) acc_x 90.6250 (82.7083) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 411
confident_label rate tensor(0.6584, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1064
clean true:1060
clean false:4
clean_rate:0.9962406015037594
noisy true:145
noisy false:407
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 552
epoch [198/200] batch [5/33] time 0.156 (0.156) data 0.079 (0.079) loss_x loss_x 0.4778 (0.6396) acc_x 84.3750 (85.0000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/33] time 0.156 (0.157) data 0.078 (0.079) loss_x loss_x 0.5850 (0.6616) acc_x 81.2500 (82.8125) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/33] time 0.157 (0.157) data 0.079 (0.079) loss_x loss_x 0.5938 (0.6134) acc_x 87.5000 (84.5833) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/33] time 0.156 (0.157) data 0.078 (0.079) loss_x loss_x 0.3955 (0.5647) acc_x 90.6250 (86.0938) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/33] time 0.156 (0.157) data 0.078 (0.079) loss_x loss_x 0.2456 (0.5608) acc_x 93.7500 (86.5000) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/33] time 0.157 (0.157) data 0.079 (0.079) loss_x loss_x 0.8823 (0.6018) acc_x 84.3750 (85.6250) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 436
confident_label rate tensor(0.6454, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1043
clean true:1041
clean false:2
clean_rate:0.9980824544582934
noisy true:139
noisy false:434
after delete: len(clean_dataset) 1043
after delete: len(noisy_dataset) 573
epoch [199/200] batch [5/32] time 0.158 (0.158) data 0.080 (0.080) loss_x loss_x 0.5381 (0.5378) acc_x 87.5000 (86.8750) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/32] time 0.157 (0.158) data 0.079 (0.080) loss_x loss_x 0.5737 (0.6110) acc_x 84.3750 (85.9375) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/32] time 0.156 (0.158) data 0.078 (0.079) loss_x loss_x 0.5347 (0.6198) acc_x 81.2500 (84.7917) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/32] time 0.156 (0.157) data 0.078 (0.079) loss_x loss_x 0.1797 (0.5972) acc_x 96.8750 (85.3125) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/32] time 0.155 (0.157) data 0.077 (0.079) loss_x loss_x 0.4131 (0.5967) acc_x 84.3750 (85.1250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [30/32] time 0.158 (0.157) data 0.080 (0.079) loss_x loss_x 0.3525 (0.5809) acc_x 90.6250 (85.5208) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 412
confident_label rate tensor(0.6553, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1059
clean true:1058
clean false:1
clean_rate:0.9990557129367328
noisy true:146
noisy false:411
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 557
epoch [200/200] batch [5/33] time 0.160 (0.158) data 0.082 (0.080) loss_x loss_x 0.6313 (0.4624) acc_x 81.2500 (86.8750) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/33] time 0.160 (0.159) data 0.082 (0.080) loss_x loss_x 0.6099 (0.5064) acc_x 81.2500 (85.3125) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/33] time 0.159 (0.159) data 0.081 (0.081) loss_x loss_x 0.7305 (0.5574) acc_x 81.2500 (84.5833) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/33] time 0.158 (0.159) data 0.080 (0.081) loss_x loss_x 0.4297 (0.5293) acc_x 90.6250 (85.9375) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/33] time 0.159 (0.159) data 0.081 (0.081) loss_x loss_x 0.6772 (0.5362) acc_x 78.1250 (85.7500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [30/33] time 0.159 (0.159) data 0.080 (0.081) loss_x loss_x 0.7896 (0.5334) acc_x 81.2500 (86.0417) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.125/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,867
* accuracy: 75.8%
* error: 24.2%
* macro_f1: 73.7%
Elapsed: 0:46:14
