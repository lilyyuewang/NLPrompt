***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.25', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.25
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.2395, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 387
clean true:377
clean false:10
clean_rate:0.9741602067183462
noisy true:135
noisy false:1094
after delete: len(clean_dataset) 387
after delete: len(noisy_dataset) 1229
epoch [1/200] batch [5/12] time 0.239 (0.255) data 0.115 (0.113) loss_x loss_x 2.5430 (2.6121) acc_x 50.0000 (45.6250) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/12] time 0.268 (0.237) data 0.141 (0.112) loss_x loss_x 2.3750 (2.5098) acc_x 62.5000 (51.2500) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 993
confident_label rate tensor(0.2847, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 460
clean true:454
clean false:6
clean_rate:0.9869565217391304
noisy true:169
noisy false:987
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1156
epoch [2/200] batch [5/14] time 0.221 (0.210) data 0.098 (0.103) loss_x loss_x 1.3359 (1.5029) acc_x 71.8750 (68.7500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/14] time 0.233 (0.222) data 0.110 (0.107) loss_x loss_x 1.2773 (1.3883) acc_x 62.5000 (68.1250) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 833
confident_label rate tensor(0.3639, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 588
clean true:582
clean false:6
clean_rate:0.9897959183673469
noisy true:201
noisy false:827
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1028
epoch [3/200] batch [5/18] time 0.219 (0.237) data 0.091 (0.111) loss_x loss_x 1.2324 (1.1630) acc_x 68.7500 (73.7500) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [10/18] time 0.237 (0.234) data 0.112 (0.114) loss_x loss_x 1.1064 (1.1192) acc_x 75.0000 (73.7500) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/18] time 0.241 (0.234) data 0.113 (0.112) loss_x loss_x 1.3008 (1.1525) acc_x 65.6250 (72.2917) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 814
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:608
clean false:7
clean_rate:0.9886178861788618
noisy true:194
noisy false:807
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [4/200] batch [5/19] time 0.237 (0.239) data 0.111 (0.112) loss_x loss_x 1.1562 (1.3557) acc_x 65.6250 (66.8750) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/19] time 0.234 (0.237) data 0.109 (0.111) loss_x loss_x 0.8252 (1.2667) acc_x 84.3750 (70.0000) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/19] time 0.231 (0.237) data 0.105 (0.111) loss_x loss_x 0.8843 (1.2188) acc_x 87.5000 (70.6250) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 815
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 604
clean true:595
clean false:9
clean_rate:0.9850993377483444
noisy true:206
noisy false:806
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1012
epoch [5/200] batch [5/18] time 0.247 (0.248) data 0.122 (0.123) loss_x loss_x 0.9448 (1.0027) acc_x 75.0000 (73.7500) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [10/18] time 0.235 (0.239) data 0.106 (0.114) loss_x loss_x 1.2500 (0.9727) acc_x 62.5000 (74.3750) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/18] time 0.236 (0.236) data 0.108 (0.110) loss_x loss_x 1.1875 (1.0032) acc_x 62.5000 (72.9167) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 779
confident_label rate tensor(0.3868, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 625
clean true:617
clean false:8
clean_rate:0.9872
noisy true:220
noisy false:771
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 991
epoch [6/200] batch [5/19] time 0.228 (0.233) data 0.102 (0.107) loss_x loss_x 0.7344 (0.8501) acc_x 87.5000 (78.1250) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/19] time 0.232 (0.231) data 0.108 (0.106) loss_x loss_x 0.9448 (0.9569) acc_x 75.0000 (75.6250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/19] time 0.234 (0.231) data 0.109 (0.105) loss_x loss_x 0.7163 (0.9610) acc_x 84.3750 (74.5833) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 776
confident_label rate tensor(0.3899, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 630
clean true:622
clean false:8
clean_rate:0.9873015873015873
noisy true:218
noisy false:768
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 986
epoch [7/200] batch [5/19] time 0.234 (0.237) data 0.110 (0.112) loss_x loss_x 0.7568 (1.1797) acc_x 78.1250 (71.2500) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/19] time 0.236 (0.238) data 0.110 (0.113) loss_x loss_x 0.7812 (1.0499) acc_x 78.1250 (73.7500) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/19] time 0.260 (0.232) data 0.106 (0.111) loss_x loss_x 0.9917 (1.0818) acc_x 75.0000 (71.8750) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 787
confident_label rate tensor(0.3911, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 632
clean true:624
clean false:8
clean_rate:0.9873417721518988
noisy true:205
noisy false:779
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 984
epoch [8/200] batch [5/19] time 0.232 (0.212) data 0.107 (0.108) loss_x loss_x 0.8872 (0.7365) acc_x 78.1250 (81.2500) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/19] time 0.224 (0.217) data 0.099 (0.103) loss_x loss_x 1.2031 (1.0042) acc_x 68.7500 (74.0625) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/19] time 0.217 (0.219) data 0.093 (0.102) loss_x loss_x 0.9634 (1.0455) acc_x 81.2500 (73.9583) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 763
confident_label rate tensor(0.3861, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 624
clean true:620
clean false:4
clean_rate:0.9935897435897436
noisy true:233
noisy false:759
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 992
epoch [9/200] batch [5/19] time 0.232 (0.236) data 0.109 (0.112) loss_x loss_x 1.1084 (1.0225) acc_x 71.8750 (75.0000) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/19] time 0.234 (0.235) data 0.108 (0.111) loss_x loss_x 0.8188 (1.0629) acc_x 81.2500 (74.6875) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/19] time 0.238 (0.238) data 0.111 (0.114) loss_x loss_x 1.1553 (1.0958) acc_x 62.5000 (72.7083) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 775
confident_label rate tensor(0.3899, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 630
clean true:623
clean false:7
clean_rate:0.9888888888888889
noisy true:218
noisy false:768
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 986
epoch [10/200] batch [5/19] time 0.233 (0.238) data 0.108 (0.112) loss_x loss_x 1.0967 (1.0049) acc_x 71.8750 (75.6250) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/19] time 0.233 (0.237) data 0.108 (0.111) loss_x loss_x 1.1104 (1.0155) acc_x 65.6250 (73.7500) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/19] time 0.231 (0.235) data 0.101 (0.108) loss_x loss_x 0.5654 (0.9366) acc_x 84.3750 (74.7917) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 762
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:631
clean false:9
clean_rate:0.9859375
noisy true:223
noisy false:753
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [11/200] batch [5/20] time 0.227 (0.219) data 0.101 (0.093) loss_x loss_x 1.4453 (0.9835) acc_x 56.2500 (72.5000) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/20] time 0.218 (0.216) data 0.095 (0.091) loss_x loss_x 1.0029 (0.9430) acc_x 84.3750 (75.0000) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/20] time 0.219 (0.218) data 0.096 (0.093) loss_x loss_x 0.9121 (0.9441) acc_x 78.1250 (76.0417) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/20] time 0.228 (0.220) data 0.102 (0.095) loss_x loss_x 1.1436 (0.9669) acc_x 71.8750 (75.0000) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 736
confident_label rate tensor(0.4084, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 660
clean true:652
clean false:8
clean_rate:0.9878787878787879
noisy true:228
noisy false:728
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 956
epoch [12/200] batch [5/20] time 0.216 (0.225) data 0.092 (0.099) loss_x loss_x 1.0996 (0.9269) acc_x 65.6250 (76.2500) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/20] time 0.234 (0.228) data 0.110 (0.102) loss_x loss_x 1.0176 (0.9907) acc_x 75.0000 (74.0625) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/20] time 0.236 (0.228) data 0.112 (0.102) loss_x loss_x 0.9004 (0.9889) acc_x 78.1250 (75.0000) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/20] time 0.186 (0.227) data 0.104 (0.103) loss_x loss_x 1.2705 (1.0358) acc_x 71.8750 (73.9062) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 748
confident_label rate tensor(0.4109, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 664
clean true:658
clean false:6
clean_rate:0.9909638554216867
noisy true:210
noisy false:742
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 952
epoch [13/200] batch [5/20] time 0.227 (0.224) data 0.105 (0.101) loss_x loss_x 1.3682 (1.0870) acc_x 71.8750 (71.8750) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/20] time 0.237 (0.226) data 0.113 (0.103) loss_x loss_x 1.3438 (1.0896) acc_x 75.0000 (72.8125) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/20] time 0.233 (0.227) data 0.110 (0.104) loss_x loss_x 0.9268 (1.0527) acc_x 78.1250 (74.1667) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/20] time 0.220 (0.224) data 0.095 (0.102) loss_x loss_x 0.9087 (1.0423) acc_x 78.1250 (75.0000) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 735
confident_label rate tensor(0.4109, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 664
clean true:656
clean false:8
clean_rate:0.9879518072289156
noisy true:225
noisy false:727
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 952
epoch [14/200] batch [5/20] time 0.235 (0.230) data 0.110 (0.107) loss_x loss_x 1.9258 (1.1687) acc_x 56.2500 (69.3750) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/20] time 0.210 (0.229) data 0.085 (0.108) loss_x loss_x 1.1689 (1.0051) acc_x 71.8750 (72.8125) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/20] time 0.235 (0.234) data 0.112 (0.112) loss_x loss_x 0.7241 (1.0062) acc_x 78.1250 (73.5417) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/20] time 0.258 (0.236) data 0.135 (0.114) loss_x loss_x 1.4014 (1.0313) acc_x 59.3750 (72.8125) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 741
confident_label rate tensor(0.4115, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 665
clean true:659
clean false:6
clean_rate:0.9909774436090225
noisy true:216
noisy false:735
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 951
epoch [15/200] batch [5/20] time 0.222 (0.224) data 0.099 (0.101) loss_x loss_x 0.9702 (1.1152) acc_x 75.0000 (72.5000) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/20] time 0.224 (0.226) data 0.100 (0.102) loss_x loss_x 1.1709 (0.9878) acc_x 68.7500 (74.6875) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/20] time 0.221 (0.224) data 0.099 (0.100) loss_x loss_x 0.5239 (0.9844) acc_x 87.5000 (75.4167) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/20] time 0.216 (0.226) data 0.091 (0.102) loss_x loss_x 0.9946 (0.9587) acc_x 78.1250 (75.9375) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 723
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:662
clean false:6
clean_rate:0.9910179640718563
noisy true:231
noisy false:717
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [16/200] batch [5/20] time 0.216 (0.217) data 0.093 (0.104) loss_x loss_x 0.8418 (0.9121) acc_x 78.1250 (80.0000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/20] time 0.246 (0.226) data 0.121 (0.108) loss_x loss_x 1.2422 (0.9447) acc_x 68.7500 (76.8750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/20] time 0.254 (0.229) data 0.125 (0.108) loss_x loss_x 0.6064 (0.9220) acc_x 78.1250 (76.8750) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/20] time 0.204 (0.228) data 0.127 (0.109) loss_x loss_x 0.9556 (0.9756) acc_x 71.8750 (75.4688) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 714
confident_label rate tensor(0.4152, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 671
clean true:665
clean false:6
clean_rate:0.9910581222056631
noisy true:237
noisy false:708
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 945
epoch [17/200] batch [5/20] time 0.314 (0.226) data 0.186 (0.129) loss_x loss_x 1.1611 (0.9112) acc_x 71.8750 (72.5000) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/20] time 0.232 (0.227) data 0.105 (0.116) loss_x loss_x 0.9966 (0.8774) acc_x 75.0000 (75.3125) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/20] time 0.234 (0.226) data 0.110 (0.111) loss_x loss_x 1.2412 (0.9409) acc_x 65.6250 (74.7917) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/20] time 0.239 (0.228) data 0.113 (0.110) loss_x loss_x 1.1396 (0.9274) acc_x 68.7500 (75.0000) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 719
confident_label rate tensor(0.4264, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 689
clean true:679
clean false:10
clean_rate:0.9854862119013063
noisy true:218
noisy false:709
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 927
epoch [18/200] batch [5/21] time 0.267 (0.261) data 0.143 (0.130) loss_x loss_x 0.5762 (0.7607) acc_x 84.3750 (78.1250) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/21] time 0.225 (0.245) data 0.098 (0.117) loss_x loss_x 0.8823 (0.9266) acc_x 78.1250 (75.9375) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/21] time 0.240 (0.243) data 0.114 (0.116) loss_x loss_x 1.0752 (0.9109) acc_x 68.7500 (75.4167) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/21] time 0.209 (0.239) data 0.106 (0.114) loss_x loss_x 0.5620 (0.8970) acc_x 84.3750 (76.4062) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 713
confident_label rate tensor(0.4270, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 690
clean true:682
clean false:8
clean_rate:0.9884057971014493
noisy true:221
noisy false:705
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 926
epoch [19/200] batch [5/21] time 0.231 (0.208) data 0.104 (0.100) loss_x loss_x 1.1465 (0.9522) acc_x 65.6250 (75.0000) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/21] time 0.237 (0.219) data 0.111 (0.102) loss_x loss_x 0.7446 (0.9377) acc_x 78.1250 (75.6250) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/21] time 0.246 (0.226) data 0.119 (0.106) loss_x loss_x 0.7334 (0.9829) acc_x 78.1250 (73.9583) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/21] time 0.228 (0.228) data 0.102 (0.106) loss_x loss_x 0.7598 (0.9440) acc_x 78.1250 (75.3125) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 726
confident_label rate tensor(0.4146, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 670
clean true:663
clean false:7
clean_rate:0.9895522388059701
noisy true:227
noisy false:719
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 946
epoch [20/200] batch [5/20] time 0.232 (0.215) data 0.108 (0.109) loss_x loss_x 1.0645 (1.2055) acc_x 71.8750 (71.2500) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/20] time 0.233 (0.224) data 0.108 (0.109) loss_x loss_x 0.9678 (1.0616) acc_x 71.8750 (73.1250) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/20] time 0.239 (0.218) data 0.098 (0.106) loss_x loss_x 1.0781 (0.9809) acc_x 71.8750 (75.6250) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/20] time 0.228 (0.221) data 0.103 (0.106) loss_x loss_x 0.7397 (0.9516) acc_x 84.3750 (76.4062) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.4264, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 689
clean true:681
clean false:8
clean_rate:0.988388969521045
noisy true:242
noisy false:685
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 927
epoch [21/200] batch [5/21] time 0.221 (0.218) data 0.095 (0.091) loss_x loss_x 0.7095 (0.8326) acc_x 71.8750 (78.1250) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/21] time 0.179 (0.208) data 0.102 (0.095) loss_x loss_x 0.8188 (0.8555) acc_x 75.0000 (77.1875) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/21] time 0.248 (0.215) data 0.122 (0.099) loss_x loss_x 0.3557 (0.8789) acc_x 96.8750 (78.1250) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/21] time 0.255 (0.221) data 0.130 (0.103) loss_x loss_x 0.7163 (0.8806) acc_x 78.1250 (78.4375) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 716
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 695
clean true:688
clean false:7
clean_rate:0.9899280575539569
noisy true:212
noisy false:709
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 921
epoch [22/200] batch [5/21] time 0.221 (0.236) data 0.092 (0.111) loss_x loss_x 0.6714 (0.7568) acc_x 84.3750 (79.3750) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/21] time 0.165 (0.219) data 0.089 (0.104) loss_x loss_x 0.7471 (0.8202) acc_x 78.1250 (78.7500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/21] time 0.243 (0.220) data 0.119 (0.103) loss_x loss_x 0.9160 (0.8590) acc_x 78.1250 (77.5000) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/21] time 0.238 (0.225) data 0.114 (0.106) loss_x loss_x 0.6548 (0.8753) acc_x 84.3750 (76.8750) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 714
clean true:705
clean false:9
clean_rate:0.9873949579831933
noisy true:226
noisy false:676
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 902
epoch [23/200] batch [5/22] time 0.251 (0.233) data 0.127 (0.109) loss_x loss_x 0.9502 (1.0611) acc_x 75.0000 (71.8750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/22] time 0.218 (0.230) data 0.091 (0.105) loss_x loss_x 0.6528 (0.9679) acc_x 87.5000 (74.6875) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/22] time 0.209 (0.228) data 0.083 (0.103) loss_x loss_x 1.0146 (0.9827) acc_x 65.6250 (72.0833) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/22] time 0.229 (0.230) data 0.104 (0.105) loss_x loss_x 0.5547 (0.9432) acc_x 90.6250 (73.7500) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 681
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 713
clean true:700
clean false:13
clean_rate:0.9817671809256662
noisy true:235
noisy false:668
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 903
epoch [24/200] batch [5/22] time 0.233 (0.241) data 0.108 (0.117) loss_x loss_x 0.7090 (0.7860) acc_x 81.2500 (78.1250) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/22] time 0.237 (0.237) data 0.114 (0.114) loss_x loss_x 0.7021 (0.8744) acc_x 81.2500 (75.9375) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/22] time 0.210 (0.233) data 0.086 (0.110) loss_x loss_x 1.1396 (0.9098) acc_x 65.6250 (74.5833) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [20/22] time 0.206 (0.229) data 0.082 (0.105) loss_x loss_x 0.8130 (0.9097) acc_x 75.0000 (74.8438) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.4468, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 722
clean true:713
clean false:9
clean_rate:0.9875346260387812
noisy true:229
noisy false:665
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 894
epoch [25/200] batch [5/22] time 0.232 (0.234) data 0.108 (0.108) loss_x loss_x 1.1445 (0.9616) acc_x 71.8750 (75.0000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/22] time 0.232 (0.234) data 0.110 (0.108) loss_x loss_x 0.9492 (0.8842) acc_x 71.8750 (76.5625) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/22] time 0.235 (0.234) data 0.110 (0.108) loss_x loss_x 0.8159 (0.8930) acc_x 75.0000 (76.4583) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/22] time 0.219 (0.233) data 0.092 (0.107) loss_x loss_x 1.0312 (0.8440) acc_x 71.8750 (78.2812) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 670
confident_label rate tensor(0.4511, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 729
clean true:719
clean false:10
clean_rate:0.9862825788751715
noisy true:227
noisy false:660
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 887
epoch [26/200] batch [5/22] time 0.237 (0.246) data 0.112 (0.121) loss_x loss_x 1.0430 (0.9762) acc_x 71.8750 (72.5000) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/22] time 0.225 (0.239) data 0.096 (0.113) loss_x loss_x 0.6572 (0.9106) acc_x 81.2500 (76.2500) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/22] time 0.217 (0.234) data 0.092 (0.108) loss_x loss_x 0.9966 (0.9082) acc_x 71.8750 (76.4583) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/22] time 0.221 (0.232) data 0.091 (0.106) loss_x loss_x 1.1338 (0.8925) acc_x 75.0000 (76.0938) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 726
clean true:719
clean false:7
clean_rate:0.990358126721763
noisy true:238
noisy false:652
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 890
epoch [27/200] batch [5/22] time 0.218 (0.230) data 0.094 (0.105) loss_x loss_x 1.1406 (0.9620) acc_x 71.8750 (75.0000) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/22] time 0.234 (0.230) data 0.108 (0.105) loss_x loss_x 0.9019 (0.9458) acc_x 78.1250 (76.2500) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/22] time 0.232 (0.232) data 0.110 (0.107) loss_x loss_x 0.8682 (0.9114) acc_x 81.2500 (77.5000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/22] time 0.231 (0.231) data 0.103 (0.106) loss_x loss_x 0.7744 (0.8868) acc_x 78.1250 (77.8125) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 717
clean true:711
clean false:6
clean_rate:0.9916317991631799
noisy true:223
noisy false:676
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 899
epoch [28/200] batch [5/22] time 0.232 (0.236) data 0.108 (0.109) loss_x loss_x 0.4922 (0.6264) acc_x 84.3750 (84.3750) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/22] time 0.221 (0.235) data 0.097 (0.109) loss_x loss_x 0.7300 (0.6801) acc_x 81.2500 (81.5625) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/22] time 0.235 (0.230) data 0.109 (0.104) loss_x loss_x 1.2705 (0.7555) acc_x 59.3750 (79.1667) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/22] time 0.221 (0.231) data 0.094 (0.106) loss_x loss_x 0.6270 (0.8034) acc_x 81.2500 (79.2188) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 656
confident_label rate tensor(0.4524, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 731
clean true:726
clean false:5
clean_rate:0.9931600547195623
noisy true:234
noisy false:651
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 885
epoch [29/200] batch [5/22] time 0.250 (0.220) data 0.125 (0.094) loss_x loss_x 0.4839 (0.8056) acc_x 81.2500 (78.1250) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/22] time 0.225 (0.230) data 0.103 (0.104) loss_x loss_x 0.9004 (0.9919) acc_x 75.0000 (72.5000) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/22] time 0.218 (0.229) data 0.093 (0.103) loss_x loss_x 1.0068 (0.9634) acc_x 78.1250 (74.5833) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/22] time 0.243 (0.235) data 0.118 (0.109) loss_x loss_x 0.8247 (0.9477) acc_x 78.1250 (74.8438) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.4579, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 740
clean true:732
clean false:8
clean_rate:0.9891891891891892
noisy true:248
noisy false:628
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 876
epoch [30/200] batch [5/23] time 0.248 (0.226) data 0.124 (0.099) loss_x loss_x 0.6284 (0.7450) acc_x 84.3750 (80.6250) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/23] time 0.232 (0.227) data 0.106 (0.102) loss_x loss_x 1.2285 (0.8473) acc_x 71.8750 (77.8125) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/23] time 0.225 (0.230) data 0.100 (0.104) loss_x loss_x 1.4473 (0.8735) acc_x 56.2500 (76.8750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/23] time 0.224 (0.230) data 0.100 (0.104) loss_x loss_x 0.9375 (0.8836) acc_x 75.0000 (76.2500) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 726
clean true:720
clean false:6
clean_rate:0.9917355371900827
noisy true:232
noisy false:658
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 890
epoch [31/200] batch [5/22] time 0.232 (0.236) data 0.108 (0.113) loss_x loss_x 1.0635 (0.8492) acc_x 62.5000 (78.1250) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/22] time 0.260 (0.238) data 0.135 (0.114) loss_x loss_x 0.9136 (0.8473) acc_x 75.0000 (79.0625) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/22] time 0.216 (0.235) data 0.093 (0.111) loss_x loss_x 0.8330 (0.8518) acc_x 78.1250 (78.5417) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/22] time 0.224 (0.233) data 0.100 (0.109) loss_x loss_x 0.7153 (0.8634) acc_x 87.5000 (77.6562) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 665
confident_label rate tensor(0.4517, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 730
clean true:721
clean false:9
clean_rate:0.9876712328767123
noisy true:230
noisy false:656
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 886
epoch [32/200] batch [5/22] time 0.234 (0.247) data 0.109 (0.123) loss_x loss_x 0.8608 (0.9842) acc_x 78.1250 (71.8750) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/22] time 0.189 (0.241) data 0.110 (0.122) loss_x loss_x 0.7793 (0.8237) acc_x 78.1250 (76.8750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/22] time 0.217 (0.235) data 0.094 (0.115) loss_x loss_x 1.0332 (0.8587) acc_x 71.8750 (75.8333) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/22] time 0.230 (0.234) data 0.105 (0.113) loss_x loss_x 0.8633 (0.8579) acc_x 81.2500 (76.7188) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.4821, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 779
clean true:771
clean false:8
clean_rate:0.9897304236200257
noisy true:239
noisy false:598
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 837
epoch [33/200] batch [5/24] time 0.235 (0.229) data 0.110 (0.098) loss_x loss_x 1.0986 (0.8679) acc_x 56.2500 (78.7500) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/24] time 0.217 (0.226) data 0.094 (0.099) loss_x loss_x 0.9849 (0.8552) acc_x 78.1250 (79.3750) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/24] time 0.219 (0.226) data 0.092 (0.099) loss_x loss_x 0.9243 (0.8442) acc_x 71.8750 (78.3333) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/24] time 0.229 (0.227) data 0.104 (0.101) loss_x loss_x 0.8105 (0.8302) acc_x 75.0000 (78.2812) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 660
confident_label rate tensor(0.4517, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 730
clean true:721
clean false:9
clean_rate:0.9876712328767123
noisy true:235
noisy false:651
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 886
epoch [34/200] batch [5/22] time 0.238 (0.220) data 0.113 (0.113) loss_x loss_x 0.8403 (0.8692) acc_x 75.0000 (72.5000) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/22] time 0.240 (0.226) data 0.114 (0.110) loss_x loss_x 0.6987 (0.9037) acc_x 84.3750 (73.1250) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/22] time 0.223 (0.227) data 0.096 (0.108) loss_x loss_x 0.7500 (0.9795) acc_x 75.0000 (70.8333) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/22] time 0.223 (0.228) data 0.098 (0.107) loss_x loss_x 0.6118 (0.9149) acc_x 84.3750 (73.7500) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.4722, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 763
clean true:754
clean false:9
clean_rate:0.9882044560943644
noisy true:237
noisy false:616
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 853
epoch [35/200] batch [5/23] time 0.234 (0.247) data 0.108 (0.122) loss_x loss_x 0.9082 (0.9627) acc_x 75.0000 (73.1250) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/23] time 0.258 (0.234) data 0.133 (0.110) loss_x loss_x 0.5684 (0.9572) acc_x 81.2500 (74.3750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/23] time 0.214 (0.232) data 0.090 (0.108) loss_x loss_x 1.0273 (0.9305) acc_x 75.0000 (74.5833) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/23] time 0.188 (0.231) data 0.112 (0.109) loss_x loss_x 0.9937 (0.9161) acc_x 71.8750 (74.5312) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.4623, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 747
clean true:737
clean false:10
clean_rate:0.9866131191432396
noisy true:234
noisy false:635
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 869
epoch [36/200] batch [5/23] time 0.230 (0.221) data 0.105 (0.096) loss_x loss_x 1.0322 (0.9029) acc_x 68.7500 (75.6250) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/23] time 0.243 (0.222) data 0.120 (0.099) loss_x loss_x 0.7603 (0.8873) acc_x 71.8750 (76.5625) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/23] time 0.243 (0.224) data 0.118 (0.100) loss_x loss_x 0.6187 (0.8842) acc_x 84.3750 (77.2917) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/23] time 0.209 (0.224) data 0.087 (0.100) loss_x loss_x 0.8584 (0.8696) acc_x 84.3750 (77.5000) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.4641, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 750
clean true:741
clean false:9
clean_rate:0.988
noisy true:240
noisy false:626
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 866
epoch [37/200] batch [5/23] time 0.239 (0.239) data 0.109 (0.112) loss_x loss_x 0.9189 (0.8322) acc_x 75.0000 (78.7500) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/23] time 0.231 (0.236) data 0.109 (0.110) loss_x loss_x 0.6299 (0.7959) acc_x 78.1250 (80.0000) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/23] time 0.227 (0.232) data 0.106 (0.107) loss_x loss_x 1.2988 (0.8684) acc_x 71.8750 (78.7500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/23] time 0.227 (0.232) data 0.103 (0.107) loss_x loss_x 0.5771 (0.8705) acc_x 81.2500 (78.7500) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.4616, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 746
clean true:734
clean false:12
clean_rate:0.9839142091152815
noisy true:236
noisy false:634
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 870
epoch [38/200] batch [5/23] time 0.233 (0.234) data 0.110 (0.109) loss_x loss_x 0.8101 (0.8087) acc_x 78.1250 (76.2500) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/23] time 0.232 (0.235) data 0.108 (0.110) loss_x loss_x 0.4939 (0.8029) acc_x 87.5000 (76.8750) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/23] time 0.235 (0.235) data 0.109 (0.110) loss_x loss_x 0.6851 (0.8048) acc_x 84.3750 (77.9167) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/23] time 0.232 (0.235) data 0.105 (0.110) loss_x loss_x 1.4307 (0.8424) acc_x 62.5000 (77.0312) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.4660, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 753
clean true:743
clean false:10
clean_rate:0.9867197875166003
noisy true:255
noisy false:608
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 863
epoch [39/200] batch [5/23] time 0.232 (0.232) data 0.108 (0.106) loss_x loss_x 0.8062 (0.8223) acc_x 78.1250 (78.7500) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [10/23] time 0.223 (0.229) data 0.097 (0.103) loss_x loss_x 0.5020 (0.7919) acc_x 81.2500 (78.4375) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/23] time 0.230 (0.231) data 0.104 (0.106) loss_x loss_x 1.3965 (0.8954) acc_x 62.5000 (76.8750) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/23] time 0.228 (0.231) data 0.106 (0.106) loss_x loss_x 0.5781 (0.8494) acc_x 78.1250 (77.8125) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 629
confident_label rate tensor(0.4672, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 755
clean true:743
clean false:12
clean_rate:0.9841059602649007
noisy true:244
noisy false:617
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 861
epoch [40/200] batch [5/23] time 0.226 (0.221) data 0.104 (0.107) loss_x loss_x 1.4971 (0.8689) acc_x 71.8750 (80.6250) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/23] time 0.233 (0.226) data 0.109 (0.107) loss_x loss_x 0.5732 (0.8058) acc_x 90.6250 (81.5625) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/23] time 0.228 (0.230) data 0.105 (0.109) loss_x loss_x 0.7588 (0.8010) acc_x 84.3750 (81.6667) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/23] time 0.228 (0.230) data 0.105 (0.109) loss_x loss_x 1.0957 (0.7981) acc_x 78.1250 (81.0938) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 650
confident_label rate tensor(0.4629, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 748
clean true:740
clean false:8
clean_rate:0.9893048128342246
noisy true:226
noisy false:642
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 868
epoch [41/200] batch [5/23] time 0.236 (0.237) data 0.109 (0.113) loss_x loss_x 0.4062 (0.8667) acc_x 87.5000 (78.7500) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [10/23] time 0.237 (0.236) data 0.107 (0.111) loss_x loss_x 0.7334 (0.8275) acc_x 78.1250 (80.0000) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/23] time 0.210 (0.231) data 0.085 (0.106) loss_x loss_x 0.4194 (0.8125) acc_x 93.7500 (81.0417) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/23] time 0.251 (0.230) data 0.126 (0.106) loss_x loss_x 0.5547 (0.8164) acc_x 81.2500 (80.6250) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.4722, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 763
clean true:756
clean false:7
clean_rate:0.9908256880733946
noisy true:242
noisy false:611
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 853
epoch [42/200] batch [5/23] time 0.243 (0.244) data 0.116 (0.118) loss_x loss_x 0.7959 (0.8468) acc_x 75.0000 (75.6250) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/23] time 0.236 (0.238) data 0.111 (0.113) loss_x loss_x 0.9106 (0.8760) acc_x 65.6250 (74.6875) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/23] time 0.238 (0.230) data 0.111 (0.109) loss_x loss_x 0.7666 (0.8705) acc_x 81.2500 (76.0417) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/23] time 0.262 (0.232) data 0.140 (0.110) loss_x loss_x 0.9111 (0.8772) acc_x 71.8750 (75.6250) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.4629, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 748
clean true:738
clean false:10
clean_rate:0.9866310160427807
noisy true:254
noisy false:614
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 868
epoch [43/200] batch [5/23] time 0.214 (0.203) data 0.086 (0.105) loss_x loss_x 0.7158 (0.8522) acc_x 78.1250 (73.7500) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/23] time 0.233 (0.212) data 0.105 (0.100) loss_x loss_x 0.8506 (0.8499) acc_x 78.1250 (76.2500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/23] time 0.233 (0.219) data 0.108 (0.102) loss_x loss_x 1.1895 (0.8537) acc_x 68.7500 (76.2500) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/23] time 0.209 (0.220) data 0.083 (0.101) loss_x loss_x 1.2002 (0.8741) acc_x 68.7500 (76.0938) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 758
clean true:746
clean false:12
clean_rate:0.9841688654353562
noisy true:252
noisy false:606
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 858
epoch [44/200] batch [5/23] time 0.220 (0.221) data 0.093 (0.102) loss_x loss_x 0.8613 (0.7308) acc_x 84.3750 (81.2500) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/23] time 0.209 (0.219) data 0.083 (0.097) loss_x loss_x 1.0361 (0.7627) acc_x 78.1250 (80.3125) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/23] time 0.228 (0.224) data 0.105 (0.101) loss_x loss_x 1.2275 (0.8112) acc_x 62.5000 (77.9167) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/23] time 0.228 (0.226) data 0.100 (0.102) loss_x loss_x 0.6953 (0.8092) acc_x 81.2500 (78.4375) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.4882, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 789
clean true:778
clean false:11
clean_rate:0.9860583016476553
noisy true:247
noisy false:580
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 827
epoch [45/200] batch [5/24] time 0.274 (0.217) data 0.148 (0.104) loss_x loss_x 0.6489 (0.6675) acc_x 81.2500 (80.0000) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/24] time 0.235 (0.219) data 0.106 (0.099) loss_x loss_x 0.4758 (0.7395) acc_x 87.5000 (80.0000) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/24] time 0.221 (0.221) data 0.096 (0.099) loss_x loss_x 1.5430 (0.7943) acc_x 56.2500 (78.7500) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/24] time 0.231 (0.226) data 0.107 (0.103) loss_x loss_x 0.9199 (0.7909) acc_x 75.0000 (79.2188) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.4889, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 790
clean true:779
clean false:11
clean_rate:0.9860759493670886
noisy true:259
noisy false:567
after delete: len(clean_dataset) 790
after delete: len(noisy_dataset) 826
epoch [46/200] batch [5/24] time 0.231 (0.241) data 0.110 (0.118) loss_x loss_x 1.1445 (0.7977) acc_x 78.1250 (78.1250) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [10/24] time 0.245 (0.249) data 0.122 (0.126) loss_x loss_x 0.4807 (0.8393) acc_x 87.5000 (79.3750) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/24] time 0.226 (0.244) data 0.105 (0.120) loss_x loss_x 1.1162 (0.8275) acc_x 71.8750 (80.2083) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/24] time 0.209 (0.243) data 0.085 (0.119) loss_x loss_x 0.7134 (0.8172) acc_x 84.3750 (80.0000) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 615
confident_label rate tensor(0.4728, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 764
clean true:753
clean false:11
clean_rate:0.9856020942408377
noisy true:248
noisy false:604
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 852
epoch [47/200] batch [5/23] time 0.206 (0.232) data 0.082 (0.102) loss_x loss_x 0.6812 (0.9021) acc_x 84.3750 (75.6250) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/23] time 0.231 (0.227) data 0.107 (0.100) loss_x loss_x 0.4888 (0.8574) acc_x 87.5000 (79.0625) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/23] time 0.216 (0.224) data 0.092 (0.098) loss_x loss_x 0.8374 (0.8797) acc_x 75.0000 (77.0833) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/23] time 0.215 (0.224) data 0.090 (0.099) loss_x loss_x 0.8467 (0.8757) acc_x 78.1250 (77.5000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 612
confident_label rate tensor(0.4752, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 768
clean true:756
clean false:12
clean_rate:0.984375
noisy true:248
noisy false:600
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 848
epoch [48/200] batch [5/24] time 0.237 (0.232) data 0.111 (0.116) loss_x loss_x 0.5352 (0.8992) acc_x 81.2500 (77.5000) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/24] time 0.238 (0.234) data 0.114 (0.114) loss_x loss_x 0.5332 (0.7990) acc_x 84.3750 (78.4375) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/24] time 0.228 (0.232) data 0.102 (0.111) loss_x loss_x 1.2188 (0.8226) acc_x 65.6250 (77.9167) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/24] time 0.230 (0.229) data 0.107 (0.107) loss_x loss_x 1.0078 (0.8057) acc_x 71.8750 (78.9062) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 600
confident_label rate tensor(0.4808, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 777
clean true:770
clean false:7
clean_rate:0.990990990990991
noisy true:246
noisy false:593
after delete: len(clean_dataset) 777
after delete: len(noisy_dataset) 839
epoch [49/200] batch [5/24] time 0.210 (0.223) data 0.083 (0.098) loss_x loss_x 1.1826 (1.0512) acc_x 87.5000 (74.3750) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [10/24] time 0.240 (0.225) data 0.117 (0.100) loss_x loss_x 0.5811 (0.8863) acc_x 87.5000 (78.7500) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/24] time 0.238 (0.223) data 0.114 (0.102) loss_x loss_x 1.3320 (0.8979) acc_x 65.6250 (77.7083) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/24] time 0.250 (0.230) data 0.124 (0.109) loss_x loss_x 0.8979 (0.8756) acc_x 84.3750 (78.2812) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 601
confident_label rate tensor(0.4839, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 782
clean true:772
clean false:10
clean_rate:0.9872122762148338
noisy true:243
noisy false:591
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 834
epoch [50/200] batch [5/24] time 0.236 (0.234) data 0.109 (0.109) loss_x loss_x 0.5474 (0.8365) acc_x 84.3750 (81.2500) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/24] time 0.220 (0.231) data 0.093 (0.106) loss_x loss_x 1.1924 (0.9113) acc_x 78.1250 (79.3750) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/24] time 0.240 (0.228) data 0.113 (0.103) loss_x loss_x 0.5210 (0.8282) acc_x 87.5000 (79.7917) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/24] time 0.221 (0.229) data 0.094 (0.104) loss_x loss_x 0.6069 (0.8037) acc_x 84.3750 (80.3125) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.4740, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 766
clean true:756
clean false:10
clean_rate:0.9869451697127938
noisy true:242
noisy false:608
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 850
epoch [51/200] batch [5/23] time 0.173 (0.212) data 0.095 (0.113) loss_x loss_x 0.6001 (0.8354) acc_x 87.5000 (80.6250) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/23] time 0.236 (0.221) data 0.113 (0.110) loss_x loss_x 0.6899 (0.7359) acc_x 81.2500 (82.1875) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/23] time 0.245 (0.225) data 0.120 (0.109) loss_x loss_x 0.6348 (0.7706) acc_x 81.2500 (81.0417) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/23] time 0.235 (0.227) data 0.109 (0.109) loss_x loss_x 0.6411 (0.7386) acc_x 81.2500 (81.7188) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 601
confident_label rate tensor(0.4790, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 774
clean true:761
clean false:13
clean_rate:0.9832041343669251
noisy true:254
noisy false:588
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 842
epoch [52/200] batch [5/24] time 0.230 (0.233) data 0.106 (0.109) loss_x loss_x 0.6655 (0.8979) acc_x 81.2500 (75.6250) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/24] time 0.237 (0.242) data 0.112 (0.117) loss_x loss_x 0.3540 (0.8565) acc_x 87.5000 (78.4375) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/24] time 0.233 (0.241) data 0.109 (0.116) loss_x loss_x 0.5171 (0.8019) acc_x 78.1250 (79.1667) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [20/24] time 0.235 (0.239) data 0.110 (0.114) loss_x loss_x 0.6826 (0.8049) acc_x 78.1250 (78.9062) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 577
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 803
clean true:793
clean false:10
clean_rate:0.987546699875467
noisy true:246
noisy false:567
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 813
epoch [53/200] batch [5/25] time 0.231 (0.241) data 0.108 (0.118) loss_x loss_x 0.8315 (0.8367) acc_x 78.1250 (80.6250) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/25] time 0.185 (0.233) data 0.108 (0.114) loss_x loss_x 0.4277 (0.7699) acc_x 87.5000 (81.5625) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/25] time 0.219 (0.232) data 0.095 (0.110) loss_x loss_x 0.9507 (0.7745) acc_x 75.0000 (80.6250) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [20/25] time 0.243 (0.231) data 0.120 (0.109) loss_x loss_x 0.9863 (0.7720) acc_x 81.2500 (80.6250) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [25/25] time 0.221 (0.228) data 0.096 (0.106) loss_x loss_x 0.6733 (0.7903) acc_x 87.5000 (80.1250) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 818
clean true:810
clean false:8
clean_rate:0.9902200488997555
noisy true:243
noisy false:555
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 798
epoch [54/200] batch [5/25] time 0.236 (0.233) data 0.111 (0.108) loss_x loss_x 0.6123 (0.6669) acc_x 84.3750 (83.1250) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/25] time 0.234 (0.233) data 0.107 (0.107) loss_x loss_x 0.9243 (0.8085) acc_x 81.2500 (79.6875) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/25] time 0.265 (0.237) data 0.139 (0.111) loss_x loss_x 0.6099 (0.7934) acc_x 84.3750 (80.8333) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/25] time 0.156 (0.222) data 0.078 (0.105) loss_x loss_x 0.8916 (0.8153) acc_x 78.1250 (79.8438) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [25/25] time 0.250 (0.226) data 0.124 (0.106) loss_x loss_x 1.0908 (0.8186) acc_x 71.8750 (79.0000) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 803
clean true:793
clean false:10
clean_rate:0.987546699875467
noisy true:248
noisy false:565
after delete: len(clean_dataset) 803
after delete: len(noisy_dataset) 813
epoch [55/200] batch [5/25] time 0.232 (0.233) data 0.106 (0.108) loss_x loss_x 0.6138 (0.6797) acc_x 90.6250 (81.8750) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [10/25] time 0.187 (0.224) data 0.109 (0.103) loss_x loss_x 0.8125 (0.7693) acc_x 75.0000 (79.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/25] time 0.228 (0.224) data 0.106 (0.104) loss_x loss_x 0.8398 (0.7281) acc_x 81.2500 (80.6250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/25] time 0.231 (0.226) data 0.108 (0.106) loss_x loss_x 0.4741 (0.7684) acc_x 84.3750 (79.3750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [25/25] time 0.233 (0.228) data 0.109 (0.107) loss_x loss_x 1.4062 (0.7656) acc_x 68.7500 (79.6250) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.4926, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 796
clean true:787
clean false:9
clean_rate:0.9886934673366834
noisy true:254
noisy false:566
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 820
epoch [56/200] batch [5/24] time 0.254 (0.227) data 0.130 (0.112) loss_x loss_x 0.7290 (0.7911) acc_x 78.1250 (78.1250) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [10/24] time 0.239 (0.234) data 0.112 (0.118) loss_x loss_x 0.9482 (0.7566) acc_x 71.8750 (80.0000) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [15/24] time 0.212 (0.230) data 0.086 (0.112) loss_x loss_x 0.5229 (0.7676) acc_x 87.5000 (79.1667) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/24] time 0.221 (0.229) data 0.095 (0.109) loss_x loss_x 0.5806 (0.7482) acc_x 81.2500 (78.9062) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 600
confident_label rate tensor(0.4845, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 783
clean true:770
clean false:13
clean_rate:0.9833971902937421
noisy true:246
noisy false:587
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 833
epoch [57/200] batch [5/24] time 0.290 (0.224) data 0.166 (0.127) loss_x loss_x 0.4197 (0.5782) acc_x 84.3750 (85.0000) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/24] time 0.235 (0.228) data 0.110 (0.118) loss_x loss_x 0.4834 (0.6649) acc_x 87.5000 (82.8125) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/24] time 0.231 (0.231) data 0.105 (0.115) loss_x loss_x 0.6162 (0.6501) acc_x 84.3750 (82.7083) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [20/24] time 0.219 (0.229) data 0.095 (0.111) loss_x loss_x 0.8286 (0.7235) acc_x 84.3750 (81.2500) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 809
clean true:796
clean false:13
clean_rate:0.9839307787391842
noisy true:254
noisy false:553
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 807
epoch [58/200] batch [5/25] time 0.234 (0.263) data 0.108 (0.127) loss_x loss_x 0.5171 (0.6290) acc_x 90.6250 (85.6250) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/25] time 0.219 (0.245) data 0.094 (0.115) loss_x loss_x 0.6440 (0.6831) acc_x 81.2500 (82.5000) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/25] time 0.222 (0.237) data 0.096 (0.109) loss_x loss_x 1.1719 (0.7270) acc_x 68.7500 (81.4583) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [20/25] time 0.223 (0.235) data 0.098 (0.108) loss_x loss_x 0.8267 (0.7393) acc_x 84.3750 (81.2500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [25/25] time 0.195 (0.232) data 0.118 (0.109) loss_x loss_x 0.2959 (0.7272) acc_x 90.6250 (81.5000) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 807
clean true:795
clean false:12
clean_rate:0.9851301115241635
noisy true:249
noisy false:560
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 809
epoch [59/200] batch [5/25] time 0.257 (0.226) data 0.134 (0.112) loss_x loss_x 0.9839 (0.8038) acc_x 71.8750 (76.8750) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [10/25] time 0.226 (0.225) data 0.102 (0.106) loss_x loss_x 1.0488 (0.7449) acc_x 68.7500 (78.1250) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/25] time 0.227 (0.223) data 0.103 (0.102) loss_x loss_x 0.3677 (0.7272) acc_x 90.6250 (78.7500) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/25] time 0.234 (0.224) data 0.108 (0.102) loss_x loss_x 0.9263 (0.7339) acc_x 78.1250 (79.3750) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [25/25] time 0.245 (0.228) data 0.121 (0.105) loss_x loss_x 0.7651 (0.7400) acc_x 81.2500 (79.6250) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.5050, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 816
clean true:805
clean false:11
clean_rate:0.9865196078431373
noisy true:254
noisy false:546
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 800
epoch [60/200] batch [5/25] time 0.237 (0.243) data 0.111 (0.109) loss_x loss_x 0.8599 (0.8295) acc_x 78.1250 (79.3750) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/25] time 0.221 (0.237) data 0.095 (0.107) loss_x loss_x 0.6328 (0.8137) acc_x 84.3750 (80.3125) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/25] time 0.223 (0.234) data 0.098 (0.106) loss_x loss_x 1.0146 (0.8652) acc_x 78.1250 (78.7500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/25] time 0.245 (0.235) data 0.116 (0.107) loss_x loss_x 0.9316 (0.8319) acc_x 81.2500 (79.3750) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [25/25] time 0.222 (0.230) data 0.080 (0.106) loss_x loss_x 0.7222 (0.8192) acc_x 84.3750 (79.3750) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 812
clean true:803
clean false:9
clean_rate:0.9889162561576355
noisy true:261
noisy false:543
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 804
epoch [61/200] batch [5/25] time 0.233 (0.236) data 0.111 (0.118) loss_x loss_x 0.6816 (0.7370) acc_x 78.1250 (79.3750) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/25] time 0.209 (0.234) data 0.085 (0.113) loss_x loss_x 0.3831 (0.6353) acc_x 87.5000 (81.2500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/25] time 0.227 (0.229) data 0.103 (0.107) loss_x loss_x 0.5518 (0.6667) acc_x 81.2500 (81.4583) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/25] time 0.226 (0.228) data 0.102 (0.105) loss_x loss_x 0.6079 (0.6393) acc_x 87.5000 (82.3438) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/25] time 0.233 (0.231) data 0.109 (0.108) loss_x loss_x 0.7930 (0.6610) acc_x 81.2500 (82.0000) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 810
clean true:801
clean false:9
clean_rate:0.9888888888888889
noisy true:243
noisy false:563
after delete: len(clean_dataset) 810
after delete: len(noisy_dataset) 806
epoch [62/200] batch [5/25] time 0.234 (0.245) data 0.109 (0.119) loss_x loss_x 0.9399 (0.8090) acc_x 84.3750 (82.5000) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/25] time 0.234 (0.239) data 0.108 (0.114) loss_x loss_x 0.3958 (0.6743) acc_x 93.7500 (84.3750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/25] time 0.216 (0.236) data 0.092 (0.111) loss_x loss_x 0.5698 (0.6699) acc_x 87.5000 (85.0000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/25] time 0.236 (0.235) data 0.111 (0.109) loss_x loss_x 0.3118 (0.6384) acc_x 90.6250 (85.1562) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [25/25] time 0.219 (0.233) data 0.095 (0.108) loss_x loss_x 0.4241 (0.6492) acc_x 93.7500 (84.7500) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 555
confident_label rate tensor(0.5105, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 825
clean true:814
clean false:11
clean_rate:0.9866666666666667
noisy true:247
noisy false:544
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 791
epoch [63/200] batch [5/25] time 0.210 (0.222) data 0.087 (0.099) loss_x loss_x 0.8955 (0.9697) acc_x 78.1250 (74.3750) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/25] time 0.211 (0.221) data 0.086 (0.097) loss_x loss_x 0.6499 (0.8677) acc_x 84.3750 (77.1875) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/25] time 0.217 (0.224) data 0.091 (0.100) loss_x loss_x 0.4282 (0.8664) acc_x 87.5000 (76.0417) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/25] time 0.224 (0.224) data 0.101 (0.100) loss_x loss_x 0.9727 (0.9080) acc_x 68.7500 (75.3125) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/25] time 0.223 (0.225) data 0.101 (0.100) loss_x loss_x 0.6294 (0.8817) acc_x 84.3750 (76.6250) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.5111, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 826
clean true:817
clean false:9
clean_rate:0.9891041162227603
noisy true:246
noisy false:544
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 790
epoch [64/200] batch [5/25] time 0.231 (0.223) data 0.108 (0.097) loss_x loss_x 0.7900 (0.8494) acc_x 81.2500 (76.8750) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/25] time 0.225 (0.224) data 0.101 (0.098) loss_x loss_x 0.6133 (0.8394) acc_x 87.5000 (79.0625) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/25] time 0.210 (0.223) data 0.085 (0.097) loss_x loss_x 0.3855 (0.7949) acc_x 90.6250 (79.5833) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/25] time 0.171 (0.223) data 0.094 (0.100) loss_x loss_x 1.0391 (0.7953) acc_x 68.7500 (79.6875) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [25/25] time 0.213 (0.218) data 0.089 (0.098) loss_x loss_x 0.5923 (0.7909) acc_x 84.3750 (79.6250) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 554
confident_label rate tensor(0.5068, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 819
clean true:807
clean false:12
clean_rate:0.9853479853479854
noisy true:255
noisy false:542
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 797
epoch [65/200] batch [5/25] time 0.262 (0.215) data 0.109 (0.104) loss_x loss_x 0.6606 (0.6898) acc_x 81.2500 (84.3750) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/25] time 0.233 (0.221) data 0.108 (0.103) loss_x loss_x 0.8979 (0.7108) acc_x 75.0000 (80.6250) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/25] time 0.238 (0.223) data 0.109 (0.103) loss_x loss_x 0.6562 (0.7465) acc_x 84.3750 (80.0000) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/25] time 0.226 (0.224) data 0.103 (0.103) loss_x loss_x 0.5317 (0.7484) acc_x 81.2500 (80.0000) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [25/25] time 0.252 (0.226) data 0.127 (0.104) loss_x loss_x 0.7646 (0.7413) acc_x 78.1250 (79.6250) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.5118, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 827
clean true:817
clean false:10
clean_rate:0.9879081015719468
noisy true:265
noisy false:524
after delete: len(clean_dataset) 827
after delete: len(noisy_dataset) 789
epoch [66/200] batch [5/25] time 0.235 (0.236) data 0.109 (0.109) loss_x loss_x 0.5371 (0.6635) acc_x 87.5000 (83.7500) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/25] time 0.237 (0.238) data 0.113 (0.112) loss_x loss_x 1.2715 (0.6914) acc_x 62.5000 (80.9375) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/25] time 0.234 (0.233) data 0.107 (0.108) loss_x loss_x 0.4841 (0.7279) acc_x 87.5000 (79.5833) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/25] time 0.226 (0.229) data 0.100 (0.107) loss_x loss_x 0.8613 (0.7518) acc_x 78.1250 (79.2188) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [25/25] time 0.215 (0.229) data 0.091 (0.107) loss_x loss_x 0.9072 (0.7410) acc_x 81.2500 (80.0000) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 568
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 799
clean true:788
clean false:11
clean_rate:0.986232790988736
noisy true:260
noisy false:557
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 817
epoch [67/200] batch [5/24] time 0.242 (0.228) data 0.118 (0.105) loss_x loss_x 0.8853 (0.8412) acc_x 81.2500 (77.5000) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/24] time 0.252 (0.231) data 0.129 (0.107) loss_x loss_x 0.4856 (0.8051) acc_x 84.3750 (79.6875) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/24] time 0.210 (0.226) data 0.086 (0.102) loss_x loss_x 0.7993 (0.7462) acc_x 81.2500 (80.0000) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/24] time 0.218 (0.226) data 0.094 (0.102) loss_x loss_x 1.0459 (0.7779) acc_x 71.8750 (79.2188) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.5204, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 841
clean true:825
clean false:16
clean_rate:0.9809750297265161
noisy true:242
noisy false:533
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 775
epoch [68/200] batch [5/26] time 0.211 (0.233) data 0.087 (0.109) loss_x loss_x 1.2734 (1.0340) acc_x 75.0000 (78.1250) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [10/26] time 0.219 (0.228) data 0.092 (0.103) loss_x loss_x 0.8472 (0.9048) acc_x 78.1250 (78.4375) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/26] time 0.241 (0.230) data 0.116 (0.106) loss_x loss_x 0.5332 (0.8271) acc_x 93.7500 (79.1667) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/26] time 0.232 (0.231) data 0.108 (0.107) loss_x loss_x 0.3325 (0.7745) acc_x 90.6250 (80.0000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [25/26] time 0.234 (0.233) data 0.108 (0.108) loss_x loss_x 1.0732 (0.8122) acc_x 78.1250 (78.5000) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.5155, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 833
clean true:822
clean false:11
clean_rate:0.9867947178871549
noisy true:250
noisy false:533
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 783
epoch [69/200] batch [5/26] time 0.238 (0.246) data 0.114 (0.121) loss_x loss_x 0.9292 (0.8578) acc_x 78.1250 (78.1250) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/26] time 0.236 (0.237) data 0.110 (0.113) loss_x loss_x 0.3430 (0.8020) acc_x 87.5000 (80.3125) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/26] time 0.224 (0.236) data 0.099 (0.111) loss_x loss_x 0.8013 (0.7473) acc_x 75.0000 (81.0417) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/26] time 0.228 (0.233) data 0.100 (0.108) loss_x loss_x 0.8726 (0.7574) acc_x 84.3750 (80.4688) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/26] time 0.237 (0.229) data 0.082 (0.106) loss_x loss_x 0.8149 (0.7924) acc_x 78.1250 (79.7500) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.5093, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 823
clean true:809
clean false:14
clean_rate:0.982989064398542
noisy true:236
noisy false:557
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 793
epoch [70/200] batch [5/25] time 0.226 (0.203) data 0.103 (0.098) loss_x loss_x 0.2629 (0.7554) acc_x 87.5000 (80.0000) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [10/25] time 0.236 (0.219) data 0.110 (0.103) loss_x loss_x 0.4019 (0.7087) acc_x 87.5000 (81.2500) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/25] time 0.243 (0.226) data 0.120 (0.107) loss_x loss_x 0.6226 (0.6959) acc_x 81.2500 (81.6667) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/25] time 0.213 (0.226) data 0.086 (0.105) loss_x loss_x 0.7432 (0.7393) acc_x 78.1250 (80.4688) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [25/25] time 0.231 (0.225) data 0.104 (0.103) loss_x loss_x 0.5161 (0.7429) acc_x 84.3750 (80.1250) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 809
clean true:796
clean false:13
clean_rate:0.9839307787391842
noisy true:245
noisy false:562
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 807
epoch [71/200] batch [5/25] time 0.228 (0.230) data 0.104 (0.105) loss_x loss_x 0.5869 (0.6993) acc_x 84.3750 (81.8750) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/25] time 0.181 (0.219) data 0.103 (0.103) loss_x loss_x 0.7427 (0.6940) acc_x 78.1250 (81.2500) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/25] time 0.220 (0.223) data 0.099 (0.103) loss_x loss_x 0.7842 (0.6953) acc_x 75.0000 (81.4583) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/25] time 0.221 (0.223) data 0.098 (0.102) loss_x loss_x 1.4834 (0.7597) acc_x 71.8750 (81.4062) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/25] time 0.234 (0.224) data 0.111 (0.103) loss_x loss_x 0.8438 (0.7519) acc_x 75.0000 (81.0000) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 554
confident_label rate tensor(0.5161, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 834
clean true:819
clean false:15
clean_rate:0.9820143884892086
noisy true:243
noisy false:539
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 782
epoch [72/200] batch [5/26] time 0.215 (0.229) data 0.092 (0.105) loss_x loss_x 1.0889 (0.8424) acc_x 62.5000 (75.0000) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [10/26] time 0.208 (0.220) data 0.084 (0.101) loss_x loss_x 0.7607 (0.7639) acc_x 81.2500 (78.7500) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [15/26] time 0.207 (0.217) data 0.084 (0.096) loss_x loss_x 0.8335 (0.7916) acc_x 68.7500 (78.1250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/26] time 0.237 (0.221) data 0.108 (0.099) loss_x loss_x 0.7402 (0.7779) acc_x 84.3750 (78.5938) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/26] time 0.232 (0.225) data 0.104 (0.102) loss_x loss_x 0.9580 (0.7746) acc_x 75.0000 (78.8750) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 813
clean true:801
clean false:12
clean_rate:0.985239852398524
noisy true:255
noisy false:548
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 803
epoch [73/200] batch [5/25] time 0.213 (0.220) data 0.087 (0.094) loss_x loss_x 1.0254 (0.9059) acc_x 75.0000 (73.1250) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [10/25] time 0.232 (0.227) data 0.109 (0.102) loss_x loss_x 0.6943 (0.7697) acc_x 84.3750 (78.1250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/25] time 0.207 (0.227) data 0.083 (0.102) loss_x loss_x 0.8081 (0.8358) acc_x 78.1250 (77.2917) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/25] time 0.169 (0.222) data 0.092 (0.101) loss_x loss_x 0.6221 (0.8353) acc_x 78.1250 (77.8125) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [25/25] time 0.221 (0.225) data 0.098 (0.104) loss_x loss_x 1.4219 (0.8400) acc_x 65.6250 (78.1250) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.5130, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 829
clean true:818
clean false:11
clean_rate:0.9867310012062727
noisy true:249
noisy false:538
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 787
epoch [74/200] batch [5/25] time 0.230 (0.245) data 0.106 (0.122) loss_x loss_x 0.5552 (0.5618) acc_x 84.3750 (84.3750) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/25] time 0.216 (0.237) data 0.093 (0.114) loss_x loss_x 0.3567 (0.5195) acc_x 90.6250 (85.0000) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/25] time 0.221 (0.234) data 0.098 (0.111) loss_x loss_x 1.2676 (0.6701) acc_x 62.5000 (80.6250) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/25] time 0.275 (0.231) data 0.130 (0.110) loss_x loss_x 0.7969 (0.7040) acc_x 78.1250 (80.4688) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [25/25] time 0.237 (0.230) data 0.110 (0.108) loss_x loss_x 1.0449 (0.6998) acc_x 62.5000 (80.5000) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 523
confident_label rate tensor(0.5223, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 844
clean true:826
clean false:18
clean_rate:0.9786729857819905
noisy true:267
noisy false:505
after delete: len(clean_dataset) 844
after delete: len(noisy_dataset) 772
epoch [75/200] batch [5/26] time 0.231 (0.230) data 0.105 (0.105) loss_x loss_x 0.5435 (0.6961) acc_x 84.3750 (84.3750) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/26] time 0.239 (0.233) data 0.113 (0.108) loss_x loss_x 0.3796 (0.6625) acc_x 90.6250 (85.0000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/26] time 0.235 (0.232) data 0.109 (0.107) loss_x loss_x 0.7563 (0.7132) acc_x 84.3750 (82.9167) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/26] time 0.232 (0.232) data 0.107 (0.107) loss_x loss_x 0.6987 (0.7069) acc_x 81.2500 (82.5000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [25/26] time 0.243 (0.233) data 0.118 (0.108) loss_x loss_x 0.9385 (0.7096) acc_x 71.8750 (82.2500) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.5093, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 823
clean true:811
clean false:12
clean_rate:0.9854191980558931
noisy true:254
noisy false:539
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 793
epoch [76/200] batch [5/25] time 0.233 (0.248) data 0.109 (0.123) loss_x loss_x 0.9722 (0.5340) acc_x 78.1250 (86.8750) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/25] time 0.234 (0.243) data 0.109 (0.119) loss_x loss_x 0.5601 (0.5443) acc_x 84.3750 (86.8750) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/25] time 0.238 (0.240) data 0.110 (0.116) loss_x loss_x 0.8311 (0.5709) acc_x 78.1250 (86.0417) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/25] time 0.214 (0.234) data 0.090 (0.110) loss_x loss_x 0.8936 (0.5925) acc_x 71.8750 (85.1562) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [25/25] time 0.232 (0.234) data 0.108 (0.109) loss_x loss_x 0.7544 (0.6363) acc_x 71.8750 (83.1250) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.5272, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 852
clean true:837
clean false:15
clean_rate:0.9823943661971831
noisy true:235
noisy false:529
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 764
epoch [77/200] batch [5/26] time 0.229 (0.232) data 0.102 (0.105) loss_x loss_x 0.8545 (0.6716) acc_x 75.0000 (82.5000) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [10/26] time 0.189 (0.227) data 0.091 (0.104) loss_x loss_x 0.6367 (0.7061) acc_x 84.3750 (81.8750) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/26] time 0.216 (0.220) data 0.091 (0.101) loss_x loss_x 0.3838 (0.7783) acc_x 84.3750 (79.7917) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/26] time 0.226 (0.222) data 0.102 (0.102) loss_x loss_x 0.6919 (0.7551) acc_x 78.1250 (80.0000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [25/26] time 0.220 (0.224) data 0.092 (0.103) loss_x loss_x 0.6689 (0.7559) acc_x 90.6250 (80.0000) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:795
clean false:13
clean_rate:0.9839108910891089
noisy true:255
noisy false:553
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [78/200] batch [5/25] time 0.225 (0.254) data 0.102 (0.130) loss_x loss_x 0.8198 (0.6991) acc_x 78.1250 (83.7500) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/25] time 0.258 (0.243) data 0.133 (0.119) loss_x loss_x 0.8716 (0.6960) acc_x 81.2500 (81.8750) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/25] time 0.216 (0.234) data 0.091 (0.112) loss_x loss_x 0.4187 (0.7133) acc_x 90.6250 (80.8333) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/25] time 0.219 (0.229) data 0.093 (0.107) loss_x loss_x 0.9990 (0.7845) acc_x 78.1250 (78.2812) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [25/25] time 0.233 (0.229) data 0.106 (0.107) loss_x loss_x 1.0049 (0.7842) acc_x 84.3750 (79.1250) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.5105, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 825
clean true:810
clean false:15
clean_rate:0.9818181818181818
noisy true:254
noisy false:537
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 791
epoch [79/200] batch [5/25] time 0.237 (0.221) data 0.110 (0.110) loss_x loss_x 0.4741 (0.6916) acc_x 90.6250 (83.7500) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/25] time 0.265 (0.229) data 0.142 (0.111) loss_x loss_x 0.6602 (0.7070) acc_x 84.3750 (83.1250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/25] time 0.209 (0.225) data 0.083 (0.105) loss_x loss_x 0.6470 (0.7091) acc_x 81.2500 (81.8750) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/25] time 0.213 (0.224) data 0.086 (0.103) loss_x loss_x 0.6763 (0.7091) acc_x 84.3750 (81.8750) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [25/25] time 0.206 (0.224) data 0.082 (0.101) loss_x loss_x 1.0605 (0.6969) acc_x 84.3750 (82.6250) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.5217, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 843
clean true:833
clean false:10
clean_rate:0.9881376037959668
noisy true:240
noisy false:533
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 773
epoch [80/200] batch [5/26] time 0.229 (0.234) data 0.101 (0.106) loss_x loss_x 0.6060 (0.6507) acc_x 87.5000 (82.5000) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/26] time 0.239 (0.233) data 0.109 (0.106) loss_x loss_x 0.2896 (0.6045) acc_x 93.7500 (85.6250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [15/26] time 0.220 (0.228) data 0.096 (0.105) loss_x loss_x 0.2725 (0.6164) acc_x 93.7500 (84.3750) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/26] time 0.242 (0.228) data 0.113 (0.105) loss_x loss_x 1.0156 (0.6616) acc_x 68.7500 (82.5000) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/26] time 0.217 (0.229) data 0.091 (0.105) loss_x loss_x 0.4924 (0.6636) acc_x 84.3750 (81.7500) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.5155, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 833
clean true:821
clean false:12
clean_rate:0.985594237695078
noisy true:261
noisy false:522
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 783
epoch [81/200] batch [5/26] time 0.229 (0.231) data 0.106 (0.107) loss_x loss_x 1.1631 (0.7788) acc_x 68.7500 (80.6250) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/26] time 0.233 (0.230) data 0.107 (0.105) loss_x loss_x 0.4526 (0.7734) acc_x 84.3750 (79.6875) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/26] time 0.235 (0.229) data 0.110 (0.104) loss_x loss_x 0.7124 (0.7578) acc_x 81.2500 (80.2083) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/26] time 0.217 (0.231) data 0.090 (0.106) loss_x loss_x 0.4336 (0.7556) acc_x 90.6250 (80.4688) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [25/26] time 0.228 (0.230) data 0.103 (0.105) loss_x loss_x 0.6670 (0.7715) acc_x 87.5000 (80.3750) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.5217, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 843
clean true:830
clean false:13
clean_rate:0.9845788849347569
noisy true:254
noisy false:519
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 773
epoch [82/200] batch [5/26] time 0.262 (0.241) data 0.136 (0.117) loss_x loss_x 0.5752 (0.5837) acc_x 90.6250 (82.5000) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/26] time 0.242 (0.233) data 0.118 (0.116) loss_x loss_x 1.0000 (0.6700) acc_x 78.1250 (82.5000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [15/26] time 0.243 (0.231) data 0.116 (0.112) loss_x loss_x 0.8281 (0.6979) acc_x 84.3750 (80.8333) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/26] time 0.223 (0.232) data 0.099 (0.111) loss_x loss_x 0.6895 (0.7197) acc_x 84.3750 (80.7812) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [25/26] time 0.232 (0.225) data 0.105 (0.108) loss_x loss_x 1.2334 (0.7247) acc_x 65.6250 (81.3750) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.5161, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 834
clean true:822
clean false:12
clean_rate:0.9856115107913669
noisy true:264
noisy false:518
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 782
epoch [83/200] batch [5/26] time 0.234 (0.235) data 0.107 (0.110) loss_x loss_x 1.1826 (0.7396) acc_x 75.0000 (83.1250) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [10/26] time 0.238 (0.238) data 0.113 (0.113) loss_x loss_x 0.1906 (0.6704) acc_x 93.7500 (84.0625) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/26] time 0.244 (0.235) data 0.118 (0.110) loss_x loss_x 1.3047 (0.7348) acc_x 62.5000 (81.2500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/26] time 0.235 (0.235) data 0.110 (0.110) loss_x loss_x 0.5405 (0.7085) acc_x 90.6250 (82.3438) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/26] time 0.218 (0.235) data 0.093 (0.109) loss_x loss_x 0.7974 (0.7233) acc_x 78.1250 (81.7500) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.5142, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 831
clean true:818
clean false:13
clean_rate:0.9843561973525873
noisy true:266
noisy false:519
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 785
epoch [84/200] batch [5/25] time 0.218 (0.217) data 0.091 (0.091) loss_x loss_x 0.8081 (0.7535) acc_x 78.1250 (80.6250) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/25] time 0.216 (0.220) data 0.089 (0.095) loss_x loss_x 0.4067 (0.6900) acc_x 87.5000 (81.5625) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/25] time 0.214 (0.216) data 0.091 (0.094) loss_x loss_x 0.9971 (0.7562) acc_x 78.1250 (80.8333) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/25] time 0.217 (0.218) data 0.093 (0.096) loss_x loss_x 0.3455 (0.7550) acc_x 93.7500 (81.5625) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [25/25] time 0.231 (0.220) data 0.104 (0.097) loss_x loss_x 1.0264 (0.7473) acc_x 71.8750 (81.1250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.5241, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 847
clean true:834
clean false:13
clean_rate:0.9846517119244392
noisy true:246
noisy false:523
after delete: len(clean_dataset) 847
after delete: len(noisy_dataset) 769
epoch [85/200] batch [5/26] time 0.239 (0.245) data 0.115 (0.121) loss_x loss_x 0.4070 (0.6156) acc_x 93.7500 (85.6250) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/26] time 0.234 (0.241) data 0.108 (0.116) loss_x loss_x 1.0283 (0.6839) acc_x 78.1250 (83.1250) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [15/26] time 0.232 (0.238) data 0.108 (0.113) loss_x loss_x 0.8076 (0.6800) acc_x 81.2500 (82.9167) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [20/26] time 0.229 (0.234) data 0.107 (0.114) loss_x loss_x 0.8203 (0.6839) acc_x 78.1250 (82.5000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [25/26] time 0.235 (0.233) data 0.111 (0.112) loss_x loss_x 0.4734 (0.6868) acc_x 87.5000 (82.2500) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 555
confident_label rate tensor(0.5111, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 826
clean true:810
clean false:16
clean_rate:0.9806295399515739
noisy true:251
noisy false:539
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 790
epoch [86/200] batch [5/25] time 0.274 (0.237) data 0.126 (0.127) loss_x loss_x 0.4651 (0.6161) acc_x 84.3750 (83.1250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [10/25] time 0.181 (0.228) data 0.104 (0.115) loss_x loss_x 1.0479 (0.7317) acc_x 71.8750 (79.3750) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [15/25] time 0.235 (0.226) data 0.110 (0.109) loss_x loss_x 0.3733 (0.6872) acc_x 87.5000 (81.4583) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/25] time 0.218 (0.226) data 0.093 (0.107) loss_x loss_x 0.6270 (0.6782) acc_x 78.1250 (81.5625) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [25/25] time 0.232 (0.226) data 0.108 (0.106) loss_x loss_x 0.9673 (0.6511) acc_x 71.8750 (82.5000) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.5322, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 860
clean true:846
clean false:14
clean_rate:0.9837209302325581
noisy true:258
noisy false:498
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 756
epoch [87/200] batch [5/26] time 0.234 (0.254) data 0.110 (0.128) loss_x loss_x 0.6665 (0.6450) acc_x 81.2500 (83.1250) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/26] time 0.231 (0.241) data 0.106 (0.116) loss_x loss_x 0.6846 (0.6567) acc_x 81.2500 (82.5000) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [15/26] time 0.264 (0.239) data 0.139 (0.114) loss_x loss_x 0.4868 (0.6386) acc_x 81.2500 (81.6667) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/26] time 0.213 (0.232) data 0.089 (0.108) loss_x loss_x 0.7832 (0.6714) acc_x 87.5000 (80.9375) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [25/26] time 0.184 (0.231) data 0.108 (0.108) loss_x loss_x 0.7603 (0.7032) acc_x 84.3750 (80.6250) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.5291, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 855
clean true:843
clean false:12
clean_rate:0.9859649122807017
noisy true:254
noisy false:507
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 761
epoch [88/200] batch [5/26] time 0.229 (0.242) data 0.105 (0.117) loss_x loss_x 0.7646 (0.6960) acc_x 81.2500 (83.7500) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/26] time 0.253 (0.237) data 0.109 (0.116) loss_x loss_x 0.9033 (0.7162) acc_x 81.2500 (83.7500) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [15/26] time 0.233 (0.237) data 0.108 (0.114) loss_x loss_x 0.5532 (0.6884) acc_x 84.3750 (82.7083) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/26] time 0.233 (0.234) data 0.107 (0.111) loss_x loss_x 0.4958 (0.7118) acc_x 81.2500 (82.0312) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [25/26] time 0.254 (0.234) data 0.131 (0.111) loss_x loss_x 0.7773 (0.7431) acc_x 75.0000 (81.0000) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.5155, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 833
clean true:823
clean false:10
clean_rate:0.9879951980792316
noisy true:240
noisy false:543
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 783
epoch [89/200] batch [5/26] time 0.218 (0.239) data 0.092 (0.114) loss_x loss_x 1.0059 (0.8094) acc_x 68.7500 (77.5000) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/26] time 0.222 (0.236) data 0.098 (0.111) loss_x loss_x 0.2756 (0.7328) acc_x 96.8750 (80.6250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [15/26] time 0.235 (0.234) data 0.107 (0.110) loss_x loss_x 0.8169 (0.7405) acc_x 78.1250 (80.4167) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/26] time 0.251 (0.235) data 0.123 (0.110) loss_x loss_x 0.5996 (0.7652) acc_x 81.2500 (79.3750) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [25/26] time 0.229 (0.236) data 0.105 (0.111) loss_x loss_x 0.8223 (0.7364) acc_x 84.3750 (80.5000) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.5266, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 851
clean true:839
clean false:12
clean_rate:0.9858989424206815
noisy true:245
noisy false:520
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 765
epoch [90/200] batch [5/26] time 0.217 (0.223) data 0.091 (0.098) loss_x loss_x 0.7261 (0.6206) acc_x 81.2500 (84.3750) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [10/26] time 0.288 (0.229) data 0.165 (0.104) loss_x loss_x 0.6069 (0.6520) acc_x 81.2500 (83.4375) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [15/26] time 0.220 (0.225) data 0.097 (0.101) loss_x loss_x 0.5952 (0.6431) acc_x 84.3750 (83.3333) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [20/26] time 0.241 (0.228) data 0.116 (0.103) loss_x loss_x 0.9307 (0.6744) acc_x 75.0000 (81.7188) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [25/26] time 0.299 (0.230) data 0.175 (0.107) loss_x loss_x 0.5146 (0.6710) acc_x 84.3750 (81.3750) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 554
confident_label rate tensor(0.5161, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 834
clean true:815
clean false:19
clean_rate:0.9772182254196643
noisy true:247
noisy false:535
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 782
epoch [91/200] batch [5/26] time 0.233 (0.231) data 0.109 (0.107) loss_x loss_x 0.8081 (0.7660) acc_x 81.2500 (82.5000) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [10/26] time 0.233 (0.234) data 0.111 (0.110) loss_x loss_x 0.9448 (0.7373) acc_x 75.0000 (82.5000) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/26] time 0.229 (0.233) data 0.105 (0.109) loss_x loss_x 1.1240 (0.7853) acc_x 68.7500 (80.6250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/26] time 0.237 (0.234) data 0.108 (0.109) loss_x loss_x 0.3101 (0.8034) acc_x 96.8750 (80.6250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [25/26] time 0.266 (0.230) data 0.143 (0.110) loss_x loss_x 0.7651 (0.7677) acc_x 78.1250 (81.1250) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.5291, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 855
clean true:843
clean false:12
clean_rate:0.9859649122807017
noisy true:254
noisy false:507
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 761
epoch [92/200] batch [5/26] time 0.229 (0.224) data 0.102 (0.100) loss_x loss_x 1.0166 (0.6967) acc_x 71.8750 (81.8750) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [10/26] time 0.239 (0.227) data 0.114 (0.102) loss_x loss_x 0.8374 (0.6698) acc_x 78.1250 (82.5000) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [15/26] time 0.185 (0.224) data 0.108 (0.102) loss_x loss_x 0.7139 (0.6344) acc_x 78.1250 (83.9583) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/26] time 0.221 (0.225) data 0.096 (0.103) loss_x loss_x 0.6240 (0.6602) acc_x 78.1250 (83.4375) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [25/26] time 0.217 (0.226) data 0.095 (0.103) loss_x loss_x 0.5874 (0.6979) acc_x 78.1250 (82.2500) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.5334, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 862
clean true:848
clean false:14
clean_rate:0.9837587006960556
noisy true:236
noisy false:518
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 754
epoch [93/200] batch [5/26] time 0.218 (0.240) data 0.092 (0.114) loss_x loss_x 0.8701 (0.8858) acc_x 78.1250 (76.8750) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/26] time 0.241 (0.220) data 0.090 (0.103) loss_x loss_x 0.7197 (0.8850) acc_x 81.2500 (75.3125) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [15/26] time 0.219 (0.223) data 0.095 (0.103) loss_x loss_x 0.5127 (0.8276) acc_x 87.5000 (77.7083) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/26] time 0.218 (0.223) data 0.096 (0.102) loss_x loss_x 0.5786 (0.7825) acc_x 81.2500 (78.9062) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [25/26] time 0.231 (0.226) data 0.107 (0.104) loss_x loss_x 0.8003 (0.7608) acc_x 71.8750 (79.3750) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.5248, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 848
clean true:835
clean false:13
clean_rate:0.9846698113207547
noisy true:259
noisy false:509
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 768
epoch [94/200] batch [5/26] time 0.226 (0.226) data 0.103 (0.101) loss_x loss_x 0.5459 (0.6742) acc_x 84.3750 (83.1250) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [10/26] time 0.219 (0.224) data 0.094 (0.099) loss_x loss_x 0.6094 (0.6715) acc_x 87.5000 (82.1875) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [15/26] time 0.227 (0.226) data 0.099 (0.100) loss_x loss_x 0.6748 (0.6776) acc_x 84.3750 (82.9167) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/26] time 0.240 (0.226) data 0.114 (0.101) loss_x loss_x 1.0273 (0.7291) acc_x 75.0000 (81.4062) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [25/26] time 0.232 (0.225) data 0.110 (0.100) loss_x loss_x 0.4832 (0.7118) acc_x 87.5000 (81.6250) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.5272, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 852
clean true:840
clean false:12
clean_rate:0.9859154929577465
noisy true:266
noisy false:498
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 764
epoch [95/200] batch [5/26] time 0.222 (0.233) data 0.097 (0.108) loss_x loss_x 0.4731 (0.6424) acc_x 87.5000 (84.3750) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/26] time 0.221 (0.231) data 0.095 (0.107) loss_x loss_x 0.6719 (0.6743) acc_x 78.1250 (84.0625) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [15/26] time 0.235 (0.230) data 0.111 (0.106) loss_x loss_x 0.2761 (0.6573) acc_x 96.8750 (84.7917) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/26] time 0.219 (0.230) data 0.093 (0.105) loss_x loss_x 0.6836 (0.7250) acc_x 84.3750 (82.9688) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [25/26] time 0.167 (0.228) data 0.091 (0.104) loss_x loss_x 0.6899 (0.7040) acc_x 81.2500 (82.7500) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 540
confident_label rate tensor(0.5198, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 840
clean true:825
clean false:15
clean_rate:0.9821428571428571
noisy true:251
noisy false:525
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 776
epoch [96/200] batch [5/26] time 0.237 (0.221) data 0.114 (0.096) loss_x loss_x 0.5874 (0.6870) acc_x 81.2500 (82.5000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/26] time 0.244 (0.221) data 0.121 (0.096) loss_x loss_x 0.7388 (0.6693) acc_x 84.3750 (82.5000) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/26] time 0.226 (0.218) data 0.101 (0.098) loss_x loss_x 0.7300 (0.6466) acc_x 78.1250 (83.5417) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [20/26] time 0.210 (0.222) data 0.083 (0.101) loss_x loss_x 1.0430 (0.6757) acc_x 71.8750 (82.3438) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [25/26] time 0.217 (0.226) data 0.094 (0.104) loss_x loss_x 0.5747 (0.6548) acc_x 81.2500 (82.2500) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.5396, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 872
clean true:855
clean false:17
clean_rate:0.9805045871559633
noisy true:251
noisy false:493
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 744
epoch [97/200] batch [5/27] time 0.235 (0.228) data 0.108 (0.103) loss_x loss_x 0.8887 (0.6183) acc_x 78.1250 (84.3750) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/27] time 0.234 (0.229) data 0.111 (0.105) loss_x loss_x 0.6064 (0.6305) acc_x 78.1250 (83.4375) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [15/27] time 0.230 (0.220) data 0.102 (0.102) loss_x loss_x 1.7295 (0.7134) acc_x 75.0000 (82.5000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/27] time 0.217 (0.224) data 0.093 (0.104) loss_x loss_x 0.5947 (0.6964) acc_x 87.5000 (83.4375) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [25/27] time 0.208 (0.223) data 0.084 (0.101) loss_x loss_x 0.8174 (0.7197) acc_x 75.0000 (82.7500) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 507
confident_label rate tensor(0.5421, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 876
clean true:858
clean false:18
clean_rate:0.9794520547945206
noisy true:251
noisy false:489
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 740
epoch [98/200] batch [5/27] time 0.239 (0.213) data 0.115 (0.099) loss_x loss_x 0.2947 (0.5327) acc_x 93.7500 (85.6250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [10/27] time 0.234 (0.222) data 0.110 (0.102) loss_x loss_x 0.8979 (0.6960) acc_x 78.1250 (81.5625) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [15/27] time 0.243 (0.230) data 0.117 (0.108) loss_x loss_x 0.5801 (0.7357) acc_x 84.3750 (80.0000) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/27] time 0.234 (0.233) data 0.108 (0.111) loss_x loss_x 0.6924 (0.7420) acc_x 75.0000 (79.2188) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [25/27] time 0.233 (0.234) data 0.107 (0.111) loss_x loss_x 0.5586 (0.7352) acc_x 93.7500 (79.8750) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.5198, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 840
clean true:827
clean false:13
clean_rate:0.9845238095238096
noisy true:253
noisy false:523
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 776
epoch [99/200] batch [5/26] time 0.214 (0.224) data 0.090 (0.099) loss_x loss_x 0.7632 (0.5678) acc_x 84.3750 (88.1250) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/26] time 0.205 (0.219) data 0.082 (0.094) loss_x loss_x 0.5332 (0.5698) acc_x 87.5000 (87.5000) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [15/26] time 0.228 (0.219) data 0.102 (0.095) loss_x loss_x 0.5547 (0.5945) acc_x 84.3750 (86.4583) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/26] time 0.218 (0.222) data 0.094 (0.097) loss_x loss_x 0.6753 (0.5822) acc_x 78.1250 (86.2500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [25/26] time 0.268 (0.226) data 0.144 (0.101) loss_x loss_x 0.4714 (0.5714) acc_x 90.6250 (86.5000) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.5204, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 841
clean true:828
clean false:13
clean_rate:0.9845422116527943
noisy true:266
noisy false:509
all clean rate:  [0.9741602067183462, 0.9869565217391304, 0.9897959183673469, 0.9886178861788618, 0.9850993377483444, 0.9872, 0.9873015873015873, 0.9873417721518988, 0.9935897435897436, 0.9888888888888889, 0.9859375, 0.9878787878787879, 0.9909638554216867, 0.9879518072289156, 0.9909774436090225, 0.9910179640718563, 0.9910581222056631, 0.9854862119013063, 0.9884057971014493, 0.9895522388059701, 0.988388969521045, 0.9899280575539569, 0.9873949579831933, 0.9817671809256662, 0.9875346260387812, 0.9862825788751715, 0.990358126721763, 0.9916317991631799, 0.9931600547195623, 0.9891891891891892, 0.9917355371900827, 0.9876712328767123, 0.9897304236200257, 0.9876712328767123, 0.9882044560943644, 0.9866131191432396, 0.988, 0.9839142091152815, 0.9867197875166003, 0.9841059602649007, 0.9893048128342246, 0.9908256880733946, 0.9866310160427807, 0.9841688654353562, 0.9860583016476553, 0.9860759493670886, 0.9856020942408377, 0.984375, 0.990990990990991, 0.9872122762148338, 0.9869451697127938, 0.9832041343669251, 0.987546699875467, 0.9902200488997555, 0.987546699875467, 0.9886934673366834, 0.9833971902937421, 0.9839307787391842, 0.9851301115241635, 0.9865196078431373, 0.9889162561576355, 0.9888888888888889, 0.9866666666666667, 0.9891041162227603, 0.9853479853479854, 0.9879081015719468, 0.986232790988736, 0.9809750297265161, 0.9867947178871549, 0.982989064398542, 0.9839307787391842, 0.9820143884892086, 0.985239852398524, 0.9867310012062727, 0.9786729857819905, 0.9854191980558931, 0.9823943661971831, 0.9839108910891089, 0.9818181818181818, 0.9881376037959668, 0.985594237695078, 0.9845788849347569, 0.9856115107913669, 0.9843561973525873, 0.9846517119244392, 0.9806295399515739, 0.9837209302325581, 0.9859649122807017, 0.9879951980792316, 0.9858989424206815, 0.9772182254196643, 0.9859649122807017, 0.9837587006960556, 0.9846698113207547, 0.9859154929577465, 0.9821428571428571, 0.9805045871559633, 0.9794520547945206, 0.9845238095238096, 0.9845422116527943]
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 775
epoch [100/200] batch [5/26] time 0.232 (0.233) data 0.109 (0.108) loss_x loss_x 0.4905 (0.5708) acc_x 84.3750 (85.0000) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [10/26] time 0.248 (0.235) data 0.121 (0.110) loss_x loss_x 1.1074 (0.6201) acc_x 75.0000 (83.7500) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [15/26] time 0.217 (0.232) data 0.095 (0.108) loss_x loss_x 0.5771 (0.6620) acc_x 84.3750 (82.5000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/26] time 0.240 (0.233) data 0.116 (0.108) loss_x loss_x 0.6865 (0.6413) acc_x 81.2500 (83.1250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [25/26] time 0.229 (0.230) data 0.103 (0.105) loss_x loss_x 0.4358 (0.6413) acc_x 90.6250 (83.0000) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.5322, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 860
clean true:849
clean false:11
clean_rate:0.9872093023255814
noisy true:251
noisy false:505
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 756
epoch [101/200] batch [5/26] time 0.221 (0.228) data 0.097 (0.102) loss_x loss_x 0.3362 (0.6320) acc_x 90.6250 (83.1250) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/26] time 0.253 (0.229) data 0.125 (0.103) loss_x loss_x 0.6045 (0.6481) acc_x 84.3750 (83.7500) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [15/26] time 0.224 (0.231) data 0.096 (0.105) loss_x loss_x 0.7510 (0.6571) acc_x 81.2500 (84.7917) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/26] time 0.200 (0.227) data 0.122 (0.106) loss_x loss_x 0.6582 (0.6586) acc_x 90.6250 (84.8438) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [25/26] time 0.248 (0.234) data 0.124 (0.109) loss_x loss_x 0.7622 (0.6545) acc_x 78.1250 (84.7500) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.5334, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 862
clean true:850
clean false:12
clean_rate:0.9860788863109049
noisy true:250
noisy false:504
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 754
epoch [102/200] batch [5/26] time 0.222 (0.221) data 0.097 (0.100) loss_x loss_x 1.4102 (0.9442) acc_x 68.7500 (78.7500) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/26] time 0.219 (0.219) data 0.093 (0.096) loss_x loss_x 0.6587 (0.8156) acc_x 87.5000 (82.1875) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [15/26] time 0.235 (0.222) data 0.112 (0.099) loss_x loss_x 0.9077 (0.8305) acc_x 78.1250 (81.4583) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/26] time 0.232 (0.223) data 0.107 (0.100) loss_x loss_x 0.5298 (0.7471) acc_x 87.5000 (82.8125) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [25/26] time 0.184 (0.221) data 0.108 (0.101) loss_x loss_x 0.6035 (0.7288) acc_x 84.3750 (83.0000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.5235, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 846
clean true:831
clean false:15
clean_rate:0.9822695035460993
noisy true:259
noisy false:511
after delete: len(clean_dataset) 846
after delete: len(noisy_dataset) 770
epoch [103/200] batch [5/26] time 0.240 (0.241) data 0.116 (0.118) loss_x loss_x 0.7642 (0.7108) acc_x 78.1250 (82.5000) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/26] time 0.234 (0.238) data 0.111 (0.114) loss_x loss_x 0.4092 (0.5929) acc_x 90.6250 (85.6250) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [15/26] time 0.222 (0.234) data 0.095 (0.110) loss_x loss_x 0.7139 (0.6240) acc_x 78.1250 (83.7500) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [20/26] time 0.248 (0.233) data 0.122 (0.109) loss_x loss_x 1.1650 (0.6440) acc_x 65.6250 (83.5938) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [25/26] time 0.223 (0.232) data 0.099 (0.108) loss_x loss_x 0.7656 (0.6481) acc_x 75.0000 (83.7500) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.5155, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 833
clean true:822
clean false:11
clean_rate:0.9867947178871549
noisy true:245
noisy false:538
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 783
epoch [104/200] batch [5/26] time 0.206 (0.211) data 0.084 (0.104) loss_x loss_x 0.3525 (0.5521) acc_x 90.6250 (88.1250) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/26] time 0.227 (0.229) data 0.103 (0.113) loss_x loss_x 0.9312 (0.7011) acc_x 71.8750 (83.7500) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [15/26] time 0.225 (0.234) data 0.100 (0.114) loss_x loss_x 1.3125 (0.7685) acc_x 78.1250 (82.7083) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/26] time 0.232 (0.232) data 0.108 (0.112) loss_x loss_x 0.4507 (0.7741) acc_x 90.6250 (81.5625) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [25/26] time 0.248 (0.234) data 0.124 (0.112) loss_x loss_x 0.7866 (0.7494) acc_x 75.0000 (81.3750) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.5285, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 854
clean true:840
clean false:14
clean_rate:0.9836065573770492
noisy true:259
noisy false:503
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 762
epoch [105/200] batch [5/26] time 0.237 (0.230) data 0.112 (0.105) loss_x loss_x 0.6792 (0.5929) acc_x 78.1250 (82.5000) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/26] time 0.217 (0.228) data 0.091 (0.102) loss_x loss_x 0.6118 (0.6498) acc_x 90.6250 (84.6875) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [15/26] time 0.237 (0.224) data 0.111 (0.099) loss_x loss_x 0.7427 (0.6270) acc_x 81.2500 (83.9583) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/26] time 0.230 (0.223) data 0.104 (0.098) loss_x loss_x 0.5098 (0.6334) acc_x 87.5000 (82.8125) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [25/26] time 0.224 (0.222) data 0.099 (0.097) loss_x loss_x 0.4939 (0.6386) acc_x 90.6250 (82.7500) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.5291, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 855
clean true:841
clean false:14
clean_rate:0.9836257309941521
noisy true:261
noisy false:500
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 761
epoch [106/200] batch [5/26] time 0.243 (0.245) data 0.116 (0.119) loss_x loss_x 0.8979 (0.6808) acc_x 71.8750 (81.2500) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/26] time 0.226 (0.226) data 0.096 (0.109) loss_x loss_x 0.4482 (0.6340) acc_x 90.6250 (83.1250) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [15/26] time 0.225 (0.226) data 0.099 (0.106) loss_x loss_x 0.5093 (0.7693) acc_x 87.5000 (79.1667) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/26] time 0.225 (0.229) data 0.101 (0.107) loss_x loss_x 0.7910 (0.7570) acc_x 84.3750 (79.3750) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [25/26] time 0.209 (0.228) data 0.083 (0.106) loss_x loss_x 0.7349 (0.7281) acc_x 81.2500 (81.1250) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.5458, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 882
clean true:868
clean false:14
clean_rate:0.9841269841269841
noisy true:250
noisy false:484
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 734
epoch [107/200] batch [5/27] time 0.213 (0.193) data 0.086 (0.091) loss_x loss_x 0.7285 (0.5773) acc_x 87.5000 (87.5000) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [10/27] time 0.241 (0.215) data 0.118 (0.102) loss_x loss_x 0.9204 (0.8042) acc_x 81.2500 (83.1250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [15/27] time 0.224 (0.221) data 0.098 (0.103) loss_x loss_x 0.4763 (0.7715) acc_x 84.3750 (82.9167) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/27] time 0.240 (0.227) data 0.113 (0.108) loss_x loss_x 0.6118 (0.7465) acc_x 84.3750 (83.1250) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [25/27] time 0.238 (0.232) data 0.113 (0.111) loss_x loss_x 0.4048 (0.6935) acc_x 87.5000 (84.3750) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 509
confident_label rate tensor(0.5322, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 860
clean true:845
clean false:15
clean_rate:0.9825581395348837
noisy true:262
noisy false:494
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 756
epoch [108/200] batch [5/26] time 0.245 (0.241) data 0.121 (0.115) loss_x loss_x 0.7383 (0.7493) acc_x 75.0000 (82.5000) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/26] time 0.244 (0.233) data 0.117 (0.107) loss_x loss_x 1.2979 (0.7203) acc_x 68.7500 (82.5000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/26] time 0.220 (0.229) data 0.096 (0.103) loss_x loss_x 0.6416 (0.7037) acc_x 78.1250 (82.2917) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/26] time 0.260 (0.226) data 0.109 (0.104) loss_x loss_x 0.8564 (0.6949) acc_x 81.2500 (82.8125) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [25/26] time 0.217 (0.225) data 0.095 (0.103) loss_x loss_x 0.9409 (0.7288) acc_x 75.0000 (81.8750) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.5328, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 861
clean true:847
clean false:14
clean_rate:0.983739837398374
noisy true:258
noisy false:497
after delete: len(clean_dataset) 861
after delete: len(noisy_dataset) 755
epoch [109/200] batch [5/26] time 0.233 (0.224) data 0.109 (0.099) loss_x loss_x 0.3723 (0.6041) acc_x 93.7500 (83.7500) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [10/26] time 0.225 (0.225) data 0.101 (0.100) loss_x loss_x 0.6494 (0.6249) acc_x 75.0000 (81.5625) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [15/26] time 0.188 (0.221) data 0.110 (0.102) loss_x loss_x 0.5996 (0.7019) acc_x 87.5000 (80.4167) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [20/26] time 0.261 (0.225) data 0.138 (0.104) loss_x loss_x 0.4045 (0.6766) acc_x 90.6250 (81.5625) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [25/26] time 0.207 (0.223) data 0.084 (0.101) loss_x loss_x 0.8701 (0.6564) acc_x 65.6250 (81.6250) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 509
confident_label rate tensor(0.5384, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 870
clean true:855
clean false:15
clean_rate:0.9827586206896551
noisy true:252
noisy false:494
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 746
epoch [110/200] batch [5/27] time 0.246 (0.215) data 0.121 (0.110) loss_x loss_x 0.5420 (0.7372) acc_x 87.5000 (81.2500) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/27] time 0.223 (0.222) data 0.097 (0.107) loss_x loss_x 0.4023 (0.7355) acc_x 87.5000 (81.2500) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [15/27] time 0.215 (0.224) data 0.091 (0.106) loss_x loss_x 0.6533 (0.7387) acc_x 78.1250 (80.8333) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [20/27] time 0.236 (0.223) data 0.111 (0.107) loss_x loss_x 0.7808 (0.7265) acc_x 78.1250 (80.9375) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [25/27] time 0.220 (0.226) data 0.096 (0.108) loss_x loss_x 0.6646 (0.7447) acc_x 81.2500 (81.0000) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.5322, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 860
clean true:846
clean false:14
clean_rate:0.9837209302325581
noisy true:253
noisy false:503
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 756
epoch [111/200] batch [5/26] time 0.229 (0.233) data 0.105 (0.109) loss_x loss_x 0.7788 (0.8454) acc_x 71.8750 (78.7500) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/26] time 0.250 (0.232) data 0.124 (0.107) loss_x loss_x 0.8105 (0.8298) acc_x 78.1250 (79.3750) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [15/26] time 0.249 (0.231) data 0.124 (0.106) loss_x loss_x 0.6851 (0.7987) acc_x 81.2500 (79.3750) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [20/26] time 0.211 (0.229) data 0.085 (0.104) loss_x loss_x 0.6528 (0.7713) acc_x 87.5000 (80.3125) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [25/26] time 0.254 (0.230) data 0.129 (0.104) loss_x loss_x 0.7759 (0.7740) acc_x 78.1250 (80.3750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 499
confident_label rate tensor(0.5433, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 878
clean true:864
clean false:14
clean_rate:0.9840546697038725
noisy true:253
noisy false:485
after delete: len(clean_dataset) 878
after delete: len(noisy_dataset) 738
epoch [112/200] batch [5/27] time 0.183 (0.205) data 0.105 (0.108) loss_x loss_x 0.6445 (0.7596) acc_x 84.3750 (79.3750) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/27] time 0.230 (0.221) data 0.104 (0.109) loss_x loss_x 0.3845 (0.6648) acc_x 90.6250 (82.1875) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [15/27] time 0.245 (0.228) data 0.119 (0.111) loss_x loss_x 0.7397 (0.6822) acc_x 81.2500 (81.6667) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [20/27] time 0.224 (0.231) data 0.101 (0.112) loss_x loss_x 0.9043 (0.7063) acc_x 75.0000 (81.5625) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [25/27] time 0.232 (0.228) data 0.107 (0.108) loss_x loss_x 1.4033 (0.7170) acc_x 68.7500 (82.2500) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 508
confident_label rate tensor(0.5384, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 870
clean true:856
clean false:14
clean_rate:0.9839080459770115
noisy true:252
noisy false:494
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 746
epoch [113/200] batch [5/27] time 0.210 (0.231) data 0.084 (0.106) loss_x loss_x 0.6562 (0.6025) acc_x 87.5000 (85.0000) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [10/27] time 0.228 (0.227) data 0.100 (0.101) loss_x loss_x 0.5879 (0.5905) acc_x 90.6250 (84.6875) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [15/27] time 0.217 (0.225) data 0.091 (0.099) loss_x loss_x 0.7471 (0.6575) acc_x 78.1250 (82.2917) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/27] time 0.164 (0.219) data 0.087 (0.098) loss_x loss_x 0.9634 (0.6951) acc_x 75.0000 (81.2500) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [25/27] time 0.218 (0.220) data 0.091 (0.098) loss_x loss_x 0.4033 (0.6812) acc_x 90.6250 (81.7500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 502
confident_label rate tensor(0.5402, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 873
clean true:857
clean false:16
clean_rate:0.981672394043528
noisy true:257
noisy false:486
after delete: len(clean_dataset) 873
after delete: len(noisy_dataset) 743
epoch [114/200] batch [5/27] time 0.222 (0.227) data 0.097 (0.096) loss_x loss_x 0.2886 (0.5369) acc_x 90.6250 (84.3750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/27] time 0.225 (0.224) data 0.099 (0.095) loss_x loss_x 0.4944 (0.5906) acc_x 90.6250 (83.7500) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [15/27] time 0.206 (0.221) data 0.083 (0.093) loss_x loss_x 0.4841 (0.6379) acc_x 90.6250 (83.3333) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/27] time 0.215 (0.218) data 0.084 (0.091) loss_x loss_x 1.1064 (0.6752) acc_x 75.0000 (83.5938) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [25/27] time 0.211 (0.217) data 0.082 (0.090) loss_x loss_x 0.9360 (0.6667) acc_x 81.2500 (83.6250) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 499
confident_label rate tensor(0.5439, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 879
clean true:865
clean false:14
clean_rate:0.9840728100113766
noisy true:252
noisy false:485
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 737
epoch [115/200] batch [5/27] time 0.207 (0.215) data 0.083 (0.088) loss_x loss_x 0.6484 (0.6196) acc_x 84.3750 (83.1250) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/27] time 0.213 (0.213) data 0.084 (0.086) loss_x loss_x 0.9668 (0.6407) acc_x 81.2500 (84.3750) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [15/27] time 0.212 (0.214) data 0.083 (0.088) loss_x loss_x 0.6436 (0.6493) acc_x 84.3750 (83.1250) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [20/27] time 0.216 (0.216) data 0.086 (0.090) loss_x loss_x 0.6870 (0.6580) acc_x 81.2500 (82.5000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [25/27] time 0.207 (0.215) data 0.080 (0.088) loss_x loss_x 0.6953 (0.6808) acc_x 75.0000 (81.2500) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 507
confident_label rate tensor(0.5377, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 869
clean true:858
clean false:11
clean_rate:0.9873417721518988
noisy true:251
noisy false:496
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 747
epoch [116/200] batch [5/27] time 0.210 (0.205) data 0.084 (0.085) loss_x loss_x 0.6660 (0.4667) acc_x 87.5000 (89.3750) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [10/27] time 0.205 (0.206) data 0.081 (0.084) loss_x loss_x 0.9453 (0.5552) acc_x 68.7500 (87.1875) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [15/27] time 0.208 (0.207) data 0.083 (0.083) loss_x loss_x 0.3826 (0.6333) acc_x 87.5000 (84.7917) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/27] time 0.225 (0.211) data 0.098 (0.087) loss_x loss_x 0.8423 (0.6370) acc_x 84.3750 (84.6875) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [25/27] time 0.225 (0.213) data 0.100 (0.089) loss_x loss_x 0.6274 (0.6438) acc_x 84.3750 (84.7500) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 495
confident_label rate tensor(0.5458, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 882
clean true:867
clean false:15
clean_rate:0.9829931972789115
noisy true:254
noisy false:480
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 734
epoch [117/200] batch [5/27] time 0.210 (0.208) data 0.085 (0.084) loss_x loss_x 0.4504 (0.7436) acc_x 90.6250 (82.5000) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [10/27] time 0.214 (0.210) data 0.086 (0.084) loss_x loss_x 0.5010 (0.6683) acc_x 93.7500 (84.6875) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [15/27] time 0.232 (0.211) data 0.107 (0.086) loss_x loss_x 0.7026 (0.6971) acc_x 87.5000 (84.3750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/27] time 0.230 (0.215) data 0.103 (0.089) loss_x loss_x 0.5205 (0.6893) acc_x 90.6250 (83.7500) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [25/27] time 0.226 (0.216) data 0.103 (0.091) loss_x loss_x 0.6714 (0.6822) acc_x 90.6250 (83.3750) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.5538, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 895
clean true:878
clean false:17
clean_rate:0.9810055865921787
noisy true:252
noisy false:469
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 721
epoch [118/200] batch [5/27] time 0.206 (0.198) data 0.083 (0.084) loss_x loss_x 0.8438 (0.7197) acc_x 75.0000 (80.6250) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/27] time 0.159 (0.198) data 0.082 (0.083) loss_x loss_x 0.6182 (0.6872) acc_x 84.3750 (82.1875) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [15/27] time 0.207 (0.204) data 0.083 (0.083) loss_x loss_x 0.6099 (0.6245) acc_x 84.3750 (84.1667) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/27] time 0.211 (0.205) data 0.084 (0.083) loss_x loss_x 0.9194 (0.6760) acc_x 78.1250 (82.8125) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [25/27] time 0.208 (0.205) data 0.083 (0.083) loss_x loss_x 0.8511 (0.7025) acc_x 78.1250 (82.8750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.5421, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 876
clean true:860
clean false:16
clean_rate:0.9817351598173516
noisy true:265
noisy false:475
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 740
epoch [119/200] batch [5/27] time 0.218 (0.227) data 0.094 (0.095) loss_x loss_x 0.7651 (0.6399) acc_x 81.2500 (84.3750) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/27] time 0.223 (0.224) data 0.100 (0.096) loss_x loss_x 0.9590 (0.6226) acc_x 78.1250 (82.8125) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [15/27] time 0.227 (0.224) data 0.102 (0.097) loss_x loss_x 0.6846 (0.6602) acc_x 84.3750 (81.8750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [20/27] time 0.226 (0.223) data 0.100 (0.097) loss_x loss_x 0.7896 (0.6488) acc_x 75.0000 (82.0312) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [25/27] time 0.212 (0.221) data 0.085 (0.094) loss_x loss_x 0.8916 (0.6409) acc_x 78.1250 (82.3750) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 478
confident_label rate tensor(0.5538, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 895
clean true:882
clean false:13
clean_rate:0.9854748603351955
noisy true:256
noisy false:465
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 721
epoch [120/200] batch [5/27] time 0.205 (0.197) data 0.081 (0.088) loss_x loss_x 0.6455 (0.5495) acc_x 81.2500 (86.8750) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/27] time 0.231 (0.210) data 0.104 (0.093) loss_x loss_x 0.3486 (0.5660) acc_x 90.6250 (84.3750) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [15/27] time 0.207 (0.213) data 0.082 (0.093) loss_x loss_x 0.6147 (0.5889) acc_x 84.3750 (84.1667) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [20/27] time 0.208 (0.211) data 0.083 (0.090) loss_x loss_x 1.3848 (0.6570) acc_x 65.6250 (82.1875) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [25/27] time 0.210 (0.211) data 0.085 (0.089) loss_x loss_x 0.5649 (0.6680) acc_x 90.6250 (82.6250) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.5526, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 893
clean true:877
clean false:16
clean_rate:0.9820828667413214
noisy true:252
noisy false:471
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 723
epoch [121/200] batch [5/27] time 0.218 (0.224) data 0.095 (0.099) loss_x loss_x 0.7310 (0.6711) acc_x 78.1250 (84.3750) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/27] time 0.226 (0.223) data 0.100 (0.099) loss_x loss_x 1.3936 (0.7729) acc_x 62.5000 (81.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [15/27] time 0.215 (0.223) data 0.091 (0.098) loss_x loss_x 0.6865 (0.7784) acc_x 87.5000 (80.6250) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/27] time 0.228 (0.223) data 0.102 (0.098) loss_x loss_x 0.6660 (0.7522) acc_x 84.3750 (81.5625) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [25/27] time 0.236 (0.224) data 0.110 (0.099) loss_x loss_x 0.5083 (0.7260) acc_x 87.5000 (82.1250) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.5334, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 862
clean true:852
clean false:10
clean_rate:0.988399071925754
noisy true:263
noisy false:491
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 754
epoch [122/200] batch [5/26] time 0.207 (0.193) data 0.083 (0.084) loss_x loss_x 0.7871 (0.7614) acc_x 81.2500 (78.7500) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/26] time 0.209 (0.200) data 0.084 (0.084) loss_x loss_x 0.6743 (0.7722) acc_x 87.5000 (79.6875) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/26] time 0.209 (0.203) data 0.085 (0.084) loss_x loss_x 0.6431 (0.7507) acc_x 78.1250 (80.2083) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/26] time 0.207 (0.204) data 0.083 (0.084) loss_x loss_x 0.5493 (0.7202) acc_x 90.6250 (81.0938) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [25/26] time 0.213 (0.205) data 0.085 (0.084) loss_x loss_x 0.8384 (0.7437) acc_x 81.2500 (80.5000) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.5470, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 884
clean true:867
clean false:17
clean_rate:0.9807692307692307
noisy true:248
noisy false:484
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 732
epoch [123/200] batch [5/27] time 0.204 (0.208) data 0.080 (0.080) loss_x loss_x 0.7769 (0.8729) acc_x 84.3750 (79.3750) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/27] time 0.206 (0.207) data 0.082 (0.081) loss_x loss_x 0.3384 (0.7253) acc_x 96.8750 (82.1875) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/27] time 0.206 (0.207) data 0.081 (0.080) loss_x loss_x 0.6631 (0.7220) acc_x 84.3750 (81.4583) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/27] time 0.204 (0.206) data 0.079 (0.081) loss_x loss_x 0.4434 (0.6764) acc_x 87.5000 (82.9688) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [25/27] time 0.209 (0.207) data 0.087 (0.081) loss_x loss_x 0.7593 (0.7146) acc_x 81.2500 (82.3750) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 475
confident_label rate tensor(0.5656, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 914
clean true:896
clean false:18
clean_rate:0.9803063457330415
noisy true:245
noisy false:457
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 702
epoch [124/200] batch [5/28] time 0.203 (0.205) data 0.078 (0.081) loss_x loss_x 0.7739 (0.7920) acc_x 84.3750 (81.8750) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/28] time 0.208 (0.206) data 0.083 (0.081) loss_x loss_x 0.6006 (0.7241) acc_x 81.2500 (82.1875) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [15/28] time 0.206 (0.206) data 0.081 (0.081) loss_x loss_x 0.9736 (0.6871) acc_x 75.0000 (83.1250) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [20/28] time 0.211 (0.207) data 0.082 (0.081) loss_x loss_x 0.2690 (0.6494) acc_x 93.7500 (84.0625) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [25/28] time 0.155 (0.203) data 0.078 (0.081) loss_x loss_x 1.3320 (0.6571) acc_x 75.0000 (84.1250) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.5495, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 888
clean true:874
clean false:14
clean_rate:0.9842342342342343
noisy true:253
noisy false:475
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 728
epoch [125/200] batch [5/27] time 0.205 (0.208) data 0.081 (0.083) loss_x loss_x 0.2910 (0.5020) acc_x 96.8750 (87.5000) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/27] time 0.208 (0.208) data 0.085 (0.083) loss_x loss_x 0.4114 (0.5845) acc_x 87.5000 (85.0000) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [15/27] time 0.213 (0.207) data 0.082 (0.082) loss_x loss_x 0.7568 (0.5794) acc_x 81.2500 (84.1667) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/27] time 0.206 (0.207) data 0.079 (0.082) loss_x loss_x 0.3765 (0.5881) acc_x 96.8750 (84.6875) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [25/27] time 0.154 (0.203) data 0.077 (0.081) loss_x loss_x 0.3184 (0.5624) acc_x 96.8750 (85.6250) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.5415, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 875
clean true:864
clean false:11
clean_rate:0.9874285714285714
noisy true:255
noisy false:486
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 741
epoch [126/200] batch [5/27] time 0.212 (0.208) data 0.085 (0.081) loss_x loss_x 0.5659 (0.7089) acc_x 84.3750 (80.0000) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/27] time 0.209 (0.208) data 0.083 (0.082) loss_x loss_x 0.6235 (0.6496) acc_x 78.1250 (82.1875) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [15/27] time 0.156 (0.202) data 0.079 (0.082) loss_x loss_x 0.4478 (0.6487) acc_x 87.5000 (82.2917) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/27] time 0.211 (0.202) data 0.084 (0.082) loss_x loss_x 0.9702 (0.6590) acc_x 75.0000 (82.3438) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [25/27] time 0.230 (0.206) data 0.107 (0.085) loss_x loss_x 0.9834 (0.6538) acc_x 75.0000 (82.1250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.5446, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 880
clean true:866
clean false:14
clean_rate:0.9840909090909091
noisy true:256
noisy false:480
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 736
epoch [127/200] batch [5/27] time 0.204 (0.206) data 0.080 (0.081) loss_x loss_x 0.9624 (0.6721) acc_x 75.0000 (80.0000) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/27] time 0.210 (0.207) data 0.086 (0.083) loss_x loss_x 0.3201 (0.5544) acc_x 93.7500 (84.3750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [15/27] time 0.160 (0.204) data 0.083 (0.082) loss_x loss_x 0.5654 (0.6223) acc_x 87.5000 (83.1250) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/27] time 0.207 (0.204) data 0.081 (0.082) loss_x loss_x 0.5752 (0.6096) acc_x 81.2500 (83.5938) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [25/27] time 0.203 (0.205) data 0.078 (0.082) loss_x loss_x 0.4243 (0.5878) acc_x 90.6250 (84.5000) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 508
confident_label rate tensor(0.5427, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 877
clean true:862
clean false:15
clean_rate:0.9828962371721779
noisy true:246
noisy false:493
after delete: len(clean_dataset) 877
after delete: len(noisy_dataset) 739
epoch [128/200] batch [5/27] time 0.237 (0.175) data 0.104 (0.086) loss_x loss_x 1.0752 (0.7628) acc_x 71.8750 (78.7500) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/27] time 0.227 (0.202) data 0.101 (0.094) loss_x loss_x 0.6958 (0.7369) acc_x 81.2500 (79.3750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [15/27] time 0.204 (0.208) data 0.079 (0.094) loss_x loss_x 0.6431 (0.6998) acc_x 87.5000 (81.2500) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/27] time 0.210 (0.208) data 0.080 (0.091) loss_x loss_x 0.4424 (0.6696) acc_x 87.5000 (81.8750) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [25/27] time 0.232 (0.202) data 0.079 (0.089) loss_x loss_x 0.3447 (0.6388) acc_x 93.7500 (82.6250) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.5476, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 885
clean true:869
clean false:16
clean_rate:0.9819209039548022
noisy true:271
noisy false:460
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 731
epoch [129/200] batch [5/27] time 0.210 (0.196) data 0.083 (0.080) loss_x loss_x 0.3042 (0.5891) acc_x 90.6250 (83.1250) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [10/27] time 0.206 (0.202) data 0.081 (0.081) loss_x loss_x 0.4480 (0.6160) acc_x 84.3750 (83.1250) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [15/27] time 0.207 (0.203) data 0.081 (0.081) loss_x loss_x 0.7446 (0.6090) acc_x 87.5000 (84.7917) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [20/27] time 0.211 (0.205) data 0.084 (0.081) loss_x loss_x 0.4912 (0.6095) acc_x 93.7500 (84.3750) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [25/27] time 0.208 (0.206) data 0.081 (0.082) loss_x loss_x 0.6045 (0.6174) acc_x 84.3750 (84.3750) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 469
confident_label rate tensor(0.5532, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 894
clean true:878
clean false:16
clean_rate:0.9821029082774049
noisy true:269
noisy false:453
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 722
epoch [130/200] batch [5/27] time 0.207 (0.189) data 0.080 (0.081) loss_x loss_x 0.9048 (0.5765) acc_x 81.2500 (86.2500) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/27] time 0.206 (0.198) data 0.083 (0.081) loss_x loss_x 0.4238 (0.5828) acc_x 87.5000 (85.3125) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [15/27] time 0.206 (0.201) data 0.080 (0.081) loss_x loss_x 0.8540 (0.6313) acc_x 81.2500 (84.5833) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [20/27] time 0.207 (0.202) data 0.081 (0.081) loss_x loss_x 0.6509 (0.6885) acc_x 81.2500 (82.5000) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [25/27] time 0.204 (0.203) data 0.080 (0.081) loss_x loss_x 0.6660 (0.6856) acc_x 78.1250 (82.3750) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 483
confident_label rate tensor(0.5464, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 883
clean true:869
clean false:14
clean_rate:0.984144960362401
noisy true:264
noisy false:469
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 733
epoch [131/200] batch [5/27] time 0.203 (0.203) data 0.079 (0.080) loss_x loss_x 0.4922 (0.6841) acc_x 87.5000 (85.0000) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/27] time 0.208 (0.206) data 0.083 (0.081) loss_x loss_x 0.3972 (0.7085) acc_x 87.5000 (82.1875) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [15/27] time 0.156 (0.202) data 0.080 (0.081) loss_x loss_x 0.6729 (0.7003) acc_x 87.5000 (82.7083) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/27] time 0.209 (0.201) data 0.083 (0.081) loss_x loss_x 0.5205 (0.6492) acc_x 87.5000 (83.4375) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [25/27] time 0.202 (0.202) data 0.079 (0.081) loss_x loss_x 0.5151 (0.6602) acc_x 87.5000 (83.6250) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.5452, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 881
clean true:868
clean false:13
clean_rate:0.985244040862656
noisy true:247
noisy false:488
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 735
epoch [132/200] batch [5/27] time 0.206 (0.205) data 0.082 (0.081) loss_x loss_x 0.8701 (0.6943) acc_x 81.2500 (82.5000) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/27] time 0.206 (0.205) data 0.080 (0.081) loss_x loss_x 0.4558 (0.7430) acc_x 90.6250 (80.6250) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [15/27] time 0.208 (0.206) data 0.083 (0.081) loss_x loss_x 0.4951 (0.7106) acc_x 87.5000 (81.4583) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [20/27] time 0.207 (0.201) data 0.080 (0.081) loss_x loss_x 0.3970 (0.6775) acc_x 87.5000 (81.7188) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [25/27] time 0.204 (0.202) data 0.079 (0.081) loss_x loss_x 0.5625 (0.6867) acc_x 81.2500 (81.8750) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.5489, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 887
clean true:874
clean false:13
clean_rate:0.9853438556933484
noisy true:254
noisy false:475
after delete: len(clean_dataset) 887
after delete: len(noisy_dataset) 729
epoch [133/200] batch [5/27] time 0.204 (0.210) data 0.079 (0.082) loss_x loss_x 0.5674 (0.7227) acc_x 81.2500 (82.5000) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/27] time 0.208 (0.209) data 0.084 (0.082) loss_x loss_x 0.5576 (0.6632) acc_x 84.3750 (82.5000) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [15/27] time 0.159 (0.205) data 0.082 (0.082) loss_x loss_x 0.6201 (0.6412) acc_x 87.5000 (82.9167) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/27] time 0.208 (0.204) data 0.083 (0.082) loss_x loss_x 0.6641 (0.6474) acc_x 81.2500 (82.3438) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [25/27] time 0.204 (0.204) data 0.081 (0.082) loss_x loss_x 0.7666 (0.6831) acc_x 81.2500 (81.2500) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.5489, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 887
clean true:873
clean false:14
clean_rate:0.9842164599774521
noisy true:257
noisy false:472
after delete: len(clean_dataset) 887
after delete: len(noisy_dataset) 729
epoch [134/200] batch [5/27] time 0.212 (0.221) data 0.089 (0.097) loss_x loss_x 0.5850 (0.6412) acc_x 87.5000 (84.3750) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/27] time 0.210 (0.220) data 0.083 (0.095) loss_x loss_x 0.9678 (0.6565) acc_x 84.3750 (83.7500) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [15/27] time 0.207 (0.216) data 0.083 (0.091) loss_x loss_x 0.6909 (0.6529) acc_x 78.1250 (82.9167) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/27] time 0.209 (0.214) data 0.084 (0.089) loss_x loss_x 0.7578 (0.6950) acc_x 78.1250 (81.7188) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [25/27] time 0.211 (0.214) data 0.084 (0.089) loss_x loss_x 0.7402 (0.7070) acc_x 84.3750 (81.7500) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 909
clean true:891
clean false:18
clean_rate:0.9801980198019802
noisy true:243
noisy false:464
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 707
epoch [135/200] batch [5/28] time 0.208 (0.209) data 0.082 (0.084) loss_x loss_x 0.6050 (0.4526) acc_x 84.3750 (88.1250) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/28] time 0.211 (0.210) data 0.084 (0.084) loss_x loss_x 0.8740 (0.5357) acc_x 68.7500 (86.5625) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [15/28] time 0.209 (0.210) data 0.083 (0.083) loss_x loss_x 0.7134 (0.5427) acc_x 78.1250 (86.0417) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/28] time 0.206 (0.209) data 0.081 (0.083) loss_x loss_x 0.6855 (0.6048) acc_x 78.1250 (83.5938) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [25/28] time 0.208 (0.209) data 0.081 (0.083) loss_x loss_x 0.4951 (0.5999) acc_x 87.5000 (83.8750) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.5489, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 887
clean true:873
clean false:14
clean_rate:0.9842164599774521
noisy true:258
noisy false:471
after delete: len(clean_dataset) 887
after delete: len(noisy_dataset) 729
epoch [136/200] batch [5/27] time 0.207 (0.210) data 0.082 (0.085) loss_x loss_x 0.2878 (0.5875) acc_x 90.6250 (85.0000) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/27] time 0.214 (0.210) data 0.086 (0.084) loss_x loss_x 0.5488 (0.6153) acc_x 84.3750 (84.0625) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/27] time 0.211 (0.210) data 0.084 (0.084) loss_x loss_x 0.5244 (0.5852) acc_x 81.2500 (84.3750) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/27] time 0.162 (0.205) data 0.085 (0.084) loss_x loss_x 0.3125 (0.5907) acc_x 87.5000 (84.0625) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [25/27] time 0.210 (0.206) data 0.081 (0.084) loss_x loss_x 0.7363 (0.6331) acc_x 81.2500 (83.2500) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.5483, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 886
clean true:873
clean false:13
clean_rate:0.9853273137697517
noisy true:258
noisy false:472
after delete: len(clean_dataset) 886
after delete: len(noisy_dataset) 730
epoch [137/200] batch [5/27] time 0.208 (0.208) data 0.082 (0.083) loss_x loss_x 0.4924 (0.5237) acc_x 87.5000 (85.6250) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/27] time 0.223 (0.213) data 0.098 (0.088) loss_x loss_x 0.8579 (0.5605) acc_x 81.2500 (85.3125) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [15/27] time 0.227 (0.213) data 0.101 (0.088) loss_x loss_x 0.5591 (0.6337) acc_x 84.3750 (83.3333) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/27] time 0.203 (0.206) data 0.085 (0.086) loss_x loss_x 0.7710 (0.6381) acc_x 78.1250 (83.4375) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [25/27] time 0.207 (0.206) data 0.083 (0.085) loss_x loss_x 0.6963 (0.6329) acc_x 84.3750 (84.1250) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.5495, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 888
clean true:877
clean false:11
clean_rate:0.9876126126126126
noisy true:267
noisy false:461
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 728
epoch [138/200] batch [5/27] time 0.207 (0.207) data 0.080 (0.082) loss_x loss_x 0.7476 (0.5958) acc_x 84.3750 (85.0000) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/27] time 0.211 (0.209) data 0.083 (0.082) loss_x loss_x 0.3542 (0.5377) acc_x 90.6250 (86.5625) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [15/27] time 0.206 (0.209) data 0.080 (0.082) loss_x loss_x 0.5859 (0.5899) acc_x 84.3750 (85.2083) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [20/27] time 0.208 (0.209) data 0.081 (0.082) loss_x loss_x 0.3569 (0.5550) acc_x 87.5000 (86.4062) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [25/27] time 0.212 (0.209) data 0.082 (0.082) loss_x loss_x 0.6431 (0.6134) acc_x 87.5000 (85.3750) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 905
clean true:887
clean false:18
clean_rate:0.980110497237569
noisy true:253
noisy false:458
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 711
epoch [139/200] batch [5/28] time 0.205 (0.206) data 0.080 (0.081) loss_x loss_x 0.3164 (0.5658) acc_x 93.7500 (85.0000) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/28] time 0.210 (0.208) data 0.083 (0.082) loss_x loss_x 0.4873 (0.5203) acc_x 87.5000 (86.2500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [15/28] time 0.212 (0.210) data 0.085 (0.083) loss_x loss_x 0.7681 (0.5732) acc_x 78.1250 (84.5833) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/28] time 0.210 (0.210) data 0.083 (0.083) loss_x loss_x 0.6479 (0.5985) acc_x 84.3750 (83.7500) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [25/28] time 0.215 (0.210) data 0.086 (0.083) loss_x loss_x 0.8335 (0.6390) acc_x 78.1250 (82.3750) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.5526, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 893
clean true:878
clean false:15
clean_rate:0.9832026875699889
noisy true:250
noisy false:473
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 723
epoch [140/200] batch [5/27] time 0.208 (0.222) data 0.082 (0.096) loss_x loss_x 0.9917 (0.6571) acc_x 78.1250 (83.7500) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/27] time 0.211 (0.214) data 0.084 (0.089) loss_x loss_x 0.3823 (0.7212) acc_x 90.6250 (81.5625) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [15/27] time 0.210 (0.213) data 0.082 (0.087) loss_x loss_x 0.3481 (0.6659) acc_x 93.7500 (83.3333) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/27] time 0.206 (0.212) data 0.081 (0.085) loss_x loss_x 0.3823 (0.6526) acc_x 81.2500 (82.9688) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [25/27] time 0.212 (0.211) data 0.082 (0.085) loss_x loss_x 0.9263 (0.6796) acc_x 81.2500 (82.7500) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.5476, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 885
clean true:874
clean false:11
clean_rate:0.9875706214689266
noisy true:266
noisy false:465
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 731
epoch [141/200] batch [5/27] time 0.209 (0.213) data 0.084 (0.082) loss_x loss_x 1.0264 (0.7748) acc_x 71.8750 (80.0000) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/27] time 0.207 (0.210) data 0.082 (0.082) loss_x loss_x 0.9692 (0.7669) acc_x 81.2500 (80.3125) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [15/27] time 0.209 (0.209) data 0.080 (0.082) loss_x loss_x 0.7012 (0.6714) acc_x 87.5000 (82.9167) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [20/27] time 0.204 (0.208) data 0.078 (0.082) loss_x loss_x 1.0420 (0.6889) acc_x 78.1250 (81.4062) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [25/27] time 0.209 (0.208) data 0.082 (0.081) loss_x loss_x 0.4072 (0.6724) acc_x 93.7500 (82.2500) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.5501, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 889
clean true:874
clean false:15
clean_rate:0.983127109111361
noisy true:261
noisy false:466
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 727
epoch [142/200] batch [5/27] time 0.236 (0.229) data 0.105 (0.102) loss_x loss_x 0.5898 (0.5783) acc_x 87.5000 (86.8750) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/27] time 0.226 (0.229) data 0.101 (0.102) loss_x loss_x 0.7480 (0.6288) acc_x 84.3750 (85.0000) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [15/27] time 0.226 (0.228) data 0.100 (0.102) loss_x loss_x 0.7676 (0.6631) acc_x 78.1250 (82.9167) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [20/27] time 0.180 (0.226) data 0.103 (0.102) loss_x loss_x 0.9175 (0.6713) acc_x 81.2500 (82.8125) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [25/27] time 0.229 (0.224) data 0.103 (0.102) loss_x loss_x 0.6250 (0.6733) acc_x 84.3750 (83.0000) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.5483, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 886
clean true:873
clean false:13
clean_rate:0.9853273137697517
noisy true:262
noisy false:468
after delete: len(clean_dataset) 886
after delete: len(noisy_dataset) 730
epoch [143/200] batch [5/27] time 0.206 (0.204) data 0.081 (0.081) loss_x loss_x 0.3806 (0.7560) acc_x 90.6250 (83.1250) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/27] time 0.209 (0.206) data 0.080 (0.081) loss_x loss_x 0.8311 (0.6656) acc_x 75.0000 (83.7500) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [15/27] time 0.208 (0.206) data 0.085 (0.081) loss_x loss_x 0.6494 (0.6553) acc_x 81.2500 (83.5417) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/27] time 0.208 (0.207) data 0.082 (0.081) loss_x loss_x 0.8823 (0.6539) acc_x 81.2500 (83.9062) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [25/27] time 0.173 (0.205) data 0.080 (0.081) loss_x loss_x 0.6416 (0.6909) acc_x 84.3750 (83.1250) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.5439, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 879
clean true:866
clean false:13
clean_rate:0.9852104664391353
noisy true:260
noisy false:477
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 737
epoch [144/200] batch [5/27] time 0.204 (0.209) data 0.079 (0.084) loss_x loss_x 0.4951 (0.7036) acc_x 87.5000 (81.2500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/27] time 0.203 (0.208) data 0.078 (0.082) loss_x loss_x 0.5684 (0.6464) acc_x 84.3750 (83.7500) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/27] time 0.159 (0.204) data 0.082 (0.082) loss_x loss_x 1.3242 (0.6753) acc_x 59.3750 (82.2917) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/27] time 0.205 (0.202) data 0.079 (0.081) loss_x loss_x 0.5542 (0.6435) acc_x 90.6250 (83.1250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [25/27] time 0.209 (0.203) data 0.083 (0.081) loss_x loss_x 0.2446 (0.6390) acc_x 96.8750 (83.7500) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.5557, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 898
clean true:883
clean false:15
clean_rate:0.9832962138084632
noisy true:251
noisy false:467
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 718
epoch [145/200] batch [5/28] time 0.210 (0.209) data 0.081 (0.082) loss_x loss_x 0.6367 (0.6478) acc_x 81.2500 (80.0000) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/28] time 0.208 (0.209) data 0.084 (0.083) loss_x loss_x 0.6445 (0.6067) acc_x 78.1250 (83.4375) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [15/28] time 0.204 (0.208) data 0.078 (0.082) loss_x loss_x 0.4973 (0.6018) acc_x 87.5000 (83.7500) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/28] time 0.204 (0.208) data 0.080 (0.082) loss_x loss_x 0.5923 (0.5726) acc_x 84.3750 (84.2188) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [25/28] time 0.182 (0.207) data 0.082 (0.081) loss_x loss_x 0.5371 (0.6132) acc_x 87.5000 (83.6250) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 470
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 905
clean true:894
clean false:11
clean_rate:0.9878453038674033
noisy true:252
noisy false:459
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 711
epoch [146/200] batch [5/28] time 0.207 (0.207) data 0.082 (0.082) loss_x loss_x 0.5332 (0.5172) acc_x 87.5000 (86.2500) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/28] time 0.207 (0.206) data 0.081 (0.081) loss_x loss_x 0.6357 (0.5363) acc_x 81.2500 (85.3125) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/28] time 0.220 (0.201) data 0.081 (0.081) loss_x loss_x 0.5317 (0.5685) acc_x 90.6250 (84.5833) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/28] time 0.207 (0.202) data 0.080 (0.081) loss_x loss_x 0.8687 (0.5917) acc_x 75.0000 (84.2188) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [25/28] time 0.207 (0.203) data 0.082 (0.081) loss_x loss_x 0.6807 (0.6139) acc_x 81.2500 (83.8750) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.5495, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 888
clean true:872
clean false:16
clean_rate:0.9819819819819819
noisy true:256
noisy false:472
after delete: len(clean_dataset) 888
after delete: len(noisy_dataset) 728
epoch [147/200] batch [5/27] time 0.208 (0.207) data 0.080 (0.081) loss_x loss_x 0.2986 (0.6228) acc_x 90.6250 (86.2500) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/27] time 0.216 (0.208) data 0.091 (0.082) loss_x loss_x 0.8784 (0.6313) acc_x 71.8750 (84.6875) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/27] time 0.209 (0.208) data 0.081 (0.082) loss_x loss_x 0.4688 (0.6333) acc_x 93.7500 (84.1667) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/27] time 0.206 (0.208) data 0.081 (0.081) loss_x loss_x 0.6050 (0.6535) acc_x 87.5000 (83.7500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [25/27] time 0.205 (0.208) data 0.079 (0.081) loss_x loss_x 0.6616 (0.6226) acc_x 75.0000 (84.5000) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 460
confident_label rate tensor(0.5693, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 920
clean true:902
clean false:18
clean_rate:0.9804347826086957
noisy true:254
noisy false:442
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 696
epoch [148/200] batch [5/28] time 0.207 (0.206) data 0.084 (0.081) loss_x loss_x 0.7852 (0.6741) acc_x 75.0000 (81.2500) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/28] time 0.203 (0.206) data 0.079 (0.081) loss_x loss_x 0.4666 (0.6433) acc_x 87.5000 (83.1250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [15/28] time 0.210 (0.206) data 0.081 (0.081) loss_x loss_x 0.8257 (0.6769) acc_x 87.5000 (83.1250) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/28] time 0.205 (0.205) data 0.082 (0.080) loss_x loss_x 0.6338 (0.6887) acc_x 84.3750 (82.3438) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [25/28] time 0.204 (0.205) data 0.081 (0.080) loss_x loss_x 0.7061 (0.6541) acc_x 84.3750 (83.2500) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.5483, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 886
clean true:873
clean false:13
clean_rate:0.9853273137697517
noisy true:253
noisy false:477
after delete: len(clean_dataset) 886
after delete: len(noisy_dataset) 730
epoch [149/200] batch [5/27] time 0.206 (0.208) data 0.079 (0.081) loss_x loss_x 0.5215 (0.6581) acc_x 84.3750 (84.3750) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/27] time 0.208 (0.208) data 0.082 (0.081) loss_x loss_x 1.1494 (0.7253) acc_x 71.8750 (81.5625) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/27] time 0.189 (0.198) data 0.081 (0.081) loss_x loss_x 0.3726 (0.6897) acc_x 93.7500 (82.7083) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/27] time 0.209 (0.200) data 0.081 (0.081) loss_x loss_x 0.4761 (0.6725) acc_x 90.6250 (82.9688) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [25/27] time 0.207 (0.202) data 0.082 (0.081) loss_x loss_x 0.7715 (0.6558) acc_x 84.3750 (83.6250) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 483
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 909
clean true:889
clean false:20
clean_rate:0.977997799779978
noisy true:244
noisy false:463
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 707
epoch [150/200] batch [5/28] time 0.207 (0.209) data 0.082 (0.081) loss_x loss_x 0.6465 (0.7039) acc_x 90.6250 (83.7500) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/28] time 0.205 (0.207) data 0.080 (0.080) loss_x loss_x 0.8628 (0.8312) acc_x 84.3750 (81.8750) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [15/28] time 0.154 (0.198) data 0.077 (0.080) loss_x loss_x 0.6030 (0.7565) acc_x 81.2500 (82.5000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [20/28] time 0.210 (0.201) data 0.082 (0.080) loss_x loss_x 0.4282 (0.7299) acc_x 87.5000 (82.6562) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [25/28] time 0.206 (0.202) data 0.081 (0.080) loss_x loss_x 0.7026 (0.7154) acc_x 81.2500 (82.6250) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 495
confident_label rate tensor(0.5507, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 890
clean true:874
clean false:16
clean_rate:0.9820224719101124
noisy true:247
noisy false:479
after delete: len(clean_dataset) 890
after delete: len(noisy_dataset) 726
epoch [151/200] batch [5/27] time 0.213 (0.190) data 0.088 (0.082) loss_x loss_x 1.0332 (0.7580) acc_x 75.0000 (80.0000) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/27] time 0.211 (0.200) data 0.083 (0.082) loss_x loss_x 0.5161 (0.6907) acc_x 84.3750 (81.5625) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [15/27] time 0.207 (0.203) data 0.084 (0.082) loss_x loss_x 0.3291 (0.6418) acc_x 93.7500 (83.5417) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/27] time 0.206 (0.204) data 0.083 (0.083) loss_x loss_x 0.8125 (0.6289) acc_x 84.3750 (84.0625) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [25/27] time 0.213 (0.205) data 0.086 (0.082) loss_x loss_x 0.6582 (0.6633) acc_x 84.3750 (83.0000) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.5470, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 884
clean true:868
clean false:16
clean_rate:0.9819004524886877
noisy true:259
noisy false:473
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 732
epoch [152/200] batch [5/27] time 0.212 (0.208) data 0.087 (0.083) loss_x loss_x 0.5659 (0.5764) acc_x 84.3750 (85.6250) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/27] time 0.185 (0.206) data 0.082 (0.082) loss_x loss_x 0.8311 (0.5576) acc_x 78.1250 (84.6875) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [15/27] time 0.157 (0.201) data 0.080 (0.082) loss_x loss_x 0.6509 (0.5585) acc_x 78.1250 (84.5833) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/27] time 0.205 (0.198) data 0.080 (0.082) loss_x loss_x 0.5679 (0.5643) acc_x 87.5000 (84.8438) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [25/27] time 0.211 (0.200) data 0.081 (0.081) loss_x loss_x 0.4109 (0.5618) acc_x 87.5000 (85.2500) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.5464, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 883
clean true:871
clean false:12
clean_rate:0.986409966024915
noisy true:254
noisy false:479
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 733
epoch [153/200] batch [5/27] time 0.208 (0.181) data 0.083 (0.080) loss_x loss_x 0.8843 (0.6077) acc_x 87.5000 (86.2500) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/27] time 0.206 (0.193) data 0.078 (0.080) loss_x loss_x 1.0898 (0.6573) acc_x 78.1250 (85.0000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/27] time 0.206 (0.198) data 0.081 (0.081) loss_x loss_x 0.6055 (0.6539) acc_x 71.8750 (82.9167) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/27] time 0.208 (0.200) data 0.081 (0.080) loss_x loss_x 0.7856 (0.6470) acc_x 78.1250 (82.8125) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [25/27] time 0.208 (0.201) data 0.082 (0.081) loss_x loss_x 0.5806 (0.6383) acc_x 81.2500 (82.8750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 457
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 909
clean true:896
clean false:13
clean_rate:0.9856985698569857
noisy true:263
noisy false:444
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 707
epoch [154/200] batch [5/28] time 0.205 (0.208) data 0.079 (0.081) loss_x loss_x 0.4958 (0.6125) acc_x 84.3750 (85.0000) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/28] time 0.210 (0.208) data 0.084 (0.081) loss_x loss_x 0.4055 (0.5917) acc_x 87.5000 (84.0625) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [15/28] time 0.207 (0.207) data 0.082 (0.082) loss_x loss_x 0.7627 (0.6514) acc_x 75.0000 (83.5417) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/28] time 0.208 (0.207) data 0.083 (0.082) loss_x loss_x 0.3782 (0.5777) acc_x 87.5000 (85.1562) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [25/28] time 0.205 (0.207) data 0.079 (0.082) loss_x loss_x 0.5342 (0.6007) acc_x 87.5000 (84.3750) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.5501, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 889
clean true:875
clean false:14
clean_rate:0.984251968503937
noisy true:265
noisy false:462
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 727
epoch [155/200] batch [5/27] time 0.211 (0.195) data 0.085 (0.083) loss_x loss_x 0.4111 (0.5121) acc_x 84.3750 (85.6250) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/27] time 0.209 (0.202) data 0.082 (0.083) loss_x loss_x 0.4233 (0.5364) acc_x 93.7500 (87.5000) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [15/27] time 0.207 (0.204) data 0.083 (0.083) loss_x loss_x 0.5366 (0.5667) acc_x 90.6250 (86.8750) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [20/27] time 0.211 (0.205) data 0.083 (0.083) loss_x loss_x 0.4333 (0.6031) acc_x 87.5000 (84.6875) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [25/27] time 0.211 (0.207) data 0.082 (0.083) loss_x loss_x 0.9097 (0.6063) acc_x 71.8750 (85.0000) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 475
confident_label rate tensor(0.5557, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 898
clean true:888
clean false:10
clean_rate:0.9888641425389755
noisy true:253
noisy false:465
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 718
epoch [156/200] batch [5/28] time 0.208 (0.206) data 0.078 (0.078) loss_x loss_x 0.7515 (0.6184) acc_x 81.2500 (83.1250) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/28] time 0.203 (0.205) data 0.077 (0.078) loss_x loss_x 0.8501 (0.6082) acc_x 78.1250 (82.8125) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/28] time 0.154 (0.200) data 0.077 (0.077) loss_x loss_x 0.8130 (0.6424) acc_x 84.3750 (82.7083) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/28] time 0.202 (0.200) data 0.077 (0.078) loss_x loss_x 0.7642 (0.6589) acc_x 81.2500 (82.0312) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [25/28] time 0.203 (0.200) data 0.078 (0.078) loss_x loss_x 0.5435 (0.6510) acc_x 90.6250 (82.5000) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 454
confident_label rate tensor(0.5705, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 922
clean true:907
clean false:15
clean_rate:0.9837310195227765
noisy true:255
noisy false:439
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 694
epoch [157/200] batch [5/28] time 0.203 (0.206) data 0.078 (0.079) loss_x loss_x 0.4434 (0.5362) acc_x 90.6250 (86.2500) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/28] time 0.204 (0.197) data 0.078 (0.078) loss_x loss_x 0.2330 (0.5087) acc_x 100.0000 (88.1250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/28] time 0.205 (0.199) data 0.078 (0.078) loss_x loss_x 0.4236 (0.5292) acc_x 93.7500 (87.5000) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/28] time 0.202 (0.200) data 0.077 (0.078) loss_x loss_x 0.4646 (0.5259) acc_x 84.3750 (86.7188) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [25/28] time 0.203 (0.201) data 0.078 (0.078) loss_x loss_x 0.5303 (0.5454) acc_x 87.5000 (86.1250) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 461
confident_label rate tensor(0.5681, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 918
clean true:904
clean false:14
clean_rate:0.9847494553376906
noisy true:251
noisy false:447
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 698
epoch [158/200] batch [5/28] time 0.202 (0.202) data 0.077 (0.078) loss_x loss_x 0.7061 (0.7226) acc_x 84.3750 (83.7500) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/28] time 0.201 (0.203) data 0.077 (0.079) loss_x loss_x 0.8066 (0.6967) acc_x 84.3750 (82.8125) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [15/28] time 0.203 (0.203) data 0.078 (0.079) loss_x loss_x 0.4788 (0.6573) acc_x 84.3750 (83.7500) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/28] time 0.202 (0.203) data 0.077 (0.078) loss_x loss_x 0.8774 (0.6652) acc_x 71.8750 (82.6562) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [25/28] time 0.203 (0.203) data 0.077 (0.078) loss_x loss_x 0.2976 (0.6347) acc_x 87.5000 (83.3750) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 477
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 903
clean true:889
clean false:14
clean_rate:0.9844961240310077
noisy true:250
noisy false:463
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 713
epoch [159/200] batch [5/28] time 0.205 (0.204) data 0.078 (0.077) loss_x loss_x 0.7832 (0.7951) acc_x 84.3750 (82.5000) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/28] time 0.202 (0.203) data 0.078 (0.077) loss_x loss_x 0.4243 (0.6592) acc_x 90.6250 (84.6875) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [15/28] time 0.201 (0.204) data 0.077 (0.078) loss_x loss_x 0.8203 (0.6892) acc_x 84.3750 (84.3750) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/28] time 0.206 (0.204) data 0.076 (0.078) loss_x loss_x 0.8457 (0.6839) acc_x 75.0000 (83.4375) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [25/28] time 0.203 (0.204) data 0.077 (0.078) loss_x loss_x 0.7817 (0.6802) acc_x 81.2500 (83.1250) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 440
confident_label rate tensor(0.5699, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 921
clean true:906
clean false:15
clean_rate:0.9837133550488599
noisy true:270
noisy false:425
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 695
epoch [160/200] batch [5/28] time 0.204 (0.203) data 0.079 (0.078) loss_x loss_x 0.4807 (0.5841) acc_x 84.3750 (84.3750) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/28] time 0.203 (0.203) data 0.080 (0.078) loss_x loss_x 0.6250 (0.6484) acc_x 84.3750 (83.4375) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [15/28] time 0.201 (0.202) data 0.076 (0.077) loss_x loss_x 0.6494 (0.6116) acc_x 81.2500 (84.3750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/28] time 0.205 (0.200) data 0.078 (0.077) loss_x loss_x 0.5420 (0.5975) acc_x 87.5000 (84.8438) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [25/28] time 0.203 (0.200) data 0.078 (0.077) loss_x loss_x 0.9395 (0.6032) acc_x 78.1250 (85.0000) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 461
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 909
clean true:895
clean false:14
clean_rate:0.9845984598459846
noisy true:260
noisy false:447
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 707
epoch [161/200] batch [5/28] time 0.203 (0.205) data 0.079 (0.080) loss_x loss_x 0.5679 (0.6428) acc_x 87.5000 (83.1250) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/28] time 0.208 (0.205) data 0.078 (0.079) loss_x loss_x 0.4258 (0.6145) acc_x 87.5000 (82.8125) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [15/28] time 0.203 (0.205) data 0.077 (0.079) loss_x loss_x 0.5884 (0.5947) acc_x 87.5000 (83.7500) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/28] time 0.204 (0.205) data 0.079 (0.079) loss_x loss_x 0.4109 (0.5963) acc_x 84.3750 (83.7500) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [25/28] time 0.206 (0.205) data 0.077 (0.079) loss_x loss_x 0.6060 (0.5867) acc_x 87.5000 (84.5000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 468
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 897
clean true:886
clean false:11
clean_rate:0.987736900780379
noisy true:262
noisy false:457
after delete: len(clean_dataset) 897
after delete: len(noisy_dataset) 719
epoch [162/200] batch [5/28] time 0.204 (0.187) data 0.078 (0.078) loss_x loss_x 0.8975 (0.7857) acc_x 71.8750 (79.3750) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/28] time 0.201 (0.195) data 0.077 (0.078) loss_x loss_x 0.6484 (0.6605) acc_x 84.3750 (81.5625) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [15/28] time 0.200 (0.198) data 0.076 (0.078) loss_x loss_x 0.4221 (0.6165) acc_x 90.6250 (82.7083) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/28] time 0.207 (0.199) data 0.083 (0.078) loss_x loss_x 0.6924 (0.6167) acc_x 84.3750 (83.2812) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [25/28] time 0.205 (0.200) data 0.080 (0.078) loss_x loss_x 0.8916 (0.6435) acc_x 71.8750 (82.3750) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 462
confident_label rate tensor(0.5668, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 916
clean true:902
clean false:14
clean_rate:0.9847161572052402
noisy true:252
noisy false:448
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 700
epoch [163/200] batch [5/28] time 0.203 (0.206) data 0.078 (0.080) loss_x loss_x 0.4937 (0.6549) acc_x 87.5000 (81.8750) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/28] time 0.203 (0.205) data 0.079 (0.079) loss_x loss_x 0.5415 (0.5961) acc_x 87.5000 (82.8125) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [15/28] time 0.200 (0.203) data 0.076 (0.078) loss_x loss_x 0.5830 (0.5964) acc_x 84.3750 (83.1250) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/28] time 0.201 (0.203) data 0.077 (0.078) loss_x loss_x 0.5181 (0.5682) acc_x 84.3750 (83.9062) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [25/28] time 0.203 (0.204) data 0.077 (0.078) loss_x loss_x 0.9878 (0.6057) acc_x 78.1250 (83.3750) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 466
confident_label rate tensor(0.5637, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 911
clean true:895
clean false:16
clean_rate:0.9824368825466521
noisy true:255
noisy false:450
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 705
epoch [164/200] batch [5/28] time 0.202 (0.202) data 0.076 (0.077) loss_x loss_x 0.4207 (0.3548) acc_x 93.7500 (91.8750) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/28] time 0.202 (0.202) data 0.077 (0.078) loss_x loss_x 0.6587 (0.4866) acc_x 84.3750 (86.5625) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/28] time 0.201 (0.202) data 0.077 (0.077) loss_x loss_x 0.7007 (0.5243) acc_x 84.3750 (86.0417) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/28] time 0.199 (0.200) data 0.076 (0.077) loss_x loss_x 0.4763 (0.5206) acc_x 90.6250 (86.5625) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [25/28] time 0.202 (0.200) data 0.077 (0.077) loss_x loss_x 0.6509 (0.5679) acc_x 81.2500 (85.0000) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 897
clean true:881
clean false:16
clean_rate:0.9821627647714605
noisy true:264
noisy false:455
after delete: len(clean_dataset) 897
after delete: len(noisy_dataset) 719
epoch [165/200] batch [5/28] time 0.203 (0.204) data 0.075 (0.076) loss_x loss_x 0.7544 (0.6547) acc_x 78.1250 (83.7500) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/28] time 0.205 (0.203) data 0.077 (0.077) loss_x loss_x 0.5283 (0.6726) acc_x 87.5000 (83.7500) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [15/28] time 0.203 (0.203) data 0.077 (0.077) loss_x loss_x 0.5264 (0.6670) acc_x 84.3750 (83.3333) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/28] time 0.202 (0.203) data 0.077 (0.077) loss_x loss_x 0.4209 (0.6287) acc_x 81.2500 (83.5938) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [25/28] time 0.173 (0.199) data 0.077 (0.077) loss_x loss_x 0.4236 (0.6285) acc_x 93.7500 (84.3750) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.5712, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 923
clean true:907
clean false:16
clean_rate:0.9826652221018418
noisy true:266
noisy false:427
after delete: len(clean_dataset) 923
after delete: len(noisy_dataset) 693
epoch [166/200] batch [5/28] time 0.203 (0.206) data 0.078 (0.079) loss_x loss_x 0.4651 (0.6618) acc_x 84.3750 (83.1250) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/28] time 0.208 (0.205) data 0.079 (0.078) loss_x loss_x 0.4082 (0.5999) acc_x 87.5000 (85.0000) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [15/28] time 0.203 (0.204) data 0.077 (0.078) loss_x loss_x 0.4419 (0.5980) acc_x 84.3750 (84.1667) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/28] time 0.202 (0.204) data 0.077 (0.077) loss_x loss_x 0.8154 (0.6583) acc_x 75.0000 (82.9688) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [25/28] time 0.156 (0.199) data 0.078 (0.077) loss_x loss_x 0.5107 (0.6635) acc_x 90.6250 (82.8750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 465
confident_label rate tensor(0.5650, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 913
clean true:898
clean false:15
clean_rate:0.9835706462212487
noisy true:253
noisy false:450
after delete: len(clean_dataset) 913
after delete: len(noisy_dataset) 703
epoch [167/200] batch [5/28] time 0.201 (0.201) data 0.076 (0.077) loss_x loss_x 0.9619 (0.8578) acc_x 68.7500 (75.6250) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/28] time 0.205 (0.199) data 0.078 (0.077) loss_x loss_x 0.7964 (0.7034) acc_x 81.2500 (80.6250) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/28] time 0.201 (0.201) data 0.077 (0.078) loss_x loss_x 0.6431 (0.6512) acc_x 78.1250 (81.8750) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/28] time 0.203 (0.201) data 0.079 (0.078) loss_x loss_x 0.5425 (0.6212) acc_x 81.2500 (82.9688) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [25/28] time 0.204 (0.201) data 0.078 (0.078) loss_x loss_x 0.6855 (0.6221) acc_x 78.1250 (83.2500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 445
confident_label rate tensor(0.5749, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 929
clean true:915
clean false:14
clean_rate:0.984930032292788
noisy true:256
noisy false:431
after delete: len(clean_dataset) 929
after delete: len(noisy_dataset) 687
epoch [168/200] batch [5/29] time 0.200 (0.207) data 0.076 (0.077) loss_x loss_x 0.8457 (0.7060) acc_x 71.8750 (78.7500) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/29] time 0.200 (0.205) data 0.076 (0.077) loss_x loss_x 0.8989 (0.6478) acc_x 75.0000 (82.5000) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/29] time 0.209 (0.205) data 0.085 (0.078) loss_x loss_x 0.5605 (0.6829) acc_x 90.6250 (82.9167) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/29] time 0.201 (0.205) data 0.077 (0.078) loss_x loss_x 0.6274 (0.7113) acc_x 87.5000 (82.8125) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [25/29] time 0.200 (0.204) data 0.077 (0.077) loss_x loss_x 0.7559 (0.7001) acc_x 78.1250 (83.0000) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.5613, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 907
clean true:890
clean false:17
clean_rate:0.9812568908489526
noisy true:236
noisy false:473
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 709
epoch [169/200] batch [5/28] time 0.202 (0.202) data 0.077 (0.077) loss_x loss_x 0.8242 (0.6506) acc_x 71.8750 (83.1250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [10/28] time 0.201 (0.202) data 0.076 (0.077) loss_x loss_x 1.3018 (0.7368) acc_x 62.5000 (79.0625) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/28] time 0.202 (0.202) data 0.077 (0.077) loss_x loss_x 0.6030 (0.7257) acc_x 81.2500 (80.0000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/28] time 0.204 (0.202) data 0.076 (0.077) loss_x loss_x 0.6216 (0.6844) acc_x 87.5000 (81.8750) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [25/28] time 0.202 (0.202) data 0.077 (0.077) loss_x loss_x 0.3098 (0.6689) acc_x 96.8750 (82.3750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.5514, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 891
clean true:876
clean false:15
clean_rate:0.9831649831649831
noisy true:269
noisy false:456
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 725
epoch [170/200] batch [5/27] time 0.205 (0.203) data 0.078 (0.077) loss_x loss_x 0.5811 (0.5635) acc_x 81.2500 (85.6250) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/27] time 0.203 (0.195) data 0.078 (0.077) loss_x loss_x 0.4170 (0.5293) acc_x 87.5000 (86.5625) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/27] time 0.201 (0.197) data 0.077 (0.077) loss_x loss_x 0.4507 (0.5686) acc_x 84.3750 (84.5833) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/27] time 0.202 (0.198) data 0.077 (0.078) loss_x loss_x 0.2356 (0.5819) acc_x 93.7500 (84.8438) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [25/27] time 0.202 (0.199) data 0.078 (0.077) loss_x loss_x 0.5020 (0.5800) acc_x 87.5000 (85.1250) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.5594, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 904
clean true:891
clean false:13
clean_rate:0.9856194690265486
noisy true:261
noisy false:451
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 712
epoch [171/200] batch [5/28] time 0.202 (0.211) data 0.077 (0.077) loss_x loss_x 0.9214 (0.7163) acc_x 78.1250 (78.1250) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [10/28] time 0.203 (0.207) data 0.078 (0.078) loss_x loss_x 0.8438 (0.6276) acc_x 78.1250 (82.8125) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [15/28] time 0.209 (0.206) data 0.084 (0.078) loss_x loss_x 0.4707 (0.6032) acc_x 90.6250 (83.5417) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/28] time 0.200 (0.205) data 0.077 (0.078) loss_x loss_x 0.6465 (0.6199) acc_x 78.1250 (82.9688) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [25/28] time 0.154 (0.203) data 0.077 (0.078) loss_x loss_x 0.4404 (0.5980) acc_x 90.6250 (83.5000) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 477
confident_label rate tensor(0.5501, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 889
clean true:875
clean false:14
clean_rate:0.984251968503937
noisy true:264
noisy false:463
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 727
epoch [172/200] batch [5/27] time 0.202 (0.201) data 0.076 (0.077) loss_x loss_x 0.7188 (0.7014) acc_x 84.3750 (83.1250) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/27] time 0.201 (0.202) data 0.077 (0.077) loss_x loss_x 0.4597 (0.6303) acc_x 90.6250 (83.7500) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/27] time 0.201 (0.202) data 0.077 (0.077) loss_x loss_x 0.5796 (0.6232) acc_x 84.3750 (82.9167) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/27] time 0.203 (0.199) data 0.077 (0.077) loss_x loss_x 0.4629 (0.6217) acc_x 87.5000 (82.9688) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [25/27] time 0.206 (0.200) data 0.078 (0.077) loss_x loss_x 0.3235 (0.6056) acc_x 84.3750 (82.8750) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 451
confident_label rate tensor(0.5675, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 917
clean true:902
clean false:15
clean_rate:0.9836423118865867
noisy true:263
noisy false:436
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 699
epoch [173/200] batch [5/28] time 0.205 (0.204) data 0.078 (0.078) loss_x loss_x 0.6270 (0.5216) acc_x 84.3750 (86.8750) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/28] time 0.204 (0.203) data 0.078 (0.078) loss_x loss_x 0.2307 (0.5646) acc_x 93.7500 (85.6250) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/28] time 0.204 (0.204) data 0.078 (0.078) loss_x loss_x 1.2246 (0.6412) acc_x 71.8750 (84.1667) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/28] time 0.205 (0.204) data 0.078 (0.078) loss_x loss_x 0.4421 (0.6204) acc_x 90.6250 (85.4688) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [25/28] time 0.206 (0.204) data 0.080 (0.078) loss_x loss_x 0.5757 (0.6213) acc_x 81.2500 (84.8750) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.5681, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 918
clean true:903
clean false:15
clean_rate:0.9836601307189542
noisy true:260
noisy false:438
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 698
epoch [174/200] batch [5/28] time 0.201 (0.187) data 0.076 (0.077) loss_x loss_x 0.8311 (0.7993) acc_x 71.8750 (78.7500) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/28] time 0.208 (0.196) data 0.078 (0.078) loss_x loss_x 0.4910 (0.7312) acc_x 90.6250 (80.6250) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [15/28] time 0.200 (0.198) data 0.076 (0.078) loss_x loss_x 0.8369 (0.7101) acc_x 71.8750 (81.6667) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/28] time 0.200 (0.200) data 0.077 (0.078) loss_x loss_x 0.9414 (0.7021) acc_x 71.8750 (81.7188) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [25/28] time 0.202 (0.201) data 0.076 (0.078) loss_x loss_x 0.6753 (0.6760) acc_x 81.2500 (82.2500) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 455
confident_label rate tensor(0.5662, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 915
clean true:901
clean false:14
clean_rate:0.9846994535519126
noisy true:260
noisy false:441
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 701
epoch [175/200] batch [5/28] time 0.202 (0.202) data 0.077 (0.078) loss_x loss_x 0.4722 (0.4809) acc_x 84.3750 (86.8750) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/28] time 0.204 (0.203) data 0.078 (0.078) loss_x loss_x 0.6880 (0.5388) acc_x 81.2500 (86.2500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [15/28] time 0.154 (0.199) data 0.077 (0.078) loss_x loss_x 0.8442 (0.5372) acc_x 78.1250 (86.4583) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/28] time 0.202 (0.201) data 0.078 (0.078) loss_x loss_x 0.5820 (0.5900) acc_x 84.3750 (85.0000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [25/28] time 0.202 (0.201) data 0.078 (0.078) loss_x loss_x 0.4460 (0.5857) acc_x 87.5000 (85.0000) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 447
confident_label rate tensor(0.5681, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 918
clean true:905
clean false:13
clean_rate:0.985838779956427
noisy true:264
noisy false:434
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 698
epoch [176/200] batch [5/28] time 0.212 (0.204) data 0.086 (0.079) loss_x loss_x 0.3472 (0.5010) acc_x 93.7500 (86.2500) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/28] time 0.201 (0.203) data 0.078 (0.078) loss_x loss_x 0.6572 (0.5318) acc_x 81.2500 (85.3125) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/28] time 0.208 (0.204) data 0.083 (0.078) loss_x loss_x 0.7773 (0.5964) acc_x 71.8750 (82.7083) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/28] time 0.209 (0.204) data 0.078 (0.078) loss_x loss_x 0.6074 (0.6360) acc_x 84.3750 (82.6562) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [25/28] time 0.203 (0.204) data 0.078 (0.078) loss_x loss_x 0.5264 (0.6267) acc_x 87.5000 (83.2500) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 454
confident_label rate tensor(0.5675, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 917
clean true:901
clean false:16
clean_rate:0.9825517993456925
noisy true:261
noisy false:438
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 699
epoch [177/200] batch [5/28] time 0.202 (0.202) data 0.077 (0.078) loss_x loss_x 0.5273 (0.5963) acc_x 84.3750 (84.3750) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/28] time 0.201 (0.203) data 0.078 (0.078) loss_x loss_x 0.6265 (0.5766) acc_x 78.1250 (84.0625) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/28] time 0.211 (0.203) data 0.086 (0.078) loss_x loss_x 0.2957 (0.5710) acc_x 90.6250 (85.0000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/28] time 0.204 (0.204) data 0.079 (0.078) loss_x loss_x 0.6689 (0.5767) acc_x 81.2500 (84.8438) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [25/28] time 0.202 (0.202) data 0.077 (0.078) loss_x loss_x 0.4504 (0.5803) acc_x 87.5000 (85.2500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 468
confident_label rate tensor(0.5644, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 912
clean true:902
clean false:10
clean_rate:0.9890350877192983
noisy true:246
noisy false:458
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 704
epoch [178/200] batch [5/28] time 0.200 (0.202) data 0.077 (0.078) loss_x loss_x 0.5615 (0.6770) acc_x 84.3750 (84.3750) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/28] time 0.223 (0.197) data 0.077 (0.077) loss_x loss_x 0.7432 (0.6135) acc_x 84.3750 (86.5625) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/28] time 0.201 (0.199) data 0.078 (0.077) loss_x loss_x 0.6992 (0.6333) acc_x 81.2500 (85.0000) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/28] time 0.201 (0.200) data 0.077 (0.077) loss_x loss_x 0.3887 (0.6522) acc_x 87.5000 (83.7500) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [25/28] time 0.202 (0.201) data 0.077 (0.077) loss_x loss_x 0.4165 (0.6297) acc_x 87.5000 (84.2500) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 474
confident_label rate tensor(0.5619, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 908
clean true:893
clean false:15
clean_rate:0.9834801762114538
noisy true:249
noisy false:459
after delete: len(clean_dataset) 908
after delete: len(noisy_dataset) 708
epoch [179/200] batch [5/28] time 0.203 (0.204) data 0.077 (0.077) loss_x loss_x 0.6899 (0.6317) acc_x 78.1250 (83.1250) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/28] time 0.203 (0.203) data 0.077 (0.078) loss_x loss_x 0.5850 (0.6081) acc_x 90.6250 (85.3125) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/28] time 0.204 (0.199) data 0.079 (0.078) loss_x loss_x 0.4868 (0.5999) acc_x 90.6250 (86.2500) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/28] time 0.204 (0.200) data 0.078 (0.079) loss_x loss_x 0.8496 (0.6117) acc_x 78.1250 (84.5312) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [25/28] time 0.203 (0.201) data 0.077 (0.078) loss_x loss_x 0.2710 (0.5776) acc_x 93.7500 (85.5000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.5613, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 907
clean true:892
clean false:15
clean_rate:0.9834619625137817
noisy true:252
noisy false:457
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 709
epoch [180/200] batch [5/28] time 0.202 (0.203) data 0.077 (0.077) loss_x loss_x 0.5112 (0.5245) acc_x 84.3750 (85.0000) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/28] time 0.209 (0.203) data 0.086 (0.078) loss_x loss_x 0.8027 (0.5378) acc_x 78.1250 (85.0000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/28] time 0.202 (0.203) data 0.076 (0.077) loss_x loss_x 1.2070 (0.5843) acc_x 68.7500 (83.3333) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/28] time 0.205 (0.203) data 0.078 (0.077) loss_x loss_x 0.5054 (0.6174) acc_x 87.5000 (82.8125) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [25/28] time 0.204 (0.203) data 0.079 (0.077) loss_x loss_x 0.5474 (0.6203) acc_x 87.5000 (83.2500) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.5526, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 893
clean true:877
clean false:16
clean_rate:0.9820828667413214
noisy true:254
noisy false:469
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 723
epoch [181/200] batch [5/27] time 0.208 (0.207) data 0.079 (0.081) loss_x loss_x 0.7432 (0.4860) acc_x 81.2500 (89.3750) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/27] time 0.202 (0.205) data 0.078 (0.079) loss_x loss_x 0.9390 (0.6178) acc_x 71.8750 (84.6875) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/27] time 0.204 (0.205) data 0.079 (0.079) loss_x loss_x 0.7397 (0.6357) acc_x 78.1250 (83.9583) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/27] time 0.203 (0.205) data 0.076 (0.078) loss_x loss_x 1.0117 (0.6423) acc_x 71.8750 (83.5938) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/27] time 0.203 (0.204) data 0.076 (0.078) loss_x loss_x 0.9312 (0.6375) acc_x 75.0000 (84.0000) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 456
confident_label rate tensor(0.5644, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 912
clean true:899
clean false:13
clean_rate:0.9857456140350878
noisy true:261
noisy false:443
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 704
epoch [182/200] batch [5/28] time 0.202 (0.206) data 0.078 (0.079) loss_x loss_x 0.5566 (0.5273) acc_x 81.2500 (86.8750) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/28] time 0.204 (0.204) data 0.077 (0.078) loss_x loss_x 0.5322 (0.5727) acc_x 84.3750 (84.3750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/28] time 0.205 (0.201) data 0.077 (0.078) loss_x loss_x 0.6118 (0.5996) acc_x 84.3750 (83.7500) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/28] time 0.205 (0.202) data 0.079 (0.078) loss_x loss_x 0.8442 (0.6227) acc_x 81.2500 (82.5000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/28] time 0.204 (0.202) data 0.077 (0.078) loss_x loss_x 0.6279 (0.6090) acc_x 84.3750 (83.1250) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 449
confident_label rate tensor(0.5687, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 919
clean true:898
clean false:21
clean_rate:0.9771490750816104
noisy true:269
noisy false:428
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 697
epoch [183/200] batch [5/28] time 0.201 (0.205) data 0.077 (0.080) loss_x loss_x 0.5420 (0.6592) acc_x 93.7500 (85.0000) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/28] time 0.201 (0.205) data 0.076 (0.080) loss_x loss_x 0.8115 (0.6484) acc_x 78.1250 (84.0625) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/28] time 0.202 (0.205) data 0.078 (0.079) loss_x loss_x 0.3757 (0.6016) acc_x 96.8750 (84.7917) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/28] time 0.200 (0.204) data 0.076 (0.079) loss_x loss_x 0.4744 (0.5955) acc_x 87.5000 (85.3125) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/28] time 0.201 (0.204) data 0.077 (0.078) loss_x loss_x 0.8608 (0.6155) acc_x 78.1250 (84.5000) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.5575, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 901
clean true:879
clean false:22
clean_rate:0.9755826859045506
noisy true:252
noisy false:463
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 715
epoch [184/200] batch [5/28] time 0.206 (0.206) data 0.078 (0.079) loss_x loss_x 0.4084 (0.5825) acc_x 84.3750 (85.0000) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/28] time 0.155 (0.196) data 0.078 (0.079) loss_x loss_x 0.7246 (0.6841) acc_x 75.0000 (83.1250) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/28] time 0.202 (0.199) data 0.078 (0.079) loss_x loss_x 0.3936 (0.6516) acc_x 90.6250 (83.3333) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/28] time 0.205 (0.200) data 0.077 (0.079) loss_x loss_x 0.4998 (0.6118) acc_x 84.3750 (83.5938) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [25/28] time 0.200 (0.201) data 0.077 (0.078) loss_x loss_x 0.9385 (0.6257) acc_x 78.1250 (83.5000) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.5699, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 921
clean true:908
clean false:13
clean_rate:0.9858849077090119
noisy true:265
noisy false:430
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 695
epoch [185/200] batch [5/28] time 0.203 (0.204) data 0.079 (0.078) loss_x loss_x 0.1013 (0.4321) acc_x 100.0000 (93.1250) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/28] time 0.203 (0.204) data 0.076 (0.078) loss_x loss_x 0.7344 (0.5464) acc_x 78.1250 (87.5000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/28] time 0.205 (0.198) data 0.078 (0.078) loss_x loss_x 0.6450 (0.5730) acc_x 84.3750 (87.2917) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/28] time 0.166 (0.197) data 0.078 (0.078) loss_x loss_x 0.6470 (0.5451) acc_x 81.2500 (87.1875) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [25/28] time 0.211 (0.199) data 0.087 (0.078) loss_x loss_x 0.4683 (0.5291) acc_x 84.3750 (87.1250) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 462
confident_label rate tensor(0.5644, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 912
clean true:895
clean false:17
clean_rate:0.981359649122807
noisy true:259
noisy false:445
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 704
epoch [186/200] batch [5/28] time 0.203 (0.212) data 0.078 (0.077) loss_x loss_x 0.9502 (0.7516) acc_x 75.0000 (79.3750) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/28] time 0.202 (0.207) data 0.077 (0.078) loss_x loss_x 0.4294 (0.6266) acc_x 87.5000 (82.1875) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/28] time 0.206 (0.206) data 0.077 (0.078) loss_x loss_x 0.4058 (0.6254) acc_x 84.3750 (82.9167) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/28] time 0.202 (0.205) data 0.077 (0.078) loss_x loss_x 0.4688 (0.6198) acc_x 84.3750 (83.2812) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [25/28] time 0.205 (0.203) data 0.077 (0.077) loss_x loss_x 0.7358 (0.6233) acc_x 84.3750 (83.7500) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 483
confident_label rate tensor(0.5520, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 892
clean true:879
clean false:13
clean_rate:0.9854260089686099
noisy true:254
noisy false:470
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 724
epoch [187/200] batch [5/27] time 0.203 (0.203) data 0.077 (0.078) loss_x loss_x 0.6069 (0.5777) acc_x 87.5000 (87.5000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/27] time 0.204 (0.204) data 0.078 (0.079) loss_x loss_x 1.0029 (0.6527) acc_x 71.8750 (83.7500) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/27] time 0.204 (0.204) data 0.077 (0.078) loss_x loss_x 0.8101 (0.6408) acc_x 84.3750 (84.7917) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/27] time 0.208 (0.204) data 0.078 (0.078) loss_x loss_x 0.4746 (0.6755) acc_x 87.5000 (83.5938) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [25/27] time 0.201 (0.200) data 0.078 (0.078) loss_x loss_x 0.6133 (0.6630) acc_x 84.3750 (83.3750) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 470
confident_label rate tensor(0.5637, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 911
clean true:892
clean false:19
clean_rate:0.9791437980241493
noisy true:254
noisy false:451
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 705
epoch [188/200] batch [5/28] time 0.202 (0.201) data 0.078 (0.077) loss_x loss_x 0.6870 (0.8954) acc_x 81.2500 (79.3750) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/28] time 0.202 (0.202) data 0.077 (0.077) loss_x loss_x 0.6768 (0.6999) acc_x 84.3750 (84.0625) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/28] time 0.155 (0.198) data 0.077 (0.077) loss_x loss_x 0.4668 (0.6357) acc_x 87.5000 (84.1667) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/28] time 0.204 (0.200) data 0.078 (0.077) loss_x loss_x 0.2927 (0.5898) acc_x 87.5000 (85.1562) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [25/28] time 0.202 (0.201) data 0.076 (0.078) loss_x loss_x 0.9116 (0.5991) acc_x 75.0000 (84.7500) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 451
confident_label rate tensor(0.5705, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 922
clean true:905
clean false:17
clean_rate:0.9815618221258134
noisy true:260
noisy false:434
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 694
epoch [189/200] batch [5/28] time 0.202 (0.203) data 0.077 (0.078) loss_x loss_x 0.3896 (0.4668) acc_x 87.5000 (89.3750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/28] time 0.203 (0.203) data 0.078 (0.077) loss_x loss_x 0.9385 (0.5814) acc_x 81.2500 (87.5000) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/28] time 0.208 (0.204) data 0.078 (0.078) loss_x loss_x 0.8247 (0.6195) acc_x 81.2500 (85.8333) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/28] time 0.204 (0.204) data 0.078 (0.078) loss_x loss_x 0.7280 (0.6353) acc_x 81.2500 (85.0000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [25/28] time 0.204 (0.204) data 0.078 (0.078) loss_x loss_x 0.7290 (0.6494) acc_x 87.5000 (84.6250) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 454
confident_label rate tensor(0.5693, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 920
clean true:904
clean false:16
clean_rate:0.9826086956521739
noisy true:258
noisy false:438
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 696
epoch [190/200] batch [5/28] time 0.203 (0.209) data 0.076 (0.077) loss_x loss_x 1.1406 (0.6812) acc_x 71.8750 (84.3750) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/28] time 0.206 (0.205) data 0.079 (0.077) loss_x loss_x 1.1963 (0.7656) acc_x 78.1250 (83.1250) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/28] time 0.207 (0.204) data 0.079 (0.077) loss_x loss_x 0.7905 (0.7346) acc_x 81.2500 (83.5417) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/28] time 0.205 (0.205) data 0.079 (0.078) loss_x loss_x 0.2593 (0.6938) acc_x 93.7500 (84.2188) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/28] time 0.201 (0.204) data 0.077 (0.078) loss_x loss_x 0.4312 (0.6900) acc_x 90.6250 (84.5000) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.5687, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 919
clean true:902
clean false:17
clean_rate:0.9815016322089227
noisy true:261
noisy false:436
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 697
epoch [191/200] batch [5/28] time 0.198 (0.201) data 0.076 (0.077) loss_x loss_x 0.3972 (0.5711) acc_x 87.5000 (85.0000) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/28] time 0.201 (0.202) data 0.076 (0.078) loss_x loss_x 0.4768 (0.5648) acc_x 87.5000 (83.4375) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/28] time 0.202 (0.202) data 0.077 (0.078) loss_x loss_x 0.8345 (0.5788) acc_x 84.3750 (83.9583) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/28] time 0.181 (0.199) data 0.076 (0.077) loss_x loss_x 0.8989 (0.6348) acc_x 78.1250 (82.3438) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/28] time 0.201 (0.199) data 0.076 (0.078) loss_x loss_x 0.6108 (0.6246) acc_x 87.5000 (83.0000) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 479
confident_label rate tensor(0.5520, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 892
clean true:878
clean false:14
clean_rate:0.984304932735426
noisy true:259
noisy false:465
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 724
epoch [192/200] batch [5/27] time 0.202 (0.203) data 0.078 (0.078) loss_x loss_x 0.7861 (0.6062) acc_x 81.2500 (86.8750) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/27] time 0.203 (0.203) data 0.079 (0.078) loss_x loss_x 0.9849 (0.6829) acc_x 78.1250 (83.7500) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/27] time 0.204 (0.203) data 0.080 (0.078) loss_x loss_x 0.7261 (0.7097) acc_x 84.3750 (82.0833) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/27] time 0.201 (0.203) data 0.077 (0.077) loss_x loss_x 0.9780 (0.6800) acc_x 78.1250 (82.9688) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [25/27] time 0.200 (0.203) data 0.076 (0.077) loss_x loss_x 0.5835 (0.6530) acc_x 84.3750 (83.6250) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 474
confident_label rate tensor(0.5675, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 917
clean true:900
clean false:17
clean_rate:0.9814612868047983
noisy true:242
noisy false:457
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 699
epoch [193/200] batch [5/28] time 0.203 (0.204) data 0.076 (0.077) loss_x loss_x 0.8921 (0.5858) acc_x 81.2500 (86.2500) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/28] time 0.202 (0.204) data 0.077 (0.077) loss_x loss_x 0.8789 (0.6181) acc_x 71.8750 (84.6875) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/28] time 0.203 (0.204) data 0.076 (0.077) loss_x loss_x 0.5908 (0.5635) acc_x 87.5000 (85.8333) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/28] time 0.162 (0.202) data 0.078 (0.078) loss_x loss_x 0.3811 (0.5806) acc_x 93.7500 (85.7812) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/28] time 0.204 (0.200) data 0.077 (0.078) loss_x loss_x 0.5991 (0.5771) acc_x 81.2500 (85.2500) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 479
confident_label rate tensor(0.5532, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 894
clean true:875
clean false:19
clean_rate:0.9787472035794184
noisy true:262
noisy false:460
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 722
epoch [194/200] batch [5/27] time 0.203 (0.204) data 0.077 (0.078) loss_x loss_x 0.4160 (0.5747) acc_x 84.3750 (81.8750) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/27] time 0.203 (0.204) data 0.077 (0.077) loss_x loss_x 0.9897 (0.6647) acc_x 71.8750 (80.9375) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/27] time 0.164 (0.201) data 0.087 (0.078) loss_x loss_x 0.7163 (0.6536) acc_x 81.2500 (81.4583) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/27] time 0.203 (0.201) data 0.078 (0.078) loss_x loss_x 0.2452 (0.6366) acc_x 90.6250 (82.6562) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [25/27] time 0.202 (0.201) data 0.077 (0.078) loss_x loss_x 0.9946 (0.6607) acc_x 75.0000 (82.5000) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.5662, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 915
clean true:898
clean false:17
clean_rate:0.9814207650273225
noisy true:247
noisy false:454
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 701
epoch [195/200] batch [5/28] time 0.204 (0.204) data 0.079 (0.078) loss_x loss_x 0.3088 (0.7584) acc_x 93.7500 (85.0000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/28] time 0.199 (0.203) data 0.078 (0.078) loss_x loss_x 0.4834 (0.6736) acc_x 84.3750 (83.7500) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/28] time 0.208 (0.203) data 0.085 (0.078) loss_x loss_x 0.6128 (0.6714) acc_x 90.6250 (84.5833) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/28] time 0.205 (0.203) data 0.079 (0.078) loss_x loss_x 0.6758 (0.6456) acc_x 84.3750 (85.1562) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [25/28] time 0.154 (0.201) data 0.077 (0.078) loss_x loss_x 0.5762 (0.6450) acc_x 84.3750 (84.5000) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 458
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 905
clean true:892
clean false:13
clean_rate:0.9856353591160221
noisy true:266
noisy false:445
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 711
epoch [196/200] batch [5/28] time 0.204 (0.210) data 0.078 (0.078) loss_x loss_x 0.7896 (0.6740) acc_x 90.6250 (84.3750) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/28] time 0.203 (0.207) data 0.079 (0.078) loss_x loss_x 0.4365 (0.5304) acc_x 90.6250 (88.4375) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/28] time 0.203 (0.206) data 0.078 (0.078) loss_x loss_x 0.5762 (0.6114) acc_x 81.2500 (85.2083) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/28] time 0.204 (0.206) data 0.077 (0.078) loss_x loss_x 0.6831 (0.6045) acc_x 78.1250 (85.1562) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/28] time 0.208 (0.206) data 0.077 (0.078) loss_x loss_x 0.4346 (0.6008) acc_x 93.7500 (85.6250) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 449
confident_label rate tensor(0.5743, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 928
clean true:914
clean false:14
clean_rate:0.9849137931034483
noisy true:253
noisy false:435
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 688
epoch [197/200] batch [5/29] time 0.202 (0.210) data 0.077 (0.079) loss_x loss_x 0.5381 (0.5810) acc_x 81.2500 (82.5000) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/29] time 0.203 (0.206) data 0.078 (0.078) loss_x loss_x 0.6987 (0.6149) acc_x 81.2500 (82.8125) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/29] time 0.212 (0.206) data 0.085 (0.079) loss_x loss_x 0.6025 (0.6520) acc_x 87.5000 (83.1250) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/29] time 0.203 (0.205) data 0.077 (0.078) loss_x loss_x 0.5293 (0.6330) acc_x 87.5000 (83.2812) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [25/29] time 0.204 (0.203) data 0.077 (0.078) loss_x loss_x 0.7173 (0.6195) acc_x 78.1250 (83.1250) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.5563, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 899
clean true:885
clean false:14
clean_rate:0.9844271412680756
noisy true:251
noisy false:466
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 717
epoch [198/200] batch [5/28] time 0.203 (0.196) data 0.077 (0.078) loss_x loss_x 0.4390 (0.6113) acc_x 90.6250 (84.3750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/28] time 0.202 (0.199) data 0.078 (0.078) loss_x loss_x 0.8784 (0.6273) acc_x 81.2500 (84.0625) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/28] time 0.198 (0.200) data 0.076 (0.078) loss_x loss_x 0.8696 (0.6023) acc_x 75.0000 (84.1667) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/28] time 0.203 (0.201) data 0.078 (0.078) loss_x loss_x 0.5415 (0.5534) acc_x 90.6250 (85.6250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [25/28] time 0.202 (0.201) data 0.079 (0.078) loss_x loss_x 0.8081 (0.5717) acc_x 75.0000 (85.2500) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 451
confident_label rate tensor(0.5786, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 935
clean true:918
clean false:17
clean_rate:0.9818181818181818
noisy true:247
noisy false:434
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 681
epoch [199/200] batch [5/29] time 0.202 (0.196) data 0.078 (0.078) loss_x loss_x 0.3428 (0.4545) acc_x 93.7500 (90.6250) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/29] time 0.201 (0.198) data 0.077 (0.077) loss_x loss_x 1.3320 (0.5950) acc_x 65.6250 (86.2500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/29] time 0.201 (0.199) data 0.077 (0.078) loss_x loss_x 0.6963 (0.5996) acc_x 87.5000 (86.6667) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/29] time 0.203 (0.200) data 0.078 (0.077) loss_x loss_x 0.5977 (0.6520) acc_x 87.5000 (85.3125) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/29] time 0.202 (0.200) data 0.077 (0.077) loss_x loss_x 0.9512 (0.6689) acc_x 75.0000 (84.6250) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.5538, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 895
clean true:880
clean false:15
clean_rate:0.9832402234636871
noisy true:254
noisy false:467
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 721
epoch [200/200] batch [5/27] time 0.204 (0.200) data 0.076 (0.077) loss_x loss_x 0.7002 (0.6445) acc_x 81.2500 (83.1250) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/27] time 0.207 (0.202) data 0.078 (0.077) loss_x loss_x 0.4194 (0.5785) acc_x 90.6250 (85.9375) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/27] time 0.203 (0.202) data 0.078 (0.077) loss_x loss_x 0.6533 (0.6250) acc_x 81.2500 (84.7917) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/27] time 0.204 (0.203) data 0.079 (0.077) loss_x loss_x 0.2971 (0.5790) acc_x 90.6250 (85.7812) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [25/27] time 0.202 (0.202) data 0.078 (0.077) loss_x loss_x 0.4661 (0.5834) acc_x 90.6250 (85.3750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,761
* accuracy: 73.0%
* error: 27.0%
* macro_f1: 71.1%
Elapsed: 0:59:19
