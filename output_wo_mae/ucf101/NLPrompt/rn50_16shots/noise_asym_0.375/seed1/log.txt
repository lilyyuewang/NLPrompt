***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.2036, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 329
clean true:313
clean false:16
clean_rate:0.9513677811550152
noisy true:199
noisy false:1088
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1287
epoch [1/200] batch [5/10] time 0.182 (0.217) data 0.105 (0.120) loss_x loss_x 2.5918 (2.5195) acc_x 65.6250 (57.5000) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/10] time 0.191 (0.199) data 0.114 (0.112) loss_x loss_x 2.4551 (2.4826) acc_x 37.5000 (54.0625) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1034
confident_label rate tensor(0.2339, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 378
clean true:367
clean false:11
clean_rate:0.9708994708994709
noisy true:215
noisy false:1023
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1238
epoch [2/200] batch [5/11] time 0.169 (0.169) data 0.091 (0.092) loss_x loss_x 1.2607 (1.4596) acc_x 78.1250 (73.1250) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/11] time 0.167 (0.170) data 0.090 (0.092) loss_x loss_x 1.4053 (1.4073) acc_x 59.3750 (68.4375) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 858
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 476
clean true:462
clean false:14
clean_rate:0.9705882352941176
noisy true:296
noisy false:844
after delete: len(clean_dataset) 476
after delete: len(noisy_dataset) 1140
epoch [3/200] batch [5/14] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 1.2812 (1.3479) acc_x 68.7500 (68.7500) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/14] time 0.193 (0.185) data 0.116 (0.108) loss_x loss_x 1.5322 (1.2564) acc_x 59.3750 (70.3125) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 819
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:486
clean false:13
clean_rate:0.9739478957915831
noisy true:311
noisy false:806
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [4/200] batch [5/15] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 1.0166 (1.0329) acc_x 71.8750 (73.7500) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/15] time 0.178 (0.171) data 0.101 (0.094) loss_x loss_x 1.1250 (1.0873) acc_x 78.1250 (73.7500) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [15/15] time 0.169 (0.173) data 0.091 (0.095) loss_x loss_x 1.5156 (1.1711) acc_x 65.6250 (71.0417) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 849
confident_label rate tensor(0.2983, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 482
clean true:466
clean false:16
clean_rate:0.966804979253112
noisy true:301
noisy false:833
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1134
epoch [5/200] batch [5/15] time 0.168 (0.184) data 0.091 (0.107) loss_x loss_x 1.3848 (1.0896) acc_x 68.7500 (74.3750) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/15] time 0.159 (0.178) data 0.081 (0.101) loss_x loss_x 1.2480 (1.1754) acc_x 68.7500 (70.9375) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [15/15] time 0.161 (0.173) data 0.083 (0.096) loss_x loss_x 0.6523 (1.0859) acc_x 81.2500 (73.3333) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 822
confident_label rate tensor(0.3175, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 513
clean true:497
clean false:16
clean_rate:0.9688109161793372
noisy true:297
noisy false:806
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1103
epoch [6/200] batch [5/16] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 1.1094 (1.1356) acc_x 68.7500 (70.0000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/16] time 0.160 (0.182) data 0.082 (0.104) loss_x loss_x 1.1084 (1.1445) acc_x 71.8750 (70.3125) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/16] time 0.166 (0.177) data 0.088 (0.100) loss_x loss_x 0.9043 (1.0279) acc_x 75.0000 (73.5417) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 796
confident_label rate tensor(0.3236, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 523
clean true:513
clean false:10
clean_rate:0.9808795411089866
noisy true:307
noisy false:786
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1093
epoch [7/200] batch [5/16] time 0.184 (0.166) data 0.106 (0.088) loss_x loss_x 1.2744 (1.0835) acc_x 65.6250 (70.6250) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/16] time 0.160 (0.170) data 0.082 (0.092) loss_x loss_x 0.8760 (1.0909) acc_x 84.3750 (71.8750) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/16] time 0.159 (0.167) data 0.082 (0.089) loss_x loss_x 1.0195 (1.0191) acc_x 75.0000 (73.9583) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 801
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:507
clean false:13
clean_rate:0.975
noisy true:308
noisy false:788
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [8/200] batch [5/16] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.8286 (1.0888) acc_x 71.8750 (73.1250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/16] time 0.184 (0.179) data 0.107 (0.101) loss_x loss_x 1.0244 (1.0914) acc_x 68.7500 (72.1875) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/16] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 1.0322 (1.0309) acc_x 71.8750 (73.7500) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 809
confident_label rate tensor(0.3255, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 526
clean true:513
clean false:13
clean_rate:0.9752851711026616
noisy true:294
noisy false:796
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1090
epoch [9/200] batch [5/16] time 0.204 (0.191) data 0.127 (0.113) loss_x loss_x 0.8857 (1.0661) acc_x 81.2500 (71.2500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/16] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 1.5479 (1.0591) acc_x 68.7500 (73.7500) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/16] time 0.173 (0.182) data 0.096 (0.105) loss_x loss_x 0.9736 (1.0767) acc_x 71.8750 (72.7083) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 775
confident_label rate tensor(0.3280, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 530
clean true:515
clean false:15
clean_rate:0.9716981132075472
noisy true:326
noisy false:760
after delete: len(clean_dataset) 530
after delete: len(noisy_dataset) 1086
epoch [10/200] batch [5/16] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 1.1367 (1.0751) acc_x 71.8750 (71.2500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/16] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 1.5439 (1.1233) acc_x 59.3750 (68.4375) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/16] time 0.190 (0.178) data 0.112 (0.101) loss_x loss_x 1.8408 (1.1645) acc_x 50.0000 (67.5000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 784
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 537
clean true:524
clean false:13
clean_rate:0.9757914338919925
noisy true:308
noisy false:771
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1079
epoch [11/200] batch [5/16] time 0.170 (0.166) data 0.093 (0.089) loss_x loss_x 1.0449 (0.9899) acc_x 68.7500 (75.0000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/16] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 1.3623 (0.9932) acc_x 62.5000 (72.8125) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/16] time 0.206 (0.179) data 0.128 (0.102) loss_x loss_x 1.0176 (1.0363) acc_x 75.0000 (72.7083) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 785
confident_label rate tensor(0.3360, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 543
clean true:528
clean false:15
clean_rate:0.9723756906077348
noisy true:303
noisy false:770
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 1073
epoch [12/200] batch [5/16] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 1.3242 (1.0789) acc_x 68.7500 (76.8750) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/16] time 0.182 (0.184) data 0.105 (0.106) loss_x loss_x 1.1777 (1.0792) acc_x 75.0000 (74.3750) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [15/16] time 0.174 (0.179) data 0.097 (0.101) loss_x loss_x 0.8740 (1.0932) acc_x 81.2500 (73.1250) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 775
confident_label rate tensor(0.3366, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 544
clean true:531
clean false:13
clean_rate:0.9761029411764706
noisy true:310
noisy false:762
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 1072
epoch [13/200] batch [5/17] time 0.191 (0.190) data 0.114 (0.113) loss_x loss_x 1.0322 (0.9676) acc_x 81.2500 (75.0000) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/17] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.9624 (0.9556) acc_x 78.1250 (75.3125) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [15/17] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 1.0830 (0.9930) acc_x 71.8750 (75.2083) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 751
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:544
clean false:10
clean_rate:0.9819494584837545
noisy true:321
noisy false:741
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [14/200] batch [5/17] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.9023 (1.0409) acc_x 65.6250 (71.8750) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/17] time 0.196 (0.186) data 0.119 (0.109) loss_x loss_x 0.7178 (1.0390) acc_x 81.2500 (70.9375) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [15/17] time 0.172 (0.188) data 0.095 (0.111) loss_x loss_x 0.7456 (1.0925) acc_x 84.3750 (69.7917) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 768
confident_label rate tensor(0.3366, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 544
clean true:532
clean false:12
clean_rate:0.9779411764705882
noisy true:316
noisy false:756
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 1072
epoch [15/200] batch [5/17] time 0.183 (0.180) data 0.105 (0.103) loss_x loss_x 1.2686 (1.0101) acc_x 65.6250 (71.8750) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/17] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.9331 (0.9621) acc_x 71.8750 (74.0625) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [15/17] time 0.186 (0.186) data 0.109 (0.108) loss_x loss_x 0.9258 (0.9667) acc_x 71.8750 (73.7500) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 713
confident_label rate tensor(0.3595, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 581
clean true:565
clean false:16
clean_rate:0.9724612736660929
noisy true:338
noisy false:697
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1035
epoch [16/200] batch [5/18] time 0.184 (0.178) data 0.106 (0.100) loss_x loss_x 1.2227 (1.1817) acc_x 75.0000 (74.3750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/18] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 1.1436 (1.1341) acc_x 65.6250 (74.0625) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [15/18] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 1.1143 (1.1628) acc_x 75.0000 (72.2917) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 717
confident_label rate tensor(0.3502, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 566
clean true:553
clean false:13
clean_rate:0.9770318021201413
noisy true:346
noisy false:704
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1050
epoch [17/200] batch [5/17] time 0.184 (0.173) data 0.106 (0.095) loss_x loss_x 1.0039 (1.2057) acc_x 68.7500 (69.3750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/17] time 0.166 (0.179) data 0.089 (0.102) loss_x loss_x 0.7588 (1.0441) acc_x 81.2500 (73.4375) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [15/17] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.8379 (1.0447) acc_x 81.2500 (74.5833) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 726
confident_label rate tensor(0.3521, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 569
clean true:557
clean false:12
clean_rate:0.9789103690685413
noisy true:333
noisy false:714
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1047
epoch [18/200] batch [5/17] time 0.177 (0.179) data 0.100 (0.101) loss_x loss_x 0.7358 (0.8768) acc_x 71.8750 (75.6250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/17] time 0.158 (0.173) data 0.082 (0.096) loss_x loss_x 0.9761 (0.9323) acc_x 68.7500 (75.6250) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [15/17] time 0.187 (0.170) data 0.110 (0.093) loss_x loss_x 0.9131 (0.9947) acc_x 75.0000 (75.4167) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 733
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:558
clean false:13
clean_rate:0.9772329246935202
noisy true:325
noisy false:720
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [19/200] batch [5/17] time 0.181 (0.185) data 0.104 (0.107) loss_x loss_x 1.3564 (1.0208) acc_x 71.8750 (75.0000) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/17] time 0.186 (0.185) data 0.108 (0.107) loss_x loss_x 0.7749 (0.9958) acc_x 81.2500 (75.0000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [15/17] time 0.162 (0.178) data 0.084 (0.101) loss_x loss_x 0.8135 (0.9707) acc_x 75.0000 (74.3750) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 732
confident_label rate tensor(0.3453, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 558
clean true:545
clean false:13
clean_rate:0.9767025089605734
noisy true:339
noisy false:719
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1058
epoch [20/200] batch [5/17] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.7100 (0.9605) acc_x 81.2500 (76.2500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/17] time 0.181 (0.176) data 0.103 (0.099) loss_x loss_x 0.8662 (1.0360) acc_x 75.0000 (73.4375) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [15/17] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.6006 (1.0570) acc_x 87.5000 (73.5417) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 728
confident_label rate tensor(0.3546, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 573
clean true:561
clean false:12
clean_rate:0.9790575916230366
noisy true:327
noisy false:716
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1043
epoch [21/200] batch [5/17] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.7749 (1.0613) acc_x 75.0000 (71.2500) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [10/17] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 1.1777 (0.9818) acc_x 71.8750 (73.4375) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [15/17] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.8887 (0.9712) acc_x 75.0000 (73.9583) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 715
confident_label rate tensor(0.3521, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 569
clean true:559
clean false:10
clean_rate:0.9824253075571178
noisy true:342
noisy false:705
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1047
epoch [22/200] batch [5/17] time 0.179 (0.174) data 0.102 (0.096) loss_x loss_x 1.1201 (0.8354) acc_x 75.0000 (80.0000) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/17] time 0.181 (0.182) data 0.104 (0.104) loss_x loss_x 1.2988 (1.0077) acc_x 65.6250 (74.6875) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [15/17] time 0.191 (0.183) data 0.113 (0.106) loss_x loss_x 0.7285 (0.9606) acc_x 81.2500 (75.4167) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 720
confident_label rate tensor(0.3490, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 564
clean true:556
clean false:8
clean_rate:0.9858156028368794
noisy true:340
noisy false:712
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1052
epoch [23/200] batch [5/17] time 0.185 (0.169) data 0.108 (0.091) loss_x loss_x 0.4924 (0.9344) acc_x 87.5000 (76.8750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/17] time 0.160 (0.167) data 0.083 (0.090) loss_x loss_x 0.6455 (0.9951) acc_x 90.6250 (76.8750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [15/17] time 0.160 (0.167) data 0.083 (0.089) loss_x loss_x 0.7153 (0.9103) acc_x 81.2500 (78.5417) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.3614, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 584
clean true:575
clean false:9
clean_rate:0.9845890410958904
noisy true:348
noisy false:684
after delete: len(clean_dataset) 584
after delete: len(noisy_dataset) 1032
epoch [24/200] batch [5/18] time 0.170 (0.178) data 0.092 (0.101) loss_x loss_x 0.9448 (1.1110) acc_x 78.1250 (72.5000) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/18] time 0.188 (0.178) data 0.111 (0.101) loss_x loss_x 1.2871 (1.0885) acc_x 62.5000 (70.9375) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [15/18] time 0.233 (0.185) data 0.156 (0.107) loss_x loss_x 1.2188 (1.0847) acc_x 65.6250 (72.0833) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 733
confident_label rate tensor(0.3484, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 563
clean true:554
clean false:9
clean_rate:0.9840142095914742
noisy true:329
noisy false:724
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1053
epoch [25/200] batch [5/17] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 1.0625 (1.0625) acc_x 68.7500 (71.2500) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/17] time 0.177 (0.178) data 0.099 (0.100) loss_x loss_x 1.2852 (0.9829) acc_x 59.3750 (72.1875) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [15/17] time 0.175 (0.179) data 0.098 (0.101) loss_x loss_x 1.5439 (0.9659) acc_x 59.3750 (73.9583) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:589
clean false:12
clean_rate:0.9800332778702163
noisy true:342
noisy false:673
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [26/200] batch [5/18] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 1.5801 (1.3204) acc_x 62.5000 (68.1250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/18] time 0.184 (0.188) data 0.108 (0.111) loss_x loss_x 0.5508 (1.1205) acc_x 87.5000 (72.8125) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/18] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 1.0596 (1.1033) acc_x 71.8750 (72.0833) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 715
confident_label rate tensor(0.3515, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 568
clean true:561
clean false:7
clean_rate:0.9876760563380281
noisy true:340
noisy false:708
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1048
epoch [27/200] batch [5/17] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 1.0166 (0.9155) acc_x 75.0000 (76.8750) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/17] time 0.159 (0.173) data 0.083 (0.096) loss_x loss_x 1.0957 (0.8772) acc_x 78.1250 (76.2500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/17] time 0.161 (0.169) data 0.083 (0.092) loss_x loss_x 0.8047 (0.8590) acc_x 71.8750 (75.6250) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 683
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 593
clean true:584
clean false:9
clean_rate:0.984822934232715
noisy true:349
noisy false:674
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1023
epoch [28/200] batch [5/18] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.8740 (0.6407) acc_x 68.7500 (80.0000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/18] time 0.194 (0.187) data 0.117 (0.110) loss_x loss_x 0.8652 (0.8894) acc_x 78.1250 (76.5625) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/18] time 0.193 (0.188) data 0.116 (0.111) loss_x loss_x 0.3103 (0.8108) acc_x 96.8750 (78.9583) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 708
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 593
clean true:577
clean false:16
clean_rate:0.9730185497470489
noisy true:331
noisy false:692
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1023
epoch [29/200] batch [5/18] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 1.0449 (0.9588) acc_x 81.2500 (76.8750) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/18] time 0.197 (0.182) data 0.118 (0.104) loss_x loss_x 0.5308 (0.9329) acc_x 87.5000 (77.1875) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/18] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.8896 (0.8909) acc_x 81.2500 (77.7083) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 699
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 595
clean true:584
clean false:11
clean_rate:0.9815126050420168
noisy true:333
noisy false:688
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1021
epoch [30/200] batch [5/18] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.8691 (0.6790) acc_x 75.0000 (81.2500) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/18] time 0.182 (0.184) data 0.104 (0.106) loss_x loss_x 1.4727 (0.7663) acc_x 59.3750 (78.7500) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/18] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.7690 (0.8418) acc_x 75.0000 (78.1250) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 651
confident_label rate tensor(0.3849, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 622
clean true:611
clean false:11
clean_rate:0.9823151125401929
noisy true:354
noisy false:640
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 994
epoch [31/200] batch [5/19] time 0.197 (0.185) data 0.119 (0.107) loss_x loss_x 0.7529 (0.9939) acc_x 81.2500 (71.2500) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/19] time 0.175 (0.184) data 0.098 (0.107) loss_x loss_x 0.3894 (0.7548) acc_x 87.5000 (79.3750) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/19] time 0.183 (0.178) data 0.105 (0.101) loss_x loss_x 0.5767 (0.7964) acc_x 78.1250 (77.2917) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:591
clean false:11
clean_rate:0.9817275747508306
noisy true:340
noisy false:674
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [32/200] batch [5/18] time 0.158 (0.159) data 0.080 (0.082) loss_x loss_x 1.2051 (0.9951) acc_x 59.3750 (72.5000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/18] time 0.175 (0.161) data 0.098 (0.083) loss_x loss_x 0.8506 (0.9732) acc_x 75.0000 (74.6875) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/18] time 0.193 (0.168) data 0.115 (0.090) loss_x loss_x 0.4797 (0.9354) acc_x 81.2500 (75.2083) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 648
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 619
clean true:607
clean false:12
clean_rate:0.9806138933764136
noisy true:361
noisy false:636
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 997
epoch [33/200] batch [5/19] time 0.170 (0.167) data 0.092 (0.090) loss_x loss_x 1.2461 (1.0424) acc_x 68.7500 (72.5000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/19] time 0.160 (0.167) data 0.083 (0.089) loss_x loss_x 1.0381 (1.0062) acc_x 75.0000 (73.4375) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/19] time 0.185 (0.172) data 0.107 (0.095) loss_x loss_x 0.6631 (0.9663) acc_x 84.3750 (75.4167) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 604
clean true:594
clean false:10
clean_rate:0.9834437086092715
noisy true:351
noisy false:661
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1012
epoch [34/200] batch [5/18] time 0.184 (0.166) data 0.107 (0.088) loss_x loss_x 0.6914 (0.6938) acc_x 78.1250 (80.6250) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/18] time 0.185 (0.169) data 0.108 (0.091) loss_x loss_x 0.8057 (0.8061) acc_x 81.2500 (77.5000) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/18] time 0.185 (0.174) data 0.108 (0.097) loss_x loss_x 1.0186 (0.8278) acc_x 68.7500 (77.5000) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:588
clean false:15
clean_rate:0.9751243781094527
noisy true:360
noisy false:653
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [35/200] batch [5/18] time 0.158 (0.175) data 0.080 (0.098) loss_x loss_x 0.9204 (0.9121) acc_x 68.7500 (76.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/18] time 0.226 (0.183) data 0.149 (0.106) loss_x loss_x 0.6938 (0.9599) acc_x 81.2500 (75.3125) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/18] time 0.195 (0.182) data 0.118 (0.104) loss_x loss_x 1.0137 (0.8861) acc_x 71.8750 (76.8750) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 612
clean true:596
clean false:16
clean_rate:0.9738562091503268
noisy true:356
noisy false:648
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1004
epoch [36/200] batch [5/19] time 0.188 (0.175) data 0.110 (0.098) loss_x loss_x 0.5435 (0.7716) acc_x 87.5000 (81.8750) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/19] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.6426 (0.8413) acc_x 87.5000 (79.3750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/19] time 0.189 (0.182) data 0.111 (0.105) loss_x loss_x 0.5142 (0.8420) acc_x 90.6250 (79.3750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.3985, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 644
clean true:633
clean false:11
clean_rate:0.9829192546583851
noisy true:348
noisy false:624
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 972
epoch [37/200] batch [5/20] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.8486 (0.8396) acc_x 84.3750 (81.2500) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/20] time 0.176 (0.181) data 0.098 (0.103) loss_x loss_x 0.9668 (0.7873) acc_x 81.2500 (81.2500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/20] time 0.169 (0.176) data 0.091 (0.099) loss_x loss_x 0.7490 (0.7898) acc_x 75.0000 (80.0000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [20/20] time 0.193 (0.179) data 0.115 (0.101) loss_x loss_x 0.6743 (0.8198) acc_x 81.2500 (79.0625) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 663
confident_label rate tensor(0.3861, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 624
clean true:610
clean false:14
clean_rate:0.9775641025641025
noisy true:343
noisy false:649
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 992
epoch [38/200] batch [5/19] time 0.186 (0.182) data 0.107 (0.104) loss_x loss_x 0.9834 (0.8150) acc_x 71.8750 (75.6250) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/19] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.7793 (0.8341) acc_x 68.7500 (75.9375) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/19] time 0.172 (0.176) data 0.094 (0.099) loss_x loss_x 0.7725 (0.8341) acc_x 81.2500 (78.3333) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 662
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:625
clean false:15
clean_rate:0.9765625
noisy true:329
noisy false:647
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [39/200] batch [5/20] time 0.173 (0.172) data 0.095 (0.094) loss_x loss_x 0.6870 (0.6959) acc_x 81.2500 (80.6250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/20] time 0.167 (0.173) data 0.090 (0.096) loss_x loss_x 0.8569 (0.7527) acc_x 81.2500 (80.9375) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/20] time 0.176 (0.174) data 0.097 (0.096) loss_x loss_x 0.7583 (0.7862) acc_x 84.3750 (80.2083) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [20/20] time 0.170 (0.174) data 0.092 (0.096) loss_x loss_x 1.3330 (0.8483) acc_x 71.8750 (79.5312) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 619
clean true:607
clean false:12
clean_rate:0.9806138933764136
noisy true:345
noisy false:652
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 997
epoch [40/200] batch [5/19] time 0.174 (0.169) data 0.097 (0.092) loss_x loss_x 1.1299 (0.8543) acc_x 68.7500 (77.5000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/19] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 1.0586 (0.8543) acc_x 78.1250 (77.8125) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/19] time 0.174 (0.177) data 0.096 (0.100) loss_x loss_x 0.6812 (0.8493) acc_x 84.3750 (76.6667) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.3967, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 641
clean true:620
clean false:21
clean_rate:0.9672386895475819
noisy true:358
noisy false:617
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 975
epoch [41/200] batch [5/20] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.7852 (0.7210) acc_x 75.0000 (80.6250) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/20] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.5493 (0.7942) acc_x 84.3750 (78.4375) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/20] time 0.182 (0.175) data 0.105 (0.097) loss_x loss_x 1.2578 (0.8222) acc_x 62.5000 (77.5000) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [20/20] time 0.183 (0.178) data 0.106 (0.100) loss_x loss_x 0.6489 (0.7846) acc_x 78.1250 (78.2812) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.3868, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 625
clean true:615
clean false:10
clean_rate:0.984
noisy true:342
noisy false:649
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 991
epoch [42/200] batch [5/19] time 0.175 (0.179) data 0.096 (0.100) loss_x loss_x 0.7725 (0.8853) acc_x 78.1250 (75.0000) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/19] time 0.161 (0.173) data 0.083 (0.094) loss_x loss_x 0.5698 (0.8111) acc_x 87.5000 (77.1875) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/19] time 0.162 (0.172) data 0.084 (0.094) loss_x loss_x 0.9819 (0.8542) acc_x 75.0000 (77.5000) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 642
confident_label rate tensor(0.3929, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 635
clean true:622
clean false:13
clean_rate:0.9795275590551181
noisy true:352
noisy false:629
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 981
epoch [43/200] batch [5/19] time 0.181 (0.186) data 0.103 (0.109) loss_x loss_x 1.6357 (1.0506) acc_x 53.1250 (73.7500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/19] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 1.3594 (1.0196) acc_x 68.7500 (73.7500) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/19] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.6655 (0.9419) acc_x 81.2500 (74.5833) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.4010, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 648
clean true:632
clean false:16
clean_rate:0.9753086419753086
noisy true:332
noisy false:636
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 968
epoch [44/200] batch [5/20] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.6118 (0.8109) acc_x 84.3750 (80.0000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/20] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.7778 (0.7535) acc_x 78.1250 (81.8750) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/20] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 1.2695 (0.8103) acc_x 68.7500 (80.0000) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [20/20] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.8164 (0.8102) acc_x 75.0000 (80.0000) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.3911, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 632
clean true:616
clean false:16
clean_rate:0.9746835443037974
noisy true:355
noisy false:629
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 984
epoch [45/200] batch [5/19] time 0.181 (0.183) data 0.104 (0.105) loss_x loss_x 1.0137 (0.9546) acc_x 78.1250 (76.2500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/19] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.6514 (0.8134) acc_x 81.2500 (79.0625) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/19] time 0.181 (0.185) data 0.104 (0.107) loss_x loss_x 0.9395 (0.8074) acc_x 71.8750 (78.7500) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 643
confident_label rate tensor(0.3979, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 643
clean true:628
clean false:15
clean_rate:0.9766718506998445
noisy true:345
noisy false:628
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 973
epoch [46/200] batch [5/20] time 0.195 (0.180) data 0.118 (0.103) loss_x loss_x 0.5420 (0.9336) acc_x 90.6250 (76.8750) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/20] time 0.186 (0.183) data 0.108 (0.106) loss_x loss_x 1.3535 (0.9890) acc_x 68.7500 (75.3125) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/20] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7710 (0.9280) acc_x 81.2500 (75.8333) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [20/20] time 0.191 (0.184) data 0.114 (0.107) loss_x loss_x 0.4626 (0.9117) acc_x 87.5000 (75.9375) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.3948, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 638
clean true:622
clean false:16
clean_rate:0.9749216300940439
noisy true:355
noisy false:623
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 978
epoch [47/200] batch [5/19] time 0.178 (0.186) data 0.101 (0.108) loss_x loss_x 0.8398 (0.7526) acc_x 81.2500 (81.8750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/19] time 0.200 (0.184) data 0.123 (0.107) loss_x loss_x 0.7144 (0.8007) acc_x 68.7500 (77.8125) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/19] time 0.187 (0.183) data 0.109 (0.105) loss_x loss_x 0.7861 (0.8394) acc_x 75.0000 (76.6667) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.4022, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 650
clean true:634
clean false:16
clean_rate:0.9753846153846154
noisy true:346
noisy false:620
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 966
epoch [48/200] batch [5/20] time 0.184 (0.182) data 0.106 (0.105) loss_x loss_x 0.6143 (0.7196) acc_x 87.5000 (81.8750) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/20] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.4507 (0.7150) acc_x 81.2500 (80.0000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/20] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.9995 (0.7875) acc_x 71.8750 (77.7083) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [20/20] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.5786 (0.7807) acc_x 84.3750 (78.7500) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.3954, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 639
clean true:622
clean false:17
clean_rate:0.97339593114241
noisy true:370
noisy false:607
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 977
epoch [49/200] batch [5/19] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.7368 (0.6188) acc_x 78.1250 (81.8750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/19] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.7871 (0.7074) acc_x 81.2500 (81.2500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/19] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.5273 (0.6474) acc_x 90.6250 (83.1250) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 634
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:625
clean false:15
clean_rate:0.9765625
noisy true:357
noisy false:619
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [50/200] batch [5/20] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.6924 (0.7392) acc_x 84.3750 (86.2500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/20] time 0.165 (0.179) data 0.087 (0.102) loss_x loss_x 0.2837 (0.8059) acc_x 90.6250 (82.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/20] time 0.186 (0.181) data 0.109 (0.103) loss_x loss_x 0.7324 (0.8364) acc_x 81.2500 (80.6250) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [20/20] time 0.191 (0.182) data 0.113 (0.105) loss_x loss_x 0.8989 (0.8798) acc_x 71.8750 (77.9688) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.3942, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 637
clean true:619
clean false:18
clean_rate:0.9717425431711146
noisy true:359
noisy false:620
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 979
epoch [51/200] batch [5/19] time 0.187 (0.182) data 0.109 (0.105) loss_x loss_x 1.1523 (0.7706) acc_x 68.7500 (78.1250) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/19] time 0.197 (0.183) data 0.120 (0.105) loss_x loss_x 0.7563 (0.9064) acc_x 78.1250 (73.4375) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/19] time 0.188 (0.183) data 0.110 (0.106) loss_x loss_x 1.2061 (0.8866) acc_x 68.7500 (74.5833) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 641
confident_label rate tensor(0.4022, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 650
clean true:630
clean false:20
clean_rate:0.9692307692307692
noisy true:345
noisy false:621
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 966
epoch [52/200] batch [5/20] time 0.188 (0.186) data 0.111 (0.109) loss_x loss_x 0.8569 (0.9216) acc_x 81.2500 (76.8750) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/20] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.7363 (0.8667) acc_x 84.3750 (78.4375) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/20] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.9419 (0.8453) acc_x 71.8750 (77.9167) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [20/20] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.4746 (0.8129) acc_x 90.6250 (79.0625) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 642
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:626
clean false:14
clean_rate:0.978125
noisy true:348
noisy false:628
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [53/200] batch [5/20] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 1.0996 (0.8491) acc_x 84.3750 (79.3750) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/20] time 0.183 (0.185) data 0.106 (0.107) loss_x loss_x 0.9292 (0.8141) acc_x 68.7500 (79.3750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/20] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5879 (0.7933) acc_x 90.6250 (79.3750) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [20/20] time 0.190 (0.186) data 0.112 (0.108) loss_x loss_x 0.7891 (0.7940) acc_x 84.3750 (79.8438) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 659
clean true:645
clean false:14
clean_rate:0.9787556904400607
noisy true:334
noisy false:623
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 957
epoch [54/200] batch [5/20] time 0.181 (0.182) data 0.103 (0.104) loss_x loss_x 0.9526 (0.9827) acc_x 78.1250 (76.8750) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/20] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 1.0088 (0.8883) acc_x 75.0000 (76.8750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/20] time 0.176 (0.179) data 0.097 (0.101) loss_x loss_x 0.8213 (0.8574) acc_x 75.0000 (77.2917) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [20/20] time 0.175 (0.179) data 0.097 (0.101) loss_x loss_x 0.9038 (0.8658) acc_x 68.7500 (76.7188) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 629
confident_label rate tensor(0.4028, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 651
clean true:635
clean false:16
clean_rate:0.9754224270353302
noisy true:352
noisy false:613
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 965
epoch [55/200] batch [5/20] time 0.160 (0.172) data 0.082 (0.094) loss_x loss_x 0.6689 (0.6381) acc_x 81.2500 (81.8750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/20] time 0.161 (0.166) data 0.083 (0.089) loss_x loss_x 0.4846 (0.5866) acc_x 90.6250 (83.1250) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/20] time 0.168 (0.168) data 0.090 (0.090) loss_x loss_x 0.3828 (0.6144) acc_x 93.7500 (83.1250) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [20/20] time 0.160 (0.166) data 0.083 (0.089) loss_x loss_x 0.7500 (0.6441) acc_x 84.3750 (83.2812) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.4084, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 660
clean true:643
clean false:17
clean_rate:0.9742424242424242
noisy true:360
noisy false:596
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 956
epoch [56/200] batch [5/20] time 0.178 (0.176) data 0.101 (0.099) loss_x loss_x 0.5981 (0.8694) acc_x 87.5000 (83.1250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/20] time 0.173 (0.177) data 0.095 (0.099) loss_x loss_x 0.8364 (0.8622) acc_x 75.0000 (80.3125) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/20] time 0.182 (0.179) data 0.104 (0.101) loss_x loss_x 0.8560 (0.8876) acc_x 78.1250 (78.7500) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [20/20] time 0.170 (0.177) data 0.092 (0.099) loss_x loss_x 0.8438 (0.8627) acc_x 75.0000 (78.5938) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.4010, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 648
clean true:635
clean false:13
clean_rate:0.9799382716049383
noisy true:345
noisy false:623
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 968
epoch [57/200] batch [5/20] time 0.245 (0.201) data 0.168 (0.123) loss_x loss_x 0.9668 (0.7710) acc_x 78.1250 (82.5000) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/20] time 0.182 (0.197) data 0.106 (0.120) loss_x loss_x 0.8887 (0.7711) acc_x 78.1250 (80.9375) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/20] time 0.186 (0.195) data 0.109 (0.118) loss_x loss_x 0.6963 (0.7647) acc_x 75.0000 (80.4167) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [20/20] time 0.188 (0.193) data 0.110 (0.115) loss_x loss_x 0.6333 (0.7390) acc_x 81.2500 (81.5625) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 673
clean true:651
clean false:22
clean_rate:0.9673105497771174
noisy true:348
noisy false:595
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 943
epoch [58/200] batch [5/21] time 0.214 (0.173) data 0.138 (0.096) loss_x loss_x 1.0596 (0.8832) acc_x 75.0000 (75.6250) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/21] time 0.180 (0.178) data 0.103 (0.100) loss_x loss_x 1.0439 (0.9475) acc_x 68.7500 (74.3750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/21] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.6318 (0.9023) acc_x 78.1250 (75.4167) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/21] time 0.184 (0.181) data 0.107 (0.103) loss_x loss_x 0.6074 (0.9193) acc_x 84.3750 (75.3125) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.3954, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 639
clean true:625
clean false:14
clean_rate:0.9780907668231612
noisy true:356
noisy false:621
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 977
epoch [59/200] batch [5/19] time 0.185 (0.171) data 0.108 (0.094) loss_x loss_x 0.5791 (0.7121) acc_x 84.3750 (83.1250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/19] time 0.218 (0.172) data 0.140 (0.094) loss_x loss_x 0.3770 (0.6883) acc_x 87.5000 (81.2500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/19] time 0.182 (0.177) data 0.105 (0.099) loss_x loss_x 0.8208 (0.6987) acc_x 84.3750 (81.8750) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 631
confident_label rate tensor(0.4084, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 660
clean true:641
clean false:19
clean_rate:0.9712121212121212
noisy true:344
noisy false:612
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 956
epoch [60/200] batch [5/20] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.9204 (0.8122) acc_x 75.0000 (78.7500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/20] time 0.179 (0.183) data 0.102 (0.105) loss_x loss_x 1.0205 (0.8528) acc_x 71.8750 (76.8750) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.3962 (0.8065) acc_x 90.6250 (78.5417) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [20/20] time 0.176 (0.183) data 0.099 (0.106) loss_x loss_x 0.7305 (0.7687) acc_x 81.2500 (80.0000) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.4146, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 670
clean true:653
clean false:17
clean_rate:0.9746268656716418
noisy true:358
noisy false:588
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 946
epoch [61/200] batch [5/20] time 0.158 (0.160) data 0.080 (0.083) loss_x loss_x 1.1455 (0.9975) acc_x 71.8750 (76.2500) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/20] time 0.164 (0.166) data 0.087 (0.088) loss_x loss_x 0.4409 (0.8146) acc_x 90.6250 (79.0625) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/20] time 0.181 (0.171) data 0.105 (0.094) loss_x loss_x 0.8013 (0.7937) acc_x 81.2500 (78.7500) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [20/20] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.5430 (0.7875) acc_x 81.2500 (78.2812) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 592
confident_label rate tensor(0.4140, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 669
clean true:652
clean false:17
clean_rate:0.9745889387144993
noisy true:372
noisy false:575
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 947
epoch [62/200] batch [5/20] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.7544 (0.7147) acc_x 84.3750 (81.2500) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/20] time 0.169 (0.181) data 0.092 (0.104) loss_x loss_x 0.8306 (0.7837) acc_x 75.0000 (77.5000) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/20] time 0.184 (0.180) data 0.106 (0.103) loss_x loss_x 0.9004 (0.7567) acc_x 81.2500 (78.9583) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [20/20] time 0.160 (0.179) data 0.083 (0.101) loss_x loss_x 0.4131 (0.7406) acc_x 90.6250 (79.3750) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 616
confident_label rate tensor(0.4183, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 676
clean true:659
clean false:17
clean_rate:0.9748520710059172
noisy true:341
noisy false:599
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 940
epoch [63/200] batch [5/21] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.7437 (0.7718) acc_x 78.1250 (79.3750) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/21] time 0.179 (0.178) data 0.101 (0.101) loss_x loss_x 0.3523 (0.7064) acc_x 90.6250 (82.1875) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/21] time 0.160 (0.177) data 0.082 (0.099) loss_x loss_x 1.0322 (0.7685) acc_x 75.0000 (79.7917) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/21] time 0.182 (0.178) data 0.105 (0.100) loss_x loss_x 0.7207 (0.7787) acc_x 81.2500 (80.3125) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 579
confident_label rate tensor(0.4307, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 696
clean true:679
clean false:17
clean_rate:0.9755747126436781
noisy true:358
noisy false:562
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 920
epoch [64/200] batch [5/21] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8667 (0.6917) acc_x 71.8750 (80.0000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/21] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.4885 (0.7682) acc_x 90.6250 (78.4375) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/21] time 0.160 (0.179) data 0.082 (0.101) loss_x loss_x 0.7778 (0.7947) acc_x 84.3750 (77.7083) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/21] time 0.182 (0.179) data 0.105 (0.101) loss_x loss_x 0.6367 (0.8171) acc_x 81.2500 (77.8125) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 583
confident_label rate tensor(0.4313, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 697
clean true:677
clean false:20
clean_rate:0.9713055954088953
noisy true:356
noisy false:563
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 919
epoch [65/200] batch [5/21] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6279 (0.6760) acc_x 84.3750 (84.3750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/21] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.6875 (0.7757) acc_x 78.1250 (80.3125) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/21] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.7515 (0.7861) acc_x 84.3750 (79.3750) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/21] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 1.0664 (0.8196) acc_x 71.8750 (78.4375) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 603
confident_label rate tensor(0.4127, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 667
clean true:648
clean false:19
clean_rate:0.9715142428785607
noisy true:365
noisy false:584
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 949
epoch [66/200] batch [5/20] time 0.182 (0.184) data 0.105 (0.106) loss_x loss_x 0.4531 (0.6551) acc_x 90.6250 (82.5000) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/20] time 0.186 (0.187) data 0.108 (0.110) loss_x loss_x 0.9189 (0.7330) acc_x 75.0000 (82.1875) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/20] time 0.186 (0.186) data 0.108 (0.109) loss_x loss_x 0.3936 (0.7039) acc_x 87.5000 (82.0833) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [20/20] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.6865 (0.7808) acc_x 75.0000 (79.3750) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 659
clean true:642
clean false:17
clean_rate:0.9742033383915023
noisy true:351
noisy false:606
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 957
epoch [67/200] batch [5/20] time 0.182 (0.174) data 0.104 (0.097) loss_x loss_x 0.6567 (0.5299) acc_x 87.5000 (85.6250) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/20] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.6729 (0.5497) acc_x 81.2500 (85.3125) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/20] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.8613 (0.6272) acc_x 81.2500 (84.1667) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [20/20] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.8901 (0.6468) acc_x 75.0000 (83.1250) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:677
clean false:16
clean_rate:0.976911976911977
noisy true:351
noisy false:572
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [68/200] batch [5/21] time 0.186 (0.172) data 0.108 (0.095) loss_x loss_x 0.4524 (0.5485) acc_x 90.6250 (85.6250) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/21] time 0.177 (0.178) data 0.099 (0.100) loss_x loss_x 0.8833 (0.6623) acc_x 78.1250 (83.1250) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/21] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.6641 (0.6867) acc_x 84.3750 (83.1250) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/21] time 0.171 (0.177) data 0.093 (0.099) loss_x loss_x 0.7549 (0.7223) acc_x 78.1250 (81.8750) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 592
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 688
clean true:667
clean false:21
clean_rate:0.9694767441860465
noisy true:357
noisy false:571
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 928
epoch [69/200] batch [5/21] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 0.7271 (0.7150) acc_x 81.2500 (79.3750) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/21] time 0.182 (0.185) data 0.105 (0.107) loss_x loss_x 0.6396 (0.8343) acc_x 87.5000 (80.0000) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/21] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.7324 (0.7986) acc_x 81.2500 (79.7917) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/21] time 0.186 (0.180) data 0.109 (0.102) loss_x loss_x 1.0586 (0.7928) acc_x 71.8750 (80.0000) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.4319, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 698
clean true:681
clean false:17
clean_rate:0.9756446991404012
noisy true:369
noisy false:549
after delete: len(clean_dataset) 698
after delete: len(noisy_dataset) 918
epoch [70/200] batch [5/21] time 0.186 (0.176) data 0.108 (0.099) loss_x loss_x 0.6509 (0.8612) acc_x 84.3750 (79.3750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/21] time 0.177 (0.176) data 0.099 (0.099) loss_x loss_x 1.1006 (0.8527) acc_x 71.8750 (79.0625) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/21] time 0.181 (0.176) data 0.104 (0.099) loss_x loss_x 0.9990 (0.8384) acc_x 75.0000 (79.7917) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/21] time 0.195 (0.177) data 0.118 (0.100) loss_x loss_x 0.6021 (0.8104) acc_x 84.3750 (79.6875) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.4121, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 666
clean true:650
clean false:16
clean_rate:0.975975975975976
noisy true:385
noisy false:565
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 950
epoch [71/200] batch [5/20] time 0.198 (0.185) data 0.122 (0.108) loss_x loss_x 0.4463 (0.7556) acc_x 87.5000 (80.6250) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/20] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.6797 (0.6930) acc_x 81.2500 (82.1875) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/20] time 0.159 (0.180) data 0.081 (0.102) loss_x loss_x 1.2920 (0.7379) acc_x 62.5000 (81.0417) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [20/20] time 0.207 (0.184) data 0.129 (0.107) loss_x loss_x 0.8579 (0.7295) acc_x 78.1250 (81.5625) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 688
clean true:671
clean false:17
clean_rate:0.9752906976744186
noisy true:364
noisy false:564
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 928
epoch [72/200] batch [5/21] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.7080 (0.7583) acc_x 81.2500 (77.5000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/21] time 0.171 (0.174) data 0.094 (0.097) loss_x loss_x 0.5581 (0.7256) acc_x 81.2500 (79.6875) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/21] time 0.183 (0.178) data 0.105 (0.100) loss_x loss_x 0.3162 (0.6847) acc_x 93.7500 (81.8750) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/21] time 0.183 (0.179) data 0.105 (0.102) loss_x loss_x 0.7915 (0.7220) acc_x 84.3750 (81.0938) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 576
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 692
clean true:672
clean false:20
clean_rate:0.9710982658959537
noisy true:368
noisy false:556
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 924
epoch [73/200] batch [5/21] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.6235 (0.7093) acc_x 81.2500 (80.0000) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/21] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 1.3086 (0.8069) acc_x 75.0000 (79.3750) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/21] time 0.159 (0.183) data 0.082 (0.105) loss_x loss_x 0.5645 (0.7834) acc_x 84.3750 (80.8333) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/21] time 0.160 (0.180) data 0.083 (0.103) loss_x loss_x 0.8013 (0.7775) acc_x 84.3750 (80.6250) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.4072, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 658
clean true:641
clean false:17
clean_rate:0.9741641337386018
noisy true:355
noisy false:603
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 958
epoch [74/200] batch [5/20] time 0.188 (0.186) data 0.110 (0.108) loss_x loss_x 0.7183 (0.6612) acc_x 81.2500 (83.1250) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/20] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.6030 (0.6863) acc_x 84.3750 (81.8750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/20] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.6519 (0.7130) acc_x 87.5000 (82.0833) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [20/20] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.2305 (0.6801) acc_x 96.8750 (83.1250) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 585
confident_label rate tensor(0.4233, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 684
clean true:667
clean false:17
clean_rate:0.9751461988304093
noisy true:364
noisy false:568
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 932
epoch [75/200] batch [5/21] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 1.1709 (0.7993) acc_x 71.8750 (78.1250) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/21] time 0.181 (0.187) data 0.104 (0.109) loss_x loss_x 0.3457 (0.7976) acc_x 84.3750 (78.4375) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/21] time 0.183 (0.189) data 0.106 (0.111) loss_x loss_x 1.0732 (0.7677) acc_x 75.0000 (79.1667) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/21] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.7007 (0.7505) acc_x 78.1250 (79.3750) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.4226, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 683
clean true:663
clean false:20
clean_rate:0.9707174231332357
noisy true:362
noisy false:571
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 933
epoch [76/200] batch [5/21] time 0.184 (0.190) data 0.107 (0.113) loss_x loss_x 0.7349 (0.7241) acc_x 78.1250 (78.7500) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/21] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.7422 (0.6963) acc_x 78.1250 (79.0625) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/21] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.8550 (0.7337) acc_x 84.3750 (80.0000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/21] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.8701 (0.7426) acc_x 71.8750 (79.2188) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 587
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 677
clean true:663
clean false:14
clean_rate:0.9793205317577548
noisy true:366
noisy false:573
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 939
epoch [77/200] batch [5/21] time 0.184 (0.177) data 0.107 (0.099) loss_x loss_x 0.3623 (0.4772) acc_x 90.6250 (88.7500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/21] time 0.183 (0.179) data 0.105 (0.101) loss_x loss_x 0.9233 (0.7066) acc_x 75.0000 (82.5000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/21] time 0.164 (0.180) data 0.086 (0.102) loss_x loss_x 0.6182 (0.7397) acc_x 84.3750 (81.4583) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [20/21] time 0.184 (0.179) data 0.107 (0.101) loss_x loss_x 0.6519 (0.7647) acc_x 78.1250 (79.6875) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 585
confident_label rate tensor(0.4196, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 678
clean true:664
clean false:14
clean_rate:0.9793510324483776
noisy true:367
noisy false:571
after delete: len(clean_dataset) 678
after delete: len(noisy_dataset) 938
epoch [78/200] batch [5/21] time 0.180 (0.177) data 0.102 (0.099) loss_x loss_x 0.6548 (0.5676) acc_x 78.1250 (83.7500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/21] time 0.183 (0.178) data 0.106 (0.100) loss_x loss_x 0.7573 (0.6289) acc_x 75.0000 (83.4375) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/21] time 0.184 (0.180) data 0.106 (0.102) loss_x loss_x 0.6162 (0.6604) acc_x 81.2500 (82.7083) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/21] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.7988 (0.6688) acc_x 84.3750 (83.4375) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 574
confident_label rate tensor(0.4183, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 676
clean true:662
clean false:14
clean_rate:0.9792899408284024
noisy true:380
noisy false:560
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 940
epoch [79/200] batch [5/21] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.8213 (0.9493) acc_x 75.0000 (74.3750) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/21] time 0.187 (0.181) data 0.109 (0.104) loss_x loss_x 0.6367 (0.7690) acc_x 81.2500 (78.4375) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/21] time 0.181 (0.182) data 0.104 (0.104) loss_x loss_x 0.8906 (0.7677) acc_x 75.0000 (79.1667) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/21] time 0.220 (0.182) data 0.142 (0.105) loss_x loss_x 0.5669 (0.7120) acc_x 81.2500 (80.1562) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.4121, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 666
clean true:652
clean false:14
clean_rate:0.978978978978979
noisy true:367
noisy false:583
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 950
epoch [80/200] batch [5/20] time 0.167 (0.201) data 0.089 (0.123) loss_x loss_x 0.7158 (0.6984) acc_x 87.5000 (85.0000) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/20] time 0.159 (0.190) data 0.082 (0.112) loss_x loss_x 0.4729 (0.6383) acc_x 81.2500 (84.3750) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/20] time 0.158 (0.180) data 0.081 (0.102) loss_x loss_x 0.8340 (0.6250) acc_x 81.2500 (84.1667) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [20/20] time 0.159 (0.175) data 0.082 (0.097) loss_x loss_x 0.4260 (0.6267) acc_x 84.3750 (83.9062) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 568
confident_label rate tensor(0.4264, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 689
clean true:671
clean false:18
clean_rate:0.9738751814223512
noisy true:377
noisy false:550
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 927
epoch [81/200] batch [5/21] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.7119 (0.6549) acc_x 78.1250 (81.2500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/21] time 0.183 (0.189) data 0.106 (0.112) loss_x loss_x 0.6904 (0.7221) acc_x 75.0000 (81.2500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/21] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.5068 (0.7356) acc_x 81.2500 (79.5833) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/21] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.6738 (0.7229) acc_x 81.2500 (80.4688) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 603
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 673
clean true:657
clean false:16
clean_rate:0.9762258543833581
noisy true:356
noisy false:587
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 943
epoch [82/200] batch [5/21] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.8906 (0.6849) acc_x 81.2500 (83.7500) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/21] time 0.171 (0.177) data 0.093 (0.100) loss_x loss_x 0.6455 (0.7225) acc_x 78.1250 (82.5000) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/21] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 0.4500 (0.7001) acc_x 87.5000 (81.6667) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/21] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.7437 (0.6711) acc_x 81.2500 (82.5000) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.4152, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 671
clean true:656
clean false:15
clean_rate:0.977645305514158
noisy true:363
noisy false:582
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 945
epoch [83/200] batch [5/20] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.6782 (0.6349) acc_x 81.2500 (82.5000) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/20] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.6450 (0.7899) acc_x 81.2500 (78.4375) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/20] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.6382 (0.7196) acc_x 84.3750 (80.8333) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [20/20] time 0.180 (0.183) data 0.104 (0.106) loss_x loss_x 0.6626 (0.7037) acc_x 75.0000 (81.0938) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 565
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 714
clean true:693
clean false:21
clean_rate:0.9705882352941176
noisy true:358
noisy false:544
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 902
epoch [84/200] batch [5/22] time 0.183 (0.181) data 0.105 (0.104) loss_x loss_x 0.4353 (0.7740) acc_x 90.6250 (80.0000) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/22] time 0.181 (0.187) data 0.104 (0.110) loss_x loss_x 0.9580 (0.7686) acc_x 78.1250 (80.0000) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/22] time 0.182 (0.187) data 0.104 (0.109) loss_x loss_x 0.7222 (0.7638) acc_x 87.5000 (80.2083) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/22] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.5977 (0.7244) acc_x 78.1250 (80.4688) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.4394, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 710
clean true:696
clean false:14
clean_rate:0.9802816901408451
noisy true:362
noisy false:544
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 906
epoch [85/200] batch [5/22] time 0.163 (0.175) data 0.085 (0.097) loss_x loss_x 0.6729 (0.7064) acc_x 81.2500 (79.3750) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/22] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.7168 (0.6739) acc_x 87.5000 (81.5625) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/22] time 0.182 (0.181) data 0.104 (0.104) loss_x loss_x 0.6997 (0.6484) acc_x 87.5000 (82.2917) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/22] time 0.181 (0.182) data 0.105 (0.104) loss_x loss_x 0.7886 (0.6731) acc_x 75.0000 (82.0312) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.4270, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 690
clean true:673
clean false:17
clean_rate:0.9753623188405797
noisy true:357
noisy false:569
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 926
epoch [86/200] batch [5/21] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.8042 (0.7540) acc_x 78.1250 (81.2500) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/21] time 0.159 (0.174) data 0.081 (0.096) loss_x loss_x 0.9194 (0.7334) acc_x 75.0000 (80.0000) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/21] time 0.159 (0.169) data 0.082 (0.092) loss_x loss_x 0.6162 (0.6882) acc_x 84.3750 (80.8333) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/21] time 0.160 (0.169) data 0.083 (0.092) loss_x loss_x 0.3210 (0.6815) acc_x 93.7500 (81.4062) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 577
confident_label rate tensor(0.4177, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 675
clean true:659
clean false:16
clean_rate:0.9762962962962963
noisy true:380
noisy false:561
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 941
epoch [87/200] batch [5/21] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.8896 (0.7225) acc_x 81.2500 (83.1250) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/21] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.5903 (0.6904) acc_x 81.2500 (83.4375) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/21] time 0.181 (0.184) data 0.102 (0.107) loss_x loss_x 0.7007 (0.7567) acc_x 78.1250 (80.2083) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/21] time 0.185 (0.183) data 0.108 (0.105) loss_x loss_x 0.7510 (0.7408) acc_x 84.3750 (80.9375) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 701
clean true:684
clean false:17
clean_rate:0.9757489300998573
noisy true:361
noisy false:554
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 915
epoch [88/200] batch [5/21] time 0.170 (0.178) data 0.093 (0.100) loss_x loss_x 0.4519 (0.6081) acc_x 87.5000 (83.1250) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/21] time 0.184 (0.180) data 0.107 (0.102) loss_x loss_x 0.9033 (0.6059) acc_x 78.1250 (84.0625) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/21] time 0.193 (0.184) data 0.115 (0.107) loss_x loss_x 0.9170 (0.6755) acc_x 75.0000 (82.5000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/21] time 0.179 (0.185) data 0.102 (0.108) loss_x loss_x 0.4431 (0.6473) acc_x 87.5000 (83.5938) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 595
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 677
clean true:659
clean false:18
clean_rate:0.9734121122599705
noisy true:362
noisy false:577
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 939
epoch [89/200] batch [5/21] time 0.177 (0.185) data 0.099 (0.107) loss_x loss_x 0.6797 (0.6356) acc_x 81.2500 (83.7500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/21] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.5649 (0.6561) acc_x 84.3750 (84.0625) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/21] time 0.174 (0.190) data 0.096 (0.112) loss_x loss_x 0.9395 (0.7014) acc_x 75.0000 (82.5000) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/21] time 0.191 (0.188) data 0.114 (0.111) loss_x loss_x 1.3857 (0.7554) acc_x 65.6250 (81.5625) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:676
clean false:17
clean_rate:0.9754689754689755
noisy true:382
noisy false:541
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [90/200] batch [5/21] time 0.185 (0.188) data 0.107 (0.110) loss_x loss_x 0.4146 (0.4967) acc_x 84.3750 (88.1250) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/21] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6812 (0.7322) acc_x 81.2500 (79.6875) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/21] time 0.181 (0.184) data 0.103 (0.107) loss_x loss_x 0.9868 (0.7790) acc_x 71.8750 (78.7500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/21] time 0.171 (0.181) data 0.093 (0.103) loss_x loss_x 0.6265 (0.8035) acc_x 81.2500 (78.9062) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 694
clean true:673
clean false:21
clean_rate:0.9697406340057637
noisy true:361
noisy false:561
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 922
epoch [91/200] batch [5/21] time 0.161 (0.161) data 0.084 (0.083) loss_x loss_x 0.3245 (0.5809) acc_x 93.7500 (86.2500) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/21] time 0.183 (0.163) data 0.104 (0.085) loss_x loss_x 0.5586 (0.6965) acc_x 84.3750 (81.8750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/21] time 0.169 (0.168) data 0.091 (0.090) loss_x loss_x 0.6094 (0.6968) acc_x 84.3750 (81.8750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/21] time 0.169 (0.170) data 0.091 (0.092) loss_x loss_x 0.6206 (0.7277) acc_x 81.2500 (80.6250) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 688
clean true:670
clean false:18
clean_rate:0.9738372093023255
noisy true:365
noisy false:563
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 928
epoch [92/200] batch [5/21] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 1.0430 (0.5927) acc_x 71.8750 (83.1250) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/21] time 0.186 (0.184) data 0.108 (0.106) loss_x loss_x 0.8584 (0.5926) acc_x 81.2500 (83.7500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/21] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.8706 (0.6240) acc_x 84.3750 (84.1667) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/21] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.9707 (0.6824) acc_x 81.2500 (83.1250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.4394, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 710
clean true:694
clean false:16
clean_rate:0.9774647887323944
noisy true:379
noisy false:527
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 906
epoch [93/200] batch [5/22] time 0.185 (0.187) data 0.109 (0.110) loss_x loss_x 0.6816 (0.7566) acc_x 87.5000 (82.5000) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/22] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.4941 (0.6776) acc_x 84.3750 (82.8125) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/22] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.7812 (0.6939) acc_x 87.5000 (83.1250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/22] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.8594 (0.7034) acc_x 75.0000 (82.6562) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.4319, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 698
clean true:684
clean false:14
clean_rate:0.9799426934097422
noisy true:366
noisy false:552
after delete: len(clean_dataset) 698
after delete: len(noisy_dataset) 918
epoch [94/200] batch [5/21] time 0.183 (0.189) data 0.106 (0.112) loss_x loss_x 0.5557 (0.6628) acc_x 87.5000 (83.1250) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/21] time 0.160 (0.183) data 0.083 (0.106) loss_x loss_x 0.7041 (0.6416) acc_x 78.1250 (83.1250) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/21] time 0.190 (0.185) data 0.112 (0.108) loss_x loss_x 0.8804 (0.6695) acc_x 78.1250 (82.5000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/21] time 0.194 (0.188) data 0.118 (0.111) loss_x loss_x 0.8853 (0.6802) acc_x 84.3750 (83.1250) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 547
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 721
clean true:702
clean false:19
clean_rate:0.9736477115117892
noisy true:367
noisy false:528
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 895
epoch [95/200] batch [5/22] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.9126 (0.6411) acc_x 68.7500 (81.2500) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/22] time 0.205 (0.185) data 0.127 (0.108) loss_x loss_x 0.5078 (0.6302) acc_x 87.5000 (83.1250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/22] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.5674 (0.6376) acc_x 87.5000 (82.2917) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/22] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.8154 (0.6610) acc_x 71.8750 (81.5625) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 564
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:678
clean false:15
clean_rate:0.9783549783549783
noisy true:374
noisy false:549
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [96/200] batch [5/21] time 0.181 (0.167) data 0.104 (0.089) loss_x loss_x 0.8052 (0.6673) acc_x 81.2500 (83.7500) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/21] time 0.182 (0.173) data 0.105 (0.095) loss_x loss_x 0.6802 (0.6192) acc_x 71.8750 (83.1250) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/21] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.5068 (0.6922) acc_x 87.5000 (81.0417) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/21] time 0.164 (0.173) data 0.086 (0.096) loss_x loss_x 1.2783 (0.7463) acc_x 65.6250 (79.5312) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.4307, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 696
clean true:678
clean false:18
clean_rate:0.9741379310344828
noisy true:352
noisy false:568
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 920
epoch [97/200] batch [5/21] time 0.159 (0.168) data 0.081 (0.090) loss_x loss_x 0.7363 (0.8363) acc_x 84.3750 (80.6250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/21] time 0.159 (0.164) data 0.082 (0.086) loss_x loss_x 0.4714 (0.7408) acc_x 84.3750 (80.6250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/21] time 0.160 (0.162) data 0.083 (0.085) loss_x loss_x 0.6689 (0.7074) acc_x 84.3750 (81.6667) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [20/21] time 0.162 (0.162) data 0.085 (0.084) loss_x loss_x 0.4543 (0.6635) acc_x 87.5000 (83.1250) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:685
clean false:15
clean_rate:0.9785714285714285
noisy true:364
noisy false:552
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [98/200] batch [5/21] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.5742 (0.5536) acc_x 78.1250 (84.3750) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/21] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5103 (0.6193) acc_x 84.3750 (81.5625) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/21] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.4673 (0.6494) acc_x 84.3750 (80.4167) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/21] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8066 (0.7157) acc_x 78.1250 (79.3750) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 705
clean true:685
clean false:20
clean_rate:0.9716312056737588
noisy true:370
noisy false:541
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 911
epoch [99/200] batch [5/22] time 0.158 (0.172) data 0.081 (0.095) loss_x loss_x 0.6943 (0.7254) acc_x 78.1250 (78.1250) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/22] time 0.186 (0.172) data 0.109 (0.095) loss_x loss_x 0.5127 (0.6403) acc_x 90.6250 (81.5625) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/22] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.4136 (0.6821) acc_x 90.6250 (81.2500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/22] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.6606 (0.6868) acc_x 78.1250 (81.2500) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 719
clean true:699
clean false:20
clean_rate:0.972183588317107
noisy true:365
noisy false:532
all clean rate:  [0.9513677811550152, 0.9708994708994709, 0.9705882352941176, 0.9739478957915831, 0.966804979253112, 0.9688109161793372, 0.9808795411089866, 0.975, 0.9752851711026616, 0.9716981132075472, 0.9757914338919925, 0.9723756906077348, 0.9761029411764706, 0.9819494584837545, 0.9779411764705882, 0.9724612736660929, 0.9770318021201413, 0.9789103690685413, 0.9772329246935202, 0.9767025089605734, 0.9790575916230366, 0.9824253075571178, 0.9858156028368794, 0.9845890410958904, 0.9840142095914742, 0.9800332778702163, 0.9876760563380281, 0.984822934232715, 0.9730185497470489, 0.9815126050420168, 0.9823151125401929, 0.9817275747508306, 0.9806138933764136, 0.9834437086092715, 0.9751243781094527, 0.9738562091503268, 0.9829192546583851, 0.9775641025641025, 0.9765625, 0.9806138933764136, 0.9672386895475819, 0.984, 0.9795275590551181, 0.9753086419753086, 0.9746835443037974, 0.9766718506998445, 0.9749216300940439, 0.9753846153846154, 0.97339593114241, 0.9765625, 0.9717425431711146, 0.9692307692307692, 0.978125, 0.9787556904400607, 0.9754224270353302, 0.9742424242424242, 0.9799382716049383, 0.9673105497771174, 0.9780907668231612, 0.9712121212121212, 0.9746268656716418, 0.9745889387144993, 0.9748520710059172, 0.9755747126436781, 0.9713055954088953, 0.9715142428785607, 0.9742033383915023, 0.976911976911977, 0.9694767441860465, 0.9756446991404012, 0.975975975975976, 0.9752906976744186, 0.9710982658959537, 0.9741641337386018, 0.9751461988304093, 0.9707174231332357, 0.9793205317577548, 0.9793510324483776, 0.9792899408284024, 0.978978978978979, 0.9738751814223512, 0.9762258543833581, 0.977645305514158, 0.9705882352941176, 0.9802816901408451, 0.9753623188405797, 0.9762962962962963, 0.9757489300998573, 0.9734121122599705, 0.9754689754689755, 0.9697406340057637, 0.9738372093023255, 0.9774647887323944, 0.9799426934097422, 0.9736477115117892, 0.9783549783549783, 0.9741379310344828, 0.9785714285714285, 0.9716312056737588, 0.972183588317107]
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 897
epoch [100/200] batch [5/22] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.8843 (0.6534) acc_x 87.5000 (83.7500) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/22] time 0.184 (0.186) data 0.106 (0.109) loss_x loss_x 0.6528 (0.6792) acc_x 84.3750 (83.1250) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/22] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 1.2490 (0.6798) acc_x 71.8750 (83.1250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/22] time 0.196 (0.182) data 0.120 (0.105) loss_x loss_x 0.8530 (0.6853) acc_x 78.1250 (82.9688) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 705
clean true:686
clean false:19
clean_rate:0.9730496453900709
noisy true:370
noisy false:541
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 911
epoch [101/200] batch [5/22] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.3921 (0.6735) acc_x 90.6250 (81.2500) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/22] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.5010 (0.6148) acc_x 87.5000 (83.7500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/22] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.6763 (0.6269) acc_x 87.5000 (83.9583) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/22] time 0.183 (0.188) data 0.105 (0.111) loss_x loss_x 0.8638 (0.6799) acc_x 75.0000 (82.0312) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.4307, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 696
clean true:680
clean false:16
clean_rate:0.9770114942528736
noisy true:375
noisy false:545
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 920
epoch [102/200] batch [5/21] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.5942 (0.7578) acc_x 84.3750 (79.3750) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/21] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.6812 (0.7301) acc_x 78.1250 (80.3125) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/21] time 0.157 (0.177) data 0.080 (0.100) loss_x loss_x 1.2949 (0.7775) acc_x 71.8750 (79.5833) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/21] time 0.160 (0.173) data 0.082 (0.095) loss_x loss_x 0.3743 (0.7058) acc_x 87.5000 (80.9375) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 714
clean true:696
clean false:18
clean_rate:0.9747899159663865
noisy true:378
noisy false:524
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 902
epoch [103/200] batch [5/22] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.5117 (0.7403) acc_x 87.5000 (81.2500) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/22] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.7837 (0.6540) acc_x 78.1250 (82.8125) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/22] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.5703 (0.6395) acc_x 84.3750 (83.3333) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/22] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.4841 (0.6439) acc_x 93.7500 (83.5938) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:684
clean false:16
clean_rate:0.9771428571428571
noisy true:357
noisy false:559
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [104/200] batch [5/21] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7583 (0.5955) acc_x 78.1250 (85.0000) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/21] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.6665 (0.5434) acc_x 81.2500 (85.9375) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/21] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7251 (0.5777) acc_x 81.2500 (85.2083) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/21] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4265 (0.5651) acc_x 87.5000 (85.3125) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.4530, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 732
clean true:713
clean false:19
clean_rate:0.9740437158469946
noisy true:364
noisy false:520
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 884
epoch [105/200] batch [5/22] time 0.186 (0.174) data 0.108 (0.096) loss_x loss_x 0.8022 (0.7387) acc_x 84.3750 (81.2500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/22] time 0.184 (0.176) data 0.106 (0.099) loss_x loss_x 0.4873 (0.7243) acc_x 87.5000 (81.2500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/22] time 0.186 (0.179) data 0.108 (0.101) loss_x loss_x 0.4189 (0.6791) acc_x 87.5000 (81.6667) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/22] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.4070 (0.6737) acc_x 84.3750 (81.7188) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.4394, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 710
clean true:694
clean false:16
clean_rate:0.9774647887323944
noisy true:380
noisy false:526
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 906
epoch [106/200] batch [5/22] time 0.180 (0.189) data 0.104 (0.112) loss_x loss_x 0.9072 (0.7252) acc_x 78.1250 (81.2500) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/22] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.4016 (0.6980) acc_x 87.5000 (82.5000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/22] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.5005 (0.6612) acc_x 84.3750 (82.0833) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/22] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.8438 (0.6507) acc_x 81.2500 (82.6562) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 565
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 701
clean true:683
clean false:18
clean_rate:0.9743223965763196
noisy true:368
noisy false:547
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 915
epoch [107/200] batch [5/21] time 0.183 (0.166) data 0.105 (0.088) loss_x loss_x 0.6855 (0.6053) acc_x 90.6250 (86.8750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/21] time 0.187 (0.175) data 0.110 (0.098) loss_x loss_x 0.5508 (0.6464) acc_x 87.5000 (84.6875) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/21] time 0.176 (0.178) data 0.098 (0.101) loss_x loss_x 0.7446 (0.6186) acc_x 81.2500 (85.0000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/21] time 0.160 (0.176) data 0.082 (0.098) loss_x loss_x 1.0273 (0.6349) acc_x 84.3750 (84.6875) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 712
clean true:689
clean false:23
clean_rate:0.9676966292134831
noisy true:374
noisy false:530
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 904
epoch [108/200] batch [5/22] time 0.171 (0.173) data 0.093 (0.096) loss_x loss_x 1.1367 (0.6673) acc_x 81.2500 (82.5000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/22] time 0.160 (0.166) data 0.082 (0.089) loss_x loss_x 0.6050 (0.6139) acc_x 90.6250 (85.0000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/22] time 0.159 (0.164) data 0.081 (0.087) loss_x loss_x 0.8252 (0.6412) acc_x 81.2500 (84.1667) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/22] time 0.158 (0.163) data 0.081 (0.086) loss_x loss_x 0.9985 (0.6427) acc_x 65.6250 (83.7500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 716
clean true:696
clean false:20
clean_rate:0.9720670391061452
noisy true:359
noisy false:541
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 900
epoch [109/200] batch [5/22] time 0.182 (0.190) data 0.105 (0.113) loss_x loss_x 0.6982 (0.7739) acc_x 84.3750 (80.0000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/22] time 0.185 (0.187) data 0.107 (0.110) loss_x loss_x 0.9121 (0.7242) acc_x 81.2500 (81.5625) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/22] time 0.169 (0.183) data 0.092 (0.106) loss_x loss_x 0.7949 (0.6822) acc_x 78.1250 (83.1250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/22] time 0.183 (0.182) data 0.105 (0.105) loss_x loss_x 1.1670 (0.7086) acc_x 78.1250 (82.9688) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 552
confident_label rate tensor(0.4486, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 725
clean true:705
clean false:20
clean_rate:0.9724137931034482
noisy true:359
noisy false:532
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 891
epoch [110/200] batch [5/22] time 0.212 (0.191) data 0.135 (0.114) loss_x loss_x 0.6826 (0.6665) acc_x 81.2500 (84.3750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/22] time 0.165 (0.179) data 0.088 (0.102) loss_x loss_x 0.8286 (0.7177) acc_x 78.1250 (80.9375) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/22] time 0.193 (0.180) data 0.116 (0.103) loss_x loss_x 1.0762 (0.7475) acc_x 87.5000 (81.6667) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/22] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.8315 (0.7572) acc_x 78.1250 (81.7188) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.4505, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 728
clean true:710
clean false:18
clean_rate:0.9752747252747253
noisy true:386
noisy false:502
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 888
epoch [111/200] batch [5/22] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.6040 (0.6894) acc_x 84.3750 (81.2500) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/22] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.4758 (0.5659) acc_x 84.3750 (84.0625) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/22] time 0.173 (0.183) data 0.096 (0.105) loss_x loss_x 0.7808 (0.6386) acc_x 78.1250 (83.3333) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/22] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7349 (0.6479) acc_x 81.2500 (82.8125) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.4356, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 704
clean true:684
clean false:20
clean_rate:0.9715909090909091
noisy true:357
noisy false:555
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 912
epoch [112/200] batch [5/22] time 0.173 (0.176) data 0.095 (0.098) loss_x loss_x 1.1064 (0.7999) acc_x 71.8750 (80.6250) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/22] time 0.181 (0.177) data 0.103 (0.100) loss_x loss_x 0.6318 (0.7148) acc_x 78.1250 (82.1875) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/22] time 0.215 (0.178) data 0.139 (0.100) loss_x loss_x 0.4644 (0.6708) acc_x 90.6250 (83.1250) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/22] time 0.183 (0.180) data 0.105 (0.103) loss_x loss_x 0.6909 (0.6892) acc_x 84.3750 (82.6562) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 719
clean true:702
clean false:17
clean_rate:0.9763560500695411
noisy true:365
noisy false:532
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 897
epoch [113/200] batch [5/22] time 0.181 (0.172) data 0.104 (0.095) loss_x loss_x 0.8335 (0.7450) acc_x 78.1250 (79.3750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/22] time 0.179 (0.170) data 0.101 (0.093) loss_x loss_x 0.4619 (0.6645) acc_x 87.5000 (82.8125) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/22] time 0.172 (0.172) data 0.094 (0.094) loss_x loss_x 0.4412 (0.6356) acc_x 87.5000 (82.9167) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/22] time 0.161 (0.171) data 0.084 (0.093) loss_x loss_x 1.0713 (0.6630) acc_x 81.2500 (83.2812) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 709
clean true:690
clean false:19
clean_rate:0.9732016925246827
noisy true:381
noisy false:526
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 907
epoch [114/200] batch [5/22] time 0.172 (0.176) data 0.095 (0.099) loss_x loss_x 0.6558 (0.5591) acc_x 87.5000 (84.3750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/22] time 0.158 (0.168) data 0.082 (0.091) loss_x loss_x 0.6128 (0.5828) acc_x 81.2500 (85.0000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/22] time 0.183 (0.170) data 0.106 (0.093) loss_x loss_x 0.4290 (0.5721) acc_x 84.3750 (85.2083) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/22] time 0.160 (0.170) data 0.082 (0.093) loss_x loss_x 0.8115 (0.6089) acc_x 75.0000 (83.5938) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 555
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 699
clean true:681
clean false:18
clean_rate:0.9742489270386266
noisy true:380
noisy false:537
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 917
epoch [115/200] batch [5/21] time 0.184 (0.195) data 0.106 (0.118) loss_x loss_x 0.6797 (0.6877) acc_x 84.3750 (82.5000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/21] time 0.161 (0.184) data 0.083 (0.106) loss_x loss_x 0.3406 (0.6234) acc_x 90.6250 (83.7500) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/21] time 0.159 (0.177) data 0.081 (0.100) loss_x loss_x 0.4351 (0.5843) acc_x 81.2500 (83.9583) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/21] time 0.159 (0.173) data 0.081 (0.096) loss_x loss_x 1.1475 (0.6253) acc_x 68.7500 (83.4375) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 556
confident_label rate tensor(0.4486, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 725
clean true:704
clean false:21
clean_rate:0.9710344827586207
noisy true:356
noisy false:535
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 891
epoch [116/200] batch [5/22] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.6929 (0.5604) acc_x 90.6250 (88.1250) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/22] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 1.2783 (0.6798) acc_x 75.0000 (85.3125) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/22] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.3704 (0.6986) acc_x 90.6250 (83.7500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/22] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.4397 (0.6622) acc_x 87.5000 (83.9062) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 717
clean true:694
clean false:23
clean_rate:0.9679218967921897
noisy true:371
noisy false:528
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 899
epoch [117/200] batch [5/22] time 0.169 (0.173) data 0.091 (0.096) loss_x loss_x 0.6426 (0.6062) acc_x 90.6250 (88.7500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/22] time 0.165 (0.175) data 0.088 (0.098) loss_x loss_x 0.8203 (0.6364) acc_x 65.6250 (84.3750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/22] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.8228 (0.6549) acc_x 71.8750 (82.9167) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/22] time 0.162 (0.180) data 0.084 (0.102) loss_x loss_x 1.0459 (0.6608) acc_x 75.0000 (83.2812) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 692
clean true:672
clean false:20
clean_rate:0.9710982658959537
noisy true:375
noisy false:549
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 924
epoch [118/200] batch [5/21] time 0.159 (0.182) data 0.082 (0.104) loss_x loss_x 0.6240 (0.7302) acc_x 78.1250 (79.3750) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/21] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.5015 (0.6997) acc_x 90.6250 (80.6250) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/21] time 0.161 (0.180) data 0.083 (0.102) loss_x loss_x 0.7109 (0.7053) acc_x 84.3750 (81.0417) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/21] time 0.181 (0.180) data 0.104 (0.102) loss_x loss_x 0.3711 (0.6400) acc_x 93.7500 (83.1250) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 705
clean true:684
clean false:21
clean_rate:0.9702127659574468
noisy true:374
noisy false:537
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 911
epoch [119/200] batch [5/22] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.5293 (0.6311) acc_x 78.1250 (82.5000) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/22] time 0.183 (0.170) data 0.106 (0.092) loss_x loss_x 0.3987 (0.6722) acc_x 96.8750 (83.7500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/22] time 0.195 (0.175) data 0.118 (0.097) loss_x loss_x 0.6973 (0.6929) acc_x 78.1250 (82.7083) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/22] time 0.182 (0.177) data 0.105 (0.099) loss_x loss_x 0.6172 (0.7006) acc_x 87.5000 (82.5000) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 541
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 717
clean true:702
clean false:15
clean_rate:0.9790794979079498
noisy true:373
noisy false:526
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 899
epoch [120/200] batch [5/22] time 0.183 (0.196) data 0.106 (0.119) loss_x loss_x 0.8262 (0.6253) acc_x 81.2500 (83.1250) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/22] time 0.179 (0.189) data 0.101 (0.112) loss_x loss_x 0.9019 (0.6486) acc_x 81.2500 (83.1250) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/22] time 0.185 (0.187) data 0.107 (0.109) loss_x loss_x 0.4656 (0.6259) acc_x 87.5000 (83.7500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/22] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.2316 (0.6502) acc_x 96.8750 (83.5938) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 550
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 726
clean true:704
clean false:22
clean_rate:0.9696969696969697
noisy true:362
noisy false:528
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 890
epoch [121/200] batch [5/22] time 0.185 (0.191) data 0.108 (0.114) loss_x loss_x 0.2003 (0.6707) acc_x 93.7500 (83.1250) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/22] time 0.176 (0.194) data 0.099 (0.116) loss_x loss_x 0.5596 (0.6243) acc_x 81.2500 (84.3750) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/22] time 0.172 (0.189) data 0.095 (0.112) loss_x loss_x 1.0391 (0.6138) acc_x 75.0000 (83.3333) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/22] time 0.181 (0.188) data 0.104 (0.111) loss_x loss_x 0.5439 (0.6274) acc_x 90.6250 (83.5938) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 717
clean true:701
clean false:16
clean_rate:0.9776847977684798
noisy true:388
noisy false:511
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 899
epoch [122/200] batch [5/22] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.4949 (0.6738) acc_x 84.3750 (82.5000) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/22] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.2013 (0.6598) acc_x 96.8750 (83.7500) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/22] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.4773 (0.6592) acc_x 90.6250 (83.1250) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/22] time 0.198 (0.181) data 0.120 (0.104) loss_x loss_x 1.1201 (0.6607) acc_x 84.3750 (83.5938) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 522
confident_label rate tensor(0.4499, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 727
clean true:711
clean false:16
clean_rate:0.9779917469050894
noisy true:383
noisy false:506
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 889
epoch [123/200] batch [5/22] time 0.185 (0.174) data 0.108 (0.097) loss_x loss_x 0.4055 (0.4062) acc_x 87.5000 (90.0000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/22] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.8525 (0.4990) acc_x 78.1250 (86.5625) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/22] time 0.186 (0.182) data 0.108 (0.105) loss_x loss_x 0.2617 (0.4768) acc_x 93.7500 (87.9167) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/22] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.6108 (0.5360) acc_x 84.3750 (85.7812) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:690
clean false:17
clean_rate:0.9759547383309759
noisy true:367
noisy false:542
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [124/200] batch [5/22] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.3323 (0.6321) acc_x 90.6250 (85.0000) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/22] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.8516 (0.7270) acc_x 84.3750 (83.4375) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/22] time 0.190 (0.187) data 0.112 (0.109) loss_x loss_x 0.3955 (0.6757) acc_x 90.6250 (84.1667) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/22] time 0.159 (0.182) data 0.081 (0.105) loss_x loss_x 0.9922 (0.6851) acc_x 78.1250 (83.7500) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.4511, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 729
clean true:714
clean false:15
clean_rate:0.9794238683127572
noisy true:382
noisy false:505
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 887
epoch [125/200] batch [5/22] time 0.175 (0.180) data 0.097 (0.103) loss_x loss_x 0.7622 (0.6236) acc_x 81.2500 (81.2500) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/22] time 0.157 (0.173) data 0.080 (0.095) loss_x loss_x 0.4988 (0.5923) acc_x 75.0000 (81.5625) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/22] time 0.162 (0.168) data 0.084 (0.091) loss_x loss_x 0.5630 (0.6698) acc_x 87.5000 (80.8333) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/22] time 0.166 (0.169) data 0.088 (0.091) loss_x loss_x 0.5742 (0.6469) acc_x 87.5000 (82.5000) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 541
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:690
clean false:17
clean_rate:0.9759547383309759
noisy true:385
noisy false:524
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [126/200] batch [5/22] time 0.184 (0.186) data 0.105 (0.108) loss_x loss_x 0.7832 (0.6016) acc_x 81.2500 (85.0000) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/22] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.6553 (0.5909) acc_x 90.6250 (86.2500) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/22] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 1.0586 (0.6804) acc_x 78.1250 (82.5000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/22] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.6699 (0.6797) acc_x 81.2500 (82.3438) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 714
clean true:694
clean false:20
clean_rate:0.9719887955182073
noisy true:390
noisy false:512
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 902
epoch [127/200] batch [5/22] time 0.183 (0.183) data 0.106 (0.105) loss_x loss_x 0.4602 (0.5423) acc_x 87.5000 (86.8750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/22] time 0.185 (0.183) data 0.106 (0.106) loss_x loss_x 0.6147 (0.6056) acc_x 84.3750 (85.3125) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/22] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.3196 (0.5849) acc_x 90.6250 (85.2083) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/22] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.7686 (0.6026) acc_x 81.2500 (84.6875) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 717
clean true:701
clean false:16
clean_rate:0.9776847977684798
noisy true:381
noisy false:518
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 899
epoch [128/200] batch [5/22] time 0.185 (0.184) data 0.107 (0.106) loss_x loss_x 0.2087 (0.3287) acc_x 96.8750 (91.2500) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/22] time 0.183 (0.183) data 0.106 (0.105) loss_x loss_x 0.3867 (0.4672) acc_x 90.6250 (87.8125) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/22] time 0.181 (0.183) data 0.104 (0.105) loss_x loss_x 0.8013 (0.5430) acc_x 81.2500 (86.2500) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/22] time 0.182 (0.183) data 0.104 (0.105) loss_x loss_x 0.8452 (0.5969) acc_x 87.5000 (85.0000) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 718
clean true:700
clean false:18
clean_rate:0.9749303621169917
noisy true:372
noisy false:526
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 898
epoch [129/200] batch [5/22] time 0.164 (0.175) data 0.086 (0.097) loss_x loss_x 0.6846 (0.7260) acc_x 78.1250 (80.6250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/22] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.7490 (0.6355) acc_x 81.2500 (84.0625) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/22] time 0.182 (0.183) data 0.104 (0.106) loss_x loss_x 0.8101 (0.6663) acc_x 81.2500 (83.5417) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/22] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6763 (0.6743) acc_x 84.3750 (82.5000) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 705
clean true:688
clean false:17
clean_rate:0.975886524822695
noisy true:353
noisy false:558
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 911
epoch [130/200] batch [5/22] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 1.0918 (0.7301) acc_x 81.2500 (84.3750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/22] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.8423 (0.7056) acc_x 81.2500 (82.8125) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/22] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 0.7349 (0.7096) acc_x 81.2500 (82.7083) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/22] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.5151 (0.6664) acc_x 90.6250 (83.9062) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.4474, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 723
clean true:707
clean false:16
clean_rate:0.9778699861687413
noisy true:372
noisy false:521
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 893
epoch [131/200] batch [5/22] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.6445 (0.6204) acc_x 87.5000 (83.7500) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/22] time 0.180 (0.183) data 0.104 (0.106) loss_x loss_x 0.4082 (0.6897) acc_x 93.7500 (83.1250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/22] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.3101 (0.6599) acc_x 93.7500 (83.7500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/22] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.5771 (0.6371) acc_x 81.2500 (83.2812) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 520
confident_label rate tensor(0.4511, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 729
clean true:713
clean false:16
clean_rate:0.9780521262002744
noisy true:383
noisy false:504
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 887
epoch [132/200] batch [5/22] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.8433 (0.5740) acc_x 75.0000 (83.1250) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/22] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.5273 (0.5279) acc_x 78.1250 (85.3125) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/22] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.8345 (0.6089) acc_x 84.3750 (84.3750) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/22] time 0.157 (0.179) data 0.081 (0.102) loss_x loss_x 0.7617 (0.6206) acc_x 81.2500 (84.0625) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 523
confident_label rate tensor(0.4554, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 736
clean true:719
clean false:17
clean_rate:0.9769021739130435
noisy true:374
noisy false:506
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 880
epoch [133/200] batch [5/23] time 0.181 (0.189) data 0.104 (0.112) loss_x loss_x 1.0537 (0.6774) acc_x 75.0000 (83.1250) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/23] time 0.180 (0.193) data 0.103 (0.116) loss_x loss_x 0.7275 (0.6353) acc_x 78.1250 (83.4375) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/23] time 0.190 (0.191) data 0.113 (0.114) loss_x loss_x 0.8325 (0.6340) acc_x 78.1250 (83.3333) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/23] time 0.183 (0.192) data 0.106 (0.115) loss_x loss_x 0.6133 (0.6607) acc_x 84.3750 (82.8125) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.4592, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 742
clean true:726
clean false:16
clean_rate:0.9784366576819407
noisy true:362
noisy false:512
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 874
epoch [134/200] batch [5/23] time 0.214 (0.187) data 0.138 (0.110) loss_x loss_x 0.3467 (0.6122) acc_x 90.6250 (83.7500) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/23] time 0.190 (0.183) data 0.112 (0.106) loss_x loss_x 0.7339 (0.7752) acc_x 87.5000 (83.1250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/23] time 0.185 (0.181) data 0.108 (0.103) loss_x loss_x 1.1895 (0.7486) acc_x 65.6250 (82.7083) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/23] time 0.177 (0.178) data 0.100 (0.100) loss_x loss_x 0.7954 (0.7219) acc_x 71.8750 (82.8125) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.4647, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 751
clean true:733
clean false:18
clean_rate:0.9760319573901465
noisy true:385
noisy false:480
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 865
epoch [135/200] batch [5/23] time 0.164 (0.177) data 0.087 (0.099) loss_x loss_x 0.9746 (0.7873) acc_x 78.1250 (79.3750) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/23] time 0.183 (0.174) data 0.105 (0.097) loss_x loss_x 0.6484 (0.6854) acc_x 81.2500 (81.8750) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/23] time 0.201 (0.185) data 0.124 (0.107) loss_x loss_x 0.6895 (0.6225) acc_x 84.3750 (83.9583) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/23] time 0.184 (0.185) data 0.108 (0.107) loss_x loss_x 0.4075 (0.6345) acc_x 87.5000 (84.3750) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 721
clean true:704
clean false:17
clean_rate:0.9764216366158114
noisy true:355
noisy false:540
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 895
epoch [136/200] batch [5/22] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.6846 (0.5389) acc_x 87.5000 (87.5000) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/22] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6353 (0.5668) acc_x 81.2500 (85.0000) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/22] time 0.186 (0.184) data 0.108 (0.106) loss_x loss_x 0.4194 (0.5732) acc_x 84.3750 (84.7917) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/22] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.7007 (0.5980) acc_x 78.1250 (83.9062) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.4511, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 729
clean true:709
clean false:20
clean_rate:0.9725651577503429
noisy true:390
noisy false:497
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 887
epoch [137/200] batch [5/22] time 0.184 (0.165) data 0.107 (0.087) loss_x loss_x 0.5254 (0.5231) acc_x 87.5000 (86.2500) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/22] time 0.181 (0.174) data 0.104 (0.096) loss_x loss_x 0.5703 (0.5254) acc_x 87.5000 (86.2500) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/22] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.3479 (0.5678) acc_x 90.6250 (85.8333) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/22] time 0.184 (0.179) data 0.107 (0.101) loss_x loss_x 0.7070 (0.6174) acc_x 81.2500 (85.0000) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.4468, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 722
clean true:703
clean false:19
clean_rate:0.9736842105263158
noisy true:374
noisy false:520
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 894
epoch [138/200] batch [5/22] time 0.195 (0.193) data 0.118 (0.116) loss_x loss_x 0.7568 (0.6807) acc_x 81.2500 (78.7500) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/22] time 0.186 (0.190) data 0.109 (0.112) loss_x loss_x 0.4575 (0.5896) acc_x 90.6250 (83.7500) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/22] time 0.180 (0.188) data 0.103 (0.110) loss_x loss_x 1.0068 (0.5952) acc_x 81.2500 (84.7917) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/22] time 0.184 (0.187) data 0.106 (0.109) loss_x loss_x 0.3645 (0.5685) acc_x 87.5000 (85.7812) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.4585, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 741
clean true:720
clean false:21
clean_rate:0.97165991902834
noisy true:380
noisy false:495
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 875
epoch [139/200] batch [5/23] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.7510 (0.4921) acc_x 81.2500 (83.7500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/23] time 0.191 (0.184) data 0.114 (0.107) loss_x loss_x 0.8203 (0.5464) acc_x 75.0000 (84.6875) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/23] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.5776 (0.5967) acc_x 84.3750 (84.5833) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/23] time 0.171 (0.188) data 0.092 (0.110) loss_x loss_x 0.4724 (0.6095) acc_x 90.6250 (84.3750) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 714
clean true:696
clean false:18
clean_rate:0.9747899159663865
noisy true:367
noisy false:535
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 902
epoch [140/200] batch [5/22] time 0.186 (0.175) data 0.108 (0.098) loss_x loss_x 0.1930 (0.7657) acc_x 96.8750 (83.1250) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/22] time 0.184 (0.178) data 0.106 (0.101) loss_x loss_x 0.4207 (0.6763) acc_x 90.6250 (82.8125) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/22] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.5654 (0.6406) acc_x 87.5000 (83.7500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/22] time 0.217 (0.181) data 0.139 (0.104) loss_x loss_x 0.6802 (0.6673) acc_x 84.3750 (83.2812) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.4573, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 739
clean true:721
clean false:18
clean_rate:0.9756427604871448
noisy true:367
noisy false:510
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 877
epoch [141/200] batch [5/23] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.3105 (0.5620) acc_x 93.7500 (86.8750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/23] time 0.182 (0.184) data 0.104 (0.107) loss_x loss_x 0.4482 (0.5939) acc_x 84.3750 (84.3750) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/23] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 1.1055 (0.6288) acc_x 68.7500 (83.5417) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/23] time 0.187 (0.186) data 0.109 (0.109) loss_x loss_x 0.9849 (0.6640) acc_x 75.0000 (82.8125) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.4517, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 730
clean true:710
clean false:20
clean_rate:0.9726027397260274
noisy true:369
noisy false:517
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 886
epoch [142/200] batch [5/22] time 0.186 (0.170) data 0.108 (0.092) loss_x loss_x 0.8354 (0.6889) acc_x 71.8750 (78.7500) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/22] time 0.200 (0.176) data 0.122 (0.099) loss_x loss_x 0.7021 (0.6547) acc_x 81.2500 (80.0000) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/22] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.9380 (0.6888) acc_x 68.7500 (78.7500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/22] time 0.183 (0.180) data 0.106 (0.102) loss_x loss_x 0.5923 (0.6568) acc_x 81.2500 (80.3125) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.4505, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 728
clean true:711
clean false:17
clean_rate:0.9766483516483516
noisy true:370
noisy false:518
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 888
epoch [143/200] batch [5/22] time 0.182 (0.183) data 0.104 (0.105) loss_x loss_x 0.4438 (0.4711) acc_x 87.5000 (90.6250) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/22] time 0.187 (0.184) data 0.109 (0.106) loss_x loss_x 0.8120 (0.5253) acc_x 75.0000 (88.1250) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/22] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.4224 (0.5362) acc_x 87.5000 (87.5000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/22] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.4023 (0.5408) acc_x 84.3750 (87.3438) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.4623, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 747
clean true:731
clean false:16
clean_rate:0.9785809906291834
noisy true:373
noisy false:496
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 869
epoch [144/200] batch [5/23] time 0.159 (0.174) data 0.081 (0.097) loss_x loss_x 0.7852 (0.6563) acc_x 78.1250 (82.5000) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/23] time 0.176 (0.177) data 0.099 (0.099) loss_x loss_x 0.5444 (0.5933) acc_x 78.1250 (82.5000) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/23] time 0.210 (0.176) data 0.133 (0.099) loss_x loss_x 0.4971 (0.6063) acc_x 87.5000 (83.3333) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/23] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.9048 (0.6014) acc_x 81.2500 (83.5938) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.4468, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 722
clean true:705
clean false:17
clean_rate:0.9764542936288089
noisy true:379
noisy false:515
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 894
epoch [145/200] batch [5/22] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.6772 (0.6801) acc_x 75.0000 (80.0000) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/22] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.3687 (0.6106) acc_x 90.6250 (81.5625) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/22] time 0.183 (0.181) data 0.106 (0.103) loss_x loss_x 0.9585 (0.6321) acc_x 78.1250 (81.6667) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/22] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 1.1064 (0.6372) acc_x 71.8750 (81.4062) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.4530, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 732
clean true:717
clean false:15
clean_rate:0.9795081967213115
noisy true:387
noisy false:497
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 884
epoch [146/200] batch [5/22] time 0.162 (0.180) data 0.084 (0.103) loss_x loss_x 0.6118 (0.7281) acc_x 81.2500 (78.1250) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/22] time 0.162 (0.171) data 0.085 (0.093) loss_x loss_x 0.2361 (0.6660) acc_x 93.7500 (80.6250) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/22] time 0.180 (0.170) data 0.103 (0.093) loss_x loss_x 0.4941 (0.6209) acc_x 84.3750 (82.7083) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/22] time 0.184 (0.174) data 0.107 (0.096) loss_x loss_x 0.3193 (0.6272) acc_x 93.7500 (82.9688) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.4672, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 755
clean true:737
clean false:18
clean_rate:0.976158940397351
noisy true:362
noisy false:499
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 861
epoch [147/200] batch [5/23] time 0.182 (0.192) data 0.105 (0.115) loss_x loss_x 0.7524 (0.6656) acc_x 87.5000 (81.2500) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/23] time 0.161 (0.181) data 0.082 (0.104) loss_x loss_x 0.5439 (0.6140) acc_x 90.6250 (84.6875) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/23] time 0.185 (0.183) data 0.108 (0.105) loss_x loss_x 0.6772 (0.6215) acc_x 81.2500 (84.7917) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/23] time 0.183 (0.183) data 0.105 (0.106) loss_x loss_x 0.3684 (0.5852) acc_x 90.6250 (85.1562) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4635, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 749
clean true:730
clean false:19
clean_rate:0.9746328437917223
noisy true:380
noisy false:487
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 867
epoch [148/200] batch [5/23] time 0.182 (0.179) data 0.104 (0.101) loss_x loss_x 0.7466 (0.5271) acc_x 75.0000 (85.6250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/23] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.2615 (0.4651) acc_x 96.8750 (87.5000) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/23] time 0.181 (0.182) data 0.103 (0.104) loss_x loss_x 1.0078 (0.5619) acc_x 71.8750 (85.8333) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/23] time 0.177 (0.182) data 0.099 (0.104) loss_x loss_x 0.1459 (0.5932) acc_x 96.8750 (84.3750) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 523
confident_label rate tensor(0.4517, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 730
clean true:712
clean false:18
clean_rate:0.9753424657534246
noisy true:381
noisy false:505
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 886
epoch [149/200] batch [5/22] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 1.2178 (0.9241) acc_x 71.8750 (80.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/22] time 0.183 (0.186) data 0.105 (0.108) loss_x loss_x 0.7534 (0.7493) acc_x 78.1250 (83.4375) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/22] time 0.186 (0.186) data 0.109 (0.108) loss_x loss_x 0.4888 (0.6756) acc_x 90.6250 (85.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/22] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.5488 (0.6320) acc_x 81.2500 (85.3125) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.4542, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 734
clean true:716
clean false:18
clean_rate:0.9754768392370572
noisy true:371
noisy false:511
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 882
epoch [150/200] batch [5/22] time 0.189 (0.185) data 0.112 (0.107) loss_x loss_x 0.8774 (0.6208) acc_x 75.0000 (83.1250) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/22] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 1.0137 (0.6392) acc_x 75.0000 (83.1250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/22] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.4504 (0.6113) acc_x 87.5000 (83.5417) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/22] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.3684 (0.6058) acc_x 93.7500 (84.5312) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.4530, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 732
clean true:717
clean false:15
clean_rate:0.9795081967213115
noisy true:381
noisy false:503
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 884
epoch [151/200] batch [5/22] time 0.185 (0.184) data 0.107 (0.106) loss_x loss_x 0.4143 (0.5742) acc_x 90.6250 (85.6250) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/22] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.7363 (0.5976) acc_x 81.2500 (84.6875) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/22] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.7412 (0.6294) acc_x 81.2500 (84.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/22] time 0.169 (0.178) data 0.092 (0.100) loss_x loss_x 0.4939 (0.6365) acc_x 90.6250 (84.2188) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 515
confident_label rate tensor(0.4623, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 747
clean true:728
clean false:19
clean_rate:0.9745649263721553
noisy true:373
noisy false:496
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 869
epoch [152/200] batch [5/23] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.7461 (0.5930) acc_x 87.5000 (88.7500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/23] time 0.204 (0.184) data 0.127 (0.106) loss_x loss_x 0.7695 (0.6816) acc_x 84.3750 (85.3125) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/23] time 0.164 (0.182) data 0.087 (0.104) loss_x loss_x 0.5449 (0.6500) acc_x 84.3750 (86.0417) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/23] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.8452 (0.6635) acc_x 84.3750 (85.7812) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.4635, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 749
clean true:730
clean false:19
clean_rate:0.9746328437917223
noisy true:393
noisy false:474
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 867
epoch [153/200] batch [5/23] time 0.182 (0.193) data 0.104 (0.116) loss_x loss_x 0.6133 (0.5788) acc_x 87.5000 (85.6250) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/23] time 0.185 (0.193) data 0.107 (0.115) loss_x loss_x 0.7236 (0.5493) acc_x 75.0000 (85.6250) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/23] time 0.183 (0.189) data 0.106 (0.112) loss_x loss_x 0.4668 (0.5739) acc_x 90.6250 (84.7917) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/23] time 0.196 (0.190) data 0.119 (0.113) loss_x loss_x 0.4612 (0.6001) acc_x 87.5000 (85.0000) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.4629, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 748
clean true:726
clean false:22
clean_rate:0.9705882352941176
noisy true:393
noisy false:475
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 868
epoch [154/200] batch [5/23] time 0.174 (0.162) data 0.097 (0.085) loss_x loss_x 0.8496 (0.6097) acc_x 81.2500 (86.2500) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/23] time 0.188 (0.171) data 0.111 (0.093) loss_x loss_x 0.9346 (0.6639) acc_x 71.8750 (84.0625) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/23] time 0.174 (0.178) data 0.097 (0.100) loss_x loss_x 0.2092 (0.6597) acc_x 93.7500 (84.3750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/23] time 0.202 (0.177) data 0.124 (0.100) loss_x loss_x 0.7231 (0.6502) acc_x 84.3750 (84.2188) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 509
confident_label rate tensor(0.4604, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 744
clean true:727
clean false:17
clean_rate:0.9771505376344086
noisy true:380
noisy false:492
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 872
epoch [155/200] batch [5/23] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.5420 (0.5625) acc_x 87.5000 (84.3750) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/23] time 0.182 (0.184) data 0.104 (0.106) loss_x loss_x 0.3218 (0.5398) acc_x 90.6250 (84.6875) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/23] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.4868 (0.5649) acc_x 90.6250 (84.5833) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/23] time 0.184 (0.178) data 0.106 (0.100) loss_x loss_x 0.3721 (0.5603) acc_x 93.7500 (85.0000) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.4486, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 725
clean true:708
clean false:17
clean_rate:0.976551724137931
noisy true:378
noisy false:513
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 891
epoch [156/200] batch [5/22] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.7188 (0.6438) acc_x 78.1250 (82.5000) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/22] time 0.183 (0.182) data 0.105 (0.105) loss_x loss_x 0.9595 (0.7034) acc_x 75.0000 (81.2500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/22] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.6826 (0.6589) acc_x 81.2500 (82.2917) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/22] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.9033 (0.6824) acc_x 75.0000 (81.2500) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.4641, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 750
clean true:732
clean false:18
clean_rate:0.976
noisy true:366
noisy false:500
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 866
epoch [157/200] batch [5/23] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 1.1172 (0.6218) acc_x 75.0000 (85.6250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/23] time 0.166 (0.177) data 0.088 (0.099) loss_x loss_x 0.7119 (0.6271) acc_x 78.1250 (84.6875) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/23] time 0.182 (0.178) data 0.104 (0.100) loss_x loss_x 0.6074 (0.6507) acc_x 78.1250 (83.7500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/23] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 1.2500 (0.6673) acc_x 75.0000 (83.5938) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.4653, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 752
clean true:733
clean false:19
clean_rate:0.9747340425531915
noisy true:369
noisy false:495
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 864
epoch [158/200] batch [5/23] time 0.175 (0.168) data 0.097 (0.091) loss_x loss_x 0.7456 (0.6521) acc_x 84.3750 (83.1250) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/23] time 0.187 (0.174) data 0.109 (0.097) loss_x loss_x 0.4561 (0.6540) acc_x 87.5000 (80.9375) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/23] time 0.190 (0.178) data 0.113 (0.101) loss_x loss_x 0.3562 (0.6261) acc_x 87.5000 (82.5000) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/23] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.4277 (0.5999) acc_x 90.6250 (83.1250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 502
confident_label rate tensor(0.4604, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 744
clean true:725
clean false:19
clean_rate:0.9744623655913979
noisy true:389
noisy false:483
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 872
epoch [159/200] batch [5/23] time 0.162 (0.181) data 0.086 (0.104) loss_x loss_x 0.8154 (0.7055) acc_x 81.2500 (83.7500) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/23] time 0.158 (0.173) data 0.081 (0.096) loss_x loss_x 1.1201 (0.7621) acc_x 71.8750 (79.3750) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/23] time 0.174 (0.175) data 0.096 (0.098) loss_x loss_x 0.4888 (0.6882) acc_x 84.3750 (80.8333) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/23] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.4622 (0.6510) acc_x 87.5000 (81.8750) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.4629, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 748
clean true:724
clean false:24
clean_rate:0.9679144385026738
noisy true:374
noisy false:494
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 868
epoch [160/200] batch [5/23] time 0.161 (0.178) data 0.083 (0.101) loss_x loss_x 0.3811 (0.8542) acc_x 90.6250 (81.2500) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/23] time 0.174 (0.177) data 0.096 (0.099) loss_x loss_x 0.9297 (0.8489) acc_x 75.0000 (80.3125) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/23] time 0.174 (0.181) data 0.097 (0.103) loss_x loss_x 0.4326 (0.7602) acc_x 87.5000 (81.8750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/23] time 0.166 (0.181) data 0.089 (0.103) loss_x loss_x 0.3337 (0.6942) acc_x 93.7500 (83.4375) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.4567, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 738
clean true:722
clean false:16
clean_rate:0.978319783197832
noisy true:382
noisy false:496
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 878
epoch [161/200] batch [5/23] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.8765 (0.6336) acc_x 71.8750 (83.1250) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/23] time 0.188 (0.186) data 0.111 (0.109) loss_x loss_x 0.5923 (0.6548) acc_x 78.1250 (82.1875) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/23] time 0.187 (0.186) data 0.109 (0.108) loss_x loss_x 0.3481 (0.6845) acc_x 93.7500 (81.8750) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/23] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.6924 (0.6726) acc_x 87.5000 (82.0312) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4542, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 734
clean true:719
clean false:15
clean_rate:0.9795640326975477
noisy true:372
noisy false:510
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 882
epoch [162/200] batch [5/22] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.2188 (0.4087) acc_x 96.8750 (91.2500) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/22] time 0.171 (0.187) data 0.094 (0.109) loss_x loss_x 0.7769 (0.6251) acc_x 81.2500 (85.0000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/22] time 0.185 (0.183) data 0.108 (0.105) loss_x loss_x 0.6143 (0.6719) acc_x 84.3750 (83.3333) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/22] time 0.187 (0.183) data 0.109 (0.106) loss_x loss_x 0.3765 (0.6615) acc_x 90.6250 (83.5938) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:716
clean false:19
clean_rate:0.9741496598639455
noisy true:375
noisy false:506
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [163/200] batch [5/22] time 0.184 (0.183) data 0.106 (0.105) loss_x loss_x 0.2257 (0.3859) acc_x 100.0000 (91.8750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/22] time 0.180 (0.186) data 0.102 (0.108) loss_x loss_x 0.9175 (0.5524) acc_x 84.3750 (87.5000) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/22] time 0.185 (0.184) data 0.107 (0.106) loss_x loss_x 0.9980 (0.6252) acc_x 71.8750 (85.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/22] time 0.196 (0.185) data 0.119 (0.108) loss_x loss_x 0.9600 (0.6373) acc_x 68.7500 (84.2188) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 760
clean true:743
clean false:17
clean_rate:0.9776315789473684
noisy true:389
noisy false:467
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 856
epoch [164/200] batch [5/23] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 1.0322 (0.7693) acc_x 71.8750 (81.8750) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/23] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 0.7500 (0.7154) acc_x 84.3750 (81.8750) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/23] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.8491 (0.6789) acc_x 81.2500 (82.9167) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/23] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.8872 (0.6865) acc_x 75.0000 (82.3438) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 531
confident_label rate tensor(0.4517, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 730
clean true:711
clean false:19
clean_rate:0.9739726027397261
noisy true:374
noisy false:512
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 886
epoch [165/200] batch [5/22] time 0.159 (0.166) data 0.082 (0.089) loss_x loss_x 0.5078 (0.7250) acc_x 87.5000 (83.7500) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/22] time 0.160 (0.163) data 0.082 (0.086) loss_x loss_x 1.2461 (0.7316) acc_x 68.7500 (81.8750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/22] time 0.182 (0.167) data 0.105 (0.089) loss_x loss_x 0.4424 (0.6901) acc_x 90.6250 (83.3333) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/22] time 0.198 (0.172) data 0.120 (0.095) loss_x loss_x 0.3948 (0.6819) acc_x 87.5000 (83.7500) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.4536, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 733
clean true:719
clean false:14
clean_rate:0.9809004092769441
noisy true:383
noisy false:500
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 883
epoch [166/200] batch [5/22] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.5205 (0.5577) acc_x 81.2500 (86.2500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/22] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.5518 (0.5478) acc_x 81.2500 (85.3125) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/22] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.8447 (0.6026) acc_x 78.1250 (83.5417) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/22] time 0.185 (0.183) data 0.108 (0.105) loss_x loss_x 0.9844 (0.6118) acc_x 84.3750 (84.5312) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 760
clean true:744
clean false:16
clean_rate:0.9789473684210527
noisy true:385
noisy false:471
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 856
epoch [167/200] batch [5/23] time 0.171 (0.183) data 0.093 (0.106) loss_x loss_x 0.8169 (0.5736) acc_x 78.1250 (85.0000) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/23] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.7432 (0.6335) acc_x 84.3750 (84.6875) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/23] time 0.179 (0.181) data 0.102 (0.103) loss_x loss_x 0.8091 (0.6291) acc_x 81.2500 (85.6250) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/23] time 0.165 (0.180) data 0.088 (0.102) loss_x loss_x 0.8965 (0.6036) acc_x 78.1250 (86.7188) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.4647, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 751
clean true:732
clean false:19
clean_rate:0.9747003994673769
noisy true:373
noisy false:492
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 865
epoch [168/200] batch [5/23] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.9751 (0.7952) acc_x 75.0000 (76.2500) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/23] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.7490 (0.7318) acc_x 78.1250 (78.7500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/23] time 0.170 (0.182) data 0.093 (0.105) loss_x loss_x 0.5483 (0.6279) acc_x 87.5000 (82.2917) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/23] time 0.184 (0.184) data 0.106 (0.106) loss_x loss_x 0.4270 (0.6026) acc_x 87.5000 (83.4375) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 538
confident_label rate tensor(0.4517, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 730
clean true:708
clean false:22
clean_rate:0.9698630136986301
noisy true:370
noisy false:516
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 886
epoch [169/200] batch [5/22] time 0.191 (0.189) data 0.114 (0.111) loss_x loss_x 0.7192 (0.6381) acc_x 84.3750 (81.8750) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/22] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 0.3774 (0.6653) acc_x 93.7500 (81.2500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/22] time 0.182 (0.182) data 0.105 (0.104) loss_x loss_x 0.9121 (0.6604) acc_x 78.1250 (82.2917) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/22] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.5693 (0.5980) acc_x 78.1250 (83.9062) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.4641, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 750
clean true:730
clean false:20
clean_rate:0.9733333333333334
noisy true:374
noisy false:492
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 866
epoch [170/200] batch [5/23] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.8569 (0.5749) acc_x 81.2500 (86.8750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/23] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6294 (0.5827) acc_x 81.2500 (85.9375) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/23] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.5503 (0.5830) acc_x 84.3750 (84.7917) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/23] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.5425 (0.5486) acc_x 87.5000 (85.7812) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 756
clean true:734
clean false:22
clean_rate:0.9708994708994709
noisy true:378
noisy false:482
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 860
epoch [171/200] batch [5/23] time 0.182 (0.164) data 0.105 (0.087) loss_x loss_x 0.7163 (0.5043) acc_x 78.1250 (87.5000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/23] time 0.181 (0.172) data 0.104 (0.095) loss_x loss_x 0.5742 (0.5542) acc_x 78.1250 (86.8750) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/23] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.9082 (0.5954) acc_x 68.7500 (85.0000) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/23] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 1.0020 (0.6148) acc_x 78.1250 (84.0625) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.4635, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 749
clean true:731
clean false:18
clean_rate:0.9759679572763685
noisy true:380
noisy false:487
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 867
epoch [172/200] batch [5/23] time 0.160 (0.164) data 0.083 (0.086) loss_x loss_x 0.3323 (0.5346) acc_x 87.5000 (86.8750) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/23] time 0.157 (0.161) data 0.080 (0.084) loss_x loss_x 0.9287 (0.5935) acc_x 78.1250 (84.0625) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/23] time 0.160 (0.161) data 0.082 (0.084) loss_x loss_x 0.5552 (0.6048) acc_x 87.5000 (85.0000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/23] time 0.161 (0.161) data 0.083 (0.084) loss_x loss_x 0.6396 (0.6042) acc_x 78.1250 (85.0000) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.4610, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 745
clean true:726
clean false:19
clean_rate:0.974496644295302
noisy true:389
noisy false:482
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 871
epoch [173/200] batch [5/23] time 0.183 (0.190) data 0.105 (0.112) loss_x loss_x 0.5234 (0.6642) acc_x 90.6250 (83.1250) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/23] time 0.180 (0.186) data 0.103 (0.108) loss_x loss_x 1.1533 (0.7386) acc_x 68.7500 (80.9375) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/23] time 0.170 (0.182) data 0.093 (0.104) loss_x loss_x 0.5439 (0.7368) acc_x 84.3750 (81.2500) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/23] time 0.184 (0.181) data 0.108 (0.104) loss_x loss_x 0.6689 (0.7382) acc_x 84.3750 (81.0938) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.4536, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 733
clean true:719
clean false:14
clean_rate:0.9809004092769441
noisy true:393
noisy false:490
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 883
epoch [174/200] batch [5/22] time 0.195 (0.185) data 0.117 (0.108) loss_x loss_x 0.8369 (0.4605) acc_x 84.3750 (90.6250) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/22] time 0.188 (0.185) data 0.111 (0.107) loss_x loss_x 0.5796 (0.5428) acc_x 84.3750 (87.8125) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/22] time 0.183 (0.187) data 0.105 (0.109) loss_x loss_x 0.6968 (0.5729) acc_x 84.3750 (87.0833) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/22] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.5889 (0.5466) acc_x 84.3750 (87.1875) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.4616, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 746
clean true:730
clean false:16
clean_rate:0.9785522788203753
noisy true:374
noisy false:496
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 870
epoch [175/200] batch [5/23] time 0.182 (0.189) data 0.105 (0.112) loss_x loss_x 0.7617 (0.5987) acc_x 84.3750 (84.3750) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/23] time 0.186 (0.189) data 0.109 (0.112) loss_x loss_x 0.6270 (0.6099) acc_x 84.3750 (84.0625) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/23] time 0.183 (0.187) data 0.105 (0.110) loss_x loss_x 0.7603 (0.6917) acc_x 84.3750 (82.9167) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/23] time 0.165 (0.185) data 0.087 (0.107) loss_x loss_x 0.5308 (0.6705) acc_x 87.5000 (83.7500) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 502
confident_label rate tensor(0.4728, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 764
clean true:744
clean false:20
clean_rate:0.9738219895287958
noisy true:370
noisy false:482
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 852
epoch [176/200] batch [5/23] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.4248 (0.4211) acc_x 84.3750 (87.5000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/23] time 0.171 (0.180) data 0.094 (0.103) loss_x loss_x 0.6855 (0.5048) acc_x 81.2500 (85.9375) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/23] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.8242 (0.5509) acc_x 78.1250 (85.2083) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/23] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.8389 (0.5439) acc_x 75.0000 (85.6250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.4616, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 746
clean true:722
clean false:24
clean_rate:0.967828418230563
noisy true:375
noisy false:495
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 870
epoch [177/200] batch [5/23] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.6235 (0.5276) acc_x 87.5000 (86.8750) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/23] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.5317 (0.5855) acc_x 87.5000 (84.3750) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/23] time 0.193 (0.189) data 0.115 (0.112) loss_x loss_x 0.4810 (0.5572) acc_x 84.3750 (85.0000) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/23] time 0.183 (0.188) data 0.106 (0.110) loss_x loss_x 1.3457 (0.6578) acc_x 71.8750 (83.5938) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:714
clean false:21
clean_rate:0.9714285714285714
noisy true:375
noisy false:506
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [178/200] batch [5/22] time 0.160 (0.167) data 0.083 (0.089) loss_x loss_x 0.6201 (0.6183) acc_x 87.5000 (86.2500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/22] time 0.162 (0.168) data 0.085 (0.090) loss_x loss_x 0.5405 (0.6056) acc_x 87.5000 (84.0625) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/22] time 0.160 (0.170) data 0.082 (0.093) loss_x loss_x 0.5591 (0.5968) acc_x 81.2500 (84.1667) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/22] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.3582 (0.5780) acc_x 90.6250 (85.3125) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4672, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 755
clean true:735
clean false:20
clean_rate:0.9735099337748344
noisy true:395
noisy false:466
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 861
epoch [179/200] batch [5/23] time 0.177 (0.181) data 0.099 (0.103) loss_x loss_x 0.3457 (0.5330) acc_x 90.6250 (85.6250) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/23] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 0.3672 (0.6224) acc_x 90.6250 (84.6875) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/23] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.7983 (0.6734) acc_x 81.2500 (83.1250) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/23] time 0.180 (0.178) data 0.103 (0.100) loss_x loss_x 1.2852 (0.6670) acc_x 71.8750 (83.9062) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.4598, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 743
clean true:726
clean false:17
clean_rate:0.9771197846567967
noisy true:374
noisy false:499
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 873
epoch [180/200] batch [5/23] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7666 (0.5743) acc_x 75.0000 (83.1250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/23] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.5801 (0.5206) acc_x 81.2500 (85.9375) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/23] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 1.1279 (0.5731) acc_x 75.0000 (85.0000) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/23] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.5225 (0.6018) acc_x 81.2500 (84.2188) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 503
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 760
clean true:740
clean false:20
clean_rate:0.9736842105263158
noisy true:373
noisy false:483
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 856
epoch [181/200] batch [5/23] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.7607 (0.6345) acc_x 78.1250 (82.5000) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/23] time 0.160 (0.172) data 0.083 (0.094) loss_x loss_x 0.5317 (0.6116) acc_x 84.3750 (83.1250) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/23] time 0.160 (0.169) data 0.082 (0.092) loss_x loss_x 0.4343 (0.6450) acc_x 90.6250 (82.7083) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/23] time 0.195 (0.169) data 0.118 (0.091) loss_x loss_x 0.2859 (0.6579) acc_x 96.8750 (83.5938) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.4585, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 741
clean true:722
clean false:19
clean_rate:0.9743589743589743
noisy true:382
noisy false:493
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 875
epoch [182/200] batch [5/23] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4106 (0.5760) acc_x 90.6250 (86.8750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/23] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 0.9683 (0.6031) acc_x 78.1250 (85.3125) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/23] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6162 (0.6674) acc_x 84.3750 (83.7500) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/23] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5640 (0.6513) acc_x 81.2500 (83.7500) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.4641, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 750
clean true:732
clean false:18
clean_rate:0.976
noisy true:373
noisy false:493
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 866
epoch [183/200] batch [5/23] time 0.182 (0.185) data 0.104 (0.108) loss_x loss_x 0.5000 (0.5647) acc_x 87.5000 (87.5000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/23] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.7798 (0.6105) acc_x 78.1250 (85.6250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/23] time 0.181 (0.185) data 0.103 (0.107) loss_x loss_x 0.2993 (0.5968) acc_x 90.6250 (85.6250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/23] time 0.183 (0.183) data 0.105 (0.105) loss_x loss_x 0.7856 (0.5884) acc_x 78.1250 (85.3125) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 508
confident_label rate tensor(0.4660, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 753
clean true:732
clean false:21
clean_rate:0.9721115537848606
noisy true:376
noisy false:487
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 863
epoch [184/200] batch [5/23] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 1.0186 (0.6567) acc_x 78.1250 (84.3750) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/23] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.4194 (0.6340) acc_x 84.3750 (84.0625) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/23] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.5991 (0.6500) acc_x 84.3750 (84.3750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/23] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.4529 (0.6088) acc_x 90.6250 (85.1562) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4660, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 753
clean true:731
clean false:22
clean_rate:0.9707835325365206
noisy true:379
noisy false:484
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 863
epoch [185/200] batch [5/23] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 1.0459 (0.6500) acc_x 71.8750 (85.0000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/23] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.5410 (0.5811) acc_x 81.2500 (86.2500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/23] time 0.183 (0.183) data 0.105 (0.106) loss_x loss_x 0.6685 (0.5672) acc_x 84.3750 (86.8750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/23] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.7368 (0.5822) acc_x 87.5000 (86.7188) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4616, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 746
clean true:731
clean false:15
clean_rate:0.9798927613941019
noisy true:379
noisy false:491
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 870
epoch [186/200] batch [5/23] time 0.166 (0.162) data 0.088 (0.085) loss_x loss_x 0.6938 (0.6847) acc_x 90.6250 (84.3750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/23] time 0.168 (0.163) data 0.090 (0.086) loss_x loss_x 0.6826 (0.6313) acc_x 78.1250 (85.0000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/23] time 0.161 (0.167) data 0.084 (0.089) loss_x loss_x 0.4985 (0.6280) acc_x 84.3750 (83.3333) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/23] time 0.161 (0.165) data 0.083 (0.087) loss_x loss_x 0.5732 (0.5709) acc_x 84.3750 (84.8438) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.4647, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 751
clean true:733
clean false:18
clean_rate:0.9760319573901465
noisy true:396
noisy false:469
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 865
epoch [187/200] batch [5/23] time 0.157 (0.159) data 0.079 (0.081) loss_x loss_x 0.7271 (0.7817) acc_x 78.1250 (76.2500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/23] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.5386 (0.7077) acc_x 84.3750 (81.2500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/23] time 0.160 (0.159) data 0.082 (0.082) loss_x loss_x 0.7441 (0.6846) acc_x 78.1250 (82.0833) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/23] time 0.159 (0.159) data 0.081 (0.082) loss_x loss_x 0.8208 (0.6933) acc_x 78.1250 (81.7188) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.4610, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 745
clean true:725
clean false:20
clean_rate:0.9731543624161074
noisy true:372
noisy false:499
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 871
epoch [188/200] batch [5/23] time 0.160 (0.159) data 0.082 (0.082) loss_x loss_x 0.7144 (0.7206) acc_x 84.3750 (86.2500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/23] time 0.159 (0.159) data 0.081 (0.082) loss_x loss_x 0.6777 (0.6839) acc_x 81.2500 (84.6875) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/23] time 0.165 (0.162) data 0.088 (0.084) loss_x loss_x 0.3728 (0.6453) acc_x 87.5000 (85.4167) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/23] time 0.160 (0.162) data 0.083 (0.084) loss_x loss_x 0.7905 (0.6615) acc_x 84.3750 (85.3125) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.4511, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 729
clean true:711
clean false:18
clean_rate:0.9753086419753086
noisy true:381
noisy false:506
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 887
epoch [189/200] batch [5/22] time 0.158 (0.158) data 0.080 (0.080) loss_x loss_x 0.6650 (0.7843) acc_x 81.2500 (78.7500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/22] time 0.159 (0.158) data 0.080 (0.080) loss_x loss_x 1.4482 (0.7635) acc_x 75.0000 (80.6250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/22] time 0.158 (0.158) data 0.080 (0.081) loss_x loss_x 0.7017 (0.7245) acc_x 81.2500 (81.2500) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/22] time 0.160 (0.159) data 0.083 (0.081) loss_x loss_x 0.2959 (0.6720) acc_x 100.0000 (83.2812) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.4653, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 752
clean true:737
clean false:15
clean_rate:0.9800531914893617
noisy true:403
noisy false:461
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 864
epoch [190/200] batch [5/23] time 0.183 (0.163) data 0.106 (0.086) loss_x loss_x 0.6401 (0.6052) acc_x 81.2500 (84.3750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/23] time 0.160 (0.166) data 0.083 (0.089) loss_x loss_x 0.6226 (0.5878) acc_x 87.5000 (85.0000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/23] time 0.159 (0.164) data 0.082 (0.087) loss_x loss_x 0.6274 (0.6019) acc_x 71.8750 (83.3333) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/23] time 0.162 (0.163) data 0.084 (0.086) loss_x loss_x 0.2207 (0.5672) acc_x 96.8750 (85.1562) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 508
confident_label rate tensor(0.4715, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 762
clean true:744
clean false:18
clean_rate:0.9763779527559056
noisy true:364
noisy false:490
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 854
epoch [191/200] batch [5/23] time 0.162 (0.160) data 0.084 (0.083) loss_x loss_x 0.5957 (0.6995) acc_x 84.3750 (81.8750) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/23] time 0.162 (0.160) data 0.084 (0.083) loss_x loss_x 0.6826 (0.6917) acc_x 81.2500 (82.8125) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/23] time 0.159 (0.160) data 0.082 (0.082) loss_x loss_x 0.5415 (0.6415) acc_x 84.3750 (84.1667) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/23] time 0.161 (0.160) data 0.083 (0.082) loss_x loss_x 0.7920 (0.6276) acc_x 71.8750 (83.2812) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.4592, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 742
clean true:721
clean false:21
clean_rate:0.9716981132075472
noisy true:385
noisy false:489
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 874
epoch [192/200] batch [5/23] time 0.161 (0.160) data 0.083 (0.082) loss_x loss_x 0.7148 (0.4598) acc_x 84.3750 (88.7500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/23] time 0.159 (0.160) data 0.081 (0.082) loss_x loss_x 0.3853 (0.5502) acc_x 87.5000 (86.8750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/23] time 0.163 (0.160) data 0.086 (0.082) loss_x loss_x 0.4395 (0.5631) acc_x 87.5000 (86.2500) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/23] time 0.159 (0.160) data 0.082 (0.082) loss_x loss_x 0.5000 (0.5776) acc_x 87.5000 (85.3125) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.4653, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 752
clean true:737
clean false:15
clean_rate:0.9800531914893617
noisy true:379
noisy false:485
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 864
epoch [193/200] batch [5/23] time 0.160 (0.160) data 0.082 (0.082) loss_x loss_x 0.4043 (0.4624) acc_x 87.5000 (89.3750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/23] time 0.160 (0.160) data 0.083 (0.082) loss_x loss_x 0.6152 (0.5071) acc_x 84.3750 (86.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/23] time 0.160 (0.160) data 0.083 (0.082) loss_x loss_x 0.5249 (0.5329) acc_x 81.2500 (86.2500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/23] time 0.167 (0.160) data 0.089 (0.082) loss_x loss_x 0.5234 (0.5247) acc_x 84.3750 (86.2500) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.4623, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 747
clean true:728
clean false:19
clean_rate:0.9745649263721553
noisy true:360
noisy false:509
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 869
epoch [194/200] batch [5/23] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.3613 (0.4766) acc_x 90.6250 (85.6250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/23] time 0.159 (0.160) data 0.082 (0.082) loss_x loss_x 0.3130 (0.5216) acc_x 96.8750 (86.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/23] time 0.160 (0.160) data 0.082 (0.082) loss_x loss_x 0.7354 (0.5777) acc_x 84.3750 (85.8333) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/23] time 0.159 (0.160) data 0.081 (0.082) loss_x loss_x 0.8257 (0.5789) acc_x 78.1250 (85.1562) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.4598, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 743
clean true:725
clean false:18
clean_rate:0.9757738896366084
noisy true:367
noisy false:506
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 873
epoch [195/200] batch [5/23] time 0.167 (0.163) data 0.089 (0.086) loss_x loss_x 0.3394 (0.5970) acc_x 87.5000 (85.6250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/23] time 0.161 (0.162) data 0.083 (0.084) loss_x loss_x 0.3997 (0.5675) acc_x 84.3750 (84.0625) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/23] time 0.160 (0.161) data 0.083 (0.083) loss_x loss_x 0.5488 (0.6216) acc_x 81.2500 (84.1667) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/23] time 0.158 (0.160) data 0.081 (0.083) loss_x loss_x 0.7305 (0.6298) acc_x 84.3750 (84.0625) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.4666, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 754
clean true:735
clean false:19
clean_rate:0.9748010610079576
noisy true:380
noisy false:482
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 862
epoch [196/200] batch [5/23] time 0.159 (0.159) data 0.082 (0.081) loss_x loss_x 0.8892 (0.6899) acc_x 78.1250 (82.5000) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/23] time 0.159 (0.159) data 0.081 (0.082) loss_x loss_x 0.8535 (0.6435) acc_x 78.1250 (84.0625) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/23] time 0.159 (0.159) data 0.081 (0.082) loss_x loss_x 0.5977 (0.6168) acc_x 87.5000 (83.9583) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/23] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.3970 (0.5747) acc_x 93.7500 (85.4688) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.4709, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 761
clean true:737
clean false:24
clean_rate:0.9684625492772667
noisy true:369
noisy false:486
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 855
epoch [197/200] batch [5/23] time 0.156 (0.157) data 0.079 (0.079) loss_x loss_x 0.9292 (0.5687) acc_x 81.2500 (87.5000) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/23] time 0.158 (0.157) data 0.080 (0.079) loss_x loss_x 0.6768 (0.6215) acc_x 84.3750 (84.6875) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/23] time 0.156 (0.157) data 0.079 (0.079) loss_x loss_x 0.6172 (0.6097) acc_x 87.5000 (85.6250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/23] time 0.157 (0.157) data 0.079 (0.079) loss_x loss_x 0.5581 (0.6105) acc_x 84.3750 (85.3125) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4592, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 742
clean true:727
clean false:15
clean_rate:0.9797843665768194
noisy true:395
noisy false:479
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 874
epoch [198/200] batch [5/23] time 0.160 (0.159) data 0.083 (0.081) loss_x loss_x 0.7490 (0.6588) acc_x 81.2500 (83.7500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/23] time 0.159 (0.159) data 0.081 (0.082) loss_x loss_x 0.7432 (0.6139) acc_x 84.3750 (85.0000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/23] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 1.0547 (0.6464) acc_x 65.6250 (83.9583) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/23] time 0.157 (0.159) data 0.080 (0.081) loss_x loss_x 0.6616 (0.6325) acc_x 84.3750 (84.5312) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 492
confident_label rate tensor(0.4623, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 747
clean true:730
clean false:17
clean_rate:0.9772423025435074
noisy true:394
noisy false:475
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 869
epoch [199/200] batch [5/23] time 0.161 (0.159) data 0.083 (0.082) loss_x loss_x 0.4775 (0.4285) acc_x 90.6250 (91.2500) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/23] time 0.157 (0.158) data 0.079 (0.081) loss_x loss_x 0.6226 (0.4860) acc_x 84.3750 (87.8125) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/23] time 0.159 (0.159) data 0.082 (0.081) loss_x loss_x 0.6362 (0.5085) acc_x 87.5000 (87.9167) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/23] time 0.159 (0.159) data 0.082 (0.081) loss_x loss_x 0.3728 (0.5369) acc_x 87.5000 (87.5000) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.4610, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 745
clean true:722
clean false:23
clean_rate:0.9691275167785235
noisy true:367
noisy false:504
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 871
epoch [200/200] batch [5/23] time 0.160 (0.160) data 0.082 (0.082) loss_x loss_x 0.9839 (0.5982) acc_x 81.2500 (87.5000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/23] time 0.158 (0.159) data 0.081 (0.081) loss_x loss_x 0.5107 (0.5737) acc_x 84.3750 (86.5625) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/23] time 0.157 (0.159) data 0.080 (0.081) loss_x loss_x 0.5718 (0.5730) acc_x 81.2500 (85.0000) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/23] time 0.158 (0.159) data 0.081 (0.081) loss_x loss_x 0.4094 (0.5786) acc_x 93.7500 (85.6250) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,738
* accuracy: 72.4%
* error: 27.6%
* macro_f1: 69.6%
Elapsed: 0:41:13
