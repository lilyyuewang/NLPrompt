***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.1665, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 269
clean true:249
clean false:20
clean_rate:0.9256505576208178
noisy true:263
noisy false:1084
after delete: len(clean_dataset) 269
after delete: len(noisy_dataset) 1347
epoch [1/200] batch [5/8] time 0.194 (0.222) data 0.117 (0.124) loss_x loss_x 2.3613 (2.5836) acc_x 59.3750 (46.2500) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1051
confident_label rate tensor(0.1813, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 293
clean true:274
clean false:19
clean_rate:0.9351535836177475
noisy true:291
noisy false:1032
after delete: len(clean_dataset) 293
after delete: len(noisy_dataset) 1323
epoch [2/200] batch [5/9] time 0.198 (0.178) data 0.120 (0.101) loss_x loss_x 1.4326 (1.6842) acc_x 65.6250 (62.5000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 836
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 405
clean true:391
clean false:14
clean_rate:0.9654320987654321
noisy true:389
noisy false:822
after delete: len(clean_dataset) 405
after delete: len(noisy_dataset) 1211
epoch [3/200] batch [5/12] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 1.4531 (1.2225) acc_x 53.1250 (66.2500) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/12] time 0.161 (0.174) data 0.085 (0.097) loss_x loss_x 1.3887 (1.2688) acc_x 68.7500 (66.5625) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 834
confident_label rate tensor(0.2488, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 402
clean true:385
clean false:17
clean_rate:0.9577114427860697
noisy true:397
noisy false:817
after delete: len(clean_dataset) 402
after delete: len(noisy_dataset) 1214
epoch [4/200] batch [5/12] time 0.183 (0.191) data 0.106 (0.114) loss_x loss_x 1.4463 (1.1253) acc_x 65.6250 (70.6250) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/12] time 0.165 (0.183) data 0.088 (0.106) loss_x loss_x 1.2910 (1.1104) acc_x 71.8750 (72.1875) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 829
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 404
clean true:388
clean false:16
clean_rate:0.9603960396039604
noisy true:399
noisy false:813
after delete: len(clean_dataset) 404
after delete: len(noisy_dataset) 1212
epoch [5/200] batch [5/12] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 1.3994 (1.1659) acc_x 65.6250 (70.6250) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/12] time 0.169 (0.183) data 0.092 (0.106) loss_x loss_x 1.3643 (1.1778) acc_x 75.0000 (71.5625) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 787
confident_label rate tensor(0.2698, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 436
clean true:419
clean false:17
clean_rate:0.9610091743119266
noisy true:410
noisy false:770
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1180
epoch [6/200] batch [5/13] time 0.162 (0.172) data 0.085 (0.094) loss_x loss_x 1.4434 (1.2943) acc_x 68.7500 (66.8750) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/13] time 0.162 (0.176) data 0.085 (0.099) loss_x loss_x 1.1572 (1.1337) acc_x 71.8750 (72.5000) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 781
confident_label rate tensor(0.2692, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 435
clean true:420
clean false:15
clean_rate:0.9655172413793104
noisy true:415
noisy false:766
after delete: len(clean_dataset) 435
after delete: len(noisy_dataset) 1181
epoch [7/200] batch [5/13] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.7959 (0.9415) acc_x 81.2500 (76.2500) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/13] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 1.1406 (0.9916) acc_x 68.7500 (75.3125) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 795
confident_label rate tensor(0.2717, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 439
clean true:423
clean false:16
clean_rate:0.9635535307517085
noisy true:398
noisy false:779
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1177
epoch [8/200] batch [5/13] time 0.184 (0.176) data 0.106 (0.100) loss_x loss_x 1.0791 (1.1564) acc_x 71.8750 (71.8750) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/13] time 0.178 (0.179) data 0.100 (0.102) loss_x loss_x 0.9712 (1.0554) acc_x 68.7500 (73.4375) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 790
confident_label rate tensor(0.2667, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 431
clean true:415
clean false:16
clean_rate:0.962877030162413
noisy true:411
noisy false:774
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1185
epoch [9/200] batch [5/13] time 0.186 (0.186) data 0.109 (0.110) loss_x loss_x 0.7666 (0.9204) acc_x 81.2500 (77.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [10/13] time 0.192 (0.187) data 0.115 (0.110) loss_x loss_x 1.4580 (1.0854) acc_x 68.7500 (73.1250) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 766
confident_label rate tensor(0.2772, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 448
clean true:436
clean false:12
clean_rate:0.9732142857142857
noisy true:414
noisy false:754
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1168
epoch [10/200] batch [5/14] time 0.203 (0.188) data 0.126 (0.112) loss_x loss_x 0.9321 (1.0648) acc_x 71.8750 (68.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/14] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 1.1445 (1.1315) acc_x 75.0000 (70.6250) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 751
confident_label rate tensor(0.2847, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 460
clean true:443
clean false:17
clean_rate:0.9630434782608696
noisy true:422
noisy false:734
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1156
epoch [11/200] batch [5/14] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 1.1436 (0.8540) acc_x 75.0000 (78.1250) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/14] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 1.4580 (0.9484) acc_x 68.7500 (77.8125) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 756
confident_label rate tensor(0.2834, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 458
clean true:440
clean false:18
clean_rate:0.9606986899563319
noisy true:420
noisy false:738
after delete: len(clean_dataset) 458
after delete: len(noisy_dataset) 1158
epoch [12/200] batch [5/14] time 0.209 (0.181) data 0.132 (0.103) loss_x loss_x 1.6562 (1.3211) acc_x 43.7500 (65.6250) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [10/14] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 1.2129 (1.1430) acc_x 78.1250 (71.5625) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 753
confident_label rate tensor(0.2791, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 451
clean true:438
clean false:13
clean_rate:0.9711751662971175
noisy true:425
noisy false:740
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1165
epoch [13/200] batch [5/14] time 0.172 (0.178) data 0.095 (0.102) loss_x loss_x 0.8184 (1.0017) acc_x 75.0000 (75.0000) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [10/14] time 0.216 (0.179) data 0.138 (0.102) loss_x loss_x 1.2490 (1.0548) acc_x 71.8750 (74.3750) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 745
confident_label rate tensor(0.2785, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 450
clean true:436
clean false:14
clean_rate:0.9688888888888889
noisy true:435
noisy false:731
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1166
epoch [14/200] batch [5/14] time 0.216 (0.191) data 0.139 (0.114) loss_x loss_x 1.0898 (1.0240) acc_x 65.6250 (73.1250) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/14] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.8975 (0.9691) acc_x 71.8750 (75.3125) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 772
confident_label rate tensor(0.2772, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 448
clean true:432
clean false:16
clean_rate:0.9642857142857143
noisy true:412
noisy false:756
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1168
epoch [15/200] batch [5/14] time 0.163 (0.174) data 0.086 (0.097) loss_x loss_x 0.7520 (0.9894) acc_x 84.3750 (79.3750) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [10/14] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.8843 (0.9871) acc_x 71.8750 (76.8750) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 748
confident_label rate tensor(0.2896, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 468
clean true:445
clean false:23
clean_rate:0.9508547008547008
noisy true:423
noisy false:725
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1148
epoch [16/200] batch [5/14] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.8408 (0.9842) acc_x 75.0000 (73.1250) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [10/14] time 0.177 (0.166) data 0.100 (0.088) loss_x loss_x 0.7642 (1.0281) acc_x 75.0000 (72.8125) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 738
confident_label rate tensor(0.2908, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 470
clean true:451
clean false:19
clean_rate:0.9595744680851064
noisy true:427
noisy false:719
after delete: len(clean_dataset) 470
after delete: len(noisy_dataset) 1146
epoch [17/200] batch [5/14] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.5156 (0.9168) acc_x 87.5000 (76.8750) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [10/14] time 0.162 (0.176) data 0.085 (0.099) loss_x loss_x 0.5791 (0.9248) acc_x 84.3750 (75.0000) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 741
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:460
clean false:20
clean_rate:0.9583333333333334
noisy true:415
noisy false:721
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [18/200] batch [5/15] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 0.8057 (0.9895) acc_x 81.2500 (76.2500) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/15] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 1.1514 (0.9800) acc_x 65.6250 (74.0625) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [15/15] time 0.175 (0.182) data 0.097 (0.105) loss_x loss_x 1.1357 (1.0021) acc_x 68.7500 (73.9583) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 745
confident_label rate tensor(0.2933, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 474
clean true:451
clean false:23
clean_rate:0.9514767932489452
noisy true:420
noisy false:722
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1142
epoch [19/200] batch [5/14] time 0.162 (0.182) data 0.086 (0.106) loss_x loss_x 0.7803 (0.7993) acc_x 78.1250 (80.0000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/14] time 0.193 (0.183) data 0.116 (0.106) loss_x loss_x 1.0361 (0.8842) acc_x 75.0000 (79.0625) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 719
confident_label rate tensor(0.2995, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 484
clean true:462
clean false:22
clean_rate:0.9545454545454546
noisy true:435
noisy false:697
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1132
epoch [20/200] batch [5/15] time 0.167 (0.163) data 0.090 (0.086) loss_x loss_x 0.7646 (0.9834) acc_x 75.0000 (71.2500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/15] time 0.196 (0.172) data 0.119 (0.095) loss_x loss_x 0.8335 (0.9651) acc_x 75.0000 (72.5000) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [15/15] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.8921 (0.9764) acc_x 78.1250 (72.2917) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 724
confident_label rate tensor(0.3014, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 487
clean true:469
clean false:18
clean_rate:0.9630390143737166
noisy true:423
noisy false:706
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1129
epoch [21/200] batch [5/15] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.3220 (0.7417) acc_x 93.7500 (84.3750) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/15] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.4736 (0.7979) acc_x 87.5000 (81.8750) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [15/15] time 0.161 (0.169) data 0.083 (0.092) loss_x loss_x 1.1465 (0.8745) acc_x 68.7500 (80.2083) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 729
confident_label rate tensor(0.2921, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 472
clean true:452
clean false:20
clean_rate:0.9576271186440678
noisy true:435
noisy false:709
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 1144
epoch [22/200] batch [5/14] time 0.189 (0.186) data 0.112 (0.109) loss_x loss_x 0.4446 (0.8741) acc_x 84.3750 (77.5000) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/14] time 0.187 (0.180) data 0.111 (0.103) loss_x loss_x 0.9033 (0.9010) acc_x 81.2500 (78.1250) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 743
confident_label rate tensor(0.2983, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 482
clean true:463
clean false:19
clean_rate:0.9605809128630706
noisy true:410
noisy false:724
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1134
epoch [23/200] batch [5/15] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.7046 (0.9535) acc_x 84.3750 (76.2500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/15] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.7930 (1.0205) acc_x 84.3750 (73.7500) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [15/15] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 1.1963 (1.0386) acc_x 78.1250 (73.9583) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 720
confident_label rate tensor(0.2933, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 474
clean true:456
clean false:18
clean_rate:0.9620253164556962
noisy true:440
noisy false:702
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1142
epoch [24/200] batch [5/14] time 0.194 (0.166) data 0.115 (0.088) loss_x loss_x 0.8535 (0.9718) acc_x 78.1250 (75.0000) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/14] time 0.167 (0.171) data 0.090 (0.094) loss_x loss_x 1.2607 (0.9196) acc_x 68.7500 (76.2500) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 699
confident_label rate tensor(0.3020, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 488
clean true:466
clean false:22
clean_rate:0.9549180327868853
noisy true:451
noisy false:677
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1128
epoch [25/200] batch [5/15] time 0.197 (0.186) data 0.121 (0.110) loss_x loss_x 0.6348 (0.7637) acc_x 75.0000 (78.7500) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [10/15] time 0.178 (0.188) data 0.101 (0.112) loss_x loss_x 0.8384 (0.8479) acc_x 75.0000 (76.2500) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [15/15] time 0.162 (0.181) data 0.084 (0.104) loss_x loss_x 0.9390 (0.9156) acc_x 68.7500 (74.5833) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 709
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 495
clean true:475
clean false:20
clean_rate:0.9595959595959596
noisy true:432
noisy false:689
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1121
epoch [26/200] batch [5/15] time 0.164 (0.170) data 0.087 (0.093) loss_x loss_x 1.3467 (1.0523) acc_x 65.6250 (76.8750) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/15] time 0.168 (0.171) data 0.091 (0.094) loss_x loss_x 0.6255 (1.0162) acc_x 81.2500 (76.2500) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [15/15] time 0.173 (0.172) data 0.096 (0.095) loss_x loss_x 0.7808 (1.0085) acc_x 81.2500 (75.8333) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 698
confident_label rate tensor(0.3069, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 496
clean true:475
clean false:21
clean_rate:0.9576612903225806
noisy true:443
noisy false:677
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1120
epoch [27/200] batch [5/15] time 0.168 (0.177) data 0.090 (0.100) loss_x loss_x 1.0830 (1.0202) acc_x 68.7500 (71.2500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/15] time 0.174 (0.180) data 0.097 (0.102) loss_x loss_x 0.9858 (0.9440) acc_x 81.2500 (75.6250) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [15/15] time 0.194 (0.180) data 0.116 (0.103) loss_x loss_x 0.9414 (0.9567) acc_x 68.7500 (75.0000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 681
confident_label rate tensor(0.3187, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 515
clean true:491
clean false:24
clean_rate:0.9533980582524272
noisy true:444
noisy false:657
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1101
epoch [28/200] batch [5/16] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.8130 (0.9649) acc_x 78.1250 (73.1250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/16] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.3569 (0.9292) acc_x 93.7500 (74.3750) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/16] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.7690 (0.9668) acc_x 81.2500 (74.1667) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:474
clean false:20
clean_rate:0.9595141700404858
noisy true:449
noisy false:673
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [29/200] batch [5/15] time 0.194 (0.180) data 0.117 (0.102) loss_x loss_x 0.6309 (0.7740) acc_x 87.5000 (81.2500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/15] time 0.188 (0.183) data 0.111 (0.106) loss_x loss_x 0.6631 (0.7575) acc_x 87.5000 (83.7500) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [15/15] time 0.159 (0.178) data 0.083 (0.101) loss_x loss_x 1.0283 (0.8417) acc_x 68.7500 (81.0417) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 699
confident_label rate tensor(0.3224, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 521
clean true:501
clean false:20
clean_rate:0.9616122840690979
noisy true:416
noisy false:679
after delete: len(clean_dataset) 521
after delete: len(noisy_dataset) 1095
epoch [30/200] batch [5/16] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.4609 (0.6848) acc_x 84.3750 (80.0000) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/16] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 1.2256 (0.7827) acc_x 65.6250 (78.1250) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/16] time 0.173 (0.184) data 0.095 (0.107) loss_x loss_x 0.6909 (0.8278) acc_x 84.3750 (77.9167) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 688
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 506
clean true:486
clean false:20
clean_rate:0.9604743083003953
noisy true:442
noisy false:668
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1110
epoch [31/200] batch [5/15] time 0.166 (0.165) data 0.089 (0.088) loss_x loss_x 1.1172 (0.8946) acc_x 75.0000 (78.7500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/15] time 0.200 (0.182) data 0.124 (0.105) loss_x loss_x 0.7744 (0.8433) acc_x 81.2500 (80.6250) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [15/15] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.7090 (0.8141) acc_x 90.6250 (82.0833) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 679
confident_label rate tensor(0.3168, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 512
clean true:491
clean false:21
clean_rate:0.958984375
noisy true:446
noisy false:658
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1104
epoch [32/200] batch [5/16] time 0.184 (0.196) data 0.107 (0.119) loss_x loss_x 0.6343 (0.7641) acc_x 75.0000 (78.7500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/16] time 0.182 (0.190) data 0.105 (0.113) loss_x loss_x 1.3789 (0.9329) acc_x 65.6250 (75.6250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/16] time 0.184 (0.189) data 0.108 (0.112) loss_x loss_x 0.8506 (0.8640) acc_x 78.1250 (77.7083) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 689
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 503
clean true:481
clean false:22
clean_rate:0.9562624254473161
noisy true:446
noisy false:667
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1113
epoch [33/200] batch [5/15] time 0.158 (0.160) data 0.082 (0.083) loss_x loss_x 1.0361 (0.9378) acc_x 71.8750 (73.7500) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [10/15] time 0.184 (0.174) data 0.106 (0.097) loss_x loss_x 0.4790 (1.0012) acc_x 84.3750 (73.7500) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [15/15] time 0.185 (0.177) data 0.109 (0.100) loss_x loss_x 0.6270 (0.9585) acc_x 84.3750 (75.2083) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 683
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:480
clean false:28
clean_rate:0.9448818897637795
noisy true:453
noisy false:655
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [34/200] batch [5/15] time 0.163 (0.180) data 0.086 (0.103) loss_x loss_x 0.5176 (0.9393) acc_x 84.3750 (73.7500) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/15] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 0.9097 (0.9263) acc_x 84.3750 (75.0000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [15/15] time 0.161 (0.167) data 0.084 (0.090) loss_x loss_x 0.8135 (0.8775) acc_x 75.0000 (77.2917) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 709
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 504
clean true:480
clean false:24
clean_rate:0.9523809523809523
noisy true:427
noisy false:685
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1112
epoch [35/200] batch [5/15] time 0.178 (0.173) data 0.101 (0.096) loss_x loss_x 0.6880 (0.7134) acc_x 81.2500 (80.6250) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/15] time 0.161 (0.171) data 0.084 (0.094) loss_x loss_x 0.9585 (0.9204) acc_x 68.7500 (74.0625) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [15/15] time 0.183 (0.174) data 0.105 (0.097) loss_x loss_x 0.9014 (0.9520) acc_x 78.1250 (73.9583) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 643
confident_label rate tensor(0.3193, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 516
clean true:498
clean false:18
clean_rate:0.9651162790697675
noisy true:475
noisy false:625
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1100
epoch [36/200] batch [5/16] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.4551 (0.8178) acc_x 84.3750 (80.6250) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/16] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 1.3428 (0.8830) acc_x 71.8750 (79.3750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/16] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 1.0420 (0.9065) acc_x 75.0000 (78.1250) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.3267, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 528
clean true:502
clean false:26
clean_rate:0.9507575757575758
noisy true:443
noisy false:645
after delete: len(clean_dataset) 528
after delete: len(noisy_dataset) 1088
epoch [37/200] batch [5/16] time 0.188 (0.189) data 0.110 (0.111) loss_x loss_x 0.8984 (0.8988) acc_x 78.1250 (73.7500) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/16] time 0.167 (0.189) data 0.089 (0.112) loss_x loss_x 0.4512 (0.8580) acc_x 87.5000 (77.5000) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/16] time 0.185 (0.189) data 0.108 (0.112) loss_x loss_x 0.7637 (0.8941) acc_x 87.5000 (77.5000) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 504
clean true:484
clean false:20
clean_rate:0.9603174603174603
noisy true:448
noisy false:664
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1112
epoch [38/200] batch [5/15] time 0.176 (0.168) data 0.099 (0.090) loss_x loss_x 1.0010 (0.9109) acc_x 75.0000 (71.8750) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [10/15] time 0.170 (0.173) data 0.093 (0.095) loss_x loss_x 0.3955 (0.8169) acc_x 87.5000 (76.2500) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [15/15] time 0.174 (0.171) data 0.097 (0.093) loss_x loss_x 0.5430 (0.7704) acc_x 81.2500 (79.1667) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 663
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:509
clean false:22
clean_rate:0.9585687382297552
noisy true:444
noisy false:641
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [39/200] batch [5/16] time 0.221 (0.181) data 0.144 (0.104) loss_x loss_x 1.1709 (0.7987) acc_x 62.5000 (75.6250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/16] time 0.200 (0.183) data 0.123 (0.106) loss_x loss_x 0.6235 (0.7605) acc_x 87.5000 (79.3750) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/16] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.5967 (0.7164) acc_x 81.2500 (80.8333) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 654
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 517
clean true:499
clean false:18
clean_rate:0.965183752417795
noisy true:463
noisy false:636
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1099
epoch [40/200] batch [5/16] time 0.183 (0.190) data 0.107 (0.113) loss_x loss_x 1.0352 (0.8194) acc_x 75.0000 (80.6250) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/16] time 0.162 (0.183) data 0.085 (0.106) loss_x loss_x 0.5034 (0.8338) acc_x 87.5000 (79.0625) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/16] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 1.5039 (0.8358) acc_x 59.3750 (79.5833) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:487
clean false:27
clean_rate:0.9474708171206225
noisy true:461
noisy false:641
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [41/200] batch [5/16] time 0.168 (0.190) data 0.091 (0.113) loss_x loss_x 0.7363 (0.9105) acc_x 78.1250 (74.3750) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/16] time 0.161 (0.180) data 0.084 (0.103) loss_x loss_x 1.3008 (0.9820) acc_x 62.5000 (73.1250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/16] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.8008 (0.9039) acc_x 75.0000 (74.7917) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:493
clean false:21
clean_rate:0.9591439688715954
noisy true:445
noisy false:657
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [42/200] batch [5/16] time 0.159 (0.160) data 0.083 (0.083) loss_x loss_x 0.5347 (0.6103) acc_x 84.3750 (80.6250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/16] time 0.162 (0.159) data 0.085 (0.083) loss_x loss_x 0.8271 (0.6688) acc_x 81.2500 (81.2500) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [15/16] time 0.158 (0.160) data 0.081 (0.083) loss_x loss_x 0.8032 (0.7258) acc_x 78.1250 (81.0417) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 704
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:481
clean false:27
clean_rate:0.9468503937007874
noisy true:431
noisy false:677
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [43/200] batch [5/15] time 0.175 (0.179) data 0.098 (0.102) loss_x loss_x 0.5996 (0.8858) acc_x 81.2500 (75.0000) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/15] time 0.197 (0.179) data 0.119 (0.102) loss_x loss_x 0.4944 (0.8357) acc_x 87.5000 (78.1250) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [15/15] time 0.182 (0.178) data 0.105 (0.101) loss_x loss_x 0.4399 (0.8549) acc_x 90.6250 (78.1250) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 525
clean true:502
clean false:23
clean_rate:0.9561904761904761
noisy true:462
noisy false:629
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1091
epoch [44/200] batch [5/16] time 0.162 (0.175) data 0.085 (0.098) loss_x loss_x 0.8994 (0.6979) acc_x 84.3750 (83.1250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/16] time 0.171 (0.176) data 0.095 (0.099) loss_x loss_x 1.1924 (0.7799) acc_x 68.7500 (79.6875) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/16] time 0.165 (0.175) data 0.088 (0.098) loss_x loss_x 1.0908 (0.7874) acc_x 71.8750 (80.2083) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 518
clean true:500
clean false:18
clean_rate:0.9652509652509652
noisy true:457
noisy false:641
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1098
epoch [45/200] batch [5/16] time 0.209 (0.177) data 0.132 (0.100) loss_x loss_x 0.8066 (0.7482) acc_x 78.1250 (80.6250) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/16] time 0.171 (0.176) data 0.095 (0.099) loss_x loss_x 0.5493 (0.8047) acc_x 87.5000 (80.0000) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/16] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.7744 (0.8387) acc_x 81.2500 (78.3333) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 535
clean true:515
clean false:20
clean_rate:0.9626168224299065
noisy true:455
noisy false:626
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1081
epoch [46/200] batch [5/16] time 0.163 (0.170) data 0.085 (0.092) loss_x loss_x 0.6411 (0.9412) acc_x 81.2500 (74.3750) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/16] time 0.192 (0.181) data 0.114 (0.103) loss_x loss_x 0.2959 (0.9027) acc_x 93.7500 (76.5625) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/16] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 1.0762 (0.9483) acc_x 68.7500 (74.7917) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:498
clean false:24
clean_rate:0.9540229885057471
noisy true:472
noisy false:622
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [47/200] batch [5/16] time 0.159 (0.160) data 0.082 (0.082) loss_x loss_x 0.7988 (0.7648) acc_x 84.3750 (82.5000) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/16] time 0.159 (0.160) data 0.081 (0.082) loss_x loss_x 0.9873 (0.8100) acc_x 65.6250 (77.5000) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [15/16] time 0.167 (0.160) data 0.090 (0.083) loss_x loss_x 0.4312 (0.8215) acc_x 90.6250 (78.1250) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 654
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:500
clean false:22
clean_rate:0.9578544061302682
noisy true:462
noisy false:632
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [48/200] batch [5/16] time 0.181 (0.183) data 0.104 (0.105) loss_x loss_x 0.3193 (0.7629) acc_x 87.5000 (79.3750) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/16] time 0.213 (0.182) data 0.136 (0.104) loss_x loss_x 0.8354 (0.8876) acc_x 78.1250 (77.8125) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/16] time 0.169 (0.181) data 0.093 (0.104) loss_x loss_x 0.7256 (0.8171) acc_x 84.3750 (80.0000) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 524
clean true:500
clean false:24
clean_rate:0.9541984732824428
noisy true:477
noisy false:615
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1092
epoch [49/200] batch [5/16] time 0.175 (0.184) data 0.098 (0.108) loss_x loss_x 0.6060 (0.7267) acc_x 87.5000 (81.2500) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/16] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.8862 (0.7621) acc_x 81.2500 (80.3125) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/16] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6689 (0.7721) acc_x 78.1250 (79.7917) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 667
confident_label rate tensor(0.3261, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 527
clean true:504
clean false:23
clean_rate:0.9563567362428842
noisy true:445
noisy false:644
after delete: len(clean_dataset) 527
after delete: len(noisy_dataset) 1089
epoch [50/200] batch [5/16] time 0.203 (0.189) data 0.126 (0.111) loss_x loss_x 0.9097 (0.6570) acc_x 81.2500 (83.7500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/16] time 0.167 (0.181) data 0.090 (0.104) loss_x loss_x 0.6133 (0.6300) acc_x 78.1250 (83.7500) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/16] time 0.235 (0.187) data 0.157 (0.110) loss_x loss_x 0.6709 (0.6627) acc_x 90.6250 (83.5417) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.3175, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 513
clean true:487
clean false:26
clean_rate:0.949317738791423
noisy true:444
noisy false:659
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1103
epoch [51/200] batch [5/16] time 0.159 (0.160) data 0.083 (0.083) loss_x loss_x 0.5366 (0.7850) acc_x 90.6250 (83.1250) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/16] time 0.160 (0.160) data 0.082 (0.083) loss_x loss_x 1.0225 (0.8391) acc_x 75.0000 (79.6875) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [15/16] time 0.202 (0.162) data 0.125 (0.085) loss_x loss_x 0.7031 (0.7858) acc_x 81.2500 (80.6250) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:501
clean false:21
clean_rate:0.9597701149425287
noisy true:470
noisy false:624
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [52/200] batch [5/16] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 1.0576 (0.7890) acc_x 71.8750 (80.6250) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/16] time 0.179 (0.183) data 0.101 (0.106) loss_x loss_x 0.7520 (0.7455) acc_x 81.2500 (82.1875) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/16] time 0.182 (0.183) data 0.105 (0.105) loss_x loss_x 1.2178 (0.7576) acc_x 75.0000 (81.6667) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 648
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 537
clean true:514
clean false:23
clean_rate:0.957169459962756
noisy true:454
noisy false:625
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1079
epoch [53/200] batch [5/16] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 0.7910 (0.7646) acc_x 81.2500 (78.1250) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/16] time 0.164 (0.172) data 0.086 (0.095) loss_x loss_x 0.8545 (0.7743) acc_x 81.2500 (78.7500) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/16] time 0.184 (0.174) data 0.107 (0.097) loss_x loss_x 1.3848 (0.7886) acc_x 75.0000 (79.5833) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.3342, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 540
clean true:515
clean false:25
clean_rate:0.9537037037037037
noisy true:455
noisy false:621
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 1076
epoch [54/200] batch [5/16] time 0.163 (0.170) data 0.087 (0.093) loss_x loss_x 0.5571 (0.9168) acc_x 81.2500 (76.8750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/16] time 0.169 (0.169) data 0.091 (0.092) loss_x loss_x 0.6973 (0.8504) acc_x 75.0000 (77.1875) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/16] time 0.181 (0.175) data 0.105 (0.098) loss_x loss_x 0.6357 (0.8252) acc_x 84.3750 (77.9167) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 650
confident_label rate tensor(0.3261, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 527
clean true:500
clean false:27
clean_rate:0.9487666034155597
noisy true:466
noisy false:623
after delete: len(clean_dataset) 527
after delete: len(noisy_dataset) 1089
epoch [55/200] batch [5/16] time 0.164 (0.168) data 0.086 (0.091) loss_x loss_x 0.5513 (0.6748) acc_x 81.2500 (79.3750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/16] time 0.194 (0.172) data 0.117 (0.095) loss_x loss_x 0.7295 (0.8768) acc_x 84.3750 (79.0625) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/16] time 0.239 (0.177) data 0.162 (0.099) loss_x loss_x 0.6343 (0.7981) acc_x 87.5000 (81.4583) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 641
confident_label rate tensor(0.3360, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 543
clean true:513
clean false:30
clean_rate:0.9447513812154696
noisy true:462
noisy false:611
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 1073
epoch [56/200] batch [5/16] time 0.170 (0.176) data 0.093 (0.098) loss_x loss_x 1.5381 (0.9692) acc_x 62.5000 (75.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/16] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.7891 (0.9192) acc_x 78.1250 (75.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/16] time 0.159 (0.175) data 0.082 (0.097) loss_x loss_x 0.5537 (0.8637) acc_x 78.1250 (77.0833) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 662
confident_label rate tensor(0.3187, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 515
clean true:491
clean false:24
clean_rate:0.9533980582524272
noisy true:463
noisy false:638
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1101
epoch [57/200] batch [5/16] time 0.198 (0.192) data 0.121 (0.115) loss_x loss_x 1.0410 (0.8170) acc_x 81.2500 (78.7500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/16] time 0.181 (0.188) data 0.104 (0.111) loss_x loss_x 0.3408 (0.6688) acc_x 93.7500 (82.8125) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/16] time 0.184 (0.187) data 0.108 (0.109) loss_x loss_x 1.1787 (0.7358) acc_x 65.6250 (80.0000) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.3465, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 560
clean true:533
clean false:27
clean_rate:0.9517857142857142
noisy true:447
noisy false:609
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1056
epoch [58/200] batch [5/17] time 0.181 (0.182) data 0.104 (0.104) loss_x loss_x 0.6934 (0.6562) acc_x 84.3750 (81.8750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/17] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.7075 (0.6641) acc_x 78.1250 (80.6250) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/17] time 0.173 (0.179) data 0.096 (0.102) loss_x loss_x 0.5776 (0.6964) acc_x 78.1250 (80.4167) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 539
clean true:519
clean false:20
clean_rate:0.9628942486085343
noisy true:460
noisy false:617
after delete: len(clean_dataset) 539
after delete: len(noisy_dataset) 1077
epoch [59/200] batch [5/16] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.5400 (0.7157) acc_x 93.7500 (84.3750) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/16] time 0.180 (0.175) data 0.103 (0.098) loss_x loss_x 0.6074 (0.7591) acc_x 84.3750 (83.1250) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/16] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.7290 (0.7498) acc_x 75.0000 (81.8750) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 633
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:524
clean false:24
clean_rate:0.9562043795620438
noisy true:459
noisy false:609
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [60/200] batch [5/17] time 0.181 (0.163) data 0.104 (0.086) loss_x loss_x 0.8818 (0.8533) acc_x 78.1250 (80.0000) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/17] time 0.183 (0.172) data 0.106 (0.095) loss_x loss_x 0.4426 (0.8557) acc_x 90.6250 (78.1250) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/17] time 0.183 (0.176) data 0.107 (0.099) loss_x loss_x 1.0889 (0.8418) acc_x 71.8750 (79.1667) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 525
clean true:499
clean false:26
clean_rate:0.9504761904761905
noisy true:440
noisy false:651
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1091
epoch [61/200] batch [5/16] time 0.186 (0.184) data 0.110 (0.108) loss_x loss_x 0.6021 (0.7503) acc_x 87.5000 (81.2500) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/16] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5630 (0.7978) acc_x 84.3750 (81.2500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/16] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.7437 (0.8450) acc_x 75.0000 (80.6250) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 640
confident_label rate tensor(0.3459, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 559
clean true:527
clean false:32
clean_rate:0.9427549194991055
noisy true:449
noisy false:608
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1057
epoch [62/200] batch [5/17] time 0.170 (0.175) data 0.094 (0.098) loss_x loss_x 1.0713 (0.8587) acc_x 71.8750 (75.6250) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/17] time 0.187 (0.179) data 0.108 (0.101) loss_x loss_x 0.7603 (0.8468) acc_x 75.0000 (76.8750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/17] time 0.175 (0.180) data 0.097 (0.103) loss_x loss_x 0.8613 (0.8517) acc_x 81.2500 (77.2917) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:527
clean false:27
clean_rate:0.9512635379061372
noisy true:472
noisy false:590
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [63/200] batch [5/17] time 0.184 (0.188) data 0.107 (0.110) loss_x loss_x 0.6030 (0.6713) acc_x 87.5000 (85.0000) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/17] time 0.186 (0.189) data 0.109 (0.111) loss_x loss_x 1.1035 (0.7423) acc_x 78.1250 (81.8750) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/17] time 0.188 (0.190) data 0.111 (0.113) loss_x loss_x 0.6099 (0.7688) acc_x 84.3750 (80.2083) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 616
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:530
clean false:24
clean_rate:0.9566787003610109
noisy true:470
noisy false:592
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [64/200] batch [5/17] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.4771 (0.7229) acc_x 90.6250 (80.0000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/17] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.8979 (0.7788) acc_x 71.8750 (79.0625) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/17] time 0.181 (0.186) data 0.105 (0.109) loss_x loss_x 0.4822 (0.7809) acc_x 93.7500 (79.1667) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 553
clean true:528
clean false:25
clean_rate:0.9547920433996383
noisy true:449
noisy false:614
after delete: len(clean_dataset) 553
after delete: len(noisy_dataset) 1063
epoch [65/200] batch [5/17] time 0.192 (0.190) data 0.115 (0.113) loss_x loss_x 0.7212 (0.6827) acc_x 75.0000 (80.0000) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/17] time 0.184 (0.190) data 0.107 (0.113) loss_x loss_x 0.9204 (0.6560) acc_x 71.8750 (80.6250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/17] time 0.163 (0.187) data 0.086 (0.110) loss_x loss_x 0.8862 (0.6605) acc_x 78.1250 (81.0417) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:528
clean false:26
clean_rate:0.9530685920577617
noisy true:464
noisy false:598
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [66/200] batch [5/17] time 0.166 (0.161) data 0.087 (0.084) loss_x loss_x 0.7485 (0.7827) acc_x 81.2500 (80.0000) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/17] time 0.169 (0.167) data 0.093 (0.090) loss_x loss_x 0.9277 (0.8004) acc_x 75.0000 (78.1250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/17] time 0.178 (0.171) data 0.101 (0.094) loss_x loss_x 0.9819 (0.7651) acc_x 75.0000 (78.7500) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 630
confident_label rate tensor(0.3360, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 543
clean true:518
clean false:25
clean_rate:0.9539594843462247
noisy true:468
noisy false:605
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 1073
epoch [67/200] batch [5/16] time 0.184 (0.196) data 0.107 (0.119) loss_x loss_x 0.8369 (0.8032) acc_x 87.5000 (83.1250) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/16] time 0.180 (0.189) data 0.103 (0.112) loss_x loss_x 0.7036 (0.7644) acc_x 78.1250 (82.5000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/16] time 0.187 (0.188) data 0.109 (0.110) loss_x loss_x 0.3694 (0.6966) acc_x 90.6250 (83.3333) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 612
confident_label rate tensor(0.3515, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 568
clean true:538
clean false:30
clean_rate:0.9471830985915493
noisy true:466
noisy false:582
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1048
epoch [68/200] batch [5/17] time 0.188 (0.191) data 0.111 (0.113) loss_x loss_x 0.2524 (0.7945) acc_x 93.7500 (78.7500) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/17] time 0.247 (0.200) data 0.170 (0.122) loss_x loss_x 1.2773 (0.8735) acc_x 68.7500 (76.5625) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/17] time 0.181 (0.195) data 0.105 (0.118) loss_x loss_x 0.8823 (0.8102) acc_x 68.7500 (78.1250) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.3397, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 549
clean true:521
clean false:28
clean_rate:0.9489981785063752
noisy true:475
noisy false:592
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1067
epoch [69/200] batch [5/17] time 0.182 (0.193) data 0.105 (0.117) loss_x loss_x 0.7334 (0.6027) acc_x 78.1250 (83.1250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/17] time 0.179 (0.189) data 0.103 (0.113) loss_x loss_x 0.4148 (0.5830) acc_x 90.6250 (84.0625) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/17] time 0.194 (0.188) data 0.116 (0.112) loss_x loss_x 0.5723 (0.5915) acc_x 90.6250 (83.9583) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.3397, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 549
clean true:522
clean false:27
clean_rate:0.9508196721311475
noisy true:450
noisy false:617
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1067
epoch [70/200] batch [5/17] time 0.168 (0.187) data 0.090 (0.110) loss_x loss_x 0.3303 (0.7130) acc_x 96.8750 (80.6250) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/17] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.8662 (0.7573) acc_x 81.2500 (81.2500) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/17] time 0.216 (0.179) data 0.140 (0.102) loss_x loss_x 0.5063 (0.7061) acc_x 84.3750 (82.2917) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 619
confident_label rate tensor(0.3441, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 556
clean true:533
clean false:23
clean_rate:0.9586330935251799
noisy true:464
noisy false:596
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1060
epoch [71/200] batch [5/17] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.2546 (0.7589) acc_x 93.7500 (83.1250) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/17] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.8394 (0.8010) acc_x 71.8750 (79.0625) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/17] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.4155 (0.7508) acc_x 90.6250 (79.3750) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.3521, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 569
clean true:539
clean false:30
clean_rate:0.9472759226713533
noisy true:478
noisy false:569
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1047
epoch [72/200] batch [5/17] time 0.191 (0.188) data 0.114 (0.112) loss_x loss_x 1.0518 (0.9237) acc_x 62.5000 (75.0000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/17] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.9429 (0.8240) acc_x 78.1250 (77.8125) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/17] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 1.1172 (0.8014) acc_x 68.7500 (78.7500) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.3441, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 556
clean true:532
clean false:24
clean_rate:0.9568345323741008
noisy true:460
noisy false:600
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1060
epoch [73/200] batch [5/17] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.5415 (0.7217) acc_x 90.6250 (83.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/17] time 0.188 (0.186) data 0.111 (0.109) loss_x loss_x 0.5615 (0.7017) acc_x 84.3750 (83.7500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/17] time 0.163 (0.181) data 0.086 (0.104) loss_x loss_x 0.7646 (0.7110) acc_x 75.0000 (82.5000) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.3521, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 569
clean true:538
clean false:31
clean_rate:0.945518453427065
noisy true:479
noisy false:568
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1047
epoch [74/200] batch [5/17] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.6616 (0.6534) acc_x 78.1250 (83.7500) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/17] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.9399 (0.6709) acc_x 75.0000 (82.5000) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/17] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 0.7905 (0.6984) acc_x 81.2500 (81.4583) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.3484, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 563
clean true:531
clean false:32
clean_rate:0.9431616341030196
noisy true:465
noisy false:588
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1053
epoch [75/200] batch [5/17] time 0.159 (0.159) data 0.083 (0.082) loss_x loss_x 0.3638 (0.6164) acc_x 93.7500 (84.3750) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/17] time 0.182 (0.163) data 0.105 (0.086) loss_x loss_x 0.9092 (0.6896) acc_x 68.7500 (81.2500) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/17] time 0.185 (0.170) data 0.107 (0.093) loss_x loss_x 0.4922 (0.6347) acc_x 96.8750 (82.5000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.3465, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 560
clean true:532
clean false:28
clean_rate:0.95
noisy true:463
noisy false:593
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1056
epoch [76/200] batch [5/17] time 0.186 (0.188) data 0.107 (0.111) loss_x loss_x 0.6001 (0.5591) acc_x 81.2500 (85.0000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/17] time 0.165 (0.184) data 0.089 (0.107) loss_x loss_x 0.6553 (0.6401) acc_x 87.5000 (83.7500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/17] time 0.177 (0.182) data 0.100 (0.105) loss_x loss_x 0.7207 (0.6692) acc_x 78.1250 (82.0833) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:545
clean false:26
clean_rate:0.9544658493870403
noisy true:480
noisy false:565
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [77/200] batch [5/17] time 0.183 (0.199) data 0.106 (0.122) loss_x loss_x 0.6245 (0.7042) acc_x 75.0000 (80.0000) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/17] time 0.182 (0.193) data 0.105 (0.116) loss_x loss_x 1.6387 (0.8292) acc_x 68.7500 (78.4375) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/17] time 0.183 (0.189) data 0.107 (0.112) loss_x loss_x 0.8472 (0.8074) acc_x 78.1250 (79.3750) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 633
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:526
clean false:28
clean_rate:0.9494584837545126
noisy true:457
noisy false:605
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [78/200] batch [5/17] time 0.188 (0.176) data 0.111 (0.099) loss_x loss_x 0.8521 (0.7992) acc_x 75.0000 (81.8750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/17] time 0.192 (0.184) data 0.115 (0.107) loss_x loss_x 0.5420 (0.7536) acc_x 93.7500 (82.5000) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/17] time 0.170 (0.185) data 0.092 (0.108) loss_x loss_x 0.3438 (0.7494) acc_x 96.8750 (82.2917) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 616
confident_label rate tensor(0.3515, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 568
clean true:542
clean false:26
clean_rate:0.954225352112676
noisy true:458
noisy false:590
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1048
epoch [79/200] batch [5/17] time 0.160 (0.160) data 0.082 (0.082) loss_x loss_x 0.5654 (0.8543) acc_x 87.5000 (78.7500) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/17] time 0.236 (0.171) data 0.159 (0.093) loss_x loss_x 1.0098 (0.8797) acc_x 75.0000 (75.9375) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/17] time 0.177 (0.173) data 0.100 (0.095) loss_x loss_x 0.5762 (0.8185) acc_x 84.3750 (77.9167) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 579
confident_label rate tensor(0.3589, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 580
clean true:555
clean false:25
clean_rate:0.9568965517241379
noisy true:482
noisy false:554
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1036
epoch [80/200] batch [5/18] time 0.184 (0.177) data 0.107 (0.099) loss_x loss_x 0.5337 (0.7177) acc_x 84.3750 (80.6250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/18] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.5259 (0.6889) acc_x 84.3750 (81.2500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/18] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 0.7344 (0.7005) acc_x 84.3750 (80.8333) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:523
clean false:25
clean_rate:0.9543795620437956
noisy true:465
noisy false:603
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [81/200] batch [5/17] time 0.184 (0.187) data 0.107 (0.111) loss_x loss_x 1.3350 (0.8122) acc_x 65.6250 (79.3750) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/17] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.3477 (0.7117) acc_x 87.5000 (83.1250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/17] time 0.202 (0.188) data 0.125 (0.111) loss_x loss_x 0.6768 (0.6820) acc_x 78.1250 (83.5417) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 619
confident_label rate tensor(0.3496, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 565
clean true:537
clean false:28
clean_rate:0.9504424778761061
noisy true:460
noisy false:591
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1051
epoch [82/200] batch [5/17] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.6157 (0.7546) acc_x 84.3750 (80.6250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/17] time 0.181 (0.186) data 0.105 (0.109) loss_x loss_x 0.8970 (0.8159) acc_x 71.8750 (79.3750) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/17] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.9526 (0.7539) acc_x 71.8750 (80.8333) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 607
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:544
clean false:27
clean_rate:0.9527145359019265
noisy true:465
noisy false:580
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [83/200] batch [5/17] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.5146 (0.6375) acc_x 90.6250 (84.3750) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/17] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.5464 (0.7545) acc_x 87.5000 (83.1250) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/17] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.7319 (0.7560) acc_x 78.1250 (81.8750) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 614
confident_label rate tensor(0.3496, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 565
clean true:537
clean false:28
clean_rate:0.9504424778761061
noisy true:465
noisy false:586
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1051
epoch [84/200] batch [5/17] time 0.161 (0.160) data 0.083 (0.082) loss_x loss_x 1.2705 (0.7640) acc_x 75.0000 (81.8750) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/17] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.2791 (0.6379) acc_x 90.6250 (85.3125) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/17] time 0.158 (0.164) data 0.081 (0.087) loss_x loss_x 1.2822 (0.6695) acc_x 65.6250 (83.5417) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 592
confident_label rate tensor(0.3645, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 589
clean true:561
clean false:28
clean_rate:0.9524617996604414
noisy true:463
noisy false:564
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 1027
epoch [85/200] batch [5/18] time 0.165 (0.171) data 0.088 (0.093) loss_x loss_x 0.6875 (0.7233) acc_x 81.2500 (81.2500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/18] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.3823 (0.6994) acc_x 90.6250 (81.2500) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/18] time 0.168 (0.173) data 0.090 (0.096) loss_x loss_x 0.5854 (0.6896) acc_x 78.1250 (81.6667) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 609
confident_label rate tensor(0.3540, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 572
clean true:548
clean false:24
clean_rate:0.958041958041958
noisy true:459
noisy false:585
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 1044
epoch [86/200] batch [5/17] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.7710 (0.8139) acc_x 81.2500 (81.8750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/17] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 1.2363 (0.8050) acc_x 65.6250 (81.2500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/17] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 1.1729 (0.7818) acc_x 71.8750 (81.4583) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 600
confident_label rate tensor(0.3589, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 580
clean true:553
clean false:27
clean_rate:0.9534482758620689
noisy true:463
noisy false:573
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1036
epoch [87/200] batch [5/18] time 0.196 (0.190) data 0.120 (0.113) loss_x loss_x 1.0801 (0.6246) acc_x 68.7500 (81.2500) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/18] time 0.193 (0.197) data 0.116 (0.121) loss_x loss_x 0.3545 (0.6075) acc_x 90.6250 (82.5000) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/18] time 0.188 (0.194) data 0.112 (0.118) loss_x loss_x 0.9912 (0.6377) acc_x 81.2500 (81.2500) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.3577, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 578
clean true:552
clean false:26
clean_rate:0.9550173010380623
noisy true:478
noisy false:560
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 1038
epoch [88/200] batch [5/18] time 0.172 (0.168) data 0.095 (0.090) loss_x loss_x 0.6396 (0.6174) acc_x 87.5000 (83.7500) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/18] time 0.183 (0.178) data 0.107 (0.101) loss_x loss_x 0.7500 (0.6420) acc_x 78.1250 (82.5000) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/18] time 0.161 (0.175) data 0.084 (0.098) loss_x loss_x 0.7598 (0.6678) acc_x 84.3750 (82.2917) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 608
confident_label rate tensor(0.3540, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 572
clean true:537
clean false:35
clean_rate:0.9388111888111889
noisy true:471
noisy false:573
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 1044
epoch [89/200] batch [5/17] time 0.182 (0.208) data 0.105 (0.131) loss_x loss_x 0.4878 (0.7409) acc_x 90.6250 (80.6250) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/17] time 0.182 (0.201) data 0.105 (0.124) loss_x loss_x 0.7456 (0.7162) acc_x 84.3750 (81.8750) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/17] time 0.185 (0.196) data 0.108 (0.119) loss_x loss_x 0.4038 (0.6996) acc_x 87.5000 (82.5000) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 577
clean true:549
clean false:28
clean_rate:0.951473136915078
noisy true:473
noisy false:566
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1039
epoch [90/200] batch [5/18] time 0.161 (0.160) data 0.083 (0.083) loss_x loss_x 0.9912 (0.8135) acc_x 75.0000 (79.3750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/18] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.7134 (0.8723) acc_x 81.2500 (79.6875) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/18] time 0.159 (0.160) data 0.081 (0.082) loss_x loss_x 0.8672 (0.8281) acc_x 75.0000 (80.0000) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 601
confident_label rate tensor(0.3546, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 573
clean true:548
clean false:25
clean_rate:0.956369982547993
noisy true:467
noisy false:576
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1043
epoch [91/200] batch [5/17] time 0.204 (0.178) data 0.128 (0.101) loss_x loss_x 1.0645 (0.7971) acc_x 71.8750 (80.0000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/17] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 0.4199 (0.6516) acc_x 90.6250 (84.3750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/17] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.6782 (0.6906) acc_x 81.2500 (83.3333) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 595
clean true:564
clean false:31
clean_rate:0.9478991596638655
noisy true:470
noisy false:551
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1021
epoch [92/200] batch [5/18] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.8394 (0.7946) acc_x 81.2500 (76.2500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/18] time 0.167 (0.182) data 0.089 (0.106) loss_x loss_x 0.3489 (0.6823) acc_x 93.7500 (81.5625) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [15/18] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 1.0449 (0.6653) acc_x 75.0000 (82.2917) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 590
confident_label rate tensor(0.3620, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 585
clean true:557
clean false:28
clean_rate:0.9521367521367521
noisy true:469
noisy false:562
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1031
epoch [93/200] batch [5/18] time 0.244 (0.213) data 0.167 (0.136) loss_x loss_x 0.6108 (0.7072) acc_x 90.6250 (85.6250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/18] time 0.196 (0.202) data 0.119 (0.125) loss_x loss_x 0.3079 (0.6576) acc_x 93.7500 (84.0625) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/18] time 0.185 (0.198) data 0.107 (0.121) loss_x loss_x 0.5620 (0.6383) acc_x 90.6250 (83.7500) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 587
confident_label rate tensor(0.3558, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 575
clean true:547
clean false:28
clean_rate:0.951304347826087
noisy true:482
noisy false:559
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1041
epoch [94/200] batch [5/17] time 0.159 (0.175) data 0.083 (0.098) loss_x loss_x 0.7432 (0.7298) acc_x 87.5000 (80.6250) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/17] time 0.159 (0.167) data 0.082 (0.090) loss_x loss_x 0.3560 (0.6353) acc_x 90.6250 (82.5000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [15/17] time 0.162 (0.168) data 0.085 (0.092) loss_x loss_x 0.5518 (0.6173) acc_x 81.2500 (83.1250) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 609
confident_label rate tensor(0.3540, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 572
clean true:541
clean false:31
clean_rate:0.9458041958041958
noisy true:466
noisy false:578
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 1044
epoch [95/200] batch [5/17] time 0.172 (0.183) data 0.095 (0.106) loss_x loss_x 0.5728 (0.6463) acc_x 90.6250 (83.7500) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/17] time 0.186 (0.179) data 0.110 (0.102) loss_x loss_x 0.8506 (0.6413) acc_x 81.2500 (84.6875) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/17] time 0.217 (0.190) data 0.141 (0.113) loss_x loss_x 0.5747 (0.6482) acc_x 81.2500 (83.3333) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 595
clean true:564
clean false:31
clean_rate:0.9478991596638655
noisy true:471
noisy false:550
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1021
epoch [96/200] batch [5/18] time 0.188 (0.186) data 0.111 (0.109) loss_x loss_x 1.2227 (0.9642) acc_x 71.8750 (76.8750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/18] time 0.187 (0.189) data 0.110 (0.111) loss_x loss_x 1.0049 (0.9225) acc_x 78.1250 (77.1875) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/18] time 0.215 (0.191) data 0.137 (0.114) loss_x loss_x 0.6665 (0.9255) acc_x 87.5000 (76.6667) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 576
confident_label rate tensor(0.3509, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 567
clean true:547
clean false:20
clean_rate:0.9647266313932981
noisy true:493
noisy false:556
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1049
epoch [97/200] batch [5/17] time 0.181 (0.174) data 0.104 (0.097) loss_x loss_x 0.6538 (0.6658) acc_x 87.5000 (80.0000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/17] time 0.189 (0.173) data 0.112 (0.096) loss_x loss_x 0.8242 (0.6389) acc_x 81.2500 (80.6250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/17] time 0.190 (0.178) data 0.112 (0.101) loss_x loss_x 0.9409 (0.6922) acc_x 81.2500 (80.8333) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3478, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 562
clean true:536
clean false:26
clean_rate:0.9537366548042705
noisy true:492
noisy false:562
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1054
epoch [98/200] batch [5/17] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.5088 (0.6017) acc_x 87.5000 (83.7500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/17] time 0.164 (0.183) data 0.087 (0.106) loss_x loss_x 0.5933 (0.6378) acc_x 87.5000 (82.5000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/17] time 0.189 (0.180) data 0.112 (0.103) loss_x loss_x 0.5171 (0.6574) acc_x 90.6250 (82.2917) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 580
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 587
clean true:562
clean false:25
clean_rate:0.9574105621805792
noisy true:474
noisy false:555
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1029
epoch [99/200] batch [5/18] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.5493 (0.6165) acc_x 84.3750 (82.5000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/18] time 0.173 (0.178) data 0.097 (0.101) loss_x loss_x 0.5508 (0.6421) acc_x 84.3750 (81.5625) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/18] time 0.162 (0.172) data 0.085 (0.095) loss_x loss_x 0.4709 (0.6783) acc_x 84.3750 (81.6667) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 592
confident_label rate tensor(0.3583, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 579
clean true:554
clean false:25
clean_rate:0.9568221070811744
noisy true:470
noisy false:567
all clean rate:  [0.9256505576208178, 0.9351535836177475, 0.9654320987654321, 0.9577114427860697, 0.9603960396039604, 0.9610091743119266, 0.9655172413793104, 0.9635535307517085, 0.962877030162413, 0.9732142857142857, 0.9630434782608696, 0.9606986899563319, 0.9711751662971175, 0.9688888888888889, 0.9642857142857143, 0.9508547008547008, 0.9595744680851064, 0.9583333333333334, 0.9514767932489452, 0.9545454545454546, 0.9630390143737166, 0.9576271186440678, 0.9605809128630706, 0.9620253164556962, 0.9549180327868853, 0.9595959595959596, 0.9576612903225806, 0.9533980582524272, 0.9595141700404858, 0.9616122840690979, 0.9604743083003953, 0.958984375, 0.9562624254473161, 0.9448818897637795, 0.9523809523809523, 0.9651162790697675, 0.9507575757575758, 0.9603174603174603, 0.9585687382297552, 0.965183752417795, 0.9474708171206225, 0.9591439688715954, 0.9468503937007874, 0.9561904761904761, 0.9652509652509652, 0.9626168224299065, 0.9540229885057471, 0.9578544061302682, 0.9541984732824428, 0.9563567362428842, 0.949317738791423, 0.9597701149425287, 0.957169459962756, 0.9537037037037037, 0.9487666034155597, 0.9447513812154696, 0.9533980582524272, 0.9517857142857142, 0.9628942486085343, 0.9562043795620438, 0.9504761904761905, 0.9427549194991055, 0.9512635379061372, 0.9566787003610109, 0.9547920433996383, 0.9530685920577617, 0.9539594843462247, 0.9471830985915493, 0.9489981785063752, 0.9508196721311475, 0.9586330935251799, 0.9472759226713533, 0.9568345323741008, 0.945518453427065, 0.9431616341030196, 0.95, 0.9544658493870403, 0.9494584837545126, 0.954225352112676, 0.9568965517241379, 0.9543795620437956, 0.9504424778761061, 0.9527145359019265, 0.9504424778761061, 0.9524617996604414, 0.958041958041958, 0.9534482758620689, 0.9550173010380623, 0.9388111888111889, 0.951473136915078, 0.956369982547993, 0.9478991596638655, 0.9521367521367521, 0.951304347826087, 0.9458041958041958, 0.9478991596638655, 0.9647266313932981, 0.9537366548042705, 0.9574105621805792, 0.9568221070811744]
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1037
epoch [100/200] batch [5/18] time 0.170 (0.177) data 0.092 (0.100) loss_x loss_x 0.6401 (0.6519) acc_x 87.5000 (82.5000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/18] time 0.188 (0.180) data 0.112 (0.103) loss_x loss_x 0.5283 (0.6727) acc_x 87.5000 (82.1875) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/18] time 0.181 (0.179) data 0.102 (0.102) loss_x loss_x 0.4338 (0.6944) acc_x 90.6250 (81.4583) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 577
clean true:547
clean false:30
clean_rate:0.9480069324090121
noisy true:463
noisy false:576
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1039
epoch [101/200] batch [5/18] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.6479 (0.6914) acc_x 81.2500 (81.8750) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/18] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.8398 (0.7840) acc_x 81.2500 (80.0000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [15/18] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.5029 (0.7549) acc_x 87.5000 (81.2500) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 590
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 587
clean true:559
clean false:28
clean_rate:0.9522998296422487
noisy true:467
noisy false:562
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1029
epoch [102/200] batch [5/18] time 0.160 (0.161) data 0.083 (0.083) loss_x loss_x 0.7017 (0.7773) acc_x 78.1250 (77.5000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/18] time 0.183 (0.162) data 0.105 (0.085) loss_x loss_x 0.6841 (0.7461) acc_x 84.3750 (80.0000) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/18] time 0.183 (0.169) data 0.106 (0.092) loss_x loss_x 0.6782 (0.7328) acc_x 84.3750 (80.2083) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.3676, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 594
clean true:565
clean false:29
clean_rate:0.9511784511784511
noisy true:492
noisy false:530
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1022
epoch [103/200] batch [5/18] time 0.170 (0.195) data 0.093 (0.118) loss_x loss_x 0.3826 (0.8540) acc_x 87.5000 (80.0000) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/18] time 0.158 (0.179) data 0.082 (0.103) loss_x loss_x 1.0752 (0.7304) acc_x 75.0000 (82.1875) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [15/18] time 0.184 (0.174) data 0.107 (0.098) loss_x loss_x 0.9746 (0.7361) acc_x 71.8750 (81.4583) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 598
clean true:569
clean false:29
clean_rate:0.9515050167224081
noisy true:476
noisy false:542
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1018
epoch [104/200] batch [5/18] time 0.191 (0.187) data 0.113 (0.109) loss_x loss_x 1.0244 (0.7546) acc_x 78.1250 (83.1250) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/18] time 0.161 (0.185) data 0.084 (0.108) loss_x loss_x 0.5732 (0.7899) acc_x 84.3750 (80.6250) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/18] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.3464 (0.7825) acc_x 93.7500 (80.2083) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:572
clean false:31
clean_rate:0.9485903814262023
noisy true:472
noisy false:541
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [105/200] batch [5/18] time 0.162 (0.171) data 0.085 (0.094) loss_x loss_x 1.0430 (0.7311) acc_x 75.0000 (81.8750) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/18] time 0.162 (0.166) data 0.085 (0.089) loss_x loss_x 0.7251 (0.7660) acc_x 78.1250 (79.6875) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [15/18] time 0.166 (0.165) data 0.089 (0.088) loss_x loss_x 0.6533 (0.7171) acc_x 84.3750 (81.2500) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 591
clean true:563
clean false:28
clean_rate:0.9526226734348562
noisy true:471
noisy false:554
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1025
epoch [106/200] batch [5/18] time 0.193 (0.189) data 0.115 (0.111) loss_x loss_x 0.7886 (0.5010) acc_x 81.2500 (88.1250) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/18] time 0.183 (0.182) data 0.104 (0.105) loss_x loss_x 0.6934 (0.5512) acc_x 84.3750 (86.5625) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/18] time 0.169 (0.178) data 0.092 (0.100) loss_x loss_x 0.6812 (0.6186) acc_x 90.6250 (85.0000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.3663, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 592
clean true:566
clean false:26
clean_rate:0.956081081081081
noisy true:453
noisy false:571
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1024
epoch [107/200] batch [5/18] time 0.160 (0.161) data 0.083 (0.084) loss_x loss_x 0.5195 (0.6767) acc_x 84.3750 (83.1250) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/18] time 0.160 (0.160) data 0.082 (0.083) loss_x loss_x 0.5894 (0.6845) acc_x 87.5000 (83.1250) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/18] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.3381 (0.7522) acc_x 90.6250 (82.0833) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 612
confident_label rate tensor(0.3558, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 575
clean true:547
clean false:28
clean_rate:0.951304347826087
noisy true:457
noisy false:584
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1041
epoch [108/200] batch [5/17] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.6221 (0.7506) acc_x 87.5000 (80.6250) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/17] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.6646 (0.6540) acc_x 75.0000 (80.6250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/17] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.5737 (0.6468) acc_x 78.1250 (81.0417) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 576
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 598
clean true:565
clean false:33
clean_rate:0.9448160535117057
noisy true:475
noisy false:543
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1018
epoch [109/200] batch [5/18] time 0.162 (0.176) data 0.086 (0.099) loss_x loss_x 1.5586 (0.7781) acc_x 65.6250 (81.8750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/18] time 0.159 (0.173) data 0.083 (0.097) loss_x loss_x 0.7793 (0.8726) acc_x 81.2500 (80.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/18] time 0.179 (0.177) data 0.103 (0.100) loss_x loss_x 0.7046 (0.7898) acc_x 81.2500 (81.0417) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:580
clean false:29
clean_rate:0.9523809523809523
noisy true:445
noisy false:562
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [110/200] batch [5/19] time 0.184 (0.191) data 0.107 (0.115) loss_x loss_x 0.8330 (0.7344) acc_x 78.1250 (80.0000) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/19] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.6079 (0.6207) acc_x 87.5000 (85.3125) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/19] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.5103 (0.5964) acc_x 81.2500 (84.3750) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.3663, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 592
clean true:562
clean false:30
clean_rate:0.9493243243243243
noisy true:468
noisy false:556
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1024
epoch [111/200] batch [5/18] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.4048 (0.5147) acc_x 81.2500 (85.0000) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [10/18] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.5771 (0.6398) acc_x 90.6250 (82.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/18] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7319 (0.6540) acc_x 84.3750 (81.8750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:556
clean false:30
clean_rate:0.9488054607508533
noisy true:487
noisy false:543
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [112/200] batch [5/18] time 0.180 (0.183) data 0.104 (0.106) loss_x loss_x 0.7183 (0.5459) acc_x 81.2500 (88.7500) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/18] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.5913 (0.6163) acc_x 78.1250 (84.6875) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [15/18] time 0.186 (0.184) data 0.110 (0.107) loss_x loss_x 0.4985 (0.6130) acc_x 84.3750 (82.9167) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.3688, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 596
clean true:571
clean false:25
clean_rate:0.9580536912751678
noisy true:479
noisy false:541
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1020
epoch [113/200] batch [5/18] time 0.163 (0.179) data 0.085 (0.102) loss_x loss_x 0.7549 (0.8515) acc_x 84.3750 (81.2500) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/18] time 0.159 (0.177) data 0.082 (0.099) loss_x loss_x 0.8438 (0.8097) acc_x 81.2500 (80.6250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [15/18] time 0.181 (0.177) data 0.105 (0.099) loss_x loss_x 0.7681 (0.7748) acc_x 81.2500 (81.6667) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:558
clean false:32
clean_rate:0.9457627118644067
noisy true:470
noisy false:556
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [114/200] batch [5/18] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.7305 (0.5256) acc_x 81.2500 (86.8750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/18] time 0.173 (0.183) data 0.096 (0.106) loss_x loss_x 0.9478 (0.6186) acc_x 84.3750 (85.0000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [15/18] time 0.182 (0.181) data 0.104 (0.104) loss_x loss_x 0.3501 (0.6339) acc_x 96.8750 (83.7500) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 585
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 607
clean true:578
clean false:29
clean_rate:0.9522240527182867
noisy true:453
noisy false:556
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1009
epoch [115/200] batch [5/18] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.6094 (0.6801) acc_x 84.3750 (81.8750) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [10/18] time 0.184 (0.178) data 0.106 (0.101) loss_x loss_x 0.7568 (0.7054) acc_x 84.3750 (81.5625) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/18] time 0.174 (0.177) data 0.096 (0.100) loss_x loss_x 1.1807 (0.7641) acc_x 75.0000 (80.2083) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3688, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 596
clean true:568
clean false:28
clean_rate:0.9530201342281879
noisy true:476
noisy false:544
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1020
epoch [116/200] batch [5/18] time 0.188 (0.189) data 0.110 (0.112) loss_x loss_x 0.6851 (0.6710) acc_x 81.2500 (83.1250) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/18] time 0.198 (0.190) data 0.122 (0.113) loss_x loss_x 1.1016 (0.7445) acc_x 65.6250 (81.5625) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/18] time 0.187 (0.189) data 0.109 (0.112) loss_x loss_x 0.8809 (0.7220) acc_x 84.3750 (81.4583) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 574
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 591
clean true:559
clean false:32
clean_rate:0.9458544839255499
noisy true:483
noisy false:542
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1025
epoch [117/200] batch [5/18] time 0.159 (0.158) data 0.082 (0.082) loss_x loss_x 0.8608 (0.7764) acc_x 75.0000 (80.0000) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/18] time 0.212 (0.180) data 0.136 (0.104) loss_x loss_x 0.9004 (0.7658) acc_x 71.8750 (81.2500) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [15/18] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.6108 (0.7111) acc_x 90.6250 (81.8750) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 587
clean true:557
clean false:30
clean_rate:0.948892674616695
noisy true:484
noisy false:545
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1029
epoch [118/200] batch [5/18] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.8486 (0.6958) acc_x 81.2500 (84.3750) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/18] time 0.179 (0.185) data 0.102 (0.108) loss_x loss_x 0.7979 (0.7057) acc_x 75.0000 (82.1875) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/18] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 0.5815 (0.7155) acc_x 81.2500 (81.2500) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 590
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:565
clean false:32
clean_rate:0.9463986599664992
noisy true:461
noisy false:558
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [119/200] batch [5/18] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.6665 (0.6227) acc_x 84.3750 (86.8750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/18] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.4561 (0.6115) acc_x 87.5000 (86.8750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [15/18] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.8291 (0.6035) acc_x 78.1250 (85.6250) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 565
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:580
clean false:35
clean_rate:0.943089430894309
noisy true:471
noisy false:530
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [120/200] batch [5/19] time 0.188 (0.174) data 0.111 (0.096) loss_x loss_x 0.8257 (0.6101) acc_x 68.7500 (82.5000) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/19] time 0.186 (0.180) data 0.108 (0.103) loss_x loss_x 0.5786 (0.6696) acc_x 84.3750 (81.8750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [15/19] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 1.1230 (0.6883) acc_x 75.0000 (82.0833) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 598
clean true:570
clean false:28
clean_rate:0.9531772575250836
noisy true:464
noisy false:554
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1018
epoch [121/200] batch [5/18] time 0.191 (0.192) data 0.113 (0.115) loss_x loss_x 0.8169 (0.6181) acc_x 78.1250 (86.2500) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [10/18] time 0.160 (0.179) data 0.083 (0.102) loss_x loss_x 0.6719 (0.6001) acc_x 81.2500 (85.6250) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/18] time 0.168 (0.182) data 0.090 (0.105) loss_x loss_x 0.7944 (0.6166) acc_x 78.1250 (85.6250) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 611
clean true:580
clean false:31
clean_rate:0.9492635024549918
noisy true:476
noisy false:529
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1005
epoch [122/200] batch [5/19] time 0.161 (0.159) data 0.084 (0.083) loss_x loss_x 0.5674 (0.6500) acc_x 87.5000 (84.3750) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/19] time 0.168 (0.166) data 0.091 (0.090) loss_x loss_x 0.6851 (0.6237) acc_x 81.2500 (84.3750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [15/19] time 0.177 (0.170) data 0.100 (0.093) loss_x loss_x 0.5918 (0.6283) acc_x 87.5000 (83.7500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.3861, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 624
clean true:590
clean false:34
clean_rate:0.9455128205128205
noisy true:484
noisy false:508
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 992
epoch [123/200] batch [5/19] time 0.210 (0.191) data 0.133 (0.114) loss_x loss_x 0.6499 (0.6741) acc_x 87.5000 (81.8750) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/19] time 0.186 (0.192) data 0.108 (0.115) loss_x loss_x 0.6445 (0.6511) acc_x 75.0000 (82.1875) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/19] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 0.7471 (0.6393) acc_x 81.2500 (83.5417) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 579
confident_label rate tensor(0.3688, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 596
clean true:568
clean false:28
clean_rate:0.9530201342281879
noisy true:469
noisy false:551
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1020
epoch [124/200] batch [5/18] time 0.184 (0.193) data 0.106 (0.116) loss_x loss_x 0.3591 (0.6147) acc_x 90.6250 (83.1250) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/18] time 0.182 (0.190) data 0.105 (0.113) loss_x loss_x 0.4741 (0.5993) acc_x 87.5000 (83.1250) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [15/18] time 0.160 (0.184) data 0.083 (0.106) loss_x loss_x 0.5483 (0.5894) acc_x 84.3750 (84.1667) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 608
clean true:576
clean false:32
clean_rate:0.9473684210526315
noisy true:456
noisy false:552
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1008
epoch [125/200] batch [5/19] time 0.189 (0.185) data 0.112 (0.109) loss_x loss_x 0.5493 (0.6009) acc_x 84.3750 (86.2500) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/19] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 0.8228 (0.6940) acc_x 84.3750 (84.6875) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [15/19] time 0.188 (0.190) data 0.111 (0.114) loss_x loss_x 0.8184 (0.6170) acc_x 75.0000 (85.6250) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3663, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 592
clean true:559
clean false:33
clean_rate:0.9442567567567568
noisy true:469
noisy false:555
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1024
epoch [126/200] batch [5/18] time 0.179 (0.177) data 0.102 (0.100) loss_x loss_x 1.0840 (0.8033) acc_x 75.0000 (80.0000) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [10/18] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.4231 (0.6964) acc_x 87.5000 (82.5000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [15/18] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.9258 (0.6785) acc_x 75.0000 (82.5000) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 574
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:572
clean false:29
clean_rate:0.9517470881863561
noisy true:470
noisy false:545
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [127/200] batch [5/18] time 0.159 (0.177) data 0.083 (0.100) loss_x loss_x 0.4263 (0.6513) acc_x 87.5000 (82.5000) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [10/18] time 0.161 (0.168) data 0.084 (0.092) loss_x loss_x 0.5376 (0.5943) acc_x 87.5000 (84.6875) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [15/18] time 0.159 (0.166) data 0.082 (0.089) loss_x loss_x 0.7642 (0.6449) acc_x 71.8750 (83.1250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 583
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:554
clean false:32
clean_rate:0.9453924914675768
noisy true:479
noisy false:551
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [128/200] batch [5/18] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3813 (0.5910) acc_x 84.3750 (81.2500) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/18] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 1.3340 (0.7515) acc_x 75.0000 (80.0000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [15/18] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.6924 (0.7409) acc_x 81.2500 (81.4583) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 555
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 619
clean true:588
clean false:31
clean_rate:0.9499192245557351
noisy true:473
noisy false:524
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 997
epoch [129/200] batch [5/19] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6812 (0.6428) acc_x 78.1250 (85.0000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/19] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.4353 (0.6031) acc_x 93.7500 (85.0000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [15/19] time 0.186 (0.185) data 0.108 (0.107) loss_x loss_x 0.7456 (0.5826) acc_x 81.2500 (85.6250) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:570
clean false:35
clean_rate:0.9421487603305785
noisy true:458
noisy false:553
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [130/200] batch [5/18] time 0.173 (0.166) data 0.096 (0.089) loss_x loss_x 0.4644 (0.6108) acc_x 87.5000 (86.2500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [10/18] time 0.159 (0.167) data 0.083 (0.090) loss_x loss_x 0.6440 (0.6079) acc_x 87.5000 (83.7500) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/18] time 0.189 (0.171) data 0.112 (0.094) loss_x loss_x 0.7061 (0.6091) acc_x 84.3750 (85.2083) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 611
clean true:581
clean false:30
clean_rate:0.9509001636661211
noisy true:462
noisy false:543
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1005
epoch [131/200] batch [5/19] time 0.192 (0.184) data 0.115 (0.107) loss_x loss_x 0.4766 (0.6791) acc_x 84.3750 (83.1250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/19] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.7515 (0.6470) acc_x 78.1250 (82.5000) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/19] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.7734 (0.6542) acc_x 84.3750 (82.7083) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 576
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:572
clean false:30
clean_rate:0.9501661129568106
noisy true:468
noisy false:546
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [132/200] batch [5/18] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.6113 (0.6899) acc_x 81.2500 (83.7500) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/18] time 0.274 (0.196) data 0.198 (0.120) loss_x loss_x 0.5957 (0.6599) acc_x 84.3750 (83.4375) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/18] time 0.200 (0.194) data 0.124 (0.117) loss_x loss_x 0.5508 (0.7057) acc_x 81.2500 (82.7083) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.3707, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 599
clean true:565
clean false:34
clean_rate:0.9432387312186978
noisy true:484
noisy false:533
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1017
epoch [133/200] batch [5/18] time 0.183 (0.189) data 0.107 (0.113) loss_x loss_x 0.6274 (0.6167) acc_x 84.3750 (84.3750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/18] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 0.6553 (0.5286) acc_x 81.2500 (86.2500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [15/18] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.4753 (0.6010) acc_x 87.5000 (84.1667) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 570
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:566
clean false:35
clean_rate:0.9417637271214643
noisy true:480
noisy false:535
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [134/200] batch [5/18] time 0.170 (0.188) data 0.093 (0.111) loss_x loss_x 0.3689 (0.5835) acc_x 90.6250 (85.6250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/18] time 0.209 (0.180) data 0.131 (0.103) loss_x loss_x 0.7964 (0.6561) acc_x 75.0000 (83.7500) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [15/18] time 0.158 (0.175) data 0.081 (0.098) loss_x loss_x 0.5884 (0.6781) acc_x 84.3750 (82.5000) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 600
clean true:574
clean false:26
clean_rate:0.9566666666666667
noisy true:464
noisy false:552
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1016
epoch [135/200] batch [5/18] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.5835 (0.6852) acc_x 84.3750 (83.1250) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/18] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.6260 (0.7088) acc_x 90.6250 (82.1875) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [15/18] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.5479 (0.7046) acc_x 87.5000 (80.8333) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:573
clean false:32
clean_rate:0.947107438016529
noisy true:465
noisy false:546
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [136/200] batch [5/18] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.7524 (0.7372) acc_x 81.2500 (81.8750) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/18] time 0.160 (0.179) data 0.083 (0.102) loss_x loss_x 0.3438 (0.6618) acc_x 93.7500 (83.7500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [15/18] time 0.169 (0.175) data 0.092 (0.099) loss_x loss_x 0.8896 (0.6832) acc_x 78.1250 (82.7083) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:576
clean false:29
clean_rate:0.9520661157024793
noisy true:462
noisy false:549
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [137/200] batch [5/18] time 0.189 (0.175) data 0.112 (0.098) loss_x loss_x 0.8550 (0.6889) acc_x 81.2500 (78.1250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/18] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.9038 (0.7266) acc_x 78.1250 (79.6875) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [15/18] time 0.172 (0.180) data 0.093 (0.103) loss_x loss_x 0.6284 (0.7364) acc_x 81.2500 (80.0000) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 554
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:587
clean false:26
clean_rate:0.9575856443719413
noisy true:475
noisy false:528
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [138/200] batch [5/19] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.3833 (0.5996) acc_x 93.7500 (84.3750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/19] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.4834 (0.6201) acc_x 87.5000 (84.0625) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/19] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.4280 (0.5625) acc_x 87.5000 (85.0000) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.3707, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 599
clean true:571
clean false:28
clean_rate:0.9532554257095158
noisy true:476
noisy false:541
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1017
epoch [139/200] batch [5/18] time 0.167 (0.179) data 0.090 (0.102) loss_x loss_x 0.5962 (0.7156) acc_x 84.3750 (83.1250) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [10/18] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.6079 (0.6476) acc_x 84.3750 (82.5000) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [15/18] time 0.161 (0.178) data 0.084 (0.101) loss_x loss_x 0.5366 (0.5889) acc_x 84.3750 (84.5833) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 565
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 612
clean true:580
clean false:32
clean_rate:0.9477124183006536
noisy true:471
noisy false:533
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1004
epoch [140/200] batch [5/19] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 0.8950 (0.5773) acc_x 78.1250 (83.7500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/19] time 0.183 (0.185) data 0.106 (0.107) loss_x loss_x 0.5659 (0.6003) acc_x 84.3750 (84.3750) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/19] time 0.161 (0.182) data 0.084 (0.104) loss_x loss_x 0.6978 (0.6585) acc_x 81.2500 (83.1250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 607
clean true:579
clean false:28
clean_rate:0.9538714991762768
noisy true:466
noisy false:543
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1009
epoch [141/200] batch [5/18] time 0.183 (0.185) data 0.106 (0.107) loss_x loss_x 0.5225 (0.7940) acc_x 84.3750 (78.7500) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/18] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 1.1064 (0.7380) acc_x 68.7500 (80.0000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [15/18] time 0.161 (0.174) data 0.083 (0.097) loss_x loss_x 0.5508 (0.6819) acc_x 81.2500 (81.6667) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.3855, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 623
clean true:582
clean false:41
clean_rate:0.9341894060995185
noisy true:471
noisy false:522
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 993
epoch [142/200] batch [5/19] time 0.181 (0.189) data 0.104 (0.112) loss_x loss_x 1.1670 (0.8304) acc_x 65.6250 (80.0000) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/19] time 0.182 (0.185) data 0.105 (0.109) loss_x loss_x 0.9106 (0.7617) acc_x 75.0000 (81.8750) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [15/19] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.7622 (0.7104) acc_x 71.8750 (82.0833) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:583
clean false:30
clean_rate:0.9510603588907015
noisy true:473
noisy false:530
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [143/200] batch [5/19] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.5820 (0.5764) acc_x 84.3750 (86.8750) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/19] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.4763 (0.5424) acc_x 84.3750 (86.8750) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [15/19] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.4324 (0.5789) acc_x 93.7500 (85.8333) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:583
clean false:32
clean_rate:0.9479674796747968
noisy true:449
noisy false:552
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [144/200] batch [5/19] time 0.160 (0.168) data 0.082 (0.091) loss_x loss_x 0.6646 (0.5888) acc_x 84.3750 (85.0000) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/19] time 0.160 (0.169) data 0.082 (0.092) loss_x loss_x 0.2230 (0.6557) acc_x 93.7500 (82.8125) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [15/19] time 0.163 (0.171) data 0.086 (0.094) loss_x loss_x 0.6934 (0.6443) acc_x 84.3750 (83.5417) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.3837, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 620
clean true:583
clean false:37
clean_rate:0.9403225806451613
noisy true:480
noisy false:516
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 996
epoch [145/200] batch [5/19] time 0.182 (0.174) data 0.105 (0.096) loss_x loss_x 0.4426 (0.7040) acc_x 90.6250 (83.1250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/19] time 0.178 (0.174) data 0.100 (0.097) loss_x loss_x 0.9653 (0.6965) acc_x 68.7500 (83.1250) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [15/19] time 0.169 (0.174) data 0.090 (0.096) loss_x loss_x 0.5635 (0.6146) acc_x 84.3750 (85.6250) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 611
clean true:582
clean false:29
clean_rate:0.9525368248772504
noisy true:471
noisy false:534
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1005
epoch [146/200] batch [5/19] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.4802 (0.5490) acc_x 87.5000 (86.2500) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/19] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.9561 (0.5941) acc_x 78.1250 (85.9375) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [15/19] time 0.162 (0.181) data 0.084 (0.104) loss_x loss_x 0.9170 (0.6111) acc_x 75.0000 (84.1667) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 595
clean true:568
clean false:27
clean_rate:0.9546218487394958
noisy true:473
noisy false:548
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1021
epoch [147/200] batch [5/18] time 0.178 (0.181) data 0.100 (0.104) loss_x loss_x 0.4036 (0.7013) acc_x 90.6250 (81.2500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/18] time 0.167 (0.178) data 0.089 (0.101) loss_x loss_x 0.5352 (0.6407) acc_x 84.3750 (81.8750) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [15/18] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 1.0869 (0.6190) acc_x 68.7500 (82.2917) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.3861, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 624
clean true:589
clean false:35
clean_rate:0.9439102564102564
noisy true:484
noisy false:508
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 992
epoch [148/200] batch [5/19] time 0.184 (0.181) data 0.108 (0.104) loss_x loss_x 1.0059 (0.7060) acc_x 71.8750 (81.2500) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/19] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.3582 (0.6019) acc_x 90.6250 (85.0000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [15/19] time 0.169 (0.182) data 0.091 (0.105) loss_x loss_x 0.2316 (0.6150) acc_x 96.8750 (85.2083) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.3849, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 622
clean true:593
clean false:29
clean_rate:0.9533762057877814
noisy true:465
noisy false:529
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 994
epoch [149/200] batch [5/19] time 0.184 (0.184) data 0.105 (0.107) loss_x loss_x 0.4551 (0.6020) acc_x 93.7500 (83.7500) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [10/19] time 0.178 (0.179) data 0.102 (0.101) loss_x loss_x 0.4409 (0.6354) acc_x 87.5000 (83.1250) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [15/19] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.2825 (0.6788) acc_x 93.7500 (82.7083) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:570
clean false:35
clean_rate:0.9421487603305785
noisy true:477
noisy false:534
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [150/200] batch [5/18] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.5205 (0.5693) acc_x 87.5000 (85.0000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/18] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.5747 (0.6153) acc_x 90.6250 (83.7500) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/18] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.1910 (0.5893) acc_x 96.8750 (85.2083) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:570
clean false:33
clean_rate:0.945273631840796
noisy true:473
noisy false:540
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [151/200] batch [5/18] time 0.172 (0.185) data 0.095 (0.108) loss_x loss_x 0.7988 (0.7515) acc_x 81.2500 (81.2500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/18] time 0.201 (0.190) data 0.124 (0.113) loss_x loss_x 0.6167 (0.6610) acc_x 90.6250 (84.0625) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [15/18] time 0.204 (0.187) data 0.127 (0.110) loss_x loss_x 0.7915 (0.6645) acc_x 71.8750 (83.7500) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 606
clean true:573
clean false:33
clean_rate:0.9455445544554455
noisy true:465
noisy false:545
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1010
epoch [152/200] batch [5/18] time 0.186 (0.194) data 0.109 (0.118) loss_x loss_x 0.7700 (0.8403) acc_x 81.2500 (78.1250) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/18] time 0.197 (0.199) data 0.120 (0.122) loss_x loss_x 1.0566 (0.7417) acc_x 71.8750 (80.0000) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/18] time 0.182 (0.192) data 0.105 (0.116) loss_x loss_x 0.4685 (0.6736) acc_x 84.3750 (81.8750) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 606
clean true:577
clean false:29
clean_rate:0.9521452145214522
noisy true:470
noisy false:540
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1010
epoch [153/200] batch [5/18] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.8345 (0.6457) acc_x 81.2500 (85.0000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/18] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6406 (0.6159) acc_x 87.5000 (85.9375) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [15/18] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.7451 (0.6089) acc_x 81.2500 (85.8333) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3849, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 622
clean true:590
clean false:32
clean_rate:0.9485530546623794
noisy true:475
noisy false:519
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 994
epoch [154/200] batch [5/19] time 0.184 (0.191) data 0.107 (0.114) loss_x loss_x 0.7900 (0.5995) acc_x 81.2500 (86.8750) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/19] time 0.199 (0.190) data 0.122 (0.113) loss_x loss_x 1.0547 (0.7134) acc_x 71.8750 (81.2500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [15/19] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 0.4312 (0.6633) acc_x 93.7500 (82.9167) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 577
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:581
clean false:32
clean_rate:0.9477977161500816
noisy true:458
noisy false:545
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [155/200] batch [5/19] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.7520 (0.6058) acc_x 81.2500 (86.2500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/19] time 0.161 (0.165) data 0.084 (0.087) loss_x loss_x 0.2886 (0.6604) acc_x 93.7500 (83.1250) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [15/19] time 0.211 (0.167) data 0.133 (0.090) loss_x loss_x 0.6191 (0.6720) acc_x 87.5000 (83.5417) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:567
clean false:30
clean_rate:0.949748743718593
noisy true:474
noisy false:545
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [156/200] batch [5/18] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.6509 (0.5916) acc_x 84.3750 (83.7500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/18] time 0.199 (0.179) data 0.122 (0.102) loss_x loss_x 1.0059 (0.6020) acc_x 75.0000 (84.0625) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [15/18] time 0.158 (0.176) data 0.081 (0.099) loss_x loss_x 0.9443 (0.6216) acc_x 84.3750 (84.1667) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 608
clean true:577
clean false:31
clean_rate:0.9490131578947368
noisy true:466
noisy false:542
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1008
epoch [157/200] batch [5/19] time 0.158 (0.169) data 0.081 (0.092) loss_x loss_x 0.7026 (0.6266) acc_x 81.2500 (84.3750) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/19] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 0.8623 (0.6409) acc_x 81.2500 (85.0000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/19] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.3440 (0.6362) acc_x 93.7500 (83.5417) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.3837, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 620
clean true:589
clean false:31
clean_rate:0.95
noisy true:456
noisy false:540
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 996
epoch [158/200] batch [5/19] time 0.186 (0.188) data 0.108 (0.111) loss_x loss_x 0.1980 (0.4444) acc_x 96.8750 (88.7500) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/19] time 0.186 (0.187) data 0.108 (0.110) loss_x loss_x 0.8320 (0.5445) acc_x 78.1250 (84.6875) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [15/19] time 0.162 (0.182) data 0.085 (0.105) loss_x loss_x 0.8057 (0.6062) acc_x 71.8750 (83.1250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 612
clean true:583
clean false:29
clean_rate:0.9526143790849673
noisy true:466
noisy false:538
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1004
epoch [159/200] batch [5/19] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 1.1113 (0.7913) acc_x 78.1250 (82.5000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/19] time 0.160 (0.160) data 0.084 (0.084) loss_x loss_x 0.4321 (0.6260) acc_x 87.5000 (85.9375) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [15/19] time 0.173 (0.165) data 0.097 (0.088) loss_x loss_x 0.6943 (0.5998) acc_x 78.1250 (85.0000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:591
clean false:37
clean_rate:0.9410828025477707
noisy true:464
noisy false:524
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [160/200] batch [5/19] time 0.193 (0.188) data 0.116 (0.111) loss_x loss_x 0.4307 (0.6500) acc_x 90.6250 (84.3750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [10/19] time 0.185 (0.186) data 0.107 (0.109) loss_x loss_x 0.4087 (0.6009) acc_x 87.5000 (84.0625) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/19] time 0.165 (0.183) data 0.087 (0.106) loss_x loss_x 0.7456 (0.6241) acc_x 81.2500 (83.5417) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 541
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 614
clean true:584
clean false:30
clean_rate:0.9511400651465798
noisy true:491
noisy false:511
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1002
epoch [161/200] batch [5/19] time 0.185 (0.192) data 0.107 (0.115) loss_x loss_x 0.6934 (0.5168) acc_x 78.1250 (85.6250) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/19] time 0.185 (0.187) data 0.107 (0.110) loss_x loss_x 0.4470 (0.6084) acc_x 90.6250 (84.0625) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/19] time 0.201 (0.187) data 0.124 (0.110) loss_x loss_x 0.6533 (0.6128) acc_x 84.3750 (83.7500) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.3837, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 620
clean true:587
clean false:33
clean_rate:0.9467741935483871
noisy true:480
noisy false:516
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 996
epoch [162/200] batch [5/19] time 0.179 (0.179) data 0.101 (0.101) loss_x loss_x 0.4595 (0.4446) acc_x 84.3750 (86.2500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/19] time 0.172 (0.176) data 0.095 (0.099) loss_x loss_x 0.5503 (0.4841) acc_x 84.3750 (87.1875) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/19] time 0.179 (0.179) data 0.102 (0.101) loss_x loss_x 0.5718 (0.4922) acc_x 84.3750 (87.2917) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 550
confident_label rate tensor(0.3917, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 633
clean true:602
clean false:31
clean_rate:0.9510268562401264
noisy true:464
noisy false:519
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 983
epoch [163/200] batch [5/19] time 0.162 (0.171) data 0.084 (0.093) loss_x loss_x 0.6162 (0.6058) acc_x 84.3750 (84.3750) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/19] time 0.185 (0.172) data 0.107 (0.094) loss_x loss_x 1.0352 (0.6452) acc_x 78.1250 (83.1250) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/19] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.3684 (0.6593) acc_x 87.5000 (82.2917) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 583
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:573
clean false:36
clean_rate:0.9408866995073891
noisy true:460
noisy false:547
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [164/200] batch [5/19] time 0.166 (0.159) data 0.088 (0.082) loss_x loss_x 0.3701 (0.6709) acc_x 93.7500 (84.3750) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [10/19] time 0.160 (0.162) data 0.082 (0.085) loss_x loss_x 1.1084 (0.5851) acc_x 65.6250 (85.3125) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [15/19] time 0.186 (0.167) data 0.110 (0.090) loss_x loss_x 0.1952 (0.6033) acc_x 96.8750 (84.3750) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 619
clean true:583
clean false:36
clean_rate:0.9418416801292407
noisy true:482
noisy false:515
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 997
epoch [165/200] batch [5/19] time 0.184 (0.179) data 0.106 (0.102) loss_x loss_x 0.9067 (0.6954) acc_x 78.1250 (83.1250) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/19] time 0.187 (0.186) data 0.108 (0.109) loss_x loss_x 0.8950 (0.7664) acc_x 75.0000 (79.6875) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/19] time 0.162 (0.179) data 0.085 (0.102) loss_x loss_x 0.5977 (0.7590) acc_x 84.3750 (80.2083) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 604
clean true:574
clean false:30
clean_rate:0.9503311258278145
noisy true:482
noisy false:530
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1012
epoch [166/200] batch [5/18] time 0.184 (0.182) data 0.106 (0.105) loss_x loss_x 0.9141 (0.5979) acc_x 81.2500 (83.7500) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [10/18] time 0.179 (0.178) data 0.103 (0.101) loss_x loss_x 0.4072 (0.6879) acc_x 84.3750 (81.2500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [15/18] time 0.171 (0.178) data 0.094 (0.101) loss_x loss_x 0.7212 (0.6687) acc_x 90.6250 (82.7083) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 608
clean true:577
clean false:31
clean_rate:0.9490131578947368
noisy true:481
noisy false:527
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1008
epoch [167/200] batch [5/19] time 0.178 (0.166) data 0.101 (0.089) loss_x loss_x 0.5327 (0.6310) acc_x 84.3750 (83.7500) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [10/19] time 0.177 (0.171) data 0.101 (0.094) loss_x loss_x 0.6650 (0.6127) acc_x 90.6250 (84.3750) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [15/19] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 1.0918 (0.6286) acc_x 71.8750 (83.7500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.3868, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 625
clean true:593
clean false:32
clean_rate:0.9488
noisy true:463
noisy false:528
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 991
epoch [168/200] batch [5/19] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.9785 (0.7348) acc_x 71.8750 (80.6250) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/19] time 0.181 (0.185) data 0.103 (0.108) loss_x loss_x 1.0000 (0.6455) acc_x 81.2500 (85.0000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/19] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.7646 (0.6485) acc_x 84.3750 (84.7917) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 612
clean true:582
clean false:30
clean_rate:0.9509803921568627
noisy true:492
noisy false:512
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1004
epoch [169/200] batch [5/19] time 0.181 (0.170) data 0.104 (0.092) loss_x loss_x 0.4814 (0.6423) acc_x 81.2500 (80.6250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/19] time 0.159 (0.166) data 0.082 (0.089) loss_x loss_x 0.7603 (0.6062) acc_x 81.2500 (83.4375) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/19] time 0.160 (0.164) data 0.083 (0.087) loss_x loss_x 1.1504 (0.6234) acc_x 71.8750 (83.9583) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 556
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 626
clean true:591
clean false:35
clean_rate:0.9440894568690096
noisy true:469
noisy false:521
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 990
epoch [170/200] batch [5/19] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.5117 (0.5706) acc_x 87.5000 (87.5000) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/19] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.4121 (0.6730) acc_x 87.5000 (86.5625) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/19] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.7446 (0.6761) acc_x 87.5000 (86.0417) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:583
clean false:32
clean_rate:0.9479674796747968
noisy true:462
noisy false:539
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [171/200] batch [5/19] time 0.192 (0.185) data 0.116 (0.108) loss_x loss_x 0.4773 (0.5540) acc_x 90.6250 (85.0000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/19] time 0.162 (0.184) data 0.085 (0.107) loss_x loss_x 0.9287 (0.6176) acc_x 78.1250 (84.0625) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [15/19] time 0.186 (0.182) data 0.109 (0.106) loss_x loss_x 0.6284 (0.6213) acc_x 78.1250 (83.7500) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3861, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 624
clean true:595
clean false:29
clean_rate:0.9535256410256411
noisy true:470
noisy false:522
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 992
epoch [172/200] batch [5/19] time 0.166 (0.193) data 0.089 (0.116) loss_x loss_x 0.6899 (0.6448) acc_x 84.3750 (85.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/19] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.2629 (0.5085) acc_x 93.7500 (88.4375) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/19] time 0.174 (0.184) data 0.096 (0.106) loss_x loss_x 0.4795 (0.5209) acc_x 87.5000 (88.1250) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:580
clean false:29
clean_rate:0.9523809523809523
noisy true:493
noisy false:514
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [173/200] batch [5/19] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.8789 (0.5845) acc_x 84.3750 (87.5000) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/19] time 0.172 (0.173) data 0.094 (0.096) loss_x loss_x 0.3047 (0.5731) acc_x 93.7500 (86.2500) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/19] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.5283 (0.5729) acc_x 87.5000 (86.2500) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.3880, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 627
clean true:594
clean false:33
clean_rate:0.9473684210526315
noisy true:474
noisy false:515
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 989
epoch [174/200] batch [5/19] time 0.194 (0.201) data 0.118 (0.125) loss_x loss_x 0.4360 (0.5010) acc_x 90.6250 (88.7500) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/19] time 0.186 (0.195) data 0.110 (0.118) loss_x loss_x 0.8887 (0.5560) acc_x 87.5000 (86.5625) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [15/19] time 0.182 (0.191) data 0.105 (0.115) loss_x loss_x 0.7729 (0.5603) acc_x 84.3750 (86.4583) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:585
clean false:28
clean_rate:0.9543230016313213
noisy true:450
noisy false:553
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [175/200] batch [5/19] time 0.173 (0.188) data 0.096 (0.110) loss_x loss_x 0.6953 (0.6910) acc_x 81.2500 (81.2500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/19] time 0.192 (0.184) data 0.116 (0.107) loss_x loss_x 0.2700 (0.5963) acc_x 96.8750 (84.3750) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [15/19] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.8027 (0.5953) acc_x 78.1250 (84.1667) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.3929, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 635
clean true:603
clean false:32
clean_rate:0.9496062992125984
noisy true:468
noisy false:513
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 981
epoch [176/200] batch [5/19] time 0.158 (0.169) data 0.082 (0.092) loss_x loss_x 0.7363 (0.5677) acc_x 71.8750 (85.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/19] time 0.193 (0.178) data 0.114 (0.101) loss_x loss_x 0.5181 (0.6329) acc_x 84.3750 (84.6875) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [15/19] time 0.167 (0.179) data 0.090 (0.102) loss_x loss_x 0.4688 (0.5968) acc_x 87.5000 (85.6250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 576
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 614
clean true:583
clean false:31
clean_rate:0.9495114006514658
noisy true:457
noisy false:545
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1002
epoch [177/200] batch [5/19] time 0.183 (0.171) data 0.106 (0.094) loss_x loss_x 1.1641 (0.7260) acc_x 81.2500 (85.6250) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/19] time 0.173 (0.172) data 0.095 (0.095) loss_x loss_x 0.4729 (0.7207) acc_x 87.5000 (83.7500) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/19] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.7241 (0.6736) acc_x 81.2500 (84.1667) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 573
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:581
clean false:32
clean_rate:0.9477977161500816
noisy true:462
noisy false:541
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [178/200] batch [5/19] time 0.192 (0.185) data 0.115 (0.108) loss_x loss_x 0.3052 (0.5986) acc_x 90.6250 (83.7500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/19] time 0.160 (0.176) data 0.083 (0.098) loss_x loss_x 0.6528 (0.6136) acc_x 78.1250 (83.1250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/19] time 0.162 (0.171) data 0.085 (0.094) loss_x loss_x 0.6094 (0.6772) acc_x 84.3750 (82.0833) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.3868, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 625
clean true:591
clean false:34
clean_rate:0.9456
noisy true:464
noisy false:527
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 991
epoch [179/200] batch [5/19] time 0.173 (0.189) data 0.097 (0.112) loss_x loss_x 0.7695 (0.6630) acc_x 81.2500 (84.3750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/19] time 0.189 (0.188) data 0.112 (0.111) loss_x loss_x 0.2283 (0.6372) acc_x 100.0000 (84.6875) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/19] time 0.169 (0.183) data 0.092 (0.106) loss_x loss_x 0.4055 (0.6145) acc_x 87.5000 (85.0000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.3868, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 625
clean true:593
clean false:32
clean_rate:0.9488
noisy true:456
noisy false:535
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 991
epoch [180/200] batch [5/19] time 0.193 (0.187) data 0.117 (0.111) loss_x loss_x 0.7056 (0.5046) acc_x 81.2500 (87.5000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/19] time 0.191 (0.187) data 0.114 (0.110) loss_x loss_x 1.0195 (0.6188) acc_x 78.1250 (83.4375) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [15/19] time 0.224 (0.190) data 0.148 (0.113) loss_x loss_x 0.5005 (0.6224) acc_x 81.2500 (82.9167) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 626
clean true:590
clean false:36
clean_rate:0.9424920127795527
noisy true:469
noisy false:521
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 990
epoch [181/200] batch [5/19] time 0.186 (0.173) data 0.109 (0.096) loss_x loss_x 0.5928 (0.4588) acc_x 87.5000 (89.3750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/19] time 0.165 (0.177) data 0.088 (0.100) loss_x loss_x 0.4602 (0.5024) acc_x 90.6250 (88.4375) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/19] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 0.6533 (0.5467) acc_x 84.3750 (86.2500) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 614
clean true:572
clean false:42
clean_rate:0.9315960912052117
noisy true:455
noisy false:547
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1002
epoch [182/200] batch [5/19] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.7847 (0.6292) acc_x 81.2500 (82.5000) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/19] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.9067 (0.6668) acc_x 75.0000 (82.8125) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/19] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 0.4358 (0.6361) acc_x 87.5000 (82.9167) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.3868, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 625
clean true:597
clean false:28
clean_rate:0.9552
noisy true:477
noisy false:514
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 991
epoch [183/200] batch [5/19] time 0.158 (0.179) data 0.081 (0.102) loss_x loss_x 0.3413 (0.4713) acc_x 90.6250 (86.8750) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/19] time 0.171 (0.170) data 0.094 (0.093) loss_x loss_x 0.9805 (0.5046) acc_x 81.2500 (87.5000) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [15/19] time 0.182 (0.172) data 0.105 (0.095) loss_x loss_x 0.5728 (0.5135) acc_x 90.6250 (87.9167) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3905, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 631
clean true:597
clean false:34
clean_rate:0.9461172741679873
noisy true:468
noisy false:517
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 985
epoch [184/200] batch [5/19] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.5757 (0.6229) acc_x 81.2500 (82.5000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/19] time 0.162 (0.178) data 0.084 (0.101) loss_x loss_x 0.7563 (0.6783) acc_x 81.2500 (80.9375) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/19] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.6060 (0.6510) acc_x 81.2500 (81.4583) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 540
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:582
clean false:33
clean_rate:0.9463414634146341
noisy true:494
noisy false:507
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [185/200] batch [5/19] time 0.161 (0.160) data 0.083 (0.083) loss_x loss_x 0.2432 (0.4888) acc_x 90.6250 (86.8750) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [10/19] time 0.176 (0.172) data 0.098 (0.095) loss_x loss_x 0.5522 (0.5083) acc_x 87.5000 (86.8750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/19] time 0.172 (0.171) data 0.096 (0.094) loss_x loss_x 0.8047 (0.6162) acc_x 84.3750 (84.7917) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.3812, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 616
clean true:584
clean false:32
clean_rate:0.948051948051948
noisy true:466
noisy false:534
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1000
epoch [186/200] batch [5/19] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 1.1338 (0.6013) acc_x 71.8750 (85.6250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/19] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8203 (0.6850) acc_x 84.3750 (84.6875) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/19] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6875 (0.6513) acc_x 90.6250 (85.6250) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 610
clean true:576
clean false:34
clean_rate:0.9442622950819672
noisy true:473
noisy false:533
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1006
epoch [187/200] batch [5/19] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.7236 (0.6759) acc_x 78.1250 (83.1250) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/19] time 0.171 (0.183) data 0.093 (0.105) loss_x loss_x 0.3479 (0.6096) acc_x 87.5000 (85.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/19] time 0.182 (0.182) data 0.104 (0.104) loss_x loss_x 0.7031 (0.5873) acc_x 81.2500 (84.5833) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:589
clean false:28
clean_rate:0.9546191247974068
noisy true:482
noisy false:517
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [188/200] batch [5/19] time 0.157 (0.160) data 0.080 (0.083) loss_x loss_x 0.6943 (0.5888) acc_x 90.6250 (86.8750) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/19] time 0.168 (0.160) data 0.091 (0.083) loss_x loss_x 0.3105 (0.5136) acc_x 93.7500 (87.5000) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/19] time 0.161 (0.160) data 0.084 (0.084) loss_x loss_x 0.3860 (0.5633) acc_x 93.7500 (86.8750) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 550
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 614
clean true:586
clean false:28
clean_rate:0.9543973941368078
noisy true:480
noisy false:522
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1002
epoch [189/200] batch [5/19] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 0.6572 (0.6099) acc_x 78.1250 (83.7500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/19] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.6558 (0.5486) acc_x 87.5000 (86.2500) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/19] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.5493 (0.5625) acc_x 84.3750 (86.4583) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:571
clean false:38
clean_rate:0.9376026272577996
noisy true:464
noisy false:543
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [190/200] batch [5/19] time 0.192 (0.181) data 0.115 (0.104) loss_x loss_x 0.7510 (0.6888) acc_x 78.1250 (83.1250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/19] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6768 (0.6358) acc_x 81.2500 (84.0625) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/19] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.7178 (0.6341) acc_x 78.1250 (83.7500) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.3899, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 630
clean true:601
clean false:29
clean_rate:0.953968253968254
noisy true:456
noisy false:530
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 986
epoch [191/200] batch [5/19] time 0.183 (0.200) data 0.106 (0.123) loss_x loss_x 0.8145 (0.5959) acc_x 78.1250 (85.0000) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/19] time 0.184 (0.192) data 0.108 (0.116) loss_x loss_x 0.3591 (0.5787) acc_x 93.7500 (85.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/19] time 0.186 (0.192) data 0.110 (0.115) loss_x loss_x 0.4351 (0.5662) acc_x 87.5000 (86.2500) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:582
clean false:35
clean_rate:0.9432739059967585
noisy true:467
noisy false:532
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [192/200] batch [5/19] time 0.162 (0.172) data 0.085 (0.095) loss_x loss_x 0.4558 (0.4517) acc_x 90.6250 (90.6250) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/19] time 0.187 (0.174) data 0.109 (0.097) loss_x loss_x 0.5938 (0.5059) acc_x 84.3750 (88.1250) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/19] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.9775 (0.5265) acc_x 81.2500 (87.9167) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 626
clean true:589
clean false:37
clean_rate:0.9408945686900958
noisy true:483
noisy false:507
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 990
epoch [193/200] batch [5/19] time 0.160 (0.160) data 0.082 (0.083) loss_x loss_x 0.5088 (0.5331) acc_x 81.2500 (83.7500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/19] time 0.163 (0.160) data 0.086 (0.083) loss_x loss_x 0.3967 (0.4738) acc_x 93.7500 (85.9375) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/19] time 0.166 (0.162) data 0.089 (0.084) loss_x loss_x 0.7256 (0.5522) acc_x 81.2500 (85.2083) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 567
confident_label rate tensor(0.3880, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 627
clean true:589
clean false:38
clean_rate:0.9393939393939394
noisy true:460
noisy false:529
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 989
epoch [194/200] batch [5/19] time 0.233 (0.195) data 0.156 (0.117) loss_x loss_x 0.6489 (0.6682) acc_x 84.3750 (85.0000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/19] time 0.185 (0.191) data 0.109 (0.114) loss_x loss_x 0.6440 (0.6278) acc_x 84.3750 (82.8125) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/19] time 0.160 (0.182) data 0.083 (0.105) loss_x loss_x 0.5610 (0.6176) acc_x 90.6250 (83.9583) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:565
clean false:38
clean_rate:0.9369817578772802
noisy true:463
noisy false:550
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [195/200] batch [5/18] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.4187 (0.5920) acc_x 93.7500 (86.8750) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/18] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.8960 (0.5911) acc_x 75.0000 (85.9375) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/18] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.6943 (0.6258) acc_x 90.6250 (85.0000) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.3806, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 615
clean true:581
clean false:34
clean_rate:0.9447154471544715
noisy true:476
noisy false:525
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1001
epoch [196/200] batch [5/19] time 0.160 (0.158) data 0.083 (0.081) loss_x loss_x 0.6890 (0.4797) acc_x 84.3750 (88.7500) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/19] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.5166 (0.5220) acc_x 87.5000 (85.9375) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/19] time 0.184 (0.165) data 0.107 (0.088) loss_x loss_x 0.6016 (0.5376) acc_x 84.3750 (86.2500) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.3837, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 620
clean true:588
clean false:32
clean_rate:0.9483870967741935
noisy true:453
noisy false:543
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 996
epoch [197/200] batch [5/19] time 0.159 (0.158) data 0.082 (0.081) loss_x loss_x 0.4194 (0.4853) acc_x 87.5000 (86.8750) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/19] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.3320 (0.5161) acc_x 87.5000 (86.8750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/19] time 0.158 (0.158) data 0.080 (0.081) loss_x loss_x 0.5503 (0.5541) acc_x 84.3750 (86.4583) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3849, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 622
clean true:587
clean false:35
clean_rate:0.9437299035369775
noisy true:478
noisy false:516
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 994
epoch [198/200] batch [5/19] time 0.157 (0.159) data 0.081 (0.082) loss_x loss_x 0.9678 (0.6568) acc_x 81.2500 (84.3750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/19] time 0.182 (0.161) data 0.105 (0.084) loss_x loss_x 1.0020 (0.6234) acc_x 78.1250 (85.0000) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/19] time 0.183 (0.168) data 0.106 (0.091) loss_x loss_x 0.5103 (0.6240) acc_x 84.3750 (84.1667) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:571
clean false:34
clean_rate:0.943801652892562
noisy true:454
noisy false:557
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [199/200] batch [5/18] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.8335 (0.6636) acc_x 75.0000 (81.8750) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/18] time 0.169 (0.163) data 0.091 (0.085) loss_x loss_x 0.4089 (0.6367) acc_x 87.5000 (82.1875) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/18] time 0.158 (0.163) data 0.081 (0.086) loss_x loss_x 0.4082 (0.5989) acc_x 87.5000 (83.7500) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.3855, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 623
clean true:590
clean false:33
clean_rate:0.9470304975922953
noisy true:499
noisy false:494
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 993
epoch [200/200] batch [5/19] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.6504 (0.5417) acc_x 87.5000 (88.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/19] time 0.155 (0.168) data 0.079 (0.091) loss_x loss_x 0.6646 (0.5802) acc_x 81.2500 (85.9375) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/19] time 0.158 (0.165) data 0.081 (0.088) loss_x loss_x 0.2852 (0.5935) acc_x 96.8750 (85.8333) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,609
* accuracy: 69.0%
* error: 31.0%
* macro_f1: 66.6%
Elapsed: 0:39:26
