***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.1343, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 217
clean true:189
clean false:28
clean_rate:0.8709677419354839
noisy true:323
noisy false:1076
after delete: len(clean_dataset) 217
after delete: len(noisy_dataset) 1399
epoch [1/200] batch [5/6] time 0.184 (0.195) data 0.108 (0.098) loss_x loss_x 2.3828 (2.6164) acc_x 53.1250 (47.5000) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1067
confident_label rate tensor(0.1343, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 217
clean true:198
clean false:19
clean_rate:0.9124423963133641
noisy true:351
noisy false:1048
after delete: len(clean_dataset) 217
after delete: len(noisy_dataset) 1399
epoch [2/200] batch [5/6] time 0.170 (0.174) data 0.092 (0.097) loss_x loss_x 1.4336 (1.6764) acc_x 62.5000 (59.3750) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 850
confident_label rate tensor(0.2024, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 327
clean true:308
clean false:19
clean_rate:0.9418960244648318
noisy true:458
noisy false:831
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 1289
epoch [3/200] batch [5/10] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 1.3750 (1.3857) acc_x 78.1250 (68.1250) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [10/10] time 0.202 (0.176) data 0.086 (0.084) loss_x loss_x 1.5459 (1.3874) acc_x 68.7500 (69.0625) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 837
confident_label rate tensor(0.2036, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 329
clean true:305
clean false:24
clean_rate:0.9270516717325228
noisy true:474
noisy false:813
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1287
epoch [4/200] batch [5/10] time 0.258 (0.211) data 0.086 (0.093) loss_x loss_x 1.0918 (1.4031) acc_x 62.5000 (61.8750) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/10] time 0.174 (0.198) data 0.096 (0.101) loss_x loss_x 1.3887 (1.2872) acc_x 62.5000 (65.9375) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 816
confident_label rate tensor(0.2005, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 324
clean true:307
clean false:17
clean_rate:0.9475308641975309
noisy true:493
noisy false:799
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 1292
epoch [5/200] batch [5/10] time 0.206 (0.206) data 0.128 (0.116) loss_x loss_x 1.0596 (1.0016) acc_x 71.8750 (73.7500) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/10] time 0.171 (0.187) data 0.094 (0.104) loss_x loss_x 0.9531 (1.0209) acc_x 71.8750 (74.0625) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 813
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 346
clean true:315
clean false:31
clean_rate:0.9104046242774566
noisy true:488
noisy false:782
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1270
epoch [6/200] batch [5/10] time 0.198 (0.178) data 0.121 (0.101) loss_x loss_x 1.1768 (1.0970) acc_x 68.7500 (69.3750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [10/10] time 0.163 (0.177) data 0.086 (0.100) loss_x loss_x 1.3379 (1.1088) acc_x 71.8750 (70.6250) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 776
confident_label rate tensor(0.2184, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 353
clean true:330
clean false:23
clean_rate:0.9348441926345609
noisy true:510
noisy false:753
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1263
epoch [7/200] batch [5/11] time 0.165 (0.170) data 0.088 (0.094) loss_x loss_x 0.7153 (1.0204) acc_x 81.2500 (72.5000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/11] time 0.159 (0.165) data 0.082 (0.089) loss_x loss_x 0.9111 (1.0535) acc_x 68.7500 (71.5625) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 804
confident_label rate tensor(0.2123, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 343
clean true:317
clean false:26
clean_rate:0.924198250728863
noisy true:495
noisy false:778
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1273
epoch [8/200] batch [5/10] time 0.191 (0.199) data 0.114 (0.094) loss_x loss_x 0.9424 (1.0175) acc_x 68.7500 (71.2500) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [10/10] time 0.188 (0.192) data 0.111 (0.101) loss_x loss_x 1.7422 (1.0800) acc_x 56.2500 (72.1875) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 781
confident_label rate tensor(0.2246, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 363
clean true:336
clean false:27
clean_rate:0.9256198347107438
noisy true:499
noisy false:754
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1253
epoch [9/200] batch [5/11] time 0.190 (0.170) data 0.113 (0.094) loss_x loss_x 1.4102 (1.3145) acc_x 68.7500 (65.6250) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [10/11] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.8228 (1.2366) acc_x 78.1250 (68.1250) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 768
confident_label rate tensor(0.2228, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 360
clean true:334
clean false:26
clean_rate:0.9277777777777778
noisy true:514
noisy false:742
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1256
epoch [10/200] batch [5/11] time 0.216 (0.183) data 0.139 (0.106) loss_x loss_x 1.1494 (1.1596) acc_x 65.6250 (68.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/11] time 0.161 (0.183) data 0.084 (0.105) loss_x loss_x 1.5928 (1.1017) acc_x 62.5000 (70.0000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 770
confident_label rate tensor(0.2296, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 371
clean true:341
clean false:30
clean_rate:0.9191374663072777
noisy true:505
noisy false:740
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1245
epoch [11/200] batch [5/11] time 0.161 (0.173) data 0.084 (0.096) loss_x loss_x 0.5898 (0.8284) acc_x 87.5000 (80.0000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/11] time 0.162 (0.180) data 0.085 (0.089) loss_x loss_x 1.4180 (0.9564) acc_x 65.6250 (77.5000) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 770
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 368
clean true:342
clean false:26
clean_rate:0.9293478260869565
noisy true:504
noisy false:744
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1248
epoch [12/200] batch [5/11] time 0.189 (0.210) data 0.113 (0.110) loss_x loss_x 0.8369 (0.7885) acc_x 84.3750 (81.8750) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [10/11] time 0.184 (0.194) data 0.105 (0.106) loss_x loss_x 1.1904 (0.9243) acc_x 65.6250 (76.5625) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 783
confident_label rate tensor(0.2308, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 373
clean true:340
clean false:33
clean_rate:0.9115281501340483
noisy true:493
noisy false:750
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1243
epoch [13/200] batch [5/11] time 0.164 (0.170) data 0.086 (0.093) loss_x loss_x 1.4707 (1.0718) acc_x 62.5000 (72.5000) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [10/11] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.4722 (0.8878) acc_x 87.5000 (76.8750) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 755
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:341
clean false:33
clean_rate:0.9117647058823529
noisy true:520
noisy false:722
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [14/200] batch [5/11] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 1.0264 (0.9425) acc_x 65.6250 (75.6250) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/11] time 0.191 (0.182) data 0.114 (0.105) loss_x loss_x 0.8818 (0.9946) acc_x 71.8750 (75.9375) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 755
confident_label rate tensor(0.2376, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 384
clean true:351
clean false:33
clean_rate:0.9140625
noisy true:510
noisy false:722
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1232
epoch [15/200] batch [5/12] time 0.182 (0.170) data 0.103 (0.093) loss_x loss_x 1.0508 (0.9827) acc_x 78.1250 (76.8750) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [10/12] time 0.269 (0.177) data 0.083 (0.089) loss_x loss_x 0.9663 (1.0045) acc_x 84.3750 (77.8125) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 766
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:340
clean false:34
clean_rate:0.9090909090909091
noisy true:510
noisy false:732
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [16/200] batch [5/11] time 0.174 (0.183) data 0.097 (0.106) loss_x loss_x 0.9229 (1.1016) acc_x 75.0000 (73.7500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [10/11] time 0.179 (0.182) data 0.100 (0.105) loss_x loss_x 0.9590 (1.0800) acc_x 71.8750 (73.1250) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 759
confident_label rate tensor(0.2351, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 380
clean true:350
clean false:30
clean_rate:0.9210526315789473
noisy true:507
noisy false:729
after delete: len(clean_dataset) 380
after delete: len(noisy_dataset) 1236
epoch [17/200] batch [5/11] time 0.183 (0.214) data 0.106 (0.107) loss_x loss_x 1.0322 (1.1123) acc_x 71.8750 (72.5000) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [10/11] time 0.193 (0.195) data 0.115 (0.103) loss_x loss_x 1.0205 (1.0563) acc_x 75.0000 (73.4375) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 758
confident_label rate tensor(0.2271, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 367
clean true:338
clean false:29
clean_rate:0.9209809264305178
noisy true:520
noisy false:729
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1249
epoch [18/200] batch [5/11] time 0.186 (0.193) data 0.109 (0.115) loss_x loss_x 1.0928 (1.0537) acc_x 68.7500 (71.8750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/11] time 0.169 (0.185) data 0.092 (0.108) loss_x loss_x 0.6606 (0.9575) acc_x 78.1250 (74.6875) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 751
confident_label rate tensor(0.2382, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 385
clean true:352
clean false:33
clean_rate:0.9142857142857143
noisy true:513
noisy false:718
after delete: len(clean_dataset) 385
after delete: len(noisy_dataset) 1231
epoch [19/200] batch [5/12] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.6221 (0.7222) acc_x 81.2500 (78.1250) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/12] time 0.179 (0.173) data 0.102 (0.096) loss_x loss_x 0.8247 (0.8386) acc_x 75.0000 (76.2500) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 728
confident_label rate tensor(0.2345, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 379
clean true:348
clean false:31
clean_rate:0.9182058047493403
noisy true:540
noisy false:697
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1237
epoch [20/200] batch [5/11] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.8335 (0.8583) acc_x 84.3750 (73.7500) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [10/11] time 0.164 (0.159) data 0.087 (0.083) loss_x loss_x 0.6729 (0.7907) acc_x 81.2500 (77.1875) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 729
confident_label rate tensor(0.2481, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 401
clean true:365
clean false:36
clean_rate:0.9102244389027432
noisy true:522
noisy false:693
after delete: len(clean_dataset) 401
after delete: len(noisy_dataset) 1215
epoch [21/200] batch [5/12] time 0.184 (0.174) data 0.107 (0.097) loss_x loss_x 0.9351 (0.8476) acc_x 68.7500 (76.8750) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/12] time 0.198 (0.178) data 0.121 (0.102) loss_x loss_x 1.2021 (1.0917) acc_x 65.6250 (72.5000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 743
confident_label rate tensor(0.2389, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 386
clean true:355
clean false:31
clean_rate:0.9196891191709845
noisy true:518
noisy false:712
after delete: len(clean_dataset) 386
after delete: len(noisy_dataset) 1230
epoch [22/200] batch [5/12] time 0.186 (0.176) data 0.110 (0.099) loss_x loss_x 0.6685 (0.8292) acc_x 84.3750 (79.3750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/12] time 0.179 (0.177) data 0.102 (0.100) loss_x loss_x 0.7476 (0.8315) acc_x 78.1250 (78.7500) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 758
confident_label rate tensor(0.2327, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 376
clean true:342
clean false:34
clean_rate:0.9095744680851063
noisy true:516
noisy false:724
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1240
epoch [23/200] batch [5/11] time 0.161 (0.160) data 0.084 (0.084) loss_x loss_x 0.2939 (0.8577) acc_x 93.7500 (80.0000) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [10/11] time 0.157 (0.165) data 0.081 (0.088) loss_x loss_x 0.7886 (0.9253) acc_x 81.2500 (77.5000) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 737
confident_label rate tensor(0.2457, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 397
clean true:363
clean false:34
clean_rate:0.9143576826196473
noisy true:516
noisy false:703
after delete: len(clean_dataset) 397
after delete: len(noisy_dataset) 1219
epoch [24/200] batch [5/12] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 1.0215 (0.8792) acc_x 75.0000 (76.8750) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/12] time 0.175 (0.200) data 0.097 (0.108) loss_x loss_x 0.7056 (0.8948) acc_x 81.2500 (75.0000) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 748
confident_label rate tensor(0.2481, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 401
clean true:367
clean false:34
clean_rate:0.9152119700748129
noisy true:501
noisy false:714
after delete: len(clean_dataset) 401
after delete: len(noisy_dataset) 1215
epoch [25/200] batch [5/12] time 0.177 (0.184) data 0.100 (0.107) loss_x loss_x 1.0215 (1.0296) acc_x 65.6250 (71.8750) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [10/12] time 0.182 (0.198) data 0.105 (0.103) loss_x loss_x 0.9204 (0.9883) acc_x 68.7500 (70.9375) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 743
confident_label rate tensor(0.2469, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 399
clean true:360
clean false:39
clean_rate:0.9022556390977443
noisy true:513
noisy false:704
after delete: len(clean_dataset) 399
after delete: len(noisy_dataset) 1217
epoch [26/200] batch [5/12] time 0.158 (0.171) data 0.081 (0.094) loss_x loss_x 0.6685 (0.9303) acc_x 84.3750 (75.6250) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/12] time 0.187 (0.177) data 0.109 (0.099) loss_x loss_x 0.8066 (0.9510) acc_x 81.2500 (75.6250) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 738
confident_label rate tensor(0.2438, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 394
clean true:350
clean false:44
clean_rate:0.8883248730964467
noisy true:528
noisy false:694
after delete: len(clean_dataset) 394
after delete: len(noisy_dataset) 1222
epoch [27/200] batch [5/12] time 0.160 (0.170) data 0.084 (0.093) loss_x loss_x 0.7183 (0.7603) acc_x 81.2500 (81.2500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/12] time 0.158 (0.165) data 0.081 (0.088) loss_x loss_x 0.5542 (0.8437) acc_x 87.5000 (77.8125) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 712
confident_label rate tensor(0.2562, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 414
clean true:378
clean false:36
clean_rate:0.9130434782608695
noisy true:526
noisy false:676
after delete: len(clean_dataset) 414
after delete: len(noisy_dataset) 1202
epoch [28/200] batch [5/12] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.8428 (1.0365) acc_x 75.0000 (73.7500) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [10/12] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 1.0195 (0.9014) acc_x 81.2500 (77.8125) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 702
confident_label rate tensor(0.2574, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 416
clean true:377
clean false:39
clean_rate:0.90625
noisy true:537
noisy false:663
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1200
epoch [29/200] batch [5/13] time 0.178 (0.185) data 0.101 (0.108) loss_x loss_x 1.1865 (0.8914) acc_x 65.6250 (78.7500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/13] time 0.295 (0.198) data 0.109 (0.107) loss_x loss_x 0.8735 (0.8693) acc_x 71.8750 (77.8125) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 736
confident_label rate tensor(0.2475, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 400
clean true:358
clean false:42
clean_rate:0.895
noisy true:522
noisy false:694
after delete: len(clean_dataset) 400
after delete: len(noisy_dataset) 1216
epoch [30/200] batch [5/12] time 0.237 (0.185) data 0.104 (0.097) loss_x loss_x 1.1826 (0.8464) acc_x 75.0000 (82.5000) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [10/12] time 0.164 (0.186) data 0.087 (0.098) loss_x loss_x 0.7749 (0.9042) acc_x 78.1250 (78.7500) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 714
confident_label rate tensor(0.2457, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 397
clean true:362
clean false:35
clean_rate:0.9118387909319899
noisy true:540
noisy false:679
after delete: len(clean_dataset) 397
after delete: len(noisy_dataset) 1219
epoch [31/200] batch [5/12] time 0.304 (0.209) data 0.115 (0.110) loss_x loss_x 0.8340 (0.7350) acc_x 78.1250 (81.2500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/12] time 0.166 (0.193) data 0.089 (0.105) loss_x loss_x 0.8228 (0.7451) acc_x 75.0000 (79.6875) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 733
confident_label rate tensor(0.2444, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 395
clean true:356
clean false:39
clean_rate:0.9012658227848102
noisy true:527
noisy false:694
after delete: len(clean_dataset) 395
after delete: len(noisy_dataset) 1221
epoch [32/200] batch [5/12] time 0.159 (0.163) data 0.081 (0.085) loss_x loss_x 0.9922 (0.8829) acc_x 68.7500 (78.7500) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/12] time 0.183 (0.168) data 0.107 (0.091) loss_x loss_x 0.9092 (0.8796) acc_x 78.1250 (79.6875) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 706
confident_label rate tensor(0.2574, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 416
clean true:378
clean false:38
clean_rate:0.9086538461538461
noisy true:532
noisy false:668
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1200
epoch [33/200] batch [5/13] time 0.185 (0.224) data 0.109 (0.104) loss_x loss_x 0.5552 (0.8231) acc_x 87.5000 (78.1250) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [10/13] time 0.197 (0.204) data 0.120 (0.106) loss_x loss_x 0.5454 (0.9011) acc_x 90.6250 (78.4375) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 717
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 403
clean true:366
clean false:37
clean_rate:0.9081885856079405
noisy true:533
noisy false:680
after delete: len(clean_dataset) 403
after delete: len(noisy_dataset) 1213
epoch [34/200] batch [5/12] time 0.235 (0.191) data 0.158 (0.114) loss_x loss_x 1.3477 (0.9044) acc_x 65.6250 (75.6250) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/12] time 0.171 (0.184) data 0.095 (0.107) loss_x loss_x 1.2979 (0.9148) acc_x 71.8750 (74.6875) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 717
confident_label rate tensor(0.2488, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 402
clean true:363
clean false:39
clean_rate:0.9029850746268657
noisy true:536
noisy false:678
after delete: len(clean_dataset) 402
after delete: len(noisy_dataset) 1214
epoch [35/200] batch [5/12] time 0.186 (0.176) data 0.109 (0.099) loss_x loss_x 1.0049 (0.8317) acc_x 78.1250 (76.8750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/12] time 0.163 (0.171) data 0.086 (0.095) loss_x loss_x 1.3906 (1.0117) acc_x 65.6250 (74.6875) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 687
confident_label rate tensor(0.2568, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 415
clean true:375
clean false:40
clean_rate:0.9036144578313253
noisy true:554
noisy false:647
after delete: len(clean_dataset) 415
after delete: len(noisy_dataset) 1201
epoch [36/200] batch [5/12] time 0.167 (0.160) data 0.089 (0.083) loss_x loss_x 0.5801 (0.9000) acc_x 87.5000 (78.7500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [10/12] time 0.164 (0.164) data 0.087 (0.087) loss_x loss_x 0.6719 (0.8248) acc_x 81.2500 (79.3750) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 695
confident_label rate tensor(0.2574, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 416
clean true:380
clean false:36
clean_rate:0.9134615384615384
noisy true:541
noisy false:659
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1200
epoch [37/200] batch [5/13] time 0.169 (0.178) data 0.092 (0.101) loss_x loss_x 0.4958 (0.8049) acc_x 84.3750 (76.8750) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [10/13] time 0.172 (0.170) data 0.095 (0.093) loss_x loss_x 1.1436 (0.8778) acc_x 65.6250 (74.0625) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 706
confident_label rate tensor(0.2574, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 416
clean true:375
clean false:41
clean_rate:0.9014423076923077
noisy true:535
noisy false:665
after delete: len(clean_dataset) 416
after delete: len(noisy_dataset) 1200
epoch [38/200] batch [5/13] time 0.165 (0.162) data 0.088 (0.085) loss_x loss_x 0.7437 (0.7553) acc_x 81.2500 (83.1250) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [10/13] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.4448 (0.7073) acc_x 90.6250 (83.7500) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 719
confident_label rate tensor(0.2556, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 413
clean true:372
clean false:41
clean_rate:0.9007263922518159
noisy true:525
noisy false:678
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1203
epoch [39/200] batch [5/12] time 0.200 (0.182) data 0.123 (0.105) loss_x loss_x 0.5610 (0.6906) acc_x 90.6250 (84.3750) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/12] time 0.162 (0.176) data 0.086 (0.099) loss_x loss_x 0.6670 (0.6767) acc_x 81.2500 (83.7500) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.2630, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 425
clean true:387
clean false:38
clean_rate:0.9105882352941177
noisy true:547
noisy false:644
after delete: len(clean_dataset) 425
after delete: len(noisy_dataset) 1191
epoch [40/200] batch [5/13] time 0.159 (0.179) data 0.082 (0.102) loss_x loss_x 1.2617 (1.0933) acc_x 68.7500 (73.7500) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [10/13] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.9038 (0.9587) acc_x 78.1250 (76.2500) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.2605, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 421
clean true:381
clean false:40
clean_rate:0.9049881235154394
noisy true:545
noisy false:650
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1195
epoch [41/200] batch [5/13] time 0.160 (0.187) data 0.083 (0.109) loss_x loss_x 0.6953 (0.9896) acc_x 84.3750 (79.3750) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [10/13] time 0.174 (0.182) data 0.098 (0.105) loss_x loss_x 0.7910 (0.9290) acc_x 81.2500 (79.6875) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.2636, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 426
clean true:384
clean false:42
clean_rate:0.9014084507042254
noisy true:547
noisy false:643
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1190
epoch [42/200] batch [5/13] time 0.192 (0.191) data 0.086 (0.087) loss_x loss_x 1.2314 (1.0868) acc_x 75.0000 (75.0000) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/13] time 0.164 (0.181) data 0.087 (0.091) loss_x loss_x 1.0742 (0.9592) acc_x 71.8750 (75.3125) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 691
confident_label rate tensor(0.2556, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 413
clean true:370
clean false:43
clean_rate:0.8958837772397095
noisy true:555
noisy false:648
after delete: len(clean_dataset) 413
after delete: len(noisy_dataset) 1203
epoch [43/200] batch [5/12] time 0.168 (0.187) data 0.091 (0.110) loss_x loss_x 0.4724 (0.8158) acc_x 84.3750 (75.0000) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/12] time 0.253 (0.207) data 0.107 (0.113) loss_x loss_x 0.6978 (0.7024) acc_x 81.2500 (80.0000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 714
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 405
clean true:365
clean false:40
clean_rate:0.9012345679012346
noisy true:537
noisy false:674
after delete: len(clean_dataset) 405
after delete: len(noisy_dataset) 1211
epoch [44/200] batch [5/12] time 0.177 (0.172) data 0.101 (0.095) loss_x loss_x 0.5903 (0.5681) acc_x 78.1250 (85.6250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/12] time 0.184 (0.178) data 0.106 (0.101) loss_x loss_x 0.8037 (0.6002) acc_x 78.1250 (84.3750) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 681
confident_label rate tensor(0.2611, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 422
clean true:384
clean false:38
clean_rate:0.909952606635071
noisy true:551
noisy false:643
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1194
epoch [45/200] batch [5/13] time 0.175 (0.174) data 0.098 (0.097) loss_x loss_x 0.6855 (0.8534) acc_x 81.2500 (76.8750) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/13] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.8286 (0.9176) acc_x 81.2500 (77.5000) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 694
confident_label rate tensor(0.2673, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 432
clean true:391
clean false:41
clean_rate:0.9050925925925926
noisy true:531
noisy false:653
after delete: len(clean_dataset) 432
after delete: len(noisy_dataset) 1184
epoch [46/200] batch [5/13] time 0.161 (0.160) data 0.084 (0.082) loss_x loss_x 0.2444 (0.6566) acc_x 90.6250 (83.1250) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/13] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.6777 (0.7650) acc_x 81.2500 (80.3125) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 687
confident_label rate tensor(0.2698, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 436
clean true:395
clean false:41
clean_rate:0.9059633027522935
noisy true:534
noisy false:646
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1180
epoch [47/200] batch [5/13] time 0.192 (0.182) data 0.115 (0.105) loss_x loss_x 0.7012 (1.2703) acc_x 81.2500 (70.6250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/13] time 0.265 (0.193) data 0.117 (0.109) loss_x loss_x 1.1387 (1.0338) acc_x 75.0000 (74.6875) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.2667, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 431
clean true:389
clean false:42
clean_rate:0.9025522041763341
noisy true:549
noisy false:636
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1185
epoch [48/200] batch [5/13] time 0.165 (0.180) data 0.088 (0.103) loss_x loss_x 0.5527 (0.6718) acc_x 90.6250 (83.1250) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/13] time 0.237 (0.183) data 0.160 (0.106) loss_x loss_x 1.1406 (0.7599) acc_x 71.8750 (80.9375) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 713
confident_label rate tensor(0.2562, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 414
clean true:368
clean false:46
clean_rate:0.8888888888888888
noisy true:535
noisy false:667
after delete: len(clean_dataset) 414
after delete: len(noisy_dataset) 1202
epoch [49/200] batch [5/12] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.7324 (0.8900) acc_x 90.6250 (78.7500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/12] time 0.169 (0.175) data 0.092 (0.098) loss_x loss_x 0.5562 (0.7634) acc_x 87.5000 (82.1875) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.2667, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 431
clean true:389
clean false:42
clean_rate:0.9025522041763341
noisy true:551
noisy false:634
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1185
epoch [50/200] batch [5/13] time 0.166 (0.176) data 0.088 (0.099) loss_x loss_x 0.7529 (1.0940) acc_x 84.3750 (72.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [10/13] time 0.160 (0.181) data 0.083 (0.092) loss_x loss_x 0.9038 (0.9977) acc_x 78.1250 (74.3750) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 697
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 409
clean true:369
clean false:40
clean_rate:0.902200488997555
noisy true:550
noisy false:657
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1207
epoch [51/200] batch [5/12] time 0.200 (0.193) data 0.122 (0.116) loss_x loss_x 0.5454 (0.6017) acc_x 81.2500 (86.2500) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/12] time 0.171 (0.200) data 0.094 (0.112) loss_x loss_x 0.7944 (0.6926) acc_x 84.3750 (83.7500) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.2636, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 426
clean true:383
clean false:43
clean_rate:0.8990610328638498
noisy true:557
noisy false:633
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1190
epoch [52/200] batch [5/13] time 0.161 (0.188) data 0.083 (0.111) loss_x loss_x 0.4839 (0.8497) acc_x 84.3750 (80.0000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/13] time 0.174 (0.184) data 0.098 (0.106) loss_x loss_x 0.6313 (0.7722) acc_x 81.2500 (81.2500) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.2754, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 445
clean true:398
clean false:47
clean_rate:0.8943820224719101
noisy true:547
noisy false:624
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1171
epoch [53/200] batch [5/13] time 0.177 (0.220) data 0.099 (0.101) loss_x loss_x 0.7935 (0.8057) acc_x 81.2500 (78.1250) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/13] time 0.170 (0.205) data 0.092 (0.107) loss_x loss_x 0.7734 (0.8146) acc_x 75.0000 (77.5000) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 670
confident_label rate tensor(0.2766, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 447
clean true:402
clean false:45
clean_rate:0.8993288590604027
noisy true:544
noisy false:625
after delete: len(clean_dataset) 447
after delete: len(noisy_dataset) 1169
epoch [54/200] batch [5/13] time 0.158 (0.185) data 0.081 (0.109) loss_x loss_x 0.8467 (0.8638) acc_x 75.0000 (76.8750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/13] time 0.291 (0.195) data 0.105 (0.107) loss_x loss_x 0.6416 (0.7945) acc_x 84.3750 (79.3750) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 687
confident_label rate tensor(0.2673, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 432
clean true:388
clean false:44
clean_rate:0.8981481481481481
noisy true:541
noisy false:643
after delete: len(clean_dataset) 432
after delete: len(noisy_dataset) 1184
epoch [55/200] batch [5/13] time 0.162 (0.180) data 0.085 (0.103) loss_x loss_x 0.8984 (0.7895) acc_x 75.0000 (78.1250) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/13] time 0.171 (0.179) data 0.093 (0.102) loss_x loss_x 1.0039 (0.7081) acc_x 71.8750 (80.3125) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.2735, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 442
clean true:401
clean false:41
clean_rate:0.9072398190045249
noisy true:537
noisy false:637
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1174
epoch [56/200] batch [5/13] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 1.3594 (0.8081) acc_x 59.3750 (80.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/13] time 0.173 (0.182) data 0.097 (0.105) loss_x loss_x 1.0195 (0.8662) acc_x 71.8750 (76.8750) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 455
clean true:406
clean false:49
clean_rate:0.8923076923076924
noisy true:539
noisy false:622
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1161
epoch [57/200] batch [5/14] time 0.193 (0.184) data 0.117 (0.107) loss_x loss_x 0.5605 (0.7192) acc_x 84.3750 (78.7500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/14] time 0.295 (0.204) data 0.109 (0.107) loss_x loss_x 0.8804 (0.7814) acc_x 84.3750 (79.6875) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.2834, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 458
clean true:407
clean false:51
clean_rate:0.888646288209607
noisy true:564
noisy false:594
after delete: len(clean_dataset) 458
after delete: len(noisy_dataset) 1158
epoch [58/200] batch [5/14] time 0.159 (0.166) data 0.082 (0.089) loss_x loss_x 0.8257 (0.7839) acc_x 81.2500 (81.8750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/14] time 0.169 (0.165) data 0.093 (0.088) loss_x loss_x 1.2939 (0.8242) acc_x 59.3750 (78.4375) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.2661, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 430
clean true:391
clean false:39
clean_rate:0.9093023255813953
noisy true:547
noisy false:639
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1186
epoch [59/200] batch [5/13] time 0.158 (0.174) data 0.082 (0.097) loss_x loss_x 1.2373 (1.1273) acc_x 71.8750 (73.7500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/13] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.5557 (0.8969) acc_x 87.5000 (78.1250) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 641
confident_label rate tensor(0.2741, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 443
clean true:397
clean false:46
clean_rate:0.8961625282167043
noisy true:578
noisy false:595
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1173
epoch [60/200] batch [5/13] time 0.174 (0.169) data 0.098 (0.092) loss_x loss_x 0.9268 (0.9055) acc_x 87.5000 (79.3750) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/13] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.8013 (0.8036) acc_x 75.0000 (79.0625) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 650
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 453
clean true:413
clean false:40
clean_rate:0.9116997792494481
noisy true:553
noisy false:610
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1163
epoch [61/200] batch [5/14] time 0.163 (0.165) data 0.086 (0.089) loss_x loss_x 0.7925 (0.8024) acc_x 81.2500 (80.0000) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/14] time 0.164 (0.168) data 0.087 (0.091) loss_x loss_x 1.3701 (0.7638) acc_x 71.8750 (82.1875) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 667
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 437
clean true:391
clean false:46
clean_rate:0.8947368421052632
noisy true:558
noisy false:621
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1179
epoch [62/200] batch [5/13] time 0.155 (0.166) data 0.077 (0.089) loss_x loss_x 0.7666 (0.6562) acc_x 84.3750 (81.8750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/13] time 0.164 (0.165) data 0.086 (0.088) loss_x loss_x 0.7554 (0.7023) acc_x 81.2500 (81.2500) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.2847, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 460
clean true:419
clean false:41
clean_rate:0.9108695652173913
noisy true:538
noisy false:618
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1156
epoch [63/200] batch [5/14] time 0.174 (0.174) data 0.098 (0.097) loss_x loss_x 0.5483 (0.8675) acc_x 90.6250 (76.8750) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/14] time 0.182 (0.170) data 0.105 (0.093) loss_x loss_x 0.7744 (0.7889) acc_x 75.0000 (79.3750) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.2667, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 431
clean true:380
clean false:51
clean_rate:0.8816705336426914
noisy true:552
noisy false:633
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1185
epoch [64/200] batch [5/13] time 0.159 (0.179) data 0.082 (0.103) loss_x loss_x 0.6030 (0.7347) acc_x 81.2500 (78.7500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/13] time 0.178 (0.177) data 0.101 (0.101) loss_x loss_x 1.1777 (0.8861) acc_x 71.8750 (76.8750) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:420
clean false:44
clean_rate:0.9051724137931034
noisy true:571
noisy false:581
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [65/200] batch [5/14] time 0.162 (0.174) data 0.084 (0.097) loss_x loss_x 1.0430 (1.0146) acc_x 84.3750 (76.8750) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/14] time 0.174 (0.171) data 0.097 (0.094) loss_x loss_x 0.7412 (0.9437) acc_x 81.2500 (77.8125) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 455
clean true:403
clean false:52
clean_rate:0.8857142857142857
noisy true:561
noisy false:600
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1161
epoch [66/200] batch [5/14] time 0.182 (0.174) data 0.105 (0.098) loss_x loss_x 0.7334 (0.7776) acc_x 75.0000 (79.3750) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/14] time 0.167 (0.171) data 0.091 (0.094) loss_x loss_x 0.8169 (0.7733) acc_x 75.0000 (77.5000) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 653
confident_label rate tensor(0.2735, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 442
clean true:397
clean false:45
clean_rate:0.8981900452488688
noisy true:566
noisy false:608
after delete: len(clean_dataset) 442
after delete: len(noisy_dataset) 1174
epoch [67/200] batch [5/13] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 1.0078 (0.8497) acc_x 81.2500 (79.3750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/13] time 0.182 (0.178) data 0.104 (0.101) loss_x loss_x 0.4412 (0.7958) acc_x 84.3750 (80.0000) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 658
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 453
clean true:407
clean false:46
clean_rate:0.8984547461368654
noisy true:551
noisy false:612
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1163
epoch [68/200] batch [5/14] time 0.166 (0.175) data 0.089 (0.099) loss_x loss_x 0.5215 (0.6756) acc_x 87.5000 (84.3750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/14] time 0.188 (0.190) data 0.109 (0.101) loss_x loss_x 0.5581 (0.6768) acc_x 84.3750 (83.1250) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 660
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 462
clean true:407
clean false:55
clean_rate:0.8809523809523809
noisy true:549
noisy false:605
after delete: len(clean_dataset) 462
after delete: len(noisy_dataset) 1154
epoch [69/200] batch [5/14] time 0.165 (0.180) data 0.088 (0.103) loss_x loss_x 1.1621 (0.7952) acc_x 71.8750 (78.7500) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/14] time 0.166 (0.173) data 0.088 (0.096) loss_x loss_x 0.3191 (0.7456) acc_x 87.5000 (79.3750) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 660
confident_label rate tensor(0.2797, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 452
clean true:401
clean false:51
clean_rate:0.8871681415929203
noisy true:555
noisy false:609
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 1164
epoch [70/200] batch [5/14] time 0.192 (0.187) data 0.116 (0.096) loss_x loss_x 1.0996 (0.7576) acc_x 68.7500 (79.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/14] time 0.191 (0.188) data 0.114 (0.104) loss_x loss_x 0.8237 (0.8129) acc_x 75.0000 (77.1875) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.2859, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 462
clean true:415
clean false:47
clean_rate:0.8982683982683982
noisy true:549
noisy false:605
after delete: len(clean_dataset) 462
after delete: len(noisy_dataset) 1154
epoch [71/200] batch [5/14] time 0.183 (0.176) data 0.105 (0.099) loss_x loss_x 0.4329 (0.7077) acc_x 90.6250 (81.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/14] time 0.219 (0.184) data 0.142 (0.107) loss_x loss_x 0.7129 (0.6836) acc_x 81.2500 (81.2500) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.2797, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 452
clean true:403
clean false:49
clean_rate:0.8915929203539823
noisy true:569
noisy false:595
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 1164
epoch [72/200] batch [5/14] time 0.158 (0.161) data 0.081 (0.084) loss_x loss_x 0.7295 (0.6403) acc_x 81.2500 (85.6250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/14] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.5342 (0.7032) acc_x 87.5000 (83.4375) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:414
clean false:50
clean_rate:0.8922413793103449
noisy true:534
noisy false:618
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [73/200] batch [5/14] time 0.170 (0.169) data 0.093 (0.092) loss_x loss_x 0.4680 (0.7829) acc_x 93.7500 (83.7500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/14] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.5513 (0.7872) acc_x 87.5000 (83.1250) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 629
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:421
clean false:43
clean_rate:0.9073275862068966
noisy true:566
noisy false:586
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [74/200] batch [5/14] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.9038 (0.7362) acc_x 75.0000 (78.1250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/14] time 0.180 (0.185) data 0.103 (0.108) loss_x loss_x 1.0986 (0.7948) acc_x 68.7500 (79.3750) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:416
clean false:48
clean_rate:0.896551724137931
noisy true:548
noisy false:604
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [75/200] batch [5/14] time 0.202 (0.168) data 0.126 (0.091) loss_x loss_x 0.4922 (0.5248) acc_x 90.6250 (86.2500) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/14] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.8853 (0.7253) acc_x 84.3750 (82.5000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 653
confident_label rate tensor(0.2865, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 463
clean true:412
clean false:51
clean_rate:0.8898488120950324
noisy true:551
noisy false:602
after delete: len(clean_dataset) 463
after delete: len(noisy_dataset) 1153
epoch [76/200] batch [5/14] time 0.175 (0.181) data 0.098 (0.103) loss_x loss_x 1.0488 (0.8345) acc_x 71.8750 (80.0000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [10/14] time 0.168 (0.176) data 0.091 (0.100) loss_x loss_x 1.0234 (0.7385) acc_x 75.0000 (80.9375) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.2933, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 474
clean true:429
clean false:45
clean_rate:0.9050632911392406
noisy true:561
noisy false:581
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1142
epoch [77/200] batch [5/14] time 0.193 (0.184) data 0.117 (0.107) loss_x loss_x 0.8335 (0.8949) acc_x 81.2500 (78.1250) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/14] time 0.185 (0.187) data 0.109 (0.110) loss_x loss_x 0.8384 (0.8356) acc_x 81.2500 (79.0625) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.2840, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 459
clean true:412
clean false:47
clean_rate:0.8976034858387799
noisy true:555
noisy false:602
after delete: len(clean_dataset) 459
after delete: len(noisy_dataset) 1157
epoch [78/200] batch [5/14] time 0.174 (0.175) data 0.096 (0.098) loss_x loss_x 0.6475 (0.6667) acc_x 81.2500 (83.1250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/14] time 0.178 (0.175) data 0.101 (0.098) loss_x loss_x 1.5000 (0.7808) acc_x 75.0000 (81.8750) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 657
confident_label rate tensor(0.2933, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 474
clean true:422
clean false:52
clean_rate:0.890295358649789
noisy true:537
noisy false:605
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1142
epoch [79/200] batch [5/14] time 0.180 (0.186) data 0.102 (0.087) loss_x loss_x 1.3242 (0.9469) acc_x 56.2500 (69.3750) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/14] time 0.158 (0.177) data 0.080 (0.089) loss_x loss_x 0.8315 (0.8354) acc_x 78.1250 (75.3125) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 471
clean true:422
clean false:49
clean_rate:0.8959660297239915
noisy true:569
noisy false:576
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1145
epoch [80/200] batch [5/14] time 0.173 (0.174) data 0.095 (0.097) loss_x loss_x 0.6445 (0.7655) acc_x 78.1250 (80.0000) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/14] time 0.217 (0.182) data 0.084 (0.100) loss_x loss_x 0.6787 (0.7369) acc_x 84.3750 (80.6250) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.2791, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 451
clean true:399
clean false:52
clean_rate:0.88470066518847
noisy true:558
noisy false:607
after delete: len(clean_dataset) 451
after delete: len(noisy_dataset) 1165
epoch [81/200] batch [5/14] time 0.224 (0.212) data 0.147 (0.135) loss_x loss_x 0.6641 (0.5940) acc_x 84.3750 (83.7500) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/14] time 0.204 (0.210) data 0.127 (0.133) loss_x loss_x 0.5059 (0.6089) acc_x 90.6250 (83.1250) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.2964, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 479
clean true:422
clean false:57
clean_rate:0.8810020876826722
noisy true:558
noisy false:579
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1137
epoch [82/200] batch [5/14] time 0.193 (0.193) data 0.116 (0.116) loss_x loss_x 0.4397 (0.8239) acc_x 87.5000 (78.1250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/14] time 0.207 (0.191) data 0.130 (0.114) loss_x loss_x 0.8716 (0.8261) acc_x 68.7500 (78.4375) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.2884, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 466
clean true:413
clean false:53
clean_rate:0.8862660944206009
noisy true:551
noisy false:599
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 1150
epoch [83/200] batch [5/14] time 0.191 (0.194) data 0.115 (0.099) loss_x loss_x 0.4976 (0.6167) acc_x 87.5000 (85.0000) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/14] time 0.160 (0.187) data 0.083 (0.101) loss_x loss_x 0.7881 (0.7310) acc_x 75.0000 (80.3125) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:414
clean false:50
clean_rate:0.8922413793103449
noisy true:565
noisy false:587
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [84/200] batch [5/14] time 0.167 (0.173) data 0.090 (0.096) loss_x loss_x 0.9814 (0.9312) acc_x 75.0000 (78.1250) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/14] time 0.176 (0.182) data 0.098 (0.094) loss_x loss_x 1.3916 (0.8714) acc_x 65.6250 (79.6875) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.2995, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 484
clean true:427
clean false:57
clean_rate:0.8822314049586777
noisy true:540
noisy false:592
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1132
epoch [85/200] batch [5/15] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.9878 (0.8499) acc_x 71.8750 (77.5000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/15] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.7607 (0.8586) acc_x 81.2500 (77.5000) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [15/15] time 0.180 (0.176) data 0.104 (0.100) loss_x loss_x 0.3523 (0.8084) acc_x 93.7500 (79.3750) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 648
confident_label rate tensor(0.3007, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 486
clean true:430
clean false:56
clean_rate:0.8847736625514403
noisy true:538
noisy false:592
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1130
epoch [86/200] batch [5/15] time 0.180 (0.174) data 0.104 (0.097) loss_x loss_x 0.3521 (0.4683) acc_x 93.7500 (88.1250) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/15] time 0.205 (0.184) data 0.128 (0.107) loss_x loss_x 0.8232 (0.6023) acc_x 81.2500 (83.1250) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [15/15] time 0.161 (0.179) data 0.084 (0.102) loss_x loss_x 0.8057 (0.6748) acc_x 75.0000 (80.4167) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 476
clean true:424
clean false:52
clean_rate:0.8907563025210085
noisy true:564
noisy false:576
after delete: len(clean_dataset) 476
after delete: len(noisy_dataset) 1140
epoch [87/200] batch [5/14] time 0.184 (0.197) data 0.107 (0.120) loss_x loss_x 0.5200 (0.5977) acc_x 87.5000 (85.0000) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/14] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.8135 (0.6037) acc_x 81.2500 (84.0625) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.2921, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 472
clean true:412
clean false:60
clean_rate:0.8728813559322034
noisy true:559
noisy false:585
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 1144
epoch [88/200] batch [5/14] time 0.173 (0.170) data 0.096 (0.093) loss_x loss_x 0.6846 (0.6842) acc_x 84.3750 (81.8750) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/14] time 0.166 (0.170) data 0.090 (0.093) loss_x loss_x 0.8208 (0.7002) acc_x 78.1250 (81.2500) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.2995, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 484
clean true:429
clean false:55
clean_rate:0.8863636363636364
noisy true:562
noisy false:570
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1132
epoch [89/200] batch [5/15] time 0.171 (0.178) data 0.095 (0.101) loss_x loss_x 0.5776 (0.5689) acc_x 84.3750 (83.7500) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/15] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.9380 (0.6617) acc_x 75.0000 (84.0625) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [15/15] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.8325 (0.7385) acc_x 71.8750 (81.2500) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 632
confident_label rate tensor(0.2927, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 473
clean true:427
clean false:46
clean_rate:0.9027484143763214
noisy true:557
noisy false:586
after delete: len(clean_dataset) 473
after delete: len(noisy_dataset) 1143
epoch [90/200] batch [5/14] time 0.208 (0.197) data 0.130 (0.119) loss_x loss_x 0.4043 (0.6382) acc_x 90.6250 (83.1250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [10/14] time 0.205 (0.198) data 0.128 (0.121) loss_x loss_x 0.8877 (0.7827) acc_x 75.0000 (80.0000) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 655
confident_label rate tensor(0.2908, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 470
clean true:421
clean false:49
clean_rate:0.8957446808510638
noisy true:540
noisy false:606
after delete: len(clean_dataset) 470
after delete: len(noisy_dataset) 1146
epoch [91/200] batch [5/14] time 0.189 (0.194) data 0.111 (0.117) loss_x loss_x 0.4487 (0.6747) acc_x 93.7500 (83.1250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/14] time 0.161 (0.183) data 0.084 (0.106) loss_x loss_x 0.4854 (0.6490) acc_x 90.6250 (83.7500) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 630
confident_label rate tensor(0.2890, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 467
clean true:410
clean false:57
clean_rate:0.8779443254817987
noisy true:576
noisy false:573
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 1149
epoch [92/200] batch [5/14] time 0.162 (0.195) data 0.085 (0.118) loss_x loss_x 0.3376 (0.7947) acc_x 93.7500 (81.8750) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/14] time 0.191 (0.190) data 0.114 (0.113) loss_x loss_x 0.5068 (0.7083) acc_x 87.5000 (82.5000) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 629
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:425
clean false:55
clean_rate:0.8854166666666666
noisy true:562
noisy false:574
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [93/200] batch [5/15] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.4988 (0.6891) acc_x 84.3750 (83.7500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/15] time 0.160 (0.167) data 0.084 (0.091) loss_x loss_x 0.8086 (0.8172) acc_x 84.3750 (79.0625) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [15/15] time 0.164 (0.166) data 0.087 (0.089) loss_x loss_x 0.8276 (0.7658) acc_x 75.0000 (79.7917) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.2976, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 481
clean true:426
clean false:55
clean_rate:0.8856548856548857
noisy true:565
noisy false:570
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1135
epoch [94/200] batch [5/15] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.5737 (0.5358) acc_x 81.2500 (85.6250) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/15] time 0.164 (0.172) data 0.087 (0.095) loss_x loss_x 0.7480 (0.5913) acc_x 81.2500 (84.0625) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [15/15] time 0.175 (0.185) data 0.098 (0.095) loss_x loss_x 1.0654 (0.6327) acc_x 75.0000 (82.2917) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 634
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 476
clean true:421
clean false:55
clean_rate:0.884453781512605
noisy true:561
noisy false:579
after delete: len(clean_dataset) 476
after delete: len(noisy_dataset) 1140
epoch [95/200] batch [5/14] time 0.167 (0.173) data 0.090 (0.096) loss_x loss_x 0.8784 (0.7649) acc_x 75.0000 (79.3750) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/14] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.6548 (0.7151) acc_x 78.1250 (81.2500) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.2995, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 484
clean true:437
clean false:47
clean_rate:0.9028925619834711
noisy true:585
noisy false:547
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1132
epoch [96/200] batch [5/15] time 0.182 (0.163) data 0.105 (0.086) loss_x loss_x 0.9873 (0.6752) acc_x 71.8750 (81.8750) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/15] time 0.182 (0.181) data 0.106 (0.095) loss_x loss_x 0.4585 (0.7160) acc_x 81.2500 (80.0000) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [15/15] time 0.159 (0.182) data 0.081 (0.098) loss_x loss_x 0.6855 (0.7442) acc_x 87.5000 (79.1667) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.3038, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 491
clean true:445
clean false:46
clean_rate:0.9063136456211812
noisy true:550
noisy false:575
after delete: len(clean_dataset) 491
after delete: len(noisy_dataset) 1125
epoch [97/200] batch [5/15] time 0.160 (0.174) data 0.082 (0.097) loss_x loss_x 0.3914 (0.7404) acc_x 87.5000 (80.6250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [10/15] time 0.170 (0.170) data 0.093 (0.093) loss_x loss_x 1.0596 (0.7021) acc_x 78.1250 (81.8750) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [15/15] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.4221 (0.7255) acc_x 90.6250 (82.2917) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.3001, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 485
clean true:429
clean false:56
clean_rate:0.8845360824742268
noisy true:561
noisy false:570
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1131
epoch [98/200] batch [5/15] time 0.168 (0.180) data 0.092 (0.103) loss_x loss_x 0.7314 (0.7146) acc_x 84.3750 (81.2500) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/15] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.5869 (0.7083) acc_x 84.3750 (82.8125) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [15/15] time 0.284 (0.182) data 0.096 (0.098) loss_x loss_x 0.8228 (0.6909) acc_x 81.2500 (83.3333) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 604
confident_label rate tensor(0.3007, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 486
clean true:428
clean false:58
clean_rate:0.8806584362139918
noisy true:584
noisy false:546
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1130
epoch [99/200] batch [5/15] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 0.5278 (0.5952) acc_x 84.3750 (86.2500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/15] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 1.0215 (0.6564) acc_x 75.0000 (84.3750) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [15/15] time 0.167 (0.172) data 0.091 (0.094) loss_x loss_x 0.9697 (0.7157) acc_x 78.1250 (82.2917) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.2896, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 468
clean true:414
clean false:54
clean_rate:0.8846153846153846
noisy true:564
noisy false:584
all clean rate:  [0.8709677419354839, 0.9124423963133641, 0.9418960244648318, 0.9270516717325228, 0.9475308641975309, 0.9104046242774566, 0.9348441926345609, 0.924198250728863, 0.9256198347107438, 0.9277777777777778, 0.9191374663072777, 0.9293478260869565, 0.9115281501340483, 0.9117647058823529, 0.9140625, 0.9090909090909091, 0.9210526315789473, 0.9209809264305178, 0.9142857142857143, 0.9182058047493403, 0.9102244389027432, 0.9196891191709845, 0.9095744680851063, 0.9143576826196473, 0.9152119700748129, 0.9022556390977443, 0.8883248730964467, 0.9130434782608695, 0.90625, 0.895, 0.9118387909319899, 0.9012658227848102, 0.9086538461538461, 0.9081885856079405, 0.9029850746268657, 0.9036144578313253, 0.9134615384615384, 0.9014423076923077, 0.9007263922518159, 0.9105882352941177, 0.9049881235154394, 0.9014084507042254, 0.8958837772397095, 0.9012345679012346, 0.909952606635071, 0.9050925925925926, 0.9059633027522935, 0.9025522041763341, 0.8888888888888888, 0.9025522041763341, 0.902200488997555, 0.8990610328638498, 0.8943820224719101, 0.8993288590604027, 0.8981481481481481, 0.9072398190045249, 0.8923076923076924, 0.888646288209607, 0.9093023255813953, 0.8961625282167043, 0.9116997792494481, 0.8947368421052632, 0.9108695652173913, 0.8816705336426914, 0.9051724137931034, 0.8857142857142857, 0.8981900452488688, 0.8984547461368654, 0.8809523809523809, 0.8871681415929203, 0.8982683982683982, 0.8915929203539823, 0.8922413793103449, 0.9073275862068966, 0.896551724137931, 0.8898488120950324, 0.9050632911392406, 0.8976034858387799, 0.890295358649789, 0.8959660297239915, 0.88470066518847, 0.8810020876826722, 0.8862660944206009, 0.8922413793103449, 0.8822314049586777, 0.8847736625514403, 0.8907563025210085, 0.8728813559322034, 0.8863636363636364, 0.9027484143763214, 0.8957446808510638, 0.8779443254817987, 0.8854166666666666, 0.8856548856548857, 0.884453781512605, 0.9028925619834711, 0.9063136456211812, 0.8845360824742268, 0.8806584362139918, 0.8846153846153846]
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1148
epoch [100/200] batch [5/14] time 0.187 (0.176) data 0.109 (0.099) loss_x loss_x 0.2695 (0.7319) acc_x 90.6250 (80.6250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/14] time 0.161 (0.173) data 0.084 (0.096) loss_x loss_x 0.8823 (0.6438) acc_x 75.0000 (83.1250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.2989, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 483
clean true:427
clean false:56
clean_rate:0.8840579710144928
noisy true:598
noisy false:535
after delete: len(clean_dataset) 483
after delete: len(noisy_dataset) 1133
epoch [101/200] batch [5/15] time 0.193 (0.176) data 0.116 (0.099) loss_x loss_x 0.5435 (0.8050) acc_x 81.2500 (75.6250) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/15] time 0.166 (0.175) data 0.090 (0.098) loss_x loss_x 0.5811 (0.8152) acc_x 81.2500 (76.2500) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [15/15] time 0.156 (0.169) data 0.079 (0.092) loss_x loss_x 0.5908 (0.7625) acc_x 84.3750 (79.5833) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:431
clean false:49
clean_rate:0.8979166666666667
noisy true:572
noisy false:564
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [102/200] batch [5/15] time 0.168 (0.170) data 0.092 (0.094) loss_x loss_x 0.5371 (0.5445) acc_x 90.6250 (86.8750) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/15] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 0.5195 (0.5616) acc_x 87.5000 (86.2500) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [15/15] time 0.174 (0.175) data 0.098 (0.098) loss_x loss_x 1.0039 (0.6201) acc_x 71.8750 (84.1667) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.2964, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 479
clean true:427
clean false:52
clean_rate:0.8914405010438413
noisy true:569
noisy false:568
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1137
epoch [103/200] batch [5/14] time 0.202 (0.188) data 0.125 (0.111) loss_x loss_x 0.6401 (0.5580) acc_x 87.5000 (83.1250) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/14] time 0.227 (0.201) data 0.125 (0.110) loss_x loss_x 0.9370 (0.5990) acc_x 78.1250 (82.8125) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.2952, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 477
clean true:421
clean false:56
clean_rate:0.8825995807127882
noisy true:559
noisy false:580
after delete: len(clean_dataset) 477
after delete: len(noisy_dataset) 1139
epoch [104/200] batch [5/14] time 0.159 (0.158) data 0.083 (0.081) loss_x loss_x 1.0439 (0.8378) acc_x 71.8750 (80.0000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/14] time 0.158 (0.158) data 0.082 (0.081) loss_x loss_x 1.1328 (0.7728) acc_x 84.3750 (83.1250) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:447
clean false:54
clean_rate:0.8922155688622755
noisy true:580
noisy false:535
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [105/200] batch [5/15] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.8633 (0.7232) acc_x 71.8750 (76.8750) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/15] time 0.167 (0.178) data 0.090 (0.101) loss_x loss_x 0.6528 (0.6885) acc_x 87.5000 (80.3125) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [15/15] time 0.192 (0.180) data 0.116 (0.103) loss_x loss_x 0.6055 (0.7329) acc_x 87.5000 (79.5833) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 622
confident_label rate tensor(0.2939, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 475
clean true:426
clean false:49
clean_rate:0.8968421052631579
noisy true:568
noisy false:573
after delete: len(clean_dataset) 475
after delete: len(noisy_dataset) 1141
epoch [106/200] batch [5/14] time 0.162 (0.188) data 0.085 (0.111) loss_x loss_x 0.7119 (0.7619) acc_x 87.5000 (81.8750) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/14] time 0.172 (0.183) data 0.096 (0.106) loss_x loss_x 0.6113 (0.7498) acc_x 84.3750 (80.3125) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.2995, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 484
clean true:432
clean false:52
clean_rate:0.8925619834710744
noisy true:582
noisy false:550
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1132
epoch [107/200] batch [5/15] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.4526 (0.7792) acc_x 84.3750 (78.1250) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [10/15] time 0.170 (0.202) data 0.093 (0.114) loss_x loss_x 0.2891 (0.7145) acc_x 93.7500 (80.6250) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/15] time 0.176 (0.194) data 0.097 (0.109) loss_x loss_x 0.7212 (0.7523) acc_x 81.2500 (80.4167) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.3001, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 485
clean true:434
clean false:51
clean_rate:0.8948453608247423
noisy true:572
noisy false:559
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1131
epoch [108/200] batch [5/15] time 0.183 (0.186) data 0.106 (0.110) loss_x loss_x 0.7407 (0.5310) acc_x 75.0000 (85.0000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/15] time 0.167 (0.181) data 0.090 (0.105) loss_x loss_x 0.8174 (0.6060) acc_x 84.3750 (84.0625) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [15/15] time 0.157 (0.173) data 0.081 (0.097) loss_x loss_x 0.6465 (0.5918) acc_x 81.2500 (84.1667) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 619
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 476
clean true:425
clean false:51
clean_rate:0.8928571428571429
noisy true:572
noisy false:568
after delete: len(clean_dataset) 476
after delete: len(noisy_dataset) 1140
epoch [109/200] batch [5/14] time 0.188 (0.202) data 0.110 (0.103) loss_x loss_x 0.4299 (0.6603) acc_x 87.5000 (80.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/14] time 0.171 (0.190) data 0.094 (0.102) loss_x loss_x 0.7012 (0.6961) acc_x 81.2500 (80.0000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.3032, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 490
clean true:436
clean false:54
clean_rate:0.889795918367347
noisy true:560
noisy false:566
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1126
epoch [110/200] batch [5/15] time 0.174 (0.205) data 0.097 (0.095) loss_x loss_x 0.4871 (0.6226) acc_x 84.3750 (81.2500) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/15] time 0.183 (0.197) data 0.107 (0.103) loss_x loss_x 0.6709 (0.6897) acc_x 75.0000 (79.6875) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [15/15] time 0.173 (0.189) data 0.096 (0.101) loss_x loss_x 0.6274 (0.7197) acc_x 84.3750 (80.2083) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.3014, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 487
clean true:435
clean false:52
clean_rate:0.893223819301848
noisy true:582
noisy false:547
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1129
epoch [111/200] batch [5/15] time 0.171 (0.167) data 0.094 (0.090) loss_x loss_x 0.9014 (0.6944) acc_x 62.5000 (80.0000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/15] time 0.165 (0.169) data 0.088 (0.092) loss_x loss_x 0.2471 (0.5961) acc_x 93.7500 (84.3750) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [15/15] time 0.169 (0.169) data 0.092 (0.092) loss_x loss_x 0.5879 (0.5931) acc_x 84.3750 (84.1667) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.3051, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 493
clean true:445
clean false:48
clean_rate:0.9026369168356998
noisy true:545
noisy false:578
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1123
epoch [112/200] batch [5/15] time 0.176 (0.188) data 0.098 (0.111) loss_x loss_x 0.3430 (0.5649) acc_x 90.6250 (83.7500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/15] time 0.165 (0.184) data 0.088 (0.106) loss_x loss_x 0.7090 (0.6183) acc_x 81.2500 (83.1250) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [15/15] time 0.159 (0.179) data 0.082 (0.102) loss_x loss_x 0.4417 (0.5943) acc_x 90.6250 (83.7500) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.3038, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 491
clean true:443
clean false:48
clean_rate:0.9022403258655805
noisy true:552
noisy false:573
after delete: len(clean_dataset) 491
after delete: len(noisy_dataset) 1125
epoch [113/200] batch [5/15] time 0.193 (0.178) data 0.116 (0.101) loss_x loss_x 0.5420 (0.6296) acc_x 87.5000 (83.7500) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/15] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 1.0986 (0.6600) acc_x 75.0000 (83.1250) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [15/15] time 0.198 (0.182) data 0.121 (0.105) loss_x loss_x 0.8760 (0.6339) acc_x 87.5000 (84.3750) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 611
confident_label rate tensor(0.3045, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 492
clean true:440
clean false:52
clean_rate:0.8943089430894309
noisy true:565
noisy false:559
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1124
epoch [114/200] batch [5/15] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 0.7852 (0.6346) acc_x 78.1250 (81.8750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/15] time 0.181 (0.176) data 0.104 (0.099) loss_x loss_x 0.4263 (0.5900) acc_x 93.7500 (84.0625) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [15/15] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 0.8203 (0.6013) acc_x 84.3750 (83.9583) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 593
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 509
clean true:457
clean false:52
clean_rate:0.8978388998035364
noisy true:566
noisy false:541
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1107
epoch [115/200] batch [5/15] time 0.160 (0.163) data 0.084 (0.086) loss_x loss_x 0.6357 (0.5869) acc_x 84.3750 (86.2500) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/15] time 0.157 (0.162) data 0.080 (0.085) loss_x loss_x 0.8154 (0.7334) acc_x 84.3750 (82.5000) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [15/15] time 0.172 (0.162) data 0.094 (0.086) loss_x loss_x 0.7139 (0.6834) acc_x 81.2500 (82.7083) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 505
clean true:455
clean false:50
clean_rate:0.900990099009901
noisy true:580
noisy false:531
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1111
epoch [116/200] batch [5/15] time 0.159 (0.183) data 0.082 (0.106) loss_x loss_x 0.9321 (0.7086) acc_x 81.2500 (85.0000) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/15] time 0.164 (0.175) data 0.087 (0.099) loss_x loss_x 0.6328 (0.7331) acc_x 78.1250 (81.5625) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [15/15] time 0.187 (0.180) data 0.110 (0.103) loss_x loss_x 0.6978 (0.6806) acc_x 78.1250 (83.5417) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.3051, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 493
clean true:438
clean false:55
clean_rate:0.8884381338742393
noisy true:560
noisy false:563
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1123
epoch [117/200] batch [5/15] time 0.162 (0.171) data 0.084 (0.094) loss_x loss_x 0.2837 (0.5590) acc_x 93.7500 (84.3750) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/15] time 0.176 (0.171) data 0.099 (0.094) loss_x loss_x 0.7617 (0.6740) acc_x 78.1250 (81.2500) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [15/15] time 0.182 (0.173) data 0.105 (0.097) loss_x loss_x 0.8828 (0.7286) acc_x 81.2500 (80.0000) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 510
clean true:452
clean false:58
clean_rate:0.8862745098039215
noisy true:580
noisy false:526
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1106
epoch [118/200] batch [5/15] time 0.189 (0.188) data 0.112 (0.112) loss_x loss_x 0.4758 (0.6181) acc_x 87.5000 (83.1250) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/15] time 0.272 (0.190) data 0.085 (0.102) loss_x loss_x 0.7441 (0.6773) acc_x 78.1250 (80.6250) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [15/15] time 0.184 (0.184) data 0.107 (0.099) loss_x loss_x 0.9272 (0.6519) acc_x 68.7500 (81.8750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.3051, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 493
clean true:434
clean false:59
clean_rate:0.8803245436105477
noisy true:561
noisy false:562
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1123
epoch [119/200] batch [5/15] time 0.161 (0.181) data 0.084 (0.104) loss_x loss_x 0.8774 (0.8488) acc_x 75.0000 (81.2500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/15] time 0.193 (0.179) data 0.116 (0.102) loss_x loss_x 0.5176 (0.8071) acc_x 84.3750 (81.2500) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [15/15] time 0.194 (0.176) data 0.097 (0.098) loss_x loss_x 0.6143 (0.7897) acc_x 81.2500 (81.0417) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 603
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:452
clean false:55
clean_rate:0.8915187376725838
noisy true:561
noisy false:548
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [120/200] batch [5/15] time 0.169 (0.192) data 0.092 (0.093) loss_x loss_x 0.7183 (0.5867) acc_x 84.3750 (84.3750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/15] time 0.175 (0.182) data 0.099 (0.094) loss_x loss_x 0.5889 (0.6014) acc_x 84.3750 (83.7500) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [15/15] time 0.167 (0.180) data 0.090 (0.095) loss_x loss_x 0.9146 (0.6478) acc_x 75.0000 (82.7083) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:438
clean false:61
clean_rate:0.8777555110220441
noisy true:558
noisy false:559
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [121/200] batch [5/15] time 0.169 (0.178) data 0.092 (0.100) loss_x loss_x 0.5151 (0.6015) acc_x 90.6250 (83.1250) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/15] time 0.189 (0.176) data 0.113 (0.099) loss_x loss_x 0.6777 (0.5738) acc_x 81.2500 (84.3750) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [15/15] time 0.286 (0.189) data 0.100 (0.105) loss_x loss_x 0.5996 (0.6359) acc_x 93.7500 (84.3750) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 505
clean true:443
clean false:62
clean_rate:0.8772277227722772
noisy true:574
noisy false:537
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1111
epoch [122/200] batch [5/15] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.6313 (0.6642) acc_x 84.3750 (81.8750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/15] time 0.176 (0.186) data 0.100 (0.109) loss_x loss_x 1.0156 (0.7255) acc_x 75.0000 (82.1875) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [15/15] time 0.161 (0.185) data 0.084 (0.109) loss_x loss_x 0.7031 (0.7442) acc_x 78.1250 (82.5000) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 510
clean true:438
clean false:72
clean_rate:0.8588235294117647
noisy true:580
noisy false:526
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1106
epoch [123/200] batch [5/15] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.6001 (0.5851) acc_x 87.5000 (84.3750) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/15] time 0.198 (0.185) data 0.121 (0.109) loss_x loss_x 0.7207 (0.6129) acc_x 84.3750 (84.3750) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [15/15] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.6318 (0.6878) acc_x 81.2500 (81.4583) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 632
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:438
clean false:61
clean_rate:0.8777555110220441
noisy true:546
noisy false:571
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [124/200] batch [5/15] time 0.171 (0.184) data 0.094 (0.107) loss_x loss_x 0.5439 (0.5919) acc_x 84.3750 (84.3750) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/15] time 0.186 (0.197) data 0.110 (0.107) loss_x loss_x 0.3674 (0.5757) acc_x 90.6250 (84.6875) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [15/15] time 0.181 (0.191) data 0.104 (0.105) loss_x loss_x 0.8989 (0.6280) acc_x 93.7500 (85.0000) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:448
clean false:66
clean_rate:0.8715953307392996
noisy true:571
noisy false:531
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [125/200] batch [5/16] time 0.156 (0.169) data 0.080 (0.092) loss_x loss_x 0.7549 (0.6562) acc_x 78.1250 (84.3750) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/16] time 0.159 (0.164) data 0.082 (0.087) loss_x loss_x 0.6924 (0.7196) acc_x 84.3750 (81.5625) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [15/16] time 0.159 (0.162) data 0.082 (0.085) loss_x loss_x 0.4829 (0.6674) acc_x 90.6250 (82.9167) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:449
clean false:59
clean_rate:0.8838582677165354
noisy true:576
noisy false:532
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [126/200] batch [5/15] time 0.189 (0.176) data 0.113 (0.099) loss_x loss_x 0.6436 (0.8550) acc_x 78.1250 (78.1250) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/15] time 0.172 (0.181) data 0.096 (0.105) loss_x loss_x 0.9375 (0.7030) acc_x 71.8750 (80.0000) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [15/15] time 0.177 (0.180) data 0.099 (0.103) loss_x loss_x 0.9106 (0.6701) acc_x 81.2500 (82.2917) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.3063, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 495
clean true:436
clean false:59
clean_rate:0.8808080808080808
noisy true:570
noisy false:551
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1121
epoch [127/200] batch [5/15] time 0.168 (0.175) data 0.091 (0.099) loss_x loss_x 1.0928 (0.8241) acc_x 71.8750 (80.6250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/15] time 0.227 (0.181) data 0.117 (0.101) loss_x loss_x 0.8384 (0.7453) acc_x 78.1250 (80.6250) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [15/15] time 0.176 (0.190) data 0.100 (0.103) loss_x loss_x 0.2561 (0.6798) acc_x 96.8750 (82.0833) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 615
confident_label rate tensor(0.3069, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 496
clean true:436
clean false:60
clean_rate:0.8790322580645161
noisy true:565
noisy false:555
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1120
epoch [128/200] batch [5/15] time 0.162 (0.170) data 0.085 (0.093) loss_x loss_x 0.5845 (0.6833) acc_x 84.3750 (83.7500) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/15] time 0.178 (0.175) data 0.101 (0.098) loss_x loss_x 0.6719 (0.6834) acc_x 84.3750 (83.7500) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [15/15] time 0.241 (0.188) data 0.107 (0.100) loss_x loss_x 0.3044 (0.6502) acc_x 90.6250 (83.1250) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.3168, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 512
clean true:454
clean false:58
clean_rate:0.88671875
noisy true:566
noisy false:538
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1104
epoch [129/200] batch [5/16] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.9160 (0.7687) acc_x 68.7500 (80.0000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/16] time 0.159 (0.170) data 0.082 (0.093) loss_x loss_x 0.9663 (0.7563) acc_x 68.7500 (79.6875) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [15/16] time 0.160 (0.168) data 0.083 (0.091) loss_x loss_x 0.7207 (0.7982) acc_x 87.5000 (79.7917) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.3187, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 515
clean true:455
clean false:60
clean_rate:0.883495145631068
noisy true:543
noisy false:558
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1101
epoch [130/200] batch [5/16] time 0.196 (0.177) data 0.120 (0.101) loss_x loss_x 0.6558 (0.9398) acc_x 78.1250 (76.2500) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/16] time 0.206 (0.179) data 0.129 (0.102) loss_x loss_x 0.2664 (0.6930) acc_x 93.7500 (81.8750) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/16] time 0.180 (0.190) data 0.103 (0.104) loss_x loss_x 0.6675 (0.6847) acc_x 87.5000 (82.7083) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:449
clean false:62
clean_rate:0.8786692759295499
noisy true:543
noisy false:562
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [131/200] batch [5/15] time 0.189 (0.208) data 0.113 (0.106) loss_x loss_x 0.4978 (0.6947) acc_x 84.3750 (82.5000) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/15] time 0.210 (0.197) data 0.134 (0.107) loss_x loss_x 0.5029 (0.6742) acc_x 90.6250 (83.4375) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [15/15] time 0.166 (0.189) data 0.090 (0.104) loss_x loss_x 0.6021 (0.7324) acc_x 87.5000 (81.8750) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 609
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:449
clean false:71
clean_rate:0.8634615384615385
noisy true:558
noisy false:538
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [132/200] batch [5/16] time 0.172 (0.187) data 0.095 (0.089) loss_x loss_x 0.6655 (0.6085) acc_x 87.5000 (86.2500) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/16] time 0.180 (0.186) data 0.104 (0.099) loss_x loss_x 0.6855 (0.6579) acc_x 81.2500 (83.7500) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/16] time 0.185 (0.187) data 0.108 (0.104) loss_x loss_x 0.7974 (0.7623) acc_x 78.1250 (81.8750) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 614
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 504
clean true:438
clean false:66
clean_rate:0.8690476190476191
noisy true:564
noisy false:548
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1112
epoch [133/200] batch [5/15] time 0.165 (0.172) data 0.088 (0.096) loss_x loss_x 0.8350 (0.7229) acc_x 81.2500 (83.1250) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/15] time 0.156 (0.167) data 0.080 (0.091) loss_x loss_x 0.9097 (0.7083) acc_x 75.0000 (82.5000) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [15/15] time 0.182 (0.167) data 0.105 (0.090) loss_x loss_x 0.3652 (0.6838) acc_x 93.7500 (83.1250) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 519
clean true:458
clean false:61
clean_rate:0.882466281310212
noisy true:576
noisy false:521
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1097
epoch [134/200] batch [5/16] time 0.201 (0.193) data 0.124 (0.116) loss_x loss_x 0.6880 (0.6511) acc_x 84.3750 (83.1250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/16] time 0.189 (0.187) data 0.112 (0.110) loss_x loss_x 1.1748 (0.6704) acc_x 75.0000 (82.1875) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [15/16] time 0.240 (0.189) data 0.163 (0.113) loss_x loss_x 0.5239 (0.6448) acc_x 87.5000 (82.7083) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:452
clean false:59
clean_rate:0.8845401174168297
noisy true:570
noisy false:535
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [135/200] batch [5/15] time 0.172 (0.171) data 0.096 (0.094) loss_x loss_x 0.8262 (0.6067) acc_x 78.1250 (84.3750) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/15] time 0.187 (0.177) data 0.110 (0.100) loss_x loss_x 0.8101 (0.5722) acc_x 75.0000 (83.7500) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [15/15] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.6982 (0.6510) acc_x 81.2500 (83.3333) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 497
clean true:435
clean false:62
clean_rate:0.8752515090543259
noisy true:546
noisy false:573
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1119
epoch [136/200] batch [5/15] time 0.176 (0.192) data 0.099 (0.114) loss_x loss_x 0.8535 (0.6629) acc_x 78.1250 (83.7500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/15] time 0.163 (0.189) data 0.086 (0.112) loss_x loss_x 0.9263 (0.6373) acc_x 78.1250 (84.6875) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [15/15] time 0.176 (0.184) data 0.097 (0.106) loss_x loss_x 0.4448 (0.5981) acc_x 87.5000 (85.4167) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 603
confident_label rate tensor(0.3082, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 498
clean true:437
clean false:61
clean_rate:0.8775100401606426
noisy true:576
noisy false:542
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1118
epoch [137/200] batch [5/15] time 0.158 (0.175) data 0.082 (0.099) loss_x loss_x 0.5972 (0.6601) acc_x 84.3750 (85.0000) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/15] time 0.158 (0.173) data 0.081 (0.097) loss_x loss_x 0.6304 (0.6482) acc_x 81.2500 (83.4375) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [15/15] time 0.168 (0.170) data 0.091 (0.093) loss_x loss_x 0.6147 (0.6170) acc_x 84.3750 (84.1667) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 607
confident_label rate tensor(0.3069, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 496
clean true:435
clean false:61
clean_rate:0.8770161290322581
noisy true:574
noisy false:546
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1120
epoch [138/200] batch [5/15] time 0.174 (0.181) data 0.097 (0.103) loss_x loss_x 0.4785 (0.5978) acc_x 90.6250 (85.6250) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/15] time 0.162 (0.188) data 0.084 (0.099) loss_x loss_x 0.4331 (0.5635) acc_x 87.5000 (85.6250) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [15/15] time 0.178 (0.186) data 0.102 (0.101) loss_x loss_x 0.6348 (0.5887) acc_x 84.3750 (85.0000) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 574
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:455
clean false:56
clean_rate:0.8904109589041096
noisy true:587
noisy false:518
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [139/200] batch [5/15] time 0.195 (0.171) data 0.119 (0.095) loss_x loss_x 0.4900 (0.6413) acc_x 90.6250 (87.5000) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/15] time 0.162 (0.171) data 0.084 (0.094) loss_x loss_x 1.0039 (0.6610) acc_x 78.1250 (85.9375) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [15/15] time 0.173 (0.171) data 0.096 (0.095) loss_x loss_x 1.1123 (0.6699) acc_x 68.7500 (85.4167) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:450
clean false:64
clean_rate:0.8754863813229572
noisy true:582
noisy false:520
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [140/200] batch [5/16] time 0.174 (0.196) data 0.097 (0.119) loss_x loss_x 0.6133 (0.5073) acc_x 87.5000 (89.3750) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/16] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.4753 (0.5623) acc_x 87.5000 (86.2500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/16] time 0.156 (0.185) data 0.079 (0.108) loss_x loss_x 0.8691 (0.6020) acc_x 65.6250 (83.7500) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 510
clean true:450
clean false:60
clean_rate:0.8823529411764706
noisy true:580
noisy false:526
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1106
epoch [141/200] batch [5/15] time 0.158 (0.158) data 0.081 (0.082) loss_x loss_x 0.2125 (0.5031) acc_x 96.8750 (88.1250) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/15] time 0.215 (0.166) data 0.138 (0.089) loss_x loss_x 0.5771 (0.5551) acc_x 87.5000 (85.3125) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [15/15] time 0.166 (0.169) data 0.089 (0.093) loss_x loss_x 0.7676 (0.5839) acc_x 75.0000 (84.5833) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 611
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 509
clean true:447
clean false:62
clean_rate:0.8781925343811395
noisy true:558
noisy false:549
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1107
epoch [142/200] batch [5/15] time 0.175 (0.174) data 0.097 (0.097) loss_x loss_x 0.7197 (0.5598) acc_x 75.0000 (85.0000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/15] time 0.191 (0.178) data 0.113 (0.101) loss_x loss_x 0.5864 (0.6588) acc_x 87.5000 (81.5625) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [15/15] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.8887 (0.6650) acc_x 81.2500 (81.6667) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 607
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:447
clean false:54
clean_rate:0.8922155688622755
noisy true:562
noisy false:553
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [143/200] batch [5/15] time 0.173 (0.186) data 0.096 (0.109) loss_x loss_x 0.4780 (0.6647) acc_x 90.6250 (82.5000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/15] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 0.7710 (0.7307) acc_x 78.1250 (80.9375) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [15/15] time 0.181 (0.190) data 0.103 (0.113) loss_x loss_x 0.8179 (0.7006) acc_x 78.1250 (82.0833) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 510
clean true:446
clean false:64
clean_rate:0.8745098039215686
noisy true:560
noisy false:546
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1106
epoch [144/200] batch [5/15] time 0.194 (0.187) data 0.115 (0.109) loss_x loss_x 0.8428 (0.6544) acc_x 81.2500 (85.0000) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/15] time 0.180 (0.184) data 0.102 (0.106) loss_x loss_x 0.9014 (0.6336) acc_x 71.8750 (85.0000) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [15/15] time 0.187 (0.181) data 0.109 (0.103) loss_x loss_x 0.5527 (0.5936) acc_x 75.0000 (84.3750) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 593
confident_label rate tensor(0.3168, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 512
clean true:451
clean false:61
clean_rate:0.880859375
noisy true:572
noisy false:532
after delete: len(clean_dataset) 512
after delete: len(noisy_dataset) 1104
epoch [145/200] batch [5/16] time 0.161 (0.162) data 0.083 (0.084) loss_x loss_x 0.6729 (0.6295) acc_x 84.3750 (86.2500) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/16] time 0.162 (0.181) data 0.085 (0.084) loss_x loss_x 0.8101 (0.6588) acc_x 84.3750 (85.6250) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [15/16] time 0.202 (0.181) data 0.124 (0.090) loss_x loss_x 0.3516 (0.6410) acc_x 96.8750 (86.4583) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 503
clean true:446
clean false:57
clean_rate:0.8866799204771372
noisy true:581
noisy false:532
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1113
epoch [146/200] batch [5/15] time 0.287 (0.195) data 0.101 (0.091) loss_x loss_x 0.7212 (0.6161) acc_x 75.0000 (85.0000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/15] time 0.164 (0.191) data 0.087 (0.101) loss_x loss_x 0.7822 (0.6612) acc_x 78.1250 (83.4375) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [15/15] time 0.161 (0.183) data 0.084 (0.097) loss_x loss_x 0.7842 (0.7324) acc_x 81.2500 (83.3333) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.3187, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 515
clean true:456
clean false:59
clean_rate:0.8854368932038835
noisy true:564
noisy false:537
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1101
epoch [147/200] batch [5/16] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.7974 (0.6097) acc_x 81.2500 (86.2500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/16] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.3474 (0.6214) acc_x 96.8750 (86.8750) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [15/16] time 0.185 (0.193) data 0.107 (0.109) loss_x loss_x 0.3008 (0.6021) acc_x 93.7500 (86.6667) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:455
clean false:67
clean_rate:0.8716475095785441
noisy true:556
noisy false:538
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [148/200] batch [5/16] time 0.176 (0.162) data 0.100 (0.086) loss_x loss_x 0.7822 (0.6120) acc_x 81.2500 (83.7500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/16] time 0.165 (0.173) data 0.089 (0.097) loss_x loss_x 1.0879 (0.6254) acc_x 71.8750 (83.4375) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [15/16] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.5981 (0.6167) acc_x 78.1250 (83.3333) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.3187, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 515
clean true:449
clean false:66
clean_rate:0.8718446601941747
noisy true:592
noisy false:509
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1101
epoch [149/200] batch [5/16] time 0.160 (0.157) data 0.083 (0.081) loss_x loss_x 0.5527 (0.7000) acc_x 84.3750 (85.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/16] time 0.158 (0.164) data 0.081 (0.087) loss_x loss_x 0.6323 (0.6918) acc_x 81.2500 (83.4375) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [15/16] time 0.158 (0.167) data 0.081 (0.090) loss_x loss_x 0.5459 (0.6930) acc_x 84.3750 (83.3333) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 604
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:443
clean false:64
clean_rate:0.873767258382643
noisy true:569
noisy false:540
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [150/200] batch [5/15] time 0.188 (0.186) data 0.112 (0.109) loss_x loss_x 0.5659 (0.6212) acc_x 87.5000 (85.0000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/15] time 0.157 (0.180) data 0.080 (0.103) loss_x loss_x 0.9253 (0.6268) acc_x 75.0000 (82.8125) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [15/15] time 0.174 (0.174) data 0.097 (0.097) loss_x loss_x 0.7231 (0.5550) acc_x 81.2500 (85.6250) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 533
clean true:475
clean false:58
clean_rate:0.8911819887429644
noisy true:584
noisy false:499
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1083
epoch [151/200] batch [5/16] time 0.173 (0.195) data 0.096 (0.118) loss_x loss_x 0.6060 (0.7032) acc_x 87.5000 (83.7500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/16] time 0.182 (0.189) data 0.105 (0.112) loss_x loss_x 0.1968 (0.5809) acc_x 96.8750 (86.2500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [15/16] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.5601 (0.5795) acc_x 81.2500 (85.4167) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 519
clean true:449
clean false:70
clean_rate:0.8651252408477842
noisy true:571
noisy false:526
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1097
epoch [152/200] batch [5/16] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.4131 (0.5703) acc_x 90.6250 (86.8750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/16] time 0.187 (0.195) data 0.110 (0.104) loss_x loss_x 0.3228 (0.5943) acc_x 96.8750 (85.0000) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/16] time 0.182 (0.188) data 0.105 (0.102) loss_x loss_x 0.7065 (0.5662) acc_x 81.2500 (85.8333) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 518
clean true:462
clean false:56
clean_rate:0.8918918918918919
noisy true:582
noisy false:516
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1098
epoch [153/200] batch [5/16] time 0.167 (0.160) data 0.089 (0.083) loss_x loss_x 0.5186 (0.6576) acc_x 87.5000 (86.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/16] time 0.173 (0.165) data 0.097 (0.088) loss_x loss_x 0.7471 (0.6467) acc_x 81.2500 (84.6875) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [15/16] time 0.182 (0.169) data 0.105 (0.092) loss_x loss_x 0.4854 (0.6145) acc_x 90.6250 (84.7917) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 525
clean true:462
clean false:63
clean_rate:0.88
noisy true:558
noisy false:533
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1091
epoch [154/200] batch [5/16] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.4570 (0.6891) acc_x 87.5000 (79.3750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/16] time 0.174 (0.184) data 0.096 (0.107) loss_x loss_x 0.7559 (0.7181) acc_x 78.1250 (79.0625) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [15/16] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.6675 (0.7292) acc_x 81.2500 (79.5833) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:462
clean false:58
clean_rate:0.8884615384615384
noisy true:595
noisy false:501
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [155/200] batch [5/16] time 0.184 (0.173) data 0.107 (0.097) loss_x loss_x 0.5767 (0.5820) acc_x 84.3750 (83.1250) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/16] time 0.177 (0.174) data 0.100 (0.098) loss_x loss_x 0.2930 (0.5323) acc_x 96.8750 (85.3125) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [15/16] time 0.165 (0.182) data 0.088 (0.098) loss_x loss_x 0.8057 (0.5907) acc_x 78.1250 (83.9583) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:453
clean false:67
clean_rate:0.8711538461538462
noisy true:564
noisy false:532
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [156/200] batch [5/16] time 0.181 (0.197) data 0.104 (0.120) loss_x loss_x 0.5352 (0.5370) acc_x 87.5000 (86.2500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/16] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.6245 (0.5686) acc_x 81.2500 (85.3125) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [15/16] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.9316 (0.6255) acc_x 75.0000 (84.3750) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 535
clean true:472
clean false:63
clean_rate:0.8822429906542056
noisy true:575
noisy false:506
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1081
epoch [157/200] batch [5/16] time 0.268 (0.201) data 0.082 (0.083) loss_x loss_x 0.2656 (0.5010) acc_x 93.7500 (87.5000) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/16] time 0.168 (0.186) data 0.091 (0.088) loss_x loss_x 0.5156 (0.6026) acc_x 87.5000 (83.7500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/16] time 0.170 (0.183) data 0.094 (0.093) loss_x loss_x 0.3235 (0.6010) acc_x 93.7500 (84.7917) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 525
clean true:458
clean false:67
clean_rate:0.8723809523809524
noisy true:592
noisy false:499
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1091
epoch [158/200] batch [5/16] time 0.161 (0.176) data 0.084 (0.099) loss_x loss_x 0.5254 (0.5282) acc_x 90.6250 (83.1250) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/16] time 0.189 (0.178) data 0.112 (0.101) loss_x loss_x 0.6504 (0.5754) acc_x 75.0000 (82.8125) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [15/16] time 0.278 (0.187) data 0.092 (0.102) loss_x loss_x 0.6509 (0.5824) acc_x 87.5000 (84.1667) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.3292, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 532
clean true:466
clean false:66
clean_rate:0.8759398496240601
noisy true:581
noisy false:503
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 1084
epoch [159/200] batch [5/16] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.5034 (0.7522) acc_x 81.2500 (79.3750) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/16] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.3723 (0.6292) acc_x 93.7500 (82.8125) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [15/16] time 0.173 (0.173) data 0.096 (0.096) loss_x loss_x 0.6450 (0.6534) acc_x 84.3750 (82.0833) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 517
clean true:453
clean false:64
clean_rate:0.8762088974854932
noisy true:592
noisy false:507
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1099
epoch [160/200] batch [5/16] time 0.168 (0.165) data 0.091 (0.088) loss_x loss_x 0.7993 (0.7338) acc_x 71.8750 (80.6250) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/16] time 0.192 (0.187) data 0.115 (0.099) loss_x loss_x 0.6177 (0.7000) acc_x 78.1250 (80.9375) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/16] time 0.174 (0.182) data 0.097 (0.098) loss_x loss_x 0.9658 (0.7092) acc_x 78.1250 (81.4583) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 591
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 525
clean true:465
clean false:60
clean_rate:0.8857142857142857
noisy true:560
noisy false:531
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1091
epoch [161/200] batch [5/16] time 0.166 (0.166) data 0.088 (0.089) loss_x loss_x 0.3782 (0.6107) acc_x 93.7500 (84.3750) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [10/16] time 0.164 (0.166) data 0.087 (0.088) loss_x loss_x 1.5283 (0.6513) acc_x 65.6250 (85.3125) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [15/16] time 0.176 (0.178) data 0.099 (0.091) loss_x loss_x 0.2598 (0.6181) acc_x 93.7500 (85.4167) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:450
clean false:64
clean_rate:0.8754863813229572
noisy true:560
noisy false:542
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [162/200] batch [5/16] time 0.191 (0.189) data 0.113 (0.113) loss_x loss_x 0.7690 (0.7223) acc_x 81.2500 (83.1250) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/16] time 0.183 (0.186) data 0.105 (0.109) loss_x loss_x 0.3147 (0.5772) acc_x 87.5000 (85.6250) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/16] time 0.182 (0.185) data 0.105 (0.107) loss_x loss_x 0.4980 (0.6326) acc_x 87.5000 (84.3750) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 601
confident_label rate tensor(0.3224, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 521
clean true:456
clean false:65
clean_rate:0.8752399232245681
noisy true:559
noisy false:536
after delete: len(clean_dataset) 521
after delete: len(noisy_dataset) 1095
epoch [163/200] batch [5/16] time 0.180 (0.183) data 0.104 (0.106) loss_x loss_x 0.9482 (0.6577) acc_x 81.2500 (83.1250) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/16] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.5625 (0.6570) acc_x 84.3750 (82.8125) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/16] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.9658 (0.6576) acc_x 71.8750 (83.1250) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:441
clean false:60
clean_rate:0.8802395209580839
noisy true:604
noisy false:511
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [164/200] batch [5/15] time 0.166 (0.185) data 0.090 (0.108) loss_x loss_x 0.3770 (0.5327) acc_x 93.7500 (87.5000) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/15] time 0.186 (0.197) data 0.110 (0.109) loss_x loss_x 0.4995 (0.4875) acc_x 84.3750 (87.8125) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [15/15] time 0.180 (0.188) data 0.103 (0.104) loss_x loss_x 0.5020 (0.5255) acc_x 87.5000 (87.2917) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 601
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:447
clean false:61
clean_rate:0.8799212598425197
noisy true:568
noisy false:540
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [165/200] batch [5/15] time 0.158 (0.158) data 0.082 (0.082) loss_x loss_x 0.9048 (0.8250) acc_x 71.8750 (77.5000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/15] time 0.178 (0.163) data 0.102 (0.087) loss_x loss_x 0.7231 (0.7448) acc_x 87.5000 (81.2500) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [15/15] time 0.163 (0.175) data 0.084 (0.091) loss_x loss_x 0.4268 (0.7027) acc_x 93.7500 (82.5000) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:457
clean false:65
clean_rate:0.8754789272030651
noisy true:598
noisy false:496
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [166/200] batch [5/16] time 0.158 (0.164) data 0.081 (0.087) loss_x loss_x 0.2280 (0.5968) acc_x 90.6250 (85.0000) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/16] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.4844 (0.6254) acc_x 81.2500 (83.1250) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [15/16] time 0.177 (0.177) data 0.099 (0.100) loss_x loss_x 0.4568 (0.5586) acc_x 87.5000 (85.4167) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 505
clean true:444
clean false:61
clean_rate:0.8792079207920792
noisy true:566
noisy false:545
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1111
epoch [167/200] batch [5/15] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.6147 (0.4831) acc_x 78.1250 (86.8750) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/15] time 0.170 (0.186) data 0.093 (0.109) loss_x loss_x 0.7388 (0.6559) acc_x 75.0000 (82.5000) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [15/15] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.3899 (0.6178) acc_x 87.5000 (83.7500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 562
confident_label rate tensor(0.3379, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 546
clean true:477
clean false:69
clean_rate:0.8736263736263736
noisy true:577
noisy false:493
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 1070
epoch [168/200] batch [5/17] time 0.168 (0.172) data 0.091 (0.095) loss_x loss_x 0.7432 (0.7450) acc_x 84.3750 (82.5000) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/17] time 0.171 (0.169) data 0.094 (0.092) loss_x loss_x 0.5205 (0.6370) acc_x 90.6250 (84.3750) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/17] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.4072 (0.6110) acc_x 87.5000 (86.4583) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:459
clean false:55
clean_rate:0.8929961089494164
noisy true:569
noisy false:533
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [169/200] batch [5/16] time 0.166 (0.188) data 0.089 (0.111) loss_x loss_x 0.8989 (0.6413) acc_x 81.2500 (83.1250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/16] time 0.177 (0.186) data 0.100 (0.109) loss_x loss_x 0.4963 (0.6036) acc_x 84.3750 (84.6875) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/16] time 0.175 (0.182) data 0.097 (0.104) loss_x loss_x 0.2468 (0.5446) acc_x 90.6250 (85.8333) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 590
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 518
clean true:452
clean false:66
clean_rate:0.8725868725868726
noisy true:574
noisy false:524
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1098
epoch [170/200] batch [5/16] time 0.168 (0.197) data 0.092 (0.120) loss_x loss_x 0.8135 (0.5822) acc_x 75.0000 (83.7500) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/16] time 0.159 (0.183) data 0.082 (0.107) loss_x loss_x 0.6494 (0.5718) acc_x 84.3750 (85.0000) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/16] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.3347 (0.5401) acc_x 90.6250 (85.4167) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 519
clean true:457
clean false:62
clean_rate:0.8805394990366089
noisy true:565
noisy false:532
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1097
epoch [171/200] batch [5/16] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.8716 (0.5557) acc_x 75.0000 (86.2500) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/16] time 0.156 (0.174) data 0.079 (0.097) loss_x loss_x 0.5093 (0.5449) acc_x 87.5000 (85.0000) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [15/16] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.4570 (0.5791) acc_x 84.3750 (84.3750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.3236, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 523
clean true:461
clean false:62
clean_rate:0.8814531548757171
noisy true:569
noisy false:524
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1093
epoch [172/200] batch [5/16] time 0.199 (0.199) data 0.123 (0.121) loss_x loss_x 0.6655 (0.5034) acc_x 84.3750 (86.8750) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/16] time 0.187 (0.203) data 0.111 (0.115) loss_x loss_x 0.5024 (0.4626) acc_x 87.5000 (87.5000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/16] time 0.170 (0.190) data 0.092 (0.106) loss_x loss_x 0.8525 (0.5226) acc_x 78.1250 (86.8750) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3317, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 536
clean true:470
clean false:66
clean_rate:0.8768656716417911
noisy true:558
noisy false:522
after delete: len(clean_dataset) 536
after delete: len(noisy_dataset) 1080
epoch [173/200] batch [5/16] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.5527 (0.4876) acc_x 90.6250 (88.7500) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/16] time 0.160 (0.172) data 0.082 (0.095) loss_x loss_x 0.3767 (0.5188) acc_x 93.7500 (87.1875) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/16] time 0.163 (0.169) data 0.086 (0.092) loss_x loss_x 0.7446 (0.5724) acc_x 75.0000 (84.5833) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 580
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:462
clean false:69
clean_rate:0.8700564971751412
noisy true:574
noisy false:511
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [174/200] batch [5/16] time 0.196 (0.184) data 0.090 (0.097) loss_x loss_x 0.3438 (0.5366) acc_x 96.8750 (88.7500) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/16] time 0.159 (0.176) data 0.082 (0.095) loss_x loss_x 0.7017 (0.6151) acc_x 87.5000 (86.5625) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [15/16] time 0.182 (0.176) data 0.106 (0.096) loss_x loss_x 1.0977 (0.6331) acc_x 71.8750 (85.4167) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 603
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 525
clean true:455
clean false:70
clean_rate:0.8666666666666667
noisy true:558
noisy false:533
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1091
epoch [175/200] batch [5/16] time 0.190 (0.206) data 0.113 (0.096) loss_x loss_x 0.7344 (0.7148) acc_x 81.2500 (83.7500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/16] time 0.175 (0.197) data 0.098 (0.104) loss_x loss_x 0.6812 (0.7170) acc_x 84.3750 (83.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [15/16] time 0.158 (0.189) data 0.082 (0.101) loss_x loss_x 0.4639 (0.6272) acc_x 81.2500 (84.1667) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:456
clean false:66
clean_rate:0.8735632183908046
noisy true:550
noisy false:544
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [176/200] batch [5/16] time 0.177 (0.182) data 0.101 (0.105) loss_x loss_x 0.3281 (0.5541) acc_x 93.7500 (86.8750) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/16] time 0.176 (0.182) data 0.099 (0.105) loss_x loss_x 0.8501 (0.5562) acc_x 71.8750 (85.0000) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [15/16] time 0.178 (0.180) data 0.100 (0.103) loss_x loss_x 0.4919 (0.5514) acc_x 87.5000 (85.6250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 616
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 510
clean true:437
clean false:73
clean_rate:0.8568627450980392
noisy true:563
noisy false:543
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1106
epoch [177/200] batch [5/15] time 0.189 (0.188) data 0.111 (0.110) loss_x loss_x 0.4500 (0.5380) acc_x 81.2500 (83.7500) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/15] time 0.163 (0.181) data 0.086 (0.103) loss_x loss_x 0.4404 (0.5398) acc_x 93.7500 (86.5625) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [15/15] time 0.188 (0.178) data 0.111 (0.100) loss_x loss_x 0.5298 (0.6167) acc_x 81.2500 (85.2083) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 539
clean true:462
clean false:77
clean_rate:0.8571428571428571
noisy true:576
noisy false:501
after delete: len(clean_dataset) 539
after delete: len(noisy_dataset) 1077
epoch [178/200] batch [5/16] time 0.161 (0.193) data 0.084 (0.093) loss_x loss_x 0.7188 (0.6695) acc_x 84.3750 (83.1250) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/16] time 0.197 (0.180) data 0.120 (0.092) loss_x loss_x 0.7397 (0.6631) acc_x 81.2500 (84.0625) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/16] time 0.183 (0.183) data 0.106 (0.099) loss_x loss_x 1.1865 (0.6818) acc_x 78.1250 (82.9167) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 519
clean true:453
clean false:66
clean_rate:0.8728323699421965
noisy true:569
noisy false:528
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1097
epoch [179/200] batch [5/16] time 0.199 (0.182) data 0.123 (0.105) loss_x loss_x 0.4280 (0.4901) acc_x 93.7500 (88.7500) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/16] time 0.195 (0.190) data 0.119 (0.114) loss_x loss_x 0.3733 (0.5567) acc_x 90.6250 (87.8125) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/16] time 0.183 (0.187) data 0.106 (0.111) loss_x loss_x 0.9058 (0.5543) acc_x 78.1250 (88.7500) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.3267, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 528
clean true:460
clean false:68
clean_rate:0.8712121212121212
noisy true:575
noisy false:513
after delete: len(clean_dataset) 528
after delete: len(noisy_dataset) 1088
epoch [180/200] batch [5/16] time 0.195 (0.181) data 0.118 (0.104) loss_x loss_x 0.3594 (0.5450) acc_x 96.8750 (87.5000) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/16] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.3169 (0.5182) acc_x 90.6250 (87.1875) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [15/16] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.7998 (0.5615) acc_x 78.1250 (86.6667) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.3193, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 516
clean true:450
clean false:66
clean_rate:0.872093023255814
noisy true:553
noisy false:547
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1100
epoch [181/200] batch [5/16] time 0.161 (0.183) data 0.083 (0.105) loss_x loss_x 0.5005 (0.4767) acc_x 87.5000 (86.8750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/16] time 0.179 (0.179) data 0.101 (0.102) loss_x loss_x 0.6377 (0.6159) acc_x 78.1250 (84.3750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/16] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.6699 (0.6133) acc_x 81.2500 (85.0000) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 576
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 539
clean true:467
clean false:72
clean_rate:0.8664192949907236
noisy true:573
noisy false:504
after delete: len(clean_dataset) 539
after delete: len(noisy_dataset) 1077
epoch [182/200] batch [5/16] time 0.159 (0.160) data 0.081 (0.083) loss_x loss_x 0.5200 (0.7176) acc_x 87.5000 (83.7500) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/16] time 0.156 (0.165) data 0.079 (0.088) loss_x loss_x 0.6748 (0.6675) acc_x 87.5000 (83.7500) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [15/16] time 0.173 (0.175) data 0.095 (0.091) loss_x loss_x 0.3909 (0.6482) acc_x 96.8750 (84.1667) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 590
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 533
clean true:469
clean false:64
clean_rate:0.8799249530956847
noisy true:557
noisy false:526
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1083
epoch [183/200] batch [5/16] time 0.174 (0.187) data 0.095 (0.109) loss_x loss_x 0.3916 (0.6099) acc_x 90.6250 (85.6250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/16] time 0.177 (0.182) data 0.101 (0.105) loss_x loss_x 0.5972 (0.5451) acc_x 90.6250 (87.1875) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [15/16] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.8560 (0.5385) acc_x 81.2500 (86.8750) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 537
clean true:463
clean false:74
clean_rate:0.8621973929236499
noisy true:554
noisy false:525
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1079
epoch [184/200] batch [5/16] time 0.184 (0.210) data 0.107 (0.133) loss_x loss_x 0.3779 (0.4545) acc_x 87.5000 (86.8750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/16] time 0.163 (0.191) data 0.086 (0.114) loss_x loss_x 0.7974 (0.5276) acc_x 87.5000 (86.8750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/16] time 0.179 (0.191) data 0.102 (0.114) loss_x loss_x 0.6416 (0.5466) acc_x 87.5000 (86.4583) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 503
clean true:443
clean false:60
clean_rate:0.8807157057654076
noisy true:574
noisy false:539
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1113
epoch [185/200] batch [5/15] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 1.0430 (0.7292) acc_x 81.2500 (83.7500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/15] time 0.194 (0.177) data 0.117 (0.100) loss_x loss_x 0.6841 (0.6080) acc_x 81.2500 (84.0625) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [15/15] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.4314 (0.6413) acc_x 93.7500 (83.5417) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 619
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 504
clean true:443
clean false:61
clean_rate:0.878968253968254
noisy true:554
noisy false:558
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1112
epoch [186/200] batch [5/15] time 0.174 (0.190) data 0.096 (0.099) loss_x loss_x 0.5884 (0.5808) acc_x 78.1250 (83.1250) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [10/15] time 0.167 (0.186) data 0.091 (0.103) loss_x loss_x 0.7749 (0.6008) acc_x 75.0000 (83.1250) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [15/15] time 0.199 (0.184) data 0.122 (0.103) loss_x loss_x 0.8701 (0.6124) acc_x 81.2500 (83.9583) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 524
clean true:457
clean false:67
clean_rate:0.8721374045801527
noisy true:561
noisy false:531
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1092
epoch [187/200] batch [5/16] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.3704 (0.5651) acc_x 90.6250 (86.2500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/16] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.7368 (0.6185) acc_x 78.1250 (85.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/16] time 0.177 (0.178) data 0.100 (0.101) loss_x loss_x 0.7915 (0.6011) acc_x 78.1250 (84.5833) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 587
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 524
clean true:456
clean false:68
clean_rate:0.8702290076335878
noisy true:573
noisy false:519
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1092
epoch [188/200] batch [5/16] time 0.252 (0.214) data 0.088 (0.097) loss_x loss_x 0.5151 (0.4932) acc_x 87.5000 (86.2500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/16] time 0.190 (0.197) data 0.113 (0.100) loss_x loss_x 0.4424 (0.4737) acc_x 87.5000 (87.5000) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/16] time 0.181 (0.194) data 0.104 (0.104) loss_x loss_x 0.5044 (0.5436) acc_x 87.5000 (85.6250) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3236, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 523
clean true:463
clean false:60
clean_rate:0.8852772466539197
noisy true:565
noisy false:528
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1093
epoch [189/200] batch [5/16] time 0.214 (0.206) data 0.138 (0.108) loss_x loss_x 0.4768 (0.6360) acc_x 87.5000 (81.2500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/16] time 0.157 (0.191) data 0.080 (0.103) loss_x loss_x 0.9785 (0.6703) acc_x 78.1250 (81.2500) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/16] time 0.196 (0.188) data 0.120 (0.104) loss_x loss_x 0.5107 (0.6413) acc_x 87.5000 (81.8750) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.3274, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 529
clean true:456
clean false:73
clean_rate:0.8620037807183365
noisy true:571
noisy false:516
after delete: len(clean_dataset) 529
after delete: len(noisy_dataset) 1087
epoch [190/200] batch [5/16] time 0.177 (0.169) data 0.100 (0.092) loss_x loss_x 1.0332 (0.5741) acc_x 84.3750 (86.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/16] time 0.193 (0.173) data 0.117 (0.097) loss_x loss_x 0.6035 (0.6039) acc_x 87.5000 (86.5625) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/16] time 0.174 (0.172) data 0.098 (0.095) loss_x loss_x 0.5327 (0.6131) acc_x 90.6250 (85.8333) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 590
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:456
clean false:64
clean_rate:0.8769230769230769
noisy true:570
noisy false:526
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [191/200] batch [5/16] time 0.172 (0.169) data 0.096 (0.092) loss_x loss_x 0.5532 (0.7586) acc_x 84.3750 (80.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/16] time 0.177 (0.173) data 0.099 (0.096) loss_x loss_x 0.9004 (0.6704) acc_x 81.2500 (82.8125) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/16] time 0.172 (0.174) data 0.095 (0.097) loss_x loss_x 0.5430 (0.6359) acc_x 81.2500 (84.3750) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:454
clean false:60
clean_rate:0.8832684824902723
noisy true:564
noisy false:538
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [192/200] batch [5/16] time 0.170 (0.186) data 0.093 (0.109) loss_x loss_x 0.9736 (0.7712) acc_x 75.0000 (84.3750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/16] time 0.181 (0.177) data 0.105 (0.100) loss_x loss_x 0.2499 (0.6210) acc_x 96.8750 (86.8750) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/16] time 0.165 (0.175) data 0.087 (0.098) loss_x loss_x 0.4595 (0.5938) acc_x 90.6250 (86.8750) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:457
clean false:63
clean_rate:0.8788461538461538
noisy true:571
noisy false:525
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [193/200] batch [5/16] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.5078 (0.5105) acc_x 87.5000 (86.8750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/16] time 0.170 (0.184) data 0.094 (0.106) loss_x loss_x 0.2815 (0.4443) acc_x 90.6250 (89.3750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/16] time 0.177 (0.183) data 0.100 (0.105) loss_x loss_x 0.5605 (0.5213) acc_x 84.3750 (87.2917) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 524
clean true:458
clean false:66
clean_rate:0.8740458015267175
noisy true:572
noisy false:520
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1092
epoch [194/200] batch [5/16] time 0.163 (0.178) data 0.085 (0.101) loss_x loss_x 0.4097 (0.5772) acc_x 90.6250 (84.3750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/16] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.4897 (0.5416) acc_x 81.2500 (85.9375) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/16] time 0.173 (0.177) data 0.097 (0.101) loss_x loss_x 0.5796 (0.6051) acc_x 78.1250 (84.5833) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 539
clean true:475
clean false:64
clean_rate:0.8812615955473099
noisy true:575
noisy false:502
after delete: len(clean_dataset) 539
after delete: len(noisy_dataset) 1077
epoch [195/200] batch [5/16] time 0.156 (0.155) data 0.080 (0.078) loss_x loss_x 0.6577 (0.5603) acc_x 81.2500 (83.7500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/16] time 0.155 (0.156) data 0.078 (0.079) loss_x loss_x 1.0391 (0.5781) acc_x 75.0000 (85.9375) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [15/16] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.5898 (0.6154) acc_x 78.1250 (84.5833) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 579
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 524
clean true:459
clean false:65
clean_rate:0.8759541984732825
noisy true:578
noisy false:514
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1092
epoch [196/200] batch [5/16] time 0.164 (0.182) data 0.086 (0.105) loss_x loss_x 0.4790 (0.4508) acc_x 93.7500 (90.0000) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/16] time 0.197 (0.183) data 0.121 (0.106) loss_x loss_x 0.2213 (0.5046) acc_x 93.7500 (87.5000) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/16] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.4827 (0.5155) acc_x 87.5000 (87.5000) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.3236, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 523
clean true:458
clean false:65
clean_rate:0.875717017208413
noisy true:545
noisy false:548
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1093
epoch [197/200] batch [5/16] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.9639 (0.5395) acc_x 75.0000 (87.5000) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/16] time 0.182 (0.190) data 0.105 (0.114) loss_x loss_x 1.1084 (0.6072) acc_x 71.8750 (84.0625) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/16] time 0.186 (0.193) data 0.109 (0.116) loss_x loss_x 0.3462 (0.5440) acc_x 87.5000 (85.6250) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 585
confident_label rate tensor(0.3267, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 528
clean true:462
clean false:66
clean_rate:0.875
noisy true:569
noisy false:519
after delete: len(clean_dataset) 528
after delete: len(noisy_dataset) 1088
epoch [198/200] batch [5/16] time 0.158 (0.182) data 0.081 (0.106) loss_x loss_x 0.7827 (0.4657) acc_x 81.2500 (87.5000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/16] time 0.199 (0.179) data 0.123 (0.103) loss_x loss_x 0.8052 (0.6398) acc_x 87.5000 (83.7500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/16] time 0.159 (0.183) data 0.081 (0.099) loss_x loss_x 0.3835 (0.6336) acc_x 90.6250 (83.7500) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:447
clean false:64
clean_rate:0.8747553816046967
noisy true:581
noisy false:524
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [199/200] batch [5/15] time 0.161 (0.175) data 0.083 (0.097) loss_x loss_x 0.4861 (0.6013) acc_x 84.3750 (86.8750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/15] time 0.158 (0.166) data 0.081 (0.089) loss_x loss_x 0.5928 (0.5682) acc_x 75.0000 (85.6250) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [15/15] time 0.158 (0.178) data 0.081 (0.086) loss_x loss_x 0.8530 (0.5828) acc_x 84.3750 (85.8333) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.3280, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 530
clean true:461
clean false:69
clean_rate:0.869811320754717
noisy true:573
noisy false:513
after delete: len(clean_dataset) 530
after delete: len(noisy_dataset) 1086
epoch [200/200] batch [5/16] time 0.182 (0.174) data 0.105 (0.097) loss_x loss_x 0.5757 (0.5969) acc_x 84.3750 (85.0000) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/16] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 0.9014 (0.6705) acc_x 81.2500 (83.7500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/16] time 0.248 (0.183) data 0.171 (0.106) loss_x loss_x 0.6050 (0.6252) acc_x 84.3750 (85.0000) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,501
* accuracy: 66.1%
* error: 33.9%
* macro_f1: 63.9%
Elapsed: 0:38:04
