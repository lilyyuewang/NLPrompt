***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '101']
output_dir: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
resume: 
root: /home/convex/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: /home/convex/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.1986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 321
clean true:313
clean false:8
clean_rate:0.9750778816199377
noisy true:199
noisy false:1096
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 1295
epoch [1/200] batch [5/10] time 0.191 (0.210) data 0.113 (0.115) loss_x loss_x 2.7734 (2.6801) acc_x 37.5000 (45.0000) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/10] time 0.208 (0.199) data 0.130 (0.113) loss_x loss_x 2.3008 (2.5275) acc_x 62.5000 (51.5625) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1034
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:368
clean false:6
clean_rate:0.983957219251337
noisy true:214
noisy false:1028
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [2/200] batch [5/11] time 0.193 (0.192) data 0.114 (0.114) loss_x loss_x 1.8789 (1.6445) acc_x 59.3750 (61.2500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/11] time 0.192 (0.214) data 0.114 (0.128) loss_x loss_x 1.5752 (1.5217) acc_x 62.5000 (64.6875) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 849
confident_label rate tensor(0.2964, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 479
clean true:472
clean false:7
clean_rate:0.9853862212943633
noisy true:295
noisy false:842
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1137
epoch [3/200] batch [5/14] time 0.184 (0.204) data 0.107 (0.111) loss_x loss_x 1.1543 (1.3262) acc_x 68.7500 (68.1250) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/14] time 0.184 (0.194) data 0.107 (0.109) loss_x loss_x 1.5752 (1.2803) acc_x 56.2500 (67.8125) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 822
confident_label rate tensor(0.2983, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 482
clean true:478
clean false:4
clean_rate:0.991701244813278
noisy true:316
noisy false:818
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1134
epoch [4/200] batch [5/15] time 0.161 (0.172) data 0.084 (0.095) loss_x loss_x 0.8960 (0.9997) acc_x 71.8750 (73.1250) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/15] time 0.198 (0.186) data 0.122 (0.098) loss_x loss_x 1.2246 (1.1061) acc_x 71.8750 (72.1875) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [15/15] time 0.222 (0.188) data 0.145 (0.104) loss_x loss_x 1.1064 (1.1490) acc_x 68.7500 (71.2500) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 830
confident_label rate tensor(0.2983, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 482
clean true:479
clean false:3
clean_rate:0.9937759336099585
noisy true:307
noisy false:827
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1134
epoch [5/200] batch [5/15] time 0.166 (0.162) data 0.089 (0.085) loss_x loss_x 1.0586 (0.9862) acc_x 71.8750 (75.0000) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/15] time 0.271 (0.181) data 0.108 (0.089) loss_x loss_x 1.1133 (0.9442) acc_x 62.5000 (75.3125) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [15/15] time 0.161 (0.177) data 0.084 (0.091) loss_x loss_x 1.1201 (0.9632) acc_x 68.7500 (75.6250) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 824
confident_label rate tensor(0.3038, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 491
clean true:489
clean false:2
clean_rate:0.9959266802443992
noisy true:303
noisy false:822
after delete: len(clean_dataset) 491
after delete: len(noisy_dataset) 1125
epoch [6/200] batch [5/15] time 0.181 (0.199) data 0.105 (0.122) loss_x loss_x 0.7539 (1.1641) acc_x 81.2500 (71.2500) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/15] time 0.165 (0.188) data 0.089 (0.111) loss_x loss_x 0.9146 (1.0802) acc_x 75.0000 (73.7500) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [15/15] time 0.159 (0.181) data 0.083 (0.104) loss_x loss_x 1.0293 (1.0236) acc_x 78.1250 (75.2083) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 808
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:493
clean false:6
clean_rate:0.9879759519038076
noisy true:315
noisy false:802
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [7/200] batch [5/15] time 0.165 (0.168) data 0.088 (0.091) loss_x loss_x 0.6079 (1.0569) acc_x 84.3750 (71.8750) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/15] time 0.188 (0.190) data 0.111 (0.104) loss_x loss_x 1.6152 (1.1931) acc_x 65.6250 (70.9375) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [15/15] time 0.221 (0.194) data 0.144 (0.111) loss_x loss_x 0.9985 (1.0966) acc_x 71.8750 (72.7083) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 806
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 510
clean true:506
clean false:4
clean_rate:0.9921568627450981
noisy true:304
noisy false:802
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1106
epoch [8/200] batch [5/15] time 0.159 (0.174) data 0.081 (0.097) loss_x loss_x 0.7954 (0.9825) acc_x 87.5000 (75.0000) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/15] time 0.172 (0.172) data 0.094 (0.095) loss_x loss_x 1.2471 (1.0262) acc_x 65.6250 (74.3750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [15/15] time 0.174 (0.172) data 0.097 (0.095) loss_x loss_x 0.3960 (0.9915) acc_x 87.5000 (75.6250) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 791
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:509
clean false:5
clean_rate:0.9902723735408561
noisy true:316
noisy false:786
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [9/200] batch [5/16] time 0.179 (0.164) data 0.102 (0.087) loss_x loss_x 0.8345 (1.0956) acc_x 75.0000 (73.7500) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [10/16] time 0.161 (0.166) data 0.084 (0.089) loss_x loss_x 0.9443 (1.0582) acc_x 78.1250 (74.6875) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [15/16] time 0.335 (0.179) data 0.148 (0.095) loss_x loss_x 1.1543 (1.0792) acc_x 71.8750 (73.3333) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 805
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 510
clean true:505
clean false:5
clean_rate:0.9901960784313726
noisy true:306
noisy false:800
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1106
epoch [10/200] batch [5/15] time 0.184 (0.202) data 0.108 (0.126) loss_x loss_x 0.8408 (0.9228) acc_x 81.2500 (75.6250) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/15] time 0.161 (0.187) data 0.085 (0.110) loss_x loss_x 0.5981 (0.9906) acc_x 87.5000 (75.6250) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [15/15] time 0.172 (0.181) data 0.095 (0.105) loss_x loss_x 1.7979 (1.0810) acc_x 81.2500 (75.4167) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 759
confident_label rate tensor(0.3317, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 536
clean true:534
clean false:2
clean_rate:0.996268656716418
noisy true:323
noisy false:757
after delete: len(clean_dataset) 536
after delete: len(noisy_dataset) 1080
epoch [11/200] batch [5/16] time 0.184 (0.191) data 0.107 (0.114) loss_x loss_x 1.0068 (0.9513) acc_x 71.8750 (75.0000) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/16] time 0.158 (0.187) data 0.081 (0.110) loss_x loss_x 0.9932 (0.9515) acc_x 68.7500 (74.6875) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/16] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.9404 (0.9593) acc_x 68.7500 (75.4167) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 772
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:516
clean false:4
clean_rate:0.9923076923076923
noisy true:328
noisy false:768
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [12/200] batch [5/16] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.8052 (0.9391) acc_x 75.0000 (77.5000) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/16] time 0.180 (0.178) data 0.104 (0.101) loss_x loss_x 1.2578 (0.9308) acc_x 68.7500 (76.8750) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [15/16] time 0.216 (0.182) data 0.139 (0.105) loss_x loss_x 1.3936 (1.0531) acc_x 68.7500 (74.3750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 754
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 539
clean true:534
clean false:5
clean_rate:0.9907235621521335
noisy true:328
noisy false:749
after delete: len(clean_dataset) 539
after delete: len(noisy_dataset) 1077
epoch [13/200] batch [5/16] time 0.158 (0.158) data 0.082 (0.081) loss_x loss_x 1.1260 (1.0607) acc_x 59.3750 (69.3750) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [10/16] time 0.160 (0.159) data 0.084 (0.082) loss_x loss_x 0.9238 (1.0803) acc_x 71.8750 (71.5625) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [15/16] time 0.184 (0.176) data 0.108 (0.089) loss_x loss_x 0.9082 (1.0473) acc_x 78.1250 (73.3333) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 768
confident_label rate tensor(0.3280, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 530
clean true:525
clean false:5
clean_rate:0.9905660377358491
noisy true:323
noisy false:763
after delete: len(clean_dataset) 530
after delete: len(noisy_dataset) 1086
epoch [14/200] batch [5/16] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.6343 (0.9284) acc_x 84.3750 (74.3750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/16] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 1.0732 (1.0469) acc_x 78.1250 (70.9375) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [15/16] time 0.170 (0.181) data 0.094 (0.104) loss_x loss_x 1.1348 (1.0063) acc_x 68.7500 (72.5000) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 749
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 555
clean true:549
clean false:6
clean_rate:0.9891891891891892
noisy true:318
noisy false:743
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1061
epoch [15/200] batch [5/17] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.6460 (1.1409) acc_x 78.1250 (71.2500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/17] time 0.186 (0.183) data 0.108 (0.106) loss_x loss_x 1.2002 (1.1017) acc_x 71.8750 (71.8750) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [15/17] time 0.171 (0.180) data 0.094 (0.103) loss_x loss_x 1.1094 (1.1249) acc_x 68.7500 (70.4167) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 758
confident_label rate tensor(0.3354, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 542
clean true:540
clean false:2
clean_rate:0.996309963099631
noisy true:318
noisy false:756
after delete: len(clean_dataset) 542
after delete: len(noisy_dataset) 1074
epoch [16/200] batch [5/16] time 0.178 (0.182) data 0.102 (0.105) loss_x loss_x 0.9429 (0.9826) acc_x 81.2500 (75.0000) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/16] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 1.1514 (0.8920) acc_x 68.7500 (75.9375) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [15/16] time 0.198 (0.188) data 0.121 (0.111) loss_x loss_x 1.3555 (0.9311) acc_x 65.6250 (75.8333) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 753
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:542
clean false:5
clean_rate:0.9908592321755028
noisy true:321
noisy false:748
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [17/200] batch [5/17] time 0.185 (0.215) data 0.107 (0.113) loss_x loss_x 0.7104 (0.9766) acc_x 87.5000 (72.5000) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/17] time 0.177 (0.199) data 0.101 (0.110) loss_x loss_x 0.5679 (0.9276) acc_x 87.5000 (77.1875) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [15/17] time 0.181 (0.192) data 0.105 (0.107) loss_x loss_x 0.9102 (0.9376) acc_x 68.7500 (77.0833) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 737
confident_label rate tensor(0.3403, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 550
clean true:549
clean false:1
clean_rate:0.9981818181818182
noisy true:330
noisy false:736
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1066
epoch [18/200] batch [5/17] time 0.186 (0.175) data 0.109 (0.097) loss_x loss_x 1.0303 (1.0259) acc_x 78.1250 (78.7500) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/17] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.6509 (0.9754) acc_x 81.2500 (75.3125) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [15/17] time 0.165 (0.176) data 0.088 (0.099) loss_x loss_x 1.7051 (0.9854) acc_x 62.5000 (75.6250) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 738
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:544
clean false:3
clean_rate:0.9945155393053017
noisy true:334
noisy false:735
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [19/200] batch [5/17] time 0.181 (0.206) data 0.104 (0.107) loss_x loss_x 1.1543 (0.9128) acc_x 68.7500 (77.5000) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/17] time 0.158 (0.191) data 0.082 (0.103) loss_x loss_x 0.8564 (0.8803) acc_x 75.0000 (76.5625) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [15/17] time 0.178 (0.182) data 0.101 (0.098) loss_x loss_x 1.3066 (0.9252) acc_x 71.8750 (76.0417) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 747
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 535
clean true:533
clean false:2
clean_rate:0.9962616822429906
noisy true:336
noisy false:745
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1081
epoch [20/200] batch [5/16] time 0.186 (0.171) data 0.091 (0.091) loss_x loss_x 0.8154 (0.8757) acc_x 75.0000 (75.0000) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/16] time 0.169 (0.187) data 0.092 (0.095) loss_x loss_x 0.7583 (0.9393) acc_x 81.2500 (75.3125) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [15/16] time 0.178 (0.183) data 0.101 (0.097) loss_x loss_x 1.2236 (0.9751) acc_x 62.5000 (73.7500) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 734
confident_label rate tensor(0.3515, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 568
clean true:562
clean false:6
clean_rate:0.9894366197183099
noisy true:320
noisy false:728
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1048
epoch [21/200] batch [5/17] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.8545 (0.9885) acc_x 84.3750 (76.8750) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [10/17] time 0.196 (0.177) data 0.118 (0.100) loss_x loss_x 0.8467 (0.9800) acc_x 84.3750 (77.1875) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [15/17] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.7856 (0.9466) acc_x 81.2500 (77.0833) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 755
confident_label rate tensor(0.3416, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 552
clean true:550
clean false:2
clean_rate:0.9963768115942029
noisy true:311
noisy false:753
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 1064
epoch [22/200] batch [5/17] time 0.167 (0.189) data 0.090 (0.112) loss_x loss_x 1.1904 (0.8748) acc_x 68.7500 (76.8750) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/17] time 0.277 (0.205) data 0.098 (0.107) loss_x loss_x 0.6885 (0.8788) acc_x 87.5000 (78.1250) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [15/17] time 0.165 (0.200) data 0.089 (0.109) loss_x loss_x 1.2832 (0.9169) acc_x 59.3750 (76.6667) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 765
confident_label rate tensor(0.3410, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 551
clean true:544
clean false:7
clean_rate:0.9872958257713249
noisy true:307
noisy false:758
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1065
epoch [23/200] batch [5/17] time 0.159 (0.158) data 0.082 (0.081) loss_x loss_x 0.9141 (1.1143) acc_x 75.0000 (74.3750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/17] time 0.169 (0.160) data 0.091 (0.083) loss_x loss_x 1.1055 (1.0572) acc_x 71.8750 (72.1875) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [15/17] time 0.159 (0.177) data 0.083 (0.086) loss_x loss_x 0.9985 (0.9647) acc_x 75.0000 (74.5833) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 726
confident_label rate tensor(0.3465, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 560
clean true:558
clean false:2
clean_rate:0.9964285714285714
noisy true:332
noisy false:724
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1056
epoch [24/200] batch [5/17] time 0.208 (0.189) data 0.131 (0.112) loss_x loss_x 0.8110 (0.7946) acc_x 81.2500 (79.3750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/17] time 0.181 (0.188) data 0.105 (0.112) loss_x loss_x 0.8340 (0.8601) acc_x 78.1250 (76.5625) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [15/17] time 0.173 (0.184) data 0.096 (0.107) loss_x loss_x 0.9888 (0.8412) acc_x 68.7500 (75.8333) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 679
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 598
clean true:596
clean false:2
clean_rate:0.9966555183946488
noisy true:341
noisy false:677
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1018
epoch [25/200] batch [5/18] time 0.305 (0.194) data 0.118 (0.095) loss_x loss_x 0.8149 (0.8205) acc_x 75.0000 (77.5000) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/18] time 0.193 (0.198) data 0.117 (0.110) loss_x loss_x 0.9834 (0.9146) acc_x 78.1250 (74.6875) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [15/18] time 0.175 (0.192) data 0.097 (0.108) loss_x loss_x 0.8291 (0.9212) acc_x 81.2500 (74.7917) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 734
confident_label rate tensor(0.3453, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 558
clean true:555
clean false:3
clean_rate:0.9946236559139785
noisy true:327
noisy false:731
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1058
epoch [26/200] batch [5/17] time 0.172 (0.165) data 0.094 (0.088) loss_x loss_x 0.7935 (0.9905) acc_x 81.2500 (75.6250) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/17] time 0.217 (0.187) data 0.100 (0.096) loss_x loss_x 0.7109 (0.8876) acc_x 75.0000 (76.2500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/17] time 0.183 (0.187) data 0.106 (0.100) loss_x loss_x 0.8477 (0.9239) acc_x 84.3750 (76.8750) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 683
confident_label rate tensor(0.3645, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 589
clean true:585
clean false:4
clean_rate:0.9932088285229203
noisy true:348
noisy false:679
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 1027
epoch [27/200] batch [5/18] time 0.185 (0.187) data 0.108 (0.109) loss_x loss_x 1.1201 (1.0013) acc_x 59.3750 (72.5000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/18] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.5962 (0.9021) acc_x 87.5000 (75.6250) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/18] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.5293 (0.9122) acc_x 84.3750 (76.2500) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.3601, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 582
clean true:579
clean false:3
clean_rate:0.9948453608247423
noisy true:344
noisy false:690
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1034
epoch [28/200] batch [5/18] time 0.275 (0.205) data 0.099 (0.108) loss_x loss_x 1.1709 (0.9408) acc_x 68.7500 (73.7500) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/18] time 0.170 (0.192) data 0.093 (0.098) loss_x loss_x 0.6943 (0.8350) acc_x 78.1250 (77.8125) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/18] time 0.163 (0.187) data 0.087 (0.098) loss_x loss_x 1.1143 (0.8386) acc_x 68.7500 (77.5000) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 698
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 591
clean true:588
clean false:3
clean_rate:0.9949238578680203
noisy true:330
noisy false:695
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1025
epoch [29/200] batch [5/18] time 0.172 (0.176) data 0.095 (0.099) loss_x loss_x 0.4631 (0.8337) acc_x 84.3750 (76.2500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/18] time 0.180 (0.173) data 0.102 (0.096) loss_x loss_x 0.6665 (0.7584) acc_x 78.1250 (78.7500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/18] time 0.172 (0.170) data 0.094 (0.093) loss_x loss_x 0.8530 (0.8647) acc_x 81.2500 (77.2917) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 667
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:595
clean false:2
clean_rate:0.9966499162479062
noisy true:354
noisy false:665
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [30/200] batch [5/18] time 0.163 (0.176) data 0.086 (0.098) loss_x loss_x 0.8203 (0.7083) acc_x 81.2500 (81.8750) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/18] time 0.164 (0.169) data 0.087 (0.092) loss_x loss_x 0.7285 (0.7716) acc_x 71.8750 (78.7500) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/18] time 0.184 (0.172) data 0.107 (0.095) loss_x loss_x 1.0381 (0.7680) acc_x 68.7500 (78.1250) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 710
confident_label rate tensor(0.3589, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 580
clean true:575
clean false:5
clean_rate:0.9913793103448276
noisy true:331
noisy false:705
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1036
epoch [31/200] batch [5/18] time 0.161 (0.176) data 0.083 (0.099) loss_x loss_x 1.1768 (0.9131) acc_x 75.0000 (76.8750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/18] time 0.184 (0.176) data 0.105 (0.099) loss_x loss_x 0.9741 (0.8354) acc_x 68.7500 (75.9375) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/18] time 0.299 (0.189) data 0.113 (0.101) loss_x loss_x 0.6899 (0.8495) acc_x 81.2500 (76.4583) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.3632, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 587
clean true:585
clean false:2
clean_rate:0.9965928449744463
noisy true:346
noisy false:683
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1029
epoch [32/200] batch [5/18] time 0.172 (0.178) data 0.095 (0.101) loss_x loss_x 0.7573 (0.8266) acc_x 75.0000 (73.7500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/18] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 1.0879 (0.8005) acc_x 65.6250 (75.9375) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/18] time 0.185 (0.184) data 0.108 (0.094) loss_x loss_x 0.9507 (0.8043) acc_x 71.8750 (77.7083) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 679
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:583
clean false:3
clean_rate:0.9948805460750854
noisy true:354
noisy false:676
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [33/200] batch [5/18] time 0.169 (0.177) data 0.091 (0.100) loss_x loss_x 0.8628 (0.8369) acc_x 75.0000 (77.5000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/18] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.9204 (0.8300) acc_x 78.1250 (79.0625) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/18] time 0.159 (0.175) data 0.082 (0.098) loss_x loss_x 0.8799 (0.8246) acc_x 78.1250 (78.5417) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 701
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 577
clean true:574
clean false:3
clean_rate:0.9948006932409013
noisy true:341
noisy false:698
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1039
epoch [34/200] batch [5/18] time 0.174 (0.172) data 0.098 (0.095) loss_x loss_x 0.7305 (0.8646) acc_x 78.1250 (76.2500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/18] time 0.181 (0.178) data 0.105 (0.102) loss_x loss_x 0.2998 (0.8263) acc_x 90.6250 (76.8750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/18] time 0.169 (0.175) data 0.092 (0.099) loss_x loss_x 0.7998 (0.7455) acc_x 78.1250 (79.1667) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 667
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 607
clean true:601
clean false:6
clean_rate:0.9901153212520593
noisy true:348
noisy false:661
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1009
epoch [35/200] batch [5/18] time 0.187 (0.182) data 0.110 (0.106) loss_x loss_x 1.1738 (0.8640) acc_x 65.6250 (78.7500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/18] time 0.183 (0.179) data 0.107 (0.103) loss_x loss_x 0.7324 (0.8593) acc_x 81.2500 (76.8750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/18] time 0.186 (0.178) data 0.110 (0.101) loss_x loss_x 0.7373 (0.8479) acc_x 81.2500 (77.2917) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 663
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 612
clean true:605
clean false:7
clean_rate:0.988562091503268
noisy true:348
noisy false:656
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1004
epoch [36/200] batch [5/19] time 0.203 (0.187) data 0.127 (0.111) loss_x loss_x 0.4995 (0.7554) acc_x 87.5000 (76.8750) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/19] time 0.172 (0.179) data 0.095 (0.103) loss_x loss_x 1.1992 (0.9230) acc_x 75.0000 (76.2500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/19] time 0.185 (0.195) data 0.109 (0.104) loss_x loss_x 0.6562 (0.9625) acc_x 81.2500 (76.0417) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 661
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 619
clean true:616
clean false:3
clean_rate:0.9951534733441034
noisy true:339
noisy false:658
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 997
epoch [37/200] batch [5/19] time 0.171 (0.174) data 0.094 (0.097) loss_x loss_x 1.0273 (0.8045) acc_x 71.8750 (79.3750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/19] time 0.159 (0.174) data 0.082 (0.097) loss_x loss_x 0.5215 (0.8764) acc_x 84.3750 (78.7500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/19] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.8862 (0.8957) acc_x 68.7500 (77.5000) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 669
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:606
clean false:3
clean_rate:0.9950738916256158
noisy true:341
noisy false:666
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [38/200] batch [5/19] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.7983 (0.8456) acc_x 78.1250 (76.2500) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/19] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.8496 (0.8810) acc_x 78.1250 (77.1875) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/19] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.8540 (0.8602) acc_x 81.2500 (79.3750) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 658
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 618
clean true:615
clean false:3
clean_rate:0.9951456310679612
noisy true:343
noisy false:655
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 998
epoch [39/200] batch [5/19] time 0.183 (0.191) data 0.107 (0.114) loss_x loss_x 0.7378 (0.8305) acc_x 71.8750 (78.7500) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/19] time 0.177 (0.182) data 0.099 (0.105) loss_x loss_x 1.0166 (0.9179) acc_x 75.0000 (76.8750) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/19] time 0.221 (0.188) data 0.143 (0.111) loss_x loss_x 0.4482 (0.9147) acc_x 90.6250 (76.2500) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:632
clean false:8
clean_rate:0.9875
noisy true:346
noisy false:630
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [40/200] batch [5/20] time 0.182 (0.177) data 0.106 (0.100) loss_x loss_x 0.8145 (0.9212) acc_x 75.0000 (78.7500) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/20] time 0.188 (0.181) data 0.110 (0.104) loss_x loss_x 0.6846 (0.8852) acc_x 78.1250 (77.5000) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.9033 (0.9599) acc_x 75.0000 (75.4167) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [20/20] time 0.169 (0.180) data 0.092 (0.103) loss_x loss_x 0.9751 (0.9836) acc_x 78.1250 (75.7812) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:626
clean false:2
clean_rate:0.9968152866242038
noisy true:352
noisy false:636
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [41/200] batch [5/19] time 0.168 (0.168) data 0.092 (0.091) loss_x loss_x 0.7754 (0.7132) acc_x 81.2500 (80.0000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/19] time 0.168 (0.168) data 0.090 (0.091) loss_x loss_x 0.7642 (0.8274) acc_x 71.8750 (76.5625) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/19] time 0.166 (0.171) data 0.089 (0.094) loss_x loss_x 0.8716 (0.8762) acc_x 71.8750 (75.2083) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 657
confident_label rate tensor(0.3849, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 622
clean true:614
clean false:8
clean_rate:0.9871382636655949
noisy true:345
noisy false:649
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 994
epoch [42/200] batch [5/19] time 0.182 (0.184) data 0.105 (0.108) loss_x loss_x 0.8774 (0.8347) acc_x 78.1250 (76.8750) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/19] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.9443 (0.8443) acc_x 71.8750 (78.1250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/19] time 0.177 (0.178) data 0.100 (0.101) loss_x loss_x 1.1270 (0.8715) acc_x 78.1250 (77.7083) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 651
confident_label rate tensor(0.3892, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 629
clean true:625
clean false:4
clean_rate:0.9936406995230525
noisy true:340
noisy false:647
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 987
epoch [43/200] batch [5/19] time 0.186 (0.190) data 0.108 (0.113) loss_x loss_x 0.3210 (0.9287) acc_x 90.6250 (78.1250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/19] time 0.190 (0.188) data 0.113 (0.111) loss_x loss_x 0.9473 (0.7932) acc_x 78.1250 (79.0625) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/19] time 0.176 (0.185) data 0.099 (0.108) loss_x loss_x 0.6543 (0.8169) acc_x 78.1250 (78.9583) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 642
confident_label rate tensor(0.3855, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 623
clean true:620
clean false:3
clean_rate:0.9951845906902087
noisy true:354
noisy false:639
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 993
epoch [44/200] batch [5/19] time 0.186 (0.188) data 0.108 (0.111) loss_x loss_x 0.5645 (0.7748) acc_x 81.2500 (76.8750) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/19] time 0.198 (0.200) data 0.120 (0.112) loss_x loss_x 0.9492 (0.7208) acc_x 78.1250 (80.3125) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/19] time 0.175 (0.193) data 0.098 (0.109) loss_x loss_x 0.8110 (0.7559) acc_x 71.8750 (79.1667) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 647
confident_label rate tensor(0.3812, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 616
clean true:612
clean false:4
clean_rate:0.9935064935064936
noisy true:357
noisy false:643
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1000
epoch [45/200] batch [5/19] time 0.163 (0.171) data 0.086 (0.094) loss_x loss_x 1.0283 (0.8474) acc_x 65.6250 (77.5000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/19] time 0.162 (0.176) data 0.085 (0.099) loss_x loss_x 0.8438 (0.8270) acc_x 68.7500 (77.5000) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/19] time 0.164 (0.174) data 0.086 (0.097) loss_x loss_x 0.8350 (0.8150) acc_x 81.2500 (78.5417) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.3849, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 622
clean true:617
clean false:5
clean_rate:0.9919614147909968
noisy true:360
noisy false:634
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 994
epoch [46/200] batch [5/19] time 0.161 (0.160) data 0.083 (0.083) loss_x loss_x 0.4485 (0.5846) acc_x 84.3750 (84.3750) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/19] time 0.161 (0.160) data 0.085 (0.083) loss_x loss_x 0.8374 (0.6806) acc_x 71.8750 (80.9375) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/19] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 1.1787 (0.8113) acc_x 71.8750 (79.1667) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:625
clean false:3
clean_rate:0.9952229299363057
noisy true:365
noisy false:623
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [47/200] batch [5/19] time 0.164 (0.179) data 0.088 (0.103) loss_x loss_x 1.0547 (0.7024) acc_x 78.1250 (82.5000) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/19] time 0.173 (0.176) data 0.097 (0.099) loss_x loss_x 0.5347 (0.7849) acc_x 87.5000 (80.3125) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/19] time 0.187 (0.176) data 0.109 (0.100) loss_x loss_x 0.9209 (0.7788) acc_x 84.3750 (80.8333) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.3942, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 637
clean true:635
clean false:2
clean_rate:0.9968602825745683
noisy true:371
noisy false:608
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 979
epoch [48/200] batch [5/19] time 0.190 (0.180) data 0.114 (0.103) loss_x loss_x 0.7607 (0.7715) acc_x 84.3750 (80.0000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/19] time 0.168 (0.182) data 0.092 (0.105) loss_x loss_x 0.9824 (0.7285) acc_x 81.2500 (80.9375) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/19] time 0.178 (0.177) data 0.102 (0.101) loss_x loss_x 0.9038 (0.7872) acc_x 81.2500 (79.3750) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 660
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 614
clean true:610
clean false:4
clean_rate:0.993485342019544
noisy true:346
noisy false:656
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1002
epoch [49/200] batch [5/19] time 0.160 (0.175) data 0.083 (0.099) loss_x loss_x 0.4692 (0.6901) acc_x 90.6250 (83.7500) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/19] time 0.158 (0.190) data 0.082 (0.102) loss_x loss_x 0.8740 (0.8078) acc_x 78.1250 (80.6250) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/19] time 0.169 (0.184) data 0.093 (0.100) loss_x loss_x 0.8271 (0.8144) acc_x 75.0000 (80.0000) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 626
clean true:620
clean false:6
clean_rate:0.9904153354632588
noisy true:350
noisy false:640
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 990
epoch [50/200] batch [5/19] time 0.164 (0.163) data 0.086 (0.086) loss_x loss_x 1.2285 (0.7275) acc_x 71.8750 (81.8750) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/19] time 0.165 (0.162) data 0.089 (0.086) loss_x loss_x 0.4739 (0.7091) acc_x 87.5000 (80.9375) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/19] time 0.180 (0.166) data 0.104 (0.089) loss_x loss_x 1.1289 (0.7936) acc_x 75.0000 (78.5417) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 633
confident_label rate tensor(0.3880, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 627
clean true:624
clean false:3
clean_rate:0.9952153110047847
noisy true:359
noisy false:630
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 989
epoch [51/200] batch [5/19] time 0.156 (0.171) data 0.079 (0.095) loss_x loss_x 0.7612 (0.8180) acc_x 78.1250 (78.1250) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/19] time 0.175 (0.172) data 0.099 (0.095) loss_x loss_x 0.7612 (0.7459) acc_x 81.2500 (81.5625) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/19] time 0.162 (0.175) data 0.085 (0.099) loss_x loss_x 1.0391 (0.7650) acc_x 71.8750 (80.6250) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.3967, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 641
clean true:638
clean false:3
clean_rate:0.9953198127925117
noisy true:340
noisy false:635
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 975
epoch [52/200] batch [5/20] time 0.174 (0.195) data 0.097 (0.118) loss_x loss_x 0.9053 (0.9869) acc_x 71.8750 (75.0000) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/20] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.6489 (0.8824) acc_x 87.5000 (77.8125) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/20] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.9033 (0.8484) acc_x 71.8750 (78.3333) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [20/20] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 1.2012 (0.8301) acc_x 68.7500 (78.5938) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.3960, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 640
clean true:636
clean false:4
clean_rate:0.99375
noisy true:375
noisy false:601
after delete: len(clean_dataset) 640
after delete: len(noisy_dataset) 976
epoch [53/200] batch [5/20] time 0.178 (0.172) data 0.101 (0.095) loss_x loss_x 0.7617 (0.8132) acc_x 78.1250 (78.1250) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/20] time 0.186 (0.173) data 0.110 (0.096) loss_x loss_x 0.5205 (0.7628) acc_x 90.6250 (80.6250) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/20] time 0.178 (0.178) data 0.102 (0.101) loss_x loss_x 0.9756 (0.8089) acc_x 81.2500 (79.5833) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [20/20] time 0.163 (0.177) data 0.086 (0.100) loss_x loss_x 0.4951 (0.8332) acc_x 87.5000 (78.7500) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 653
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:599
clean false:3
clean_rate:0.9950166112956811
noisy true:364
noisy false:650
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [54/200] batch [5/18] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 0.7002 (0.5281) acc_x 87.5000 (88.7500) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/18] time 0.157 (0.172) data 0.080 (0.095) loss_x loss_x 0.9585 (0.7208) acc_x 71.8750 (82.8125) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/18] time 0.181 (0.172) data 0.105 (0.095) loss_x loss_x 0.6655 (0.7313) acc_x 81.2500 (82.0833) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.3880, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 627
clean true:624
clean false:3
clean_rate:0.9952153110047847
noisy true:366
noisy false:623
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 989
epoch [55/200] batch [5/19] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.4126 (0.8189) acc_x 84.3750 (76.8750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/19] time 0.293 (0.201) data 0.106 (0.107) loss_x loss_x 0.5166 (0.7820) acc_x 87.5000 (78.4375) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/19] time 0.183 (0.198) data 0.106 (0.110) loss_x loss_x 1.3994 (0.8280) acc_x 62.5000 (77.5000) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.4084, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 660
clean true:656
clean false:4
clean_rate:0.9939393939393939
noisy true:364
noisy false:592
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 956
epoch [56/200] batch [5/20] time 0.171 (0.179) data 0.095 (0.101) loss_x loss_x 1.0020 (0.8472) acc_x 68.7500 (74.3750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/20] time 0.184 (0.190) data 0.107 (0.102) loss_x loss_x 0.6309 (0.8509) acc_x 87.5000 (76.2500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/20] time 0.170 (0.184) data 0.093 (0.100) loss_x loss_x 0.3940 (0.7793) acc_x 87.5000 (78.5417) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [20/20] time 0.161 (0.180) data 0.085 (0.098) loss_x loss_x 0.5347 (0.7861) acc_x 84.3750 (78.9062) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 642
confident_label rate tensor(0.3942, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 637
clean true:631
clean false:6
clean_rate:0.9905808477237049
noisy true:343
noisy false:636
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 979
epoch [57/200] batch [5/19] time 0.169 (0.180) data 0.093 (0.103) loss_x loss_x 0.8140 (0.8877) acc_x 75.0000 (77.5000) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/19] time 0.196 (0.177) data 0.119 (0.100) loss_x loss_x 0.6348 (0.7809) acc_x 84.3750 (78.7500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/19] time 0.163 (0.174) data 0.085 (0.097) loss_x loss_x 1.2295 (0.8198) acc_x 71.8750 (78.9583) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.4028, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 651
clean true:649
clean false:2
clean_rate:0.9969278033794163
noisy true:369
noisy false:596
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 965
epoch [58/200] batch [5/20] time 0.187 (0.176) data 0.109 (0.098) loss_x loss_x 0.8008 (0.7978) acc_x 78.1250 (78.7500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/20] time 0.165 (0.172) data 0.088 (0.094) loss_x loss_x 0.7207 (0.7767) acc_x 75.0000 (77.8125) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/20] time 0.160 (0.167) data 0.083 (0.090) loss_x loss_x 1.1660 (0.7844) acc_x 68.7500 (77.9167) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [20/20] time 0.158 (0.165) data 0.081 (0.088) loss_x loss_x 0.5166 (0.7872) acc_x 84.3750 (77.9688) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 656
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:622
clean false:6
clean_rate:0.9904458598726115
noisy true:338
noisy false:650
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [59/200] batch [5/19] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.6387 (0.5764) acc_x 84.3750 (83.7500) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/19] time 0.237 (0.201) data 0.107 (0.108) loss_x loss_x 1.0273 (0.6592) acc_x 75.0000 (82.5000) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/19] time 0.182 (0.195) data 0.106 (0.107) loss_x loss_x 0.7295 (0.6250) acc_x 84.3750 (83.3333) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.3967, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 641
clean true:636
clean false:5
clean_rate:0.9921996879875195
noisy true:357
noisy false:618
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 975
epoch [60/200] batch [5/20] time 0.172 (0.203) data 0.094 (0.098) loss_x loss_x 0.7500 (0.8013) acc_x 84.3750 (81.8750) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/20] time 0.180 (0.184) data 0.103 (0.094) loss_x loss_x 0.8721 (0.7738) acc_x 78.1250 (79.6875) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/20] time 0.195 (0.185) data 0.118 (0.099) loss_x loss_x 0.7954 (0.8173) acc_x 68.7500 (78.7500) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [20/20] time 0.188 (0.185) data 0.111 (0.102) loss_x loss_x 0.9565 (0.7951) acc_x 78.1250 (79.6875) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.4041, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 653
clean true:648
clean false:5
clean_rate:0.9923430321592649
noisy true:342
noisy false:621
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 963
epoch [61/200] batch [5/20] time 0.175 (0.189) data 0.097 (0.103) loss_x loss_x 0.8047 (0.7448) acc_x 71.8750 (80.6250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/20] time 0.183 (0.191) data 0.106 (0.110) loss_x loss_x 0.7905 (0.6573) acc_x 81.2500 (83.4375) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/20] time 0.177 (0.186) data 0.100 (0.106) loss_x loss_x 0.9683 (0.6965) acc_x 75.0000 (83.1250) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [20/20] time 0.177 (0.190) data 0.101 (0.107) loss_x loss_x 0.6562 (0.7034) acc_x 84.3750 (82.3438) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.4010, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 648
clean true:643
clean false:5
clean_rate:0.9922839506172839
noisy true:352
noisy false:616
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 968
epoch [62/200] batch [5/20] time 0.157 (0.164) data 0.081 (0.087) loss_x loss_x 0.9692 (0.7044) acc_x 78.1250 (80.0000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/20] time 0.182 (0.166) data 0.105 (0.090) loss_x loss_x 1.2979 (0.6830) acc_x 75.0000 (82.8125) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/20] time 0.187 (0.186) data 0.110 (0.095) loss_x loss_x 0.8916 (0.7968) acc_x 78.1250 (79.3750) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [20/20] time 0.186 (0.186) data 0.108 (0.099) loss_x loss_x 0.6455 (0.7763) acc_x 81.2500 (80.0000) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 615
confident_label rate tensor(0.4010, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 648
clean true:645
clean false:3
clean_rate:0.9953703703703703
noisy true:356
noisy false:612
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 968
epoch [63/200] batch [5/20] time 0.184 (0.193) data 0.108 (0.116) loss_x loss_x 0.8623 (0.6898) acc_x 71.8750 (80.0000) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/20] time 0.189 (0.190) data 0.112 (0.113) loss_x loss_x 0.7314 (0.7247) acc_x 81.2500 (80.3125) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/20] time 0.177 (0.188) data 0.100 (0.111) loss_x loss_x 0.5347 (0.7700) acc_x 87.5000 (79.1667) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [20/20] time 0.181 (0.183) data 0.103 (0.106) loss_x loss_x 0.8071 (0.8207) acc_x 78.1250 (78.2812) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 600
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 657
clean true:651
clean false:6
clean_rate:0.9908675799086758
noisy true:365
noisy false:594
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 959
epoch [64/200] batch [5/20] time 0.199 (0.188) data 0.121 (0.111) loss_x loss_x 0.7144 (0.7470) acc_x 78.1250 (80.0000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/20] time 0.183 (0.182) data 0.104 (0.105) loss_x loss_x 0.8271 (0.7259) acc_x 78.1250 (80.3125) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/20] time 0.177 (0.179) data 0.099 (0.102) loss_x loss_x 0.6274 (0.7850) acc_x 84.3750 (80.0000) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [20/20] time 0.179 (0.179) data 0.103 (0.102) loss_x loss_x 0.7271 (0.7552) acc_x 81.2500 (81.0938) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.3998, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 646
clean true:640
clean false:6
clean_rate:0.9907120743034056
noisy true:379
noisy false:591
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 970
epoch [65/200] batch [5/20] time 0.185 (0.186) data 0.109 (0.110) loss_x loss_x 0.3901 (0.7149) acc_x 93.7500 (80.6250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/20] time 0.188 (0.190) data 0.111 (0.113) loss_x loss_x 0.8730 (0.7327) acc_x 78.1250 (81.8750) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/20] time 0.183 (0.189) data 0.107 (0.112) loss_x loss_x 1.0342 (0.7507) acc_x 84.3750 (82.0833) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [20/20] time 0.216 (0.197) data 0.140 (0.112) loss_x loss_x 0.6548 (0.7581) acc_x 81.2500 (81.5625) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.4103, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 663
clean true:657
clean false:6
clean_rate:0.9909502262443439
noisy true:360
noisy false:593
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 953
epoch [66/200] batch [5/20] time 0.175 (0.179) data 0.097 (0.101) loss_x loss_x 0.4854 (0.7046) acc_x 87.5000 (80.6250) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/20] time 0.184 (0.179) data 0.107 (0.101) loss_x loss_x 0.3721 (0.6294) acc_x 87.5000 (84.0625) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/20] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.6963 (0.6455) acc_x 84.3750 (83.7500) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [20/20] time 0.168 (0.175) data 0.090 (0.098) loss_x loss_x 0.8208 (0.6901) acc_x 78.1250 (82.0312) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.4053, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 655
clean true:653
clean false:2
clean_rate:0.9969465648854962
noisy true:375
noisy false:586
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 961
epoch [67/200] batch [5/20] time 0.172 (0.176) data 0.094 (0.099) loss_x loss_x 1.1768 (0.7874) acc_x 75.0000 (82.5000) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/20] time 0.171 (0.178) data 0.093 (0.101) loss_x loss_x 0.7505 (0.7199) acc_x 84.3750 (82.5000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/20] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.4521 (0.7217) acc_x 93.7500 (81.8750) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [20/20] time 0.293 (0.183) data 0.107 (0.101) loss_x loss_x 0.7642 (0.7133) acc_x 87.5000 (82.0312) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 568
confident_label rate tensor(0.4183, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 676
clean true:672
clean false:4
clean_rate:0.9940828402366864
noisy true:376
noisy false:564
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 940
epoch [68/200] batch [5/21] time 0.161 (0.180) data 0.084 (0.102) loss_x loss_x 0.6460 (0.7035) acc_x 81.2500 (78.1250) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/21] time 0.199 (0.185) data 0.122 (0.108) loss_x loss_x 0.7505 (0.6593) acc_x 78.1250 (79.6875) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/21] time 0.187 (0.199) data 0.109 (0.114) loss_x loss_x 1.1250 (0.7204) acc_x 71.8750 (79.5833) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/21] time 0.176 (0.193) data 0.100 (0.111) loss_x loss_x 0.5947 (0.7725) acc_x 84.3750 (77.8125) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.4084, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 660
clean true:655
clean false:5
clean_rate:0.9924242424242424
noisy true:377
noisy false:579
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 956
epoch [69/200] batch [5/20] time 0.187 (0.184) data 0.109 (0.107) loss_x loss_x 0.5410 (0.7297) acc_x 84.3750 (81.2500) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/20] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.7671 (0.7894) acc_x 81.2500 (80.0000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/20] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.6597 (0.8092) acc_x 81.2500 (78.7500) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [20/20] time 0.167 (0.181) data 0.089 (0.104) loss_x loss_x 1.2051 (0.8071) acc_x 71.8750 (79.0625) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.4109, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 664
clean true:660
clean false:4
clean_rate:0.9939759036144579
noisy true:354
noisy false:598
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 952
epoch [70/200] batch [5/20] time 0.219 (0.183) data 0.081 (0.094) loss_x loss_x 0.5771 (0.7291) acc_x 78.1250 (81.8750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/20] time 0.230 (0.192) data 0.153 (0.101) loss_x loss_x 0.6987 (0.7792) acc_x 81.2500 (80.6250) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/20] time 0.180 (0.190) data 0.103 (0.104) loss_x loss_x 0.7144 (0.8028) acc_x 81.2500 (79.1667) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [20/20] time 0.187 (0.190) data 0.110 (0.106) loss_x loss_x 0.8887 (0.7823) acc_x 71.8750 (79.8438) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 657
clean true:651
clean false:6
clean_rate:0.9908675799086758
noisy true:360
noisy false:599
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 959
epoch [71/200] batch [5/20] time 0.183 (0.180) data 0.107 (0.104) loss_x loss_x 0.6587 (0.6452) acc_x 84.3750 (84.3750) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/20] time 0.169 (0.193) data 0.092 (0.102) loss_x loss_x 0.6558 (0.6627) acc_x 75.0000 (81.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/20] time 0.180 (0.186) data 0.104 (0.101) loss_x loss_x 0.9546 (0.6735) acc_x 75.0000 (81.4583) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [20/20] time 0.167 (0.181) data 0.090 (0.098) loss_x loss_x 0.7026 (0.7009) acc_x 75.0000 (80.7812) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 568
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 688
clean true:681
clean false:7
clean_rate:0.9898255813953488
noisy true:367
noisy false:561
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 928
epoch [72/200] batch [5/21] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.6743 (0.7369) acc_x 87.5000 (80.0000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/21] time 0.185 (0.189) data 0.108 (0.112) loss_x loss_x 0.7788 (0.8426) acc_x 87.5000 (79.0625) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/21] time 0.188 (0.187) data 0.103 (0.110) loss_x loss_x 0.6509 (0.8375) acc_x 87.5000 (80.0000) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/21] time 0.163 (0.185) data 0.086 (0.106) loss_x loss_x 0.5195 (0.8519) acc_x 84.3750 (78.9062) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.4115, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 665
clean true:662
clean false:3
clean_rate:0.9954887218045113
noisy true:368
noisy false:583
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 951
epoch [73/200] batch [5/20] time 0.185 (0.180) data 0.108 (0.104) loss_x loss_x 0.8003 (0.8063) acc_x 84.3750 (78.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/20] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.3560 (0.7653) acc_x 87.5000 (78.7500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/20] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.6357 (0.7792) acc_x 84.3750 (79.1667) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [20/20] time 0.174 (0.181) data 0.098 (0.105) loss_x loss_x 0.8882 (0.7742) acc_x 75.0000 (79.8438) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.4016, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 649
clean true:645
clean false:4
clean_rate:0.9938366718027735
noisy true:351
noisy false:616
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 967
epoch [74/200] batch [5/20] time 0.166 (0.179) data 0.090 (0.102) loss_x loss_x 1.0244 (0.8467) acc_x 81.2500 (78.1250) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/20] time 0.185 (0.176) data 0.107 (0.099) loss_x loss_x 0.6924 (0.8543) acc_x 81.2500 (75.9375) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/20] time 0.164 (0.176) data 0.087 (0.099) loss_x loss_x 0.6577 (0.8195) acc_x 87.5000 (78.3333) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [20/20] time 0.173 (0.175) data 0.097 (0.098) loss_x loss_x 0.7031 (0.8242) acc_x 84.3750 (78.7500) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:661
clean false:7
clean_rate:0.9895209580838323
noisy true:369
noisy false:579
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [75/200] batch [5/20] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.6694 (0.8208) acc_x 78.1250 (80.0000) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/20] time 0.174 (0.179) data 0.097 (0.088) loss_x loss_x 1.3877 (0.8225) acc_x 59.3750 (79.0625) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/20] time 0.160 (0.178) data 0.083 (0.091) loss_x loss_x 0.4543 (0.7881) acc_x 90.6250 (79.5833) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [20/20] time 0.173 (0.174) data 0.096 (0.090) loss_x loss_x 1.1221 (0.7814) acc_x 65.6250 (79.2188) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 611
confident_label rate tensor(0.4028, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 651
clean true:647
clean false:4
clean_rate:0.9938556067588326
noisy true:358
noisy false:607
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 965
epoch [76/200] batch [5/20] time 0.160 (0.182) data 0.083 (0.105) loss_x loss_x 0.6265 (0.6147) acc_x 81.2500 (85.0000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/20] time 0.181 (0.179) data 0.104 (0.101) loss_x loss_x 1.0684 (0.6777) acc_x 81.2500 (83.4375) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/20] time 0.162 (0.175) data 0.086 (0.098) loss_x loss_x 0.5288 (0.6527) acc_x 84.3750 (84.1667) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [20/20] time 0.293 (0.185) data 0.106 (0.097) loss_x loss_x 0.6309 (0.6198) acc_x 75.0000 (84.6875) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 590
confident_label rate tensor(0.4090, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 661
clean true:658
clean false:3
clean_rate:0.9954614220877458
noisy true:368
noisy false:587
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 955
epoch [77/200] batch [5/20] time 0.180 (0.189) data 0.103 (0.112) loss_x loss_x 0.9072 (0.7117) acc_x 84.3750 (81.2500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/20] time 0.161 (0.179) data 0.084 (0.102) loss_x loss_x 0.5444 (0.6780) acc_x 90.6250 (81.2500) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/20] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.5034 (0.6892) acc_x 84.3750 (81.2500) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [20/20] time 0.171 (0.180) data 0.094 (0.103) loss_x loss_x 1.0186 (0.7037) acc_x 84.3750 (81.5625) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 688
clean true:682
clean false:6
clean_rate:0.9912790697674418
noisy true:365
noisy false:563
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 928
epoch [78/200] batch [5/21] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 1.2324 (0.7530) acc_x 71.8750 (78.7500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/21] time 0.186 (0.196) data 0.109 (0.105) loss_x loss_x 1.0059 (0.8149) acc_x 68.7500 (76.2500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/21] time 0.170 (0.190) data 0.094 (0.104) loss_x loss_x 0.7495 (0.8466) acc_x 81.2500 (76.4583) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/21] time 0.173 (0.185) data 0.095 (0.102) loss_x loss_x 0.8975 (0.8532) acc_x 81.2500 (76.8750) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.4208, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 680
clean true:676
clean false:4
clean_rate:0.9941176470588236
noisy true:351
noisy false:585
after delete: len(clean_dataset) 680
after delete: len(noisy_dataset) 936
epoch [79/200] batch [5/21] time 0.185 (0.176) data 0.106 (0.099) loss_x loss_x 0.9248 (0.8253) acc_x 81.2500 (77.5000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/21] time 0.175 (0.177) data 0.098 (0.101) loss_x loss_x 1.1914 (0.7831) acc_x 59.3750 (77.1875) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/21] time 0.158 (0.174) data 0.082 (0.097) loss_x loss_x 0.8198 (0.7061) acc_x 78.1250 (80.4167) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/21] time 0.213 (0.175) data 0.136 (0.098) loss_x loss_x 0.5278 (0.7329) acc_x 84.3750 (79.8438) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.4183, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 676
clean true:673
clean false:3
clean_rate:0.9955621301775148
noisy true:354
noisy false:586
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 940
epoch [80/200] batch [5/21] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.8765 (0.9397) acc_x 75.0000 (77.5000) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/21] time 0.178 (0.162) data 0.102 (0.086) loss_x loss_x 0.7104 (0.9048) acc_x 75.0000 (75.6250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/21] time 0.163 (0.164) data 0.086 (0.087) loss_x loss_x 0.5806 (0.8282) acc_x 81.2500 (77.5000) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [20/21] time 0.163 (0.163) data 0.086 (0.086) loss_x loss_x 0.8042 (0.7893) acc_x 71.8750 (78.1250) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 570
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 673
clean true:668
clean false:5
clean_rate:0.9925705794947994
noisy true:378
noisy false:565
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 943
epoch [81/200] batch [5/21] time 0.166 (0.171) data 0.089 (0.093) loss_x loss_x 1.0537 (0.8515) acc_x 65.6250 (76.8750) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/21] time 0.164 (0.172) data 0.087 (0.095) loss_x loss_x 0.9424 (0.7518) acc_x 71.8750 (80.6250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/21] time 0.199 (0.178) data 0.122 (0.101) loss_x loss_x 0.5762 (0.7949) acc_x 87.5000 (81.0417) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/21] time 0.162 (0.176) data 0.086 (0.099) loss_x loss_x 0.6772 (0.7669) acc_x 84.3750 (81.5625) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.4158, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 672
clean true:668
clean false:4
clean_rate:0.9940476190476191
noisy true:362
noisy false:582
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 944
epoch [82/200] batch [5/21] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.7158 (0.7611) acc_x 78.1250 (76.2500) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/21] time 0.289 (0.195) data 0.102 (0.104) loss_x loss_x 0.2756 (0.6272) acc_x 96.8750 (81.8750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/21] time 0.177 (0.187) data 0.100 (0.101) loss_x loss_x 0.4065 (0.6306) acc_x 87.5000 (81.8750) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/21] time 0.161 (0.186) data 0.084 (0.102) loss_x loss_x 1.1572 (0.7445) acc_x 68.7500 (79.5312) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.4121, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 666
clean true:662
clean false:4
clean_rate:0.993993993993994
noisy true:348
noisy false:602
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 950
epoch [83/200] batch [5/20] time 0.189 (0.194) data 0.112 (0.117) loss_x loss_x 0.9272 (0.6894) acc_x 71.8750 (79.3750) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/20] time 0.228 (0.196) data 0.151 (0.119) loss_x loss_x 1.0186 (0.7640) acc_x 75.0000 (77.5000) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/20] time 0.193 (0.189) data 0.117 (0.112) loss_x loss_x 0.6411 (0.7625) acc_x 84.3750 (78.1250) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [20/20] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.2234 (0.7090) acc_x 96.8750 (79.5312) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 673
clean true:668
clean false:5
clean_rate:0.9925705794947994
noisy true:370
noisy false:573
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 943
epoch [84/200] batch [5/21] time 0.185 (0.179) data 0.109 (0.102) loss_x loss_x 0.4895 (0.7344) acc_x 84.3750 (81.8750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [10/21] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.8345 (0.7100) acc_x 78.1250 (81.2500) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/21] time 0.185 (0.181) data 0.108 (0.105) loss_x loss_x 0.5122 (0.6240) acc_x 87.5000 (83.5417) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/21] time 0.229 (0.190) data 0.152 (0.107) loss_x loss_x 0.6250 (0.6238) acc_x 90.6250 (84.0625) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 574
confident_label rate tensor(0.4183, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 676
clean true:673
clean false:3
clean_rate:0.9955621301775148
noisy true:369
noisy false:571
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 940
epoch [85/200] batch [5/21] time 0.184 (0.195) data 0.107 (0.118) loss_x loss_x 0.4438 (0.7729) acc_x 87.5000 (82.5000) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/21] time 0.186 (0.185) data 0.109 (0.109) loss_x loss_x 0.6372 (0.7258) acc_x 84.3750 (81.8750) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/21] time 0.283 (0.192) data 0.097 (0.107) loss_x loss_x 0.7334 (0.6965) acc_x 81.2500 (81.4583) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/21] time 0.184 (0.191) data 0.108 (0.108) loss_x loss_x 0.7529 (0.7056) acc_x 75.0000 (81.4062) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.4270, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 690
clean true:686
clean false:4
clean_rate:0.9942028985507246
noisy true:361
noisy false:565
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 926
epoch [86/200] batch [5/21] time 0.210 (0.202) data 0.134 (0.125) loss_x loss_x 0.6323 (0.9025) acc_x 78.1250 (72.5000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/21] time 0.171 (0.191) data 0.094 (0.114) loss_x loss_x 0.6035 (0.8287) acc_x 90.6250 (77.1875) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/21] time 0.177 (0.187) data 0.100 (0.110) loss_x loss_x 0.8984 (0.8089) acc_x 78.1250 (77.9167) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/21] time 0.171 (0.184) data 0.094 (0.108) loss_x loss_x 0.8857 (0.7946) acc_x 81.2500 (79.0625) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 550
confident_label rate tensor(0.4307, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 696
clean true:690
clean false:6
clean_rate:0.9913793103448276
noisy true:376
noisy false:544
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 920
epoch [87/200] batch [5/21] time 0.159 (0.169) data 0.082 (0.092) loss_x loss_x 1.0283 (0.8702) acc_x 71.8750 (78.7500) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/21] time 0.188 (0.186) data 0.111 (0.097) loss_x loss_x 0.7944 (0.8125) acc_x 78.1250 (79.3750) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/21] time 0.171 (0.183) data 0.094 (0.098) loss_x loss_x 0.9512 (0.7837) acc_x 71.8750 (80.0000) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/21] time 0.191 (0.184) data 0.115 (0.101) loss_x loss_x 0.6533 (0.7699) acc_x 81.2500 (79.6875) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.4307, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 696
clean true:689
clean false:7
clean_rate:0.9899425287356322
noisy true:383
noisy false:537
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 920
epoch [88/200] batch [5/21] time 0.182 (0.199) data 0.106 (0.122) loss_x loss_x 0.9512 (0.7214) acc_x 75.0000 (81.8750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/21] time 0.160 (0.190) data 0.083 (0.113) loss_x loss_x 0.5508 (0.7166) acc_x 81.2500 (82.8125) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/21] time 0.159 (0.187) data 0.082 (0.110) loss_x loss_x 0.9536 (0.7337) acc_x 71.8750 (82.0833) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/21] time 0.275 (0.196) data 0.109 (0.115) loss_x loss_x 0.8564 (0.7855) acc_x 71.8750 (80.7812) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.4394, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 710
clean true:707
clean false:3
clean_rate:0.995774647887324
noisy true:367
noisy false:539
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 906
epoch [89/200] batch [5/22] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 1.0713 (0.8281) acc_x 71.8750 (75.0000) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/22] time 0.162 (0.171) data 0.086 (0.094) loss_x loss_x 0.9097 (0.7546) acc_x 71.8750 (77.1875) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/22] time 0.161 (0.167) data 0.084 (0.091) loss_x loss_x 0.4922 (0.7710) acc_x 84.3750 (77.9167) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/22] time 0.258 (0.170) data 0.105 (0.090) loss_x loss_x 0.6060 (0.7651) acc_x 84.3750 (78.5938) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.4233, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 684
clean true:678
clean false:6
clean_rate:0.9912280701754386
noisy true:379
noisy false:553
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 932
epoch [90/200] batch [5/21] time 0.186 (0.192) data 0.108 (0.114) loss_x loss_x 0.5337 (0.5916) acc_x 90.6250 (86.2500) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/21] time 0.168 (0.189) data 0.091 (0.111) loss_x loss_x 0.3923 (0.6413) acc_x 93.7500 (84.3750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/21] time 0.174 (0.188) data 0.096 (0.111) loss_x loss_x 0.6675 (0.6533) acc_x 78.1250 (83.3333) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/21] time 0.171 (0.188) data 0.094 (0.107) loss_x loss_x 0.4482 (0.6737) acc_x 90.6250 (82.1875) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 702
clean true:699
clean false:3
clean_rate:0.9957264957264957
noisy true:372
noisy false:542
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 914
epoch [91/200] batch [5/21] time 0.185 (0.190) data 0.108 (0.112) loss_x loss_x 0.8301 (0.6888) acc_x 81.2500 (83.1250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/21] time 0.203 (0.186) data 0.126 (0.108) loss_x loss_x 1.1279 (0.7756) acc_x 71.8750 (80.3125) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/21] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.5781 (0.7588) acc_x 87.5000 (80.2083) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/21] time 0.186 (0.188) data 0.108 (0.111) loss_x loss_x 0.8398 (0.7479) acc_x 78.1250 (80.1562) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 541
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 701
clean true:696
clean false:5
clean_rate:0.992867332382311
noisy true:379
noisy false:536
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 915
epoch [92/200] batch [5/21] time 0.158 (0.163) data 0.081 (0.086) loss_x loss_x 0.7656 (0.6511) acc_x 81.2500 (81.2500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/21] time 0.181 (0.189) data 0.104 (0.100) loss_x loss_x 0.5308 (0.7052) acc_x 84.3750 (80.6250) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/21] time 0.185 (0.188) data 0.108 (0.104) loss_x loss_x 1.0752 (0.7542) acc_x 75.0000 (80.8333) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/21] time 0.188 (0.188) data 0.110 (0.105) loss_x loss_x 0.7983 (0.7521) acc_x 81.2500 (80.6250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 703
clean true:699
clean false:4
clean_rate:0.9943100995732574
noisy true:380
noisy false:533
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 913
epoch [93/200] batch [5/21] time 0.168 (0.168) data 0.092 (0.092) loss_x loss_x 0.9062 (0.7252) acc_x 78.1250 (81.2500) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/21] time 0.186 (0.177) data 0.109 (0.100) loss_x loss_x 0.6313 (0.6850) acc_x 84.3750 (80.9375) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/21] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.7954 (0.7320) acc_x 78.1250 (79.7917) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/21] time 0.182 (0.190) data 0.106 (0.106) loss_x loss_x 0.7612 (0.7222) acc_x 81.2500 (80.7812) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 544
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:703
clean false:4
clean_rate:0.9943422913719944
noisy true:369
noisy false:540
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [94/200] batch [5/22] time 0.169 (0.166) data 0.092 (0.089) loss_x loss_x 0.5815 (0.6954) acc_x 81.2500 (78.7500) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/22] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.9927 (0.7894) acc_x 71.8750 (77.5000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/22] time 0.159 (0.173) data 0.081 (0.097) loss_x loss_x 0.5957 (0.7803) acc_x 81.2500 (77.7083) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/22] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.9004 (0.7987) acc_x 78.1250 (77.3438) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.4233, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 684
clean true:681
clean false:3
clean_rate:0.9956140350877193
noisy true:351
noisy false:581
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 932
epoch [95/200] batch [5/21] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.4153 (0.7329) acc_x 87.5000 (81.8750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/21] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.2598 (0.6129) acc_x 96.8750 (84.6875) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/21] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.8237 (0.6765) acc_x 75.0000 (82.9167) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/21] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.6016 (0.6919) acc_x 78.1250 (81.2500) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 705
clean true:701
clean false:4
clean_rate:0.9943262411347518
noisy true:373
noisy false:538
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 911
epoch [96/200] batch [5/22] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.6484 (0.6266) acc_x 81.2500 (81.2500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/22] time 0.205 (0.179) data 0.128 (0.102) loss_x loss_x 0.9370 (0.6920) acc_x 75.0000 (81.5625) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/22] time 0.163 (0.180) data 0.087 (0.103) loss_x loss_x 1.0244 (0.7571) acc_x 65.6250 (79.1667) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/22] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.5459 (0.7504) acc_x 90.6250 (80.0000) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 547
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 695
clean true:688
clean false:7
clean_rate:0.9899280575539569
noisy true:381
noisy false:540
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 921
epoch [97/200] batch [5/21] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 1.0312 (0.7843) acc_x 71.8750 (79.3750) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/21] time 0.181 (0.178) data 0.104 (0.101) loss_x loss_x 0.6245 (0.7753) acc_x 81.2500 (80.9375) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/21] time 0.158 (0.176) data 0.081 (0.099) loss_x loss_x 0.9478 (0.7415) acc_x 71.8750 (81.2500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/21] time 0.181 (0.176) data 0.105 (0.100) loss_x loss_x 1.0801 (0.7626) acc_x 75.0000 (80.4688) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:696
clean false:4
clean_rate:0.9942857142857143
noisy true:381
noisy false:535
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [98/200] batch [5/21] time 0.171 (0.164) data 0.094 (0.087) loss_x loss_x 0.8374 (0.7149) acc_x 81.2500 (85.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/21] time 0.157 (0.163) data 0.081 (0.086) loss_x loss_x 0.7041 (0.7706) acc_x 81.2500 (83.4375) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/21] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 0.8262 (0.7534) acc_x 75.0000 (82.9167) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [20/21] time 0.179 (0.163) data 0.102 (0.086) loss_x loss_x 0.6392 (0.7777) acc_x 78.1250 (81.8750) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.4196, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 678
clean true:675
clean false:3
clean_rate:0.995575221238938
noisy true:370
noisy false:568
after delete: len(clean_dataset) 678
after delete: len(noisy_dataset) 938
epoch [99/200] batch [5/21] time 0.161 (0.166) data 0.085 (0.089) loss_x loss_x 0.3870 (0.5410) acc_x 84.3750 (82.5000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/21] time 0.175 (0.172) data 0.097 (0.094) loss_x loss_x 0.2800 (0.6267) acc_x 96.8750 (81.5625) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/21] time 0.177 (0.191) data 0.100 (0.101) loss_x loss_x 0.8794 (0.6675) acc_x 78.1250 (81.2500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/21] time 0.164 (0.187) data 0.087 (0.100) loss_x loss_x 0.8174 (0.6694) acc_x 84.3750 (81.8750) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 564
confident_label rate tensor(0.4264, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 689
clean true:685
clean false:4
clean_rate:0.9941944847605225
noisy true:367
noisy false:560
all clean rate:  [0.9750778816199377, 0.983957219251337, 0.9853862212943633, 0.991701244813278, 0.9937759336099585, 0.9959266802443992, 0.9879759519038076, 0.9921568627450981, 0.9902723735408561, 0.9901960784313726, 0.996268656716418, 0.9923076923076923, 0.9907235621521335, 0.9905660377358491, 0.9891891891891892, 0.996309963099631, 0.9908592321755028, 0.9981818181818182, 0.9945155393053017, 0.9962616822429906, 0.9894366197183099, 0.9963768115942029, 0.9872958257713249, 0.9964285714285714, 0.9966555183946488, 0.9946236559139785, 0.9932088285229203, 0.9948453608247423, 0.9949238578680203, 0.9966499162479062, 0.9913793103448276, 0.9965928449744463, 0.9948805460750854, 0.9948006932409013, 0.9901153212520593, 0.988562091503268, 0.9951534733441034, 0.9950738916256158, 0.9951456310679612, 0.9875, 0.9968152866242038, 0.9871382636655949, 0.9936406995230525, 0.9951845906902087, 0.9935064935064936, 0.9919614147909968, 0.9952229299363057, 0.9968602825745683, 0.993485342019544, 0.9904153354632588, 0.9952153110047847, 0.9953198127925117, 0.99375, 0.9950166112956811, 0.9952153110047847, 0.9939393939393939, 0.9905808477237049, 0.9969278033794163, 0.9904458598726115, 0.9921996879875195, 0.9923430321592649, 0.9922839506172839, 0.9953703703703703, 0.9908675799086758, 0.9907120743034056, 0.9909502262443439, 0.9969465648854962, 0.9940828402366864, 0.9924242424242424, 0.9939759036144579, 0.9908675799086758, 0.9898255813953488, 0.9954887218045113, 0.9938366718027735, 0.9895209580838323, 0.9938556067588326, 0.9954614220877458, 0.9912790697674418, 0.9941176470588236, 0.9955621301775148, 0.9925705794947994, 0.9940476190476191, 0.993993993993994, 0.9925705794947994, 0.9955621301775148, 0.9942028985507246, 0.9913793103448276, 0.9899425287356322, 0.995774647887324, 0.9912280701754386, 0.9957264957264957, 0.992867332382311, 0.9943100995732574, 0.9943422913719944, 0.9956140350877193, 0.9943262411347518, 0.9899280575539569, 0.9942857142857143, 0.995575221238938, 0.9941944847605225]
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 927
epoch [100/200] batch [5/21] time 0.182 (0.194) data 0.105 (0.117) loss_x loss_x 0.9453 (0.9279) acc_x 75.0000 (75.6250) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/21] time 0.167 (0.183) data 0.090 (0.106) loss_x loss_x 0.7607 (0.8512) acc_x 78.1250 (78.4375) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/21] time 0.186 (0.182) data 0.107 (0.105) loss_x loss_x 0.7603 (0.7869) acc_x 78.1250 (79.3750) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/21] time 0.159 (0.182) data 0.082 (0.104) loss_x loss_x 0.4634 (0.7529) acc_x 84.3750 (79.5312) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 720
clean true:715
clean false:5
clean_rate:0.9930555555555556
noisy true:396
noisy false:500
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 896
epoch [101/200] batch [5/22] time 0.180 (0.175) data 0.104 (0.099) loss_x loss_x 0.6929 (0.6342) acc_x 81.2500 (83.7500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/22] time 0.166 (0.170) data 0.088 (0.093) loss_x loss_x 0.9351 (0.8476) acc_x 78.1250 (78.4375) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/22] time 0.169 (0.171) data 0.093 (0.094) loss_x loss_x 0.4187 (0.7801) acc_x 87.5000 (80.0000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/22] time 0.207 (0.174) data 0.130 (0.097) loss_x loss_x 0.6558 (0.7526) acc_x 78.1250 (80.7812) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 547
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 716
clean true:712
clean false:4
clean_rate:0.994413407821229
noisy true:357
noisy false:543
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 900
epoch [102/200] batch [5/22] time 0.159 (0.174) data 0.082 (0.097) loss_x loss_x 0.7944 (0.6862) acc_x 75.0000 (81.2500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/22] time 0.185 (0.172) data 0.107 (0.095) loss_x loss_x 0.8691 (0.7367) acc_x 75.0000 (81.5625) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/22] time 0.161 (0.171) data 0.084 (0.094) loss_x loss_x 0.7681 (0.7152) acc_x 78.1250 (82.0833) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/22] time 0.166 (0.171) data 0.089 (0.094) loss_x loss_x 0.4480 (0.7291) acc_x 87.5000 (82.1875) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:702
clean false:5
clean_rate:0.9929278642149929
noisy true:384
noisy false:525
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [103/200] batch [5/22] time 0.169 (0.183) data 0.093 (0.106) loss_x loss_x 1.1514 (0.8460) acc_x 75.0000 (80.6250) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/22] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 1.0469 (0.8290) acc_x 75.0000 (80.0000) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/22] time 0.214 (0.180) data 0.137 (0.103) loss_x loss_x 0.8838 (0.8090) acc_x 81.2500 (80.4167) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/22] time 0.185 (0.180) data 0.107 (0.103) loss_x loss_x 0.7275 (0.7939) acc_x 78.1250 (80.7812) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.4356, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 704
clean true:700
clean false:4
clean_rate:0.9943181818181818
noisy true:392
noisy false:520
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 912
epoch [104/200] batch [5/22] time 0.170 (0.179) data 0.093 (0.102) loss_x loss_x 0.9580 (0.7515) acc_x 71.8750 (81.8750) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/22] time 0.184 (0.186) data 0.106 (0.109) loss_x loss_x 0.5103 (0.7230) acc_x 87.5000 (80.9375) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/22] time 0.299 (0.198) data 0.114 (0.109) loss_x loss_x 0.3770 (0.6773) acc_x 84.3750 (81.8750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/22] time 0.183 (0.194) data 0.107 (0.108) loss_x loss_x 0.6313 (0.6727) acc_x 81.2500 (81.7188) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 718
clean true:714
clean false:4
clean_rate:0.9944289693593314
noisy true:377
noisy false:521
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 898
epoch [105/200] batch [5/22] time 0.180 (0.185) data 0.102 (0.108) loss_x loss_x 0.7632 (0.7667) acc_x 84.3750 (81.8750) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/22] time 0.190 (0.193) data 0.112 (0.106) loss_x loss_x 0.7900 (0.8082) acc_x 81.2500 (80.6250) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/22] time 0.168 (0.187) data 0.091 (0.104) loss_x loss_x 0.8242 (0.7563) acc_x 87.5000 (82.0833) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/22] time 0.183 (0.184) data 0.106 (0.102) loss_x loss_x 0.8931 (0.7194) acc_x 78.1250 (82.3438) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 719
clean true:717
clean false:2
clean_rate:0.9972183588317107
noisy true:389
noisy false:508
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 897
epoch [106/200] batch [5/22] time 0.160 (0.160) data 0.084 (0.083) loss_x loss_x 0.7344 (0.7757) acc_x 78.1250 (79.3750) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/22] time 0.164 (0.160) data 0.086 (0.084) loss_x loss_x 0.7222 (0.7535) acc_x 78.1250 (81.8750) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/22] time 0.158 (0.161) data 0.081 (0.084) loss_x loss_x 0.3962 (0.6935) acc_x 90.6250 (82.0833) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/22] time 0.206 (0.165) data 0.129 (0.088) loss_x loss_x 0.5957 (0.7072) acc_x 87.5000 (81.7188) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 711
clean true:705
clean false:6
clean_rate:0.9915611814345991
noisy true:378
noisy false:527
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 905
epoch [107/200] batch [5/22] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.7349 (0.6985) acc_x 81.2500 (83.1250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/22] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.5874 (0.6628) acc_x 87.5000 (83.1250) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/22] time 0.167 (0.188) data 0.090 (0.103) loss_x loss_x 0.5142 (0.7159) acc_x 87.5000 (81.4583) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/22] time 0.159 (0.181) data 0.082 (0.098) loss_x loss_x 0.9238 (0.7304) acc_x 81.2500 (81.2500) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.4536, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 733
clean true:729
clean false:4
clean_rate:0.9945429740791268
noisy true:377
noisy false:506
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 883
epoch [108/200] batch [5/22] time 0.174 (0.184) data 0.097 (0.107) loss_x loss_x 0.9272 (0.7498) acc_x 65.6250 (81.2500) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/22] time 0.193 (0.189) data 0.117 (0.113) loss_x loss_x 0.9141 (0.6783) acc_x 75.0000 (82.5000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/22] time 0.222 (0.198) data 0.143 (0.114) loss_x loss_x 0.4546 (0.7567) acc_x 90.6250 (81.0417) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/22] time 0.184 (0.193) data 0.108 (0.111) loss_x loss_x 0.7979 (0.7518) acc_x 68.7500 (80.1562) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 550
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 706
clean true:700
clean false:6
clean_rate:0.9915014164305949
noisy true:366
noisy false:544
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 910
epoch [109/200] batch [5/22] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.7520 (0.8199) acc_x 84.3750 (83.1250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/22] time 0.184 (0.185) data 0.107 (0.109) loss_x loss_x 0.7261 (0.8138) acc_x 84.3750 (81.8750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/22] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.9507 (0.7667) acc_x 84.3750 (82.5000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/22] time 0.184 (0.191) data 0.107 (0.109) loss_x loss_x 1.0078 (0.7746) acc_x 81.2500 (81.7188) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 703
clean true:699
clean false:4
clean_rate:0.9943100995732574
noisy true:359
noisy false:554
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 913
epoch [110/200] batch [5/21] time 0.159 (0.170) data 0.082 (0.093) loss_x loss_x 0.6572 (0.6981) acc_x 81.2500 (79.3750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/21] time 0.165 (0.171) data 0.088 (0.094) loss_x loss_x 0.9355 (0.7052) acc_x 75.0000 (80.3125) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/21] time 0.180 (0.171) data 0.103 (0.095) loss_x loss_x 0.9072 (0.7584) acc_x 87.5000 (80.6250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/21] time 0.189 (0.172) data 0.113 (0.095) loss_x loss_x 0.5601 (0.7294) acc_x 81.2500 (81.4062) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 706
clean true:705
clean false:1
clean_rate:0.9985835694050992
noisy true:376
noisy false:534
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 910
epoch [111/200] batch [5/22] time 0.161 (0.160) data 0.085 (0.084) loss_x loss_x 0.8555 (0.7603) acc_x 78.1250 (81.8750) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [10/22] time 0.164 (0.160) data 0.086 (0.083) loss_x loss_x 0.5400 (0.7564) acc_x 84.3750 (81.5625) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/22] time 0.163 (0.162) data 0.087 (0.085) loss_x loss_x 0.6758 (0.6979) acc_x 87.5000 (82.7083) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/22] time 0.309 (0.178) data 0.176 (0.096) loss_x loss_x 0.4695 (0.6705) acc_x 93.7500 (83.5938) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 721
clean true:719
clean false:2
clean_rate:0.9972260748959778
noisy true:372
noisy false:523
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 895
epoch [112/200] batch [5/22] time 0.173 (0.180) data 0.097 (0.103) loss_x loss_x 0.8345 (0.7718) acc_x 75.0000 (80.0000) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/22] time 0.286 (0.197) data 0.115 (0.107) loss_x loss_x 0.2617 (0.5880) acc_x 93.7500 (85.3125) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/22] time 0.168 (0.194) data 0.091 (0.109) loss_x loss_x 0.7651 (0.6450) acc_x 75.0000 (83.9583) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/22] time 0.171 (0.189) data 0.095 (0.106) loss_x loss_x 0.7734 (0.6589) acc_x 68.7500 (82.3438) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 713
clean true:708
clean false:5
clean_rate:0.9929873772791024
noisy true:383
noisy false:520
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 903
epoch [113/200] batch [5/22] time 0.185 (0.194) data 0.109 (0.117) loss_x loss_x 0.5278 (0.7663) acc_x 87.5000 (82.5000) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/22] time 0.275 (0.200) data 0.103 (0.114) loss_x loss_x 0.7983 (0.7027) acc_x 84.3750 (83.1250) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/22] time 0.181 (0.200) data 0.105 (0.114) loss_x loss_x 0.3867 (0.6361) acc_x 93.7500 (85.2083) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/22] time 0.179 (0.197) data 0.102 (0.113) loss_x loss_x 0.5884 (0.6874) acc_x 81.2500 (82.8125) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 726
clean true:722
clean false:4
clean_rate:0.9944903581267218
noisy true:397
noisy false:493
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 890
epoch [114/200] batch [5/22] time 0.171 (0.169) data 0.093 (0.092) loss_x loss_x 0.8237 (0.5240) acc_x 78.1250 (86.8750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/22] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 0.6875 (0.5784) acc_x 84.3750 (87.5000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/22] time 0.174 (0.171) data 0.098 (0.094) loss_x loss_x 0.7285 (0.6296) acc_x 81.2500 (85.4167) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/22] time 0.179 (0.173) data 0.102 (0.096) loss_x loss_x 0.7529 (0.6388) acc_x 78.1250 (84.6875) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:698
clean false:2
clean_rate:0.9971428571428571
noisy true:369
noisy false:547
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [115/200] batch [5/21] time 0.172 (0.180) data 0.095 (0.104) loss_x loss_x 0.5229 (0.6665) acc_x 81.2500 (83.7500) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [10/21] time 0.182 (0.177) data 0.104 (0.100) loss_x loss_x 0.9849 (0.7166) acc_x 78.1250 (80.0000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/21] time 0.191 (0.177) data 0.114 (0.100) loss_x loss_x 0.6479 (0.6776) acc_x 87.5000 (81.8750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/21] time 0.170 (0.176) data 0.094 (0.099) loss_x loss_x 1.0000 (0.7199) acc_x 84.3750 (82.1875) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 709
clean true:704
clean false:5
clean_rate:0.9929478138222849
noisy true:385
noisy false:522
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 907
epoch [116/200] batch [5/22] time 0.176 (0.186) data 0.100 (0.109) loss_x loss_x 0.5991 (0.6120) acc_x 81.2500 (88.1250) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/22] time 0.178 (0.179) data 0.100 (0.102) loss_x loss_x 0.6621 (0.6148) acc_x 84.3750 (86.5625) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/22] time 0.170 (0.179) data 0.094 (0.103) loss_x loss_x 0.7422 (0.6105) acc_x 81.2500 (86.0417) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/22] time 0.298 (0.185) data 0.110 (0.102) loss_x loss_x 0.7510 (0.6204) acc_x 84.3750 (85.9375) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 521
confident_label rate tensor(0.4474, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 723
clean true:717
clean false:6
clean_rate:0.991701244813278
noisy true:378
noisy false:515
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 893
epoch [117/200] batch [5/22] time 0.169 (0.194) data 0.092 (0.117) loss_x loss_x 0.5430 (0.5969) acc_x 84.3750 (85.0000) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/22] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 0.5635 (0.5795) acc_x 81.2500 (85.6250) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/22] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 0.5269 (0.6078) acc_x 90.6250 (83.5417) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/22] time 0.197 (0.184) data 0.120 (0.107) loss_x loss_x 1.3438 (0.6502) acc_x 59.3750 (82.5000) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 695
clean true:690
clean false:5
clean_rate:0.9928057553956835
noisy true:397
noisy false:524
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 921
epoch [118/200] batch [5/21] time 0.188 (0.190) data 0.111 (0.101) loss_x loss_x 0.6880 (0.6909) acc_x 87.5000 (82.5000) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/21] time 0.183 (0.188) data 0.106 (0.105) loss_x loss_x 0.8140 (0.8015) acc_x 78.1250 (80.3125) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/21] time 0.173 (0.183) data 0.094 (0.102) loss_x loss_x 0.1797 (0.7220) acc_x 96.8750 (82.2917) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/21] time 0.186 (0.182) data 0.109 (0.102) loss_x loss_x 0.5400 (0.7349) acc_x 84.3750 (82.5000) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 720
clean true:715
clean false:5
clean_rate:0.9930555555555556
noisy true:387
noisy false:509
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 896
epoch [119/200] batch [5/22] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.5234 (0.6292) acc_x 87.5000 (81.8750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/22] time 0.196 (0.181) data 0.119 (0.104) loss_x loss_x 0.9214 (0.7305) acc_x 75.0000 (78.4375) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/22] time 0.181 (0.191) data 0.104 (0.103) loss_x loss_x 0.6636 (0.7051) acc_x 87.5000 (80.8333) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/22] time 0.180 (0.189) data 0.102 (0.103) loss_x loss_x 0.7363 (0.7309) acc_x 78.1250 (80.3125) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 711
clean true:707
clean false:4
clean_rate:0.9943741209563994
noisy true:391
noisy false:514
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 905
epoch [120/200] batch [5/22] time 0.162 (0.176) data 0.085 (0.099) loss_x loss_x 0.8296 (0.5906) acc_x 75.0000 (84.3750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/22] time 0.158 (0.169) data 0.082 (0.092) loss_x loss_x 0.9102 (0.6686) acc_x 78.1250 (85.9375) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/22] time 0.157 (0.165) data 0.080 (0.088) loss_x loss_x 0.6011 (0.6703) acc_x 90.6250 (84.7917) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/22] time 0.155 (0.169) data 0.079 (0.087) loss_x loss_x 0.7715 (0.6668) acc_x 87.5000 (84.8438) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.4517, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 730
clean true:727
clean false:3
clean_rate:0.9958904109589041
noisy true:378
noisy false:508
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 886
epoch [121/200] batch [5/22] time 0.168 (0.185) data 0.092 (0.108) loss_x loss_x 0.6968 (0.6588) acc_x 78.1250 (81.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/22] time 0.205 (0.186) data 0.128 (0.109) loss_x loss_x 0.5493 (0.6699) acc_x 78.1250 (80.9375) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/22] time 0.160 (0.181) data 0.083 (0.104) loss_x loss_x 0.8706 (0.6699) acc_x 68.7500 (81.4583) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/22] time 0.235 (0.184) data 0.118 (0.105) loss_x loss_x 1.1719 (0.6731) acc_x 75.0000 (82.1875) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 515
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 718
clean true:712
clean false:6
clean_rate:0.9916434540389972
noisy true:389
noisy false:509
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 898
epoch [122/200] batch [5/22] time 0.163 (0.180) data 0.085 (0.102) loss_x loss_x 0.5664 (0.6286) acc_x 78.1250 (81.8750) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/22] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.6987 (0.5657) acc_x 84.3750 (85.6250) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/22] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.4937 (0.6527) acc_x 87.5000 (83.1250) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/22] time 0.176 (0.180) data 0.100 (0.103) loss_x loss_x 0.4785 (0.6737) acc_x 87.5000 (82.3438) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 503
confident_label rate tensor(0.4499, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 727
clean true:723
clean false:4
clean_rate:0.9944979367262724
noisy true:390
noisy false:499
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 889
epoch [123/200] batch [5/22] time 0.172 (0.181) data 0.094 (0.104) loss_x loss_x 1.2773 (0.7964) acc_x 62.5000 (81.8750) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/22] time 0.175 (0.177) data 0.098 (0.099) loss_x loss_x 0.5366 (0.6579) acc_x 87.5000 (84.0625) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/22] time 0.185 (0.175) data 0.109 (0.098) loss_x loss_x 0.7754 (0.6356) acc_x 81.2500 (84.5833) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/22] time 0.158 (0.175) data 0.079 (0.098) loss_x loss_x 0.6626 (0.6078) acc_x 84.3750 (85.0000) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 721
clean true:716
clean false:5
clean_rate:0.9930651872399445
noisy true:402
noisy false:493
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 895
epoch [124/200] batch [5/22] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 1.0352 (0.7960) acc_x 84.3750 (80.0000) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/22] time 0.162 (0.171) data 0.084 (0.094) loss_x loss_x 0.5981 (0.7291) acc_x 84.3750 (80.9375) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/22] time 0.168 (0.179) data 0.090 (0.094) loss_x loss_x 0.5474 (0.6923) acc_x 87.5000 (82.0833) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/22] time 0.183 (0.181) data 0.106 (0.098) loss_x loss_x 0.5581 (0.6821) acc_x 87.5000 (82.3438) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.4616, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 746
clean true:743
clean false:3
clean_rate:0.9959785522788204
noisy true:382
noisy false:488
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 870
epoch [125/200] batch [5/23] time 0.169 (0.172) data 0.091 (0.094) loss_x loss_x 0.5557 (0.7246) acc_x 90.6250 (81.2500) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/23] time 0.166 (0.170) data 0.089 (0.092) loss_x loss_x 0.3743 (0.6415) acc_x 96.8750 (84.0625) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/23] time 0.177 (0.180) data 0.101 (0.096) loss_x loss_x 0.9414 (0.6942) acc_x 68.7500 (82.9167) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/23] time 0.181 (0.177) data 0.104 (0.095) loss_x loss_x 0.6846 (0.6674) acc_x 75.0000 (82.8125) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 502
confident_label rate tensor(0.4468, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 722
clean true:716
clean false:6
clean_rate:0.9916897506925207
noisy true:398
noisy false:496
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 894
epoch [126/200] batch [5/22] time 0.171 (0.171) data 0.093 (0.093) loss_x loss_x 0.8066 (0.7092) acc_x 81.2500 (81.2500) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [10/22] time 0.181 (0.173) data 0.104 (0.096) loss_x loss_x 0.6079 (0.6194) acc_x 87.5000 (84.6875) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/22] time 0.169 (0.175) data 0.092 (0.097) loss_x loss_x 0.7568 (0.6399) acc_x 84.3750 (83.9583) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/22] time 0.178 (0.180) data 0.102 (0.099) loss_x loss_x 0.8071 (0.6687) acc_x 81.2500 (83.1250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:703
clean false:4
clean_rate:0.9943422913719944
noisy true:377
noisy false:532
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [127/200] batch [5/22] time 0.225 (0.193) data 0.148 (0.116) loss_x loss_x 0.5010 (0.6289) acc_x 90.6250 (85.6250) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/22] time 0.161 (0.188) data 0.085 (0.112) loss_x loss_x 0.4236 (0.6330) acc_x 93.7500 (86.2500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/22] time 0.185 (0.187) data 0.107 (0.110) loss_x loss_x 0.7808 (0.6539) acc_x 78.1250 (85.4167) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/22] time 0.184 (0.186) data 0.107 (0.110) loss_x loss_x 0.5439 (0.6394) acc_x 87.5000 (85.6250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 492
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:730
clean false:5
clean_rate:0.9931972789115646
noisy true:394
noisy false:487
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [128/200] batch [5/22] time 0.160 (0.161) data 0.083 (0.084) loss_x loss_x 0.9146 (0.5508) acc_x 78.1250 (87.5000) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/22] time 0.160 (0.161) data 0.084 (0.084) loss_x loss_x 0.5420 (0.5816) acc_x 81.2500 (85.9375) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [15/22] time 0.161 (0.161) data 0.084 (0.084) loss_x loss_x 0.7349 (0.5792) acc_x 81.2500 (85.4167) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/22] time 0.162 (0.170) data 0.085 (0.088) loss_x loss_x 1.1826 (0.6512) acc_x 68.7500 (83.4375) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 711
clean true:706
clean false:5
clean_rate:0.9929676511954993
noisy true:399
noisy false:506
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 905
epoch [129/200] batch [5/22] time 0.159 (0.169) data 0.083 (0.092) loss_x loss_x 0.7251 (0.7350) acc_x 87.5000 (82.5000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/22] time 0.182 (0.174) data 0.105 (0.097) loss_x loss_x 0.5967 (0.8462) acc_x 81.2500 (78.1250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/22] time 0.296 (0.187) data 0.109 (0.101) loss_x loss_x 0.8335 (0.7718) acc_x 78.1250 (81.0417) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/22] time 0.181 (0.187) data 0.105 (0.103) loss_x loss_x 0.5903 (0.7283) acc_x 84.3750 (82.0312) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 529
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 713
clean true:707
clean false:6
clean_rate:0.9915848527349228
noisy true:380
noisy false:523
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 903
epoch [130/200] batch [5/22] time 0.178 (0.181) data 0.100 (0.104) loss_x loss_x 0.6748 (0.7109) acc_x 81.2500 (82.5000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/22] time 0.166 (0.192) data 0.089 (0.104) loss_x loss_x 0.5664 (0.6430) acc_x 87.5000 (84.3750) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/22] time 0.189 (0.188) data 0.113 (0.104) loss_x loss_x 0.6860 (0.7186) acc_x 78.1250 (82.7083) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/22] time 0.160 (0.182) data 0.084 (0.100) loss_x loss_x 0.4316 (0.7027) acc_x 90.6250 (82.9688) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 717
clean true:712
clean false:5
clean_rate:0.99302649930265
noisy true:371
noisy false:528
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 899
epoch [131/200] batch [5/22] time 0.223 (0.194) data 0.146 (0.117) loss_x loss_x 0.3801 (0.6261) acc_x 90.6250 (85.0000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/22] time 0.240 (0.209) data 0.163 (0.121) loss_x loss_x 0.8750 (0.6954) acc_x 81.2500 (83.1250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/22] time 0.178 (0.202) data 0.101 (0.117) loss_x loss_x 0.7783 (0.7028) acc_x 84.3750 (84.1667) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/22] time 0.180 (0.199) data 0.104 (0.116) loss_x loss_x 0.6240 (0.7286) acc_x 87.5000 (83.1250) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.4592, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 742
clean true:738
clean false:4
clean_rate:0.9946091644204852
noisy true:387
noisy false:487
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 874
epoch [132/200] batch [5/23] time 0.162 (0.197) data 0.084 (0.098) loss_x loss_x 0.5005 (0.4364) acc_x 90.6250 (89.3750) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/23] time 0.192 (0.191) data 0.115 (0.103) loss_x loss_x 0.9131 (0.6126) acc_x 78.1250 (84.0625) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/23] time 0.273 (0.192) data 0.087 (0.100) loss_x loss_x 1.2900 (0.6561) acc_x 68.7500 (83.3333) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/23] time 0.179 (0.187) data 0.100 (0.096) loss_x loss_x 1.2480 (0.7260) acc_x 78.1250 (82.3438) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.4616, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 746
clean true:740
clean false:6
clean_rate:0.9919571045576407
noisy true:386
noisy false:484
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 870
epoch [133/200] batch [5/23] time 0.197 (0.189) data 0.120 (0.112) loss_x loss_x 0.3091 (0.6125) acc_x 87.5000 (85.6250) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/23] time 0.180 (0.188) data 0.103 (0.111) loss_x loss_x 0.9746 (0.6944) acc_x 78.1250 (81.2500) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/23] time 0.168 (0.192) data 0.091 (0.108) loss_x loss_x 0.5024 (0.6371) acc_x 87.5000 (83.5417) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/23] time 0.160 (0.185) data 0.083 (0.102) loss_x loss_x 0.6357 (0.6181) acc_x 87.5000 (85.0000) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.4530, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 732
clean true:728
clean false:4
clean_rate:0.994535519125683
noisy true:378
noisy false:506
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 884
epoch [134/200] batch [5/22] time 0.181 (0.195) data 0.103 (0.118) loss_x loss_x 0.5234 (0.4692) acc_x 84.3750 (86.2500) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/22] time 0.189 (0.188) data 0.112 (0.111) loss_x loss_x 0.2886 (0.5972) acc_x 96.8750 (85.3125) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/22] time 0.171 (0.186) data 0.094 (0.109) loss_x loss_x 0.6191 (0.6213) acc_x 87.5000 (84.3750) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/22] time 0.163 (0.187) data 0.086 (0.104) loss_x loss_x 0.7529 (0.6134) acc_x 81.2500 (84.3750) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.4493, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 726
clean true:724
clean false:2
clean_rate:0.9972451790633609
noisy true:405
noisy false:485
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 890
epoch [135/200] batch [5/22] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.6528 (0.6911) acc_x 81.2500 (83.7500) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/22] time 0.183 (0.178) data 0.106 (0.102) loss_x loss_x 0.9092 (0.7275) acc_x 81.2500 (81.5625) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/22] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.6372 (0.6824) acc_x 81.2500 (81.6667) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/22] time 0.169 (0.177) data 0.093 (0.101) loss_x loss_x 0.3101 (0.6817) acc_x 90.6250 (82.3438) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.4524, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 731
clean true:727
clean false:4
clean_rate:0.9945280437756497
noisy true:392
noisy false:493
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 885
epoch [136/200] batch [5/22] time 0.197 (0.201) data 0.120 (0.123) loss_x loss_x 0.8115 (0.6723) acc_x 84.3750 (84.3750) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/22] time 0.180 (0.193) data 0.103 (0.116) loss_x loss_x 0.5361 (0.6139) acc_x 84.3750 (85.0000) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/22] time 0.201 (0.203) data 0.124 (0.119) loss_x loss_x 1.1182 (0.6501) acc_x 71.8750 (83.1250) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/22] time 0.191 (0.199) data 0.114 (0.116) loss_x loss_x 0.7539 (0.6657) acc_x 84.3750 (82.9688) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4598, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 743
clean true:736
clean false:7
clean_rate:0.990578734858681
noisy true:394
noisy false:479
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 873
epoch [137/200] batch [5/23] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 1.0479 (0.7196) acc_x 68.7500 (78.7500) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/23] time 0.179 (0.167) data 0.102 (0.090) loss_x loss_x 0.5942 (0.6173) acc_x 90.6250 (83.1250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/23] time 0.185 (0.184) data 0.109 (0.095) loss_x loss_x 0.6494 (0.6439) acc_x 87.5000 (82.9167) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/23] time 0.184 (0.184) data 0.107 (0.099) loss_x loss_x 0.7017 (0.6930) acc_x 81.2500 (81.8750) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 503
confident_label rate tensor(0.4542, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 734
clean true:730
clean false:4
clean_rate:0.9945504087193461
noisy true:383
noisy false:499
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 882
epoch [138/200] batch [5/22] time 0.163 (0.165) data 0.085 (0.087) loss_x loss_x 0.7578 (0.6947) acc_x 81.2500 (85.0000) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/22] time 0.158 (0.166) data 0.081 (0.089) loss_x loss_x 0.5347 (0.6627) acc_x 81.2500 (84.6875) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/22] time 0.246 (0.177) data 0.082 (0.086) loss_x loss_x 0.8149 (0.6754) acc_x 81.2500 (83.9583) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/22] time 0.159 (0.172) data 0.082 (0.085) loss_x loss_x 0.3760 (0.6481) acc_x 90.6250 (83.7500) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.4530, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 732
clean true:731
clean false:1
clean_rate:0.9986338797814208
noisy true:392
noisy false:492
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 884
epoch [139/200] batch [5/22] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.3364 (0.4659) acc_x 90.6250 (88.1250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/22] time 0.288 (0.188) data 0.101 (0.100) loss_x loss_x 0.7686 (0.5454) acc_x 78.1250 (86.8750) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/22] time 0.182 (0.187) data 0.105 (0.103) loss_x loss_x 0.8213 (0.5557) acc_x 87.5000 (87.2917) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/22] time 0.178 (0.187) data 0.102 (0.104) loss_x loss_x 0.7432 (0.5690) acc_x 84.3750 (86.4062) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 495
confident_label rate tensor(0.4641, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 750
clean true:747
clean false:3
clean_rate:0.996
noisy true:374
noisy false:492
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 866
epoch [140/200] batch [5/23] time 0.164 (0.166) data 0.087 (0.089) loss_x loss_x 0.1466 (0.5210) acc_x 96.8750 (87.5000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/23] time 0.170 (0.168) data 0.094 (0.091) loss_x loss_x 0.4170 (0.5579) acc_x 93.7500 (86.5625) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/23] time 0.167 (0.169) data 0.090 (0.092) loss_x loss_x 0.7671 (0.5300) acc_x 81.2500 (86.8750) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/23] time 0.179 (0.175) data 0.103 (0.093) loss_x loss_x 0.5229 (0.5318) acc_x 84.3750 (86.5625) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.4524, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 731
clean true:729
clean false:2
clean_rate:0.9972640218878249
noisy true:382
noisy false:503
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 885
epoch [141/200] batch [5/22] time 0.228 (0.197) data 0.151 (0.121) loss_x loss_x 0.5938 (0.5195) acc_x 84.3750 (86.8750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/22] time 0.180 (0.204) data 0.102 (0.114) loss_x loss_x 0.9004 (0.5546) acc_x 75.0000 (86.2500) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/22] time 0.179 (0.200) data 0.103 (0.114) loss_x loss_x 0.9653 (0.6160) acc_x 78.1250 (83.9583) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/22] time 0.179 (0.196) data 0.102 (0.112) loss_x loss_x 0.5205 (0.6064) acc_x 84.3750 (84.5312) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4511, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 729
clean true:726
clean false:3
clean_rate:0.9958847736625515
noisy true:396
noisy false:491
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 887
epoch [142/200] batch [5/22] time 0.158 (0.160) data 0.081 (0.082) loss_x loss_x 0.8042 (0.6240) acc_x 87.5000 (85.0000) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/22] time 0.160 (0.160) data 0.082 (0.083) loss_x loss_x 0.4993 (0.5831) acc_x 90.6250 (84.6875) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [15/22] time 0.189 (0.177) data 0.113 (0.093) loss_x loss_x 0.4939 (0.6460) acc_x 93.7500 (83.3333) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/22] time 0.163 (0.178) data 0.085 (0.095) loss_x loss_x 0.7144 (0.6688) acc_x 75.0000 (81.8750) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 475
confident_label rate tensor(0.4623, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 747
clean true:742
clean false:5
clean_rate:0.9933065595716198
noisy true:399
noisy false:470
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 869
epoch [143/200] batch [5/23] time 0.188 (0.183) data 0.109 (0.107) loss_x loss_x 0.7993 (0.7571) acc_x 84.3750 (83.7500) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/23] time 0.173 (0.190) data 0.097 (0.102) loss_x loss_x 0.7729 (0.7194) acc_x 84.3750 (83.7500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/23] time 0.171 (0.182) data 0.094 (0.098) loss_x loss_x 0.5688 (0.6638) acc_x 90.6250 (84.7917) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/23] time 0.167 (0.181) data 0.090 (0.098) loss_x loss_x 0.3931 (0.6416) acc_x 84.3750 (84.5312) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:731
clean false:4
clean_rate:0.9945578231292517
noisy true:397
noisy false:484
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [144/200] batch [5/22] time 0.183 (0.191) data 0.106 (0.114) loss_x loss_x 0.7241 (0.6022) acc_x 87.5000 (87.5000) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/22] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.2678 (0.6039) acc_x 93.7500 (85.6250) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/22] time 0.194 (0.187) data 0.118 (0.110) loss_x loss_x 0.4375 (0.6269) acc_x 84.3750 (84.3750) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/22] time 0.181 (0.197) data 0.105 (0.110) loss_x loss_x 0.9355 (0.6392) acc_x 78.1250 (84.3750) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.4653, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 752
clean true:747
clean false:5
clean_rate:0.9933510638297872
noisy true:382
noisy false:482
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 864
epoch [145/200] batch [5/23] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.4875 (0.6194) acc_x 87.5000 (81.8750) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/23] time 0.169 (0.183) data 0.092 (0.106) loss_x loss_x 0.8975 (0.6441) acc_x 68.7500 (80.3125) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/23] time 0.188 (0.184) data 0.112 (0.107) loss_x loss_x 1.0205 (0.6922) acc_x 84.3750 (79.7917) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/23] time 0.192 (0.182) data 0.115 (0.106) loss_x loss_x 0.4827 (0.6536) acc_x 90.6250 (81.7188) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:732
clean false:3
clean_rate:0.9959183673469387
noisy true:391
noisy false:490
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [146/200] batch [5/22] time 0.282 (0.188) data 0.095 (0.089) loss_x loss_x 0.6489 (0.6062) acc_x 84.3750 (85.0000) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/22] time 0.180 (0.197) data 0.103 (0.104) loss_x loss_x 0.5586 (0.6135) acc_x 87.5000 (83.4375) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/22] time 0.212 (0.194) data 0.135 (0.107) loss_x loss_x 0.5352 (0.5769) acc_x 90.6250 (85.2083) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/22] time 0.174 (0.189) data 0.097 (0.104) loss_x loss_x 0.3020 (0.5588) acc_x 93.7500 (85.9375) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4542, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 734
clean true:727
clean false:7
clean_rate:0.9904632152588556
noisy true:403
noisy false:479
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 882
epoch [147/200] batch [5/22] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.3259 (0.5095) acc_x 84.3750 (85.0000) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/22] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.7456 (0.6278) acc_x 84.3750 (83.7500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/22] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.7383 (0.6439) acc_x 81.2500 (83.1250) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/22] time 0.293 (0.190) data 0.107 (0.105) loss_x loss_x 0.6128 (0.6455) acc_x 81.2500 (83.4375) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 479
confident_label rate tensor(0.4592, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 742
clean true:738
clean false:4
clean_rate:0.9946091644204852
noisy true:399
noisy false:475
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 874
epoch [148/200] batch [5/23] time 0.166 (0.216) data 0.089 (0.112) loss_x loss_x 0.8828 (0.7145) acc_x 78.1250 (81.2500) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/23] time 0.181 (0.194) data 0.103 (0.103) loss_x loss_x 0.6675 (0.6857) acc_x 78.1250 (81.5625) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/23] time 0.182 (0.191) data 0.104 (0.104) loss_x loss_x 0.2133 (0.6393) acc_x 96.8750 (82.7083) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/23] time 0.183 (0.189) data 0.106 (0.105) loss_x loss_x 0.5747 (0.6150) acc_x 84.3750 (83.5938) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.4561, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 737
clean true:732
clean false:5
clean_rate:0.9932157394843962
noisy true:388
noisy false:491
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 879
epoch [149/200] batch [5/23] time 0.169 (0.171) data 0.092 (0.094) loss_x loss_x 0.5723 (0.4584) acc_x 81.2500 (88.7500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/23] time 0.170 (0.187) data 0.093 (0.096) loss_x loss_x 0.7549 (0.5600) acc_x 68.7500 (84.3750) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/23] time 0.161 (0.184) data 0.084 (0.098) loss_x loss_x 0.5801 (0.6013) acc_x 93.7500 (83.7500) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/23] time 0.189 (0.183) data 0.112 (0.099) loss_x loss_x 0.2382 (0.5784) acc_x 100.0000 (84.6875) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 758
clean true:750
clean false:8
clean_rate:0.9894459102902374
noisy true:384
noisy false:474
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 858
epoch [150/200] batch [5/23] time 0.169 (0.169) data 0.093 (0.093) loss_x loss_x 0.9531 (0.6514) acc_x 71.8750 (83.7500) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/23] time 0.177 (0.171) data 0.100 (0.095) loss_x loss_x 0.9243 (0.7269) acc_x 75.0000 (80.6250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/23] time 0.183 (0.175) data 0.106 (0.099) loss_x loss_x 0.5229 (0.7385) acc_x 87.5000 (80.0000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/23] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.5557 (0.7152) acc_x 90.6250 (80.9375) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.4579, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 740
clean true:738
clean false:2
clean_rate:0.9972972972972973
noisy true:407
noisy false:469
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 876
epoch [151/200] batch [5/23] time 0.157 (0.169) data 0.080 (0.092) loss_x loss_x 0.8228 (0.5489) acc_x 78.1250 (86.8750) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/23] time 0.159 (0.169) data 0.083 (0.092) loss_x loss_x 0.4189 (0.5667) acc_x 87.5000 (86.2500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/23] time 0.158 (0.165) data 0.081 (0.089) loss_x loss_x 0.8325 (0.6423) acc_x 68.7500 (84.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/23] time 0.157 (0.164) data 0.081 (0.088) loss_x loss_x 0.6108 (0.6040) acc_x 81.2500 (85.1562) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.4598, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 743
clean true:740
clean false:3
clean_rate:0.9959623149394348
noisy true:392
noisy false:481
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 873
epoch [152/200] batch [5/23] time 0.175 (0.186) data 0.099 (0.109) loss_x loss_x 0.7378 (0.7793) acc_x 78.1250 (79.3750) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/23] time 0.208 (0.183) data 0.131 (0.106) loss_x loss_x 0.4878 (0.7595) acc_x 90.6250 (79.3750) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/23] time 0.188 (0.185) data 0.110 (0.108) loss_x loss_x 0.6182 (0.7416) acc_x 81.2500 (80.6250) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/23] time 0.165 (0.183) data 0.089 (0.106) loss_x loss_x 0.4802 (0.7227) acc_x 87.5000 (80.9375) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:730
clean false:5
clean_rate:0.9931972789115646
noisy true:393
noisy false:488
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [153/200] batch [5/22] time 0.178 (0.172) data 0.100 (0.095) loss_x loss_x 1.0410 (0.6426) acc_x 71.8750 (85.0000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/22] time 0.187 (0.181) data 0.110 (0.103) loss_x loss_x 0.4631 (0.5956) acc_x 87.5000 (85.0000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/22] time 0.183 (0.194) data 0.105 (0.103) loss_x loss_x 1.0430 (0.5988) acc_x 65.6250 (83.7500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/22] time 0.191 (0.190) data 0.114 (0.102) loss_x loss_x 0.4133 (0.6074) acc_x 87.5000 (83.5938) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4573, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 739
clean true:733
clean false:6
clean_rate:0.9918809201623816
noisy true:389
noisy false:488
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 877
epoch [154/200] batch [5/23] time 0.180 (0.175) data 0.102 (0.097) loss_x loss_x 0.6294 (0.8028) acc_x 90.6250 (81.2500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/23] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.3362 (0.7357) acc_x 90.6250 (83.1250) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/23] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.3137 (0.6997) acc_x 87.5000 (82.9167) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/23] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.7144 (0.6756) acc_x 81.2500 (82.8125) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.4585, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 741
clean true:739
clean false:2
clean_rate:0.9973009446693657
noisy true:393
noisy false:482
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 875
epoch [155/200] batch [5/23] time 0.172 (0.172) data 0.095 (0.095) loss_x loss_x 0.5918 (0.5295) acc_x 81.2500 (83.1250) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/23] time 0.169 (0.171) data 0.092 (0.094) loss_x loss_x 0.5503 (0.5785) acc_x 81.2500 (81.8750) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/23] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.3997 (0.5357) acc_x 87.5000 (82.9167) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/23] time 0.197 (0.178) data 0.121 (0.101) loss_x loss_x 0.5703 (0.5712) acc_x 84.3750 (82.8125) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.4511, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 729
clean true:724
clean false:5
clean_rate:0.9931412894375857
noisy true:395
noisy false:492
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 887
epoch [156/200] batch [5/22] time 0.185 (0.210) data 0.108 (0.092) loss_x loss_x 0.6265 (0.7717) acc_x 87.5000 (80.0000) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/22] time 0.173 (0.194) data 0.096 (0.096) loss_x loss_x 0.3511 (0.7748) acc_x 96.8750 (82.1875) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/22] time 0.224 (0.193) data 0.148 (0.103) loss_x loss_x 0.5112 (0.6875) acc_x 81.2500 (82.9167) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/22] time 0.172 (0.187) data 0.096 (0.100) loss_x loss_x 0.4922 (0.6456) acc_x 87.5000 (83.5938) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.4480, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 724
clean true:720
clean false:4
clean_rate:0.994475138121547
noisy true:398
noisy false:494
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 892
epoch [157/200] batch [5/22] time 0.179 (0.204) data 0.102 (0.118) loss_x loss_x 0.6450 (0.6658) acc_x 84.3750 (83.7500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/22] time 0.178 (0.193) data 0.101 (0.111) loss_x loss_x 0.8936 (0.6349) acc_x 75.0000 (82.5000) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/22] time 0.159 (0.182) data 0.081 (0.102) loss_x loss_x 0.5088 (0.6271) acc_x 87.5000 (83.5417) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/22] time 0.162 (0.177) data 0.084 (0.097) loss_x loss_x 0.6216 (0.6122) acc_x 87.5000 (84.8438) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.4653, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 752
clean true:746
clean false:6
clean_rate:0.9920212765957447
noisy true:382
noisy false:482
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 864
epoch [158/200] batch [5/23] time 0.164 (0.201) data 0.087 (0.103) loss_x loss_x 0.6216 (0.6096) acc_x 75.0000 (82.5000) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/23] time 0.166 (0.186) data 0.089 (0.098) loss_x loss_x 1.0400 (0.7154) acc_x 75.0000 (81.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/23] time 0.195 (0.186) data 0.119 (0.102) loss_x loss_x 0.5610 (0.6622) acc_x 90.6250 (83.7500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/23] time 0.171 (0.185) data 0.094 (0.103) loss_x loss_x 0.4756 (0.6876) acc_x 84.3750 (82.8125) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 483
confident_label rate tensor(0.4579, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 740
clean true:737
clean false:3
clean_rate:0.995945945945946
noisy true:396
noisy false:480
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 876
epoch [159/200] batch [5/23] time 0.270 (0.210) data 0.130 (0.099) loss_x loss_x 0.3579 (0.7787) acc_x 93.7500 (82.5000) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/23] time 0.161 (0.196) data 0.085 (0.101) loss_x loss_x 1.0166 (0.6886) acc_x 75.0000 (84.0625) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/23] time 0.176 (0.191) data 0.098 (0.103) loss_x loss_x 0.9482 (0.7013) acc_x 68.7500 (82.7083) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/23] time 0.212 (0.190) data 0.135 (0.105) loss_x loss_x 0.6587 (0.7009) acc_x 87.5000 (82.9688) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.4666, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 754
clean true:747
clean false:7
clean_rate:0.9907161803713528
noisy true:393
noisy false:469
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 862
epoch [160/200] batch [5/23] time 0.192 (0.190) data 0.115 (0.112) loss_x loss_x 0.6348 (0.6220) acc_x 84.3750 (84.3750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/23] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.8350 (0.6835) acc_x 78.1250 (82.1875) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/23] time 0.167 (0.188) data 0.091 (0.111) loss_x loss_x 0.6523 (0.6642) acc_x 87.5000 (83.3333) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/23] time 0.176 (0.188) data 0.099 (0.110) loss_x loss_x 0.2896 (0.6337) acc_x 96.8750 (84.6875) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.4610, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 745
clean true:742
clean false:3
clean_rate:0.9959731543624161
noisy true:383
noisy false:488
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 871
epoch [161/200] batch [5/23] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 0.7275 (0.6410) acc_x 84.3750 (83.7500) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/23] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 1.0420 (0.7081) acc_x 78.1250 (82.1875) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/23] time 0.168 (0.180) data 0.091 (0.103) loss_x loss_x 0.8213 (0.7136) acc_x 78.1250 (82.2917) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/23] time 0.193 (0.186) data 0.116 (0.103) loss_x loss_x 0.5537 (0.6950) acc_x 87.5000 (81.8750) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 466
confident_label rate tensor(0.4684, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 757
clean true:752
clean false:5
clean_rate:0.9933949801849405
noisy true:398
noisy false:461
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 859
epoch [162/200] batch [5/23] time 0.189 (0.189) data 0.112 (0.112) loss_x loss_x 0.6436 (0.7349) acc_x 87.5000 (85.0000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/23] time 0.192 (0.188) data 0.116 (0.111) loss_x loss_x 0.5073 (0.8094) acc_x 90.6250 (81.8750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/23] time 0.178 (0.182) data 0.101 (0.105) loss_x loss_x 0.7397 (0.7807) acc_x 78.1250 (81.8750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/23] time 0.160 (0.180) data 0.082 (0.103) loss_x loss_x 0.9468 (0.7322) acc_x 81.2500 (82.8125) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.4579, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 740
clean true:738
clean false:2
clean_rate:0.9972972972972973
noisy true:388
noisy false:488
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 876
epoch [163/200] batch [5/23] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.4980 (0.5213) acc_x 81.2500 (85.0000) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/23] time 0.188 (0.181) data 0.110 (0.104) loss_x loss_x 0.3308 (0.4906) acc_x 93.7500 (86.5625) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/23] time 0.163 (0.181) data 0.085 (0.103) loss_x loss_x 0.8657 (0.5360) acc_x 71.8750 (86.0417) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/23] time 0.175 (0.180) data 0.099 (0.103) loss_x loss_x 0.3167 (0.5509) acc_x 87.5000 (85.6250) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4585, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 741
clean true:737
clean false:4
clean_rate:0.9946018893387314
noisy true:385
noisy false:490
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 875
epoch [164/200] batch [5/23] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.4614 (0.7664) acc_x 90.6250 (83.7500) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/23] time 0.169 (0.179) data 0.093 (0.102) loss_x loss_x 0.6904 (0.6876) acc_x 78.1250 (84.0625) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/23] time 0.175 (0.188) data 0.098 (0.103) loss_x loss_x 0.4895 (0.6031) acc_x 84.3750 (85.0000) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/23] time 0.173 (0.183) data 0.096 (0.100) loss_x loss_x 0.4829 (0.6220) acc_x 87.5000 (84.5312) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.4604, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 744
clean true:740
clean false:4
clean_rate:0.9946236559139785
noisy true:391
noisy false:481
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 872
epoch [165/200] batch [5/23] time 0.178 (0.195) data 0.101 (0.119) loss_x loss_x 0.9414 (0.6060) acc_x 75.0000 (88.7500) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/23] time 0.160 (0.200) data 0.083 (0.106) loss_x loss_x 0.2903 (0.5939) acc_x 93.7500 (88.1250) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/23] time 0.192 (0.192) data 0.114 (0.104) loss_x loss_x 0.2069 (0.5748) acc_x 93.7500 (87.5000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/23] time 0.189 (0.189) data 0.111 (0.104) loss_x loss_x 0.2703 (0.5542) acc_x 96.8750 (87.5000) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.4604, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 744
clean true:739
clean false:5
clean_rate:0.9932795698924731
noisy true:397
noisy false:475
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 872
epoch [166/200] batch [5/23] time 0.180 (0.183) data 0.103 (0.107) loss_x loss_x 0.8052 (0.7054) acc_x 81.2500 (83.1250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/23] time 0.171 (0.179) data 0.093 (0.102) loss_x loss_x 0.4045 (0.6897) acc_x 90.6250 (83.4375) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/23] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.7446 (0.7208) acc_x 87.5000 (82.9167) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/23] time 0.163 (0.173) data 0.085 (0.096) loss_x loss_x 0.6045 (0.7128) acc_x 81.2500 (82.5000) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 758
clean true:751
clean false:7
clean_rate:0.9907651715039578
noisy true:394
noisy false:464
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 858
epoch [167/200] batch [5/23] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.8774 (0.6362) acc_x 78.1250 (86.8750) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/23] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.6865 (0.5748) acc_x 81.2500 (85.3125) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/23] time 0.161 (0.182) data 0.084 (0.105) loss_x loss_x 0.5381 (0.5895) acc_x 90.6250 (85.0000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/23] time 0.171 (0.179) data 0.094 (0.103) loss_x loss_x 0.3572 (0.6057) acc_x 93.7500 (84.8438) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.4697, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 759
clean true:751
clean false:8
clean_rate:0.9894598155467721
noisy true:383
noisy false:474
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 857
epoch [168/200] batch [5/23] time 0.173 (0.220) data 0.096 (0.099) loss_x loss_x 0.7227 (0.4839) acc_x 78.1250 (86.2500) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/23] time 0.176 (0.201) data 0.099 (0.102) loss_x loss_x 0.3462 (0.5547) acc_x 93.7500 (85.3125) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/23] time 0.193 (0.193) data 0.116 (0.101) loss_x loss_x 0.7256 (0.5842) acc_x 84.3750 (85.4167) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/23] time 0.168 (0.189) data 0.090 (0.100) loss_x loss_x 0.3784 (0.6291) acc_x 90.6250 (84.3750) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.4579, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 740
clean true:737
clean false:3
clean_rate:0.995945945945946
noisy true:398
noisy false:478
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 876
epoch [169/200] batch [5/23] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.6875 (0.7368) acc_x 75.0000 (83.1250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/23] time 0.292 (0.191) data 0.106 (0.103) loss_x loss_x 0.4805 (0.6835) acc_x 81.2500 (83.4375) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/23] time 0.185 (0.189) data 0.109 (0.105) loss_x loss_x 0.4697 (0.7023) acc_x 87.5000 (82.9167) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/23] time 0.184 (0.188) data 0.108 (0.105) loss_x loss_x 0.5669 (0.6560) acc_x 78.1250 (83.1250) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 513
confident_label rate tensor(0.4542, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 734
clean true:730
clean false:4
clean_rate:0.9945504087193461
noisy true:373
noisy false:509
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 882
epoch [170/200] batch [5/22] time 0.190 (0.174) data 0.113 (0.097) loss_x loss_x 0.4998 (0.4871) acc_x 84.3750 (87.5000) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/22] time 0.179 (0.178) data 0.102 (0.101) loss_x loss_x 0.5229 (0.5295) acc_x 84.3750 (86.5625) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/22] time 0.195 (0.177) data 0.118 (0.100) loss_x loss_x 0.7642 (0.5995) acc_x 78.1250 (84.5833) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/22] time 0.177 (0.176) data 0.099 (0.099) loss_x loss_x 0.4548 (0.5750) acc_x 87.5000 (85.0000) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 760
clean true:756
clean false:4
clean_rate:0.9947368421052631
noisy true:380
noisy false:476
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 856
epoch [171/200] batch [5/23] time 0.180 (0.186) data 0.103 (0.109) loss_x loss_x 0.5425 (0.6466) acc_x 90.6250 (83.7500) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/23] time 0.177 (0.181) data 0.099 (0.103) loss_x loss_x 0.7944 (0.6337) acc_x 81.2500 (84.3750) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/23] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.6787 (0.6222) acc_x 87.5000 (84.3750) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/23] time 0.182 (0.186) data 0.106 (0.105) loss_x loss_x 0.6738 (0.6034) acc_x 81.2500 (85.0000) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 475
confident_label rate tensor(0.4641, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 750
clean true:746
clean false:4
clean_rate:0.9946666666666667
noisy true:395
noisy false:471
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 866
epoch [172/200] batch [5/23] time 0.189 (0.189) data 0.112 (0.112) loss_x loss_x 0.7051 (0.5955) acc_x 81.2500 (84.3750) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/23] time 0.185 (0.201) data 0.108 (0.113) loss_x loss_x 0.3357 (0.5552) acc_x 84.3750 (84.3750) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/23] time 0.180 (0.194) data 0.103 (0.109) loss_x loss_x 1.3506 (0.6220) acc_x 71.8750 (83.3333) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/23] time 0.169 (0.188) data 0.092 (0.106) loss_x loss_x 0.5361 (0.6522) acc_x 87.5000 (82.8125) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 477
confident_label rate tensor(0.4641, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 750
clean true:748
clean false:2
clean_rate:0.9973333333333333
noisy true:391
noisy false:475
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 866
epoch [173/200] batch [5/23] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 1.2061 (0.7294) acc_x 78.1250 (83.1250) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/23] time 0.159 (0.169) data 0.082 (0.093) loss_x loss_x 0.9985 (0.6790) acc_x 81.2500 (84.0625) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/23] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.6284 (0.6347) acc_x 81.2500 (84.5833) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/23] time 0.169 (0.168) data 0.093 (0.091) loss_x loss_x 0.2314 (0.6103) acc_x 96.8750 (84.6875) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 760
clean true:755
clean false:5
clean_rate:0.993421052631579
noisy true:397
noisy false:459
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 856
epoch [174/200] batch [5/23] time 0.184 (0.197) data 0.107 (0.120) loss_x loss_x 0.6406 (0.6821) acc_x 84.3750 (81.8750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/23] time 0.185 (0.191) data 0.106 (0.114) loss_x loss_x 1.0088 (0.6366) acc_x 68.7500 (83.1250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/23] time 0.181 (0.188) data 0.104 (0.111) loss_x loss_x 0.6313 (0.6157) acc_x 84.3750 (83.5417) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/23] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.5928 (0.6203) acc_x 81.2500 (83.5938) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 466
confident_label rate tensor(0.4697, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 759
clean true:756
clean false:3
clean_rate:0.9960474308300395
noisy true:394
noisy false:463
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 857
epoch [175/200] batch [5/23] time 0.159 (0.169) data 0.083 (0.092) loss_x loss_x 0.4287 (0.5569) acc_x 84.3750 (83.1250) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/23] time 0.159 (0.175) data 0.082 (0.098) loss_x loss_x 0.4651 (0.6189) acc_x 87.5000 (83.1250) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/23] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.7227 (0.6317) acc_x 81.2500 (82.5000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/23] time 0.213 (0.177) data 0.136 (0.101) loss_x loss_x 0.7773 (0.6769) acc_x 78.1250 (82.1875) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 479
confident_label rate tensor(0.4610, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 745
clean true:742
clean false:3
clean_rate:0.9959731543624161
noisy true:395
noisy false:476
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 871
epoch [176/200] batch [5/23] time 0.173 (0.176) data 0.095 (0.099) loss_x loss_x 0.5557 (0.6818) acc_x 93.7500 (84.3750) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/23] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 1.0146 (0.6509) acc_x 75.0000 (83.4375) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/23] time 0.171 (0.172) data 0.094 (0.095) loss_x loss_x 0.4192 (0.6226) acc_x 90.6250 (84.3750) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/23] time 0.278 (0.183) data 0.095 (0.096) loss_x loss_x 0.8350 (0.6489) acc_x 68.7500 (83.7500) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:732
clean false:3
clean_rate:0.9959183673469387
noisy true:386
noisy false:495
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [177/200] batch [5/22] time 0.180 (0.195) data 0.104 (0.118) loss_x loss_x 0.8281 (0.6441) acc_x 78.1250 (85.6250) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/22] time 0.174 (0.190) data 0.095 (0.113) loss_x loss_x 0.4043 (0.6021) acc_x 90.6250 (86.2500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/22] time 0.161 (0.185) data 0.084 (0.108) loss_x loss_x 0.7256 (0.6304) acc_x 87.5000 (85.2083) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/22] time 0.215 (0.182) data 0.137 (0.105) loss_x loss_x 0.4426 (0.6337) acc_x 87.5000 (85.0000) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.4660, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 753
clean true:746
clean false:7
clean_rate:0.9907038512616202
noisy true:388
noisy false:475
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 863
epoch [178/200] batch [5/23] time 0.177 (0.180) data 0.100 (0.104) loss_x loss_x 0.6167 (0.6639) acc_x 81.2500 (83.7500) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/23] time 0.171 (0.180) data 0.094 (0.103) loss_x loss_x 0.7397 (0.6225) acc_x 81.2500 (84.6875) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/23] time 0.193 (0.180) data 0.115 (0.103) loss_x loss_x 1.0352 (0.5938) acc_x 68.7500 (84.3750) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/23] time 0.178 (0.187) data 0.101 (0.104) loss_x loss_x 0.7476 (0.6126) acc_x 81.2500 (83.9062) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 463
confident_label rate tensor(0.4629, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 748
clean true:743
clean false:5
clean_rate:0.9933155080213903
noisy true:410
noisy false:458
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 868
epoch [179/200] batch [5/23] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 0.3296 (0.5687) acc_x 93.7500 (86.2500) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/23] time 0.177 (0.197) data 0.101 (0.102) loss_x loss_x 0.2981 (0.5652) acc_x 90.6250 (85.6250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/23] time 0.173 (0.189) data 0.096 (0.100) loss_x loss_x 0.8203 (0.5765) acc_x 84.3750 (85.6250) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/23] time 0.160 (0.184) data 0.083 (0.098) loss_x loss_x 1.0371 (0.6003) acc_x 75.0000 (84.8438) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.4573, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 739
clean true:733
clean false:6
clean_rate:0.9918809201623816
noisy true:382
noisy false:495
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 877
epoch [180/200] batch [5/23] time 0.160 (0.168) data 0.083 (0.091) loss_x loss_x 0.5366 (0.5154) acc_x 81.2500 (86.2500) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/23] time 0.158 (0.166) data 0.082 (0.089) loss_x loss_x 0.7026 (0.5351) acc_x 84.3750 (86.5625) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/23] time 0.159 (0.164) data 0.082 (0.087) loss_x loss_x 0.3381 (0.5346) acc_x 90.6250 (86.2500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/23] time 0.224 (0.174) data 0.147 (0.092) loss_x loss_x 0.6479 (0.5660) acc_x 78.1250 (86.0938) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 478
confident_label rate tensor(0.4604, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 744
clean true:737
clean false:7
clean_rate:0.9905913978494624
noisy true:401
noisy false:471
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 872
epoch [181/200] batch [5/23] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.7544 (0.6610) acc_x 87.5000 (86.8750) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/23] time 0.160 (0.185) data 0.083 (0.099) loss_x loss_x 0.9829 (0.7311) acc_x 87.5000 (84.3750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/23] time 0.232 (0.185) data 0.155 (0.102) loss_x loss_x 0.7217 (0.6517) acc_x 78.1250 (85.0000) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/23] time 0.185 (0.189) data 0.108 (0.108) loss_x loss_x 0.8018 (0.6473) acc_x 81.2500 (85.1562) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4573, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 739
clean true:737
clean false:2
clean_rate:0.9972936400541272
noisy true:393
noisy false:484
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 877
epoch [182/200] batch [5/23] time 0.178 (0.186) data 0.101 (0.109) loss_x loss_x 0.8125 (0.6458) acc_x 84.3750 (85.6250) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/23] time 0.169 (0.176) data 0.093 (0.099) loss_x loss_x 0.7275 (0.6603) acc_x 87.5000 (83.7500) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/23] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.8472 (0.5956) acc_x 78.1250 (84.5833) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/23] time 0.192 (0.178) data 0.112 (0.101) loss_x loss_x 0.4102 (0.5716) acc_x 84.3750 (85.0000) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 447
confident_label rate tensor(0.4752, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 768
clean true:767
clean false:1
clean_rate:0.9986979166666666
noisy true:402
noisy false:446
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 848
epoch [183/200] batch [5/24] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.3892 (0.5594) acc_x 93.7500 (85.0000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/24] time 0.182 (0.176) data 0.105 (0.098) loss_x loss_x 0.2861 (0.5097) acc_x 90.6250 (86.8750) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/24] time 0.191 (0.176) data 0.114 (0.099) loss_x loss_x 0.5664 (0.5244) acc_x 87.5000 (86.4583) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/24] time 0.187 (0.178) data 0.110 (0.101) loss_x loss_x 0.3296 (0.5145) acc_x 93.7500 (86.0938) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 460
confident_label rate tensor(0.4759, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 769
clean true:767
clean false:2
clean_rate:0.9973992197659298
noisy true:389
noisy false:458
after delete: len(clean_dataset) 769
after delete: len(noisy_dataset) 847
epoch [184/200] batch [5/24] time 0.188 (0.212) data 0.111 (0.105) loss_x loss_x 0.8369 (0.5827) acc_x 75.0000 (83.7500) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/24] time 0.183 (0.196) data 0.106 (0.105) loss_x loss_x 0.5942 (0.5831) acc_x 84.3750 (83.7500) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/24] time 0.188 (0.193) data 0.111 (0.107) loss_x loss_x 0.6094 (0.6097) acc_x 84.3750 (84.1667) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/24] time 0.182 (0.192) data 0.105 (0.108) loss_x loss_x 0.9404 (0.6203) acc_x 75.0000 (84.2188) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 483
confident_label rate tensor(0.4629, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 748
clean true:745
clean false:3
clean_rate:0.9959893048128342
noisy true:388
noisy false:480
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 868
epoch [185/200] batch [5/23] time 0.183 (0.187) data 0.104 (0.109) loss_x loss_x 0.6060 (0.5809) acc_x 90.6250 (87.5000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/23] time 0.161 (0.185) data 0.085 (0.107) loss_x loss_x 0.6611 (0.6447) acc_x 84.3750 (85.0000) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/23] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.2156 (0.5697) acc_x 96.8750 (86.8750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/23] time 0.185 (0.182) data 0.109 (0.099) loss_x loss_x 0.6997 (0.6177) acc_x 81.2500 (84.8438) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.4660, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 753
clean true:748
clean false:5
clean_rate:0.9933598937583001
noisy true:386
noisy false:477
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 863
epoch [186/200] batch [5/23] time 0.187 (0.186) data 0.111 (0.109) loss_x loss_x 0.7349 (0.6104) acc_x 75.0000 (82.5000) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/23] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.8887 (0.6052) acc_x 75.0000 (83.1250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/23] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 0.6367 (0.6057) acc_x 81.2500 (84.1667) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/23] time 0.161 (0.181) data 0.084 (0.104) loss_x loss_x 0.6572 (0.5822) acc_x 81.2500 (84.5312) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 445
confident_label rate tensor(0.4746, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 767
clean true:765
clean false:2
clean_rate:0.9973924380704041
noisy true:406
noisy false:443
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 849
epoch [187/200] batch [5/23] time 0.169 (0.173) data 0.092 (0.095) loss_x loss_x 0.4858 (0.6968) acc_x 87.5000 (81.2500) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/23] time 0.194 (0.170) data 0.118 (0.093) loss_x loss_x 0.6157 (0.6295) acc_x 81.2500 (84.6875) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/23] time 0.175 (0.178) data 0.098 (0.093) loss_x loss_x 0.2620 (0.5711) acc_x 93.7500 (85.8333) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/23] time 0.195 (0.180) data 0.117 (0.098) loss_x loss_x 0.2986 (0.5510) acc_x 93.7500 (87.0312) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 758
clean true:754
clean false:4
clean_rate:0.9947229551451188
noisy true:381
noisy false:477
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 858
epoch [188/200] batch [5/23] time 0.166 (0.174) data 0.090 (0.097) loss_x loss_x 0.5254 (0.5736) acc_x 87.5000 (84.3750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/23] time 0.168 (0.170) data 0.092 (0.093) loss_x loss_x 0.6025 (0.5241) acc_x 81.2500 (85.3125) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/23] time 0.183 (0.175) data 0.106 (0.097) loss_x loss_x 0.4800 (0.5364) acc_x 90.6250 (84.7917) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/23] time 0.171 (0.174) data 0.093 (0.096) loss_x loss_x 0.6821 (0.5827) acc_x 81.2500 (84.8438) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 479
confident_label rate tensor(0.4536, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 733
clean true:730
clean false:3
clean_rate:0.9959072305593452
noisy true:407
noisy false:476
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 883
epoch [189/200] batch [5/22] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.6597 (0.5035) acc_x 90.6250 (89.3750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/22] time 0.165 (0.175) data 0.088 (0.098) loss_x loss_x 0.4849 (0.5495) acc_x 87.5000 (88.4375) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/22] time 0.213 (0.190) data 0.135 (0.113) loss_x loss_x 0.8789 (0.6058) acc_x 81.2500 (86.6667) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/22] time 0.222 (0.195) data 0.145 (0.117) loss_x loss_x 0.6460 (0.6088) acc_x 81.2500 (86.4062) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.4604, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 744
clean true:740
clean false:4
clean_rate:0.9946236559139785
noisy true:387
noisy false:485
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 872
epoch [190/200] batch [5/23] time 0.158 (0.179) data 0.080 (0.101) loss_x loss_x 0.5508 (0.5766) acc_x 84.3750 (85.0000) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/23] time 0.160 (0.169) data 0.084 (0.092) loss_x loss_x 0.4971 (0.5216) acc_x 87.5000 (86.8750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/23] time 0.172 (0.169) data 0.095 (0.091) loss_x loss_x 0.4465 (0.5105) acc_x 81.2500 (86.4583) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/23] time 0.178 (0.170) data 0.100 (0.093) loss_x loss_x 0.4233 (0.5454) acc_x 90.6250 (85.6250) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 448
confident_label rate tensor(0.4802, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 776
clean true:771
clean false:5
clean_rate:0.9935567010309279
noisy true:397
noisy false:443
after delete: len(clean_dataset) 776
after delete: len(noisy_dataset) 840
epoch [191/200] batch [5/24] time 0.160 (0.180) data 0.084 (0.103) loss_x loss_x 0.8320 (0.6869) acc_x 78.1250 (83.1250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/24] time 0.163 (0.172) data 0.084 (0.095) loss_x loss_x 0.5054 (0.6223) acc_x 87.5000 (84.6875) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/24] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.4688 (0.5890) acc_x 90.6250 (86.4583) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/24] time 0.196 (0.179) data 0.119 (0.102) loss_x loss_x 0.8594 (0.6387) acc_x 78.1250 (84.5312) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:728
clean false:7
clean_rate:0.9904761904761905
noisy true:397
noisy false:484
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [192/200] batch [5/22] time 0.183 (0.197) data 0.107 (0.120) loss_x loss_x 0.5552 (0.7723) acc_x 84.3750 (82.5000) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/22] time 0.174 (0.188) data 0.097 (0.111) loss_x loss_x 0.6504 (0.6549) acc_x 84.3750 (84.6875) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/22] time 0.180 (0.188) data 0.102 (0.109) loss_x loss_x 0.4705 (0.6746) acc_x 87.5000 (83.7500) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/22] time 0.183 (0.185) data 0.105 (0.106) loss_x loss_x 0.7080 (0.6827) acc_x 84.3750 (83.2812) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 467
confident_label rate tensor(0.4660, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 753
clean true:747
clean false:6
clean_rate:0.9920318725099602
noisy true:402
noisy false:461
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 863
epoch [193/200] batch [5/23] time 0.163 (0.170) data 0.085 (0.093) loss_x loss_x 0.5259 (0.6429) acc_x 84.3750 (82.5000) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/23] time 0.172 (0.196) data 0.095 (0.098) loss_x loss_x 0.5562 (0.6438) acc_x 81.2500 (83.1250) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/23] time 0.165 (0.188) data 0.088 (0.098) loss_x loss_x 0.4226 (0.6561) acc_x 84.3750 (82.5000) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/23] time 0.221 (0.185) data 0.144 (0.098) loss_x loss_x 0.8936 (0.6706) acc_x 78.1250 (82.5000) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 756
clean true:753
clean false:3
clean_rate:0.996031746031746
noisy true:404
noisy false:456
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 860
epoch [194/200] batch [5/23] time 0.164 (0.167) data 0.088 (0.090) loss_x loss_x 0.7202 (0.6876) acc_x 78.1250 (81.8750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/23] time 0.167 (0.177) data 0.090 (0.089) loss_x loss_x 0.7090 (0.6440) acc_x 81.2500 (83.1250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/23] time 0.191 (0.179) data 0.114 (0.095) loss_x loss_x 0.6636 (0.6771) acc_x 81.2500 (80.8333) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/23] time 0.195 (0.182) data 0.118 (0.099) loss_x loss_x 0.2278 (0.6313) acc_x 93.7500 (82.1875) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 477
confident_label rate tensor(0.4697, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 759
clean true:756
clean false:3
clean_rate:0.9960474308300395
noisy true:383
noisy false:474
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 857
epoch [195/200] batch [5/23] time 0.183 (0.180) data 0.107 (0.103) loss_x loss_x 0.7588 (0.6013) acc_x 81.2500 (86.8750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/23] time 0.191 (0.181) data 0.115 (0.104) loss_x loss_x 0.2222 (0.5371) acc_x 96.8750 (88.1250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/23] time 0.169 (0.180) data 0.092 (0.103) loss_x loss_x 0.7368 (0.5606) acc_x 84.3750 (87.0833) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/23] time 0.156 (0.175) data 0.079 (0.098) loss_x loss_x 0.8882 (0.5694) acc_x 78.1250 (87.1875) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 458
confident_label rate tensor(0.4722, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 763
clean true:758
clean false:5
clean_rate:0.9934469200524246
noisy true:400
noisy false:453
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 853
epoch [196/200] batch [5/23] time 0.161 (0.201) data 0.084 (0.092) loss_x loss_x 0.8735 (0.8122) acc_x 81.2500 (80.0000) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/23] time 0.170 (0.184) data 0.093 (0.091) loss_x loss_x 0.4980 (0.6747) acc_x 84.3750 (82.8125) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/23] time 0.186 (0.183) data 0.110 (0.096) loss_x loss_x 0.8643 (0.6519) acc_x 78.1250 (82.9167) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/23] time 0.183 (0.184) data 0.107 (0.099) loss_x loss_x 0.3130 (0.6292) acc_x 93.7500 (83.5938) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 465
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 758
clean true:753
clean false:5
clean_rate:0.9934036939313984
noisy true:398
noisy false:460
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 858
epoch [197/200] batch [5/23] time 0.161 (0.166) data 0.084 (0.089) loss_x loss_x 0.6484 (0.6306) acc_x 81.2500 (82.5000) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/23] time 0.187 (0.172) data 0.109 (0.095) loss_x loss_x 0.6895 (0.5403) acc_x 78.1250 (85.3125) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/23] time 0.183 (0.184) data 0.106 (0.099) loss_x loss_x 0.2471 (0.5222) acc_x 93.7500 (85.2083) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/23] time 0.166 (0.179) data 0.089 (0.097) loss_x loss_x 0.5645 (0.5498) acc_x 87.5000 (85.3125) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 467
confident_label rate tensor(0.4598, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 743
clean true:739
clean false:4
clean_rate:0.9946164199192463
noisy true:410
noisy false:463
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 873
epoch [198/200] batch [5/23] time 0.167 (0.167) data 0.089 (0.090) loss_x loss_x 0.5088 (0.4884) acc_x 87.5000 (88.7500) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/23] time 0.184 (0.192) data 0.106 (0.094) loss_x loss_x 0.7510 (0.6770) acc_x 84.3750 (83.7500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/23] time 0.186 (0.190) data 0.109 (0.099) loss_x loss_x 0.3030 (0.6590) acc_x 93.7500 (83.5417) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/23] time 0.193 (0.189) data 0.116 (0.101) loss_x loss_x 0.7065 (0.6381) acc_x 81.2500 (83.5938) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 470
confident_label rate tensor(0.4635, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 749
clean true:743
clean false:6
clean_rate:0.9919893190921228
noisy true:403
noisy false:464
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 867
epoch [199/200] batch [5/23] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.5742 (0.6552) acc_x 84.3750 (81.8750) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/23] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.8955 (0.6725) acc_x 78.1250 (80.3125) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/23] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7139 (0.6500) acc_x 78.1250 (80.4167) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/23] time 0.182 (0.186) data 0.105 (0.107) loss_x loss_x 0.6689 (0.6364) acc_x 84.3750 (81.8750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4573, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 739
clean true:738
clean false:1
clean_rate:0.9986468200270636
noisy true:392
noisy false:485
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 877
epoch [200/200] batch [5/23] time 0.180 (0.220) data 0.104 (0.109) loss_x loss_x 0.8950 (0.6581) acc_x 78.1250 (83.7500) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/23] time 0.184 (0.201) data 0.107 (0.108) loss_x loss_x 0.5840 (0.7242) acc_x 81.2500 (82.5000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/23] time 0.185 (0.195) data 0.108 (0.108) loss_x loss_x 0.2717 (0.6690) acc_x 90.6250 (83.3333) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/23] time 0.183 (0.194) data 0.106 (0.109) loss_x loss_x 0.4626 (0.6265) acc_x 90.6250 (84.3750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output_wo_mae/ucf101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,754
* accuracy: 72.8%
* error: 27.2%
* macro_f1: 70.7%
Elapsed: 0:42:20
