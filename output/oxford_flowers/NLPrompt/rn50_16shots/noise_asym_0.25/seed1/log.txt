***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.25', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.25
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 282
clean true:280
clean false:2
clean_rate:0.9929078014184397
noisy true:95
noisy false:1255
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1350
epoch [1/200] batch [5/8] time 0.342 (0.359) data 0.264 (0.262) loss_x loss_x 2.5742 (2.7465) acc_x 37.5000 (37.5000) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [5/42] time 0.327 (0.348) data 0.249 (0.261) loss_u loss_u 0.9756 (0.9752) acc_u 3.1250 (4.3750) lr 1.0000e-05 eta 0:00:12
epoch [1/200] batch [10/42] time 0.350 (0.344) data 0.271 (0.260) loss_u loss_u 0.9697 (0.9735) acc_u 3.1250 (5.0000) lr 1.0000e-05 eta 0:00:11
epoch [1/200] batch [15/42] time 0.352 (0.342) data 0.275 (0.259) loss_u loss_u 0.9746 (0.9678) acc_u 6.2500 (6.6667) lr 1.0000e-05 eta 0:00:09
epoch [1/200] batch [20/42] time 0.340 (0.341) data 0.262 (0.259) loss_u loss_u 0.9517 (0.9645) acc_u 9.3750 (7.3438) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [25/42] time 0.381 (0.341) data 0.303 (0.260) loss_u loss_u 0.9058 (0.9590) acc_u 15.6250 (8.1250) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [30/42] time 0.319 (0.340) data 0.242 (0.260) loss_u loss_u 0.9756 (0.9591) acc_u 3.1250 (7.9167) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [35/42] time 0.321 (0.339) data 0.242 (0.259) loss_u loss_u 0.9302 (0.9565) acc_u 12.5000 (8.6607) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [40/42] time 0.293 (0.334) data 0.215 (0.254) loss_u loss_u 0.9155 (0.9560) acc_u 31.2500 (9.1406) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1000
confident_label rate tensor(0.2898, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 473
clean true:470
clean false:3
clean_rate:0.9936575052854123
noisy true:162
noisy false:997
after delete: len(clean_dataset) 473
after delete: len(noisy_dataset) 1159
epoch [2/200] batch [5/14] time 0.342 (0.354) data 0.265 (0.277) loss_x loss_x 1.2070 (1.3513) acc_x 65.6250 (65.6250) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [10/14] time 0.329 (0.345) data 0.251 (0.267) loss_x loss_x 0.6284 (1.0617) acc_x 81.2500 (73.4375) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [5/36] time 0.329 (0.341) data 0.252 (0.263) loss_u loss_u 0.7285 (0.8462) acc_u 40.6250 (21.8750) lr 2.0000e-03 eta 0:00:10
epoch [2/200] batch [10/36] time 0.344 (0.341) data 0.266 (0.263) loss_u loss_u 0.7915 (0.8202) acc_u 28.1250 (24.3750) lr 2.0000e-03 eta 0:00:08
epoch [2/200] batch [15/36] time 0.339 (0.342) data 0.261 (0.264) loss_u loss_u 0.9092 (0.8229) acc_u 12.5000 (23.9583) lr 2.0000e-03 eta 0:00:07
epoch [2/200] batch [20/36] time 0.323 (0.340) data 0.245 (0.262) loss_u loss_u 0.7295 (0.8109) acc_u 34.3750 (25.1562) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [25/36] time 0.329 (0.340) data 0.250 (0.262) loss_u loss_u 0.8467 (0.8132) acc_u 18.7500 (24.8750) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [30/36] time 0.329 (0.339) data 0.251 (0.261) loss_u loss_u 0.6597 (0.8016) acc_u 43.7500 (26.1458) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [35/36] time 0.293 (0.335) data 0.214 (0.257) loss_u loss_u 0.7905 (0.8050) acc_u 28.1250 (25.8036) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 709
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 708
clean true:704
clean false:4
clean_rate:0.9943502824858758
noisy true:219
noisy false:705
after delete: len(clean_dataset) 708
after delete: len(noisy_dataset) 924
epoch [3/200] batch [5/22] time 0.360 (0.361) data 0.283 (0.284) loss_x loss_x 0.9829 (0.8646) acc_x 81.2500 (80.0000) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [10/22] time 0.354 (0.358) data 0.277 (0.281) loss_x loss_x 0.6523 (0.8382) acc_x 87.5000 (79.6875) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [15/22] time 0.341 (0.353) data 0.264 (0.276) loss_x loss_x 0.6948 (0.8674) acc_x 78.1250 (78.5417) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/22] time 0.345 (0.352) data 0.267 (0.275) loss_x loss_x 0.7217 (0.8640) acc_x 78.1250 (78.9062) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/28] time 0.344 (0.352) data 0.267 (0.274) loss_u loss_u 0.9565 (0.8811) acc_u 3.1250 (16.8750) lr 1.9999e-03 eta 0:00:08
epoch [3/200] batch [10/28] time 0.356 (0.350) data 0.278 (0.272) loss_u loss_u 0.8955 (0.8692) acc_u 12.5000 (18.7500) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [15/28] time 0.291 (0.345) data 0.213 (0.267) loss_u loss_u 0.8384 (0.8727) acc_u 12.5000 (16.6667) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [20/28] time 0.352 (0.343) data 0.275 (0.265) loss_u loss_u 0.9023 (0.8754) acc_u 15.6250 (16.5625) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [25/28] time 0.331 (0.344) data 0.253 (0.266) loss_u loss_u 0.9316 (0.8780) acc_u 9.3750 (16.1250) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 711
confident_label rate tensor(0.4277, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 698
clean true:697
clean false:1
clean_rate:0.998567335243553
noisy true:224
noisy false:710
after delete: len(clean_dataset) 698
after delete: len(noisy_dataset) 934
epoch [4/200] batch [5/21] time 0.342 (0.344) data 0.264 (0.266) loss_x loss_x 0.9531 (0.8581) acc_x 68.7500 (80.0000) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [10/21] time 0.344 (0.345) data 0.266 (0.268) loss_x loss_x 0.9126 (0.7762) acc_x 78.1250 (80.3125) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/21] time 0.328 (0.341) data 0.250 (0.263) loss_x loss_x 0.5581 (0.7315) acc_x 87.5000 (81.2500) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/21] time 0.346 (0.340) data 0.269 (0.262) loss_x loss_x 0.6621 (0.7250) acc_x 81.2500 (81.7188) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/29] time 0.356 (0.340) data 0.278 (0.263) loss_u loss_u 0.8691 (0.8803) acc_u 15.6250 (15.0000) lr 1.9995e-03 eta 0:00:08
epoch [4/200] batch [10/29] time 0.335 (0.340) data 0.257 (0.262) loss_u loss_u 0.9077 (0.8895) acc_u 9.3750 (13.7500) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [15/29] time 0.349 (0.341) data 0.271 (0.263) loss_u loss_u 0.8105 (0.8760) acc_u 25.0000 (16.2500) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [20/29] time 0.335 (0.340) data 0.257 (0.262) loss_u loss_u 0.8818 (0.8764) acc_u 9.3750 (15.9375) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [25/29] time 0.351 (0.341) data 0.273 (0.264) loss_u loss_u 0.8784 (0.8730) acc_u 12.5000 (16.3750) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 678
confident_label rate tensor(0.4479, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 731
clean true:727
clean false:4
clean_rate:0.9945280437756497
noisy true:227
noisy false:674
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 901
epoch [5/200] batch [5/22] time 0.338 (0.347) data 0.260 (0.269) loss_x loss_x 0.6416 (0.6925) acc_x 78.1250 (80.6250) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [10/22] time 0.345 (0.345) data 0.268 (0.267) loss_x loss_x 0.7749 (0.7221) acc_x 75.0000 (80.9375) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [15/22] time 0.344 (0.345) data 0.266 (0.267) loss_x loss_x 0.8037 (0.7564) acc_x 75.0000 (79.5833) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/22] time 0.351 (0.346) data 0.273 (0.268) loss_x loss_x 0.6904 (0.7961) acc_x 81.2500 (78.1250) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/28] time 0.347 (0.348) data 0.268 (0.270) loss_u loss_u 0.8384 (0.8566) acc_u 18.7500 (18.7500) lr 1.9989e-03 eta 0:00:08
epoch [5/200] batch [10/28] time 0.340 (0.348) data 0.263 (0.270) loss_u loss_u 0.8472 (0.8549) acc_u 15.6250 (18.4375) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [15/28] time 0.343 (0.348) data 0.265 (0.270) loss_u loss_u 0.8652 (0.8583) acc_u 18.7500 (18.3333) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [20/28] time 0.321 (0.347) data 0.242 (0.269) loss_u loss_u 0.8374 (0.8604) acc_u 25.0000 (17.9688) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [25/28] time 0.299 (0.344) data 0.220 (0.266) loss_u loss_u 0.8208 (0.8582) acc_u 21.8750 (18.3750) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 634
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 762
clean true:759
clean false:3
clean_rate:0.9960629921259843
noisy true:239
noisy false:631
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 870
epoch [6/200] batch [5/23] time 0.350 (0.352) data 0.272 (0.275) loss_x loss_x 0.7207 (0.8426) acc_x 75.0000 (77.5000) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [10/23] time 0.336 (0.347) data 0.259 (0.269) loss_x loss_x 0.7856 (0.7584) acc_x 84.3750 (82.1875) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [15/23] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.5376 (0.7641) acc_x 87.5000 (81.4583) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/23] time 0.349 (0.342) data 0.271 (0.264) loss_x loss_x 0.4421 (0.7432) acc_x 90.6250 (82.5000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [5/27] time 0.372 (0.343) data 0.294 (0.266) loss_u loss_u 0.8828 (0.8428) acc_u 15.6250 (21.8750) lr 1.9980e-03 eta 0:00:07
epoch [6/200] batch [10/27] time 0.333 (0.343) data 0.254 (0.265) loss_u loss_u 0.9053 (0.8681) acc_u 12.5000 (17.8125) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [15/27] time 0.336 (0.342) data 0.257 (0.265) loss_u loss_u 0.8486 (0.8713) acc_u 15.6250 (17.2917) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [20/27] time 0.293 (0.338) data 0.214 (0.260) loss_u loss_u 0.8232 (0.8671) acc_u 25.0000 (17.5000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [25/27] time 0.342 (0.336) data 0.265 (0.258) loss_u loss_u 0.8799 (0.8700) acc_u 12.5000 (16.6250) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 599
confident_label rate tensor(0.4810, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 785
clean true:783
clean false:2
clean_rate:0.9974522292993631
noisy true:250
noisy false:597
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 847
epoch [7/200] batch [5/24] time 0.347 (0.347) data 0.269 (0.269) loss_x loss_x 0.5557 (0.5991) acc_x 90.6250 (85.6250) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [10/24] time 0.349 (0.344) data 0.271 (0.266) loss_x loss_x 0.5474 (0.6598) acc_x 84.3750 (82.8125) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [15/24] time 0.327 (0.339) data 0.250 (0.262) loss_x loss_x 0.5732 (0.6713) acc_x 81.2500 (81.8750) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/24] time 0.367 (0.342) data 0.289 (0.264) loss_x loss_x 0.3926 (0.6794) acc_x 87.5000 (82.0312) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [5/26] time 0.360 (0.342) data 0.283 (0.265) loss_u loss_u 0.8525 (0.8500) acc_u 18.7500 (21.2500) lr 1.9969e-03 eta 0:00:07
epoch [7/200] batch [10/26] time 0.345 (0.344) data 0.267 (0.266) loss_u loss_u 0.8726 (0.8523) acc_u 21.8750 (20.6250) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [15/26] time 0.356 (0.344) data 0.278 (0.266) loss_u loss_u 0.9209 (0.8523) acc_u 9.3750 (20.2083) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/26] time 0.302 (0.343) data 0.223 (0.266) loss_u loss_u 0.8564 (0.8515) acc_u 18.7500 (19.6875) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [25/26] time 0.294 (0.339) data 0.215 (0.261) loss_u loss_u 0.8232 (0.8506) acc_u 21.8750 (19.6250) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 574
confident_label rate tensor(0.4914, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 802
clean true:797
clean false:5
clean_rate:0.9937655860349127
noisy true:261
noisy false:569
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 830
epoch [8/200] batch [5/25] time 0.351 (0.329) data 0.273 (0.251) loss_x loss_x 0.6089 (0.5536) acc_x 81.2500 (86.2500) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [10/25] time 0.344 (0.342) data 0.267 (0.264) loss_x loss_x 0.5967 (0.5762) acc_x 78.1250 (86.8750) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [15/25] time 0.341 (0.342) data 0.264 (0.264) loss_x loss_x 0.5454 (0.6095) acc_x 87.5000 (85.6250) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [20/25] time 0.335 (0.341) data 0.257 (0.263) loss_x loss_x 0.3650 (0.6171) acc_x 93.7500 (85.3125) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [25/25] time 0.343 (0.341) data 0.266 (0.264) loss_x loss_x 0.7119 (0.6257) acc_x 81.2500 (84.7500) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/25] time 0.354 (0.343) data 0.277 (0.265) loss_u loss_u 0.8320 (0.8496) acc_u 21.8750 (20.0000) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [10/25] time 0.341 (0.344) data 0.263 (0.266) loss_u loss_u 0.7822 (0.8451) acc_u 31.2500 (21.2500) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [15/25] time 0.337 (0.344) data 0.259 (0.266) loss_u loss_u 0.8740 (0.8464) acc_u 12.5000 (20.0000) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [20/25] time 0.329 (0.343) data 0.251 (0.266) loss_u loss_u 0.7822 (0.8496) acc_u 25.0000 (19.5312) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [25/25] time 0.355 (0.343) data 0.278 (0.266) loss_u loss_u 0.9072 (0.8553) acc_u 9.3750 (18.3750) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 557
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 816
clean true:812
clean false:4
clean_rate:0.9950980392156863
noisy true:263
noisy false:553
after delete: len(clean_dataset) 816
after delete: len(noisy_dataset) 816
epoch [9/200] batch [5/25] time 0.314 (0.315) data 0.237 (0.237) loss_x loss_x 0.7217 (0.6784) acc_x 81.2500 (81.8750) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [10/25] time 0.342 (0.329) data 0.265 (0.251) loss_x loss_x 0.5962 (0.6899) acc_x 81.2500 (83.4375) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [15/25] time 0.333 (0.329) data 0.255 (0.251) loss_x loss_x 0.8472 (0.6672) acc_x 78.1250 (83.7500) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [20/25] time 0.343 (0.332) data 0.265 (0.254) loss_x loss_x 0.6860 (0.6638) acc_x 90.6250 (83.4375) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [25/25] time 0.335 (0.334) data 0.257 (0.256) loss_x loss_x 0.2949 (0.6393) acc_x 93.7500 (84.1250) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/25] time 0.351 (0.335) data 0.273 (0.257) loss_u loss_u 0.9478 (0.8409) acc_u 6.2500 (19.3750) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [10/25] time 0.344 (0.336) data 0.266 (0.258) loss_u loss_u 0.8716 (0.8532) acc_u 15.6250 (18.4375) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [15/25] time 0.345 (0.337) data 0.267 (0.259) loss_u loss_u 0.8438 (0.8514) acc_u 25.0000 (18.7500) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [20/25] time 0.348 (0.337) data 0.270 (0.260) loss_u loss_u 0.8477 (0.8548) acc_u 18.7500 (18.4375) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [25/25] time 0.330 (0.338) data 0.252 (0.260) loss_u loss_u 0.8525 (0.8639) acc_u 18.7500 (16.8750) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 566
confident_label rate tensor(0.5012, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 818
clean true:814
clean false:4
clean_rate:0.9951100244498777
noisy true:252
noisy false:562
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 814
epoch [10/200] batch [5/25] time 0.330 (0.340) data 0.252 (0.262) loss_x loss_x 0.4438 (0.5861) acc_x 90.6250 (85.6250) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [10/25] time 0.332 (0.325) data 0.255 (0.247) loss_x loss_x 0.8071 (0.7051) acc_x 78.1250 (83.4375) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [15/25] time 0.346 (0.327) data 0.269 (0.250) loss_x loss_x 0.4685 (0.6914) acc_x 87.5000 (82.9167) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [20/25] time 0.348 (0.330) data 0.271 (0.253) loss_x loss_x 0.7246 (0.6927) acc_x 93.7500 (82.9688) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [25/25] time 0.345 (0.333) data 0.267 (0.256) loss_x loss_x 0.6294 (0.6821) acc_x 84.3750 (83.3750) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/25] time 0.350 (0.335) data 0.272 (0.257) loss_u loss_u 0.7729 (0.8235) acc_u 28.1250 (24.3750) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [10/25] time 0.338 (0.336) data 0.261 (0.259) loss_u loss_u 0.8965 (0.8354) acc_u 18.7500 (22.1875) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [15/25] time 0.339 (0.337) data 0.261 (0.259) loss_u loss_u 0.8320 (0.8486) acc_u 25.0000 (20.2083) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [20/25] time 0.349 (0.338) data 0.272 (0.260) loss_u loss_u 0.9272 (0.8503) acc_u 9.3750 (20.1562) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [25/25] time 0.356 (0.339) data 0.278 (0.261) loss_u loss_u 0.8223 (0.8529) acc_u 18.7500 (19.2500) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 511
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 875
clean true:868
clean false:7
clean_rate:0.992
noisy true:253
noisy false:504
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 757
epoch [11/200] batch [5/27] time 0.346 (0.335) data 0.269 (0.257) loss_x loss_x 0.6260 (0.5854) acc_x 81.2500 (84.3750) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [10/27] time 0.362 (0.343) data 0.285 (0.266) loss_x loss_x 0.5752 (0.6264) acc_x 87.5000 (83.4375) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [15/27] time 0.318 (0.331) data 0.241 (0.254) loss_x loss_x 0.5547 (0.6566) acc_x 90.6250 (83.7500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [20/27] time 0.323 (0.330) data 0.246 (0.253) loss_x loss_x 0.9185 (0.6791) acc_x 75.0000 (83.5938) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [25/27] time 0.360 (0.334) data 0.283 (0.257) loss_x loss_x 0.5532 (0.6678) acc_x 81.2500 (83.3750) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/23] time 0.344 (0.337) data 0.267 (0.259) loss_u loss_u 0.8721 (0.8651) acc_u 18.7500 (16.8750) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [10/23] time 0.347 (0.337) data 0.270 (0.260) loss_u loss_u 0.8452 (0.8662) acc_u 15.6250 (16.8750) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [15/23] time 0.328 (0.338) data 0.249 (0.260) loss_u loss_u 0.9146 (0.8674) acc_u 12.5000 (17.0833) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/23] time 0.343 (0.338) data 0.264 (0.261) loss_u loss_u 0.7988 (0.8710) acc_u 28.1250 (16.8750) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 484
confident_label rate tensor(0.5355, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 874
clean true:872
clean false:2
clean_rate:0.9977116704805492
noisy true:276
noisy false:482
after delete: len(clean_dataset) 874
after delete: len(noisy_dataset) 758
epoch [12/200] batch [5/27] time 0.346 (0.345) data 0.268 (0.268) loss_x loss_x 0.4094 (0.7069) acc_x 90.6250 (82.5000) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [10/27] time 0.317 (0.343) data 0.239 (0.265) loss_x loss_x 0.5190 (0.5296) acc_x 90.6250 (87.8125) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [15/27] time 0.339 (0.340) data 0.262 (0.262) loss_x loss_x 0.6777 (0.5380) acc_x 87.5000 (88.1250) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [20/27] time 0.339 (0.340) data 0.262 (0.263) loss_x loss_x 0.5737 (0.5423) acc_x 90.6250 (88.4375) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [25/27] time 0.351 (0.341) data 0.273 (0.263) loss_x loss_x 0.6177 (0.5550) acc_x 90.6250 (88.0000) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/23] time 0.349 (0.341) data 0.272 (0.263) loss_u loss_u 0.8730 (0.8733) acc_u 15.6250 (14.3750) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [10/23] time 0.339 (0.341) data 0.260 (0.264) loss_u loss_u 0.9248 (0.8714) acc_u 12.5000 (15.9375) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [15/23] time 0.351 (0.341) data 0.274 (0.263) loss_u loss_u 0.8848 (0.8593) acc_u 18.7500 (17.7083) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/23] time 0.339 (0.341) data 0.261 (0.263) loss_u loss_u 0.8560 (0.8668) acc_u 18.7500 (16.5625) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 485
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:887
clean false:4
clean_rate:0.9955106621773289
noisy true:260
noisy false:481
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [13/200] batch [5/27] time 0.333 (0.342) data 0.255 (0.264) loss_x loss_x 0.6465 (0.6180) acc_x 81.2500 (85.0000) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [10/27] time 0.322 (0.335) data 0.244 (0.257) loss_x loss_x 0.7891 (0.6380) acc_x 87.5000 (85.3125) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [15/27] time 0.332 (0.335) data 0.255 (0.257) loss_x loss_x 0.9019 (0.5888) acc_x 71.8750 (86.6667) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/27] time 0.351 (0.335) data 0.274 (0.257) loss_x loss_x 0.7803 (0.6214) acc_x 81.2500 (85.7812) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [25/27] time 0.369 (0.338) data 0.291 (0.261) loss_x loss_x 0.4897 (0.5952) acc_x 90.6250 (86.1250) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/23] time 0.352 (0.341) data 0.274 (0.263) loss_u loss_u 0.8525 (0.8639) acc_u 15.6250 (16.8750) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [10/23] time 0.345 (0.341) data 0.267 (0.264) loss_u loss_u 0.8262 (0.8708) acc_u 18.7500 (15.9375) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [15/23] time 0.334 (0.341) data 0.256 (0.264) loss_u loss_u 0.8140 (0.8663) acc_u 25.0000 (16.6667) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/23] time 0.341 (0.342) data 0.263 (0.264) loss_u loss_u 0.8970 (0.8710) acc_u 9.3750 (15.9375) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 492
confident_label rate tensor(0.5343, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 872
clean true:870
clean false:2
clean_rate:0.9977064220183486
noisy true:270
noisy false:490
after delete: len(clean_dataset) 872
after delete: len(noisy_dataset) 760
epoch [14/200] batch [5/27] time 0.345 (0.339) data 0.267 (0.261) loss_x loss_x 0.5449 (0.4729) acc_x 84.3750 (87.5000) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [10/27] time 0.342 (0.343) data 0.264 (0.266) loss_x loss_x 0.5986 (0.4732) acc_x 84.3750 (87.5000) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [15/27] time 0.311 (0.341) data 0.234 (0.263) loss_x loss_x 0.6484 (0.4846) acc_x 87.5000 (87.9167) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [20/27] time 0.331 (0.338) data 0.254 (0.260) loss_x loss_x 0.4973 (0.4925) acc_x 90.6250 (87.6562) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [25/27] time 0.340 (0.338) data 0.263 (0.260) loss_x loss_x 0.6343 (0.5049) acc_x 81.2500 (86.7500) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/23] time 0.344 (0.338) data 0.267 (0.260) loss_u loss_u 0.8618 (0.8530) acc_u 18.7500 (17.5000) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [10/23] time 0.343 (0.339) data 0.266 (0.261) loss_u loss_u 0.8232 (0.8414) acc_u 21.8750 (19.3750) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [15/23] time 0.345 (0.339) data 0.268 (0.262) loss_u loss_u 0.8853 (0.8567) acc_u 12.5000 (17.5000) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/23] time 0.366 (0.340) data 0.287 (0.263) loss_u loss_u 0.8652 (0.8539) acc_u 18.7500 (18.1250) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 455
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:899
clean false:3
clean_rate:0.9966740576496674
noisy true:278
noisy false:452
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [15/200] batch [5/28] time 0.307 (0.314) data 0.228 (0.235) loss_x loss_x 0.5464 (0.5305) acc_x 90.6250 (86.8750) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [10/28] time 0.291 (0.316) data 0.214 (0.238) loss_x loss_x 0.5034 (0.5130) acc_x 81.2500 (86.5625) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/28] time 0.299 (0.313) data 0.220 (0.235) loss_x loss_x 0.4172 (0.4981) acc_x 90.6250 (87.0833) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [20/28] time 0.354 (0.321) data 0.276 (0.243) loss_x loss_x 0.6206 (0.5242) acc_x 78.1250 (86.4062) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/28] time 0.355 (0.329) data 0.278 (0.251) loss_x loss_x 0.5298 (0.5376) acc_x 84.3750 (86.1250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/22] time 0.355 (0.334) data 0.278 (0.256) loss_u loss_u 0.8735 (0.8818) acc_u 15.6250 (15.0000) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/22] time 0.359 (0.335) data 0.281 (0.257) loss_u loss_u 0.8740 (0.8828) acc_u 18.7500 (15.3125) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [15/22] time 0.353 (0.337) data 0.275 (0.259) loss_u loss_u 0.8257 (0.8674) acc_u 15.6250 (16.0417) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/22] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9702 (0.8679) acc_u 3.1250 (15.9375) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 450
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 906
clean true:902
clean false:4
clean_rate:0.9955849889624724
noisy true:280
noisy false:446
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 726
epoch [16/200] batch [5/28] time 0.348 (0.361) data 0.271 (0.284) loss_x loss_x 0.4524 (0.5049) acc_x 93.7500 (89.3750) lr 1.9759e-03 eta 0:00:08
epoch [16/200] batch [10/28] time 0.330 (0.343) data 0.252 (0.266) loss_x loss_x 0.5439 (0.5493) acc_x 87.5000 (87.5000) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [15/28] time 0.294 (0.334) data 0.216 (0.256) loss_x loss_x 0.7393 (0.5777) acc_x 81.2500 (86.0417) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [20/28] time 0.347 (0.330) data 0.269 (0.252) loss_x loss_x 0.2864 (0.5570) acc_x 93.7500 (86.4062) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/28] time 0.339 (0.332) data 0.262 (0.255) loss_x loss_x 0.5869 (0.5482) acc_x 87.5000 (86.6250) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/22] time 0.316 (0.332) data 0.238 (0.254) loss_u loss_u 0.8857 (0.8687) acc_u 12.5000 (15.6250) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/22] time 0.335 (0.332) data 0.257 (0.255) loss_u loss_u 0.8389 (0.8656) acc_u 18.7500 (16.2500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [15/22] time 0.371 (0.335) data 0.294 (0.257) loss_u loss_u 0.8672 (0.8685) acc_u 15.6250 (16.2500) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/22] time 0.349 (0.337) data 0.271 (0.259) loss_u loss_u 0.8926 (0.8626) acc_u 12.5000 (16.8750) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 446
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 914
clean true:907
clean false:7
clean_rate:0.9923413566739606
noisy true:279
noisy false:439
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 718
epoch [17/200] batch [5/28] time 0.318 (0.320) data 0.241 (0.243) loss_x loss_x 0.3999 (0.5131) acc_x 93.7500 (89.3750) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [10/28] time 0.344 (0.335) data 0.267 (0.258) loss_x loss_x 0.3428 (0.4617) acc_x 93.7500 (88.7500) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [15/28] time 0.323 (0.334) data 0.245 (0.257) loss_x loss_x 0.5513 (0.5570) acc_x 84.3750 (86.8750) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [20/28] time 0.304 (0.332) data 0.227 (0.255) loss_x loss_x 0.5166 (0.5513) acc_x 87.5000 (87.0312) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/28] time 0.302 (0.327) data 0.224 (0.249) loss_x loss_x 0.6436 (0.5564) acc_x 78.1250 (87.2500) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/22] time 0.339 (0.326) data 0.261 (0.248) loss_u loss_u 0.9146 (0.8750) acc_u 12.5000 (15.0000) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/22] time 0.325 (0.328) data 0.247 (0.250) loss_u loss_u 0.8843 (0.8626) acc_u 18.7500 (17.1875) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/22] time 0.335 (0.330) data 0.258 (0.252) loss_u loss_u 0.9043 (0.8642) acc_u 15.6250 (17.0833) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/22] time 0.333 (0.332) data 0.255 (0.254) loss_u loss_u 0.8760 (0.8644) acc_u 18.7500 (17.1875) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 421
confident_label rate tensor(0.5686, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 928
clean true:923
clean false:5
clean_rate:0.9946120689655172
noisy true:288
noisy false:416
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 704
epoch [18/200] batch [5/29] time 0.342 (0.345) data 0.265 (0.268) loss_x loss_x 0.3550 (0.5261) acc_x 93.7500 (88.7500) lr 1.9686e-03 eta 0:00:08
epoch [18/200] batch [10/29] time 0.342 (0.343) data 0.265 (0.266) loss_x loss_x 0.6333 (0.5327) acc_x 81.2500 (87.5000) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [15/29] time 0.321 (0.344) data 0.244 (0.266) loss_x loss_x 0.8320 (0.6278) acc_x 81.2500 (85.6250) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [20/29] time 0.340 (0.344) data 0.263 (0.266) loss_x loss_x 0.6025 (0.6290) acc_x 84.3750 (85.4688) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [25/29] time 0.332 (0.343) data 0.254 (0.265) loss_x loss_x 0.4497 (0.6045) acc_x 90.6250 (85.8750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [5/22] time 0.297 (0.334) data 0.218 (0.256) loss_u loss_u 0.8672 (0.8882) acc_u 15.6250 (14.3750) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [10/22] time 0.349 (0.335) data 0.269 (0.257) loss_u loss_u 0.8779 (0.8804) acc_u 15.6250 (15.3125) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [15/22] time 0.354 (0.336) data 0.276 (0.258) loss_u loss_u 0.9067 (0.8790) acc_u 9.3750 (14.7917) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/22] time 0.342 (0.337) data 0.262 (0.259) loss_u loss_u 0.8398 (0.8729) acc_u 25.0000 (15.9375) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 421
confident_label rate tensor(0.5631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 919
clean true:912
clean false:7
clean_rate:0.9923830250272034
noisy true:299
noisy false:414
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 713
epoch [19/200] batch [5/28] time 0.303 (0.340) data 0.225 (0.262) loss_x loss_x 0.3308 (0.5067) acc_x 93.7500 (86.8750) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [10/28] time 0.344 (0.334) data 0.267 (0.257) loss_x loss_x 0.5220 (0.4919) acc_x 87.5000 (88.1250) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [15/28] time 0.384 (0.342) data 0.307 (0.264) loss_x loss_x 0.8960 (0.5354) acc_x 78.1250 (86.8750) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [20/28] time 0.338 (0.344) data 0.260 (0.267) loss_x loss_x 0.3667 (0.5220) acc_x 90.6250 (87.0312) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [25/28] time 0.343 (0.344) data 0.266 (0.267) loss_x loss_x 0.7314 (0.5376) acc_x 84.3750 (86.8750) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [5/22] time 0.327 (0.345) data 0.249 (0.267) loss_u loss_u 0.7969 (0.8624) acc_u 21.8750 (15.6250) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/22] time 0.310 (0.341) data 0.231 (0.263) loss_u loss_u 0.7202 (0.8435) acc_u 34.3750 (18.1250) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [15/22] time 0.343 (0.340) data 0.266 (0.262) loss_u loss_u 0.8994 (0.8461) acc_u 12.5000 (18.7500) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/22] time 0.349 (0.340) data 0.272 (0.263) loss_u loss_u 0.8862 (0.8526) acc_u 15.6250 (17.9688) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 380
confident_label rate tensor(0.5907, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 964
clean true:958
clean false:6
clean_rate:0.9937759336099585
noisy true:294
noisy false:374
after delete: len(clean_dataset) 964
after delete: len(noisy_dataset) 668
epoch [20/200] batch [5/30] time 0.350 (0.346) data 0.273 (0.269) loss_x loss_x 0.5288 (0.5510) acc_x 84.3750 (86.8750) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [10/30] time 0.336 (0.346) data 0.259 (0.268) loss_x loss_x 0.4988 (0.5443) acc_x 90.6250 (86.5625) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [15/30] time 0.336 (0.345) data 0.259 (0.267) loss_x loss_x 0.6006 (0.5875) acc_x 84.3750 (86.0417) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [20/30] time 0.341 (0.346) data 0.262 (0.268) loss_x loss_x 0.2798 (0.5350) acc_x 96.8750 (87.6562) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [25/30] time 0.345 (0.345) data 0.267 (0.268) loss_x loss_x 0.6665 (0.5249) acc_x 78.1250 (87.6250) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [30/30] time 0.347 (0.344) data 0.268 (0.267) loss_x loss_x 0.4644 (0.5163) acc_x 87.5000 (87.9167) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/20] time 0.341 (0.344) data 0.263 (0.266) loss_u loss_u 0.8530 (0.8632) acc_u 15.6250 (16.8750) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [10/20] time 0.308 (0.343) data 0.229 (0.265) loss_u loss_u 0.8662 (0.8621) acc_u 15.6250 (17.8125) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/20] time 0.339 (0.343) data 0.261 (0.266) loss_u loss_u 0.9019 (0.8773) acc_u 9.3750 (15.6250) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/20] time 0.388 (0.343) data 0.310 (0.266) loss_u loss_u 0.9487 (0.8717) acc_u 6.2500 (16.2500) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 419
confident_label rate tensor(0.5674, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 926
clean true:918
clean false:8
clean_rate:0.9913606911447084
noisy true:295
noisy false:411
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 706
epoch [21/200] batch [5/28] time 0.339 (0.346) data 0.262 (0.268) loss_x loss_x 0.2766 (0.4362) acc_x 93.7500 (88.7500) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [10/28] time 0.314 (0.340) data 0.237 (0.263) loss_x loss_x 0.5327 (0.5104) acc_x 87.5000 (86.8750) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [15/28] time 0.343 (0.341) data 0.265 (0.264) loss_x loss_x 0.4907 (0.5015) acc_x 84.3750 (87.5000) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [20/28] time 0.322 (0.341) data 0.244 (0.264) loss_x loss_x 0.6123 (0.5064) acc_x 84.3750 (87.0312) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [25/28] time 0.341 (0.342) data 0.264 (0.265) loss_x loss_x 0.4539 (0.5051) acc_x 87.5000 (87.0000) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [5/22] time 0.344 (0.343) data 0.267 (0.265) loss_u loss_u 0.8452 (0.8344) acc_u 18.7500 (20.6250) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [10/22] time 0.324 (0.343) data 0.245 (0.265) loss_u loss_u 0.8076 (0.8450) acc_u 18.7500 (18.1250) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [15/22] time 0.353 (0.342) data 0.275 (0.265) loss_u loss_u 0.8604 (0.8498) acc_u 18.7500 (17.9167) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/22] time 0.344 (0.343) data 0.267 (0.265) loss_u loss_u 0.8198 (0.8564) acc_u 21.8750 (17.1875) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 413
confident_label rate tensor(0.5650, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 922
clean true:916
clean false:6
clean_rate:0.9934924078091106
noisy true:303
noisy false:407
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 710
epoch [22/200] batch [5/28] time 0.323 (0.336) data 0.246 (0.259) loss_x loss_x 0.3123 (0.3461) acc_x 90.6250 (91.8750) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [10/28] time 0.330 (0.335) data 0.252 (0.258) loss_x loss_x 0.4290 (0.3858) acc_x 90.6250 (90.3125) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [15/28] time 0.337 (0.333) data 0.259 (0.256) loss_x loss_x 0.5596 (0.3982) acc_x 84.3750 (89.5833) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [20/28] time 0.344 (0.335) data 0.267 (0.258) loss_x loss_x 0.4226 (0.4178) acc_x 87.5000 (88.4375) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/28] time 0.335 (0.336) data 0.257 (0.259) loss_x loss_x 0.9683 (0.4585) acc_x 75.0000 (87.8750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [5/22] time 0.329 (0.338) data 0.250 (0.261) loss_u loss_u 0.8218 (0.8273) acc_u 21.8750 (22.5000) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [10/22] time 0.346 (0.337) data 0.266 (0.259) loss_u loss_u 0.8779 (0.8457) acc_u 15.6250 (20.6250) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [15/22] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.7871 (0.8421) acc_u 34.3750 (20.8333) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/22] time 0.324 (0.335) data 0.246 (0.258) loss_u loss_u 0.8135 (0.8496) acc_u 21.8750 (19.2188) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 379
confident_label rate tensor(0.5821, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 950
clean true:947
clean false:3
clean_rate:0.9968421052631579
noisy true:306
noisy false:376
after delete: len(clean_dataset) 950
after delete: len(noisy_dataset) 682
epoch [23/200] batch [5/29] time 0.351 (0.339) data 0.274 (0.262) loss_x loss_x 0.2817 (0.3878) acc_x 96.8750 (92.5000) lr 1.9461e-03 eta 0:00:08
epoch [23/200] batch [10/29] time 0.350 (0.340) data 0.272 (0.263) loss_x loss_x 0.6670 (0.4627) acc_x 81.2500 (90.0000) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [15/29] time 0.360 (0.341) data 0.283 (0.264) loss_x loss_x 0.3408 (0.4708) acc_x 93.7500 (89.7917) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [20/29] time 0.343 (0.342) data 0.266 (0.265) loss_x loss_x 0.6045 (0.4671) acc_x 75.0000 (88.9062) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [25/29] time 0.359 (0.344) data 0.281 (0.267) loss_x loss_x 0.6074 (0.4809) acc_x 87.5000 (88.5000) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [5/21] time 0.334 (0.344) data 0.255 (0.266) loss_u loss_u 0.9067 (0.8852) acc_u 9.3750 (13.7500) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [10/21] time 0.352 (0.343) data 0.274 (0.266) loss_u loss_u 0.8574 (0.8800) acc_u 18.7500 (15.3125) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/21] time 0.351 (0.344) data 0.274 (0.267) loss_u loss_u 0.8701 (0.8806) acc_u 15.6250 (15.0000) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/21] time 0.337 (0.344) data 0.259 (0.267) loss_u loss_u 0.8843 (0.8706) acc_u 12.5000 (16.4062) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 378
confident_label rate tensor(0.5882, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 960
clean true:954
clean false:6
clean_rate:0.99375
noisy true:300
noisy false:372
after delete: len(clean_dataset) 960
after delete: len(noisy_dataset) 672
epoch [24/200] batch [5/30] time 0.348 (0.342) data 0.269 (0.264) loss_x loss_x 0.6851 (0.5163) acc_x 81.2500 (87.5000) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [10/30] time 0.343 (0.348) data 0.266 (0.270) loss_x loss_x 0.4883 (0.5468) acc_x 87.5000 (87.1875) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [15/30] time 0.353 (0.347) data 0.276 (0.269) loss_x loss_x 0.5796 (0.5281) acc_x 84.3750 (87.5000) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [20/30] time 0.340 (0.347) data 0.263 (0.269) loss_x loss_x 0.3801 (0.5299) acc_x 93.7500 (87.8125) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [25/30] time 0.330 (0.346) data 0.253 (0.268) loss_x loss_x 0.7109 (0.5357) acc_x 87.5000 (87.7500) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [30/30] time 0.332 (0.345) data 0.255 (0.268) loss_x loss_x 0.6133 (0.5293) acc_x 84.3750 (88.0208) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/21] time 0.342 (0.346) data 0.265 (0.268) loss_u loss_u 0.9492 (0.8835) acc_u 6.2500 (13.7500) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/21] time 0.310 (0.345) data 0.232 (0.267) loss_u loss_u 0.8301 (0.8792) acc_u 21.8750 (15.0000) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/21] time 0.325 (0.342) data 0.246 (0.264) loss_u loss_u 0.7812 (0.8719) acc_u 28.1250 (15.6250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/21] time 0.341 (0.342) data 0.264 (0.264) loss_u loss_u 0.8062 (0.8632) acc_u 21.8750 (16.2500) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 381
confident_label rate tensor(0.5888, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 961
clean true:957
clean false:4
clean_rate:0.9958376690946931
noisy true:294
noisy false:377
after delete: len(clean_dataset) 961
after delete: len(noisy_dataset) 671
epoch [25/200] batch [5/30] time 0.348 (0.344) data 0.270 (0.266) loss_x loss_x 0.4790 (0.5369) acc_x 90.6250 (86.8750) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [10/30] time 0.349 (0.351) data 0.272 (0.273) loss_x loss_x 0.3274 (0.5049) acc_x 93.7500 (88.1250) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [15/30] time 0.344 (0.348) data 0.266 (0.270) loss_x loss_x 0.3801 (0.4729) acc_x 93.7500 (88.9583) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [20/30] time 0.345 (0.348) data 0.267 (0.270) loss_x loss_x 0.4565 (0.4751) acc_x 93.7500 (89.2188) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/30] time 0.340 (0.346) data 0.262 (0.269) loss_x loss_x 0.6289 (0.5081) acc_x 87.5000 (88.1250) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [30/30] time 0.312 (0.344) data 0.234 (0.266) loss_x loss_x 0.6431 (0.5306) acc_x 84.3750 (87.5000) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/20] time 0.343 (0.343) data 0.265 (0.265) loss_u loss_u 0.9316 (0.8866) acc_u 6.2500 (14.3750) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [10/20] time 0.334 (0.343) data 0.256 (0.265) loss_u loss_u 0.9087 (0.8770) acc_u 12.5000 (15.9375) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/20] time 0.339 (0.343) data 0.262 (0.265) loss_u loss_u 0.9189 (0.8681) acc_u 9.3750 (16.4583) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/20] time 0.336 (0.343) data 0.257 (0.265) loss_u loss_u 0.8350 (0.8694) acc_u 21.8750 (16.4062) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 374
confident_label rate tensor(0.5876, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 959
clean true:956
clean false:3
clean_rate:0.9968717413972888
noisy true:302
noisy false:371
after delete: len(clean_dataset) 959
after delete: len(noisy_dataset) 673
epoch [26/200] batch [5/29] time 0.348 (0.343) data 0.269 (0.265) loss_x loss_x 0.3318 (0.3692) acc_x 90.6250 (91.2500) lr 1.9298e-03 eta 0:00:08
epoch [26/200] batch [10/29] time 0.338 (0.342) data 0.261 (0.264) loss_x loss_x 0.5303 (0.4212) acc_x 90.6250 (90.3125) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [15/29] time 0.350 (0.342) data 0.273 (0.265) loss_x loss_x 0.8037 (0.4407) acc_x 78.1250 (89.3750) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [20/29] time 0.336 (0.342) data 0.258 (0.264) loss_x loss_x 0.6699 (0.4610) acc_x 87.5000 (89.2188) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [25/29] time 0.348 (0.341) data 0.270 (0.263) loss_x loss_x 0.5298 (0.4569) acc_x 81.2500 (89.1250) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [5/21] time 0.307 (0.341) data 0.229 (0.264) loss_u loss_u 0.8325 (0.8240) acc_u 21.8750 (21.2500) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [10/21] time 0.339 (0.337) data 0.260 (0.259) loss_u loss_u 0.8130 (0.8523) acc_u 18.7500 (17.1875) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/21] time 0.346 (0.338) data 0.268 (0.260) loss_u loss_u 0.9380 (0.8674) acc_u 6.2500 (16.0417) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/21] time 0.343 (0.338) data 0.265 (0.260) loss_u loss_u 0.9502 (0.8660) acc_u 6.2500 (16.4062) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 402
confident_label rate tensor(0.5754, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 939
clean true:936
clean false:3
clean_rate:0.9968051118210862
noisy true:294
noisy false:399
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 693
epoch [27/200] batch [5/29] time 0.342 (0.348) data 0.265 (0.270) loss_x loss_x 0.4910 (0.4114) acc_x 90.6250 (90.0000) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [10/29] time 0.342 (0.347) data 0.265 (0.269) loss_x loss_x 0.4446 (0.5280) acc_x 90.6250 (87.5000) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [15/29] time 0.333 (0.347) data 0.255 (0.270) loss_x loss_x 0.5479 (0.5178) acc_x 81.2500 (87.0833) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [20/29] time 0.345 (0.347) data 0.267 (0.269) loss_x loss_x 0.4548 (0.4828) acc_x 93.7500 (87.9688) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/29] time 0.341 (0.344) data 0.264 (0.267) loss_x loss_x 0.6748 (0.5026) acc_x 81.2500 (87.7500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [5/21] time 0.342 (0.345) data 0.264 (0.267) loss_u loss_u 0.7852 (0.8248) acc_u 25.0000 (20.0000) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/21] time 0.292 (0.343) data 0.213 (0.266) loss_u loss_u 0.7773 (0.8380) acc_u 25.0000 (19.0625) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [15/21] time 0.359 (0.341) data 0.280 (0.263) loss_u loss_u 0.8633 (0.8492) acc_u 18.7500 (18.5417) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/21] time 0.332 (0.340) data 0.253 (0.262) loss_u loss_u 0.7383 (0.8333) acc_u 31.2500 (20.6250) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 349
confident_label rate tensor(0.5968, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 974
clean true:971
clean false:3
clean_rate:0.9969199178644764
noisy true:312
noisy false:346
after delete: len(clean_dataset) 974
after delete: len(noisy_dataset) 658
epoch [28/200] batch [5/30] time 0.343 (0.353) data 0.266 (0.275) loss_x loss_x 0.5879 (0.4870) acc_x 87.5000 (91.2500) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [10/30] time 0.330 (0.339) data 0.253 (0.261) loss_x loss_x 0.6880 (0.5190) acc_x 78.1250 (89.6875) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [15/30] time 0.350 (0.339) data 0.272 (0.262) loss_x loss_x 0.4304 (0.5038) acc_x 84.3750 (88.9583) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [20/30] time 0.341 (0.342) data 0.264 (0.265) loss_x loss_x 0.5620 (0.4651) acc_x 90.6250 (89.8438) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [25/30] time 0.361 (0.346) data 0.284 (0.268) loss_x loss_x 0.3562 (0.4686) acc_x 96.8750 (89.6250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [30/30] time 0.335 (0.345) data 0.257 (0.268) loss_x loss_x 0.3730 (0.4745) acc_x 84.3750 (89.3750) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/20] time 0.350 (0.346) data 0.272 (0.269) loss_u loss_u 0.7671 (0.8524) acc_u 28.1250 (19.3750) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/20] time 0.340 (0.345) data 0.262 (0.268) loss_u loss_u 0.9043 (0.8603) acc_u 12.5000 (17.8125) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/20] time 0.305 (0.345) data 0.225 (0.267) loss_u loss_u 0.9150 (0.8556) acc_u 12.5000 (18.3333) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/20] time 0.343 (0.342) data 0.265 (0.264) loss_u loss_u 0.8516 (0.8586) acc_u 21.8750 (18.1250) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 360
confident_label rate tensor(0.5980, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 976
clean true:973
clean false:3
clean_rate:0.9969262295081968
noisy true:299
noisy false:357
after delete: len(clean_dataset) 976
after delete: len(noisy_dataset) 656
epoch [29/200] batch [5/30] time 0.344 (0.358) data 0.266 (0.280) loss_x loss_x 0.3142 (0.4002) acc_x 90.6250 (90.0000) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [10/30] time 0.347 (0.342) data 0.269 (0.265) loss_x loss_x 1.1738 (0.5006) acc_x 75.0000 (88.4375) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [15/30] time 0.330 (0.342) data 0.253 (0.264) loss_x loss_x 0.4836 (0.4923) acc_x 84.3750 (87.9167) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [20/30] time 0.337 (0.342) data 0.260 (0.265) loss_x loss_x 0.4373 (0.5253) acc_x 84.3750 (86.0938) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/30] time 0.343 (0.343) data 0.265 (0.266) loss_x loss_x 0.4021 (0.5037) acc_x 87.5000 (86.1250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [30/30] time 0.342 (0.343) data 0.265 (0.265) loss_x loss_x 0.4783 (0.5313) acc_x 87.5000 (85.6250) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/20] time 0.357 (0.344) data 0.278 (0.266) loss_u loss_u 0.8301 (0.8747) acc_u 15.6250 (13.1250) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [10/20] time 0.360 (0.346) data 0.282 (0.268) loss_u loss_u 0.8306 (0.8610) acc_u 25.0000 (16.2500) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/20] time 0.313 (0.345) data 0.234 (0.267) loss_u loss_u 0.8657 (0.8605) acc_u 12.5000 (16.8750) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/20] time 0.339 (0.344) data 0.260 (0.266) loss_u loss_u 0.8848 (0.8620) acc_u 12.5000 (17.1875) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 373
confident_label rate tensor(0.5907, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 964
clean true:956
clean false:8
clean_rate:0.991701244813278
noisy true:303
noisy false:365
after delete: len(clean_dataset) 964
after delete: len(noisy_dataset) 668
epoch [30/200] batch [5/30] time 0.351 (0.352) data 0.274 (0.274) loss_x loss_x 0.3103 (0.5056) acc_x 96.8750 (87.5000) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [10/30] time 0.338 (0.355) data 0.260 (0.277) loss_x loss_x 0.6182 (0.4399) acc_x 87.5000 (90.0000) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [15/30] time 0.354 (0.353) data 0.277 (0.275) loss_x loss_x 0.2603 (0.4154) acc_x 93.7500 (90.4167) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [20/30] time 0.359 (0.355) data 0.282 (0.277) loss_x loss_x 0.5078 (0.4274) acc_x 87.5000 (90.1562) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [25/30] time 0.351 (0.355) data 0.272 (0.277) loss_x loss_x 0.2328 (0.4304) acc_x 96.8750 (90.3750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [30/30] time 0.352 (0.353) data 0.274 (0.276) loss_x loss_x 0.2925 (0.4353) acc_x 96.8750 (90.3125) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/20] time 0.339 (0.353) data 0.261 (0.275) loss_u loss_u 0.8237 (0.8100) acc_u 18.7500 (21.8750) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/20] time 0.349 (0.351) data 0.270 (0.273) loss_u loss_u 0.7988 (0.8083) acc_u 25.0000 (23.1250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/20] time 0.337 (0.352) data 0.258 (0.274) loss_u loss_u 0.8799 (0.8266) acc_u 15.6250 (21.8750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/20] time 0.356 (0.352) data 0.278 (0.273) loss_u loss_u 0.7451 (0.8282) acc_u 28.1250 (21.4062) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 329
confident_label rate tensor(0.6152, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1004
clean true:997
clean false:7
clean_rate:0.9930278884462151
noisy true:306
noisy false:322
after delete: len(clean_dataset) 1004
after delete: len(noisy_dataset) 628
epoch [31/200] batch [5/31] time 0.360 (0.355) data 0.282 (0.277) loss_x loss_x 0.2847 (0.3870) acc_x 90.6250 (90.0000) lr 1.8980e-03 eta 0:00:09
epoch [31/200] batch [10/31] time 0.350 (0.353) data 0.272 (0.275) loss_x loss_x 0.4573 (0.4291) acc_x 93.7500 (90.0000) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [15/31] time 0.362 (0.352) data 0.284 (0.274) loss_x loss_x 0.2839 (0.4116) acc_x 93.7500 (90.4167) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [20/31] time 0.348 (0.352) data 0.271 (0.275) loss_x loss_x 0.2559 (0.3934) acc_x 93.7500 (90.9375) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [25/31] time 0.347 (0.352) data 0.270 (0.274) loss_x loss_x 0.5537 (0.4112) acc_x 84.3750 (90.6250) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [30/31] time 0.356 (0.352) data 0.279 (0.274) loss_x loss_x 0.3687 (0.4166) acc_x 90.6250 (90.6250) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/19] time 0.312 (0.348) data 0.233 (0.270) loss_u loss_u 0.9233 (0.8980) acc_u 9.3750 (11.8750) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/19] time 0.350 (0.345) data 0.272 (0.267) loss_u loss_u 0.8735 (0.8869) acc_u 18.7500 (14.0625) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/19] time 0.344 (0.345) data 0.266 (0.267) loss_u loss_u 0.8423 (0.8698) acc_u 25.0000 (16.6667) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 334
confident_label rate tensor(0.6109, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 997
clean true:988
clean false:9
clean_rate:0.9909729187562688
noisy true:310
noisy false:325
after delete: len(clean_dataset) 997
after delete: len(noisy_dataset) 635
epoch [32/200] batch [5/31] time 0.359 (0.360) data 0.281 (0.282) loss_x loss_x 0.3943 (0.4615) acc_x 93.7500 (91.8750) lr 1.8910e-03 eta 0:00:09
epoch [32/200] batch [10/31] time 0.342 (0.355) data 0.264 (0.277) loss_x loss_x 0.2175 (0.4390) acc_x 100.0000 (90.3125) lr 1.8910e-03 eta 0:00:07
epoch [32/200] batch [15/31] time 0.349 (0.356) data 0.271 (0.278) loss_x loss_x 0.2345 (0.4144) acc_x 96.8750 (90.8333) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [20/31] time 0.355 (0.352) data 0.278 (0.274) loss_x loss_x 0.3665 (0.4514) acc_x 93.7500 (89.8438) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [25/31] time 0.346 (0.351) data 0.268 (0.274) loss_x loss_x 0.5479 (0.4370) acc_x 90.6250 (90.2500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [30/31] time 0.344 (0.351) data 0.267 (0.273) loss_x loss_x 0.2421 (0.4419) acc_x 93.7500 (89.7917) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/19] time 0.347 (0.350) data 0.269 (0.272) loss_u loss_u 0.7754 (0.8513) acc_u 25.0000 (16.2500) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/19] time 0.325 (0.346) data 0.246 (0.268) loss_u loss_u 0.8325 (0.8563) acc_u 18.7500 (16.5625) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [15/19] time 0.348 (0.346) data 0.271 (0.268) loss_u loss_u 0.9214 (0.8575) acc_u 12.5000 (17.0833) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.5974, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 975
clean true:968
clean false:7
clean_rate:0.9928205128205129
noisy true:318
noisy false:339
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 657
epoch [33/200] batch [5/30] time 0.338 (0.346) data 0.260 (0.268) loss_x loss_x 0.5220 (0.4280) acc_x 81.2500 (87.5000) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [10/30] time 0.355 (0.351) data 0.278 (0.273) loss_x loss_x 0.5527 (0.4507) acc_x 87.5000 (87.8125) lr 1.8838e-03 eta 0:00:07
epoch [33/200] batch [15/30] time 0.346 (0.349) data 0.268 (0.272) loss_x loss_x 0.3884 (0.4123) acc_x 87.5000 (89.1667) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [20/30] time 0.343 (0.350) data 0.265 (0.272) loss_x loss_x 0.3435 (0.4057) acc_x 93.7500 (89.5312) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/30] time 0.344 (0.350) data 0.267 (0.272) loss_x loss_x 0.3076 (0.4327) acc_x 96.8750 (88.8750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [30/30] time 0.348 (0.350) data 0.270 (0.272) loss_x loss_x 0.3213 (0.4047) acc_x 87.5000 (89.5833) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/20] time 0.352 (0.350) data 0.272 (0.272) loss_u loss_u 0.9014 (0.8744) acc_u 15.6250 (15.0000) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/20] time 0.350 (0.350) data 0.272 (0.272) loss_u loss_u 0.7383 (0.8655) acc_u 31.2500 (16.2500) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/20] time 0.346 (0.350) data 0.267 (0.272) loss_u loss_u 0.8081 (0.8570) acc_u 25.0000 (17.2917) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/20] time 0.358 (0.350) data 0.279 (0.272) loss_u loss_u 0.9204 (0.8573) acc_u 6.2500 (17.3438) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.6078, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 992
clean true:984
clean false:8
clean_rate:0.9919354838709677
noisy true:302
noisy false:338
after delete: len(clean_dataset) 992
after delete: len(noisy_dataset) 640
epoch [34/200] batch [5/31] time 0.356 (0.356) data 0.278 (0.278) loss_x loss_x 0.4133 (0.3196) acc_x 90.6250 (95.0000) lr 1.8763e-03 eta 0:00:09
epoch [34/200] batch [10/31] time 0.358 (0.358) data 0.280 (0.280) loss_x loss_x 0.5322 (0.4100) acc_x 87.5000 (91.2500) lr 1.8763e-03 eta 0:00:07
epoch [34/200] batch [15/31] time 0.337 (0.353) data 0.259 (0.276) loss_x loss_x 0.7480 (0.4409) acc_x 84.3750 (90.2083) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [20/31] time 0.345 (0.352) data 0.267 (0.275) loss_x loss_x 0.4111 (0.4418) acc_x 90.6250 (90.1562) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [25/31] time 0.324 (0.350) data 0.246 (0.273) loss_x loss_x 0.6362 (0.4484) acc_x 87.5000 (90.1250) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [30/31] time 0.358 (0.350) data 0.281 (0.272) loss_x loss_x 0.3499 (0.4667) acc_x 96.8750 (89.7917) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/20] time 0.338 (0.349) data 0.260 (0.271) loss_u loss_u 0.8804 (0.8387) acc_u 12.5000 (18.7500) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [10/20] time 0.304 (0.347) data 0.225 (0.269) loss_u loss_u 0.8491 (0.8459) acc_u 18.7500 (18.1250) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [15/20] time 0.328 (0.343) data 0.250 (0.265) loss_u loss_u 0.8428 (0.8530) acc_u 15.6250 (17.2917) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/20] time 0.352 (0.344) data 0.272 (0.266) loss_u loss_u 0.9253 (0.8606) acc_u 6.2500 (16.8750) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 339
confident_label rate tensor(0.6078, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 992
clean true:984
clean false:8
clean_rate:0.9919354838709677
noisy true:309
noisy false:331
after delete: len(clean_dataset) 992
after delete: len(noisy_dataset) 640
epoch [35/200] batch [5/31] time 0.349 (0.353) data 0.271 (0.275) loss_x loss_x 0.5278 (0.4660) acc_x 87.5000 (87.5000) lr 1.8686e-03 eta 0:00:09
epoch [35/200] batch [10/31] time 0.351 (0.351) data 0.273 (0.273) loss_x loss_x 0.2522 (0.4934) acc_x 96.8750 (87.5000) lr 1.8686e-03 eta 0:00:07
epoch [35/200] batch [15/31] time 0.338 (0.351) data 0.259 (0.273) loss_x loss_x 0.6567 (0.5265) acc_x 84.3750 (86.2500) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [20/31] time 0.342 (0.348) data 0.264 (0.270) loss_x loss_x 0.5493 (0.5355) acc_x 96.8750 (86.7188) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [25/31] time 0.340 (0.346) data 0.261 (0.268) loss_x loss_x 0.3464 (0.4942) acc_x 87.5000 (88.0000) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [30/31] time 0.366 (0.347) data 0.289 (0.269) loss_x loss_x 0.3171 (0.5046) acc_x 96.8750 (88.0208) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/20] time 0.337 (0.348) data 0.259 (0.270) loss_u loss_u 0.8477 (0.8255) acc_u 15.6250 (19.3750) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [10/20] time 0.392 (0.348) data 0.313 (0.270) loss_u loss_u 0.8066 (0.8338) acc_u 25.0000 (19.0625) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/20] time 0.358 (0.348) data 0.279 (0.270) loss_u loss_u 0.8228 (0.8438) acc_u 25.0000 (19.1667) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/20] time 0.306 (0.345) data 0.228 (0.266) loss_u loss_u 0.9292 (0.8519) acc_u 9.3750 (17.8125) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 344
confident_label rate tensor(0.6054, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 988
clean true:983
clean false:5
clean_rate:0.9949392712550608
noisy true:305
noisy false:339
after delete: len(clean_dataset) 988
after delete: len(noisy_dataset) 644
epoch [36/200] batch [5/30] time 0.372 (0.365) data 0.294 (0.287) loss_x loss_x 0.4517 (0.3617) acc_x 90.6250 (90.6250) lr 1.8607e-03 eta 0:00:09
epoch [36/200] batch [10/30] time 0.361 (0.362) data 0.282 (0.284) loss_x loss_x 0.4075 (0.4197) acc_x 90.6250 (90.0000) lr 1.8607e-03 eta 0:00:07
epoch [36/200] batch [15/30] time 0.335 (0.357) data 0.258 (0.280) loss_x loss_x 0.1583 (0.3859) acc_x 96.8750 (90.8333) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [20/30] time 0.344 (0.353) data 0.266 (0.275) loss_x loss_x 0.2771 (0.3846) acc_x 93.7500 (91.2500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [25/30] time 0.344 (0.352) data 0.267 (0.274) loss_x loss_x 0.4619 (0.3772) acc_x 87.5000 (91.5000) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [30/30] time 0.342 (0.353) data 0.264 (0.275) loss_x loss_x 0.4060 (0.3938) acc_x 90.6250 (91.2500) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/20] time 0.351 (0.353) data 0.274 (0.275) loss_u loss_u 0.9404 (0.8636) acc_u 6.2500 (17.5000) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/20] time 0.345 (0.353) data 0.266 (0.275) loss_u loss_u 0.8535 (0.8532) acc_u 15.6250 (18.1250) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [15/20] time 0.292 (0.348) data 0.213 (0.270) loss_u loss_u 0.8442 (0.8389) acc_u 21.8750 (20.2083) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/20] time 0.311 (0.346) data 0.232 (0.268) loss_u loss_u 0.8979 (0.8390) acc_u 12.5000 (20.3125) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.6134, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1001
clean true:993
clean false:8
clean_rate:0.9920079920079921
noisy true:314
noisy false:317
after delete: len(clean_dataset) 1001
after delete: len(noisy_dataset) 631
epoch [37/200] batch [5/31] time 0.354 (0.365) data 0.276 (0.287) loss_x loss_x 0.3267 (0.4348) acc_x 93.7500 (89.3750) lr 1.8526e-03 eta 0:00:09
epoch [37/200] batch [10/31] time 0.356 (0.354) data 0.277 (0.275) loss_x loss_x 0.6416 (0.4231) acc_x 81.2500 (89.6875) lr 1.8526e-03 eta 0:00:07
epoch [37/200] batch [15/31] time 0.359 (0.354) data 0.282 (0.276) loss_x loss_x 0.2739 (0.4182) acc_x 90.6250 (89.1667) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [20/31] time 0.343 (0.356) data 0.265 (0.278) loss_x loss_x 0.4009 (0.3991) acc_x 87.5000 (90.1562) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [25/31] time 0.348 (0.355) data 0.271 (0.277) loss_x loss_x 0.9629 (0.4071) acc_x 71.8750 (90.2500) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [30/31] time 0.346 (0.353) data 0.268 (0.275) loss_x loss_x 0.5010 (0.4127) acc_x 87.5000 (90.1042) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/19] time 0.331 (0.350) data 0.253 (0.272) loss_u loss_u 0.8545 (0.8792) acc_u 15.6250 (13.1250) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/19] time 0.363 (0.349) data 0.284 (0.271) loss_u loss_u 0.8945 (0.8770) acc_u 12.5000 (14.6875) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/19] time 0.302 (0.345) data 0.224 (0.267) loss_u loss_u 0.7725 (0.8530) acc_u 25.0000 (17.0833) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.6158, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1005
clean true:997
clean false:8
clean_rate:0.9920398009950249
noisy true:310
noisy false:317
after delete: len(clean_dataset) 1005
after delete: len(noisy_dataset) 627
epoch [38/200] batch [5/31] time 0.364 (0.361) data 0.286 (0.283) loss_x loss_x 0.2272 (0.3506) acc_x 93.7500 (91.8750) lr 1.8443e-03 eta 0:00:09
epoch [38/200] batch [10/31] time 0.352 (0.356) data 0.275 (0.278) loss_x loss_x 0.6665 (0.3928) acc_x 81.2500 (90.0000) lr 1.8443e-03 eta 0:00:07
epoch [38/200] batch [15/31] time 0.379 (0.360) data 0.301 (0.282) loss_x loss_x 0.3259 (0.3710) acc_x 90.6250 (90.6250) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [20/31] time 0.346 (0.357) data 0.269 (0.279) loss_x loss_x 0.2256 (0.3603) acc_x 100.0000 (90.7812) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/31] time 0.379 (0.364) data 0.301 (0.287) loss_x loss_x 0.4080 (0.3752) acc_x 90.6250 (90.8750) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [30/31] time 0.368 (0.367) data 0.290 (0.290) loss_x loss_x 0.6147 (0.3908) acc_x 90.6250 (90.9375) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/19] time 0.402 (0.373) data 0.323 (0.296) loss_u loss_u 0.8179 (0.8502) acc_u 21.8750 (18.7500) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/19] time 0.352 (0.373) data 0.273 (0.296) loss_u loss_u 0.9438 (0.8569) acc_u 6.2500 (17.1875) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/19] time 0.336 (0.369) data 0.258 (0.291) loss_u loss_u 0.8545 (0.8529) acc_u 18.7500 (18.1250) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 309
confident_label rate tensor(0.6152, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1004
clean true:1002
clean false:2
clean_rate:0.99800796812749
noisy true:321
noisy false:307
after delete: len(clean_dataset) 1004
after delete: len(noisy_dataset) 628
epoch [39/200] batch [5/31] time 0.355 (0.363) data 0.278 (0.285) loss_x loss_x 0.2783 (0.4826) acc_x 93.7500 (91.8750) lr 1.8358e-03 eta 0:00:09
epoch [39/200] batch [10/31] time 0.353 (0.361) data 0.274 (0.283) loss_x loss_x 0.4795 (0.4586) acc_x 87.5000 (89.6875) lr 1.8358e-03 eta 0:00:07
epoch [39/200] batch [15/31] time 0.356 (0.360) data 0.277 (0.282) loss_x loss_x 0.6074 (0.5217) acc_x 87.5000 (88.3333) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [20/31] time 0.349 (0.358) data 0.271 (0.281) loss_x loss_x 0.4314 (0.5022) acc_x 87.5000 (88.2812) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [25/31] time 0.354 (0.359) data 0.277 (0.282) loss_x loss_x 0.4502 (0.4709) acc_x 90.6250 (88.7500) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [30/31] time 0.352 (0.362) data 0.275 (0.284) loss_x loss_x 0.5439 (0.4613) acc_x 84.3750 (88.6458) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/19] time 0.353 (0.363) data 0.275 (0.285) loss_u loss_u 0.9248 (0.8659) acc_u 9.3750 (15.6250) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/19] time 0.358 (0.362) data 0.279 (0.284) loss_u loss_u 0.8130 (0.8672) acc_u 21.8750 (15.9375) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [15/19] time 0.355 (0.359) data 0.276 (0.281) loss_u loss_u 0.7910 (0.8565) acc_u 25.0000 (16.6667) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 339
confident_label rate tensor(0.6078, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 992
clean true:986
clean false:6
clean_rate:0.9939516129032258
noisy true:307
noisy false:333
after delete: len(clean_dataset) 992
after delete: len(noisy_dataset) 640
epoch [40/200] batch [5/31] time 0.416 (0.377) data 0.338 (0.299) loss_x loss_x 0.4431 (0.5025) acc_x 84.3750 (88.7500) lr 1.8271e-03 eta 0:00:09
epoch [40/200] batch [10/31] time 0.338 (0.364) data 0.260 (0.287) loss_x loss_x 0.5156 (0.4821) acc_x 87.5000 (89.0625) lr 1.8271e-03 eta 0:00:07
epoch [40/200] batch [15/31] time 0.363 (0.365) data 0.284 (0.287) loss_x loss_x 0.4067 (0.4527) acc_x 90.6250 (90.4167) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [20/31] time 0.383 (0.362) data 0.306 (0.285) loss_x loss_x 0.6768 (0.4481) acc_x 84.3750 (90.4688) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [25/31] time 0.343 (0.365) data 0.265 (0.287) loss_x loss_x 0.3855 (0.4230) acc_x 93.7500 (90.8750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [30/31] time 0.364 (0.363) data 0.285 (0.285) loss_x loss_x 0.3091 (0.4322) acc_x 93.7500 (90.5208) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/20] time 0.376 (0.364) data 0.298 (0.286) loss_u loss_u 0.8979 (0.8478) acc_u 12.5000 (20.0000) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/20] time 0.309 (0.360) data 0.230 (0.282) loss_u loss_u 0.8804 (0.8455) acc_u 12.5000 (18.7500) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [15/20] time 0.355 (0.360) data 0.277 (0.282) loss_u loss_u 0.8892 (0.8465) acc_u 12.5000 (18.9583) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/20] time 0.363 (0.360) data 0.285 (0.282) loss_u loss_u 0.9082 (0.8528) acc_u 9.3750 (18.1250) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 302
confident_label rate tensor(0.6232, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1017
clean true:1014
clean false:3
clean_rate:0.9970501474926253
noisy true:316
noisy false:299
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 615
epoch [41/200] batch [5/31] time 0.357 (0.365) data 0.279 (0.287) loss_x loss_x 0.3145 (0.4455) acc_x 93.7500 (88.7500) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [10/31] time 0.346 (0.363) data 0.268 (0.285) loss_x loss_x 0.4268 (0.4365) acc_x 84.3750 (88.4375) lr 1.8181e-03 eta 0:00:07
epoch [41/200] batch [15/31] time 0.372 (0.362) data 0.294 (0.284) loss_x loss_x 0.1879 (0.4231) acc_x 93.7500 (88.3333) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [20/31] time 0.358 (0.364) data 0.280 (0.286) loss_x loss_x 0.5571 (0.4222) acc_x 84.3750 (88.4375) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [25/31] time 0.364 (0.367) data 0.286 (0.290) loss_x loss_x 0.4729 (0.4343) acc_x 84.3750 (88.1250) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [30/31] time 0.360 (0.365) data 0.282 (0.288) loss_x loss_x 0.2201 (0.4236) acc_x 93.7500 (88.4375) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/19] time 0.311 (0.359) data 0.232 (0.281) loss_u loss_u 0.8330 (0.8516) acc_u 15.6250 (18.1250) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/19] time 0.376 (0.356) data 0.298 (0.277) loss_u loss_u 0.7788 (0.8727) acc_u 31.2500 (16.2500) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/19] time 0.342 (0.354) data 0.262 (0.276) loss_u loss_u 0.9028 (0.8792) acc_u 12.5000 (15.6250) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 296
confident_label rate tensor(0.6219, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1015
clean true:1011
clean false:4
clean_rate:0.9960591133004926
noisy true:325
noisy false:292
after delete: len(clean_dataset) 1015
after delete: len(noisy_dataset) 617
epoch [42/200] batch [5/31] time 0.359 (0.355) data 0.282 (0.277) loss_x loss_x 0.6260 (0.3698) acc_x 81.2500 (90.6250) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [10/31] time 0.362 (0.358) data 0.285 (0.280) loss_x loss_x 0.2905 (0.3604) acc_x 93.7500 (90.3125) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [15/31] time 0.362 (0.361) data 0.284 (0.283) loss_x loss_x 0.3403 (0.3621) acc_x 93.7500 (90.2083) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [20/31] time 0.355 (0.358) data 0.277 (0.280) loss_x loss_x 0.7271 (0.3840) acc_x 81.2500 (89.3750) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [25/31] time 0.365 (0.359) data 0.287 (0.281) loss_x loss_x 0.3088 (0.4239) acc_x 96.8750 (88.7500) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [30/31] time 0.355 (0.358) data 0.277 (0.281) loss_x loss_x 0.3430 (0.4325) acc_x 90.6250 (88.3333) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/19] time 0.318 (0.356) data 0.239 (0.277) loss_u loss_u 0.8755 (0.8799) acc_u 15.6250 (14.3750) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/19] time 0.349 (0.355) data 0.271 (0.276) loss_u loss_u 0.9541 (0.8814) acc_u 6.2500 (14.3750) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/19] time 0.305 (0.353) data 0.227 (0.275) loss_u loss_u 0.8008 (0.8589) acc_u 25.0000 (17.5000) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 284
confident_label rate tensor(0.6311, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1030
clean true:1024
clean false:6
clean_rate:0.9941747572815534
noisy true:324
noisy false:278
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 602
epoch [43/200] batch [5/32] time 0.342 (0.355) data 0.265 (0.278) loss_x loss_x 0.2462 (0.3140) acc_x 93.7500 (92.5000) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [10/32] time 0.360 (0.355) data 0.283 (0.277) loss_x loss_x 0.1782 (0.3499) acc_x 100.0000 (92.1875) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [15/32] time 0.357 (0.353) data 0.279 (0.276) loss_x loss_x 0.5527 (0.4048) acc_x 90.6250 (91.2500) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [20/32] time 0.380 (0.360) data 0.303 (0.282) loss_x loss_x 0.4453 (0.4139) acc_x 87.5000 (90.4688) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [25/32] time 0.337 (0.359) data 0.259 (0.281) loss_x loss_x 0.3481 (0.4259) acc_x 93.7500 (90.1250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [30/32] time 0.376 (0.358) data 0.297 (0.281) loss_x loss_x 0.3430 (0.4394) acc_x 93.7500 (89.4792) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/18] time 0.303 (0.356) data 0.224 (0.278) loss_u loss_u 0.8750 (0.8702) acc_u 15.6250 (15.0000) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/18] time 0.345 (0.353) data 0.267 (0.276) loss_u loss_u 0.8159 (0.8437) acc_u 25.0000 (19.3750) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/18] time 0.305 (0.352) data 0.226 (0.274) loss_u loss_u 0.8643 (0.8482) acc_u 15.6250 (18.7500) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 296
confident_label rate tensor(0.6293, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1027
clean true:1020
clean false:7
clean_rate:0.9931840311587147
noisy true:316
noisy false:289
after delete: len(clean_dataset) 1027
after delete: len(noisy_dataset) 605
epoch [44/200] batch [5/32] time 0.363 (0.485) data 0.285 (0.407) loss_x loss_x 0.5884 (0.5657) acc_x 81.2500 (84.3750) lr 1.7902e-03 eta 0:00:13
epoch [44/200] batch [10/32] time 0.360 (0.429) data 0.280 (0.351) loss_x loss_x 0.7026 (0.4675) acc_x 84.3750 (88.1250) lr 1.7902e-03 eta 0:00:09
epoch [44/200] batch [15/32] time 0.343 (0.406) data 0.265 (0.328) loss_x loss_x 0.5664 (0.4181) acc_x 78.1250 (89.5833) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [20/32] time 0.367 (0.399) data 0.287 (0.321) loss_x loss_x 0.3787 (0.4313) acc_x 87.5000 (89.2188) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [25/32] time 0.358 (0.391) data 0.280 (0.313) loss_x loss_x 0.3726 (0.4379) acc_x 87.5000 (89.2500) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [30/32] time 0.342 (0.384) data 0.264 (0.306) loss_x loss_x 0.8013 (0.4363) acc_x 78.1250 (89.1667) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/18] time 0.328 (0.383) data 0.249 (0.305) loss_u loss_u 0.8574 (0.8667) acc_u 18.7500 (16.8750) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/18] time 0.405 (0.378) data 0.327 (0.300) loss_u loss_u 0.7344 (0.8440) acc_u 31.2500 (19.6875) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/18] time 0.360 (0.379) data 0.282 (0.300) loss_u loss_u 0.8584 (0.8530) acc_u 15.6250 (17.9167) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.6397, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1044
clean true:1036
clean false:8
clean_rate:0.9923371647509579
noisy true:313
noisy false:275
after delete: len(clean_dataset) 1044
after delete: len(noisy_dataset) 588
epoch [45/200] batch [5/32] time 0.352 (0.361) data 0.274 (0.283) loss_x loss_x 0.3386 (0.4802) acc_x 87.5000 (90.0000) lr 1.7804e-03 eta 0:00:09
epoch [45/200] batch [10/32] time 0.354 (0.356) data 0.276 (0.278) loss_x loss_x 0.5146 (0.5012) acc_x 87.5000 (89.0625) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [15/32] time 0.353 (0.357) data 0.275 (0.279) loss_x loss_x 0.4890 (0.4795) acc_x 90.6250 (89.3750) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [20/32] time 0.362 (0.355) data 0.284 (0.277) loss_x loss_x 0.2217 (0.4591) acc_x 93.7500 (88.7500) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [25/32] time 0.350 (0.356) data 0.272 (0.278) loss_x loss_x 0.6353 (0.4564) acc_x 87.5000 (88.8750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [30/32] time 0.349 (0.355) data 0.271 (0.277) loss_x loss_x 0.6025 (0.4465) acc_x 81.2500 (88.9583) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/18] time 0.327 (0.351) data 0.249 (0.273) loss_u loss_u 0.7837 (0.8530) acc_u 25.0000 (18.1250) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/18] time 0.307 (0.348) data 0.228 (0.270) loss_u loss_u 0.8198 (0.8579) acc_u 18.7500 (16.8750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/18] time 0.352 (0.350) data 0.272 (0.271) loss_u loss_u 0.8633 (0.8695) acc_u 15.6250 (15.2083) lr 1.7804e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 275
confident_label rate tensor(0.6403, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1045
clean true:1036
clean false:9
clean_rate:0.9913875598086125
noisy true:321
noisy false:266
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 587
epoch [46/200] batch [5/32] time 0.324 (0.359) data 0.247 (0.281) loss_x loss_x 0.4141 (0.4239) acc_x 93.7500 (90.6250) lr 1.7705e-03 eta 0:00:09
epoch [46/200] batch [10/32] time 0.385 (0.358) data 0.307 (0.281) loss_x loss_x 0.3970 (0.4376) acc_x 90.6250 (90.0000) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [15/32] time 0.362 (0.357) data 0.285 (0.280) loss_x loss_x 0.4270 (0.4211) acc_x 87.5000 (89.1667) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [20/32] time 0.353 (0.358) data 0.276 (0.280) loss_x loss_x 0.3262 (0.4277) acc_x 93.7500 (89.2188) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [25/32] time 0.343 (0.356) data 0.265 (0.279) loss_x loss_x 0.3196 (0.4185) acc_x 90.6250 (89.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/32] time 0.337 (0.354) data 0.259 (0.277) loss_x loss_x 0.5356 (0.4158) acc_x 87.5000 (90.1042) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/18] time 0.296 (0.346) data 0.217 (0.269) loss_u loss_u 0.9194 (0.8539) acc_u 9.3750 (16.8750) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [10/18] time 0.384 (0.346) data 0.306 (0.268) loss_u loss_u 0.8057 (0.8591) acc_u 21.8750 (16.5625) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/18] time 0.348 (0.347) data 0.270 (0.269) loss_u loss_u 0.8359 (0.8648) acc_u 18.7500 (15.6250) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 296
confident_label rate tensor(0.6207, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1013
clean true:1010
clean false:3
clean_rate:0.9970384995064165
noisy true:326
noisy false:293
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 619
epoch [47/200] batch [5/31] time 0.372 (0.354) data 0.295 (0.276) loss_x loss_x 0.4106 (0.4808) acc_x 87.5000 (86.2500) lr 1.7604e-03 eta 0:00:09
epoch [47/200] batch [10/31] time 0.352 (0.355) data 0.274 (0.277) loss_x loss_x 0.5376 (0.4473) acc_x 81.2500 (88.7500) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [15/31] time 0.348 (0.352) data 0.270 (0.274) loss_x loss_x 0.9590 (0.4677) acc_x 75.0000 (87.9167) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [20/31] time 0.349 (0.351) data 0.272 (0.273) loss_x loss_x 0.8906 (0.4746) acc_x 81.2500 (88.2812) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/31] time 0.326 (0.348) data 0.249 (0.270) loss_x loss_x 0.6147 (0.4765) acc_x 87.5000 (88.7500) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [30/31] time 0.340 (0.346) data 0.262 (0.269) loss_x loss_x 0.2181 (0.4637) acc_x 93.7500 (88.9583) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/19] time 0.342 (0.345) data 0.265 (0.267) loss_u loss_u 0.8252 (0.8713) acc_u 18.7500 (15.6250) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/19] time 0.308 (0.340) data 0.230 (0.262) loss_u loss_u 0.7891 (0.8664) acc_u 25.0000 (16.5625) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/19] time 0.344 (0.337) data 0.266 (0.259) loss_u loss_u 0.7915 (0.8533) acc_u 21.8750 (17.7083) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.6403, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1045
clean true:1040
clean false:5
clean_rate:0.9952153110047847
noisy true:326
noisy false:261
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 587
epoch [48/200] batch [5/32] time 0.364 (0.365) data 0.286 (0.287) loss_x loss_x 0.3374 (0.3819) acc_x 93.7500 (91.8750) lr 1.7501e-03 eta 0:00:09
epoch [48/200] batch [10/32] time 0.322 (0.353) data 0.244 (0.276) loss_x loss_x 0.3086 (0.3785) acc_x 90.6250 (91.2500) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [15/32] time 0.363 (0.353) data 0.285 (0.275) loss_x loss_x 0.4460 (0.3602) acc_x 87.5000 (91.6667) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [20/32] time 0.340 (0.354) data 0.262 (0.276) loss_x loss_x 0.5098 (0.4137) acc_x 84.3750 (90.4688) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [25/32] time 0.348 (0.351) data 0.271 (0.273) loss_x loss_x 0.2703 (0.4135) acc_x 93.7500 (90.6250) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [30/32] time 0.356 (0.350) data 0.278 (0.272) loss_x loss_x 0.3408 (0.4051) acc_x 90.6250 (90.5208) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/18] time 0.347 (0.351) data 0.269 (0.273) loss_u loss_u 0.8696 (0.8577) acc_u 15.6250 (16.2500) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/18] time 0.296 (0.348) data 0.217 (0.270) loss_u loss_u 0.8130 (0.8628) acc_u 21.8750 (16.2500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/18] time 0.305 (0.343) data 0.226 (0.265) loss_u loss_u 0.9268 (0.8588) acc_u 12.5000 (16.6667) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 290
confident_label rate tensor(0.6348, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1036
clean true:1029
clean false:7
clean_rate:0.9932432432432432
noisy true:313
noisy false:283
after delete: len(clean_dataset) 1036
after delete: len(noisy_dataset) 596
epoch [49/200] batch [5/32] time 0.366 (0.354) data 0.289 (0.276) loss_x loss_x 0.1669 (0.3729) acc_x 100.0000 (91.2500) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [10/32] time 0.343 (0.354) data 0.266 (0.276) loss_x loss_x 0.5957 (0.4416) acc_x 81.2500 (89.3750) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [15/32] time 0.331 (0.351) data 0.254 (0.274) loss_x loss_x 0.3962 (0.4107) acc_x 93.7500 (90.6250) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [20/32] time 0.327 (0.349) data 0.249 (0.272) loss_x loss_x 0.5356 (0.4318) acc_x 87.5000 (90.6250) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [25/32] time 0.342 (0.348) data 0.263 (0.270) loss_x loss_x 0.6953 (0.4386) acc_x 81.2500 (90.3750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [30/32] time 0.351 (0.348) data 0.274 (0.270) loss_x loss_x 0.3672 (0.4318) acc_x 90.6250 (90.5208) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/18] time 0.382 (0.351) data 0.304 (0.273) loss_u loss_u 0.8408 (0.8411) acc_u 18.7500 (19.3750) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [10/18] time 0.343 (0.351) data 0.264 (0.273) loss_u loss_u 0.8687 (0.8568) acc_u 18.7500 (18.4375) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/18] time 0.309 (0.348) data 0.230 (0.270) loss_u loss_u 0.8599 (0.8590) acc_u 15.6250 (17.7083) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 292
confident_label rate tensor(0.6287, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1026
clean true:1021
clean false:5
clean_rate:0.9951267056530214
noisy true:319
noisy false:287
after delete: len(clean_dataset) 1026
after delete: len(noisy_dataset) 606
epoch [50/200] batch [5/32] time 0.347 (0.338) data 0.270 (0.260) loss_x loss_x 0.2935 (0.4298) acc_x 96.8750 (91.8750) lr 1.7290e-03 eta 0:00:09
epoch [50/200] batch [10/32] time 0.361 (0.344) data 0.283 (0.266) loss_x loss_x 0.5474 (0.4606) acc_x 84.3750 (90.0000) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [15/32] time 0.345 (0.351) data 0.267 (0.273) loss_x loss_x 0.4092 (0.4602) acc_x 93.7500 (90.2083) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [20/32] time 0.360 (0.350) data 0.282 (0.272) loss_x loss_x 0.1272 (0.4410) acc_x 96.8750 (89.6875) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [25/32] time 0.362 (0.350) data 0.283 (0.272) loss_x loss_x 0.4727 (0.4542) acc_x 87.5000 (88.8750) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [30/32] time 0.369 (0.351) data 0.291 (0.273) loss_x loss_x 0.2751 (0.4577) acc_x 90.6250 (88.8542) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/18] time 0.359 (0.352) data 0.282 (0.274) loss_u loss_u 0.8076 (0.8215) acc_u 21.8750 (20.6250) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/18] time 0.353 (0.351) data 0.275 (0.274) loss_u loss_u 0.8032 (0.8315) acc_u 21.8750 (19.6875) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/18] time 0.301 (0.351) data 0.223 (0.273) loss_u loss_u 0.8462 (0.8452) acc_u 18.7500 (18.1250) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 286
confident_label rate tensor(0.6373, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1040
clean true:1033
clean false:7
clean_rate:0.9932692307692308
noisy true:313
noisy false:279
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 592
epoch [51/200] batch [5/32] time 0.376 (0.339) data 0.298 (0.261) loss_x loss_x 0.9487 (0.5444) acc_x 81.2500 (87.5000) lr 1.7181e-03 eta 0:00:09
epoch [51/200] batch [10/32] time 0.338 (0.349) data 0.260 (0.271) loss_x loss_x 0.4897 (0.4623) acc_x 90.6250 (89.3750) lr 1.7181e-03 eta 0:00:07
epoch [51/200] batch [15/32] time 0.303 (0.345) data 0.225 (0.267) loss_x loss_x 0.6333 (0.4892) acc_x 84.3750 (88.7500) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [20/32] time 0.372 (0.344) data 0.295 (0.266) loss_x loss_x 0.3430 (0.4736) acc_x 90.6250 (88.5938) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [25/32] time 0.345 (0.348) data 0.268 (0.270) loss_x loss_x 0.5986 (0.4742) acc_x 78.1250 (87.8750) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [30/32] time 0.359 (0.350) data 0.281 (0.272) loss_x loss_x 0.3057 (0.4545) acc_x 87.5000 (88.3333) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/18] time 0.347 (0.349) data 0.267 (0.272) loss_u loss_u 0.7075 (0.8466) acc_u 34.3750 (18.1250) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/18] time 0.354 (0.349) data 0.276 (0.271) loss_u loss_u 0.7095 (0.8479) acc_u 34.3750 (18.1250) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/18] time 0.352 (0.350) data 0.274 (0.272) loss_u loss_u 0.7769 (0.8391) acc_u 25.0000 (19.1667) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.6366, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1039
clean true:1035
clean false:4
clean_rate:0.9961501443695862
noisy true:327
noisy false:266
after delete: len(clean_dataset) 1039
after delete: len(noisy_dataset) 593
epoch [52/200] batch [5/32] time 0.360 (0.370) data 0.281 (0.292) loss_x loss_x 0.8232 (0.4519) acc_x 81.2500 (90.6250) lr 1.7071e-03 eta 0:00:09
epoch [52/200] batch [10/32] time 0.350 (0.363) data 0.272 (0.285) loss_x loss_x 0.3298 (0.4291) acc_x 87.5000 (89.6875) lr 1.7071e-03 eta 0:00:07
epoch [52/200] batch [15/32] time 0.349 (0.363) data 0.271 (0.285) loss_x loss_x 0.8647 (0.4432) acc_x 84.3750 (89.3750) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [20/32] time 0.357 (0.362) data 0.280 (0.284) loss_x loss_x 0.6431 (0.4709) acc_x 81.2500 (88.5938) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [25/32] time 0.336 (0.362) data 0.259 (0.284) loss_x loss_x 0.4492 (0.4752) acc_x 90.6250 (88.6250) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/32] time 0.348 (0.360) data 0.270 (0.282) loss_x loss_x 0.5464 (0.4716) acc_x 87.5000 (89.0625) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/18] time 0.349 (0.360) data 0.270 (0.282) loss_u loss_u 0.8472 (0.8565) acc_u 18.7500 (18.1250) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/18] time 0.309 (0.356) data 0.229 (0.278) loss_u loss_u 0.9077 (0.8717) acc_u 12.5000 (16.5625) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/18] time 0.353 (0.355) data 0.274 (0.277) loss_u loss_u 0.8472 (0.8598) acc_u 15.6250 (18.1250) lr 1.7071e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 286
confident_label rate tensor(0.6317, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1031
clean true:1026
clean false:5
clean_rate:0.9951503394762367
noisy true:320
noisy false:281
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 601
epoch [53/200] batch [5/32] time 0.362 (0.365) data 0.284 (0.288) loss_x loss_x 0.2465 (0.4313) acc_x 96.8750 (88.7500) lr 1.6959e-03 eta 0:00:09
epoch [53/200] batch [10/32] time 0.339 (0.358) data 0.261 (0.281) loss_x loss_x 0.6064 (0.5219) acc_x 87.5000 (86.8750) lr 1.6959e-03 eta 0:00:07
epoch [53/200] batch [15/32] time 0.340 (0.353) data 0.263 (0.276) loss_x loss_x 0.3557 (0.4701) acc_x 90.6250 (88.5417) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [20/32] time 0.358 (0.355) data 0.278 (0.277) loss_x loss_x 0.4072 (0.4921) acc_x 87.5000 (87.8125) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [25/32] time 0.344 (0.354) data 0.267 (0.276) loss_x loss_x 0.2502 (0.4678) acc_x 96.8750 (88.6250) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [30/32] time 0.367 (0.355) data 0.289 (0.277) loss_x loss_x 0.2563 (0.4466) acc_x 93.7500 (89.0625) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/18] time 0.364 (0.347) data 0.286 (0.270) loss_u loss_u 0.9077 (0.8594) acc_u 12.5000 (16.2500) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/18] time 0.330 (0.348) data 0.252 (0.270) loss_u loss_u 0.8765 (0.8377) acc_u 15.6250 (18.7500) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/18] time 0.323 (0.347) data 0.244 (0.269) loss_u loss_u 0.7529 (0.8307) acc_u 28.1250 (20.0000) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 230
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1079
clean true:1076
clean false:3
clean_rate:0.9972196478220574
noisy true:326
noisy false:227
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 553
epoch [54/200] batch [5/33] time 0.354 (0.362) data 0.276 (0.284) loss_x loss_x 0.1475 (0.4260) acc_x 100.0000 (90.6250) lr 1.6845e-03 eta 0:00:10
epoch [54/200] batch [10/33] time 0.331 (0.354) data 0.253 (0.276) loss_x loss_x 0.5107 (0.4018) acc_x 84.3750 (90.0000) lr 1.6845e-03 eta 0:00:08
epoch [54/200] batch [15/33] time 0.329 (0.353) data 0.251 (0.275) loss_x loss_x 0.3833 (0.4550) acc_x 93.7500 (88.9583) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [20/33] time 0.377 (0.352) data 0.299 (0.274) loss_x loss_x 0.4272 (0.4509) acc_x 84.3750 (88.1250) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [25/33] time 0.342 (0.352) data 0.264 (0.274) loss_x loss_x 0.6455 (0.4711) acc_x 87.5000 (87.7500) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [30/33] time 0.357 (0.351) data 0.280 (0.274) loss_x loss_x 0.4543 (0.4570) acc_x 78.1250 (87.7083) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [5/17] time 0.350 (0.349) data 0.271 (0.271) loss_u loss_u 0.8633 (0.8892) acc_u 12.5000 (13.1250) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/17] time 0.320 (0.350) data 0.241 (0.272) loss_u loss_u 0.9067 (0.8858) acc_u 12.5000 (13.4375) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/17] time 0.341 (0.349) data 0.263 (0.271) loss_u loss_u 0.9375 (0.8816) acc_u 9.3750 (14.1667) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.6446, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1052
clean true:1047
clean false:5
clean_rate:0.9952471482889734
noisy true:322
noisy false:258
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 580
epoch [55/200] batch [5/32] time 0.346 (0.343) data 0.269 (0.265) loss_x loss_x 0.4902 (0.4758) acc_x 84.3750 (87.5000) lr 1.6730e-03 eta 0:00:09
epoch [55/200] batch [10/32] time 0.364 (0.346) data 0.286 (0.269) loss_x loss_x 0.1605 (0.4415) acc_x 96.8750 (88.1250) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [15/32] time 0.352 (0.347) data 0.274 (0.269) loss_x loss_x 0.4451 (0.4408) acc_x 90.6250 (88.7500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [20/32] time 0.365 (0.346) data 0.288 (0.268) loss_x loss_x 0.2810 (0.4338) acc_x 100.0000 (89.2188) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [25/32] time 0.341 (0.347) data 0.263 (0.269) loss_x loss_x 0.3394 (0.4349) acc_x 93.7500 (88.6250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [30/32] time 0.347 (0.346) data 0.269 (0.269) loss_x loss_x 0.4128 (0.4466) acc_x 78.1250 (87.9167) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/18] time 0.305 (0.345) data 0.227 (0.267) loss_u loss_u 0.9224 (0.8677) acc_u 9.3750 (14.3750) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [10/18] time 0.333 (0.343) data 0.255 (0.265) loss_u loss_u 0.9014 (0.8802) acc_u 15.6250 (14.3750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/18] time 0.339 (0.344) data 0.261 (0.266) loss_u loss_u 0.9072 (0.8635) acc_u 12.5000 (16.6667) lr 1.6730e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.6483, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1058
clean true:1055
clean false:3
clean_rate:0.997164461247637
noisy true:327
noisy false:247
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 574
epoch [56/200] batch [5/33] time 0.336 (0.357) data 0.258 (0.279) loss_x loss_x 0.3943 (0.4078) acc_x 90.6250 (86.8750) lr 1.6613e-03 eta 0:00:10
epoch [56/200] batch [10/33] time 0.345 (0.353) data 0.268 (0.275) loss_x loss_x 0.1809 (0.3907) acc_x 100.0000 (89.0625) lr 1.6613e-03 eta 0:00:08
epoch [56/200] batch [15/33] time 0.361 (0.349) data 0.283 (0.271) loss_x loss_x 0.5801 (0.4180) acc_x 87.5000 (88.9583) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [20/33] time 0.355 (0.349) data 0.278 (0.271) loss_x loss_x 0.4397 (0.4162) acc_x 84.3750 (89.0625) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [25/33] time 0.355 (0.348) data 0.277 (0.270) loss_x loss_x 0.2600 (0.4128) acc_x 93.7500 (89.2500) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/33] time 0.366 (0.350) data 0.288 (0.272) loss_x loss_x 0.5762 (0.4169) acc_x 84.3750 (89.1667) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [5/17] time 0.296 (0.346) data 0.218 (0.269) loss_u loss_u 0.8984 (0.8867) acc_u 12.5000 (13.1250) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [10/17] time 0.357 (0.343) data 0.279 (0.265) loss_u loss_u 0.8794 (0.8710) acc_u 12.5000 (15.3125) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/17] time 0.309 (0.343) data 0.229 (0.265) loss_u loss_u 0.8013 (0.8472) acc_u 21.8750 (18.1250) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.6556, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1070
clean true:1069
clean false:1
clean_rate:0.9990654205607477
noisy true:332
noisy false:230
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 562
epoch [57/200] batch [5/33] time 0.343 (0.360) data 0.265 (0.282) loss_x loss_x 0.7559 (0.5213) acc_x 71.8750 (87.5000) lr 1.6494e-03 eta 0:00:10
epoch [57/200] batch [10/33] time 0.357 (0.356) data 0.280 (0.279) loss_x loss_x 0.5439 (0.4981) acc_x 84.3750 (87.5000) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [15/33] time 0.343 (0.353) data 0.265 (0.276) loss_x loss_x 0.2874 (0.5065) acc_x 93.7500 (87.7083) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [20/33] time 0.377 (0.353) data 0.298 (0.275) loss_x loss_x 0.3604 (0.4804) acc_x 90.6250 (88.1250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [25/33] time 0.366 (0.352) data 0.287 (0.274) loss_x loss_x 0.4661 (0.4617) acc_x 93.7500 (89.2500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [30/33] time 0.359 (0.352) data 0.281 (0.274) loss_x loss_x 0.3262 (0.4423) acc_x 90.6250 (89.1667) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [5/17] time 0.336 (0.350) data 0.257 (0.272) loss_u loss_u 0.8477 (0.8272) acc_u 15.6250 (20.0000) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/17] time 0.357 (0.346) data 0.279 (0.268) loss_u loss_u 0.8721 (0.8530) acc_u 12.5000 (18.1250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/17] time 0.310 (0.345) data 0.232 (0.267) loss_u loss_u 0.8813 (0.8675) acc_u 15.6250 (16.8750) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 248
confident_label rate tensor(0.6544, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1068
clean true:1066
clean false:2
clean_rate:0.99812734082397
noisy true:318
noisy false:246
after delete: len(clean_dataset) 1068
after delete: len(noisy_dataset) 564
epoch [58/200] batch [5/33] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.5269 (0.3900) acc_x 93.7500 (93.1250) lr 1.6374e-03 eta 0:00:09
epoch [58/200] batch [10/33] time 0.383 (0.367) data 0.305 (0.289) loss_x loss_x 0.2839 (0.3811) acc_x 96.8750 (92.5000) lr 1.6374e-03 eta 0:00:08
epoch [58/200] batch [15/33] time 0.348 (0.365) data 0.270 (0.287) loss_x loss_x 0.3953 (0.3924) acc_x 87.5000 (91.8750) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [20/33] time 0.354 (0.363) data 0.276 (0.285) loss_x loss_x 0.4387 (0.3919) acc_x 90.6250 (92.3438) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [25/33] time 0.359 (0.362) data 0.281 (0.284) loss_x loss_x 0.3081 (0.4056) acc_x 90.6250 (91.2500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [30/33] time 0.345 (0.361) data 0.267 (0.283) loss_x loss_x 0.5259 (0.4115) acc_x 90.6250 (90.9375) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [5/17] time 0.321 (0.359) data 0.243 (0.281) loss_u loss_u 0.8701 (0.8552) acc_u 12.5000 (16.8750) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/17] time 0.310 (0.353) data 0.232 (0.275) loss_u loss_u 0.7993 (0.8612) acc_u 28.1250 (16.8750) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/17] time 0.342 (0.351) data 0.264 (0.273) loss_u loss_u 0.8882 (0.8578) acc_u 12.5000 (17.0833) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 216
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1084
clean false:4
clean_rate:0.9963235294117647
noisy true:332
noisy false:212
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [59/200] batch [5/34] time 0.341 (0.382) data 0.263 (0.304) loss_x loss_x 0.2218 (0.3815) acc_x 93.7500 (88.7500) lr 1.6252e-03 eta 0:00:11
epoch [59/200] batch [10/34] time 0.334 (0.363) data 0.257 (0.285) loss_x loss_x 0.4565 (0.4168) acc_x 90.6250 (89.0625) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [15/34] time 0.339 (0.358) data 0.262 (0.280) loss_x loss_x 0.5503 (0.4588) acc_x 84.3750 (87.5000) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [20/34] time 0.345 (0.357) data 0.267 (0.280) loss_x loss_x 0.2812 (0.4239) acc_x 96.8750 (88.9062) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [25/34] time 0.370 (0.358) data 0.292 (0.281) loss_x loss_x 0.6792 (0.4290) acc_x 81.2500 (89.3750) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [30/34] time 0.366 (0.357) data 0.289 (0.280) loss_x loss_x 0.5166 (0.4229) acc_x 90.6250 (89.4792) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [5/17] time 0.355 (0.360) data 0.277 (0.282) loss_u loss_u 0.7925 (0.8764) acc_u 21.8750 (15.0000) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [10/17] time 0.358 (0.357) data 0.279 (0.279) loss_u loss_u 0.8950 (0.8783) acc_u 12.5000 (14.6875) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/17] time 0.314 (0.355) data 0.234 (0.278) loss_u loss_u 0.8921 (0.8838) acc_u 12.5000 (13.9583) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.6575, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1073
clean true:1069
clean false:4
clean_rate:0.9962721342031687
noisy true:325
noisy false:234
after delete: len(clean_dataset) 1073
after delete: len(noisy_dataset) 559
epoch [60/200] batch [5/33] time 0.309 (0.323) data 0.231 (0.246) loss_x loss_x 0.4290 (0.3448) acc_x 90.6250 (90.6250) lr 1.6129e-03 eta 0:00:09
epoch [60/200] batch [10/33] time 0.351 (0.335) data 0.273 (0.258) loss_x loss_x 0.3706 (0.4397) acc_x 87.5000 (88.7500) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [15/33] time 0.372 (0.340) data 0.295 (0.263) loss_x loss_x 0.4995 (0.4693) acc_x 87.5000 (87.9167) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [20/33] time 0.348 (0.345) data 0.270 (0.267) loss_x loss_x 0.1066 (0.4106) acc_x 100.0000 (89.5312) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [25/33] time 0.339 (0.346) data 0.261 (0.269) loss_x loss_x 0.2244 (0.3975) acc_x 93.7500 (89.7500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [30/33] time 0.340 (0.347) data 0.262 (0.269) loss_x loss_x 0.3010 (0.3895) acc_x 93.7500 (89.8958) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [5/17] time 0.347 (0.347) data 0.268 (0.270) loss_u loss_u 0.7959 (0.8553) acc_u 21.8750 (15.6250) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/17] time 0.340 (0.344) data 0.261 (0.266) loss_u loss_u 0.8838 (0.8472) acc_u 15.6250 (17.5000) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/17] time 0.356 (0.347) data 0.275 (0.268) loss_u loss_u 0.8379 (0.8508) acc_u 18.7500 (17.5000) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.6507, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1062
clean true:1061
clean false:1
clean_rate:0.9990583804143126
noisy true:338
noisy false:232
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 570
epoch [61/200] batch [5/33] time 0.349 (0.356) data 0.270 (0.278) loss_x loss_x 0.3679 (0.4200) acc_x 93.7500 (89.3750) lr 1.6004e-03 eta 0:00:09
epoch [61/200] batch [10/33] time 0.346 (0.354) data 0.269 (0.276) loss_x loss_x 0.5879 (0.4159) acc_x 84.3750 (89.6875) lr 1.6004e-03 eta 0:00:08
epoch [61/200] batch [15/33] time 0.361 (0.356) data 0.283 (0.278) loss_x loss_x 0.2485 (0.3954) acc_x 93.7500 (90.4167) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [20/33] time 0.340 (0.355) data 0.262 (0.277) loss_x loss_x 0.1044 (0.3768) acc_x 100.0000 (90.6250) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [25/33] time 0.340 (0.352) data 0.262 (0.274) loss_x loss_x 0.3796 (0.3784) acc_x 90.6250 (90.6250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [30/33] time 0.341 (0.350) data 0.264 (0.273) loss_x loss_x 0.2231 (0.3657) acc_x 90.6250 (90.8333) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [5/17] time 0.312 (0.346) data 0.233 (0.269) loss_u loss_u 0.7891 (0.8405) acc_u 28.1250 (21.2500) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/17] time 0.335 (0.345) data 0.258 (0.268) loss_u loss_u 0.8145 (0.8552) acc_u 21.8750 (18.7500) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/17] time 0.332 (0.346) data 0.254 (0.268) loss_u loss_u 0.7949 (0.8497) acc_u 25.0000 (18.9583) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 230
confident_label rate tensor(0.6587, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1075
clean true:1073
clean false:2
clean_rate:0.998139534883721
noisy true:329
noisy false:228
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 557
epoch [62/200] batch [5/33] time 0.363 (0.370) data 0.285 (0.292) loss_x loss_x 0.2654 (0.4378) acc_x 96.8750 (90.6250) lr 1.5878e-03 eta 0:00:10
epoch [62/200] batch [10/33] time 0.393 (0.365) data 0.316 (0.287) loss_x loss_x 0.5342 (0.4413) acc_x 78.1250 (88.7500) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [15/33] time 0.362 (0.363) data 0.285 (0.286) loss_x loss_x 0.2419 (0.4081) acc_x 96.8750 (90.4167) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [20/33] time 0.338 (0.361) data 0.261 (0.283) loss_x loss_x 0.4048 (0.4204) acc_x 93.7500 (90.3125) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [25/33] time 0.357 (0.359) data 0.280 (0.281) loss_x loss_x 0.2976 (0.4210) acc_x 90.6250 (89.7500) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [30/33] time 0.349 (0.359) data 0.272 (0.281) loss_x loss_x 0.4531 (0.4265) acc_x 84.3750 (89.5833) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [5/17] time 0.353 (0.357) data 0.276 (0.279) loss_u loss_u 0.7554 (0.8315) acc_u 34.3750 (21.8750) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/17] time 0.290 (0.352) data 0.211 (0.274) loss_u loss_u 0.8711 (0.8448) acc_u 15.6250 (19.3750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/17] time 0.332 (0.348) data 0.254 (0.270) loss_u loss_u 0.8081 (0.8467) acc_u 25.0000 (19.3750) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 201
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1095
clean false:2
clean_rate:0.9981768459434822
noisy true:336
noisy false:199
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [63/200] batch [5/34] time 0.325 (0.333) data 0.247 (0.255) loss_x loss_x 0.4297 (0.4534) acc_x 93.7500 (89.3750) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [10/34] time 0.355 (0.342) data 0.278 (0.264) loss_x loss_x 0.2445 (0.4612) acc_x 96.8750 (88.1250) lr 1.5750e-03 eta 0:00:08
epoch [63/200] batch [15/34] time 0.351 (0.345) data 0.273 (0.267) loss_x loss_x 0.6641 (0.4558) acc_x 87.5000 (88.1250) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [20/34] time 0.337 (0.343) data 0.259 (0.265) loss_x loss_x 0.3767 (0.4509) acc_x 90.6250 (88.2812) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [25/34] time 0.364 (0.342) data 0.287 (0.265) loss_x loss_x 0.2974 (0.4591) acc_x 90.6250 (88.5000) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [30/34] time 0.345 (0.344) data 0.268 (0.266) loss_x loss_x 0.2812 (0.4480) acc_x 87.5000 (88.3333) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [5/16] time 0.357 (0.345) data 0.279 (0.267) loss_u loss_u 0.8984 (0.8521) acc_u 12.5000 (18.1250) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/16] time 0.349 (0.346) data 0.270 (0.268) loss_u loss_u 0.8940 (0.8727) acc_u 12.5000 (15.9375) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/16] time 0.302 (0.344) data 0.223 (0.266) loss_u loss_u 0.8418 (0.8672) acc_u 18.7500 (16.0417) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.6556, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1070
clean true:1069
clean false:1
clean_rate:0.9990654205607477
noisy true:335
noisy false:227
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 562
epoch [64/200] batch [5/33] time 0.350 (0.365) data 0.271 (0.287) loss_x loss_x 0.3313 (0.3601) acc_x 90.6250 (93.1250) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [10/33] time 0.343 (0.363) data 0.265 (0.285) loss_x loss_x 0.4277 (0.3413) acc_x 87.5000 (93.4375) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [15/33] time 0.347 (0.359) data 0.269 (0.281) loss_x loss_x 0.3821 (0.3630) acc_x 93.7500 (92.7083) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [20/33] time 0.383 (0.360) data 0.305 (0.282) loss_x loss_x 0.5845 (0.3615) acc_x 87.5000 (92.3438) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [25/33] time 0.330 (0.358) data 0.253 (0.280) loss_x loss_x 0.5776 (0.3763) acc_x 84.3750 (92.0000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [30/33] time 0.346 (0.354) data 0.268 (0.277) loss_x loss_x 0.3630 (0.3771) acc_x 90.6250 (91.6667) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [5/17] time 0.350 (0.355) data 0.271 (0.277) loss_u loss_u 0.7876 (0.8540) acc_u 31.2500 (17.5000) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/17] time 0.314 (0.354) data 0.233 (0.276) loss_u loss_u 0.8677 (0.8584) acc_u 15.6250 (16.8750) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/17] time 0.337 (0.352) data 0.257 (0.274) loss_u loss_u 0.7896 (0.8585) acc_u 28.1250 (17.5000) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.6526, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1065
clean true:1064
clean false:1
clean_rate:0.9990610328638497
noisy true:324
noisy false:243
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 567
epoch [65/200] batch [5/33] time 0.346 (0.361) data 0.268 (0.283) loss_x loss_x 0.2319 (0.3878) acc_x 93.7500 (90.6250) lr 1.5490e-03 eta 0:00:10
epoch [65/200] batch [10/33] time 0.361 (0.354) data 0.283 (0.276) loss_x loss_x 0.3530 (0.3818) acc_x 93.7500 (90.6250) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [15/33] time 0.353 (0.354) data 0.275 (0.276) loss_x loss_x 0.3945 (0.4262) acc_x 93.7500 (90.0000) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [20/33] time 0.336 (0.349) data 0.258 (0.271) loss_x loss_x 0.4058 (0.4194) acc_x 84.3750 (89.5312) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [25/33] time 0.343 (0.350) data 0.266 (0.272) loss_x loss_x 0.5024 (0.4467) acc_x 84.3750 (88.5000) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [30/33] time 0.353 (0.352) data 0.276 (0.274) loss_x loss_x 0.5005 (0.4308) acc_x 84.3750 (88.9583) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [5/17] time 0.353 (0.353) data 0.275 (0.275) loss_u loss_u 0.8936 (0.8808) acc_u 12.5000 (15.0000) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/17] time 0.352 (0.352) data 0.274 (0.275) loss_u loss_u 0.9272 (0.8666) acc_u 9.3750 (16.2500) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/17] time 0.370 (0.352) data 0.291 (0.274) loss_u loss_u 0.8086 (0.8552) acc_u 25.0000 (18.3333) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.6593, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1076
clean true:1075
clean false:1
clean_rate:0.9990706319702602
noisy true:339
noisy false:217
after delete: len(clean_dataset) 1076
after delete: len(noisy_dataset) 556
epoch [66/200] batch [5/33] time 0.357 (0.360) data 0.279 (0.282) loss_x loss_x 0.5952 (0.4154) acc_x 87.5000 (90.0000) lr 1.5358e-03 eta 0:00:10
epoch [66/200] batch [10/33] time 0.352 (0.355) data 0.274 (0.277) loss_x loss_x 0.4119 (0.3997) acc_x 87.5000 (90.0000) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [15/33] time 0.395 (0.357) data 0.317 (0.278) loss_x loss_x 0.5425 (0.4058) acc_x 93.7500 (90.6250) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [20/33] time 0.358 (0.356) data 0.280 (0.278) loss_x loss_x 0.3232 (0.3933) acc_x 90.6250 (90.9375) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [25/33] time 0.399 (0.358) data 0.320 (0.280) loss_x loss_x 0.3618 (0.3855) acc_x 93.7500 (90.8750) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [30/33] time 0.349 (0.356) data 0.271 (0.278) loss_x loss_x 0.1770 (0.4009) acc_x 96.8750 (90.7292) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [5/17] time 0.368 (0.355) data 0.290 (0.277) loss_u loss_u 0.8828 (0.8183) acc_u 12.5000 (21.2500) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/17] time 0.321 (0.352) data 0.243 (0.273) loss_u loss_u 0.8760 (0.8400) acc_u 12.5000 (18.7500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/17] time 0.310 (0.351) data 0.231 (0.273) loss_u loss_u 0.8442 (0.8410) acc_u 15.6250 (18.7500) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.6618, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1080
clean true:1079
clean false:1
clean_rate:0.9990740740740741
noisy true:335
noisy false:217
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 552
epoch [67/200] batch [5/33] time 0.342 (0.351) data 0.264 (0.273) loss_x loss_x 0.4495 (0.4025) acc_x 84.3750 (90.6250) lr 1.5225e-03 eta 0:00:09
epoch [67/200] batch [10/33] time 0.364 (0.352) data 0.286 (0.274) loss_x loss_x 0.4688 (0.4606) acc_x 84.3750 (87.1875) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [15/33] time 0.353 (0.355) data 0.276 (0.278) loss_x loss_x 0.2646 (0.4265) acc_x 93.7500 (88.7500) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [20/33] time 0.349 (0.353) data 0.271 (0.275) loss_x loss_x 0.3816 (0.4023) acc_x 87.5000 (89.2188) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [25/33] time 0.353 (0.350) data 0.275 (0.272) loss_x loss_x 0.3633 (0.4165) acc_x 93.7500 (89.0000) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [30/33] time 0.359 (0.350) data 0.281 (0.272) loss_x loss_x 0.3787 (0.4026) acc_x 87.5000 (89.5833) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [5/17] time 0.350 (0.351) data 0.272 (0.273) loss_u loss_u 0.7280 (0.8406) acc_u 31.2500 (17.5000) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/17] time 0.297 (0.347) data 0.219 (0.269) loss_u loss_u 0.8140 (0.8387) acc_u 25.0000 (18.4375) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/17] time 0.333 (0.344) data 0.254 (0.266) loss_u loss_u 0.8164 (0.8396) acc_u 25.0000 (18.5417) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 215
confident_label rate tensor(0.6673, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1089
clean true:1087
clean false:2
clean_rate:0.9981634527089073
noisy true:330
noisy false:213
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 543
epoch [68/200] batch [5/34] time 0.356 (0.351) data 0.279 (0.273) loss_x loss_x 0.5215 (0.4082) acc_x 87.5000 (91.2500) lr 1.5090e-03 eta 0:00:10
epoch [68/200] batch [10/34] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.4758 (0.4628) acc_x 84.3750 (88.4375) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [15/34] time 0.363 (0.351) data 0.285 (0.273) loss_x loss_x 0.2062 (0.3961) acc_x 96.8750 (90.2083) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [20/34] time 0.355 (0.352) data 0.276 (0.274) loss_x loss_x 0.1857 (0.3814) acc_x 100.0000 (90.9375) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [25/34] time 0.342 (0.352) data 0.265 (0.275) loss_x loss_x 0.4077 (0.3659) acc_x 87.5000 (91.1250) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [30/34] time 0.357 (0.352) data 0.279 (0.274) loss_x loss_x 0.2642 (0.3703) acc_x 96.8750 (90.9375) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [5/16] time 0.330 (0.352) data 0.251 (0.274) loss_u loss_u 0.9351 (0.8389) acc_u 6.2500 (18.7500) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/16] time 0.354 (0.352) data 0.275 (0.274) loss_u loss_u 0.8999 (0.8493) acc_u 15.6250 (17.8125) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/16] time 0.339 (0.348) data 0.260 (0.270) loss_u loss_u 0.9116 (0.8617) acc_u 12.5000 (16.6667) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1087
clean false:1
clean_rate:0.9990808823529411
noisy true:349
noisy false:195
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [69/200] batch [5/34] time 0.336 (0.365) data 0.258 (0.287) loss_x loss_x 0.6821 (0.3426) acc_x 84.3750 (93.1250) lr 1.4955e-03 eta 0:00:10
epoch [69/200] batch [10/34] time 0.338 (0.363) data 0.261 (0.285) loss_x loss_x 0.6460 (0.3594) acc_x 84.3750 (92.1875) lr 1.4955e-03 eta 0:00:08
epoch [69/200] batch [15/34] time 0.352 (0.361) data 0.274 (0.283) loss_x loss_x 0.3342 (0.3787) acc_x 96.8750 (92.0833) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [20/34] time 0.337 (0.356) data 0.259 (0.278) loss_x loss_x 0.4463 (0.3733) acc_x 90.6250 (92.1875) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [25/34] time 0.373 (0.357) data 0.295 (0.279) loss_x loss_x 0.2800 (0.4034) acc_x 93.7500 (91.0000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [30/34] time 0.346 (0.356) data 0.268 (0.278) loss_x loss_x 0.2300 (0.3930) acc_x 90.6250 (90.9375) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [5/17] time 0.360 (0.355) data 0.283 (0.277) loss_u loss_u 0.8096 (0.8215) acc_u 21.8750 (21.2500) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/17] time 0.355 (0.354) data 0.276 (0.276) loss_u loss_u 0.8965 (0.8370) acc_u 9.3750 (19.3750) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/17] time 0.311 (0.349) data 0.232 (0.271) loss_u loss_u 0.8413 (0.8511) acc_u 15.6250 (17.0833) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 193
confident_label rate tensor(0.6703, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1094
clean true:1092
clean false:2
clean_rate:0.9981718464351006
noisy true:347
noisy false:191
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 538
epoch [70/200] batch [5/34] time 0.352 (0.357) data 0.275 (0.280) loss_x loss_x 0.2717 (0.3542) acc_x 93.7500 (92.5000) lr 1.4818e-03 eta 0:00:10
epoch [70/200] batch [10/34] time 0.338 (0.354) data 0.260 (0.277) loss_x loss_x 0.3955 (0.3284) acc_x 90.6250 (92.5000) lr 1.4818e-03 eta 0:00:08
epoch [70/200] batch [15/34] time 0.364 (0.358) data 0.286 (0.280) loss_x loss_x 0.2681 (0.3197) acc_x 96.8750 (93.1250) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [20/34] time 0.362 (0.356) data 0.283 (0.278) loss_x loss_x 0.4348 (0.3337) acc_x 87.5000 (92.3438) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [25/34] time 0.348 (0.354) data 0.270 (0.276) loss_x loss_x 0.3452 (0.3483) acc_x 93.7500 (92.5000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [30/34] time 0.352 (0.354) data 0.273 (0.276) loss_x loss_x 0.1519 (0.3357) acc_x 96.8750 (93.0208) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [5/16] time 0.334 (0.354) data 0.255 (0.276) loss_u loss_u 0.9233 (0.8688) acc_u 9.3750 (15.6250) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/16] time 0.309 (0.350) data 0.231 (0.273) loss_u loss_u 0.8672 (0.8725) acc_u 15.6250 (15.3125) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/16] time 0.317 (0.348) data 0.238 (0.270) loss_u loss_u 0.8848 (0.8725) acc_u 12.5000 (15.0000) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 195
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1087
clean false:1
clean_rate:0.9990808823529411
noisy true:350
noisy false:194
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [71/200] batch [5/34] time 0.355 (0.360) data 0.276 (0.282) loss_x loss_x 0.5269 (0.4966) acc_x 84.3750 (87.5000) lr 1.4679e-03 eta 0:00:10
epoch [71/200] batch [10/34] time 0.345 (0.355) data 0.266 (0.276) loss_x loss_x 0.5371 (0.4522) acc_x 87.5000 (88.7500) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [15/34] time 0.349 (0.352) data 0.271 (0.274) loss_x loss_x 0.4341 (0.4525) acc_x 87.5000 (88.1250) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [20/34] time 0.363 (0.356) data 0.285 (0.277) loss_x loss_x 0.2089 (0.4079) acc_x 96.8750 (89.5312) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [25/34] time 0.358 (0.359) data 0.280 (0.281) loss_x loss_x 0.2220 (0.3816) acc_x 96.8750 (90.5000) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [30/34] time 0.346 (0.358) data 0.268 (0.280) loss_x loss_x 0.3518 (0.3707) acc_x 96.8750 (91.3542) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [5/17] time 0.364 (0.355) data 0.284 (0.277) loss_u loss_u 0.8901 (0.8362) acc_u 12.5000 (18.7500) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/17] time 0.339 (0.355) data 0.262 (0.277) loss_u loss_u 0.8975 (0.8636) acc_u 12.5000 (16.2500) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/17] time 0.341 (0.352) data 0.262 (0.274) loss_u loss_u 0.8428 (0.8596) acc_u 18.7500 (16.8750) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6697, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1093
clean true:1093
clean false:0
clean_rate:1.0
noisy true:347
noisy false:192
after delete: len(clean_dataset) 1093
after delete: len(noisy_dataset) 539
epoch [72/200] batch [5/34] time 0.374 (0.376) data 0.295 (0.297) loss_x loss_x 0.1425 (0.3473) acc_x 100.0000 (91.8750) lr 1.4540e-03 eta 0:00:10
epoch [72/200] batch [10/34] time 0.362 (0.368) data 0.284 (0.289) loss_x loss_x 0.4119 (0.3740) acc_x 81.2500 (90.6250) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [15/34] time 0.369 (0.367) data 0.291 (0.289) loss_x loss_x 0.2075 (0.3515) acc_x 96.8750 (91.6667) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [20/34] time 0.366 (0.364) data 0.288 (0.286) loss_x loss_x 0.3093 (0.3666) acc_x 93.7500 (91.4062) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [25/34] time 0.369 (0.363) data 0.291 (0.285) loss_x loss_x 0.1356 (0.3627) acc_x 96.8750 (91.6250) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [30/34] time 0.348 (0.361) data 0.269 (0.283) loss_x loss_x 0.1505 (0.3659) acc_x 96.8750 (91.3542) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [5/16] time 0.319 (0.353) data 0.241 (0.275) loss_u loss_u 0.8115 (0.8154) acc_u 21.8750 (21.2500) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/16] time 0.330 (0.349) data 0.251 (0.271) loss_u loss_u 0.8872 (0.8500) acc_u 12.5000 (18.1250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/16] time 0.340 (0.349) data 0.262 (0.271) loss_u loss_u 0.9297 (0.8663) acc_u 6.2500 (15.8333) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6703, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1094
clean true:1092
clean false:2
clean_rate:0.9981718464351006
noisy true:344
noisy false:194
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 538
epoch [73/200] batch [5/34] time 0.349 (0.359) data 0.271 (0.281) loss_x loss_x 0.5054 (0.3563) acc_x 90.6250 (93.1250) lr 1.4399e-03 eta 0:00:10
epoch [73/200] batch [10/34] time 0.341 (0.355) data 0.263 (0.277) loss_x loss_x 0.3853 (0.4129) acc_x 93.7500 (90.9375) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [15/34] time 0.359 (0.354) data 0.281 (0.276) loss_x loss_x 0.5161 (0.4408) acc_x 81.2500 (89.3750) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [20/34] time 0.402 (0.357) data 0.324 (0.279) loss_x loss_x 0.4077 (0.4258) acc_x 90.6250 (89.8438) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [25/34] time 0.372 (0.356) data 0.292 (0.278) loss_x loss_x 0.2524 (0.4133) acc_x 96.8750 (90.5000) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [30/34] time 0.301 (0.352) data 0.223 (0.274) loss_x loss_x 0.2097 (0.3910) acc_x 96.8750 (90.9375) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [5/16] time 0.348 (0.349) data 0.271 (0.271) loss_u loss_u 0.8608 (0.8100) acc_u 15.6250 (21.8750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/16] time 0.340 (0.349) data 0.262 (0.271) loss_u loss_u 0.8926 (0.8385) acc_u 12.5000 (18.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/16] time 0.326 (0.350) data 0.248 (0.272) loss_u loss_u 0.8906 (0.8580) acc_u 15.6250 (15.8333) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 201
confident_label rate tensor(0.6691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1092
clean true:1091
clean false:1
clean_rate:0.9990842490842491
noisy true:340
noisy false:200
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 540
epoch [74/200] batch [5/34] time 0.357 (0.355) data 0.279 (0.277) loss_x loss_x 0.4385 (0.3882) acc_x 84.3750 (90.0000) lr 1.4258e-03 eta 0:00:10
epoch [74/200] batch [10/34] time 0.350 (0.355) data 0.273 (0.278) loss_x loss_x 0.2290 (0.3737) acc_x 90.6250 (89.6875) lr 1.4258e-03 eta 0:00:08
epoch [74/200] batch [15/34] time 0.353 (0.354) data 0.275 (0.276) loss_x loss_x 0.3347 (0.3493) acc_x 93.7500 (91.2500) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [20/34] time 0.347 (0.354) data 0.269 (0.276) loss_x loss_x 0.3328 (0.3621) acc_x 93.7500 (91.4062) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [25/34] time 0.306 (0.350) data 0.228 (0.272) loss_x loss_x 0.2092 (0.3693) acc_x 96.8750 (91.3750) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [30/34] time 0.310 (0.347) data 0.232 (0.269) loss_x loss_x 0.3325 (0.3644) acc_x 93.7500 (91.7708) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [5/16] time 0.346 (0.339) data 0.268 (0.261) loss_u loss_u 0.9263 (0.8350) acc_u 12.5000 (19.3750) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/16] time 0.359 (0.341) data 0.281 (0.263) loss_u loss_u 0.9561 (0.8510) acc_u 3.1250 (17.1875) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/16] time 0.347 (0.341) data 0.268 (0.263) loss_u loss_u 0.8726 (0.8568) acc_u 12.5000 (16.6667) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.6679, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1090
clean true:1087
clean false:3
clean_rate:0.9972477064220183
noisy true:339
noisy false:203
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 542
epoch [75/200] batch [5/34] time 0.354 (0.341) data 0.277 (0.263) loss_x loss_x 0.4246 (0.3795) acc_x 93.7500 (91.8750) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [10/34] time 0.328 (0.341) data 0.250 (0.264) loss_x loss_x 0.2017 (0.3956) acc_x 96.8750 (91.8750) lr 1.4115e-03 eta 0:00:08
epoch [75/200] batch [15/34] time 0.353 (0.341) data 0.275 (0.263) loss_x loss_x 0.3210 (0.4023) acc_x 93.7500 (91.0417) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [20/34] time 0.352 (0.343) data 0.274 (0.265) loss_x loss_x 0.6875 (0.4116) acc_x 84.3750 (90.3125) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [25/34] time 0.341 (0.342) data 0.263 (0.264) loss_x loss_x 0.6045 (0.4242) acc_x 87.5000 (90.0000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [30/34] time 0.337 (0.343) data 0.259 (0.265) loss_x loss_x 0.4973 (0.4219) acc_x 84.3750 (89.7917) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [5/16] time 0.352 (0.342) data 0.274 (0.264) loss_u loss_u 0.9062 (0.8692) acc_u 9.3750 (16.2500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/16] time 0.348 (0.346) data 0.270 (0.268) loss_u loss_u 0.8311 (0.8681) acc_u 21.8750 (16.2500) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/16] time 0.352 (0.346) data 0.275 (0.268) loss_u loss_u 0.9077 (0.8576) acc_u 12.5000 (17.0833) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.6740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1100
clean true:1099
clean false:1
clean_rate:0.9990909090909091
noisy true:346
noisy false:186
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 532
epoch [76/200] batch [5/34] time 0.376 (0.366) data 0.298 (0.288) loss_x loss_x 0.3967 (0.3350) acc_x 90.6250 (93.1250) lr 1.3971e-03 eta 0:00:10
epoch [76/200] batch [10/34] time 0.348 (0.358) data 0.270 (0.280) loss_x loss_x 0.3052 (0.3338) acc_x 90.6250 (92.1875) lr 1.3971e-03 eta 0:00:08
epoch [76/200] batch [15/34] time 0.354 (0.355) data 0.276 (0.277) loss_x loss_x 0.3372 (0.3467) acc_x 96.8750 (92.2917) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [20/34] time 0.308 (0.349) data 0.231 (0.271) loss_x loss_x 0.2537 (0.3562) acc_x 93.7500 (91.7188) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [25/34] time 0.373 (0.351) data 0.295 (0.273) loss_x loss_x 0.3999 (0.3572) acc_x 93.7500 (92.0000) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [30/34] time 0.344 (0.352) data 0.266 (0.274) loss_x loss_x 0.2598 (0.3553) acc_x 96.8750 (91.8750) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [5/16] time 0.318 (0.344) data 0.238 (0.266) loss_u loss_u 0.9058 (0.8594) acc_u 12.5000 (17.5000) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/16] time 0.339 (0.343) data 0.260 (0.265) loss_u loss_u 0.8604 (0.8634) acc_u 15.6250 (16.5625) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/16] time 0.358 (0.343) data 0.280 (0.265) loss_u loss_u 0.8369 (0.8699) acc_u 21.8750 (15.2083) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1107
clean false:2
clean_rate:0.9981965734896303
noisy true:344
noisy false:179
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [77/200] batch [5/34] time 0.359 (0.361) data 0.282 (0.283) loss_x loss_x 0.2280 (0.3186) acc_x 96.8750 (93.7500) lr 1.3827e-03 eta 0:00:10
epoch [77/200] batch [10/34] time 0.362 (0.358) data 0.284 (0.280) loss_x loss_x 0.3474 (0.3206) acc_x 87.5000 (91.8750) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [15/34] time 0.352 (0.356) data 0.274 (0.277) loss_x loss_x 0.4890 (0.3492) acc_x 87.5000 (91.0417) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [20/34] time 0.356 (0.356) data 0.278 (0.278) loss_x loss_x 0.2382 (0.3454) acc_x 93.7500 (91.2500) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [25/34] time 0.359 (0.355) data 0.282 (0.277) loss_x loss_x 0.3657 (0.3466) acc_x 90.6250 (91.2500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [30/34] time 0.354 (0.355) data 0.276 (0.277) loss_x loss_x 0.4890 (0.3486) acc_x 87.5000 (91.4583) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [5/16] time 0.370 (0.351) data 0.291 (0.272) loss_u loss_u 0.8447 (0.8848) acc_u 18.7500 (14.3750) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/16] time 0.333 (0.350) data 0.255 (0.271) loss_u loss_u 0.9150 (0.8793) acc_u 9.3750 (14.3750) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/16] time 0.363 (0.350) data 0.284 (0.272) loss_u loss_u 0.9653 (0.8795) acc_u 3.1250 (15.0000) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 211
confident_label rate tensor(0.6679, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1090
clean true:1089
clean false:1
clean_rate:0.9990825688073395
noisy true:332
noisy false:210
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 542
epoch [78/200] batch [5/34] time 0.363 (0.377) data 0.284 (0.298) loss_x loss_x 0.6763 (0.4311) acc_x 87.5000 (91.8750) lr 1.3681e-03 eta 0:00:10
epoch [78/200] batch [10/34] time 0.386 (0.368) data 0.308 (0.289) loss_x loss_x 0.3354 (0.4132) acc_x 87.5000 (90.6250) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [15/34] time 0.383 (0.366) data 0.305 (0.288) loss_x loss_x 0.3188 (0.3846) acc_x 90.6250 (90.4167) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [20/34] time 0.353 (0.364) data 0.275 (0.286) loss_x loss_x 0.4463 (0.3893) acc_x 84.3750 (90.4688) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [25/34] time 0.347 (0.361) data 0.270 (0.283) loss_x loss_x 0.3555 (0.3880) acc_x 93.7500 (90.6250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [30/34] time 0.343 (0.358) data 0.265 (0.280) loss_x loss_x 0.3362 (0.3706) acc_x 84.3750 (90.8333) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [5/16] time 0.364 (0.355) data 0.286 (0.277) loss_u loss_u 0.7939 (0.8392) acc_u 21.8750 (18.1250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/16] time 0.320 (0.354) data 0.242 (0.276) loss_u loss_u 0.8145 (0.8388) acc_u 21.8750 (18.4375) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/16] time 0.294 (0.349) data 0.214 (0.271) loss_u loss_u 0.8770 (0.8541) acc_u 12.5000 (16.6667) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 194
confident_label rate tensor(0.6691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1092
clean true:1091
clean false:1
clean_rate:0.9990842490842491
noisy true:347
noisy false:193
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 540
epoch [79/200] batch [5/34] time 0.361 (0.364) data 0.283 (0.285) loss_x loss_x 0.3479 (0.3125) acc_x 93.7500 (91.8750) lr 1.3535e-03 eta 0:00:10
epoch [79/200] batch [10/34] time 0.346 (0.360) data 0.268 (0.281) loss_x loss_x 0.3806 (0.3110) acc_x 90.6250 (91.8750) lr 1.3535e-03 eta 0:00:08
epoch [79/200] batch [15/34] time 0.345 (0.355) data 0.267 (0.277) loss_x loss_x 0.7393 (0.3572) acc_x 81.2500 (90.6250) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [20/34] time 0.342 (0.354) data 0.264 (0.276) loss_x loss_x 0.4255 (0.3594) acc_x 90.6250 (90.6250) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [25/34] time 0.344 (0.353) data 0.267 (0.275) loss_x loss_x 0.2561 (0.3811) acc_x 90.6250 (90.2500) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [30/34] time 0.297 (0.348) data 0.220 (0.270) loss_x loss_x 0.3184 (0.3794) acc_x 90.6250 (90.4167) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [5/16] time 0.299 (0.344) data 0.221 (0.266) loss_u loss_u 0.8306 (0.8233) acc_u 18.7500 (21.8750) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/16] time 0.295 (0.340) data 0.216 (0.261) loss_u loss_u 0.9321 (0.8565) acc_u 9.3750 (17.5000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/16] time 0.349 (0.339) data 0.271 (0.260) loss_u loss_u 0.9077 (0.8539) acc_u 12.5000 (18.3333) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 180
confident_label rate tensor(0.6746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1101
clean true:1100
clean false:1
clean_rate:0.9990917347865577
noisy true:352
noisy false:179
after delete: len(clean_dataset) 1101
after delete: len(noisy_dataset) 531
epoch [80/200] batch [5/34] time 0.353 (0.362) data 0.275 (0.283) loss_x loss_x 0.1919 (0.3783) acc_x 96.8750 (90.6250) lr 1.3387e-03 eta 0:00:10
epoch [80/200] batch [10/34] time 0.377 (0.356) data 0.299 (0.278) loss_x loss_x 0.1960 (0.3348) acc_x 96.8750 (92.5000) lr 1.3387e-03 eta 0:00:08
epoch [80/200] batch [15/34] time 0.350 (0.351) data 0.272 (0.273) loss_x loss_x 0.2451 (0.3710) acc_x 96.8750 (92.2917) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [20/34] time 0.342 (0.349) data 0.264 (0.270) loss_x loss_x 0.5210 (0.3720) acc_x 81.2500 (91.7188) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [25/34] time 0.350 (0.348) data 0.272 (0.269) loss_x loss_x 0.6450 (0.3746) acc_x 81.2500 (91.6250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [30/34] time 0.342 (0.347) data 0.263 (0.269) loss_x loss_x 0.5005 (0.3776) acc_x 90.6250 (91.6667) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [5/16] time 0.347 (0.344) data 0.269 (0.266) loss_u loss_u 0.8535 (0.8764) acc_u 15.6250 (15.0000) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/16] time 0.357 (0.346) data 0.279 (0.267) loss_u loss_u 0.8335 (0.8770) acc_u 18.7500 (15.3125) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/16] time 0.341 (0.345) data 0.262 (0.267) loss_u loss_u 0.8306 (0.8747) acc_u 18.7500 (15.2083) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 160
confident_label rate tensor(0.6850, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1118
clean true:1117
clean false:1
clean_rate:0.9991055456171736
noisy true:355
noisy false:159
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 514
epoch [81/200] batch [5/34] time 0.344 (0.357) data 0.267 (0.278) loss_x loss_x 0.4556 (0.4487) acc_x 87.5000 (86.8750) lr 1.3239e-03 eta 0:00:10
epoch [81/200] batch [10/34] time 0.338 (0.353) data 0.261 (0.275) loss_x loss_x 0.4529 (0.4247) acc_x 84.3750 (88.4375) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [15/34] time 0.372 (0.354) data 0.295 (0.276) loss_x loss_x 0.2664 (0.4025) acc_x 96.8750 (89.7917) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [20/34] time 0.336 (0.353) data 0.258 (0.275) loss_x loss_x 0.3748 (0.3878) acc_x 87.5000 (90.1562) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [25/34] time 0.308 (0.346) data 0.230 (0.268) loss_x loss_x 0.3372 (0.4043) acc_x 93.7500 (90.5000) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [30/34] time 0.316 (0.341) data 0.239 (0.262) loss_x loss_x 0.2015 (0.3659) acc_x 100.0000 (91.8750) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [5/16] time 0.340 (0.340) data 0.261 (0.262) loss_u loss_u 0.8711 (0.8704) acc_u 15.6250 (16.2500) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/16] time 0.334 (0.340) data 0.255 (0.262) loss_u loss_u 0.8701 (0.8692) acc_u 15.6250 (15.3125) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/16] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9136 (0.8710) acc_u 9.3750 (15.2083) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 168
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1126
clean true:1124
clean false:2
clean_rate:0.9982238010657194
noisy true:340
noisy false:166
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 506
epoch [82/200] batch [5/35] time 0.344 (0.339) data 0.267 (0.262) loss_x loss_x 0.1735 (0.3433) acc_x 96.8750 (90.6250) lr 1.3090e-03 eta 0:00:10
epoch [82/200] batch [10/35] time 0.330 (0.337) data 0.253 (0.259) loss_x loss_x 0.2886 (0.3696) acc_x 93.7500 (90.3125) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [15/35] time 0.339 (0.341) data 0.262 (0.264) loss_x loss_x 0.3765 (0.3622) acc_x 90.6250 (91.2500) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [20/35] time 0.340 (0.342) data 0.262 (0.264) loss_x loss_x 0.5366 (0.3614) acc_x 87.5000 (91.2500) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [25/35] time 0.338 (0.341) data 0.261 (0.264) loss_x loss_x 0.4263 (0.3456) acc_x 78.1250 (91.2500) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [30/35] time 0.296 (0.337) data 0.217 (0.259) loss_x loss_x 0.3262 (0.3661) acc_x 93.7500 (90.7292) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [35/35] time 0.351 (0.334) data 0.274 (0.256) loss_x loss_x 0.4199 (0.3620) acc_x 93.7500 (91.0714) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/15] time 0.340 (0.334) data 0.263 (0.257) loss_u loss_u 0.9414 (0.9179) acc_u 6.2500 (10.0000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/15] time 0.324 (0.334) data 0.245 (0.256) loss_u loss_u 0.9282 (0.9163) acc_u 9.3750 (9.6875) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/15] time 0.341 (0.335) data 0.263 (0.257) loss_u loss_u 0.7959 (0.8919) acc_u 25.0000 (12.9167) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 193
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1099
clean false:3
clean_rate:0.9972776769509982
noisy true:340
noisy false:190
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [83/200] batch [5/34] time 0.356 (0.347) data 0.277 (0.269) loss_x loss_x 0.2358 (0.3593) acc_x 90.6250 (91.2500) lr 1.2940e-03 eta 0:00:10
epoch [83/200] batch [10/34] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.6187 (0.3457) acc_x 87.5000 (92.5000) lr 1.2940e-03 eta 0:00:08
epoch [83/200] batch [15/34] time 0.331 (0.342) data 0.254 (0.264) loss_x loss_x 0.1098 (0.2993) acc_x 96.8750 (93.7500) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [20/34] time 0.337 (0.341) data 0.259 (0.263) loss_x loss_x 0.1808 (0.2946) acc_x 96.8750 (93.7500) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [25/34] time 0.361 (0.342) data 0.283 (0.265) loss_x loss_x 0.3896 (0.3111) acc_x 90.6250 (93.3750) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [30/34] time 0.349 (0.343) data 0.272 (0.265) loss_x loss_x 0.2585 (0.3243) acc_x 93.7500 (93.2292) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [5/16] time 0.351 (0.340) data 0.273 (0.262) loss_u loss_u 0.8022 (0.8563) acc_u 21.8750 (16.2500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/16] time 0.336 (0.341) data 0.257 (0.263) loss_u loss_u 0.8301 (0.8511) acc_u 18.7500 (18.1250) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/16] time 0.377 (0.342) data 0.298 (0.264) loss_u loss_u 0.8721 (0.8660) acc_u 15.6250 (16.2500) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 178
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1109
clean false:0
clean_rate:1.0
noisy true:345
noisy false:178
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [84/200] batch [5/34] time 0.343 (0.342) data 0.266 (0.264) loss_x loss_x 0.3013 (0.3602) acc_x 93.7500 (92.5000) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [10/34] time 0.331 (0.343) data 0.254 (0.266) loss_x loss_x 0.3604 (0.3227) acc_x 87.5000 (92.8125) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [15/34] time 0.354 (0.344) data 0.277 (0.267) loss_x loss_x 0.3574 (0.3336) acc_x 93.7500 (92.7083) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [20/34] time 0.348 (0.344) data 0.270 (0.267) loss_x loss_x 0.1766 (0.3072) acc_x 96.8750 (93.4375) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [25/34] time 0.352 (0.345) data 0.274 (0.267) loss_x loss_x 0.2366 (0.2985) acc_x 93.7500 (93.8750) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [30/34] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.3850 (0.3014) acc_x 84.3750 (93.5417) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [5/16] time 0.311 (0.340) data 0.232 (0.262) loss_u loss_u 0.8379 (0.8522) acc_u 18.7500 (16.2500) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/16] time 0.344 (0.339) data 0.265 (0.262) loss_u loss_u 0.8413 (0.8554) acc_u 15.6250 (16.5625) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/16] time 0.341 (0.340) data 0.262 (0.262) loss_u loss_u 0.8979 (0.8677) acc_u 9.3750 (15.2083) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.6734, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1099
clean true:1098
clean false:1
clean_rate:0.9990900818926297
noisy true:343
noisy false:190
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 533
epoch [85/200] batch [5/34] time 0.328 (0.349) data 0.251 (0.271) loss_x loss_x 0.4719 (0.4154) acc_x 87.5000 (90.6250) lr 1.2639e-03 eta 0:00:10
epoch [85/200] batch [10/34] time 0.344 (0.350) data 0.266 (0.272) loss_x loss_x 0.7183 (0.4461) acc_x 87.5000 (90.3125) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [15/34] time 0.302 (0.341) data 0.224 (0.263) loss_x loss_x 0.3723 (0.4244) acc_x 90.6250 (90.4167) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [20/34] time 0.338 (0.342) data 0.260 (0.264) loss_x loss_x 0.3667 (0.3929) acc_x 87.5000 (90.9375) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [25/34] time 0.356 (0.342) data 0.278 (0.264) loss_x loss_x 0.2363 (0.3802) acc_x 100.0000 (91.5000) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [30/34] time 0.304 (0.340) data 0.226 (0.262) loss_x loss_x 0.1823 (0.3802) acc_x 93.7500 (91.3542) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [5/16] time 0.317 (0.340) data 0.240 (0.262) loss_u loss_u 0.8765 (0.8281) acc_u 15.6250 (20.6250) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/16] time 0.300 (0.337) data 0.221 (0.259) loss_u loss_u 0.8203 (0.8503) acc_u 21.8750 (18.7500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/16] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.8848 (0.8651) acc_u 15.6250 (16.6667) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 194
confident_label rate tensor(0.6703, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1094
clean true:1092
clean false:2
clean_rate:0.9981718464351006
noisy true:346
noisy false:192
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 538
epoch [86/200] batch [5/34] time 0.337 (0.343) data 0.260 (0.265) loss_x loss_x 0.2739 (0.2891) acc_x 96.8750 (93.7500) lr 1.2487e-03 eta 0:00:09
epoch [86/200] batch [10/34] time 0.337 (0.344) data 0.259 (0.266) loss_x loss_x 0.5137 (0.3406) acc_x 90.6250 (91.5625) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [15/34] time 0.326 (0.345) data 0.248 (0.268) loss_x loss_x 0.4907 (0.3434) acc_x 87.5000 (91.4583) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [20/34] time 0.343 (0.346) data 0.266 (0.269) loss_x loss_x 0.5356 (0.3437) acc_x 90.6250 (91.7188) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [25/34] time 0.335 (0.344) data 0.257 (0.266) loss_x loss_x 0.4209 (0.3374) acc_x 93.7500 (91.7500) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [30/34] time 0.296 (0.340) data 0.219 (0.262) loss_x loss_x 0.2255 (0.3365) acc_x 90.6250 (91.9792) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [5/16] time 0.353 (0.340) data 0.274 (0.262) loss_u loss_u 0.7725 (0.8475) acc_u 28.1250 (17.5000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/16] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.7559 (0.8349) acc_u 31.2500 (19.0625) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/16] time 0.296 (0.338) data 0.218 (0.261) loss_u loss_u 0.8735 (0.8477) acc_u 15.6250 (18.1250) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 178
confident_label rate tensor(0.6814, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1112
clean true:1112
clean false:0
clean_rate:1.0
noisy true:342
noisy false:178
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 520
epoch [87/200] batch [5/34] time 0.293 (0.333) data 0.215 (0.255) loss_x loss_x 0.3035 (0.2978) acc_x 93.7500 (93.7500) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [10/34] time 0.354 (0.323) data 0.276 (0.245) loss_x loss_x 0.5103 (0.3436) acc_x 93.7500 (93.1250) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [15/34] time 0.349 (0.333) data 0.271 (0.255) loss_x loss_x 0.2101 (0.3692) acc_x 96.8750 (92.0833) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [20/34] time 0.354 (0.337) data 0.277 (0.259) loss_x loss_x 0.3003 (0.3523) acc_x 90.6250 (92.3438) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [25/34] time 0.347 (0.339) data 0.269 (0.261) loss_x loss_x 0.2379 (0.3786) acc_x 93.7500 (91.8750) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [30/34] time 0.354 (0.340) data 0.275 (0.262) loss_x loss_x 0.2251 (0.3652) acc_x 93.7500 (91.9792) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [5/16] time 0.351 (0.342) data 0.273 (0.264) loss_u loss_u 0.8394 (0.8593) acc_u 21.8750 (16.8750) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/16] time 0.348 (0.342) data 0.270 (0.264) loss_u loss_u 0.9165 (0.8641) acc_u 9.3750 (15.9375) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/16] time 0.377 (0.347) data 0.299 (0.268) loss_u loss_u 0.8066 (0.8706) acc_u 18.7500 (15.4167) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6771, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1105
clean true:1103
clean false:2
clean_rate:0.9981900452488688
noisy true:333
noisy false:194
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 527
epoch [88/200] batch [5/34] time 0.381 (0.381) data 0.303 (0.303) loss_x loss_x 0.3130 (0.2594) acc_x 90.6250 (92.5000) lr 1.2181e-03 eta 0:00:11
epoch [88/200] batch [10/34] time 0.353 (0.366) data 0.275 (0.288) loss_x loss_x 0.6138 (0.3455) acc_x 81.2500 (90.3125) lr 1.2181e-03 eta 0:00:08
epoch [88/200] batch [15/34] time 0.344 (0.362) data 0.266 (0.285) loss_x loss_x 0.2966 (0.3500) acc_x 93.7500 (91.0417) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [20/34] time 0.330 (0.358) data 0.253 (0.280) loss_x loss_x 0.1287 (0.3231) acc_x 96.8750 (91.5625) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [25/34] time 0.335 (0.354) data 0.257 (0.276) loss_x loss_x 0.2991 (0.3334) acc_x 96.8750 (91.6250) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [30/34] time 0.342 (0.352) data 0.264 (0.274) loss_x loss_x 0.1487 (0.3314) acc_x 100.0000 (91.8750) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [5/16] time 0.333 (0.349) data 0.254 (0.271) loss_u loss_u 0.9194 (0.8433) acc_u 9.3750 (16.2500) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/16] time 0.354 (0.349) data 0.276 (0.271) loss_u loss_u 0.9409 (0.8733) acc_u 6.2500 (13.4375) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/16] time 0.351 (0.348) data 0.273 (0.270) loss_u loss_u 0.8018 (0.8655) acc_u 25.0000 (15.2083) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 161
confident_label rate tensor(0.6942, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1133
clean true:1131
clean false:2
clean_rate:0.9982347749338041
noisy true:340
noisy false:159
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 499
epoch [89/200] batch [5/35] time 0.409 (0.364) data 0.331 (0.286) loss_x loss_x 0.5098 (0.4019) acc_x 84.3750 (88.7500) lr 1.2028e-03 eta 0:00:10
epoch [89/200] batch [10/35] time 0.351 (0.375) data 0.273 (0.297) loss_x loss_x 0.3242 (0.3752) acc_x 90.6250 (90.0000) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [15/35] time 0.337 (0.366) data 0.259 (0.288) loss_x loss_x 0.8159 (0.3915) acc_x 84.3750 (90.4167) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [20/35] time 0.350 (0.357) data 0.271 (0.278) loss_x loss_x 0.2111 (0.3816) acc_x 100.0000 (91.0938) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [25/35] time 0.351 (0.356) data 0.273 (0.277) loss_x loss_x 0.4893 (0.3862) acc_x 90.6250 (90.8750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [30/35] time 0.332 (0.352) data 0.254 (0.274) loss_x loss_x 0.6504 (0.3989) acc_x 81.2500 (90.2083) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [35/35] time 0.343 (0.352) data 0.264 (0.274) loss_x loss_x 0.3884 (0.3911) acc_x 90.6250 (90.5357) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/15] time 0.351 (0.351) data 0.273 (0.273) loss_u loss_u 0.8447 (0.8676) acc_u 18.7500 (15.6250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/15] time 0.336 (0.350) data 0.257 (0.272) loss_u loss_u 0.8823 (0.8731) acc_u 12.5000 (15.3125) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/15] time 0.348 (0.350) data 0.268 (0.272) loss_u loss_u 0.8755 (0.8944) acc_u 15.6250 (12.9167) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 147
confident_label rate tensor(0.6955, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1135
clean true:1133
clean false:2
clean_rate:0.9982378854625551
noisy true:352
noisy false:145
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 497
epoch [90/200] batch [5/35] time 0.311 (0.314) data 0.233 (0.236) loss_x loss_x 0.6870 (0.3213) acc_x 81.2500 (93.1250) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [10/35] time 0.337 (0.329) data 0.259 (0.252) loss_x loss_x 0.3440 (0.3588) acc_x 87.5000 (90.6250) lr 1.1874e-03 eta 0:00:08
epoch [90/200] batch [15/35] time 0.359 (0.333) data 0.281 (0.255) loss_x loss_x 0.4402 (0.3708) acc_x 87.5000 (91.0417) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [20/35] time 0.346 (0.338) data 0.269 (0.260) loss_x loss_x 0.4236 (0.3581) acc_x 90.6250 (91.0938) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [25/35] time 0.337 (0.337) data 0.259 (0.259) loss_x loss_x 0.2898 (0.3503) acc_x 96.8750 (91.7500) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [30/35] time 0.346 (0.338) data 0.269 (0.260) loss_x loss_x 0.2654 (0.3561) acc_x 90.6250 (91.4583) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [35/35] time 0.341 (0.339) data 0.264 (0.261) loss_x loss_x 0.3723 (0.3513) acc_x 96.8750 (91.7857) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/15] time 0.348 (0.339) data 0.270 (0.261) loss_u loss_u 0.8867 (0.8870) acc_u 12.5000 (12.5000) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/15] time 0.354 (0.339) data 0.276 (0.261) loss_u loss_u 0.9766 (0.8985) acc_u 0.0000 (12.1875) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/15] time 0.343 (0.340) data 0.265 (0.262) loss_u loss_u 0.8872 (0.8920) acc_u 9.3750 (12.7083) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 180
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1110
clean true:1109
clean false:1
clean_rate:0.9990990990990991
noisy true:343
noisy false:179
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 522
epoch [91/200] batch [5/34] time 0.340 (0.332) data 0.261 (0.254) loss_x loss_x 0.1667 (0.2738) acc_x 100.0000 (95.0000) lr 1.1719e-03 eta 0:00:09
epoch [91/200] batch [10/34] time 0.375 (0.339) data 0.297 (0.261) loss_x loss_x 0.4099 (0.2943) acc_x 87.5000 (93.4375) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [15/34] time 0.359 (0.348) data 0.281 (0.269) loss_x loss_x 0.2876 (0.2993) acc_x 93.7500 (93.5417) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [20/34] time 0.359 (0.353) data 0.281 (0.275) loss_x loss_x 0.3018 (0.3035) acc_x 93.7500 (93.4375) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [25/34] time 0.407 (0.359) data 0.328 (0.281) loss_x loss_x 0.3115 (0.3034) acc_x 93.7500 (93.6250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [30/34] time 0.374 (0.364) data 0.296 (0.286) loss_x loss_x 0.7075 (0.3223) acc_x 81.2500 (93.1250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [5/16] time 0.351 (0.363) data 0.273 (0.285) loss_u loss_u 0.9365 (0.8855) acc_u 6.2500 (13.1250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/16] time 0.368 (0.362) data 0.291 (0.284) loss_u loss_u 0.8535 (0.8665) acc_u 18.7500 (15.0000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/16] time 0.367 (0.363) data 0.288 (0.285) loss_u loss_u 0.9214 (0.8836) acc_u 12.5000 (13.5417) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 193
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1100
clean false:2
clean_rate:0.9981851179673321
noisy true:339
noisy false:191
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [92/200] batch [5/34] time 0.298 (0.335) data 0.220 (0.257) loss_x loss_x 0.4861 (0.4008) acc_x 87.5000 (91.8750) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [10/34] time 0.360 (0.329) data 0.283 (0.250) loss_x loss_x 0.3823 (0.4263) acc_x 87.5000 (89.3750) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [15/34] time 0.352 (0.336) data 0.274 (0.258) loss_x loss_x 0.4648 (0.4166) acc_x 90.6250 (90.2083) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [20/34] time 0.344 (0.337) data 0.267 (0.259) loss_x loss_x 0.5620 (0.4064) acc_x 84.3750 (90.1562) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [25/34] time 0.346 (0.338) data 0.269 (0.260) loss_x loss_x 0.4412 (0.3896) acc_x 93.7500 (90.8750) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [30/34] time 0.346 (0.340) data 0.269 (0.263) loss_x loss_x 0.2864 (0.3760) acc_x 96.8750 (90.9375) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [5/16] time 0.359 (0.343) data 0.281 (0.265) loss_u loss_u 0.9077 (0.8780) acc_u 9.3750 (14.3750) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/16] time 0.343 (0.344) data 0.265 (0.266) loss_u loss_u 0.9136 (0.8739) acc_u 9.3750 (15.0000) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/16] time 0.355 (0.345) data 0.278 (0.268) loss_u loss_u 0.7964 (0.8713) acc_u 21.8750 (15.2083) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 159
confident_label rate tensor(0.6869, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1121
clean true:1121
clean false:0
clean_rate:1.0
noisy true:352
noisy false:159
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 511
epoch [93/200] batch [5/35] time 0.358 (0.320) data 0.281 (0.242) loss_x loss_x 0.3506 (0.2924) acc_x 93.7500 (95.0000) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [10/35] time 0.336 (0.333) data 0.258 (0.256) loss_x loss_x 0.1572 (0.3003) acc_x 96.8750 (94.3750) lr 1.1409e-03 eta 0:00:08
epoch [93/200] batch [15/35] time 0.343 (0.337) data 0.266 (0.259) loss_x loss_x 0.4192 (0.3185) acc_x 90.6250 (93.3333) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [20/35] time 0.330 (0.338) data 0.253 (0.260) loss_x loss_x 0.6138 (0.3358) acc_x 81.2500 (92.6562) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [25/35] time 0.351 (0.340) data 0.274 (0.262) loss_x loss_x 0.2881 (0.3207) acc_x 93.7500 (93.2500) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [30/35] time 0.341 (0.340) data 0.264 (0.263) loss_x loss_x 0.5010 (0.3391) acc_x 90.6250 (92.8125) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [35/35] time 0.338 (0.341) data 0.260 (0.264) loss_x loss_x 0.6079 (0.3510) acc_x 87.5000 (92.5000) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/15] time 0.353 (0.343) data 0.275 (0.265) loss_u loss_u 0.8828 (0.8611) acc_u 15.6250 (17.5000) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/15] time 0.336 (0.343) data 0.257 (0.265) loss_u loss_u 0.9272 (0.8798) acc_u 9.3750 (15.0000) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/15] time 0.375 (0.344) data 0.296 (0.266) loss_u loss_u 0.9429 (0.8851) acc_u 6.2500 (13.7500) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 168
confident_label rate tensor(0.6850, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1118
clean true:1117
clean false:1
clean_rate:0.9991055456171736
noisy true:347
noisy false:167
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 514
epoch [94/200] batch [5/34] time 0.301 (0.305) data 0.223 (0.227) loss_x loss_x 0.3899 (0.3563) acc_x 90.6250 (90.0000) lr 1.1253e-03 eta 0:00:08
epoch [94/200] batch [10/34] time 0.337 (0.319) data 0.259 (0.241) loss_x loss_x 0.2025 (0.3646) acc_x 96.8750 (91.5625) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [15/34] time 0.358 (0.331) data 0.281 (0.253) loss_x loss_x 0.2480 (0.3319) acc_x 93.7500 (92.2917) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [20/34] time 0.333 (0.334) data 0.256 (0.256) loss_x loss_x 0.1982 (0.3228) acc_x 96.8750 (92.3438) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [25/34] time 0.343 (0.336) data 0.265 (0.258) loss_x loss_x 0.3601 (0.3397) acc_x 93.7500 (91.8750) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [30/34] time 0.330 (0.337) data 0.253 (0.259) loss_x loss_x 0.3423 (0.3545) acc_x 90.6250 (91.3542) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [5/16] time 0.348 (0.338) data 0.271 (0.261) loss_u loss_u 0.8594 (0.8788) acc_u 15.6250 (15.6250) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/16] time 0.340 (0.338) data 0.262 (0.260) loss_u loss_u 0.9395 (0.8774) acc_u 9.3750 (15.3125) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/16] time 0.334 (0.339) data 0.256 (0.261) loss_u loss_u 0.8242 (0.8698) acc_u 18.7500 (15.6250) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 185
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1107
clean false:2
clean_rate:0.9981965734896303
noisy true:340
noisy false:183
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [95/200] batch [5/34] time 0.324 (0.339) data 0.245 (0.261) loss_x loss_x 0.5347 (0.3661) acc_x 84.3750 (90.6250) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [10/34] time 0.353 (0.337) data 0.275 (0.260) loss_x loss_x 0.3833 (0.4127) acc_x 96.8750 (90.9375) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [15/34] time 0.323 (0.336) data 0.245 (0.258) loss_x loss_x 0.1801 (0.3665) acc_x 93.7500 (91.8750) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [20/34] time 0.406 (0.342) data 0.329 (0.264) loss_x loss_x 0.4001 (0.3740) acc_x 90.6250 (91.4062) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [25/34] time 0.361 (0.349) data 0.283 (0.271) loss_x loss_x 0.1934 (0.3590) acc_x 96.8750 (91.1250) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [30/34] time 0.360 (0.348) data 0.282 (0.270) loss_x loss_x 0.3398 (0.3578) acc_x 96.8750 (91.4583) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [5/16] time 0.371 (0.352) data 0.293 (0.274) loss_u loss_u 0.8564 (0.8502) acc_u 15.6250 (16.2500) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/16] time 0.397 (0.355) data 0.318 (0.277) loss_u loss_u 0.8994 (0.8590) acc_u 12.5000 (15.9375) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/16] time 0.347 (0.358) data 0.268 (0.280) loss_u loss_u 0.8506 (0.8601) acc_u 15.6250 (15.8333) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 161
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1123
clean true:1122
clean false:1
clean_rate:0.9991095280498664
noisy true:349
noisy false:160
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 509
epoch [96/200] batch [5/35] time 0.337 (0.342) data 0.260 (0.265) loss_x loss_x 0.2120 (0.3627) acc_x 93.7500 (91.2500) lr 1.0941e-03 eta 0:00:10
epoch [96/200] batch [10/35] time 0.328 (0.334) data 0.251 (0.257) loss_x loss_x 0.1932 (0.3522) acc_x 96.8750 (92.1875) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [15/35] time 0.347 (0.334) data 0.270 (0.257) loss_x loss_x 0.2544 (0.3481) acc_x 93.7500 (91.6667) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [20/35] time 0.306 (0.334) data 0.229 (0.256) loss_x loss_x 0.2072 (0.3293) acc_x 93.7500 (92.3438) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [25/35] time 0.341 (0.331) data 0.263 (0.253) loss_x loss_x 0.4158 (0.3426) acc_x 87.5000 (92.0000) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [30/35] time 0.304 (0.330) data 0.227 (0.252) loss_x loss_x 0.3765 (0.3475) acc_x 90.6250 (91.7708) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [35/35] time 0.327 (0.330) data 0.250 (0.252) loss_x loss_x 0.2812 (0.3430) acc_x 93.7500 (92.2321) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/15] time 0.325 (0.331) data 0.248 (0.254) loss_u loss_u 0.9062 (0.9026) acc_u 12.5000 (11.2500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/15] time 0.359 (0.333) data 0.280 (0.255) loss_u loss_u 0.9429 (0.9087) acc_u 6.2500 (10.6250) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/15] time 0.338 (0.334) data 0.260 (0.256) loss_u loss_u 0.7969 (0.8919) acc_u 25.0000 (12.2917) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 188
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1101
clean false:2
clean_rate:0.9981867633726201
noisy true:343
noisy false:186
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [97/200] batch [5/34] time 0.364 (0.351) data 0.286 (0.273) loss_x loss_x 0.2756 (0.3941) acc_x 90.6250 (91.2500) lr 1.0785e-03 eta 0:00:10
epoch [97/200] batch [10/34] time 0.410 (0.369) data 0.330 (0.291) loss_x loss_x 0.3564 (0.3921) acc_x 90.6250 (91.2500) lr 1.0785e-03 eta 0:00:08
epoch [97/200] batch [15/34] time 0.345 (0.374) data 0.267 (0.296) loss_x loss_x 0.2573 (0.3380) acc_x 93.7500 (92.7083) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [20/34] time 0.389 (0.378) data 0.311 (0.300) loss_x loss_x 0.4006 (0.3295) acc_x 96.8750 (92.9688) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [25/34] time 0.363 (0.375) data 0.286 (0.297) loss_x loss_x 0.3276 (0.3336) acc_x 93.7500 (92.6250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [30/34] time 0.316 (0.366) data 0.238 (0.288) loss_x loss_x 0.1472 (0.3176) acc_x 96.8750 (92.8125) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [5/16] time 0.347 (0.361) data 0.270 (0.283) loss_u loss_u 0.9136 (0.8372) acc_u 6.2500 (18.1250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/16] time 0.326 (0.358) data 0.248 (0.280) loss_u loss_u 0.8228 (0.8530) acc_u 18.7500 (17.1875) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/16] time 0.354 (0.357) data 0.276 (0.279) loss_u loss_u 0.9336 (0.8640) acc_u 9.3750 (15.6250) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 169
confident_label rate tensor(0.6857, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1119
clean true:1118
clean false:1
clean_rate:0.9991063449508489
noisy true:345
noisy false:168
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 513
epoch [98/200] batch [5/34] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.4287 (0.4058) acc_x 84.3750 (88.7500) lr 1.0628e-03 eta 0:00:10
epoch [98/200] batch [10/34] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.3264 (0.3572) acc_x 96.8750 (91.5625) lr 1.0628e-03 eta 0:00:08
epoch [98/200] batch [15/34] time 0.334 (0.343) data 0.257 (0.266) loss_x loss_x 0.2322 (0.3226) acc_x 96.8750 (93.1250) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [20/34] time 0.334 (0.342) data 0.256 (0.264) loss_x loss_x 0.3855 (0.3050) acc_x 90.6250 (93.4375) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [25/34] time 0.356 (0.341) data 0.278 (0.263) loss_x loss_x 0.4312 (0.3109) acc_x 93.7500 (93.0000) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [30/34] time 0.308 (0.334) data 0.230 (0.256) loss_x loss_x 0.2542 (0.3089) acc_x 90.6250 (92.9167) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [5/16] time 0.350 (0.335) data 0.271 (0.257) loss_u loss_u 0.8066 (0.8853) acc_u 25.0000 (13.7500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/16] time 0.362 (0.338) data 0.283 (0.260) loss_u loss_u 0.8809 (0.8820) acc_u 15.6250 (14.0625) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/16] time 0.397 (0.342) data 0.319 (0.265) loss_u loss_u 0.8926 (0.8755) acc_u 12.5000 (15.2083) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6814, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1112
clean true:1110
clean false:2
clean_rate:0.9982014388489209
noisy true:341
noisy false:179
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 520
epoch [99/200] batch [5/34] time 0.362 (0.367) data 0.285 (0.289) loss_x loss_x 0.2605 (0.3325) acc_x 93.7500 (90.6250) lr 1.0471e-03 eta 0:00:10
epoch [99/200] batch [10/34] time 0.331 (0.361) data 0.254 (0.283) loss_x loss_x 0.1858 (0.2730) acc_x 96.8750 (93.4375) lr 1.0471e-03 eta 0:00:08
epoch [99/200] batch [15/34] time 0.364 (0.358) data 0.286 (0.281) loss_x loss_x 0.4822 (0.2878) acc_x 93.7500 (94.3750) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [20/34] time 0.347 (0.358) data 0.269 (0.281) loss_x loss_x 0.2335 (0.2961) acc_x 96.8750 (94.3750) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [25/34] time 0.342 (0.357) data 0.265 (0.279) loss_x loss_x 0.2288 (0.3070) acc_x 93.7500 (93.6250) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [30/34] time 0.303 (0.354) data 0.224 (0.276) loss_x loss_x 0.3660 (0.3040) acc_x 87.5000 (93.5417) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [5/16] time 0.337 (0.349) data 0.259 (0.271) loss_u loss_u 0.8086 (0.8496) acc_u 18.7500 (16.8750) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/16] time 0.309 (0.347) data 0.231 (0.269) loss_u loss_u 0.9077 (0.8694) acc_u 12.5000 (15.0000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/16] time 0.360 (0.348) data 0.283 (0.270) loss_u loss_u 0.8438 (0.8664) acc_u 15.6250 (15.4167) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 170
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1122
clean true:1122
clean false:0
clean_rate:1.0
noisy true:340
noisy false:170
all clean rate:  [0.9929078014184397, 0.9936575052854123, 0.9943502824858758, 0.998567335243553, 0.9945280437756497, 0.9960629921259843, 0.9974522292993631, 0.9937655860349127, 0.9950980392156863, 0.9951100244498777, 0.992, 0.9977116704805492, 0.9955106621773289, 0.9977064220183486, 0.9966740576496674, 0.9955849889624724, 0.9923413566739606, 0.9946120689655172, 0.9923830250272034, 0.9937759336099585, 0.9913606911447084, 0.9934924078091106, 0.9968421052631579, 0.99375, 0.9958376690946931, 0.9968717413972888, 0.9968051118210862, 0.9969199178644764, 0.9969262295081968, 0.991701244813278, 0.9930278884462151, 0.9909729187562688, 0.9928205128205129, 0.9919354838709677, 0.9919354838709677, 0.9949392712550608, 0.9920079920079921, 0.9920398009950249, 0.99800796812749, 0.9939516129032258, 0.9970501474926253, 0.9960591133004926, 0.9941747572815534, 0.9931840311587147, 0.9923371647509579, 0.9913875598086125, 0.9970384995064165, 0.9952153110047847, 0.9932432432432432, 0.9951267056530214, 0.9932692307692308, 0.9961501443695862, 0.9951503394762367, 0.9972196478220574, 0.9952471482889734, 0.997164461247637, 0.9990654205607477, 0.99812734082397, 0.9963235294117647, 0.9962721342031687, 0.9990583804143126, 0.998139534883721, 0.9981768459434822, 0.9990654205607477, 0.9990610328638497, 0.9990706319702602, 0.9990740740740741, 0.9981634527089073, 0.9990808823529411, 0.9981718464351006, 0.9990808823529411, 1.0, 0.9981718464351006, 0.9990842490842491, 0.9972477064220183, 0.9990909090909091, 0.9981965734896303, 0.9990825688073395, 0.9990842490842491, 0.9990917347865577, 0.9991055456171736, 0.9982238010657194, 0.9972776769509982, 1.0, 0.9990900818926297, 0.9981718464351006, 1.0, 0.9981900452488688, 0.9982347749338041, 0.9982378854625551, 0.9990990990990991, 0.9981851179673321, 1.0, 0.9991055456171736, 0.9981965734896303, 0.9991095280498664, 0.9981867633726201, 0.9991063449508489, 0.9982014388489209, 1.0]
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 510
epoch [100/200] batch [5/35] time 0.364 (0.356) data 0.286 (0.278) loss_x loss_x 0.4124 (0.4644) acc_x 93.7500 (88.7500) lr 1.0314e-03 eta 0:00:10
epoch [100/200] batch [10/35] time 0.398 (0.355) data 0.320 (0.277) loss_x loss_x 0.3428 (0.3898) acc_x 90.6250 (90.3125) lr 1.0314e-03 eta 0:00:08
epoch [100/200] batch [15/35] time 0.350 (0.352) data 0.272 (0.274) loss_x loss_x 0.2776 (0.3975) acc_x 96.8750 (90.6250) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [20/35] time 0.402 (0.354) data 0.324 (0.276) loss_x loss_x 0.2382 (0.3575) acc_x 96.8750 (91.7188) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [25/35] time 0.377 (0.361) data 0.299 (0.283) loss_x loss_x 0.5615 (0.3596) acc_x 90.6250 (92.1250) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [30/35] time 0.299 (0.356) data 0.221 (0.278) loss_x loss_x 0.3765 (0.3546) acc_x 90.6250 (92.1875) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [35/35] time 0.360 (0.354) data 0.282 (0.276) loss_x loss_x 0.3633 (0.3575) acc_x 87.5000 (91.8750) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/15] time 0.363 (0.357) data 0.285 (0.279) loss_u loss_u 0.8037 (0.8652) acc_u 25.0000 (15.0000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/15] time 0.381 (0.357) data 0.301 (0.279) loss_u loss_u 0.8975 (0.8770) acc_u 9.3750 (14.0625) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/15] time 0.378 (0.358) data 0.299 (0.280) loss_u loss_u 0.8931 (0.8851) acc_u 12.5000 (13.1250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1107
clean false:1
clean_rate:0.9990974729241877
noisy true:335
noisy false:189
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [101/200] batch [5/34] time 0.352 (0.351) data 0.274 (0.273) loss_x loss_x 0.5356 (0.4173) acc_x 87.5000 (90.6250) lr 1.0157e-03 eta 0:00:10
epoch [101/200] batch [10/34] time 0.345 (0.350) data 0.268 (0.272) loss_x loss_x 0.4172 (0.3534) acc_x 90.6250 (91.5625) lr 1.0157e-03 eta 0:00:08
epoch [101/200] batch [15/34] time 0.345 (0.345) data 0.267 (0.268) loss_x loss_x 0.3254 (0.3315) acc_x 90.6250 (92.2917) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [20/34] time 0.360 (0.347) data 0.282 (0.270) loss_x loss_x 0.1755 (0.3109) acc_x 96.8750 (93.1250) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [25/34] time 0.305 (0.343) data 0.227 (0.265) loss_x loss_x 0.1880 (0.3210) acc_x 93.7500 (93.0000) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [30/34] time 0.367 (0.342) data 0.289 (0.264) loss_x loss_x 0.3696 (0.3089) acc_x 90.6250 (93.3333) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [5/16] time 0.407 (0.352) data 0.328 (0.274) loss_u loss_u 0.9268 (0.8964) acc_u 9.3750 (12.5000) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/16] time 0.332 (0.353) data 0.254 (0.275) loss_u loss_u 0.8555 (0.8724) acc_u 15.6250 (14.6875) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/16] time 0.341 (0.353) data 0.262 (0.275) loss_u loss_u 0.8262 (0.8750) acc_u 21.8750 (15.2083) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 149
confident_label rate tensor(0.6949, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1134
clean true:1133
clean false:1
clean_rate:0.9991181657848325
noisy true:350
noisy false:148
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 498
epoch [102/200] batch [5/35] time 0.345 (0.351) data 0.267 (0.274) loss_x loss_x 0.3708 (0.2874) acc_x 90.6250 (94.3750) lr 1.0000e-03 eta 0:00:10
epoch [102/200] batch [10/35] time 0.339 (0.347) data 0.261 (0.269) loss_x loss_x 0.2101 (0.2970) acc_x 90.6250 (92.8125) lr 1.0000e-03 eta 0:00:08
epoch [102/200] batch [15/35] time 0.344 (0.344) data 0.267 (0.266) loss_x loss_x 0.1735 (0.2647) acc_x 96.8750 (94.1667) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [20/35] time 0.330 (0.341) data 0.253 (0.264) loss_x loss_x 0.4812 (0.3041) acc_x 90.6250 (93.4375) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [25/35] time 0.297 (0.335) data 0.218 (0.257) loss_x loss_x 0.2664 (0.3084) acc_x 100.0000 (93.6250) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [30/35] time 0.344 (0.333) data 0.267 (0.255) loss_x loss_x 0.2639 (0.2954) acc_x 93.7500 (93.8542) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [35/35] time 0.339 (0.335) data 0.262 (0.257) loss_x loss_x 0.1766 (0.3036) acc_x 100.0000 (93.4821) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/15] time 0.347 (0.336) data 0.269 (0.258) loss_u loss_u 0.9082 (0.9163) acc_u 9.3750 (10.6250) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/15] time 0.347 (0.337) data 0.269 (0.259) loss_u loss_u 0.8794 (0.8947) acc_u 12.5000 (12.5000) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/15] time 0.412 (0.339) data 0.333 (0.261) loss_u loss_u 0.9126 (0.8935) acc_u 9.3750 (12.5000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 174
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1108
clean false:1
clean_rate:0.9990982867448152
noisy true:350
noisy false:173
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [103/200] batch [5/34] time 0.335 (0.343) data 0.256 (0.265) loss_x loss_x 0.3965 (0.3966) acc_x 90.6250 (91.2500) lr 9.8429e-04 eta 0:00:09
epoch [103/200] batch [10/34] time 0.329 (0.340) data 0.251 (0.262) loss_x loss_x 0.2336 (0.3584) acc_x 93.7500 (92.5000) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [15/34] time 0.326 (0.339) data 0.248 (0.261) loss_x loss_x 0.4124 (0.3489) acc_x 90.6250 (92.7083) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [20/34] time 0.347 (0.341) data 0.270 (0.263) loss_x loss_x 0.5249 (0.3628) acc_x 84.3750 (91.8750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [25/34] time 0.299 (0.337) data 0.222 (0.259) loss_x loss_x 0.4688 (0.3692) acc_x 93.7500 (91.6250) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [30/34] time 0.338 (0.332) data 0.260 (0.255) loss_x loss_x 0.2681 (0.3511) acc_x 90.6250 (91.6667) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [5/16] time 0.348 (0.335) data 0.269 (0.257) loss_u loss_u 0.9116 (0.8896) acc_u 9.3750 (13.1250) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/16] time 0.346 (0.337) data 0.268 (0.259) loss_u loss_u 0.8760 (0.8788) acc_u 12.5000 (14.0625) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/16] time 0.345 (0.338) data 0.267 (0.260) loss_u loss_u 0.8550 (0.8634) acc_u 15.6250 (16.2500) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 175
confident_label rate tensor(0.6814, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1112
clean true:1112
clean false:0
clean_rate:1.0
noisy true:345
noisy false:175
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 520
epoch [104/200] batch [5/34] time 0.346 (0.348) data 0.268 (0.270) loss_x loss_x 0.2448 (0.2963) acc_x 93.7500 (91.2500) lr 9.6859e-04 eta 0:00:10
epoch [104/200] batch [10/34] time 0.337 (0.347) data 0.260 (0.269) loss_x loss_x 0.4055 (0.3313) acc_x 93.7500 (91.8750) lr 9.6859e-04 eta 0:00:08
epoch [104/200] batch [15/34] time 0.331 (0.341) data 0.254 (0.264) loss_x loss_x 0.5322 (0.3413) acc_x 87.5000 (92.5000) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [20/34] time 0.340 (0.341) data 0.262 (0.264) loss_x loss_x 0.1185 (0.3338) acc_x 96.8750 (92.1875) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [25/34] time 0.325 (0.340) data 0.248 (0.263) loss_x loss_x 0.4180 (0.3354) acc_x 90.6250 (92.2500) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [30/34] time 0.302 (0.335) data 0.224 (0.257) loss_x loss_x 0.2622 (0.3246) acc_x 93.7500 (92.5000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [5/16] time 0.347 (0.336) data 0.270 (0.258) loss_u loss_u 0.9043 (0.9005) acc_u 12.5000 (12.5000) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/16] time 0.337 (0.337) data 0.259 (0.259) loss_u loss_u 0.8550 (0.8686) acc_u 15.6250 (16.2500) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/16] time 0.349 (0.338) data 0.271 (0.260) loss_u loss_u 0.8447 (0.8600) acc_u 18.7500 (17.5000) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 166
confident_label rate tensor(0.6808, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1111
clean true:1111
clean false:0
clean_rate:1.0
noisy true:355
noisy false:166
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 521
epoch [105/200] batch [5/34] time 0.348 (0.369) data 0.271 (0.292) loss_x loss_x 0.2069 (0.3142) acc_x 96.8750 (95.0000) lr 9.5289e-04 eta 0:00:10
epoch [105/200] batch [10/34] time 0.316 (0.353) data 0.239 (0.275) loss_x loss_x 0.4846 (0.3273) acc_x 87.5000 (93.7500) lr 9.5289e-04 eta 0:00:08
epoch [105/200] batch [15/34] time 0.343 (0.348) data 0.266 (0.270) loss_x loss_x 0.4880 (0.3322) acc_x 87.5000 (93.1250) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [20/34] time 0.347 (0.345) data 0.269 (0.268) loss_x loss_x 0.3660 (0.3305) acc_x 90.6250 (92.5000) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [25/34] time 0.437 (0.350) data 0.358 (0.272) loss_x loss_x 0.4646 (0.3284) acc_x 90.6250 (92.0000) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [30/34] time 0.353 (0.357) data 0.275 (0.280) loss_x loss_x 0.3701 (0.3308) acc_x 90.6250 (92.0833) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [5/16] time 0.363 (0.356) data 0.285 (0.278) loss_u loss_u 0.9102 (0.8802) acc_u 9.3750 (15.0000) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/16] time 0.383 (0.357) data 0.305 (0.279) loss_u loss_u 0.9126 (0.8707) acc_u 9.3750 (15.3125) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/16] time 0.350 (0.359) data 0.272 (0.280) loss_u loss_u 0.8540 (0.8711) acc_u 18.7500 (15.6250) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 165
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1123
clean true:1122
clean false:1
clean_rate:0.9991095280498664
noisy true:345
noisy false:164
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 509
epoch [106/200] batch [5/35] time 0.341 (0.338) data 0.264 (0.261) loss_x loss_x 0.4050 (0.2465) acc_x 87.5000 (93.7500) lr 9.3721e-04 eta 0:00:10
epoch [106/200] batch [10/35] time 0.344 (0.341) data 0.267 (0.264) loss_x loss_x 0.2854 (0.2896) acc_x 93.7500 (93.1250) lr 9.3721e-04 eta 0:00:08
epoch [106/200] batch [15/35] time 0.329 (0.341) data 0.251 (0.263) loss_x loss_x 0.4192 (0.3020) acc_x 90.6250 (92.2917) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [20/35] time 0.335 (0.338) data 0.257 (0.260) loss_x loss_x 0.2505 (0.2959) acc_x 90.6250 (92.1875) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [25/35] time 0.343 (0.338) data 0.265 (0.261) loss_x loss_x 0.1797 (0.2985) acc_x 96.8750 (92.1250) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [30/35] time 0.357 (0.338) data 0.278 (0.260) loss_x loss_x 0.3347 (0.3137) acc_x 90.6250 (91.2500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [35/35] time 0.345 (0.339) data 0.268 (0.262) loss_x loss_x 0.3752 (0.3185) acc_x 90.6250 (91.5179) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/15] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.8408 (0.9040) acc_u 21.8750 (13.1250) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/15] time 0.458 (0.344) data 0.380 (0.266) loss_u loss_u 0.8979 (0.8858) acc_u 15.6250 (15.6250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/15] time 0.338 (0.347) data 0.260 (0.269) loss_u loss_u 0.9561 (0.8882) acc_u 3.1250 (14.5833) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 172
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1120
clean true:1120
clean false:0
clean_rate:1.0
noisy true:340
noisy false:172
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 512
epoch [107/200] batch [5/35] time 0.301 (0.324) data 0.224 (0.247) loss_x loss_x 0.4673 (0.3391) acc_x 87.5000 (91.8750) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [10/35] time 0.338 (0.330) data 0.261 (0.253) loss_x loss_x 0.3818 (0.3590) acc_x 87.5000 (91.8750) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [15/35] time 0.342 (0.334) data 0.265 (0.257) loss_x loss_x 0.2666 (0.3603) acc_x 90.6250 (91.4583) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [20/35] time 0.343 (0.335) data 0.266 (0.258) loss_x loss_x 0.4719 (0.3393) acc_x 81.2500 (91.5625) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [25/35] time 0.347 (0.333) data 0.269 (0.255) loss_x loss_x 0.1542 (0.3389) acc_x 96.8750 (92.0000) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [30/35] time 0.354 (0.335) data 0.277 (0.257) loss_x loss_x 0.1130 (0.3255) acc_x 100.0000 (92.6042) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [35/35] time 0.342 (0.337) data 0.265 (0.260) loss_x loss_x 0.5615 (0.3294) acc_x 87.5000 (92.5893) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/16] time 0.345 (0.338) data 0.268 (0.260) loss_u loss_u 0.8560 (0.8722) acc_u 18.7500 (16.2500) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/16] time 0.378 (0.340) data 0.300 (0.262) loss_u loss_u 0.9351 (0.8732) acc_u 9.3750 (15.9375) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/16] time 0.359 (0.343) data 0.280 (0.265) loss_u loss_u 0.8726 (0.8834) acc_u 15.6250 (14.5833) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 182
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1110
clean true:1109
clean false:1
clean_rate:0.9990990990990991
noisy true:341
noisy false:181
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 522
epoch [108/200] batch [5/34] time 0.331 (0.341) data 0.253 (0.263) loss_x loss_x 0.1770 (0.2631) acc_x 96.8750 (94.3750) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [10/34] time 0.327 (0.341) data 0.249 (0.263) loss_x loss_x 0.2588 (0.2726) acc_x 96.8750 (94.6875) lr 9.0589e-04 eta 0:00:08
epoch [108/200] batch [15/34] time 0.326 (0.341) data 0.249 (0.264) loss_x loss_x 0.1283 (0.2848) acc_x 100.0000 (94.5833) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [20/34] time 0.320 (0.339) data 0.243 (0.261) loss_x loss_x 0.4148 (0.2886) acc_x 93.7500 (94.5312) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [25/34] time 0.316 (0.336) data 0.238 (0.259) loss_x loss_x 0.3728 (0.3096) acc_x 90.6250 (93.8750) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [30/34] time 0.353 (0.334) data 0.276 (0.257) loss_x loss_x 0.1982 (0.2980) acc_x 96.8750 (94.0625) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [5/16] time 0.337 (0.335) data 0.258 (0.258) loss_u loss_u 0.9546 (0.9091) acc_u 6.2500 (11.2500) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/16] time 0.335 (0.336) data 0.257 (0.258) loss_u loss_u 0.8477 (0.8771) acc_u 18.7500 (15.3125) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/16] time 0.341 (0.337) data 0.263 (0.259) loss_u loss_u 0.7749 (0.8577) acc_u 25.0000 (17.2917) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 174
confident_label rate tensor(0.6857, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1119
clean true:1118
clean false:1
clean_rate:0.9991063449508489
noisy true:340
noisy false:173
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 513
epoch [109/200] batch [5/34] time 0.336 (0.349) data 0.258 (0.272) loss_x loss_x 0.2930 (0.2583) acc_x 90.6250 (93.7500) lr 8.9027e-04 eta 0:00:10
epoch [109/200] batch [10/34] time 0.323 (0.341) data 0.245 (0.263) loss_x loss_x 0.2749 (0.3060) acc_x 96.8750 (92.5000) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [15/34] time 0.327 (0.338) data 0.249 (0.260) loss_x loss_x 0.2330 (0.2705) acc_x 100.0000 (94.1667) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [20/34] time 0.335 (0.337) data 0.257 (0.259) loss_x loss_x 0.5352 (0.3131) acc_x 90.6250 (93.5938) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [25/34] time 0.313 (0.336) data 0.235 (0.258) loss_x loss_x 0.4065 (0.3320) acc_x 84.3750 (92.6250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [30/34] time 0.351 (0.333) data 0.274 (0.256) loss_x loss_x 0.5557 (0.3315) acc_x 81.2500 (92.6042) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [5/16] time 0.359 (0.341) data 0.281 (0.263) loss_u loss_u 0.8037 (0.8614) acc_u 21.8750 (15.6250) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/16] time 0.345 (0.342) data 0.268 (0.264) loss_u loss_u 0.9004 (0.8709) acc_u 12.5000 (14.3750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/16] time 0.341 (0.343) data 0.263 (0.265) loss_u loss_u 0.8164 (0.8659) acc_u 21.8750 (15.0000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 170
confident_label rate tensor(0.6850, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1118
clean true:1117
clean false:1
clean_rate:0.9991055456171736
noisy true:345
noisy false:169
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 514
epoch [110/200] batch [5/34] time 0.336 (0.346) data 0.257 (0.268) loss_x loss_x 0.5439 (0.3748) acc_x 84.3750 (90.0000) lr 8.7467e-04 eta 0:00:10
epoch [110/200] batch [10/34] time 0.348 (0.345) data 0.270 (0.267) loss_x loss_x 0.1187 (0.3296) acc_x 100.0000 (91.8750) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [15/34] time 0.342 (0.343) data 0.264 (0.265) loss_x loss_x 0.1329 (0.3257) acc_x 96.8750 (91.8750) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [20/34] time 0.338 (0.341) data 0.259 (0.264) loss_x loss_x 0.2367 (0.3382) acc_x 96.8750 (91.4062) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [25/34] time 0.301 (0.337) data 0.223 (0.259) loss_x loss_x 0.4089 (0.3388) acc_x 96.8750 (92.0000) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [30/34] time 0.342 (0.336) data 0.264 (0.258) loss_x loss_x 0.9341 (0.3470) acc_x 81.2500 (92.1875) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [5/16] time 0.346 (0.336) data 0.269 (0.258) loss_u loss_u 0.9326 (0.8399) acc_u 9.3750 (19.3750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/16] time 0.349 (0.337) data 0.271 (0.260) loss_u loss_u 0.8809 (0.8566) acc_u 12.5000 (16.8750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/16] time 0.344 (0.338) data 0.266 (0.260) loss_u loss_u 0.8501 (0.8651) acc_u 15.6250 (15.4167) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 165
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1122
clean true:1121
clean false:1
clean_rate:0.9991087344028521
noisy true:346
noisy false:164
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 510
epoch [111/200] batch [5/35] time 0.363 (0.345) data 0.286 (0.268) loss_x loss_x 0.1075 (0.3416) acc_x 100.0000 (90.6250) lr 8.5910e-04 eta 0:00:10
epoch [111/200] batch [10/35] time 0.330 (0.343) data 0.252 (0.266) loss_x loss_x 0.3345 (0.3331) acc_x 87.5000 (91.2500) lr 8.5910e-04 eta 0:00:08
epoch [111/200] batch [15/35] time 0.345 (0.342) data 0.268 (0.264) loss_x loss_x 0.1831 (0.3197) acc_x 93.7500 (91.2500) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [20/35] time 0.340 (0.339) data 0.262 (0.261) loss_x loss_x 0.3286 (0.3164) acc_x 87.5000 (91.7188) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [25/35] time 0.309 (0.337) data 0.230 (0.259) loss_x loss_x 0.2600 (0.2960) acc_x 90.6250 (92.2500) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [30/35] time 0.339 (0.338) data 0.261 (0.260) loss_x loss_x 0.2167 (0.3160) acc_x 93.7500 (92.0833) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [35/35] time 0.342 (0.338) data 0.265 (0.261) loss_x loss_x 0.2712 (0.3111) acc_x 93.7500 (92.5893) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/15] time 0.339 (0.338) data 0.262 (0.260) loss_u loss_u 0.8955 (0.8948) acc_u 12.5000 (13.7500) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/15] time 0.339 (0.339) data 0.261 (0.261) loss_u loss_u 0.8745 (0.8864) acc_u 15.6250 (14.0625) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/15] time 0.353 (0.340) data 0.276 (0.262) loss_u loss_u 0.8389 (0.8726) acc_u 21.8750 (15.6250) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 168
confident_label rate tensor(0.6838, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1116
clean true:1114
clean false:2
clean_rate:0.9982078853046595
noisy true:350
noisy false:166
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 516
epoch [112/200] batch [5/34] time 0.391 (0.360) data 0.313 (0.282) loss_x loss_x 0.2244 (0.3721) acc_x 96.8750 (92.5000) lr 8.4357e-04 eta 0:00:10
epoch [112/200] batch [10/34] time 0.400 (0.391) data 0.322 (0.313) loss_x loss_x 0.2590 (0.3333) acc_x 96.8750 (93.1250) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [15/34] time 0.350 (0.376) data 0.273 (0.298) loss_x loss_x 0.3171 (0.3173) acc_x 93.7500 (93.5417) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [20/34] time 0.305 (0.365) data 0.227 (0.288) loss_x loss_x 0.1407 (0.3085) acc_x 96.8750 (93.5938) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [25/34] time 0.306 (0.353) data 0.228 (0.275) loss_x loss_x 0.1702 (0.3105) acc_x 96.8750 (93.1250) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [30/34] time 0.334 (0.352) data 0.257 (0.274) loss_x loss_x 0.1423 (0.2914) acc_x 100.0000 (94.0625) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [5/16] time 0.349 (0.351) data 0.271 (0.273) loss_u loss_u 0.8242 (0.8822) acc_u 21.8750 (13.7500) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/16] time 0.332 (0.349) data 0.254 (0.271) loss_u loss_u 0.8564 (0.8639) acc_u 15.6250 (15.6250) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/16] time 0.376 (0.349) data 0.298 (0.271) loss_u loss_u 0.8101 (0.8578) acc_u 21.8750 (17.0833) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 162
confident_label rate tensor(0.6949, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1134
clean true:1131
clean false:3
clean_rate:0.9973544973544973
noisy true:339
noisy false:159
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 498
epoch [113/200] batch [5/35] time 0.366 (0.395) data 0.288 (0.317) loss_x loss_x 0.3279 (0.3240) acc_x 90.6250 (93.1250) lr 8.2807e-04 eta 0:00:11
epoch [113/200] batch [10/35] time 0.359 (0.372) data 0.281 (0.294) loss_x loss_x 0.1870 (0.2813) acc_x 100.0000 (93.4375) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [15/35] time 0.334 (0.360) data 0.257 (0.282) loss_x loss_x 0.2374 (0.3014) acc_x 93.7500 (92.5000) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [20/35] time 0.305 (0.349) data 0.227 (0.271) loss_x loss_x 0.2947 (0.2943) acc_x 93.7500 (92.5000) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [25/35] time 0.343 (0.344) data 0.265 (0.266) loss_x loss_x 0.3931 (0.3132) acc_x 93.7500 (91.8750) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [30/35] time 0.332 (0.343) data 0.255 (0.265) loss_x loss_x 0.4299 (0.3305) acc_x 90.6250 (91.7708) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [35/35] time 0.349 (0.344) data 0.272 (0.266) loss_x loss_x 0.2362 (0.3223) acc_x 96.8750 (92.1429) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/15] time 0.334 (0.345) data 0.256 (0.267) loss_u loss_u 0.8491 (0.8753) acc_u 21.8750 (14.3750) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/15] time 0.346 (0.345) data 0.267 (0.267) loss_u loss_u 0.8359 (0.8815) acc_u 18.7500 (13.7500) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [15/15] time 0.343 (0.345) data 0.265 (0.267) loss_u loss_u 0.9062 (0.8797) acc_u 9.3750 (13.7500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 154
confident_label rate tensor(0.6973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1138
clean true:1136
clean false:2
clean_rate:0.9982425307557118
noisy true:342
noisy false:152
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 494
epoch [114/200] batch [5/35] time 0.349 (0.350) data 0.271 (0.273) loss_x loss_x 0.5220 (0.3403) acc_x 84.3750 (91.8750) lr 8.1262e-04 eta 0:00:10
epoch [114/200] batch [10/35] time 0.328 (0.346) data 0.250 (0.269) loss_x loss_x 0.3032 (0.2979) acc_x 93.7500 (93.7500) lr 8.1262e-04 eta 0:00:08
epoch [114/200] batch [15/35] time 0.298 (0.336) data 0.220 (0.259) loss_x loss_x 0.3516 (0.3164) acc_x 93.7500 (93.3333) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [20/35] time 0.336 (0.332) data 0.258 (0.254) loss_x loss_x 0.1567 (0.3207) acc_x 96.8750 (93.1250) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [25/35] time 0.347 (0.334) data 0.269 (0.256) loss_x loss_x 0.2439 (0.2956) acc_x 96.8750 (94.0000) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [30/35] time 0.355 (0.336) data 0.277 (0.258) loss_x loss_x 0.3904 (0.3109) acc_x 90.6250 (93.6458) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [35/35] time 0.353 (0.338) data 0.276 (0.260) loss_x loss_x 0.2028 (0.3138) acc_x 96.8750 (93.3036) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/15] time 0.356 (0.339) data 0.277 (0.261) loss_u loss_u 0.7847 (0.8778) acc_u 25.0000 (14.3750) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/15] time 0.343 (0.340) data 0.264 (0.262) loss_u loss_u 0.8921 (0.8969) acc_u 9.3750 (11.8750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [15/15] time 0.324 (0.340) data 0.245 (0.262) loss_u loss_u 0.8174 (0.8903) acc_u 21.8750 (12.9167) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 160
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1123
clean true:1121
clean false:2
clean_rate:0.9982190560997328
noisy true:351
noisy false:158
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 509
epoch [115/200] batch [5/35] time 0.562 (0.455) data 0.484 (0.376) loss_x loss_x 0.4124 (0.3389) acc_x 93.7500 (91.8750) lr 7.9721e-04 eta 0:00:13
epoch [115/200] batch [10/35] time 0.302 (0.447) data 0.224 (0.368) loss_x loss_x 0.1748 (0.3221) acc_x 96.8750 (92.5000) lr 7.9721e-04 eta 0:00:11
epoch [115/200] batch [15/35] time 0.311 (0.401) data 0.233 (0.322) loss_x loss_x 0.4255 (0.3142) acc_x 90.6250 (93.3333) lr 7.9721e-04 eta 0:00:08
epoch [115/200] batch [20/35] time 0.338 (0.388) data 0.260 (0.309) loss_x loss_x 0.2815 (0.3276) acc_x 93.7500 (93.1250) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [25/35] time 0.351 (0.380) data 0.273 (0.301) loss_x loss_x 0.4375 (0.3253) acc_x 96.8750 (93.7500) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [30/35] time 0.305 (0.373) data 0.227 (0.294) loss_x loss_x 0.2130 (0.3225) acc_x 93.7500 (93.4375) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [35/35] time 0.301 (0.367) data 0.224 (0.289) loss_x loss_x 0.4324 (0.3147) acc_x 84.3750 (93.1250) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/15] time 0.368 (0.363) data 0.290 (0.285) loss_u loss_u 0.9326 (0.8854) acc_u 6.2500 (12.5000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/15] time 0.574 (0.369) data 0.494 (0.291) loss_u loss_u 0.9497 (0.8940) acc_u 6.2500 (12.1875) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/15] time 0.363 (0.376) data 0.284 (0.297) loss_u loss_u 0.8423 (0.8776) acc_u 18.7500 (13.9583) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 154
confident_label rate tensor(0.6918, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1129
clean true:1128
clean false:1
clean_rate:0.9991142604074402
noisy true:350
noisy false:153
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 503
epoch [116/200] batch [5/35] time 0.481 (0.413) data 0.397 (0.332) loss_x loss_x 0.1354 (0.3206) acc_x 100.0000 (94.3750) lr 7.8186e-04 eta 0:00:12
epoch [116/200] batch [10/35] time 0.434 (0.439) data 0.356 (0.359) loss_x loss_x 0.3696 (0.2902) acc_x 87.5000 (94.0625) lr 7.8186e-04 eta 0:00:10
epoch [116/200] batch [15/35] time 0.333 (0.402) data 0.255 (0.322) loss_x loss_x 0.1855 (0.2784) acc_x 93.7500 (94.5833) lr 7.8186e-04 eta 0:00:08
epoch [116/200] batch [20/35] time 0.368 (0.393) data 0.290 (0.314) loss_x loss_x 0.2045 (0.3040) acc_x 96.8750 (93.7500) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [25/35] time 0.390 (0.391) data 0.313 (0.312) loss_x loss_x 0.1641 (0.2814) acc_x 100.0000 (94.5000) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [30/35] time 0.353 (0.385) data 0.272 (0.306) loss_x loss_x 0.2097 (0.2742) acc_x 96.8750 (94.6875) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [35/35] time 0.479 (0.395) data 0.316 (0.309) loss_x loss_x 0.2472 (0.2781) acc_x 96.8750 (94.3750) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/15] time 0.463 (0.402) data 0.296 (0.306) loss_u loss_u 0.8203 (0.8745) acc_u 18.7500 (14.3750) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [10/15] time 0.393 (0.403) data 0.227 (0.299) loss_u loss_u 0.8730 (0.8692) acc_u 15.6250 (15.0000) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/15] time 0.370 (0.400) data 0.206 (0.291) loss_u loss_u 0.9258 (0.8770) acc_u 9.3750 (14.3750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 174
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1108
clean false:1
clean_rate:0.9990982867448152
noisy true:350
noisy false:173
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [117/200] batch [5/34] time 0.460 (0.442) data 0.300 (0.284) loss_x loss_x 0.3093 (0.1990) acc_x 93.7500 (96.2500) lr 7.6655e-04 eta 0:00:12
epoch [117/200] batch [10/34] time 0.442 (0.444) data 0.277 (0.284) loss_x loss_x 0.4700 (0.2658) acc_x 93.7500 (95.9375) lr 7.6655e-04 eta 0:00:10
epoch [117/200] batch [15/34] time 0.378 (0.439) data 0.301 (0.284) loss_x loss_x 0.3733 (0.2830) acc_x 90.6250 (94.3750) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [20/34] time 0.445 (0.441) data 0.280 (0.284) loss_x loss_x 0.3108 (0.3145) acc_x 93.7500 (93.5938) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [25/34] time 0.455 (0.445) data 0.297 (0.287) loss_x loss_x 0.2888 (0.3070) acc_x 93.7500 (93.8750) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [30/34] time 0.457 (0.443) data 0.291 (0.286) loss_x loss_x 0.2159 (0.3147) acc_x 96.8750 (93.4375) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [5/16] time 0.447 (0.437) data 0.278 (0.278) loss_u loss_u 0.8418 (0.8703) acc_u 18.7500 (14.3750) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [10/16] time 0.467 (0.440) data 0.296 (0.282) loss_u loss_u 0.9990 (0.8760) acc_u 0.0000 (13.7500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/16] time 0.459 (0.441) data 0.290 (0.283) loss_u loss_u 0.7466 (0.8604) acc_u 31.2500 (16.2500) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.6771, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1105
clean true:1104
clean false:1
clean_rate:0.9990950226244344
noisy true:345
noisy false:182
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 527
epoch [118/200] batch [5/34] time 0.415 (0.432) data 0.252 (0.273) loss_x loss_x 0.3857 (0.3419) acc_x 87.5000 (91.8750) lr 7.5131e-04 eta 0:00:12
epoch [118/200] batch [10/34] time 0.378 (0.409) data 0.218 (0.249) loss_x loss_x 0.3428 (0.2851) acc_x 93.7500 (93.4375) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [15/34] time 0.440 (0.412) data 0.273 (0.257) loss_x loss_x 0.1942 (0.2854) acc_x 93.7500 (93.1250) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [20/34] time 0.419 (0.417) data 0.258 (0.261) loss_x loss_x 0.1174 (0.2847) acc_x 96.8750 (93.1250) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [25/34] time 0.440 (0.425) data 0.281 (0.268) loss_x loss_x 0.2249 (0.2871) acc_x 93.7500 (93.3750) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [30/34] time 0.436 (0.424) data 0.271 (0.269) loss_x loss_x 0.3999 (0.2854) acc_x 84.3750 (93.5417) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [5/16] time 0.472 (0.429) data 0.302 (0.271) loss_u loss_u 0.8540 (0.8726) acc_u 15.6250 (15.0000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/16] time 0.474 (0.433) data 0.305 (0.274) loss_u loss_u 0.9141 (0.8787) acc_u 9.3750 (13.7500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/16] time 0.468 (0.437) data 0.304 (0.277) loss_u loss_u 0.9155 (0.8690) acc_u 12.5000 (14.7917) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 144
confident_label rate tensor(0.6998, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1142
clean true:1141
clean false:1
clean_rate:0.999124343257443
noisy true:347
noisy false:143
after delete: len(clean_dataset) 1142
after delete: len(noisy_dataset) 490
epoch [119/200] batch [5/35] time 0.476 (0.416) data 0.314 (0.271) loss_x loss_x 0.3186 (0.3764) acc_x 90.6250 (91.8750) lr 7.3613e-04 eta 0:00:12
epoch [119/200] batch [10/35] time 0.491 (0.445) data 0.329 (0.292) loss_x loss_x 0.2379 (0.2906) acc_x 93.7500 (93.1250) lr 7.3613e-04 eta 0:00:11
epoch [119/200] batch [15/35] time 0.443 (0.443) data 0.282 (0.287) loss_x loss_x 0.2070 (0.3136) acc_x 93.7500 (91.4583) lr 7.3613e-04 eta 0:00:08
epoch [119/200] batch [20/35] time 0.441 (0.444) data 0.280 (0.289) loss_x loss_x 0.1268 (0.3101) acc_x 100.0000 (91.8750) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [25/35] time 0.467 (0.436) data 0.305 (0.279) loss_x loss_x 0.1884 (0.2981) acc_x 93.7500 (92.5000) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [30/35] time 0.429 (0.435) data 0.253 (0.279) loss_x loss_x 0.1942 (0.2941) acc_x 96.8750 (92.7083) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [35/35] time 0.432 (0.438) data 0.266 (0.281) loss_x loss_x 0.5952 (0.3026) acc_x 84.3750 (92.5893) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/15] time 0.438 (0.441) data 0.277 (0.282) loss_u loss_u 0.8818 (0.9072) acc_u 12.5000 (10.0000) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/15] time 0.432 (0.440) data 0.262 (0.280) loss_u loss_u 0.9380 (0.8840) acc_u 9.3750 (13.4375) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/15] time 0.469 (0.441) data 0.301 (0.280) loss_u loss_u 0.9492 (0.9021) acc_u 6.2500 (11.6667) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 157
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1126
clean true:1125
clean false:1
clean_rate:0.9991119005328597
noisy true:350
noisy false:156
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 506
epoch [120/200] batch [5/35] time 0.553 (0.456) data 0.388 (0.309) loss_x loss_x 0.2063 (0.4090) acc_x 93.7500 (89.3750) lr 7.2101e-04 eta 0:00:13
epoch [120/200] batch [10/35] time 0.417 (0.483) data 0.252 (0.326) loss_x loss_x 0.2260 (0.3574) acc_x 96.8750 (90.9375) lr 7.2101e-04 eta 0:00:12
epoch [120/200] batch [15/35] time 0.533 (0.471) data 0.369 (0.312) loss_x loss_x 0.1725 (0.3360) acc_x 96.8750 (91.6667) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [20/35] time 0.472 (0.468) data 0.310 (0.313) loss_x loss_x 0.5093 (0.3441) acc_x 87.5000 (91.4062) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [25/35] time 0.436 (0.465) data 0.274 (0.309) loss_x loss_x 0.4229 (0.3528) acc_x 84.3750 (90.8750) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [30/35] time 0.449 (0.461) data 0.291 (0.304) loss_x loss_x 0.4082 (0.3450) acc_x 87.5000 (91.2500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [35/35] time 0.434 (0.457) data 0.272 (0.301) loss_x loss_x 0.5254 (0.3433) acc_x 87.5000 (91.5179) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/15] time 0.432 (0.452) data 0.265 (0.295) loss_u loss_u 0.9526 (0.8649) acc_u 6.2500 (15.6250) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/15] time 0.465 (0.452) data 0.298 (0.293) loss_u loss_u 0.9209 (0.8628) acc_u 9.3750 (16.2500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/15] time 0.367 (0.449) data 0.266 (0.290) loss_u loss_u 0.9116 (0.8656) acc_u 9.3750 (16.0417) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 153
confident_label rate tensor(0.6961, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1136
clean true:1136
clean false:0
clean_rate:1.0
noisy true:343
noisy false:153
after delete: len(clean_dataset) 1136
after delete: len(noisy_dataset) 496
epoch [121/200] batch [5/35] time 0.331 (0.406) data 0.252 (0.269) loss_x loss_x 0.3064 (0.2815) acc_x 93.7500 (93.7500) lr 7.0596e-04 eta 0:00:12
epoch [121/200] batch [10/35] time 0.490 (0.435) data 0.327 (0.285) loss_x loss_x 0.4712 (0.3106) acc_x 93.7500 (93.1250) lr 7.0596e-04 eta 0:00:10
epoch [121/200] batch [15/35] time 0.449 (0.447) data 0.290 (0.293) loss_x loss_x 0.1561 (0.3042) acc_x 100.0000 (93.3333) lr 7.0596e-04 eta 0:00:08
epoch [121/200] batch [20/35] time 0.455 (0.454) data 0.293 (0.300) loss_x loss_x 0.3909 (0.2934) acc_x 90.6250 (93.7500) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [25/35] time 0.490 (0.459) data 0.326 (0.303) loss_x loss_x 0.2817 (0.2983) acc_x 93.7500 (93.8750) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [30/35] time 0.450 (0.454) data 0.283 (0.300) loss_x loss_x 0.5991 (0.3013) acc_x 90.6250 (93.9583) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [35/35] time 0.439 (0.455) data 0.278 (0.299) loss_x loss_x 0.4512 (0.2964) acc_x 90.6250 (93.9286) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/15] time 0.499 (0.462) data 0.327 (0.307) loss_u loss_u 0.9141 (0.8927) acc_u 12.5000 (11.8750) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/15] time 0.435 (0.459) data 0.266 (0.303) loss_u loss_u 0.8867 (0.8878) acc_u 12.5000 (12.8125) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/15] time 0.396 (0.454) data 0.224 (0.296) loss_u loss_u 0.8330 (0.8963) acc_u 18.7500 (11.6667) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1108
clean false:0
clean_rate:1.0
noisy true:343
noisy false:181
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [122/200] batch [5/34] time 0.430 (0.418) data 0.267 (0.272) loss_x loss_x 0.2576 (0.3520) acc_x 96.8750 (91.8750) lr 6.9098e-04 eta 0:00:12
epoch [122/200] batch [10/34] time 0.485 (0.447) data 0.322 (0.292) loss_x loss_x 0.4944 (0.3329) acc_x 90.6250 (92.1875) lr 6.9098e-04 eta 0:00:10
epoch [122/200] batch [15/34] time 0.491 (0.457) data 0.327 (0.299) loss_x loss_x 0.1293 (0.3365) acc_x 100.0000 (92.0833) lr 6.9098e-04 eta 0:00:08
epoch [122/200] batch [20/34] time 0.443 (0.455) data 0.278 (0.300) loss_x loss_x 0.2139 (0.3568) acc_x 100.0000 (91.5625) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [25/34] time 0.388 (0.448) data 0.226 (0.292) loss_x loss_x 0.4402 (0.3557) acc_x 90.6250 (91.8750) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [30/34] time 0.455 (0.449) data 0.294 (0.291) loss_x loss_x 0.4033 (0.3423) acc_x 93.7500 (92.1875) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [5/16] time 0.427 (0.446) data 0.257 (0.288) loss_u loss_u 0.8545 (0.8699) acc_u 15.6250 (14.3750) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/16] time 0.485 (0.447) data 0.318 (0.288) loss_u loss_u 0.8164 (0.8549) acc_u 21.8750 (16.5625) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/16] time 0.378 (0.437) data 0.215 (0.281) loss_u loss_u 0.9053 (0.8508) acc_u 9.3750 (16.6667) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 139
confident_label rate tensor(0.6955, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1135
clean true:1134
clean false:1
clean_rate:0.9991189427312775
noisy true:359
noisy false:138
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 497
epoch [123/200] batch [5/35] time 0.480 (0.481) data 0.315 (0.334) loss_x loss_x 0.3054 (0.3470) acc_x 90.6250 (93.7500) lr 6.7608e-04 eta 0:00:14
epoch [123/200] batch [10/35] time 0.473 (0.478) data 0.309 (0.322) loss_x loss_x 0.3889 (0.2972) acc_x 90.6250 (94.6875) lr 6.7608e-04 eta 0:00:11
epoch [123/200] batch [15/35] time 0.368 (0.461) data 0.289 (0.308) loss_x loss_x 0.2183 (0.2870) acc_x 96.8750 (93.9583) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [20/35] time 0.522 (0.466) data 0.359 (0.311) loss_x loss_x 0.3875 (0.3012) acc_x 90.6250 (93.4375) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [25/35] time 0.460 (0.465) data 0.298 (0.308) loss_x loss_x 0.2595 (0.2872) acc_x 96.8750 (94.0000) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [30/35] time 0.388 (0.458) data 0.226 (0.303) loss_x loss_x 0.5269 (0.2950) acc_x 84.3750 (93.7500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [35/35] time 0.520 (0.459) data 0.358 (0.303) loss_x loss_x 0.1552 (0.2928) acc_x 96.8750 (93.8393) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/15] time 0.429 (0.458) data 0.263 (0.301) loss_u loss_u 0.8765 (0.8960) acc_u 15.6250 (12.5000) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/15] time 0.391 (0.452) data 0.230 (0.296) loss_u loss_u 0.9004 (0.8978) acc_u 9.3750 (11.5625) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/15] time 0.513 (0.452) data 0.353 (0.295) loss_u loss_u 0.8789 (0.8895) acc_u 12.5000 (12.7083) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 150
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1127
clean true:1126
clean false:1
clean_rate:0.9991126885536823
noisy true:356
noisy false:149
after delete: len(clean_dataset) 1127
after delete: len(noisy_dataset) 505
epoch [124/200] batch [5/35] time 0.502 (0.469) data 0.338 (0.315) loss_x loss_x 0.1589 (0.2476) acc_x 93.7500 (93.7500) lr 6.6126e-04 eta 0:00:14
epoch [124/200] batch [10/35] time 0.515 (0.482) data 0.349 (0.323) loss_x loss_x 0.2874 (0.2565) acc_x 93.7500 (93.7500) lr 6.6126e-04 eta 0:00:12
epoch [124/200] batch [15/35] time 0.492 (0.476) data 0.328 (0.315) loss_x loss_x 0.3723 (0.2586) acc_x 90.6250 (93.9583) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [20/35] time 0.462 (0.470) data 0.297 (0.313) loss_x loss_x 0.2788 (0.2643) acc_x 93.7500 (94.0625) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [25/35] time 0.434 (0.466) data 0.269 (0.307) loss_x loss_x 0.2644 (0.2647) acc_x 90.6250 (93.8750) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [30/35] time 0.447 (0.457) data 0.271 (0.300) loss_x loss_x 0.1118 (0.2535) acc_x 100.0000 (94.0625) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [35/35] time 0.437 (0.453) data 0.277 (0.296) loss_x loss_x 0.2700 (0.2582) acc_x 93.7500 (93.9286) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/15] time 0.430 (0.452) data 0.264 (0.294) loss_u loss_u 0.9146 (0.8545) acc_u 9.3750 (18.1250) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/15] time 0.487 (0.449) data 0.322 (0.291) loss_u loss_u 0.8716 (0.8691) acc_u 15.6250 (15.9375) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/15] time 0.481 (0.452) data 0.318 (0.294) loss_u loss_u 0.9302 (0.8749) acc_u 9.3750 (15.0000) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 153
confident_label rate tensor(0.6961, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1136
clean true:1133
clean false:3
clean_rate:0.9973591549295775
noisy true:346
noisy false:150
after delete: len(clean_dataset) 1136
after delete: len(noisy_dataset) 496
epoch [125/200] batch [5/35] time 0.624 (0.535) data 0.460 (0.370) loss_x loss_x 0.1571 (0.2067) acc_x 96.8750 (95.0000) lr 6.4653e-04 eta 0:00:16
epoch [125/200] batch [10/35] time 0.477 (0.519) data 0.397 (0.364) loss_x loss_x 0.2458 (0.2729) acc_x 93.7500 (94.0625) lr 6.4653e-04 eta 0:00:12
epoch [125/200] batch [15/35] time 0.435 (0.498) data 0.274 (0.341) loss_x loss_x 0.5869 (0.3080) acc_x 81.2500 (92.0833) lr 6.4653e-04 eta 0:00:09
epoch [125/200] batch [20/35] time 0.426 (0.486) data 0.344 (0.331) loss_x loss_x 0.0794 (0.2960) acc_x 100.0000 (92.5000) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [25/35] time 0.472 (0.482) data 0.307 (0.325) loss_x loss_x 0.1096 (0.2751) acc_x 100.0000 (93.5000) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [30/35] time 0.423 (0.473) data 0.265 (0.317) loss_x loss_x 0.4502 (0.2904) acc_x 90.6250 (92.9167) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [35/35] time 0.391 (0.461) data 0.233 (0.305) loss_x loss_x 0.2917 (0.3026) acc_x 96.8750 (92.4107) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/15] time 0.445 (0.454) data 0.277 (0.299) loss_u loss_u 0.9106 (0.8852) acc_u 9.3750 (12.5000) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/15] time 0.449 (0.451) data 0.282 (0.295) loss_u loss_u 0.9111 (0.8746) acc_u 9.3750 (13.4375) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/15] time 0.432 (0.449) data 0.267 (0.294) loss_u loss_u 0.9380 (0.8866) acc_u 6.2500 (12.5000) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 153
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1128
clean true:1126
clean false:2
clean_rate:0.99822695035461
noisy true:353
noisy false:151
after delete: len(clean_dataset) 1128
after delete: len(noisy_dataset) 504
epoch [126/200] batch [5/35] time 0.420 (0.451) data 0.254 (0.304) loss_x loss_x 0.2625 (0.2762) acc_x 96.8750 (93.7500) lr 6.3188e-04 eta 0:00:13
epoch [126/200] batch [10/35] time 0.496 (0.450) data 0.334 (0.295) loss_x loss_x 0.3713 (0.3030) acc_x 90.6250 (93.1250) lr 6.3188e-04 eta 0:00:11
epoch [126/200] batch [15/35] time 0.447 (0.465) data 0.286 (0.307) loss_x loss_x 0.2368 (0.3307) acc_x 96.8750 (92.2917) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [20/35] time 0.515 (0.462) data 0.354 (0.308) loss_x loss_x 0.3623 (0.3182) acc_x 90.6250 (92.5000) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [25/35] time 0.488 (0.467) data 0.325 (0.310) loss_x loss_x 0.2507 (0.3131) acc_x 96.8750 (92.7500) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [30/35] time 0.296 (0.452) data 0.218 (0.300) loss_x loss_x 0.4338 (0.3107) acc_x 87.5000 (93.0208) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [35/35] time 0.434 (0.448) data 0.271 (0.295) loss_x loss_x 0.1467 (0.3046) acc_x 96.8750 (92.9464) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/15] time 0.435 (0.447) data 0.270 (0.292) loss_u loss_u 0.8379 (0.8643) acc_u 18.7500 (15.6250) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/15] time 0.437 (0.443) data 0.273 (0.289) loss_u loss_u 0.8696 (0.8788) acc_u 15.6250 (14.3750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/15] time 0.432 (0.444) data 0.265 (0.289) loss_u loss_u 0.9072 (0.8823) acc_u 9.3750 (13.5417) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 152
confident_label rate tensor(0.6924, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1130
clean true:1130
clean false:0
clean_rate:1.0
noisy true:350
noisy false:152
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 502
epoch [127/200] batch [5/35] time 0.505 (0.467) data 0.340 (0.310) loss_x loss_x 0.2664 (0.3048) acc_x 96.8750 (94.3750) lr 6.1732e-04 eta 0:00:13
epoch [127/200] batch [10/35] time 0.510 (0.478) data 0.344 (0.317) loss_x loss_x 0.2240 (0.2858) acc_x 93.7500 (94.0625) lr 6.1732e-04 eta 0:00:11
epoch [127/200] batch [15/35] time 0.457 (0.478) data 0.293 (0.316) loss_x loss_x 0.3745 (0.2844) acc_x 93.7500 (94.1667) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [20/35] time 0.458 (0.470) data 0.293 (0.313) loss_x loss_x 0.2996 (0.2783) acc_x 90.6250 (94.3750) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [25/35] time 0.499 (0.470) data 0.335 (0.311) loss_x loss_x 0.2195 (0.2658) acc_x 90.6250 (94.5000) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [30/35] time 0.491 (0.464) data 0.326 (0.307) loss_x loss_x 0.1345 (0.2619) acc_x 96.8750 (94.3750) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [35/35] time 0.454 (0.467) data 0.291 (0.309) loss_x loss_x 0.2632 (0.2743) acc_x 96.8750 (94.1964) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/15] time 0.439 (0.463) data 0.272 (0.304) loss_u loss_u 0.9375 (0.8458) acc_u 6.2500 (16.8750) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/15] time 0.425 (0.458) data 0.264 (0.300) loss_u loss_u 0.9067 (0.8751) acc_u 12.5000 (14.3750) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/15] time 0.426 (0.453) data 0.264 (0.294) loss_u loss_u 0.9004 (0.8781) acc_u 12.5000 (13.9583) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 151
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1123
clean true:1121
clean false:2
clean_rate:0.9982190560997328
noisy true:360
noisy false:149
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 509
epoch [128/200] batch [5/35] time 0.513 (0.495) data 0.351 (0.331) loss_x loss_x 0.2812 (0.2903) acc_x 93.7500 (93.1250) lr 6.0285e-04 eta 0:00:14
epoch [128/200] batch [10/35] time 0.473 (0.489) data 0.311 (0.326) loss_x loss_x 0.1670 (0.2588) acc_x 96.8750 (93.7500) lr 6.0285e-04 eta 0:00:12
epoch [128/200] batch [15/35] time 0.423 (0.480) data 0.345 (0.323) loss_x loss_x 0.3650 (0.2796) acc_x 90.6250 (93.7500) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [20/35] time 0.439 (0.462) data 0.276 (0.303) loss_x loss_x 0.3010 (0.2986) acc_x 93.7500 (93.4375) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [25/35] time 0.483 (0.467) data 0.317 (0.307) loss_x loss_x 0.2820 (0.3052) acc_x 96.8750 (93.6250) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [30/35] time 0.464 (0.467) data 0.299 (0.308) loss_x loss_x 0.2003 (0.2890) acc_x 93.7500 (93.8542) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [35/35] time 0.504 (0.470) data 0.338 (0.311) loss_x loss_x 0.2084 (0.2932) acc_x 96.8750 (93.5714) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/15] time 0.318 (0.465) data 0.240 (0.307) loss_u loss_u 0.8696 (0.8948) acc_u 12.5000 (11.8750) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/15] time 0.442 (0.462) data 0.271 (0.302) loss_u loss_u 0.8882 (0.8756) acc_u 15.6250 (14.0625) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/15] time 0.442 (0.460) data 0.274 (0.299) loss_u loss_u 0.8911 (0.8795) acc_u 15.6250 (14.1667) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 153
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1126
clean true:1125
clean false:1
clean_rate:0.9991119005328597
noisy true:354
noisy false:152
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 506
epoch [129/200] batch [5/35] time 0.457 (0.438) data 0.298 (0.292) loss_x loss_x 0.1820 (0.2488) acc_x 93.7500 (95.6250) lr 5.8849e-04 eta 0:00:13
epoch [129/200] batch [10/35] time 0.453 (0.460) data 0.293 (0.307) loss_x loss_x 0.6934 (0.3070) acc_x 87.5000 (93.4375) lr 5.8849e-04 eta 0:00:11
epoch [129/200] batch [15/35] time 0.445 (0.459) data 0.283 (0.307) loss_x loss_x 0.3860 (0.2845) acc_x 93.7500 (94.1667) lr 5.8849e-04 eta 0:00:09
epoch [129/200] batch [20/35] time 0.482 (0.464) data 0.319 (0.310) loss_x loss_x 0.4631 (0.2811) acc_x 87.5000 (94.2188) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [25/35] time 0.472 (0.470) data 0.309 (0.314) loss_x loss_x 0.2012 (0.3005) acc_x 93.7500 (93.3750) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [30/35] time 0.508 (0.471) data 0.350 (0.317) loss_x loss_x 0.3274 (0.2974) acc_x 87.5000 (93.2292) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [35/35] time 0.449 (0.468) data 0.284 (0.312) loss_x loss_x 0.2467 (0.2965) acc_x 93.7500 (92.9464) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/15] time 0.430 (0.467) data 0.258 (0.311) loss_u loss_u 0.8457 (0.8717) acc_u 18.7500 (14.3750) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [10/15] time 0.464 (0.469) data 0.301 (0.312) loss_u loss_u 0.9058 (0.8879) acc_u 12.5000 (13.1250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/15] time 0.434 (0.466) data 0.264 (0.310) loss_u loss_u 0.7637 (0.8795) acc_u 28.1250 (13.9583) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 145
confident_label rate tensor(0.6979, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1139
clean true:1138
clean false:1
clean_rate:0.9991220368744512
noisy true:349
noisy false:144
after delete: len(clean_dataset) 1139
after delete: len(noisy_dataset) 493
epoch [130/200] batch [5/35] time 0.455 (0.430) data 0.291 (0.280) loss_x loss_x 0.4458 (0.3141) acc_x 87.5000 (91.8750) lr 5.7422e-04 eta 0:00:12
epoch [130/200] batch [10/35] time 0.451 (0.440) data 0.287 (0.284) loss_x loss_x 0.2673 (0.3048) acc_x 87.5000 (92.1875) lr 5.7422e-04 eta 0:00:10
epoch [130/200] batch [15/35] time 0.482 (0.451) data 0.322 (0.293) loss_x loss_x 0.3350 (0.3045) acc_x 93.7500 (92.7083) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [20/35] time 0.520 (0.458) data 0.357 (0.303) loss_x loss_x 0.3264 (0.3058) acc_x 93.7500 (92.6562) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [25/35] time 0.433 (0.463) data 0.276 (0.307) loss_x loss_x 0.2944 (0.2982) acc_x 90.6250 (92.8750) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [30/35] time 0.382 (0.454) data 0.304 (0.300) loss_x loss_x 0.1536 (0.2891) acc_x 100.0000 (93.3333) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [35/35] time 0.473 (0.456) data 0.307 (0.301) loss_x loss_x 0.4583 (0.2974) acc_x 93.7500 (93.3929) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/15] time 0.511 (0.460) data 0.342 (0.303) loss_u loss_u 0.8975 (0.9115) acc_u 9.3750 (9.3750) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/15] time 0.400 (0.451) data 0.232 (0.295) loss_u loss_u 0.8882 (0.9135) acc_u 12.5000 (9.3750) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/15] time 0.442 (0.454) data 0.273 (0.297) loss_u loss_u 0.8613 (0.8954) acc_u 15.6250 (11.2500) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 149
confident_label rate tensor(0.6918, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1129
clean true:1127
clean false:2
clean_rate:0.9982285208148804
noisy true:356
noisy false:147
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 503
epoch [131/200] batch [5/35] time 0.558 (0.503) data 0.393 (0.341) loss_x loss_x 0.1836 (0.2871) acc_x 96.8750 (96.2500) lr 5.6006e-04 eta 0:00:15
epoch [131/200] batch [10/35] time 0.412 (0.478) data 0.250 (0.316) loss_x loss_x 0.1464 (0.3187) acc_x 100.0000 (94.0625) lr 5.6006e-04 eta 0:00:11
epoch [131/200] batch [15/35] time 0.479 (0.463) data 0.317 (0.305) loss_x loss_x 0.3245 (0.3161) acc_x 93.7500 (93.7500) lr 5.6006e-04 eta 0:00:09
epoch [131/200] batch [20/35] time 0.396 (0.463) data 0.234 (0.305) loss_x loss_x 0.3716 (0.3228) acc_x 87.5000 (93.4375) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [25/35] time 0.452 (0.453) data 0.291 (0.294) loss_x loss_x 0.5498 (0.3382) acc_x 87.5000 (92.3750) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [30/35] time 0.492 (0.454) data 0.328 (0.297) loss_x loss_x 0.4829 (0.3288) acc_x 90.6250 (92.8125) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [35/35] time 0.485 (0.458) data 0.320 (0.300) loss_x loss_x 0.3811 (0.3266) acc_x 93.7500 (92.8571) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/15] time 0.322 (0.457) data 0.244 (0.300) loss_u loss_u 0.8413 (0.8614) acc_u 18.7500 (16.2500) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/15] time 0.494 (0.457) data 0.334 (0.299) loss_u loss_u 0.8247 (0.8690) acc_u 18.7500 (15.0000) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/15] time 0.449 (0.459) data 0.286 (0.300) loss_u loss_u 0.8164 (0.8656) acc_u 21.8750 (15.4167) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 161
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1123
clean true:1123
clean false:0
clean_rate:1.0
noisy true:348
noisy false:161
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 509
epoch [132/200] batch [5/35] time 0.452 (0.403) data 0.287 (0.251) loss_x loss_x 0.1289 (0.3096) acc_x 96.8750 (90.0000) lr 5.4601e-04 eta 0:00:12
epoch [132/200] batch [10/35] time 0.507 (0.442) data 0.342 (0.284) loss_x loss_x 0.3218 (0.2784) acc_x 93.7500 (93.4375) lr 5.4601e-04 eta 0:00:11
epoch [132/200] batch [15/35] time 0.426 (0.452) data 0.262 (0.292) loss_x loss_x 0.2195 (0.3204) acc_x 96.8750 (93.1250) lr 5.4601e-04 eta 0:00:09
epoch [132/200] batch [20/35] time 0.490 (0.452) data 0.327 (0.295) loss_x loss_x 0.2043 (0.3048) acc_x 96.8750 (93.2812) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [25/35] time 0.453 (0.453) data 0.291 (0.294) loss_x loss_x 0.2603 (0.3219) acc_x 93.7500 (92.3750) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [30/35] time 0.362 (0.449) data 0.285 (0.293) loss_x loss_x 0.2472 (0.3083) acc_x 96.8750 (92.7083) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [35/35] time 0.457 (0.452) data 0.299 (0.295) loss_x loss_x 0.1124 (0.2944) acc_x 100.0000 (93.1250) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/15] time 0.504 (0.457) data 0.341 (0.299) loss_u loss_u 0.8359 (0.8751) acc_u 18.7500 (14.3750) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/15] time 0.406 (0.452) data 0.235 (0.295) loss_u loss_u 0.8271 (0.8709) acc_u 18.7500 (14.6875) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/15] time 0.498 (0.451) data 0.331 (0.292) loss_u loss_u 0.8687 (0.8670) acc_u 15.6250 (15.4167) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 157
confident_label rate tensor(0.6930, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1131
clean true:1129
clean false:2
clean_rate:0.9982316534040672
noisy true:346
noisy false:155
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 501
epoch [133/200] batch [5/35] time 0.475 (0.442) data 0.313 (0.296) loss_x loss_x 0.2311 (0.2967) acc_x 96.8750 (93.1250) lr 5.3207e-04 eta 0:00:13
epoch [133/200] batch [10/35] time 0.425 (0.454) data 0.262 (0.299) loss_x loss_x 0.5415 (0.3024) acc_x 90.6250 (92.8125) lr 5.3207e-04 eta 0:00:11
epoch [133/200] batch [15/35] time 0.450 (0.448) data 0.286 (0.290) loss_x loss_x 0.2186 (0.3094) acc_x 96.8750 (92.7083) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [20/35] time 0.423 (0.448) data 0.259 (0.290) loss_x loss_x 0.1722 (0.3082) acc_x 96.8750 (92.9688) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [25/35] time 0.438 (0.446) data 0.273 (0.287) loss_x loss_x 0.5679 (0.3077) acc_x 84.3750 (93.0000) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [30/35] time 0.430 (0.445) data 0.267 (0.286) loss_x loss_x 0.4360 (0.3132) acc_x 84.3750 (93.0208) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [35/35] time 0.444 (0.443) data 0.279 (0.286) loss_x loss_x 0.2479 (0.3136) acc_x 96.8750 (93.0357) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/15] time 0.581 (0.447) data 0.413 (0.289) loss_u loss_u 0.8394 (0.8468) acc_u 18.7500 (18.7500) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/15] time 0.397 (0.450) data 0.293 (0.292) loss_u loss_u 0.9087 (0.8763) acc_u 12.5000 (15.0000) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/15] time 0.440 (0.450) data 0.273 (0.291) loss_u loss_u 0.8877 (0.8796) acc_u 12.5000 (14.3750) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.6832, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1115
clean true:1114
clean false:1
clean_rate:0.9991031390134529
noisy true:342
noisy false:175
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 517
epoch [134/200] batch [5/34] time 0.463 (0.448) data 0.297 (0.285) loss_x loss_x 0.2600 (0.2502) acc_x 96.8750 (96.2500) lr 5.1825e-04 eta 0:00:12
epoch [134/200] batch [10/34] time 0.470 (0.446) data 0.307 (0.283) loss_x loss_x 0.3479 (0.2850) acc_x 90.6250 (94.3750) lr 5.1825e-04 eta 0:00:10
epoch [134/200] batch [15/34] time 0.448 (0.450) data 0.283 (0.286) loss_x loss_x 0.5464 (0.2946) acc_x 87.5000 (93.7500) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [20/34] time 0.441 (0.447) data 0.274 (0.284) loss_x loss_x 0.2013 (0.2891) acc_x 96.8750 (94.0625) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [25/34] time 0.435 (0.447) data 0.270 (0.283) loss_x loss_x 0.2316 (0.2860) acc_x 93.7500 (94.0000) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [30/34] time 0.394 (0.438) data 0.229 (0.276) loss_x loss_x 0.2219 (0.2840) acc_x 93.7500 (94.0625) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [5/16] time 0.476 (0.440) data 0.309 (0.279) loss_u loss_u 0.8604 (0.8562) acc_u 15.6250 (15.0000) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/16] time 0.413 (0.440) data 0.254 (0.279) loss_u loss_u 0.8062 (0.8684) acc_u 21.8750 (14.6875) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/16] time 0.429 (0.440) data 0.262 (0.278) loss_u loss_u 0.9937 (0.8679) acc_u 0.0000 (15.0000) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 141
confident_label rate tensor(0.6973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1138
clean true:1137
clean false:1
clean_rate:0.9991212653778558
noisy true:354
noisy false:140
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 494
epoch [135/200] batch [5/35] time 0.381 (0.439) data 0.278 (0.292) loss_x loss_x 0.1350 (0.2596) acc_x 100.0000 (95.6250) lr 5.0454e-04 eta 0:00:13
epoch [135/200] batch [10/35] time 0.464 (0.426) data 0.301 (0.271) loss_x loss_x 0.2056 (0.2862) acc_x 93.7500 (93.4375) lr 5.0454e-04 eta 0:00:10
epoch [135/200] batch [15/35] time 0.459 (0.436) data 0.299 (0.278) loss_x loss_x 0.3201 (0.2888) acc_x 90.6250 (92.9167) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [20/35] time 0.450 (0.433) data 0.285 (0.278) loss_x loss_x 0.3022 (0.3004) acc_x 90.6250 (92.3438) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [25/35] time 0.434 (0.435) data 0.270 (0.278) loss_x loss_x 0.5786 (0.3253) acc_x 87.5000 (92.2500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [30/35] time 0.457 (0.436) data 0.294 (0.278) loss_x loss_x 0.3606 (0.3166) acc_x 87.5000 (92.1875) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [35/35] time 0.456 (0.436) data 0.292 (0.281) loss_x loss_x 0.1536 (0.2997) acc_x 100.0000 (92.6786) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/15] time 0.461 (0.437) data 0.292 (0.281) loss_u loss_u 0.8726 (0.8969) acc_u 15.6250 (12.5000) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/15] time 0.462 (0.444) data 0.292 (0.286) loss_u loss_u 0.8770 (0.8750) acc_u 12.5000 (14.3750) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/15] time 0.396 (0.440) data 0.224 (0.283) loss_u loss_u 0.8760 (0.8870) acc_u 15.6250 (12.9167) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 155
confident_label rate tensor(0.6918, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1129
clean true:1128
clean false:1
clean_rate:0.9991142604074402
noisy true:349
noisy false:154
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 503
epoch [136/200] batch [5/35] time 0.523 (0.492) data 0.364 (0.330) loss_x loss_x 0.2100 (0.2559) acc_x 93.7500 (94.3750) lr 4.9096e-04 eta 0:00:14
epoch [136/200] batch [10/35] time 0.416 (0.474) data 0.272 (0.314) loss_x loss_x 0.4226 (0.3325) acc_x 87.5000 (92.1875) lr 4.9096e-04 eta 0:00:11
epoch [136/200] batch [15/35] time 0.475 (0.468) data 0.311 (0.305) loss_x loss_x 0.3081 (0.3132) acc_x 90.6250 (92.0833) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [20/35] time 0.443 (0.467) data 0.266 (0.307) loss_x loss_x 0.2100 (0.2832) acc_x 96.8750 (93.5938) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [25/35] time 0.382 (0.452) data 0.217 (0.292) loss_x loss_x 0.2250 (0.2852) acc_x 93.7500 (93.5000) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [30/35] time 0.448 (0.445) data 0.283 (0.284) loss_x loss_x 0.1631 (0.2902) acc_x 96.8750 (93.3333) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [35/35] time 0.442 (0.448) data 0.279 (0.287) loss_x loss_x 0.4397 (0.2874) acc_x 87.5000 (93.3036) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/15] time 0.387 (0.450) data 0.308 (0.291) loss_u loss_u 0.9272 (0.8725) acc_u 9.3750 (14.3750) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/15] time 0.443 (0.452) data 0.275 (0.292) loss_u loss_u 0.8911 (0.8893) acc_u 9.3750 (12.1875) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/15] time 0.467 (0.455) data 0.302 (0.294) loss_u loss_u 0.7925 (0.8788) acc_u 21.8750 (13.5417) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 145
confident_label rate tensor(0.6967, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1137
clean true:1136
clean false:1
clean_rate:0.9991204925241864
noisy true:351
noisy false:144
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 495
epoch [137/200] batch [5/35] time 0.464 (0.449) data 0.302 (0.290) loss_x loss_x 0.1481 (0.3055) acc_x 100.0000 (93.1250) lr 4.7750e-04 eta 0:00:13
epoch [137/200] batch [10/35] time 0.430 (0.443) data 0.269 (0.284) loss_x loss_x 0.2856 (0.3124) acc_x 90.6250 (91.5625) lr 4.7750e-04 eta 0:00:11
epoch [137/200] batch [15/35] time 0.419 (0.438) data 0.256 (0.277) loss_x loss_x 0.2296 (0.2802) acc_x 93.7500 (92.7083) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [20/35] time 0.438 (0.438) data 0.275 (0.280) loss_x loss_x 0.1879 (0.2629) acc_x 96.8750 (93.7500) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [25/35] time 0.437 (0.441) data 0.276 (0.282) loss_x loss_x 0.3372 (0.2721) acc_x 90.6250 (93.5000) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [30/35] time 0.446 (0.444) data 0.281 (0.284) loss_x loss_x 0.3560 (0.2852) acc_x 87.5000 (93.1250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [35/35] time 0.438 (0.443) data 0.279 (0.284) loss_x loss_x 0.2637 (0.2834) acc_x 90.6250 (93.0357) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/15] time 0.506 (0.450) data 0.339 (0.290) loss_u loss_u 0.8564 (0.8808) acc_u 18.7500 (14.3750) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/15] time 0.469 (0.444) data 0.300 (0.284) loss_u loss_u 0.9390 (0.8945) acc_u 6.2500 (12.1875) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/15] time 0.466 (0.445) data 0.294 (0.285) loss_u loss_u 0.8457 (0.8898) acc_u 18.7500 (12.7083) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 142
confident_label rate tensor(0.7004, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1143
clean true:1141
clean false:2
clean_rate:0.9982502187226596
noisy true:349
noisy false:140
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 489
epoch [138/200] batch [5/35] time 0.431 (0.450) data 0.268 (0.295) loss_x loss_x 0.2279 (0.3211) acc_x 96.8750 (93.1250) lr 4.6417e-04 eta 0:00:13
epoch [138/200] batch [10/35] time 0.486 (0.436) data 0.323 (0.278) loss_x loss_x 0.2356 (0.2888) acc_x 93.7500 (93.7500) lr 4.6417e-04 eta 0:00:10
epoch [138/200] batch [15/35] time 0.513 (0.459) data 0.351 (0.300) loss_x loss_x 0.3867 (0.3165) acc_x 87.5000 (92.7083) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [20/35] time 0.510 (0.465) data 0.353 (0.305) loss_x loss_x 0.2411 (0.2988) acc_x 93.7500 (92.9688) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [25/35] time 0.470 (0.461) data 0.308 (0.301) loss_x loss_x 0.2327 (0.2984) acc_x 96.8750 (93.0000) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [30/35] time 0.468 (0.460) data 0.303 (0.302) loss_x loss_x 0.2124 (0.3008) acc_x 96.8750 (93.2292) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [35/35] time 0.463 (0.463) data 0.297 (0.304) loss_x loss_x 0.2661 (0.2923) acc_x 96.8750 (93.5714) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/15] time 0.472 (0.465) data 0.304 (0.305) loss_u loss_u 0.8911 (0.9019) acc_u 15.6250 (11.8750) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/15] time 0.475 (0.464) data 0.309 (0.303) loss_u loss_u 0.8745 (0.8809) acc_u 15.6250 (13.7500) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/15] time 0.424 (0.462) data 0.254 (0.300) loss_u loss_u 0.8564 (0.8848) acc_u 18.7500 (13.5417) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 167
confident_label rate tensor(0.6838, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1116
clean true:1114
clean false:2
clean_rate:0.9982078853046595
noisy true:351
noisy false:165
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 516
epoch [139/200] batch [5/34] time 0.492 (0.474) data 0.325 (0.327) loss_x loss_x 0.2561 (0.2348) acc_x 93.7500 (96.2500) lr 4.5098e-04 eta 0:00:13
epoch [139/200] batch [10/34] time 0.442 (0.448) data 0.281 (0.292) loss_x loss_x 0.2625 (0.2784) acc_x 96.8750 (95.0000) lr 4.5098e-04 eta 0:00:10
epoch [139/200] batch [15/34] time 0.512 (0.464) data 0.339 (0.305) loss_x loss_x 0.1270 (0.2532) acc_x 96.8750 (95.6250) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [20/34] time 0.393 (0.458) data 0.231 (0.298) loss_x loss_x 0.3398 (0.2483) acc_x 90.6250 (95.1562) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [25/34] time 0.482 (0.454) data 0.320 (0.294) loss_x loss_x 0.1693 (0.2670) acc_x 100.0000 (94.6250) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [30/34] time 0.441 (0.452) data 0.282 (0.294) loss_x loss_x 0.4221 (0.2735) acc_x 84.3750 (93.9583) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [5/16] time 0.446 (0.453) data 0.273 (0.294) loss_u loss_u 0.8662 (0.8351) acc_u 15.6250 (19.3750) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/16] time 0.448 (0.451) data 0.285 (0.291) loss_u loss_u 0.7549 (0.8605) acc_u 28.1250 (15.6250) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/16] time 0.452 (0.450) data 0.287 (0.289) loss_u loss_u 0.7988 (0.8588) acc_u 25.0000 (15.6250) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 147
confident_label rate tensor(0.6967, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1137
clean true:1135
clean false:2
clean_rate:0.9982409850483729
noisy true:350
noisy false:145
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 495
epoch [140/200] batch [5/35] time 0.446 (0.457) data 0.279 (0.310) loss_x loss_x 0.3911 (0.2310) acc_x 90.6250 (94.3750) lr 4.3792e-04 eta 0:00:13
epoch [140/200] batch [10/35] time 0.459 (0.454) data 0.298 (0.297) loss_x loss_x 0.1423 (0.2414) acc_x 93.7500 (94.0625) lr 4.3792e-04 eta 0:00:11
epoch [140/200] batch [15/35] time 0.501 (0.451) data 0.340 (0.298) loss_x loss_x 0.2666 (0.2763) acc_x 93.7500 (93.1250) lr 4.3792e-04 eta 0:00:09
epoch [140/200] batch [20/35] time 0.460 (0.452) data 0.299 (0.296) loss_x loss_x 0.3518 (0.2698) acc_x 90.6250 (93.4375) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [25/35] time 0.447 (0.450) data 0.285 (0.294) loss_x loss_x 0.2223 (0.2723) acc_x 96.8750 (93.3750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [30/35] time 0.446 (0.449) data 0.284 (0.294) loss_x loss_x 0.4050 (0.2645) acc_x 87.5000 (93.5417) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [35/35] time 0.439 (0.443) data 0.277 (0.288) loss_x loss_x 0.2057 (0.2608) acc_x 100.0000 (93.9286) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/15] time 0.489 (0.451) data 0.318 (0.295) loss_u loss_u 0.8408 (0.8909) acc_u 18.7500 (14.3750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/15] time 0.445 (0.454) data 0.279 (0.296) loss_u loss_u 0.9351 (0.9074) acc_u 6.2500 (11.8750) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/15] time 0.445 (0.453) data 0.276 (0.294) loss_u loss_u 0.9536 (0.9006) acc_u 6.2500 (12.7083) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 134
confident_label rate tensor(0.6973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1138
clean true:1137
clean false:1
clean_rate:0.9991212653778558
noisy true:361
noisy false:133
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 494
epoch [141/200] batch [5/35] time 0.396 (0.407) data 0.231 (0.260) loss_x loss_x 0.2620 (0.2636) acc_x 93.7500 (90.6250) lr 4.2499e-04 eta 0:00:12
epoch [141/200] batch [10/35] time 0.492 (0.427) data 0.328 (0.273) loss_x loss_x 0.3396 (0.3046) acc_x 93.7500 (91.2500) lr 4.2499e-04 eta 0:00:10
epoch [141/200] batch [15/35] time 0.439 (0.438) data 0.279 (0.281) loss_x loss_x 0.3445 (0.2808) acc_x 93.7500 (92.2917) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [20/35] time 0.387 (0.433) data 0.223 (0.275) loss_x loss_x 0.2483 (0.2786) acc_x 96.8750 (92.9688) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [25/35] time 0.431 (0.431) data 0.271 (0.272) loss_x loss_x 0.3223 (0.2752) acc_x 100.0000 (93.5000) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [30/35] time 0.446 (0.434) data 0.286 (0.274) loss_x loss_x 0.3865 (0.2831) acc_x 90.6250 (93.4375) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [35/35] time 0.450 (0.433) data 0.294 (0.275) loss_x loss_x 0.2335 (0.2734) acc_x 93.7500 (93.8393) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/15] time 0.474 (0.437) data 0.308 (0.279) loss_u loss_u 0.9878 (0.9211) acc_u 3.1250 (9.3750) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/15] time 0.472 (0.439) data 0.314 (0.281) loss_u loss_u 0.8457 (0.9156) acc_u 21.8750 (10.3125) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/15] time 0.419 (0.435) data 0.250 (0.277) loss_u loss_u 0.8804 (0.8989) acc_u 18.7500 (12.2917) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 148
confident_label rate tensor(0.6930, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1131
clean true:1128
clean false:3
clean_rate:0.9973474801061007
noisy true:356
noisy false:145
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 501
epoch [142/200] batch [5/35] time 0.454 (0.438) data 0.292 (0.291) loss_x loss_x 0.1022 (0.2022) acc_x 96.8750 (95.6250) lr 4.1221e-04 eta 0:00:13
epoch [142/200] batch [10/35] time 0.459 (0.447) data 0.296 (0.292) loss_x loss_x 0.4282 (0.2747) acc_x 93.7500 (93.4375) lr 4.1221e-04 eta 0:00:11
epoch [142/200] batch [15/35] time 0.387 (0.441) data 0.223 (0.283) loss_x loss_x 0.2568 (0.2733) acc_x 93.7500 (93.5417) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [20/35] time 0.429 (0.425) data 0.272 (0.271) loss_x loss_x 0.3477 (0.2552) acc_x 87.5000 (94.0625) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [25/35] time 0.425 (0.428) data 0.263 (0.273) loss_x loss_x 0.4312 (0.2673) acc_x 90.6250 (93.8750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [30/35] time 0.459 (0.433) data 0.296 (0.277) loss_x loss_x 0.3518 (0.2830) acc_x 90.6250 (93.3333) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [35/35] time 0.432 (0.437) data 0.271 (0.280) loss_x loss_x 0.3887 (0.2888) acc_x 90.6250 (93.3929) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/15] time 0.410 (0.437) data 0.266 (0.280) loss_u loss_u 0.8735 (0.8784) acc_u 12.5000 (13.1250) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/15] time 0.436 (0.437) data 0.263 (0.278) loss_u loss_u 0.8569 (0.8718) acc_u 18.7500 (15.0000) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/15] time 0.408 (0.435) data 0.242 (0.275) loss_u loss_u 0.9072 (0.8772) acc_u 12.5000 (14.5833) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 139
confident_label rate tensor(0.6985, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1140
clean true:1139
clean false:1
clean_rate:0.9991228070175439
noisy true:354
noisy false:138
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 492
epoch [143/200] batch [5/35] time 0.459 (0.438) data 0.295 (0.292) loss_x loss_x 0.5483 (0.2922) acc_x 93.7500 (95.0000) lr 3.9958e-04 eta 0:00:13
epoch [143/200] batch [10/35] time 0.377 (0.431) data 0.217 (0.276) loss_x loss_x 0.3306 (0.2998) acc_x 90.6250 (94.0625) lr 3.9958e-04 eta 0:00:10
epoch [143/200] batch [15/35] time 0.451 (0.441) data 0.288 (0.283) loss_x loss_x 0.2144 (0.2878) acc_x 96.8750 (93.9583) lr 3.9958e-04 eta 0:00:08
epoch [143/200] batch [20/35] time 0.452 (0.440) data 0.290 (0.285) loss_x loss_x 0.4304 (0.2813) acc_x 90.6250 (93.9062) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [25/35] time 0.428 (0.442) data 0.266 (0.285) loss_x loss_x 0.2600 (0.2948) acc_x 93.7500 (93.5000) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [30/35] time 0.479 (0.443) data 0.315 (0.285) loss_x loss_x 0.1549 (0.2818) acc_x 100.0000 (94.0625) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [35/35] time 0.402 (0.439) data 0.239 (0.282) loss_x loss_x 0.3005 (0.2756) acc_x 96.8750 (94.2857) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/15] time 0.440 (0.436) data 0.278 (0.278) loss_u loss_u 0.8945 (0.8938) acc_u 12.5000 (12.5000) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/15] time 0.426 (0.435) data 0.264 (0.276) loss_u loss_u 0.8975 (0.8987) acc_u 12.5000 (11.8750) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/15] time 0.428 (0.432) data 0.264 (0.275) loss_u loss_u 0.9214 (0.8975) acc_u 9.3750 (11.8750) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 154
confident_label rate tensor(0.6942, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1133
clean true:1131
clean false:2
clean_rate:0.9982347749338041
noisy true:347
noisy false:152
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 499
epoch [144/200] batch [5/35] time 0.391 (0.420) data 0.229 (0.257) loss_x loss_x 0.1294 (0.2272) acc_x 96.8750 (96.2500) lr 3.8709e-04 eta 0:00:12
epoch [144/200] batch [10/35] time 0.431 (0.416) data 0.268 (0.261) loss_x loss_x 0.3135 (0.2706) acc_x 93.7500 (94.3750) lr 3.8709e-04 eta 0:00:10
epoch [144/200] batch [15/35] time 0.442 (0.426) data 0.282 (0.269) loss_x loss_x 0.3486 (0.2675) acc_x 96.8750 (95.2083) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [20/35] time 0.429 (0.432) data 0.264 (0.273) loss_x loss_x 0.1929 (0.2942) acc_x 93.7500 (94.5312) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [25/35] time 0.431 (0.430) data 0.268 (0.274) loss_x loss_x 0.5371 (0.3107) acc_x 87.5000 (93.7500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [30/35] time 0.439 (0.432) data 0.275 (0.274) loss_x loss_x 0.1150 (0.3077) acc_x 96.8750 (93.8542) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [35/35] time 0.349 (0.431) data 0.271 (0.275) loss_x loss_x 0.4753 (0.3041) acc_x 87.5000 (93.6607) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/15] time 0.398 (0.428) data 0.229 (0.271) loss_u loss_u 0.8286 (0.8775) acc_u 21.8750 (14.3750) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/15] time 0.422 (0.429) data 0.260 (0.271) loss_u loss_u 0.9253 (0.8763) acc_u 9.3750 (14.6875) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/15] time 0.302 (0.424) data 0.224 (0.267) loss_u loss_u 0.8916 (0.8811) acc_u 15.6250 (14.3750) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 145
confident_label rate tensor(0.6991, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1141
clean true:1139
clean false:2
clean_rate:0.9982471516213848
noisy true:348
noisy false:143
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 491
epoch [145/200] batch [5/35] time 0.430 (0.443) data 0.268 (0.297) loss_x loss_x 0.2744 (0.3258) acc_x 93.7500 (92.5000) lr 3.7476e-04 eta 0:00:13
epoch [145/200] batch [10/35] time 0.465 (0.448) data 0.303 (0.294) loss_x loss_x 0.3018 (0.3329) acc_x 96.8750 (93.4375) lr 3.7476e-04 eta 0:00:11
epoch [145/200] batch [15/35] time 0.442 (0.452) data 0.280 (0.295) loss_x loss_x 0.5005 (0.3162) acc_x 87.5000 (93.5417) lr 3.7476e-04 eta 0:00:09
epoch [145/200] batch [20/35] time 0.440 (0.449) data 0.276 (0.293) loss_x loss_x 0.3481 (0.3030) acc_x 90.6250 (93.2812) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [25/35] time 0.409 (0.440) data 0.244 (0.281) loss_x loss_x 0.4009 (0.2984) acc_x 90.6250 (93.3750) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [30/35] time 0.459 (0.440) data 0.293 (0.281) loss_x loss_x 0.3582 (0.2972) acc_x 93.7500 (93.1250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [35/35] time 0.460 (0.440) data 0.296 (0.282) loss_x loss_x 0.3223 (0.3203) acc_x 90.6250 (92.2321) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/15] time 0.425 (0.441) data 0.258 (0.282) loss_u loss_u 0.9009 (0.8939) acc_u 9.3750 (12.5000) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/15] time 0.436 (0.439) data 0.266 (0.279) loss_u loss_u 0.8525 (0.8708) acc_u 18.7500 (15.0000) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/15] time 0.378 (0.432) data 0.210 (0.273) loss_u loss_u 0.8843 (0.8854) acc_u 12.5000 (13.5417) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 157
confident_label rate tensor(0.6918, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1129
clean true:1128
clean false:1
clean_rate:0.9991142604074402
noisy true:347
noisy false:156
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 503
epoch [146/200] batch [5/35] time 0.480 (0.470) data 0.319 (0.310) loss_x loss_x 0.3708 (0.2930) acc_x 90.6250 (95.6250) lr 3.6258e-04 eta 0:00:14
epoch [146/200] batch [10/35] time 0.443 (0.450) data 0.281 (0.289) loss_x loss_x 0.2098 (0.3046) acc_x 100.0000 (95.0000) lr 3.6258e-04 eta 0:00:11
epoch [146/200] batch [15/35] time 0.454 (0.451) data 0.290 (0.290) loss_x loss_x 0.2292 (0.3264) acc_x 96.8750 (94.1667) lr 3.6258e-04 eta 0:00:09
epoch [146/200] batch [20/35] time 0.426 (0.446) data 0.267 (0.286) loss_x loss_x 0.3823 (0.3251) acc_x 87.5000 (93.5938) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [25/35] time 0.443 (0.442) data 0.279 (0.284) loss_x loss_x 0.3403 (0.3249) acc_x 87.5000 (93.2500) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [30/35] time 0.461 (0.445) data 0.296 (0.286) loss_x loss_x 0.1267 (0.3031) acc_x 100.0000 (93.8542) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [35/35] time 0.426 (0.446) data 0.260 (0.288) loss_x loss_x 0.1779 (0.2919) acc_x 100.0000 (93.9286) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/15] time 0.436 (0.441) data 0.274 (0.282) loss_u loss_u 0.8867 (0.8342) acc_u 18.7500 (20.6250) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/15] time 0.394 (0.437) data 0.222 (0.279) loss_u loss_u 0.8887 (0.8605) acc_u 12.5000 (16.8750) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/15] time 0.391 (0.433) data 0.219 (0.274) loss_u loss_u 0.8291 (0.8707) acc_u 18.7500 (15.2083) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 136
confident_label rate tensor(0.6991, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1141
clean true:1139
clean false:2
clean_rate:0.9982471516213848
noisy true:357
noisy false:134
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 491
epoch [147/200] batch [5/35] time 0.504 (0.450) data 0.339 (0.302) loss_x loss_x 0.3638 (0.3378) acc_x 90.6250 (89.3750) lr 3.5055e-04 eta 0:00:13
epoch [147/200] batch [10/35] time 0.455 (0.455) data 0.295 (0.299) loss_x loss_x 0.1882 (0.2821) acc_x 100.0000 (92.8125) lr 3.5055e-04 eta 0:00:11
epoch [147/200] batch [15/35] time 0.454 (0.461) data 0.288 (0.302) loss_x loss_x 0.1633 (0.2430) acc_x 93.7500 (93.9583) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [20/35] time 0.508 (0.456) data 0.344 (0.301) loss_x loss_x 0.3792 (0.2543) acc_x 93.7500 (94.0625) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [25/35] time 0.517 (0.463) data 0.352 (0.306) loss_x loss_x 0.2063 (0.2471) acc_x 96.8750 (94.6250) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [30/35] time 0.451 (0.465) data 0.268 (0.309) loss_x loss_x 0.3745 (0.2609) acc_x 93.7500 (94.2708) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [35/35] time 0.433 (0.463) data 0.269 (0.306) loss_x loss_x 0.3167 (0.2733) acc_x 87.5000 (93.4821) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/15] time 0.440 (0.463) data 0.272 (0.304) loss_u loss_u 0.9497 (0.8812) acc_u 6.2500 (14.3750) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/15] time 0.427 (0.453) data 0.261 (0.297) loss_u loss_u 0.8999 (0.8849) acc_u 9.3750 (13.1250) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/15] time 0.468 (0.454) data 0.302 (0.297) loss_u loss_u 0.9941 (0.8904) acc_u 0.0000 (12.5000) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 143
confident_label rate tensor(0.6985, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1140
clean true:1139
clean false:1
clean_rate:0.9991228070175439
noisy true:350
noisy false:142
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 492
epoch [148/200] batch [5/35] time 0.374 (0.432) data 0.296 (0.287) loss_x loss_x 0.5088 (0.3526) acc_x 87.5000 (90.6250) lr 3.3869e-04 eta 0:00:12
epoch [148/200] batch [10/35] time 0.438 (0.434) data 0.276 (0.282) loss_x loss_x 0.2607 (0.3166) acc_x 96.8750 (92.5000) lr 3.3869e-04 eta 0:00:10
epoch [148/200] batch [15/35] time 0.519 (0.454) data 0.358 (0.298) loss_x loss_x 0.2883 (0.3019) acc_x 93.7500 (93.3333) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [20/35] time 0.455 (0.452) data 0.292 (0.297) loss_x loss_x 0.2810 (0.3164) acc_x 90.6250 (92.5000) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [25/35] time 0.387 (0.441) data 0.221 (0.284) loss_x loss_x 0.1918 (0.3090) acc_x 93.7500 (92.5000) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [30/35] time 0.458 (0.440) data 0.296 (0.282) loss_x loss_x 0.3979 (0.3111) acc_x 90.6250 (92.5000) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [35/35] time 0.463 (0.440) data 0.299 (0.284) loss_x loss_x 0.3257 (0.3008) acc_x 96.8750 (93.0357) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/15] time 0.391 (0.438) data 0.221 (0.280) loss_u loss_u 0.9180 (0.8952) acc_u 9.3750 (11.2500) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/15] time 0.393 (0.432) data 0.224 (0.273) loss_u loss_u 0.9131 (0.8872) acc_u 9.3750 (11.8750) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/15] time 0.432 (0.430) data 0.263 (0.272) loss_u loss_u 0.8774 (0.8923) acc_u 12.5000 (11.6667) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 136
confident_label rate tensor(0.6985, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1140
clean true:1138
clean false:2
clean_rate:0.9982456140350877
noisy true:358
noisy false:134
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 492
epoch [149/200] batch [5/35] time 0.426 (0.452) data 0.260 (0.285) loss_x loss_x 0.2937 (0.2515) acc_x 93.7500 (94.3750) lr 3.2699e-04 eta 0:00:13
epoch [149/200] batch [10/35] time 0.469 (0.445) data 0.304 (0.280) loss_x loss_x 0.2998 (0.2785) acc_x 90.6250 (94.0625) lr 3.2699e-04 eta 0:00:11
epoch [149/200] batch [15/35] time 0.437 (0.453) data 0.276 (0.294) loss_x loss_x 0.1725 (0.2552) acc_x 96.8750 (94.7917) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [20/35] time 0.454 (0.447) data 0.291 (0.288) loss_x loss_x 0.2463 (0.2690) acc_x 93.7500 (94.6875) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [25/35] time 0.445 (0.446) data 0.284 (0.287) loss_x loss_x 0.3420 (0.2769) acc_x 90.6250 (94.2500) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [30/35] time 0.438 (0.447) data 0.281 (0.288) loss_x loss_x 0.2524 (0.2717) acc_x 93.7500 (94.5833) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [35/35] time 0.435 (0.448) data 0.273 (0.289) loss_x loss_x 0.2715 (0.2755) acc_x 96.8750 (94.1071) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/15] time 0.362 (0.446) data 0.283 (0.289) loss_u loss_u 0.8735 (0.8881) acc_u 12.5000 (11.8750) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/15] time 0.461 (0.444) data 0.291 (0.285) loss_u loss_u 0.8833 (0.8930) acc_u 12.5000 (11.5625) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/15] time 0.403 (0.439) data 0.237 (0.280) loss_u loss_u 0.9043 (0.8917) acc_u 12.5000 (11.8750) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 151
confident_label rate tensor(0.6949, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1134
clean true:1132
clean false:2
clean_rate:0.9982363315696648
noisy true:349
noisy false:149
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 498
epoch [150/200] batch [5/35] time 0.427 (0.455) data 0.267 (0.296) loss_x loss_x 0.3213 (0.3097) acc_x 90.6250 (93.1250) lr 3.1545e-04 eta 0:00:13
epoch [150/200] batch [10/35] time 0.461 (0.460) data 0.298 (0.298) loss_x loss_x 0.3406 (0.2574) acc_x 93.7500 (95.0000) lr 3.1545e-04 eta 0:00:11
epoch [150/200] batch [15/35] time 0.437 (0.459) data 0.273 (0.296) loss_x loss_x 0.5098 (0.2826) acc_x 87.5000 (94.1667) lr 3.1545e-04 eta 0:00:09
epoch [150/200] batch [20/35] time 0.470 (0.453) data 0.306 (0.294) loss_x loss_x 0.2118 (0.2908) acc_x 96.8750 (93.4375) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [25/35] time 0.405 (0.450) data 0.239 (0.290) loss_x loss_x 0.3794 (0.2738) acc_x 90.6250 (94.0000) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [30/35] time 0.470 (0.446) data 0.309 (0.288) loss_x loss_x 0.5317 (0.2809) acc_x 90.6250 (94.2708) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [35/35] time 0.401 (0.445) data 0.239 (0.286) loss_x loss_x 0.2213 (0.2861) acc_x 96.8750 (93.8393) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/15] time 0.386 (0.439) data 0.307 (0.281) loss_u loss_u 0.8403 (0.8814) acc_u 18.7500 (14.3750) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/15] time 0.450 (0.441) data 0.284 (0.283) loss_u loss_u 0.8560 (0.8856) acc_u 15.6250 (13.4375) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/15] time 0.488 (0.444) data 0.327 (0.285) loss_u loss_u 0.8921 (0.8804) acc_u 12.5000 (14.1667) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 156
confident_label rate tensor(0.6930, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1131
clean true:1130
clean false:1
clean_rate:0.9991158267020336
noisy true:346
noisy false:155
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 501
epoch [151/200] batch [5/35] time 0.455 (0.420) data 0.295 (0.270) loss_x loss_x 0.1283 (0.2929) acc_x 100.0000 (94.3750) lr 3.0409e-04 eta 0:00:12
epoch [151/200] batch [10/35] time 0.466 (0.432) data 0.307 (0.275) loss_x loss_x 0.1061 (0.2510) acc_x 100.0000 (95.6250) lr 3.0409e-04 eta 0:00:10
epoch [151/200] batch [15/35] time 0.449 (0.435) data 0.284 (0.276) loss_x loss_x 0.2087 (0.2770) acc_x 96.8750 (94.3750) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [20/35] time 0.486 (0.442) data 0.322 (0.286) loss_x loss_x 0.3945 (0.2796) acc_x 87.5000 (94.2188) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [25/35] time 0.467 (0.446) data 0.302 (0.288) loss_x loss_x 0.2566 (0.2957) acc_x 93.7500 (93.6250) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [30/35] time 0.419 (0.446) data 0.291 (0.289) loss_x loss_x 0.2866 (0.2862) acc_x 93.7500 (94.0625) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [35/35] time 0.449 (0.449) data 0.284 (0.290) loss_x loss_x 0.4795 (0.2924) acc_x 87.5000 (93.8393) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/15] time 0.419 (0.451) data 0.258 (0.291) loss_u loss_u 0.7866 (0.8957) acc_u 28.1250 (11.8750) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/15] time 0.412 (0.443) data 0.248 (0.285) loss_u loss_u 0.8691 (0.8707) acc_u 15.6250 (15.0000) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/15] time 0.473 (0.444) data 0.311 (0.285) loss_u loss_u 0.8721 (0.8706) acc_u 12.5000 (15.0000) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 155
confident_label rate tensor(0.6893, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1125
clean true:1123
clean false:2
clean_rate:0.9982222222222222
noisy true:354
noisy false:153
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 507
epoch [152/200] batch [5/35] time 0.436 (0.438) data 0.267 (0.275) loss_x loss_x 0.4946 (0.3008) acc_x 87.5000 (93.7500) lr 2.9289e-04 eta 0:00:13
epoch [152/200] batch [10/35] time 0.453 (0.446) data 0.287 (0.282) loss_x loss_x 0.5630 (0.3221) acc_x 84.3750 (93.4375) lr 2.9289e-04 eta 0:00:11
epoch [152/200] batch [15/35] time 0.394 (0.429) data 0.229 (0.265) loss_x loss_x 0.1600 (0.3162) acc_x 100.0000 (93.5417) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [20/35] time 0.457 (0.427) data 0.297 (0.267) loss_x loss_x 0.2510 (0.3205) acc_x 93.7500 (93.1250) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [25/35] time 0.429 (0.433) data 0.267 (0.272) loss_x loss_x 0.3630 (0.3070) acc_x 93.7500 (93.7500) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [30/35] time 0.473 (0.435) data 0.311 (0.274) loss_x loss_x 0.1133 (0.2994) acc_x 96.8750 (93.9583) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [35/35] time 0.500 (0.437) data 0.338 (0.278) loss_x loss_x 0.2292 (0.2795) acc_x 96.8750 (94.6429) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/15] time 0.470 (0.440) data 0.303 (0.281) loss_u loss_u 0.7969 (0.8396) acc_u 25.0000 (19.3750) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/15] time 0.544 (0.450) data 0.381 (0.290) loss_u loss_u 0.8623 (0.8583) acc_u 12.5000 (16.2500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/15] time 0.430 (0.449) data 0.266 (0.290) loss_u loss_u 0.9492 (0.8674) acc_u 6.2500 (15.6250) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 151
confident_label rate tensor(0.6936, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1132
clean true:1132
clean false:0
clean_rate:1.0
noisy true:349
noisy false:151
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 500
epoch [153/200] batch [5/35] time 0.441 (0.427) data 0.281 (0.283) loss_x loss_x 0.1252 (0.2169) acc_x 96.8750 (96.8750) lr 2.8187e-04 eta 0:00:12
epoch [153/200] batch [10/35] time 0.598 (0.455) data 0.437 (0.302) loss_x loss_x 0.3064 (0.2407) acc_x 90.6250 (94.0625) lr 2.8187e-04 eta 0:00:11
epoch [153/200] batch [15/35] time 0.508 (0.464) data 0.341 (0.313) loss_x loss_x 0.6934 (0.2518) acc_x 84.3750 (94.5833) lr 2.8187e-04 eta 0:00:09
epoch [153/200] batch [20/35] time 0.507 (0.474) data 0.340 (0.319) loss_x loss_x 0.2598 (0.2622) acc_x 96.8750 (93.7500) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [25/35] time 0.468 (0.473) data 0.301 (0.320) loss_x loss_x 0.2786 (0.2754) acc_x 93.7500 (93.5000) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [30/35] time 0.498 (0.477) data 0.332 (0.322) loss_x loss_x 0.2385 (0.2689) acc_x 90.6250 (93.7500) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [35/35] time 0.450 (0.475) data 0.290 (0.321) loss_x loss_x 0.3064 (0.2633) acc_x 90.6250 (94.0179) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/15] time 0.402 (0.468) data 0.233 (0.312) loss_u loss_u 0.8579 (0.8612) acc_u 15.6250 (16.8750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/15] time 0.438 (0.465) data 0.271 (0.307) loss_u loss_u 0.8794 (0.8707) acc_u 18.7500 (15.6250) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/15] time 0.464 (0.466) data 0.297 (0.309) loss_u loss_u 0.9253 (0.8864) acc_u 9.3750 (13.7500) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 143
confident_label rate tensor(0.6936, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1132
clean true:1131
clean false:1
clean_rate:0.9991166077738516
noisy true:358
noisy false:142
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 500
epoch [154/200] batch [5/35] time 0.461 (0.420) data 0.298 (0.273) loss_x loss_x 0.3628 (0.3591) acc_x 93.7500 (92.5000) lr 2.7103e-04 eta 0:00:12
epoch [154/200] batch [10/35] time 0.489 (0.443) data 0.327 (0.288) loss_x loss_x 0.4438 (0.3272) acc_x 84.3750 (91.8750) lr 2.7103e-04 eta 0:00:11
epoch [154/200] batch [15/35] time 0.302 (0.428) data 0.223 (0.277) loss_x loss_x 0.3062 (0.3260) acc_x 90.6250 (91.8750) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [20/35] time 0.428 (0.431) data 0.265 (0.276) loss_x loss_x 0.0817 (0.3094) acc_x 100.0000 (92.3438) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [25/35] time 0.468 (0.434) data 0.310 (0.278) loss_x loss_x 0.3118 (0.2888) acc_x 93.7500 (93.1250) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [30/35] time 0.440 (0.435) data 0.271 (0.281) loss_x loss_x 0.5874 (0.2860) acc_x 87.5000 (93.4375) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [35/35] time 0.447 (0.438) data 0.283 (0.282) loss_x loss_x 0.4478 (0.2958) acc_x 90.6250 (93.3929) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/15] time 0.449 (0.442) data 0.285 (0.285) loss_u loss_u 0.9702 (0.9115) acc_u 3.1250 (9.3750) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/15] time 0.451 (0.441) data 0.280 (0.286) loss_u loss_u 0.9609 (0.8873) acc_u 6.2500 (12.8125) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/15] time 0.526 (0.448) data 0.360 (0.291) loss_u loss_u 0.7886 (0.8785) acc_u 21.8750 (13.7500) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 153
confident_label rate tensor(0.6893, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1125
clean true:1124
clean false:1
clean_rate:0.9991111111111111
noisy true:355
noisy false:152
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 507
epoch [155/200] batch [5/35] time 0.469 (0.470) data 0.305 (0.323) loss_x loss_x 0.3584 (0.2417) acc_x 87.5000 (94.3750) lr 2.6037e-04 eta 0:00:14
epoch [155/200] batch [10/35] time 0.487 (0.469) data 0.325 (0.314) loss_x loss_x 0.2622 (0.2559) acc_x 93.7500 (92.5000) lr 2.6037e-04 eta 0:00:11
epoch [155/200] batch [15/35] time 0.410 (0.469) data 0.332 (0.317) loss_x loss_x 0.3477 (0.2774) acc_x 87.5000 (92.5000) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [20/35] time 0.477 (0.470) data 0.315 (0.315) loss_x loss_x 0.2615 (0.2982) acc_x 96.8750 (92.6562) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [25/35] time 0.469 (0.472) data 0.309 (0.316) loss_x loss_x 0.2646 (0.3009) acc_x 96.8750 (92.7500) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [30/35] time 0.394 (0.460) data 0.233 (0.303) loss_x loss_x 0.1621 (0.2825) acc_x 96.8750 (93.1250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [35/35] time 0.449 (0.456) data 0.286 (0.299) loss_x loss_x 0.4287 (0.2825) acc_x 90.6250 (93.4821) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/15] time 0.425 (0.452) data 0.262 (0.296) loss_u loss_u 0.9248 (0.9059) acc_u 9.3750 (11.2500) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/15] time 0.434 (0.456) data 0.268 (0.299) loss_u loss_u 0.8311 (0.8802) acc_u 18.7500 (14.3750) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/15] time 0.447 (0.454) data 0.277 (0.296) loss_u loss_u 0.8726 (0.8808) acc_u 18.7500 (14.3750) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 120
confident_label rate tensor(0.7065, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1153
clean true:1151
clean false:2
clean_rate:0.9982653946227233
noisy true:361
noisy false:118
after delete: len(clean_dataset) 1153
after delete: len(noisy_dataset) 479
epoch [156/200] batch [5/36] time 0.426 (0.452) data 0.262 (0.289) loss_x loss_x 0.3337 (0.3126) acc_x 90.6250 (92.5000) lr 2.4989e-04 eta 0:00:14
epoch [156/200] batch [10/36] time 0.445 (0.452) data 0.285 (0.287) loss_x loss_x 0.2034 (0.2466) acc_x 93.7500 (93.7500) lr 2.4989e-04 eta 0:00:11
epoch [156/200] batch [15/36] time 0.491 (0.464) data 0.325 (0.300) loss_x loss_x 0.4255 (0.2820) acc_x 90.6250 (93.3333) lr 2.4989e-04 eta 0:00:09
epoch [156/200] batch [20/36] time 0.452 (0.471) data 0.291 (0.309) loss_x loss_x 0.1406 (0.2555) acc_x 100.0000 (94.5312) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [25/36] time 0.472 (0.468) data 0.314 (0.305) loss_x loss_x 0.2654 (0.2597) acc_x 96.8750 (94.6250) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [30/36] time 0.445 (0.472) data 0.310 (0.310) loss_x loss_x 0.2462 (0.2767) acc_x 96.8750 (94.0625) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [35/36] time 0.445 (0.469) data 0.286 (0.309) loss_x loss_x 0.2048 (0.2805) acc_x 93.7500 (94.0179) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/14] time 0.443 (0.469) data 0.274 (0.309) loss_u loss_u 0.8774 (0.9086) acc_u 12.5000 (10.0000) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/14] time 0.413 (0.464) data 0.249 (0.305) loss_u loss_u 0.8643 (0.8923) acc_u 15.6250 (12.1875) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 160
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1124
clean true:1123
clean false:1
clean_rate:0.9991103202846975
noisy true:349
noisy false:159
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 508
epoch [157/200] batch [5/35] time 0.421 (0.471) data 0.256 (0.305) loss_x loss_x 0.1802 (0.2662) acc_x 96.8750 (94.3750) lr 2.3959e-04 eta 0:00:14
epoch [157/200] batch [10/35] time 0.457 (0.471) data 0.295 (0.314) loss_x loss_x 0.2034 (0.2821) acc_x 93.7500 (93.4375) lr 2.3959e-04 eta 0:00:11
epoch [157/200] batch [15/35] time 0.443 (0.475) data 0.277 (0.316) loss_x loss_x 0.0986 (0.2514) acc_x 100.0000 (94.5833) lr 2.3959e-04 eta 0:00:09
epoch [157/200] batch [20/35] time 0.471 (0.455) data 0.309 (0.299) loss_x loss_x 0.3140 (0.2500) acc_x 93.7500 (94.8438) lr 2.3959e-04 eta 0:00:06
epoch [157/200] batch [25/35] time 0.483 (0.453) data 0.323 (0.296) loss_x loss_x 0.3584 (0.2545) acc_x 90.6250 (94.5000) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [30/35] time 0.504 (0.452) data 0.345 (0.298) loss_x loss_x 0.2971 (0.2609) acc_x 96.8750 (94.3750) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [35/35] time 0.457 (0.456) data 0.296 (0.301) loss_x loss_x 0.1312 (0.2522) acc_x 100.0000 (94.6429) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/15] time 0.540 (0.457) data 0.381 (0.303) loss_u loss_u 0.9429 (0.9154) acc_u 6.2500 (9.3750) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/15] time 0.433 (0.458) data 0.261 (0.302) loss_u loss_u 0.8730 (0.8757) acc_u 15.6250 (14.6875) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/15] time 0.436 (0.455) data 0.271 (0.298) loss_u loss_u 0.8823 (0.8727) acc_u 15.6250 (14.5833) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 133
confident_label rate tensor(0.6973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1138
clean true:1138
clean false:0
clean_rate:1.0
noisy true:361
noisy false:133
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 494
epoch [158/200] batch [5/35] time 0.467 (0.458) data 0.303 (0.311) loss_x loss_x 0.1724 (0.2555) acc_x 96.8750 (96.2500) lr 2.2949e-04 eta 0:00:13
epoch [158/200] batch [10/35] time 0.505 (0.467) data 0.344 (0.312) loss_x loss_x 0.4141 (0.2579) acc_x 90.6250 (95.3125) lr 2.2949e-04 eta 0:00:11
epoch [158/200] batch [15/35] time 0.412 (0.475) data 0.334 (0.323) loss_x loss_x 0.2499 (0.2711) acc_x 93.7500 (94.5833) lr 2.2949e-04 eta 0:00:09
epoch [158/200] batch [20/35] time 0.463 (0.470) data 0.306 (0.315) loss_x loss_x 0.2793 (0.2801) acc_x 96.8750 (94.2188) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [25/35] time 0.492 (0.473) data 0.329 (0.317) loss_x loss_x 0.2446 (0.2894) acc_x 93.7500 (93.6250) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [30/35] time 0.414 (0.466) data 0.254 (0.312) loss_x loss_x 0.0920 (0.2756) acc_x 100.0000 (94.0625) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [35/35] time 0.448 (0.457) data 0.287 (0.301) loss_x loss_x 0.3909 (0.2888) acc_x 93.7500 (93.5714) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/15] time 0.441 (0.454) data 0.277 (0.297) loss_u loss_u 0.9707 (0.8881) acc_u 3.1250 (13.7500) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/15] time 0.442 (0.450) data 0.274 (0.294) loss_u loss_u 0.9443 (0.8867) acc_u 6.2500 (13.7500) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/15] time 0.433 (0.448) data 0.269 (0.291) loss_u loss_u 0.9087 (0.8956) acc_u 12.5000 (13.1250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 146
confident_label rate tensor(0.6967, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1137
clean true:1136
clean false:1
clean_rate:0.9991204925241864
noisy true:350
noisy false:145
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 495
epoch [159/200] batch [5/35] time 0.346 (0.353) data 0.269 (0.275) loss_x loss_x 0.1604 (0.2167) acc_x 96.8750 (95.6250) lr 2.1957e-04 eta 0:00:10
epoch [159/200] batch [10/35] time 0.354 (0.351) data 0.276 (0.273) loss_x loss_x 0.2590 (0.2295) acc_x 93.7500 (95.3125) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [15/35] time 0.344 (0.348) data 0.266 (0.271) loss_x loss_x 0.2312 (0.2642) acc_x 90.6250 (94.1667) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [20/35] time 0.295 (0.341) data 0.217 (0.264) loss_x loss_x 0.3049 (0.2822) acc_x 90.6250 (93.7500) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [25/35] time 0.334 (0.336) data 0.256 (0.258) loss_x loss_x 0.1661 (0.2786) acc_x 96.8750 (94.1250) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [30/35] time 0.335 (0.337) data 0.257 (0.259) loss_x loss_x 0.3862 (0.2785) acc_x 90.6250 (93.8542) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [35/35] time 0.346 (0.338) data 0.268 (0.260) loss_x loss_x 0.3242 (0.2762) acc_x 90.6250 (93.6607) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/15] time 0.353 (0.339) data 0.275 (0.261) loss_u loss_u 0.8750 (0.9010) acc_u 15.6250 (10.6250) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/15] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9194 (0.8994) acc_u 9.3750 (11.5625) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [15/15] time 0.353 (0.341) data 0.274 (0.263) loss_u loss_u 0.8242 (0.8821) acc_u 18.7500 (13.3333) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 139
confident_label rate tensor(0.7010, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1144
clean true:1142
clean false:2
clean_rate:0.9982517482517482
noisy true:351
noisy false:137
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 488
epoch [160/200] batch [5/35] time 0.351 (0.357) data 0.274 (0.279) loss_x loss_x 0.4644 (0.3288) acc_x 81.2500 (91.2500) lr 2.0984e-04 eta 0:00:10
epoch [160/200] batch [10/35] time 0.346 (0.354) data 0.267 (0.276) loss_x loss_x 0.2373 (0.3177) acc_x 96.8750 (92.1875) lr 2.0984e-04 eta 0:00:08
epoch [160/200] batch [15/35] time 0.341 (0.349) data 0.263 (0.271) loss_x loss_x 0.2054 (0.3028) acc_x 96.8750 (93.3333) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [20/35] time 0.339 (0.347) data 0.262 (0.269) loss_x loss_x 0.2172 (0.2938) acc_x 96.8750 (93.5938) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [25/35] time 0.287 (0.339) data 0.208 (0.261) loss_x loss_x 0.2878 (0.2901) acc_x 96.8750 (94.0000) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [30/35] time 0.327 (0.337) data 0.249 (0.259) loss_x loss_x 0.2095 (0.2898) acc_x 96.8750 (93.8542) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [35/35] time 0.349 (0.338) data 0.272 (0.260) loss_x loss_x 0.2830 (0.2790) acc_x 96.8750 (94.2857) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/15] time 0.340 (0.338) data 0.262 (0.261) loss_u loss_u 0.9395 (0.8852) acc_u 6.2500 (13.7500) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/15] time 0.460 (0.345) data 0.380 (0.267) loss_u loss_u 0.8730 (0.8904) acc_u 12.5000 (12.5000) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/15] time 0.350 (0.348) data 0.272 (0.270) loss_u loss_u 0.9126 (0.8863) acc_u 9.3750 (13.1250) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 142
confident_label rate tensor(0.7004, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1143
clean true:1142
clean false:1
clean_rate:0.9991251093613298
noisy true:348
noisy false:141
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 489
epoch [161/200] batch [5/35] time 0.337 (0.343) data 0.260 (0.266) loss_x loss_x 0.1602 (0.2139) acc_x 96.8750 (96.2500) lr 2.0032e-04 eta 0:00:10
epoch [161/200] batch [10/35] time 0.353 (0.347) data 0.275 (0.269) loss_x loss_x 0.1002 (0.2375) acc_x 100.0000 (95.6250) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [15/35] time 0.338 (0.347) data 0.261 (0.269) loss_x loss_x 0.3555 (0.2710) acc_x 90.6250 (94.1667) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [20/35] time 0.355 (0.348) data 0.277 (0.271) loss_x loss_x 0.3928 (0.2734) acc_x 90.6250 (94.3750) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [25/35] time 0.334 (0.344) data 0.254 (0.267) loss_x loss_x 0.2153 (0.2606) acc_x 96.8750 (95.0000) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [30/35] time 0.344 (0.345) data 0.267 (0.267) loss_x loss_x 0.1138 (0.2488) acc_x 100.0000 (95.3125) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [35/35] time 0.329 (0.343) data 0.251 (0.265) loss_x loss_x 0.3660 (0.2438) acc_x 90.6250 (95.2679) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/15] time 0.335 (0.342) data 0.256 (0.264) loss_u loss_u 0.9346 (0.9198) acc_u 6.2500 (10.0000) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/15] time 0.337 (0.342) data 0.259 (0.264) loss_u loss_u 0.8662 (0.9099) acc_u 15.6250 (10.6250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/15] time 0.340 (0.341) data 0.263 (0.263) loss_u loss_u 0.8604 (0.9002) acc_u 15.6250 (12.0833) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 157
confident_label rate tensor(0.6857, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1119
clean true:1118
clean false:1
clean_rate:0.9991063449508489
noisy true:357
noisy false:156
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 513
epoch [162/200] batch [5/34] time 0.340 (0.349) data 0.263 (0.271) loss_x loss_x 0.2939 (0.2835) acc_x 90.6250 (93.1250) lr 1.9098e-04 eta 0:00:10
epoch [162/200] batch [10/34] time 0.326 (0.343) data 0.249 (0.265) loss_x loss_x 0.5649 (0.3284) acc_x 84.3750 (92.1875) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [15/34] time 0.342 (0.341) data 0.264 (0.263) loss_x loss_x 0.2402 (0.3323) acc_x 100.0000 (92.7083) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [20/34] time 0.299 (0.336) data 0.221 (0.258) loss_x loss_x 0.1893 (0.2976) acc_x 96.8750 (93.5938) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [25/34] time 0.352 (0.336) data 0.275 (0.258) loss_x loss_x 0.1769 (0.2787) acc_x 93.7500 (94.0000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [30/34] time 0.346 (0.337) data 0.268 (0.259) loss_x loss_x 0.1283 (0.2761) acc_x 96.8750 (93.7500) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [5/16] time 0.352 (0.337) data 0.274 (0.260) loss_u loss_u 0.7080 (0.8499) acc_u 31.2500 (17.5000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/16] time 0.350 (0.339) data 0.271 (0.261) loss_u loss_u 0.8911 (0.8556) acc_u 12.5000 (16.8750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/16] time 0.359 (0.339) data 0.280 (0.261) loss_u loss_u 0.8892 (0.8601) acc_u 12.5000 (16.4583) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 147
confident_label rate tensor(0.6949, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1134
clean true:1133
clean false:1
clean_rate:0.9991181657848325
noisy true:352
noisy false:146
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 498
epoch [163/200] batch [5/35] time 0.335 (0.340) data 0.258 (0.263) loss_x loss_x 0.4910 (0.2959) acc_x 87.5000 (95.6250) lr 1.8185e-04 eta 0:00:10
epoch [163/200] batch [10/35] time 0.332 (0.343) data 0.254 (0.266) loss_x loss_x 0.3625 (0.2783) acc_x 87.5000 (95.0000) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [15/35] time 0.336 (0.343) data 0.259 (0.265) loss_x loss_x 0.2150 (0.2601) acc_x 96.8750 (95.6250) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [20/35] time 0.331 (0.340) data 0.253 (0.262) loss_x loss_x 0.3708 (0.2500) acc_x 90.6250 (95.4688) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [25/35] time 0.305 (0.336) data 0.228 (0.258) loss_x loss_x 0.1841 (0.2478) acc_x 96.8750 (95.3750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [30/35] time 0.344 (0.336) data 0.265 (0.259) loss_x loss_x 0.4121 (0.2584) acc_x 87.5000 (94.7917) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [35/35] time 0.356 (0.338) data 0.278 (0.260) loss_x loss_x 0.3491 (0.2620) acc_x 93.7500 (94.6429) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/15] time 0.335 (0.339) data 0.257 (0.261) loss_u loss_u 0.9355 (0.9003) acc_u 6.2500 (11.8750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/15] time 0.335 (0.338) data 0.257 (0.260) loss_u loss_u 0.9233 (0.8916) acc_u 9.3750 (13.1250) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/15] time 0.342 (0.338) data 0.263 (0.260) loss_u loss_u 0.9448 (0.8906) acc_u 6.2500 (13.1250) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 146
confident_label rate tensor(0.6985, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1140
clean true:1136
clean false:4
clean_rate:0.9964912280701754
noisy true:350
noisy false:142
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 492
epoch [164/200] batch [5/35] time 0.349 (0.354) data 0.272 (0.276) loss_x loss_x 0.2295 (0.2986) acc_x 96.8750 (95.0000) lr 1.7292e-04 eta 0:00:10
epoch [164/200] batch [10/35] time 0.296 (0.338) data 0.218 (0.260) loss_x loss_x 0.1064 (0.2631) acc_x 100.0000 (95.0000) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [15/35] time 0.344 (0.331) data 0.267 (0.253) loss_x loss_x 0.3354 (0.2664) acc_x 96.8750 (94.5833) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [20/35] time 0.348 (0.335) data 0.270 (0.258) loss_x loss_x 0.2593 (0.2599) acc_x 93.7500 (94.6875) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [25/35] time 0.341 (0.337) data 0.264 (0.259) loss_x loss_x 0.4976 (0.2748) acc_x 90.6250 (94.2500) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [30/35] time 0.342 (0.337) data 0.263 (0.260) loss_x loss_x 0.4890 (0.2872) acc_x 87.5000 (93.9583) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [35/35] time 0.338 (0.337) data 0.260 (0.259) loss_x loss_x 0.1562 (0.2730) acc_x 100.0000 (94.4643) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/15] time 0.339 (0.337) data 0.260 (0.259) loss_u loss_u 0.9365 (0.8834) acc_u 6.2500 (13.1250) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/15] time 0.340 (0.336) data 0.262 (0.259) loss_u loss_u 0.8647 (0.8833) acc_u 15.6250 (13.1250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [15/15] time 0.342 (0.335) data 0.263 (0.258) loss_u loss_u 0.8965 (0.8824) acc_u 12.5000 (13.5417) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 142
confident_label rate tensor(0.6979, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1139
clean true:1138
clean false:1
clean_rate:0.9991220368744512
noisy true:352
noisy false:141
after delete: len(clean_dataset) 1139
after delete: len(noisy_dataset) 493
epoch [165/200] batch [5/35] time 0.335 (0.345) data 0.257 (0.267) loss_x loss_x 0.2849 (0.3368) acc_x 90.6250 (90.6250) lr 1.6419e-04 eta 0:00:10
epoch [165/200] batch [10/35] time 0.327 (0.342) data 0.248 (0.264) loss_x loss_x 0.0911 (0.2958) acc_x 100.0000 (93.1250) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [15/35] time 0.338 (0.340) data 0.260 (0.262) loss_x loss_x 0.2133 (0.2567) acc_x 96.8750 (94.3750) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [20/35] time 0.346 (0.341) data 0.268 (0.263) loss_x loss_x 0.1816 (0.2615) acc_x 93.7500 (94.6875) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [25/35] time 0.351 (0.343) data 0.274 (0.265) loss_x loss_x 0.4192 (0.2763) acc_x 93.7500 (94.6250) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [30/35] time 0.344 (0.343) data 0.266 (0.266) loss_x loss_x 0.2585 (0.2715) acc_x 93.7500 (94.6875) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [35/35] time 0.341 (0.344) data 0.264 (0.266) loss_x loss_x 0.2998 (0.2752) acc_x 93.7500 (94.4643) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/15] time 0.353 (0.344) data 0.275 (0.266) loss_u loss_u 0.8096 (0.8780) acc_u 18.7500 (14.3750) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/15] time 0.327 (0.344) data 0.249 (0.266) loss_u loss_u 0.8516 (0.8926) acc_u 18.7500 (12.8125) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/15] time 0.358 (0.343) data 0.280 (0.265) loss_u loss_u 0.9072 (0.8970) acc_u 9.3750 (11.8750) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 153
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1126
clean true:1124
clean false:2
clean_rate:0.9982238010657194
noisy true:355
noisy false:151
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 506
epoch [166/200] batch [5/35] time 0.342 (0.347) data 0.264 (0.269) loss_x loss_x 0.3623 (0.2237) acc_x 93.7500 (96.8750) lr 1.5567e-04 eta 0:00:10
epoch [166/200] batch [10/35] time 0.296 (0.336) data 0.218 (0.258) loss_x loss_x 0.4700 (0.2548) acc_x 87.5000 (95.0000) lr 1.5567e-04 eta 0:00:08
epoch [166/200] batch [15/35] time 0.345 (0.335) data 0.268 (0.258) loss_x loss_x 0.1918 (0.2406) acc_x 96.8750 (95.0000) lr 1.5567e-04 eta 0:00:06
epoch [166/200] batch [20/35] time 0.351 (0.337) data 0.273 (0.259) loss_x loss_x 0.1735 (0.2344) acc_x 93.7500 (95.3125) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [25/35] time 0.334 (0.339) data 0.255 (0.261) loss_x loss_x 0.4456 (0.2350) acc_x 93.7500 (95.5000) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [30/35] time 0.340 (0.339) data 0.263 (0.261) loss_x loss_x 0.2177 (0.2413) acc_x 93.7500 (95.0000) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [35/35] time 0.331 (0.339) data 0.253 (0.261) loss_x loss_x 0.6187 (0.2494) acc_x 81.2500 (94.5536) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/15] time 0.348 (0.339) data 0.270 (0.262) loss_u loss_u 0.7593 (0.8688) acc_u 31.2500 (15.6250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/15] time 0.347 (0.340) data 0.269 (0.262) loss_u loss_u 0.9214 (0.8849) acc_u 9.3750 (13.4375) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [15/15] time 0.347 (0.341) data 0.268 (0.263) loss_u loss_u 0.8755 (0.8772) acc_u 12.5000 (14.5833) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 146
confident_label rate tensor(0.6936, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1132
clean true:1131
clean false:1
clean_rate:0.9991166077738516
noisy true:355
noisy false:145
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 500
epoch [167/200] batch [5/35] time 0.343 (0.352) data 0.266 (0.275) loss_x loss_x 0.2161 (0.2185) acc_x 96.8750 (96.8750) lr 1.4736e-04 eta 0:00:10
epoch [167/200] batch [10/35] time 0.306 (0.341) data 0.227 (0.264) loss_x loss_x 0.2355 (0.2263) acc_x 93.7500 (95.6250) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [15/35] time 0.342 (0.344) data 0.264 (0.266) loss_x loss_x 0.1958 (0.2434) acc_x 96.8750 (95.4167) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [20/35] time 0.347 (0.345) data 0.270 (0.267) loss_x loss_x 0.5581 (0.2632) acc_x 90.6250 (94.8438) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [25/35] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.1293 (0.2549) acc_x 96.8750 (94.8750) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [30/35] time 0.339 (0.346) data 0.261 (0.268) loss_x loss_x 0.1315 (0.2515) acc_x 100.0000 (95.0000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [35/35] time 0.345 (0.346) data 0.268 (0.268) loss_x loss_x 0.1702 (0.2416) acc_x 96.8750 (95.1786) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/15] time 0.351 (0.345) data 0.273 (0.267) loss_u loss_u 0.8740 (0.8883) acc_u 18.7500 (12.5000) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/15] time 0.352 (0.344) data 0.274 (0.267) loss_u loss_u 0.8643 (0.8898) acc_u 15.6250 (12.5000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [15/15] time 0.349 (0.344) data 0.270 (0.266) loss_u loss_u 0.8984 (0.8825) acc_u 12.5000 (13.3333) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 132
confident_label rate tensor(0.7022, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1146
clean true:1145
clean false:1
clean_rate:0.9991273996509599
noisy true:355
noisy false:131
after delete: len(clean_dataset) 1146
after delete: len(noisy_dataset) 486
epoch [168/200] batch [5/35] time 0.352 (0.406) data 0.274 (0.328) loss_x loss_x 0.3218 (0.2548) acc_x 93.7500 (95.0000) lr 1.3926e-04 eta 0:00:12
epoch [168/200] batch [10/35] time 0.303 (0.366) data 0.225 (0.288) loss_x loss_x 0.1722 (0.2447) acc_x 93.7500 (93.7500) lr 1.3926e-04 eta 0:00:09
epoch [168/200] batch [15/35] time 0.338 (0.349) data 0.260 (0.271) loss_x loss_x 0.1659 (0.2324) acc_x 96.8750 (94.5833) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [20/35] time 0.334 (0.347) data 0.257 (0.269) loss_x loss_x 0.5254 (0.2483) acc_x 87.5000 (94.2188) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [25/35] time 0.333 (0.345) data 0.255 (0.267) loss_x loss_x 0.2227 (0.2411) acc_x 96.8750 (94.3750) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [30/35] time 0.344 (0.345) data 0.266 (0.267) loss_x loss_x 0.2457 (0.2481) acc_x 96.8750 (94.2708) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [35/35] time 0.334 (0.344) data 0.257 (0.266) loss_x loss_x 0.2369 (0.2504) acc_x 96.8750 (94.1964) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/15] time 0.346 (0.343) data 0.268 (0.266) loss_u loss_u 0.9282 (0.9196) acc_u 9.3750 (9.3750) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/15] time 0.351 (0.343) data 0.273 (0.265) loss_u loss_u 0.8984 (0.9019) acc_u 12.5000 (10.9375) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/15] time 0.353 (0.343) data 0.275 (0.265) loss_u loss_u 0.9155 (0.8932) acc_u 9.3750 (11.8750) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 141
confident_label rate tensor(0.6979, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1139
clean true:1137
clean false:2
clean_rate:0.9982440737489026
noisy true:354
noisy false:139
after delete: len(clean_dataset) 1139
after delete: len(noisy_dataset) 493
epoch [169/200] batch [5/35] time 0.351 (0.366) data 0.273 (0.289) loss_x loss_x 0.2908 (0.2745) acc_x 90.6250 (94.3750) lr 1.3137e-04 eta 0:00:10
epoch [169/200] batch [10/35] time 0.314 (0.349) data 0.235 (0.271) loss_x loss_x 0.2008 (0.2572) acc_x 96.8750 (95.0000) lr 1.3137e-04 eta 0:00:08
epoch [169/200] batch [15/35] time 0.340 (0.346) data 0.262 (0.268) loss_x loss_x 0.3142 (0.2459) acc_x 90.6250 (95.0000) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [20/35] time 0.338 (0.345) data 0.260 (0.267) loss_x loss_x 0.1776 (0.2538) acc_x 100.0000 (94.3750) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [25/35] time 0.341 (0.345) data 0.263 (0.267) loss_x loss_x 0.4185 (0.2723) acc_x 93.7500 (94.2500) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [30/35] time 0.339 (0.343) data 0.261 (0.265) loss_x loss_x 0.1807 (0.2670) acc_x 96.8750 (94.2708) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [35/35] time 0.325 (0.342) data 0.248 (0.264) loss_x loss_x 0.2484 (0.2768) acc_x 93.7500 (94.0179) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/15] time 0.340 (0.341) data 0.262 (0.263) loss_u loss_u 0.7847 (0.8772) acc_u 25.0000 (13.7500) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/15] time 0.320 (0.340) data 0.242 (0.263) loss_u loss_u 0.7900 (0.8799) acc_u 21.8750 (13.4375) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/15] time 0.349 (0.341) data 0.271 (0.263) loss_u loss_u 0.8267 (0.8754) acc_u 18.7500 (13.7500) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 138
confident_label rate tensor(0.6991, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1141
clean true:1140
clean false:1
clean_rate:0.9991235758106923
noisy true:354
noisy false:137
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 491
epoch [170/200] batch [5/35] time 0.347 (0.354) data 0.269 (0.277) loss_x loss_x 0.1265 (0.2401) acc_x 100.0000 (94.3750) lr 1.2369e-04 eta 0:00:10
epoch [170/200] batch [10/35] time 0.302 (0.338) data 0.224 (0.260) loss_x loss_x 0.1725 (0.2444) acc_x 96.8750 (93.4375) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [15/35] time 0.341 (0.334) data 0.263 (0.256) loss_x loss_x 0.1667 (0.2462) acc_x 93.7500 (93.5417) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [20/35] time 0.345 (0.337) data 0.267 (0.260) loss_x loss_x 0.1534 (0.2384) acc_x 100.0000 (94.5312) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [25/35] time 0.343 (0.339) data 0.265 (0.261) loss_x loss_x 0.4033 (0.2489) acc_x 87.5000 (94.0000) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [30/35] time 0.342 (0.339) data 0.264 (0.262) loss_x loss_x 0.2991 (0.2674) acc_x 90.6250 (93.6458) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [35/35] time 0.344 (0.341) data 0.266 (0.264) loss_x loss_x 0.2964 (0.2593) acc_x 93.7500 (93.9286) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/15] time 0.352 (0.341) data 0.275 (0.263) loss_u loss_u 0.8857 (0.9029) acc_u 15.6250 (10.6250) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/15] time 0.341 (0.341) data 0.263 (0.264) loss_u loss_u 0.8843 (0.8845) acc_u 12.5000 (13.4375) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/15] time 0.348 (0.342) data 0.271 (0.264) loss_u loss_u 0.9014 (0.8896) acc_u 9.3750 (12.2917) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 151
confident_label rate tensor(0.6949, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1134
clean true:1132
clean false:2
clean_rate:0.9982363315696648
noisy true:349
noisy false:149
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 498
epoch [171/200] batch [5/35] time 0.352 (0.344) data 0.274 (0.267) loss_x loss_x 0.3838 (0.3161) acc_x 84.3750 (90.6250) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [10/35] time 0.309 (0.340) data 0.231 (0.262) loss_x loss_x 0.3479 (0.3048) acc_x 87.5000 (91.2500) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [15/35] time 0.313 (0.327) data 0.234 (0.249) loss_x loss_x 0.3159 (0.2984) acc_x 84.3750 (91.2500) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [20/35] time 0.342 (0.328) data 0.265 (0.251) loss_x loss_x 0.3452 (0.2903) acc_x 93.7500 (91.5625) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [25/35] time 0.339 (0.331) data 0.262 (0.253) loss_x loss_x 0.2485 (0.2834) acc_x 96.8750 (92.1250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [30/35] time 0.339 (0.333) data 0.262 (0.255) loss_x loss_x 0.1780 (0.2756) acc_x 100.0000 (92.9167) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [35/35] time 0.339 (0.334) data 0.262 (0.256) loss_x loss_x 0.2722 (0.2774) acc_x 90.6250 (92.8571) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/15] time 0.343 (0.335) data 0.265 (0.257) loss_u loss_u 0.9043 (0.9137) acc_u 9.3750 (9.3750) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/15] time 0.341 (0.335) data 0.263 (0.257) loss_u loss_u 0.8237 (0.8924) acc_u 21.8750 (12.1875) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [15/15] time 0.343 (0.336) data 0.265 (0.258) loss_u loss_u 0.7974 (0.8858) acc_u 25.0000 (13.1250) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 145
confident_label rate tensor(0.6991, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1141
clean true:1139
clean false:2
clean_rate:0.9982471516213848
noisy true:348
noisy false:143
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 491
epoch [172/200] batch [5/35] time 0.338 (0.341) data 0.260 (0.263) loss_x loss_x 0.2184 (0.3231) acc_x 96.8750 (91.8750) lr 1.0899e-04 eta 0:00:10
epoch [172/200] batch [10/35] time 0.336 (0.342) data 0.259 (0.264) loss_x loss_x 0.2688 (0.2878) acc_x 96.8750 (93.7500) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [15/35] time 0.344 (0.341) data 0.266 (0.263) loss_x loss_x 0.2225 (0.2813) acc_x 93.7500 (93.7500) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [20/35] time 0.331 (0.341) data 0.252 (0.264) loss_x loss_x 0.3574 (0.3087) acc_x 93.7500 (93.2812) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [25/35] time 0.309 (0.334) data 0.231 (0.256) loss_x loss_x 0.1677 (0.2988) acc_x 100.0000 (93.6250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [30/35] time 0.311 (0.332) data 0.234 (0.254) loss_x loss_x 0.3347 (0.2960) acc_x 90.6250 (93.5417) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [35/35] time 0.336 (0.332) data 0.258 (0.254) loss_x loss_x 0.1361 (0.2852) acc_x 100.0000 (93.7500) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/15] time 0.349 (0.334) data 0.272 (0.256) loss_u loss_u 0.8135 (0.8590) acc_u 21.8750 (16.2500) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/15] time 0.338 (0.334) data 0.260 (0.256) loss_u loss_u 0.8696 (0.8722) acc_u 12.5000 (14.3750) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/15] time 0.342 (0.335) data 0.263 (0.257) loss_u loss_u 0.9658 (0.8890) acc_u 3.1250 (12.5000) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 139
confident_label rate tensor(0.7034, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1148
clean true:1145
clean false:3
clean_rate:0.9973867595818815
noisy true:348
noisy false:136
after delete: len(clean_dataset) 1148
after delete: len(noisy_dataset) 484
epoch [173/200] batch [5/35] time 0.353 (0.351) data 0.276 (0.274) loss_x loss_x 0.0920 (0.2294) acc_x 100.0000 (95.6250) lr 1.0197e-04 eta 0:00:10
epoch [173/200] batch [10/35] time 0.349 (0.349) data 0.272 (0.271) loss_x loss_x 0.3066 (0.2423) acc_x 93.7500 (95.3125) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [15/35] time 0.359 (0.349) data 0.281 (0.272) loss_x loss_x 0.2920 (0.2730) acc_x 90.6250 (94.5833) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [20/35] time 0.337 (0.348) data 0.259 (0.271) loss_x loss_x 0.4656 (0.2965) acc_x 87.5000 (93.2812) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [25/35] time 0.331 (0.348) data 0.252 (0.270) loss_x loss_x 0.1624 (0.2920) acc_x 93.7500 (93.3750) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [30/35] time 0.320 (0.343) data 0.242 (0.266) loss_x loss_x 0.4514 (0.3016) acc_x 87.5000 (93.2292) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [35/35] time 0.341 (0.342) data 0.263 (0.264) loss_x loss_x 0.1168 (0.2863) acc_x 100.0000 (93.8393) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/15] time 0.340 (0.341) data 0.262 (0.263) loss_u loss_u 0.7915 (0.8455) acc_u 25.0000 (18.1250) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/15] time 0.347 (0.341) data 0.269 (0.264) loss_u loss_u 0.8569 (0.8720) acc_u 15.6250 (15.0000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/15] time 0.332 (0.340) data 0.254 (0.263) loss_u loss_u 0.9600 (0.8930) acc_u 6.2500 (12.5000) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 152
confident_label rate tensor(0.6930, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1131
clean true:1130
clean false:1
clean_rate:0.9991158267020336
noisy true:350
noisy false:151
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 501
epoch [174/200] batch [5/35] time 0.346 (0.350) data 0.267 (0.272) loss_x loss_x 0.3318 (0.2259) acc_x 87.5000 (93.1250) lr 9.5173e-05 eta 0:00:10
epoch [174/200] batch [10/35] time 0.351 (0.348) data 0.273 (0.270) loss_x loss_x 0.2781 (0.2328) acc_x 96.8750 (94.3750) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [15/35] time 0.345 (0.343) data 0.268 (0.265) loss_x loss_x 0.2595 (0.2481) acc_x 93.7500 (94.5833) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [20/35] time 0.350 (0.344) data 0.271 (0.266) loss_x loss_x 0.2244 (0.2472) acc_x 96.8750 (95.0000) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [25/35] time 0.343 (0.342) data 0.266 (0.265) loss_x loss_x 0.2891 (0.2376) acc_x 90.6250 (95.3750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [30/35] time 0.357 (0.343) data 0.279 (0.265) loss_x loss_x 0.1506 (0.2348) acc_x 96.8750 (95.4167) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [35/35] time 0.327 (0.343) data 0.249 (0.266) loss_x loss_x 0.1741 (0.2294) acc_x 96.8750 (95.6250) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/15] time 0.337 (0.340) data 0.259 (0.263) loss_u loss_u 0.9297 (0.8736) acc_u 6.2500 (13.7500) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/15] time 0.350 (0.342) data 0.272 (0.264) loss_u loss_u 0.8848 (0.8712) acc_u 12.5000 (14.3750) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [15/15] time 0.332 (0.342) data 0.254 (0.264) loss_u loss_u 0.8574 (0.8691) acc_u 15.6250 (14.7917) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 140
confident_label rate tensor(0.7004, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1143
clean true:1143
clean false:0
clean_rate:1.0
noisy true:349
noisy false:140
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 489
epoch [175/200] batch [5/35] time 0.345 (0.358) data 0.267 (0.280) loss_x loss_x 0.2441 (0.2904) acc_x 96.8750 (95.0000) lr 8.8597e-05 eta 0:00:10
epoch [175/200] batch [10/35] time 0.359 (0.351) data 0.281 (0.274) loss_x loss_x 0.5454 (0.3186) acc_x 84.3750 (92.8125) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [15/35] time 0.302 (0.345) data 0.223 (0.268) loss_x loss_x 0.1484 (0.2762) acc_x 100.0000 (93.9583) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [20/35] time 0.351 (0.339) data 0.274 (0.261) loss_x loss_x 0.0856 (0.2635) acc_x 100.0000 (94.6875) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [25/35] time 0.328 (0.340) data 0.251 (0.262) loss_x loss_x 0.1484 (0.2581) acc_x 100.0000 (94.8750) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [30/35] time 0.327 (0.338) data 0.249 (0.260) loss_x loss_x 0.2966 (0.2601) acc_x 93.7500 (94.4792) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [35/35] time 0.301 (0.335) data 0.223 (0.258) loss_x loss_x 0.3894 (0.2682) acc_x 93.7500 (94.5536) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/15] time 0.333 (0.336) data 0.255 (0.258) loss_u loss_u 0.8291 (0.8746) acc_u 18.7500 (13.7500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/15] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9004 (0.8874) acc_u 9.3750 (11.8750) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [15/15] time 0.349 (0.336) data 0.271 (0.258) loss_u loss_u 0.9263 (0.8864) acc_u 9.3750 (12.0833) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 146
confident_label rate tensor(0.6973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1138
clean true:1136
clean false:2
clean_rate:0.9982425307557118
noisy true:350
noisy false:144
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 494
epoch [176/200] batch [5/35] time 0.351 (0.347) data 0.274 (0.269) loss_x loss_x 0.1576 (0.2490) acc_x 100.0000 (96.2500) lr 8.2245e-05 eta 0:00:10
epoch [176/200] batch [10/35] time 0.335 (0.344) data 0.258 (0.267) loss_x loss_x 0.1964 (0.2797) acc_x 96.8750 (95.3125) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [15/35] time 0.326 (0.345) data 0.247 (0.267) loss_x loss_x 0.2144 (0.2795) acc_x 96.8750 (95.0000) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [20/35] time 0.341 (0.343) data 0.263 (0.265) loss_x loss_x 0.2644 (0.2750) acc_x 93.7500 (94.6875) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [25/35] time 0.332 (0.342) data 0.255 (0.265) loss_x loss_x 0.1713 (0.2581) acc_x 96.8750 (95.5000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [30/35] time 0.343 (0.342) data 0.266 (0.264) loss_x loss_x 0.1136 (0.2540) acc_x 100.0000 (95.5208) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [35/35] time 0.338 (0.341) data 0.261 (0.263) loss_x loss_x 0.2269 (0.2565) acc_x 93.7500 (95.2679) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/15] time 0.348 (0.341) data 0.270 (0.263) loss_u loss_u 0.7773 (0.8635) acc_u 25.0000 (15.0000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/15] time 0.333 (0.341) data 0.255 (0.264) loss_u loss_u 0.9644 (0.8950) acc_u 3.1250 (11.8750) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [15/15] time 0.343 (0.341) data 0.264 (0.263) loss_u loss_u 0.9053 (0.8948) acc_u 9.3750 (12.0833) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 149
confident_label rate tensor(0.6985, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1140
clean true:1139
clean false:1
clean_rate:0.9991228070175439
noisy true:344
noisy false:148
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 492
epoch [177/200] batch [5/35] time 0.342 (0.342) data 0.265 (0.265) loss_x loss_x 0.3638 (0.2399) acc_x 90.6250 (94.3750) lr 7.6120e-05 eta 0:00:10
epoch [177/200] batch [10/35] time 0.341 (0.341) data 0.264 (0.264) loss_x loss_x 0.2874 (0.2699) acc_x 93.7500 (94.3750) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [15/35] time 0.301 (0.330) data 0.223 (0.252) loss_x loss_x 0.3018 (0.2428) acc_x 96.8750 (95.0000) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [20/35] time 0.354 (0.329) data 0.276 (0.251) loss_x loss_x 0.5068 (0.2474) acc_x 87.5000 (94.8438) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [25/35] time 0.348 (0.332) data 0.271 (0.255) loss_x loss_x 0.2245 (0.2611) acc_x 93.7500 (94.6250) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [30/35] time 0.355 (0.334) data 0.276 (0.256) loss_x loss_x 0.1893 (0.2424) acc_x 96.8750 (95.2083) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [35/35] time 0.346 (0.334) data 0.267 (0.256) loss_x loss_x 0.1538 (0.2397) acc_x 96.8750 (95.2679) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/15] time 0.350 (0.334) data 0.273 (0.256) loss_u loss_u 0.8877 (0.8798) acc_u 12.5000 (13.1250) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/15] time 0.352 (0.336) data 0.274 (0.258) loss_u loss_u 0.8784 (0.8706) acc_u 12.5000 (14.3750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/15] time 0.336 (0.335) data 0.258 (0.257) loss_u loss_u 0.8838 (0.8853) acc_u 12.5000 (12.5000) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 162
confident_label rate tensor(0.6893, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1125
clean true:1123
clean false:2
clean_rate:0.9982222222222222
noisy true:347
noisy false:160
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 507
epoch [178/200] batch [5/35] time 0.354 (0.352) data 0.276 (0.274) loss_x loss_x 0.1948 (0.2727) acc_x 96.8750 (93.7500) lr 7.0224e-05 eta 0:00:10
epoch [178/200] batch [10/35] time 0.350 (0.349) data 0.272 (0.271) loss_x loss_x 0.1393 (0.2485) acc_x 100.0000 (94.6875) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [15/35] time 0.304 (0.339) data 0.226 (0.261) loss_x loss_x 0.1776 (0.2428) acc_x 96.8750 (95.0000) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [20/35] time 0.335 (0.337) data 0.258 (0.260) loss_x loss_x 0.1094 (0.2394) acc_x 100.0000 (95.1562) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [25/35] time 0.335 (0.338) data 0.256 (0.260) loss_x loss_x 0.2487 (0.2334) acc_x 90.6250 (94.8750) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [30/35] time 0.344 (0.338) data 0.265 (0.261) loss_x loss_x 0.1927 (0.2223) acc_x 96.8750 (95.2083) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [35/35] time 0.345 (0.338) data 0.266 (0.261) loss_x loss_x 0.2795 (0.2297) acc_x 93.7500 (95.0893) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/15] time 0.349 (0.343) data 0.270 (0.265) loss_u loss_u 0.9131 (0.8943) acc_u 12.5000 (11.8750) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/15] time 0.316 (0.344) data 0.238 (0.266) loss_u loss_u 0.8408 (0.8843) acc_u 21.8750 (13.7500) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/15] time 0.367 (0.345) data 0.287 (0.267) loss_u loss_u 0.9424 (0.8844) acc_u 6.2500 (13.5417) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 158
confident_label rate tensor(0.6973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1138
clean true:1137
clean false:1
clean_rate:0.9991212653778558
noisy true:337
noisy false:157
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 494
epoch [179/200] batch [5/35] time 0.304 (0.323) data 0.226 (0.245) loss_x loss_x 0.2124 (0.2576) acc_x 90.6250 (91.8750) lr 6.4556e-05 eta 0:00:09
epoch [179/200] batch [10/35] time 0.351 (0.326) data 0.274 (0.248) loss_x loss_x 0.3167 (0.2681) acc_x 93.7500 (92.5000) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [15/35] time 0.334 (0.331) data 0.256 (0.253) loss_x loss_x 0.2759 (0.3021) acc_x 93.7500 (92.0833) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [20/35] time 0.343 (0.334) data 0.266 (0.256) loss_x loss_x 0.3423 (0.2935) acc_x 93.7500 (92.8125) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [25/35] time 0.345 (0.335) data 0.268 (0.257) loss_x loss_x 0.1766 (0.2765) acc_x 96.8750 (93.5000) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [30/35] time 0.323 (0.336) data 0.245 (0.258) loss_x loss_x 0.3171 (0.2682) acc_x 93.7500 (93.9583) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [35/35] time 0.353 (0.338) data 0.275 (0.260) loss_x loss_x 0.3311 (0.2699) acc_x 93.7500 (94.0179) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/15] time 0.355 (0.339) data 0.277 (0.262) loss_u loss_u 0.8066 (0.8776) acc_u 21.8750 (14.3750) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/15] time 0.361 (0.341) data 0.283 (0.263) loss_u loss_u 0.8013 (0.8997) acc_u 21.8750 (11.8750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/15] time 0.350 (0.341) data 0.272 (0.263) loss_u loss_u 0.8203 (0.8888) acc_u 18.7500 (12.5000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 158
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1124
clean true:1123
clean false:1
clean_rate:0.9991103202846975
noisy true:351
noisy false:157
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 508
epoch [180/200] batch [5/35] time 0.309 (0.305) data 0.231 (0.226) loss_x loss_x 0.2235 (0.2760) acc_x 96.8750 (93.7500) lr 5.9119e-05 eta 0:00:09
epoch [180/200] batch [10/35] time 0.334 (0.321) data 0.257 (0.243) loss_x loss_x 0.3118 (0.3051) acc_x 90.6250 (92.5000) lr 5.9119e-05 eta 0:00:08
epoch [180/200] batch [15/35] time 0.336 (0.325) data 0.258 (0.247) loss_x loss_x 0.4448 (0.3267) acc_x 84.3750 (92.0833) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [20/35] time 0.350 (0.328) data 0.272 (0.250) loss_x loss_x 0.1726 (0.2879) acc_x 100.0000 (93.4375) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [25/35] time 0.398 (0.334) data 0.320 (0.256) loss_x loss_x 0.1592 (0.2718) acc_x 96.8750 (94.1250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [30/35] time 0.348 (0.336) data 0.270 (0.258) loss_x loss_x 0.1678 (0.2693) acc_x 96.8750 (94.1667) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [35/35] time 0.329 (0.336) data 0.251 (0.259) loss_x loss_x 0.3176 (0.2613) acc_x 93.7500 (94.4643) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/15] time 0.361 (0.338) data 0.283 (0.260) loss_u loss_u 0.8896 (0.8640) acc_u 12.5000 (15.6250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/15] time 0.409 (0.345) data 0.329 (0.267) loss_u loss_u 0.8208 (0.8718) acc_u 18.7500 (14.6875) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [15/15] time 0.342 (0.348) data 0.264 (0.270) loss_u loss_u 0.9404 (0.8666) acc_u 9.3750 (15.6250) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 145
confident_label rate tensor(0.6955, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1135
clean true:1133
clean false:2
clean_rate:0.9982378854625551
noisy true:354
noisy false:143
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 497
epoch [181/200] batch [5/35] time 0.349 (0.334) data 0.271 (0.256) loss_x loss_x 0.2939 (0.2471) acc_x 87.5000 (95.0000) lr 5.3915e-05 eta 0:00:10
epoch [181/200] batch [10/35] time 0.342 (0.336) data 0.265 (0.258) loss_x loss_x 0.2969 (0.2742) acc_x 93.7500 (94.0625) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [15/35] time 0.316 (0.336) data 0.238 (0.258) loss_x loss_x 0.4949 (0.3043) acc_x 84.3750 (93.5417) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [20/35] time 0.356 (0.337) data 0.279 (0.259) loss_x loss_x 0.2369 (0.2944) acc_x 96.8750 (93.5938) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [25/35] time 0.332 (0.338) data 0.254 (0.260) loss_x loss_x 0.1752 (0.2734) acc_x 90.6250 (93.8750) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [30/35] time 0.349 (0.338) data 0.270 (0.260) loss_x loss_x 0.1993 (0.2804) acc_x 90.6250 (93.7500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [35/35] time 0.341 (0.340) data 0.264 (0.262) loss_x loss_x 0.1067 (0.2832) acc_x 100.0000 (93.6607) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/15] time 0.322 (0.338) data 0.244 (0.261) loss_u loss_u 0.7964 (0.8595) acc_u 21.8750 (16.2500) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/15] time 0.346 (0.339) data 0.268 (0.261) loss_u loss_u 0.8867 (0.8727) acc_u 15.6250 (14.6875) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/15] time 0.339 (0.339) data 0.261 (0.262) loss_u loss_u 0.9365 (0.8782) acc_u 6.2500 (13.9583) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 166
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1122
clean true:1120
clean false:2
clean_rate:0.9982174688057041
noisy true:346
noisy false:164
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 510
epoch [182/200] batch [5/35] time 0.349 (0.323) data 0.271 (0.245) loss_x loss_x 0.2974 (0.2743) acc_x 90.6250 (93.1250) lr 4.8943e-05 eta 0:00:09
epoch [182/200] batch [10/35] time 0.367 (0.347) data 0.289 (0.269) loss_x loss_x 0.4719 (0.2816) acc_x 84.3750 (92.5000) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [15/35] time 0.310 (0.343) data 0.232 (0.265) loss_x loss_x 0.2202 (0.2652) acc_x 96.8750 (93.5417) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [20/35] time 0.364 (0.342) data 0.287 (0.264) loss_x loss_x 0.2100 (0.2559) acc_x 96.8750 (94.0625) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [25/35] time 0.343 (0.342) data 0.265 (0.265) loss_x loss_x 0.2015 (0.2476) acc_x 96.8750 (94.5000) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [30/35] time 0.327 (0.341) data 0.250 (0.263) loss_x loss_x 0.0775 (0.2438) acc_x 100.0000 (94.3750) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [35/35] time 0.341 (0.340) data 0.263 (0.262) loss_x loss_x 0.2069 (0.2499) acc_x 100.0000 (94.1964) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/15] time 0.338 (0.340) data 0.261 (0.262) loss_u loss_u 0.7749 (0.8565) acc_u 25.0000 (17.5000) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/15] time 0.345 (0.341) data 0.267 (0.263) loss_u loss_u 0.7642 (0.8623) acc_u 25.0000 (15.6250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/15] time 0.345 (0.341) data 0.266 (0.263) loss_u loss_u 0.8530 (0.8728) acc_u 21.8750 (15.0000) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 147
confident_label rate tensor(0.7022, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1146
clean true:1144
clean false:2
clean_rate:0.9982547993019197
noisy true:341
noisy false:145
after delete: len(clean_dataset) 1146
after delete: len(noisy_dataset) 486
epoch [183/200] batch [5/35] time 0.358 (0.354) data 0.280 (0.276) loss_x loss_x 0.3599 (0.2618) acc_x 93.7500 (96.2500) lr 4.4207e-05 eta 0:00:10
epoch [183/200] batch [10/35] time 0.355 (0.353) data 0.277 (0.275) loss_x loss_x 0.2217 (0.2829) acc_x 93.7500 (94.6875) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [15/35] time 0.354 (0.342) data 0.276 (0.264) loss_x loss_x 0.3096 (0.3084) acc_x 90.6250 (93.5417) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [20/35] time 0.350 (0.340) data 0.273 (0.262) loss_x loss_x 0.1805 (0.2920) acc_x 96.8750 (93.9062) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [25/35] time 0.363 (0.342) data 0.284 (0.265) loss_x loss_x 0.1672 (0.2826) acc_x 93.7500 (94.1250) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [30/35] time 0.343 (0.343) data 0.265 (0.265) loss_x loss_x 0.3691 (0.2965) acc_x 87.5000 (93.6458) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [35/35] time 0.365 (0.345) data 0.286 (0.267) loss_x loss_x 0.3989 (0.3019) acc_x 93.7500 (93.6607) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/15] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.9351 (0.8818) acc_u 6.2500 (11.8750) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/15] time 0.354 (0.344) data 0.275 (0.266) loss_u loss_u 0.9604 (0.8914) acc_u 3.1250 (11.2500) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [15/15] time 0.350 (0.344) data 0.272 (0.266) loss_u loss_u 0.8818 (0.8872) acc_u 12.5000 (12.2917) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 144
confident_label rate tensor(0.6967, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1137
clean true:1136
clean false:1
clean_rate:0.9991204925241864
noisy true:352
noisy false:143
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 495
epoch [184/200] batch [5/35] time 0.347 (0.347) data 0.270 (0.269) loss_x loss_x 0.1410 (0.2686) acc_x 96.8750 (94.3750) lr 3.9706e-05 eta 0:00:10
epoch [184/200] batch [10/35] time 0.330 (0.340) data 0.252 (0.262) loss_x loss_x 0.4585 (0.2812) acc_x 84.3750 (93.4375) lr 3.9706e-05 eta 0:00:08
epoch [184/200] batch [15/35] time 0.311 (0.340) data 0.233 (0.262) loss_x loss_x 0.3035 (0.2771) acc_x 93.7500 (93.5417) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [20/35] time 0.351 (0.336) data 0.274 (0.258) loss_x loss_x 0.2842 (0.2861) acc_x 93.7500 (93.2812) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [25/35] time 0.341 (0.337) data 0.264 (0.259) loss_x loss_x 0.2908 (0.2788) acc_x 93.7500 (93.5000) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [30/35] time 0.330 (0.338) data 0.252 (0.260) loss_x loss_x 0.3364 (0.2797) acc_x 87.5000 (93.2292) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [35/35] time 0.340 (0.338) data 0.262 (0.261) loss_x loss_x 0.2610 (0.2727) acc_x 93.7500 (93.6607) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/15] time 0.364 (0.339) data 0.286 (0.261) loss_u loss_u 0.8726 (0.8868) acc_u 18.7500 (13.7500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/15] time 0.316 (0.338) data 0.238 (0.261) loss_u loss_u 0.9233 (0.8910) acc_u 9.3750 (13.7500) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/15] time 0.340 (0.338) data 0.262 (0.260) loss_u loss_u 0.8521 (0.8880) acc_u 15.6250 (13.5417) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 150
confident_label rate tensor(0.6936, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1132
clean true:1131
clean false:1
clean_rate:0.9991166077738516
noisy true:351
noisy false:149
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 500
epoch [185/200] batch [5/35] time 0.339 (0.351) data 0.261 (0.274) loss_x loss_x 0.3740 (0.3032) acc_x 93.7500 (93.7500) lr 3.5443e-05 eta 0:00:10
epoch [185/200] batch [10/35] time 0.343 (0.345) data 0.266 (0.268) loss_x loss_x 0.2976 (0.3285) acc_x 100.0000 (93.7500) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [15/35] time 0.322 (0.341) data 0.245 (0.264) loss_x loss_x 0.1207 (0.3034) acc_x 96.8750 (93.7500) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [20/35] time 0.331 (0.340) data 0.254 (0.263) loss_x loss_x 0.0829 (0.3099) acc_x 100.0000 (94.0625) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [25/35] time 0.327 (0.340) data 0.249 (0.262) loss_x loss_x 0.1041 (0.2993) acc_x 100.0000 (93.7500) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [30/35] time 0.349 (0.340) data 0.270 (0.263) loss_x loss_x 0.0552 (0.2844) acc_x 100.0000 (94.0625) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [35/35] time 0.294 (0.338) data 0.216 (0.260) loss_x loss_x 0.3311 (0.2835) acc_x 93.7500 (93.9286) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/15] time 0.296 (0.332) data 0.218 (0.255) loss_u loss_u 0.9043 (0.8693) acc_u 9.3750 (15.0000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/15] time 0.368 (0.331) data 0.286 (0.254) loss_u loss_u 0.9102 (0.8814) acc_u 9.3750 (13.7500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/15] time 0.311 (0.332) data 0.231 (0.254) loss_u loss_u 0.8945 (0.8820) acc_u 12.5000 (13.5417) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 130
confident_label rate tensor(0.7016, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1145
clean true:1144
clean false:1
clean_rate:0.9991266375545852
noisy true:358
noisy false:129
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 487
epoch [186/200] batch [5/35] time 0.294 (0.301) data 0.216 (0.223) loss_x loss_x 0.2365 (0.4067) acc_x 90.6250 (90.0000) lr 3.1417e-05 eta 0:00:09
epoch [186/200] batch [10/35] time 0.297 (0.308) data 0.220 (0.230) loss_x loss_x 0.2778 (0.3740) acc_x 96.8750 (91.8750) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [15/35] time 0.307 (0.303) data 0.229 (0.226) loss_x loss_x 0.1777 (0.3563) acc_x 96.8750 (91.6667) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [20/35] time 0.295 (0.301) data 0.217 (0.223) loss_x loss_x 0.1591 (0.3353) acc_x 96.8750 (91.8750) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [25/35] time 0.295 (0.299) data 0.218 (0.222) loss_x loss_x 0.3865 (0.3293) acc_x 87.5000 (91.7500) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [30/35] time 0.303 (0.298) data 0.226 (0.221) loss_x loss_x 0.3413 (0.3319) acc_x 90.6250 (91.7708) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [35/35] time 0.293 (0.298) data 0.216 (0.220) loss_x loss_x 0.1852 (0.3159) acc_x 96.8750 (92.1429) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/15] time 0.299 (0.298) data 0.221 (0.220) loss_u loss_u 0.9194 (0.8806) acc_u 9.3750 (13.1250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/15] time 0.290 (0.297) data 0.211 (0.220) loss_u loss_u 0.8730 (0.8957) acc_u 12.5000 (11.5625) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/15] time 0.296 (0.297) data 0.218 (0.219) loss_u loss_u 0.9116 (0.8909) acc_u 9.3750 (12.2917) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 132
confident_label rate tensor(0.7047, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1150
clean true:1148
clean false:2
clean_rate:0.9982608695652174
noisy true:352
noisy false:130
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 482
epoch [187/200] batch [5/35] time 0.285 (0.302) data 0.207 (0.224) loss_x loss_x 0.3992 (0.2684) acc_x 90.6250 (92.5000) lr 2.7630e-05 eta 0:00:09
epoch [187/200] batch [10/35] time 0.298 (0.299) data 0.220 (0.221) loss_x loss_x 0.1660 (0.2629) acc_x 96.8750 (93.4375) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [15/35] time 0.310 (0.299) data 0.232 (0.221) loss_x loss_x 0.3096 (0.2704) acc_x 93.7500 (93.9583) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [20/35] time 0.312 (0.304) data 0.233 (0.226) loss_x loss_x 0.2394 (0.2524) acc_x 93.7500 (94.6875) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [25/35] time 0.306 (0.305) data 0.228 (0.227) loss_x loss_x 0.2971 (0.2533) acc_x 93.7500 (94.8750) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [30/35] time 0.294 (0.303) data 0.216 (0.225) loss_x loss_x 0.3401 (0.2694) acc_x 93.7500 (94.1667) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [35/35] time 0.300 (0.302) data 0.222 (0.224) loss_x loss_x 0.1392 (0.2635) acc_x 93.7500 (94.1964) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/15] time 0.293 (0.302) data 0.215 (0.223) loss_u loss_u 0.8770 (0.8919) acc_u 12.5000 (11.8750) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/15] time 0.292 (0.301) data 0.213 (0.223) loss_u loss_u 0.9448 (0.8991) acc_u 6.2500 (11.5625) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/15] time 0.350 (0.302) data 0.271 (0.224) loss_u loss_u 0.8911 (0.8948) acc_u 12.5000 (12.0833) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 135
confident_label rate tensor(0.7034, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1148
clean true:1147
clean false:1
clean_rate:0.9991289198606271
noisy true:350
noisy false:134
after delete: len(clean_dataset) 1148
after delete: len(noisy_dataset) 484
epoch [188/200] batch [5/35] time 0.304 (0.301) data 0.226 (0.223) loss_x loss_x 0.4473 (0.3122) acc_x 90.6250 (93.1250) lr 2.4083e-05 eta 0:00:09
epoch [188/200] batch [10/35] time 0.301 (0.298) data 0.218 (0.219) loss_x loss_x 0.1130 (0.2734) acc_x 100.0000 (94.0625) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [15/35] time 0.303 (0.314) data 0.225 (0.235) loss_x loss_x 0.2286 (0.2708) acc_x 96.8750 (94.5833) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [20/35] time 0.293 (0.312) data 0.215 (0.234) loss_x loss_x 0.2515 (0.2653) acc_x 93.7500 (94.0625) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [25/35] time 0.301 (0.309) data 0.224 (0.230) loss_x loss_x 0.1693 (0.2734) acc_x 96.8750 (93.6250) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [30/35] time 0.289 (0.306) data 0.211 (0.227) loss_x loss_x 0.1572 (0.2611) acc_x 96.8750 (94.0625) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [35/35] time 0.295 (0.304) data 0.218 (0.226) loss_x loss_x 0.2426 (0.2519) acc_x 96.8750 (94.3750) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/15] time 0.293 (0.304) data 0.215 (0.226) loss_u loss_u 0.8892 (0.8724) acc_u 12.5000 (14.3750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/15] time 0.291 (0.303) data 0.212 (0.225) loss_u loss_u 0.9839 (0.8811) acc_u 3.1250 (13.1250) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/15] time 0.289 (0.302) data 0.210 (0.223) loss_u loss_u 0.9990 (0.8887) acc_u 0.0000 (12.2917) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 155
confident_label rate tensor(0.6887, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1124
clean true:1123
clean false:1
clean_rate:0.9991103202846975
noisy true:354
noisy false:154
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 508
epoch [189/200] batch [5/35] time 0.295 (0.291) data 0.216 (0.213) loss_x loss_x 0.2291 (0.2556) acc_x 100.0000 (95.0000) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [10/35] time 0.289 (0.290) data 0.211 (0.212) loss_x loss_x 0.2842 (0.2728) acc_x 96.8750 (94.6875) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [15/35] time 0.301 (0.291) data 0.223 (0.214) loss_x loss_x 0.1692 (0.2677) acc_x 96.8750 (94.1667) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [20/35] time 0.283 (0.291) data 0.206 (0.213) loss_x loss_x 0.5693 (0.2804) acc_x 90.6250 (94.2188) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [25/35] time 0.291 (0.290) data 0.214 (0.213) loss_x loss_x 0.5117 (0.2829) acc_x 87.5000 (94.2500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [30/35] time 0.291 (0.291) data 0.213 (0.213) loss_x loss_x 0.1681 (0.2716) acc_x 100.0000 (94.6875) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [35/35] time 0.285 (0.291) data 0.208 (0.213) loss_x loss_x 0.2922 (0.2735) acc_x 93.7500 (94.2857) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/15] time 0.292 (0.291) data 0.214 (0.213) loss_u loss_u 0.9141 (0.8824) acc_u 12.5000 (13.7500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/15] time 0.301 (0.292) data 0.222 (0.214) loss_u loss_u 0.7808 (0.8413) acc_u 25.0000 (17.8125) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/15] time 0.297 (0.293) data 0.218 (0.215) loss_u loss_u 0.9458 (0.8572) acc_u 6.2500 (16.0417) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 152
confident_label rate tensor(0.7004, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1143
clean true:1141
clean false:2
clean_rate:0.9982502187226596
noisy true:339
noisy false:150
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 489
epoch [190/200] batch [5/35] time 0.302 (0.301) data 0.223 (0.223) loss_x loss_x 0.1755 (0.2378) acc_x 96.8750 (95.0000) lr 1.7713e-05 eta 0:00:09
epoch [190/200] batch [10/35] time 0.294 (0.298) data 0.215 (0.219) loss_x loss_x 0.3987 (0.2542) acc_x 90.6250 (95.0000) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [15/35] time 0.298 (0.297) data 0.219 (0.218) loss_x loss_x 0.1907 (0.2551) acc_x 93.7500 (94.1667) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [20/35] time 0.296 (0.298) data 0.218 (0.219) loss_x loss_x 0.3652 (0.2635) acc_x 93.7500 (94.0625) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [25/35] time 0.295 (0.297) data 0.217 (0.219) loss_x loss_x 0.4546 (0.2655) acc_x 90.6250 (94.1250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [30/35] time 0.293 (0.298) data 0.214 (0.219) loss_x loss_x 0.2117 (0.2639) acc_x 96.8750 (94.3750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [35/35] time 0.302 (0.297) data 0.223 (0.219) loss_x loss_x 0.1930 (0.2669) acc_x 96.8750 (94.1964) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/15] time 0.297 (0.298) data 0.218 (0.219) loss_u loss_u 0.8599 (0.8914) acc_u 15.6250 (12.5000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/15] time 0.301 (0.298) data 0.221 (0.219) loss_u loss_u 0.7861 (0.8830) acc_u 21.8750 (13.7500) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/15] time 0.302 (0.298) data 0.223 (0.219) loss_u loss_u 0.9634 (0.8836) acc_u 3.1250 (13.3333) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 158
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1122
clean true:1121
clean false:1
clean_rate:0.9991087344028521
noisy true:353
noisy false:157
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 510
epoch [191/200] batch [5/35] time 0.306 (0.307) data 0.228 (0.229) loss_x loss_x 0.2102 (0.1781) acc_x 93.7500 (96.2500) lr 1.4891e-05 eta 0:00:09
epoch [191/200] batch [10/35] time 0.301 (0.302) data 0.224 (0.224) loss_x loss_x 0.1797 (0.2355) acc_x 96.8750 (95.6250) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [15/35] time 0.291 (0.299) data 0.213 (0.221) loss_x loss_x 0.5410 (0.2490) acc_x 84.3750 (95.2083) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [20/35] time 0.299 (0.298) data 0.221 (0.221) loss_x loss_x 0.1122 (0.2456) acc_x 100.0000 (95.1562) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [25/35] time 0.286 (0.298) data 0.209 (0.220) loss_x loss_x 0.5669 (0.2499) acc_x 81.2500 (94.6250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [30/35] time 0.291 (0.296) data 0.213 (0.219) loss_x loss_x 0.1617 (0.2478) acc_x 100.0000 (94.7917) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [35/35] time 0.295 (0.296) data 0.218 (0.219) loss_x loss_x 0.0765 (0.2430) acc_x 100.0000 (95.0893) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/15] time 0.296 (0.297) data 0.217 (0.219) loss_u loss_u 0.8281 (0.8567) acc_u 18.7500 (16.2500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/15] time 0.301 (0.297) data 0.223 (0.219) loss_u loss_u 0.8208 (0.8642) acc_u 18.7500 (15.0000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/15] time 0.297 (0.297) data 0.218 (0.219) loss_u loss_u 0.8896 (0.8513) acc_u 12.5000 (16.4583) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 133
confident_label rate tensor(0.6973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1138
clean true:1137
clean false:1
clean_rate:0.9991212653778558
noisy true:362
noisy false:132
after delete: len(clean_dataset) 1138
after delete: len(noisy_dataset) 494
epoch [192/200] batch [5/35] time 0.309 (0.300) data 0.231 (0.222) loss_x loss_x 0.1434 (0.2462) acc_x 96.8750 (95.0000) lr 1.2312e-05 eta 0:00:09
epoch [192/200] batch [10/35] time 0.300 (0.299) data 0.222 (0.221) loss_x loss_x 0.1510 (0.2687) acc_x 93.7500 (93.7500) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [15/35] time 0.310 (0.300) data 0.231 (0.222) loss_x loss_x 0.1482 (0.2623) acc_x 100.0000 (93.9583) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [20/35] time 0.294 (0.299) data 0.216 (0.221) loss_x loss_x 0.1715 (0.2677) acc_x 96.8750 (93.7500) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [25/35] time 0.306 (0.299) data 0.228 (0.221) loss_x loss_x 0.1093 (0.2566) acc_x 96.8750 (94.2500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [30/35] time 0.294 (0.299) data 0.216 (0.221) loss_x loss_x 0.6016 (0.2732) acc_x 84.3750 (93.8542) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [35/35] time 0.297 (0.299) data 0.219 (0.221) loss_x loss_x 0.3955 (0.2618) acc_x 90.6250 (94.2857) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/15] time 0.297 (0.300) data 0.219 (0.221) loss_u loss_u 0.9233 (0.9170) acc_u 9.3750 (9.3750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/15] time 0.303 (0.299) data 0.224 (0.221) loss_u loss_u 0.9478 (0.9145) acc_u 6.2500 (10.6250) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/15] time 0.304 (0.299) data 0.223 (0.221) loss_u loss_u 0.8145 (0.8991) acc_u 21.8750 (12.2917) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 130
confident_label rate tensor(0.7010, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1144
clean true:1142
clean false:2
clean_rate:0.9982517482517482
noisy true:360
noisy false:128
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 488
epoch [193/200] batch [5/35] time 0.294 (0.304) data 0.217 (0.226) loss_x loss_x 0.3245 (0.3568) acc_x 93.7500 (91.8750) lr 9.9763e-06 eta 0:00:09
epoch [193/200] batch [10/35] time 0.298 (0.301) data 0.220 (0.223) loss_x loss_x 0.3857 (0.3147) acc_x 87.5000 (92.8125) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [15/35] time 0.301 (0.300) data 0.223 (0.222) loss_x loss_x 0.3469 (0.3095) acc_x 90.6250 (92.7083) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [20/35] time 0.297 (0.299) data 0.219 (0.221) loss_x loss_x 0.1252 (0.2845) acc_x 96.8750 (93.4375) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [25/35] time 0.291 (0.298) data 0.213 (0.220) loss_x loss_x 0.3364 (0.2841) acc_x 96.8750 (93.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [30/35] time 0.293 (0.297) data 0.215 (0.220) loss_x loss_x 0.3523 (0.2972) acc_x 90.6250 (93.3333) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [35/35] time 0.299 (0.298) data 0.221 (0.220) loss_x loss_x 0.2546 (0.2943) acc_x 93.7500 (93.5714) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/15] time 0.290 (0.298) data 0.211 (0.220) loss_u loss_u 0.9072 (0.9110) acc_u 9.3750 (11.2500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/15] time 0.294 (0.298) data 0.216 (0.220) loss_u loss_u 0.8799 (0.9028) acc_u 12.5000 (11.5625) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/15] time 0.291 (0.297) data 0.211 (0.219) loss_u loss_u 0.9072 (0.8967) acc_u 9.3750 (11.8750) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 136
confident_label rate tensor(0.6979, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1139
clean true:1138
clean false:1
clean_rate:0.9991220368744512
noisy true:358
noisy false:135
after delete: len(clean_dataset) 1139
after delete: len(noisy_dataset) 493
epoch [194/200] batch [5/35] time 0.292 (0.288) data 0.214 (0.210) loss_x loss_x 0.1595 (0.2362) acc_x 96.8750 (96.2500) lr 7.8853e-06 eta 0:00:08
epoch [194/200] batch [10/35] time 0.288 (0.288) data 0.210 (0.210) loss_x loss_x 0.1937 (0.2207) acc_x 96.8750 (96.8750) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [15/35] time 0.286 (0.289) data 0.209 (0.211) loss_x loss_x 0.3186 (0.2389) acc_x 90.6250 (95.6250) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [20/35] time 0.295 (0.289) data 0.217 (0.211) loss_x loss_x 0.2961 (0.2506) acc_x 93.7500 (95.6250) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [25/35] time 0.296 (0.290) data 0.218 (0.212) loss_x loss_x 0.1586 (0.2495) acc_x 96.8750 (95.3750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [30/35] time 0.289 (0.291) data 0.211 (0.213) loss_x loss_x 0.2260 (0.2385) acc_x 93.7500 (95.5208) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [35/35] time 0.298 (0.291) data 0.220 (0.213) loss_x loss_x 0.2145 (0.2338) acc_x 90.6250 (95.3571) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/15] time 0.295 (0.292) data 0.217 (0.214) loss_u loss_u 0.9600 (0.9037) acc_u 3.1250 (10.6250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/15] time 0.299 (0.293) data 0.221 (0.215) loss_u loss_u 0.9312 (0.8988) acc_u 9.3750 (11.2500) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/15] time 0.287 (0.293) data 0.208 (0.215) loss_u loss_u 0.8838 (0.8851) acc_u 12.5000 (12.9167) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 146
confident_label rate tensor(0.6942, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1133
clean true:1132
clean false:1
clean_rate:0.999117387466902
noisy true:354
noisy false:145
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 499
epoch [195/200] batch [5/35] time 0.292 (0.295) data 0.214 (0.217) loss_x loss_x 0.3381 (0.2273) acc_x 93.7500 (95.0000) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [10/35] time 0.300 (0.295) data 0.222 (0.217) loss_x loss_x 0.1260 (0.2324) acc_x 96.8750 (95.6250) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [15/35] time 0.287 (0.294) data 0.209 (0.216) loss_x loss_x 0.2505 (0.2143) acc_x 93.7500 (95.8333) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [20/35] time 0.290 (0.294) data 0.212 (0.216) loss_x loss_x 0.3638 (0.2419) acc_x 87.5000 (95.0000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [25/35] time 0.291 (0.293) data 0.213 (0.216) loss_x loss_x 0.2335 (0.2529) acc_x 96.8750 (94.8750) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [30/35] time 0.294 (0.294) data 0.217 (0.216) loss_x loss_x 0.2573 (0.2601) acc_x 93.7500 (94.5833) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [35/35] time 0.300 (0.294) data 0.222 (0.216) loss_x loss_x 0.2742 (0.2717) acc_x 90.6250 (94.0179) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/15] time 0.302 (0.294) data 0.223 (0.216) loss_u loss_u 0.7485 (0.8797) acc_u 28.1250 (13.1250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/15] time 0.298 (0.295) data 0.219 (0.217) loss_u loss_u 0.8247 (0.8749) acc_u 21.8750 (13.7500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/15] time 0.292 (0.294) data 0.213 (0.216) loss_u loss_u 0.9321 (0.8839) acc_u 6.2500 (12.9167) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 136
confident_label rate tensor(0.7010, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1144
clean true:1143
clean false:1
clean_rate:0.9991258741258742
noisy true:353
noisy false:135
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 488
epoch [196/200] batch [5/35] time 0.304 (0.308) data 0.225 (0.230) loss_x loss_x 0.1265 (0.2188) acc_x 96.8750 (95.6250) lr 4.4380e-06 eta 0:00:09
epoch [196/200] batch [10/35] time 0.308 (0.308) data 0.229 (0.230) loss_x loss_x 0.3296 (0.2861) acc_x 90.6250 (93.4375) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [15/35] time 0.312 (0.307) data 0.233 (0.228) loss_x loss_x 0.2803 (0.2615) acc_x 93.7500 (94.1667) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [20/35] time 0.302 (0.305) data 0.223 (0.226) loss_x loss_x 0.1591 (0.2391) acc_x 100.0000 (95.1562) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [25/35] time 0.327 (0.305) data 0.249 (0.227) loss_x loss_x 0.1887 (0.2422) acc_x 93.7500 (94.6250) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [30/35] time 0.294 (0.303) data 0.217 (0.224) loss_x loss_x 0.0964 (0.2520) acc_x 100.0000 (94.0625) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [35/35] time 0.282 (0.301) data 0.204 (0.222) loss_x loss_x 0.4373 (0.2619) acc_x 90.6250 (93.8393) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/15] time 0.295 (0.300) data 0.216 (0.222) loss_u loss_u 0.8667 (0.9016) acc_u 15.6250 (11.2500) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/15] time 0.299 (0.300) data 0.220 (0.221) loss_u loss_u 0.8491 (0.8829) acc_u 18.7500 (13.4375) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/15] time 0.299 (0.299) data 0.220 (0.221) loss_u loss_u 0.8872 (0.8895) acc_u 12.5000 (12.9167) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 161
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1128
clean true:1127
clean false:1
clean_rate:0.999113475177305
noisy true:344
noisy false:160
after delete: len(clean_dataset) 1128
after delete: len(noisy_dataset) 504
epoch [197/200] batch [5/35] time 0.300 (0.305) data 0.222 (0.227) loss_x loss_x 0.4651 (0.3258) acc_x 87.5000 (90.0000) lr 3.0827e-06 eta 0:00:09
epoch [197/200] batch [10/35] time 0.304 (0.302) data 0.226 (0.224) loss_x loss_x 0.1304 (0.2967) acc_x 96.8750 (92.1875) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [15/35] time 0.290 (0.299) data 0.212 (0.222) loss_x loss_x 0.3191 (0.2945) acc_x 93.7500 (92.5000) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [20/35] time 0.289 (0.298) data 0.211 (0.220) loss_x loss_x 0.2164 (0.2860) acc_x 96.8750 (93.1250) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [25/35] time 0.296 (0.298) data 0.219 (0.220) loss_x loss_x 0.1086 (0.2803) acc_x 100.0000 (93.3750) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [30/35] time 0.298 (0.297) data 0.219 (0.219) loss_x loss_x 0.1829 (0.2820) acc_x 96.8750 (93.5417) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [35/35] time 0.301 (0.297) data 0.223 (0.219) loss_x loss_x 0.2410 (0.2778) acc_x 93.7500 (93.8393) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/15] time 0.321 (0.299) data 0.242 (0.221) loss_u loss_u 0.9165 (0.8876) acc_u 9.3750 (12.5000) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/15] time 0.298 (0.299) data 0.219 (0.221) loss_u loss_u 0.9121 (0.8828) acc_u 9.3750 (13.1250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/15] time 0.304 (0.299) data 0.225 (0.221) loss_u loss_u 0.9458 (0.8719) acc_u 6.2500 (14.3750) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 144
confident_label rate tensor(0.6918, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1129
clean true:1126
clean false:3
clean_rate:0.9973427812223207
noisy true:362
noisy false:141
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 503
epoch [198/200] batch [5/35] time 0.292 (0.293) data 0.214 (0.215) loss_x loss_x 0.3184 (0.3442) acc_x 93.7500 (93.7500) lr 1.9733e-06 eta 0:00:08
epoch [198/200] batch [10/35] time 0.290 (0.292) data 0.212 (0.215) loss_x loss_x 0.3293 (0.3242) acc_x 93.7500 (93.7500) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [15/35] time 0.286 (0.292) data 0.208 (0.214) loss_x loss_x 0.2698 (0.2921) acc_x 93.7500 (93.9583) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [20/35] time 0.286 (0.292) data 0.209 (0.214) loss_x loss_x 0.2244 (0.2624) acc_x 96.8750 (94.8438) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [25/35] time 0.295 (0.292) data 0.217 (0.214) loss_x loss_x 0.2280 (0.2575) acc_x 93.7500 (94.7500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [30/35] time 0.288 (0.292) data 0.210 (0.214) loss_x loss_x 0.1144 (0.2541) acc_x 100.0000 (94.5833) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [35/35] time 0.295 (0.292) data 0.217 (0.214) loss_x loss_x 0.2029 (0.2502) acc_x 96.8750 (94.5536) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/15] time 0.297 (0.292) data 0.219 (0.214) loss_u loss_u 0.8887 (0.8528) acc_u 12.5000 (16.2500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/15] time 0.290 (0.292) data 0.211 (0.214) loss_u loss_u 0.8867 (0.8574) acc_u 15.6250 (16.8750) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/15] time 0.321 (0.293) data 0.242 (0.215) loss_u loss_u 0.9067 (0.8680) acc_u 12.5000 (15.4167) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 128
confident_label rate tensor(0.7071, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1154
clean true:1153
clean false:1
clean_rate:0.9991334488734835
noisy true:351
noisy false:127
after delete: len(clean_dataset) 1154
after delete: len(noisy_dataset) 478
epoch [199/200] batch [5/36] time 0.302 (0.303) data 0.225 (0.225) loss_x loss_x 0.2554 (0.2358) acc_x 93.7500 (94.3750) lr 1.1101e-06 eta 0:00:09
epoch [199/200] batch [10/36] time 0.301 (0.300) data 0.223 (0.223) loss_x loss_x 0.3665 (0.2449) acc_x 87.5000 (93.4375) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [15/36] time 0.294 (0.300) data 0.217 (0.222) loss_x loss_x 0.3359 (0.2416) acc_x 93.7500 (93.9583) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [20/36] time 0.294 (0.298) data 0.216 (0.221) loss_x loss_x 0.2407 (0.2327) acc_x 93.7500 (94.2188) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [25/36] time 0.301 (0.298) data 0.223 (0.220) loss_x loss_x 0.3765 (0.2432) acc_x 93.7500 (94.3750) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [30/36] time 0.283 (0.297) data 0.205 (0.219) loss_x loss_x 0.3069 (0.2470) acc_x 93.7500 (94.1667) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [35/36] time 0.283 (0.296) data 0.205 (0.218) loss_x loss_x 0.3074 (0.2557) acc_x 93.7500 (93.9286) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/14] time 0.291 (0.295) data 0.213 (0.218) loss_u loss_u 0.9199 (0.9062) acc_u 9.3750 (11.8750) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/14] time 0.295 (0.295) data 0.216 (0.217) loss_u loss_u 0.8853 (0.8992) acc_u 12.5000 (11.8750) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 139
confident_label rate tensor(0.6967, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1137
clean true:1136
clean false:1
clean_rate:0.9991204925241864
noisy true:357
noisy false:138
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 495
epoch [200/200] batch [5/35] time 0.325 (0.337) data 0.246 (0.258) loss_x loss_x 0.1313 (0.1693) acc_x 96.8750 (96.8750) lr 4.9344e-07 eta 0:00:10
epoch [200/200] batch [10/35] time 0.309 (0.325) data 0.231 (0.246) loss_x loss_x 0.3896 (0.2824) acc_x 90.6250 (93.1250) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [15/35] time 0.301 (0.319) data 0.223 (0.241) loss_x loss_x 0.2932 (0.2757) acc_x 90.6250 (93.3333) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [20/35] time 0.298 (0.314) data 0.219 (0.236) loss_x loss_x 0.2849 (0.2862) acc_x 93.7500 (93.4375) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [25/35] time 0.300 (0.311) data 0.222 (0.233) loss_x loss_x 0.2151 (0.2684) acc_x 96.8750 (94.0000) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [30/35] time 0.304 (0.310) data 0.225 (0.231) loss_x loss_x 0.1631 (0.2578) acc_x 100.0000 (94.2708) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [35/35] time 0.296 (0.308) data 0.217 (0.229) loss_x loss_x 0.4077 (0.2553) acc_x 87.5000 (94.1071) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/15] time 0.301 (0.307) data 0.221 (0.228) loss_u loss_u 0.8481 (0.8758) acc_u 15.6250 (13.7500) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/15] time 0.311 (0.307) data 0.231 (0.228) loss_u loss_u 0.8901 (0.8844) acc_u 12.5000 (13.1250) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/15] time 0.301 (0.307) data 0.221 (0.228) loss_u loss_u 0.9434 (0.8794) acc_u 6.2500 (13.9583) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,283
* accuracy: 92.7%
* error: 7.3%
* macro_f1: 92.6%
Elapsed: 2:11:07
