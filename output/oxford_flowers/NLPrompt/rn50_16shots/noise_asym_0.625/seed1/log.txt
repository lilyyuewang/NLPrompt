***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1255
confident_label rate tensor(0.0901, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 147
clean true:141
clean false:6
clean_rate:0.9591836734693877
noisy true:236
noisy false:1249
after delete: len(clean_dataset) 147
after delete: len(noisy_dataset) 1485
epoch [1/200] batch [1/4] time 0.447 (0.447) data 0.274 (0.274) loss_x loss_x 2.5918 (2.5918) acc_x 56.2500 (56.2500) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [2/4] time 0.342 (0.395) data 0.264 (0.269) loss_x loss_x 2.9629 (2.7773) acc_x 40.6250 (48.4375) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [3/4] time 0.330 (0.373) data 0.253 (0.264) loss_x loss_x 3.2617 (2.9388) acc_x 15.6250 (37.5000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [4/4] time 0.329 (0.362) data 0.251 (0.261) loss_x loss_x 2.6367 (2.8633) acc_x 37.5000 (37.5000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/46] time 0.339 (0.351) data 0.261 (0.260) loss_u loss_u 0.9927 (0.9877) acc_u 0.0000 (0.0000) lr 1.0000e-05 eta 0:00:14
epoch [1/200] batch [10/46] time 0.307 (0.341) data 0.229 (0.255) loss_u loss_u 0.9883 (0.9851) acc_u 0.0000 (1.8750) lr 1.0000e-05 eta 0:00:12
epoch [1/200] batch [15/46] time 0.315 (0.338) data 0.237 (0.255) loss_u loss_u 0.9785 (0.9834) acc_u 3.1250 (2.5000) lr 1.0000e-05 eta 0:00:10
epoch [1/200] batch [20/46] time 0.337 (0.336) data 0.260 (0.254) loss_u loss_u 0.9775 (0.9834) acc_u 3.1250 (2.5000) lr 1.0000e-05 eta 0:00:08
epoch [1/200] batch [25/46] time 0.345 (0.337) data 0.267 (0.255) loss_u loss_u 0.9839 (0.9838) acc_u 3.1250 (2.3750) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [30/46] time 0.317 (0.335) data 0.240 (0.254) loss_u loss_u 0.9824 (0.9845) acc_u 6.2500 (2.5000) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [35/46] time 0.322 (0.333) data 0.245 (0.253) loss_u loss_u 0.9790 (0.9838) acc_u 3.1250 (2.8571) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [40/46] time 0.291 (0.332) data 0.212 (0.252) loss_u loss_u 0.9541 (0.9828) acc_u 6.2500 (3.1250) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [45/46] time 0.291 (0.328) data 0.212 (0.248) loss_u loss_u 0.9888 (0.9827) acc_u 0.0000 (3.0556) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1145
confident_label rate tensor(0.1091, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 178
clean true:173
clean false:5
clean_rate:0.9719101123595506
noisy true:314
noisy false:1140
after delete: len(clean_dataset) 178
after delete: len(noisy_dataset) 1454
epoch [2/200] batch [5/5] time 0.338 (0.338) data 0.261 (0.261) loss_x loss_x 0.7471 (1.2984) acc_x 84.3750 (70.0000) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/45] time 0.346 (0.340) data 0.268 (0.262) loss_u loss_u 0.9224 (0.9011) acc_u 9.3750 (13.1250) lr 2.0000e-03 eta 0:00:13
epoch [2/200] batch [10/45] time 0.342 (0.340) data 0.264 (0.263) loss_u loss_u 0.9341 (0.9009) acc_u 9.3750 (12.1875) lr 2.0000e-03 eta 0:00:11
epoch [2/200] batch [15/45] time 0.353 (0.343) data 0.275 (0.265) loss_u loss_u 0.8516 (0.8874) acc_u 18.7500 (13.7500) lr 2.0000e-03 eta 0:00:10
epoch [2/200] batch [20/45] time 0.326 (0.340) data 0.248 (0.262) loss_u loss_u 0.9165 (0.8922) acc_u 9.3750 (13.1250) lr 2.0000e-03 eta 0:00:08
epoch [2/200] batch [25/45] time 0.329 (0.339) data 0.252 (0.261) loss_u loss_u 0.9399 (0.8939) acc_u 6.2500 (12.7500) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [30/45] time 0.323 (0.337) data 0.246 (0.260) loss_u loss_u 0.8970 (0.8936) acc_u 15.6250 (12.8125) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [35/45] time 0.337 (0.337) data 0.259 (0.260) loss_u loss_u 0.9150 (0.8980) acc_u 15.6250 (12.4107) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [40/45] time 0.303 (0.336) data 0.224 (0.258) loss_u loss_u 0.8652 (0.8964) acc_u 15.6250 (12.4219) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [45/45] time 0.342 (0.332) data 0.264 (0.255) loss_u loss_u 0.9062 (0.8988) acc_u 12.5000 (12.2222) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 768
confident_label rate tensor(0.2016, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 329
clean true:324
clean false:5
clean_rate:0.9848024316109423
noisy true:540
noisy false:763
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1303
epoch [3/200] batch [5/10] time 0.314 (0.343) data 0.237 (0.265) loss_x loss_x 0.8975 (0.9108) acc_x 75.0000 (79.3750) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/10] time 0.304 (0.322) data 0.227 (0.245) loss_x loss_x 0.6665 (0.8387) acc_x 81.2500 (82.1875) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/40] time 0.329 (0.325) data 0.251 (0.247) loss_u loss_u 0.9268 (0.9603) acc_u 6.2500 (3.7500) lr 1.9999e-03 eta 0:00:11
epoch [3/200] batch [10/40] time 0.332 (0.329) data 0.254 (0.251) loss_u loss_u 0.9502 (0.9563) acc_u 9.3750 (5.0000) lr 1.9999e-03 eta 0:00:09
epoch [3/200] batch [15/40] time 0.342 (0.330) data 0.265 (0.253) loss_u loss_u 0.9756 (0.9614) acc_u 6.2500 (4.3750) lr 1.9999e-03 eta 0:00:08
epoch [3/200] batch [20/40] time 0.347 (0.333) data 0.269 (0.255) loss_u loss_u 0.9546 (0.9593) acc_u 9.3750 (5.1562) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [25/40] time 0.349 (0.334) data 0.272 (0.256) loss_u loss_u 0.9458 (0.9585) acc_u 12.5000 (5.3750) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [30/40] time 0.362 (0.334) data 0.285 (0.257) loss_u loss_u 0.9551 (0.9561) acc_u 6.2500 (5.5208) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [35/40] time 0.331 (0.335) data 0.252 (0.258) loss_u loss_u 0.9287 (0.9536) acc_u 9.3750 (5.8929) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [40/40] time 0.311 (0.332) data 0.232 (0.254) loss_u loss_u 0.9214 (0.9525) acc_u 12.5000 (5.9375) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 737
confident_label rate tensor(0.2126, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 347
clean true:339
clean false:8
clean_rate:0.9769452449567724
noisy true:556
noisy false:729
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1285
epoch [4/200] batch [5/10] time 0.330 (0.342) data 0.253 (0.264) loss_x loss_x 1.6377 (1.0461) acc_x 56.2500 (72.5000) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/10] time 0.332 (0.342) data 0.254 (0.264) loss_x loss_x 0.7236 (0.8985) acc_x 81.2500 (77.5000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/40] time 0.345 (0.342) data 0.267 (0.264) loss_u loss_u 0.9785 (0.9699) acc_u 3.1250 (3.7500) lr 1.9995e-03 eta 0:00:11
epoch [4/200] batch [10/40] time 0.355 (0.343) data 0.276 (0.265) loss_u loss_u 0.9219 (0.9652) acc_u 9.3750 (4.6875) lr 1.9995e-03 eta 0:00:10
epoch [4/200] batch [15/40] time 0.343 (0.343) data 0.265 (0.265) loss_u loss_u 0.9580 (0.9587) acc_u 6.2500 (5.6250) lr 1.9995e-03 eta 0:00:08
epoch [4/200] batch [20/40] time 0.343 (0.343) data 0.266 (0.265) loss_u loss_u 0.9644 (0.9620) acc_u 6.2500 (5.1562) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [25/40] time 0.356 (0.344) data 0.278 (0.266) loss_u loss_u 0.9565 (0.9595) acc_u 6.2500 (5.2500) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [30/40] time 0.349 (0.344) data 0.271 (0.266) loss_u loss_u 0.9546 (0.9584) acc_u 6.2500 (5.3125) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [35/40] time 0.349 (0.343) data 0.272 (0.265) loss_u loss_u 0.9590 (0.9586) acc_u 3.1250 (5.1786) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [40/40] time 0.296 (0.340) data 0.218 (0.262) loss_u loss_u 0.9399 (0.9567) acc_u 6.2500 (5.3125) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 705
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 356
clean true:352
clean false:4
clean_rate:0.9887640449438202
noisy true:575
noisy false:701
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1276
epoch [5/200] batch [5/11] time 0.346 (0.338) data 0.269 (0.261) loss_x loss_x 0.4724 (0.7200) acc_x 84.3750 (84.3750) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/11] time 0.336 (0.344) data 0.258 (0.267) loss_x loss_x 0.7725 (0.8084) acc_x 87.5000 (82.5000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/39] time 0.330 (0.342) data 0.253 (0.265) loss_u loss_u 0.9253 (0.9535) acc_u 9.3750 (4.3750) lr 1.9989e-03 eta 0:00:11
epoch [5/200] batch [10/39] time 0.310 (0.338) data 0.232 (0.261) loss_u loss_u 0.9380 (0.9539) acc_u 6.2500 (5.0000) lr 1.9989e-03 eta 0:00:09
epoch [5/200] batch [15/39] time 0.343 (0.338) data 0.264 (0.260) loss_u loss_u 0.9614 (0.9571) acc_u 3.1250 (4.7917) lr 1.9989e-03 eta 0:00:08
epoch [5/200] batch [20/39] time 0.347 (0.338) data 0.269 (0.260) loss_u loss_u 0.9624 (0.9569) acc_u 6.2500 (5.1562) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [25/39] time 0.348 (0.339) data 0.270 (0.261) loss_u loss_u 0.9062 (0.9542) acc_u 12.5000 (5.5000) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [30/39] time 0.341 (0.339) data 0.264 (0.261) loss_u loss_u 0.9438 (0.9545) acc_u 6.2500 (5.4167) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [35/39] time 0.306 (0.338) data 0.227 (0.260) loss_u loss_u 0.9248 (0.9538) acc_u 9.3750 (5.4464) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 709
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 359
clean true:354
clean false:5
clean_rate:0.9860724233983287
noisy true:569
noisy false:704
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1273
epoch [6/200] batch [5/11] time 0.347 (0.344) data 0.270 (0.266) loss_x loss_x 0.7632 (0.8077) acc_x 78.1250 (83.1250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/11] time 0.338 (0.340) data 0.259 (0.262) loss_x loss_x 0.9810 (0.8116) acc_x 75.0000 (80.9375) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/39] time 0.346 (0.340) data 0.267 (0.262) loss_u loss_u 0.9580 (0.9434) acc_u 6.2500 (6.2500) lr 1.9980e-03 eta 0:00:11
epoch [6/200] batch [10/39] time 0.334 (0.341) data 0.256 (0.263) loss_u loss_u 0.8687 (0.9419) acc_u 12.5000 (6.2500) lr 1.9980e-03 eta 0:00:09
epoch [6/200] batch [15/39] time 0.327 (0.341) data 0.249 (0.263) loss_u loss_u 0.9868 (0.9463) acc_u 3.1250 (6.0417) lr 1.9980e-03 eta 0:00:08
epoch [6/200] batch [20/39] time 0.337 (0.339) data 0.259 (0.261) loss_u loss_u 0.9683 (0.9497) acc_u 3.1250 (5.6250) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [25/39] time 0.345 (0.339) data 0.268 (0.261) loss_u loss_u 0.9756 (0.9532) acc_u 6.2500 (5.5000) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [30/39] time 0.343 (0.339) data 0.265 (0.261) loss_u loss_u 0.8906 (0.9534) acc_u 12.5000 (5.3125) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [35/39] time 0.302 (0.337) data 0.223 (0.259) loss_u loss_u 0.9619 (0.9556) acc_u 3.1250 (4.9107) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 702
confident_label rate tensor(0.2126, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 347
clean true:345
clean false:2
clean_rate:0.9942363112391931
noisy true:585
noisy false:700
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1285
epoch [7/200] batch [5/10] time 0.334 (0.334) data 0.256 (0.256) loss_x loss_x 1.1318 (0.7803) acc_x 78.1250 (81.2500) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/10] time 0.334 (0.339) data 0.257 (0.261) loss_x loss_x 0.6865 (0.8016) acc_x 84.3750 (81.5625) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/40] time 0.343 (0.339) data 0.264 (0.261) loss_u loss_u 0.9639 (0.9341) acc_u 3.1250 (8.7500) lr 1.9969e-03 eta 0:00:11
epoch [7/200] batch [10/40] time 0.342 (0.339) data 0.264 (0.261) loss_u loss_u 0.9580 (0.9408) acc_u 6.2500 (7.8125) lr 1.9969e-03 eta 0:00:10
epoch [7/200] batch [15/40] time 0.337 (0.339) data 0.259 (0.261) loss_u loss_u 0.9653 (0.9406) acc_u 6.2500 (7.9167) lr 1.9969e-03 eta 0:00:08
epoch [7/200] batch [20/40] time 0.348 (0.341) data 0.271 (0.263) loss_u loss_u 0.9512 (0.9372) acc_u 3.1250 (8.1250) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [25/40] time 0.339 (0.341) data 0.261 (0.264) loss_u loss_u 0.9331 (0.9391) acc_u 6.2500 (7.3750) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [30/40] time 0.315 (0.338) data 0.237 (0.260) loss_u loss_u 0.9512 (0.9409) acc_u 9.3750 (7.3958) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [35/40] time 0.331 (0.337) data 0.252 (0.259) loss_u loss_u 0.9902 (0.9423) acc_u 0.0000 (7.1429) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [40/40] time 0.346 (0.334) data 0.268 (0.256) loss_u loss_u 0.9697 (0.9456) acc_u 3.1250 (6.7969) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 717
confident_label rate tensor(0.2108, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 344
clean true:339
clean false:5
clean_rate:0.9854651162790697
noisy true:576
noisy false:712
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1288
epoch [8/200] batch [5/10] time 0.337 (0.346) data 0.259 (0.267) loss_x loss_x 0.5659 (0.6275) acc_x 81.2500 (83.7500) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/10] time 0.332 (0.344) data 0.254 (0.266) loss_x loss_x 0.6597 (0.7196) acc_x 78.1250 (80.6250) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/40] time 0.351 (0.343) data 0.273 (0.265) loss_u loss_u 0.9634 (0.9463) acc_u 3.1250 (6.2500) lr 1.9956e-03 eta 0:00:12
epoch [8/200] batch [10/40] time 0.338 (0.342) data 0.260 (0.264) loss_u loss_u 0.9219 (0.9427) acc_u 12.5000 (6.8750) lr 1.9956e-03 eta 0:00:10
epoch [8/200] batch [15/40] time 0.333 (0.342) data 0.255 (0.265) loss_u loss_u 0.9497 (0.9422) acc_u 9.3750 (7.5000) lr 1.9956e-03 eta 0:00:08
epoch [8/200] batch [20/40] time 0.335 (0.342) data 0.257 (0.265) loss_u loss_u 0.9326 (0.9386) acc_u 6.2500 (7.8125) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [25/40] time 0.356 (0.343) data 0.278 (0.265) loss_u loss_u 0.9067 (0.9384) acc_u 9.3750 (7.8750) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [30/40] time 0.341 (0.342) data 0.264 (0.264) loss_u loss_u 0.9331 (0.9406) acc_u 12.5000 (7.6042) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [35/40] time 0.334 (0.339) data 0.255 (0.261) loss_u loss_u 0.8721 (0.9396) acc_u 18.7500 (7.7679) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [40/40] time 0.357 (0.338) data 0.278 (0.260) loss_u loss_u 0.9492 (0.9419) acc_u 6.2500 (7.5000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 687
confident_label rate tensor(0.2267, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 370
clean true:364
clean false:6
clean_rate:0.9837837837837838
noisy true:581
noisy false:681
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1262
epoch [9/200] batch [5/11] time 0.345 (0.346) data 0.268 (0.269) loss_x loss_x 0.3787 (0.5711) acc_x 87.5000 (86.8750) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/11] time 0.359 (0.345) data 0.281 (0.267) loss_x loss_x 0.4258 (0.6322) acc_x 90.6250 (85.3125) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/39] time 0.343 (0.346) data 0.265 (0.268) loss_u loss_u 0.9673 (0.9487) acc_u 3.1250 (5.0000) lr 1.9940e-03 eta 0:00:11
epoch [9/200] batch [10/39] time 0.352 (0.347) data 0.274 (0.269) loss_u loss_u 0.9536 (0.9496) acc_u 6.2500 (5.9375) lr 1.9940e-03 eta 0:00:10
epoch [9/200] batch [15/39] time 0.343 (0.346) data 0.266 (0.268) loss_u loss_u 0.9912 (0.9500) acc_u 0.0000 (5.8333) lr 1.9940e-03 eta 0:00:08
epoch [9/200] batch [20/39] time 0.341 (0.346) data 0.264 (0.268) loss_u loss_u 0.8975 (0.9493) acc_u 9.3750 (5.4688) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [25/39] time 0.352 (0.344) data 0.274 (0.267) loss_u loss_u 0.9863 (0.9529) acc_u 0.0000 (5.1250) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [30/39] time 0.342 (0.344) data 0.264 (0.266) loss_u loss_u 0.9292 (0.9514) acc_u 9.3750 (5.3125) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [35/39] time 0.296 (0.342) data 0.217 (0.264) loss_u loss_u 0.9429 (0.9485) acc_u 9.3750 (5.8929) lr 1.9940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 665
confident_label rate tensor(0.2335, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 381
clean true:378
clean false:3
clean_rate:0.9921259842519685
noisy true:589
noisy false:662
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1251
epoch [10/200] batch [5/11] time 0.336 (0.334) data 0.258 (0.256) loss_x loss_x 0.7959 (0.7250) acc_x 81.2500 (80.0000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/11] time 0.342 (0.336) data 0.264 (0.258) loss_x loss_x 0.4382 (0.6929) acc_x 93.7500 (81.8750) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/39] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9673 (0.9444) acc_u 3.1250 (6.8750) lr 1.9921e-03 eta 0:00:11
epoch [10/200] batch [10/39] time 0.339 (0.338) data 0.261 (0.260) loss_u loss_u 0.9565 (0.9444) acc_u 6.2500 (6.8750) lr 1.9921e-03 eta 0:00:09
epoch [10/200] batch [15/39] time 0.340 (0.338) data 0.263 (0.260) loss_u loss_u 0.9883 (0.9482) acc_u 0.0000 (6.6667) lr 1.9921e-03 eta 0:00:08
epoch [10/200] batch [20/39] time 0.329 (0.337) data 0.251 (0.259) loss_u loss_u 0.9424 (0.9486) acc_u 9.3750 (6.7188) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [25/39] time 0.319 (0.336) data 0.240 (0.258) loss_u loss_u 0.9673 (0.9468) acc_u 3.1250 (6.7500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [30/39] time 0.343 (0.337) data 0.266 (0.259) loss_u loss_u 0.9863 (0.9494) acc_u 0.0000 (6.4583) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [35/39] time 0.327 (0.337) data 0.249 (0.260) loss_u loss_u 0.9370 (0.9486) acc_u 6.2500 (6.6071) lr 1.9921e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 683
confident_label rate tensor(0.2304, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 376
clean true:367
clean false:9
clean_rate:0.976063829787234
noisy true:582
noisy false:674
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1256
epoch [11/200] batch [5/11] time 0.330 (0.344) data 0.253 (0.266) loss_x loss_x 0.4194 (0.7588) acc_x 90.6250 (83.1250) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/11] time 0.327 (0.339) data 0.249 (0.262) loss_x loss_x 0.8120 (0.7319) acc_x 78.1250 (84.0625) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/39] time 0.343 (0.337) data 0.265 (0.260) loss_u loss_u 0.8657 (0.9076) acc_u 18.7500 (11.8750) lr 1.9900e-03 eta 0:00:11
epoch [11/200] batch [10/39] time 0.318 (0.338) data 0.241 (0.260) loss_u loss_u 0.9673 (0.9343) acc_u 3.1250 (8.7500) lr 1.9900e-03 eta 0:00:09
epoch [11/200] batch [15/39] time 0.328 (0.339) data 0.250 (0.261) loss_u loss_u 0.9663 (0.9408) acc_u 6.2500 (7.5000) lr 1.9900e-03 eta 0:00:08
epoch [11/200] batch [20/39] time 0.351 (0.339) data 0.274 (0.261) loss_u loss_u 0.9658 (0.9435) acc_u 3.1250 (7.1875) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [25/39] time 0.343 (0.339) data 0.265 (0.261) loss_u loss_u 0.9395 (0.9440) acc_u 6.2500 (6.8750) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [30/39] time 0.332 (0.339) data 0.254 (0.261) loss_u loss_u 0.9619 (0.9461) acc_u 6.2500 (6.6667) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [35/39] time 0.312 (0.339) data 0.233 (0.261) loss_u loss_u 0.9580 (0.9498) acc_u 3.1250 (6.1607) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 655
confident_label rate tensor(0.2371, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 387
clean true:382
clean false:5
clean_rate:0.9870801033591732
noisy true:595
noisy false:650
after delete: len(clean_dataset) 387
after delete: len(noisy_dataset) 1245
epoch [12/200] batch [5/12] time 0.335 (0.338) data 0.257 (0.260) loss_x loss_x 1.1104 (0.8536) acc_x 71.8750 (83.1250) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/12] time 0.334 (0.335) data 0.257 (0.257) loss_x loss_x 0.6289 (0.8169) acc_x 90.6250 (82.5000) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/38] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.8784 (0.9410) acc_u 15.6250 (6.8750) lr 1.9877e-03 eta 0:00:11
epoch [12/200] batch [10/38] time 0.349 (0.338) data 0.271 (0.261) loss_u loss_u 0.9409 (0.9489) acc_u 6.2500 (5.9375) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [15/38] time 0.357 (0.341) data 0.279 (0.263) loss_u loss_u 0.9453 (0.9462) acc_u 9.3750 (7.0833) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [20/38] time 0.347 (0.342) data 0.269 (0.264) loss_u loss_u 0.9321 (0.9398) acc_u 9.3750 (7.8125) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [25/38] time 0.348 (0.343) data 0.269 (0.265) loss_u loss_u 0.9307 (0.9410) acc_u 6.2500 (7.3750) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [30/38] time 0.339 (0.342) data 0.261 (0.264) loss_u loss_u 0.9551 (0.9423) acc_u 3.1250 (7.1875) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [35/38] time 0.303 (0.340) data 0.224 (0.262) loss_u loss_u 0.9580 (0.9450) acc_u 3.1250 (6.5179) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 627
confident_label rate tensor(0.2414, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 394
clean true:384
clean false:10
clean_rate:0.9746192893401016
noisy true:621
noisy false:617
after delete: len(clean_dataset) 394
after delete: len(noisy_dataset) 1238
epoch [13/200] batch [5/12] time 0.329 (0.338) data 0.250 (0.260) loss_x loss_x 0.9561 (0.7056) acc_x 84.3750 (84.3750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/12] time 0.332 (0.335) data 0.255 (0.258) loss_x loss_x 0.7231 (0.6940) acc_x 75.0000 (83.7500) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/38] time 0.338 (0.339) data 0.260 (0.261) loss_u loss_u 0.9683 (0.9443) acc_u 3.1250 (5.6250) lr 1.9851e-03 eta 0:00:11
epoch [13/200] batch [10/38] time 0.337 (0.337) data 0.259 (0.259) loss_u loss_u 0.9810 (0.9471) acc_u 3.1250 (6.5625) lr 1.9851e-03 eta 0:00:09
epoch [13/200] batch [15/38] time 0.334 (0.337) data 0.256 (0.259) loss_u loss_u 0.9380 (0.9434) acc_u 6.2500 (7.0833) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [20/38] time 0.321 (0.336) data 0.243 (0.259) loss_u loss_u 0.9795 (0.9450) acc_u 3.1250 (7.3438) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [25/38] time 0.349 (0.336) data 0.271 (0.258) loss_u loss_u 0.9375 (0.9446) acc_u 9.3750 (7.5000) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [30/38] time 0.349 (0.337) data 0.269 (0.260) loss_u loss_u 0.9292 (0.9477) acc_u 9.3750 (6.9792) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [35/38] time 0.323 (0.338) data 0.245 (0.260) loss_u loss_u 0.9458 (0.9495) acc_u 9.3750 (6.8750) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 603
confident_label rate tensor(0.2543, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 415
clean true:405
clean false:10
clean_rate:0.9759036144578314
noisy true:624
noisy false:593
after delete: len(clean_dataset) 415
after delete: len(noisy_dataset) 1217
epoch [14/200] batch [5/12] time 0.335 (0.346) data 0.258 (0.269) loss_x loss_x 1.0215 (0.6400) acc_x 75.0000 (85.6250) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/12] time 0.336 (0.339) data 0.259 (0.261) loss_x loss_x 0.4888 (0.7060) acc_x 90.6250 (83.7500) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/38] time 0.332 (0.334) data 0.254 (0.256) loss_u loss_u 0.9561 (0.9707) acc_u 6.2500 (3.1250) lr 1.9823e-03 eta 0:00:11
epoch [14/200] batch [10/38] time 0.337 (0.335) data 0.260 (0.257) loss_u loss_u 0.9614 (0.9553) acc_u 3.1250 (5.6250) lr 1.9823e-03 eta 0:00:09
epoch [14/200] batch [15/38] time 0.330 (0.336) data 0.252 (0.258) loss_u loss_u 0.9629 (0.9559) acc_u 3.1250 (5.4167) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [20/38] time 0.357 (0.337) data 0.280 (0.259) loss_u loss_u 0.9448 (0.9566) acc_u 9.3750 (5.6250) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [25/38] time 0.349 (0.338) data 0.272 (0.261) loss_u loss_u 0.9741 (0.9554) acc_u 6.2500 (6.0000) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [30/38] time 0.347 (0.339) data 0.269 (0.261) loss_u loss_u 0.9531 (0.9545) acc_u 3.1250 (5.8333) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [35/38] time 0.344 (0.340) data 0.265 (0.262) loss_u loss_u 0.9829 (0.9567) acc_u 0.0000 (5.5357) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 611
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 408
clean true:397
clean false:11
clean_rate:0.9730392156862745
noisy true:624
noisy false:600
after delete: len(clean_dataset) 408
after delete: len(noisy_dataset) 1224
epoch [15/200] batch [5/12] time 0.349 (0.341) data 0.272 (0.264) loss_x loss_x 0.6978 (0.7349) acc_x 87.5000 (84.3750) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/12] time 0.350 (0.340) data 0.272 (0.262) loss_x loss_x 0.5640 (0.7301) acc_x 87.5000 (83.7500) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/38] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9492 (0.9624) acc_u 6.2500 (4.3750) lr 1.9792e-03 eta 0:00:11
epoch [15/200] batch [10/38] time 0.332 (0.340) data 0.255 (0.263) loss_u loss_u 0.9321 (0.9479) acc_u 9.3750 (6.5625) lr 1.9792e-03 eta 0:00:09
epoch [15/200] batch [15/38] time 0.331 (0.339) data 0.254 (0.262) loss_u loss_u 0.9473 (0.9432) acc_u 6.2500 (6.8750) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [20/38] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9731 (0.9444) acc_u 3.1250 (6.7188) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [25/38] time 0.328 (0.339) data 0.250 (0.261) loss_u loss_u 0.9287 (0.9425) acc_u 6.2500 (6.7500) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [30/38] time 0.346 (0.340) data 0.268 (0.262) loss_u loss_u 0.9517 (0.9449) acc_u 3.1250 (6.2500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [35/38] time 0.307 (0.339) data 0.229 (0.261) loss_u loss_u 0.9355 (0.9463) acc_u 9.3750 (6.3393) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 611
confident_label rate tensor(0.2525, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 412
clean true:404
clean false:8
clean_rate:0.9805825242718447
noisy true:617
noisy false:603
after delete: len(clean_dataset) 412
after delete: len(noisy_dataset) 1220
epoch [16/200] batch [5/12] time 0.331 (0.343) data 0.254 (0.265) loss_x loss_x 0.7661 (0.6932) acc_x 68.7500 (81.8750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/12] time 0.341 (0.341) data 0.264 (0.263) loss_x loss_x 0.6919 (0.7234) acc_x 87.5000 (82.8125) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/38] time 0.337 (0.338) data 0.258 (0.260) loss_u loss_u 0.9966 (0.9592) acc_u 0.0000 (5.0000) lr 1.9759e-03 eta 0:00:11
epoch [16/200] batch [10/38] time 0.329 (0.337) data 0.251 (0.259) loss_u loss_u 0.9771 (0.9455) acc_u 3.1250 (6.5625) lr 1.9759e-03 eta 0:00:09
epoch [16/200] batch [15/38] time 0.337 (0.336) data 0.259 (0.258) loss_u loss_u 0.9268 (0.9434) acc_u 9.3750 (7.2917) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [20/38] time 0.339 (0.334) data 0.261 (0.257) loss_u loss_u 0.9771 (0.9495) acc_u 0.0000 (6.4062) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [25/38] time 0.337 (0.336) data 0.259 (0.258) loss_u loss_u 0.9199 (0.9495) acc_u 12.5000 (6.5000) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [30/38] time 0.341 (0.337) data 0.263 (0.259) loss_u loss_u 0.9180 (0.9514) acc_u 9.3750 (6.1458) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [35/38] time 0.307 (0.336) data 0.228 (0.258) loss_u loss_u 0.9468 (0.9497) acc_u 6.2500 (6.1607) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 572
confident_label rate tensor(0.2598, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 424
clean true:417
clean false:7
clean_rate:0.9834905660377359
noisy true:643
noisy false:565
after delete: len(clean_dataset) 424
after delete: len(noisy_dataset) 1208
epoch [17/200] batch [5/13] time 0.352 (0.351) data 0.275 (0.274) loss_x loss_x 0.4805 (0.5358) acc_x 93.7500 (89.3750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/13] time 0.331 (0.346) data 0.254 (0.269) loss_x loss_x 0.6206 (0.5341) acc_x 90.6250 (89.6875) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [5/37] time 0.323 (0.340) data 0.245 (0.262) loss_u loss_u 0.9189 (0.9199) acc_u 9.3750 (10.0000) lr 1.9724e-03 eta 0:00:10
epoch [17/200] batch [10/37] time 0.334 (0.340) data 0.257 (0.262) loss_u loss_u 0.8931 (0.9290) acc_u 12.5000 (8.7500) lr 1.9724e-03 eta 0:00:09
epoch [17/200] batch [15/37] time 0.337 (0.340) data 0.258 (0.262) loss_u loss_u 0.9771 (0.9409) acc_u 3.1250 (7.0833) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [20/37] time 0.339 (0.339) data 0.261 (0.262) loss_u loss_u 0.9858 (0.9518) acc_u 0.0000 (5.4688) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [25/37] time 0.330 (0.340) data 0.252 (0.262) loss_u loss_u 0.9341 (0.9524) acc_u 9.3750 (5.3750) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [30/37] time 0.347 (0.340) data 0.269 (0.262) loss_u loss_u 0.8877 (0.9485) acc_u 18.7500 (6.2500) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [35/37] time 0.353 (0.341) data 0.274 (0.263) loss_u loss_u 0.8901 (0.9483) acc_u 12.5000 (6.3393) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 569
confident_label rate tensor(0.2702, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 441
clean true:430
clean false:11
clean_rate:0.9750566893424036
noisy true:633
noisy false:558
after delete: len(clean_dataset) 441
after delete: len(noisy_dataset) 1191
epoch [18/200] batch [5/13] time 0.331 (0.341) data 0.254 (0.264) loss_x loss_x 0.4739 (0.6555) acc_x 93.7500 (84.3750) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/13] time 0.343 (0.339) data 0.266 (0.262) loss_x loss_x 0.7397 (0.6069) acc_x 81.2500 (84.6875) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [5/37] time 0.341 (0.340) data 0.263 (0.263) loss_u loss_u 0.9419 (0.9606) acc_u 6.2500 (5.0000) lr 1.9686e-03 eta 0:00:10
epoch [18/200] batch [10/37] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9883 (0.9596) acc_u 0.0000 (4.0625) lr 1.9686e-03 eta 0:00:09
epoch [18/200] batch [15/37] time 0.326 (0.341) data 0.248 (0.263) loss_u loss_u 0.9395 (0.9570) acc_u 6.2500 (4.7917) lr 1.9686e-03 eta 0:00:07
epoch [18/200] batch [20/37] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.9619 (0.9588) acc_u 6.2500 (4.6875) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [25/37] time 0.344 (0.341) data 0.267 (0.263) loss_u loss_u 0.9077 (0.9571) acc_u 12.5000 (5.0000) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [30/37] time 0.337 (0.341) data 0.260 (0.263) loss_u loss_u 0.9136 (0.9538) acc_u 12.5000 (5.7292) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [35/37] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.9287 (0.9503) acc_u 9.3750 (6.0714) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 590
confident_label rate tensor(0.2610, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 426
clean true:411
clean false:15
clean_rate:0.9647887323943662
noisy true:631
noisy false:575
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1206
epoch [19/200] batch [5/13] time 0.353 (0.347) data 0.275 (0.270) loss_x loss_x 0.7217 (0.6992) acc_x 75.0000 (80.6250) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/13] time 0.366 (0.347) data 0.287 (0.269) loss_x loss_x 0.3342 (0.6138) acc_x 90.6250 (85.3125) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [5/37] time 0.344 (0.345) data 0.266 (0.267) loss_u loss_u 0.9678 (0.9347) acc_u 3.1250 (9.3750) lr 1.9646e-03 eta 0:00:11
epoch [19/200] batch [10/37] time 0.337 (0.343) data 0.259 (0.266) loss_u loss_u 0.9380 (0.9433) acc_u 6.2500 (7.8125) lr 1.9646e-03 eta 0:00:09
epoch [19/200] batch [15/37] time 0.338 (0.342) data 0.260 (0.264) loss_u loss_u 0.9126 (0.9388) acc_u 15.6250 (8.3333) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [20/37] time 0.343 (0.341) data 0.266 (0.263) loss_u loss_u 0.9883 (0.9428) acc_u 0.0000 (7.3438) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [25/37] time 0.324 (0.340) data 0.246 (0.262) loss_u loss_u 0.9297 (0.9425) acc_u 6.2500 (7.1250) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [30/37] time 0.338 (0.339) data 0.260 (0.261) loss_u loss_u 0.9922 (0.9473) acc_u 0.0000 (6.3542) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [35/37] time 0.316 (0.338) data 0.237 (0.260) loss_u loss_u 0.9258 (0.9458) acc_u 9.3750 (6.6071) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 577
confident_label rate tensor(0.2684, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 438
clean true:425
clean false:13
clean_rate:0.9703196347031964
noisy true:630
noisy false:564
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1194
epoch [20/200] batch [5/13] time 0.343 (0.345) data 0.266 (0.268) loss_x loss_x 0.5386 (0.6939) acc_x 78.1250 (82.5000) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/13] time 0.330 (0.342) data 0.252 (0.265) loss_x loss_x 0.4429 (0.5821) acc_x 90.6250 (85.6250) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [5/37] time 0.347 (0.339) data 0.269 (0.261) loss_u loss_u 0.9229 (0.9454) acc_u 12.5000 (6.8750) lr 1.9603e-03 eta 0:00:10
epoch [20/200] batch [10/37] time 0.325 (0.337) data 0.247 (0.260) loss_u loss_u 0.9395 (0.9500) acc_u 12.5000 (6.5625) lr 1.9603e-03 eta 0:00:09
epoch [20/200] batch [15/37] time 0.350 (0.338) data 0.272 (0.261) loss_u loss_u 0.9414 (0.9407) acc_u 6.2500 (7.5000) lr 1.9603e-03 eta 0:00:07
epoch [20/200] batch [20/37] time 0.349 (0.339) data 0.271 (0.261) loss_u loss_u 0.8799 (0.9376) acc_u 15.6250 (8.2812) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [25/37] time 0.335 (0.339) data 0.257 (0.261) loss_u loss_u 0.9663 (0.9432) acc_u 3.1250 (7.5000) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [30/37] time 0.337 (0.339) data 0.259 (0.261) loss_u loss_u 0.9111 (0.9418) acc_u 12.5000 (7.7083) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [35/37] time 0.327 (0.338) data 0.249 (0.261) loss_u loss_u 0.9341 (0.9441) acc_u 9.3750 (7.2321) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 534
confident_label rate tensor(0.2812, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 459
clean true:438
clean false:21
clean_rate:0.954248366013072
noisy true:660
noisy false:513
after delete: len(clean_dataset) 459
after delete: len(noisy_dataset) 1173
epoch [21/200] batch [5/14] time 0.335 (0.345) data 0.257 (0.268) loss_x loss_x 0.8457 (0.7495) acc_x 81.2500 (81.2500) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/14] time 0.335 (0.338) data 0.257 (0.260) loss_x loss_x 0.4385 (0.7125) acc_x 84.3750 (81.2500) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [5/36] time 0.343 (0.340) data 0.265 (0.263) loss_u loss_u 0.9502 (0.9497) acc_u 6.2500 (6.8750) lr 1.9558e-03 eta 0:00:10
epoch [21/200] batch [10/36] time 0.344 (0.340) data 0.266 (0.263) loss_u loss_u 0.9756 (0.9530) acc_u 3.1250 (6.5625) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [15/36] time 0.335 (0.340) data 0.257 (0.263) loss_u loss_u 0.9727 (0.9601) acc_u 3.1250 (5.4167) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [20/36] time 0.343 (0.341) data 0.264 (0.264) loss_u loss_u 0.9604 (0.9569) acc_u 3.1250 (5.3125) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [25/36] time 0.297 (0.340) data 0.218 (0.262) loss_u loss_u 0.9756 (0.9579) acc_u 3.1250 (5.3750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [30/36] time 0.333 (0.339) data 0.255 (0.261) loss_u loss_u 0.9053 (0.9549) acc_u 9.3750 (5.6250) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [35/36] time 0.343 (0.340) data 0.266 (0.262) loss_u loss_u 0.9360 (0.9538) acc_u 9.3750 (5.8929) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 619
confident_label rate tensor(0.2616, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 427
clean true:406
clean false:21
clean_rate:0.9508196721311475
noisy true:607
noisy false:598
after delete: len(clean_dataset) 427
after delete: len(noisy_dataset) 1205
epoch [22/200] batch [5/13] time 0.343 (0.348) data 0.266 (0.270) loss_x loss_x 0.6611 (0.6575) acc_x 87.5000 (85.6250) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/13] time 0.345 (0.347) data 0.267 (0.269) loss_x loss_x 0.7280 (0.6260) acc_x 84.3750 (87.1875) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [5/37] time 0.345 (0.345) data 0.267 (0.267) loss_u loss_u 0.9238 (0.9381) acc_u 9.3750 (8.1250) lr 1.9511e-03 eta 0:00:11
epoch [22/200] batch [10/37] time 0.350 (0.345) data 0.273 (0.268) loss_u loss_u 0.8672 (0.9343) acc_u 15.6250 (8.1250) lr 1.9511e-03 eta 0:00:09
epoch [22/200] batch [15/37] time 0.354 (0.345) data 0.277 (0.268) loss_u loss_u 0.9131 (0.9310) acc_u 12.5000 (8.5417) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [20/37] time 0.349 (0.345) data 0.271 (0.267) loss_u loss_u 0.8804 (0.9315) acc_u 12.5000 (8.5938) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [25/37] time 0.308 (0.342) data 0.230 (0.264) loss_u loss_u 0.9380 (0.9333) acc_u 9.3750 (8.3750) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [30/37] time 0.344 (0.338) data 0.266 (0.260) loss_u loss_u 0.9678 (0.9329) acc_u 3.1250 (8.5417) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [35/37] time 0.347 (0.339) data 0.269 (0.261) loss_u loss_u 0.8779 (0.9311) acc_u 15.6250 (8.6607) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 534
confident_label rate tensor(0.2855, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 466
clean true:440
clean false:26
clean_rate:0.944206008583691
noisy true:658
noisy false:508
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 1166
epoch [23/200] batch [5/14] time 0.330 (0.331) data 0.252 (0.253) loss_x loss_x 0.6929 (0.6750) acc_x 90.6250 (86.8750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/14] time 0.335 (0.335) data 0.257 (0.258) loss_x loss_x 1.0156 (0.6603) acc_x 78.1250 (86.5625) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [5/36] time 0.328 (0.335) data 0.249 (0.257) loss_u loss_u 0.9585 (0.9604) acc_u 6.2500 (4.3750) lr 1.9461e-03 eta 0:00:10
epoch [23/200] batch [10/36] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9507 (0.9568) acc_u 6.2500 (5.0000) lr 1.9461e-03 eta 0:00:08
epoch [23/200] batch [15/36] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9253 (0.9529) acc_u 6.2500 (5.2083) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [20/36] time 0.337 (0.335) data 0.259 (0.258) loss_u loss_u 0.9224 (0.9509) acc_u 9.3750 (5.4688) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [25/36] time 0.330 (0.335) data 0.251 (0.257) loss_u loss_u 0.9849 (0.9511) acc_u 0.0000 (5.3750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [30/36] time 0.349 (0.336) data 0.272 (0.258) loss_u loss_u 0.9482 (0.9522) acc_u 6.2500 (5.3125) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [35/36] time 0.303 (0.333) data 0.224 (0.255) loss_u loss_u 0.9370 (0.9512) acc_u 9.3750 (5.5357) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 565
confident_label rate tensor(0.2837, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 463
clean true:436
clean false:27
clean_rate:0.9416846652267818
noisy true:631
noisy false:538
after delete: len(clean_dataset) 463
after delete: len(noisy_dataset) 1169
epoch [24/200] batch [5/14] time 0.325 (0.333) data 0.248 (0.255) loss_x loss_x 0.4758 (0.4671) acc_x 90.6250 (90.0000) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/14] time 0.350 (0.336) data 0.272 (0.258) loss_x loss_x 0.7261 (0.5505) acc_x 84.3750 (88.1250) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [5/36] time 0.332 (0.339) data 0.254 (0.261) loss_u loss_u 0.9531 (0.9470) acc_u 6.2500 (6.8750) lr 1.9409e-03 eta 0:00:10
epoch [24/200] batch [10/36] time 0.348 (0.338) data 0.270 (0.261) loss_u loss_u 0.9883 (0.9525) acc_u 3.1250 (7.1875) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [15/36] time 0.345 (0.341) data 0.267 (0.264) loss_u loss_u 0.9082 (0.9508) acc_u 9.3750 (6.8750) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [20/36] time 0.334 (0.341) data 0.256 (0.263) loss_u loss_u 0.8853 (0.9482) acc_u 18.7500 (7.1875) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [25/36] time 0.334 (0.340) data 0.256 (0.262) loss_u loss_u 0.9980 (0.9513) acc_u 0.0000 (6.8750) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [30/36] time 0.339 (0.339) data 0.262 (0.261) loss_u loss_u 0.9814 (0.9542) acc_u 0.0000 (6.1458) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [35/36] time 0.303 (0.338) data 0.226 (0.260) loss_u loss_u 0.9009 (0.9510) acc_u 15.6250 (6.3393) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 541
confident_label rate tensor(0.2843, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 464
clean true:446
clean false:18
clean_rate:0.9612068965517241
noisy true:645
noisy false:523
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1168
epoch [25/200] batch [5/14] time 0.348 (0.333) data 0.271 (0.255) loss_x loss_x 0.3757 (0.5538) acc_x 90.6250 (85.0000) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/14] time 0.358 (0.334) data 0.280 (0.256) loss_x loss_x 0.6504 (0.6019) acc_x 87.5000 (85.3125) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [5/36] time 0.329 (0.331) data 0.252 (0.253) loss_u loss_u 0.9590 (0.9313) acc_u 3.1250 (6.8750) lr 1.9354e-03 eta 0:00:10
epoch [25/200] batch [10/36] time 0.341 (0.333) data 0.262 (0.255) loss_u loss_u 0.9517 (0.9470) acc_u 6.2500 (6.2500) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [15/36] time 0.333 (0.334) data 0.255 (0.256) loss_u loss_u 0.9644 (0.9389) acc_u 6.2500 (7.9167) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [20/36] time 0.328 (0.333) data 0.250 (0.255) loss_u loss_u 0.9707 (0.9473) acc_u 3.1250 (6.8750) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [25/36] time 0.342 (0.334) data 0.264 (0.256) loss_u loss_u 0.9355 (0.9482) acc_u 9.3750 (6.6250) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [30/36] time 0.346 (0.335) data 0.267 (0.258) loss_u loss_u 0.9414 (0.9473) acc_u 9.3750 (6.7708) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [35/36] time 0.331 (0.335) data 0.252 (0.257) loss_u loss_u 0.9756 (0.9497) acc_u 3.1250 (6.3393) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 528
confident_label rate tensor(0.2874, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 469
clean true:443
clean false:26
clean_rate:0.9445628997867804
noisy true:661
noisy false:502
after delete: len(clean_dataset) 469
after delete: len(noisy_dataset) 1163
epoch [26/200] batch [5/14] time 0.337 (0.316) data 0.259 (0.238) loss_x loss_x 0.2910 (0.5715) acc_x 93.7500 (86.8750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/14] time 0.343 (0.328) data 0.265 (0.250) loss_x loss_x 0.5894 (0.5509) acc_x 87.5000 (87.1875) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [5/36] time 0.342 (0.336) data 0.263 (0.258) loss_u loss_u 0.9160 (0.9355) acc_u 9.3750 (8.1250) lr 1.9298e-03 eta 0:00:10
epoch [26/200] batch [10/36] time 0.326 (0.338) data 0.247 (0.260) loss_u loss_u 0.9976 (0.9434) acc_u 0.0000 (7.1875) lr 1.9298e-03 eta 0:00:08
epoch [26/200] batch [15/36] time 0.346 (0.337) data 0.268 (0.259) loss_u loss_u 0.9321 (0.9411) acc_u 6.2500 (7.5000) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [20/36] time 0.335 (0.337) data 0.256 (0.259) loss_u loss_u 0.9106 (0.9428) acc_u 9.3750 (7.0312) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [25/36] time 0.346 (0.339) data 0.268 (0.261) loss_u loss_u 0.9272 (0.9406) acc_u 9.3750 (7.3750) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [30/36] time 0.358 (0.340) data 0.280 (0.262) loss_u loss_u 0.9575 (0.9455) acc_u 3.1250 (6.5625) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [35/36] time 0.361 (0.340) data 0.283 (0.262) loss_u loss_u 0.9321 (0.9446) acc_u 6.2500 (6.6071) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 508
confident_label rate tensor(0.2935, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 479
clean true:457
clean false:22
clean_rate:0.954070981210856
noisy true:667
noisy false:486
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1153
epoch [27/200] batch [5/14] time 0.350 (0.349) data 0.272 (0.271) loss_x loss_x 0.9800 (0.6209) acc_x 71.8750 (86.2500) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/14] time 0.333 (0.342) data 0.255 (0.265) loss_x loss_x 0.4556 (0.5570) acc_x 87.5000 (86.2500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [5/36] time 0.336 (0.338) data 0.257 (0.260) loss_u loss_u 0.9985 (0.9503) acc_u 0.0000 (5.6250) lr 1.9239e-03 eta 0:00:10
epoch [27/200] batch [10/36] time 0.338 (0.339) data 0.260 (0.261) loss_u loss_u 0.9048 (0.9448) acc_u 12.5000 (6.2500) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [15/36] time 0.355 (0.341) data 0.277 (0.263) loss_u loss_u 0.8979 (0.9408) acc_u 18.7500 (7.2917) lr 1.9239e-03 eta 0:00:07
epoch [27/200] batch [20/36] time 0.317 (0.341) data 0.238 (0.263) loss_u loss_u 0.9541 (0.9455) acc_u 3.1250 (6.7188) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [25/36] time 0.346 (0.341) data 0.268 (0.263) loss_u loss_u 0.9395 (0.9444) acc_u 6.2500 (6.7500) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [30/36] time 0.320 (0.340) data 0.242 (0.262) loss_u loss_u 0.9531 (0.9465) acc_u 6.2500 (6.4583) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [35/36] time 0.341 (0.340) data 0.262 (0.262) loss_u loss_u 0.9829 (0.9493) acc_u 3.1250 (6.2500) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 519
confident_label rate tensor(0.2935, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 479
clean true:455
clean false:24
clean_rate:0.9498956158663883
noisy true:658
noisy false:495
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1153
epoch [28/200] batch [5/14] time 0.344 (0.330) data 0.266 (0.253) loss_x loss_x 0.6064 (0.6051) acc_x 87.5000 (86.8750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/14] time 0.362 (0.339) data 0.284 (0.261) loss_x loss_x 0.4189 (0.5932) acc_x 93.7500 (86.8750) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [5/36] time 0.349 (0.340) data 0.271 (0.263) loss_u loss_u 0.9907 (0.9708) acc_u 0.0000 (3.7500) lr 1.9178e-03 eta 0:00:10
epoch [28/200] batch [10/36] time 0.329 (0.340) data 0.251 (0.262) loss_u loss_u 0.9893 (0.9644) acc_u 0.0000 (4.0625) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [15/36] time 0.338 (0.339) data 0.261 (0.262) loss_u loss_u 0.9370 (0.9517) acc_u 6.2500 (5.8333) lr 1.9178e-03 eta 0:00:07
epoch [28/200] batch [20/36] time 0.332 (0.339) data 0.254 (0.262) loss_u loss_u 0.9741 (0.9501) acc_u 3.1250 (6.2500) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [25/36] time 0.355 (0.340) data 0.277 (0.262) loss_u loss_u 0.9878 (0.9511) acc_u 0.0000 (6.3750) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [30/36] time 0.349 (0.340) data 0.271 (0.262) loss_u loss_u 0.9863 (0.9520) acc_u 0.0000 (6.1458) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [35/36] time 0.332 (0.340) data 0.254 (0.262) loss_u loss_u 0.9634 (0.9495) acc_u 6.2500 (6.3393) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 514
confident_label rate tensor(0.2953, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 482
clean true:454
clean false:28
clean_rate:0.941908713692946
noisy true:664
noisy false:486
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1150
epoch [29/200] batch [5/15] time 0.336 (0.309) data 0.258 (0.231) loss_x loss_x 0.4858 (0.5871) acc_x 90.6250 (81.8750) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/15] time 0.326 (0.319) data 0.248 (0.241) loss_x loss_x 0.7764 (0.6032) acc_x 75.0000 (83.4375) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/15] time 0.335 (0.325) data 0.256 (0.247) loss_x loss_x 0.5132 (0.6132) acc_x 87.5000 (83.9583) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/35] time 0.345 (0.326) data 0.267 (0.249) loss_u loss_u 0.9570 (0.9451) acc_u 6.2500 (7.5000) lr 1.9114e-03 eta 0:00:09
epoch [29/200] batch [10/35] time 0.345 (0.329) data 0.268 (0.252) loss_u loss_u 0.9834 (0.9427) acc_u 3.1250 (7.1875) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [15/35] time 0.341 (0.330) data 0.263 (0.253) loss_u loss_u 0.9150 (0.9422) acc_u 12.5000 (7.2917) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [20/35] time 0.348 (0.332) data 0.270 (0.255) loss_u loss_u 0.9224 (0.9429) acc_u 9.3750 (7.5000) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [25/35] time 0.340 (0.333) data 0.262 (0.255) loss_u loss_u 0.9102 (0.9395) acc_u 9.3750 (8.0000) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [30/35] time 0.359 (0.333) data 0.282 (0.256) loss_u loss_u 0.9717 (0.9429) acc_u 3.1250 (7.3958) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [35/35] time 0.333 (0.334) data 0.255 (0.256) loss_u loss_u 0.9634 (0.9448) acc_u 3.1250 (6.9643) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 516
confident_label rate tensor(0.3015, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 492
clean true:451
clean false:41
clean_rate:0.9166666666666666
noisy true:665
noisy false:475
after delete: len(clean_dataset) 492
after delete: len(noisy_dataset) 1140
epoch [30/200] batch [5/15] time 0.346 (0.328) data 0.269 (0.250) loss_x loss_x 0.8457 (0.7211) acc_x 93.7500 (88.7500) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/15] time 0.340 (0.336) data 0.263 (0.258) loss_x loss_x 0.3975 (0.6707) acc_x 87.5000 (86.8750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/15] time 0.362 (0.338) data 0.285 (0.261) loss_x loss_x 0.3972 (0.7182) acc_x 90.6250 (85.8333) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/35] time 0.339 (0.337) data 0.261 (0.259) loss_u loss_u 0.9741 (0.9599) acc_u 6.2500 (6.2500) lr 1.9048e-03 eta 0:00:10
epoch [30/200] batch [10/35] time 0.330 (0.336) data 0.252 (0.258) loss_u loss_u 0.9214 (0.9537) acc_u 9.3750 (6.8750) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [15/35] time 0.325 (0.334) data 0.247 (0.257) loss_u loss_u 0.9927 (0.9558) acc_u 0.0000 (6.6667) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [20/35] time 0.355 (0.335) data 0.277 (0.257) loss_u loss_u 0.9604 (0.9573) acc_u 6.2500 (6.4062) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [25/35] time 0.335 (0.335) data 0.257 (0.257) loss_u loss_u 0.9321 (0.9555) acc_u 6.2500 (6.3750) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [30/35] time 0.329 (0.335) data 0.251 (0.257) loss_u loss_u 0.9673 (0.9549) acc_u 3.1250 (6.1458) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [35/35] time 0.340 (0.335) data 0.262 (0.257) loss_u loss_u 0.9526 (0.9530) acc_u 3.1250 (6.2500) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 505
confident_label rate tensor(0.3051, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 498
clean true:465
clean false:33
clean_rate:0.9337349397590361
noisy true:662
noisy false:472
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1134
epoch [31/200] batch [5/15] time 0.299 (0.317) data 0.222 (0.239) loss_x loss_x 0.6084 (0.6102) acc_x 87.5000 (84.3750) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/15] time 0.339 (0.322) data 0.262 (0.244) loss_x loss_x 0.7261 (0.6482) acc_x 81.2500 (84.6875) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/15] time 0.360 (0.328) data 0.283 (0.251) loss_x loss_x 0.8594 (0.6490) acc_x 81.2500 (84.7917) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/35] time 0.336 (0.331) data 0.258 (0.253) loss_u loss_u 0.8525 (0.9271) acc_u 18.7500 (8.7500) lr 1.8980e-03 eta 0:00:09
epoch [31/200] batch [10/35] time 0.349 (0.332) data 0.271 (0.254) loss_u loss_u 0.9614 (0.9407) acc_u 6.2500 (7.5000) lr 1.8980e-03 eta 0:00:08
epoch [31/200] batch [15/35] time 0.332 (0.333) data 0.254 (0.255) loss_u loss_u 0.9370 (0.9465) acc_u 6.2500 (6.4583) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [20/35] time 0.383 (0.335) data 0.306 (0.258) loss_u loss_u 0.8672 (0.9415) acc_u 15.6250 (7.1875) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [25/35] time 0.340 (0.336) data 0.261 (0.258) loss_u loss_u 0.9253 (0.9424) acc_u 9.3750 (7.1250) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [30/35] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.9146 (0.9433) acc_u 15.6250 (7.3958) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [35/35] time 0.338 (0.337) data 0.259 (0.259) loss_u loss_u 0.9590 (0.9443) acc_u 3.1250 (7.1429) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 489
confident_label rate tensor(0.2972, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 485
clean true:449
clean false:36
clean_rate:0.9257731958762887
noisy true:694
noisy false:453
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1147
epoch [32/200] batch [5/15] time 0.351 (0.351) data 0.273 (0.273) loss_x loss_x 0.5396 (0.5034) acc_x 84.3750 (86.8750) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/15] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.8936 (0.5688) acc_x 75.0000 (85.9375) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/15] time 0.332 (0.345) data 0.255 (0.268) loss_x loss_x 0.6953 (0.5642) acc_x 84.3750 (86.2500) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/35] time 0.335 (0.343) data 0.257 (0.266) loss_u loss_u 0.9287 (0.9299) acc_u 6.2500 (7.5000) lr 1.8910e-03 eta 0:00:10
epoch [32/200] batch [10/35] time 0.332 (0.342) data 0.254 (0.264) loss_u loss_u 0.9414 (0.9325) acc_u 6.2500 (7.5000) lr 1.8910e-03 eta 0:00:08
epoch [32/200] batch [15/35] time 0.341 (0.341) data 0.263 (0.264) loss_u loss_u 0.9453 (0.9352) acc_u 6.2500 (7.5000) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [20/35] time 0.322 (0.340) data 0.244 (0.263) loss_u loss_u 0.9746 (0.9340) acc_u 3.1250 (8.1250) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [25/35] time 0.337 (0.340) data 0.260 (0.262) loss_u loss_u 0.9512 (0.9340) acc_u 3.1250 (8.0000) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [30/35] time 0.337 (0.340) data 0.259 (0.262) loss_u loss_u 0.9229 (0.9373) acc_u 9.3750 (7.7083) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [35/35] time 0.324 (0.339) data 0.247 (0.262) loss_u loss_u 0.9336 (0.9406) acc_u 9.3750 (7.2321) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 503
confident_label rate tensor(0.3076, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 502
clean true:462
clean false:40
clean_rate:0.9203187250996016
noisy true:667
noisy false:463
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1130
epoch [33/200] batch [5/15] time 0.346 (0.352) data 0.269 (0.275) loss_x loss_x 0.6978 (0.5296) acc_x 93.7500 (89.3750) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/15] time 0.341 (0.348) data 0.263 (0.271) loss_x loss_x 0.4766 (0.5177) acc_x 84.3750 (86.8750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/15] time 0.341 (0.344) data 0.263 (0.267) loss_x loss_x 0.3799 (0.5226) acc_x 90.6250 (87.0833) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/35] time 0.334 (0.342) data 0.256 (0.265) loss_u loss_u 0.9473 (0.9461) acc_u 6.2500 (6.8750) lr 1.8838e-03 eta 0:00:10
epoch [33/200] batch [10/35] time 0.347 (0.341) data 0.269 (0.263) loss_u loss_u 0.9385 (0.9578) acc_u 9.3750 (5.6250) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [15/35] time 0.355 (0.342) data 0.277 (0.264) loss_u loss_u 0.9326 (0.9466) acc_u 9.3750 (6.4583) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [20/35] time 0.345 (0.342) data 0.267 (0.264) loss_u loss_u 0.9092 (0.9439) acc_u 9.3750 (6.8750) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [25/35] time 0.325 (0.342) data 0.247 (0.264) loss_u loss_u 0.9976 (0.9452) acc_u 0.0000 (6.8750) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [30/35] time 0.307 (0.338) data 0.228 (0.260) loss_u loss_u 0.9717 (0.9434) acc_u 3.1250 (6.9792) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [35/35] time 0.354 (0.337) data 0.275 (0.259) loss_u loss_u 0.9526 (0.9471) acc_u 6.2500 (6.4286) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 525
confident_label rate tensor(0.3070, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 501
clean true:453
clean false:48
clean_rate:0.9041916167664671
noisy true:654
noisy false:477
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1131
epoch [34/200] batch [5/15] time 0.352 (0.346) data 0.275 (0.268) loss_x loss_x 0.6460 (0.4893) acc_x 84.3750 (88.1250) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/15] time 0.332 (0.344) data 0.254 (0.266) loss_x loss_x 0.9736 (0.5629) acc_x 75.0000 (84.3750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/15] time 0.353 (0.344) data 0.276 (0.266) loss_x loss_x 0.3699 (0.5625) acc_x 87.5000 (84.5833) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/35] time 0.331 (0.343) data 0.253 (0.265) loss_u loss_u 0.9575 (0.9440) acc_u 6.2500 (6.8750) lr 1.8763e-03 eta 0:00:10
epoch [34/200] batch [10/35] time 0.338 (0.340) data 0.261 (0.262) loss_u loss_u 0.8726 (0.9435) acc_u 18.7500 (6.8750) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [15/35] time 0.341 (0.340) data 0.263 (0.262) loss_u loss_u 0.9678 (0.9437) acc_u 6.2500 (6.8750) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [20/35] time 0.328 (0.340) data 0.250 (0.263) loss_u loss_u 0.9580 (0.9441) acc_u 3.1250 (6.5625) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [25/35] time 0.327 (0.339) data 0.249 (0.261) loss_u loss_u 0.9927 (0.9477) acc_u 0.0000 (6.0000) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [30/35] time 0.333 (0.336) data 0.255 (0.258) loss_u loss_u 0.9585 (0.9483) acc_u 6.2500 (6.1458) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [35/35] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9062 (0.9461) acc_u 12.5000 (6.6071) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 493
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 508
clean true:465
clean false:43
clean_rate:0.9153543307086615
noisy true:674
noisy false:450
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1124
epoch [35/200] batch [5/15] time 0.352 (0.351) data 0.274 (0.274) loss_x loss_x 0.7100 (0.5583) acc_x 84.3750 (86.8750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/15] time 0.340 (0.346) data 0.263 (0.268) loss_x loss_x 0.8242 (0.6443) acc_x 87.5000 (85.9375) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/15] time 0.330 (0.342) data 0.253 (0.265) loss_x loss_x 0.4976 (0.6138) acc_x 87.5000 (86.4583) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/35] time 0.330 (0.341) data 0.252 (0.264) loss_u loss_u 0.8950 (0.9349) acc_u 15.6250 (8.1250) lr 1.8686e-03 eta 0:00:10
epoch [35/200] batch [10/35] time 0.338 (0.340) data 0.260 (0.262) loss_u loss_u 0.9575 (0.9407) acc_u 3.1250 (7.1875) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [15/35] time 0.336 (0.340) data 0.258 (0.262) loss_u loss_u 0.9634 (0.9415) acc_u 3.1250 (6.8750) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [20/35] time 0.349 (0.339) data 0.269 (0.261) loss_u loss_u 0.9385 (0.9455) acc_u 6.2500 (6.2500) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [25/35] time 0.303 (0.338) data 0.224 (0.260) loss_u loss_u 0.8867 (0.9434) acc_u 15.6250 (6.8750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [30/35] time 0.339 (0.337) data 0.261 (0.259) loss_u loss_u 0.9473 (0.9431) acc_u 9.3750 (7.0833) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [35/35] time 0.347 (0.337) data 0.269 (0.260) loss_u loss_u 0.9478 (0.9440) acc_u 6.2500 (6.8750) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 516
confident_label rate tensor(0.3082, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 503
clean true:461
clean false:42
clean_rate:0.9165009940357853
noisy true:655
noisy false:474
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1129
epoch [36/200] batch [5/15] time 0.347 (0.350) data 0.270 (0.273) loss_x loss_x 0.5459 (0.6515) acc_x 81.2500 (85.6250) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/15] time 0.348 (0.348) data 0.271 (0.271) loss_x loss_x 0.4258 (0.5582) acc_x 93.7500 (88.4375) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/15] time 0.337 (0.349) data 0.260 (0.271) loss_x loss_x 0.5322 (0.5711) acc_x 81.2500 (86.6667) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/35] time 0.336 (0.345) data 0.257 (0.267) loss_u loss_u 0.9385 (0.9551) acc_u 6.2500 (5.0000) lr 1.8607e-03 eta 0:00:10
epoch [36/200] batch [10/35] time 0.343 (0.345) data 0.266 (0.268) loss_u loss_u 0.9985 (0.9454) acc_u 0.0000 (5.9375) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [15/35] time 0.348 (0.346) data 0.270 (0.268) loss_u loss_u 0.9819 (0.9470) acc_u 3.1250 (5.8333) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [20/35] time 0.321 (0.342) data 0.243 (0.264) loss_u loss_u 0.9204 (0.9465) acc_u 12.5000 (6.0938) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [25/35] time 0.344 (0.340) data 0.265 (0.262) loss_u loss_u 0.9639 (0.9440) acc_u 3.1250 (6.3750) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [30/35] time 0.337 (0.341) data 0.259 (0.263) loss_u loss_u 0.8271 (0.9399) acc_u 21.8750 (7.0833) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [35/35] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.9756 (0.9379) acc_u 3.1250 (7.1429) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 492
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 522
clean true:471
clean false:51
clean_rate:0.9022988505747126
noisy true:669
noisy false:441
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1110
epoch [37/200] batch [5/16] time 0.349 (0.353) data 0.272 (0.276) loss_x loss_x 0.4612 (0.6139) acc_x 87.5000 (83.7500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/16] time 0.343 (0.349) data 0.266 (0.272) loss_x loss_x 0.5181 (0.5360) acc_x 90.6250 (87.5000) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/16] time 0.338 (0.348) data 0.261 (0.271) loss_x loss_x 0.6055 (0.5879) acc_x 87.5000 (86.4583) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/34] time 0.340 (0.346) data 0.263 (0.268) loss_u loss_u 0.9673 (0.9475) acc_u 3.1250 (6.8750) lr 1.8526e-03 eta 0:00:10
epoch [37/200] batch [10/34] time 0.352 (0.346) data 0.274 (0.268) loss_u loss_u 0.9980 (0.9562) acc_u 0.0000 (5.9375) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [15/34] time 0.312 (0.344) data 0.233 (0.266) loss_u loss_u 0.9189 (0.9517) acc_u 12.5000 (6.8750) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [20/34] time 0.353 (0.342) data 0.275 (0.265) loss_u loss_u 0.9956 (0.9503) acc_u 0.0000 (6.7188) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [25/34] time 0.347 (0.343) data 0.270 (0.265) loss_u loss_u 0.9756 (0.9538) acc_u 3.1250 (6.2500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [30/34] time 0.346 (0.343) data 0.268 (0.266) loss_u loss_u 0.9443 (0.9466) acc_u 6.2500 (6.9792) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 491
confident_label rate tensor(0.3033, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 495
clean true:450
clean false:45
clean_rate:0.9090909090909091
noisy true:691
noisy false:446
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1137
epoch [38/200] batch [5/15] time 0.339 (0.342) data 0.261 (0.265) loss_x loss_x 0.2656 (0.4711) acc_x 100.0000 (87.5000) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/15] time 0.348 (0.340) data 0.271 (0.263) loss_x loss_x 0.4553 (0.5242) acc_x 84.3750 (86.5625) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/15] time 0.343 (0.342) data 0.266 (0.265) loss_x loss_x 0.5659 (0.5335) acc_x 84.3750 (87.0833) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/35] time 0.328 (0.339) data 0.251 (0.262) loss_u loss_u 0.8916 (0.8949) acc_u 15.6250 (14.3750) lr 1.8443e-03 eta 0:00:10
epoch [38/200] batch [10/35] time 0.341 (0.339) data 0.262 (0.261) loss_u loss_u 0.9707 (0.9208) acc_u 3.1250 (10.9375) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [15/35] time 0.332 (0.340) data 0.254 (0.262) loss_u loss_u 0.9277 (0.9254) acc_u 9.3750 (10.4167) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [20/35] time 0.326 (0.340) data 0.248 (0.262) loss_u loss_u 0.9922 (0.9258) acc_u 0.0000 (10.0000) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [25/35] time 0.349 (0.339) data 0.271 (0.261) loss_u loss_u 0.9497 (0.9293) acc_u 6.2500 (9.2500) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [30/35] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9316 (0.9271) acc_u 6.2500 (9.8958) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [35/35] time 0.336 (0.341) data 0.258 (0.263) loss_u loss_u 0.9775 (0.9303) acc_u 3.1250 (9.4643) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 456
confident_label rate tensor(0.3174, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 518
clean true:480
clean false:38
clean_rate:0.9266409266409267
noisy true:696
noisy false:418
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1114
epoch [39/200] batch [5/16] time 0.339 (0.351) data 0.262 (0.273) loss_x loss_x 0.5176 (0.4766) acc_x 81.2500 (88.7500) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/16] time 0.339 (0.342) data 0.262 (0.265) loss_x loss_x 0.3257 (0.4761) acc_x 96.8750 (88.1250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/16] time 0.350 (0.342) data 0.272 (0.264) loss_x loss_x 0.6362 (0.5576) acc_x 84.3750 (85.8333) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/34] time 0.341 (0.342) data 0.263 (0.264) loss_u loss_u 0.9678 (0.9439) acc_u 3.1250 (6.2500) lr 1.8358e-03 eta 0:00:09
epoch [39/200] batch [10/34] time 0.331 (0.340) data 0.254 (0.263) loss_u loss_u 0.9492 (0.9474) acc_u 6.2500 (5.6250) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [15/34] time 0.370 (0.344) data 0.291 (0.266) loss_u loss_u 0.9946 (0.9508) acc_u 0.0000 (5.4167) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [20/34] time 0.352 (0.344) data 0.274 (0.266) loss_u loss_u 0.9443 (0.9513) acc_u 6.2500 (5.4688) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [25/34] time 0.341 (0.343) data 0.263 (0.265) loss_u loss_u 0.9404 (0.9487) acc_u 6.2500 (5.8750) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [30/34] time 0.318 (0.342) data 0.238 (0.264) loss_u loss_u 0.9658 (0.9499) acc_u 3.1250 (5.6250) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 512
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 511
clean true:467
clean false:44
clean_rate:0.913894324853229
noisy true:653
noisy false:468
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1121
epoch [40/200] batch [5/15] time 0.338 (0.340) data 0.261 (0.262) loss_x loss_x 0.5698 (0.6060) acc_x 90.6250 (89.3750) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/15] time 0.323 (0.339) data 0.245 (0.262) loss_x loss_x 0.5825 (0.6472) acc_x 87.5000 (85.3125) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/15] time 0.324 (0.338) data 0.247 (0.261) loss_x loss_x 0.7334 (0.6190) acc_x 78.1250 (85.8333) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/35] time 0.343 (0.338) data 0.265 (0.260) loss_u loss_u 0.9043 (0.9249) acc_u 9.3750 (8.1250) lr 1.8271e-03 eta 0:00:10
epoch [40/200] batch [10/35] time 0.383 (0.348) data 0.303 (0.270) loss_u loss_u 0.9258 (0.9314) acc_u 9.3750 (8.1250) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [15/35] time 0.345 (0.348) data 0.267 (0.270) loss_u loss_u 0.9204 (0.9374) acc_u 9.3750 (7.2917) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [20/35] time 0.358 (0.348) data 0.279 (0.270) loss_u loss_u 0.9360 (0.9387) acc_u 6.2500 (7.3438) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [25/35] time 0.364 (0.348) data 0.286 (0.271) loss_u loss_u 0.9263 (0.9391) acc_u 9.3750 (7.3750) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [30/35] time 0.307 (0.345) data 0.228 (0.267) loss_u loss_u 0.8887 (0.9369) acc_u 12.5000 (7.6042) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [35/35] time 0.349 (0.346) data 0.270 (0.268) loss_u loss_u 0.9834 (0.9355) acc_u 3.1250 (7.8571) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 482
confident_label rate tensor(0.3290, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 537
clean true:480
clean false:57
clean_rate:0.8938547486033519
noisy true:670
noisy false:425
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1095
epoch [41/200] batch [5/16] time 0.349 (0.363) data 0.271 (0.285) loss_x loss_x 0.8589 (0.6556) acc_x 84.3750 (87.5000) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/16] time 0.347 (0.349) data 0.270 (0.271) loss_x loss_x 0.3354 (0.5587) acc_x 93.7500 (88.7500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/16] time 0.338 (0.349) data 0.261 (0.271) loss_x loss_x 0.4927 (0.5420) acc_x 93.7500 (88.3333) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/34] time 0.348 (0.339) data 0.269 (0.261) loss_u loss_u 0.9497 (0.9275) acc_u 9.3750 (8.7500) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [10/34] time 0.362 (0.341) data 0.284 (0.263) loss_u loss_u 0.9722 (0.9393) acc_u 3.1250 (6.8750) lr 1.8181e-03 eta 0:00:08
epoch [41/200] batch [15/34] time 0.352 (0.341) data 0.273 (0.263) loss_u loss_u 0.9072 (0.9403) acc_u 12.5000 (7.0833) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [20/34] time 0.343 (0.341) data 0.265 (0.263) loss_u loss_u 0.9072 (0.9402) acc_u 12.5000 (7.3438) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [25/34] time 0.300 (0.339) data 0.222 (0.261) loss_u loss_u 0.9331 (0.9437) acc_u 9.3750 (6.8750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [30/34] time 0.352 (0.337) data 0.273 (0.259) loss_u loss_u 0.9609 (0.9437) acc_u 6.2500 (6.8750) lr 1.8181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 487
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 516
clean true:465
clean false:51
clean_rate:0.9011627906976745
noisy true:680
noisy false:436
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1116
epoch [42/200] batch [5/16] time 0.343 (0.343) data 0.265 (0.265) loss_x loss_x 0.3850 (0.5217) acc_x 93.7500 (88.1250) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/16] time 0.335 (0.341) data 0.258 (0.263) loss_x loss_x 0.5596 (0.5012) acc_x 90.6250 (89.0625) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/16] time 0.319 (0.336) data 0.241 (0.258) loss_x loss_x 0.4153 (0.5703) acc_x 93.7500 (87.7083) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/34] time 0.342 (0.329) data 0.264 (0.251) loss_u loss_u 0.9668 (0.9646) acc_u 3.1250 (4.3750) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [10/34] time 0.347 (0.332) data 0.269 (0.254) loss_u loss_u 0.9883 (0.9340) acc_u 0.0000 (8.7500) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [15/34] time 0.336 (0.333) data 0.258 (0.255) loss_u loss_u 0.9976 (0.9325) acc_u 0.0000 (9.1667) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [20/34] time 0.349 (0.335) data 0.271 (0.257) loss_u loss_u 0.9414 (0.9365) acc_u 6.2500 (8.4375) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [25/34] time 0.341 (0.337) data 0.263 (0.259) loss_u loss_u 0.9976 (0.9373) acc_u 0.0000 (8.1250) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [30/34] time 0.340 (0.338) data 0.261 (0.260) loss_u loss_u 0.9795 (0.9422) acc_u 3.1250 (7.7083) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 461
confident_label rate tensor(0.3297, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 538
clean true:475
clean false:63
clean_rate:0.8828996282527881
noisy true:696
noisy false:398
after delete: len(clean_dataset) 538
after delete: len(noisy_dataset) 1094
epoch [43/200] batch [5/16] time 0.357 (0.354) data 0.280 (0.277) loss_x loss_x 0.3015 (0.4503) acc_x 90.6250 (90.0000) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/16] time 0.353 (0.350) data 0.276 (0.272) loss_x loss_x 0.3049 (0.4190) acc_x 90.6250 (90.3125) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/16] time 0.299 (0.344) data 0.221 (0.266) loss_x loss_x 0.6396 (0.4941) acc_x 78.1250 (88.1250) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/34] time 0.335 (0.342) data 0.257 (0.264) loss_u loss_u 0.9951 (0.9308) acc_u 0.0000 (8.7500) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [10/34] time 0.361 (0.345) data 0.282 (0.267) loss_u loss_u 0.9331 (0.9364) acc_u 9.3750 (8.1250) lr 1.7997e-03 eta 0:00:08
epoch [43/200] batch [15/34] time 0.361 (0.346) data 0.283 (0.268) loss_u loss_u 0.9580 (0.9410) acc_u 3.1250 (7.0833) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [20/34] time 0.337 (0.346) data 0.259 (0.268) loss_u loss_u 0.9902 (0.9366) acc_u 0.0000 (7.6562) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [25/34] time 0.355 (0.346) data 0.278 (0.268) loss_u loss_u 0.9233 (0.9407) acc_u 9.3750 (7.0000) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [30/34] time 0.340 (0.346) data 0.263 (0.268) loss_u loss_u 0.9443 (0.9439) acc_u 6.2500 (6.6667) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 454
confident_label rate tensor(0.3315, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 541
clean true:485
clean false:56
clean_rate:0.8964879852125693
noisy true:693
noisy false:398
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1091
epoch [44/200] batch [5/16] time 0.337 (0.349) data 0.260 (0.272) loss_x loss_x 0.6802 (0.5374) acc_x 75.0000 (85.6250) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/16] time 0.300 (0.338) data 0.222 (0.261) loss_x loss_x 0.3564 (0.5350) acc_x 90.6250 (86.5625) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/16] time 0.334 (0.330) data 0.256 (0.252) loss_x loss_x 0.6670 (0.5540) acc_x 84.3750 (86.2500) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/34] time 0.353 (0.335) data 0.275 (0.257) loss_u loss_u 0.9404 (0.9403) acc_u 6.2500 (6.8750) lr 1.7902e-03 eta 0:00:09
epoch [44/200] batch [10/34] time 0.335 (0.337) data 0.258 (0.259) loss_u loss_u 0.8872 (0.9432) acc_u 15.6250 (6.8750) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [15/34] time 0.334 (0.338) data 0.256 (0.260) loss_u loss_u 0.9814 (0.9431) acc_u 3.1250 (6.6667) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [20/34] time 0.341 (0.339) data 0.264 (0.261) loss_u loss_u 0.9194 (0.9455) acc_u 6.2500 (6.2500) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [25/34] time 0.341 (0.340) data 0.263 (0.262) loss_u loss_u 0.8467 (0.9421) acc_u 18.7500 (6.7500) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [30/34] time 0.350 (0.341) data 0.272 (0.263) loss_u loss_u 0.9312 (0.9454) acc_u 9.3750 (6.4583) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 511
confident_label rate tensor(0.3211, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 524
clean true:465
clean false:59
clean_rate:0.8874045801526718
noisy true:656
noisy false:452
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1108
epoch [45/200] batch [5/16] time 0.339 (0.340) data 0.262 (0.263) loss_x loss_x 0.4575 (0.6687) acc_x 84.3750 (82.5000) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/16] time 0.318 (0.337) data 0.240 (0.260) loss_x loss_x 0.3718 (0.6324) acc_x 84.3750 (83.7500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/16] time 0.345 (0.337) data 0.268 (0.259) loss_x loss_x 0.4136 (0.5637) acc_x 84.3750 (84.7917) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/34] time 0.354 (0.341) data 0.276 (0.263) loss_u loss_u 0.9580 (0.9481) acc_u 6.2500 (5.6250) lr 1.7804e-03 eta 0:00:09
epoch [45/200] batch [10/34] time 0.341 (0.342) data 0.263 (0.264) loss_u loss_u 0.9976 (0.9479) acc_u 0.0000 (5.6250) lr 1.7804e-03 eta 0:00:08
epoch [45/200] batch [15/34] time 0.353 (0.343) data 0.275 (0.265) loss_u loss_u 0.9521 (0.9522) acc_u 6.2500 (5.4167) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [20/34] time 0.359 (0.344) data 0.281 (0.267) loss_u loss_u 0.9409 (0.9458) acc_u 6.2500 (6.4062) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [25/34] time 0.347 (0.344) data 0.269 (0.266) loss_u loss_u 0.8477 (0.9414) acc_u 18.7500 (7.1250) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [30/34] time 0.345 (0.345) data 0.268 (0.267) loss_u loss_u 0.9604 (0.9359) acc_u 6.2500 (7.7083) lr 1.7804e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 451
confident_label rate tensor(0.3370, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 550
clean true:488
clean false:62
clean_rate:0.8872727272727273
noisy true:693
noisy false:389
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1082
epoch [46/200] batch [5/17] time 0.354 (0.340) data 0.275 (0.263) loss_x loss_x 0.7900 (0.5518) acc_x 75.0000 (85.0000) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [10/17] time 0.340 (0.341) data 0.263 (0.263) loss_x loss_x 0.3813 (0.5020) acc_x 93.7500 (86.8750) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/17] time 0.349 (0.342) data 0.271 (0.265) loss_x loss_x 0.4866 (0.5402) acc_x 84.3750 (86.4583) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/33] time 0.346 (0.342) data 0.267 (0.264) loss_u loss_u 0.9634 (0.9538) acc_u 3.1250 (5.0000) lr 1.7705e-03 eta 0:00:09
epoch [46/200] batch [10/33] time 0.356 (0.343) data 0.279 (0.265) loss_u loss_u 0.9399 (0.9505) acc_u 9.3750 (6.2500) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [15/33] time 0.358 (0.343) data 0.280 (0.265) loss_u loss_u 0.9819 (0.9495) acc_u 3.1250 (6.6667) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [20/33] time 0.370 (0.344) data 0.292 (0.266) loss_u loss_u 0.9722 (0.9496) acc_u 3.1250 (6.5625) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [25/33] time 0.351 (0.345) data 0.273 (0.267) loss_u loss_u 0.9229 (0.9473) acc_u 12.5000 (6.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/33] time 0.356 (0.345) data 0.279 (0.267) loss_u loss_u 0.9116 (0.9488) acc_u 9.3750 (6.4583) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 469
confident_label rate tensor(0.3309, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 540
clean true:481
clean false:59
clean_rate:0.8907407407407407
noisy true:682
noisy false:410
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 1092
epoch [47/200] batch [5/16] time 0.355 (0.338) data 0.278 (0.260) loss_x loss_x 0.3708 (0.6312) acc_x 90.6250 (86.2500) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/16] time 0.354 (0.343) data 0.277 (0.265) loss_x loss_x 0.3149 (0.4974) acc_x 93.7500 (88.7500) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/16] time 0.340 (0.342) data 0.263 (0.265) loss_x loss_x 0.6084 (0.4926) acc_x 90.6250 (89.3750) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/34] time 0.356 (0.343) data 0.278 (0.266) loss_u loss_u 0.9028 (0.9527) acc_u 9.3750 (5.6250) lr 1.7604e-03 eta 0:00:09
epoch [47/200] batch [10/34] time 0.336 (0.343) data 0.258 (0.266) loss_u loss_u 0.9795 (0.9643) acc_u 0.0000 (3.7500) lr 1.7604e-03 eta 0:00:08
epoch [47/200] batch [15/34] time 0.346 (0.344) data 0.269 (0.267) loss_u loss_u 0.9185 (0.9459) acc_u 9.3750 (6.2500) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [20/34] time 0.336 (0.345) data 0.257 (0.267) loss_u loss_u 0.9468 (0.9443) acc_u 6.2500 (6.2500) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [25/34] time 0.330 (0.344) data 0.252 (0.266) loss_u loss_u 0.8721 (0.9417) acc_u 15.6250 (6.7500) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [30/34] time 0.335 (0.343) data 0.257 (0.266) loss_u loss_u 0.9795 (0.9424) acc_u 3.1250 (6.9792) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 449
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 549
clean true:491
clean false:58
clean_rate:0.8943533697632058
noisy true:692
noisy false:391
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1083
epoch [48/200] batch [5/17] time 0.341 (0.327) data 0.263 (0.250) loss_x loss_x 0.4143 (0.4850) acc_x 87.5000 (85.0000) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/17] time 0.345 (0.331) data 0.267 (0.253) loss_x loss_x 0.2311 (0.4858) acc_x 93.7500 (86.2500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/17] time 0.345 (0.338) data 0.268 (0.260) loss_x loss_x 0.1398 (0.4225) acc_x 96.8750 (89.1667) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/33] time 0.328 (0.338) data 0.250 (0.260) loss_u loss_u 0.9102 (0.9202) acc_u 12.5000 (11.8750) lr 1.7501e-03 eta 0:00:09
epoch [48/200] batch [10/33] time 0.326 (0.337) data 0.248 (0.259) loss_u loss_u 0.9961 (0.9433) acc_u 0.0000 (7.5000) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [15/33] time 0.342 (0.338) data 0.264 (0.260) loss_u loss_u 0.8979 (0.9394) acc_u 12.5000 (7.7083) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [20/33] time 0.329 (0.337) data 0.251 (0.260) loss_u loss_u 0.9668 (0.9412) acc_u 3.1250 (7.8125) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [25/33] time 0.346 (0.337) data 0.268 (0.260) loss_u loss_u 0.9727 (0.9442) acc_u 3.1250 (7.2500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [30/33] time 0.343 (0.338) data 0.265 (0.261) loss_u loss_u 0.9756 (0.9412) acc_u 3.1250 (7.8125) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 470
confident_label rate tensor(0.3346, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 546
clean true:479
clean false:67
clean_rate:0.8772893772893773
noisy true:683
noisy false:403
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 1086
epoch [49/200] batch [5/17] time 0.343 (0.345) data 0.264 (0.267) loss_x loss_x 0.4373 (0.5022) acc_x 87.5000 (85.6250) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [10/17] time 0.351 (0.347) data 0.274 (0.269) loss_x loss_x 0.3630 (0.4555) acc_x 87.5000 (86.8750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/17] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.6865 (0.4936) acc_x 84.3750 (86.6667) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/33] time 0.341 (0.346) data 0.262 (0.268) loss_u loss_u 0.9512 (0.9415) acc_u 6.2500 (6.8750) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [10/33] time 0.344 (0.345) data 0.266 (0.267) loss_u loss_u 0.9741 (0.9446) acc_u 3.1250 (6.8750) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [15/33] time 0.330 (0.344) data 0.252 (0.266) loss_u loss_u 0.9331 (0.9458) acc_u 12.5000 (7.0833) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [20/33] time 0.350 (0.345) data 0.273 (0.267) loss_u loss_u 0.9946 (0.9442) acc_u 0.0000 (6.8750) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [25/33] time 0.342 (0.345) data 0.265 (0.267) loss_u loss_u 0.9810 (0.9470) acc_u 3.1250 (6.5000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [30/33] time 0.307 (0.345) data 0.227 (0.267) loss_u loss_u 0.8481 (0.9440) acc_u 21.8750 (6.9792) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 479
confident_label rate tensor(0.3278, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 535
clean true:472
clean false:63
clean_rate:0.8822429906542056
noisy true:681
noisy false:416
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1097
epoch [50/200] batch [5/16] time 0.360 (0.351) data 0.282 (0.273) loss_x loss_x 0.6362 (0.6184) acc_x 87.5000 (85.6250) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/16] time 0.332 (0.346) data 0.254 (0.269) loss_x loss_x 0.7290 (0.6144) acc_x 84.3750 (85.3125) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/16] time 0.350 (0.345) data 0.273 (0.268) loss_x loss_x 0.5879 (0.6070) acc_x 78.1250 (84.7917) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/34] time 0.344 (0.345) data 0.265 (0.267) loss_u loss_u 0.9067 (0.9356) acc_u 9.3750 (6.8750) lr 1.7290e-03 eta 0:00:09
epoch [50/200] batch [10/34] time 0.344 (0.344) data 0.266 (0.267) loss_u loss_u 0.9463 (0.9394) acc_u 6.2500 (6.8750) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [15/34] time 0.348 (0.344) data 0.270 (0.266) loss_u loss_u 0.9399 (0.9295) acc_u 6.2500 (8.3333) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [20/34] time 0.334 (0.344) data 0.256 (0.266) loss_u loss_u 0.9248 (0.9275) acc_u 9.3750 (8.5938) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [25/34] time 0.311 (0.339) data 0.233 (0.262) loss_u loss_u 0.9053 (0.9282) acc_u 12.5000 (8.5000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [30/34] time 0.358 (0.338) data 0.280 (0.260) loss_u loss_u 0.8823 (0.9310) acc_u 15.6250 (8.2292) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 458
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 549
clean true:485
clean false:64
clean_rate:0.8834244080145719
noisy true:689
noisy false:394
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1083
epoch [51/200] batch [5/17] time 0.347 (0.351) data 0.269 (0.274) loss_x loss_x 0.3267 (0.4436) acc_x 90.6250 (89.3750) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/17] time 0.350 (0.353) data 0.272 (0.275) loss_x loss_x 0.4526 (0.4366) acc_x 84.3750 (89.6875) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/17] time 0.326 (0.349) data 0.249 (0.272) loss_x loss_x 0.6670 (0.4908) acc_x 93.7500 (88.1250) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/33] time 0.348 (0.348) data 0.270 (0.270) loss_u loss_u 0.9316 (0.9371) acc_u 9.3750 (7.5000) lr 1.7181e-03 eta 0:00:09
epoch [51/200] batch [10/33] time 0.347 (0.348) data 0.269 (0.270) loss_u loss_u 0.9697 (0.9397) acc_u 3.1250 (7.5000) lr 1.7181e-03 eta 0:00:07
epoch [51/200] batch [15/33] time 0.344 (0.347) data 0.266 (0.269) loss_u loss_u 0.9204 (0.9296) acc_u 9.3750 (8.5417) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [20/33] time 0.330 (0.346) data 0.252 (0.269) loss_u loss_u 0.9751 (0.9305) acc_u 3.1250 (8.5938) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [25/33] time 0.331 (0.346) data 0.253 (0.268) loss_u loss_u 0.9663 (0.9297) acc_u 3.1250 (8.6250) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [30/33] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9263 (0.9312) acc_u 12.5000 (8.5417) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 444
confident_label rate tensor(0.3352, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 547
clean true:481
clean false:66
clean_rate:0.8793418647166362
noisy true:707
noisy false:378
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1085
epoch [52/200] batch [5/17] time 0.340 (0.340) data 0.263 (0.263) loss_x loss_x 0.3411 (0.4616) acc_x 90.6250 (88.1250) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/17] time 0.346 (0.338) data 0.269 (0.261) loss_x loss_x 0.5151 (0.4878) acc_x 93.7500 (87.5000) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/17] time 0.330 (0.339) data 0.253 (0.262) loss_x loss_x 0.5713 (0.4995) acc_x 90.6250 (87.7083) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/33] time 0.336 (0.339) data 0.259 (0.261) loss_u loss_u 0.9692 (0.9540) acc_u 3.1250 (5.6250) lr 1.7071e-03 eta 0:00:09
epoch [52/200] batch [10/33] time 0.340 (0.339) data 0.262 (0.261) loss_u loss_u 0.8911 (0.9471) acc_u 15.6250 (6.8750) lr 1.7071e-03 eta 0:00:07
epoch [52/200] batch [15/33] time 0.350 (0.341) data 0.272 (0.263) loss_u loss_u 0.9312 (0.9326) acc_u 6.2500 (8.1250) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [20/33] time 0.354 (0.341) data 0.276 (0.264) loss_u loss_u 0.9443 (0.9387) acc_u 6.2500 (7.1875) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [25/33] time 0.301 (0.338) data 0.222 (0.260) loss_u loss_u 0.8779 (0.9379) acc_u 12.5000 (7.2500) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/33] time 0.344 (0.336) data 0.266 (0.258) loss_u loss_u 0.9688 (0.9372) acc_u 3.1250 (7.3958) lr 1.7071e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 465
confident_label rate tensor(0.3272, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 534
clean true:475
clean false:59
clean_rate:0.8895131086142322
noisy true:692
noisy false:406
after delete: len(clean_dataset) 534
after delete: len(noisy_dataset) 1098
epoch [53/200] batch [5/16] time 0.297 (0.336) data 0.220 (0.258) loss_x loss_x 0.4692 (0.5825) acc_x 90.6250 (85.6250) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [10/16] time 0.342 (0.337) data 0.265 (0.260) loss_x loss_x 0.5112 (0.5334) acc_x 93.7500 (87.1875) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/16] time 0.332 (0.338) data 0.255 (0.260) loss_x loss_x 0.3992 (0.4684) acc_x 87.5000 (88.5417) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/34] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.9175 (0.9263) acc_u 9.3750 (9.3750) lr 1.6959e-03 eta 0:00:09
epoch [53/200] batch [10/34] time 0.336 (0.338) data 0.258 (0.261) loss_u loss_u 0.9570 (0.9405) acc_u 3.1250 (7.1875) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [15/34] time 0.350 (0.341) data 0.272 (0.263) loss_u loss_u 0.9683 (0.9425) acc_u 3.1250 (6.4583) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [20/34] time 0.342 (0.341) data 0.264 (0.263) loss_u loss_u 0.8267 (0.9313) acc_u 21.8750 (7.9688) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [25/34] time 0.338 (0.341) data 0.261 (0.263) loss_u loss_u 0.9053 (0.9351) acc_u 9.3750 (7.5000) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [30/34] time 0.309 (0.340) data 0.229 (0.262) loss_u loss_u 0.9438 (0.9356) acc_u 9.3750 (7.3958) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 452
confident_label rate tensor(0.3370, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 550
clean true:486
clean false:64
clean_rate:0.8836363636363637
noisy true:694
noisy false:388
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1082
epoch [54/200] batch [5/17] time 0.332 (0.344) data 0.255 (0.266) loss_x loss_x 0.7173 (0.4155) acc_x 81.2500 (91.2500) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/17] time 0.330 (0.338) data 0.252 (0.261) loss_x loss_x 0.4055 (0.3798) acc_x 96.8750 (91.5625) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/17] time 0.343 (0.341) data 0.266 (0.263) loss_x loss_x 0.4253 (0.4211) acc_x 93.7500 (90.4167) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/33] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.9453 (0.9320) acc_u 6.2500 (8.1250) lr 1.6845e-03 eta 0:00:09
epoch [54/200] batch [10/33] time 0.360 (0.340) data 0.281 (0.263) loss_u loss_u 0.9424 (0.9299) acc_u 9.3750 (8.4375) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [15/33] time 0.335 (0.341) data 0.257 (0.263) loss_u loss_u 0.9473 (0.9356) acc_u 6.2500 (7.7083) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [20/33] time 0.331 (0.341) data 0.253 (0.263) loss_u loss_u 0.9326 (0.9378) acc_u 6.2500 (7.1875) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [25/33] time 0.303 (0.339) data 0.225 (0.261) loss_u loss_u 0.9727 (0.9390) acc_u 3.1250 (7.1250) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [30/33] time 0.350 (0.336) data 0.271 (0.258) loss_u loss_u 0.9287 (0.9381) acc_u 6.2500 (7.3958) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 462
confident_label rate tensor(0.3278, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 535
clean true:478
clean false:57
clean_rate:0.8934579439252337
noisy true:692
noisy false:405
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1097
epoch [55/200] batch [5/16] time 0.348 (0.354) data 0.271 (0.276) loss_x loss_x 0.3833 (0.5086) acc_x 90.6250 (89.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/16] time 0.378 (0.352) data 0.300 (0.274) loss_x loss_x 0.3113 (0.4388) acc_x 93.7500 (89.3750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/16] time 0.343 (0.349) data 0.265 (0.271) loss_x loss_x 0.1997 (0.4548) acc_x 96.8750 (88.9583) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/34] time 0.365 (0.348) data 0.287 (0.270) loss_u loss_u 0.9897 (0.9416) acc_u 0.0000 (6.2500) lr 1.6730e-03 eta 0:00:10
epoch [55/200] batch [10/34] time 0.350 (0.348) data 0.273 (0.270) loss_u loss_u 0.8848 (0.9376) acc_u 12.5000 (7.1875) lr 1.6730e-03 eta 0:00:08
epoch [55/200] batch [15/34] time 0.339 (0.348) data 0.261 (0.270) loss_u loss_u 0.9194 (0.9360) acc_u 6.2500 (7.7083) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [20/34] time 0.350 (0.348) data 0.272 (0.270) loss_u loss_u 0.9404 (0.9348) acc_u 6.2500 (7.9688) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [25/34] time 0.295 (0.345) data 0.216 (0.267) loss_u loss_u 0.9648 (0.9293) acc_u 0.0000 (8.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [30/34] time 0.303 (0.340) data 0.224 (0.262) loss_u loss_u 0.9458 (0.9320) acc_u 6.2500 (8.0208) lr 1.6730e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 452
confident_label rate tensor(0.3456, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 564
clean true:493
clean false:71
clean_rate:0.874113475177305
noisy true:687
noisy false:381
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1068
epoch [56/200] batch [5/17] time 0.337 (0.346) data 0.259 (0.268) loss_x loss_x 0.3811 (0.4767) acc_x 87.5000 (86.8750) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [10/17] time 0.337 (0.340) data 0.260 (0.263) loss_x loss_x 0.8652 (0.5723) acc_x 84.3750 (85.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/17] time 0.348 (0.342) data 0.270 (0.265) loss_x loss_x 0.4653 (0.5018) acc_x 87.5000 (87.5000) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/33] time 0.332 (0.342) data 0.254 (0.264) loss_u loss_u 0.9961 (0.9382) acc_u 0.0000 (6.8750) lr 1.6613e-03 eta 0:00:09
epoch [56/200] batch [10/33] time 0.321 (0.340) data 0.244 (0.262) loss_u loss_u 0.9463 (0.9438) acc_u 6.2500 (6.5625) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [15/33] time 0.367 (0.341) data 0.288 (0.264) loss_u loss_u 0.9751 (0.9414) acc_u 3.1250 (7.2917) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [20/33] time 0.343 (0.341) data 0.266 (0.264) loss_u loss_u 0.9790 (0.9497) acc_u 3.1250 (6.0938) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [25/33] time 0.325 (0.340) data 0.247 (0.262) loss_u loss_u 0.9707 (0.9491) acc_u 3.1250 (6.3750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/33] time 0.297 (0.336) data 0.218 (0.258) loss_u loss_u 0.9346 (0.9444) acc_u 6.2500 (6.8750) lr 1.6613e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 445
confident_label rate tensor(0.3370, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 550
clean true:486
clean false:64
clean_rate:0.8836363636363637
noisy true:701
noisy false:381
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1082
epoch [57/200] batch [5/17] time 0.340 (0.315) data 0.263 (0.237) loss_x loss_x 0.6743 (0.4558) acc_x 84.3750 (89.3750) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/17] time 0.329 (0.329) data 0.252 (0.252) loss_x loss_x 0.4062 (0.4295) acc_x 90.6250 (90.6250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/17] time 0.352 (0.333) data 0.275 (0.256) loss_x loss_x 0.4495 (0.4493) acc_x 93.7500 (90.2083) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/33] time 0.340 (0.337) data 0.262 (0.260) loss_u loss_u 0.9292 (0.9375) acc_u 9.3750 (6.8750) lr 1.6494e-03 eta 0:00:09
epoch [57/200] batch [10/33] time 0.342 (0.339) data 0.264 (0.261) loss_u loss_u 0.8926 (0.9379) acc_u 12.5000 (6.8750) lr 1.6494e-03 eta 0:00:07
epoch [57/200] batch [15/33] time 0.347 (0.340) data 0.269 (0.262) loss_u loss_u 0.9302 (0.9431) acc_u 6.2500 (6.8750) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [20/33] time 0.335 (0.341) data 0.257 (0.263) loss_u loss_u 0.9785 (0.9385) acc_u 3.1250 (7.5000) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [25/33] time 0.357 (0.341) data 0.280 (0.263) loss_u loss_u 0.9487 (0.9388) acc_u 6.2500 (7.5000) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [30/33] time 0.295 (0.340) data 0.217 (0.262) loss_u loss_u 0.9766 (0.9403) acc_u 3.1250 (7.2917) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 433
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 549
clean true:490
clean false:59
clean_rate:0.8925318761384335
noisy true:709
noisy false:374
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1083
epoch [58/200] batch [5/17] time 0.338 (0.342) data 0.261 (0.264) loss_x loss_x 0.5669 (0.3911) acc_x 84.3750 (91.2500) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/17] time 0.352 (0.343) data 0.275 (0.265) loss_x loss_x 0.3701 (0.4333) acc_x 93.7500 (90.3125) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/17] time 0.333 (0.342) data 0.256 (0.264) loss_x loss_x 0.2764 (0.4186) acc_x 93.7500 (90.4167) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/33] time 0.343 (0.341) data 0.266 (0.264) loss_u loss_u 0.9219 (0.9262) acc_u 9.3750 (8.1250) lr 1.6374e-03 eta 0:00:09
epoch [58/200] batch [10/33] time 0.327 (0.340) data 0.249 (0.262) loss_u loss_u 0.9360 (0.9223) acc_u 6.2500 (9.0625) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [15/33] time 0.332 (0.339) data 0.255 (0.262) loss_u loss_u 0.9546 (0.9302) acc_u 6.2500 (8.5417) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [20/33] time 0.336 (0.340) data 0.258 (0.263) loss_u loss_u 0.9624 (0.9306) acc_u 6.2500 (8.4375) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [25/33] time 0.338 (0.340) data 0.261 (0.263) loss_u loss_u 0.9888 (0.9351) acc_u 3.1250 (8.0000) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [30/33] time 0.346 (0.341) data 0.267 (0.263) loss_u loss_u 0.9536 (0.9338) acc_u 6.2500 (8.1250) lr 1.6374e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 452
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 562
clean true:489
clean false:73
clean_rate:0.8701067615658363
noisy true:691
noisy false:379
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1070
epoch [59/200] batch [5/17] time 0.348 (0.329) data 0.269 (0.251) loss_x loss_x 0.2595 (0.5491) acc_x 100.0000 (87.5000) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/17] time 0.369 (0.341) data 0.291 (0.263) loss_x loss_x 0.4773 (0.4965) acc_x 90.6250 (88.1250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/17] time 0.349 (0.342) data 0.272 (0.264) loss_x loss_x 0.7280 (0.5298) acc_x 84.3750 (87.5000) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/33] time 0.343 (0.344) data 0.265 (0.266) loss_u loss_u 0.9375 (0.9305) acc_u 6.2500 (8.7500) lr 1.6252e-03 eta 0:00:09
epoch [59/200] batch [10/33] time 0.335 (0.343) data 0.257 (0.265) loss_u loss_u 0.9546 (0.9445) acc_u 9.3750 (7.1875) lr 1.6252e-03 eta 0:00:07
epoch [59/200] batch [15/33] time 0.355 (0.344) data 0.278 (0.266) loss_u loss_u 0.9517 (0.9400) acc_u 6.2500 (7.2917) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [20/33] time 0.332 (0.343) data 0.254 (0.265) loss_u loss_u 0.9111 (0.9363) acc_u 9.3750 (7.6562) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [25/33] time 0.335 (0.343) data 0.257 (0.265) loss_u loss_u 0.8677 (0.9310) acc_u 18.7500 (8.3750) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [30/33] time 0.342 (0.343) data 0.264 (0.265) loss_u loss_u 0.9502 (0.9354) acc_u 6.2500 (7.9167) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 481
confident_label rate tensor(0.3401, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 555
clean true:482
clean false:73
clean_rate:0.8684684684684685
noisy true:669
noisy false:408
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1077
epoch [60/200] batch [5/17] time 0.352 (0.361) data 0.273 (0.283) loss_x loss_x 0.2449 (0.3852) acc_x 96.8750 (90.0000) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/17] time 0.305 (0.340) data 0.227 (0.262) loss_x loss_x 0.1851 (0.3874) acc_x 100.0000 (90.0000) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/17] time 0.334 (0.339) data 0.256 (0.261) loss_x loss_x 0.3550 (0.4156) acc_x 90.6250 (89.7917) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/33] time 0.327 (0.339) data 0.249 (0.261) loss_u loss_u 0.9146 (0.9437) acc_u 6.2500 (5.6250) lr 1.6129e-03 eta 0:00:09
epoch [60/200] batch [10/33] time 0.346 (0.340) data 0.268 (0.262) loss_u loss_u 0.8325 (0.9407) acc_u 21.8750 (6.8750) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [15/33] time 0.347 (0.340) data 0.269 (0.262) loss_u loss_u 0.9209 (0.9395) acc_u 9.3750 (6.8750) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [20/33] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.9409 (0.9424) acc_u 9.3750 (6.7188) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [25/33] time 0.349 (0.342) data 0.271 (0.264) loss_u loss_u 0.9180 (0.9387) acc_u 12.5000 (7.2500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [30/33] time 0.332 (0.342) data 0.254 (0.264) loss_u loss_u 0.9712 (0.9360) acc_u 3.1250 (7.5000) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 426
confident_label rate tensor(0.3425, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 559
clean true:494
clean false:65
clean_rate:0.8837209302325582
noisy true:712
noisy false:361
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1073
epoch [61/200] batch [5/17] time 0.342 (0.350) data 0.264 (0.272) loss_x loss_x 0.4888 (0.4076) acc_x 84.3750 (89.3750) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/17] time 0.299 (0.330) data 0.221 (0.252) loss_x loss_x 0.2605 (0.3826) acc_x 96.8750 (91.8750) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/17] time 0.347 (0.329) data 0.270 (0.251) loss_x loss_x 0.3215 (0.3913) acc_x 93.7500 (91.6667) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/33] time 0.352 (0.336) data 0.275 (0.258) loss_u loss_u 0.9336 (0.9332) acc_u 6.2500 (6.8750) lr 1.6004e-03 eta 0:00:09
epoch [61/200] batch [10/33] time 0.343 (0.338) data 0.265 (0.260) loss_u loss_u 0.9360 (0.9364) acc_u 6.2500 (6.8750) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [15/33] time 0.358 (0.339) data 0.280 (0.261) loss_u loss_u 0.9487 (0.9410) acc_u 6.2500 (6.4583) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [20/33] time 0.353 (0.340) data 0.276 (0.262) loss_u loss_u 0.9629 (0.9476) acc_u 6.2500 (5.9375) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [25/33] time 0.345 (0.341) data 0.267 (0.263) loss_u loss_u 0.9575 (0.9444) acc_u 3.1250 (6.3750) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [30/33] time 0.336 (0.341) data 0.258 (0.263) loss_u loss_u 0.9478 (0.9458) acc_u 6.2500 (6.3542) lr 1.6004e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 448
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:494
clean false:69
clean_rate:0.8774422735346359
noisy true:690
noisy false:379
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [62/200] batch [5/17] time 0.345 (0.340) data 0.268 (0.262) loss_x loss_x 0.7573 (0.4710) acc_x 81.2500 (88.7500) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/17] time 0.337 (0.338) data 0.258 (0.260) loss_x loss_x 0.5723 (0.4851) acc_x 90.6250 (89.0625) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/17] time 0.336 (0.329) data 0.258 (0.251) loss_x loss_x 0.4514 (0.4727) acc_x 84.3750 (88.1250) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/33] time 0.338 (0.333) data 0.260 (0.256) loss_u loss_u 0.9180 (0.9321) acc_u 9.3750 (7.5000) lr 1.5878e-03 eta 0:00:09
epoch [62/200] batch [10/33] time 0.356 (0.336) data 0.278 (0.258) loss_u loss_u 0.9287 (0.9344) acc_u 9.3750 (8.1250) lr 1.5878e-03 eta 0:00:07
epoch [62/200] batch [15/33] time 0.325 (0.337) data 0.247 (0.259) loss_u loss_u 0.9565 (0.9382) acc_u 6.2500 (7.5000) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [20/33] time 0.372 (0.340) data 0.293 (0.262) loss_u loss_u 0.9351 (0.9400) acc_u 6.2500 (7.0312) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [25/33] time 0.333 (0.340) data 0.256 (0.262) loss_u loss_u 0.9951 (0.9441) acc_u 0.0000 (6.6250) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [30/33] time 0.355 (0.341) data 0.276 (0.263) loss_u loss_u 0.9639 (0.9432) acc_u 6.2500 (6.7708) lr 1.5878e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 412
confident_label rate tensor(0.3462, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 565
clean true:506
clean false:59
clean_rate:0.8955752212389381
noisy true:714
noisy false:353
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1067
epoch [63/200] batch [5/17] time 0.359 (0.355) data 0.281 (0.277) loss_x loss_x 0.1930 (0.3665) acc_x 96.8750 (92.5000) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/17] time 0.340 (0.352) data 0.262 (0.274) loss_x loss_x 0.2822 (0.3710) acc_x 93.7500 (92.8125) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/17] time 0.317 (0.343) data 0.239 (0.265) loss_x loss_x 0.5615 (0.4105) acc_x 84.3750 (90.0000) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/33] time 0.346 (0.343) data 0.268 (0.265) loss_u loss_u 0.9058 (0.9551) acc_u 9.3750 (5.0000) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [10/33] time 0.346 (0.345) data 0.267 (0.267) loss_u loss_u 0.9390 (0.9461) acc_u 9.3750 (6.2500) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [15/33] time 0.347 (0.345) data 0.269 (0.267) loss_u loss_u 0.8618 (0.9431) acc_u 12.5000 (6.4583) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [20/33] time 0.342 (0.345) data 0.265 (0.267) loss_u loss_u 0.9673 (0.9395) acc_u 3.1250 (7.1875) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [25/33] time 0.341 (0.345) data 0.264 (0.267) loss_u loss_u 0.9971 (0.9440) acc_u 0.0000 (6.6250) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [30/33] time 0.349 (0.344) data 0.271 (0.266) loss_u loss_u 0.9482 (0.9453) acc_u 3.1250 (6.4583) lr 1.5750e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 416
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 560
clean true:496
clean false:64
clean_rate:0.8857142857142857
noisy true:720
noisy false:352
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1072
epoch [64/200] batch [5/17] time 0.348 (0.355) data 0.270 (0.277) loss_x loss_x 0.5298 (0.5359) acc_x 84.3750 (87.5000) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/17] time 0.310 (0.342) data 0.233 (0.264) loss_x loss_x 0.2299 (0.4628) acc_x 90.6250 (87.8125) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/17] time 0.347 (0.331) data 0.269 (0.253) loss_x loss_x 0.5327 (0.4632) acc_x 87.5000 (87.9167) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/33] time 0.353 (0.334) data 0.275 (0.257) loss_u loss_u 0.9292 (0.9487) acc_u 6.2500 (5.6250) lr 1.5621e-03 eta 0:00:09
epoch [64/200] batch [10/33] time 0.328 (0.335) data 0.250 (0.257) loss_u loss_u 0.9951 (0.9476) acc_u 0.0000 (6.2500) lr 1.5621e-03 eta 0:00:07
epoch [64/200] batch [15/33] time 0.338 (0.336) data 0.260 (0.258) loss_u loss_u 0.9668 (0.9372) acc_u 3.1250 (7.2917) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [20/33] time 0.333 (0.336) data 0.255 (0.258) loss_u loss_u 0.9668 (0.9416) acc_u 3.1250 (6.7188) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [25/33] time 0.339 (0.335) data 0.261 (0.257) loss_u loss_u 0.8379 (0.9347) acc_u 18.7500 (7.7500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [30/33] time 0.359 (0.336) data 0.280 (0.258) loss_u loss_u 0.9834 (0.9382) acc_u 3.1250 (7.3958) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 437
confident_label rate tensor(0.3376, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 551
clean true:486
clean false:65
clean_rate:0.8820326678765881
noisy true:709
noisy false:372
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1081
epoch [65/200] batch [5/17] time 0.355 (0.353) data 0.277 (0.275) loss_x loss_x 0.2869 (0.3927) acc_x 93.7500 (91.2500) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/17] time 0.320 (0.349) data 0.241 (0.271) loss_x loss_x 0.7173 (0.3992) acc_x 87.5000 (92.1875) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [15/17] time 0.336 (0.346) data 0.258 (0.268) loss_x loss_x 0.6323 (0.4143) acc_x 84.3750 (91.0417) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/33] time 0.339 (0.348) data 0.261 (0.270) loss_u loss_u 0.9927 (0.9303) acc_u 0.0000 (7.5000) lr 1.5490e-03 eta 0:00:09
epoch [65/200] batch [10/33] time 0.347 (0.348) data 0.269 (0.270) loss_u loss_u 0.9336 (0.9312) acc_u 6.2500 (7.1875) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [15/33] time 0.330 (0.347) data 0.251 (0.269) loss_u loss_u 0.9165 (0.9267) acc_u 9.3750 (7.7083) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [20/33] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.9609 (0.9287) acc_u 6.2500 (8.1250) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [25/33] time 0.335 (0.345) data 0.256 (0.267) loss_u loss_u 0.9380 (0.9355) acc_u 9.3750 (7.6250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [30/33] time 0.341 (0.345) data 0.263 (0.267) loss_u loss_u 0.8774 (0.9355) acc_u 12.5000 (7.6042) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 420
confident_label rate tensor(0.3407, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 556
clean true:494
clean false:62
clean_rate:0.8884892086330936
noisy true:718
noisy false:358
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1076
epoch [66/200] batch [5/17] time 0.306 (0.312) data 0.228 (0.234) loss_x loss_x 0.3882 (0.4011) acc_x 90.6250 (91.2500) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/17] time 0.336 (0.319) data 0.258 (0.241) loss_x loss_x 0.5049 (0.4833) acc_x 84.3750 (87.1875) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/17] time 0.361 (0.330) data 0.283 (0.252) loss_x loss_x 0.3125 (0.4855) acc_x 93.7500 (87.2917) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/33] time 0.342 (0.334) data 0.264 (0.256) loss_u loss_u 0.9307 (0.9291) acc_u 9.3750 (8.7500) lr 1.5358e-03 eta 0:00:09
epoch [66/200] batch [10/33] time 0.350 (0.336) data 0.272 (0.258) loss_u loss_u 0.9707 (0.9290) acc_u 3.1250 (8.4375) lr 1.5358e-03 eta 0:00:07
epoch [66/200] batch [15/33] time 0.346 (0.338) data 0.269 (0.260) loss_u loss_u 0.9468 (0.9260) acc_u 3.1250 (8.5417) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [20/33] time 0.331 (0.338) data 0.253 (0.260) loss_u loss_u 0.9570 (0.9295) acc_u 3.1250 (7.9688) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [25/33] time 0.291 (0.337) data 0.213 (0.259) loss_u loss_u 0.9282 (0.9311) acc_u 6.2500 (7.6250) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [30/33] time 0.340 (0.337) data 0.262 (0.259) loss_u loss_u 0.9888 (0.9334) acc_u 0.0000 (7.5000) lr 1.5358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 435
confident_label rate tensor(0.3548, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 579
clean true:512
clean false:67
clean_rate:0.8842832469775475
noisy true:685
noisy false:368
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1053
epoch [67/200] batch [5/18] time 0.349 (0.346) data 0.272 (0.268) loss_x loss_x 0.4360 (0.4460) acc_x 84.3750 (87.5000) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/18] time 0.302 (0.323) data 0.224 (0.246) loss_x loss_x 0.7749 (0.4921) acc_x 81.2500 (87.8125) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/18] time 0.327 (0.329) data 0.250 (0.252) loss_x loss_x 0.5967 (0.4835) acc_x 81.2500 (87.9167) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/32] time 0.350 (0.335) data 0.271 (0.257) loss_u loss_u 0.9966 (0.9553) acc_u 0.0000 (4.3750) lr 1.5225e-03 eta 0:00:09
epoch [67/200] batch [10/32] time 0.345 (0.335) data 0.267 (0.257) loss_u loss_u 0.9653 (0.9636) acc_u 3.1250 (3.4375) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [15/32] time 0.342 (0.336) data 0.265 (0.258) loss_u loss_u 0.8628 (0.9587) acc_u 15.6250 (4.1667) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [20/32] time 0.352 (0.338) data 0.273 (0.260) loss_u loss_u 0.9688 (0.9570) acc_u 3.1250 (4.5312) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [25/32] time 0.340 (0.339) data 0.262 (0.261) loss_u loss_u 0.9121 (0.9520) acc_u 9.3750 (5.1250) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [30/32] time 0.356 (0.341) data 0.278 (0.263) loss_u loss_u 0.9478 (0.9534) acc_u 6.2500 (5.0000) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 434
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 560
clean true:493
clean false:67
clean_rate:0.8803571428571428
noisy true:705
noisy false:367
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1072
epoch [68/200] batch [5/17] time 0.308 (0.328) data 0.230 (0.250) loss_x loss_x 0.1556 (0.3936) acc_x 100.0000 (92.5000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/17] time 0.354 (0.320) data 0.277 (0.243) loss_x loss_x 0.2695 (0.4161) acc_x 90.6250 (90.0000) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/17] time 0.343 (0.327) data 0.266 (0.249) loss_x loss_x 0.4314 (0.4143) acc_x 96.8750 (90.4167) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/33] time 0.299 (0.330) data 0.222 (0.253) loss_u loss_u 0.9243 (0.9429) acc_u 9.3750 (6.8750) lr 1.5090e-03 eta 0:00:09
epoch [68/200] batch [10/33] time 0.339 (0.329) data 0.261 (0.251) loss_u loss_u 0.9658 (0.9516) acc_u 6.2500 (6.2500) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [15/33] time 0.358 (0.331) data 0.280 (0.254) loss_u loss_u 0.9829 (0.9545) acc_u 3.1250 (6.2500) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [20/33] time 0.344 (0.333) data 0.266 (0.255) loss_u loss_u 0.9595 (0.9508) acc_u 6.2500 (6.2500) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [25/33] time 0.337 (0.333) data 0.259 (0.256) loss_u loss_u 0.9570 (0.9527) acc_u 3.1250 (5.7500) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [30/33] time 0.348 (0.335) data 0.271 (0.257) loss_u loss_u 0.9883 (0.9510) acc_u 0.0000 (5.8333) lr 1.5090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 434
confident_label rate tensor(0.3493, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 570
clean true:493
clean false:77
clean_rate:0.8649122807017544
noisy true:705
noisy false:357
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1062
epoch [69/200] batch [5/17] time 0.321 (0.351) data 0.243 (0.273) loss_x loss_x 0.3904 (0.4882) acc_x 90.6250 (88.1250) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/17] time 0.346 (0.335) data 0.269 (0.257) loss_x loss_x 0.3745 (0.4593) acc_x 90.6250 (88.4375) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/17] time 0.360 (0.340) data 0.283 (0.262) loss_x loss_x 0.3411 (0.4657) acc_x 93.7500 (88.1250) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/33] time 0.330 (0.341) data 0.252 (0.263) loss_u loss_u 0.9263 (0.9433) acc_u 6.2500 (6.8750) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [10/33] time 0.357 (0.342) data 0.279 (0.264) loss_u loss_u 0.9468 (0.9546) acc_u 3.1250 (4.6875) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [15/33] time 0.337 (0.341) data 0.259 (0.263) loss_u loss_u 0.9976 (0.9531) acc_u 0.0000 (5.4167) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [20/33] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9922 (0.9473) acc_u 3.1250 (6.4062) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [25/33] time 0.342 (0.342) data 0.263 (0.265) loss_u loss_u 0.9507 (0.9490) acc_u 6.2500 (6.1250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [30/33] time 0.347 (0.342) data 0.268 (0.264) loss_u loss_u 0.9067 (0.9452) acc_u 9.3750 (6.3542) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 408
confident_label rate tensor(0.3511, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 573
clean true:506
clean false:67
clean_rate:0.8830715532286213
noisy true:718
noisy false:341
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1059
epoch [70/200] batch [5/17] time 0.337 (0.348) data 0.259 (0.270) loss_x loss_x 0.3623 (0.3648) acc_x 93.7500 (91.8750) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [10/17] time 0.306 (0.327) data 0.228 (0.249) loss_x loss_x 0.5103 (0.4121) acc_x 87.5000 (90.3125) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/17] time 0.333 (0.324) data 0.256 (0.247) loss_x loss_x 0.7437 (0.4449) acc_x 75.0000 (89.3750) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/33] time 0.349 (0.329) data 0.272 (0.251) loss_u loss_u 0.8770 (0.9328) acc_u 12.5000 (6.8750) lr 1.4818e-03 eta 0:00:09
epoch [70/200] batch [10/33] time 0.348 (0.332) data 0.271 (0.254) loss_u loss_u 0.9062 (0.9418) acc_u 9.3750 (6.2500) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [15/33] time 0.341 (0.333) data 0.264 (0.256) loss_u loss_u 0.8804 (0.9359) acc_u 12.5000 (6.6667) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [20/33] time 0.344 (0.335) data 0.266 (0.257) loss_u loss_u 0.9604 (0.9433) acc_u 6.2500 (5.9375) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [25/33] time 0.339 (0.335) data 0.261 (0.257) loss_u loss_u 0.9678 (0.9398) acc_u 3.1250 (6.3750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [30/33] time 0.342 (0.336) data 0.264 (0.258) loss_u loss_u 0.9458 (0.9415) acc_u 9.3750 (6.4583) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 470
confident_label rate tensor(0.3542, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 578
clean true:503
clean false:75
clean_rate:0.870242214532872
noisy true:659
noisy false:395
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 1054
epoch [71/200] batch [5/18] time 0.351 (0.339) data 0.273 (0.261) loss_x loss_x 0.4263 (0.4014) acc_x 90.6250 (90.6250) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/18] time 0.298 (0.324) data 0.220 (0.247) loss_x loss_x 0.3867 (0.3689) acc_x 90.6250 (91.5625) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/18] time 0.342 (0.322) data 0.265 (0.244) loss_x loss_x 0.5894 (0.3876) acc_x 81.2500 (90.6250) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/32] time 0.337 (0.330) data 0.260 (0.252) loss_u loss_u 0.9668 (0.9497) acc_u 6.2500 (5.6250) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [10/32] time 0.338 (0.332) data 0.260 (0.255) loss_u loss_u 0.9287 (0.9511) acc_u 6.2500 (5.3125) lr 1.4679e-03 eta 0:00:07
epoch [71/200] batch [15/32] time 0.348 (0.333) data 0.270 (0.255) loss_u loss_u 0.8623 (0.9465) acc_u 15.6250 (6.0417) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [20/32] time 0.354 (0.335) data 0.275 (0.257) loss_u loss_u 0.8691 (0.9428) acc_u 15.6250 (6.5625) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [25/32] time 0.347 (0.336) data 0.269 (0.258) loss_u loss_u 0.9312 (0.9421) acc_u 9.3750 (6.7500) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [30/32] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9189 (0.9479) acc_u 9.3750 (6.0417) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 422
confident_label rate tensor(0.3548, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 579
clean true:508
clean false:71
clean_rate:0.8773747841105354
noisy true:702
noisy false:351
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1053
epoch [72/200] batch [5/18] time 0.335 (0.332) data 0.258 (0.254) loss_x loss_x 0.3333 (0.3744) acc_x 90.6250 (91.8750) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [10/18] time 0.327 (0.333) data 0.249 (0.255) loss_x loss_x 0.5356 (0.3979) acc_x 78.1250 (90.6250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/18] time 0.297 (0.331) data 0.219 (0.253) loss_x loss_x 0.2812 (0.4416) acc_x 93.7500 (89.3750) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/32] time 0.348 (0.327) data 0.270 (0.249) loss_u loss_u 0.9878 (0.9379) acc_u 0.0000 (7.5000) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [10/32] time 0.337 (0.329) data 0.259 (0.251) loss_u loss_u 0.9565 (0.9427) acc_u 3.1250 (7.1875) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [15/32] time 0.339 (0.332) data 0.260 (0.254) loss_u loss_u 0.9048 (0.9377) acc_u 12.5000 (7.5000) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [20/32] time 0.344 (0.333) data 0.267 (0.255) loss_u loss_u 0.9370 (0.9360) acc_u 6.2500 (7.6562) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [25/32] time 0.298 (0.329) data 0.221 (0.251) loss_u loss_u 1.0000 (0.9396) acc_u 0.0000 (7.1250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [30/32] time 0.345 (0.330) data 0.266 (0.252) loss_u loss_u 0.9219 (0.9381) acc_u 12.5000 (7.5000) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 451
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:501
clean false:75
clean_rate:0.8697916666666666
noisy true:680
noisy false:376
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [73/200] batch [5/18] time 0.343 (0.347) data 0.265 (0.269) loss_x loss_x 0.6060 (0.4426) acc_x 81.2500 (86.8750) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [10/18] time 0.346 (0.339) data 0.269 (0.261) loss_x loss_x 0.4294 (0.4608) acc_x 90.6250 (85.9375) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/18] time 0.361 (0.339) data 0.283 (0.262) loss_x loss_x 0.3457 (0.4674) acc_x 84.3750 (85.8333) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [5/33] time 0.332 (0.337) data 0.254 (0.259) loss_u loss_u 0.9976 (0.9514) acc_u 0.0000 (6.2500) lr 1.4399e-03 eta 0:00:09
epoch [73/200] batch [10/33] time 0.338 (0.338) data 0.260 (0.260) loss_u loss_u 0.9546 (0.9446) acc_u 6.2500 (6.8750) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [15/33] time 0.340 (0.339) data 0.262 (0.261) loss_u loss_u 0.8882 (0.9443) acc_u 15.6250 (6.8750) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [20/33] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9346 (0.9455) acc_u 6.2500 (6.5625) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [25/33] time 0.357 (0.341) data 0.278 (0.263) loss_u loss_u 0.9673 (0.9399) acc_u 3.1250 (7.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [30/33] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.9790 (0.9415) acc_u 3.1250 (6.9792) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 444
confident_label rate tensor(0.3468, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 566
clean true:495
clean false:71
clean_rate:0.8745583038869258
noisy true:693
noisy false:373
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1066
epoch [74/200] batch [5/17] time 0.345 (0.349) data 0.268 (0.272) loss_x loss_x 0.2362 (0.2943) acc_x 96.8750 (95.0000) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/17] time 0.337 (0.343) data 0.259 (0.266) loss_x loss_x 0.6611 (0.4481) acc_x 81.2500 (90.0000) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/17] time 0.293 (0.330) data 0.215 (0.253) loss_x loss_x 0.6260 (0.4419) acc_x 90.6250 (90.8333) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/33] time 0.324 (0.330) data 0.246 (0.252) loss_u loss_u 0.8579 (0.8948) acc_u 15.6250 (11.8750) lr 1.4258e-03 eta 0:00:09
epoch [74/200] batch [10/33] time 0.349 (0.334) data 0.271 (0.256) loss_u loss_u 0.9648 (0.9173) acc_u 6.2500 (9.3750) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [15/33] time 0.354 (0.336) data 0.277 (0.258) loss_u loss_u 0.9224 (0.9251) acc_u 9.3750 (8.5417) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [20/33] time 0.352 (0.338) data 0.274 (0.260) loss_u loss_u 0.9570 (0.9251) acc_u 6.2500 (8.7500) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [25/33] time 0.341 (0.337) data 0.263 (0.260) loss_u loss_u 0.9150 (0.9263) acc_u 9.3750 (8.6250) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [30/33] time 0.357 (0.338) data 0.279 (0.260) loss_u loss_u 0.9814 (0.9295) acc_u 3.1250 (8.2292) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 446
confident_label rate tensor(0.3462, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 565
clean true:494
clean false:71
clean_rate:0.8743362831858407
noisy true:692
noisy false:375
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1067
epoch [75/200] batch [5/17] time 0.334 (0.347) data 0.257 (0.269) loss_x loss_x 0.4121 (0.4612) acc_x 87.5000 (85.6250) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/17] time 0.353 (0.344) data 0.275 (0.266) loss_x loss_x 0.5479 (0.4287) acc_x 87.5000 (87.8125) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/17] time 0.307 (0.342) data 0.228 (0.265) loss_x loss_x 0.4783 (0.4177) acc_x 84.3750 (88.7500) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/33] time 0.334 (0.339) data 0.256 (0.261) loss_u loss_u 0.9795 (0.9535) acc_u 3.1250 (5.6250) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [10/33] time 0.329 (0.340) data 0.251 (0.263) loss_u loss_u 0.9688 (0.9407) acc_u 3.1250 (6.8750) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [15/33] time 0.344 (0.341) data 0.266 (0.263) loss_u loss_u 0.9209 (0.9364) acc_u 9.3750 (7.5000) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [20/33] time 0.356 (0.342) data 0.278 (0.265) loss_u loss_u 0.9233 (0.9394) acc_u 9.3750 (7.3438) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [25/33] time 0.346 (0.342) data 0.267 (0.265) loss_u loss_u 0.9365 (0.9389) acc_u 6.2500 (7.3750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [30/33] time 0.342 (0.344) data 0.264 (0.266) loss_u loss_u 0.9375 (0.9347) acc_u 6.2500 (7.9167) lr 1.4115e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 451
confident_label rate tensor(0.3431, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 560
clean true:485
clean false:75
clean_rate:0.8660714285714286
noisy true:696
noisy false:376
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1072
epoch [76/200] batch [5/17] time 0.334 (0.343) data 0.256 (0.266) loss_x loss_x 0.6514 (0.3922) acc_x 81.2500 (88.1250) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/17] time 0.344 (0.340) data 0.267 (0.262) loss_x loss_x 0.3772 (0.3588) acc_x 90.6250 (90.9375) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/17] time 0.339 (0.340) data 0.261 (0.262) loss_x loss_x 0.3381 (0.3542) acc_x 93.7500 (90.6250) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/33] time 0.331 (0.341) data 0.254 (0.263) loss_u loss_u 0.9624 (0.9470) acc_u 3.1250 (5.0000) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [10/33] time 0.328 (0.340) data 0.250 (0.262) loss_u loss_u 0.8838 (0.9320) acc_u 12.5000 (7.1875) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [15/33] time 0.349 (0.341) data 0.271 (0.264) loss_u loss_u 0.9287 (0.9261) acc_u 9.3750 (8.3333) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [20/33] time 0.339 (0.342) data 0.262 (0.264) loss_u loss_u 0.9438 (0.9310) acc_u 6.2500 (7.8125) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [25/33] time 0.367 (0.344) data 0.290 (0.266) loss_u loss_u 0.9585 (0.9318) acc_u 3.1250 (7.6250) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [30/33] time 0.343 (0.344) data 0.266 (0.266) loss_u loss_u 0.9409 (0.9354) acc_u 6.2500 (7.5000) lr 1.3971e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 466
confident_label rate tensor(0.3456, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 564
clean true:489
clean false:75
clean_rate:0.8670212765957447
noisy true:677
noisy false:391
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1068
epoch [77/200] batch [5/17] time 0.345 (0.358) data 0.267 (0.280) loss_x loss_x 0.1586 (0.4698) acc_x 96.8750 (86.8750) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [10/17] time 0.376 (0.359) data 0.298 (0.280) loss_x loss_x 0.3145 (0.4406) acc_x 93.7500 (88.4375) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/17] time 0.367 (0.359) data 0.289 (0.281) loss_x loss_x 0.4031 (0.4240) acc_x 87.5000 (88.3333) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/33] time 0.350 (0.362) data 0.271 (0.283) loss_u loss_u 0.9087 (0.9330) acc_u 9.3750 (7.5000) lr 1.3827e-03 eta 0:00:10
epoch [77/200] batch [10/33] time 0.344 (0.359) data 0.265 (0.281) loss_u loss_u 0.9087 (0.9218) acc_u 9.3750 (8.7500) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [15/33] time 0.362 (0.354) data 0.283 (0.275) loss_u loss_u 0.9307 (0.9234) acc_u 6.2500 (8.1250) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [20/33] time 0.331 (0.352) data 0.252 (0.273) loss_u loss_u 0.9272 (0.9225) acc_u 9.3750 (8.5938) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [25/33] time 0.303 (0.349) data 0.224 (0.271) loss_u loss_u 0.9766 (0.9301) acc_u 3.1250 (8.0000) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [30/33] time 0.336 (0.349) data 0.257 (0.270) loss_u loss_u 0.9258 (0.9315) acc_u 9.3750 (7.9167) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 445
confident_label rate tensor(0.3542, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 578
clean true:500
clean false:78
clean_rate:0.8650519031141869
noisy true:687
noisy false:367
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 1054
epoch [78/200] batch [5/18] time 0.344 (0.354) data 0.267 (0.276) loss_x loss_x 0.1724 (0.2882) acc_x 96.8750 (94.3750) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [10/18] time 0.355 (0.350) data 0.277 (0.272) loss_x loss_x 0.2727 (0.3419) acc_x 96.8750 (93.4375) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/18] time 0.347 (0.348) data 0.269 (0.270) loss_x loss_x 0.4182 (0.3898) acc_x 90.6250 (91.4583) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [5/32] time 0.329 (0.344) data 0.251 (0.267) loss_u loss_u 0.9365 (0.9515) acc_u 12.5000 (5.6250) lr 1.3681e-03 eta 0:00:09
epoch [78/200] batch [10/32] time 0.342 (0.344) data 0.264 (0.266) loss_u loss_u 0.9697 (0.9585) acc_u 3.1250 (5.0000) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [15/32] time 0.340 (0.344) data 0.263 (0.266) loss_u loss_u 0.9697 (0.9457) acc_u 6.2500 (6.4583) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [20/32] time 0.337 (0.344) data 0.259 (0.266) loss_u loss_u 0.9546 (0.9431) acc_u 3.1250 (7.0312) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [25/32] time 0.341 (0.344) data 0.263 (0.266) loss_u loss_u 0.8281 (0.9397) acc_u 21.8750 (7.3750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [30/32] time 0.346 (0.344) data 0.269 (0.266) loss_u loss_u 0.8984 (0.9420) acc_u 12.5000 (6.9792) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 422
confident_label rate tensor(0.3597, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 587
clean true:515
clean false:72
clean_rate:0.8773424190800682
noisy true:695
noisy false:350
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1045
epoch [79/200] batch [5/18] time 0.309 (0.345) data 0.231 (0.267) loss_x loss_x 0.4231 (0.3749) acc_x 87.5000 (93.1250) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/18] time 0.354 (0.346) data 0.277 (0.268) loss_x loss_x 0.4133 (0.4206) acc_x 87.5000 (90.6250) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/18] time 0.360 (0.348) data 0.282 (0.270) loss_x loss_x 0.3894 (0.4135) acc_x 90.6250 (90.2083) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [5/32] time 0.351 (0.347) data 0.273 (0.269) loss_u loss_u 0.9658 (0.9571) acc_u 3.1250 (4.3750) lr 1.3535e-03 eta 0:00:09
epoch [79/200] batch [10/32] time 0.337 (0.346) data 0.259 (0.268) loss_u loss_u 0.9697 (0.9549) acc_u 3.1250 (4.6875) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [15/32] time 0.346 (0.346) data 0.268 (0.268) loss_u loss_u 0.8745 (0.9466) acc_u 12.5000 (5.6250) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [20/32] time 0.313 (0.344) data 0.234 (0.266) loss_u loss_u 0.9941 (0.9493) acc_u 0.0000 (5.4688) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [25/32] time 0.335 (0.340) data 0.257 (0.262) loss_u loss_u 0.8960 (0.9416) acc_u 12.5000 (6.5000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [30/32] time 0.338 (0.340) data 0.260 (0.262) loss_u loss_u 0.9517 (0.9436) acc_u 6.2500 (6.3542) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.3621, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 591
clean true:516
clean false:75
clean_rate:0.8730964467005076
noisy true:688
noisy false:353
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1041
epoch [80/200] batch [5/18] time 0.335 (0.381) data 0.254 (0.301) loss_x loss_x 0.5703 (0.5838) acc_x 87.5000 (86.2500) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/18] time 0.343 (0.347) data 0.265 (0.268) loss_x loss_x 0.5894 (0.5609) acc_x 87.5000 (86.5625) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/18] time 0.339 (0.347) data 0.261 (0.269) loss_x loss_x 0.1936 (0.4889) acc_x 96.8750 (88.1250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [5/32] time 0.349 (0.348) data 0.270 (0.270) loss_u loss_u 0.9692 (0.9579) acc_u 3.1250 (5.6250) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [10/32] time 0.348 (0.350) data 0.270 (0.272) loss_u loss_u 0.9565 (0.9513) acc_u 6.2500 (6.2500) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [15/32] time 0.371 (0.350) data 0.293 (0.272) loss_u loss_u 0.9756 (0.9491) acc_u 3.1250 (6.6667) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [20/32] time 0.332 (0.348) data 0.254 (0.270) loss_u loss_u 0.9648 (0.9538) acc_u 3.1250 (5.7812) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [25/32] time 0.329 (0.348) data 0.252 (0.270) loss_u loss_u 0.9126 (0.9520) acc_u 12.5000 (6.0000) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [30/32] time 0.327 (0.347) data 0.250 (0.268) loss_u loss_u 0.9443 (0.9514) acc_u 6.2500 (5.9375) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 452
confident_label rate tensor(0.3505, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 572
clean true:499
clean false:73
clean_rate:0.8723776223776224
noisy true:681
noisy false:379
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 1060
epoch [81/200] batch [5/17] time 0.308 (0.339) data 0.231 (0.262) loss_x loss_x 0.6855 (0.5769) acc_x 90.6250 (86.2500) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/17] time 0.345 (0.331) data 0.267 (0.254) loss_x loss_x 0.2428 (0.4971) acc_x 96.8750 (88.4375) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/17] time 0.338 (0.336) data 0.261 (0.258) loss_x loss_x 0.4917 (0.4699) acc_x 90.6250 (89.7917) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/33] time 0.355 (0.339) data 0.277 (0.262) loss_u loss_u 0.9243 (0.9527) acc_u 9.3750 (5.6250) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [10/33] time 0.340 (0.339) data 0.262 (0.261) loss_u loss_u 0.9028 (0.9494) acc_u 12.5000 (5.9375) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [15/33] time 0.336 (0.339) data 0.258 (0.261) loss_u loss_u 0.9761 (0.9458) acc_u 3.1250 (6.2500) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [20/33] time 0.346 (0.340) data 0.268 (0.262) loss_u loss_u 0.9038 (0.9462) acc_u 12.5000 (6.4062) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [25/33] time 0.350 (0.341) data 0.272 (0.263) loss_u loss_u 0.9526 (0.9434) acc_u 6.2500 (6.5000) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [30/33] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.8516 (0.9397) acc_u 18.7500 (7.1875) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 460
confident_label rate tensor(0.3554, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 580
clean true:504
clean false:76
clean_rate:0.8689655172413793
noisy true:668
noisy false:384
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1052
epoch [82/200] batch [5/18] time 0.313 (0.326) data 0.234 (0.248) loss_x loss_x 0.2822 (0.2916) acc_x 90.6250 (93.7500) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [10/18] time 0.337 (0.335) data 0.259 (0.257) loss_x loss_x 0.5015 (0.3745) acc_x 90.6250 (91.5625) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/18] time 0.346 (0.336) data 0.269 (0.259) loss_x loss_x 0.1937 (0.3994) acc_x 93.7500 (90.6250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [5/32] time 0.324 (0.337) data 0.246 (0.259) loss_u loss_u 0.9521 (0.9447) acc_u 6.2500 (7.5000) lr 1.3090e-03 eta 0:00:09
epoch [82/200] batch [10/32] time 0.358 (0.339) data 0.280 (0.261) loss_u loss_u 0.9761 (0.9402) acc_u 0.0000 (7.5000) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [15/32] time 0.343 (0.338) data 0.265 (0.260) loss_u loss_u 0.9849 (0.9426) acc_u 3.1250 (7.0833) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [20/32] time 0.339 (0.338) data 0.262 (0.260) loss_u loss_u 0.9956 (0.9469) acc_u 0.0000 (6.4062) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [25/32] time 0.343 (0.339) data 0.264 (0.261) loss_u loss_u 0.9824 (0.9509) acc_u 0.0000 (5.6250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [30/32] time 0.325 (0.338) data 0.248 (0.260) loss_u loss_u 0.9961 (0.9499) acc_u 0.0000 (5.8333) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 438
confident_label rate tensor(0.3560, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 581
clean true:503
clean false:78
clean_rate:0.8657487091222031
noisy true:691
noisy false:360
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1051
epoch [83/200] batch [5/18] time 0.309 (0.338) data 0.231 (0.260) loss_x loss_x 0.2664 (0.4398) acc_x 93.7500 (89.3750) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [10/18] time 0.339 (0.328) data 0.260 (0.250) loss_x loss_x 0.1698 (0.4232) acc_x 96.8750 (89.6875) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/18] time 0.342 (0.332) data 0.265 (0.255) loss_x loss_x 0.3643 (0.4294) acc_x 90.6250 (89.5833) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/32] time 0.343 (0.338) data 0.266 (0.260) loss_u loss_u 0.9604 (0.9396) acc_u 3.1250 (6.2500) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [10/32] time 0.347 (0.339) data 0.269 (0.262) loss_u loss_u 0.9580 (0.9517) acc_u 3.1250 (4.6875) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [15/32] time 0.333 (0.340) data 0.255 (0.262) loss_u loss_u 0.9351 (0.9481) acc_u 9.3750 (5.6250) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [20/32] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.9302 (0.9450) acc_u 6.2500 (6.2500) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [25/32] time 0.332 (0.339) data 0.254 (0.261) loss_u loss_u 0.9258 (0.9438) acc_u 9.3750 (6.5000) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [30/32] time 0.347 (0.340) data 0.269 (0.262) loss_u loss_u 0.9668 (0.9412) acc_u 6.2500 (7.2917) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 438
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:496
clean false:80
clean_rate:0.8611111111111112
noisy true:698
noisy false:358
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [84/200] batch [5/18] time 0.306 (0.333) data 0.228 (0.255) loss_x loss_x 0.5625 (0.4516) acc_x 90.6250 (91.2500) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/18] time 0.337 (0.327) data 0.260 (0.249) loss_x loss_x 0.3125 (0.4618) acc_x 93.7500 (91.8750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/18] time 0.346 (0.331) data 0.268 (0.253) loss_x loss_x 0.2299 (0.4167) acc_x 90.6250 (90.8333) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/33] time 0.337 (0.335) data 0.260 (0.257) loss_u loss_u 0.8750 (0.9079) acc_u 15.6250 (10.6250) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [10/33] time 0.338 (0.336) data 0.260 (0.258) loss_u loss_u 0.9551 (0.9356) acc_u 6.2500 (8.1250) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [15/33] time 0.342 (0.336) data 0.264 (0.259) loss_u loss_u 0.8950 (0.9249) acc_u 12.5000 (9.5833) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [20/33] time 0.340 (0.337) data 0.262 (0.259) loss_u loss_u 0.9868 (0.9354) acc_u 3.1250 (8.1250) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [25/33] time 0.356 (0.338) data 0.278 (0.260) loss_u loss_u 0.9092 (0.9359) acc_u 9.3750 (7.8750) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [30/33] time 0.346 (0.338) data 0.268 (0.260) loss_u loss_u 0.9072 (0.9344) acc_u 9.3750 (7.9167) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 466
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:492
clean false:84
clean_rate:0.8541666666666666
noisy true:674
noisy false:382
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [85/200] batch [5/18] time 0.300 (0.337) data 0.222 (0.258) loss_x loss_x 0.3550 (0.3883) acc_x 93.7500 (94.3750) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [10/18] time 0.307 (0.320) data 0.229 (0.242) loss_x loss_x 0.6089 (0.4366) acc_x 84.3750 (91.2500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/18] time 0.360 (0.328) data 0.283 (0.250) loss_x loss_x 0.1903 (0.4511) acc_x 93.7500 (90.8333) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/33] time 0.346 (0.335) data 0.267 (0.257) loss_u loss_u 0.9966 (0.9354) acc_u 0.0000 (7.5000) lr 1.2639e-03 eta 0:00:09
epoch [85/200] batch [10/33] time 0.344 (0.338) data 0.266 (0.260) loss_u loss_u 0.9326 (0.9344) acc_u 6.2500 (7.5000) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [15/33] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.8628 (0.9227) acc_u 15.6250 (8.7500) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [20/33] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9834 (0.9288) acc_u 0.0000 (8.2812) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [25/33] time 0.323 (0.340) data 0.246 (0.262) loss_u loss_u 0.9668 (0.9321) acc_u 3.1250 (8.1250) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [30/33] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9346 (0.9336) acc_u 6.2500 (8.0208) lr 1.2639e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 407
confident_label rate tensor(0.3542, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 578
clean true:511
clean false:67
clean_rate:0.884083044982699
noisy true:714
noisy false:340
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 1054
epoch [86/200] batch [5/18] time 0.306 (0.328) data 0.228 (0.250) loss_x loss_x 0.5557 (0.4073) acc_x 75.0000 (86.2500) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [10/18] time 0.348 (0.328) data 0.271 (0.250) loss_x loss_x 0.5557 (0.4034) acc_x 90.6250 (88.1250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/18] time 0.350 (0.334) data 0.273 (0.256) loss_x loss_x 0.1917 (0.4036) acc_x 96.8750 (89.1667) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [5/32] time 0.340 (0.335) data 0.262 (0.257) loss_u loss_u 0.9937 (0.9486) acc_u 0.0000 (6.2500) lr 1.2487e-03 eta 0:00:09
epoch [86/200] batch [10/32] time 0.354 (0.337) data 0.277 (0.259) loss_u loss_u 0.9141 (0.9427) acc_u 9.3750 (6.5625) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [15/32] time 0.342 (0.336) data 0.264 (0.258) loss_u loss_u 0.9541 (0.9359) acc_u 3.1250 (7.0833) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [20/32] time 0.350 (0.338) data 0.271 (0.260) loss_u loss_u 0.9053 (0.9404) acc_u 9.3750 (6.4062) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [25/32] time 0.348 (0.339) data 0.269 (0.261) loss_u loss_u 0.9438 (0.9416) acc_u 9.3750 (6.5000) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [30/32] time 0.342 (0.339) data 0.264 (0.261) loss_u loss_u 0.9341 (0.9407) acc_u 6.2500 (6.7708) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.3566, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 582
clean true:504
clean false:78
clean_rate:0.865979381443299
noisy true:700
noisy false:350
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1050
epoch [87/200] batch [5/18] time 0.309 (0.343) data 0.231 (0.265) loss_x loss_x 0.1663 (0.3799) acc_x 93.7500 (89.3750) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [10/18] time 0.349 (0.343) data 0.271 (0.266) loss_x loss_x 0.2303 (0.3927) acc_x 96.8750 (90.0000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/18] time 0.342 (0.347) data 0.264 (0.269) loss_x loss_x 0.5381 (0.4041) acc_x 90.6250 (89.3750) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [5/32] time 0.350 (0.347) data 0.272 (0.269) loss_u loss_u 0.8818 (0.9404) acc_u 15.6250 (6.8750) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [10/32] time 0.352 (0.347) data 0.274 (0.269) loss_u loss_u 0.9707 (0.9347) acc_u 6.2500 (7.8125) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [15/32] time 0.341 (0.346) data 0.261 (0.268) loss_u loss_u 0.9390 (0.9428) acc_u 6.2500 (6.6667) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [20/32] time 0.335 (0.346) data 0.257 (0.268) loss_u loss_u 0.9521 (0.9438) acc_u 3.1250 (6.2500) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [25/32] time 0.343 (0.346) data 0.265 (0.268) loss_u loss_u 0.9614 (0.9390) acc_u 6.2500 (6.7500) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [30/32] time 0.341 (0.347) data 0.263 (0.268) loss_u loss_u 0.8862 (0.9400) acc_u 12.5000 (6.9792) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 465
confident_label rate tensor(0.3505, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 572
clean true:488
clean false:84
clean_rate:0.8531468531468531
noisy true:679
noisy false:381
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 1060
epoch [88/200] batch [5/17] time 0.400 (0.337) data 0.321 (0.258) loss_x loss_x 0.2881 (0.3747) acc_x 87.5000 (88.1250) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/17] time 0.350 (0.341) data 0.273 (0.263) loss_x loss_x 0.4028 (0.3686) acc_x 87.5000 (89.6875) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/17] time 0.336 (0.342) data 0.259 (0.264) loss_x loss_x 0.4482 (0.4035) acc_x 90.6250 (89.5833) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/33] time 0.342 (0.342) data 0.264 (0.264) loss_u loss_u 0.9570 (0.9296) acc_u 3.1250 (6.8750) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [10/33] time 0.335 (0.341) data 0.257 (0.264) loss_u loss_u 0.9829 (0.9420) acc_u 0.0000 (5.9375) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [15/33] time 0.346 (0.341) data 0.268 (0.263) loss_u loss_u 0.9956 (0.9408) acc_u 0.0000 (5.8333) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [20/33] time 0.323 (0.341) data 0.245 (0.263) loss_u loss_u 0.9131 (0.9379) acc_u 9.3750 (6.4062) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [25/33] time 0.343 (0.340) data 0.264 (0.262) loss_u loss_u 0.8496 (0.9335) acc_u 18.7500 (7.2500) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [30/33] time 0.330 (0.340) data 0.252 (0.262) loss_u loss_u 0.9800 (0.9375) acc_u 3.1250 (6.8750) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 403
confident_label rate tensor(0.3585, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 585
clean true:509
clean false:76
clean_rate:0.8700854700854701
noisy true:720
noisy false:327
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1047
epoch [89/200] batch [5/18] time 0.356 (0.344) data 0.278 (0.267) loss_x loss_x 0.3242 (0.3045) acc_x 93.7500 (95.0000) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [10/18] time 0.303 (0.329) data 0.225 (0.251) loss_x loss_x 0.4990 (0.4345) acc_x 93.7500 (91.5625) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/18] time 0.337 (0.331) data 0.260 (0.253) loss_x loss_x 0.3752 (0.4063) acc_x 90.6250 (91.8750) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/32] time 0.347 (0.335) data 0.270 (0.257) loss_u loss_u 0.9199 (0.9618) acc_u 9.3750 (3.7500) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [10/32] time 0.337 (0.335) data 0.260 (0.257) loss_u loss_u 0.9541 (0.9575) acc_u 6.2500 (4.6875) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [15/32] time 0.333 (0.336) data 0.255 (0.259) loss_u loss_u 0.8706 (0.9472) acc_u 15.6250 (5.8333) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [20/32] time 0.346 (0.337) data 0.269 (0.259) loss_u loss_u 0.8799 (0.9392) acc_u 15.6250 (6.8750) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [25/32] time 0.337 (0.337) data 0.259 (0.260) loss_u loss_u 0.9834 (0.9456) acc_u 3.1250 (6.2500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [30/32] time 0.355 (0.335) data 0.277 (0.257) loss_u loss_u 0.9409 (0.9458) acc_u 6.2500 (6.1458) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 452
confident_label rate tensor(0.3536, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 577
clean true:500
clean false:77
clean_rate:0.8665511265164645
noisy true:680
noisy false:375
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1055
epoch [90/200] batch [5/18] time 0.360 (0.357) data 0.282 (0.279) loss_x loss_x 0.9727 (0.5288) acc_x 87.5000 (90.6250) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [10/18] time 0.300 (0.346) data 0.222 (0.268) loss_x loss_x 0.2532 (0.4064) acc_x 93.7500 (92.8125) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/18] time 0.358 (0.338) data 0.279 (0.260) loss_x loss_x 0.4702 (0.4049) acc_x 87.5000 (90.6250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [5/32] time 0.334 (0.340) data 0.257 (0.262) loss_u loss_u 0.9727 (0.9432) acc_u 3.1250 (6.8750) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [10/32] time 0.351 (0.337) data 0.273 (0.259) loss_u loss_u 0.9497 (0.9377) acc_u 6.2500 (6.8750) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [15/32] time 0.341 (0.338) data 0.262 (0.260) loss_u loss_u 0.8872 (0.9368) acc_u 12.5000 (7.0833) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [20/32] time 0.334 (0.339) data 0.257 (0.261) loss_u loss_u 0.8950 (0.9365) acc_u 12.5000 (7.1875) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [25/32] time 0.337 (0.339) data 0.260 (0.261) loss_u loss_u 0.9316 (0.9367) acc_u 6.2500 (7.2500) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [30/32] time 0.350 (0.339) data 0.272 (0.261) loss_u loss_u 0.9365 (0.9386) acc_u 6.2500 (6.8750) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.3585, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 585
clean true:503
clean false:82
clean_rate:0.8598290598290599
noisy true:701
noisy false:346
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1047
epoch [91/200] batch [5/18] time 0.329 (0.343) data 0.251 (0.265) loss_x loss_x 0.2479 (0.3758) acc_x 90.6250 (90.6250) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [10/18] time 0.310 (0.340) data 0.231 (0.262) loss_x loss_x 0.1627 (0.3683) acc_x 96.8750 (90.9375) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/18] time 0.342 (0.330) data 0.264 (0.253) loss_x loss_x 0.2412 (0.3910) acc_x 93.7500 (90.4167) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/32] time 0.349 (0.331) data 0.271 (0.253) loss_u loss_u 0.9150 (0.9165) acc_u 9.3750 (10.0000) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [10/32] time 0.330 (0.331) data 0.252 (0.253) loss_u loss_u 0.9897 (0.9313) acc_u 0.0000 (8.1250) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [15/32] time 0.352 (0.333) data 0.275 (0.255) loss_u loss_u 0.8540 (0.9250) acc_u 18.7500 (9.1667) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [20/32] time 0.340 (0.334) data 0.262 (0.256) loss_u loss_u 0.9316 (0.9345) acc_u 9.3750 (7.9688) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [25/32] time 0.356 (0.336) data 0.278 (0.258) loss_u loss_u 0.9302 (0.9390) acc_u 6.2500 (7.2500) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [30/32] time 0.340 (0.336) data 0.261 (0.258) loss_u loss_u 0.8975 (0.9397) acc_u 15.6250 (7.2917) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 436
confident_label rate tensor(0.3621, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 591
clean true:506
clean false:85
clean_rate:0.856175972927242
noisy true:690
noisy false:351
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1041
epoch [92/200] batch [5/18] time 0.349 (0.345) data 0.272 (0.268) loss_x loss_x 0.6182 (0.5031) acc_x 87.5000 (89.3750) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [10/18] time 0.332 (0.343) data 0.254 (0.265) loss_x loss_x 0.4814 (0.4779) acc_x 93.7500 (90.3125) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/18] time 0.307 (0.329) data 0.229 (0.251) loss_x loss_x 0.3152 (0.4257) acc_x 87.5000 (91.0417) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/32] time 0.349 (0.334) data 0.271 (0.256) loss_u loss_u 0.9038 (0.9432) acc_u 12.5000 (6.2500) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [10/32] time 0.341 (0.336) data 0.264 (0.258) loss_u loss_u 0.9243 (0.9447) acc_u 9.3750 (6.8750) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [15/32] time 0.350 (0.338) data 0.273 (0.260) loss_u loss_u 0.9600 (0.9423) acc_u 6.2500 (6.8750) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [20/32] time 0.344 (0.338) data 0.266 (0.260) loss_u loss_u 0.9609 (0.9452) acc_u 3.1250 (5.9375) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [25/32] time 0.346 (0.339) data 0.267 (0.261) loss_u loss_u 0.9556 (0.9479) acc_u 6.2500 (5.7500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [30/32] time 0.328 (0.338) data 0.250 (0.260) loss_u loss_u 0.8618 (0.9424) acc_u 18.7500 (6.6667) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.3634, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 593
clean true:507
clean false:86
clean_rate:0.8549747048903878
noisy true:697
noisy false:342
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1039
epoch [93/200] batch [5/18] time 0.348 (0.343) data 0.270 (0.266) loss_x loss_x 0.3792 (0.2556) acc_x 90.6250 (95.0000) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [10/18] time 0.352 (0.344) data 0.275 (0.266) loss_x loss_x 0.4644 (0.3612) acc_x 84.3750 (91.2500) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/18] time 0.350 (0.346) data 0.272 (0.268) loss_x loss_x 0.3606 (0.3834) acc_x 93.7500 (91.2500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [5/32] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.9609 (0.9345) acc_u 6.2500 (8.7500) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [10/32] time 0.353 (0.345) data 0.275 (0.267) loss_u loss_u 0.9727 (0.9401) acc_u 3.1250 (7.8125) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [15/32] time 0.299 (0.343) data 0.220 (0.265) loss_u loss_u 0.9619 (0.9472) acc_u 3.1250 (6.4583) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [20/32] time 0.328 (0.338) data 0.250 (0.260) loss_u loss_u 0.9150 (0.9392) acc_u 9.3750 (7.6562) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [25/32] time 0.340 (0.338) data 0.261 (0.260) loss_u loss_u 0.8535 (0.9374) acc_u 18.7500 (7.7500) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [30/32] time 0.352 (0.337) data 0.274 (0.259) loss_u loss_u 0.9170 (0.9378) acc_u 9.3750 (7.5000) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 445
confident_label rate tensor(0.3572, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 583
clean true:499
clean false:84
clean_rate:0.855917667238422
noisy true:688
noisy false:361
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1049
epoch [94/200] batch [5/18] time 0.329 (0.332) data 0.252 (0.254) loss_x loss_x 0.5591 (0.6757) acc_x 87.5000 (84.3750) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [10/18] time 0.304 (0.321) data 0.226 (0.243) loss_x loss_x 0.4937 (0.5342) acc_x 87.5000 (87.8125) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/18] time 0.325 (0.321) data 0.248 (0.243) loss_x loss_x 0.4170 (0.4813) acc_x 90.6250 (88.5417) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/32] time 0.343 (0.326) data 0.264 (0.248) loss_u loss_u 0.9189 (0.9364) acc_u 9.3750 (8.1250) lr 1.1253e-03 eta 0:00:08
epoch [94/200] batch [10/32] time 0.331 (0.328) data 0.253 (0.250) loss_u loss_u 0.9438 (0.9312) acc_u 9.3750 (8.1250) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [15/32] time 0.362 (0.330) data 0.285 (0.252) loss_u loss_u 0.9551 (0.9341) acc_u 3.1250 (7.9167) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [20/32] time 0.343 (0.331) data 0.265 (0.254) loss_u loss_u 0.8892 (0.9249) acc_u 15.6250 (9.0625) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [25/32] time 0.332 (0.332) data 0.254 (0.254) loss_u loss_u 0.9219 (0.9278) acc_u 9.3750 (8.5000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [30/32] time 0.345 (0.333) data 0.267 (0.255) loss_u loss_u 0.9868 (0.9331) acc_u 0.0000 (7.8125) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 444
confident_label rate tensor(0.3627, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 592
clean true:502
clean false:90
clean_rate:0.847972972972973
noisy true:686
noisy false:354
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1040
epoch [95/200] batch [5/18] time 0.335 (0.351) data 0.257 (0.273) loss_x loss_x 0.3022 (0.3734) acc_x 93.7500 (91.8750) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/18] time 0.336 (0.343) data 0.259 (0.265) loss_x loss_x 0.1993 (0.3257) acc_x 96.8750 (92.8125) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/18] time 0.302 (0.332) data 0.224 (0.254) loss_x loss_x 0.4536 (0.3465) acc_x 93.7500 (92.2917) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/32] time 0.349 (0.331) data 0.272 (0.253) loss_u loss_u 0.9883 (0.9663) acc_u 3.1250 (4.3750) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [10/32] time 0.334 (0.333) data 0.257 (0.255) loss_u loss_u 0.9990 (0.9628) acc_u 0.0000 (4.6875) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [15/32] time 0.352 (0.334) data 0.274 (0.257) loss_u loss_u 0.9136 (0.9566) acc_u 9.3750 (5.0000) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [20/32] time 0.337 (0.336) data 0.259 (0.258) loss_u loss_u 0.9507 (0.9500) acc_u 3.1250 (5.9375) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [25/32] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9468 (0.9431) acc_u 6.2500 (6.5000) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [30/32] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9717 (0.9426) acc_u 3.1250 (6.5625) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 462
confident_label rate tensor(0.3536, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 577
clean true:493
clean false:84
clean_rate:0.854419410745234
noisy true:677
noisy false:378
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1055
epoch [96/200] batch [5/18] time 0.344 (0.352) data 0.267 (0.274) loss_x loss_x 0.5781 (0.3481) acc_x 84.3750 (91.8750) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/18] time 0.340 (0.348) data 0.261 (0.270) loss_x loss_x 0.1448 (0.3374) acc_x 96.8750 (92.1875) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/18] time 0.344 (0.348) data 0.266 (0.271) loss_x loss_x 0.3896 (0.3453) acc_x 87.5000 (91.2500) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [5/32] time 0.360 (0.339) data 0.280 (0.261) loss_u loss_u 0.9995 (0.9215) acc_u 0.0000 (9.3750) lr 1.0941e-03 eta 0:00:09
epoch [96/200] batch [10/32] time 0.343 (0.341) data 0.265 (0.262) loss_u loss_u 0.8940 (0.9095) acc_u 15.6250 (10.9375) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [15/32] time 0.341 (0.341) data 0.262 (0.263) loss_u loss_u 0.9600 (0.9228) acc_u 6.2500 (9.3750) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [20/32] time 0.345 (0.342) data 0.268 (0.264) loss_u loss_u 0.9321 (0.9332) acc_u 6.2500 (7.9688) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [25/32] time 0.348 (0.343) data 0.270 (0.265) loss_u loss_u 0.9595 (0.9326) acc_u 6.2500 (8.0000) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [30/32] time 0.350 (0.344) data 0.271 (0.266) loss_u loss_u 0.9985 (0.9341) acc_u 0.0000 (7.7083) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 452
confident_label rate tensor(0.3603, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 588
clean true:500
clean false:88
clean_rate:0.8503401360544217
noisy true:680
noisy false:364
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1044
epoch [97/200] batch [5/18] time 0.360 (0.349) data 0.282 (0.272) loss_x loss_x 0.5488 (0.4725) acc_x 90.6250 (91.8750) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [10/18] time 0.355 (0.343) data 0.278 (0.266) loss_x loss_x 0.2710 (0.3801) acc_x 96.8750 (92.8125) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/18] time 0.330 (0.344) data 0.251 (0.266) loss_x loss_x 0.3296 (0.3761) acc_x 93.7500 (92.7083) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [5/32] time 0.303 (0.337) data 0.225 (0.259) loss_u loss_u 0.9565 (0.9516) acc_u 6.2500 (5.6250) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [10/32] time 0.344 (0.339) data 0.266 (0.261) loss_u loss_u 0.9336 (0.9442) acc_u 6.2500 (6.5625) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [15/32] time 0.349 (0.341) data 0.270 (0.263) loss_u loss_u 0.9253 (0.9343) acc_u 9.3750 (7.2917) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [20/32] time 0.349 (0.341) data 0.271 (0.263) loss_u loss_u 0.9492 (0.9386) acc_u 9.3750 (7.0312) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [25/32] time 0.338 (0.341) data 0.260 (0.263) loss_u loss_u 0.9346 (0.9407) acc_u 6.2500 (6.8750) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [30/32] time 0.343 (0.342) data 0.266 (0.264) loss_u loss_u 0.9907 (0.9410) acc_u 3.1250 (6.9792) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 461
confident_label rate tensor(0.3615, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 590
clean true:504
clean false:86
clean_rate:0.8542372881355932
noisy true:667
noisy false:375
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1042
epoch [98/200] batch [5/18] time 0.332 (0.349) data 0.254 (0.271) loss_x loss_x 0.3711 (0.4068) acc_x 93.7500 (93.1250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [10/18] time 0.333 (0.342) data 0.256 (0.264) loss_x loss_x 0.4429 (0.4374) acc_x 90.6250 (91.2500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/18] time 0.322 (0.343) data 0.245 (0.266) loss_x loss_x 0.5103 (0.4509) acc_x 87.5000 (90.0000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [5/32] time 0.298 (0.334) data 0.220 (0.256) loss_u loss_u 0.9751 (0.9665) acc_u 3.1250 (4.3750) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [10/32] time 0.343 (0.335) data 0.264 (0.257) loss_u loss_u 0.9404 (0.9533) acc_u 9.3750 (5.6250) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [15/32] time 0.347 (0.336) data 0.269 (0.257) loss_u loss_u 0.9155 (0.9425) acc_u 9.3750 (7.0833) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [20/32] time 0.358 (0.337) data 0.280 (0.259) loss_u loss_u 0.9419 (0.9379) acc_u 6.2500 (7.5000) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [25/32] time 0.353 (0.338) data 0.275 (0.260) loss_u loss_u 0.9688 (0.9359) acc_u 6.2500 (8.0000) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [30/32] time 0.334 (0.339) data 0.256 (0.261) loss_u loss_u 0.9937 (0.9401) acc_u 0.0000 (7.5000) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 429
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 598
clean true:510
clean false:88
clean_rate:0.8528428093645485
noisy true:693
noisy false:341
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1034
epoch [99/200] batch [5/18] time 0.344 (0.344) data 0.267 (0.267) loss_x loss_x 0.2964 (0.3589) acc_x 93.7500 (91.8750) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/18] time 0.329 (0.344) data 0.252 (0.266) loss_x loss_x 0.8901 (0.4568) acc_x 78.1250 (89.0625) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/18] time 0.349 (0.345) data 0.271 (0.268) loss_x loss_x 0.3840 (0.4642) acc_x 93.7500 (89.1667) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [5/32] time 0.299 (0.340) data 0.221 (0.263) loss_u loss_u 0.9243 (0.9422) acc_u 9.3750 (6.8750) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [10/32] time 0.376 (0.341) data 0.298 (0.263) loss_u loss_u 0.9468 (0.9479) acc_u 6.2500 (6.2500) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [15/32] time 0.349 (0.342) data 0.271 (0.264) loss_u loss_u 0.9546 (0.9521) acc_u 3.1250 (5.6250) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [20/32] time 0.350 (0.343) data 0.273 (0.265) loss_u loss_u 0.9600 (0.9545) acc_u 3.1250 (5.3125) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [25/32] time 0.337 (0.343) data 0.259 (0.266) loss_u loss_u 0.9531 (0.9491) acc_u 9.3750 (6.0000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [30/32] time 0.350 (0.344) data 0.271 (0.266) loss_u loss_u 0.9521 (0.9464) acc_u 3.1250 (6.2500) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 430
confident_label rate tensor(0.3585, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 585
clean true:502
clean false:83
clean_rate:0.8581196581196581
noisy true:700
noisy false:347
all clean rate:  [0.9591836734693877, 0.9719101123595506, 0.9848024316109423, 0.9769452449567724, 0.9887640449438202, 0.9860724233983287, 0.9942363112391931, 0.9854651162790697, 0.9837837837837838, 0.9921259842519685, 0.976063829787234, 0.9870801033591732, 0.9746192893401016, 0.9759036144578314, 0.9730392156862745, 0.9805825242718447, 0.9834905660377359, 0.9750566893424036, 0.9647887323943662, 0.9703196347031964, 0.954248366013072, 0.9508196721311475, 0.944206008583691, 0.9416846652267818, 0.9612068965517241, 0.9445628997867804, 0.954070981210856, 0.9498956158663883, 0.941908713692946, 0.9166666666666666, 0.9337349397590361, 0.9257731958762887, 0.9203187250996016, 0.9041916167664671, 0.9153543307086615, 0.9165009940357853, 0.9022988505747126, 0.9090909090909091, 0.9266409266409267, 0.913894324853229, 0.8938547486033519, 0.9011627906976745, 0.8828996282527881, 0.8964879852125693, 0.8874045801526718, 0.8872727272727273, 0.8907407407407407, 0.8943533697632058, 0.8772893772893773, 0.8822429906542056, 0.8834244080145719, 0.8793418647166362, 0.8895131086142322, 0.8836363636363637, 0.8934579439252337, 0.874113475177305, 0.8836363636363637, 0.8925318761384335, 0.8701067615658363, 0.8684684684684685, 0.8837209302325582, 0.8774422735346359, 0.8955752212389381, 0.8857142857142857, 0.8820326678765881, 0.8884892086330936, 0.8842832469775475, 0.8803571428571428, 0.8649122807017544, 0.8830715532286213, 0.870242214532872, 0.8773747841105354, 0.8697916666666666, 0.8745583038869258, 0.8743362831858407, 0.8660714285714286, 0.8670212765957447, 0.8650519031141869, 0.8773424190800682, 0.8730964467005076, 0.8723776223776224, 0.8689655172413793, 0.8657487091222031, 0.8611111111111112, 0.8541666666666666, 0.884083044982699, 0.865979381443299, 0.8531468531468531, 0.8700854700854701, 0.8665511265164645, 0.8598290598290599, 0.856175972927242, 0.8549747048903878, 0.855917667238422, 0.847972972972973, 0.854419410745234, 0.8503401360544217, 0.8542372881355932, 0.8528428093645485, 0.8581196581196581]
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1047
epoch [100/200] batch [5/18] time 0.331 (0.344) data 0.253 (0.266) loss_x loss_x 0.3687 (0.3218) acc_x 90.6250 (93.1250) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [10/18] time 0.341 (0.333) data 0.264 (0.255) loss_x loss_x 0.5352 (0.4077) acc_x 81.2500 (88.4375) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/18] time 0.351 (0.336) data 0.274 (0.258) loss_x loss_x 0.2654 (0.3754) acc_x 93.7500 (90.2083) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [5/32] time 0.345 (0.329) data 0.267 (0.251) loss_u loss_u 0.9834 (0.9549) acc_u 3.1250 (5.0000) lr 1.0314e-03 eta 0:00:08
epoch [100/200] batch [10/32] time 0.346 (0.332) data 0.268 (0.254) loss_u loss_u 0.9038 (0.9446) acc_u 12.5000 (6.2500) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [15/32] time 0.352 (0.334) data 0.274 (0.256) loss_u loss_u 0.9927 (0.9494) acc_u 0.0000 (5.6250) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [20/32] time 0.339 (0.337) data 0.262 (0.259) loss_u loss_u 0.9272 (0.9484) acc_u 12.5000 (6.0938) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [25/32] time 0.335 (0.337) data 0.258 (0.259) loss_u loss_u 0.9375 (0.9453) acc_u 6.2500 (6.5000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [30/32] time 0.363 (0.337) data 0.285 (0.260) loss_u loss_u 0.8823 (0.9399) acc_u 12.5000 (7.0833) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 439
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 598
clean true:509
clean false:89
clean_rate:0.8511705685618729
noisy true:684
noisy false:350
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1034
epoch [101/200] batch [5/18] time 0.340 (0.351) data 0.263 (0.274) loss_x loss_x 0.2394 (0.4075) acc_x 96.8750 (89.3750) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/18] time 0.344 (0.347) data 0.266 (0.270) loss_x loss_x 0.2461 (0.3695) acc_x 93.7500 (89.6875) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/18] time 0.335 (0.344) data 0.258 (0.266) loss_x loss_x 0.5522 (0.3910) acc_x 87.5000 (89.7917) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [5/32] time 0.301 (0.334) data 0.223 (0.256) loss_u loss_u 0.9570 (0.9563) acc_u 3.1250 (4.3750) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [10/32] time 0.353 (0.336) data 0.275 (0.258) loss_u loss_u 0.9082 (0.9424) acc_u 9.3750 (5.9375) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [15/32] time 0.342 (0.338) data 0.264 (0.260) loss_u loss_u 0.8975 (0.9397) acc_u 12.5000 (6.4583) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [20/32] time 0.348 (0.338) data 0.269 (0.261) loss_u loss_u 0.9595 (0.9395) acc_u 3.1250 (6.7188) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [25/32] time 0.396 (0.341) data 0.317 (0.263) loss_u loss_u 0.9775 (0.9394) acc_u 3.1250 (6.6250) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [30/32] time 0.329 (0.341) data 0.250 (0.263) loss_u loss_u 0.9731 (0.9418) acc_u 3.1250 (6.2500) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.3615, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 590
clean true:496
clean false:94
clean_rate:0.8406779661016949
noisy true:664
noisy false:378
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1042
epoch [102/200] batch [5/18] time 0.341 (0.351) data 0.263 (0.273) loss_x loss_x 0.4634 (0.3599) acc_x 90.6250 (94.3750) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/18] time 0.337 (0.347) data 0.258 (0.269) loss_x loss_x 0.2869 (0.4259) acc_x 93.7500 (92.5000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/18] time 0.341 (0.346) data 0.264 (0.268) loss_x loss_x 0.3530 (0.4235) acc_x 93.7500 (91.2500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [5/32] time 0.308 (0.339) data 0.229 (0.261) loss_u loss_u 0.9531 (0.9634) acc_u 6.2500 (5.0000) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [10/32] time 0.351 (0.338) data 0.274 (0.260) loss_u loss_u 0.9434 (0.9518) acc_u 6.2500 (7.5000) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [15/32] time 0.351 (0.338) data 0.272 (0.260) loss_u loss_u 0.9541 (0.9502) acc_u 6.2500 (7.2917) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [20/32] time 0.337 (0.338) data 0.260 (0.260) loss_u loss_u 0.9561 (0.9429) acc_u 3.1250 (7.5000) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [25/32] time 0.360 (0.340) data 0.281 (0.262) loss_u loss_u 0.9263 (0.9388) acc_u 9.3750 (7.7500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [30/32] time 0.339 (0.340) data 0.262 (0.262) loss_u loss_u 0.9453 (0.9395) acc_u 6.2500 (7.5000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 444
confident_label rate tensor(0.3615, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 590
clean true:509
clean false:81
clean_rate:0.8627118644067797
noisy true:679
noisy false:363
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1042
epoch [103/200] batch [5/18] time 0.347 (0.350) data 0.269 (0.272) loss_x loss_x 0.3066 (0.3927) acc_x 90.6250 (90.0000) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [10/18] time 0.360 (0.348) data 0.283 (0.270) loss_x loss_x 0.4001 (0.4044) acc_x 90.6250 (89.0625) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/18] time 0.328 (0.344) data 0.250 (0.266) loss_x loss_x 0.3594 (0.4244) acc_x 93.7500 (88.5417) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [5/32] time 0.296 (0.335) data 0.217 (0.257) loss_u loss_u 0.9985 (0.9732) acc_u 0.0000 (3.1250) lr 9.8429e-04 eta 0:00:09
epoch [103/200] batch [10/32] time 0.362 (0.335) data 0.284 (0.257) loss_u loss_u 0.9355 (0.9550) acc_u 6.2500 (5.3125) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [15/32] time 0.349 (0.337) data 0.272 (0.260) loss_u loss_u 0.8994 (0.9419) acc_u 12.5000 (6.4583) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [20/32] time 0.345 (0.339) data 0.268 (0.261) loss_u loss_u 0.9209 (0.9437) acc_u 6.2500 (6.2500) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [25/32] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.8809 (0.9371) acc_u 12.5000 (7.0000) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [30/32] time 0.341 (0.339) data 0.263 (0.261) loss_u loss_u 0.9629 (0.9388) acc_u 3.1250 (6.9792) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 440
confident_label rate tensor(0.3640, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 594
clean true:506
clean false:88
clean_rate:0.8518518518518519
noisy true:686
noisy false:352
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1038
epoch [104/200] batch [5/18] time 0.339 (0.346) data 0.261 (0.269) loss_x loss_x 0.5840 (0.5218) acc_x 84.3750 (88.7500) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/18] time 0.344 (0.342) data 0.267 (0.265) loss_x loss_x 0.1709 (0.4481) acc_x 96.8750 (89.6875) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/18] time 0.347 (0.343) data 0.270 (0.265) loss_x loss_x 0.4236 (0.4250) acc_x 84.3750 (89.7917) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [5/32] time 0.311 (0.338) data 0.233 (0.260) loss_u loss_u 0.9683 (0.9554) acc_u 3.1250 (5.0000) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [10/32] time 0.341 (0.337) data 0.264 (0.260) loss_u loss_u 0.9502 (0.9404) acc_u 6.2500 (6.8750) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [15/32] time 0.340 (0.338) data 0.261 (0.261) loss_u loss_u 0.9233 (0.9448) acc_u 6.2500 (6.0417) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [20/32] time 0.342 (0.339) data 0.263 (0.261) loss_u loss_u 0.9536 (0.9395) acc_u 6.2500 (6.8750) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [25/32] time 0.337 (0.340) data 0.259 (0.262) loss_u loss_u 0.9326 (0.9350) acc_u 9.3750 (7.5000) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [30/32] time 0.340 (0.339) data 0.261 (0.262) loss_u loss_u 0.9502 (0.9362) acc_u 6.2500 (7.2917) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 462
confident_label rate tensor(0.3701, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 604
clean true:507
clean false:97
clean_rate:0.8394039735099338
noisy true:663
noisy false:365
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1028
epoch [105/200] batch [5/18] time 0.346 (0.348) data 0.269 (0.271) loss_x loss_x 0.2502 (0.4129) acc_x 93.7500 (88.7500) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/18] time 0.345 (0.343) data 0.267 (0.266) loss_x loss_x 0.1483 (0.4008) acc_x 96.8750 (89.3750) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/18] time 0.326 (0.342) data 0.248 (0.264) loss_x loss_x 0.6382 (0.4425) acc_x 81.2500 (88.3333) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [5/32] time 0.290 (0.334) data 0.213 (0.257) loss_u loss_u 0.9487 (0.9561) acc_u 6.2500 (5.6250) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [10/32] time 0.335 (0.330) data 0.257 (0.252) loss_u loss_u 0.9585 (0.9519) acc_u 0.0000 (5.6250) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [15/32] time 0.293 (0.329) data 0.216 (0.251) loss_u loss_u 0.9468 (0.9479) acc_u 6.2500 (6.0417) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [20/32] time 0.345 (0.331) data 0.267 (0.253) loss_u loss_u 0.8984 (0.9460) acc_u 12.5000 (6.5625) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [25/32] time 0.336 (0.333) data 0.258 (0.256) loss_u loss_u 0.9536 (0.9499) acc_u 3.1250 (5.7500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [30/32] time 0.341 (0.335) data 0.263 (0.257) loss_u loss_u 0.9746 (0.9511) acc_u 6.2500 (5.6250) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 439
confident_label rate tensor(0.3597, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 587
clean true:508
clean false:79
clean_rate:0.8654173764906303
noisy true:685
noisy false:360
after delete: len(clean_dataset) 587
after delete: len(noisy_dataset) 1045
epoch [106/200] batch [5/18] time 0.337 (0.345) data 0.259 (0.268) loss_x loss_x 0.5649 (0.4845) acc_x 90.6250 (89.3750) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [10/18] time 0.306 (0.339) data 0.229 (0.261) loss_x loss_x 0.2366 (0.4322) acc_x 93.7500 (90.3125) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/18] time 0.345 (0.335) data 0.267 (0.257) loss_x loss_x 0.2209 (0.3870) acc_x 93.7500 (91.2500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [5/32] time 0.359 (0.342) data 0.280 (0.264) loss_u loss_u 0.9199 (0.9555) acc_u 6.2500 (3.7500) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [10/32] time 0.302 (0.335) data 0.223 (0.257) loss_u loss_u 0.8887 (0.9496) acc_u 12.5000 (5.6250) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [15/32] time 0.344 (0.335) data 0.266 (0.257) loss_u loss_u 0.9209 (0.9431) acc_u 9.3750 (6.4583) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [20/32] time 0.325 (0.335) data 0.247 (0.257) loss_u loss_u 0.9028 (0.9390) acc_u 12.5000 (7.0312) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [25/32] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9614 (0.9389) acc_u 3.1250 (7.0000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [30/32] time 0.350 (0.337) data 0.273 (0.259) loss_u loss_u 0.9165 (0.9371) acc_u 6.2500 (7.0833) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.3732, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 609
clean true:522
clean false:87
clean_rate:0.8571428571428571
noisy true:682
noisy false:341
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1023
epoch [107/200] batch [5/19] time 0.342 (0.353) data 0.264 (0.275) loss_x loss_x 0.4817 (0.4126) acc_x 87.5000 (88.1250) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [10/19] time 0.346 (0.351) data 0.268 (0.274) loss_x loss_x 0.3252 (0.3426) acc_x 90.6250 (90.9375) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [15/19] time 0.346 (0.347) data 0.269 (0.270) loss_x loss_x 0.1382 (0.3179) acc_x 100.0000 (92.2917) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [5/31] time 0.316 (0.345) data 0.237 (0.267) loss_u loss_u 0.9111 (0.9542) acc_u 9.3750 (5.0000) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [10/31] time 0.308 (0.339) data 0.231 (0.262) loss_u loss_u 0.9385 (0.9553) acc_u 6.2500 (4.6875) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [15/31] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9043 (0.9538) acc_u 9.3750 (4.7917) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [20/31] time 0.344 (0.341) data 0.266 (0.263) loss_u loss_u 0.9312 (0.9499) acc_u 9.3750 (5.3125) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [25/31] time 0.337 (0.341) data 0.259 (0.263) loss_u loss_u 0.9600 (0.9468) acc_u 3.1250 (5.5000) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [30/31] time 0.348 (0.342) data 0.269 (0.264) loss_u loss_u 0.9795 (0.9508) acc_u 3.1250 (5.1042) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 423
confident_label rate tensor(0.3621, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 591
clean true:508
clean false:83
clean_rate:0.8595600676818951
noisy true:701
noisy false:340
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1041
epoch [108/200] batch [5/18] time 0.338 (0.352) data 0.260 (0.274) loss_x loss_x 0.4832 (0.4329) acc_x 81.2500 (90.6250) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [10/18] time 0.345 (0.347) data 0.268 (0.269) loss_x loss_x 0.2056 (0.4149) acc_x 100.0000 (90.9375) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/18] time 0.351 (0.344) data 0.274 (0.266) loss_x loss_x 0.4282 (0.4058) acc_x 96.8750 (91.6667) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [5/32] time 0.336 (0.341) data 0.258 (0.264) loss_u loss_u 0.9141 (0.9394) acc_u 9.3750 (6.8750) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [10/32] time 0.370 (0.339) data 0.293 (0.262) loss_u loss_u 0.9238 (0.9286) acc_u 12.5000 (8.7500) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [15/32] time 0.355 (0.339) data 0.277 (0.261) loss_u loss_u 0.9434 (0.9340) acc_u 3.1250 (7.7083) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [20/32] time 0.342 (0.340) data 0.263 (0.262) loss_u loss_u 0.9429 (0.9395) acc_u 6.2500 (7.1875) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [25/32] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9927 (0.9403) acc_u 0.0000 (7.0000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [30/32] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9116 (0.9353) acc_u 9.3750 (7.5000) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 447
confident_label rate tensor(0.3732, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 609
clean true:518
clean false:91
clean_rate:0.8505747126436781
noisy true:667
noisy false:356
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1023
epoch [109/200] batch [5/19] time 0.332 (0.347) data 0.254 (0.269) loss_x loss_x 0.2349 (0.5892) acc_x 93.7500 (84.3750) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [10/19] time 0.340 (0.344) data 0.262 (0.266) loss_x loss_x 0.4424 (0.5127) acc_x 90.6250 (86.5625) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [15/19] time 0.345 (0.346) data 0.268 (0.269) loss_x loss_x 0.3889 (0.4868) acc_x 93.7500 (87.5000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [5/31] time 0.301 (0.338) data 0.222 (0.260) loss_u loss_u 0.9497 (0.9564) acc_u 9.3750 (5.0000) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [10/31] time 0.347 (0.337) data 0.269 (0.259) loss_u loss_u 0.9268 (0.9452) acc_u 6.2500 (6.2500) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [15/31] time 0.348 (0.339) data 0.270 (0.261) loss_u loss_u 0.9531 (0.9434) acc_u 6.2500 (6.4583) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [20/31] time 0.347 (0.340) data 0.269 (0.262) loss_u loss_u 0.8735 (0.9438) acc_u 15.6250 (6.4062) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [25/31] time 0.347 (0.340) data 0.269 (0.262) loss_u loss_u 0.9712 (0.9481) acc_u 3.1250 (5.8750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [30/31] time 0.341 (0.341) data 0.264 (0.263) loss_u loss_u 0.9941 (0.9503) acc_u 0.0000 (5.7292) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 437
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 598
clean true:509
clean false:89
clean_rate:0.8511705685618729
noisy true:686
noisy false:348
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1034
epoch [110/200] batch [5/18] time 0.348 (0.349) data 0.270 (0.271) loss_x loss_x 0.4492 (0.4323) acc_x 84.3750 (88.7500) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/18] time 0.332 (0.345) data 0.255 (0.267) loss_x loss_x 0.4419 (0.3802) acc_x 93.7500 (91.5625) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/18] time 0.329 (0.347) data 0.252 (0.269) loss_x loss_x 0.4893 (0.3967) acc_x 87.5000 (90.4167) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [5/32] time 0.361 (0.345) data 0.283 (0.267) loss_u loss_u 0.9507 (0.9357) acc_u 6.2500 (6.8750) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [10/32] time 0.338 (0.345) data 0.260 (0.267) loss_u loss_u 0.9692 (0.9532) acc_u 3.1250 (4.6875) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [15/32] time 0.341 (0.344) data 0.263 (0.266) loss_u loss_u 0.9604 (0.9453) acc_u 6.2500 (5.6250) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [20/32] time 0.340 (0.344) data 0.262 (0.266) loss_u loss_u 0.9736 (0.9455) acc_u 3.1250 (5.9375) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [25/32] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.9219 (0.9434) acc_u 9.3750 (6.6250) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [30/32] time 0.342 (0.342) data 0.264 (0.264) loss_u loss_u 0.9316 (0.9441) acc_u 9.3750 (6.3542) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 437
confident_label rate tensor(0.3646, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 595
clean true:503
clean false:92
clean_rate:0.8453781512605042
noisy true:692
noisy false:345
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1037
epoch [111/200] batch [5/18] time 0.341 (0.349) data 0.263 (0.272) loss_x loss_x 0.4902 (0.4520) acc_x 81.2500 (90.0000) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/18] time 0.357 (0.345) data 0.280 (0.268) loss_x loss_x 0.2168 (0.4060) acc_x 93.7500 (90.9375) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/18] time 0.331 (0.346) data 0.252 (0.269) loss_x loss_x 0.3042 (0.3796) acc_x 90.6250 (90.8333) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [5/32] time 0.351 (0.347) data 0.273 (0.269) loss_u loss_u 0.9077 (0.9346) acc_u 12.5000 (6.8750) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [10/32] time 0.329 (0.344) data 0.251 (0.267) loss_u loss_u 0.9468 (0.9331) acc_u 6.2500 (7.1875) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [15/32] time 0.360 (0.345) data 0.282 (0.267) loss_u loss_u 0.9419 (0.9384) acc_u 6.2500 (7.2917) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [20/32] time 0.350 (0.346) data 0.271 (0.268) loss_u loss_u 0.9629 (0.9391) acc_u 3.1250 (7.0312) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [25/32] time 0.349 (0.347) data 0.271 (0.269) loss_u loss_u 0.9595 (0.9401) acc_u 3.1250 (6.8750) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [30/32] time 0.349 (0.347) data 0.272 (0.269) loss_u loss_u 0.9448 (0.9380) acc_u 6.2500 (6.9792) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 418
confident_label rate tensor(0.3695, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 603
clean true:520
clean false:83
clean_rate:0.8623548922056384
noisy true:694
noisy false:335
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1029
epoch [112/200] batch [5/18] time 0.325 (0.329) data 0.247 (0.251) loss_x loss_x 0.2217 (0.3547) acc_x 96.8750 (93.7500) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/18] time 0.347 (0.334) data 0.269 (0.256) loss_x loss_x 0.4543 (0.3786) acc_x 90.6250 (91.8750) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/18] time 0.330 (0.339) data 0.253 (0.261) loss_x loss_x 0.3230 (0.3669) acc_x 90.6250 (91.8750) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [5/32] time 0.351 (0.342) data 0.273 (0.264) loss_u loss_u 0.9805 (0.9546) acc_u 3.1250 (4.3750) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [10/32] time 0.352 (0.344) data 0.274 (0.266) loss_u loss_u 0.9561 (0.9494) acc_u 6.2500 (5.6250) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [15/32] time 0.344 (0.344) data 0.266 (0.266) loss_u loss_u 0.9204 (0.9456) acc_u 9.3750 (6.8750) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [20/32] time 0.347 (0.344) data 0.268 (0.266) loss_u loss_u 0.9800 (0.9441) acc_u 3.1250 (6.8750) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [25/32] time 0.341 (0.344) data 0.263 (0.266) loss_u loss_u 0.8916 (0.9440) acc_u 12.5000 (6.8750) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [30/32] time 0.327 (0.344) data 0.249 (0.266) loss_u loss_u 0.9248 (0.9421) acc_u 6.2500 (6.9792) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 407
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 606
clean true:524
clean false:82
clean_rate:0.8646864686468647
noisy true:701
noisy false:325
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1026
epoch [113/200] batch [5/18] time 0.308 (0.333) data 0.229 (0.255) loss_x loss_x 0.1982 (0.3432) acc_x 96.8750 (91.8750) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/18] time 0.341 (0.329) data 0.264 (0.251) loss_x loss_x 0.3508 (0.3529) acc_x 90.6250 (91.2500) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/18] time 0.339 (0.335) data 0.261 (0.257) loss_x loss_x 0.6118 (0.3712) acc_x 84.3750 (91.4583) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [5/32] time 0.344 (0.337) data 0.266 (0.259) loss_u loss_u 0.9219 (0.9290) acc_u 9.3750 (9.3750) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [10/32] time 0.339 (0.339) data 0.261 (0.261) loss_u loss_u 0.9258 (0.9324) acc_u 6.2500 (8.1250) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [15/32] time 0.346 (0.340) data 0.268 (0.262) loss_u loss_u 0.9688 (0.9402) acc_u 3.1250 (7.0833) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [20/32] time 0.356 (0.342) data 0.277 (0.264) loss_u loss_u 0.9893 (0.9386) acc_u 3.1250 (7.3438) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [25/32] time 0.339 (0.344) data 0.261 (0.266) loss_u loss_u 0.8872 (0.9378) acc_u 12.5000 (7.5000) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [30/32] time 0.302 (0.343) data 0.224 (0.265) loss_u loss_u 0.9409 (0.9375) acc_u 6.2500 (7.3958) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 403
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 606
clean true:523
clean false:83
clean_rate:0.863036303630363
noisy true:706
noisy false:320
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1026
epoch [114/200] batch [5/18] time 0.347 (0.345) data 0.270 (0.268) loss_x loss_x 0.4058 (0.4179) acc_x 90.6250 (90.6250) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/18] time 0.356 (0.347) data 0.278 (0.269) loss_x loss_x 0.2100 (0.3829) acc_x 96.8750 (92.1875) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/18] time 0.355 (0.346) data 0.278 (0.269) loss_x loss_x 0.4753 (0.3559) acc_x 78.1250 (92.0833) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [5/32] time 0.343 (0.343) data 0.265 (0.266) loss_u loss_u 0.9990 (0.9546) acc_u 0.0000 (5.6250) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [10/32] time 0.347 (0.342) data 0.269 (0.264) loss_u loss_u 0.9380 (0.9537) acc_u 6.2500 (5.3125) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [15/32] time 0.354 (0.343) data 0.276 (0.266) loss_u loss_u 0.9780 (0.9451) acc_u 3.1250 (6.2500) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [20/32] time 0.342 (0.343) data 0.264 (0.265) loss_u loss_u 0.8052 (0.9344) acc_u 21.8750 (7.8125) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [25/32] time 0.343 (0.343) data 0.265 (0.265) loss_u loss_u 0.9092 (0.9379) acc_u 9.3750 (7.5000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [30/32] time 0.296 (0.343) data 0.217 (0.265) loss_u loss_u 0.9722 (0.9407) acc_u 3.1250 (7.0833) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 401
confident_label rate tensor(0.3768, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 615
clean true:529
clean false:86
clean_rate:0.8601626016260162
noisy true:702
noisy false:315
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1017
epoch [115/200] batch [5/19] time 0.337 (0.348) data 0.259 (0.270) loss_x loss_x 0.4641 (0.4933) acc_x 87.5000 (86.2500) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/19] time 0.341 (0.355) data 0.264 (0.277) loss_x loss_x 0.6177 (0.4693) acc_x 84.3750 (87.8125) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [15/19] time 0.348 (0.351) data 0.270 (0.273) loss_x loss_x 0.1361 (0.4155) acc_x 100.0000 (89.5833) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [5/31] time 0.346 (0.348) data 0.268 (0.270) loss_u loss_u 0.9224 (0.9400) acc_u 9.3750 (7.5000) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [10/31] time 0.345 (0.349) data 0.268 (0.271) loss_u loss_u 0.9683 (0.9501) acc_u 3.1250 (6.2500) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [15/31] time 0.370 (0.350) data 0.292 (0.273) loss_u loss_u 0.9717 (0.9470) acc_u 3.1250 (6.2500) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [20/31] time 0.349 (0.351) data 0.270 (0.273) loss_u loss_u 0.8813 (0.9422) acc_u 15.6250 (6.8750) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [25/31] time 0.346 (0.350) data 0.267 (0.272) loss_u loss_u 0.8730 (0.9416) acc_u 15.6250 (6.8750) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [30/31] time 0.293 (0.347) data 0.214 (0.269) loss_u loss_u 0.9380 (0.9446) acc_u 3.1250 (6.2500) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 412
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 598
clean true:515
clean false:83
clean_rate:0.8612040133779264
noisy true:705
noisy false:329
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1034
epoch [116/200] batch [5/18] time 0.341 (0.350) data 0.264 (0.272) loss_x loss_x 0.5713 (0.4156) acc_x 90.6250 (90.0000) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [10/18] time 0.337 (0.346) data 0.259 (0.269) loss_x loss_x 0.1895 (0.3863) acc_x 96.8750 (90.9375) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/18] time 0.332 (0.343) data 0.255 (0.265) loss_x loss_x 0.5566 (0.3790) acc_x 87.5000 (90.8333) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [5/32] time 0.350 (0.346) data 0.273 (0.268) loss_u loss_u 0.9614 (0.9271) acc_u 6.2500 (8.7500) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [10/32] time 0.332 (0.345) data 0.254 (0.267) loss_u loss_u 0.9678 (0.9374) acc_u 3.1250 (7.5000) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [15/32] time 0.338 (0.345) data 0.261 (0.267) loss_u loss_u 0.8301 (0.9321) acc_u 18.7500 (7.9167) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [20/32] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.9634 (0.9381) acc_u 3.1250 (7.0312) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [25/32] time 0.356 (0.345) data 0.278 (0.267) loss_u loss_u 0.9507 (0.9384) acc_u 3.1250 (7.1250) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [30/32] time 0.303 (0.343) data 0.224 (0.265) loss_u loss_u 0.9092 (0.9373) acc_u 12.5000 (7.1875) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 400
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 610
clean true:521
clean false:89
clean_rate:0.8540983606557377
noisy true:711
noisy false:311
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1022
epoch [117/200] batch [5/19] time 0.343 (0.354) data 0.265 (0.277) loss_x loss_x 0.2457 (0.3758) acc_x 93.7500 (91.8750) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [10/19] time 0.342 (0.346) data 0.264 (0.269) loss_x loss_x 0.1827 (0.3590) acc_x 96.8750 (91.5625) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [15/19] time 0.352 (0.344) data 0.275 (0.267) loss_x loss_x 0.4294 (0.3629) acc_x 87.5000 (91.2500) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [5/31] time 0.342 (0.345) data 0.264 (0.267) loss_u loss_u 0.8574 (0.9301) acc_u 15.6250 (8.1250) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [10/31] time 0.344 (0.345) data 0.266 (0.267) loss_u loss_u 0.9731 (0.9406) acc_u 3.1250 (6.8750) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [15/31] time 0.344 (0.346) data 0.266 (0.268) loss_u loss_u 0.9302 (0.9382) acc_u 9.3750 (7.5000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [20/31] time 0.351 (0.346) data 0.273 (0.268) loss_u loss_u 0.9541 (0.9339) acc_u 6.2500 (7.9688) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [25/31] time 0.370 (0.346) data 0.292 (0.269) loss_u loss_u 0.9648 (0.9398) acc_u 6.2500 (7.5000) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [30/31] time 0.292 (0.343) data 0.214 (0.265) loss_u loss_u 0.9570 (0.9427) acc_u 3.1250 (7.1875) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 441
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 599
clean true:511
clean false:88
clean_rate:0.8530884808013356
noisy true:680
noisy false:353
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1033
epoch [118/200] batch [5/18] time 0.346 (0.352) data 0.269 (0.274) loss_x loss_x 0.3489 (0.3572) acc_x 84.3750 (90.0000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/18] time 0.349 (0.350) data 0.272 (0.272) loss_x loss_x 0.3857 (0.3502) acc_x 90.6250 (90.3125) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/18] time 0.352 (0.342) data 0.275 (0.264) loss_x loss_x 0.2839 (0.3491) acc_x 96.8750 (90.8333) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [5/32] time 0.347 (0.343) data 0.269 (0.266) loss_u loss_u 0.9097 (0.9342) acc_u 12.5000 (8.7500) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [10/32] time 0.336 (0.343) data 0.259 (0.266) loss_u loss_u 0.9487 (0.9371) acc_u 6.2500 (8.1250) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [15/32] time 0.324 (0.343) data 0.247 (0.265) loss_u loss_u 0.9824 (0.9424) acc_u 3.1250 (7.2917) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [20/32] time 0.335 (0.343) data 0.257 (0.265) loss_u loss_u 0.9688 (0.9384) acc_u 3.1250 (7.5000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [25/32] time 0.331 (0.344) data 0.254 (0.266) loss_u loss_u 0.9258 (0.9312) acc_u 6.2500 (8.0000) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [30/32] time 0.294 (0.340) data 0.215 (0.263) loss_u loss_u 0.9443 (0.9307) acc_u 9.3750 (8.1250) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 414
confident_label rate tensor(0.3799, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 620
clean true:526
clean false:94
clean_rate:0.8483870967741935
noisy true:692
noisy false:320
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 1012
epoch [119/200] batch [5/19] time 0.352 (0.358) data 0.274 (0.281) loss_x loss_x 0.1199 (0.2995) acc_x 100.0000 (94.3750) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [10/19] time 0.327 (0.350) data 0.249 (0.273) loss_x loss_x 0.4436 (0.3038) acc_x 90.6250 (93.1250) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [15/19] time 0.345 (0.348) data 0.268 (0.271) loss_x loss_x 0.2205 (0.3035) acc_x 96.8750 (93.7500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [5/31] time 0.331 (0.347) data 0.252 (0.269) loss_u loss_u 0.8423 (0.9446) acc_u 18.7500 (6.2500) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [10/31] time 0.342 (0.347) data 0.264 (0.269) loss_u loss_u 0.9741 (0.9582) acc_u 3.1250 (4.6875) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [15/31] time 0.335 (0.346) data 0.257 (0.268) loss_u loss_u 0.8960 (0.9498) acc_u 12.5000 (6.0417) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [20/31] time 0.330 (0.345) data 0.252 (0.267) loss_u loss_u 0.9941 (0.9449) acc_u 0.0000 (6.7188) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [25/31] time 0.321 (0.343) data 0.243 (0.266) loss_u loss_u 0.9927 (0.9463) acc_u 0.0000 (6.5000) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [30/31] time 0.301 (0.339) data 0.223 (0.261) loss_u loss_u 0.9419 (0.9479) acc_u 9.3750 (6.3542) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 422
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 610
clean true:525
clean false:85
clean_rate:0.860655737704918
noisy true:685
noisy false:337
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1022
epoch [120/200] batch [5/19] time 0.353 (0.314) data 0.276 (0.237) loss_x loss_x 0.5454 (0.4969) acc_x 84.3750 (88.1250) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/19] time 0.361 (0.330) data 0.283 (0.252) loss_x loss_x 0.3279 (0.4134) acc_x 93.7500 (90.6250) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/19] time 0.344 (0.334) data 0.267 (0.256) loss_x loss_x 0.3486 (0.3761) acc_x 90.6250 (92.0833) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [5/31] time 0.351 (0.338) data 0.272 (0.260) loss_u loss_u 0.9326 (0.9411) acc_u 6.2500 (6.8750) lr 7.2101e-04 eta 0:00:08
epoch [120/200] batch [10/31] time 0.338 (0.338) data 0.260 (0.260) loss_u loss_u 0.9595 (0.9430) acc_u 6.2500 (6.8750) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [15/31] time 0.336 (0.338) data 0.258 (0.260) loss_u loss_u 0.9663 (0.9456) acc_u 3.1250 (6.6667) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [20/31] time 0.355 (0.338) data 0.277 (0.261) loss_u loss_u 0.8618 (0.9399) acc_u 15.6250 (7.3438) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [25/31] time 0.339 (0.338) data 0.261 (0.260) loss_u loss_u 0.9966 (0.9437) acc_u 0.0000 (6.7500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [30/31] time 0.362 (0.338) data 0.284 (0.260) loss_u loss_u 0.8823 (0.9431) acc_u 12.5000 (6.7708) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 393
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 599
clean true:522
clean false:77
clean_rate:0.8714524207011686
noisy true:717
noisy false:316
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1033
epoch [121/200] batch [5/18] time 0.346 (0.325) data 0.268 (0.247) loss_x loss_x 0.4929 (0.3670) acc_x 84.3750 (90.0000) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/18] time 0.340 (0.337) data 0.262 (0.258) loss_x loss_x 0.5854 (0.3567) acc_x 87.5000 (91.5625) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/18] time 0.354 (0.334) data 0.276 (0.256) loss_x loss_x 0.3799 (0.3586) acc_x 90.6250 (91.8750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [5/32] time 0.342 (0.338) data 0.264 (0.260) loss_u loss_u 0.9097 (0.9342) acc_u 9.3750 (7.5000) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [10/32] time 0.361 (0.341) data 0.284 (0.263) loss_u loss_u 0.9634 (0.9355) acc_u 3.1250 (7.5000) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [15/32] time 0.346 (0.343) data 0.268 (0.264) loss_u loss_u 0.9927 (0.9334) acc_u 0.0000 (7.7083) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [20/32] time 0.349 (0.344) data 0.272 (0.266) loss_u loss_u 0.9180 (0.9303) acc_u 9.3750 (7.8125) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [25/32] time 0.343 (0.344) data 0.264 (0.266) loss_u loss_u 0.9414 (0.9337) acc_u 6.2500 (7.6250) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [30/32] time 0.328 (0.344) data 0.251 (0.266) loss_u loss_u 0.9585 (0.9392) acc_u 6.2500 (6.9792) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 404
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 606
clean true:520
clean false:86
clean_rate:0.858085808580858
noisy true:708
noisy false:318
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1026
epoch [122/200] batch [5/18] time 0.339 (0.358) data 0.260 (0.280) loss_x loss_x 0.2683 (0.2746) acc_x 96.8750 (95.6250) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/18] time 0.299 (0.342) data 0.222 (0.265) loss_x loss_x 0.2148 (0.3324) acc_x 96.8750 (93.7500) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/18] time 0.345 (0.335) data 0.268 (0.258) loss_x loss_x 0.3218 (0.3358) acc_x 93.7500 (93.5417) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [5/32] time 0.335 (0.337) data 0.257 (0.259) loss_u loss_u 0.9268 (0.9426) acc_u 9.3750 (6.8750) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [10/32] time 0.339 (0.338) data 0.261 (0.260) loss_u loss_u 0.9531 (0.9464) acc_u 3.1250 (5.9375) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [15/32] time 0.394 (0.340) data 0.315 (0.263) loss_u loss_u 0.9360 (0.9422) acc_u 9.3750 (6.8750) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [20/32] time 0.352 (0.341) data 0.273 (0.263) loss_u loss_u 0.9507 (0.9386) acc_u 6.2500 (7.3438) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [25/32] time 0.346 (0.342) data 0.269 (0.264) loss_u loss_u 0.9590 (0.9373) acc_u 6.2500 (7.3750) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [30/32] time 0.349 (0.342) data 0.271 (0.265) loss_u loss_u 0.9229 (0.9370) acc_u 9.3750 (7.3958) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 421
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:523
clean false:91
clean_rate:0.8517915309446255
noisy true:688
noisy false:330
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [123/200] batch [5/19] time 0.357 (0.356) data 0.280 (0.278) loss_x loss_x 0.3687 (0.3769) acc_x 93.7500 (91.2500) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/19] time 0.344 (0.350) data 0.267 (0.272) loss_x loss_x 0.2742 (0.3303) acc_x 90.6250 (93.1250) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/19] time 0.342 (0.350) data 0.264 (0.273) loss_x loss_x 0.3657 (0.3239) acc_x 90.6250 (93.7500) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [5/31] time 0.338 (0.349) data 0.260 (0.271) loss_u loss_u 0.9316 (0.9437) acc_u 6.2500 (5.6250) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [10/31] time 0.353 (0.348) data 0.275 (0.271) loss_u loss_u 0.9658 (0.9563) acc_u 3.1250 (4.6875) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [15/31] time 0.347 (0.347) data 0.268 (0.269) loss_u loss_u 0.9038 (0.9472) acc_u 9.3750 (5.8333) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [20/31] time 0.331 (0.346) data 0.254 (0.268) loss_u loss_u 0.9717 (0.9460) acc_u 3.1250 (5.9375) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [25/31] time 0.345 (0.343) data 0.266 (0.265) loss_u loss_u 0.9341 (0.9457) acc_u 9.3750 (6.0000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [30/31] time 0.345 (0.344) data 0.267 (0.266) loss_u loss_u 0.9507 (0.9436) acc_u 9.3750 (6.3542) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 421
confident_label rate tensor(0.3701, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 604
clean true:523
clean false:81
clean_rate:0.8658940397350994
noisy true:688
noisy false:340
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1028
epoch [124/200] batch [5/18] time 0.341 (0.341) data 0.263 (0.263) loss_x loss_x 0.7852 (0.5080) acc_x 78.1250 (87.5000) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/18] time 0.328 (0.341) data 0.251 (0.264) loss_x loss_x 0.2058 (0.4356) acc_x 96.8750 (91.2500) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/18] time 0.347 (0.342) data 0.269 (0.264) loss_x loss_x 0.3279 (0.3861) acc_x 90.6250 (91.8750) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [5/32] time 0.340 (0.344) data 0.262 (0.266) loss_u loss_u 0.9473 (0.9412) acc_u 6.2500 (7.5000) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [10/32] time 0.356 (0.344) data 0.278 (0.266) loss_u loss_u 0.9585 (0.9373) acc_u 6.2500 (8.1250) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [15/32] time 0.347 (0.344) data 0.270 (0.266) loss_u loss_u 0.9536 (0.9441) acc_u 3.1250 (6.6667) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [20/32] time 0.341 (0.344) data 0.263 (0.266) loss_u loss_u 0.9238 (0.9375) acc_u 9.3750 (7.5000) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [25/32] time 0.306 (0.341) data 0.227 (0.263) loss_u loss_u 0.9590 (0.9375) acc_u 3.1250 (7.3750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [30/32] time 0.345 (0.338) data 0.267 (0.260) loss_u loss_u 0.8760 (0.9331) acc_u 15.6250 (7.8125) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 606
clean true:515
clean false:91
clean_rate:0.8498349834983498
noisy true:689
noisy false:337
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1026
epoch [125/200] batch [5/18] time 0.322 (0.341) data 0.245 (0.263) loss_x loss_x 0.2754 (0.3875) acc_x 93.7500 (91.2500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/18] time 0.339 (0.328) data 0.262 (0.251) loss_x loss_x 0.2338 (0.3295) acc_x 100.0000 (92.1875) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/18] time 0.345 (0.332) data 0.267 (0.255) loss_x loss_x 0.5557 (0.3977) acc_x 84.3750 (90.4167) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/32] time 0.337 (0.338) data 0.259 (0.261) loss_u loss_u 0.8760 (0.9147) acc_u 15.6250 (11.2500) lr 6.4653e-04 eta 0:00:09
epoch [125/200] batch [10/32] time 0.328 (0.340) data 0.250 (0.262) loss_u loss_u 0.9336 (0.9234) acc_u 9.3750 (10.0000) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [15/32] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9502 (0.9264) acc_u 6.2500 (9.3750) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [20/32] time 0.338 (0.340) data 0.260 (0.262) loss_u loss_u 0.8564 (0.9265) acc_u 18.7500 (9.0625) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [25/32] time 0.331 (0.338) data 0.253 (0.260) loss_u loss_u 0.9272 (0.9255) acc_u 9.3750 (9.2500) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [30/32] time 0.339 (0.337) data 0.261 (0.259) loss_u loss_u 0.9199 (0.9296) acc_u 9.3750 (8.6458) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 399
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:526
clean false:88
clean_rate:0.8566775244299675
noisy true:707
noisy false:311
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [126/200] batch [5/19] time 0.347 (0.339) data 0.269 (0.262) loss_x loss_x 0.2871 (0.3515) acc_x 90.6250 (89.3750) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/19] time 0.297 (0.318) data 0.218 (0.240) loss_x loss_x 0.3271 (0.3248) acc_x 93.7500 (91.2500) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/19] time 0.329 (0.320) data 0.251 (0.242) loss_x loss_x 0.4192 (0.3206) acc_x 84.3750 (91.4583) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [5/31] time 0.342 (0.328) data 0.264 (0.251) loss_u loss_u 0.9482 (0.9570) acc_u 6.2500 (5.0000) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [10/31] time 0.348 (0.332) data 0.270 (0.254) loss_u loss_u 0.9248 (0.9440) acc_u 9.3750 (5.9375) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [15/31] time 0.360 (0.334) data 0.281 (0.256) loss_u loss_u 0.9556 (0.9466) acc_u 6.2500 (6.0417) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [20/31] time 0.352 (0.335) data 0.274 (0.258) loss_u loss_u 0.9307 (0.9424) acc_u 12.5000 (6.8750) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [25/31] time 0.359 (0.336) data 0.280 (0.258) loss_u loss_u 0.9990 (0.9437) acc_u 0.0000 (6.7500) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [30/31] time 0.354 (0.337) data 0.276 (0.259) loss_u loss_u 0.9575 (0.9458) acc_u 6.2500 (6.3542) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 374
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:528
clean false:86
clean_rate:0.8599348534201955
noisy true:730
noisy false:288
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [127/200] batch [5/19] time 0.301 (0.306) data 0.223 (0.228) loss_x loss_x 0.2573 (0.3942) acc_x 93.7500 (91.2500) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/19] time 0.315 (0.313) data 0.238 (0.235) loss_x loss_x 0.2983 (0.3507) acc_x 90.6250 (91.8750) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/19] time 0.352 (0.315) data 0.274 (0.237) loss_x loss_x 0.2764 (0.3827) acc_x 90.6250 (91.0417) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [5/31] time 0.351 (0.327) data 0.273 (0.249) loss_u loss_u 0.9321 (0.9370) acc_u 9.3750 (6.2500) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [10/31] time 0.351 (0.331) data 0.273 (0.253) loss_u loss_u 0.9414 (0.9451) acc_u 6.2500 (5.6250) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [15/31] time 0.357 (0.333) data 0.280 (0.255) loss_u loss_u 0.8750 (0.9382) acc_u 15.6250 (7.0833) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [20/31] time 0.346 (0.334) data 0.269 (0.256) loss_u loss_u 0.9609 (0.9354) acc_u 3.1250 (7.3438) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [25/31] time 0.343 (0.335) data 0.265 (0.257) loss_u loss_u 0.9390 (0.9336) acc_u 6.2500 (7.6250) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [30/31] time 0.325 (0.336) data 0.247 (0.258) loss_u loss_u 0.9702 (0.9326) acc_u 3.1250 (8.0208) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 423
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 610
clean true:518
clean false:92
clean_rate:0.8491803278688524
noisy true:691
noisy false:331
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1022
epoch [128/200] batch [5/19] time 0.304 (0.337) data 0.226 (0.259) loss_x loss_x 0.4353 (0.3275) acc_x 90.6250 (92.5000) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/19] time 0.349 (0.342) data 0.272 (0.264) loss_x loss_x 0.2971 (0.3544) acc_x 90.6250 (91.2500) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [15/19] time 0.331 (0.343) data 0.253 (0.265) loss_x loss_x 0.5889 (0.3887) acc_x 87.5000 (90.8333) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [5/31] time 0.354 (0.344) data 0.276 (0.266) loss_u loss_u 0.9521 (0.9323) acc_u 6.2500 (8.1250) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [10/31] time 0.351 (0.345) data 0.274 (0.266) loss_u loss_u 0.9600 (0.9329) acc_u 6.2500 (8.4375) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [15/31] time 0.343 (0.345) data 0.264 (0.267) loss_u loss_u 0.9214 (0.9232) acc_u 9.3750 (9.1667) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [20/31] time 0.339 (0.344) data 0.261 (0.266) loss_u loss_u 0.9160 (0.9237) acc_u 9.3750 (9.2188) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [25/31] time 0.342 (0.345) data 0.264 (0.267) loss_u loss_u 0.8770 (0.9280) acc_u 12.5000 (8.6250) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [30/31] time 0.349 (0.347) data 0.272 (0.268) loss_u loss_u 0.9434 (0.9301) acc_u 6.2500 (8.2292) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 403
confident_label rate tensor(0.3732, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 609
clean true:520
clean false:89
clean_rate:0.8538587848932676
noisy true:709
noisy false:314
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1023
epoch [129/200] batch [5/19] time 0.299 (0.342) data 0.221 (0.265) loss_x loss_x 0.2627 (0.3142) acc_x 96.8750 (92.5000) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [10/19] time 0.340 (0.327) data 0.262 (0.249) loss_x loss_x 0.2827 (0.3758) acc_x 87.5000 (91.5625) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/19] time 0.348 (0.333) data 0.270 (0.255) loss_x loss_x 0.2610 (0.3346) acc_x 90.6250 (91.8750) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [5/31] time 0.358 (0.338) data 0.280 (0.260) loss_u loss_u 0.8779 (0.9351) acc_u 15.6250 (8.1250) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [10/31] time 0.355 (0.341) data 0.277 (0.263) loss_u loss_u 0.9287 (0.9359) acc_u 9.3750 (8.1250) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [15/31] time 0.349 (0.342) data 0.271 (0.264) loss_u loss_u 0.9399 (0.9247) acc_u 6.2500 (9.1667) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [20/31] time 0.349 (0.343) data 0.271 (0.265) loss_u loss_u 0.9541 (0.9303) acc_u 6.2500 (8.5938) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [25/31] time 0.358 (0.343) data 0.280 (0.266) loss_u loss_u 0.9043 (0.9340) acc_u 9.3750 (8.0000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [30/31] time 0.348 (0.344) data 0.269 (0.266) loss_u loss_u 0.9351 (0.9369) acc_u 9.3750 (7.6042) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 429
confident_label rate tensor(0.3768, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 615
clean true:523
clean false:92
clean_rate:0.8504065040650407
noisy true:680
noisy false:337
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1017
epoch [130/200] batch [5/19] time 0.349 (0.350) data 0.272 (0.272) loss_x loss_x 0.3223 (0.3117) acc_x 93.7500 (91.8750) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/19] time 0.347 (0.351) data 0.269 (0.273) loss_x loss_x 0.3618 (0.3228) acc_x 93.7500 (91.8750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [15/19] time 0.345 (0.351) data 0.268 (0.273) loss_x loss_x 0.3064 (0.3262) acc_x 93.7500 (92.0833) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [5/31] time 0.341 (0.349) data 0.263 (0.272) loss_u loss_u 0.9463 (0.9335) acc_u 6.2500 (9.3750) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [10/31] time 0.351 (0.348) data 0.273 (0.271) loss_u loss_u 0.9238 (0.9259) acc_u 9.3750 (9.3750) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [15/31] time 0.333 (0.347) data 0.255 (0.269) loss_u loss_u 0.9243 (0.9294) acc_u 9.3750 (8.7500) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [20/31] time 0.341 (0.346) data 0.264 (0.269) loss_u loss_u 0.9233 (0.9357) acc_u 9.3750 (7.8125) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [25/31] time 0.341 (0.346) data 0.263 (0.268) loss_u loss_u 0.9170 (0.9353) acc_u 9.3750 (7.6250) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [30/31] time 0.344 (0.346) data 0.265 (0.268) loss_u loss_u 0.9800 (0.9380) acc_u 3.1250 (7.1875) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 438
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 618
clean true:522
clean false:96
clean_rate:0.8446601941747572
noisy true:672
noisy false:342
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 1014
epoch [131/200] batch [5/19] time 0.300 (0.314) data 0.222 (0.237) loss_x loss_x 0.3909 (0.3928) acc_x 84.3750 (88.7500) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/19] time 0.348 (0.329) data 0.270 (0.252) loss_x loss_x 0.2357 (0.4106) acc_x 96.8750 (89.3750) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/19] time 0.333 (0.338) data 0.256 (0.261) loss_x loss_x 0.3469 (0.4098) acc_x 96.8750 (90.2083) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [5/31] time 0.353 (0.341) data 0.274 (0.264) loss_u loss_u 0.9204 (0.9500) acc_u 9.3750 (5.6250) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [10/31] time 0.331 (0.341) data 0.252 (0.263) loss_u loss_u 0.8447 (0.9255) acc_u 15.6250 (7.8125) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [15/31] time 0.342 (0.341) data 0.264 (0.264) loss_u loss_u 0.9712 (0.9257) acc_u 3.1250 (7.9167) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [20/31] time 0.351 (0.343) data 0.272 (0.265) loss_u loss_u 0.9360 (0.9281) acc_u 9.3750 (7.9688) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [25/31] time 0.347 (0.343) data 0.269 (0.265) loss_u loss_u 0.9351 (0.9314) acc_u 9.3750 (7.7500) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [30/31] time 0.325 (0.343) data 0.246 (0.265) loss_u loss_u 0.9834 (0.9367) acc_u 3.1250 (7.1875) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 423
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 613
clean true:524
clean false:89
clean_rate:0.8548123980424144
noisy true:685
noisy false:334
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1019
epoch [132/200] batch [5/19] time 0.320 (0.330) data 0.242 (0.252) loss_x loss_x 0.3857 (0.4105) acc_x 90.6250 (91.2500) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/19] time 0.341 (0.337) data 0.264 (0.260) loss_x loss_x 0.1501 (0.4109) acc_x 96.8750 (90.9375) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [15/19] time 0.348 (0.339) data 0.270 (0.261) loss_x loss_x 0.4414 (0.3915) acc_x 84.3750 (90.8333) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [5/31] time 0.347 (0.341) data 0.269 (0.263) loss_u loss_u 0.9644 (0.9384) acc_u 3.1250 (6.8750) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [10/31] time 0.352 (0.342) data 0.274 (0.264) loss_u loss_u 0.8955 (0.9478) acc_u 12.5000 (5.9375) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [15/31] time 0.354 (0.343) data 0.276 (0.265) loss_u loss_u 0.8647 (0.9467) acc_u 15.6250 (6.2500) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [20/31] time 0.345 (0.343) data 0.267 (0.266) loss_u loss_u 0.9390 (0.9372) acc_u 6.2500 (7.3438) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [25/31] time 0.357 (0.343) data 0.278 (0.265) loss_u loss_u 0.9873 (0.9401) acc_u 0.0000 (7.0000) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [30/31] time 0.350 (0.343) data 0.271 (0.265) loss_u loss_u 0.9014 (0.9383) acc_u 9.3750 (7.2917) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 425
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:522
clean false:97
clean_rate:0.8432956381260097
noisy true:685
noisy false:328
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [133/200] batch [5/19] time 0.362 (0.350) data 0.285 (0.272) loss_x loss_x 0.2029 (0.3130) acc_x 96.8750 (91.8750) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/19] time 0.357 (0.350) data 0.279 (0.272) loss_x loss_x 0.4595 (0.2942) acc_x 81.2500 (92.1875) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [15/19] time 0.358 (0.349) data 0.279 (0.271) loss_x loss_x 0.3074 (0.2987) acc_x 90.6250 (92.2917) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [5/31] time 0.340 (0.348) data 0.262 (0.270) loss_u loss_u 0.9961 (0.9302) acc_u 0.0000 (8.7500) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [10/31] time 0.350 (0.347) data 0.272 (0.269) loss_u loss_u 0.9624 (0.9351) acc_u 6.2500 (8.1250) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [15/31] time 0.352 (0.349) data 0.274 (0.271) loss_u loss_u 0.9878 (0.9451) acc_u 0.0000 (6.6667) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [20/31] time 0.349 (0.348) data 0.271 (0.270) loss_u loss_u 0.9072 (0.9353) acc_u 9.3750 (7.5000) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [25/31] time 0.338 (0.347) data 0.260 (0.269) loss_u loss_u 0.9775 (0.9331) acc_u 3.1250 (8.1250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [30/31] time 0.328 (0.346) data 0.250 (0.268) loss_u loss_u 0.9668 (0.9351) acc_u 3.1250 (7.9167) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 402
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 611
clean true:526
clean false:85
clean_rate:0.8608837970540099
noisy true:704
noisy false:317
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1021
epoch [134/200] batch [5/19] time 0.329 (0.332) data 0.252 (0.254) loss_x loss_x 0.2727 (0.3031) acc_x 96.8750 (93.7500) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/19] time 0.352 (0.344) data 0.274 (0.267) loss_x loss_x 0.2032 (0.3328) acc_x 93.7500 (93.4375) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [15/19] time 0.345 (0.342) data 0.267 (0.265) loss_x loss_x 0.2340 (0.3339) acc_x 93.7500 (92.7083) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [5/31] time 0.338 (0.344) data 0.261 (0.267) loss_u loss_u 0.9653 (0.9348) acc_u 3.1250 (7.5000) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [10/31] time 0.351 (0.344) data 0.274 (0.266) loss_u loss_u 0.9580 (0.9479) acc_u 3.1250 (5.9375) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [15/31] time 0.351 (0.344) data 0.273 (0.266) loss_u loss_u 0.9717 (0.9500) acc_u 3.1250 (6.0417) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [20/31] time 0.352 (0.345) data 0.275 (0.267) loss_u loss_u 0.9971 (0.9474) acc_u 0.0000 (6.2500) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [25/31] time 0.363 (0.345) data 0.284 (0.268) loss_u loss_u 0.8555 (0.9391) acc_u 18.7500 (7.5000) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [30/31] time 0.315 (0.345) data 0.237 (0.267) loss_u loss_u 0.9238 (0.9420) acc_u 9.3750 (7.1875) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 429
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:526
clean false:93
clean_rate:0.8497576736672051
noisy true:677
noisy false:336
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [135/200] batch [5/19] time 0.333 (0.323) data 0.255 (0.244) loss_x loss_x 0.6211 (0.3977) acc_x 84.3750 (91.2500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/19] time 0.337 (0.332) data 0.259 (0.254) loss_x loss_x 0.3372 (0.3484) acc_x 87.5000 (91.2500) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/19] time 0.349 (0.336) data 0.272 (0.258) loss_x loss_x 0.3572 (0.3203) acc_x 90.6250 (91.6667) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [5/31] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.9355 (0.9376) acc_u 9.3750 (8.1250) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [10/31] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9595 (0.9449) acc_u 3.1250 (6.5625) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [15/31] time 0.343 (0.341) data 0.265 (0.263) loss_u loss_u 0.9629 (0.9440) acc_u 3.1250 (6.4583) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [20/31] time 0.350 (0.342) data 0.272 (0.264) loss_u loss_u 0.9731 (0.9423) acc_u 3.1250 (6.7188) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [25/31] time 0.349 (0.343) data 0.271 (0.265) loss_u loss_u 0.9995 (0.9487) acc_u 0.0000 (6.0000) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [30/31] time 0.342 (0.343) data 0.264 (0.266) loss_u loss_u 0.9614 (0.9442) acc_u 3.1250 (6.4583) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 405
confident_label rate tensor(0.3860, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 630
clean true:536
clean false:94
clean_rate:0.8507936507936508
noisy true:691
noisy false:311
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 1002
epoch [136/200] batch [5/19] time 0.338 (0.318) data 0.261 (0.240) loss_x loss_x 0.3201 (0.3220) acc_x 93.7500 (93.7500) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/19] time 0.336 (0.327) data 0.258 (0.249) loss_x loss_x 0.2957 (0.3543) acc_x 90.6250 (92.1875) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/19] time 0.324 (0.331) data 0.246 (0.254) loss_x loss_x 0.4026 (0.3796) acc_x 90.6250 (91.6667) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [5/31] time 0.355 (0.334) data 0.276 (0.256) loss_u loss_u 0.9644 (0.9489) acc_u 3.1250 (6.2500) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [10/31] time 0.356 (0.337) data 0.278 (0.259) loss_u loss_u 0.9688 (0.9432) acc_u 3.1250 (6.5625) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [15/31] time 0.353 (0.339) data 0.275 (0.261) loss_u loss_u 0.9194 (0.9373) acc_u 9.3750 (7.5000) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [20/31] time 0.349 (0.340) data 0.272 (0.262) loss_u loss_u 0.9541 (0.9428) acc_u 6.2500 (6.8750) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [25/31] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.9575 (0.9487) acc_u 6.2500 (6.1250) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [30/31] time 0.339 (0.340) data 0.262 (0.262) loss_u loss_u 0.9707 (0.9476) acc_u 3.1250 (6.2500) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 416
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 612
clean true:525
clean false:87
clean_rate:0.8578431372549019
noisy true:691
noisy false:329
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1020
epoch [137/200] batch [5/19] time 0.347 (0.315) data 0.269 (0.237) loss_x loss_x 0.3096 (0.3289) acc_x 93.7500 (93.1250) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/19] time 0.339 (0.329) data 0.261 (0.251) loss_x loss_x 0.4326 (0.3786) acc_x 87.5000 (91.5625) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/19] time 0.352 (0.337) data 0.274 (0.259) loss_x loss_x 0.3960 (0.3341) acc_x 90.6250 (92.7083) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [5/31] time 0.338 (0.339) data 0.260 (0.261) loss_u loss_u 0.9204 (0.9222) acc_u 9.3750 (10.0000) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [10/31] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9502 (0.9262) acc_u 6.2500 (9.3750) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [15/31] time 0.340 (0.341) data 0.262 (0.263) loss_u loss_u 0.9438 (0.9302) acc_u 6.2500 (8.3333) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [20/31] time 0.295 (0.338) data 0.217 (0.260) loss_u loss_u 0.8970 (0.9313) acc_u 9.3750 (7.8125) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [25/31] time 0.339 (0.337) data 0.261 (0.259) loss_u loss_u 0.9707 (0.9339) acc_u 3.1250 (7.8750) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [30/31] time 0.337 (0.336) data 0.259 (0.259) loss_u loss_u 0.9912 (0.9368) acc_u 0.0000 (7.5000) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 421
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 624
clean true:529
clean false:95
clean_rate:0.8477564102564102
noisy true:682
noisy false:326
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 1008
epoch [138/200] batch [5/19] time 0.300 (0.307) data 0.222 (0.229) loss_x loss_x 0.1716 (0.3981) acc_x 93.7500 (89.3750) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/19] time 0.328 (0.324) data 0.250 (0.246) loss_x loss_x 0.2365 (0.4027) acc_x 96.8750 (89.6875) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/19] time 0.342 (0.327) data 0.265 (0.249) loss_x loss_x 0.4050 (0.4146) acc_x 90.6250 (89.7917) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [5/31] time 0.330 (0.333) data 0.252 (0.255) loss_u loss_u 0.9312 (0.9457) acc_u 6.2500 (6.2500) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [10/31] time 0.340 (0.335) data 0.261 (0.257) loss_u loss_u 0.9033 (0.9390) acc_u 12.5000 (6.8750) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [15/31] time 0.327 (0.335) data 0.249 (0.257) loss_u loss_u 0.9155 (0.9451) acc_u 12.5000 (6.0417) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [20/31] time 0.337 (0.335) data 0.258 (0.257) loss_u loss_u 0.9106 (0.9457) acc_u 9.3750 (5.9375) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [25/31] time 0.374 (0.337) data 0.296 (0.259) loss_u loss_u 0.9082 (0.9410) acc_u 12.5000 (6.6250) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [30/31] time 0.337 (0.338) data 0.259 (0.260) loss_u loss_u 0.9385 (0.9433) acc_u 6.2500 (6.3542) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 414
confident_label rate tensor(0.3854, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 629
clean true:538
clean false:91
clean_rate:0.8553259141494436
noisy true:680
noisy false:323
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 1003
epoch [139/200] batch [5/19] time 0.351 (0.346) data 0.273 (0.268) loss_x loss_x 0.4175 (0.3728) acc_x 87.5000 (91.2500) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/19] time 0.337 (0.345) data 0.260 (0.267) loss_x loss_x 0.2998 (0.3838) acc_x 93.7500 (90.6250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [15/19] time 0.349 (0.346) data 0.271 (0.268) loss_x loss_x 0.4316 (0.4059) acc_x 87.5000 (90.8333) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [5/31] time 0.350 (0.345) data 0.272 (0.267) loss_u loss_u 0.9302 (0.9646) acc_u 6.2500 (3.7500) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [10/31] time 0.338 (0.345) data 0.260 (0.268) loss_u loss_u 0.9463 (0.9513) acc_u 9.3750 (5.6250) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [15/31] time 0.336 (0.345) data 0.258 (0.267) loss_u loss_u 0.9409 (0.9436) acc_u 6.2500 (6.4583) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [20/31] time 0.307 (0.343) data 0.228 (0.265) loss_u loss_u 0.9492 (0.9498) acc_u 6.2500 (5.6250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [25/31] time 0.375 (0.343) data 0.297 (0.265) loss_u loss_u 0.9688 (0.9493) acc_u 3.1250 (5.6250) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [30/31] time 0.409 (0.347) data 0.329 (0.269) loss_u loss_u 0.9478 (0.9494) acc_u 9.3750 (5.8333) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 426
confident_label rate tensor(0.3842, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 627
clean true:535
clean false:92
clean_rate:0.8532695374800638
noisy true:671
noisy false:334
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 1005
epoch [140/200] batch [5/19] time 0.345 (0.350) data 0.268 (0.272) loss_x loss_x 0.3706 (0.3140) acc_x 90.6250 (93.1250) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/19] time 0.340 (0.348) data 0.262 (0.271) loss_x loss_x 0.5889 (0.3317) acc_x 78.1250 (90.6250) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [15/19] time 0.337 (0.348) data 0.259 (0.270) loss_x loss_x 0.2264 (0.3139) acc_x 93.7500 (91.4583) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [5/31] time 0.352 (0.346) data 0.274 (0.268) loss_u loss_u 0.9375 (0.9257) acc_u 6.2500 (10.0000) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [10/31] time 0.357 (0.348) data 0.278 (0.270) loss_u loss_u 0.9990 (0.9364) acc_u 0.0000 (8.4375) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [15/31] time 0.343 (0.348) data 0.266 (0.270) loss_u loss_u 0.9995 (0.9452) acc_u 0.0000 (7.0833) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [20/31] time 0.326 (0.347) data 0.248 (0.269) loss_u loss_u 0.9482 (0.9476) acc_u 6.2500 (6.4062) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [25/31] time 0.340 (0.346) data 0.262 (0.268) loss_u loss_u 0.9062 (0.9467) acc_u 12.5000 (6.5000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [30/31] time 0.315 (0.344) data 0.238 (0.266) loss_u loss_u 0.9473 (0.9456) acc_u 6.2500 (6.5625) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 415
confident_label rate tensor(0.3799, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 620
clean true:527
clean false:93
clean_rate:0.85
noisy true:690
noisy false:322
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 1012
epoch [141/200] batch [5/19] time 0.351 (0.359) data 0.273 (0.281) loss_x loss_x 0.4575 (0.3924) acc_x 84.3750 (90.0000) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/19] time 0.353 (0.351) data 0.275 (0.273) loss_x loss_x 0.6138 (0.3911) acc_x 93.7500 (90.6250) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [15/19] time 0.355 (0.350) data 0.277 (0.272) loss_x loss_x 0.3086 (0.3910) acc_x 93.7500 (90.2083) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [5/31] time 0.339 (0.348) data 0.261 (0.270) loss_u loss_u 0.9648 (0.9313) acc_u 3.1250 (7.5000) lr 4.2499e-04 eta 0:00:09
epoch [141/200] batch [10/31] time 0.347 (0.347) data 0.269 (0.270) loss_u loss_u 0.9390 (0.9256) acc_u 6.2500 (8.4375) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [15/31] time 0.341 (0.346) data 0.264 (0.268) loss_u loss_u 0.9893 (0.9314) acc_u 3.1250 (8.1250) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [20/31] time 0.337 (0.345) data 0.259 (0.267) loss_u loss_u 0.9883 (0.9367) acc_u 0.0000 (7.3438) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [25/31] time 0.350 (0.345) data 0.271 (0.267) loss_u loss_u 0.9126 (0.9389) acc_u 9.3750 (7.1250) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [30/31] time 0.302 (0.342) data 0.224 (0.264) loss_u loss_u 0.8867 (0.9399) acc_u 12.5000 (7.0833) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 430
confident_label rate tensor(0.3799, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 620
clean true:526
clean false:94
clean_rate:0.8483870967741935
noisy true:676
noisy false:336
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 1012
epoch [142/200] batch [5/19] time 0.339 (0.348) data 0.261 (0.270) loss_x loss_x 0.1647 (0.3748) acc_x 100.0000 (91.8750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/19] time 0.351 (0.344) data 0.273 (0.267) loss_x loss_x 0.2378 (0.3207) acc_x 93.7500 (92.1875) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [15/19] time 0.343 (0.344) data 0.265 (0.266) loss_x loss_x 0.1533 (0.3408) acc_x 100.0000 (92.5000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [5/31] time 0.354 (0.345) data 0.275 (0.267) loss_u loss_u 0.9263 (0.9500) acc_u 12.5000 (6.2500) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [10/31] time 0.353 (0.345) data 0.275 (0.267) loss_u loss_u 0.9478 (0.9433) acc_u 6.2500 (6.8750) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [15/31] time 0.314 (0.344) data 0.236 (0.266) loss_u loss_u 0.9434 (0.9397) acc_u 9.3750 (7.5000) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [20/31] time 0.336 (0.344) data 0.257 (0.266) loss_u loss_u 0.9253 (0.9410) acc_u 9.3750 (7.0312) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [25/31] time 0.334 (0.344) data 0.256 (0.266) loss_u loss_u 0.9155 (0.9363) acc_u 9.3750 (7.3750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [30/31] time 0.305 (0.342) data 0.227 (0.264) loss_u loss_u 0.8867 (0.9319) acc_u 15.6250 (8.0208) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.3805, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 621
clean true:527
clean false:94
clean_rate:0.8486312399355878
noisy true:677
noisy false:334
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 1011
epoch [143/200] batch [5/19] time 0.345 (0.350) data 0.268 (0.273) loss_x loss_x 0.2864 (0.3973) acc_x 90.6250 (89.3750) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/19] time 0.341 (0.350) data 0.264 (0.273) loss_x loss_x 0.3601 (0.3964) acc_x 93.7500 (90.0000) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [15/19] time 0.340 (0.349) data 0.262 (0.271) loss_x loss_x 0.3010 (0.3629) acc_x 93.7500 (91.6667) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [5/31] time 0.352 (0.347) data 0.275 (0.269) loss_u loss_u 0.9448 (0.9335) acc_u 6.2500 (9.3750) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [10/31] time 0.344 (0.346) data 0.266 (0.269) loss_u loss_u 0.9873 (0.9466) acc_u 0.0000 (6.8750) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [15/31] time 0.341 (0.345) data 0.263 (0.268) loss_u loss_u 0.9785 (0.9434) acc_u 3.1250 (7.5000) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [20/31] time 0.340 (0.345) data 0.261 (0.268) loss_u loss_u 0.9390 (0.9395) acc_u 6.2500 (7.6562) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [25/31] time 0.347 (0.346) data 0.269 (0.268) loss_u loss_u 0.9155 (0.9382) acc_u 9.3750 (7.7500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [30/31] time 0.302 (0.345) data 0.223 (0.267) loss_u loss_u 0.9629 (0.9354) acc_u 3.1250 (7.7083) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 425
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:527
clean false:92
clean_rate:0.851373182552504
noisy true:680
noisy false:333
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [144/200] batch [5/19] time 0.352 (0.347) data 0.275 (0.269) loss_x loss_x 0.3071 (0.3264) acc_x 90.6250 (91.2500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/19] time 0.334 (0.345) data 0.256 (0.267) loss_x loss_x 0.2299 (0.3105) acc_x 96.8750 (92.1875) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/19] time 0.352 (0.345) data 0.275 (0.267) loss_x loss_x 0.2637 (0.3089) acc_x 93.7500 (92.5000) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [5/31] time 0.345 (0.344) data 0.267 (0.267) loss_u loss_u 0.9009 (0.9558) acc_u 12.5000 (5.0000) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [10/31] time 0.336 (0.343) data 0.258 (0.265) loss_u loss_u 0.9580 (0.9526) acc_u 3.1250 (5.6250) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [15/31] time 0.360 (0.344) data 0.282 (0.266) loss_u loss_u 0.8760 (0.9404) acc_u 12.5000 (6.8750) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [20/31] time 0.323 (0.343) data 0.245 (0.265) loss_u loss_u 0.8994 (0.9385) acc_u 12.5000 (7.3438) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [25/31] time 0.305 (0.339) data 0.227 (0.261) loss_u loss_u 0.8931 (0.9388) acc_u 12.5000 (7.1250) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [30/31] time 0.338 (0.336) data 0.259 (0.258) loss_u loss_u 0.9448 (0.9382) acc_u 9.3750 (7.1875) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 404
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 618
clean true:521
clean false:97
clean_rate:0.843042071197411
noisy true:707
noisy false:307
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 1014
epoch [145/200] batch [5/19] time 0.353 (0.350) data 0.276 (0.273) loss_x loss_x 0.3896 (0.3838) acc_x 93.7500 (92.5000) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/19] time 0.342 (0.348) data 0.264 (0.271) loss_x loss_x 0.6655 (0.3546) acc_x 87.5000 (93.7500) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [15/19] time 0.346 (0.346) data 0.268 (0.269) loss_x loss_x 0.3215 (0.3794) acc_x 90.6250 (92.0833) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [5/31] time 0.343 (0.346) data 0.264 (0.268) loss_u loss_u 0.9590 (0.9334) acc_u 3.1250 (8.1250) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [10/31] time 0.338 (0.346) data 0.260 (0.268) loss_u loss_u 0.9976 (0.9406) acc_u 0.0000 (6.8750) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [15/31] time 0.333 (0.345) data 0.256 (0.267) loss_u loss_u 0.9082 (0.9373) acc_u 9.3750 (7.0833) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [20/31] time 0.345 (0.343) data 0.268 (0.265) loss_u loss_u 0.8369 (0.9347) acc_u 18.7500 (7.5000) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [25/31] time 0.301 (0.341) data 0.222 (0.263) loss_u loss_u 0.9751 (0.9389) acc_u 3.1250 (7.0000) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [30/31] time 0.303 (0.337) data 0.225 (0.259) loss_u loss_u 0.9141 (0.9366) acc_u 12.5000 (7.5000) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 401
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:522
clean false:97
clean_rate:0.8432956381260097
noisy true:709
noisy false:304
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [146/200] batch [5/19] time 0.344 (0.347) data 0.267 (0.269) loss_x loss_x 0.2053 (0.3095) acc_x 90.6250 (91.8750) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/19] time 0.361 (0.350) data 0.284 (0.272) loss_x loss_x 0.3445 (0.3822) acc_x 90.6250 (90.3125) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/19] time 0.334 (0.346) data 0.256 (0.269) loss_x loss_x 0.5664 (0.3794) acc_x 87.5000 (90.2083) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [5/31] time 0.345 (0.344) data 0.267 (0.267) loss_u loss_u 0.9556 (0.9461) acc_u 3.1250 (4.3750) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [10/31] time 0.348 (0.344) data 0.268 (0.266) loss_u loss_u 0.8652 (0.9276) acc_u 15.6250 (7.5000) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [15/31] time 0.349 (0.344) data 0.271 (0.266) loss_u loss_u 0.9233 (0.9316) acc_u 9.3750 (7.2917) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [20/31] time 0.349 (0.343) data 0.271 (0.266) loss_u loss_u 0.9468 (0.9334) acc_u 6.2500 (7.0312) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [25/31] time 0.321 (0.341) data 0.242 (0.263) loss_u loss_u 0.9458 (0.9276) acc_u 6.2500 (8.0000) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [30/31] time 0.363 (0.341) data 0.286 (0.263) loss_u loss_u 0.9858 (0.9317) acc_u 0.0000 (7.7083) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 410
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 618
clean true:522
clean false:96
clean_rate:0.8446601941747572
noisy true:700
noisy false:314
after delete: len(clean_dataset) 618
after delete: len(noisy_dataset) 1014
epoch [147/200] batch [5/19] time 0.345 (0.345) data 0.268 (0.267) loss_x loss_x 0.4497 (0.4305) acc_x 93.7500 (91.8750) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/19] time 0.360 (0.349) data 0.282 (0.271) loss_x loss_x 0.2433 (0.3449) acc_x 96.8750 (92.8125) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/19] time 0.350 (0.348) data 0.273 (0.271) loss_x loss_x 0.3655 (0.3072) acc_x 93.7500 (94.1667) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [5/31] time 0.338 (0.347) data 0.261 (0.269) loss_u loss_u 0.9180 (0.9269) acc_u 9.3750 (8.7500) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [10/31] time 0.342 (0.347) data 0.265 (0.269) loss_u loss_u 0.9507 (0.9391) acc_u 6.2500 (6.8750) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [15/31] time 0.344 (0.346) data 0.267 (0.269) loss_u loss_u 0.9214 (0.9398) acc_u 9.3750 (6.6667) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [20/31] time 0.348 (0.346) data 0.271 (0.269) loss_u loss_u 0.8755 (0.9388) acc_u 15.6250 (7.0312) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [25/31] time 0.301 (0.345) data 0.223 (0.267) loss_u loss_u 0.9624 (0.9408) acc_u 3.1250 (7.1250) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [30/31] time 0.302 (0.340) data 0.224 (0.262) loss_u loss_u 0.9365 (0.9433) acc_u 9.3750 (6.8750) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 444
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 607
clean true:515
clean false:92
clean_rate:0.8484349258649094
noisy true:673
noisy false:352
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1025
epoch [148/200] batch [5/18] time 0.334 (0.323) data 0.256 (0.244) loss_x loss_x 0.3928 (0.3015) acc_x 90.6250 (93.7500) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/18] time 0.329 (0.332) data 0.251 (0.254) loss_x loss_x 0.2568 (0.3015) acc_x 96.8750 (93.4375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/18] time 0.330 (0.334) data 0.253 (0.256) loss_x loss_x 0.3132 (0.3041) acc_x 93.7500 (92.9167) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [5/32] time 0.346 (0.338) data 0.268 (0.260) loss_u loss_u 0.9541 (0.9209) acc_u 3.1250 (8.7500) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [10/32] time 0.350 (0.340) data 0.272 (0.262) loss_u loss_u 0.8823 (0.9248) acc_u 12.5000 (8.7500) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [15/32] time 0.346 (0.340) data 0.269 (0.262) loss_u loss_u 0.9614 (0.9337) acc_u 6.2500 (7.9167) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [20/32] time 0.332 (0.340) data 0.254 (0.262) loss_u loss_u 0.9385 (0.9341) acc_u 6.2500 (7.8125) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [25/32] time 0.331 (0.339) data 0.253 (0.262) loss_u loss_u 0.8892 (0.9326) acc_u 12.5000 (7.8750) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [30/32] time 0.327 (0.339) data 0.249 (0.261) loss_u loss_u 0.9189 (0.9330) acc_u 9.3750 (7.8125) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 402
confident_label rate tensor(0.3860, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 630
clean true:540
clean false:90
clean_rate:0.8571428571428571
noisy true:690
noisy false:312
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 1002
epoch [149/200] batch [5/19] time 0.344 (0.348) data 0.266 (0.270) loss_x loss_x 0.4922 (0.3337) acc_x 84.3750 (91.8750) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/19] time 0.341 (0.345) data 0.263 (0.268) loss_x loss_x 0.2771 (0.3333) acc_x 93.7500 (92.5000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/19] time 0.346 (0.347) data 0.268 (0.270) loss_x loss_x 0.1337 (0.3338) acc_x 100.0000 (93.3333) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [5/31] time 0.350 (0.348) data 0.272 (0.270) loss_u loss_u 0.9360 (0.9513) acc_u 6.2500 (5.0000) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [10/31] time 0.340 (0.347) data 0.263 (0.270) loss_u loss_u 0.9468 (0.9532) acc_u 6.2500 (5.0000) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [15/31] time 0.350 (0.346) data 0.271 (0.269) loss_u loss_u 0.8823 (0.9472) acc_u 12.5000 (6.0417) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [20/31] time 0.359 (0.347) data 0.281 (0.269) loss_u loss_u 0.8989 (0.9389) acc_u 9.3750 (6.8750) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [25/31] time 0.348 (0.347) data 0.269 (0.269) loss_u loss_u 0.9629 (0.9447) acc_u 3.1250 (6.1250) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [30/31] time 0.311 (0.346) data 0.232 (0.268) loss_u loss_u 0.9399 (0.9446) acc_u 6.2500 (6.0417) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 403
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:530
clean false:89
clean_rate:0.8562197092084006
noisy true:699
noisy false:314
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [150/200] batch [5/19] time 0.372 (0.348) data 0.294 (0.270) loss_x loss_x 0.3784 (0.3614) acc_x 87.5000 (90.6250) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/19] time 0.346 (0.347) data 0.269 (0.269) loss_x loss_x 0.3994 (0.3429) acc_x 90.6250 (91.8750) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [15/19] time 0.348 (0.347) data 0.270 (0.269) loss_x loss_x 0.4167 (0.3397) acc_x 93.7500 (92.0833) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [5/31] time 0.354 (0.347) data 0.277 (0.270) loss_u loss_u 0.9380 (0.9371) acc_u 9.3750 (8.1250) lr 3.1545e-04 eta 0:00:09
epoch [150/200] batch [10/31] time 0.337 (0.346) data 0.259 (0.268) loss_u loss_u 0.9136 (0.9315) acc_u 6.2500 (7.8125) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [15/31] time 0.337 (0.344) data 0.259 (0.266) loss_u loss_u 0.9839 (0.9379) acc_u 3.1250 (7.0833) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [20/31] time 0.344 (0.345) data 0.266 (0.268) loss_u loss_u 0.9443 (0.9357) acc_u 6.2500 (7.3438) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [25/31] time 0.342 (0.345) data 0.264 (0.268) loss_u loss_u 0.9365 (0.9375) acc_u 6.2500 (7.1250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [30/31] time 0.303 (0.343) data 0.224 (0.265) loss_u loss_u 0.8867 (0.9399) acc_u 15.6250 (6.9792) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 410
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 616
clean true:524
clean false:92
clean_rate:0.8506493506493507
noisy true:698
noisy false:318
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1016
epoch [151/200] batch [5/19] time 0.343 (0.356) data 0.266 (0.279) loss_x loss_x 0.3010 (0.3047) acc_x 90.6250 (93.7500) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/19] time 0.347 (0.352) data 0.268 (0.274) loss_x loss_x 0.3384 (0.2775) acc_x 87.5000 (92.8125) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [15/19] time 0.343 (0.348) data 0.266 (0.270) loss_x loss_x 0.2366 (0.2834) acc_x 96.8750 (93.1250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [5/31] time 0.367 (0.348) data 0.289 (0.270) loss_u loss_u 0.9375 (0.9492) acc_u 6.2500 (5.0000) lr 3.0409e-04 eta 0:00:09
epoch [151/200] batch [10/31] time 0.345 (0.347) data 0.267 (0.269) loss_u loss_u 0.9468 (0.9471) acc_u 6.2500 (5.9375) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [15/31] time 0.330 (0.347) data 0.253 (0.269) loss_u loss_u 0.9102 (0.9401) acc_u 12.5000 (6.8750) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [20/31] time 0.353 (0.348) data 0.275 (0.270) loss_u loss_u 0.9170 (0.9386) acc_u 9.3750 (7.0312) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [25/31] time 0.356 (0.348) data 0.279 (0.270) loss_u loss_u 0.9751 (0.9379) acc_u 3.1250 (7.2500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [30/31] time 0.303 (0.347) data 0.224 (0.269) loss_u loss_u 0.8545 (0.9382) acc_u 15.6250 (7.0833) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 408
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 624
clean true:534
clean false:90
clean_rate:0.8557692307692307
noisy true:690
noisy false:318
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 1008
epoch [152/200] batch [5/19] time 0.349 (0.353) data 0.272 (0.275) loss_x loss_x 0.4893 (0.3428) acc_x 81.2500 (90.6250) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/19] time 0.346 (0.347) data 0.268 (0.270) loss_x loss_x 0.3296 (0.3128) acc_x 87.5000 (91.2500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [15/19] time 0.328 (0.345) data 0.250 (0.268) loss_x loss_x 0.3379 (0.3156) acc_x 93.7500 (91.8750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [5/31] time 0.336 (0.343) data 0.259 (0.266) loss_u loss_u 0.9756 (0.9368) acc_u 3.1250 (7.5000) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [10/31] time 0.349 (0.343) data 0.271 (0.265) loss_u loss_u 0.9985 (0.9421) acc_u 0.0000 (6.5625) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [15/31] time 0.356 (0.343) data 0.278 (0.265) loss_u loss_u 0.9194 (0.9382) acc_u 9.3750 (7.0833) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [20/31] time 0.353 (0.344) data 0.274 (0.266) loss_u loss_u 0.9932 (0.9437) acc_u 0.0000 (6.4062) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [25/31] time 0.295 (0.341) data 0.217 (0.264) loss_u loss_u 0.9141 (0.9458) acc_u 9.3750 (6.2500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [30/31] time 0.318 (0.338) data 0.240 (0.260) loss_u loss_u 0.9482 (0.9468) acc_u 6.2500 (6.2500) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 369
confident_label rate tensor(0.3860, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 630
clean true:542
clean false:88
clean_rate:0.8603174603174604
noisy true:721
noisy false:281
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 1002
epoch [153/200] batch [5/19] time 0.348 (0.354) data 0.270 (0.276) loss_x loss_x 0.3596 (0.3755) acc_x 93.7500 (90.6250) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/19] time 0.344 (0.347) data 0.267 (0.269) loss_x loss_x 0.2180 (0.3511) acc_x 96.8750 (92.5000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/19] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.3875 (0.3294) acc_x 90.6250 (93.3333) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [5/31] time 0.336 (0.345) data 0.257 (0.267) loss_u loss_u 0.8833 (0.9128) acc_u 15.6250 (10.6250) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [10/31] time 0.342 (0.344) data 0.265 (0.266) loss_u loss_u 0.8521 (0.9223) acc_u 15.6250 (9.3750) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [15/31] time 0.343 (0.344) data 0.265 (0.266) loss_u loss_u 0.9771 (0.9283) acc_u 3.1250 (8.7500) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [20/31] time 0.333 (0.345) data 0.255 (0.267) loss_u loss_u 0.9844 (0.9338) acc_u 3.1250 (7.8125) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [25/31] time 0.294 (0.344) data 0.215 (0.266) loss_u loss_u 0.9785 (0.9431) acc_u 6.2500 (6.7500) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [30/31] time 0.347 (0.342) data 0.270 (0.264) loss_u loss_u 0.9292 (0.9449) acc_u 9.3750 (6.6667) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 398
confident_label rate tensor(0.3805, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 621
clean true:538
clean false:83
clean_rate:0.8663446054750402
noisy true:696
noisy false:315
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 1011
epoch [154/200] batch [5/19] time 0.331 (0.338) data 0.253 (0.260) loss_x loss_x 0.3220 (0.2984) acc_x 93.7500 (93.7500) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/19] time 0.329 (0.337) data 0.252 (0.260) loss_x loss_x 0.2136 (0.3457) acc_x 93.7500 (92.8125) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [15/19] time 0.349 (0.339) data 0.271 (0.261) loss_x loss_x 0.2524 (0.3318) acc_x 90.6250 (92.7083) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [5/31] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.9673 (0.9464) acc_u 3.1250 (6.2500) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [10/31] time 0.328 (0.340) data 0.251 (0.263) loss_u loss_u 0.8647 (0.9326) acc_u 15.6250 (8.4375) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [15/31] time 0.344 (0.340) data 0.266 (0.263) loss_u loss_u 0.8984 (0.9328) acc_u 9.3750 (8.3333) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [20/31] time 0.316 (0.339) data 0.238 (0.261) loss_u loss_u 0.8774 (0.9276) acc_u 12.5000 (8.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [25/31] time 0.313 (0.338) data 0.234 (0.260) loss_u loss_u 0.9619 (0.9312) acc_u 3.1250 (8.1250) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [30/31] time 0.310 (0.335) data 0.232 (0.257) loss_u loss_u 0.9731 (0.9331) acc_u 3.1250 (7.8125) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 393
confident_label rate tensor(0.3768, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 615
clean true:530
clean false:85
clean_rate:0.8617886178861789
noisy true:709
noisy false:308
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1017
epoch [155/200] batch [5/19] time 0.344 (0.363) data 0.267 (0.285) loss_x loss_x 0.3691 (0.3344) acc_x 90.6250 (93.7500) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [10/19] time 0.336 (0.354) data 0.258 (0.276) loss_x loss_x 0.7300 (0.4171) acc_x 75.0000 (89.6875) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [15/19] time 0.337 (0.348) data 0.260 (0.270) loss_x loss_x 0.3696 (0.4131) acc_x 87.5000 (89.5833) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [5/31] time 0.333 (0.347) data 0.255 (0.270) loss_u loss_u 0.9717 (0.9281) acc_u 3.1250 (8.7500) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [10/31] time 0.348 (0.348) data 0.270 (0.270) loss_u loss_u 0.9385 (0.9224) acc_u 9.3750 (9.3750) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [15/31] time 0.349 (0.347) data 0.271 (0.270) loss_u loss_u 0.9360 (0.9259) acc_u 9.3750 (8.7500) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [20/31] time 0.347 (0.346) data 0.269 (0.268) loss_u loss_u 0.8921 (0.9227) acc_u 12.5000 (9.2188) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [25/31] time 0.349 (0.347) data 0.271 (0.269) loss_u loss_u 0.9902 (0.9322) acc_u 0.0000 (8.0000) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [30/31] time 0.294 (0.342) data 0.215 (0.264) loss_u loss_u 0.9082 (0.9336) acc_u 12.5000 (8.1250) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 420
confident_label rate tensor(0.3811, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 622
clean true:524
clean false:98
clean_rate:0.842443729903537
noisy true:688
noisy false:322
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 1010
epoch [156/200] batch [5/19] time 0.352 (0.362) data 0.275 (0.285) loss_x loss_x 0.3242 (0.3215) acc_x 87.5000 (91.8750) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/19] time 0.338 (0.354) data 0.261 (0.277) loss_x loss_x 0.2566 (0.3111) acc_x 93.7500 (93.1250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/19] time 0.355 (0.351) data 0.277 (0.274) loss_x loss_x 0.3337 (0.3095) acc_x 93.7500 (93.3333) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [5/31] time 0.340 (0.350) data 0.262 (0.273) loss_u loss_u 0.9395 (0.9237) acc_u 6.2500 (8.7500) lr 2.4989e-04 eta 0:00:09
epoch [156/200] batch [10/31] time 0.347 (0.350) data 0.270 (0.272) loss_u loss_u 0.9077 (0.9330) acc_u 9.3750 (7.8125) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [15/31] time 0.350 (0.349) data 0.271 (0.272) loss_u loss_u 0.8823 (0.9277) acc_u 12.5000 (8.5417) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [20/31] time 0.341 (0.350) data 0.263 (0.272) loss_u loss_u 0.9404 (0.9274) acc_u 6.2500 (8.2812) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [25/31] time 0.337 (0.349) data 0.258 (0.272) loss_u loss_u 0.9917 (0.9261) acc_u 0.0000 (8.5000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [30/31] time 0.300 (0.344) data 0.221 (0.266) loss_u loss_u 0.9312 (0.9302) acc_u 9.3750 (8.1250) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 409
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 625
clean true:533
clean false:92
clean_rate:0.8528
noisy true:690
noisy false:317
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 1007
epoch [157/200] batch [5/19] time 0.340 (0.352) data 0.261 (0.274) loss_x loss_x 0.4326 (0.4236) acc_x 84.3750 (90.0000) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/19] time 0.343 (0.348) data 0.265 (0.270) loss_x loss_x 0.3379 (0.3421) acc_x 96.8750 (93.1250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/19] time 0.359 (0.345) data 0.281 (0.268) loss_x loss_x 0.3809 (0.3475) acc_x 93.7500 (92.2917) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [5/31] time 0.345 (0.343) data 0.267 (0.265) loss_u loss_u 0.9678 (0.9366) acc_u 3.1250 (6.2500) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [10/31] time 0.333 (0.344) data 0.255 (0.266) loss_u loss_u 0.9570 (0.9440) acc_u 6.2500 (5.9375) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [15/31] time 0.350 (0.345) data 0.272 (0.267) loss_u loss_u 0.8823 (0.9419) acc_u 15.6250 (6.6667) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [20/31] time 0.343 (0.345) data 0.265 (0.267) loss_u loss_u 0.8779 (0.9390) acc_u 12.5000 (6.8750) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [25/31] time 0.314 (0.343) data 0.236 (0.265) loss_u loss_u 0.9912 (0.9405) acc_u 3.1250 (6.7500) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [30/31] time 0.305 (0.338) data 0.226 (0.261) loss_u loss_u 0.9131 (0.9355) acc_u 9.3750 (7.3958) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 406
confident_label rate tensor(0.3866, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 631
clean true:533
clean false:98
clean_rate:0.8446909667194928
noisy true:693
noisy false:308
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 1001
epoch [158/200] batch [5/19] time 0.339 (0.342) data 0.262 (0.265) loss_x loss_x 0.1674 (0.3542) acc_x 96.8750 (92.5000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/19] time 0.349 (0.348) data 0.272 (0.271) loss_x loss_x 0.2632 (0.3319) acc_x 90.6250 (92.1875) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [15/19] time 0.328 (0.347) data 0.250 (0.269) loss_x loss_x 0.3345 (0.3290) acc_x 93.7500 (91.4583) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [5/31] time 0.344 (0.344) data 0.265 (0.266) loss_u loss_u 0.8979 (0.9328) acc_u 12.5000 (8.1250) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [10/31] time 0.347 (0.344) data 0.269 (0.266) loss_u loss_u 0.9878 (0.9272) acc_u 0.0000 (8.1250) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [15/31] time 0.341 (0.343) data 0.263 (0.265) loss_u loss_u 0.9351 (0.9384) acc_u 6.2500 (6.8750) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [20/31] time 0.354 (0.343) data 0.275 (0.266) loss_u loss_u 0.9062 (0.9398) acc_u 12.5000 (6.8750) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [25/31] time 0.329 (0.343) data 0.251 (0.266) loss_u loss_u 0.9434 (0.9416) acc_u 9.3750 (6.7500) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [30/31] time 0.302 (0.342) data 0.224 (0.264) loss_u loss_u 0.9512 (0.9416) acc_u 3.1250 (6.6667) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 395
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:528
clean false:86
clean_rate:0.8599348534201955
noisy true:709
noisy false:309
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [159/200] batch [5/19] time 0.324 (0.308) data 0.246 (0.230) loss_x loss_x 0.2759 (0.2884) acc_x 93.7500 (93.7500) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/19] time 0.345 (0.324) data 0.267 (0.246) loss_x loss_x 0.3301 (0.3034) acc_x 87.5000 (92.1875) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/19] time 0.338 (0.331) data 0.260 (0.253) loss_x loss_x 0.2666 (0.3038) acc_x 96.8750 (92.7083) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [5/31] time 0.351 (0.336) data 0.274 (0.258) loss_u loss_u 0.8838 (0.9375) acc_u 12.5000 (6.8750) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [10/31] time 0.364 (0.339) data 0.286 (0.261) loss_u loss_u 0.9985 (0.9289) acc_u 0.0000 (7.8125) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [15/31] time 0.355 (0.340) data 0.277 (0.262) loss_u loss_u 0.8408 (0.9289) acc_u 18.7500 (8.1250) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [20/31] time 0.340 (0.341) data 0.262 (0.263) loss_u loss_u 0.9482 (0.9307) acc_u 6.2500 (7.8125) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [25/31] time 0.296 (0.340) data 0.218 (0.262) loss_u loss_u 0.9502 (0.9300) acc_u 6.2500 (8.1250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [30/31] time 0.335 (0.339) data 0.257 (0.261) loss_u loss_u 0.9194 (0.9326) acc_u 9.3750 (7.8125) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 416
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 616
clean true:529
clean false:87
clean_rate:0.8587662337662337
noisy true:687
noisy false:329
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1016
epoch [160/200] batch [5/19] time 0.302 (0.321) data 0.224 (0.243) loss_x loss_x 0.4761 (0.4267) acc_x 87.5000 (90.0000) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/19] time 0.350 (0.330) data 0.272 (0.252) loss_x loss_x 0.3123 (0.3724) acc_x 93.7500 (91.2500) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/19] time 0.353 (0.336) data 0.275 (0.259) loss_x loss_x 0.2280 (0.3593) acc_x 93.7500 (90.6250) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [5/31] time 0.333 (0.339) data 0.256 (0.261) loss_u loss_u 0.9492 (0.9367) acc_u 6.2500 (7.5000) lr 2.0984e-04 eta 0:00:08
epoch [160/200] batch [10/31] time 0.341 (0.339) data 0.264 (0.261) loss_u loss_u 0.9023 (0.9345) acc_u 12.5000 (7.5000) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [15/31] time 0.354 (0.340) data 0.277 (0.262) loss_u loss_u 0.9375 (0.9326) acc_u 6.2500 (7.5000) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [20/31] time 0.356 (0.341) data 0.278 (0.263) loss_u loss_u 0.9399 (0.9321) acc_u 9.3750 (7.9688) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [25/31] time 0.345 (0.342) data 0.268 (0.264) loss_u loss_u 0.9399 (0.9349) acc_u 6.2500 (7.6250) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [30/31] time 0.359 (0.343) data 0.281 (0.265) loss_u loss_u 0.8921 (0.9344) acc_u 12.5000 (7.9167) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 394
confident_label rate tensor(0.3873, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 632
clean true:539
clean false:93
clean_rate:0.8528481012658228
noisy true:699
noisy false:301
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 1000
epoch [161/200] batch [5/19] time 0.302 (0.309) data 0.224 (0.231) loss_x loss_x 0.1893 (0.3576) acc_x 96.8750 (92.5000) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/19] time 0.352 (0.330) data 0.275 (0.252) loss_x loss_x 0.3616 (0.3438) acc_x 90.6250 (92.8125) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/19] time 0.334 (0.334) data 0.257 (0.257) loss_x loss_x 0.5928 (0.3325) acc_x 90.6250 (92.7083) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [5/31] time 0.337 (0.340) data 0.259 (0.262) loss_u loss_u 0.9473 (0.9169) acc_u 6.2500 (10.6250) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [10/31] time 0.347 (0.340) data 0.270 (0.262) loss_u loss_u 0.9697 (0.9328) acc_u 3.1250 (7.8125) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [15/31] time 0.361 (0.341) data 0.283 (0.263) loss_u loss_u 0.9927 (0.9354) acc_u 0.0000 (7.5000) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [20/31] time 0.335 (0.341) data 0.256 (0.263) loss_u loss_u 0.9937 (0.9415) acc_u 0.0000 (6.8750) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [25/31] time 0.323 (0.341) data 0.245 (0.263) loss_u loss_u 0.9082 (0.9411) acc_u 9.3750 (6.8750) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [30/31] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.9746 (0.9430) acc_u 3.1250 (6.6667) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 393
confident_label rate tensor(0.3811, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 622
clean true:531
clean false:91
clean_rate:0.8536977491961415
noisy true:708
noisy false:302
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 1010
epoch [162/200] batch [5/19] time 0.300 (0.319) data 0.222 (0.241) loss_x loss_x 0.4065 (0.3285) acc_x 90.6250 (92.5000) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/19] time 0.360 (0.317) data 0.282 (0.239) loss_x loss_x 0.5635 (0.3689) acc_x 84.3750 (90.9375) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/19] time 0.329 (0.325) data 0.252 (0.247) loss_x loss_x 0.5908 (0.3836) acc_x 78.1250 (89.7917) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [5/31] time 0.347 (0.333) data 0.269 (0.255) loss_u loss_u 0.9409 (0.9292) acc_u 6.2500 (7.5000) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [10/31] time 0.343 (0.336) data 0.264 (0.258) loss_u loss_u 0.9214 (0.9250) acc_u 9.3750 (8.1250) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [15/31] time 0.348 (0.337) data 0.271 (0.259) loss_u loss_u 0.9331 (0.9363) acc_u 9.3750 (7.5000) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [20/31] time 0.333 (0.338) data 0.255 (0.260) loss_u loss_u 0.9639 (0.9401) acc_u 3.1250 (7.1875) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [25/31] time 0.348 (0.338) data 0.270 (0.260) loss_u loss_u 0.9463 (0.9383) acc_u 6.2500 (7.2500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [30/31] time 0.323 (0.338) data 0.245 (0.260) loss_u loss_u 0.9668 (0.9403) acc_u 3.1250 (6.8750) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 406
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 616
clean true:528
clean false:88
clean_rate:0.8571428571428571
noisy true:698
noisy false:318
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1016
epoch [163/200] batch [5/19] time 0.301 (0.314) data 0.223 (0.235) loss_x loss_x 0.2612 (0.2678) acc_x 96.8750 (95.0000) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/19] time 0.342 (0.324) data 0.265 (0.246) loss_x loss_x 0.4858 (0.3132) acc_x 87.5000 (93.4375) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/19] time 0.342 (0.334) data 0.265 (0.256) loss_x loss_x 0.2742 (0.3230) acc_x 90.6250 (92.0833) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [5/31] time 0.353 (0.340) data 0.275 (0.262) loss_u loss_u 0.9448 (0.9235) acc_u 6.2500 (9.3750) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [10/31] time 0.347 (0.340) data 0.269 (0.263) loss_u loss_u 0.9214 (0.9338) acc_u 9.3750 (8.1250) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [15/31] time 0.333 (0.341) data 0.256 (0.264) loss_u loss_u 0.8887 (0.9356) acc_u 12.5000 (7.9167) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [20/31] time 0.338 (0.341) data 0.261 (0.264) loss_u loss_u 0.8784 (0.9289) acc_u 15.6250 (8.4375) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [25/31] time 0.343 (0.342) data 0.264 (0.264) loss_u loss_u 0.9399 (0.9300) acc_u 6.2500 (8.1250) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [30/31] time 0.337 (0.342) data 0.259 (0.264) loss_u loss_u 0.9976 (0.9333) acc_u 0.0000 (7.7083) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 409
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:530
clean false:89
clean_rate:0.8562197092084006
noisy true:693
noisy false:320
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [164/200] batch [5/19] time 0.327 (0.335) data 0.250 (0.257) loss_x loss_x 0.1956 (0.3057) acc_x 100.0000 (95.0000) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/19] time 0.341 (0.338) data 0.264 (0.260) loss_x loss_x 0.7056 (0.3329) acc_x 78.1250 (93.4375) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/19] time 0.342 (0.341) data 0.265 (0.263) loss_x loss_x 0.6289 (0.3285) acc_x 87.5000 (93.3333) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [5/31] time 0.340 (0.346) data 0.262 (0.268) loss_u loss_u 0.9712 (0.9432) acc_u 3.1250 (6.2500) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [10/31] time 0.342 (0.346) data 0.265 (0.268) loss_u loss_u 0.9648 (0.9451) acc_u 3.1250 (6.2500) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [15/31] time 0.342 (0.346) data 0.263 (0.268) loss_u loss_u 0.9326 (0.9396) acc_u 9.3750 (7.0833) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [20/31] time 0.343 (0.346) data 0.264 (0.268) loss_u loss_u 0.9434 (0.9375) acc_u 6.2500 (7.1875) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [25/31] time 0.363 (0.347) data 0.285 (0.269) loss_u loss_u 0.9282 (0.9370) acc_u 6.2500 (7.3750) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [30/31] time 0.337 (0.346) data 0.259 (0.268) loss_u loss_u 0.9712 (0.9389) acc_u 3.1250 (7.1875) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 406
confident_label rate tensor(0.3732, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 609
clean true:519
clean false:90
clean_rate:0.8522167487684729
noisy true:707
noisy false:316
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1023
epoch [165/200] batch [5/19] time 0.310 (0.336) data 0.233 (0.258) loss_x loss_x 0.3511 (0.2696) acc_x 90.6250 (91.8750) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/19] time 0.345 (0.331) data 0.268 (0.253) loss_x loss_x 0.4973 (0.2961) acc_x 90.6250 (93.4375) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/19] time 0.340 (0.340) data 0.262 (0.262) loss_x loss_x 0.3733 (0.3203) acc_x 90.6250 (91.8750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [5/31] time 0.342 (0.341) data 0.264 (0.263) loss_u loss_u 0.9336 (0.9236) acc_u 6.2500 (7.5000) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [10/31] time 0.348 (0.343) data 0.271 (0.265) loss_u loss_u 0.9097 (0.9214) acc_u 9.3750 (8.1250) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [15/31] time 0.345 (0.344) data 0.267 (0.266) loss_u loss_u 0.8999 (0.9171) acc_u 9.3750 (8.9583) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [20/31] time 0.343 (0.343) data 0.265 (0.265) loss_u loss_u 0.8721 (0.9111) acc_u 15.6250 (9.8438) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [25/31] time 0.333 (0.343) data 0.254 (0.265) loss_u loss_u 0.9946 (0.9199) acc_u 0.0000 (8.7500) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [30/31] time 0.342 (0.342) data 0.264 (0.265) loss_u loss_u 0.8901 (0.9240) acc_u 12.5000 (8.2292) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 396
confident_label rate tensor(0.3817, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 623
clean true:529
clean false:94
clean_rate:0.8491171749598716
noisy true:707
noisy false:302
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 1009
epoch [166/200] batch [5/19] time 0.362 (0.350) data 0.284 (0.272) loss_x loss_x 0.1750 (0.2458) acc_x 96.8750 (95.0000) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/19] time 0.343 (0.351) data 0.265 (0.273) loss_x loss_x 0.2727 (0.2880) acc_x 96.8750 (94.6875) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [15/19] time 0.345 (0.348) data 0.268 (0.270) loss_x loss_x 0.2905 (0.2744) acc_x 93.7500 (94.5833) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [5/31] time 0.341 (0.347) data 0.263 (0.270) loss_u loss_u 0.9741 (0.9271) acc_u 3.1250 (8.7500) lr 1.5567e-04 eta 0:00:09
epoch [166/200] batch [10/31] time 0.384 (0.349) data 0.306 (0.271) loss_u loss_u 0.8877 (0.9295) acc_u 15.6250 (8.7500) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [15/31] time 0.337 (0.349) data 0.259 (0.271) loss_u loss_u 0.9023 (0.9360) acc_u 12.5000 (7.9167) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [20/31] time 0.340 (0.348) data 0.261 (0.270) loss_u loss_u 0.9194 (0.9365) acc_u 9.3750 (7.8125) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [25/31] time 0.316 (0.346) data 0.236 (0.269) loss_u loss_u 0.8550 (0.9335) acc_u 18.7500 (8.5000) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [30/31] time 0.330 (0.345) data 0.251 (0.267) loss_u loss_u 0.8652 (0.9383) acc_u 15.6250 (7.7083) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 398
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 624
clean true:533
clean false:91
clean_rate:0.8541666666666666
noisy true:701
noisy false:307
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 1008
epoch [167/200] batch [5/19] time 0.353 (0.350) data 0.276 (0.273) loss_x loss_x 0.2600 (0.3198) acc_x 93.7500 (91.2500) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/19] time 0.349 (0.348) data 0.272 (0.270) loss_x loss_x 0.4404 (0.3478) acc_x 87.5000 (90.9375) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/19] time 0.336 (0.344) data 0.259 (0.267) loss_x loss_x 0.3164 (0.3142) acc_x 96.8750 (92.5000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [5/31] time 0.344 (0.347) data 0.266 (0.269) loss_u loss_u 0.9946 (0.9348) acc_u 0.0000 (7.5000) lr 1.4736e-04 eta 0:00:09
epoch [167/200] batch [10/31] time 0.337 (0.347) data 0.260 (0.269) loss_u loss_u 0.9248 (0.9320) acc_u 9.3750 (8.1250) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [15/31] time 0.347 (0.346) data 0.269 (0.268) loss_u loss_u 0.9551 (0.9369) acc_u 6.2500 (7.9167) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [20/31] time 0.298 (0.341) data 0.219 (0.263) loss_u loss_u 0.9419 (0.9422) acc_u 6.2500 (7.1875) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [25/31] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9351 (0.9408) acc_u 9.3750 (7.5000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [30/31] time 0.337 (0.341) data 0.260 (0.263) loss_u loss_u 0.9136 (0.9377) acc_u 9.3750 (7.6042) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 400
confident_label rate tensor(0.3866, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 631
clean true:537
clean false:94
clean_rate:0.8510301109350238
noisy true:695
noisy false:306
after delete: len(clean_dataset) 631
after delete: len(noisy_dataset) 1001
epoch [168/200] batch [5/19] time 0.348 (0.348) data 0.271 (0.270) loss_x loss_x 0.4094 (0.4600) acc_x 93.7500 (89.3750) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/19] time 0.343 (0.338) data 0.266 (0.261) loss_x loss_x 0.2949 (0.3758) acc_x 90.6250 (90.9375) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/19] time 0.341 (0.339) data 0.264 (0.261) loss_x loss_x 0.2532 (0.3790) acc_x 93.7500 (91.0417) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [5/31] time 0.339 (0.343) data 0.262 (0.265) loss_u loss_u 0.9185 (0.9560) acc_u 9.3750 (4.3750) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [10/31] time 0.348 (0.344) data 0.270 (0.266) loss_u loss_u 0.9497 (0.9547) acc_u 6.2500 (5.0000) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [15/31] time 0.351 (0.346) data 0.273 (0.268) loss_u loss_u 0.9028 (0.9465) acc_u 12.5000 (6.0417) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [20/31] time 0.307 (0.341) data 0.228 (0.263) loss_u loss_u 0.9253 (0.9453) acc_u 6.2500 (6.0938) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [25/31] time 0.352 (0.341) data 0.275 (0.263) loss_u loss_u 0.9639 (0.9440) acc_u 3.1250 (6.2500) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [30/31] time 0.334 (0.341) data 0.256 (0.263) loss_u loss_u 0.9443 (0.9456) acc_u 6.2500 (6.0417) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 399
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:525
clean false:89
clean_rate:0.8550488599348535
noisy true:708
noisy false:310
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [169/200] batch [5/19] time 0.354 (0.348) data 0.277 (0.271) loss_x loss_x 0.4541 (0.3538) acc_x 87.5000 (92.5000) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [10/19] time 0.351 (0.347) data 0.274 (0.269) loss_x loss_x 0.4648 (0.3587) acc_x 87.5000 (91.2500) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/19] time 0.355 (0.347) data 0.277 (0.269) loss_x loss_x 0.0828 (0.3185) acc_x 100.0000 (92.5000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [5/31] time 0.329 (0.345) data 0.252 (0.268) loss_u loss_u 0.9995 (0.9436) acc_u 0.0000 (7.5000) lr 1.3137e-04 eta 0:00:08
epoch [169/200] batch [10/31] time 0.347 (0.345) data 0.270 (0.267) loss_u loss_u 0.9731 (0.9358) acc_u 3.1250 (7.8125) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [15/31] time 0.311 (0.343) data 0.233 (0.265) loss_u loss_u 0.9839 (0.9396) acc_u 0.0000 (6.8750) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [20/31] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9487 (0.9320) acc_u 6.2500 (7.8125) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [25/31] time 0.329 (0.340) data 0.251 (0.262) loss_u loss_u 0.9385 (0.9328) acc_u 6.2500 (7.7500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [30/31] time 0.331 (0.339) data 0.252 (0.261) loss_u loss_u 0.9937 (0.9365) acc_u 0.0000 (7.2917) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 409
confident_label rate tensor(0.3873, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 632
clean true:537
clean false:95
clean_rate:0.8496835443037974
noisy true:686
noisy false:314
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 1000
epoch [170/200] batch [5/19] time 0.296 (0.328) data 0.219 (0.251) loss_x loss_x 0.1664 (0.2654) acc_x 100.0000 (96.2500) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/19] time 0.343 (0.326) data 0.266 (0.248) loss_x loss_x 0.4839 (0.3297) acc_x 87.5000 (94.0625) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/19] time 0.353 (0.332) data 0.275 (0.255) loss_x loss_x 0.1807 (0.3089) acc_x 96.8750 (94.1667) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [5/31] time 0.347 (0.337) data 0.268 (0.259) loss_u loss_u 0.9404 (0.9190) acc_u 9.3750 (10.0000) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [10/31] time 0.359 (0.340) data 0.281 (0.262) loss_u loss_u 0.9795 (0.9427) acc_u 0.0000 (6.5625) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [15/31] time 0.302 (0.335) data 0.224 (0.257) loss_u loss_u 0.9092 (0.9431) acc_u 9.3750 (6.6667) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [20/31] time 0.356 (0.334) data 0.279 (0.256) loss_u loss_u 0.9683 (0.9381) acc_u 6.2500 (7.3438) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [25/31] time 0.333 (0.335) data 0.255 (0.257) loss_u loss_u 0.9146 (0.9367) acc_u 12.5000 (7.5000) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [30/31] time 0.350 (0.335) data 0.272 (0.257) loss_u loss_u 0.9995 (0.9406) acc_u 0.0000 (6.8750) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 385
confident_label rate tensor(0.3903, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 637
clean true:543
clean false:94
clean_rate:0.8524332810047096
noisy true:704
noisy false:291
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 995
epoch [171/200] batch [5/19] time 0.346 (0.351) data 0.269 (0.273) loss_x loss_x 0.2551 (0.3627) acc_x 90.6250 (91.2500) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [10/19] time 0.355 (0.349) data 0.277 (0.271) loss_x loss_x 0.4846 (0.3949) acc_x 93.7500 (90.9375) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [15/19] time 0.344 (0.347) data 0.266 (0.270) loss_x loss_x 0.2303 (0.4266) acc_x 90.6250 (90.2083) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [5/31] time 0.331 (0.348) data 0.254 (0.270) loss_u loss_u 0.9326 (0.9196) acc_u 9.3750 (10.0000) lr 1.1623e-04 eta 0:00:09
epoch [171/200] batch [10/31] time 0.309 (0.348) data 0.229 (0.270) loss_u loss_u 0.9653 (0.9417) acc_u 6.2500 (7.1875) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [15/31] time 0.353 (0.345) data 0.274 (0.267) loss_u loss_u 0.8877 (0.9380) acc_u 12.5000 (7.2917) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [20/31] time 0.354 (0.345) data 0.276 (0.267) loss_u loss_u 0.9766 (0.9447) acc_u 3.1250 (6.5625) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [25/31] time 0.333 (0.345) data 0.255 (0.267) loss_u loss_u 0.8970 (0.9449) acc_u 12.5000 (6.5000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [30/31] time 0.345 (0.344) data 0.267 (0.266) loss_u loss_u 0.9990 (0.9445) acc_u 0.0000 (6.5625) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 393
confident_label rate tensor(0.3854, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 629
clean true:541
clean false:88
clean_rate:0.8600953895071543
noisy true:698
noisy false:305
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 1003
epoch [172/200] batch [5/19] time 0.348 (0.343) data 0.271 (0.265) loss_x loss_x 0.2145 (0.3207) acc_x 96.8750 (92.5000) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/19] time 0.332 (0.341) data 0.255 (0.263) loss_x loss_x 0.2037 (0.3101) acc_x 96.8750 (93.7500) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/19] time 0.345 (0.341) data 0.267 (0.264) loss_x loss_x 0.2351 (0.3017) acc_x 96.8750 (93.5417) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [5/31] time 0.338 (0.343) data 0.259 (0.265) loss_u loss_u 0.8931 (0.9452) acc_u 15.6250 (6.8750) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [10/31] time 0.335 (0.342) data 0.257 (0.265) loss_u loss_u 0.9453 (0.9426) acc_u 6.2500 (7.1875) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [15/31] time 0.354 (0.343) data 0.276 (0.265) loss_u loss_u 0.9536 (0.9399) acc_u 3.1250 (7.2917) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [20/31] time 0.342 (0.343) data 0.265 (0.265) loss_u loss_u 0.9463 (0.9455) acc_u 6.2500 (6.7188) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [25/31] time 0.342 (0.342) data 0.262 (0.264) loss_u loss_u 0.9111 (0.9436) acc_u 12.5000 (6.8750) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [30/31] time 0.358 (0.342) data 0.280 (0.264) loss_u loss_u 0.8936 (0.9398) acc_u 12.5000 (7.2917) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 394
confident_label rate tensor(0.3879, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 633
clean true:540
clean false:93
clean_rate:0.8530805687203792
noisy true:698
noisy false:301
after delete: len(clean_dataset) 633
after delete: len(noisy_dataset) 999
epoch [173/200] batch [5/19] time 0.346 (0.351) data 0.269 (0.273) loss_x loss_x 0.2769 (0.2809) acc_x 93.7500 (93.7500) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/19] time 0.340 (0.347) data 0.262 (0.270) loss_x loss_x 0.2883 (0.3176) acc_x 93.7500 (92.5000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/19] time 0.353 (0.347) data 0.276 (0.270) loss_x loss_x 0.2225 (0.3463) acc_x 96.8750 (92.2917) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [5/31] time 0.331 (0.334) data 0.253 (0.257) loss_u loss_u 0.9658 (0.9673) acc_u 3.1250 (4.3750) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [10/31] time 0.335 (0.336) data 0.257 (0.258) loss_u loss_u 0.9731 (0.9682) acc_u 3.1250 (3.7500) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [15/31] time 0.329 (0.336) data 0.252 (0.259) loss_u loss_u 0.9482 (0.9615) acc_u 6.2500 (4.3750) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [20/31] time 0.340 (0.337) data 0.262 (0.259) loss_u loss_u 0.8638 (0.9515) acc_u 18.7500 (5.4688) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [25/31] time 0.340 (0.337) data 0.263 (0.259) loss_u loss_u 0.9033 (0.9490) acc_u 12.5000 (5.8750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [30/31] time 0.332 (0.337) data 0.253 (0.259) loss_u loss_u 0.9038 (0.9474) acc_u 9.3750 (5.9375) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 406
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:528
clean false:91
clean_rate:0.8529886914378029
noisy true:698
noisy false:315
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [174/200] batch [5/19] time 0.338 (0.343) data 0.261 (0.266) loss_x loss_x 0.4141 (0.3541) acc_x 87.5000 (91.2500) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/19] time 0.345 (0.343) data 0.268 (0.265) loss_x loss_x 0.1544 (0.3278) acc_x 100.0000 (91.8750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [15/19] time 0.338 (0.341) data 0.261 (0.264) loss_x loss_x 0.2793 (0.3278) acc_x 93.7500 (92.5000) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [5/31] time 0.327 (0.332) data 0.248 (0.255) loss_u loss_u 0.9546 (0.9660) acc_u 6.2500 (3.7500) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [10/31] time 0.351 (0.330) data 0.272 (0.252) loss_u loss_u 0.8931 (0.9387) acc_u 12.5000 (7.1875) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [15/31] time 0.344 (0.332) data 0.265 (0.255) loss_u loss_u 0.9688 (0.9401) acc_u 3.1250 (6.8750) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [20/31] time 0.336 (0.334) data 0.258 (0.256) loss_u loss_u 0.9360 (0.9372) acc_u 6.2500 (6.8750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [25/31] time 0.350 (0.334) data 0.272 (0.256) loss_u loss_u 0.9336 (0.9412) acc_u 9.3750 (6.5000) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [30/31] time 0.347 (0.336) data 0.270 (0.258) loss_u loss_u 0.9390 (0.9350) acc_u 6.2500 (7.2917) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 408
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:533
clean false:86
clean_rate:0.8610662358642972
noisy true:691
noisy false:322
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [175/200] batch [5/19] time 0.365 (0.357) data 0.288 (0.279) loss_x loss_x 0.2917 (0.1864) acc_x 93.7500 (97.5000) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/19] time 0.334 (0.347) data 0.257 (0.269) loss_x loss_x 0.1945 (0.2470) acc_x 96.8750 (94.6875) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [15/19] time 0.343 (0.346) data 0.265 (0.268) loss_x loss_x 0.3450 (0.2706) acc_x 87.5000 (93.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [5/31] time 0.364 (0.345) data 0.286 (0.268) loss_u loss_u 0.9951 (0.9172) acc_u 0.0000 (9.3750) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [10/31] time 0.297 (0.342) data 0.219 (0.264) loss_u loss_u 0.8882 (0.9215) acc_u 12.5000 (8.4375) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [15/31] time 0.305 (0.335) data 0.225 (0.257) loss_u loss_u 0.9097 (0.9207) acc_u 12.5000 (8.5417) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [20/31] time 0.349 (0.335) data 0.271 (0.257) loss_u loss_u 0.9653 (0.9293) acc_u 3.1250 (7.6562) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [25/31] time 0.341 (0.336) data 0.262 (0.258) loss_u loss_u 0.9380 (0.9294) acc_u 6.2500 (7.6250) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [30/31] time 0.346 (0.337) data 0.267 (0.259) loss_u loss_u 0.8276 (0.9284) acc_u 18.7500 (7.7083) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 405
confident_label rate tensor(0.3811, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 622
clean true:534
clean false:88
clean_rate:0.8585209003215434
noisy true:693
noisy false:317
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 1010
epoch [176/200] batch [5/19] time 0.339 (0.349) data 0.262 (0.272) loss_x loss_x 0.3564 (0.2514) acc_x 96.8750 (95.6250) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/19] time 0.321 (0.343) data 0.244 (0.265) loss_x loss_x 0.3157 (0.2557) acc_x 90.6250 (94.0625) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/19] time 0.350 (0.341) data 0.272 (0.264) loss_x loss_x 0.2983 (0.2647) acc_x 96.8750 (93.9583) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [5/31] time 0.337 (0.342) data 0.259 (0.265) loss_u loss_u 0.8789 (0.9461) acc_u 15.6250 (5.6250) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [10/31] time 0.332 (0.341) data 0.254 (0.264) loss_u loss_u 0.9639 (0.9545) acc_u 3.1250 (5.0000) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [15/31] time 0.292 (0.337) data 0.213 (0.259) loss_u loss_u 0.8286 (0.9455) acc_u 18.7500 (6.2500) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [20/31] time 0.348 (0.334) data 0.270 (0.256) loss_u loss_u 0.9707 (0.9508) acc_u 3.1250 (5.7812) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [25/31] time 0.347 (0.335) data 0.269 (0.257) loss_u loss_u 0.9287 (0.9436) acc_u 6.2500 (6.5000) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [30/31] time 0.347 (0.337) data 0.269 (0.259) loss_u loss_u 0.9849 (0.9434) acc_u 3.1250 (6.5625) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 410
confident_label rate tensor(0.3860, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 630
clean true:536
clean false:94
clean_rate:0.8507936507936508
noisy true:686
noisy false:316
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 1002
epoch [177/200] batch [5/19] time 0.354 (0.349) data 0.276 (0.271) loss_x loss_x 0.3025 (0.3178) acc_x 90.6250 (95.0000) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/19] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.2040 (0.3141) acc_x 93.7500 (94.0625) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/19] time 0.335 (0.336) data 0.258 (0.259) loss_x loss_x 0.2180 (0.3031) acc_x 93.7500 (94.1667) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [5/31] time 0.380 (0.343) data 0.301 (0.265) loss_u loss_u 0.9424 (0.9500) acc_u 6.2500 (5.6250) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [10/31] time 0.339 (0.342) data 0.261 (0.264) loss_u loss_u 0.9219 (0.9340) acc_u 6.2500 (7.1875) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [15/31] time 0.340 (0.343) data 0.262 (0.265) loss_u loss_u 0.8960 (0.9323) acc_u 12.5000 (7.0833) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [20/31] time 0.361 (0.342) data 0.282 (0.264) loss_u loss_u 0.9478 (0.9372) acc_u 6.2500 (6.7188) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [25/31] time 0.353 (0.344) data 0.275 (0.266) loss_u loss_u 0.9326 (0.9372) acc_u 9.3750 (7.0000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [30/31] time 0.336 (0.344) data 0.258 (0.266) loss_u loss_u 0.8311 (0.9349) acc_u 18.7500 (7.2917) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 402
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 624
clean true:530
clean false:94
clean_rate:0.8493589743589743
noisy true:700
noisy false:308
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 1008
epoch [178/200] batch [5/19] time 0.353 (0.346) data 0.275 (0.269) loss_x loss_x 0.2435 (0.4459) acc_x 93.7500 (90.0000) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/19] time 0.344 (0.347) data 0.267 (0.270) loss_x loss_x 0.4290 (0.3382) acc_x 90.6250 (93.4375) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/19] time 0.357 (0.347) data 0.279 (0.269) loss_x loss_x 0.1661 (0.2873) acc_x 93.7500 (94.1667) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [5/31] time 0.370 (0.347) data 0.292 (0.270) loss_u loss_u 0.8984 (0.9087) acc_u 12.5000 (10.6250) lr 7.0224e-05 eta 0:00:09
epoch [178/200] batch [10/31] time 0.342 (0.348) data 0.263 (0.270) loss_u loss_u 0.9390 (0.9235) acc_u 6.2500 (8.7500) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [15/31] time 0.337 (0.344) data 0.259 (0.266) loss_u loss_u 0.9375 (0.9299) acc_u 6.2500 (7.7083) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [20/31] time 0.352 (0.343) data 0.273 (0.265) loss_u loss_u 0.9429 (0.9298) acc_u 9.3750 (8.1250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [25/31] time 0.338 (0.343) data 0.260 (0.265) loss_u loss_u 0.9849 (0.9363) acc_u 3.1250 (7.3750) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [30/31] time 0.397 (0.344) data 0.319 (0.266) loss_u loss_u 0.9751 (0.9360) acc_u 3.1250 (7.3958) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 401
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:526
clean false:93
clean_rate:0.8497576736672051
noisy true:705
noisy false:308
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [179/200] batch [5/19] time 0.350 (0.349) data 0.273 (0.272) loss_x loss_x 0.3035 (0.3544) acc_x 93.7500 (88.7500) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/19] time 0.348 (0.350) data 0.269 (0.272) loss_x loss_x 0.1445 (0.3311) acc_x 96.8750 (90.6250) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/19] time 0.340 (0.348) data 0.262 (0.270) loss_x loss_x 0.6792 (0.3589) acc_x 81.2500 (90.0000) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [5/31] time 0.339 (0.346) data 0.261 (0.268) loss_u loss_u 0.9585 (0.9235) acc_u 3.1250 (8.1250) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [10/31] time 0.324 (0.345) data 0.245 (0.267) loss_u loss_u 0.9219 (0.9344) acc_u 9.3750 (7.1875) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [15/31] time 0.349 (0.341) data 0.271 (0.263) loss_u loss_u 0.9175 (0.9331) acc_u 9.3750 (7.2917) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [20/31] time 0.358 (0.342) data 0.280 (0.264) loss_u loss_u 0.9595 (0.9307) acc_u 3.1250 (7.6562) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [25/31] time 0.349 (0.343) data 0.270 (0.265) loss_u loss_u 0.9609 (0.9322) acc_u 3.1250 (7.3750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [30/31] time 0.341 (0.343) data 0.263 (0.266) loss_u loss_u 0.9492 (0.9312) acc_u 6.2500 (7.6042) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 399
confident_label rate tensor(0.3805, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 621
clean true:531
clean false:90
clean_rate:0.855072463768116
noisy true:702
noisy false:309
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 1011
epoch [180/200] batch [5/19] time 0.348 (0.362) data 0.271 (0.285) loss_x loss_x 0.4460 (0.3886) acc_x 87.5000 (90.0000) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [10/19] time 0.344 (0.354) data 0.267 (0.276) loss_x loss_x 0.3806 (0.3143) acc_x 84.3750 (92.1875) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/19] time 0.356 (0.349) data 0.279 (0.272) loss_x loss_x 0.2372 (0.2902) acc_x 93.7500 (92.9167) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [5/31] time 0.374 (0.348) data 0.295 (0.271) loss_u loss_u 0.9702 (0.9481) acc_u 3.1250 (6.2500) lr 5.9119e-05 eta 0:00:09
epoch [180/200] batch [10/31] time 0.331 (0.346) data 0.254 (0.268) loss_u loss_u 0.9448 (0.9484) acc_u 6.2500 (5.6250) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [15/31] time 0.307 (0.341) data 0.228 (0.263) loss_u loss_u 0.9346 (0.9389) acc_u 6.2500 (7.2917) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [20/31] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9717 (0.9399) acc_u 9.3750 (7.5000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [25/31] time 0.363 (0.341) data 0.285 (0.263) loss_u loss_u 0.9692 (0.9422) acc_u 3.1250 (7.2500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [30/31] time 0.358 (0.342) data 0.280 (0.264) loss_u loss_u 0.9575 (0.9408) acc_u 3.1250 (7.2917) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 404
confident_label rate tensor(0.3848, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 628
clean true:537
clean false:91
clean_rate:0.8550955414012739
noisy true:691
noisy false:313
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 1004
epoch [181/200] batch [5/19] time 0.353 (0.356) data 0.275 (0.278) loss_x loss_x 0.4661 (0.3729) acc_x 84.3750 (90.0000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/19] time 0.353 (0.355) data 0.276 (0.277) loss_x loss_x 0.6240 (0.3725) acc_x 87.5000 (91.8750) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/19] time 0.340 (0.352) data 0.262 (0.274) loss_x loss_x 0.4570 (0.3695) acc_x 90.6250 (91.4583) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [5/31] time 0.329 (0.341) data 0.251 (0.263) loss_u loss_u 0.9268 (0.9327) acc_u 9.3750 (6.8750) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [10/31] time 0.350 (0.343) data 0.272 (0.265) loss_u loss_u 0.9346 (0.9304) acc_u 6.2500 (7.8125) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [15/31] time 0.306 (0.338) data 0.227 (0.260) loss_u loss_u 0.9644 (0.9385) acc_u 3.1250 (6.8750) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [20/31] time 0.340 (0.338) data 0.262 (0.260) loss_u loss_u 0.9131 (0.9405) acc_u 9.3750 (6.7188) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [25/31] time 0.338 (0.338) data 0.261 (0.260) loss_u loss_u 0.9326 (0.9407) acc_u 9.3750 (6.8750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [30/31] time 0.332 (0.339) data 0.254 (0.261) loss_u loss_u 0.9092 (0.9403) acc_u 12.5000 (6.9792) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 392
confident_label rate tensor(0.3848, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 628
clean true:537
clean false:91
clean_rate:0.8550955414012739
noisy true:703
noisy false:301
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 1004
epoch [182/200] batch [5/19] time 0.343 (0.354) data 0.265 (0.276) loss_x loss_x 0.3320 (0.3475) acc_x 87.5000 (92.5000) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/19] time 0.350 (0.350) data 0.272 (0.273) loss_x loss_x 0.2062 (0.2729) acc_x 96.8750 (95.3125) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/19] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.2340 (0.2734) acc_x 96.8750 (95.0000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [5/31] time 0.349 (0.346) data 0.271 (0.268) loss_u loss_u 0.9971 (0.9727) acc_u 0.0000 (2.5000) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [10/31] time 0.296 (0.342) data 0.217 (0.265) loss_u loss_u 0.9648 (0.9541) acc_u 3.1250 (4.6875) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [15/31] time 0.305 (0.338) data 0.227 (0.260) loss_u loss_u 0.9668 (0.9463) acc_u 3.1250 (5.6250) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [20/31] time 0.339 (0.339) data 0.260 (0.261) loss_u loss_u 0.9106 (0.9460) acc_u 9.3750 (5.7812) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [25/31] time 0.334 (0.340) data 0.257 (0.262) loss_u loss_u 0.9546 (0.9455) acc_u 6.2500 (6.1250) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [30/31] time 0.342 (0.340) data 0.263 (0.262) loss_u loss_u 0.9038 (0.9423) acc_u 9.3750 (6.3542) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 392
confident_label rate tensor(0.3854, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 629
clean true:536
clean false:93
clean_rate:0.8521462639109698
noisy true:704
noisy false:299
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 1003
epoch [183/200] batch [5/19] time 0.363 (0.365) data 0.286 (0.287) loss_x loss_x 0.1653 (0.2381) acc_x 96.8750 (94.3750) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [10/19] time 0.348 (0.355) data 0.270 (0.277) loss_x loss_x 0.2634 (0.2959) acc_x 93.7500 (92.8125) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/19] time 0.359 (0.353) data 0.282 (0.275) loss_x loss_x 0.4900 (0.3299) acc_x 84.3750 (91.6667) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [5/31] time 0.347 (0.349) data 0.270 (0.271) loss_u loss_u 0.9053 (0.9149) acc_u 12.5000 (10.6250) lr 4.4207e-05 eta 0:00:09
epoch [183/200] batch [10/31] time 0.322 (0.345) data 0.243 (0.267) loss_u loss_u 0.9341 (0.9232) acc_u 6.2500 (9.3750) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [15/31] time 0.337 (0.344) data 0.259 (0.266) loss_u loss_u 0.9624 (0.9433) acc_u 3.1250 (6.6667) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [20/31] time 0.349 (0.345) data 0.271 (0.267) loss_u loss_u 0.9116 (0.9425) acc_u 12.5000 (6.7188) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [25/31] time 0.334 (0.344) data 0.256 (0.267) loss_u loss_u 0.9424 (0.9433) acc_u 6.2500 (6.5000) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [30/31] time 0.339 (0.345) data 0.261 (0.267) loss_u loss_u 0.9028 (0.9395) acc_u 9.3750 (6.8750) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 402
confident_label rate tensor(0.3817, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 623
clean true:532
clean false:91
clean_rate:0.8539325842696629
noisy true:698
noisy false:311
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 1009
epoch [184/200] batch [5/19] time 0.354 (0.366) data 0.277 (0.288) loss_x loss_x 0.1429 (0.3684) acc_x 96.8750 (92.5000) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [10/19] time 0.343 (0.354) data 0.266 (0.276) loss_x loss_x 0.5278 (0.3731) acc_x 90.6250 (91.2500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/19] time 0.341 (0.350) data 0.263 (0.273) loss_x loss_x 0.3435 (0.3413) acc_x 93.7500 (92.5000) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [5/31] time 0.332 (0.345) data 0.254 (0.267) loss_u loss_u 0.9497 (0.9318) acc_u 3.1250 (6.8750) lr 3.9706e-05 eta 0:00:08
epoch [184/200] batch [10/31] time 0.322 (0.344) data 0.244 (0.266) loss_u loss_u 0.9595 (0.9230) acc_u 6.2500 (8.1250) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [15/31] time 0.346 (0.344) data 0.268 (0.266) loss_u loss_u 0.8101 (0.9224) acc_u 21.8750 (8.5417) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [20/31] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.9878 (0.9292) acc_u 0.0000 (7.6562) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [25/31] time 0.332 (0.343) data 0.254 (0.265) loss_u loss_u 0.9556 (0.9321) acc_u 3.1250 (7.3750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [30/31] time 0.351 (0.343) data 0.272 (0.265) loss_u loss_u 0.9976 (0.9345) acc_u 0.0000 (7.1875) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 401
confident_label rate tensor(0.3848, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 628
clean true:538
clean false:90
clean_rate:0.856687898089172
noisy true:693
noisy false:311
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 1004
epoch [185/200] batch [5/19] time 0.347 (0.348) data 0.269 (0.270) loss_x loss_x 0.1666 (0.2491) acc_x 96.8750 (93.7500) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/19] time 0.348 (0.344) data 0.270 (0.266) loss_x loss_x 0.0951 (0.2665) acc_x 100.0000 (93.7500) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/19] time 0.349 (0.344) data 0.272 (0.267) loss_x loss_x 0.1609 (0.2592) acc_x 93.7500 (93.9583) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [5/31] time 0.357 (0.333) data 0.280 (0.255) loss_u loss_u 0.9224 (0.9285) acc_u 12.5000 (8.7500) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [10/31] time 0.365 (0.334) data 0.287 (0.256) loss_u loss_u 0.9111 (0.9228) acc_u 9.3750 (9.3750) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [15/31] time 0.322 (0.334) data 0.244 (0.256) loss_u loss_u 0.9395 (0.9317) acc_u 6.2500 (7.9167) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [20/31] time 0.340 (0.334) data 0.262 (0.256) loss_u loss_u 0.9346 (0.9364) acc_u 6.2500 (7.5000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [25/31] time 0.332 (0.334) data 0.254 (0.256) loss_u loss_u 0.9688 (0.9402) acc_u 3.1250 (7.2500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [30/31] time 0.343 (0.334) data 0.265 (0.256) loss_u loss_u 0.8818 (0.9393) acc_u 12.5000 (7.3958) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 407
confident_label rate tensor(0.3805, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 621
clean true:526
clean false:95
clean_rate:0.8470209339774557
noisy true:699
noisy false:312
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 1011
epoch [186/200] batch [5/19] time 0.370 (0.357) data 0.293 (0.279) loss_x loss_x 0.0748 (0.2931) acc_x 100.0000 (92.5000) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/19] time 0.338 (0.351) data 0.261 (0.274) loss_x loss_x 0.2029 (0.2839) acc_x 93.7500 (92.1875) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/19] time 0.296 (0.347) data 0.218 (0.269) loss_x loss_x 0.1597 (0.2915) acc_x 96.8750 (92.9167) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [5/31] time 0.301 (0.332) data 0.224 (0.254) loss_u loss_u 0.9380 (0.9504) acc_u 6.2500 (5.6250) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [10/31] time 0.348 (0.334) data 0.271 (0.256) loss_u loss_u 0.9766 (0.9476) acc_u 3.1250 (5.9375) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [15/31] time 0.341 (0.336) data 0.264 (0.258) loss_u loss_u 0.9575 (0.9489) acc_u 6.2500 (5.6250) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [20/31] time 0.357 (0.338) data 0.278 (0.260) loss_u loss_u 0.9414 (0.9440) acc_u 6.2500 (6.0938) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [25/31] time 0.353 (0.338) data 0.275 (0.261) loss_u loss_u 0.9487 (0.9422) acc_u 6.2500 (6.5000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [30/31] time 0.368 (0.339) data 0.290 (0.261) loss_u loss_u 0.8921 (0.9381) acc_u 12.5000 (6.8750) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 389
confident_label rate tensor(0.3836, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 626
clean true:534
clean false:92
clean_rate:0.853035143769968
noisy true:709
noisy false:297
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 1006
epoch [187/200] batch [5/19] time 0.364 (0.351) data 0.286 (0.273) loss_x loss_x 0.2030 (0.3132) acc_x 96.8750 (93.1250) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/19] time 0.349 (0.349) data 0.272 (0.272) loss_x loss_x 0.2095 (0.3331) acc_x 100.0000 (92.8125) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/19] time 0.347 (0.348) data 0.269 (0.270) loss_x loss_x 0.1444 (0.3250) acc_x 96.8750 (92.5000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [5/31] time 0.352 (0.344) data 0.274 (0.266) loss_u loss_u 0.9312 (0.9254) acc_u 9.3750 (8.1250) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [10/31] time 0.348 (0.344) data 0.269 (0.266) loss_u loss_u 0.9111 (0.9247) acc_u 9.3750 (8.1250) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [15/31] time 0.346 (0.344) data 0.268 (0.266) loss_u loss_u 0.9668 (0.9347) acc_u 3.1250 (7.0833) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [20/31] time 0.340 (0.345) data 0.261 (0.267) loss_u loss_u 0.9609 (0.9377) acc_u 3.1250 (6.5625) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [25/31] time 0.353 (0.346) data 0.274 (0.268) loss_u loss_u 0.9146 (0.9349) acc_u 9.3750 (7.1250) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [30/31] time 0.337 (0.346) data 0.258 (0.268) loss_u loss_u 0.9507 (0.9324) acc_u 6.2500 (7.3958) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 398
confident_label rate tensor(0.3817, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 623
clean true:536
clean false:87
clean_rate:0.8603531300160514
noisy true:698
noisy false:311
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 1009
epoch [188/200] batch [5/19] time 0.345 (0.353) data 0.265 (0.275) loss_x loss_x 0.3826 (0.3202) acc_x 93.7500 (92.5000) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/19] time 0.300 (0.337) data 0.221 (0.258) loss_x loss_x 0.4097 (0.3069) acc_x 93.7500 (92.5000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/19] time 0.347 (0.337) data 0.269 (0.259) loss_x loss_x 0.3022 (0.2804) acc_x 87.5000 (93.1250) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [5/31] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.9165 (0.9222) acc_u 9.3750 (9.3750) lr 2.4083e-05 eta 0:00:08
epoch [188/200] batch [10/31] time 0.353 (0.341) data 0.275 (0.263) loss_u loss_u 0.9692 (0.9333) acc_u 3.1250 (8.1250) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [15/31] time 0.353 (0.342) data 0.275 (0.264) loss_u loss_u 0.9932 (0.9357) acc_u 0.0000 (7.5000) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [20/31] time 0.347 (0.343) data 0.268 (0.265) loss_u loss_u 0.9502 (0.9381) acc_u 6.2500 (7.5000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [25/31] time 0.324 (0.342) data 0.246 (0.264) loss_u loss_u 0.9224 (0.9374) acc_u 9.3750 (7.5000) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [30/31] time 0.321 (0.342) data 0.243 (0.264) loss_u loss_u 0.8813 (0.9351) acc_u 15.6250 (8.1250) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 398
confident_label rate tensor(0.3817, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 623
clean true:530
clean false:93
clean_rate:0.8507223113964687
noisy true:704
noisy false:305
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 1009
epoch [189/200] batch [5/19] time 0.341 (0.354) data 0.262 (0.276) loss_x loss_x 0.2637 (0.2922) acc_x 93.7500 (92.5000) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/19] time 0.349 (0.348) data 0.271 (0.270) loss_x loss_x 0.3384 (0.2921) acc_x 87.5000 (92.8125) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/19] time 0.345 (0.346) data 0.267 (0.268) loss_x loss_x 0.3982 (0.2803) acc_x 90.6250 (93.1250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [5/31] time 0.344 (0.346) data 0.266 (0.268) loss_u loss_u 0.9541 (0.9483) acc_u 3.1250 (5.0000) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [10/31] time 0.345 (0.345) data 0.267 (0.267) loss_u loss_u 0.9458 (0.9418) acc_u 6.2500 (6.2500) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [15/31] time 0.348 (0.345) data 0.270 (0.268) loss_u loss_u 0.9565 (0.9405) acc_u 6.2500 (6.8750) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [20/31] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.9595 (0.9413) acc_u 3.1250 (6.7188) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [25/31] time 0.355 (0.345) data 0.276 (0.267) loss_u loss_u 0.9502 (0.9409) acc_u 6.2500 (6.7500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [30/31] time 0.354 (0.345) data 0.276 (0.267) loss_u loss_u 0.9180 (0.9342) acc_u 9.3750 (7.6042) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 404
confident_label rate tensor(0.3909, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 638
clean true:536
clean false:102
clean_rate:0.8401253918495298
noisy true:692
noisy false:302
after delete: len(clean_dataset) 638
after delete: len(noisy_dataset) 994
epoch [190/200] batch [5/19] time 0.323 (0.310) data 0.245 (0.232) loss_x loss_x 0.2815 (0.2255) acc_x 93.7500 (95.0000) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/19] time 0.339 (0.326) data 0.261 (0.248) loss_x loss_x 0.2910 (0.2627) acc_x 93.7500 (94.0625) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/19] time 0.338 (0.331) data 0.260 (0.253) loss_x loss_x 0.3201 (0.2855) acc_x 90.6250 (94.1667) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [5/31] time 0.344 (0.336) data 0.266 (0.258) loss_u loss_u 0.9619 (0.9417) acc_u 6.2500 (7.5000) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [10/31] time 0.341 (0.337) data 0.263 (0.259) loss_u loss_u 0.9551 (0.9501) acc_u 6.2500 (5.9375) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [15/31] time 0.355 (0.339) data 0.277 (0.261) loss_u loss_u 0.9531 (0.9450) acc_u 6.2500 (6.6667) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [20/31] time 0.350 (0.340) data 0.272 (0.262) loss_u loss_u 0.9741 (0.9416) acc_u 3.1250 (7.0312) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [25/31] time 0.318 (0.340) data 0.240 (0.262) loss_u loss_u 0.9282 (0.9424) acc_u 9.3750 (7.1250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [30/31] time 0.342 (0.340) data 0.265 (0.262) loss_u loss_u 0.9575 (0.9469) acc_u 6.2500 (6.4583) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 402
confident_label rate tensor(0.3842, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 627
clean true:536
clean false:91
clean_rate:0.8548644338118022
noisy true:694
noisy false:311
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 1005
epoch [191/200] batch [5/19] time 0.307 (0.312) data 0.228 (0.234) loss_x loss_x 0.6279 (0.4317) acc_x 81.2500 (88.1250) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/19] time 0.346 (0.327) data 0.268 (0.249) loss_x loss_x 0.3025 (0.3403) acc_x 93.7500 (90.9375) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/19] time 0.343 (0.336) data 0.265 (0.258) loss_x loss_x 0.4182 (0.3335) acc_x 81.2500 (90.4167) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [5/31] time 0.334 (0.337) data 0.255 (0.259) loss_u loss_u 0.8960 (0.9046) acc_u 9.3750 (10.6250) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [10/31] time 0.344 (0.338) data 0.267 (0.260) loss_u loss_u 0.9414 (0.9193) acc_u 6.2500 (9.0625) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [15/31] time 0.336 (0.339) data 0.259 (0.261) loss_u loss_u 0.9258 (0.9228) acc_u 6.2500 (8.5417) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [20/31] time 0.348 (0.340) data 0.270 (0.262) loss_u loss_u 0.9678 (0.9290) acc_u 6.2500 (8.1250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [25/31] time 0.390 (0.342) data 0.312 (0.264) loss_u loss_u 0.9419 (0.9330) acc_u 6.2500 (7.6250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [30/31] time 0.328 (0.341) data 0.250 (0.264) loss_u loss_u 0.9971 (0.9385) acc_u 0.0000 (7.0833) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 385
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 617
clean true:533
clean false:84
clean_rate:0.8638573743922204
noisy true:714
noisy false:301
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 1015
epoch [192/200] batch [5/19] time 0.324 (0.327) data 0.246 (0.249) loss_x loss_x 0.3052 (0.3395) acc_x 90.6250 (94.3750) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/19] time 0.361 (0.341) data 0.283 (0.263) loss_x loss_x 0.2837 (0.2953) acc_x 93.7500 (94.3750) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/19] time 0.287 (0.337) data 0.209 (0.259) loss_x loss_x 0.4360 (0.2972) acc_x 87.5000 (93.9583) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [5/31] time 0.345 (0.340) data 0.266 (0.262) loss_u loss_u 0.9624 (0.9349) acc_u 6.2500 (7.5000) lr 1.2312e-05 eta 0:00:08
epoch [192/200] batch [10/31] time 0.343 (0.338) data 0.265 (0.260) loss_u loss_u 0.9668 (0.9369) acc_u 3.1250 (6.8750) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [15/31] time 0.348 (0.339) data 0.269 (0.261) loss_u loss_u 0.9282 (0.9480) acc_u 9.3750 (5.6250) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [20/31] time 0.347 (0.338) data 0.269 (0.260) loss_u loss_u 0.9604 (0.9408) acc_u 6.2500 (6.5625) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [25/31] time 0.338 (0.337) data 0.259 (0.259) loss_u loss_u 0.9302 (0.9380) acc_u 6.2500 (6.7500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [30/31] time 0.338 (0.338) data 0.260 (0.260) loss_u loss_u 0.9028 (0.9341) acc_u 9.3750 (7.1875) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 410
confident_label rate tensor(0.3811, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 622
clean true:530
clean false:92
clean_rate:0.8520900321543409
noisy true:692
noisy false:318
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 1010
epoch [193/200] batch [5/19] time 0.308 (0.331) data 0.230 (0.253) loss_x loss_x 0.1509 (0.2657) acc_x 100.0000 (93.1250) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/19] time 0.350 (0.323) data 0.272 (0.245) loss_x loss_x 0.3125 (0.2933) acc_x 93.7500 (92.8125) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/19] time 0.341 (0.331) data 0.263 (0.253) loss_x loss_x 0.2028 (0.2788) acc_x 96.8750 (93.7500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [5/31] time 0.338 (0.334) data 0.258 (0.256) loss_u loss_u 0.9199 (0.9189) acc_u 9.3750 (9.3750) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [10/31] time 0.350 (0.335) data 0.272 (0.257) loss_u loss_u 0.9663 (0.9333) acc_u 3.1250 (7.8125) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [15/31] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9438 (0.9388) acc_u 6.2500 (6.8750) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [20/31] time 0.345 (0.336) data 0.267 (0.258) loss_u loss_u 0.9707 (0.9312) acc_u 3.1250 (7.8125) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [25/31] time 0.333 (0.336) data 0.255 (0.258) loss_u loss_u 0.9941 (0.9349) acc_u 0.0000 (7.3750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [30/31] time 0.358 (0.338) data 0.280 (0.260) loss_u loss_u 0.9385 (0.9353) acc_u 6.2500 (7.2917) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 383
confident_label rate tensor(0.3903, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 637
clean true:546
clean false:91
clean_rate:0.8571428571428571
noisy true:703
noisy false:292
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 995
epoch [194/200] batch [5/19] time 0.324 (0.341) data 0.245 (0.262) loss_x loss_x 0.1924 (0.2473) acc_x 96.8750 (93.1250) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/19] time 0.348 (0.341) data 0.271 (0.263) loss_x loss_x 0.3455 (0.2417) acc_x 93.7500 (93.7500) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/19] time 0.358 (0.341) data 0.281 (0.263) loss_x loss_x 0.4963 (0.2883) acc_x 87.5000 (91.8750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [5/31] time 0.346 (0.343) data 0.268 (0.265) loss_u loss_u 0.9263 (0.9476) acc_u 6.2500 (5.6250) lr 7.8853e-06 eta 0:00:08
epoch [194/200] batch [10/31] time 0.332 (0.342) data 0.254 (0.264) loss_u loss_u 0.9204 (0.9488) acc_u 9.3750 (5.3125) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [15/31] time 0.334 (0.340) data 0.255 (0.262) loss_u loss_u 0.9033 (0.9413) acc_u 9.3750 (6.0417) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [20/31] time 0.340 (0.340) data 0.263 (0.262) loss_u loss_u 0.9033 (0.9431) acc_u 12.5000 (6.0938) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [25/31] time 0.335 (0.340) data 0.257 (0.262) loss_u loss_u 0.9126 (0.9425) acc_u 9.3750 (6.1250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [30/31] time 0.345 (0.341) data 0.267 (0.263) loss_u loss_u 0.9951 (0.9458) acc_u 0.0000 (5.8333) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 402
confident_label rate tensor(0.3817, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 623
clean true:535
clean false:88
clean_rate:0.8587479935794543
noisy true:695
noisy false:314
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 1009
epoch [195/200] batch [5/19] time 0.299 (0.326) data 0.222 (0.248) loss_x loss_x 0.4080 (0.3885) acc_x 87.5000 (90.0000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/19] time 0.351 (0.332) data 0.273 (0.254) loss_x loss_x 0.2581 (0.3737) acc_x 96.8750 (91.5625) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/19] time 0.333 (0.334) data 0.256 (0.256) loss_x loss_x 0.3074 (0.3599) acc_x 90.6250 (91.8750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [5/31] time 0.349 (0.338) data 0.270 (0.260) loss_u loss_u 0.9521 (0.9156) acc_u 6.2500 (10.0000) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [10/31] time 0.322 (0.336) data 0.244 (0.259) loss_u loss_u 0.9771 (0.9354) acc_u 0.0000 (7.5000) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [15/31] time 0.338 (0.336) data 0.261 (0.258) loss_u loss_u 0.8833 (0.9386) acc_u 12.5000 (7.2917) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [20/31] time 0.356 (0.337) data 0.279 (0.260) loss_u loss_u 0.9668 (0.9369) acc_u 6.2500 (7.5000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [25/31] time 0.347 (0.338) data 0.270 (0.260) loss_u loss_u 0.8618 (0.9371) acc_u 15.6250 (7.5000) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [30/31] time 0.344 (0.339) data 0.265 (0.261) loss_u loss_u 0.9038 (0.9387) acc_u 12.5000 (7.2917) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 417
confident_label rate tensor(0.3799, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 620
clean true:526
clean false:94
clean_rate:0.8483870967741935
noisy true:689
noisy false:323
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 1012
epoch [196/200] batch [5/19] time 0.342 (0.343) data 0.265 (0.266) loss_x loss_x 0.3030 (0.3652) acc_x 90.6250 (93.7500) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/19] time 0.298 (0.326) data 0.220 (0.248) loss_x loss_x 0.3403 (0.3288) acc_x 90.6250 (93.7500) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/19] time 0.348 (0.322) data 0.271 (0.245) loss_x loss_x 0.1038 (0.2801) acc_x 100.0000 (94.7917) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [5/31] time 0.330 (0.330) data 0.252 (0.252) loss_u loss_u 0.9258 (0.9192) acc_u 9.3750 (9.3750) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [10/31] time 0.333 (0.332) data 0.255 (0.254) loss_u loss_u 0.9961 (0.9367) acc_u 0.0000 (7.5000) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [15/31] time 0.326 (0.332) data 0.248 (0.254) loss_u loss_u 0.9321 (0.9298) acc_u 9.3750 (8.1250) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [20/31] time 0.334 (0.331) data 0.255 (0.254) loss_u loss_u 0.8975 (0.9276) acc_u 9.3750 (8.5938) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [25/31] time 0.334 (0.332) data 0.256 (0.255) loss_u loss_u 0.9648 (0.9333) acc_u 3.1250 (7.6250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/31] time 0.345 (0.334) data 0.267 (0.256) loss_u loss_u 0.9385 (0.9343) acc_u 6.2500 (7.5000) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 405
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:528
clean false:91
clean_rate:0.8529886914378029
noisy true:699
noisy false:314
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [197/200] batch [5/19] time 0.335 (0.355) data 0.257 (0.277) loss_x loss_x 0.3005 (0.3102) acc_x 93.7500 (93.7500) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/19] time 0.299 (0.331) data 0.221 (0.253) loss_x loss_x 0.1572 (0.2946) acc_x 100.0000 (94.6875) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/19] time 0.328 (0.327) data 0.250 (0.250) loss_x loss_x 0.3323 (0.3047) acc_x 93.7500 (94.1667) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [5/31] time 0.339 (0.333) data 0.261 (0.255) loss_u loss_u 0.9414 (0.9256) acc_u 6.2500 (8.1250) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [10/31] time 0.344 (0.335) data 0.266 (0.257) loss_u loss_u 0.9429 (0.9287) acc_u 6.2500 (8.4375) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [15/31] time 0.336 (0.336) data 0.258 (0.258) loss_u loss_u 0.9526 (0.9213) acc_u 3.1250 (8.9583) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [20/31] time 0.345 (0.336) data 0.267 (0.258) loss_u loss_u 0.8945 (0.9215) acc_u 12.5000 (8.9062) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [25/31] time 0.340 (0.337) data 0.262 (0.259) loss_u loss_u 0.9688 (0.9279) acc_u 3.1250 (8.1250) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [30/31] time 0.327 (0.337) data 0.249 (0.259) loss_u loss_u 0.9746 (0.9309) acc_u 3.1250 (7.7083) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 403
confident_label rate tensor(0.3854, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 629
clean true:533
clean false:96
clean_rate:0.8473767885532592
noisy true:696
noisy false:307
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 1003
epoch [198/200] batch [5/19] time 0.342 (0.346) data 0.264 (0.268) loss_x loss_x 0.1782 (0.2149) acc_x 96.8750 (95.6250) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/19] time 0.327 (0.343) data 0.249 (0.265) loss_x loss_x 0.3882 (0.2426) acc_x 93.7500 (95.0000) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/19] time 0.292 (0.335) data 0.214 (0.257) loss_x loss_x 0.2622 (0.2690) acc_x 93.7500 (93.9583) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [5/31] time 0.328 (0.332) data 0.250 (0.254) loss_u loss_u 0.8818 (0.9403) acc_u 12.5000 (6.8750) lr 1.9733e-06 eta 0:00:08
epoch [198/200] batch [10/31] time 0.317 (0.331) data 0.239 (0.253) loss_u loss_u 0.9497 (0.9271) acc_u 6.2500 (8.1250) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [15/31] time 0.336 (0.332) data 0.258 (0.254) loss_u loss_u 0.8979 (0.9328) acc_u 15.6250 (7.5000) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [20/31] time 0.331 (0.332) data 0.253 (0.254) loss_u loss_u 0.9761 (0.9395) acc_u 3.1250 (6.7188) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [25/31] time 0.333 (0.329) data 0.255 (0.251) loss_u loss_u 0.9214 (0.9376) acc_u 9.3750 (7.1250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/31] time 0.328 (0.329) data 0.251 (0.252) loss_u loss_u 0.9658 (0.9410) acc_u 3.1250 (6.6667) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 420
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 607
clean true:518
clean false:89
clean_rate:0.8533772652388797
noisy true:694
noisy false:331
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1025
epoch [199/200] batch [5/18] time 0.345 (0.351) data 0.267 (0.273) loss_x loss_x 0.1707 (0.2729) acc_x 96.8750 (94.3750) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/18] time 0.345 (0.350) data 0.267 (0.272) loss_x loss_x 0.2690 (0.2928) acc_x 93.7500 (92.1875) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/18] time 0.357 (0.346) data 0.279 (0.269) loss_x loss_x 0.3542 (0.3123) acc_x 93.7500 (92.0833) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [5/32] time 0.312 (0.336) data 0.234 (0.258) loss_u loss_u 0.9917 (0.9486) acc_u 0.0000 (5.0000) lr 1.1101e-06 eta 0:00:09
epoch [199/200] batch [10/32] time 0.341 (0.337) data 0.264 (0.260) loss_u loss_u 0.9116 (0.9479) acc_u 9.3750 (5.9375) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [15/32] time 0.337 (0.339) data 0.259 (0.261) loss_u loss_u 0.9624 (0.9465) acc_u 3.1250 (6.0417) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [20/32] time 0.359 (0.341) data 0.281 (0.263) loss_u loss_u 0.9224 (0.9446) acc_u 9.3750 (6.4062) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [25/32] time 0.348 (0.342) data 0.270 (0.264) loss_u loss_u 0.9111 (0.9358) acc_u 9.3750 (7.5000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [30/32] time 0.331 (0.340) data 0.253 (0.262) loss_u loss_u 0.8975 (0.9319) acc_u 12.5000 (7.9167) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 405
confident_label rate tensor(0.3854, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 629
clean true:535
clean false:94
clean_rate:0.8505564387917329
noisy true:692
noisy false:311
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 1003
epoch [200/200] batch [5/19] time 0.326 (0.340) data 0.248 (0.263) loss_x loss_x 0.1896 (0.3581) acc_x 96.8750 (90.0000) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/19] time 0.336 (0.335) data 0.259 (0.258) loss_x loss_x 0.2888 (0.3519) acc_x 90.6250 (90.0000) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/19] time 0.333 (0.335) data 0.255 (0.258) loss_x loss_x 0.4448 (0.3400) acc_x 84.3750 (91.0417) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [5/31] time 0.332 (0.335) data 0.254 (0.258) loss_u loss_u 0.9580 (0.9376) acc_u 3.1250 (7.5000) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [10/31] time 0.337 (0.336) data 0.259 (0.258) loss_u loss_u 0.9395 (0.9333) acc_u 6.2500 (8.1250) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [15/31] time 0.352 (0.337) data 0.273 (0.260) loss_u loss_u 0.9580 (0.9360) acc_u 6.2500 (7.5000) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [20/31] time 0.353 (0.338) data 0.274 (0.261) loss_u loss_u 0.9316 (0.9408) acc_u 6.2500 (7.0312) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [25/31] time 0.339 (0.339) data 0.262 (0.261) loss_u loss_u 0.9775 (0.9407) acc_u 3.1250 (7.0000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [30/31] time 0.358 (0.340) data 0.280 (0.262) loss_u loss_u 0.9985 (0.9406) acc_u 0.0000 (6.9792) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 1,913
* accuracy: 77.7%
* error: 22.3%
* macro_f1: 77.0%
Elapsed: 2:02:06
