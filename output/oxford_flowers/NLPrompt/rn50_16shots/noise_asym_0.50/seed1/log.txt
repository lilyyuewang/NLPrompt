***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1213, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 198
clean true:193
clean false:5
clean_rate:0.9747474747474747
noisy true:182
noisy false:1252
after delete: len(clean_dataset) 198
after delete: len(noisy_dataset) 1434
epoch [1/200] batch [5/6] time 0.291 (0.334) data 0.213 (0.239) loss_x loss_x 2.5098 (2.8180) acc_x 43.7500 (35.6250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/44] time 0.332 (0.321) data 0.254 (0.233) loss_u loss_u 0.9878 (0.9827) acc_u 0.0000 (2.5000) lr 1.0000e-05 eta 0:00:12
epoch [1/200] batch [10/44] time 0.346 (0.327) data 0.268 (0.242) loss_u loss_u 0.9766 (0.9800) acc_u 3.1250 (3.4375) lr 1.0000e-05 eta 0:00:11
epoch [1/200] batch [15/44] time 0.325 (0.329) data 0.247 (0.246) loss_u loss_u 0.9526 (0.9778) acc_u 9.3750 (4.1667) lr 1.0000e-05 eta 0:00:09
epoch [1/200] batch [20/44] time 0.345 (0.331) data 0.267 (0.249) loss_u loss_u 0.9648 (0.9783) acc_u 6.2500 (3.5938) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [25/44] time 0.324 (0.330) data 0.246 (0.248) loss_u loss_u 0.9619 (0.9770) acc_u 6.2500 (3.8750) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [30/44] time 0.340 (0.331) data 0.262 (0.250) loss_u loss_u 0.9722 (0.9772) acc_u 3.1250 (3.6458) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [35/44] time 0.341 (0.332) data 0.264 (0.251) loss_u loss_u 0.9814 (0.9762) acc_u 0.0000 (4.0179) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [40/44] time 0.333 (0.332) data 0.256 (0.251) loss_u loss_u 0.9858 (0.9769) acc_u 3.1250 (3.9844) lr 1.0000e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1108
confident_label rate tensor(0.1661, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 271
clean true:268
clean false:3
clean_rate:0.988929889298893
noisy true:256
noisy false:1105
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 1361
epoch [2/200] batch [5/8] time 0.303 (0.329) data 0.225 (0.252) loss_x loss_x 0.6616 (1.2192) acc_x 84.3750 (73.1250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/42] time 0.333 (0.337) data 0.255 (0.259) loss_u loss_u 0.8613 (0.8335) acc_u 15.6250 (21.8750) lr 2.0000e-03 eta 0:00:12
epoch [2/200] batch [10/42] time 0.357 (0.337) data 0.278 (0.260) loss_u loss_u 0.8291 (0.8565) acc_u 21.8750 (18.1250) lr 2.0000e-03 eta 0:00:10
epoch [2/200] batch [15/42] time 0.347 (0.339) data 0.269 (0.261) loss_u loss_u 0.8706 (0.8687) acc_u 15.6250 (16.2500) lr 2.0000e-03 eta 0:00:09
epoch [2/200] batch [20/42] time 0.326 (0.337) data 0.248 (0.259) loss_u loss_u 0.8394 (0.8718) acc_u 21.8750 (15.9375) lr 2.0000e-03 eta 0:00:07
epoch [2/200] batch [25/42] time 0.330 (0.336) data 0.252 (0.258) loss_u loss_u 0.9150 (0.8731) acc_u 9.3750 (15.5000) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [30/42] time 0.337 (0.336) data 0.260 (0.258) loss_u loss_u 0.9243 (0.8753) acc_u 12.5000 (15.1042) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [35/42] time 0.340 (0.336) data 0.261 (0.258) loss_u loss_u 0.8970 (0.8742) acc_u 12.5000 (15.1786) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [40/42] time 0.325 (0.336) data 0.248 (0.258) loss_u loss_u 0.8911 (0.8725) acc_u 15.6250 (15.5469) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 723
confident_label rate tensor(0.2788, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 455
clean true:452
clean false:3
clean_rate:0.9934065934065934
noisy true:457
noisy false:720
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1177
epoch [3/200] batch [5/14] time 0.302 (0.309) data 0.224 (0.231) loss_x loss_x 0.4680 (0.7650) acc_x 90.6250 (81.8750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/14] time 0.328 (0.321) data 0.251 (0.244) loss_x loss_x 0.8823 (0.8007) acc_x 75.0000 (79.6875) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [5/36] time 0.328 (0.316) data 0.250 (0.238) loss_u loss_u 0.9092 (0.9263) acc_u 12.5000 (9.3750) lr 1.9999e-03 eta 0:00:09
epoch [3/200] batch [10/36] time 0.331 (0.319) data 0.254 (0.241) loss_u loss_u 0.9277 (0.9281) acc_u 9.3750 (9.3750) lr 1.9999e-03 eta 0:00:08
epoch [3/200] batch [15/36] time 0.343 (0.322) data 0.265 (0.244) loss_u loss_u 0.9185 (0.9270) acc_u 6.2500 (9.1667) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [20/36] time 0.350 (0.326) data 0.273 (0.248) loss_u loss_u 0.9458 (0.9301) acc_u 3.1250 (8.4375) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [25/36] time 0.352 (0.328) data 0.275 (0.251) loss_u loss_u 0.9419 (0.9271) acc_u 6.2500 (9.0000) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [30/36] time 0.336 (0.330) data 0.258 (0.252) loss_u loss_u 0.9644 (0.9318) acc_u 3.1250 (8.2292) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [35/36] time 0.332 (0.331) data 0.253 (0.253) loss_u loss_u 0.9443 (0.9302) acc_u 6.2500 (8.5714) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 709
confident_label rate tensor(0.2911, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 475
clean true:466
clean false:9
clean_rate:0.9810526315789474
noisy true:457
noisy false:700
after delete: len(clean_dataset) 475
after delete: len(noisy_dataset) 1157
epoch [4/200] batch [5/14] time 0.331 (0.332) data 0.254 (0.254) loss_x loss_x 0.9238 (0.7429) acc_x 81.2500 (81.8750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/14] time 0.333 (0.336) data 0.256 (0.259) loss_x loss_x 0.8486 (0.7387) acc_x 71.8750 (79.6875) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [5/36] time 0.343 (0.338) data 0.266 (0.260) loss_u loss_u 0.9243 (0.9326) acc_u 6.2500 (7.5000) lr 1.9995e-03 eta 0:00:10
epoch [4/200] batch [10/36] time 0.348 (0.339) data 0.269 (0.262) loss_u loss_u 0.9116 (0.9284) acc_u 9.3750 (9.3750) lr 1.9995e-03 eta 0:00:08
epoch [4/200] batch [15/36] time 0.343 (0.340) data 0.264 (0.263) loss_u loss_u 0.9365 (0.9331) acc_u 6.2500 (8.7500) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [20/36] time 0.351 (0.341) data 0.274 (0.263) loss_u loss_u 0.9502 (0.9332) acc_u 9.3750 (8.7500) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [25/36] time 0.329 (0.340) data 0.251 (0.262) loss_u loss_u 0.9614 (0.9354) acc_u 6.2500 (8.3750) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [30/36] time 0.324 (0.340) data 0.246 (0.262) loss_u loss_u 0.9590 (0.9390) acc_u 6.2500 (7.9167) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [35/36] time 0.336 (0.340) data 0.258 (0.262) loss_u loss_u 0.9917 (0.9413) acc_u 0.0000 (7.5893) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 668
confident_label rate tensor(0.3033, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 495
clean true:489
clean false:6
clean_rate:0.9878787878787879
noisy true:475
noisy false:662
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1137
epoch [5/200] batch [5/15] time 0.297 (0.304) data 0.219 (0.226) loss_x loss_x 0.7944 (0.7180) acc_x 81.2500 (81.2500) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [10/15] time 0.329 (0.319) data 0.252 (0.242) loss_x loss_x 1.0586 (0.7427) acc_x 75.0000 (80.3125) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/15] time 0.346 (0.327) data 0.269 (0.249) loss_x loss_x 0.7754 (0.7357) acc_x 75.0000 (80.4167) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/35] time 0.338 (0.331) data 0.260 (0.253) loss_u loss_u 0.8716 (0.9162) acc_u 12.5000 (9.3750) lr 1.9989e-03 eta 0:00:09
epoch [5/200] batch [10/35] time 0.341 (0.332) data 0.263 (0.254) loss_u loss_u 0.9922 (0.9327) acc_u 0.0000 (8.1250) lr 1.9989e-03 eta 0:00:08
epoch [5/200] batch [15/35] time 0.348 (0.334) data 0.271 (0.256) loss_u loss_u 0.8438 (0.9279) acc_u 18.7500 (8.3333) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [20/35] time 0.332 (0.334) data 0.255 (0.257) loss_u loss_u 0.9409 (0.9225) acc_u 9.3750 (9.3750) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [25/35] time 0.348 (0.335) data 0.269 (0.257) loss_u loss_u 0.9404 (0.9265) acc_u 9.3750 (9.0000) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [30/35] time 0.325 (0.335) data 0.246 (0.258) loss_u loss_u 0.8555 (0.9270) acc_u 21.8750 (9.1667) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [35/35] time 0.348 (0.336) data 0.270 (0.258) loss_u loss_u 0.8657 (0.9249) acc_u 15.6250 (9.3750) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 670
confident_label rate tensor(0.2984, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 487
clean true:483
clean false:4
clean_rate:0.9917864476386037
noisy true:479
noisy false:666
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1145
epoch [6/200] batch [5/15] time 0.298 (0.327) data 0.219 (0.249) loss_x loss_x 0.7876 (0.7280) acc_x 78.1250 (80.6250) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/15] time 0.329 (0.327) data 0.251 (0.249) loss_x loss_x 0.8096 (0.7076) acc_x 81.2500 (82.1875) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/15] time 0.342 (0.330) data 0.265 (0.252) loss_x loss_x 1.0088 (0.7226) acc_x 75.0000 (81.6667) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/35] time 0.346 (0.333) data 0.268 (0.255) loss_u loss_u 0.9404 (0.9296) acc_u 6.2500 (10.0000) lr 1.9980e-03 eta 0:00:09
epoch [6/200] batch [10/35] time 0.347 (0.334) data 0.269 (0.256) loss_u loss_u 0.9595 (0.9299) acc_u 6.2500 (9.3750) lr 1.9980e-03 eta 0:00:08
epoch [6/200] batch [15/35] time 0.344 (0.336) data 0.267 (0.258) loss_u loss_u 0.9341 (0.9305) acc_u 6.2500 (8.7500) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [20/35] time 0.337 (0.337) data 0.260 (0.259) loss_u loss_u 0.8882 (0.9305) acc_u 12.5000 (9.0625) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [25/35] time 0.338 (0.336) data 0.259 (0.258) loss_u loss_u 0.8584 (0.9318) acc_u 18.7500 (8.8750) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [30/35] time 0.334 (0.337) data 0.256 (0.259) loss_u loss_u 0.9302 (0.9299) acc_u 9.3750 (9.0625) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [35/35] time 0.340 (0.338) data 0.263 (0.260) loss_u loss_u 0.9360 (0.9267) acc_u 6.2500 (9.2857) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 652
confident_label rate tensor(0.2947, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 481
clean true:480
clean false:1
clean_rate:0.997920997920998
noisy true:500
noisy false:651
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1151
epoch [7/200] batch [5/15] time 0.298 (0.319) data 0.220 (0.241) loss_x loss_x 0.5791 (0.6865) acc_x 87.5000 (81.8750) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/15] time 0.335 (0.321) data 0.258 (0.243) loss_x loss_x 0.5273 (0.6321) acc_x 81.2500 (82.8125) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/15] time 0.327 (0.326) data 0.250 (0.249) loss_x loss_x 0.4934 (0.6826) acc_x 87.5000 (82.9167) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/35] time 0.338 (0.330) data 0.260 (0.253) loss_u loss_u 0.9395 (0.9230) acc_u 6.2500 (9.3750) lr 1.9969e-03 eta 0:00:09
epoch [7/200] batch [10/35] time 0.350 (0.331) data 0.271 (0.254) loss_u loss_u 0.8921 (0.9269) acc_u 15.6250 (9.6875) lr 1.9969e-03 eta 0:00:08
epoch [7/200] batch [15/35] time 0.362 (0.333) data 0.284 (0.255) loss_u loss_u 0.9824 (0.9275) acc_u 3.1250 (9.7917) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [20/35] time 0.354 (0.335) data 0.276 (0.257) loss_u loss_u 0.8643 (0.9243) acc_u 18.7500 (10.3125) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [25/35] time 0.361 (0.337) data 0.283 (0.259) loss_u loss_u 0.9648 (0.9227) acc_u 3.1250 (10.5000) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [30/35] time 0.349 (0.338) data 0.271 (0.260) loss_u loss_u 0.9443 (0.9208) acc_u 6.2500 (10.8333) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [35/35] time 0.325 (0.338) data 0.247 (0.260) loss_u loss_u 0.9712 (0.9225) acc_u 3.1250 (10.2679) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 638
confident_label rate tensor(0.3107, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 507
clean true:503
clean false:4
clean_rate:0.9921104536489151
noisy true:491
noisy false:634
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1125
epoch [8/200] batch [5/15] time 0.296 (0.317) data 0.219 (0.240) loss_x loss_x 0.5869 (0.8689) acc_x 81.2500 (80.0000) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/15] time 0.370 (0.325) data 0.293 (0.247) loss_x loss_x 0.3528 (0.6995) acc_x 90.6250 (83.1250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/15] time 0.344 (0.329) data 0.266 (0.252) loss_x loss_x 0.5381 (0.6761) acc_x 81.2500 (82.5000) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/35] time 0.356 (0.335) data 0.278 (0.257) loss_u loss_u 0.8965 (0.9128) acc_u 9.3750 (11.2500) lr 1.9956e-03 eta 0:00:10
epoch [8/200] batch [10/35] time 0.353 (0.338) data 0.275 (0.260) loss_u loss_u 0.9326 (0.9265) acc_u 6.2500 (8.4375) lr 1.9956e-03 eta 0:00:08
epoch [8/200] batch [15/35] time 0.339 (0.338) data 0.261 (0.260) loss_u loss_u 0.9785 (0.9380) acc_u 0.0000 (7.0833) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [20/35] time 0.327 (0.337) data 0.249 (0.259) loss_u loss_u 0.9824 (0.9415) acc_u 3.1250 (6.5625) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [25/35] time 0.331 (0.336) data 0.253 (0.259) loss_u loss_u 0.9028 (0.9364) acc_u 12.5000 (7.2500) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [30/35] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.9604 (0.9403) acc_u 6.2500 (7.0833) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [35/35] time 0.349 (0.337) data 0.271 (0.259) loss_u loss_u 0.9072 (0.9375) acc_u 12.5000 (7.5893) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 621
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 511
clean true:507
clean false:4
clean_rate:0.9921722113502935
noisy true:504
noisy false:617
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1121
epoch [9/200] batch [5/15] time 0.313 (0.320) data 0.234 (0.242) loss_x loss_x 0.5151 (0.6295) acc_x 87.5000 (85.6250) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/15] time 0.330 (0.325) data 0.252 (0.247) loss_x loss_x 0.8916 (0.6360) acc_x 71.8750 (83.4375) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/15] time 0.326 (0.328) data 0.248 (0.250) loss_x loss_x 0.7964 (0.6207) acc_x 71.8750 (83.3333) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/35] time 0.339 (0.329) data 0.261 (0.251) loss_u loss_u 0.9927 (0.9422) acc_u 0.0000 (6.2500) lr 1.9940e-03 eta 0:00:09
epoch [9/200] batch [10/35] time 0.326 (0.329) data 0.248 (0.251) loss_u loss_u 0.9526 (0.9337) acc_u 6.2500 (7.5000) lr 1.9940e-03 eta 0:00:08
epoch [9/200] batch [15/35] time 0.339 (0.331) data 0.260 (0.253) loss_u loss_u 0.9131 (0.9338) acc_u 12.5000 (8.1250) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [20/35] time 0.355 (0.334) data 0.276 (0.256) loss_u loss_u 0.9375 (0.9389) acc_u 9.3750 (7.5000) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [25/35] time 0.354 (0.335) data 0.277 (0.257) loss_u loss_u 0.9062 (0.9343) acc_u 15.6250 (8.3750) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [30/35] time 0.337 (0.335) data 0.260 (0.257) loss_u loss_u 0.9038 (0.9341) acc_u 12.5000 (8.2292) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [35/35] time 0.323 (0.332) data 0.244 (0.254) loss_u loss_u 0.9595 (0.9390) acc_u 9.3750 (7.7679) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 657
confident_label rate tensor(0.3058, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 499
clean true:492
clean false:7
clean_rate:0.9859719438877755
noisy true:483
noisy false:650
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1133
epoch [10/200] batch [5/15] time 0.352 (0.330) data 0.274 (0.252) loss_x loss_x 0.7568 (0.7365) acc_x 78.1250 (83.1250) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/15] time 0.332 (0.334) data 0.255 (0.257) loss_x loss_x 0.7197 (0.6654) acc_x 81.2500 (83.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/15] time 0.329 (0.329) data 0.251 (0.252) loss_x loss_x 0.8447 (0.6556) acc_x 78.1250 (84.5833) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/35] time 0.342 (0.328) data 0.264 (0.251) loss_u loss_u 0.9580 (0.8994) acc_u 3.1250 (11.8750) lr 1.9921e-03 eta 0:00:09
epoch [10/200] batch [10/35] time 0.337 (0.329) data 0.259 (0.252) loss_u loss_u 0.9292 (0.9125) acc_u 9.3750 (10.9375) lr 1.9921e-03 eta 0:00:08
epoch [10/200] batch [15/35] time 0.346 (0.331) data 0.268 (0.254) loss_u loss_u 0.9531 (0.9093) acc_u 3.1250 (11.2500) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [20/35] time 0.332 (0.333) data 0.254 (0.255) loss_u loss_u 0.9004 (0.9100) acc_u 15.6250 (11.2500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [25/35] time 0.329 (0.333) data 0.251 (0.256) loss_u loss_u 0.9009 (0.9130) acc_u 9.3750 (10.7500) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [30/35] time 0.348 (0.335) data 0.270 (0.257) loss_u loss_u 0.9595 (0.9152) acc_u 6.2500 (10.6250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [35/35] time 0.330 (0.335) data 0.252 (0.257) loss_u loss_u 0.9883 (0.9202) acc_u 0.0000 (9.7321) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 585
confident_label rate tensor(0.3248, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 530
clean true:527
clean false:3
clean_rate:0.9943396226415094
noisy true:520
noisy false:582
after delete: len(clean_dataset) 530
after delete: len(noisy_dataset) 1102
epoch [11/200] batch [5/16] time 0.306 (0.306) data 0.227 (0.228) loss_x loss_x 0.7334 (0.8046) acc_x 75.0000 (80.0000) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/16] time 0.338 (0.315) data 0.260 (0.237) loss_x loss_x 1.2100 (0.7498) acc_x 71.8750 (81.8750) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/16] time 0.333 (0.323) data 0.255 (0.245) loss_x loss_x 0.8262 (0.7552) acc_x 84.3750 (82.9167) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/34] time 0.345 (0.329) data 0.268 (0.251) loss_u loss_u 0.9043 (0.9252) acc_u 12.5000 (8.7500) lr 1.9900e-03 eta 0:00:09
epoch [11/200] batch [10/34] time 0.350 (0.334) data 0.272 (0.256) loss_u loss_u 0.9219 (0.9312) acc_u 12.5000 (8.7500) lr 1.9900e-03 eta 0:00:08
epoch [11/200] batch [15/34] time 0.327 (0.335) data 0.249 (0.257) loss_u loss_u 0.9424 (0.9311) acc_u 6.2500 (8.7500) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [20/34] time 0.326 (0.334) data 0.248 (0.257) loss_u loss_u 0.9395 (0.9339) acc_u 6.2500 (8.1250) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [25/34] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9810 (0.9402) acc_u 0.0000 (7.1250) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [30/34] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9688 (0.9386) acc_u 3.1250 (7.3958) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 579
confident_label rate tensor(0.3266, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 533
clean true:526
clean false:7
clean_rate:0.9868667917448405
noisy true:527
noisy false:572
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1099
epoch [12/200] batch [5/16] time 0.315 (0.328) data 0.237 (0.250) loss_x loss_x 0.7676 (0.7304) acc_x 78.1250 (83.1250) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/16] time 0.349 (0.337) data 0.272 (0.259) loss_x loss_x 0.7959 (0.7400) acc_x 81.2500 (81.8750) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/16] time 0.338 (0.338) data 0.260 (0.260) loss_x loss_x 0.5688 (0.6973) acc_x 84.3750 (83.5417) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/34] time 0.336 (0.336) data 0.257 (0.258) loss_u loss_u 0.9185 (0.9193) acc_u 9.3750 (10.0000) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [10/34] time 0.350 (0.337) data 0.271 (0.259) loss_u loss_u 0.8403 (0.9187) acc_u 18.7500 (9.6875) lr 1.9877e-03 eta 0:00:08
epoch [12/200] batch [15/34] time 0.342 (0.338) data 0.264 (0.260) loss_u loss_u 0.9570 (0.9254) acc_u 6.2500 (8.9583) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [20/34] time 0.351 (0.340) data 0.273 (0.262) loss_u loss_u 0.8945 (0.9235) acc_u 12.5000 (9.2188) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [25/34] time 0.338 (0.341) data 0.260 (0.263) loss_u loss_u 0.9531 (0.9187) acc_u 6.2500 (10.0000) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [30/34] time 0.339 (0.341) data 0.261 (0.263) loss_u loss_u 0.9287 (0.9235) acc_u 6.2500 (9.4792) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 618
confident_label rate tensor(0.3260, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 532
clean true:520
clean false:12
clean_rate:0.9774436090225563
noisy true:494
noisy false:606
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 1100
epoch [13/200] batch [5/16] time 0.307 (0.306) data 0.230 (0.228) loss_x loss_x 0.6045 (0.5583) acc_x 78.1250 (86.8750) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/16] time 0.333 (0.322) data 0.255 (0.244) loss_x loss_x 0.4058 (0.6160) acc_x 90.6250 (84.6875) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [15/16] time 0.352 (0.327) data 0.275 (0.249) loss_x loss_x 0.4778 (0.6224) acc_x 87.5000 (84.5833) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/34] time 0.346 (0.332) data 0.269 (0.254) loss_u loss_u 0.9219 (0.9306) acc_u 9.3750 (8.1250) lr 1.9851e-03 eta 0:00:09
epoch [13/200] batch [10/34] time 0.332 (0.335) data 0.253 (0.258) loss_u loss_u 0.9614 (0.9300) acc_u 3.1250 (8.4375) lr 1.9851e-03 eta 0:00:08
epoch [13/200] batch [15/34] time 0.345 (0.336) data 0.267 (0.258) loss_u loss_u 0.9287 (0.9199) acc_u 6.2500 (10.0000) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [20/34] time 0.350 (0.338) data 0.272 (0.260) loss_u loss_u 0.8784 (0.9216) acc_u 15.6250 (9.8438) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [25/34] time 0.344 (0.338) data 0.265 (0.260) loss_u loss_u 0.9331 (0.9235) acc_u 6.2500 (9.5000) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [30/34] time 0.356 (0.340) data 0.279 (0.262) loss_u loss_u 0.9658 (0.9246) acc_u 3.1250 (9.3750) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 615
confident_label rate tensor(0.3211, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 524
clean true:514
clean false:10
clean_rate:0.9809160305343512
noisy true:503
noisy false:605
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1108
epoch [14/200] batch [5/16] time 0.345 (0.332) data 0.267 (0.254) loss_x loss_x 0.3303 (0.5046) acc_x 93.7500 (90.0000) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/16] time 0.353 (0.340) data 0.275 (0.262) loss_x loss_x 0.5894 (0.5462) acc_x 90.6250 (88.7500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/16] time 0.342 (0.341) data 0.265 (0.263) loss_x loss_x 0.5889 (0.5675) acc_x 87.5000 (87.9167) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/34] time 0.340 (0.342) data 0.261 (0.264) loss_u loss_u 0.9375 (0.9409) acc_u 9.3750 (8.1250) lr 1.9823e-03 eta 0:00:09
epoch [14/200] batch [10/34] time 0.339 (0.342) data 0.261 (0.264) loss_u loss_u 0.8530 (0.9244) acc_u 15.6250 (10.0000) lr 1.9823e-03 eta 0:00:08
epoch [14/200] batch [15/34] time 0.335 (0.342) data 0.257 (0.264) loss_u loss_u 0.9263 (0.9225) acc_u 9.3750 (10.4167) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [20/34] time 0.336 (0.342) data 0.258 (0.264) loss_u loss_u 0.9268 (0.9251) acc_u 9.3750 (10.3125) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [25/34] time 0.302 (0.337) data 0.224 (0.259) loss_u loss_u 0.9614 (0.9248) acc_u 6.2500 (10.6250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [30/34] time 0.334 (0.337) data 0.256 (0.259) loss_u loss_u 0.9526 (0.9224) acc_u 6.2500 (10.7292) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 583
confident_label rate tensor(0.3419, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 558
clean true:539
clean false:19
clean_rate:0.9659498207885304
noisy true:510
noisy false:564
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1074
epoch [15/200] batch [5/17] time 0.348 (0.324) data 0.271 (0.246) loss_x loss_x 0.2500 (0.5211) acc_x 93.7500 (88.7500) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/17] time 0.344 (0.333) data 0.266 (0.256) loss_x loss_x 0.7397 (0.5985) acc_x 78.1250 (85.3125) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/17] time 0.341 (0.338) data 0.264 (0.260) loss_x loss_x 0.7500 (0.6020) acc_x 81.2500 (85.2083) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/33] time 0.340 (0.337) data 0.261 (0.259) loss_u loss_u 0.9219 (0.9447) acc_u 9.3750 (6.2500) lr 1.9792e-03 eta 0:00:09
epoch [15/200] batch [10/33] time 0.334 (0.339) data 0.255 (0.261) loss_u loss_u 0.9512 (0.9473) acc_u 6.2500 (5.6250) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [15/33] time 0.345 (0.339) data 0.268 (0.261) loss_u loss_u 0.9634 (0.9441) acc_u 3.1250 (6.4583) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [20/33] time 0.330 (0.339) data 0.252 (0.261) loss_u loss_u 0.9321 (0.9372) acc_u 6.2500 (7.5000) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [25/33] time 0.339 (0.339) data 0.261 (0.261) loss_u loss_u 0.9561 (0.9387) acc_u 3.1250 (7.3750) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [30/33] time 0.350 (0.340) data 0.272 (0.262) loss_u loss_u 0.9502 (0.9380) acc_u 6.2500 (7.8125) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 577
confident_label rate tensor(0.3339, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 545
clean true:532
clean false:13
clean_rate:0.9761467889908257
noisy true:523
noisy false:564
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1087
epoch [16/200] batch [5/17] time 0.370 (0.322) data 0.292 (0.244) loss_x loss_x 0.7764 (0.7483) acc_x 87.5000 (84.3750) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/17] time 0.346 (0.334) data 0.269 (0.256) loss_x loss_x 0.8657 (0.7286) acc_x 81.2500 (83.4375) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/17] time 0.325 (0.337) data 0.247 (0.259) loss_x loss_x 0.4871 (0.6938) acc_x 90.6250 (83.7500) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/33] time 0.333 (0.336) data 0.256 (0.258) loss_u loss_u 0.9141 (0.9071) acc_u 9.3750 (12.5000) lr 1.9759e-03 eta 0:00:09
epoch [16/200] batch [10/33] time 0.340 (0.336) data 0.261 (0.258) loss_u loss_u 0.8340 (0.9134) acc_u 21.8750 (12.5000) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [15/33] time 0.339 (0.335) data 0.261 (0.257) loss_u loss_u 0.9175 (0.9227) acc_u 9.3750 (10.8333) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [20/33] time 0.345 (0.336) data 0.267 (0.258) loss_u loss_u 0.9072 (0.9229) acc_u 9.3750 (10.4688) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [25/33] time 0.343 (0.336) data 0.266 (0.258) loss_u loss_u 0.9531 (0.9205) acc_u 3.1250 (10.5000) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [30/33] time 0.337 (0.336) data 0.259 (0.258) loss_u loss_u 0.9502 (0.9226) acc_u 3.1250 (10.1042) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 534
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:560
clean false:16
clean_rate:0.9722222222222222
noisy true:538
noisy false:518
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [17/200] batch [5/18] time 0.347 (0.319) data 0.268 (0.240) loss_x loss_x 0.6685 (0.6358) acc_x 87.5000 (86.8750) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [10/18] time 0.344 (0.333) data 0.267 (0.255) loss_x loss_x 0.9951 (0.7192) acc_x 87.5000 (84.6875) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/18] time 0.344 (0.336) data 0.266 (0.258) loss_x loss_x 0.5225 (0.6813) acc_x 93.7500 (85.2083) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [5/33] time 0.358 (0.338) data 0.280 (0.259) loss_u loss_u 0.9478 (0.9243) acc_u 6.2500 (11.2500) lr 1.9724e-03 eta 0:00:09
epoch [17/200] batch [10/33] time 0.333 (0.339) data 0.255 (0.261) loss_u loss_u 0.9585 (0.9257) acc_u 3.1250 (10.0000) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [15/33] time 0.336 (0.339) data 0.257 (0.261) loss_u loss_u 0.8970 (0.9187) acc_u 12.5000 (10.4167) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [20/33] time 0.331 (0.339) data 0.253 (0.261) loss_u loss_u 0.8931 (0.9236) acc_u 12.5000 (9.6875) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [25/33] time 0.339 (0.339) data 0.261 (0.261) loss_u loss_u 0.9453 (0.9244) acc_u 6.2500 (9.5000) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [30/33] time 0.353 (0.340) data 0.275 (0.262) loss_u loss_u 0.9390 (0.9295) acc_u 9.3750 (8.8542) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 520
confident_label rate tensor(0.3646, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 595
clean true:576
clean false:19
clean_rate:0.9680672268907563
noisy true:536
noisy false:501
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1037
epoch [18/200] batch [5/18] time 0.337 (0.344) data 0.260 (0.267) loss_x loss_x 0.3052 (0.6735) acc_x 93.7500 (83.7500) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/18] time 0.343 (0.346) data 0.265 (0.269) loss_x loss_x 0.7295 (0.6391) acc_x 84.3750 (83.4375) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/18] time 0.332 (0.344) data 0.255 (0.267) loss_x loss_x 0.5815 (0.6470) acc_x 81.2500 (83.3333) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [5/32] time 0.336 (0.342) data 0.258 (0.265) loss_u loss_u 0.9634 (0.9360) acc_u 6.2500 (8.1250) lr 1.9686e-03 eta 0:00:09
epoch [18/200] batch [10/32] time 0.341 (0.341) data 0.263 (0.264) loss_u loss_u 0.9673 (0.9469) acc_u 6.2500 (6.8750) lr 1.9686e-03 eta 0:00:07
epoch [18/200] batch [15/32] time 0.351 (0.340) data 0.274 (0.263) loss_u loss_u 0.9507 (0.9498) acc_u 6.2500 (6.4583) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [20/32] time 0.343 (0.341) data 0.265 (0.263) loss_u loss_u 0.9224 (0.9468) acc_u 9.3750 (6.5625) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [25/32] time 0.331 (0.341) data 0.254 (0.263) loss_u loss_u 0.9546 (0.9469) acc_u 6.2500 (6.6250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [30/32] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.9321 (0.9402) acc_u 9.3750 (7.3958) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 547
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:545
clean false:18
clean_rate:0.9680284191829485
noisy true:540
noisy false:529
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [19/200] batch [5/17] time 0.348 (0.321) data 0.271 (0.243) loss_x loss_x 0.7471 (0.6163) acc_x 93.7500 (86.2500) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/17] time 0.344 (0.330) data 0.266 (0.253) loss_x loss_x 0.2394 (0.5975) acc_x 100.0000 (85.3125) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/17] time 0.337 (0.334) data 0.259 (0.257) loss_x loss_x 0.5439 (0.5656) acc_x 81.2500 (86.4583) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/33] time 0.328 (0.339) data 0.251 (0.261) loss_u loss_u 0.9370 (0.8825) acc_u 6.2500 (15.0000) lr 1.9646e-03 eta 0:00:09
epoch [19/200] batch [10/33] time 0.338 (0.338) data 0.260 (0.260) loss_u loss_u 0.8418 (0.8799) acc_u 18.7500 (14.6875) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [15/33] time 0.325 (0.337) data 0.247 (0.259) loss_u loss_u 0.9170 (0.8948) acc_u 12.5000 (12.9167) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [20/33] time 0.328 (0.336) data 0.250 (0.258) loss_u loss_u 0.9053 (0.9030) acc_u 12.5000 (11.5625) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [25/33] time 0.339 (0.336) data 0.261 (0.258) loss_u loss_u 0.9526 (0.9090) acc_u 6.2500 (11.0000) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [30/33] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9443 (0.9140) acc_u 6.2500 (10.3125) lr 1.9646e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 514
confident_label rate tensor(0.3652, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 596
clean true:579
clean false:17
clean_rate:0.9714765100671141
noisy true:539
noisy false:497
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1036
epoch [20/200] batch [5/18] time 0.326 (0.335) data 0.248 (0.257) loss_x loss_x 0.6641 (0.5845) acc_x 87.5000 (88.1250) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/18] time 0.295 (0.320) data 0.217 (0.243) loss_x loss_x 0.9341 (0.5453) acc_x 78.1250 (88.1250) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/18] time 0.347 (0.326) data 0.269 (0.249) loss_x loss_x 0.5186 (0.5611) acc_x 87.5000 (86.6667) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/32] time 0.356 (0.325) data 0.278 (0.247) loss_u loss_u 0.8818 (0.9214) acc_u 12.5000 (9.3750) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [10/32] time 0.347 (0.327) data 0.270 (0.249) loss_u loss_u 0.9102 (0.9334) acc_u 9.3750 (7.5000) lr 1.9603e-03 eta 0:00:07
epoch [20/200] batch [15/32] time 0.332 (0.328) data 0.254 (0.250) loss_u loss_u 0.9185 (0.9340) acc_u 12.5000 (7.9167) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [20/32] time 0.336 (0.331) data 0.258 (0.253) loss_u loss_u 0.9360 (0.9405) acc_u 6.2500 (6.8750) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [25/32] time 0.345 (0.331) data 0.267 (0.254) loss_u loss_u 0.9453 (0.9415) acc_u 6.2500 (6.6250) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [30/32] time 0.331 (0.332) data 0.253 (0.255) loss_u loss_u 0.9321 (0.9425) acc_u 9.3750 (6.7708) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 536
confident_label rate tensor(0.3621, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 591
clean true:575
clean false:16
clean_rate:0.9729272419627749
noisy true:521
noisy false:520
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1041
epoch [21/200] batch [5/18] time 0.350 (0.348) data 0.273 (0.271) loss_x loss_x 0.3887 (0.6714) acc_x 87.5000 (85.6250) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/18] time 0.302 (0.332) data 0.224 (0.254) loss_x loss_x 1.3936 (0.6864) acc_x 75.0000 (85.6250) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/18] time 0.326 (0.329) data 0.249 (0.252) loss_x loss_x 0.5586 (0.6402) acc_x 90.6250 (85.8333) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/32] time 0.344 (0.330) data 0.266 (0.252) loss_u loss_u 0.9233 (0.9269) acc_u 9.3750 (10.6250) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [10/32] time 0.343 (0.331) data 0.265 (0.253) loss_u loss_u 0.9692 (0.9191) acc_u 3.1250 (10.3125) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [15/32] time 0.341 (0.332) data 0.264 (0.254) loss_u loss_u 0.9165 (0.9172) acc_u 9.3750 (10.4167) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [20/32] time 0.344 (0.333) data 0.266 (0.255) loss_u loss_u 0.9565 (0.9221) acc_u 6.2500 (10.3125) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [25/32] time 0.333 (0.333) data 0.255 (0.256) loss_u loss_u 0.9341 (0.9263) acc_u 9.3750 (9.7500) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [30/32] time 0.358 (0.335) data 0.280 (0.257) loss_u loss_u 0.9448 (0.9287) acc_u 9.3750 (9.5833) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 508
confident_label rate tensor(0.3646, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 595
clean true:580
clean false:15
clean_rate:0.9747899159663865
noisy true:544
noisy false:493
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1037
epoch [22/200] batch [5/18] time 0.330 (0.335) data 0.253 (0.257) loss_x loss_x 0.4558 (0.7015) acc_x 90.6250 (81.2500) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/18] time 0.340 (0.338) data 0.263 (0.261) loss_x loss_x 0.2878 (0.6043) acc_x 90.6250 (84.6875) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/18] time 0.359 (0.334) data 0.281 (0.257) loss_x loss_x 0.6357 (0.6003) acc_x 78.1250 (84.5833) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [5/32] time 0.346 (0.338) data 0.267 (0.260) loss_u loss_u 0.9326 (0.9187) acc_u 6.2500 (10.0000) lr 1.9511e-03 eta 0:00:09
epoch [22/200] batch [10/32] time 0.337 (0.339) data 0.260 (0.261) loss_u loss_u 0.9292 (0.9120) acc_u 6.2500 (10.9375) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [15/32] time 0.343 (0.340) data 0.265 (0.262) loss_u loss_u 0.9946 (0.9233) acc_u 0.0000 (8.9583) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [20/32] time 0.343 (0.340) data 0.265 (0.263) loss_u loss_u 0.9873 (0.9345) acc_u 3.1250 (7.8125) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [25/32] time 0.353 (0.341) data 0.275 (0.264) loss_u loss_u 0.9697 (0.9371) acc_u 6.2500 (7.6250) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [30/32] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9478 (0.9378) acc_u 6.2500 (7.6042) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 506
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 608
clean true:592
clean false:16
clean_rate:0.9736842105263158
noisy true:534
noisy false:490
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1024
epoch [23/200] batch [5/19] time 0.330 (0.335) data 0.251 (0.257) loss_x loss_x 0.4167 (0.5977) acc_x 90.6250 (86.2500) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [10/19] time 0.340 (0.336) data 0.262 (0.258) loss_x loss_x 0.3833 (0.5698) acc_x 87.5000 (86.5625) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/19] time 0.341 (0.339) data 0.263 (0.261) loss_x loss_x 0.3303 (0.5568) acc_x 96.8750 (87.7083) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [5/32] time 0.352 (0.341) data 0.273 (0.263) loss_u loss_u 0.8760 (0.9459) acc_u 15.6250 (6.8750) lr 1.9461e-03 eta 0:00:09
epoch [23/200] batch [10/32] time 0.344 (0.341) data 0.265 (0.263) loss_u loss_u 0.9917 (0.9343) acc_u 0.0000 (9.0625) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [15/32] time 0.337 (0.341) data 0.258 (0.263) loss_u loss_u 0.9097 (0.9328) acc_u 9.3750 (8.9583) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [20/32] time 0.337 (0.340) data 0.258 (0.262) loss_u loss_u 0.9619 (0.9339) acc_u 3.1250 (8.5938) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [25/32] time 0.335 (0.340) data 0.257 (0.261) loss_u loss_u 0.9907 (0.9351) acc_u 0.0000 (8.2500) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [30/32] time 0.322 (0.339) data 0.243 (0.261) loss_u loss_u 0.9678 (0.9382) acc_u 9.3750 (8.0208) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 523
confident_label rate tensor(0.3627, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 592
clean true:576
clean false:16
clean_rate:0.972972972972973
noisy true:533
noisy false:507
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1040
epoch [24/200] batch [5/18] time 0.330 (0.348) data 0.253 (0.271) loss_x loss_x 0.6870 (0.6064) acc_x 81.2500 (87.5000) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/18] time 0.345 (0.347) data 0.268 (0.270) loss_x loss_x 0.4485 (0.5187) acc_x 90.6250 (89.0625) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/18] time 0.342 (0.347) data 0.264 (0.270) loss_x loss_x 0.4136 (0.5370) acc_x 93.7500 (88.7500) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [5/32] time 0.334 (0.347) data 0.256 (0.269) loss_u loss_u 0.9492 (0.9208) acc_u 6.2500 (10.0000) lr 1.9409e-03 eta 0:00:09
epoch [24/200] batch [10/32] time 0.353 (0.349) data 0.275 (0.271) loss_u loss_u 0.9512 (0.9261) acc_u 6.2500 (9.6875) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [15/32] time 0.353 (0.349) data 0.275 (0.272) loss_u loss_u 0.9609 (0.9300) acc_u 3.1250 (8.5417) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [20/32] time 0.350 (0.349) data 0.272 (0.272) loss_u loss_u 0.9385 (0.9316) acc_u 6.2500 (8.1250) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [25/32] time 0.328 (0.347) data 0.250 (0.269) loss_u loss_u 0.9399 (0.9300) acc_u 6.2500 (8.3750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [30/32] time 0.347 (0.346) data 0.269 (0.268) loss_u loss_u 0.9595 (0.9278) acc_u 3.1250 (8.7500) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 484
confident_label rate tensor(0.3842, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 627
clean true:608
clean false:19
clean_rate:0.9696969696969697
noisy true:540
noisy false:465
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 1005
epoch [25/200] batch [5/19] time 0.336 (0.342) data 0.259 (0.264) loss_x loss_x 0.5488 (0.5892) acc_x 87.5000 (86.8750) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/19] time 0.301 (0.334) data 0.224 (0.256) loss_x loss_x 0.5029 (0.5436) acc_x 93.7500 (89.0625) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/19] time 0.319 (0.334) data 0.241 (0.256) loss_x loss_x 0.6572 (0.5738) acc_x 81.2500 (88.7500) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [5/31] time 0.351 (0.336) data 0.274 (0.258) loss_u loss_u 0.9214 (0.9279) acc_u 9.3750 (8.7500) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [10/31] time 0.334 (0.335) data 0.256 (0.258) loss_u loss_u 0.9399 (0.9421) acc_u 6.2500 (6.8750) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [15/31] time 0.331 (0.337) data 0.253 (0.259) loss_u loss_u 0.9575 (0.9496) acc_u 3.1250 (5.4167) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [20/31] time 0.336 (0.338) data 0.258 (0.260) loss_u loss_u 0.8271 (0.9417) acc_u 21.8750 (7.1875) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/31] time 0.332 (0.338) data 0.254 (0.260) loss_u loss_u 0.9624 (0.9415) acc_u 3.1250 (7.1250) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [30/31] time 0.305 (0.336) data 0.226 (0.258) loss_u loss_u 0.9316 (0.9417) acc_u 9.3750 (7.1875) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 523
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 599
clean true:587
clean false:12
clean_rate:0.9799666110183639
noisy true:522
noisy false:511
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1033
epoch [26/200] batch [5/18] time 0.349 (0.343) data 0.271 (0.265) loss_x loss_x 0.8677 (0.5898) acc_x 75.0000 (85.0000) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/18] time 0.339 (0.345) data 0.262 (0.267) loss_x loss_x 0.5405 (0.5709) acc_x 81.2500 (85.6250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/18] time 0.345 (0.343) data 0.267 (0.265) loss_x loss_x 0.6655 (0.5948) acc_x 87.5000 (85.8333) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [5/32] time 0.331 (0.342) data 0.253 (0.264) loss_u loss_u 0.9009 (0.9178) acc_u 12.5000 (11.2500) lr 1.9298e-03 eta 0:00:09
epoch [26/200] batch [10/32] time 0.338 (0.341) data 0.260 (0.264) loss_u loss_u 0.9238 (0.9241) acc_u 9.3750 (9.6875) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [15/32] time 0.332 (0.340) data 0.253 (0.262) loss_u loss_u 0.9531 (0.9205) acc_u 3.1250 (9.7917) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [20/32] time 0.344 (0.339) data 0.266 (0.262) loss_u loss_u 0.9111 (0.9224) acc_u 9.3750 (9.5312) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [25/32] time 0.345 (0.339) data 0.268 (0.261) loss_u loss_u 0.9102 (0.9219) acc_u 12.5000 (9.6250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [30/32] time 0.297 (0.338) data 0.218 (0.260) loss_u loss_u 0.9292 (0.9241) acc_u 6.2500 (9.0625) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 458
confident_label rate tensor(0.3860, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 630
clean true:614
clean false:16
clean_rate:0.9746031746031746
noisy true:560
noisy false:442
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 1002
epoch [27/200] batch [5/19] time 0.290 (0.323) data 0.212 (0.245) loss_x loss_x 0.5669 (0.5327) acc_x 87.5000 (86.8750) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/19] time 0.332 (0.317) data 0.255 (0.240) loss_x loss_x 0.5137 (0.6069) acc_x 87.5000 (86.5625) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/19] time 0.342 (0.323) data 0.265 (0.245) loss_x loss_x 0.8989 (0.5822) acc_x 84.3750 (87.0833) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [5/31] time 0.350 (0.332) data 0.272 (0.254) loss_u loss_u 0.9502 (0.9242) acc_u 6.2500 (10.0000) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [10/31] time 0.348 (0.336) data 0.271 (0.258) loss_u loss_u 0.9517 (0.9335) acc_u 6.2500 (8.7500) lr 1.9239e-03 eta 0:00:07
epoch [27/200] batch [15/31] time 0.336 (0.335) data 0.258 (0.258) loss_u loss_u 0.9297 (0.9362) acc_u 6.2500 (8.3333) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [20/31] time 0.343 (0.336) data 0.265 (0.258) loss_u loss_u 0.9282 (0.9386) acc_u 9.3750 (7.6562) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/31] time 0.334 (0.336) data 0.257 (0.258) loss_u loss_u 0.9639 (0.9430) acc_u 3.1250 (7.0000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [30/31] time 0.320 (0.335) data 0.242 (0.258) loss_u loss_u 0.9258 (0.9424) acc_u 6.2500 (7.0833) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 497
confident_label rate tensor(0.3585, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 585
clean true:574
clean false:11
clean_rate:0.9811965811965812
noisy true:561
noisy false:486
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1047
epoch [28/200] batch [5/18] time 0.341 (0.345) data 0.264 (0.268) loss_x loss_x 0.6831 (0.8188) acc_x 81.2500 (80.6250) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/18] time 0.337 (0.344) data 0.259 (0.266) loss_x loss_x 0.3684 (0.6178) acc_x 90.6250 (85.6250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/18] time 0.342 (0.341) data 0.265 (0.263) loss_x loss_x 0.6309 (0.6113) acc_x 87.5000 (85.4167) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [5/32] time 0.341 (0.340) data 0.263 (0.262) loss_u loss_u 0.9507 (0.9109) acc_u 9.3750 (11.2500) lr 1.9178e-03 eta 0:00:09
epoch [28/200] batch [10/32] time 0.339 (0.340) data 0.261 (0.262) loss_u loss_u 0.9233 (0.9186) acc_u 9.3750 (10.6250) lr 1.9178e-03 eta 0:00:07
epoch [28/200] batch [15/32] time 0.340 (0.340) data 0.263 (0.263) loss_u loss_u 0.8906 (0.9074) acc_u 12.5000 (11.6667) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [20/32] time 0.354 (0.340) data 0.277 (0.262) loss_u loss_u 0.9004 (0.9102) acc_u 12.5000 (11.4062) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [25/32] time 0.337 (0.339) data 0.259 (0.261) loss_u loss_u 0.9053 (0.9119) acc_u 15.6250 (11.5000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [30/32] time 0.341 (0.338) data 0.263 (0.260) loss_u loss_u 0.9468 (0.9139) acc_u 6.2500 (11.1458) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 476
confident_label rate tensor(0.3811, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 622
clean true:603
clean false:19
clean_rate:0.9694533762057878
noisy true:553
noisy false:457
after delete: len(clean_dataset) 622
after delete: len(noisy_dataset) 1010
epoch [29/200] batch [5/19] time 0.351 (0.350) data 0.273 (0.273) loss_x loss_x 0.5049 (0.5288) acc_x 84.3750 (85.6250) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/19] time 0.337 (0.346) data 0.259 (0.269) loss_x loss_x 0.6396 (0.6217) acc_x 84.3750 (85.6250) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/19] time 0.330 (0.344) data 0.253 (0.267) loss_x loss_x 0.5869 (0.5294) acc_x 90.6250 (88.5417) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [5/31] time 0.342 (0.345) data 0.264 (0.268) loss_u loss_u 0.9150 (0.9367) acc_u 9.3750 (6.2500) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [10/31] time 0.328 (0.344) data 0.250 (0.266) loss_u loss_u 0.8867 (0.9225) acc_u 15.6250 (9.3750) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [15/31] time 0.328 (0.342) data 0.250 (0.265) loss_u loss_u 0.9390 (0.9336) acc_u 6.2500 (8.1250) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [20/31] time 0.316 (0.340) data 0.239 (0.263) loss_u loss_u 0.8389 (0.9247) acc_u 15.6250 (8.9062) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/31] time 0.343 (0.340) data 0.264 (0.263) loss_u loss_u 0.9561 (0.9242) acc_u 6.2500 (9.1250) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [30/31] time 0.298 (0.337) data 0.219 (0.260) loss_u loss_u 0.9595 (0.9273) acc_u 3.1250 (8.6458) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 492
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 616
clean true:598
clean false:18
clean_rate:0.9707792207792207
noisy true:542
noisy false:474
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1016
epoch [30/200] batch [5/19] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.6748 (0.5403) acc_x 87.5000 (88.7500) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/19] time 0.328 (0.344) data 0.251 (0.267) loss_x loss_x 0.7822 (0.5140) acc_x 84.3750 (89.0625) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/19] time 0.348 (0.344) data 0.271 (0.266) loss_x loss_x 0.2377 (0.5073) acc_x 96.8750 (89.5833) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [5/31] time 0.338 (0.342) data 0.260 (0.265) loss_u loss_u 0.9277 (0.9104) acc_u 6.2500 (11.2500) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [10/31] time 0.350 (0.342) data 0.273 (0.264) loss_u loss_u 0.9268 (0.9202) acc_u 6.2500 (9.6875) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [15/31] time 0.321 (0.341) data 0.243 (0.264) loss_u loss_u 0.8760 (0.9243) acc_u 15.6250 (9.3750) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [20/31] time 0.346 (0.340) data 0.268 (0.263) loss_u loss_u 0.9351 (0.9285) acc_u 6.2500 (8.9062) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [25/31] time 0.330 (0.340) data 0.253 (0.262) loss_u loss_u 0.9380 (0.9327) acc_u 9.3750 (8.3750) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [30/31] time 0.299 (0.337) data 0.221 (0.259) loss_u loss_u 0.9062 (0.9338) acc_u 12.5000 (8.4375) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 487
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 617
clean true:595
clean false:22
clean_rate:0.9643435980551054
noisy true:550
noisy false:465
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 1015
epoch [31/200] batch [5/19] time 0.348 (0.319) data 0.271 (0.242) loss_x loss_x 0.3740 (0.5500) acc_x 87.5000 (85.0000) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/19] time 0.351 (0.332) data 0.273 (0.255) loss_x loss_x 0.7290 (0.6091) acc_x 81.2500 (84.3750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/19] time 0.330 (0.336) data 0.252 (0.258) loss_x loss_x 0.6001 (0.5842) acc_x 90.6250 (86.0417) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [5/31] time 0.328 (0.338) data 0.250 (0.260) loss_u loss_u 0.9497 (0.9185) acc_u 6.2500 (10.6250) lr 1.8980e-03 eta 0:00:08
epoch [31/200] batch [10/31] time 0.327 (0.337) data 0.249 (0.259) loss_u loss_u 0.7295 (0.9021) acc_u 34.3750 (12.1875) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [15/31] time 0.331 (0.337) data 0.254 (0.259) loss_u loss_u 0.9644 (0.9119) acc_u 3.1250 (11.0417) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [20/31] time 0.328 (0.337) data 0.250 (0.259) loss_u loss_u 0.9429 (0.9173) acc_u 6.2500 (10.1562) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [25/31] time 0.323 (0.337) data 0.245 (0.259) loss_u loss_u 0.9668 (0.9218) acc_u 6.2500 (9.6250) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [30/31] time 0.300 (0.335) data 0.221 (0.257) loss_u loss_u 0.9111 (0.9232) acc_u 12.5000 (9.4792) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 474
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 616
clean true:606
clean false:10
clean_rate:0.9837662337662337
noisy true:552
noisy false:464
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1016
epoch [32/200] batch [5/19] time 0.339 (0.306) data 0.262 (0.228) loss_x loss_x 0.4216 (0.6456) acc_x 90.6250 (83.1250) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/19] time 0.336 (0.324) data 0.259 (0.246) loss_x loss_x 0.6846 (0.5512) acc_x 81.2500 (86.2500) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/19] time 0.321 (0.327) data 0.243 (0.249) loss_x loss_x 0.5659 (0.5287) acc_x 84.3750 (86.6667) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [5/31] time 0.331 (0.333) data 0.252 (0.255) loss_u loss_u 0.9150 (0.9227) acc_u 9.3750 (8.1250) lr 1.8910e-03 eta 0:00:08
epoch [32/200] batch [10/31] time 0.331 (0.333) data 0.252 (0.255) loss_u loss_u 0.9116 (0.9191) acc_u 6.2500 (8.4375) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [15/31] time 0.339 (0.334) data 0.262 (0.256) loss_u loss_u 0.9131 (0.9184) acc_u 12.5000 (9.1667) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [20/31] time 0.333 (0.333) data 0.255 (0.255) loss_u loss_u 0.9131 (0.9224) acc_u 9.3750 (8.7500) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [25/31] time 0.346 (0.334) data 0.269 (0.256) loss_u loss_u 0.9336 (0.9270) acc_u 9.3750 (8.6250) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [30/31] time 0.344 (0.334) data 0.266 (0.257) loss_u loss_u 0.9072 (0.9253) acc_u 12.5000 (8.8542) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 442
confident_label rate tensor(0.3873, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 632
clean true:618
clean false:14
clean_rate:0.9778481012658228
noisy true:572
noisy false:428
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 1000
epoch [33/200] batch [5/19] time 0.294 (0.332) data 0.216 (0.254) loss_x loss_x 1.0762 (0.5627) acc_x 81.2500 (88.1250) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/19] time 0.327 (0.316) data 0.250 (0.239) loss_x loss_x 0.5400 (0.5422) acc_x 90.6250 (88.4375) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/19] time 0.348 (0.319) data 0.271 (0.242) loss_x loss_x 0.5532 (0.5267) acc_x 93.7500 (88.9583) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [5/31] time 0.347 (0.326) data 0.269 (0.248) loss_u loss_u 0.9468 (0.9222) acc_u 6.2500 (9.3750) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [10/31] time 0.349 (0.328) data 0.271 (0.250) loss_u loss_u 0.9619 (0.9265) acc_u 3.1250 (9.0625) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [15/31] time 0.323 (0.330) data 0.245 (0.253) loss_u loss_u 0.8730 (0.9313) acc_u 15.6250 (8.7500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [20/31] time 0.323 (0.331) data 0.244 (0.253) loss_u loss_u 0.9556 (0.9329) acc_u 6.2500 (8.7500) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/31] time 0.338 (0.332) data 0.260 (0.255) loss_u loss_u 0.8960 (0.9337) acc_u 12.5000 (8.7500) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [30/31] time 0.341 (0.333) data 0.263 (0.256) loss_u loss_u 0.9458 (0.9327) acc_u 6.2500 (8.6458) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 480
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 624
clean true:603
clean false:21
clean_rate:0.9663461538461539
noisy true:549
noisy false:459
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 1008
epoch [34/200] batch [5/19] time 0.307 (0.338) data 0.230 (0.260) loss_x loss_x 0.3274 (0.4629) acc_x 93.7500 (90.6250) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/19] time 0.312 (0.322) data 0.235 (0.244) loss_x loss_x 0.4160 (0.4725) acc_x 87.5000 (90.0000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/19] time 0.342 (0.326) data 0.264 (0.248) loss_x loss_x 0.4333 (0.4625) acc_x 90.6250 (90.2083) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [5/31] time 0.349 (0.330) data 0.271 (0.253) loss_u loss_u 0.9180 (0.9217) acc_u 12.5000 (9.3750) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [10/31] time 0.332 (0.332) data 0.254 (0.255) loss_u loss_u 0.9438 (0.9251) acc_u 9.3750 (9.6875) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [15/31] time 0.349 (0.334) data 0.270 (0.256) loss_u loss_u 0.9302 (0.9258) acc_u 6.2500 (8.9583) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [20/31] time 0.351 (0.334) data 0.273 (0.256) loss_u loss_u 0.9424 (0.9308) acc_u 6.2500 (8.2812) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [25/31] time 0.337 (0.335) data 0.259 (0.257) loss_u loss_u 0.9556 (0.9244) acc_u 3.1250 (8.8750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [30/31] time 0.344 (0.335) data 0.267 (0.257) loss_u loss_u 0.9634 (0.9286) acc_u 3.1250 (8.4375) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 442
confident_label rate tensor(0.3958, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 646
clean true:629
clean false:17
clean_rate:0.9736842105263158
noisy true:561
noisy false:425
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 986
epoch [35/200] batch [5/20] time 0.339 (0.338) data 0.261 (0.260) loss_x loss_x 0.4873 (0.4937) acc_x 81.2500 (83.1250) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [10/20] time 0.301 (0.328) data 0.223 (0.250) loss_x loss_x 0.4744 (0.4716) acc_x 81.2500 (84.3750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/20] time 0.348 (0.327) data 0.270 (0.250) loss_x loss_x 0.2888 (0.5241) acc_x 90.6250 (84.1667) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/20] time 0.329 (0.329) data 0.251 (0.252) loss_x loss_x 0.7358 (0.5607) acc_x 81.2500 (83.7500) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/30] time 0.349 (0.331) data 0.271 (0.254) loss_u loss_u 0.8975 (0.9449) acc_u 12.5000 (6.8750) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [10/30] time 0.322 (0.333) data 0.244 (0.255) loss_u loss_u 0.9604 (0.9392) acc_u 6.2500 (7.1875) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [15/30] time 0.341 (0.334) data 0.264 (0.256) loss_u loss_u 0.9546 (0.9430) acc_u 6.2500 (6.8750) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [20/30] time 0.339 (0.334) data 0.261 (0.256) loss_u loss_u 0.9258 (0.9400) acc_u 9.3750 (7.1875) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [25/30] time 0.329 (0.333) data 0.251 (0.255) loss_u loss_u 0.9321 (0.9368) acc_u 6.2500 (7.5000) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [30/30] time 0.310 (0.333) data 0.231 (0.255) loss_u loss_u 0.9634 (0.9356) acc_u 6.2500 (7.9167) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 439
confident_label rate tensor(0.3958, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 646
clean true:630
clean false:16
clean_rate:0.9752321981424149
noisy true:563
noisy false:423
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 986
epoch [36/200] batch [5/20] time 0.323 (0.319) data 0.246 (0.242) loss_x loss_x 0.6416 (0.5526) acc_x 78.1250 (83.7500) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [10/20] time 0.334 (0.325) data 0.257 (0.248) loss_x loss_x 0.9556 (0.5710) acc_x 81.2500 (86.2500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [15/20] time 0.298 (0.322) data 0.220 (0.244) loss_x loss_x 0.3914 (0.5155) acc_x 93.7500 (88.1250) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/20] time 0.349 (0.322) data 0.272 (0.244) loss_x loss_x 0.3337 (0.5107) acc_x 93.7500 (87.6562) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/30] time 0.335 (0.327) data 0.257 (0.249) loss_u loss_u 0.9277 (0.9603) acc_u 6.2500 (4.3750) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [10/30] time 0.327 (0.329) data 0.249 (0.252) loss_u loss_u 0.9648 (0.9568) acc_u 3.1250 (5.0000) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [15/30] time 0.332 (0.330) data 0.254 (0.252) loss_u loss_u 0.8750 (0.9454) acc_u 15.6250 (6.4583) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [20/30] time 0.344 (0.331) data 0.266 (0.254) loss_u loss_u 0.9839 (0.9423) acc_u 3.1250 (7.1875) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [25/30] time 0.344 (0.333) data 0.267 (0.255) loss_u loss_u 0.9331 (0.9384) acc_u 6.2500 (7.7500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [30/30] time 0.352 (0.334) data 0.274 (0.256) loss_u loss_u 0.9814 (0.9402) acc_u 0.0000 (7.1875) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 445
confident_label rate tensor(0.3971, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 648
clean true:630
clean false:18
clean_rate:0.9722222222222222
noisy true:557
noisy false:427
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 984
epoch [37/200] batch [5/20] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.4407 (0.4836) acc_x 90.6250 (90.6250) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [10/20] time 0.352 (0.349) data 0.274 (0.272) loss_x loss_x 0.3359 (0.4691) acc_x 93.7500 (90.3125) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/20] time 0.302 (0.342) data 0.225 (0.264) loss_x loss_x 0.3579 (0.5013) acc_x 93.7500 (88.7500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/20] time 0.299 (0.332) data 0.221 (0.254) loss_x loss_x 0.3994 (0.4783) acc_x 90.6250 (89.3750) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/30] time 0.336 (0.332) data 0.259 (0.254) loss_u loss_u 0.9214 (0.9531) acc_u 6.2500 (4.3750) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [10/30] time 0.359 (0.334) data 0.282 (0.256) loss_u loss_u 0.8755 (0.9360) acc_u 15.6250 (7.5000) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [15/30] time 0.337 (0.335) data 0.259 (0.257) loss_u loss_u 0.9663 (0.9441) acc_u 6.2500 (7.0833) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [20/30] time 0.347 (0.337) data 0.269 (0.259) loss_u loss_u 0.9424 (0.9425) acc_u 9.3750 (7.1875) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [25/30] time 0.349 (0.337) data 0.271 (0.259) loss_u loss_u 0.9341 (0.9394) acc_u 6.2500 (7.6250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [30/30] time 0.381 (0.338) data 0.303 (0.260) loss_u loss_u 0.9922 (0.9435) acc_u 0.0000 (7.0833) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 440
confident_label rate tensor(0.3903, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 637
clean true:618
clean false:19
clean_rate:0.9701726844583988
noisy true:574
noisy false:421
after delete: len(clean_dataset) 637
after delete: len(noisy_dataset) 995
epoch [38/200] batch [5/19] time 0.335 (0.339) data 0.257 (0.261) loss_x loss_x 0.3218 (0.4889) acc_x 93.7500 (88.7500) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/19] time 0.344 (0.337) data 0.266 (0.259) loss_x loss_x 0.5269 (0.4315) acc_x 87.5000 (90.6250) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/19] time 0.349 (0.337) data 0.271 (0.260) loss_x loss_x 0.1195 (0.4387) acc_x 96.8750 (90.2083) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [5/31] time 0.300 (0.335) data 0.221 (0.257) loss_u loss_u 0.9072 (0.9099) acc_u 9.3750 (11.2500) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [10/31] time 0.339 (0.331) data 0.261 (0.253) loss_u loss_u 0.9399 (0.9310) acc_u 12.5000 (9.0625) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [15/31] time 0.330 (0.331) data 0.252 (0.253) loss_u loss_u 0.8433 (0.9263) acc_u 18.7500 (9.7917) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [20/31] time 0.339 (0.332) data 0.261 (0.254) loss_u loss_u 0.9263 (0.9231) acc_u 6.2500 (9.8438) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/31] time 0.329 (0.332) data 0.250 (0.254) loss_u loss_u 0.9624 (0.9284) acc_u 3.1250 (9.3750) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [30/31] time 0.346 (0.333) data 0.268 (0.255) loss_u loss_u 0.9727 (0.9284) acc_u 3.1250 (9.3750) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.3983, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 650
clean true:634
clean false:16
clean_rate:0.9753846153846154
noisy true:570
noisy false:412
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 982
epoch [39/200] batch [5/20] time 0.353 (0.359) data 0.276 (0.282) loss_x loss_x 0.4365 (0.5234) acc_x 93.7500 (90.0000) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/20] time 0.345 (0.349) data 0.268 (0.271) loss_x loss_x 0.2141 (0.4585) acc_x 96.8750 (90.6250) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [15/20] time 0.324 (0.344) data 0.246 (0.266) loss_x loss_x 0.5171 (0.5068) acc_x 84.3750 (88.9583) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/20] time 0.340 (0.341) data 0.262 (0.263) loss_x loss_x 0.6763 (0.4941) acc_x 81.2500 (89.0625) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/30] time 0.298 (0.339) data 0.219 (0.261) loss_u loss_u 0.9189 (0.9349) acc_u 9.3750 (7.5000) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [10/30] time 0.369 (0.337) data 0.291 (0.259) loss_u loss_u 0.8882 (0.9332) acc_u 12.5000 (7.8125) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [15/30] time 0.333 (0.337) data 0.254 (0.259) loss_u loss_u 0.9990 (0.9388) acc_u 0.0000 (7.0833) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [20/30] time 0.349 (0.337) data 0.272 (0.260) loss_u loss_u 0.9146 (0.9340) acc_u 12.5000 (7.8125) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [25/30] time 0.360 (0.339) data 0.282 (0.261) loss_u loss_u 0.9204 (0.9324) acc_u 12.5000 (8.1250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [30/30] time 0.351 (0.339) data 0.273 (0.261) loss_u loss_u 0.9966 (0.9325) acc_u 0.0000 (8.1250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 431
confident_label rate tensor(0.3934, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 642
clean true:629
clean false:13
clean_rate:0.9797507788161994
noisy true:572
noisy false:418
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 990
epoch [40/200] batch [5/20] time 0.333 (0.351) data 0.255 (0.274) loss_x loss_x 0.7700 (0.4173) acc_x 81.2500 (91.2500) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/20] time 0.354 (0.348) data 0.276 (0.270) loss_x loss_x 0.3848 (0.3842) acc_x 93.7500 (93.1250) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [15/20] time 0.338 (0.345) data 0.261 (0.267) loss_x loss_x 0.4583 (0.4538) acc_x 90.6250 (90.2083) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/20] time 0.345 (0.342) data 0.268 (0.265) loss_x loss_x 0.6934 (0.4926) acc_x 81.2500 (89.0625) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/30] time 0.304 (0.339) data 0.225 (0.261) loss_u loss_u 0.9780 (0.9301) acc_u 6.2500 (9.3750) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [10/30] time 0.345 (0.337) data 0.267 (0.259) loss_u loss_u 0.9712 (0.9343) acc_u 3.1250 (8.4375) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [15/30] time 0.324 (0.335) data 0.246 (0.258) loss_u loss_u 0.9946 (0.9428) acc_u 3.1250 (7.5000) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [20/30] time 0.338 (0.335) data 0.259 (0.257) loss_u loss_u 0.8472 (0.9396) acc_u 15.6250 (7.8125) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [25/30] time 0.321 (0.335) data 0.243 (0.257) loss_u loss_u 0.9478 (0.9334) acc_u 6.2500 (8.5000) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [30/30] time 0.492 (0.339) data 0.412 (0.261) loss_u loss_u 0.9580 (0.9328) acc_u 3.1250 (8.5417) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 467
confident_label rate tensor(0.3952, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 645
clean true:621
clean false:24
clean_rate:0.9627906976744186
noisy true:544
noisy false:443
after delete: len(clean_dataset) 645
after delete: len(noisy_dataset) 987
epoch [41/200] batch [5/20] time 0.343 (0.343) data 0.266 (0.265) loss_x loss_x 0.3923 (0.6082) acc_x 90.6250 (86.2500) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/20] time 0.345 (0.344) data 0.268 (0.266) loss_x loss_x 0.4526 (0.5754) acc_x 90.6250 (88.7500) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/20] time 0.338 (0.343) data 0.261 (0.266) loss_x loss_x 0.7954 (0.5988) acc_x 81.2500 (87.9167) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/20] time 0.343 (0.344) data 0.266 (0.267) loss_x loss_x 0.5938 (0.5942) acc_x 87.5000 (87.8125) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/30] time 0.344 (0.343) data 0.267 (0.266) loss_u loss_u 0.9297 (0.9196) acc_u 9.3750 (8.7500) lr 1.8181e-03 eta 0:00:08
epoch [41/200] batch [10/30] time 0.305 (0.340) data 0.227 (0.263) loss_u loss_u 0.9507 (0.9352) acc_u 6.2500 (7.8125) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [15/30] time 0.301 (0.337) data 0.223 (0.259) loss_u loss_u 0.9209 (0.9340) acc_u 9.3750 (8.3333) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [20/30] time 0.329 (0.337) data 0.251 (0.259) loss_u loss_u 0.9136 (0.9291) acc_u 9.3750 (9.0625) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [25/30] time 0.346 (0.338) data 0.267 (0.260) loss_u loss_u 0.9585 (0.9296) acc_u 6.2500 (8.8750) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [30/30] time 0.344 (0.338) data 0.267 (0.261) loss_u loss_u 0.9097 (0.9342) acc_u 12.5000 (8.3333) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 425
confident_label rate tensor(0.3915, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 639
clean true:623
clean false:16
clean_rate:0.974960876369327
noisy true:584
noisy false:409
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 993
epoch [42/200] batch [5/19] time 0.351 (0.356) data 0.274 (0.278) loss_x loss_x 0.3245 (0.3682) acc_x 90.6250 (90.6250) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/19] time 0.339 (0.350) data 0.261 (0.273) loss_x loss_x 0.4841 (0.3731) acc_x 90.6250 (90.9375) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/19] time 0.354 (0.349) data 0.276 (0.272) loss_x loss_x 0.4128 (0.4039) acc_x 87.5000 (91.0417) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [5/31] time 0.351 (0.349) data 0.273 (0.272) loss_u loss_u 0.8828 (0.9478) acc_u 15.6250 (6.8750) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [10/31] time 0.339 (0.349) data 0.261 (0.271) loss_u loss_u 0.8481 (0.9359) acc_u 15.6250 (7.8125) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [15/31] time 0.310 (0.342) data 0.231 (0.264) loss_u loss_u 0.8779 (0.9265) acc_u 15.6250 (8.9583) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [20/31] time 0.336 (0.341) data 0.257 (0.263) loss_u loss_u 0.8999 (0.9252) acc_u 15.6250 (9.0625) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [25/31] time 0.321 (0.342) data 0.243 (0.264) loss_u loss_u 0.9165 (0.9255) acc_u 6.2500 (9.0000) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [30/31] time 0.336 (0.341) data 0.258 (0.263) loss_u loss_u 0.9141 (0.9227) acc_u 9.3750 (9.3750) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 387
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 662
clean true:645
clean false:17
clean_rate:0.974320241691843
noisy true:600
noisy false:370
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 970
epoch [43/200] batch [5/20] time 0.360 (0.370) data 0.282 (0.292) loss_x loss_x 0.2620 (0.3363) acc_x 93.7500 (92.5000) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/20] time 0.353 (0.363) data 0.276 (0.286) loss_x loss_x 0.2617 (0.4070) acc_x 90.6250 (90.6250) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/20] time 0.348 (0.361) data 0.271 (0.284) loss_x loss_x 0.3572 (0.4298) acc_x 93.7500 (90.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/20] time 0.370 (0.361) data 0.293 (0.284) loss_x loss_x 0.6665 (0.4382) acc_x 87.5000 (90.3125) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/30] time 0.337 (0.358) data 0.259 (0.280) loss_u loss_u 0.9814 (0.9307) acc_u 3.1250 (9.3750) lr 1.7997e-03 eta 0:00:08
epoch [43/200] batch [10/30] time 0.347 (0.355) data 0.269 (0.278) loss_u loss_u 0.9619 (0.9358) acc_u 3.1250 (8.1250) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [15/30] time 0.318 (0.348) data 0.239 (0.271) loss_u loss_u 0.9087 (0.9359) acc_u 9.3750 (8.1250) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [20/30] time 0.326 (0.346) data 0.248 (0.268) loss_u loss_u 0.9453 (0.9373) acc_u 6.2500 (7.9688) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [25/30] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.9614 (0.9374) acc_u 3.1250 (7.7500) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/30] time 0.344 (0.345) data 0.266 (0.268) loss_u loss_u 0.9033 (0.9398) acc_u 15.6250 (7.5000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 427
confident_label rate tensor(0.3983, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 650
clean true:630
clean false:20
clean_rate:0.9692307692307692
noisy true:575
noisy false:407
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 982
epoch [44/200] batch [5/20] time 0.356 (0.378) data 0.278 (0.300) loss_x loss_x 0.5288 (0.4664) acc_x 90.6250 (88.1250) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/20] time 0.342 (0.363) data 0.264 (0.285) loss_x loss_x 0.6113 (0.4927) acc_x 81.2500 (88.1250) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/20] time 0.349 (0.357) data 0.272 (0.279) loss_x loss_x 0.3999 (0.4785) acc_x 93.7500 (88.9583) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/20] time 0.339 (0.355) data 0.261 (0.277) loss_x loss_x 0.2131 (0.4907) acc_x 96.8750 (88.2812) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/30] time 0.336 (0.352) data 0.258 (0.274) loss_u loss_u 0.9590 (0.9247) acc_u 6.2500 (8.7500) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [10/30] time 0.359 (0.351) data 0.280 (0.273) loss_u loss_u 0.9443 (0.9264) acc_u 9.3750 (9.0625) lr 1.7902e-03 eta 0:00:07
epoch [44/200] batch [15/30] time 0.328 (0.350) data 0.251 (0.272) loss_u loss_u 0.9351 (0.9284) acc_u 6.2500 (8.5417) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [20/30] time 0.306 (0.344) data 0.227 (0.266) loss_u loss_u 0.9189 (0.9245) acc_u 9.3750 (9.0625) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [25/30] time 0.340 (0.343) data 0.262 (0.265) loss_u loss_u 0.9365 (0.9271) acc_u 9.3750 (9.0000) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [30/30] time 0.345 (0.343) data 0.267 (0.265) loss_u loss_u 0.8760 (0.9248) acc_u 15.6250 (9.2708) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 435
confident_label rate tensor(0.4050, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 661
clean true:645
clean false:16
clean_rate:0.9757942511346445
noisy true:552
noisy false:419
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 971
epoch [45/200] batch [5/20] time 0.334 (0.345) data 0.257 (0.267) loss_x loss_x 0.7100 (0.6994) acc_x 84.3750 (85.0000) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [10/20] time 0.331 (0.342) data 0.254 (0.265) loss_x loss_x 0.4822 (0.6084) acc_x 87.5000 (86.5625) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/20] time 0.342 (0.343) data 0.264 (0.266) loss_x loss_x 0.4182 (0.5432) acc_x 90.6250 (87.2917) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/20] time 0.347 (0.345) data 0.270 (0.268) loss_x loss_x 0.4600 (0.5359) acc_x 90.6250 (87.3438) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/30] time 0.360 (0.345) data 0.283 (0.268) loss_u loss_u 0.9360 (0.9669) acc_u 9.3750 (5.0000) lr 1.7804e-03 eta 0:00:08
epoch [45/200] batch [10/30] time 0.348 (0.345) data 0.271 (0.268) loss_u loss_u 0.9326 (0.9612) acc_u 6.2500 (5.0000) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [15/30] time 0.337 (0.345) data 0.259 (0.267) loss_u loss_u 0.9023 (0.9508) acc_u 12.5000 (6.4583) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [20/30] time 0.300 (0.341) data 0.221 (0.264) loss_u loss_u 0.9360 (0.9476) acc_u 6.2500 (6.5625) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [25/30] time 0.333 (0.342) data 0.256 (0.264) loss_u loss_u 0.9966 (0.9463) acc_u 0.0000 (6.5000) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [30/30] time 0.329 (0.342) data 0.251 (0.264) loss_u loss_u 0.9443 (0.9411) acc_u 9.3750 (7.3958) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 399
confident_label rate tensor(0.4062, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 663
clean true:644
clean false:19
clean_rate:0.971342383107089
noisy true:589
noisy false:380
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 969
epoch [46/200] batch [5/20] time 0.390 (0.353) data 0.312 (0.275) loss_x loss_x 0.4321 (0.4600) acc_x 90.6250 (90.6250) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/20] time 0.337 (0.352) data 0.260 (0.275) loss_x loss_x 0.8628 (0.5492) acc_x 87.5000 (89.0625) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/20] time 0.338 (0.351) data 0.259 (0.273) loss_x loss_x 0.5229 (0.5200) acc_x 87.5000 (88.7500) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/20] time 0.342 (0.349) data 0.266 (0.271) loss_x loss_x 0.4111 (0.5328) acc_x 93.7500 (88.7500) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/30] time 0.348 (0.348) data 0.270 (0.270) loss_u loss_u 0.9199 (0.9282) acc_u 9.3750 (8.1250) lr 1.7705e-03 eta 0:00:08
epoch [46/200] batch [10/30] time 0.343 (0.348) data 0.264 (0.270) loss_u loss_u 0.9556 (0.9248) acc_u 3.1250 (8.7500) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [15/30] time 0.346 (0.346) data 0.268 (0.269) loss_u loss_u 0.9761 (0.9296) acc_u 3.1250 (8.1250) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [20/30] time 0.339 (0.346) data 0.261 (0.269) loss_u loss_u 0.9141 (0.9382) acc_u 9.3750 (7.0312) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [25/30] time 0.338 (0.346) data 0.259 (0.268) loss_u loss_u 0.9443 (0.9394) acc_u 6.2500 (7.1250) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [30/30] time 0.342 (0.346) data 0.264 (0.268) loss_u loss_u 0.9927 (0.9404) acc_u 0.0000 (7.0833) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 402
confident_label rate tensor(0.4032, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 658
clean true:637
clean false:21
clean_rate:0.9680851063829787
noisy true:593
noisy false:381
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 974
epoch [47/200] batch [5/20] time 0.344 (0.347) data 0.267 (0.269) loss_x loss_x 0.3499 (0.4294) acc_x 90.6250 (90.0000) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/20] time 0.351 (0.345) data 0.274 (0.268) loss_x loss_x 0.2822 (0.4486) acc_x 93.7500 (89.6875) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/20] time 0.367 (0.348) data 0.290 (0.271) loss_x loss_x 0.2334 (0.4729) acc_x 96.8750 (89.3750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/20] time 0.349 (0.347) data 0.272 (0.270) loss_x loss_x 0.3760 (0.4556) acc_x 96.8750 (90.0000) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/30] time 0.352 (0.347) data 0.274 (0.269) loss_u loss_u 0.9463 (0.9437) acc_u 9.3750 (7.5000) lr 1.7604e-03 eta 0:00:08
epoch [47/200] batch [10/30] time 0.331 (0.346) data 0.253 (0.268) loss_u loss_u 0.9658 (0.9265) acc_u 3.1250 (8.7500) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [15/30] time 0.354 (0.346) data 0.275 (0.269) loss_u loss_u 0.9473 (0.9298) acc_u 6.2500 (8.5417) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [20/30] time 0.335 (0.346) data 0.257 (0.269) loss_u loss_u 0.9634 (0.9360) acc_u 3.1250 (7.5000) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/30] time 0.341 (0.346) data 0.263 (0.268) loss_u loss_u 0.9409 (0.9370) acc_u 6.2500 (7.5000) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/30] time 0.313 (0.344) data 0.234 (0.266) loss_u loss_u 0.9043 (0.9329) acc_u 12.5000 (8.1250) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 413
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 665
clean true:646
clean false:19
clean_rate:0.9714285714285714
noisy true:573
noisy false:394
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 967
epoch [48/200] batch [5/20] time 0.336 (0.321) data 0.258 (0.243) loss_x loss_x 0.3101 (0.4578) acc_x 93.7500 (90.6250) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/20] time 0.340 (0.334) data 0.263 (0.256) loss_x loss_x 0.4695 (0.4396) acc_x 87.5000 (91.5625) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/20] time 0.348 (0.338) data 0.270 (0.260) loss_x loss_x 0.1971 (0.4449) acc_x 100.0000 (91.0417) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/20] time 0.344 (0.339) data 0.267 (0.261) loss_x loss_x 0.5088 (0.4553) acc_x 87.5000 (90.4688) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/30] time 0.349 (0.340) data 0.270 (0.263) loss_u loss_u 0.9277 (0.9551) acc_u 6.2500 (4.3750) lr 1.7501e-03 eta 0:00:08
epoch [48/200] batch [10/30] time 0.346 (0.342) data 0.268 (0.264) loss_u loss_u 0.8408 (0.9434) acc_u 21.8750 (6.2500) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [15/30] time 0.364 (0.344) data 0.286 (0.266) loss_u loss_u 0.9526 (0.9424) acc_u 9.3750 (6.4583) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [20/30] time 0.347 (0.344) data 0.270 (0.267) loss_u loss_u 0.9336 (0.9429) acc_u 6.2500 (6.0938) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [25/30] time 0.353 (0.345) data 0.275 (0.267) loss_u loss_u 0.9419 (0.9444) acc_u 6.2500 (6.0000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [30/30] time 0.347 (0.345) data 0.270 (0.267) loss_u loss_u 0.9849 (0.9392) acc_u 3.1250 (6.5625) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 418
confident_label rate tensor(0.4026, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 657
clean true:636
clean false:21
clean_rate:0.9680365296803652
noisy true:578
noisy false:397
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 975
epoch [49/200] batch [5/20] time 0.367 (0.347) data 0.290 (0.269) loss_x loss_x 0.6914 (0.6509) acc_x 81.2500 (84.3750) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/20] time 0.340 (0.343) data 0.263 (0.265) loss_x loss_x 0.2856 (0.5163) acc_x 90.6250 (87.1875) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/20] time 0.335 (0.340) data 0.257 (0.262) loss_x loss_x 0.3567 (0.4902) acc_x 90.6250 (87.0833) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/20] time 0.336 (0.341) data 0.258 (0.264) loss_x loss_x 0.3965 (0.4956) acc_x 90.6250 (87.8125) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/30] time 0.325 (0.339) data 0.248 (0.262) loss_u loss_u 0.9570 (0.9254) acc_u 3.1250 (8.7500) lr 1.7396e-03 eta 0:00:08
epoch [49/200] batch [10/30] time 0.339 (0.340) data 0.261 (0.263) loss_u loss_u 0.9199 (0.9237) acc_u 9.3750 (8.7500) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [15/30] time 0.347 (0.340) data 0.269 (0.263) loss_u loss_u 0.9453 (0.9272) acc_u 6.2500 (8.3333) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [20/30] time 0.343 (0.340) data 0.265 (0.263) loss_u loss_u 0.8662 (0.9232) acc_u 18.7500 (8.7500) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [25/30] time 0.333 (0.340) data 0.255 (0.262) loss_u loss_u 0.9453 (0.9273) acc_u 6.2500 (8.2500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/30] time 0.298 (0.337) data 0.220 (0.260) loss_u loss_u 0.9678 (0.9309) acc_u 3.1250 (7.9167) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 407
confident_label rate tensor(0.4093, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 668
clean true:650
clean false:18
clean_rate:0.9730538922155688
noisy true:575
noisy false:389
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 964
epoch [50/200] batch [5/20] time 0.292 (0.313) data 0.214 (0.235) loss_x loss_x 0.4265 (0.4193) acc_x 87.5000 (90.0000) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/20] time 0.345 (0.315) data 0.267 (0.237) loss_x loss_x 0.4851 (0.4480) acc_x 90.6250 (89.3750) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/20] time 0.352 (0.328) data 0.274 (0.250) loss_x loss_x 0.4548 (0.4031) acc_x 87.5000 (90.8333) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/20] time 0.331 (0.332) data 0.254 (0.254) loss_x loss_x 0.7896 (0.4453) acc_x 78.1250 (89.2188) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/30] time 0.376 (0.335) data 0.297 (0.257) loss_u loss_u 0.9565 (0.9556) acc_u 6.2500 (5.6250) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [10/30] time 0.350 (0.339) data 0.271 (0.261) loss_u loss_u 0.9209 (0.9415) acc_u 9.3750 (7.1875) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [15/30] time 0.350 (0.339) data 0.272 (0.261) loss_u loss_u 0.9663 (0.9385) acc_u 3.1250 (7.5000) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [20/30] time 0.366 (0.340) data 0.288 (0.262) loss_u loss_u 0.9282 (0.9380) acc_u 9.3750 (7.5000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [25/30] time 0.343 (0.341) data 0.265 (0.263) loss_u loss_u 0.8418 (0.9302) acc_u 18.7500 (8.3750) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/30] time 0.332 (0.341) data 0.254 (0.263) loss_u loss_u 0.9971 (0.9370) acc_u 0.0000 (7.3958) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 401
confident_label rate tensor(0.4118, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 672
clean true:652
clean false:20
clean_rate:0.9702380952380952
noisy true:579
noisy false:381
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 960
epoch [51/200] batch [5/21] time 0.328 (0.343) data 0.251 (0.266) loss_x loss_x 0.4070 (0.4829) acc_x 87.5000 (88.7500) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/21] time 0.345 (0.334) data 0.267 (0.256) loss_x loss_x 0.4114 (0.3857) acc_x 93.7500 (90.9375) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/21] time 0.342 (0.339) data 0.265 (0.261) loss_x loss_x 0.6924 (0.4134) acc_x 81.2500 (89.1667) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [20/21] time 0.363 (0.340) data 0.286 (0.263) loss_x loss_x 0.3740 (0.4202) acc_x 90.6250 (89.6875) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/30] time 0.351 (0.342) data 0.273 (0.265) loss_u loss_u 0.9023 (0.9377) acc_u 12.5000 (7.5000) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [10/30] time 0.360 (0.344) data 0.282 (0.266) loss_u loss_u 0.8984 (0.9395) acc_u 12.5000 (6.8750) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [15/30] time 0.329 (0.343) data 0.252 (0.265) loss_u loss_u 0.9180 (0.9383) acc_u 9.3750 (7.0833) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [20/30] time 0.349 (0.343) data 0.271 (0.265) loss_u loss_u 0.9536 (0.9404) acc_u 6.2500 (7.0312) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [25/30] time 0.359 (0.344) data 0.281 (0.266) loss_u loss_u 0.9102 (0.9402) acc_u 9.3750 (6.8750) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [30/30] time 0.342 (0.344) data 0.263 (0.266) loss_u loss_u 0.9771 (0.9398) acc_u 3.1250 (6.8750) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 416
confident_label rate tensor(0.4020, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 656
clean true:636
clean false:20
clean_rate:0.9695121951219512
noisy true:580
noisy false:396
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 976
epoch [52/200] batch [5/20] time 0.332 (0.330) data 0.254 (0.252) loss_x loss_x 0.5205 (0.6513) acc_x 90.6250 (84.3750) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/20] time 0.307 (0.314) data 0.229 (0.237) loss_x loss_x 0.9902 (0.5812) acc_x 81.2500 (87.1875) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/20] time 0.335 (0.323) data 0.258 (0.246) loss_x loss_x 0.4097 (0.5132) acc_x 93.7500 (88.7500) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/20] time 0.339 (0.327) data 0.262 (0.250) loss_x loss_x 0.4402 (0.5099) acc_x 87.5000 (88.2812) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/30] time 0.330 (0.331) data 0.253 (0.253) loss_u loss_u 0.9414 (0.9240) acc_u 6.2500 (7.5000) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [10/30] time 0.348 (0.332) data 0.269 (0.255) loss_u loss_u 0.9048 (0.9241) acc_u 9.3750 (7.5000) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [15/30] time 0.343 (0.334) data 0.266 (0.257) loss_u loss_u 0.9468 (0.9285) acc_u 9.3750 (7.9167) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [20/30] time 0.346 (0.336) data 0.267 (0.258) loss_u loss_u 0.9316 (0.9301) acc_u 9.3750 (8.1250) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [25/30] time 0.351 (0.336) data 0.274 (0.259) loss_u loss_u 0.9258 (0.9305) acc_u 9.3750 (8.1250) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/30] time 0.339 (0.338) data 0.261 (0.260) loss_u loss_u 0.9688 (0.9295) acc_u 3.1250 (8.1250) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 392
confident_label rate tensor(0.4130, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 674
clean true:652
clean false:22
clean_rate:0.9673590504451038
noisy true:588
noisy false:370
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 958
epoch [53/200] batch [5/21] time 0.368 (0.354) data 0.291 (0.276) loss_x loss_x 0.2235 (0.6096) acc_x 100.0000 (86.8750) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/21] time 0.331 (0.330) data 0.252 (0.252) loss_x loss_x 0.5210 (0.6505) acc_x 84.3750 (86.5625) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/21] time 0.345 (0.333) data 0.268 (0.255) loss_x loss_x 0.3623 (0.5742) acc_x 93.7500 (87.2917) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/21] time 0.347 (0.334) data 0.269 (0.257) loss_x loss_x 0.4438 (0.5396) acc_x 93.7500 (87.9688) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/29] time 0.342 (0.337) data 0.264 (0.260) loss_u loss_u 0.9009 (0.9214) acc_u 12.5000 (10.0000) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [10/29] time 0.346 (0.339) data 0.269 (0.262) loss_u loss_u 0.8857 (0.9226) acc_u 15.6250 (10.0000) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [15/29] time 0.346 (0.340) data 0.268 (0.262) loss_u loss_u 0.8745 (0.9290) acc_u 15.6250 (9.1667) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [20/29] time 0.354 (0.341) data 0.275 (0.263) loss_u loss_u 0.8779 (0.9290) acc_u 15.6250 (9.0625) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [25/29] time 0.354 (0.341) data 0.275 (0.264) loss_u loss_u 0.9370 (0.9339) acc_u 6.2500 (8.2500) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 379
confident_label rate tensor(0.4191, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 684
clean true:664
clean false:20
clean_rate:0.9707602339181286
noisy true:589
noisy false:359
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 948
epoch [54/200] batch [5/21] time 0.310 (0.325) data 0.232 (0.248) loss_x loss_x 0.3591 (0.4353) acc_x 93.7500 (90.6250) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [10/21] time 0.347 (0.323) data 0.270 (0.245) loss_x loss_x 0.6514 (0.4820) acc_x 84.3750 (89.0625) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/21] time 0.354 (0.331) data 0.276 (0.253) loss_x loss_x 0.4539 (0.5001) acc_x 93.7500 (88.7500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/21] time 0.327 (0.332) data 0.250 (0.254) loss_x loss_x 0.5425 (0.5072) acc_x 84.3750 (87.6562) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/29] time 0.329 (0.333) data 0.251 (0.256) loss_u loss_u 0.9648 (0.9592) acc_u 3.1250 (5.0000) lr 1.6845e-03 eta 0:00:08
epoch [54/200] batch [10/29] time 0.379 (0.337) data 0.301 (0.259) loss_u loss_u 0.9033 (0.9412) acc_u 12.5000 (6.8750) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [15/29] time 0.349 (0.337) data 0.272 (0.259) loss_u loss_u 0.9424 (0.9401) acc_u 6.2500 (6.8750) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [20/29] time 0.344 (0.338) data 0.266 (0.260) loss_u loss_u 0.9502 (0.9426) acc_u 9.3750 (6.8750) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [25/29] time 0.344 (0.339) data 0.266 (0.261) loss_u loss_u 0.9814 (0.9479) acc_u 0.0000 (6.2500) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 404
confident_label rate tensor(0.4136, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 675
clean true:656
clean false:19
clean_rate:0.9718518518518519
noisy true:572
noisy false:385
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 957
epoch [55/200] batch [5/21] time 0.327 (0.349) data 0.249 (0.271) loss_x loss_x 0.4905 (0.4586) acc_x 87.5000 (90.0000) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/21] time 0.338 (0.342) data 0.261 (0.264) loss_x loss_x 0.5371 (0.4529) acc_x 87.5000 (89.6875) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/21] time 0.337 (0.341) data 0.260 (0.264) loss_x loss_x 0.6089 (0.4607) acc_x 87.5000 (89.5833) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/21] time 0.356 (0.341) data 0.278 (0.264) loss_x loss_x 0.4136 (0.4634) acc_x 90.6250 (89.0625) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/29] time 0.359 (0.342) data 0.281 (0.264) loss_u loss_u 0.9487 (0.9468) acc_u 6.2500 (6.8750) lr 1.6730e-03 eta 0:00:08
epoch [55/200] batch [10/29] time 0.338 (0.342) data 0.259 (0.264) loss_u loss_u 0.8838 (0.9375) acc_u 15.6250 (7.8125) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [15/29] time 0.343 (0.341) data 0.265 (0.264) loss_u loss_u 0.9609 (0.9419) acc_u 3.1250 (7.0833) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [20/29] time 0.337 (0.342) data 0.260 (0.264) loss_u loss_u 0.9302 (0.9375) acc_u 6.2500 (7.5000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [25/29] time 0.326 (0.341) data 0.247 (0.263) loss_u loss_u 0.9121 (0.9380) acc_u 9.3750 (7.5000) lr 1.6730e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 407
confident_label rate tensor(0.4105, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 670
clean true:651
clean false:19
clean_rate:0.9716417910447761
noisy true:574
noisy false:388
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 962
epoch [56/200] batch [5/20] time 0.333 (0.344) data 0.255 (0.266) loss_x loss_x 0.1887 (0.4595) acc_x 100.0000 (90.0000) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [10/20] time 0.345 (0.327) data 0.268 (0.249) loss_x loss_x 0.3928 (0.4596) acc_x 90.6250 (89.6875) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [15/20] time 0.342 (0.331) data 0.265 (0.254) loss_x loss_x 0.4751 (0.4439) acc_x 84.3750 (90.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/20] time 0.330 (0.334) data 0.252 (0.256) loss_x loss_x 0.3174 (0.4477) acc_x 93.7500 (89.8438) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/30] time 0.348 (0.337) data 0.269 (0.259) loss_u loss_u 0.9678 (0.9546) acc_u 3.1250 (5.0000) lr 1.6613e-03 eta 0:00:08
epoch [56/200] batch [10/30] time 0.353 (0.338) data 0.275 (0.261) loss_u loss_u 0.9526 (0.9400) acc_u 6.2500 (6.8750) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [15/30] time 0.344 (0.339) data 0.266 (0.261) loss_u loss_u 0.9741 (0.9325) acc_u 3.1250 (7.5000) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [20/30] time 0.344 (0.339) data 0.267 (0.261) loss_u loss_u 0.9385 (0.9299) acc_u 6.2500 (7.6562) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [25/30] time 0.346 (0.339) data 0.267 (0.261) loss_u loss_u 0.9248 (0.9305) acc_u 9.3750 (8.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [30/30] time 0.342 (0.340) data 0.265 (0.262) loss_u loss_u 0.9883 (0.9366) acc_u 0.0000 (7.2917) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 373
confident_label rate tensor(0.4210, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 687
clean true:670
clean false:17
clean_rate:0.975254730713246
noisy true:589
noisy false:356
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 945
epoch [57/200] batch [5/21] time 0.343 (0.344) data 0.266 (0.266) loss_x loss_x 0.6992 (0.4402) acc_x 87.5000 (91.2500) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [10/21] time 0.348 (0.346) data 0.271 (0.268) loss_x loss_x 0.6621 (0.4376) acc_x 81.2500 (90.3125) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/21] time 0.328 (0.342) data 0.251 (0.264) loss_x loss_x 0.3184 (0.4344) acc_x 87.5000 (90.6250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [20/21] time 0.348 (0.342) data 0.270 (0.264) loss_x loss_x 0.2725 (0.4270) acc_x 93.7500 (90.3125) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/29] time 0.322 (0.342) data 0.244 (0.264) loss_u loss_u 0.9731 (0.9420) acc_u 3.1250 (7.5000) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [10/29] time 0.350 (0.343) data 0.271 (0.265) loss_u loss_u 0.9805 (0.9398) acc_u 3.1250 (7.8125) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [15/29] time 0.331 (0.343) data 0.253 (0.265) loss_u loss_u 0.9272 (0.9414) acc_u 9.3750 (7.5000) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [20/29] time 0.347 (0.342) data 0.269 (0.264) loss_u loss_u 0.9478 (0.9448) acc_u 6.2500 (6.8750) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [25/29] time 0.344 (0.342) data 0.266 (0.264) loss_u loss_u 0.9312 (0.9421) acc_u 9.3750 (7.1250) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 396
confident_label rate tensor(0.4087, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 667
clean true:646
clean false:21
clean_rate:0.9685157421289355
noisy true:590
noisy false:375
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 965
epoch [58/200] batch [5/20] time 0.338 (0.336) data 0.261 (0.259) loss_x loss_x 0.3381 (0.5727) acc_x 93.7500 (87.5000) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/20] time 0.366 (0.340) data 0.288 (0.262) loss_x loss_x 0.3284 (0.4772) acc_x 93.7500 (88.7500) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/20] time 0.304 (0.337) data 0.226 (0.259) loss_x loss_x 0.1268 (0.4262) acc_x 100.0000 (90.8333) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/20] time 0.336 (0.337) data 0.258 (0.259) loss_x loss_x 0.6191 (0.4327) acc_x 90.6250 (90.3125) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/30] time 0.343 (0.338) data 0.266 (0.260) loss_u loss_u 0.9922 (0.9546) acc_u 0.0000 (4.3750) lr 1.6374e-03 eta 0:00:08
epoch [58/200] batch [10/30] time 0.318 (0.337) data 0.241 (0.260) loss_u loss_u 0.9648 (0.9353) acc_u 6.2500 (6.8750) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [15/30] time 0.345 (0.338) data 0.267 (0.260) loss_u loss_u 0.9180 (0.9310) acc_u 9.3750 (7.5000) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [20/30] time 0.343 (0.339) data 0.265 (0.261) loss_u loss_u 0.9795 (0.9374) acc_u 3.1250 (7.0312) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [25/30] time 0.349 (0.340) data 0.272 (0.262) loss_u loss_u 0.9526 (0.9367) acc_u 6.2500 (7.1250) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/30] time 0.309 (0.339) data 0.231 (0.261) loss_u loss_u 0.9556 (0.9362) acc_u 6.2500 (7.3958) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 390
confident_label rate tensor(0.4148, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 677
clean true:659
clean false:18
clean_rate:0.9734121122599705
noisy true:583
noisy false:372
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 955
epoch [59/200] batch [5/21] time 0.343 (0.352) data 0.265 (0.274) loss_x loss_x 0.6445 (0.4527) acc_x 81.2500 (88.7500) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/21] time 0.348 (0.350) data 0.270 (0.272) loss_x loss_x 0.3889 (0.4375) acc_x 96.8750 (89.3750) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/21] time 0.337 (0.347) data 0.259 (0.270) loss_x loss_x 0.2959 (0.4475) acc_x 96.8750 (89.3750) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/21] time 0.294 (0.335) data 0.217 (0.258) loss_x loss_x 0.4673 (0.4426) acc_x 84.3750 (89.6875) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/29] time 0.350 (0.337) data 0.272 (0.259) loss_u loss_u 0.9429 (0.9436) acc_u 9.3750 (7.5000) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [10/29] time 0.347 (0.337) data 0.269 (0.260) loss_u loss_u 0.8965 (0.9152) acc_u 15.6250 (10.3125) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [15/29] time 0.327 (0.337) data 0.249 (0.260) loss_u loss_u 0.8999 (0.9189) acc_u 9.3750 (9.7917) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [20/29] time 0.348 (0.337) data 0.271 (0.260) loss_u loss_u 0.9663 (0.9290) acc_u 3.1250 (8.4375) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [25/29] time 0.300 (0.337) data 0.223 (0.259) loss_u loss_u 0.9683 (0.9276) acc_u 3.1250 (8.6250) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 397
confident_label rate tensor(0.4136, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 675
clean true:655
clean false:20
clean_rate:0.9703703703703703
noisy true:580
noisy false:377
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 957
epoch [60/200] batch [5/21] time 0.345 (0.351) data 0.268 (0.274) loss_x loss_x 0.6406 (0.5052) acc_x 87.5000 (87.5000) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/21] time 0.333 (0.343) data 0.256 (0.265) loss_x loss_x 0.4905 (0.5087) acc_x 84.3750 (89.0625) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/21] time 0.329 (0.339) data 0.252 (0.261) loss_x loss_x 0.4399 (0.4701) acc_x 90.6250 (89.5833) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/21] time 0.336 (0.340) data 0.259 (0.263) loss_x loss_x 0.6030 (0.4646) acc_x 81.2500 (89.8438) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/29] time 0.366 (0.342) data 0.288 (0.264) loss_u loss_u 0.9565 (0.9301) acc_u 6.2500 (8.1250) lr 1.6129e-03 eta 0:00:08
epoch [60/200] batch [10/29] time 0.353 (0.343) data 0.275 (0.265) loss_u loss_u 0.9629 (0.9320) acc_u 3.1250 (7.5000) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [15/29] time 0.360 (0.343) data 0.282 (0.266) loss_u loss_u 0.8838 (0.9254) acc_u 15.6250 (8.7500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [20/29] time 0.299 (0.343) data 0.220 (0.265) loss_u loss_u 0.9639 (0.9292) acc_u 3.1250 (8.4375) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [25/29] time 0.315 (0.339) data 0.237 (0.261) loss_u loss_u 0.8838 (0.9318) acc_u 15.6250 (8.1250) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 398
confident_label rate tensor(0.4093, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 668
clean true:647
clean false:21
clean_rate:0.968562874251497
noisy true:587
noisy false:377
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 964
epoch [61/200] batch [5/20] time 0.341 (0.355) data 0.264 (0.278) loss_x loss_x 0.3994 (0.4015) acc_x 96.8750 (92.5000) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [10/20] time 0.348 (0.350) data 0.271 (0.273) loss_x loss_x 0.2108 (0.4448) acc_x 96.8750 (90.3125) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/20] time 0.337 (0.349) data 0.260 (0.272) loss_x loss_x 0.5054 (0.4083) acc_x 87.5000 (91.0417) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/20] time 0.346 (0.348) data 0.268 (0.271) loss_x loss_x 0.2494 (0.3773) acc_x 96.8750 (91.7188) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/30] time 0.338 (0.348) data 0.259 (0.270) loss_u loss_u 0.9321 (0.9407) acc_u 9.3750 (6.8750) lr 1.6004e-03 eta 0:00:08
epoch [61/200] batch [10/30] time 0.338 (0.348) data 0.260 (0.270) loss_u loss_u 0.8892 (0.9323) acc_u 15.6250 (7.8125) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [15/30] time 0.344 (0.349) data 0.265 (0.271) loss_u loss_u 0.9424 (0.9381) acc_u 3.1250 (7.0833) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [20/30] time 0.321 (0.348) data 0.243 (0.270) loss_u loss_u 0.8774 (0.9296) acc_u 12.5000 (8.2812) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [25/30] time 0.370 (0.346) data 0.291 (0.268) loss_u loss_u 0.9595 (0.9288) acc_u 6.2500 (8.5000) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/30] time 0.352 (0.346) data 0.274 (0.268) loss_u loss_u 0.9492 (0.9304) acc_u 6.2500 (8.4375) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 387
confident_label rate tensor(0.4210, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 687
clean true:663
clean false:24
clean_rate:0.9650655021834061
noisy true:582
noisy false:363
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 945
epoch [62/200] batch [5/21] time 0.341 (0.352) data 0.263 (0.274) loss_x loss_x 0.5869 (0.4162) acc_x 90.6250 (91.2500) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/21] time 0.346 (0.348) data 0.268 (0.270) loss_x loss_x 0.5444 (0.4371) acc_x 84.3750 (89.6875) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/21] time 0.339 (0.348) data 0.262 (0.270) loss_x loss_x 0.7529 (0.4573) acc_x 81.2500 (89.1667) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/21] time 0.316 (0.344) data 0.239 (0.266) loss_x loss_x 0.5151 (0.4498) acc_x 84.3750 (89.0625) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/29] time 0.354 (0.347) data 0.277 (0.269) loss_u loss_u 0.9570 (0.9355) acc_u 3.1250 (7.5000) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [10/29] time 0.350 (0.347) data 0.271 (0.269) loss_u loss_u 0.9590 (0.9498) acc_u 3.1250 (5.6250) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [15/29] time 0.347 (0.349) data 0.270 (0.271) loss_u loss_u 0.9570 (0.9416) acc_u 3.1250 (6.6667) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [20/29] time 0.328 (0.346) data 0.249 (0.268) loss_u loss_u 0.8906 (0.9395) acc_u 12.5000 (6.8750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [25/29] time 0.350 (0.346) data 0.273 (0.267) loss_u loss_u 0.9038 (0.9363) acc_u 9.3750 (7.2500) lr 1.5878e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 368
confident_label rate tensor(0.4234, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 691
clean true:675
clean false:16
clean_rate:0.9768451519536903
noisy true:589
noisy false:352
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 941
epoch [63/200] batch [5/21] time 0.350 (0.363) data 0.272 (0.285) loss_x loss_x 0.2268 (0.4090) acc_x 96.8750 (90.0000) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/21] time 0.336 (0.352) data 0.259 (0.274) loss_x loss_x 0.4060 (0.3961) acc_x 87.5000 (90.9375) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/21] time 0.344 (0.352) data 0.267 (0.275) loss_x loss_x 0.5122 (0.4005) acc_x 90.6250 (91.0417) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/21] time 0.340 (0.349) data 0.263 (0.272) loss_x loss_x 0.3748 (0.4118) acc_x 90.6250 (90.4688) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/29] time 0.353 (0.348) data 0.274 (0.270) loss_u loss_u 0.8613 (0.9168) acc_u 15.6250 (9.3750) lr 1.5750e-03 eta 0:00:08
epoch [63/200] batch [10/29] time 0.364 (0.349) data 0.286 (0.271) loss_u loss_u 0.9946 (0.9369) acc_u 0.0000 (6.8750) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [15/29] time 0.303 (0.346) data 0.224 (0.268) loss_u loss_u 0.9541 (0.9427) acc_u 3.1250 (6.0417) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [20/29] time 0.297 (0.341) data 0.219 (0.263) loss_u loss_u 0.9604 (0.9417) acc_u 3.1250 (6.5625) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [25/29] time 0.360 (0.343) data 0.281 (0.265) loss_u loss_u 0.9702 (0.9424) acc_u 3.1250 (6.6250) lr 1.5750e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 357
confident_label rate tensor(0.4240, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 692
clean true:671
clean false:21
clean_rate:0.9696531791907514
noisy true:604
noisy false:336
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 940
epoch [64/200] batch [5/21] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.2108 (0.4262) acc_x 100.0000 (92.5000) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/21] time 0.345 (0.342) data 0.267 (0.264) loss_x loss_x 0.2793 (0.4248) acc_x 93.7500 (91.5625) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/21] time 0.337 (0.341) data 0.260 (0.264) loss_x loss_x 0.4355 (0.4795) acc_x 90.6250 (90.4167) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/21] time 0.301 (0.339) data 0.224 (0.262) loss_x loss_x 0.9512 (0.5051) acc_x 90.6250 (89.8438) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/29] time 0.344 (0.339) data 0.265 (0.262) loss_u loss_u 0.9282 (0.9446) acc_u 9.3750 (6.8750) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [10/29] time 0.347 (0.341) data 0.269 (0.264) loss_u loss_u 0.9634 (0.9422) acc_u 3.1250 (6.5625) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [15/29] time 0.298 (0.341) data 0.220 (0.264) loss_u loss_u 0.8921 (0.9355) acc_u 12.5000 (7.9167) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [20/29] time 0.331 (0.337) data 0.252 (0.259) loss_u loss_u 0.9761 (0.9328) acc_u 3.1250 (8.1250) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [25/29] time 0.344 (0.337) data 0.267 (0.259) loss_u loss_u 0.9087 (0.9304) acc_u 9.3750 (8.5000) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 363
confident_label rate tensor(0.4222, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 689
clean true:670
clean false:19
clean_rate:0.9724238026124818
noisy true:599
noisy false:344
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 943
epoch [65/200] batch [5/21] time 0.324 (0.344) data 0.247 (0.267) loss_x loss_x 0.6030 (0.4388) acc_x 84.3750 (88.1250) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/21] time 0.338 (0.343) data 0.260 (0.266) loss_x loss_x 0.5322 (0.4072) acc_x 93.7500 (90.3125) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/21] time 0.344 (0.343) data 0.267 (0.266) loss_x loss_x 0.4644 (0.4429) acc_x 90.6250 (89.5833) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/21] time 0.349 (0.342) data 0.272 (0.265) loss_x loss_x 0.4883 (0.4483) acc_x 84.3750 (89.5312) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/29] time 0.343 (0.343) data 0.265 (0.265) loss_u loss_u 0.9609 (0.9472) acc_u 6.2500 (5.6250) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [10/29] time 0.296 (0.339) data 0.218 (0.261) loss_u loss_u 0.9868 (0.9417) acc_u 0.0000 (6.5625) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [15/29] time 0.330 (0.337) data 0.251 (0.259) loss_u loss_u 0.9092 (0.9390) acc_u 12.5000 (7.2917) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [20/29] time 0.305 (0.333) data 0.227 (0.255) loss_u loss_u 0.9102 (0.9308) acc_u 12.5000 (8.4375) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/29] time 0.363 (0.334) data 0.285 (0.256) loss_u loss_u 0.9487 (0.9320) acc_u 6.2500 (8.2500) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.4185, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 683
clean true:667
clean false:16
clean_rate:0.9765739385065886
noisy true:598
noisy false:351
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 949
epoch [66/200] batch [5/21] time 0.333 (0.335) data 0.256 (0.257) loss_x loss_x 0.3816 (0.3398) acc_x 93.7500 (91.2500) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/21] time 0.341 (0.341) data 0.264 (0.263) loss_x loss_x 0.5591 (0.4710) acc_x 87.5000 (89.6875) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/21] time 0.336 (0.341) data 0.259 (0.264) loss_x loss_x 0.4580 (0.4096) acc_x 90.6250 (91.2500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/21] time 0.336 (0.341) data 0.259 (0.264) loss_x loss_x 0.5342 (0.4222) acc_x 81.2500 (90.4688) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/29] time 0.350 (0.342) data 0.272 (0.264) loss_u loss_u 0.9482 (0.9227) acc_u 3.1250 (8.1250) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [10/29] time 0.347 (0.343) data 0.269 (0.265) loss_u loss_u 0.9272 (0.9310) acc_u 9.3750 (7.5000) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [15/29] time 0.345 (0.343) data 0.266 (0.265) loss_u loss_u 0.9395 (0.9279) acc_u 6.2500 (7.7083) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [20/29] time 0.363 (0.342) data 0.285 (0.264) loss_u loss_u 0.9902 (0.9297) acc_u 0.0000 (7.5000) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [25/29] time 0.320 (0.339) data 0.241 (0.261) loss_u loss_u 0.9258 (0.9240) acc_u 9.3750 (8.6250) lr 1.5358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 329
confident_label rate tensor(0.4271, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 697
clean true:682
clean false:15
clean_rate:0.9784791965566715
noisy true:621
noisy false:314
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 935
epoch [67/200] batch [5/21] time 0.355 (0.360) data 0.278 (0.283) loss_x loss_x 0.2179 (0.3474) acc_x 96.8750 (93.1250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/21] time 0.350 (0.353) data 0.272 (0.276) loss_x loss_x 0.5078 (0.3830) acc_x 87.5000 (91.5625) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/21] time 0.332 (0.348) data 0.255 (0.270) loss_x loss_x 0.4854 (0.4110) acc_x 87.5000 (90.2083) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/21] time 0.350 (0.347) data 0.272 (0.269) loss_x loss_x 0.3499 (0.4109) acc_x 93.7500 (90.6250) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/29] time 0.363 (0.346) data 0.285 (0.269) loss_u loss_u 0.8916 (0.9657) acc_u 15.6250 (4.3750) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [10/29] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.8813 (0.9297) acc_u 15.6250 (8.4375) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [15/29] time 0.360 (0.345) data 0.283 (0.267) loss_u loss_u 0.9482 (0.9355) acc_u 6.2500 (7.5000) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [20/29] time 0.342 (0.346) data 0.265 (0.268) loss_u loss_u 0.9702 (0.9432) acc_u 6.2500 (6.7188) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [25/29] time 0.343 (0.342) data 0.265 (0.265) loss_u loss_u 0.9976 (0.9497) acc_u 0.0000 (6.0000) lr 1.5225e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.4289, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 700
clean true:682
clean false:18
clean_rate:0.9742857142857143
noisy true:604
noisy false:328
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 932
epoch [68/200] batch [5/21] time 0.354 (0.353) data 0.276 (0.275) loss_x loss_x 0.1863 (0.4104) acc_x 96.8750 (90.6250) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/21] time 0.345 (0.349) data 0.267 (0.270) loss_x loss_x 0.6689 (0.4675) acc_x 87.5000 (89.3750) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/21] time 0.313 (0.346) data 0.235 (0.267) loss_x loss_x 0.3184 (0.4575) acc_x 93.7500 (89.5833) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/21] time 0.309 (0.337) data 0.231 (0.258) loss_x loss_x 0.4885 (0.4598) acc_x 87.5000 (89.5312) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/29] time 0.346 (0.339) data 0.268 (0.261) loss_u loss_u 0.9990 (0.9264) acc_u 0.0000 (9.3750) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [10/29] time 0.341 (0.339) data 0.264 (0.261) loss_u loss_u 0.9673 (0.9344) acc_u 3.1250 (8.1250) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [15/29] time 0.342 (0.340) data 0.265 (0.262) loss_u loss_u 0.9673 (0.9404) acc_u 6.2500 (7.5000) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [20/29] time 0.342 (0.341) data 0.264 (0.263) loss_u loss_u 0.9497 (0.9457) acc_u 6.2500 (6.8750) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [25/29] time 0.310 (0.340) data 0.232 (0.262) loss_u loss_u 0.9321 (0.9413) acc_u 6.2500 (7.1250) lr 1.5090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.4252, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 694
clean true:678
clean false:16
clean_rate:0.9769452449567724
noisy true:608
noisy false:330
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 938
epoch [69/200] batch [5/21] time 0.341 (0.345) data 0.263 (0.268) loss_x loss_x 0.2416 (0.3951) acc_x 93.7500 (90.6250) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/21] time 0.351 (0.343) data 0.274 (0.265) loss_x loss_x 0.3743 (0.3374) acc_x 87.5000 (92.1875) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/21] time 0.341 (0.342) data 0.263 (0.264) loss_x loss_x 0.4038 (0.3681) acc_x 90.6250 (91.2500) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/21] time 0.354 (0.343) data 0.276 (0.266) loss_x loss_x 0.1940 (0.3563) acc_x 100.0000 (91.5625) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/29] time 0.351 (0.344) data 0.274 (0.266) loss_u loss_u 0.9155 (0.9438) acc_u 12.5000 (8.1250) lr 1.4955e-03 eta 0:00:08
epoch [69/200] batch [10/29] time 0.364 (0.345) data 0.286 (0.268) loss_u loss_u 0.9395 (0.9513) acc_u 6.2500 (6.2500) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [15/29] time 0.334 (0.346) data 0.256 (0.268) loss_u loss_u 0.9219 (0.9542) acc_u 6.2500 (5.8333) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [20/29] time 0.307 (0.344) data 0.229 (0.266) loss_u loss_u 0.9316 (0.9499) acc_u 6.2500 (6.0938) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [25/29] time 0.310 (0.340) data 0.233 (0.262) loss_u loss_u 0.9380 (0.9435) acc_u 6.2500 (6.8750) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 365
confident_label rate tensor(0.4210, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 687
clean true:670
clean false:17
clean_rate:0.975254730713246
noisy true:597
noisy false:348
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 945
epoch [70/200] batch [5/21] time 0.353 (0.347) data 0.275 (0.269) loss_x loss_x 0.1605 (0.3678) acc_x 100.0000 (91.2500) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/21] time 0.343 (0.346) data 0.265 (0.269) loss_x loss_x 0.1812 (0.3435) acc_x 96.8750 (92.5000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/21] time 0.351 (0.347) data 0.274 (0.270) loss_x loss_x 0.7432 (0.3616) acc_x 81.2500 (90.8333) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/21] time 0.339 (0.347) data 0.262 (0.269) loss_x loss_x 0.3472 (0.3808) acc_x 90.6250 (90.7812) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/29] time 0.298 (0.341) data 0.221 (0.263) loss_u loss_u 0.9546 (0.9530) acc_u 6.2500 (5.6250) lr 1.4818e-03 eta 0:00:08
epoch [70/200] batch [10/29] time 0.329 (0.339) data 0.252 (0.261) loss_u loss_u 0.9160 (0.9436) acc_u 12.5000 (6.5625) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [15/29] time 0.338 (0.339) data 0.259 (0.261) loss_u loss_u 0.8906 (0.9408) acc_u 15.6250 (7.2917) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [20/29] time 0.301 (0.338) data 0.222 (0.260) loss_u loss_u 0.9341 (0.9396) acc_u 6.2500 (7.1875) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [25/29] time 0.356 (0.337) data 0.277 (0.259) loss_u loss_u 0.8828 (0.9329) acc_u 12.5000 (8.0000) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 356
confident_label rate tensor(0.4283, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 699
clean true:677
clean false:22
clean_rate:0.9685264663805436
noisy true:599
noisy false:334
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 933
epoch [71/200] batch [5/21] time 0.351 (0.346) data 0.273 (0.268) loss_x loss_x 0.2289 (0.3714) acc_x 96.8750 (91.8750) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/21] time 0.344 (0.343) data 0.267 (0.265) loss_x loss_x 0.4268 (0.4375) acc_x 93.7500 (91.2500) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/21] time 0.350 (0.342) data 0.273 (0.264) loss_x loss_x 0.1935 (0.4134) acc_x 96.8750 (90.8333) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/21] time 0.346 (0.343) data 0.269 (0.266) loss_x loss_x 0.3091 (0.3887) acc_x 93.7500 (91.7188) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/29] time 0.357 (0.343) data 0.278 (0.265) loss_u loss_u 0.9229 (0.9202) acc_u 9.3750 (9.3750) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [10/29] time 0.352 (0.344) data 0.275 (0.267) loss_u loss_u 0.9722 (0.9303) acc_u 3.1250 (8.1250) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [15/29] time 0.353 (0.345) data 0.275 (0.267) loss_u loss_u 0.9365 (0.9330) acc_u 6.2500 (7.9167) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [20/29] time 0.335 (0.341) data 0.258 (0.264) loss_u loss_u 0.9795 (0.9325) acc_u 0.0000 (7.8125) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [25/29] time 0.342 (0.339) data 0.264 (0.262) loss_u loss_u 0.9585 (0.9328) acc_u 6.2500 (7.7500) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 321
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 713
clean true:695
clean false:18
clean_rate:0.9747545582047685
noisy true:616
noisy false:303
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 919
epoch [72/200] batch [5/22] time 0.330 (0.347) data 0.253 (0.269) loss_x loss_x 0.5898 (0.3968) acc_x 84.3750 (91.2500) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/22] time 0.346 (0.346) data 0.269 (0.269) loss_x loss_x 0.4055 (0.3761) acc_x 96.8750 (91.5625) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/22] time 0.343 (0.345) data 0.266 (0.268) loss_x loss_x 0.4329 (0.3593) acc_x 87.5000 (92.0833) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/22] time 0.335 (0.344) data 0.258 (0.267) loss_x loss_x 0.3867 (0.4073) acc_x 84.3750 (90.4688) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/28] time 0.353 (0.340) data 0.275 (0.263) loss_u loss_u 0.9097 (0.9308) acc_u 9.3750 (8.1250) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [10/28] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9292 (0.9429) acc_u 9.3750 (6.2500) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [15/28] time 0.357 (0.341) data 0.279 (0.264) loss_u loss_u 0.9712 (0.9436) acc_u 3.1250 (6.4583) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [20/28] time 0.346 (0.341) data 0.267 (0.264) loss_u loss_u 0.9678 (0.9482) acc_u 3.1250 (5.9375) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [25/28] time 0.337 (0.341) data 0.259 (0.264) loss_u loss_u 0.9424 (0.9513) acc_u 6.2500 (5.5000) lr 1.4540e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 344
confident_label rate tensor(0.4222, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 689
clean true:672
clean false:17
clean_rate:0.9753265602322206
noisy true:616
noisy false:327
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 943
epoch [73/200] batch [5/21] time 0.348 (0.349) data 0.271 (0.271) loss_x loss_x 0.2052 (0.4948) acc_x 96.8750 (87.5000) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/21] time 0.337 (0.342) data 0.260 (0.265) loss_x loss_x 0.2661 (0.3789) acc_x 96.8750 (91.8750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/21] time 0.337 (0.343) data 0.260 (0.266) loss_x loss_x 0.4109 (0.3625) acc_x 93.7500 (93.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/21] time 0.337 (0.343) data 0.260 (0.266) loss_x loss_x 0.3274 (0.3486) acc_x 96.8750 (92.9688) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/29] time 0.316 (0.340) data 0.237 (0.262) loss_u loss_u 0.9399 (0.8986) acc_u 6.2500 (11.8750) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [10/29] time 0.305 (0.336) data 0.227 (0.259) loss_u loss_u 0.9360 (0.9149) acc_u 6.2500 (9.3750) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [15/29] time 0.341 (0.337) data 0.263 (0.260) loss_u loss_u 0.8960 (0.9209) acc_u 15.6250 (9.1667) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [20/29] time 0.339 (0.338) data 0.260 (0.260) loss_u loss_u 0.9897 (0.9290) acc_u 0.0000 (8.1250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [25/29] time 0.345 (0.338) data 0.267 (0.260) loss_u loss_u 0.9214 (0.9319) acc_u 9.3750 (7.8750) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 326
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 708
clean true:693
clean false:15
clean_rate:0.9788135593220338
noisy true:613
noisy false:311
after delete: len(clean_dataset) 708
after delete: len(noisy_dataset) 924
epoch [74/200] batch [5/22] time 0.339 (0.348) data 0.262 (0.270) loss_x loss_x 0.4380 (0.3013) acc_x 90.6250 (91.8750) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/22] time 0.345 (0.347) data 0.268 (0.269) loss_x loss_x 0.6255 (0.3660) acc_x 90.6250 (91.2500) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/22] time 0.311 (0.332) data 0.234 (0.254) loss_x loss_x 0.2957 (0.3698) acc_x 90.6250 (90.8333) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/22] time 0.320 (0.335) data 0.243 (0.258) loss_x loss_x 0.6987 (0.4030) acc_x 87.5000 (90.1562) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/28] time 0.356 (0.337) data 0.277 (0.259) loss_u loss_u 0.9380 (0.9752) acc_u 9.3750 (3.7500) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [10/28] time 0.349 (0.338) data 0.271 (0.260) loss_u loss_u 0.9126 (0.9613) acc_u 9.3750 (5.0000) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [15/28] time 0.322 (0.335) data 0.243 (0.257) loss_u loss_u 0.9634 (0.9605) acc_u 6.2500 (5.0000) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [20/28] time 0.338 (0.336) data 0.260 (0.258) loss_u loss_u 0.8726 (0.9504) acc_u 15.6250 (5.9375) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/28] time 0.340 (0.337) data 0.261 (0.259) loss_u loss_u 0.9282 (0.9450) acc_u 6.2500 (6.6250) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 329
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 721
clean true:698
clean false:23
clean_rate:0.9680998613037448
noisy true:605
noisy false:306
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 911
epoch [75/200] batch [5/22] time 0.348 (0.355) data 0.270 (0.277) loss_x loss_x 0.2888 (0.3775) acc_x 90.6250 (88.7500) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [10/22] time 0.343 (0.350) data 0.266 (0.273) loss_x loss_x 0.2479 (0.3690) acc_x 93.7500 (89.0625) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/22] time 0.341 (0.347) data 0.264 (0.269) loss_x loss_x 0.3281 (0.3766) acc_x 90.6250 (89.7917) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/22] time 0.333 (0.346) data 0.255 (0.269) loss_x loss_x 1.1182 (0.4222) acc_x 78.1250 (89.0625) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/28] time 0.325 (0.344) data 0.247 (0.267) loss_u loss_u 0.9932 (0.9565) acc_u 0.0000 (5.0000) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [10/28] time 0.334 (0.343) data 0.257 (0.265) loss_u loss_u 0.8501 (0.9449) acc_u 18.7500 (6.5625) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [15/28] time 0.350 (0.342) data 0.272 (0.265) loss_u loss_u 0.9497 (0.9473) acc_u 3.1250 (6.2500) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [20/28] time 0.346 (0.343) data 0.268 (0.265) loss_u loss_u 0.9976 (0.9498) acc_u 0.0000 (5.7812) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/28] time 0.333 (0.343) data 0.254 (0.265) loss_u loss_u 0.9502 (0.9523) acc_u 6.2500 (5.5000) lr 1.4115e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 340
confident_label rate tensor(0.4265, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 696
clean true:676
clean false:20
clean_rate:0.9712643678160919
noisy true:616
noisy false:320
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 936
epoch [76/200] batch [5/21] time 0.338 (0.350) data 0.261 (0.272) loss_x loss_x 0.2732 (0.4284) acc_x 90.6250 (90.6250) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/21] time 0.348 (0.348) data 0.271 (0.271) loss_x loss_x 0.3408 (0.3940) acc_x 87.5000 (90.0000) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/21] time 0.299 (0.342) data 0.222 (0.264) loss_x loss_x 0.4346 (0.3854) acc_x 87.5000 (90.6250) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/21] time 0.357 (0.338) data 0.280 (0.260) loss_x loss_x 0.2827 (0.3813) acc_x 93.7500 (91.0938) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/29] time 0.343 (0.338) data 0.266 (0.261) loss_u loss_u 0.9424 (0.9506) acc_u 6.2500 (5.6250) lr 1.3971e-03 eta 0:00:08
epoch [76/200] batch [10/29] time 0.337 (0.338) data 0.259 (0.261) loss_u loss_u 0.8276 (0.9309) acc_u 21.8750 (7.8125) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [15/29] time 0.368 (0.338) data 0.289 (0.260) loss_u loss_u 0.9492 (0.9354) acc_u 6.2500 (7.2917) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [20/29] time 0.359 (0.339) data 0.281 (0.261) loss_u loss_u 0.9731 (0.9392) acc_u 3.1250 (7.0312) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [25/29] time 0.333 (0.338) data 0.254 (0.260) loss_u loss_u 0.9932 (0.9435) acc_u 0.0000 (6.5000) lr 1.3971e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 344
confident_label rate tensor(0.4314, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 704
clean true:686
clean false:18
clean_rate:0.9744318181818182
noisy true:602
noisy false:326
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 928
epoch [77/200] batch [5/22] time 0.351 (0.367) data 0.273 (0.290) loss_x loss_x 0.1735 (0.4202) acc_x 100.0000 (91.8750) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [10/22] time 0.343 (0.356) data 0.266 (0.279) loss_x loss_x 0.2524 (0.3914) acc_x 90.6250 (91.2500) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/22] time 0.339 (0.352) data 0.262 (0.275) loss_x loss_x 0.3003 (0.3485) acc_x 90.6250 (91.8750) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/22] time 0.335 (0.351) data 0.256 (0.273) loss_x loss_x 0.5352 (0.3899) acc_x 90.6250 (91.2500) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/29] time 0.343 (0.349) data 0.266 (0.272) loss_u loss_u 0.9395 (0.9517) acc_u 6.2500 (5.0000) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [10/29] time 0.341 (0.347) data 0.263 (0.270) loss_u loss_u 0.9141 (0.9423) acc_u 9.3750 (6.2500) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [15/29] time 0.297 (0.341) data 0.218 (0.264) loss_u loss_u 0.9585 (0.9485) acc_u 6.2500 (5.8333) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [20/29] time 0.345 (0.340) data 0.267 (0.263) loss_u loss_u 0.9609 (0.9451) acc_u 6.2500 (6.2500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [25/29] time 0.338 (0.340) data 0.261 (0.263) loss_u loss_u 0.8618 (0.9421) acc_u 15.6250 (6.6250) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.4259, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 695
clean true:676
clean false:19
clean_rate:0.9726618705035971
noisy true:601
noisy false:336
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 937
epoch [78/200] batch [5/21] time 0.334 (0.339) data 0.257 (0.262) loss_x loss_x 0.3679 (0.4799) acc_x 96.8750 (89.3750) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/21] time 0.338 (0.339) data 0.261 (0.262) loss_x loss_x 0.1499 (0.4540) acc_x 100.0000 (90.3125) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/21] time 0.336 (0.341) data 0.259 (0.264) loss_x loss_x 0.4395 (0.4090) acc_x 87.5000 (90.8333) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/21] time 0.322 (0.343) data 0.244 (0.266) loss_x loss_x 0.4380 (0.3915) acc_x 90.6250 (91.5625) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/29] time 0.343 (0.338) data 0.264 (0.261) loss_u loss_u 0.9146 (0.9103) acc_u 12.5000 (11.8750) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [10/29] time 0.338 (0.340) data 0.259 (0.262) loss_u loss_u 0.9126 (0.9307) acc_u 9.3750 (9.0625) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [15/29] time 0.342 (0.341) data 0.265 (0.263) loss_u loss_u 0.9209 (0.9315) acc_u 9.3750 (8.5417) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [20/29] time 0.345 (0.342) data 0.267 (0.264) loss_u loss_u 0.9297 (0.9283) acc_u 6.2500 (8.7500) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [25/29] time 0.294 (0.338) data 0.215 (0.261) loss_u loss_u 0.9961 (0.9364) acc_u 0.0000 (7.5000) lr 1.3681e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 716
clean true:700
clean false:16
clean_rate:0.9776536312849162
noisy true:607
noisy false:309
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 916
epoch [79/200] batch [5/22] time 0.350 (0.351) data 0.273 (0.274) loss_x loss_x 0.1538 (0.3382) acc_x 93.7500 (91.8750) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/22] time 0.343 (0.350) data 0.266 (0.273) loss_x loss_x 0.3687 (0.3481) acc_x 93.7500 (92.1875) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/22] time 0.340 (0.348) data 0.263 (0.270) loss_x loss_x 0.6689 (0.3785) acc_x 81.2500 (91.6667) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/22] time 0.338 (0.347) data 0.261 (0.269) loss_x loss_x 0.3323 (0.3705) acc_x 93.7500 (91.4062) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/28] time 0.344 (0.347) data 0.266 (0.270) loss_u loss_u 0.9604 (0.9291) acc_u 3.1250 (7.5000) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [10/28] time 0.348 (0.348) data 0.271 (0.270) loss_u loss_u 0.9434 (0.9381) acc_u 6.2500 (6.5625) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [15/28] time 0.340 (0.348) data 0.262 (0.270) loss_u loss_u 0.9033 (0.9416) acc_u 9.3750 (6.0417) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [20/28] time 0.347 (0.349) data 0.269 (0.271) loss_u loss_u 0.9956 (0.9462) acc_u 0.0000 (5.6250) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/28] time 0.366 (0.349) data 0.288 (0.271) loss_u loss_u 0.9595 (0.9479) acc_u 3.1250 (5.5000) lr 1.3535e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 341
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 702
clean true:677
clean false:25
clean_rate:0.9643874643874644
noisy true:614
noisy false:316
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 930
epoch [80/200] batch [5/21] time 0.345 (0.349) data 0.268 (0.271) loss_x loss_x 0.3501 (0.3080) acc_x 93.7500 (94.3750) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/21] time 0.361 (0.349) data 0.284 (0.271) loss_x loss_x 0.4434 (0.3443) acc_x 93.7500 (93.7500) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [15/21] time 0.355 (0.348) data 0.277 (0.270) loss_x loss_x 0.6279 (0.3727) acc_x 93.7500 (93.3333) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/21] time 0.338 (0.345) data 0.261 (0.268) loss_x loss_x 0.5786 (0.3881) acc_x 84.3750 (92.3438) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/29] time 0.349 (0.345) data 0.270 (0.267) loss_u loss_u 0.9385 (0.9479) acc_u 6.2500 (5.6250) lr 1.3387e-03 eta 0:00:08
epoch [80/200] batch [10/29] time 0.353 (0.345) data 0.275 (0.268) loss_u loss_u 0.9526 (0.9463) acc_u 6.2500 (5.9375) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [15/29] time 0.311 (0.341) data 0.233 (0.263) loss_u loss_u 0.9263 (0.9392) acc_u 9.3750 (6.8750) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [20/29] time 0.327 (0.340) data 0.248 (0.263) loss_u loss_u 0.9780 (0.9419) acc_u 3.1250 (6.7188) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [25/29] time 0.304 (0.337) data 0.224 (0.259) loss_u loss_u 0.9619 (0.9391) acc_u 3.1250 (6.8750) lr 1.3387e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.4308, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 703
clean true:679
clean false:24
clean_rate:0.9658605974395448
noisy true:628
noisy false:301
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 929
epoch [81/200] batch [5/21] time 0.351 (0.348) data 0.272 (0.269) loss_x loss_x 0.3860 (0.4155) acc_x 93.7500 (91.2500) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/21] time 0.355 (0.346) data 0.278 (0.268) loss_x loss_x 0.2430 (0.3866) acc_x 93.7500 (90.6250) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/21] time 0.352 (0.345) data 0.275 (0.267) loss_x loss_x 0.4971 (0.4183) acc_x 90.6250 (89.7917) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/21] time 0.344 (0.347) data 0.267 (0.270) loss_x loss_x 0.3774 (0.4045) acc_x 90.6250 (90.0000) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/29] time 0.342 (0.346) data 0.265 (0.268) loss_u loss_u 0.9268 (0.9207) acc_u 9.3750 (9.3750) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [10/29] time 0.338 (0.346) data 0.261 (0.268) loss_u loss_u 0.8750 (0.9221) acc_u 15.6250 (8.7500) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [15/29] time 0.344 (0.347) data 0.266 (0.269) loss_u loss_u 0.9414 (0.9346) acc_u 6.2500 (7.5000) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [20/29] time 0.345 (0.346) data 0.268 (0.268) loss_u loss_u 0.9351 (0.9399) acc_u 6.2500 (7.0312) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [25/29] time 0.299 (0.343) data 0.221 (0.265) loss_u loss_u 0.9736 (0.9385) acc_u 3.1250 (7.1250) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 354
confident_label rate tensor(0.4289, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 700
clean true:676
clean false:24
clean_rate:0.9657142857142857
noisy true:602
noisy false:330
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 932
epoch [82/200] batch [5/21] time 0.361 (0.365) data 0.283 (0.288) loss_x loss_x 0.1353 (0.4222) acc_x 100.0000 (91.2500) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/21] time 0.348 (0.357) data 0.271 (0.279) loss_x loss_x 0.3247 (0.4297) acc_x 84.3750 (89.6875) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [15/21] time 0.338 (0.354) data 0.261 (0.276) loss_x loss_x 0.3789 (0.3757) acc_x 90.6250 (91.4583) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/21] time 0.353 (0.351) data 0.275 (0.274) loss_x loss_x 0.3525 (0.3745) acc_x 90.6250 (91.5625) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/29] time 0.334 (0.350) data 0.256 (0.272) loss_u loss_u 0.9976 (0.9443) acc_u 0.0000 (6.8750) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [10/29] time 0.330 (0.348) data 0.252 (0.270) loss_u loss_u 0.9712 (0.9379) acc_u 3.1250 (7.5000) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [15/29] time 0.349 (0.347) data 0.272 (0.269) loss_u loss_u 0.9380 (0.9398) acc_u 6.2500 (7.0833) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [20/29] time 0.330 (0.346) data 0.251 (0.269) loss_u loss_u 0.8838 (0.9359) acc_u 12.5000 (7.5000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [25/29] time 0.305 (0.341) data 0.226 (0.263) loss_u loss_u 0.9434 (0.9351) acc_u 6.2500 (7.6250) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 326
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 701
clean true:682
clean false:19
clean_rate:0.9728958630527818
noisy true:624
noisy false:307
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 931
epoch [83/200] batch [5/21] time 0.360 (0.351) data 0.282 (0.273) loss_x loss_x 0.2671 (0.3782) acc_x 90.6250 (90.6250) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/21] time 0.337 (0.350) data 0.258 (0.272) loss_x loss_x 0.4067 (0.3821) acc_x 90.6250 (90.9375) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/21] time 0.347 (0.349) data 0.270 (0.271) loss_x loss_x 0.2700 (0.3606) acc_x 90.6250 (91.2500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/21] time 0.347 (0.347) data 0.270 (0.270) loss_x loss_x 0.3416 (0.3693) acc_x 90.6250 (91.2500) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/29] time 0.362 (0.350) data 0.284 (0.272) loss_u loss_u 0.9561 (0.9188) acc_u 6.2500 (9.3750) lr 1.2940e-03 eta 0:00:08
epoch [83/200] batch [10/29] time 0.345 (0.349) data 0.266 (0.272) loss_u loss_u 0.8936 (0.9362) acc_u 12.5000 (7.1875) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [15/29] time 0.339 (0.350) data 0.260 (0.272) loss_u loss_u 0.8604 (0.9351) acc_u 15.6250 (7.5000) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [20/29] time 0.327 (0.349) data 0.249 (0.271) loss_u loss_u 0.9961 (0.9402) acc_u 0.0000 (6.8750) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [25/29] time 0.302 (0.345) data 0.223 (0.267) loss_u loss_u 0.9697 (0.9378) acc_u 3.1250 (7.1250) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 335
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 701
clean true:681
clean false:20
clean_rate:0.9714693295292439
noisy true:616
noisy false:315
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 931
epoch [84/200] batch [5/21] time 0.348 (0.351) data 0.270 (0.273) loss_x loss_x 0.5503 (0.4300) acc_x 87.5000 (88.7500) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/21] time 0.373 (0.352) data 0.296 (0.274) loss_x loss_x 0.2078 (0.4247) acc_x 96.8750 (89.3750) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/21] time 0.343 (0.351) data 0.266 (0.273) loss_x loss_x 0.4822 (0.4063) acc_x 90.6250 (90.2083) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/21] time 0.347 (0.348) data 0.270 (0.271) loss_x loss_x 0.2405 (0.4357) acc_x 96.8750 (89.5312) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/29] time 0.345 (0.348) data 0.267 (0.270) loss_u loss_u 0.9067 (0.9031) acc_u 9.3750 (11.8750) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [10/29] time 0.342 (0.347) data 0.264 (0.269) loss_u loss_u 0.9453 (0.9233) acc_u 6.2500 (9.0625) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [15/29] time 0.347 (0.347) data 0.270 (0.269) loss_u loss_u 0.9395 (0.9273) acc_u 6.2500 (8.3333) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [20/29] time 0.311 (0.344) data 0.232 (0.267) loss_u loss_u 0.9546 (0.9307) acc_u 6.2500 (7.9688) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [25/29] time 0.302 (0.341) data 0.224 (0.263) loss_u loss_u 0.9268 (0.9320) acc_u 12.5000 (8.0000) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 712
clean true:692
clean false:20
clean_rate:0.9719101123595506
noisy true:602
noisy false:318
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 920
epoch [85/200] batch [5/22] time 0.346 (0.349) data 0.269 (0.271) loss_x loss_x 0.7285 (0.3899) acc_x 81.2500 (92.5000) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/22] time 0.344 (0.343) data 0.267 (0.266) loss_x loss_x 0.4299 (0.4011) acc_x 90.6250 (91.5625) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/22] time 0.352 (0.342) data 0.275 (0.265) loss_x loss_x 0.5649 (0.4169) acc_x 87.5000 (90.2083) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [20/22] time 0.319 (0.340) data 0.242 (0.262) loss_x loss_x 0.6074 (0.4078) acc_x 78.1250 (89.8438) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/28] time 0.364 (0.342) data 0.285 (0.265) loss_u loss_u 0.9424 (0.9403) acc_u 6.2500 (6.8750) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [10/28] time 0.340 (0.342) data 0.262 (0.265) loss_u loss_u 0.9639 (0.9268) acc_u 3.1250 (8.1250) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [15/28] time 0.367 (0.343) data 0.289 (0.265) loss_u loss_u 0.9712 (0.9358) acc_u 3.1250 (7.0833) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [20/28] time 0.309 (0.340) data 0.230 (0.262) loss_u loss_u 0.9976 (0.9440) acc_u 0.0000 (6.4062) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/28] time 0.319 (0.337) data 0.241 (0.259) loss_u loss_u 0.9429 (0.9408) acc_u 6.2500 (6.8750) lr 1.2639e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 349
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 707
clean true:683
clean false:24
clean_rate:0.9660537482319661
noisy true:600
noisy false:325
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 925
epoch [86/200] batch [5/22] time 0.349 (0.353) data 0.272 (0.275) loss_x loss_x 0.2081 (0.3451) acc_x 96.8750 (91.2500) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [10/22] time 0.335 (0.348) data 0.257 (0.271) loss_x loss_x 0.7188 (0.3849) acc_x 93.7500 (91.2500) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/22] time 0.341 (0.346) data 0.263 (0.269) loss_x loss_x 0.3137 (0.4071) acc_x 87.5000 (89.3750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/22] time 0.333 (0.344) data 0.256 (0.267) loss_x loss_x 0.4116 (0.3983) acc_x 96.8750 (89.8438) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/28] time 0.345 (0.345) data 0.267 (0.267) loss_u loss_u 0.9302 (0.9334) acc_u 6.2500 (6.8750) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [10/28] time 0.340 (0.346) data 0.262 (0.268) loss_u loss_u 0.9688 (0.9258) acc_u 3.1250 (8.4375) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [15/28] time 0.349 (0.346) data 0.271 (0.268) loss_u loss_u 0.9126 (0.9292) acc_u 9.3750 (8.1250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [20/28] time 0.375 (0.347) data 0.296 (0.269) loss_u loss_u 0.9248 (0.9313) acc_u 12.5000 (8.1250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/28] time 0.351 (0.344) data 0.272 (0.266) loss_u loss_u 0.9658 (0.9340) acc_u 3.1250 (8.1250) lr 1.2487e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 317
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 716
clean true:695
clean false:21
clean_rate:0.9706703910614525
noisy true:620
noisy false:296
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 916
epoch [87/200] batch [5/22] time 0.352 (0.355) data 0.275 (0.277) loss_x loss_x 0.2262 (0.3793) acc_x 96.8750 (90.0000) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [10/22] time 0.332 (0.352) data 0.255 (0.275) loss_x loss_x 0.3958 (0.3812) acc_x 93.7500 (91.2500) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/22] time 0.330 (0.347) data 0.252 (0.269) loss_x loss_x 0.5210 (0.3786) acc_x 87.5000 (91.2500) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/22] time 0.341 (0.345) data 0.263 (0.268) loss_x loss_x 0.4382 (0.4083) acc_x 84.3750 (90.1562) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/28] time 0.353 (0.345) data 0.276 (0.267) loss_u loss_u 0.9360 (0.9586) acc_u 9.3750 (5.6250) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [10/28] time 0.337 (0.346) data 0.260 (0.268) loss_u loss_u 0.8379 (0.9472) acc_u 21.8750 (6.5625) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [15/28] time 0.349 (0.345) data 0.271 (0.268) loss_u loss_u 0.9980 (0.9507) acc_u 0.0000 (6.0417) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [20/28] time 0.355 (0.346) data 0.276 (0.268) loss_u loss_u 0.9375 (0.9511) acc_u 6.2500 (5.7812) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/28] time 0.306 (0.341) data 0.227 (0.263) loss_u loss_u 0.9961 (0.9496) acc_u 0.0000 (5.7500) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 710
clean true:689
clean false:21
clean_rate:0.9704225352112676
noisy true:605
noisy false:317
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 922
epoch [88/200] batch [5/22] time 0.341 (0.347) data 0.264 (0.269) loss_x loss_x 0.2554 (0.5798) acc_x 93.7500 (85.0000) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/22] time 0.352 (0.347) data 0.274 (0.269) loss_x loss_x 0.3579 (0.4685) acc_x 96.8750 (88.1250) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/22] time 0.344 (0.348) data 0.266 (0.270) loss_x loss_x 0.2651 (0.4451) acc_x 93.7500 (88.5417) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/22] time 0.354 (0.342) data 0.276 (0.265) loss_x loss_x 0.5449 (0.4414) acc_x 87.5000 (88.9062) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/28] time 0.333 (0.342) data 0.255 (0.264) loss_u loss_u 0.8940 (0.9290) acc_u 12.5000 (8.7500) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [10/28] time 0.362 (0.344) data 0.284 (0.266) loss_u loss_u 0.8735 (0.9207) acc_u 15.6250 (10.0000) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [15/28] time 0.357 (0.344) data 0.279 (0.266) loss_u loss_u 0.9946 (0.9385) acc_u 0.0000 (8.1250) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [20/28] time 0.340 (0.344) data 0.263 (0.266) loss_u loss_u 0.9927 (0.9490) acc_u 0.0000 (6.5625) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/28] time 0.305 (0.343) data 0.226 (0.265) loss_u loss_u 0.9155 (0.9466) acc_u 9.3750 (6.6250) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 328
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 713
clean true:691
clean false:22
clean_rate:0.9691444600280504
noisy true:613
noisy false:306
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 919
epoch [89/200] batch [5/22] time 0.349 (0.353) data 0.271 (0.275) loss_x loss_x 0.6279 (0.4498) acc_x 84.3750 (92.5000) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [10/22] time 0.338 (0.348) data 0.258 (0.270) loss_x loss_x 0.3704 (0.4396) acc_x 93.7500 (91.5625) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/22] time 0.351 (0.347) data 0.273 (0.269) loss_x loss_x 0.1682 (0.4525) acc_x 100.0000 (91.4583) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/22] time 0.354 (0.346) data 0.277 (0.268) loss_x loss_x 0.3516 (0.4385) acc_x 90.6250 (91.4062) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/28] time 0.358 (0.346) data 0.280 (0.268) loss_u loss_u 0.9937 (0.9525) acc_u 0.0000 (5.6250) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [10/28] time 0.349 (0.346) data 0.271 (0.268) loss_u loss_u 0.9634 (0.9352) acc_u 3.1250 (7.5000) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [15/28] time 0.345 (0.346) data 0.267 (0.268) loss_u loss_u 0.9185 (0.9428) acc_u 12.5000 (6.8750) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [20/28] time 0.338 (0.345) data 0.259 (0.267) loss_u loss_u 0.9595 (0.9448) acc_u 3.1250 (6.4062) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/28] time 0.351 (0.344) data 0.273 (0.266) loss_u loss_u 0.9814 (0.9444) acc_u 3.1250 (6.3750) lr 1.2028e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 308
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:701
clean false:23
clean_rate:0.9682320441988951
noisy true:623
noisy false:285
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [90/200] batch [5/22] time 0.342 (0.357) data 0.264 (0.279) loss_x loss_x 0.4172 (0.3069) acc_x 93.7500 (94.3750) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [10/22] time 0.305 (0.345) data 0.227 (0.267) loss_x loss_x 0.4778 (0.3438) acc_x 90.6250 (92.1875) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/22] time 0.355 (0.337) data 0.278 (0.259) loss_x loss_x 0.5620 (0.3473) acc_x 90.6250 (92.2917) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [20/22] time 0.336 (0.338) data 0.258 (0.260) loss_x loss_x 0.2725 (0.3632) acc_x 96.8750 (91.4062) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/28] time 0.332 (0.338) data 0.255 (0.260) loss_u loss_u 0.9673 (0.9501) acc_u 3.1250 (5.0000) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [10/28] time 0.310 (0.338) data 0.233 (0.260) loss_u loss_u 0.9932 (0.9486) acc_u 0.0000 (5.3125) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [15/28] time 0.303 (0.337) data 0.225 (0.259) loss_u loss_u 0.9985 (0.9491) acc_u 0.0000 (5.2083) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [20/28] time 0.305 (0.334) data 0.226 (0.256) loss_u loss_u 0.9668 (0.9508) acc_u 3.1250 (5.3125) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/28] time 0.362 (0.336) data 0.284 (0.258) loss_u loss_u 0.9946 (0.9532) acc_u 0.0000 (5.2500) lr 1.1874e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 333
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 716
clean true:692
clean false:24
clean_rate:0.9664804469273743
noisy true:607
noisy false:309
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 916
epoch [91/200] batch [5/22] time 0.348 (0.346) data 0.271 (0.268) loss_x loss_x 0.2651 (0.2839) acc_x 90.6250 (91.8750) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/22] time 0.352 (0.344) data 0.274 (0.266) loss_x loss_x 0.2153 (0.3264) acc_x 96.8750 (91.8750) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/22] time 0.346 (0.342) data 0.268 (0.265) loss_x loss_x 0.2729 (0.3229) acc_x 93.7500 (92.2917) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/22] time 0.330 (0.341) data 0.252 (0.264) loss_x loss_x 0.3489 (0.3504) acc_x 90.6250 (91.5625) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/28] time 0.342 (0.341) data 0.263 (0.264) loss_u loss_u 0.9556 (0.9225) acc_u 6.2500 (9.3750) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [10/28] time 0.342 (0.341) data 0.263 (0.263) loss_u loss_u 0.8994 (0.9257) acc_u 9.3750 (8.4375) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [15/28] time 0.380 (0.342) data 0.301 (0.264) loss_u loss_u 0.9980 (0.9373) acc_u 0.0000 (7.2917) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [20/28] time 0.320 (0.338) data 0.241 (0.260) loss_u loss_u 0.9688 (0.9385) acc_u 3.1250 (7.0312) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/28] time 0.335 (0.339) data 0.258 (0.261) loss_u loss_u 0.9390 (0.9406) acc_u 6.2500 (6.8750) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 311
confident_label rate tensor(0.4393, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 717
clean true:698
clean false:19
clean_rate:0.9735006973500697
noisy true:623
noisy false:292
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 915
epoch [92/200] batch [5/22] time 0.355 (0.346) data 0.277 (0.269) loss_x loss_x 0.4590 (0.3851) acc_x 87.5000 (90.0000) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/22] time 0.338 (0.342) data 0.260 (0.264) loss_x loss_x 0.3540 (0.3572) acc_x 90.6250 (90.3125) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/22] time 0.336 (0.342) data 0.258 (0.264) loss_x loss_x 0.5718 (0.3890) acc_x 81.2500 (89.3750) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/22] time 0.326 (0.338) data 0.249 (0.261) loss_x loss_x 0.7129 (0.4128) acc_x 84.3750 (89.0625) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/28] time 0.381 (0.341) data 0.303 (0.264) loss_u loss_u 0.9595 (0.9413) acc_u 3.1250 (6.8750) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [10/28] time 0.336 (0.341) data 0.258 (0.263) loss_u loss_u 0.9136 (0.9446) acc_u 9.3750 (6.5625) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [15/28] time 0.363 (0.341) data 0.285 (0.263) loss_u loss_u 0.9658 (0.9435) acc_u 3.1250 (6.6667) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [20/28] time 0.395 (0.339) data 0.316 (0.261) loss_u loss_u 0.9565 (0.9413) acc_u 3.1250 (6.7188) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/28] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.9492 (0.9439) acc_u 6.2500 (6.5000) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 329
confident_label rate tensor(0.4357, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 711
clean true:688
clean false:23
clean_rate:0.9676511954992968
noisy true:615
noisy false:306
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 921
epoch [93/200] batch [5/22] time 0.358 (0.345) data 0.281 (0.267) loss_x loss_x 0.2079 (0.3353) acc_x 96.8750 (93.1250) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/22] time 0.346 (0.348) data 0.268 (0.271) loss_x loss_x 0.3516 (0.3685) acc_x 87.5000 (91.5625) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/22] time 0.288 (0.342) data 0.211 (0.265) loss_x loss_x 0.3997 (0.3589) acc_x 87.5000 (92.0833) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/22] time 0.308 (0.334) data 0.231 (0.257) loss_x loss_x 0.5869 (0.3636) acc_x 84.3750 (91.8750) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/28] time 0.364 (0.336) data 0.286 (0.258) loss_u loss_u 0.9316 (0.9463) acc_u 9.3750 (6.2500) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [10/28] time 0.340 (0.336) data 0.262 (0.259) loss_u loss_u 0.9326 (0.9351) acc_u 9.3750 (7.8125) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [15/28] time 0.344 (0.337) data 0.265 (0.260) loss_u loss_u 0.9429 (0.9307) acc_u 6.2500 (8.3333) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [20/28] time 0.349 (0.337) data 0.271 (0.260) loss_u loss_u 0.9370 (0.9337) acc_u 6.2500 (8.1250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/28] time 0.350 (0.338) data 0.272 (0.261) loss_u loss_u 0.9219 (0.9358) acc_u 9.3750 (7.7500) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 321
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:703
clean false:26
clean_rate:0.9643347050754458
noisy true:608
noisy false:295
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [94/200] batch [5/22] time 0.334 (0.341) data 0.257 (0.263) loss_x loss_x 0.5244 (0.2979) acc_x 87.5000 (93.7500) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/22] time 0.355 (0.342) data 0.278 (0.265) loss_x loss_x 0.2451 (0.2976) acc_x 96.8750 (93.4375) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/22] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.3728 (0.3333) acc_x 96.8750 (93.3333) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/22] time 0.344 (0.344) data 0.266 (0.266) loss_x loss_x 0.6484 (0.3741) acc_x 84.3750 (92.0312) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/28] time 0.342 (0.344) data 0.264 (0.266) loss_u loss_u 0.9556 (0.9647) acc_u 6.2500 (3.7500) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [10/28] time 0.345 (0.344) data 0.267 (0.266) loss_u loss_u 0.9082 (0.9636) acc_u 9.3750 (3.7500) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [15/28] time 0.345 (0.344) data 0.267 (0.266) loss_u loss_u 0.9570 (0.9540) acc_u 6.2500 (5.0000) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [20/28] time 0.300 (0.340) data 0.221 (0.262) loss_u loss_u 0.9390 (0.9497) acc_u 9.3750 (5.4688) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/28] time 0.339 (0.339) data 0.261 (0.261) loss_u loss_u 0.9521 (0.9486) acc_u 6.2500 (5.6250) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 302
confident_label rate tensor(0.4424, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 722
clean true:698
clean false:24
clean_rate:0.9667590027700831
noisy true:632
noisy false:278
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 910
epoch [95/200] batch [5/22] time 0.343 (0.349) data 0.266 (0.272) loss_x loss_x 0.1968 (0.3374) acc_x 96.8750 (93.1250) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/22] time 0.335 (0.347) data 0.257 (0.269) loss_x loss_x 0.9585 (0.4122) acc_x 68.7500 (90.3125) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/22] time 0.333 (0.348) data 0.256 (0.270) loss_x loss_x 0.2937 (0.3856) acc_x 96.8750 (91.0417) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/22] time 0.339 (0.347) data 0.262 (0.269) loss_x loss_x 0.2798 (0.3622) acc_x 96.8750 (91.4062) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/28] time 0.346 (0.346) data 0.268 (0.269) loss_u loss_u 0.9688 (0.9534) acc_u 3.1250 (5.6250) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [10/28] time 0.344 (0.345) data 0.266 (0.267) loss_u loss_u 0.8882 (0.9410) acc_u 12.5000 (7.5000) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [15/28] time 0.293 (0.342) data 0.214 (0.264) loss_u loss_u 0.9648 (0.9348) acc_u 3.1250 (7.9167) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [20/28] time 0.340 (0.341) data 0.262 (0.263) loss_u loss_u 0.9258 (0.9426) acc_u 9.3750 (6.8750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/28] time 0.327 (0.341) data 0.249 (0.263) loss_u loss_u 0.9678 (0.9428) acc_u 3.1250 (7.0000) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 328
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 721
clean true:700
clean false:21
clean_rate:0.970873786407767
noisy true:604
noisy false:307
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 911
epoch [96/200] batch [5/22] time 0.366 (0.356) data 0.289 (0.278) loss_x loss_x 0.2104 (0.2703) acc_x 93.7500 (93.1250) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [10/22] time 0.349 (0.352) data 0.271 (0.274) loss_x loss_x 0.3013 (0.2853) acc_x 93.7500 (92.8125) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/22] time 0.333 (0.348) data 0.255 (0.271) loss_x loss_x 0.2336 (0.3466) acc_x 93.7500 (91.6667) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [20/22] time 0.341 (0.346) data 0.264 (0.269) loss_x loss_x 0.2856 (0.3383) acc_x 93.7500 (92.1875) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/28] time 0.355 (0.349) data 0.277 (0.271) loss_u loss_u 0.9717 (0.9462) acc_u 3.1250 (6.2500) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [10/28] time 0.302 (0.343) data 0.224 (0.265) loss_u loss_u 0.9414 (0.9342) acc_u 12.5000 (8.4375) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [15/28] time 0.337 (0.340) data 0.258 (0.262) loss_u loss_u 0.9766 (0.9414) acc_u 3.1250 (7.2917) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [20/28] time 0.349 (0.340) data 0.271 (0.262) loss_u loss_u 0.9082 (0.9401) acc_u 9.3750 (7.1875) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/28] time 0.341 (0.341) data 0.264 (0.263) loss_u loss_u 0.9795 (0.9377) acc_u 3.1250 (7.3750) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 316
confident_label rate tensor(0.4424, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 722
clean true:700
clean false:22
clean_rate:0.9695290858725761
noisy true:616
noisy false:294
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 910
epoch [97/200] batch [5/22] time 0.351 (0.355) data 0.274 (0.277) loss_x loss_x 0.4556 (0.3506) acc_x 87.5000 (92.5000) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [10/22] time 0.291 (0.349) data 0.213 (0.271) loss_x loss_x 0.3057 (0.4115) acc_x 93.7500 (90.9375) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/22] time 0.302 (0.334) data 0.225 (0.256) loss_x loss_x 0.2788 (0.3764) acc_x 90.6250 (90.8333) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/22] time 0.345 (0.330) data 0.268 (0.252) loss_x loss_x 0.6123 (0.3709) acc_x 84.3750 (91.2500) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/28] time 0.418 (0.338) data 0.340 (0.261) loss_u loss_u 0.9502 (0.9219) acc_u 6.2500 (8.7500) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [10/28] time 0.340 (0.338) data 0.261 (0.260) loss_u loss_u 0.9727 (0.9361) acc_u 3.1250 (6.8750) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [15/28] time 0.342 (0.337) data 0.264 (0.259) loss_u loss_u 0.9487 (0.9386) acc_u 6.2500 (6.8750) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [20/28] time 0.335 (0.337) data 0.257 (0.260) loss_u loss_u 0.9380 (0.9425) acc_u 6.2500 (6.2500) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/28] time 0.335 (0.337) data 0.257 (0.259) loss_u loss_u 0.9580 (0.9471) acc_u 6.2500 (5.7500) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 322
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 709
clean true:689
clean false:20
clean_rate:0.9717912552891397
noisy true:621
noisy false:302
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 923
epoch [98/200] batch [5/22] time 0.339 (0.353) data 0.262 (0.276) loss_x loss_x 0.2761 (0.3583) acc_x 93.7500 (91.2500) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [10/22] time 0.333 (0.350) data 0.255 (0.272) loss_x loss_x 0.5615 (0.3357) acc_x 84.3750 (92.5000) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/22] time 0.351 (0.347) data 0.273 (0.269) loss_x loss_x 0.1083 (0.3186) acc_x 100.0000 (93.3333) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/22] time 0.340 (0.345) data 0.262 (0.268) loss_x loss_x 0.5586 (0.3560) acc_x 87.5000 (92.3438) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/28] time 0.348 (0.345) data 0.269 (0.267) loss_u loss_u 0.7891 (0.9193) acc_u 25.0000 (8.7500) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [10/28] time 0.341 (0.340) data 0.262 (0.262) loss_u loss_u 0.9448 (0.9343) acc_u 6.2500 (7.5000) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [15/28] time 0.348 (0.341) data 0.271 (0.263) loss_u loss_u 0.9531 (0.9330) acc_u 6.2500 (7.9167) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [20/28] time 0.340 (0.341) data 0.262 (0.263) loss_u loss_u 0.9365 (0.9338) acc_u 9.3750 (7.8125) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/28] time 0.352 (0.342) data 0.273 (0.264) loss_u loss_u 0.8540 (0.9310) acc_u 18.7500 (8.2500) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 335
confident_label rate tensor(0.4381, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 715
clean true:691
clean false:24
clean_rate:0.9664335664335665
noisy true:606
noisy false:311
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 917
epoch [99/200] batch [5/22] time 0.329 (0.347) data 0.252 (0.269) loss_x loss_x 0.3882 (0.4089) acc_x 87.5000 (89.3750) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [10/22] time 0.347 (0.344) data 0.270 (0.267) loss_x loss_x 0.9858 (0.4185) acc_x 87.5000 (91.2500) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/22] time 0.339 (0.344) data 0.262 (0.266) loss_x loss_x 0.2261 (0.3896) acc_x 96.8750 (92.0833) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/22] time 0.335 (0.343) data 0.256 (0.266) loss_x loss_x 0.2654 (0.3729) acc_x 93.7500 (92.5000) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/28] time 0.300 (0.343) data 0.221 (0.266) loss_u loss_u 0.9683 (0.9524) acc_u 3.1250 (5.0000) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [10/28] time 0.348 (0.339) data 0.270 (0.262) loss_u loss_u 0.9648 (0.9556) acc_u 3.1250 (5.0000) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [15/28] time 0.354 (0.339) data 0.277 (0.261) loss_u loss_u 0.9707 (0.9454) acc_u 3.1250 (6.0417) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [20/28] time 0.330 (0.339) data 0.251 (0.261) loss_u loss_u 0.9438 (0.9448) acc_u 6.2500 (6.2500) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/28] time 0.353 (0.340) data 0.275 (0.262) loss_u loss_u 0.9785 (0.9407) acc_u 3.1250 (6.7500) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 314
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 713
clean true:694
clean false:19
clean_rate:0.9733520336605891
noisy true:624
noisy false:295
all clean rate:  [0.9747474747474747, 0.988929889298893, 0.9934065934065934, 0.9810526315789474, 0.9878787878787879, 0.9917864476386037, 0.997920997920998, 0.9921104536489151, 0.9921722113502935, 0.9859719438877755, 0.9943396226415094, 0.9868667917448405, 0.9774436090225563, 0.9809160305343512, 0.9659498207885304, 0.9761467889908257, 0.9722222222222222, 0.9680672268907563, 0.9680284191829485, 0.9714765100671141, 0.9729272419627749, 0.9747899159663865, 0.9736842105263158, 0.972972972972973, 0.9696969696969697, 0.9799666110183639, 0.9746031746031746, 0.9811965811965812, 0.9694533762057878, 0.9707792207792207, 0.9643435980551054, 0.9837662337662337, 0.9778481012658228, 0.9663461538461539, 0.9736842105263158, 0.9752321981424149, 0.9722222222222222, 0.9701726844583988, 0.9753846153846154, 0.9797507788161994, 0.9627906976744186, 0.974960876369327, 0.974320241691843, 0.9692307692307692, 0.9757942511346445, 0.971342383107089, 0.9680851063829787, 0.9714285714285714, 0.9680365296803652, 0.9730538922155688, 0.9702380952380952, 0.9695121951219512, 0.9673590504451038, 0.9707602339181286, 0.9718518518518519, 0.9716417910447761, 0.975254730713246, 0.9685157421289355, 0.9734121122599705, 0.9703703703703703, 0.968562874251497, 0.9650655021834061, 0.9768451519536903, 0.9696531791907514, 0.9724238026124818, 0.9765739385065886, 0.9784791965566715, 0.9742857142857143, 0.9769452449567724, 0.975254730713246, 0.9685264663805436, 0.9747545582047685, 0.9753265602322206, 0.9788135593220338, 0.9680998613037448, 0.9712643678160919, 0.9744318181818182, 0.9726618705035971, 0.9776536312849162, 0.9643874643874644, 0.9658605974395448, 0.9657142857142857, 0.9728958630527818, 0.9714693295292439, 0.9719101123595506, 0.9660537482319661, 0.9706703910614525, 0.9704225352112676, 0.9691444600280504, 0.9682320441988951, 0.9664804469273743, 0.9735006973500697, 0.9676511954992968, 0.9643347050754458, 0.9667590027700831, 0.970873786407767, 0.9695290858725761, 0.9717912552891397, 0.9664335664335665, 0.9733520336605891]
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 919
epoch [100/200] batch [5/22] time 0.346 (0.346) data 0.268 (0.267) loss_x loss_x 0.3547 (0.3524) acc_x 90.6250 (91.2500) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/22] time 0.334 (0.345) data 0.256 (0.267) loss_x loss_x 0.2959 (0.3197) acc_x 96.8750 (92.1875) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/22] time 0.343 (0.342) data 0.266 (0.264) loss_x loss_x 0.2803 (0.3612) acc_x 93.7500 (91.0417) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/22] time 0.350 (0.342) data 0.273 (0.265) loss_x loss_x 0.1927 (0.3584) acc_x 96.8750 (91.0938) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/28] time 0.349 (0.343) data 0.271 (0.265) loss_u loss_u 0.9912 (0.9482) acc_u 0.0000 (6.2500) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [10/28] time 0.305 (0.336) data 0.226 (0.259) loss_u loss_u 0.9365 (0.9428) acc_u 6.2500 (6.5625) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [15/28] time 0.321 (0.334) data 0.244 (0.256) loss_u loss_u 0.9976 (0.9422) acc_u 0.0000 (6.6667) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [20/28] time 0.344 (0.333) data 0.266 (0.255) loss_u loss_u 0.9077 (0.9396) acc_u 9.3750 (7.0312) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/28] time 0.368 (0.334) data 0.290 (0.256) loss_u loss_u 0.9458 (0.9407) acc_u 6.2500 (6.7500) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 317
confident_label rate tensor(0.4393, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 717
clean true:692
clean false:25
clean_rate:0.9651324965132496
noisy true:623
noisy false:292
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 915
epoch [101/200] batch [5/22] time 0.347 (0.350) data 0.269 (0.272) loss_x loss_x 0.2024 (0.2313) acc_x 96.8750 (94.3750) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/22] time 0.349 (0.349) data 0.271 (0.272) loss_x loss_x 0.3862 (0.3482) acc_x 93.7500 (92.1875) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/22] time 0.345 (0.348) data 0.267 (0.270) loss_x loss_x 0.2778 (0.3380) acc_x 90.6250 (92.2917) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/22] time 0.343 (0.349) data 0.266 (0.272) loss_x loss_x 0.9448 (0.3553) acc_x 84.3750 (92.1875) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/28] time 0.304 (0.345) data 0.225 (0.267) loss_u loss_u 0.9834 (0.9540) acc_u 0.0000 (5.0000) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [10/28] time 0.323 (0.340) data 0.246 (0.262) loss_u loss_u 0.8984 (0.9400) acc_u 12.5000 (6.8750) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [15/28] time 0.346 (0.339) data 0.268 (0.262) loss_u loss_u 0.9048 (0.9402) acc_u 9.3750 (6.6667) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [20/28] time 0.306 (0.338) data 0.227 (0.260) loss_u loss_u 0.9707 (0.9389) acc_u 3.1250 (6.8750) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/28] time 0.348 (0.337) data 0.270 (0.259) loss_u loss_u 0.9395 (0.9380) acc_u 6.2500 (6.8750) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 329
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 716
clean true:694
clean false:22
clean_rate:0.9692737430167597
noisy true:609
noisy false:307
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 916
epoch [102/200] batch [5/22] time 0.334 (0.343) data 0.257 (0.265) loss_x loss_x 0.2808 (0.3056) acc_x 93.7500 (93.1250) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/22] time 0.307 (0.331) data 0.229 (0.253) loss_x loss_x 0.2159 (0.2911) acc_x 96.8750 (94.3750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [15/22] time 0.332 (0.334) data 0.254 (0.256) loss_x loss_x 0.6904 (0.3290) acc_x 78.1250 (92.5000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/22] time 0.341 (0.337) data 0.262 (0.259) loss_x loss_x 0.2198 (0.3122) acc_x 93.7500 (92.8125) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/28] time 0.298 (0.331) data 0.220 (0.254) loss_u loss_u 0.8174 (0.9099) acc_u 25.0000 (11.8750) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [10/28] time 0.352 (0.332) data 0.273 (0.254) loss_u loss_u 0.9380 (0.9229) acc_u 6.2500 (9.3750) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [15/28] time 0.344 (0.333) data 0.267 (0.255) loss_u loss_u 0.9902 (0.9331) acc_u 0.0000 (7.9167) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [20/28] time 0.344 (0.334) data 0.266 (0.256) loss_u loss_u 0.9814 (0.9377) acc_u 3.1250 (7.5000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/28] time 0.341 (0.334) data 0.263 (0.256) loss_u loss_u 0.9761 (0.9405) acc_u 3.1250 (7.1250) lr 1.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 302
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:705
clean false:19
clean_rate:0.9737569060773481
noisy true:625
noisy false:283
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [103/200] batch [5/22] time 0.338 (0.351) data 0.261 (0.274) loss_x loss_x 0.4341 (0.4402) acc_x 93.7500 (90.6250) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/22] time 0.343 (0.352) data 0.266 (0.275) loss_x loss_x 0.2563 (0.3678) acc_x 93.7500 (92.5000) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/22] time 0.344 (0.347) data 0.266 (0.270) loss_x loss_x 0.6079 (0.3918) acc_x 87.5000 (91.4583) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [20/22] time 0.333 (0.345) data 0.256 (0.267) loss_x loss_x 0.2177 (0.4040) acc_x 93.7500 (90.3125) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/28] time 0.296 (0.337) data 0.217 (0.259) loss_u loss_u 0.8506 (0.9204) acc_u 15.6250 (8.1250) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [10/28] time 0.342 (0.334) data 0.265 (0.256) loss_u loss_u 0.9072 (0.9318) acc_u 9.3750 (6.5625) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [15/28] time 0.349 (0.334) data 0.272 (0.256) loss_u loss_u 0.9331 (0.9299) acc_u 6.2500 (7.2917) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [20/28] time 0.330 (0.335) data 0.252 (0.257) loss_u loss_u 0.9009 (0.9289) acc_u 12.5000 (7.5000) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/28] time 0.329 (0.335) data 0.252 (0.257) loss_u loss_u 0.9590 (0.9396) acc_u 6.2500 (6.3750) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 304
confident_label rate tensor(0.4485, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 732
clean true:711
clean false:21
clean_rate:0.9713114754098361
noisy true:617
noisy false:283
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 900
epoch [104/200] batch [5/22] time 0.350 (0.354) data 0.272 (0.276) loss_x loss_x 0.2233 (0.4052) acc_x 96.8750 (92.5000) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [10/22] time 0.299 (0.339) data 0.221 (0.262) loss_x loss_x 0.2969 (0.3814) acc_x 90.6250 (92.1875) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/22] time 0.342 (0.340) data 0.265 (0.263) loss_x loss_x 0.5654 (0.3956) acc_x 87.5000 (91.6667) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/22] time 0.347 (0.342) data 0.269 (0.265) loss_x loss_x 0.2925 (0.3743) acc_x 93.7500 (92.0312) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/28] time 0.299 (0.339) data 0.221 (0.262) loss_u loss_u 0.9282 (0.9469) acc_u 6.2500 (5.6250) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [10/28] time 0.339 (0.336) data 0.261 (0.258) loss_u loss_u 0.9243 (0.9477) acc_u 9.3750 (5.9375) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [15/28] time 0.323 (0.336) data 0.245 (0.258) loss_u loss_u 0.9956 (0.9488) acc_u 0.0000 (5.8333) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [20/28] time 0.341 (0.337) data 0.263 (0.259) loss_u loss_u 0.9326 (0.9475) acc_u 6.2500 (6.2500) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/28] time 0.343 (0.337) data 0.265 (0.259) loss_u loss_u 0.9771 (0.9476) acc_u 3.1250 (6.1250) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 290
confident_label rate tensor(0.4510, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 736
clean true:716
clean false:20
clean_rate:0.9728260869565217
noisy true:626
noisy false:270
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 896
epoch [105/200] batch [5/23] time 0.353 (0.354) data 0.276 (0.277) loss_x loss_x 0.4956 (0.3336) acc_x 87.5000 (93.1250) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [10/23] time 0.345 (0.347) data 0.268 (0.270) loss_x loss_x 0.3003 (0.3966) acc_x 93.7500 (90.9375) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/23] time 0.335 (0.345) data 0.258 (0.268) loss_x loss_x 0.4995 (0.3951) acc_x 87.5000 (91.4583) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/23] time 0.344 (0.345) data 0.267 (0.268) loss_x loss_x 0.5283 (0.3844) acc_x 84.3750 (91.2500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [5/28] time 0.310 (0.340) data 0.231 (0.262) loss_u loss_u 0.8257 (0.9125) acc_u 18.7500 (10.0000) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [10/28] time 0.358 (0.339) data 0.279 (0.261) loss_u loss_u 0.9561 (0.9430) acc_u 9.3750 (7.5000) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [15/28] time 0.349 (0.341) data 0.271 (0.263) loss_u loss_u 0.9248 (0.9509) acc_u 9.3750 (6.4583) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [20/28] time 0.337 (0.340) data 0.259 (0.263) loss_u loss_u 0.9756 (0.9574) acc_u 3.1250 (5.4688) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/28] time 0.348 (0.340) data 0.270 (0.262) loss_u loss_u 0.9429 (0.9545) acc_u 6.2500 (5.6250) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 308
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:704
clean false:20
clean_rate:0.9723756906077348
noisy true:620
noisy false:288
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [106/200] batch [5/22] time 0.361 (0.356) data 0.283 (0.279) loss_x loss_x 0.5200 (0.3805) acc_x 90.6250 (90.6250) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [10/22] time 0.338 (0.351) data 0.261 (0.274) loss_x loss_x 0.6558 (0.3721) acc_x 87.5000 (90.9375) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/22] time 0.354 (0.352) data 0.276 (0.274) loss_x loss_x 0.4080 (0.3545) acc_x 87.5000 (91.0417) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/22] time 0.355 (0.352) data 0.277 (0.274) loss_x loss_x 0.6147 (0.3655) acc_x 84.3750 (90.9375) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/28] time 0.310 (0.344) data 0.231 (0.266) loss_u loss_u 0.9321 (0.9397) acc_u 9.3750 (6.2500) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [10/28] time 0.357 (0.345) data 0.279 (0.267) loss_u loss_u 0.9814 (0.9433) acc_u 3.1250 (6.5625) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [15/28] time 0.345 (0.344) data 0.266 (0.266) loss_u loss_u 0.9062 (0.9445) acc_u 12.5000 (6.4583) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [20/28] time 0.344 (0.344) data 0.266 (0.266) loss_u loss_u 0.9653 (0.9460) acc_u 6.2500 (6.2500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/28] time 0.343 (0.344) data 0.265 (0.266) loss_u loss_u 0.9629 (0.9427) acc_u 6.2500 (7.0000) lr 9.3721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.4473, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 730
clean true:707
clean false:23
clean_rate:0.9684931506849315
noisy true:642
noisy false:260
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 902
epoch [107/200] batch [5/22] time 0.344 (0.344) data 0.266 (0.266) loss_x loss_x 0.5498 (0.5563) acc_x 87.5000 (89.3750) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/22] time 0.468 (0.359) data 0.390 (0.281) loss_x loss_x 0.4822 (0.5330) acc_x 90.6250 (89.6875) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/22] time 0.337 (0.356) data 0.259 (0.278) loss_x loss_x 0.3889 (0.4859) acc_x 87.5000 (89.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/22] time 0.341 (0.353) data 0.263 (0.276) loss_x loss_x 0.2974 (0.4279) acc_x 90.6250 (90.3125) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/28] time 0.308 (0.340) data 0.229 (0.262) loss_u loss_u 0.9351 (0.9401) acc_u 6.2500 (7.5000) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [10/28] time 0.351 (0.343) data 0.273 (0.265) loss_u loss_u 0.9326 (0.9290) acc_u 12.5000 (8.7500) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [15/28] time 0.340 (0.342) data 0.261 (0.264) loss_u loss_u 0.9810 (0.9356) acc_u 3.1250 (7.9167) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [20/28] time 0.357 (0.343) data 0.279 (0.265) loss_u loss_u 0.9092 (0.9418) acc_u 9.3750 (7.0312) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/28] time 0.339 (0.344) data 0.261 (0.265) loss_u loss_u 0.9619 (0.9421) acc_u 6.2500 (7.0000) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 299
confident_label rate tensor(0.4498, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 734
clean true:711
clean false:23
clean_rate:0.9686648501362398
noisy true:622
noisy false:276
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 898
epoch [108/200] batch [5/22] time 0.337 (0.350) data 0.259 (0.272) loss_x loss_x 0.3931 (0.2661) acc_x 84.3750 (93.7500) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/22] time 0.328 (0.346) data 0.250 (0.268) loss_x loss_x 0.4131 (0.3018) acc_x 93.7500 (93.4375) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/22] time 0.347 (0.347) data 0.270 (0.269) loss_x loss_x 0.3101 (0.3404) acc_x 90.6250 (92.5000) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/22] time 0.324 (0.348) data 0.247 (0.270) loss_x loss_x 0.3511 (0.3251) acc_x 90.6250 (92.9688) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/28] time 0.341 (0.338) data 0.263 (0.260) loss_u loss_u 0.9907 (0.9437) acc_u 0.0000 (6.2500) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [10/28] time 0.328 (0.338) data 0.251 (0.260) loss_u loss_u 0.9663 (0.9441) acc_u 3.1250 (5.9375) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [15/28] time 0.332 (0.337) data 0.254 (0.259) loss_u loss_u 0.9497 (0.9464) acc_u 3.1250 (5.6250) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [20/28] time 0.334 (0.336) data 0.256 (0.258) loss_u loss_u 0.9829 (0.9442) acc_u 0.0000 (6.2500) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/28] time 0.330 (0.336) data 0.252 (0.258) loss_u loss_u 0.9448 (0.9421) acc_u 6.2500 (6.3750) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 302
confident_label rate tensor(0.4510, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 736
clean true:712
clean false:24
clean_rate:0.967391304347826
noisy true:618
noisy false:278
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 896
epoch [109/200] batch [5/23] time 0.347 (0.352) data 0.270 (0.274) loss_x loss_x 0.3813 (0.3284) acc_x 90.6250 (91.8750) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [10/23] time 0.351 (0.344) data 0.273 (0.267) loss_x loss_x 0.2673 (0.3010) acc_x 90.6250 (93.1250) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/23] time 0.335 (0.343) data 0.258 (0.266) loss_x loss_x 0.2111 (0.3266) acc_x 100.0000 (92.5000) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [20/23] time 0.337 (0.342) data 0.259 (0.265) loss_x loss_x 0.3901 (0.3139) acc_x 93.7500 (92.3438) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [5/28] time 0.300 (0.343) data 0.221 (0.265) loss_u loss_u 0.9990 (0.9523) acc_u 0.0000 (5.0000) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [10/28] time 0.346 (0.338) data 0.269 (0.261) loss_u loss_u 0.8750 (0.9445) acc_u 15.6250 (6.2500) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [15/28] time 0.360 (0.339) data 0.282 (0.261) loss_u loss_u 0.9644 (0.9417) acc_u 3.1250 (6.6667) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [20/28] time 0.348 (0.339) data 0.270 (0.262) loss_u loss_u 0.9639 (0.9476) acc_u 3.1250 (5.7812) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/28] time 0.351 (0.341) data 0.273 (0.263) loss_u loss_u 0.9165 (0.9428) acc_u 9.3750 (6.3750) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 308
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 721
clean true:698
clean false:23
clean_rate:0.9680998613037448
noisy true:626
noisy false:285
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 911
epoch [110/200] batch [5/22] time 0.331 (0.346) data 0.253 (0.268) loss_x loss_x 0.1949 (0.4174) acc_x 96.8750 (87.5000) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/22] time 0.356 (0.345) data 0.278 (0.267) loss_x loss_x 0.1609 (0.3552) acc_x 96.8750 (90.0000) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/22] time 0.351 (0.345) data 0.274 (0.268) loss_x loss_x 0.3845 (0.3587) acc_x 84.3750 (90.2083) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [20/22] time 0.354 (0.347) data 0.277 (0.269) loss_x loss_x 0.1992 (0.3458) acc_x 100.0000 (90.9375) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/28] time 0.299 (0.342) data 0.220 (0.264) loss_u loss_u 0.8867 (0.9345) acc_u 12.5000 (7.5000) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [10/28] time 0.347 (0.337) data 0.269 (0.259) loss_u loss_u 0.9019 (0.9409) acc_u 12.5000 (7.1875) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [15/28] time 0.338 (0.338) data 0.261 (0.260) loss_u loss_u 0.9932 (0.9430) acc_u 0.0000 (7.0833) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [20/28] time 0.339 (0.337) data 0.262 (0.260) loss_u loss_u 0.9521 (0.9457) acc_u 6.2500 (6.7188) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/28] time 0.349 (0.338) data 0.271 (0.260) loss_u loss_u 0.9341 (0.9421) acc_u 6.2500 (7.1250) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 311
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:706
clean false:23
clean_rate:0.9684499314128944
noisy true:615
noisy false:288
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [111/200] batch [5/22] time 0.343 (0.346) data 0.264 (0.268) loss_x loss_x 0.4622 (0.4229) acc_x 90.6250 (90.6250) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/22] time 0.331 (0.341) data 0.254 (0.264) loss_x loss_x 0.5234 (0.4065) acc_x 84.3750 (90.9375) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/22] time 0.360 (0.343) data 0.282 (0.265) loss_x loss_x 0.3252 (0.3591) acc_x 90.6250 (91.4583) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [20/22] time 0.340 (0.342) data 0.262 (0.264) loss_x loss_x 0.2412 (0.3513) acc_x 93.7500 (92.0312) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/28] time 0.335 (0.342) data 0.256 (0.264) loss_u loss_u 0.9331 (0.9601) acc_u 9.3750 (4.3750) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [10/28] time 0.295 (0.338) data 0.216 (0.260) loss_u loss_u 0.9912 (0.9559) acc_u 0.0000 (4.6875) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [15/28] time 0.305 (0.334) data 0.227 (0.256) loss_u loss_u 0.9404 (0.9584) acc_u 6.2500 (4.3750) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [20/28] time 0.336 (0.335) data 0.257 (0.257) loss_u loss_u 0.9077 (0.9532) acc_u 9.3750 (5.1562) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/28] time 0.339 (0.335) data 0.261 (0.257) loss_u loss_u 0.9541 (0.9483) acc_u 6.2500 (6.1250) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 301
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 726
clean true:706
clean false:20
clean_rate:0.9724517906336089
noisy true:625
noisy false:281
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 906
epoch [112/200] batch [5/22] time 0.342 (0.344) data 0.265 (0.266) loss_x loss_x 0.2871 (0.3104) acc_x 90.6250 (92.5000) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/22] time 0.328 (0.341) data 0.251 (0.263) loss_x loss_x 0.4917 (0.3569) acc_x 90.6250 (91.5625) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/22] time 0.352 (0.341) data 0.273 (0.263) loss_x loss_x 0.2085 (0.3663) acc_x 93.7500 (91.0417) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [20/22] time 0.340 (0.341) data 0.262 (0.263) loss_x loss_x 0.2603 (0.3425) acc_x 96.8750 (92.1875) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/28] time 0.342 (0.342) data 0.265 (0.264) loss_u loss_u 0.9502 (0.9255) acc_u 6.2500 (8.1250) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [10/28] time 0.355 (0.343) data 0.278 (0.266) loss_u loss_u 0.9785 (0.9412) acc_u 3.1250 (6.5625) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [15/28] time 0.332 (0.343) data 0.255 (0.265) loss_u loss_u 0.9580 (0.9407) acc_u 3.1250 (6.8750) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [20/28] time 0.311 (0.341) data 0.233 (0.263) loss_u loss_u 0.9375 (0.9351) acc_u 6.2500 (7.5000) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/28] time 0.300 (0.336) data 0.222 (0.259) loss_u loss_u 0.9761 (0.9349) acc_u 3.1250 (7.6250) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 307
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 726
clean true:703
clean false:23
clean_rate:0.9683195592286501
noisy true:622
noisy false:284
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 906
epoch [113/200] batch [5/22] time 0.343 (0.369) data 0.266 (0.291) loss_x loss_x 0.4690 (0.4027) acc_x 87.5000 (90.0000) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [10/22] time 0.349 (0.360) data 0.271 (0.282) loss_x loss_x 0.1179 (0.3522) acc_x 100.0000 (91.2500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/22] time 0.332 (0.354) data 0.254 (0.276) loss_x loss_x 0.3147 (0.3305) acc_x 93.7500 (91.8750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/22] time 0.310 (0.345) data 0.232 (0.267) loss_x loss_x 0.3730 (0.3233) acc_x 96.8750 (92.5000) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/28] time 0.355 (0.346) data 0.277 (0.268) loss_u loss_u 0.9165 (0.9449) acc_u 9.3750 (5.6250) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [10/28] time 0.357 (0.347) data 0.279 (0.269) loss_u loss_u 0.8408 (0.9293) acc_u 18.7500 (7.8125) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [15/28] time 0.343 (0.347) data 0.265 (0.269) loss_u loss_u 0.9131 (0.9218) acc_u 9.3750 (8.7500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [20/28] time 0.341 (0.348) data 0.262 (0.270) loss_u loss_u 0.8901 (0.9241) acc_u 12.5000 (8.5938) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/28] time 0.323 (0.344) data 0.244 (0.266) loss_u loss_u 0.9258 (0.9324) acc_u 9.3750 (7.7500) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 296
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:723
clean false:21
clean_rate:0.9717741935483871
noisy true:613
noisy false:275
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [114/200] batch [5/23] time 0.337 (0.346) data 0.259 (0.268) loss_x loss_x 0.3013 (0.2942) acc_x 96.8750 (93.7500) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [10/23] time 0.352 (0.344) data 0.275 (0.266) loss_x loss_x 0.3447 (0.3055) acc_x 90.6250 (93.4375) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/23] time 0.340 (0.342) data 0.263 (0.265) loss_x loss_x 0.2849 (0.3305) acc_x 93.7500 (91.8750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/23] time 0.337 (0.337) data 0.260 (0.259) loss_x loss_x 0.2805 (0.3132) acc_x 90.6250 (92.1875) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [5/27] time 0.337 (0.336) data 0.259 (0.258) loss_u loss_u 0.9233 (0.9381) acc_u 9.3750 (8.1250) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [10/27] time 0.349 (0.338) data 0.271 (0.260) loss_u loss_u 0.9399 (0.9439) acc_u 6.2500 (6.5625) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [15/27] time 0.341 (0.338) data 0.264 (0.260) loss_u loss_u 0.9692 (0.9469) acc_u 3.1250 (6.4583) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [20/27] time 0.335 (0.338) data 0.257 (0.260) loss_u loss_u 0.9209 (0.9483) acc_u 9.3750 (6.0938) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/27] time 0.305 (0.336) data 0.226 (0.258) loss_u loss_u 0.9585 (0.9486) acc_u 3.1250 (6.0000) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 284
confident_label rate tensor(0.4504, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 735
clean true:714
clean false:21
clean_rate:0.9714285714285714
noisy true:634
noisy false:263
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 897
epoch [115/200] batch [5/22] time 0.354 (0.340) data 0.277 (0.262) loss_x loss_x 0.1310 (0.3127) acc_x 100.0000 (91.2500) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/22] time 0.346 (0.348) data 0.269 (0.270) loss_x loss_x 0.5747 (0.3905) acc_x 87.5000 (90.0000) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/22] time 0.348 (0.345) data 0.271 (0.268) loss_x loss_x 0.2383 (0.3498) acc_x 96.8750 (91.2500) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [20/22] time 0.333 (0.342) data 0.255 (0.264) loss_x loss_x 0.4302 (0.3750) acc_x 87.5000 (90.7812) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/28] time 0.349 (0.343) data 0.271 (0.265) loss_u loss_u 0.7896 (0.9226) acc_u 25.0000 (8.7500) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [10/28] time 0.342 (0.344) data 0.265 (0.267) loss_u loss_u 0.9297 (0.9312) acc_u 9.3750 (7.8125) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [15/28] time 0.349 (0.345) data 0.272 (0.267) loss_u loss_u 0.9087 (0.9334) acc_u 9.3750 (7.7083) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [20/28] time 0.355 (0.346) data 0.278 (0.268) loss_u loss_u 0.9751 (0.9379) acc_u 3.1250 (7.0312) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/28] time 0.340 (0.345) data 0.261 (0.267) loss_u loss_u 0.9224 (0.9361) acc_u 9.3750 (7.3750) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 295
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:722
clean false:26
clean_rate:0.9652406417112299
noisy true:615
noisy false:269
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [116/200] batch [5/23] time 0.346 (0.351) data 0.269 (0.273) loss_x loss_x 0.4485 (0.4885) acc_x 87.5000 (90.0000) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [10/23] time 0.343 (0.353) data 0.266 (0.275) loss_x loss_x 0.2920 (0.3855) acc_x 96.8750 (91.8750) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/23] time 0.335 (0.348) data 0.258 (0.270) loss_x loss_x 0.5386 (0.4050) acc_x 87.5000 (90.6250) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/23] time 0.343 (0.348) data 0.265 (0.270) loss_x loss_x 0.2578 (0.3743) acc_x 96.8750 (91.5625) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [5/27] time 0.353 (0.346) data 0.275 (0.268) loss_u loss_u 0.9834 (0.9339) acc_u 3.1250 (8.1250) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [10/27] time 0.355 (0.346) data 0.277 (0.268) loss_u loss_u 0.9688 (0.9434) acc_u 3.1250 (7.1875) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [15/27] time 0.339 (0.345) data 0.262 (0.268) loss_u loss_u 0.9673 (0.9472) acc_u 3.1250 (6.8750) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [20/27] time 0.348 (0.346) data 0.270 (0.268) loss_u loss_u 0.9688 (0.9470) acc_u 3.1250 (6.5625) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/27] time 0.366 (0.347) data 0.288 (0.269) loss_u loss_u 0.9600 (0.9476) acc_u 3.1250 (6.5000) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 300
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:705
clean false:24
clean_rate:0.9670781893004116
noisy true:627
noisy false:276
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [117/200] batch [5/22] time 0.298 (0.310) data 0.220 (0.232) loss_x loss_x 0.4539 (0.3430) acc_x 93.7500 (93.1250) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/22] time 0.347 (0.328) data 0.270 (0.250) loss_x loss_x 0.2178 (0.3082) acc_x 93.7500 (93.1250) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [15/22] time 0.348 (0.334) data 0.270 (0.256) loss_x loss_x 0.2307 (0.3129) acc_x 96.8750 (92.7083) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/22] time 0.366 (0.338) data 0.289 (0.260) loss_x loss_x 0.5107 (0.3415) acc_x 78.1250 (91.2500) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/28] time 0.346 (0.341) data 0.268 (0.263) loss_u loss_u 0.9453 (0.9541) acc_u 6.2500 (4.3750) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [10/28] time 0.341 (0.342) data 0.263 (0.264) loss_u loss_u 0.8867 (0.9414) acc_u 12.5000 (6.5625) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [15/28] time 0.346 (0.342) data 0.269 (0.265) loss_u loss_u 0.9180 (0.9329) acc_u 9.3750 (7.9167) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [20/28] time 0.343 (0.342) data 0.265 (0.265) loss_u loss_u 0.9961 (0.9391) acc_u 0.0000 (7.0312) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/28] time 0.358 (0.343) data 0.280 (0.265) loss_u loss_u 0.9214 (0.9365) acc_u 9.3750 (7.5000) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 291
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:726
clean false:22
clean_rate:0.9705882352941176
noisy true:615
noisy false:269
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [118/200] batch [5/23] time 0.334 (0.323) data 0.257 (0.245) loss_x loss_x 0.3694 (0.2845) acc_x 93.7500 (94.3750) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/23] time 0.339 (0.333) data 0.262 (0.255) loss_x loss_x 0.8257 (0.3698) acc_x 84.3750 (92.1875) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/23] time 0.346 (0.337) data 0.269 (0.259) loss_x loss_x 0.4138 (0.3760) acc_x 90.6250 (91.8750) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/23] time 0.321 (0.337) data 0.244 (0.260) loss_x loss_x 0.5972 (0.3760) acc_x 81.2500 (90.9375) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [5/27] time 0.366 (0.343) data 0.289 (0.265) loss_u loss_u 0.9678 (0.9276) acc_u 3.1250 (8.1250) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [10/27] time 0.360 (0.344) data 0.282 (0.266) loss_u loss_u 0.9595 (0.9449) acc_u 3.1250 (6.2500) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [15/27] time 0.351 (0.345) data 0.273 (0.267) loss_u loss_u 0.9521 (0.9495) acc_u 6.2500 (5.6250) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [20/27] time 0.336 (0.344) data 0.259 (0.266) loss_u loss_u 0.9575 (0.9505) acc_u 6.2500 (5.4688) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/27] time 0.342 (0.344) data 0.263 (0.266) loss_u loss_u 0.9688 (0.9481) acc_u 3.1250 (5.6250) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 290
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:721
clean false:21
clean_rate:0.9716981132075472
noisy true:621
noisy false:269
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [119/200] batch [5/23] time 0.342 (0.332) data 0.264 (0.254) loss_x loss_x 0.2820 (0.3292) acc_x 93.7500 (91.2500) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [10/23] time 0.339 (0.334) data 0.262 (0.256) loss_x loss_x 0.3264 (0.3683) acc_x 87.5000 (89.6875) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/23] time 0.327 (0.331) data 0.249 (0.253) loss_x loss_x 0.4241 (0.3978) acc_x 93.7500 (90.8333) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [20/23] time 0.337 (0.333) data 0.260 (0.255) loss_x loss_x 0.3535 (0.3877) acc_x 90.6250 (91.4062) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/27] time 0.363 (0.338) data 0.286 (0.260) loss_u loss_u 0.9858 (0.9627) acc_u 0.0000 (3.7500) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [10/27] time 0.361 (0.339) data 0.283 (0.261) loss_u loss_u 0.9131 (0.9501) acc_u 9.3750 (5.3125) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [15/27] time 0.356 (0.340) data 0.278 (0.262) loss_u loss_u 0.9575 (0.9520) acc_u 6.2500 (5.6250) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [20/27] time 0.351 (0.340) data 0.273 (0.263) loss_u loss_u 0.9194 (0.9457) acc_u 9.3750 (6.2500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/27] time 0.342 (0.341) data 0.264 (0.263) loss_u loss_u 0.9590 (0.9447) acc_u 3.1250 (6.3750) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 280
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:723
clean false:25
clean_rate:0.9665775401069518
noisy true:629
noisy false:255
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [120/200] batch [5/23] time 0.332 (0.342) data 0.254 (0.265) loss_x loss_x 0.4797 (0.3523) acc_x 90.6250 (91.8750) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [10/23] time 0.339 (0.340) data 0.261 (0.262) loss_x loss_x 0.2065 (0.3591) acc_x 90.6250 (91.5625) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/23] time 0.348 (0.341) data 0.271 (0.263) loss_x loss_x 0.3789 (0.3680) acc_x 87.5000 (91.2500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [20/23] time 0.347 (0.341) data 0.270 (0.263) loss_x loss_x 0.1174 (0.3683) acc_x 100.0000 (91.0938) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [5/27] time 0.340 (0.343) data 0.263 (0.266) loss_u loss_u 0.8906 (0.9466) acc_u 12.5000 (6.2500) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [10/27] time 0.342 (0.344) data 0.264 (0.266) loss_u loss_u 0.9644 (0.9558) acc_u 3.1250 (5.6250) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [15/27] time 0.350 (0.344) data 0.272 (0.266) loss_u loss_u 0.9590 (0.9458) acc_u 3.1250 (6.2500) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [20/27] time 0.356 (0.344) data 0.278 (0.266) loss_u loss_u 0.9180 (0.9488) acc_u 9.3750 (5.9375) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/27] time 0.346 (0.349) data 0.266 (0.271) loss_u loss_u 0.9946 (0.9510) acc_u 0.0000 (5.6250) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:726
clean false:20
clean_rate:0.9731903485254692
noisy true:623
noisy false:263
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [121/200] batch [5/23] time 0.346 (0.347) data 0.268 (0.270) loss_x loss_x 0.2202 (0.3121) acc_x 96.8750 (93.1250) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [10/23] time 0.340 (0.348) data 0.263 (0.270) loss_x loss_x 0.3567 (0.3324) acc_x 87.5000 (91.5625) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/23] time 0.353 (0.347) data 0.276 (0.269) loss_x loss_x 0.2413 (0.3186) acc_x 93.7500 (92.5000) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/23] time 0.344 (0.346) data 0.264 (0.268) loss_x loss_x 0.1995 (0.3271) acc_x 96.8750 (92.8125) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [5/27] time 0.354 (0.347) data 0.276 (0.269) loss_u loss_u 0.8843 (0.9274) acc_u 12.5000 (7.5000) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [10/27] time 0.351 (0.348) data 0.274 (0.270) loss_u loss_u 0.9185 (0.9427) acc_u 9.3750 (5.9375) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [15/27] time 0.340 (0.347) data 0.263 (0.270) loss_u loss_u 0.9268 (0.9438) acc_u 6.2500 (5.6250) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [20/27] time 0.358 (0.347) data 0.281 (0.269) loss_u loss_u 0.9751 (0.9500) acc_u 3.1250 (5.1562) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/27] time 0.318 (0.344) data 0.240 (0.267) loss_u loss_u 0.9482 (0.9505) acc_u 9.3750 (5.3750) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 290
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:720
clean false:24
clean_rate:0.967741935483871
noisy true:622
noisy false:266
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [122/200] batch [5/23] time 0.351 (0.356) data 0.274 (0.279) loss_x loss_x 0.3315 (0.2795) acc_x 93.7500 (95.6250) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [10/23] time 0.327 (0.336) data 0.250 (0.259) loss_x loss_x 0.4302 (0.3078) acc_x 87.5000 (93.1250) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/23] time 0.335 (0.336) data 0.257 (0.259) loss_x loss_x 0.4277 (0.3269) acc_x 87.5000 (92.7083) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/23] time 0.337 (0.338) data 0.259 (0.260) loss_x loss_x 0.1469 (0.3060) acc_x 96.8750 (92.9688) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [5/27] time 0.334 (0.338) data 0.256 (0.261) loss_u loss_u 0.9902 (0.9375) acc_u 0.0000 (6.2500) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [10/27] time 0.341 (0.340) data 0.263 (0.262) loss_u loss_u 0.9341 (0.9452) acc_u 6.2500 (5.6250) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [15/27] time 0.340 (0.341) data 0.262 (0.264) loss_u loss_u 0.9077 (0.9426) acc_u 9.3750 (6.0417) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [20/27] time 0.336 (0.341) data 0.258 (0.263) loss_u loss_u 0.8833 (0.9406) acc_u 12.5000 (6.4062) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/27] time 0.295 (0.340) data 0.216 (0.262) loss_u loss_u 0.9141 (0.9415) acc_u 9.3750 (6.3750) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.4522, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 738
clean true:718
clean false:20
clean_rate:0.9728997289972899
noisy true:643
noisy false:251
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 894
epoch [123/200] batch [5/23] time 0.301 (0.301) data 0.223 (0.223) loss_x loss_x 0.3391 (0.2780) acc_x 87.5000 (93.7500) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/23] time 0.334 (0.323) data 0.257 (0.245) loss_x loss_x 0.2468 (0.2860) acc_x 96.8750 (93.7500) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/23] time 0.347 (0.329) data 0.269 (0.252) loss_x loss_x 0.2371 (0.2722) acc_x 90.6250 (94.1667) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/23] time 0.345 (0.336) data 0.267 (0.259) loss_x loss_x 0.5273 (0.3248) acc_x 87.5000 (92.9688) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [5/27] time 0.356 (0.339) data 0.278 (0.261) loss_u loss_u 0.9375 (0.9318) acc_u 6.2500 (7.5000) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [10/27] time 0.333 (0.338) data 0.256 (0.261) loss_u loss_u 0.9316 (0.9319) acc_u 6.2500 (8.4375) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [15/27] time 0.337 (0.339) data 0.259 (0.261) loss_u loss_u 0.9551 (0.9318) acc_u 3.1250 (7.9167) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [20/27] time 0.327 (0.340) data 0.249 (0.262) loss_u loss_u 0.9478 (0.9393) acc_u 6.2500 (6.8750) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/27] time 0.331 (0.340) data 0.253 (0.262) loss_u loss_u 0.9287 (0.9443) acc_u 6.2500 (6.1250) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 300
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:710
clean false:19
clean_rate:0.9739368998628258
noisy true:622
noisy false:281
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [124/200] batch [5/22] time 0.335 (0.341) data 0.258 (0.264) loss_x loss_x 0.1841 (0.4010) acc_x 96.8750 (90.6250) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/22] time 0.306 (0.327) data 0.228 (0.249) loss_x loss_x 0.4854 (0.3649) acc_x 87.5000 (91.2500) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [15/22] time 0.341 (0.330) data 0.263 (0.253) loss_x loss_x 0.6685 (0.3547) acc_x 81.2500 (91.8750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [20/22] time 0.339 (0.334) data 0.262 (0.256) loss_x loss_x 0.2383 (0.3376) acc_x 96.8750 (92.3438) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/28] time 0.359 (0.338) data 0.280 (0.261) loss_u loss_u 0.9053 (0.9217) acc_u 12.5000 (8.7500) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [10/28] time 0.353 (0.341) data 0.276 (0.263) loss_u loss_u 0.9170 (0.9336) acc_u 9.3750 (7.5000) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [15/28] time 0.357 (0.343) data 0.279 (0.265) loss_u loss_u 0.9995 (0.9344) acc_u 0.0000 (7.2917) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [20/28] time 0.347 (0.344) data 0.269 (0.266) loss_u loss_u 0.8936 (0.9274) acc_u 12.5000 (8.1250) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/28] time 0.352 (0.344) data 0.275 (0.266) loss_u loss_u 0.8540 (0.9226) acc_u 15.6250 (8.6250) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 273
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:732
clean false:21
clean_rate:0.9721115537848606
noisy true:627
noisy false:252
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [125/200] batch [5/23] time 0.337 (0.347) data 0.259 (0.268) loss_x loss_x 0.3159 (0.3344) acc_x 87.5000 (91.8750) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [10/23] time 0.343 (0.339) data 0.265 (0.261) loss_x loss_x 0.4128 (0.3198) acc_x 90.6250 (92.8125) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/23] time 0.354 (0.341) data 0.273 (0.263) loss_x loss_x 0.2505 (0.3135) acc_x 96.8750 (93.1250) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/23] time 0.351 (0.342) data 0.273 (0.264) loss_x loss_x 0.4404 (0.3088) acc_x 90.6250 (93.4375) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [5/27] time 0.342 (0.344) data 0.264 (0.266) loss_u loss_u 0.9438 (0.9631) acc_u 6.2500 (3.1250) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [10/27] time 0.358 (0.345) data 0.280 (0.267) loss_u loss_u 0.9688 (0.9524) acc_u 3.1250 (5.0000) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [15/27] time 0.340 (0.344) data 0.262 (0.266) loss_u loss_u 0.9995 (0.9588) acc_u 0.0000 (4.3750) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [20/27] time 0.376 (0.346) data 0.297 (0.268) loss_u loss_u 0.9629 (0.9591) acc_u 3.1250 (4.2188) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/27] time 0.342 (0.345) data 0.263 (0.267) loss_u loss_u 0.9395 (0.9558) acc_u 6.2500 (5.0000) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 286
confident_label rate tensor(0.4504, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 735
clean true:714
clean false:21
clean_rate:0.9714285714285714
noisy true:632
noisy false:265
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 897
epoch [126/200] batch [5/22] time 0.347 (0.348) data 0.270 (0.271) loss_x loss_x 0.2278 (0.2106) acc_x 96.8750 (97.5000) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/22] time 0.320 (0.343) data 0.243 (0.266) loss_x loss_x 0.6313 (0.2791) acc_x 78.1250 (94.0625) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/22] time 0.338 (0.343) data 0.261 (0.266) loss_x loss_x 0.2991 (0.2865) acc_x 90.6250 (93.1250) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/22] time 0.338 (0.345) data 0.261 (0.268) loss_x loss_x 0.2957 (0.2760) acc_x 90.6250 (93.4375) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/28] time 0.350 (0.346) data 0.273 (0.269) loss_u loss_u 0.8940 (0.9056) acc_u 12.5000 (11.2500) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [10/28] time 0.344 (0.345) data 0.267 (0.268) loss_u loss_u 0.9854 (0.9240) acc_u 0.0000 (9.6875) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [15/28] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.9917 (0.9374) acc_u 0.0000 (7.7083) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [20/28] time 0.321 (0.344) data 0.243 (0.266) loss_u loss_u 0.9106 (0.9397) acc_u 9.3750 (7.3438) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/28] time 0.340 (0.342) data 0.263 (0.265) loss_u loss_u 0.8828 (0.9371) acc_u 15.6250 (7.7500) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4632, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 756
clean true:732
clean false:24
clean_rate:0.9682539682539683
noisy true:637
noisy false:239
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 876
epoch [127/200] batch [5/23] time 0.335 (0.342) data 0.258 (0.264) loss_x loss_x 0.3811 (0.4877) acc_x 84.3750 (85.6250) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [10/23] time 0.347 (0.338) data 0.268 (0.261) loss_x loss_x 0.2742 (0.3713) acc_x 90.6250 (89.6875) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/23] time 0.342 (0.340) data 0.265 (0.263) loss_x loss_x 0.1566 (0.3325) acc_x 96.8750 (91.0417) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/23] time 0.339 (0.342) data 0.262 (0.264) loss_x loss_x 0.2444 (0.3207) acc_x 96.8750 (91.5625) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [5/27] time 0.336 (0.342) data 0.258 (0.264) loss_u loss_u 0.8691 (0.9374) acc_u 15.6250 (7.5000) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [10/27] time 0.358 (0.344) data 0.279 (0.267) loss_u loss_u 0.8682 (0.9390) acc_u 15.6250 (7.1875) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [15/27] time 0.353 (0.345) data 0.274 (0.268) loss_u loss_u 0.9561 (0.9449) acc_u 3.1250 (6.2500) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [20/27] time 0.297 (0.342) data 0.218 (0.264) loss_u loss_u 0.9810 (0.9501) acc_u 0.0000 (5.6250) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/27] time 0.306 (0.337) data 0.227 (0.260) loss_u loss_u 0.9810 (0.9522) acc_u 3.1250 (5.3750) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:722
clean false:22
clean_rate:0.9704301075268817
noisy true:649
noisy false:239
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [128/200] batch [5/23] time 0.350 (0.349) data 0.272 (0.271) loss_x loss_x 0.5508 (0.4030) acc_x 90.6250 (88.7500) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [10/23] time 0.343 (0.348) data 0.265 (0.270) loss_x loss_x 0.4819 (0.3389) acc_x 87.5000 (91.5625) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/23] time 0.341 (0.347) data 0.264 (0.270) loss_x loss_x 0.2495 (0.3294) acc_x 90.6250 (91.8750) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/23] time 0.360 (0.345) data 0.282 (0.268) loss_x loss_x 0.1428 (0.3079) acc_x 96.8750 (92.5000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [5/27] time 0.346 (0.344) data 0.268 (0.266) loss_u loss_u 0.8975 (0.9550) acc_u 9.3750 (5.0000) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [10/27] time 0.365 (0.347) data 0.287 (0.269) loss_u loss_u 0.8750 (0.9473) acc_u 12.5000 (5.9375) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [15/27] time 0.337 (0.347) data 0.258 (0.269) loss_u loss_u 0.9380 (0.9542) acc_u 6.2500 (5.2083) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [20/27] time 0.304 (0.345) data 0.226 (0.267) loss_u loss_u 0.9678 (0.9482) acc_u 3.1250 (5.9375) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/27] time 0.351 (0.342) data 0.272 (0.264) loss_u loss_u 0.8955 (0.9405) acc_u 12.5000 (6.6250) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:731
clean false:22
clean_rate:0.9707835325365206
noisy true:635
noisy false:244
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [129/200] batch [5/23] time 0.348 (0.350) data 0.271 (0.273) loss_x loss_x 0.3816 (0.2834) acc_x 93.7500 (93.7500) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [10/23] time 0.351 (0.349) data 0.273 (0.271) loss_x loss_x 0.3818 (0.3453) acc_x 90.6250 (92.8125) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/23] time 0.346 (0.346) data 0.269 (0.269) loss_x loss_x 0.4592 (0.3813) acc_x 81.2500 (90.8333) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [20/23] time 0.352 (0.347) data 0.274 (0.269) loss_x loss_x 0.1400 (0.3565) acc_x 100.0000 (91.8750) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [5/27] time 0.357 (0.346) data 0.279 (0.268) loss_u loss_u 0.9951 (0.9695) acc_u 0.0000 (3.7500) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [10/27] time 0.341 (0.346) data 0.263 (0.269) loss_u loss_u 0.9678 (0.9563) acc_u 3.1250 (5.0000) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [15/27] time 0.364 (0.346) data 0.286 (0.268) loss_u loss_u 0.9180 (0.9497) acc_u 9.3750 (5.6250) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [20/27] time 0.307 (0.346) data 0.228 (0.268) loss_u loss_u 0.9678 (0.9543) acc_u 3.1250 (5.0000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/27] time 0.328 (0.343) data 0.250 (0.265) loss_u loss_u 0.9102 (0.9522) acc_u 9.3750 (5.2500) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 289
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:718
clean false:24
clean_rate:0.967654986522911
noisy true:625
noisy false:265
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [130/200] batch [5/23] time 0.358 (0.346) data 0.280 (0.268) loss_x loss_x 0.2057 (0.3143) acc_x 96.8750 (92.5000) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [10/23] time 0.345 (0.347) data 0.268 (0.269) loss_x loss_x 0.2361 (0.2985) acc_x 96.8750 (93.4375) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/23] time 0.343 (0.345) data 0.266 (0.268) loss_x loss_x 0.4294 (0.2983) acc_x 84.3750 (92.9167) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [20/23] time 0.345 (0.344) data 0.267 (0.266) loss_x loss_x 0.1406 (0.3223) acc_x 96.8750 (92.6562) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [5/27] time 0.367 (0.344) data 0.289 (0.267) loss_u loss_u 0.9702 (0.9486) acc_u 3.1250 (6.8750) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [10/27] time 0.322 (0.343) data 0.244 (0.266) loss_u loss_u 0.8242 (0.9484) acc_u 18.7500 (6.2500) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [15/27] time 0.328 (0.345) data 0.250 (0.267) loss_u loss_u 0.9629 (0.9389) acc_u 6.2500 (7.0833) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [20/27] time 0.338 (0.345) data 0.260 (0.267) loss_u loss_u 0.9458 (0.9425) acc_u 9.3750 (6.8750) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/27] time 0.309 (0.340) data 0.230 (0.262) loss_u loss_u 0.9321 (0.9447) acc_u 9.3750 (6.6250) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:727
clean false:21
clean_rate:0.9719251336898396
noisy true:637
noisy false:247
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [131/200] batch [5/23] time 0.350 (0.331) data 0.272 (0.254) loss_x loss_x 0.6875 (0.3799) acc_x 78.1250 (90.0000) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [10/23] time 0.361 (0.340) data 0.283 (0.263) loss_x loss_x 0.2458 (0.3263) acc_x 93.7500 (91.8750) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/23] time 0.342 (0.341) data 0.265 (0.264) loss_x loss_x 0.2874 (0.3461) acc_x 96.8750 (92.2917) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/23] time 0.366 (0.343) data 0.289 (0.265) loss_x loss_x 0.5059 (0.3514) acc_x 87.5000 (92.1875) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [5/27] time 0.333 (0.341) data 0.256 (0.263) loss_u loss_u 0.8823 (0.9105) acc_u 12.5000 (11.2500) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [10/27] time 0.355 (0.343) data 0.277 (0.266) loss_u loss_u 0.9141 (0.9367) acc_u 12.5000 (8.1250) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [15/27] time 0.343 (0.344) data 0.264 (0.266) loss_u loss_u 0.9707 (0.9461) acc_u 3.1250 (6.6667) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [20/27] time 0.349 (0.344) data 0.270 (0.267) loss_u loss_u 0.9834 (0.9495) acc_u 0.0000 (6.0938) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/27] time 0.357 (0.345) data 0.278 (0.267) loss_u loss_u 0.9629 (0.9484) acc_u 3.1250 (6.1250) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 292
confident_label rate tensor(0.4479, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 731
clean true:709
clean false:22
clean_rate:0.9699042407660738
noisy true:631
noisy false:270
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 901
epoch [132/200] batch [5/22] time 0.332 (0.347) data 0.254 (0.270) loss_x loss_x 0.5410 (0.2677) acc_x 93.7500 (96.2500) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [10/22] time 0.344 (0.345) data 0.266 (0.268) loss_x loss_x 0.3672 (0.2738) acc_x 84.3750 (94.0625) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/22] time 0.331 (0.340) data 0.254 (0.263) loss_x loss_x 0.2810 (0.3016) acc_x 93.7500 (93.5417) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [20/22] time 0.337 (0.341) data 0.260 (0.264) loss_x loss_x 0.3049 (0.3314) acc_x 96.8750 (92.9688) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/28] time 0.339 (0.343) data 0.259 (0.265) loss_u loss_u 0.9590 (0.9271) acc_u 6.2500 (8.1250) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [10/28] time 0.328 (0.343) data 0.250 (0.265) loss_u loss_u 0.9307 (0.9332) acc_u 9.3750 (7.8125) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [15/28] time 0.346 (0.343) data 0.267 (0.265) loss_u loss_u 0.9438 (0.9258) acc_u 6.2500 (8.9583) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [20/28] time 0.335 (0.343) data 0.257 (0.265) loss_u loss_u 0.9648 (0.9292) acc_u 3.1250 (8.4375) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/28] time 0.287 (0.340) data 0.208 (0.262) loss_u loss_u 0.9541 (0.9275) acc_u 6.2500 (8.7500) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:726
clean false:25
clean_rate:0.966711051930759
noisy true:646
noisy false:235
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [133/200] batch [5/23] time 0.303 (0.311) data 0.225 (0.233) loss_x loss_x 0.2776 (0.2906) acc_x 96.8750 (94.3750) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [10/23] time 0.333 (0.321) data 0.255 (0.243) loss_x loss_x 0.2964 (0.2901) acc_x 90.6250 (93.7500) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/23] time 0.336 (0.329) data 0.257 (0.251) loss_x loss_x 0.3381 (0.2949) acc_x 90.6250 (93.3333) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/23] time 0.344 (0.333) data 0.266 (0.255) loss_x loss_x 0.5400 (0.2970) acc_x 81.2500 (93.1250) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/27] time 0.354 (0.337) data 0.277 (0.260) loss_u loss_u 0.9399 (0.9521) acc_u 9.3750 (6.8750) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [10/27] time 0.361 (0.340) data 0.283 (0.262) loss_u loss_u 0.9180 (0.9362) acc_u 9.3750 (7.8125) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [15/27] time 0.342 (0.341) data 0.264 (0.263) loss_u loss_u 0.8804 (0.9328) acc_u 12.5000 (8.1250) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [20/27] time 0.348 (0.342) data 0.271 (0.264) loss_u loss_u 0.9648 (0.9349) acc_u 3.1250 (7.5000) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/27] time 0.345 (0.341) data 0.267 (0.263) loss_u loss_u 0.9629 (0.9403) acc_u 3.1250 (6.7500) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:729
clean false:25
clean_rate:0.96684350132626
noisy true:632
noisy false:246
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [134/200] batch [5/23] time 0.343 (0.340) data 0.265 (0.263) loss_x loss_x 0.3660 (0.4125) acc_x 90.6250 (90.6250) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [10/23] time 0.342 (0.339) data 0.264 (0.261) loss_x loss_x 0.2056 (0.3229) acc_x 100.0000 (93.7500) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/23] time 0.339 (0.340) data 0.261 (0.262) loss_x loss_x 0.1592 (0.3330) acc_x 96.8750 (93.3333) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/23] time 0.327 (0.340) data 0.249 (0.262) loss_x loss_x 0.3098 (0.3369) acc_x 93.7500 (92.5000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [5/27] time 0.357 (0.341) data 0.280 (0.263) loss_u loss_u 0.9351 (0.9219) acc_u 6.2500 (9.3750) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [10/27] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.9336 (0.9450) acc_u 6.2500 (6.5625) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [15/27] time 0.349 (0.344) data 0.270 (0.266) loss_u loss_u 0.9780 (0.9460) acc_u 3.1250 (6.2500) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [20/27] time 0.352 (0.345) data 0.273 (0.267) loss_u loss_u 0.8779 (0.9392) acc_u 12.5000 (6.7188) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/27] time 0.345 (0.345) data 0.267 (0.267) loss_u loss_u 0.9678 (0.9431) acc_u 3.1250 (6.3750) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:728
clean false:19
clean_rate:0.9745649263721553
noisy true:647
noisy false:238
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [135/200] batch [5/23] time 0.350 (0.369) data 0.272 (0.290) loss_x loss_x 0.7134 (0.3830) acc_x 75.0000 (89.3750) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [10/23] time 0.348 (0.367) data 0.269 (0.288) loss_x loss_x 0.2927 (0.3489) acc_x 90.6250 (90.0000) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/23] time 0.358 (0.369) data 0.280 (0.291) loss_x loss_x 0.1825 (0.3083) acc_x 96.8750 (91.6667) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/23] time 0.365 (0.368) data 0.286 (0.289) loss_x loss_x 0.8784 (0.3337) acc_x 87.5000 (92.0312) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [5/27] time 0.336 (0.364) data 0.257 (0.285) loss_u loss_u 0.9624 (0.9507) acc_u 3.1250 (4.3750) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [10/27] time 0.330 (0.358) data 0.251 (0.280) loss_u loss_u 0.9678 (0.9605) acc_u 3.1250 (3.4375) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [15/27] time 0.360 (0.354) data 0.283 (0.276) loss_u loss_u 0.9409 (0.9494) acc_u 9.3750 (5.2083) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [20/27] time 0.353 (0.354) data 0.276 (0.275) loss_u loss_u 0.8799 (0.9437) acc_u 12.5000 (5.9375) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/27] time 0.299 (0.351) data 0.220 (0.273) loss_u loss_u 0.9922 (0.9437) acc_u 0.0000 (6.1250) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:723
clean false:21
clean_rate:0.9717741935483871
noisy true:652
noisy false:236
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [136/200] batch [5/23] time 0.347 (0.358) data 0.270 (0.280) loss_x loss_x 0.5063 (0.3668) acc_x 90.6250 (90.0000) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [10/23] time 0.346 (0.353) data 0.269 (0.275) loss_x loss_x 0.5098 (0.3969) acc_x 84.3750 (89.3750) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/23] time 0.328 (0.347) data 0.250 (0.269) loss_x loss_x 0.2612 (0.3555) acc_x 93.7500 (90.8333) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/23] time 0.338 (0.347) data 0.261 (0.269) loss_x loss_x 0.2131 (0.3533) acc_x 93.7500 (90.9375) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [5/27] time 0.376 (0.350) data 0.295 (0.271) loss_u loss_u 0.8931 (0.9448) acc_u 9.3750 (5.6250) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [10/27] time 0.337 (0.349) data 0.259 (0.271) loss_u loss_u 0.8115 (0.9265) acc_u 21.8750 (8.1250) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [15/27] time 0.337 (0.349) data 0.260 (0.271) loss_u loss_u 0.8555 (0.9264) acc_u 18.7500 (8.1250) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [20/27] time 0.362 (0.349) data 0.284 (0.271) loss_u loss_u 0.9097 (0.9345) acc_u 12.5000 (7.5000) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/27] time 0.303 (0.347) data 0.224 (0.269) loss_u loss_u 0.9717 (0.9388) acc_u 3.1250 (7.0000) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 240
confident_label rate tensor(0.4638, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 757
clean true:736
clean false:21
clean_rate:0.9722589167767504
noisy true:656
noisy false:219
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 875
epoch [137/200] batch [5/23] time 0.346 (0.339) data 0.269 (0.262) loss_x loss_x 0.2668 (0.3976) acc_x 96.8750 (91.8750) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [10/23] time 0.349 (0.343) data 0.272 (0.266) loss_x loss_x 0.2078 (0.3587) acc_x 96.8750 (92.1875) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/23] time 0.352 (0.345) data 0.274 (0.267) loss_x loss_x 0.2010 (0.3394) acc_x 96.8750 (92.0833) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/23] time 0.341 (0.346) data 0.264 (0.268) loss_x loss_x 0.3059 (0.3286) acc_x 90.6250 (92.1875) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [5/27] time 0.342 (0.346) data 0.265 (0.269) loss_u loss_u 0.9155 (0.9336) acc_u 12.5000 (8.1250) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [10/27] time 0.340 (0.345) data 0.262 (0.268) loss_u loss_u 0.9180 (0.9399) acc_u 9.3750 (7.1875) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [15/27] time 0.305 (0.342) data 0.227 (0.264) loss_u loss_u 0.9980 (0.9479) acc_u 0.0000 (6.0417) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [20/27] time 0.351 (0.341) data 0.272 (0.263) loss_u loss_u 0.9937 (0.9525) acc_u 0.0000 (5.4688) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/27] time 0.312 (0.340) data 0.234 (0.263) loss_u loss_u 0.9644 (0.9537) acc_u 3.1250 (5.3750) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:726
clean false:20
clean_rate:0.9731903485254692
noisy true:630
noisy false:256
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [138/200] batch [5/23] time 0.351 (0.354) data 0.273 (0.276) loss_x loss_x 0.1558 (0.2356) acc_x 96.8750 (96.2500) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [10/23] time 0.326 (0.345) data 0.249 (0.267) loss_x loss_x 0.4507 (0.2479) acc_x 87.5000 (95.3125) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/23] time 0.353 (0.345) data 0.276 (0.267) loss_x loss_x 0.1407 (0.3115) acc_x 100.0000 (93.9583) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [20/23] time 0.353 (0.344) data 0.275 (0.267) loss_x loss_x 0.2715 (0.2919) acc_x 90.6250 (94.0625) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [5/27] time 0.337 (0.341) data 0.259 (0.264) loss_u loss_u 0.9512 (0.9571) acc_u 3.1250 (5.6250) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [10/27] time 0.359 (0.342) data 0.280 (0.265) loss_u loss_u 0.8789 (0.9455) acc_u 12.5000 (6.2500) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [15/27] time 0.354 (0.342) data 0.276 (0.265) loss_u loss_u 0.9658 (0.9357) acc_u 3.1250 (7.5000) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [20/27] time 0.335 (0.343) data 0.258 (0.265) loss_u loss_u 0.8877 (0.9388) acc_u 12.5000 (7.0312) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/27] time 0.298 (0.342) data 0.219 (0.264) loss_u loss_u 0.9819 (0.9421) acc_u 3.1250 (6.6250) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4638, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 757
clean true:738
clean false:19
clean_rate:0.9749009247027741
noisy true:632
noisy false:243
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 875
epoch [139/200] batch [5/23] time 0.354 (0.360) data 0.277 (0.283) loss_x loss_x 0.2194 (0.2822) acc_x 93.7500 (92.5000) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [10/23] time 0.341 (0.354) data 0.263 (0.277) loss_x loss_x 0.2144 (0.2543) acc_x 96.8750 (95.0000) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/23] time 0.347 (0.353) data 0.269 (0.276) loss_x loss_x 0.1952 (0.2755) acc_x 100.0000 (94.1667) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/23] time 0.338 (0.351) data 0.261 (0.274) loss_x loss_x 0.2389 (0.2917) acc_x 96.8750 (93.9062) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [5/27] time 0.337 (0.349) data 0.259 (0.271) loss_u loss_u 0.9395 (0.9503) acc_u 6.2500 (5.6250) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [10/27] time 0.346 (0.349) data 0.268 (0.271) loss_u loss_u 0.9722 (0.9526) acc_u 3.1250 (5.6250) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [15/27] time 0.339 (0.347) data 0.259 (0.269) loss_u loss_u 0.9556 (0.9548) acc_u 6.2500 (5.2083) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [20/27] time 0.336 (0.343) data 0.257 (0.265) loss_u loss_u 0.9097 (0.9554) acc_u 9.3750 (5.1562) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/27] time 0.343 (0.341) data 0.265 (0.263) loss_u loss_u 0.9292 (0.9548) acc_u 6.2500 (5.1250) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:729
clean false:25
clean_rate:0.96684350132626
noisy true:642
noisy false:236
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [140/200] batch [5/23] time 0.339 (0.311) data 0.262 (0.233) loss_x loss_x 0.1207 (0.3015) acc_x 100.0000 (95.0000) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/23] time 0.341 (0.328) data 0.264 (0.250) loss_x loss_x 0.3718 (0.3059) acc_x 87.5000 (94.0625) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/23] time 0.337 (0.332) data 0.260 (0.255) loss_x loss_x 0.6987 (0.3442) acc_x 84.3750 (92.5000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/23] time 0.335 (0.333) data 0.258 (0.255) loss_x loss_x 0.3560 (0.3106) acc_x 93.7500 (93.7500) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/27] time 0.351 (0.334) data 0.273 (0.257) loss_u loss_u 0.9160 (0.9344) acc_u 9.3750 (7.5000) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [10/27] time 0.343 (0.337) data 0.266 (0.260) loss_u loss_u 0.9336 (0.9387) acc_u 6.2500 (6.5625) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [15/27] time 0.344 (0.338) data 0.266 (0.261) loss_u loss_u 0.9365 (0.9318) acc_u 6.2500 (7.0833) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [20/27] time 0.354 (0.340) data 0.276 (0.262) loss_u loss_u 0.9805 (0.9392) acc_u 3.1250 (6.4062) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/27] time 0.458 (0.349) data 0.375 (0.271) loss_u loss_u 0.9438 (0.9394) acc_u 6.2500 (6.5000) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:727
clean false:24
clean_rate:0.9680426098535286
noisy true:638
noisy false:243
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [141/200] batch [5/23] time 0.347 (0.319) data 0.269 (0.241) loss_x loss_x 0.3867 (0.3611) acc_x 90.6250 (92.5000) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/23] time 0.343 (0.338) data 0.266 (0.260) loss_x loss_x 0.2402 (0.3191) acc_x 93.7500 (92.8125) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/23] time 0.349 (0.339) data 0.271 (0.262) loss_x loss_x 0.1926 (0.3022) acc_x 93.7500 (93.3333) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [20/23] time 0.330 (0.340) data 0.252 (0.263) loss_x loss_x 0.2507 (0.2949) acc_x 96.8750 (93.9062) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [5/27] time 0.346 (0.341) data 0.268 (0.264) loss_u loss_u 0.9658 (0.9684) acc_u 6.2500 (3.7500) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [10/27] time 0.347 (0.342) data 0.269 (0.264) loss_u loss_u 0.9790 (0.9560) acc_u 3.1250 (5.0000) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [15/27] time 0.340 (0.342) data 0.262 (0.265) loss_u loss_u 0.9639 (0.9491) acc_u 3.1250 (5.6250) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [20/27] time 0.341 (0.342) data 0.264 (0.264) loss_u loss_u 0.9458 (0.9484) acc_u 6.2500 (5.6250) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/27] time 0.336 (0.344) data 0.258 (0.266) loss_u loss_u 0.9248 (0.9470) acc_u 6.2500 (5.7500) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.4596, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 750
clean true:726
clean false:24
clean_rate:0.968
noisy true:639
noisy false:243
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 882
epoch [142/200] batch [5/23] time 0.336 (0.346) data 0.259 (0.268) loss_x loss_x 0.5386 (0.3819) acc_x 87.5000 (91.8750) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [10/23] time 0.347 (0.346) data 0.269 (0.268) loss_x loss_x 0.3347 (0.3447) acc_x 93.7500 (91.8750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/23] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.3308 (0.3491) acc_x 93.7500 (91.6667) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [20/23] time 0.335 (0.343) data 0.258 (0.266) loss_x loss_x 0.2385 (0.3267) acc_x 90.6250 (92.1875) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [5/27] time 0.338 (0.343) data 0.261 (0.266) loss_u loss_u 0.9395 (0.9380) acc_u 6.2500 (6.8750) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [10/27] time 0.344 (0.344) data 0.266 (0.266) loss_u loss_u 0.9556 (0.9292) acc_u 6.2500 (8.1250) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [15/27] time 0.352 (0.344) data 0.274 (0.266) loss_u loss_u 0.8574 (0.9328) acc_u 15.6250 (7.2917) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [20/27] time 0.349 (0.344) data 0.271 (0.266) loss_u loss_u 0.9697 (0.9380) acc_u 3.1250 (6.8750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/27] time 0.344 (0.344) data 0.265 (0.266) loss_u loss_u 0.9634 (0.9371) acc_u 3.1250 (6.8750) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:726
clean false:26
clean_rate:0.9654255319148937
noisy true:643
noisy false:237
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [143/200] batch [5/23] time 0.343 (0.322) data 0.265 (0.244) loss_x loss_x 0.3625 (0.3241) acc_x 96.8750 (94.3750) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [10/23] time 0.338 (0.332) data 0.260 (0.254) loss_x loss_x 0.3323 (0.3395) acc_x 90.6250 (93.7500) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/23] time 0.343 (0.336) data 0.265 (0.259) loss_x loss_x 0.2500 (0.3120) acc_x 93.7500 (93.7500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/23] time 0.351 (0.338) data 0.274 (0.260) loss_x loss_x 0.2764 (0.3201) acc_x 96.8750 (92.8125) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [5/27] time 0.341 (0.341) data 0.262 (0.263) loss_u loss_u 0.9648 (0.9406) acc_u 6.2500 (7.5000) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [10/27] time 0.350 (0.342) data 0.272 (0.264) loss_u loss_u 0.9619 (0.9345) acc_u 3.1250 (8.1250) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [15/27] time 0.333 (0.343) data 0.255 (0.265) loss_u loss_u 0.9648 (0.9356) acc_u 3.1250 (7.9167) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [20/27] time 0.343 (0.342) data 0.265 (0.264) loss_u loss_u 0.9072 (0.9376) acc_u 9.3750 (7.3438) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/27] time 0.349 (0.342) data 0.272 (0.264) loss_u loss_u 0.9272 (0.9390) acc_u 9.3750 (7.1250) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 273
confident_label rate tensor(0.4651, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 759
clean true:733
clean false:26
clean_rate:0.9657444005270093
noisy true:626
noisy false:247
after delete: len(clean_dataset) 759
after delete: len(noisy_dataset) 873
epoch [144/200] batch [5/23] time 0.291 (0.302) data 0.212 (0.224) loss_x loss_x 0.2839 (0.1719) acc_x 93.7500 (97.5000) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [10/23] time 0.349 (0.317) data 0.272 (0.239) loss_x loss_x 0.1157 (0.2198) acc_x 100.0000 (96.2500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/23] time 0.326 (0.324) data 0.249 (0.246) loss_x loss_x 0.5752 (0.2675) acc_x 87.5000 (94.7917) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/23] time 0.333 (0.328) data 0.256 (0.250) loss_x loss_x 0.2722 (0.2735) acc_x 93.7500 (93.9062) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/27] time 0.334 (0.332) data 0.256 (0.254) loss_u loss_u 0.9790 (0.9489) acc_u 3.1250 (6.2500) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [10/27] time 0.330 (0.332) data 0.252 (0.254) loss_u loss_u 0.9976 (0.9485) acc_u 0.0000 (6.5625) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [15/27] time 0.343 (0.334) data 0.263 (0.256) loss_u loss_u 0.9409 (0.9512) acc_u 6.2500 (6.2500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [20/27] time 0.342 (0.335) data 0.264 (0.257) loss_u loss_u 0.8750 (0.9473) acc_u 12.5000 (6.4062) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/27] time 0.343 (0.336) data 0.265 (0.258) loss_u loss_u 0.9517 (0.9487) acc_u 6.2500 (6.2500) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.4663, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 761
clean true:738
clean false:23
clean_rate:0.9697766097240473
noisy true:643
noisy false:228
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 871
epoch [145/200] batch [5/23] time 0.298 (0.324) data 0.220 (0.247) loss_x loss_x 0.5752 (0.4649) acc_x 84.3750 (88.7500) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [10/23] time 0.351 (0.324) data 0.274 (0.246) loss_x loss_x 0.2756 (0.3536) acc_x 96.8750 (92.1875) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/23] time 0.347 (0.331) data 0.270 (0.253) loss_x loss_x 0.4998 (0.3395) acc_x 87.5000 (92.2917) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/23] time 0.351 (0.337) data 0.274 (0.259) loss_x loss_x 0.1759 (0.3208) acc_x 96.8750 (92.9688) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [5/27] time 0.349 (0.339) data 0.271 (0.262) loss_u loss_u 0.9448 (0.9595) acc_u 6.2500 (4.3750) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [10/27] time 0.354 (0.340) data 0.274 (0.262) loss_u loss_u 0.9712 (0.9571) acc_u 3.1250 (5.0000) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [15/27] time 0.349 (0.342) data 0.270 (0.264) loss_u loss_u 0.9995 (0.9575) acc_u 0.0000 (4.7917) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [20/27] time 0.332 (0.342) data 0.254 (0.264) loss_u loss_u 0.9912 (0.9579) acc_u 0.0000 (4.5312) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/27] time 0.349 (0.342) data 0.271 (0.265) loss_u loss_u 0.9731 (0.9595) acc_u 3.1250 (4.5000) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:728
clean false:23
clean_rate:0.9693741677762983
noisy true:635
noisy false:246
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [146/200] batch [5/23] time 0.346 (0.329) data 0.268 (0.251) loss_x loss_x 0.1937 (0.3050) acc_x 96.8750 (93.7500) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [10/23] time 0.355 (0.331) data 0.278 (0.253) loss_x loss_x 0.3230 (0.2966) acc_x 93.7500 (94.0625) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/23] time 0.379 (0.337) data 0.302 (0.259) loss_x loss_x 0.1307 (0.2716) acc_x 100.0000 (95.0000) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/23] time 0.350 (0.338) data 0.273 (0.260) loss_x loss_x 0.1578 (0.2811) acc_x 96.8750 (94.5312) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [5/27] time 0.348 (0.342) data 0.270 (0.264) loss_u loss_u 0.9160 (0.9309) acc_u 9.3750 (8.1250) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [10/27] time 0.351 (0.343) data 0.273 (0.265) loss_u loss_u 0.9580 (0.9281) acc_u 6.2500 (8.4375) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [15/27] time 0.336 (0.343) data 0.259 (0.265) loss_u loss_u 0.9897 (0.9306) acc_u 0.0000 (7.7083) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [20/27] time 0.355 (0.343) data 0.277 (0.265) loss_u loss_u 0.9839 (0.9369) acc_u 3.1250 (7.0312) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/27] time 0.340 (0.343) data 0.261 (0.266) loss_u loss_u 0.9580 (0.9409) acc_u 3.1250 (6.6250) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4706, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 768
clean true:741
clean false:27
clean_rate:0.96484375
noisy true:629
noisy false:235
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 864
epoch [147/200] batch [5/24] time 0.351 (0.338) data 0.273 (0.260) loss_x loss_x 0.2014 (0.3188) acc_x 96.8750 (92.5000) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [10/24] time 0.320 (0.328) data 0.242 (0.250) loss_x loss_x 0.2915 (0.3298) acc_x 90.6250 (91.5625) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/24] time 0.367 (0.336) data 0.288 (0.258) loss_x loss_x 0.3110 (0.2953) acc_x 93.7500 (92.9167) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/24] time 0.344 (0.340) data 0.267 (0.262) loss_x loss_x 0.5405 (0.3357) acc_x 84.3750 (92.1875) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [5/27] time 0.345 (0.341) data 0.267 (0.263) loss_u loss_u 0.9360 (0.9454) acc_u 6.2500 (6.2500) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [10/27] time 0.347 (0.342) data 0.270 (0.264) loss_u loss_u 0.9741 (0.9633) acc_u 3.1250 (4.0625) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [15/27] time 0.376 (0.342) data 0.298 (0.265) loss_u loss_u 0.9727 (0.9544) acc_u 3.1250 (5.0000) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [20/27] time 0.328 (0.343) data 0.250 (0.265) loss_u loss_u 0.9897 (0.9528) acc_u 3.1250 (5.3125) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/27] time 0.338 (0.343) data 0.260 (0.265) loss_u loss_u 0.9688 (0.9523) acc_u 6.2500 (5.5000) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:728
clean false:24
clean_rate:0.9680851063829787
noisy true:642
noisy false:238
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [148/200] batch [5/23] time 0.334 (0.327) data 0.257 (0.250) loss_x loss_x 0.1840 (0.2857) acc_x 96.8750 (94.3750) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [10/23] time 0.347 (0.337) data 0.270 (0.260) loss_x loss_x 0.3867 (0.3197) acc_x 90.6250 (93.4375) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/23] time 0.356 (0.340) data 0.278 (0.263) loss_x loss_x 0.2119 (0.3179) acc_x 100.0000 (93.9583) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/23] time 0.373 (0.343) data 0.295 (0.265) loss_x loss_x 0.1378 (0.3257) acc_x 100.0000 (93.7500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [5/27] time 0.344 (0.344) data 0.266 (0.266) loss_u loss_u 0.9414 (0.9432) acc_u 9.3750 (6.8750) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [10/27] time 0.341 (0.345) data 0.263 (0.267) loss_u loss_u 0.9731 (0.9517) acc_u 3.1250 (5.6250) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [15/27] time 0.370 (0.345) data 0.291 (0.268) loss_u loss_u 0.9497 (0.9497) acc_u 9.3750 (6.0417) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [20/27] time 0.339 (0.345) data 0.261 (0.267) loss_u loss_u 0.9346 (0.9465) acc_u 9.3750 (6.4062) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/27] time 0.340 (0.345) data 0.261 (0.267) loss_u loss_u 0.9155 (0.9454) acc_u 9.3750 (6.5000) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 279
confident_label rate tensor(0.4626, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 755
clean true:730
clean false:25
clean_rate:0.9668874172185431
noisy true:623
noisy false:254
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 877
epoch [149/200] batch [5/23] time 0.346 (0.341) data 0.268 (0.263) loss_x loss_x 0.6880 (0.4120) acc_x 81.2500 (88.7500) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [10/23] time 0.340 (0.342) data 0.262 (0.264) loss_x loss_x 0.3733 (0.3833) acc_x 90.6250 (89.3750) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/23] time 0.345 (0.342) data 0.267 (0.265) loss_x loss_x 0.2690 (0.3267) acc_x 96.8750 (91.8750) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/23] time 0.345 (0.343) data 0.268 (0.265) loss_x loss_x 0.1819 (0.3113) acc_x 96.8750 (92.3438) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [5/27] time 0.331 (0.342) data 0.253 (0.265) loss_u loss_u 0.9023 (0.9290) acc_u 12.5000 (8.7500) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [10/27] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.9985 (0.9356) acc_u 0.0000 (7.5000) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [15/27] time 0.352 (0.343) data 0.273 (0.265) loss_u loss_u 0.9419 (0.9371) acc_u 6.2500 (7.0833) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [20/27] time 0.352 (0.344) data 0.274 (0.266) loss_u loss_u 0.9414 (0.9410) acc_u 6.2500 (6.8750) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/27] time 0.298 (0.341) data 0.220 (0.263) loss_u loss_u 0.9702 (0.9414) acc_u 3.1250 (6.6250) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4638, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 757
clean true:735
clean false:22
clean_rate:0.9709379128137384
noisy true:634
noisy false:241
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 875
epoch [150/200] batch [5/23] time 0.351 (0.324) data 0.274 (0.246) loss_x loss_x 0.1248 (0.2089) acc_x 100.0000 (96.8750) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/23] time 0.343 (0.336) data 0.265 (0.259) loss_x loss_x 0.2133 (0.2479) acc_x 96.8750 (95.3125) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/23] time 0.362 (0.341) data 0.284 (0.264) loss_x loss_x 0.1763 (0.2540) acc_x 100.0000 (95.0000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [20/23] time 0.361 (0.344) data 0.283 (0.267) loss_x loss_x 0.0637 (0.2475) acc_x 100.0000 (94.6875) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [5/27] time 0.354 (0.350) data 0.277 (0.272) loss_u loss_u 0.9980 (0.9569) acc_u 0.0000 (5.6250) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [10/27] time 0.342 (0.349) data 0.264 (0.271) loss_u loss_u 0.9224 (0.9485) acc_u 9.3750 (6.2500) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [15/27] time 0.342 (0.348) data 0.265 (0.271) loss_u loss_u 0.9180 (0.9459) acc_u 9.3750 (6.4583) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [20/27] time 0.329 (0.347) data 0.250 (0.270) loss_u loss_u 0.8770 (0.9411) acc_u 12.5000 (6.7188) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/27] time 0.321 (0.346) data 0.244 (0.269) loss_u loss_u 0.9712 (0.9426) acc_u 3.1250 (6.6250) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4632, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 756
clean true:730
clean false:26
clean_rate:0.9656084656084656
noisy true:643
noisy false:233
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 876
epoch [151/200] batch [5/23] time 0.344 (0.317) data 0.267 (0.240) loss_x loss_x 0.2186 (0.2115) acc_x 96.8750 (95.6250) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [10/23] time 0.340 (0.334) data 0.262 (0.256) loss_x loss_x 0.0869 (0.2183) acc_x 100.0000 (95.9375) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/23] time 0.347 (0.338) data 0.269 (0.260) loss_x loss_x 0.2325 (0.2481) acc_x 96.8750 (94.7917) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/23] time 0.338 (0.339) data 0.261 (0.261) loss_x loss_x 0.1792 (0.2642) acc_x 93.7500 (94.0625) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [5/27] time 0.386 (0.342) data 0.308 (0.264) loss_u loss_u 0.9678 (0.9559) acc_u 6.2500 (5.6250) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [10/27] time 0.353 (0.343) data 0.275 (0.266) loss_u loss_u 0.8872 (0.9461) acc_u 12.5000 (6.2500) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [15/27] time 0.366 (0.345) data 0.288 (0.267) loss_u loss_u 0.9648 (0.9494) acc_u 3.1250 (5.8333) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [20/27] time 0.345 (0.345) data 0.268 (0.267) loss_u loss_u 0.9678 (0.9499) acc_u 3.1250 (5.6250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/27] time 0.359 (0.345) data 0.281 (0.267) loss_u loss_u 0.9712 (0.9515) acc_u 3.1250 (5.3750) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:728
clean false:24
clean_rate:0.9680851063829787
noisy true:635
noisy false:245
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [152/200] batch [5/23] time 0.296 (0.321) data 0.218 (0.243) loss_x loss_x 0.5513 (0.3945) acc_x 87.5000 (88.7500) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [10/23] time 0.338 (0.334) data 0.260 (0.256) loss_x loss_x 0.4424 (0.3065) acc_x 81.2500 (91.2500) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/23] time 0.333 (0.335) data 0.255 (0.257) loss_x loss_x 0.3572 (0.3197) acc_x 90.6250 (91.6667) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/23] time 0.342 (0.338) data 0.264 (0.261) loss_x loss_x 0.1735 (0.3057) acc_x 96.8750 (92.0312) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [5/27] time 0.347 (0.341) data 0.268 (0.263) loss_u loss_u 0.9502 (0.9244) acc_u 6.2500 (9.3750) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [10/27] time 0.334 (0.341) data 0.256 (0.263) loss_u loss_u 0.8979 (0.9357) acc_u 12.5000 (8.1250) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [15/27] time 0.340 (0.342) data 0.261 (0.264) loss_u loss_u 0.9419 (0.9359) acc_u 9.3750 (7.9167) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [20/27] time 0.337 (0.342) data 0.259 (0.264) loss_u loss_u 0.8994 (0.9373) acc_u 12.5000 (7.6562) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/27] time 0.338 (0.343) data 0.260 (0.265) loss_u loss_u 0.9688 (0.9386) acc_u 3.1250 (7.3750) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:722
clean false:25
clean_rate:0.9665327978580991
noisy true:641
noisy false:244
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [153/200] batch [5/23] time 0.294 (0.322) data 0.217 (0.245) loss_x loss_x 0.3716 (0.3249) acc_x 90.6250 (93.1250) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [10/23] time 0.348 (0.332) data 0.270 (0.254) loss_x loss_x 0.2798 (0.2984) acc_x 96.8750 (94.3750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/23] time 0.357 (0.337) data 0.280 (0.259) loss_x loss_x 0.3289 (0.3388) acc_x 93.7500 (92.5000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/23] time 0.343 (0.338) data 0.266 (0.261) loss_x loss_x 0.2822 (0.3220) acc_x 96.8750 (93.4375) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [5/27] time 0.342 (0.340) data 0.264 (0.263) loss_u loss_u 0.9141 (0.9486) acc_u 12.5000 (6.2500) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [10/27] time 0.352 (0.342) data 0.274 (0.265) loss_u loss_u 0.8789 (0.9487) acc_u 12.5000 (5.6250) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [15/27] time 0.345 (0.343) data 0.267 (0.265) loss_u loss_u 0.9082 (0.9461) acc_u 9.3750 (5.8333) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [20/27] time 0.345 (0.343) data 0.267 (0.266) loss_u loss_u 0.9155 (0.9436) acc_u 12.5000 (6.0938) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/27] time 0.343 (0.344) data 0.266 (0.266) loss_u loss_u 0.9229 (0.9405) acc_u 9.3750 (6.5000) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 758
clean true:733
clean false:25
clean_rate:0.9670184696569921
noisy true:639
noisy false:235
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 874
epoch [154/200] batch [5/23] time 0.296 (0.327) data 0.219 (0.250) loss_x loss_x 0.3210 (0.3466) acc_x 96.8750 (91.8750) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [10/23] time 0.337 (0.316) data 0.260 (0.238) loss_x loss_x 0.2456 (0.3554) acc_x 93.7500 (91.2500) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/23] time 0.337 (0.323) data 0.259 (0.245) loss_x loss_x 0.4802 (0.3874) acc_x 93.7500 (91.0417) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/23] time 0.345 (0.329) data 0.267 (0.251) loss_x loss_x 0.3013 (0.3712) acc_x 93.7500 (91.5625) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/27] time 0.351 (0.334) data 0.274 (0.256) loss_u loss_u 0.9673 (0.9300) acc_u 3.1250 (8.1250) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [10/27] time 0.343 (0.336) data 0.265 (0.258) loss_u loss_u 0.9673 (0.9319) acc_u 3.1250 (8.1250) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [15/27] time 0.353 (0.338) data 0.276 (0.260) loss_u loss_u 0.9639 (0.9330) acc_u 3.1250 (7.5000) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [20/27] time 0.352 (0.339) data 0.275 (0.261) loss_u loss_u 0.9873 (0.9385) acc_u 0.0000 (7.0312) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/27] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9683 (0.9427) acc_u 3.1250 (6.5000) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.4657, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 760
clean true:736
clean false:24
clean_rate:0.968421052631579
noisy true:649
noisy false:223
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 872
epoch [155/200] batch [5/23] time 0.344 (0.343) data 0.266 (0.264) loss_x loss_x 0.2793 (0.2406) acc_x 93.7500 (94.3750) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [10/23] time 0.338 (0.341) data 0.260 (0.263) loss_x loss_x 0.5361 (0.3115) acc_x 93.7500 (93.4375) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/23] time 0.349 (0.344) data 0.271 (0.266) loss_x loss_x 0.1505 (0.3000) acc_x 96.8750 (92.9167) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [20/23] time 0.346 (0.344) data 0.268 (0.266) loss_x loss_x 0.4958 (0.3033) acc_x 87.5000 (92.5000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [5/27] time 0.345 (0.347) data 0.267 (0.269) loss_u loss_u 0.9629 (0.9586) acc_u 3.1250 (4.3750) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [10/27] time 0.349 (0.347) data 0.271 (0.269) loss_u loss_u 0.9546 (0.9382) acc_u 3.1250 (6.8750) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [15/27] time 0.346 (0.347) data 0.269 (0.269) loss_u loss_u 0.9961 (0.9399) acc_u 0.0000 (7.0833) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [20/27] time 0.340 (0.346) data 0.261 (0.268) loss_u loss_u 0.9072 (0.9402) acc_u 9.3750 (6.8750) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/27] time 0.296 (0.343) data 0.218 (0.265) loss_u loss_u 0.9824 (0.9423) acc_u 3.1250 (6.6250) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:730
clean false:24
clean_rate:0.9681697612732095
noisy true:638
noisy false:240
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [156/200] batch [5/23] time 0.338 (0.323) data 0.260 (0.245) loss_x loss_x 0.2274 (0.2815) acc_x 93.7500 (93.7500) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/23] time 0.337 (0.332) data 0.260 (0.255) loss_x loss_x 0.1766 (0.2846) acc_x 96.8750 (94.3750) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/23] time 0.335 (0.337) data 0.258 (0.259) loss_x loss_x 0.2490 (0.2655) acc_x 90.6250 (93.5417) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/23] time 0.351 (0.340) data 0.274 (0.263) loss_x loss_x 0.2203 (0.2482) acc_x 96.8750 (94.2188) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [5/27] time 0.348 (0.342) data 0.271 (0.264) loss_u loss_u 0.9971 (0.9776) acc_u 0.0000 (1.8750) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [10/27] time 0.348 (0.342) data 0.271 (0.265) loss_u loss_u 0.9678 (0.9660) acc_u 3.1250 (3.1250) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [15/27] time 0.356 (0.344) data 0.278 (0.266) loss_u loss_u 0.8242 (0.9473) acc_u 21.8750 (5.6250) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [20/27] time 0.300 (0.343) data 0.223 (0.265) loss_u loss_u 0.9160 (0.9406) acc_u 12.5000 (6.5625) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/27] time 0.345 (0.340) data 0.267 (0.263) loss_u loss_u 0.9575 (0.9463) acc_u 6.2500 (6.0000) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.4626, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 755
clean true:733
clean false:22
clean_rate:0.9708609271523179
noisy true:635
noisy false:242
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 877
epoch [157/200] batch [5/23] time 0.345 (0.326) data 0.268 (0.248) loss_x loss_x 0.2664 (0.2504) acc_x 96.8750 (95.6250) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/23] time 0.339 (0.339) data 0.261 (0.261) loss_x loss_x 0.2917 (0.2761) acc_x 90.6250 (94.3750) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/23] time 0.339 (0.341) data 0.262 (0.263) loss_x loss_x 0.3101 (0.2774) acc_x 90.6250 (93.7500) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/23] time 0.346 (0.341) data 0.269 (0.263) loss_x loss_x 0.3357 (0.2812) acc_x 90.6250 (93.9062) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [5/27] time 0.332 (0.340) data 0.254 (0.263) loss_u loss_u 0.9355 (0.9429) acc_u 6.2500 (6.8750) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [10/27] time 0.348 (0.342) data 0.270 (0.264) loss_u loss_u 0.9512 (0.9391) acc_u 6.2500 (7.1875) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [15/27] time 0.350 (0.342) data 0.273 (0.264) loss_u loss_u 0.9771 (0.9380) acc_u 3.1250 (7.2917) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [20/27] time 0.327 (0.342) data 0.249 (0.264) loss_u loss_u 0.9185 (0.9335) acc_u 9.3750 (7.6562) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/27] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.9580 (0.9383) acc_u 6.2500 (7.0000) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:731
clean false:21
clean_rate:0.9720744680851063
noisy true:652
noisy false:228
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [158/200] batch [5/23] time 0.346 (0.324) data 0.269 (0.246) loss_x loss_x 0.2180 (0.2568) acc_x 96.8750 (94.3750) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/23] time 0.343 (0.335) data 0.266 (0.257) loss_x loss_x 0.2079 (0.2707) acc_x 96.8750 (94.0625) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/23] time 0.340 (0.338) data 0.262 (0.260) loss_x loss_x 0.2266 (0.2700) acc_x 93.7500 (94.5833) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/23] time 0.336 (0.339) data 0.259 (0.262) loss_x loss_x 0.3389 (0.2945) acc_x 93.7500 (93.7500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [5/27] time 0.338 (0.341) data 0.260 (0.263) loss_u loss_u 0.9507 (0.9423) acc_u 6.2500 (6.8750) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [10/27] time 0.355 (0.342) data 0.276 (0.265) loss_u loss_u 0.9165 (0.9384) acc_u 9.3750 (7.1875) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [15/27] time 0.349 (0.343) data 0.269 (0.265) loss_u loss_u 0.9331 (0.9454) acc_u 9.3750 (6.2500) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [20/27] time 0.346 (0.344) data 0.268 (0.266) loss_u loss_u 0.9448 (0.9435) acc_u 6.2500 (6.4062) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/27] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.8325 (0.9415) acc_u 21.8750 (6.8750) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:722
clean false:23
clean_rate:0.9691275167785235
noisy true:645
noisy false:242
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [159/200] batch [5/23] time 0.345 (0.348) data 0.268 (0.270) loss_x loss_x 0.7266 (0.3264) acc_x 84.3750 (94.3750) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [10/23] time 0.345 (0.350) data 0.268 (0.272) loss_x loss_x 0.2488 (0.3104) acc_x 93.7500 (93.7500) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/23] time 0.346 (0.348) data 0.268 (0.270) loss_x loss_x 0.0960 (0.3050) acc_x 100.0000 (93.5417) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/23] time 0.345 (0.349) data 0.267 (0.271) loss_x loss_x 0.3643 (0.3035) acc_x 90.6250 (93.5938) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [5/27] time 0.351 (0.349) data 0.273 (0.271) loss_u loss_u 0.9355 (0.9232) acc_u 6.2500 (8.7500) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [10/27] time 0.340 (0.348) data 0.262 (0.270) loss_u loss_u 0.7783 (0.9230) acc_u 25.0000 (8.7500) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [15/27] time 0.348 (0.348) data 0.270 (0.270) loss_u loss_u 0.8901 (0.9297) acc_u 9.3750 (7.9167) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [20/27] time 0.318 (0.346) data 0.240 (0.268) loss_u loss_u 0.8735 (0.9314) acc_u 15.6250 (7.6562) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/27] time 0.301 (0.345) data 0.223 (0.267) loss_u loss_u 0.9868 (0.9383) acc_u 3.1250 (7.1250) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:733
clean false:20
clean_rate:0.9734395750332006
noisy true:665
noisy false:214
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [160/200] batch [5/23] time 0.357 (0.341) data 0.280 (0.264) loss_x loss_x 0.2510 (0.2631) acc_x 93.7500 (93.1250) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [10/23] time 0.348 (0.344) data 0.271 (0.266) loss_x loss_x 0.2197 (0.2912) acc_x 93.7500 (92.8125) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/23] time 0.349 (0.344) data 0.272 (0.266) loss_x loss_x 0.2888 (0.3289) acc_x 93.7500 (91.8750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/23] time 0.342 (0.345) data 0.265 (0.268) loss_x loss_x 0.1572 (0.3114) acc_x 100.0000 (93.2812) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [5/27] time 0.360 (0.347) data 0.281 (0.269) loss_u loss_u 0.9883 (0.9636) acc_u 0.0000 (3.7500) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [10/27] time 0.340 (0.347) data 0.262 (0.270) loss_u loss_u 0.9253 (0.9418) acc_u 9.3750 (6.2500) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [15/27] time 0.341 (0.347) data 0.263 (0.269) loss_u loss_u 0.9980 (0.9449) acc_u 0.0000 (6.0417) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [20/27] time 0.341 (0.347) data 0.263 (0.269) loss_u loss_u 0.9531 (0.9450) acc_u 6.2500 (5.9375) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/27] time 0.342 (0.347) data 0.263 (0.269) loss_u loss_u 0.9175 (0.9411) acc_u 9.3750 (6.3750) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.4737, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 773
clean true:748
clean false:25
clean_rate:0.9676584734799483
noisy true:640
noisy false:219
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 859
epoch [161/200] batch [5/24] time 0.333 (0.349) data 0.255 (0.272) loss_x loss_x 0.2847 (0.3207) acc_x 96.8750 (92.5000) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [10/24] time 0.342 (0.349) data 0.264 (0.272) loss_x loss_x 0.2634 (0.2937) acc_x 100.0000 (93.7500) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/24] time 0.346 (0.349) data 0.268 (0.271) loss_x loss_x 0.6763 (0.3306) acc_x 87.5000 (92.2917) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/24] time 0.341 (0.347) data 0.264 (0.270) loss_x loss_x 0.5200 (0.3118) acc_x 78.1250 (92.5000) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [5/26] time 0.344 (0.345) data 0.266 (0.268) loss_u loss_u 0.9741 (0.9692) acc_u 3.1250 (3.7500) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [10/26] time 0.348 (0.345) data 0.270 (0.268) loss_u loss_u 0.9624 (0.9659) acc_u 3.1250 (4.0625) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [15/26] time 0.347 (0.345) data 0.269 (0.267) loss_u loss_u 0.9429 (0.9535) acc_u 6.2500 (5.6250) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/26] time 0.342 (0.345) data 0.264 (0.267) loss_u loss_u 0.9360 (0.9548) acc_u 9.3750 (5.4688) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/26] time 0.310 (0.341) data 0.231 (0.264) loss_u loss_u 0.9502 (0.9540) acc_u 6.2500 (5.5000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:728
clean false:23
clean_rate:0.9693741677762983
noisy true:640
noisy false:241
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [162/200] batch [5/23] time 0.343 (0.354) data 0.266 (0.276) loss_x loss_x 0.3083 (0.2803) acc_x 93.7500 (90.6250) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [10/23] time 0.356 (0.351) data 0.279 (0.274) loss_x loss_x 0.2666 (0.3201) acc_x 87.5000 (89.3750) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/23] time 0.344 (0.349) data 0.267 (0.272) loss_x loss_x 0.2240 (0.3211) acc_x 93.7500 (90.0000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/23] time 0.349 (0.347) data 0.271 (0.270) loss_x loss_x 0.1564 (0.3064) acc_x 96.8750 (91.0938) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [5/27] time 0.348 (0.348) data 0.270 (0.270) loss_u loss_u 0.9648 (0.9317) acc_u 3.1250 (7.5000) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [10/27] time 0.356 (0.347) data 0.278 (0.269) loss_u loss_u 0.9805 (0.9363) acc_u 3.1250 (7.1875) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [15/27] time 0.357 (0.348) data 0.279 (0.270) loss_u loss_u 0.9111 (0.9376) acc_u 12.5000 (7.2917) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [20/27] time 0.308 (0.347) data 0.229 (0.270) loss_u loss_u 0.8726 (0.9319) acc_u 15.6250 (7.8125) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/27] time 0.329 (0.344) data 0.251 (0.266) loss_u loss_u 0.8945 (0.9326) acc_u 12.5000 (8.0000) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 758
clean true:734
clean false:24
clean_rate:0.9683377308707124
noisy true:647
noisy false:227
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 874
epoch [163/200] batch [5/23] time 0.335 (0.345) data 0.257 (0.268) loss_x loss_x 0.6406 (0.3213) acc_x 84.3750 (93.7500) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [10/23] time 0.332 (0.348) data 0.255 (0.271) loss_x loss_x 0.4453 (0.3133) acc_x 87.5000 (92.1875) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/23] time 0.342 (0.347) data 0.264 (0.269) loss_x loss_x 0.1836 (0.3014) acc_x 96.8750 (93.3333) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/23] time 0.338 (0.345) data 0.261 (0.268) loss_x loss_x 0.5479 (0.3098) acc_x 87.5000 (92.6562) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [5/27] time 0.349 (0.345) data 0.271 (0.268) loss_u loss_u 0.8809 (0.9466) acc_u 12.5000 (5.0000) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [10/27] time 0.352 (0.345) data 0.275 (0.268) loss_u loss_u 0.9951 (0.9506) acc_u 0.0000 (5.0000) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [15/27] time 0.366 (0.346) data 0.288 (0.268) loss_u loss_u 0.9355 (0.9516) acc_u 6.2500 (5.2083) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [20/27] time 0.297 (0.345) data 0.219 (0.267) loss_u loss_u 0.9155 (0.9524) acc_u 12.5000 (5.3125) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/27] time 0.305 (0.340) data 0.226 (0.262) loss_u loss_u 0.9526 (0.9491) acc_u 9.3750 (5.7500) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 762
clean true:736
clean false:26
clean_rate:0.9658792650918635
noisy true:644
noisy false:226
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 870
epoch [164/200] batch [5/23] time 0.340 (0.345) data 0.262 (0.267) loss_x loss_x 0.4500 (0.4052) acc_x 87.5000 (91.8750) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [10/23] time 0.335 (0.344) data 0.258 (0.266) loss_x loss_x 0.3267 (0.3601) acc_x 90.6250 (92.1875) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/23] time 0.342 (0.344) data 0.265 (0.266) loss_x loss_x 0.2520 (0.3340) acc_x 96.8750 (92.9167) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/23] time 0.334 (0.344) data 0.256 (0.266) loss_x loss_x 0.3621 (0.3370) acc_x 90.6250 (92.3438) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [5/27] time 0.326 (0.342) data 0.247 (0.265) loss_u loss_u 0.9556 (0.9257) acc_u 3.1250 (7.5000) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [10/27] time 0.347 (0.342) data 0.269 (0.265) loss_u loss_u 0.9409 (0.9344) acc_u 6.2500 (6.8750) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [15/27] time 0.344 (0.342) data 0.266 (0.265) loss_u loss_u 0.9668 (0.9428) acc_u 3.1250 (5.8333) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [20/27] time 0.346 (0.343) data 0.268 (0.265) loss_u loss_u 0.9702 (0.9425) acc_u 3.1250 (6.0938) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/27] time 0.301 (0.340) data 0.222 (0.262) loss_u loss_u 0.8721 (0.9396) acc_u 18.7500 (6.6250) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 258
confident_label rate tensor(0.4675, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 763
clean true:739
clean false:24
clean_rate:0.9685452162516383
noisy true:635
noisy false:234
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 869
epoch [165/200] batch [5/23] time 0.352 (0.347) data 0.275 (0.269) loss_x loss_x 0.1571 (0.2595) acc_x 96.8750 (93.7500) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [10/23] time 0.338 (0.343) data 0.261 (0.266) loss_x loss_x 0.2277 (0.3010) acc_x 93.7500 (93.4375) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/23] time 0.348 (0.345) data 0.271 (0.267) loss_x loss_x 0.4768 (0.3225) acc_x 90.6250 (92.5000) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/23] time 0.342 (0.344) data 0.265 (0.266) loss_x loss_x 0.3071 (0.3180) acc_x 93.7500 (92.8125) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [5/27] time 0.352 (0.346) data 0.273 (0.268) loss_u loss_u 0.9463 (0.9507) acc_u 6.2500 (6.2500) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [10/27] time 0.350 (0.348) data 0.273 (0.270) loss_u loss_u 0.9263 (0.9503) acc_u 9.3750 (6.2500) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [15/27] time 0.349 (0.348) data 0.272 (0.271) loss_u loss_u 0.9297 (0.9493) acc_u 9.3750 (6.2500) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [20/27] time 0.332 (0.348) data 0.255 (0.271) loss_u loss_u 0.9678 (0.9449) acc_u 3.1250 (6.7188) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/27] time 0.331 (0.347) data 0.252 (0.269) loss_u loss_u 0.9692 (0.9478) acc_u 3.1250 (6.2500) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 274
confident_label rate tensor(0.4675, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 763
clean true:736
clean false:27
clean_rate:0.9646133682830931
noisy true:622
noisy false:247
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 869
epoch [166/200] batch [5/23] time 0.331 (0.326) data 0.253 (0.248) loss_x loss_x 0.2920 (0.2762) acc_x 90.6250 (91.8750) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/23] time 0.352 (0.336) data 0.274 (0.259) loss_x loss_x 0.2717 (0.2812) acc_x 93.7500 (92.8125) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/23] time 0.343 (0.339) data 0.266 (0.261) loss_x loss_x 0.1578 (0.2797) acc_x 100.0000 (93.5417) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/23] time 0.335 (0.338) data 0.258 (0.261) loss_x loss_x 0.3318 (0.2917) acc_x 96.8750 (93.5938) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [5/27] time 0.346 (0.338) data 0.268 (0.260) loss_u loss_u 0.9692 (0.9602) acc_u 3.1250 (5.0000) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [10/27] time 0.340 (0.339) data 0.261 (0.261) loss_u loss_u 0.9673 (0.9500) acc_u 3.1250 (6.2500) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [15/27] time 0.334 (0.340) data 0.256 (0.262) loss_u loss_u 0.8486 (0.9407) acc_u 15.6250 (6.8750) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [20/27] time 0.340 (0.340) data 0.261 (0.262) loss_u loss_u 0.9619 (0.9437) acc_u 3.1250 (6.5625) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/27] time 0.341 (0.340) data 0.263 (0.262) loss_u loss_u 0.9282 (0.9405) acc_u 9.3750 (7.0000) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.4626, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 755
clean true:728
clean false:27
clean_rate:0.9642384105960264
noisy true:643
noisy false:234
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 877
epoch [167/200] batch [5/23] time 0.323 (0.335) data 0.245 (0.257) loss_x loss_x 0.3474 (0.2435) acc_x 90.6250 (95.0000) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [10/23] time 0.299 (0.316) data 0.221 (0.238) loss_x loss_x 0.3625 (0.2275) acc_x 93.7500 (95.6250) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/23] time 0.337 (0.320) data 0.259 (0.242) loss_x loss_x 0.2715 (0.2597) acc_x 93.7500 (93.7500) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/23] time 0.348 (0.326) data 0.271 (0.248) loss_x loss_x 0.1450 (0.2464) acc_x 100.0000 (94.0625) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/27] time 0.360 (0.332) data 0.282 (0.255) loss_u loss_u 0.9883 (0.9373) acc_u 0.0000 (6.2500) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [10/27] time 0.351 (0.334) data 0.272 (0.257) loss_u loss_u 0.9409 (0.9234) acc_u 6.2500 (8.4375) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [15/27] time 0.349 (0.335) data 0.271 (0.257) loss_u loss_u 0.9766 (0.9337) acc_u 6.2500 (7.7083) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [20/27] time 0.342 (0.336) data 0.265 (0.258) loss_u loss_u 0.9668 (0.9364) acc_u 3.1250 (7.3438) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/27] time 0.362 (0.337) data 0.284 (0.260) loss_u loss_u 0.9937 (0.9367) acc_u 0.0000 (7.2500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 764
clean true:737
clean false:27
clean_rate:0.9646596858638743
noisy true:608
noisy false:260
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 868
epoch [168/200] batch [5/23] time 0.345 (0.345) data 0.268 (0.267) loss_x loss_x 0.2362 (0.3160) acc_x 93.7500 (91.2500) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [10/23] time 0.338 (0.344) data 0.260 (0.267) loss_x loss_x 0.4060 (0.3011) acc_x 90.6250 (92.1875) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/23] time 0.296 (0.329) data 0.218 (0.251) loss_x loss_x 0.4907 (0.3106) acc_x 81.2500 (91.8750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/23] time 0.344 (0.334) data 0.267 (0.257) loss_x loss_x 0.3916 (0.3102) acc_x 87.5000 (92.0312) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [5/27] time 0.339 (0.338) data 0.260 (0.260) loss_u loss_u 0.9443 (0.9615) acc_u 6.2500 (4.3750) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [10/27] time 0.350 (0.340) data 0.273 (0.262) loss_u loss_u 0.9482 (0.9644) acc_u 6.2500 (4.0625) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [15/27] time 0.354 (0.341) data 0.277 (0.263) loss_u loss_u 0.9458 (0.9607) acc_u 6.2500 (4.3750) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [20/27] time 0.332 (0.341) data 0.254 (0.263) loss_u loss_u 0.9307 (0.9631) acc_u 6.2500 (4.0625) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/27] time 0.353 (0.342) data 0.275 (0.264) loss_u loss_u 0.7666 (0.9523) acc_u 25.0000 (5.3750) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 762
clean true:736
clean false:26
clean_rate:0.9658792650918635
noisy true:636
noisy false:234
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 870
epoch [169/200] batch [5/23] time 0.343 (0.355) data 0.266 (0.278) loss_x loss_x 0.3931 (0.2886) acc_x 87.5000 (91.2500) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [10/23] time 0.356 (0.345) data 0.279 (0.268) loss_x loss_x 0.2195 (0.2669) acc_x 93.7500 (93.1250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/23] time 0.292 (0.331) data 0.214 (0.254) loss_x loss_x 0.2437 (0.2742) acc_x 93.7500 (93.1250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/23] time 0.350 (0.333) data 0.272 (0.256) loss_x loss_x 0.4668 (0.2885) acc_x 81.2500 (92.5000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [5/27] time 0.333 (0.335) data 0.255 (0.257) loss_u loss_u 0.9385 (0.9483) acc_u 6.2500 (5.0000) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [10/27] time 0.344 (0.337) data 0.266 (0.259) loss_u loss_u 0.8726 (0.9459) acc_u 12.5000 (5.6250) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [15/27] time 0.344 (0.338) data 0.266 (0.260) loss_u loss_u 0.9521 (0.9397) acc_u 3.1250 (6.6667) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [20/27] time 0.348 (0.339) data 0.269 (0.262) loss_u loss_u 0.9106 (0.9419) acc_u 9.3750 (6.2500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/27] time 0.346 (0.340) data 0.267 (0.263) loss_u loss_u 0.9956 (0.9406) acc_u 0.0000 (6.3750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.4626, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 755
clean true:732
clean false:23
clean_rate:0.9695364238410596
noisy true:651
noisy false:226
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 877
epoch [170/200] batch [5/23] time 0.347 (0.346) data 0.268 (0.268) loss_x loss_x 0.3586 (0.3064) acc_x 93.7500 (94.3750) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [10/23] time 0.350 (0.348) data 0.272 (0.270) loss_x loss_x 0.2206 (0.3015) acc_x 96.8750 (94.3750) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/23] time 0.312 (0.339) data 0.234 (0.262) loss_x loss_x 0.1997 (0.2930) acc_x 90.6250 (93.9583) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/23] time 0.341 (0.337) data 0.263 (0.259) loss_x loss_x 0.2515 (0.2977) acc_x 90.6250 (93.9062) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [5/27] time 0.338 (0.336) data 0.259 (0.259) loss_u loss_u 0.9209 (0.9493) acc_u 9.3750 (5.6250) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [10/27] time 0.341 (0.337) data 0.264 (0.259) loss_u loss_u 0.9507 (0.9489) acc_u 3.1250 (5.0000) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [15/27] time 0.337 (0.337) data 0.259 (0.259) loss_u loss_u 0.9023 (0.9414) acc_u 9.3750 (6.0417) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [20/27] time 0.339 (0.336) data 0.261 (0.259) loss_u loss_u 0.9326 (0.9386) acc_u 9.3750 (6.7188) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/27] time 0.345 (0.337) data 0.267 (0.259) loss_u loss_u 0.9648 (0.9387) acc_u 3.1250 (6.6250) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.4688, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 765
clean true:740
clean false:25
clean_rate:0.9673202614379085
noisy true:636
noisy false:231
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 867
epoch [171/200] batch [5/23] time 0.331 (0.356) data 0.254 (0.279) loss_x loss_x 0.2583 (0.2409) acc_x 96.8750 (96.8750) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [10/23] time 0.318 (0.347) data 0.240 (0.269) loss_x loss_x 0.4084 (0.3213) acc_x 87.5000 (93.4375) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/23] time 0.305 (0.344) data 0.228 (0.266) loss_x loss_x 0.2446 (0.2958) acc_x 96.8750 (94.1667) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/23] time 0.323 (0.336) data 0.246 (0.258) loss_x loss_x 0.2051 (0.2832) acc_x 93.7500 (93.5938) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [5/27] time 0.349 (0.339) data 0.271 (0.261) loss_u loss_u 0.9014 (0.9154) acc_u 15.6250 (11.2500) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [10/27] time 0.322 (0.339) data 0.244 (0.261) loss_u loss_u 0.9307 (0.9246) acc_u 9.3750 (9.6875) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [15/27] time 0.353 (0.341) data 0.275 (0.263) loss_u loss_u 0.9067 (0.9364) acc_u 9.3750 (7.7083) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [20/27] time 0.349 (0.341) data 0.270 (0.263) loss_u loss_u 0.9390 (0.9384) acc_u 6.2500 (7.1875) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/27] time 0.341 (0.341) data 0.264 (0.263) loss_u loss_u 0.9443 (0.9419) acc_u 6.2500 (6.7500) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 762
clean true:736
clean false:26
clean_rate:0.9658792650918635
noisy true:646
noisy false:224
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 870
epoch [172/200] batch [5/23] time 0.344 (0.332) data 0.266 (0.255) loss_x loss_x 0.1564 (0.3418) acc_x 96.8750 (91.2500) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [10/23] time 0.333 (0.338) data 0.256 (0.260) loss_x loss_x 0.2323 (0.3244) acc_x 96.8750 (92.1875) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/23] time 0.358 (0.341) data 0.281 (0.263) loss_x loss_x 0.4363 (0.2999) acc_x 87.5000 (92.9167) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/23] time 0.345 (0.342) data 0.268 (0.264) loss_x loss_x 0.2137 (0.3095) acc_x 96.8750 (92.9688) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [5/27] time 0.336 (0.339) data 0.257 (0.261) loss_u loss_u 0.9536 (0.9632) acc_u 6.2500 (3.7500) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [10/27] time 0.353 (0.341) data 0.275 (0.263) loss_u loss_u 0.9722 (0.9494) acc_u 3.1250 (5.9375) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [15/27] time 0.343 (0.341) data 0.265 (0.263) loss_u loss_u 0.9502 (0.9525) acc_u 6.2500 (5.4167) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [20/27] time 0.357 (0.342) data 0.278 (0.264) loss_u loss_u 0.9990 (0.9491) acc_u 0.0000 (5.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/27] time 0.351 (0.341) data 0.273 (0.263) loss_u loss_u 0.8784 (0.9452) acc_u 12.5000 (6.1250) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:731
clean false:22
clean_rate:0.9707835325365206
noisy true:648
noisy false:231
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [173/200] batch [5/23] time 0.326 (0.338) data 0.248 (0.261) loss_x loss_x 0.4084 (0.2270) acc_x 90.6250 (95.6250) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [10/23] time 0.334 (0.342) data 0.257 (0.264) loss_x loss_x 0.3567 (0.2658) acc_x 87.5000 (93.7500) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/23] time 0.336 (0.342) data 0.258 (0.264) loss_x loss_x 0.6035 (0.3009) acc_x 78.1250 (92.2917) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/23] time 0.329 (0.341) data 0.251 (0.263) loss_x loss_x 0.3301 (0.3014) acc_x 90.6250 (92.3438) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [5/27] time 0.299 (0.338) data 0.221 (0.260) loss_u loss_u 0.9668 (0.9551) acc_u 3.1250 (4.3750) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [10/27] time 0.339 (0.334) data 0.261 (0.256) loss_u loss_u 0.9414 (0.9478) acc_u 6.2500 (5.6250) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [15/27] time 0.344 (0.335) data 0.266 (0.257) loss_u loss_u 0.9106 (0.9426) acc_u 9.3750 (6.0417) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [20/27] time 0.341 (0.335) data 0.263 (0.258) loss_u loss_u 0.9746 (0.9403) acc_u 3.1250 (6.4062) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/27] time 0.337 (0.336) data 0.259 (0.258) loss_u loss_u 0.8862 (0.9426) acc_u 12.5000 (6.1250) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 758
clean true:732
clean false:26
clean_rate:0.9656992084432717
noisy true:641
noisy false:233
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 874
epoch [174/200] batch [5/23] time 0.343 (0.336) data 0.264 (0.258) loss_x loss_x 0.4729 (0.2973) acc_x 96.8750 (93.1250) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [10/23] time 0.321 (0.336) data 0.243 (0.258) loss_x loss_x 0.2632 (0.3078) acc_x 87.5000 (92.1875) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/23] time 0.349 (0.336) data 0.272 (0.258) loss_x loss_x 0.2087 (0.3057) acc_x 96.8750 (92.5000) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/23] time 0.356 (0.339) data 0.278 (0.261) loss_x loss_x 0.0779 (0.2751) acc_x 100.0000 (93.2812) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [5/27] time 0.363 (0.340) data 0.285 (0.262) loss_u loss_u 0.9316 (0.9561) acc_u 9.3750 (5.0000) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [10/27] time 0.335 (0.338) data 0.257 (0.260) loss_u loss_u 0.9795 (0.9508) acc_u 3.1250 (5.6250) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [15/27] time 0.294 (0.337) data 0.215 (0.259) loss_u loss_u 0.9810 (0.9484) acc_u 3.1250 (6.2500) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [20/27] time 0.349 (0.335) data 0.271 (0.257) loss_u loss_u 0.9106 (0.9494) acc_u 9.3750 (5.9375) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/27] time 0.343 (0.336) data 0.264 (0.258) loss_u loss_u 0.9507 (0.9483) acc_u 6.2500 (6.1250) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4688, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 765
clean true:739
clean false:26
clean_rate:0.9660130718954248
noisy true:631
noisy false:236
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 867
epoch [175/200] batch [5/23] time 0.349 (0.350) data 0.272 (0.272) loss_x loss_x 0.4673 (0.2866) acc_x 84.3750 (93.7500) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [10/23] time 0.335 (0.346) data 0.258 (0.268) loss_x loss_x 0.2512 (0.2716) acc_x 90.6250 (94.0625) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/23] time 0.339 (0.341) data 0.262 (0.263) loss_x loss_x 0.5889 (0.3049) acc_x 84.3750 (93.3333) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/23] time 0.352 (0.343) data 0.275 (0.266) loss_x loss_x 0.4548 (0.3064) acc_x 90.6250 (93.5938) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [5/27] time 0.323 (0.339) data 0.245 (0.262) loss_u loss_u 0.9141 (0.9242) acc_u 9.3750 (8.7500) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [10/27] time 0.300 (0.336) data 0.222 (0.259) loss_u loss_u 0.9473 (0.9384) acc_u 6.2500 (6.5625) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [15/27] time 0.316 (0.336) data 0.237 (0.258) loss_u loss_u 0.9229 (0.9382) acc_u 6.2500 (6.6667) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [20/27] time 0.314 (0.334) data 0.234 (0.256) loss_u loss_u 0.9927 (0.9431) acc_u 0.0000 (6.0938) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/27] time 0.352 (0.336) data 0.274 (0.258) loss_u loss_u 0.9370 (0.9482) acc_u 6.2500 (5.5000) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.4675, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 763
clean true:739
clean false:24
clean_rate:0.9685452162516383
noisy true:623
noisy false:246
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 869
epoch [176/200] batch [5/23] time 0.337 (0.346) data 0.260 (0.268) loss_x loss_x 0.2455 (0.2733) acc_x 96.8750 (95.0000) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [10/23] time 0.356 (0.347) data 0.278 (0.269) loss_x loss_x 0.2477 (0.2422) acc_x 90.6250 (95.0000) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/23] time 0.346 (0.345) data 0.267 (0.267) loss_x loss_x 0.3137 (0.2658) acc_x 93.7500 (94.1667) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/23] time 0.353 (0.340) data 0.275 (0.262) loss_x loss_x 0.2793 (0.2570) acc_x 90.6250 (93.9062) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [5/27] time 0.352 (0.346) data 0.274 (0.269) loss_u loss_u 0.9565 (0.9230) acc_u 3.1250 (8.7500) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [10/27] time 0.351 (0.348) data 0.273 (0.270) loss_u loss_u 0.9980 (0.9433) acc_u 0.0000 (6.8750) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [15/27] time 0.344 (0.347) data 0.267 (0.269) loss_u loss_u 0.9697 (0.9446) acc_u 3.1250 (6.2500) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [20/27] time 0.342 (0.347) data 0.264 (0.269) loss_u loss_u 0.9473 (0.9459) acc_u 9.3750 (6.4062) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/27] time 0.349 (0.347) data 0.271 (0.270) loss_u loss_u 0.9819 (0.9473) acc_u 3.1250 (6.2500) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:724
clean false:24
clean_rate:0.9679144385026738
noisy true:652
noisy false:232
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [177/200] batch [5/23] time 0.349 (0.351) data 0.272 (0.274) loss_x loss_x 0.3533 (0.3512) acc_x 93.7500 (91.2500) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [10/23] time 0.355 (0.351) data 0.277 (0.274) loss_x loss_x 0.2183 (0.2925) acc_x 93.7500 (93.1250) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/23] time 0.318 (0.344) data 0.240 (0.266) loss_x loss_x 0.4597 (0.2982) acc_x 84.3750 (91.8750) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/23] time 0.353 (0.345) data 0.275 (0.267) loss_x loss_x 0.2332 (0.2851) acc_x 93.7500 (92.6562) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [5/27] time 0.346 (0.344) data 0.268 (0.266) loss_u loss_u 0.9668 (0.9162) acc_u 3.1250 (9.3750) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [10/27] time 0.358 (0.346) data 0.281 (0.268) loss_u loss_u 0.9307 (0.9283) acc_u 9.3750 (8.7500) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [15/27] time 0.352 (0.346) data 0.274 (0.268) loss_u loss_u 0.9126 (0.9304) acc_u 9.3750 (8.1250) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [20/27] time 0.366 (0.347) data 0.288 (0.269) loss_u loss_u 0.9185 (0.9331) acc_u 9.3750 (7.8125) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/27] time 0.351 (0.347) data 0.273 (0.270) loss_u loss_u 0.9380 (0.9352) acc_u 6.2500 (7.5000) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4663, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 761
clean true:736
clean false:25
clean_rate:0.9671484888304862
noisy true:637
noisy false:234
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 871
epoch [178/200] batch [5/23] time 0.353 (0.355) data 0.275 (0.277) loss_x loss_x 0.2275 (0.2748) acc_x 93.7500 (93.1250) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [10/23] time 0.347 (0.353) data 0.270 (0.275) loss_x loss_x 0.0884 (0.2546) acc_x 100.0000 (93.7500) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/23] time 0.342 (0.344) data 0.265 (0.267) loss_x loss_x 0.1366 (0.2445) acc_x 100.0000 (94.1667) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/23] time 0.340 (0.343) data 0.263 (0.266) loss_x loss_x 0.1466 (0.2684) acc_x 96.8750 (93.9062) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [5/27] time 0.297 (0.335) data 0.218 (0.257) loss_u loss_u 0.9268 (0.9538) acc_u 9.3750 (6.2500) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [10/27] time 0.350 (0.336) data 0.272 (0.259) loss_u loss_u 0.9336 (0.9594) acc_u 6.2500 (4.6875) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [15/27] time 0.330 (0.338) data 0.252 (0.260) loss_u loss_u 0.9805 (0.9494) acc_u 3.1250 (5.8333) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [20/27] time 0.349 (0.338) data 0.271 (0.260) loss_u loss_u 0.9277 (0.9451) acc_u 9.3750 (6.2500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/27] time 0.333 (0.339) data 0.255 (0.261) loss_u loss_u 0.9243 (0.9448) acc_u 9.3750 (6.2500) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:731
clean false:21
clean_rate:0.9720744680851063
noisy true:638
noisy false:242
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [179/200] batch [5/23] time 0.340 (0.339) data 0.263 (0.262) loss_x loss_x 0.5234 (0.3357) acc_x 93.7500 (93.1250) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [10/23] time 0.349 (0.342) data 0.272 (0.264) loss_x loss_x 0.3904 (0.2999) acc_x 93.7500 (94.0625) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/23] time 0.349 (0.341) data 0.270 (0.264) loss_x loss_x 0.3657 (0.2720) acc_x 90.6250 (94.3750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/23] time 0.291 (0.339) data 0.212 (0.261) loss_x loss_x 0.2312 (0.2666) acc_x 96.8750 (94.3750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [5/27] time 0.340 (0.337) data 0.262 (0.259) loss_u loss_u 0.9570 (0.9423) acc_u 6.2500 (7.5000) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [10/27] time 0.347 (0.338) data 0.268 (0.261) loss_u loss_u 0.9634 (0.9425) acc_u 3.1250 (6.5625) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [15/27] time 0.335 (0.339) data 0.258 (0.261) loss_u loss_u 0.8623 (0.9248) acc_u 12.5000 (8.1250) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [20/27] time 0.368 (0.341) data 0.289 (0.263) loss_u loss_u 0.9663 (0.9348) acc_u 3.1250 (6.8750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/27] time 0.354 (0.342) data 0.276 (0.264) loss_u loss_u 0.9390 (0.9384) acc_u 6.2500 (6.6250) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 258
confident_label rate tensor(0.4718, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 770
clean true:740
clean false:30
clean_rate:0.961038961038961
noisy true:634
noisy false:228
after delete: len(clean_dataset) 770
after delete: len(noisy_dataset) 862
epoch [180/200] batch [5/24] time 0.352 (0.347) data 0.274 (0.269) loss_x loss_x 0.1890 (0.3056) acc_x 100.0000 (93.7500) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [10/24] time 0.337 (0.345) data 0.260 (0.267) loss_x loss_x 0.2700 (0.2876) acc_x 96.8750 (93.7500) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/24] time 0.354 (0.347) data 0.276 (0.270) loss_x loss_x 0.4595 (0.2653) acc_x 93.7500 (94.7917) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/24] time 0.296 (0.340) data 0.218 (0.262) loss_x loss_x 0.1753 (0.2648) acc_x 96.8750 (94.5312) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [5/26] time 0.337 (0.337) data 0.260 (0.259) loss_u loss_u 0.9829 (0.9468) acc_u 3.1250 (5.6250) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [10/26] time 0.355 (0.339) data 0.277 (0.262) loss_u loss_u 0.9619 (0.9405) acc_u 3.1250 (6.5625) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [15/26] time 0.338 (0.341) data 0.260 (0.263) loss_u loss_u 0.9985 (0.9460) acc_u 0.0000 (6.0417) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/26] time 0.395 (0.343) data 0.316 (0.265) loss_u loss_u 0.9492 (0.9476) acc_u 6.2500 (5.7812) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/26] time 0.469 (0.356) data 0.390 (0.278) loss_u loss_u 0.9268 (0.9427) acc_u 6.2500 (6.2500) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4657, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 760
clean true:737
clean false:23
clean_rate:0.9697368421052631
noisy true:632
noisy false:240
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 872
epoch [181/200] batch [5/23] time 0.326 (0.339) data 0.249 (0.261) loss_x loss_x 0.4280 (0.3556) acc_x 93.7500 (93.7500) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [10/23] time 0.349 (0.340) data 0.270 (0.262) loss_x loss_x 0.1407 (0.3101) acc_x 100.0000 (94.3750) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/23] time 0.323 (0.336) data 0.245 (0.258) loss_x loss_x 0.2766 (0.3274) acc_x 96.8750 (93.5417) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/23] time 0.329 (0.331) data 0.250 (0.253) loss_x loss_x 0.1324 (0.3216) acc_x 100.0000 (93.5938) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/27] time 0.304 (0.334) data 0.227 (0.256) loss_u loss_u 0.9268 (0.9331) acc_u 6.2500 (6.2500) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [10/27] time 0.305 (0.332) data 0.228 (0.254) loss_u loss_u 0.9390 (0.9390) acc_u 6.2500 (6.2500) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [15/27] time 0.297 (0.328) data 0.219 (0.250) loss_u loss_u 0.8208 (0.9377) acc_u 18.7500 (6.6667) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/27] time 0.351 (0.329) data 0.273 (0.251) loss_u loss_u 0.9790 (0.9393) acc_u 0.0000 (6.4062) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/27] time 0.333 (0.330) data 0.255 (0.252) loss_u loss_u 0.9893 (0.9424) acc_u 0.0000 (6.0000) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4632, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 756
clean true:735
clean false:21
clean_rate:0.9722222222222222
noisy true:635
noisy false:241
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 876
epoch [182/200] batch [5/23] time 0.364 (0.351) data 0.287 (0.273) loss_x loss_x 0.2344 (0.2384) acc_x 93.7500 (93.1250) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [10/23] time 0.346 (0.349) data 0.269 (0.271) loss_x loss_x 0.1688 (0.2356) acc_x 93.7500 (93.7500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/23] time 0.329 (0.346) data 0.251 (0.268) loss_x loss_x 0.3035 (0.2318) acc_x 93.7500 (94.3750) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/23] time 0.297 (0.335) data 0.218 (0.257) loss_x loss_x 0.4868 (0.2680) acc_x 84.3750 (93.7500) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [5/27] time 0.349 (0.339) data 0.272 (0.261) loss_u loss_u 0.9404 (0.9245) acc_u 6.2500 (8.1250) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [10/27] time 0.358 (0.341) data 0.279 (0.263) loss_u loss_u 0.9678 (0.9323) acc_u 3.1250 (7.5000) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [15/27] time 0.331 (0.341) data 0.253 (0.264) loss_u loss_u 0.9692 (0.9401) acc_u 3.1250 (6.4583) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [20/27] time 0.346 (0.342) data 0.268 (0.264) loss_u loss_u 0.8647 (0.9266) acc_u 15.6250 (7.9688) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/27] time 0.347 (0.343) data 0.269 (0.265) loss_u loss_u 0.9888 (0.9324) acc_u 0.0000 (7.3750) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.4688, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 765
clean true:740
clean false:25
clean_rate:0.9673202614379085
noisy true:649
noisy false:218
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 867
epoch [183/200] batch [5/23] time 0.340 (0.356) data 0.263 (0.278) loss_x loss_x 0.3850 (0.3210) acc_x 90.6250 (92.5000) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [10/23] time 0.344 (0.351) data 0.267 (0.273) loss_x loss_x 0.2866 (0.3309) acc_x 90.6250 (91.8750) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/23] time 0.354 (0.348) data 0.276 (0.271) loss_x loss_x 0.1844 (0.2988) acc_x 93.7500 (92.7083) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/23] time 0.335 (0.342) data 0.258 (0.264) loss_x loss_x 0.3191 (0.2906) acc_x 93.7500 (93.1250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [5/27] time 0.326 (0.343) data 0.249 (0.265) loss_u loss_u 0.9834 (0.9556) acc_u 0.0000 (5.6250) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [10/27] time 0.327 (0.342) data 0.249 (0.264) loss_u loss_u 0.9688 (0.9452) acc_u 3.1250 (6.2500) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [15/27] time 0.349 (0.342) data 0.272 (0.264) loss_u loss_u 0.9629 (0.9498) acc_u 3.1250 (5.6250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [20/27] time 0.353 (0.342) data 0.274 (0.264) loss_u loss_u 0.9355 (0.9480) acc_u 6.2500 (5.7812) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/27] time 0.340 (0.341) data 0.261 (0.264) loss_u loss_u 0.9424 (0.9495) acc_u 6.2500 (5.6250) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.4632, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 756
clean true:730
clean false:26
clean_rate:0.9656084656084656
noisy true:626
noisy false:250
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 876
epoch [184/200] batch [5/23] time 0.351 (0.349) data 0.274 (0.272) loss_x loss_x 0.2856 (0.3282) acc_x 96.8750 (91.8750) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [10/23] time 0.349 (0.346) data 0.271 (0.269) loss_x loss_x 0.2830 (0.3009) acc_x 93.7500 (93.1250) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/23] time 0.346 (0.345) data 0.269 (0.268) loss_x loss_x 0.3726 (0.3119) acc_x 96.8750 (93.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/23] time 0.336 (0.344) data 0.259 (0.266) loss_x loss_x 0.4097 (0.3087) acc_x 90.6250 (93.5938) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [5/27] time 0.356 (0.337) data 0.277 (0.259) loss_u loss_u 0.9482 (0.9251) acc_u 6.2500 (9.3750) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [10/27] time 0.324 (0.337) data 0.246 (0.259) loss_u loss_u 0.9678 (0.9456) acc_u 6.2500 (6.8750) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [15/27] time 0.342 (0.337) data 0.264 (0.260) loss_u loss_u 0.9131 (0.9382) acc_u 12.5000 (7.9167) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [20/27] time 0.336 (0.338) data 0.257 (0.260) loss_u loss_u 0.9375 (0.9314) acc_u 6.2500 (8.2812) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/27] time 0.338 (0.338) data 0.260 (0.260) loss_u loss_u 0.9629 (0.9382) acc_u 3.1250 (7.3750) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:728
clean false:26
clean_rate:0.9655172413793104
noisy true:636
noisy false:242
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [185/200] batch [5/23] time 0.334 (0.340) data 0.256 (0.262) loss_x loss_x 0.6138 (0.3683) acc_x 90.6250 (92.5000) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [10/23] time 0.328 (0.339) data 0.250 (0.261) loss_x loss_x 0.3960 (0.3124) acc_x 96.8750 (94.3750) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/23] time 0.341 (0.339) data 0.263 (0.261) loss_x loss_x 0.2825 (0.2966) acc_x 93.7500 (94.1667) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/23] time 0.339 (0.338) data 0.262 (0.261) loss_x loss_x 0.3604 (0.3108) acc_x 93.7500 (93.4375) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [5/27] time 0.348 (0.340) data 0.270 (0.262) loss_u loss_u 0.8965 (0.9400) acc_u 12.5000 (7.5000) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [10/27] time 0.314 (0.336) data 0.235 (0.258) loss_u loss_u 0.9087 (0.9356) acc_u 9.3750 (7.8125) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [15/27] time 0.354 (0.338) data 0.275 (0.260) loss_u loss_u 0.9219 (0.9330) acc_u 9.3750 (7.9167) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [20/27] time 0.366 (0.339) data 0.288 (0.261) loss_u loss_u 0.9985 (0.9405) acc_u 0.0000 (7.0312) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/27] time 0.329 (0.339) data 0.250 (0.261) loss_u loss_u 0.9248 (0.9392) acc_u 6.2500 (7.0000) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 764
clean true:738
clean false:26
clean_rate:0.9659685863874345
noisy true:631
noisy false:237
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 868
epoch [186/200] batch [5/23] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.2471 (0.3112) acc_x 96.8750 (93.1250) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [10/23] time 0.340 (0.340) data 0.262 (0.262) loss_x loss_x 0.5083 (0.3293) acc_x 87.5000 (92.8125) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/23] time 0.334 (0.340) data 0.256 (0.262) loss_x loss_x 0.2039 (0.3241) acc_x 100.0000 (92.7083) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/23] time 0.343 (0.340) data 0.266 (0.262) loss_x loss_x 0.4648 (0.3079) acc_x 93.7500 (93.5938) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [5/27] time 0.357 (0.342) data 0.280 (0.264) loss_u loss_u 0.9995 (0.9574) acc_u 0.0000 (4.3750) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [10/27] time 0.330 (0.337) data 0.251 (0.259) loss_u loss_u 0.8652 (0.9409) acc_u 15.6250 (6.5625) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [15/27] time 0.348 (0.338) data 0.270 (0.260) loss_u loss_u 0.9326 (0.9401) acc_u 6.2500 (6.6667) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [20/27] time 0.339 (0.339) data 0.262 (0.261) loss_u loss_u 0.9941 (0.9461) acc_u 0.0000 (5.9375) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/27] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9614 (0.9494) acc_u 3.1250 (5.5000) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.4749, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 775
clean true:748
clean false:27
clean_rate:0.9651612903225807
noisy true:640
noisy false:217
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 857
epoch [187/200] batch [5/24] time 0.361 (0.353) data 0.284 (0.275) loss_x loss_x 0.1246 (0.2038) acc_x 96.8750 (96.2500) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [10/24] time 0.345 (0.351) data 0.268 (0.273) loss_x loss_x 0.2749 (0.2202) acc_x 93.7500 (95.6250) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/24] time 0.357 (0.350) data 0.280 (0.273) loss_x loss_x 0.1854 (0.2471) acc_x 93.7500 (94.3750) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/24] time 0.339 (0.348) data 0.262 (0.270) loss_x loss_x 0.3254 (0.2803) acc_x 90.6250 (93.5938) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [5/26] time 0.332 (0.347) data 0.254 (0.269) loss_u loss_u 0.9727 (0.9488) acc_u 3.1250 (6.8750) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [10/26] time 0.306 (0.343) data 0.228 (0.265) loss_u loss_u 0.9790 (0.9557) acc_u 3.1250 (5.6250) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [15/26] time 0.355 (0.343) data 0.276 (0.266) loss_u loss_u 0.9653 (0.9599) acc_u 3.1250 (5.0000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/26] time 0.337 (0.344) data 0.259 (0.266) loss_u loss_u 0.8730 (0.9565) acc_u 12.5000 (5.3125) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/26] time 0.351 (0.344) data 0.274 (0.266) loss_u loss_u 0.9912 (0.9581) acc_u 0.0000 (5.0000) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 762
clean true:738
clean false:24
clean_rate:0.968503937007874
noisy true:644
noisy false:226
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 870
epoch [188/200] batch [5/23] time 0.303 (0.327) data 0.226 (0.249) loss_x loss_x 0.6343 (0.3697) acc_x 84.3750 (90.6250) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/23] time 0.311 (0.315) data 0.234 (0.237) loss_x loss_x 0.5132 (0.3281) acc_x 87.5000 (92.8125) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/23] time 0.349 (0.324) data 0.271 (0.246) loss_x loss_x 0.0602 (0.3282) acc_x 100.0000 (93.3333) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/23] time 0.339 (0.329) data 0.262 (0.252) loss_x loss_x 0.3538 (0.3166) acc_x 90.6250 (93.4375) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/27] time 0.348 (0.333) data 0.270 (0.256) loss_u loss_u 0.9980 (0.9424) acc_u 0.0000 (6.2500) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [10/27] time 0.304 (0.333) data 0.225 (0.255) loss_u loss_u 0.9692 (0.9313) acc_u 3.1250 (7.5000) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [15/27] time 0.299 (0.329) data 0.220 (0.251) loss_u loss_u 0.9878 (0.9416) acc_u 0.0000 (6.2500) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/27] time 0.333 (0.329) data 0.255 (0.251) loss_u loss_u 0.9150 (0.9478) acc_u 9.3750 (5.4688) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/27] time 0.347 (0.331) data 0.268 (0.253) loss_u loss_u 0.9365 (0.9402) acc_u 6.2500 (6.3750) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4730, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 772
clean true:744
clean false:28
clean_rate:0.9637305699481865
noisy true:636
noisy false:224
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 860
epoch [189/200] batch [5/24] time 0.352 (0.353) data 0.273 (0.275) loss_x loss_x 0.3367 (0.3828) acc_x 93.7500 (91.8750) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [10/24] time 0.344 (0.350) data 0.267 (0.272) loss_x loss_x 0.2629 (0.3225) acc_x 87.5000 (91.5625) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/24] time 0.341 (0.349) data 0.263 (0.271) loss_x loss_x 0.3049 (0.3016) acc_x 93.7500 (92.7083) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/24] time 0.343 (0.348) data 0.266 (0.271) loss_x loss_x 0.2247 (0.3013) acc_x 93.7500 (92.8125) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [5/26] time 0.344 (0.349) data 0.266 (0.271) loss_u loss_u 0.9316 (0.9370) acc_u 6.2500 (6.2500) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [10/26] time 0.374 (0.350) data 0.297 (0.272) loss_u loss_u 0.9722 (0.9500) acc_u 3.1250 (5.3125) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [15/26] time 0.322 (0.348) data 0.243 (0.270) loss_u loss_u 0.9683 (0.9562) acc_u 3.1250 (4.5833) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/26] time 0.324 (0.343) data 0.246 (0.265) loss_u loss_u 0.9658 (0.9593) acc_u 3.1250 (4.2188) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/26] time 0.341 (0.344) data 0.263 (0.266) loss_u loss_u 0.9668 (0.9534) acc_u 3.1250 (5.0000) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.4712, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 769
clean true:740
clean false:29
clean_rate:0.9622886866059818
noisy true:642
noisy false:221
after delete: len(clean_dataset) 769
after delete: len(noisy_dataset) 863
epoch [190/200] batch [5/24] time 0.347 (0.340) data 0.269 (0.262) loss_x loss_x 0.2568 (0.2792) acc_x 93.7500 (93.7500) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [10/24] time 0.348 (0.340) data 0.270 (0.262) loss_x loss_x 0.5835 (0.3223) acc_x 84.3750 (93.1250) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/24] time 0.345 (0.342) data 0.267 (0.264) loss_x loss_x 0.4358 (0.3246) acc_x 87.5000 (92.2917) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/24] time 0.340 (0.343) data 0.263 (0.265) loss_x loss_x 0.1560 (0.2984) acc_x 96.8750 (92.5000) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [5/26] time 0.363 (0.345) data 0.286 (0.267) loss_u loss_u 0.9575 (0.9521) acc_u 6.2500 (6.2500) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [10/26] time 0.347 (0.345) data 0.270 (0.267) loss_u loss_u 0.9526 (0.9489) acc_u 6.2500 (6.5625) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [15/26] time 0.347 (0.346) data 0.269 (0.268) loss_u loss_u 0.9282 (0.9468) acc_u 9.3750 (6.6667) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/26] time 0.319 (0.345) data 0.241 (0.268) loss_u loss_u 0.9409 (0.9456) acc_u 6.2500 (6.8750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/26] time 0.306 (0.342) data 0.227 (0.264) loss_u loss_u 0.9209 (0.9489) acc_u 9.3750 (6.3750) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 242
confident_label rate tensor(0.4767, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 778
clean true:750
clean false:28
clean_rate:0.9640102827763496
noisy true:640
noisy false:214
after delete: len(clean_dataset) 778
after delete: len(noisy_dataset) 854
epoch [191/200] batch [5/24] time 0.343 (0.352) data 0.265 (0.274) loss_x loss_x 0.4734 (0.2949) acc_x 90.6250 (96.8750) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [10/24] time 0.343 (0.349) data 0.265 (0.271) loss_x loss_x 0.1410 (0.2694) acc_x 96.8750 (95.3125) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/24] time 0.345 (0.347) data 0.267 (0.269) loss_x loss_x 0.3486 (0.2934) acc_x 93.7500 (94.3750) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/24] time 0.345 (0.347) data 0.267 (0.269) loss_x loss_x 0.2688 (0.2821) acc_x 96.8750 (94.3750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [5/26] time 0.350 (0.346) data 0.271 (0.268) loss_u loss_u 0.9932 (0.9571) acc_u 0.0000 (4.3750) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [10/26] time 0.351 (0.347) data 0.273 (0.269) loss_u loss_u 0.9668 (0.9482) acc_u 3.1250 (5.6250) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [15/26] time 0.363 (0.348) data 0.285 (0.269) loss_u loss_u 0.9004 (0.9432) acc_u 12.5000 (6.4583) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/26] time 0.328 (0.346) data 0.250 (0.268) loss_u loss_u 0.9741 (0.9464) acc_u 3.1250 (5.9375) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/26] time 0.309 (0.342) data 0.230 (0.263) loss_u loss_u 0.9419 (0.9521) acc_u 6.2500 (5.2500) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.4694, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 766
clean true:743
clean false:23
clean_rate:0.9699738903394256
noisy true:652
noisy false:214
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 866
epoch [192/200] batch [5/23] time 0.340 (0.350) data 0.264 (0.273) loss_x loss_x 0.3193 (0.2761) acc_x 93.7500 (93.1250) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [10/23] time 0.342 (0.345) data 0.264 (0.268) loss_x loss_x 0.3948 (0.3170) acc_x 93.7500 (93.1250) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/23] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.2385 (0.3218) acc_x 93.7500 (92.9167) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/23] time 0.338 (0.340) data 0.261 (0.262) loss_x loss_x 0.1588 (0.3034) acc_x 96.8750 (93.4375) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [5/27] time 0.356 (0.340) data 0.277 (0.263) loss_u loss_u 0.9175 (0.9372) acc_u 12.5000 (7.5000) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [10/27] time 0.339 (0.340) data 0.261 (0.263) loss_u loss_u 0.8154 (0.9327) acc_u 18.7500 (7.8125) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [15/27] time 0.375 (0.342) data 0.296 (0.264) loss_u loss_u 0.9629 (0.9437) acc_u 3.1250 (6.4583) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [20/27] time 0.334 (0.341) data 0.256 (0.264) loss_u loss_u 0.8779 (0.9444) acc_u 12.5000 (6.2500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/27] time 0.332 (0.339) data 0.254 (0.262) loss_u loss_u 0.9263 (0.9462) acc_u 9.3750 (6.0000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4663, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 761
clean true:735
clean false:26
clean_rate:0.9658344283837057
noisy true:645
noisy false:226
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 871
epoch [193/200] batch [5/23] time 0.350 (0.349) data 0.273 (0.271) loss_x loss_x 0.1880 (0.2362) acc_x 93.7500 (95.6250) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [10/23] time 0.344 (0.340) data 0.267 (0.262) loss_x loss_x 0.1733 (0.2682) acc_x 96.8750 (93.7500) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [15/23] time 0.358 (0.345) data 0.280 (0.267) loss_x loss_x 0.1893 (0.2719) acc_x 90.6250 (93.5417) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/23] time 0.349 (0.347) data 0.272 (0.269) loss_x loss_x 0.2305 (0.2511) acc_x 93.7500 (94.2188) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [5/27] time 0.348 (0.346) data 0.270 (0.268) loss_u loss_u 0.9263 (0.9485) acc_u 12.5000 (6.8750) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [10/27] time 0.331 (0.345) data 0.253 (0.267) loss_u loss_u 0.9678 (0.9333) acc_u 3.1250 (8.1250) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [15/27] time 0.328 (0.343) data 0.250 (0.265) loss_u loss_u 0.9302 (0.9374) acc_u 6.2500 (7.2917) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [20/27] time 0.332 (0.344) data 0.254 (0.266) loss_u loss_u 0.9194 (0.9398) acc_u 9.3750 (6.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/27] time 0.313 (0.341) data 0.234 (0.263) loss_u loss_u 0.9287 (0.9439) acc_u 6.2500 (6.2500) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4681, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 764
clean true:737
clean false:27
clean_rate:0.9646596858638743
noisy true:635
noisy false:233
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 868
epoch [194/200] batch [5/23] time 0.354 (0.352) data 0.275 (0.274) loss_x loss_x 0.2791 (0.4540) acc_x 93.7500 (88.1250) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [10/23] time 0.348 (0.350) data 0.271 (0.272) loss_x loss_x 0.2793 (0.3719) acc_x 93.7500 (90.9375) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/23] time 0.334 (0.347) data 0.256 (0.269) loss_x loss_x 0.2263 (0.3296) acc_x 93.7500 (92.0833) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/23] time 0.352 (0.346) data 0.275 (0.268) loss_x loss_x 0.2157 (0.3031) acc_x 96.8750 (92.8125) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [5/27] time 0.340 (0.345) data 0.261 (0.267) loss_u loss_u 0.9468 (0.9448) acc_u 9.3750 (6.8750) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [10/27] time 0.347 (0.345) data 0.270 (0.267) loss_u loss_u 0.9365 (0.9437) acc_u 6.2500 (6.8750) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [15/27] time 0.341 (0.344) data 0.263 (0.267) loss_u loss_u 0.9580 (0.9483) acc_u 3.1250 (6.2500) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [20/27] time 0.299 (0.342) data 0.220 (0.264) loss_u loss_u 0.8994 (0.9471) acc_u 12.5000 (6.4062) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/27] time 0.338 (0.341) data 0.260 (0.263) loss_u loss_u 0.9790 (0.9451) acc_u 0.0000 (6.5000) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.4626, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 755
clean true:730
clean false:25
clean_rate:0.9668874172185431
noisy true:635
noisy false:242
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 877
epoch [195/200] batch [5/23] time 0.341 (0.341) data 0.263 (0.264) loss_x loss_x 0.3718 (0.3919) acc_x 93.7500 (91.8750) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [10/23] time 0.342 (0.333) data 0.265 (0.256) loss_x loss_x 0.2986 (0.3999) acc_x 93.7500 (91.2500) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/23] time 0.318 (0.334) data 0.241 (0.256) loss_x loss_x 0.2034 (0.3466) acc_x 96.8750 (92.0833) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/23] time 0.340 (0.337) data 0.263 (0.259) loss_x loss_x 0.4182 (0.3454) acc_x 90.6250 (92.1875) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [5/27] time 0.375 (0.339) data 0.296 (0.261) loss_u loss_u 0.9985 (0.9634) acc_u 0.0000 (4.3750) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [10/27] time 0.359 (0.340) data 0.281 (0.262) loss_u loss_u 0.9458 (0.9575) acc_u 6.2500 (5.3125) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [15/27] time 0.345 (0.341) data 0.266 (0.263) loss_u loss_u 0.9077 (0.9403) acc_u 9.3750 (7.0833) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [20/27] time 0.350 (0.343) data 0.271 (0.265) loss_u loss_u 0.9365 (0.9481) acc_u 6.2500 (5.9375) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/27] time 0.304 (0.340) data 0.226 (0.262) loss_u loss_u 0.9092 (0.9452) acc_u 12.5000 (6.2500) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 762
clean true:735
clean false:27
clean_rate:0.9645669291338582
noisy true:621
noisy false:249
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 870
epoch [196/200] batch [5/23] time 0.343 (0.351) data 0.265 (0.273) loss_x loss_x 0.3015 (0.2386) acc_x 96.8750 (96.8750) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [10/23] time 0.349 (0.345) data 0.272 (0.267) loss_x loss_x 0.3306 (0.2753) acc_x 87.5000 (93.1250) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/23] time 0.360 (0.344) data 0.282 (0.267) loss_x loss_x 0.0800 (0.2588) acc_x 100.0000 (93.7500) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/23] time 0.324 (0.343) data 0.247 (0.265) loss_x loss_x 0.0966 (0.2551) acc_x 100.0000 (93.9062) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [5/27] time 0.345 (0.340) data 0.267 (0.263) loss_u loss_u 0.9648 (0.9525) acc_u 3.1250 (5.6250) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [10/27] time 0.342 (0.341) data 0.264 (0.263) loss_u loss_u 0.9185 (0.9398) acc_u 6.2500 (6.8750) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [15/27] time 0.358 (0.343) data 0.280 (0.265) loss_u loss_u 0.9517 (0.9503) acc_u 6.2500 (5.6250) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [20/27] time 0.343 (0.343) data 0.266 (0.265) loss_u loss_u 0.9741 (0.9426) acc_u 3.1250 (6.5625) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/27] time 0.332 (0.340) data 0.252 (0.263) loss_u loss_u 0.9771 (0.9473) acc_u 3.1250 (6.1250) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 762
clean true:735
clean false:27
clean_rate:0.9645669291338582
noisy true:628
noisy false:242
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 870
epoch [197/200] batch [5/23] time 0.353 (0.352) data 0.276 (0.275) loss_x loss_x 0.2878 (0.3239) acc_x 87.5000 (91.8750) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [10/23] time 0.293 (0.337) data 0.215 (0.259) loss_x loss_x 0.2954 (0.2682) acc_x 87.5000 (92.8125) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/23] time 0.353 (0.335) data 0.276 (0.258) loss_x loss_x 0.4893 (0.3238) acc_x 90.6250 (91.6667) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/23] time 0.325 (0.335) data 0.247 (0.257) loss_x loss_x 0.2891 (0.3230) acc_x 96.8750 (91.8750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [5/27] time 0.343 (0.333) data 0.265 (0.256) loss_u loss_u 0.9683 (0.9563) acc_u 3.1250 (4.3750) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [10/27] time 0.351 (0.336) data 0.273 (0.258) loss_u loss_u 0.9697 (0.9583) acc_u 6.2500 (4.6875) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [15/27] time 0.345 (0.336) data 0.266 (0.258) loss_u loss_u 0.9331 (0.9467) acc_u 6.2500 (5.8333) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [20/27] time 0.310 (0.333) data 0.231 (0.255) loss_u loss_u 0.8896 (0.9400) acc_u 12.5000 (6.7188) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/27] time 0.341 (0.334) data 0.262 (0.256) loss_u loss_u 0.9146 (0.9411) acc_u 9.3750 (6.6250) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4657, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 760
clean true:736
clean false:24
clean_rate:0.968421052631579
noisy true:634
noisy false:238
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 872
epoch [198/200] batch [5/23] time 0.350 (0.349) data 0.272 (0.271) loss_x loss_x 0.1825 (0.2553) acc_x 96.8750 (93.1250) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [10/23] time 0.342 (0.346) data 0.265 (0.268) loss_x loss_x 0.5547 (0.3177) acc_x 84.3750 (91.8750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/23] time 0.332 (0.343) data 0.254 (0.266) loss_x loss_x 0.2186 (0.3106) acc_x 93.7500 (92.9167) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/23] time 0.343 (0.342) data 0.265 (0.265) loss_x loss_x 0.3167 (0.3165) acc_x 87.5000 (92.9688) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [5/27] time 0.363 (0.342) data 0.283 (0.265) loss_u loss_u 0.8979 (0.9373) acc_u 12.5000 (8.7500) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [10/27] time 0.339 (0.342) data 0.261 (0.264) loss_u loss_u 0.8872 (0.9415) acc_u 12.5000 (7.1875) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [15/27] time 0.300 (0.341) data 0.221 (0.263) loss_u loss_u 0.9492 (0.9454) acc_u 6.2500 (7.0833) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [20/27] time 0.334 (0.339) data 0.256 (0.261) loss_u loss_u 0.9209 (0.9428) acc_u 9.3750 (7.5000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/27] time 0.341 (0.339) data 0.263 (0.261) loss_u loss_u 0.9062 (0.9438) acc_u 12.5000 (7.1250) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.4694, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 766
clean true:740
clean false:26
clean_rate:0.9660574412532638
noisy true:641
noisy false:225
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 866
epoch [199/200] batch [5/23] time 0.346 (0.361) data 0.269 (0.283) loss_x loss_x 0.2266 (0.1961) acc_x 93.7500 (96.2500) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [10/23] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.1620 (0.2226) acc_x 93.7500 (96.2500) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/23] time 0.354 (0.346) data 0.276 (0.268) loss_x loss_x 0.1606 (0.2360) acc_x 96.8750 (95.8333) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/23] time 0.333 (0.345) data 0.255 (0.267) loss_x loss_x 0.4998 (0.2672) acc_x 84.3750 (94.6875) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [5/27] time 0.341 (0.343) data 0.262 (0.266) loss_u loss_u 0.9473 (0.9313) acc_u 6.2500 (8.1250) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [10/27] time 0.371 (0.344) data 0.292 (0.266) loss_u loss_u 0.9204 (0.9409) acc_u 9.3750 (6.5625) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [15/27] time 0.325 (0.343) data 0.248 (0.265) loss_u loss_u 0.9976 (0.9504) acc_u 0.0000 (5.4167) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [20/27] time 0.347 (0.344) data 0.269 (0.266) loss_u loss_u 0.9434 (0.9511) acc_u 6.2500 (5.3125) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/27] time 0.355 (0.344) data 0.277 (0.266) loss_u loss_u 0.9487 (0.9494) acc_u 6.2500 (5.6250) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 284
confident_label rate tensor(0.4596, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 750
clean true:725
clean false:25
clean_rate:0.9666666666666667
noisy true:623
noisy false:259
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 882
epoch [200/200] batch [5/23] time 0.344 (0.351) data 0.267 (0.273) loss_x loss_x 0.3169 (0.3030) acc_x 93.7500 (93.7500) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [10/23] time 0.319 (0.344) data 0.242 (0.266) loss_x loss_x 0.3494 (0.3050) acc_x 90.6250 (92.5000) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/23] time 0.342 (0.341) data 0.264 (0.263) loss_x loss_x 0.3904 (0.3246) acc_x 93.7500 (92.5000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/23] time 0.350 (0.342) data 0.272 (0.265) loss_x loss_x 0.1536 (0.2980) acc_x 96.8750 (93.4375) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [5/27] time 0.347 (0.339) data 0.268 (0.261) loss_u loss_u 0.9375 (0.9424) acc_u 6.2500 (6.2500) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [10/27] time 0.364 (0.335) data 0.285 (0.257) loss_u loss_u 0.9082 (0.9334) acc_u 9.3750 (7.1875) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [15/27] time 0.359 (0.337) data 0.281 (0.259) loss_u loss_u 0.9214 (0.9332) acc_u 6.2500 (7.0833) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [20/27] time 0.359 (0.340) data 0.280 (0.262) loss_u loss_u 0.9316 (0.9321) acc_u 6.2500 (7.0312) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/27] time 0.454 (0.354) data 0.374 (0.276) loss_u loss_u 0.9502 (0.9340) acc_u 9.3750 (7.3750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,140
* accuracy: 86.9%
* error: 13.1%
* macro_f1: 86.8%
Elapsed: 2:01:44
