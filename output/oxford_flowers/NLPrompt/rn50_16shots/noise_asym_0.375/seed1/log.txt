***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1440, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 235
clean true:231
clean false:4
clean_rate:0.9829787234042553
noisy true:144
noisy false:1253
after delete: len(clean_dataset) 235
after delete: len(noisy_dataset) 1397
epoch [1/200] batch [5/7] time 0.342 (0.362) data 0.265 (0.265) loss_x loss_x 2.4551 (2.6641) acc_x 50.0000 (40.6250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/43] time 0.292 (0.334) data 0.213 (0.246) loss_u loss_u 0.9780 (0.9792) acc_u 3.1250 (3.1250) lr 1.0000e-05 eta 0:00:12
epoch [1/200] batch [10/43] time 0.313 (0.324) data 0.234 (0.239) loss_u loss_u 0.9834 (0.9773) acc_u 0.0000 (3.7500) lr 1.0000e-05 eta 0:00:10
epoch [1/200] batch [15/43] time 0.343 (0.327) data 0.265 (0.244) loss_u loss_u 0.9746 (0.9772) acc_u 3.1250 (3.9583) lr 1.0000e-05 eta 0:00:09
epoch [1/200] batch [20/43] time 0.323 (0.328) data 0.245 (0.245) loss_u loss_u 0.9785 (0.9756) acc_u 6.2500 (4.6875) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [25/43] time 0.324 (0.329) data 0.246 (0.248) loss_u loss_u 0.9346 (0.9726) acc_u 12.5000 (5.6250) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [30/43] time 0.333 (0.330) data 0.254 (0.249) loss_u loss_u 0.9829 (0.9729) acc_u 3.1250 (5.8333) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [35/43] time 0.329 (0.331) data 0.251 (0.250) loss_u loss_u 0.9429 (0.9716) acc_u 18.7500 (6.3393) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [40/43] time 0.344 (0.332) data 0.266 (0.251) loss_u loss_u 0.9717 (0.9696) acc_u 3.1250 (6.9531) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1047
confident_label rate tensor(0.2083, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 340
clean true:336
clean false:4
clean_rate:0.9882352941176471
noisy true:249
noisy false:1043
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1292
epoch [2/200] batch [5/10] time 0.338 (0.348) data 0.260 (0.270) loss_x loss_x 1.1240 (1.1729) acc_x 71.8750 (75.0000) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/10] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.5620 (0.8959) acc_x 84.3750 (80.0000) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/40] time 0.323 (0.344) data 0.243 (0.266) loss_u loss_u 0.7998 (0.8418) acc_u 31.2500 (20.6250) lr 2.0000e-03 eta 0:00:12
epoch [2/200] batch [10/40] time 0.321 (0.336) data 0.241 (0.258) loss_u loss_u 0.8394 (0.8467) acc_u 18.7500 (19.3750) lr 2.0000e-03 eta 0:00:10
epoch [2/200] batch [15/40] time 0.346 (0.338) data 0.268 (0.260) loss_u loss_u 0.7920 (0.8392) acc_u 25.0000 (21.6667) lr 2.0000e-03 eta 0:00:08
epoch [2/200] batch [20/40] time 0.333 (0.338) data 0.255 (0.259) loss_u loss_u 0.8486 (0.8340) acc_u 21.8750 (22.0312) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [25/40] time 0.333 (0.338) data 0.254 (0.260) loss_u loss_u 0.8242 (0.8361) acc_u 25.0000 (21.7500) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [30/40] time 0.346 (0.338) data 0.268 (0.260) loss_u loss_u 0.8779 (0.8361) acc_u 15.6250 (21.4583) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [35/40] time 0.350 (0.339) data 0.272 (0.261) loss_u loss_u 0.8320 (0.8370) acc_u 25.0000 (21.2500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [40/40] time 0.318 (0.338) data 0.239 (0.259) loss_u loss_u 0.8408 (0.8379) acc_u 21.8750 (21.4844) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 728
confident_label rate tensor(0.3505, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 572
clean true:567
clean false:5
clean_rate:0.9912587412587412
noisy true:337
noisy false:723
after delete: len(clean_dataset) 572
after delete: len(noisy_dataset) 1060
epoch [3/200] batch [5/17] time 0.342 (0.341) data 0.264 (0.264) loss_x loss_x 0.8105 (0.8414) acc_x 75.0000 (75.0000) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/17] time 0.336 (0.340) data 0.258 (0.263) loss_x loss_x 1.1279 (0.8583) acc_x 75.0000 (76.8750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [15/17] time 0.310 (0.337) data 0.232 (0.260) loss_x loss_x 0.7402 (0.8093) acc_x 84.3750 (79.5833) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/33] time 0.340 (0.330) data 0.261 (0.252) loss_u loss_u 0.9268 (0.9125) acc_u 6.2500 (10.6250) lr 1.9999e-03 eta 0:00:09
epoch [3/200] batch [10/33] time 0.339 (0.332) data 0.261 (0.254) loss_u loss_u 0.8193 (0.8809) acc_u 18.7500 (14.6875) lr 1.9999e-03 eta 0:00:07
epoch [3/200] batch [15/33] time 0.343 (0.333) data 0.265 (0.255) loss_u loss_u 0.9609 (0.8896) acc_u 3.1250 (13.7500) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [20/33] time 0.334 (0.333) data 0.256 (0.255) loss_u loss_u 0.9395 (0.8991) acc_u 3.1250 (12.3438) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [25/33] time 0.332 (0.334) data 0.252 (0.256) loss_u loss_u 0.9033 (0.8988) acc_u 12.5000 (12.5000) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [30/33] time 0.341 (0.334) data 0.262 (0.256) loss_u loss_u 0.8589 (0.8967) acc_u 18.7500 (12.7083) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 719
confident_label rate tensor(0.3523, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 575
clean true:568
clean false:7
clean_rate:0.9878260869565217
noisy true:345
noisy false:712
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1057
epoch [4/200] batch [5/17] time 0.338 (0.345) data 0.259 (0.267) loss_x loss_x 0.7500 (0.9427) acc_x 78.1250 (80.0000) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/17] time 0.342 (0.343) data 0.264 (0.265) loss_x loss_x 0.5845 (0.8827) acc_x 90.6250 (80.3125) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/17] time 0.338 (0.339) data 0.260 (0.261) loss_x loss_x 0.6724 (0.8364) acc_x 84.3750 (81.2500) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/33] time 0.304 (0.328) data 0.226 (0.250) loss_u loss_u 0.8232 (0.9137) acc_u 18.7500 (10.0000) lr 1.9995e-03 eta 0:00:09
epoch [4/200] batch [10/33] time 0.352 (0.332) data 0.273 (0.254) loss_u loss_u 0.8535 (0.8994) acc_u 18.7500 (11.8750) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [15/33] time 0.347 (0.333) data 0.269 (0.254) loss_u loss_u 0.9067 (0.8985) acc_u 15.6250 (12.7083) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [20/33] time 0.337 (0.335) data 0.259 (0.256) loss_u loss_u 0.9180 (0.9002) acc_u 12.5000 (12.8125) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [25/33] time 0.337 (0.335) data 0.259 (0.257) loss_u loss_u 0.7925 (0.8890) acc_u 21.8750 (13.8750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [30/33] time 0.330 (0.336) data 0.252 (0.258) loss_u loss_u 0.7646 (0.8854) acc_u 25.0000 (14.0625) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 666
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 617
clean true:612
clean false:5
clean_rate:0.9918962722852512
noisy true:354
noisy false:661
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 1015
epoch [5/200] batch [5/19] time 0.333 (0.338) data 0.256 (0.260) loss_x loss_x 1.1113 (0.9328) acc_x 78.1250 (78.7500) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/19] time 0.338 (0.338) data 0.261 (0.260) loss_x loss_x 0.7207 (0.8207) acc_x 84.3750 (81.5625) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/19] time 0.340 (0.340) data 0.263 (0.262) loss_x loss_x 0.6475 (0.7554) acc_x 81.2500 (82.2917) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [5/31] time 0.335 (0.336) data 0.256 (0.258) loss_u loss_u 0.8872 (0.9101) acc_u 18.7500 (11.8750) lr 1.9989e-03 eta 0:00:08
epoch [5/200] batch [10/31] time 0.353 (0.338) data 0.274 (0.259) loss_u loss_u 0.8438 (0.9052) acc_u 21.8750 (12.5000) lr 1.9989e-03 eta 0:00:07
epoch [5/200] batch [15/31] time 0.331 (0.340) data 0.253 (0.262) loss_u loss_u 0.9077 (0.9099) acc_u 12.5000 (12.0833) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [20/31] time 0.336 (0.339) data 0.257 (0.261) loss_u loss_u 0.8936 (0.9072) acc_u 12.5000 (12.5000) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [25/31] time 0.350 (0.340) data 0.272 (0.262) loss_u loss_u 0.9478 (0.9024) acc_u 6.2500 (12.7500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [30/31] time 0.350 (0.341) data 0.270 (0.263) loss_u loss_u 0.9097 (0.9043) acc_u 9.3750 (12.0833) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 651
confident_label rate tensor(0.3817, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 623
clean true:618
clean false:5
clean_rate:0.9919743178170144
noisy true:363
noisy false:646
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 1009
epoch [6/200] batch [5/19] time 0.341 (0.348) data 0.263 (0.269) loss_x loss_x 0.4800 (0.6541) acc_x 93.7500 (85.0000) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/19] time 0.340 (0.346) data 0.263 (0.268) loss_x loss_x 0.9316 (0.7172) acc_x 75.0000 (82.5000) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/19] time 0.310 (0.339) data 0.232 (0.261) loss_x loss_x 0.6704 (0.6960) acc_x 84.3750 (82.9167) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [5/31] time 0.354 (0.337) data 0.276 (0.259) loss_u loss_u 0.9170 (0.9014) acc_u 9.3750 (12.5000) lr 1.9980e-03 eta 0:00:08
epoch [6/200] batch [10/31] time 0.328 (0.337) data 0.250 (0.259) loss_u loss_u 0.9751 (0.9087) acc_u 0.0000 (10.6250) lr 1.9980e-03 eta 0:00:07
epoch [6/200] batch [15/31] time 0.328 (0.337) data 0.249 (0.258) loss_u loss_u 0.9067 (0.9139) acc_u 12.5000 (10.0000) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [20/31] time 0.325 (0.336) data 0.246 (0.257) loss_u loss_u 0.8389 (0.9102) acc_u 18.7500 (11.0938) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [25/31] time 0.333 (0.336) data 0.255 (0.257) loss_u loss_u 0.9341 (0.9066) acc_u 9.3750 (11.5000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [30/31] time 0.333 (0.335) data 0.255 (0.257) loss_u loss_u 0.9150 (0.9070) acc_u 12.5000 (11.7708) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 642
confident_label rate tensor(0.3934, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 642
clean true:637
clean false:5
clean_rate:0.9922118380062306
noisy true:353
noisy false:637
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 990
epoch [7/200] batch [5/20] time 0.327 (0.341) data 0.250 (0.263) loss_x loss_x 0.8779 (0.8526) acc_x 78.1250 (80.6250) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [10/20] time 0.305 (0.327) data 0.227 (0.250) loss_x loss_x 0.3958 (0.7478) acc_x 93.7500 (82.1875) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [15/20] time 0.296 (0.326) data 0.217 (0.248) loss_x loss_x 0.9536 (0.7106) acc_x 75.0000 (82.9167) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/20] time 0.319 (0.323) data 0.241 (0.245) loss_x loss_x 0.7129 (0.7425) acc_x 84.3750 (82.1875) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/30] time 0.334 (0.322) data 0.256 (0.244) loss_u loss_u 0.8916 (0.9249) acc_u 15.6250 (10.6250) lr 1.9969e-03 eta 0:00:08
epoch [7/200] batch [10/30] time 0.345 (0.325) data 0.266 (0.247) loss_u loss_u 0.9155 (0.9013) acc_u 12.5000 (12.8125) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [15/30] time 0.339 (0.327) data 0.259 (0.249) loss_u loss_u 0.8677 (0.8998) acc_u 15.6250 (13.1250) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [20/30] time 0.339 (0.328) data 0.260 (0.250) loss_u loss_u 0.8965 (0.8981) acc_u 9.3750 (13.2812) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [25/30] time 0.358 (0.330) data 0.279 (0.252) loss_u loss_u 0.9604 (0.9059) acc_u 3.1250 (12.0000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [30/30] time 0.358 (0.333) data 0.277 (0.255) loss_u loss_u 0.8730 (0.9035) acc_u 15.6250 (12.1875) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 645
confident_label rate tensor(0.3799, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 620
clean true:613
clean false:7
clean_rate:0.9887096774193549
noisy true:374
noisy false:638
after delete: len(clean_dataset) 620
after delete: len(noisy_dataset) 1012
epoch [8/200] batch [5/19] time 0.355 (0.350) data 0.276 (0.272) loss_x loss_x 0.8271 (0.8195) acc_x 78.1250 (81.2500) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/19] time 0.335 (0.344) data 0.257 (0.266) loss_x loss_x 0.8315 (0.8285) acc_x 78.1250 (81.2500) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/19] time 0.339 (0.344) data 0.260 (0.265) loss_x loss_x 0.5796 (0.7625) acc_x 87.5000 (82.5000) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [5/31] time 0.308 (0.335) data 0.228 (0.256) loss_u loss_u 0.8872 (0.8911) acc_u 12.5000 (12.5000) lr 1.9956e-03 eta 0:00:08
epoch [8/200] batch [10/31] time 0.343 (0.333) data 0.265 (0.255) loss_u loss_u 0.9805 (0.8997) acc_u 0.0000 (12.1875) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [15/31] time 0.338 (0.334) data 0.260 (0.255) loss_u loss_u 0.8345 (0.8886) acc_u 18.7500 (14.5833) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [20/31] time 0.346 (0.335) data 0.268 (0.257) loss_u loss_u 0.8750 (0.8902) acc_u 18.7500 (14.3750) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [25/31] time 0.346 (0.336) data 0.266 (0.257) loss_u loss_u 0.9189 (0.8893) acc_u 15.6250 (14.3750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [30/31] time 0.349 (0.337) data 0.271 (0.258) loss_u loss_u 0.8994 (0.8903) acc_u 9.3750 (14.0625) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 612
confident_label rate tensor(0.4093, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 668
clean true:661
clean false:7
clean_rate:0.9895209580838323
noisy true:359
noisy false:605
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 964
epoch [9/200] batch [5/20] time 0.335 (0.345) data 0.257 (0.267) loss_x loss_x 0.6235 (0.5437) acc_x 87.5000 (88.7500) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [10/20] time 0.356 (0.345) data 0.278 (0.267) loss_x loss_x 0.8623 (0.6361) acc_x 84.3750 (85.6250) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/20] time 0.333 (0.342) data 0.255 (0.264) loss_x loss_x 0.6235 (0.6678) acc_x 84.3750 (85.4167) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/20] time 0.289 (0.339) data 0.211 (0.261) loss_x loss_x 0.8765 (0.6823) acc_x 81.2500 (83.9062) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/30] time 0.310 (0.332) data 0.230 (0.253) loss_u loss_u 0.9004 (0.8991) acc_u 15.6250 (15.0000) lr 1.9940e-03 eta 0:00:08
epoch [9/200] batch [10/30] time 0.351 (0.333) data 0.272 (0.254) loss_u loss_u 0.9121 (0.8843) acc_u 12.5000 (15.6250) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [15/30] time 0.346 (0.334) data 0.267 (0.256) loss_u loss_u 0.9771 (0.8942) acc_u 3.1250 (13.7500) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [20/30] time 0.355 (0.335) data 0.277 (0.257) loss_u loss_u 0.9224 (0.8936) acc_u 6.2500 (13.5938) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [25/30] time 0.336 (0.335) data 0.258 (0.257) loss_u loss_u 0.9688 (0.9002) acc_u 3.1250 (12.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [30/30] time 0.328 (0.335) data 0.249 (0.257) loss_u loss_u 0.9375 (0.9021) acc_u 9.3750 (12.1875) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 605
confident_label rate tensor(0.4026, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 657
clean true:648
clean false:9
clean_rate:0.9863013698630136
noisy true:379
noisy false:596
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 975
epoch [10/200] batch [5/20] time 0.297 (0.316) data 0.219 (0.238) loss_x loss_x 0.7607 (0.5944) acc_x 84.3750 (83.7500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/20] time 0.327 (0.319) data 0.249 (0.241) loss_x loss_x 0.7700 (0.6079) acc_x 84.3750 (84.0625) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [15/20] time 0.325 (0.329) data 0.247 (0.251) loss_x loss_x 0.6855 (0.5998) acc_x 81.2500 (83.9583) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/20] time 0.308 (0.327) data 0.229 (0.249) loss_x loss_x 0.3218 (0.6023) acc_x 90.6250 (83.2812) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/30] time 0.346 (0.324) data 0.267 (0.245) loss_u loss_u 0.8862 (0.9002) acc_u 15.6250 (11.8750) lr 1.9921e-03 eta 0:00:08
epoch [10/200] batch [10/30] time 0.352 (0.327) data 0.273 (0.249) loss_u loss_u 0.9077 (0.9122) acc_u 12.5000 (10.3125) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [15/30] time 0.335 (0.330) data 0.256 (0.252) loss_u loss_u 0.8379 (0.9059) acc_u 25.0000 (11.0417) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [20/30] time 0.353 (0.330) data 0.275 (0.252) loss_u loss_u 0.9014 (0.8944) acc_u 12.5000 (12.6562) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [25/30] time 0.337 (0.332) data 0.259 (0.254) loss_u loss_u 0.8569 (0.8979) acc_u 15.6250 (12.1250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [30/30] time 0.334 (0.333) data 0.256 (0.254) loss_u loss_u 0.9487 (0.8983) acc_u 6.2500 (11.9792) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 581
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 665
clean true:655
clean false:10
clean_rate:0.9849624060150376
noisy true:396
noisy false:571
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 967
epoch [11/200] batch [5/20] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.7080 (0.5813) acc_x 81.2500 (86.2500) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [10/20] time 0.334 (0.341) data 0.256 (0.263) loss_x loss_x 0.8457 (0.5923) acc_x 75.0000 (84.3750) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/20] time 0.333 (0.339) data 0.255 (0.261) loss_x loss_x 0.4690 (0.5770) acc_x 93.7500 (86.0417) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/20] time 0.334 (0.339) data 0.256 (0.261) loss_x loss_x 0.8374 (0.5941) acc_x 87.5000 (85.4688) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/30] time 0.331 (0.337) data 0.253 (0.259) loss_u loss_u 0.8916 (0.9103) acc_u 9.3750 (10.6250) lr 1.9900e-03 eta 0:00:08
epoch [11/200] batch [10/30] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9370 (0.9160) acc_u 6.2500 (10.0000) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [15/30] time 0.335 (0.336) data 0.257 (0.258) loss_u loss_u 0.9258 (0.9156) acc_u 9.3750 (10.0000) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [20/30] time 0.336 (0.337) data 0.258 (0.259) loss_u loss_u 0.8730 (0.9165) acc_u 15.6250 (10.0000) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [25/30] time 0.343 (0.338) data 0.265 (0.260) loss_u loss_u 0.9438 (0.9069) acc_u 9.3750 (11.1250) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [30/30] time 0.336 (0.338) data 0.258 (0.260) loss_u loss_u 0.8242 (0.9075) acc_u 18.7500 (11.2500) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 571
confident_label rate tensor(0.4210, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 687
clean true:678
clean false:9
clean_rate:0.9868995633187773
noisy true:383
noisy false:562
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 945
epoch [12/200] batch [5/21] time 0.348 (0.339) data 0.270 (0.261) loss_x loss_x 0.5151 (0.6733) acc_x 87.5000 (86.8750) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [10/21] time 0.344 (0.341) data 0.267 (0.263) loss_x loss_x 0.4465 (0.6294) acc_x 90.6250 (85.9375) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/21] time 0.342 (0.342) data 0.264 (0.264) loss_x loss_x 0.3142 (0.6396) acc_x 93.7500 (85.2083) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/21] time 0.292 (0.338) data 0.214 (0.259) loss_x loss_x 0.4475 (0.6346) acc_x 84.3750 (84.5312) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/29] time 0.353 (0.331) data 0.274 (0.253) loss_u loss_u 0.8018 (0.8759) acc_u 21.8750 (14.3750) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [10/29] time 0.348 (0.333) data 0.269 (0.255) loss_u loss_u 0.9180 (0.8881) acc_u 9.3750 (12.8125) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [15/29] time 0.351 (0.335) data 0.273 (0.256) loss_u loss_u 0.8784 (0.8953) acc_u 12.5000 (12.7083) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [20/29] time 0.351 (0.337) data 0.273 (0.258) loss_u loss_u 0.9468 (0.8983) acc_u 9.3750 (12.6562) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [25/29] time 0.339 (0.338) data 0.260 (0.259) loss_u loss_u 0.8677 (0.8933) acc_u 18.7500 (13.3750) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 558
confident_label rate tensor(0.4271, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 697
clean true:685
clean false:12
clean_rate:0.9827833572453372
noisy true:389
noisy false:546
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 935
epoch [13/200] batch [5/21] time 0.348 (0.343) data 0.270 (0.266) loss_x loss_x 0.7944 (0.7565) acc_x 81.2500 (83.7500) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [10/21] time 0.346 (0.344) data 0.269 (0.266) loss_x loss_x 0.6553 (0.6335) acc_x 87.5000 (85.9375) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/21] time 0.321 (0.344) data 0.243 (0.267) loss_x loss_x 0.5454 (0.5940) acc_x 87.5000 (85.8333) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/21] time 0.346 (0.337) data 0.268 (0.259) loss_x loss_x 0.5132 (0.5866) acc_x 84.3750 (85.3125) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/29] time 0.298 (0.335) data 0.219 (0.257) loss_u loss_u 0.8882 (0.9018) acc_u 15.6250 (12.5000) lr 1.9851e-03 eta 0:00:08
epoch [13/200] batch [10/29] time 0.333 (0.332) data 0.254 (0.254) loss_u loss_u 0.9282 (0.9052) acc_u 9.3750 (11.8750) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [15/29] time 0.334 (0.332) data 0.256 (0.254) loss_u loss_u 0.8711 (0.9106) acc_u 18.7500 (10.8333) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/29] time 0.321 (0.332) data 0.243 (0.254) loss_u loss_u 0.9229 (0.9103) acc_u 9.3750 (11.2500) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [25/29] time 0.344 (0.334) data 0.266 (0.256) loss_u loss_u 0.9058 (0.9086) acc_u 9.3750 (11.6250) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 564
confident_label rate tensor(0.4240, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 692
clean true:680
clean false:12
clean_rate:0.9826589595375722
noisy true:388
noisy false:552
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 940
epoch [14/200] batch [5/21] time 0.348 (0.348) data 0.270 (0.270) loss_x loss_x 0.5532 (0.5582) acc_x 90.6250 (88.1250) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [10/21] time 0.338 (0.345) data 0.260 (0.267) loss_x loss_x 0.3911 (0.5271) acc_x 96.8750 (90.0000) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/21] time 0.341 (0.338) data 0.263 (0.260) loss_x loss_x 0.5513 (0.5346) acc_x 87.5000 (88.7500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/21] time 0.345 (0.338) data 0.267 (0.260) loss_x loss_x 0.4937 (0.5163) acc_x 87.5000 (88.9062) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/29] time 0.292 (0.332) data 0.212 (0.254) loss_u loss_u 0.8750 (0.8905) acc_u 15.6250 (13.1250) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [10/29] time 0.340 (0.330) data 0.262 (0.251) loss_u loss_u 0.8091 (0.8826) acc_u 25.0000 (15.3125) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [15/29] time 0.343 (0.332) data 0.265 (0.254) loss_u loss_u 0.8159 (0.8818) acc_u 21.8750 (15.2083) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [20/29] time 0.341 (0.333) data 0.263 (0.255) loss_u loss_u 0.9648 (0.8948) acc_u 3.1250 (13.4375) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [25/29] time 0.340 (0.334) data 0.262 (0.256) loss_u loss_u 0.9126 (0.8918) acc_u 9.3750 (13.6250) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 513
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 720
clean true:709
clean false:11
clean_rate:0.9847222222222223
noisy true:410
noisy false:502
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 912
epoch [15/200] batch [5/22] time 0.330 (0.341) data 0.252 (0.263) loss_x loss_x 0.9761 (0.7354) acc_x 62.5000 (80.0000) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/22] time 0.357 (0.340) data 0.279 (0.262) loss_x loss_x 0.4558 (0.6963) acc_x 90.6250 (81.5625) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [15/22] time 0.334 (0.338) data 0.257 (0.260) loss_x loss_x 0.7485 (0.6317) acc_x 81.2500 (83.5417) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/22] time 0.328 (0.337) data 0.250 (0.259) loss_x loss_x 0.6626 (0.6145) acc_x 87.5000 (83.9062) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/28] time 0.296 (0.334) data 0.217 (0.256) loss_u loss_u 0.8921 (0.8974) acc_u 12.5000 (11.8750) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [10/28] time 0.306 (0.332) data 0.227 (0.254) loss_u loss_u 0.9570 (0.9085) acc_u 6.2500 (11.8750) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/28] time 0.362 (0.333) data 0.282 (0.255) loss_u loss_u 0.9297 (0.9072) acc_u 9.3750 (11.4583) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [20/28] time 0.324 (0.334) data 0.245 (0.255) loss_u loss_u 0.9014 (0.9035) acc_u 12.5000 (11.8750) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/28] time 0.335 (0.334) data 0.257 (0.256) loss_u loss_u 0.9229 (0.9077) acc_u 9.3750 (11.3750) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 528
confident_label rate tensor(0.4357, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 711
clean true:699
clean false:12
clean_rate:0.9831223628691983
noisy true:405
noisy false:516
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 921
epoch [16/200] batch [5/22] time 0.357 (0.346) data 0.278 (0.268) loss_x loss_x 0.6514 (0.5485) acc_x 81.2500 (86.2500) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/22] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.5054 (0.5860) acc_x 90.6250 (85.3125) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [15/22] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.7227 (0.5566) acc_x 84.3750 (86.6667) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/22] time 0.309 (0.341) data 0.231 (0.263) loss_x loss_x 0.7827 (0.5660) acc_x 75.0000 (86.4062) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/28] time 0.358 (0.343) data 0.279 (0.265) loss_u loss_u 0.9165 (0.9170) acc_u 12.5000 (10.6250) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [10/28] time 0.302 (0.338) data 0.223 (0.260) loss_u loss_u 0.9663 (0.9221) acc_u 6.2500 (10.0000) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [15/28] time 0.341 (0.339) data 0.263 (0.260) loss_u loss_u 0.9165 (0.9177) acc_u 12.5000 (10.2083) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [20/28] time 0.339 (0.338) data 0.261 (0.260) loss_u loss_u 0.9048 (0.9152) acc_u 9.3750 (10.6250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/28] time 0.347 (0.339) data 0.269 (0.261) loss_u loss_u 0.8857 (0.9101) acc_u 9.3750 (11.2500) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 519
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 713
clean true:702
clean false:11
clean_rate:0.9845722300140253
noisy true:411
noisy false:508
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 919
epoch [17/200] batch [5/22] time 0.355 (0.352) data 0.276 (0.274) loss_x loss_x 0.5630 (0.6381) acc_x 87.5000 (85.6250) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/22] time 0.328 (0.346) data 0.250 (0.268) loss_x loss_x 0.4019 (0.5781) acc_x 93.7500 (86.2500) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [15/22] time 0.338 (0.344) data 0.261 (0.266) loss_x loss_x 0.6538 (0.6349) acc_x 87.5000 (83.7500) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/22] time 0.292 (0.338) data 0.214 (0.260) loss_x loss_x 0.7012 (0.6370) acc_x 81.2500 (82.8125) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/28] time 0.338 (0.338) data 0.260 (0.260) loss_u loss_u 0.8975 (0.8842) acc_u 12.5000 (13.7500) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [10/28] time 0.300 (0.333) data 0.221 (0.255) loss_u loss_u 0.9097 (0.8975) acc_u 9.3750 (12.8125) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [15/28] time 0.325 (0.329) data 0.246 (0.251) loss_u loss_u 0.8984 (0.9010) acc_u 15.6250 (12.9167) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [20/28] time 0.336 (0.330) data 0.258 (0.252) loss_u loss_u 0.8647 (0.8944) acc_u 18.7500 (13.9062) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/28] time 0.341 (0.332) data 0.262 (0.253) loss_u loss_u 0.9019 (0.8974) acc_u 12.5000 (13.3750) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 490
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:732
clean false:12
clean_rate:0.9838709677419355
noisy true:410
noisy false:478
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [18/200] batch [5/23] time 0.344 (0.349) data 0.266 (0.271) loss_x loss_x 0.3918 (0.6149) acc_x 90.6250 (86.2500) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [10/23] time 0.354 (0.348) data 0.276 (0.270) loss_x loss_x 0.4602 (0.5347) acc_x 93.7500 (88.4375) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [15/23] time 0.347 (0.347) data 0.269 (0.269) loss_x loss_x 0.6494 (0.5905) acc_x 81.2500 (85.8333) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/23] time 0.349 (0.347) data 0.271 (0.269) loss_x loss_x 0.4817 (0.5852) acc_x 90.6250 (85.6250) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [5/27] time 0.288 (0.341) data 0.209 (0.263) loss_u loss_u 0.9238 (0.9153) acc_u 9.3750 (10.6250) lr 1.9686e-03 eta 0:00:07
epoch [18/200] batch [10/27] time 0.349 (0.339) data 0.270 (0.260) loss_u loss_u 0.9146 (0.9065) acc_u 9.3750 (11.8750) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [15/27] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.9258 (0.9105) acc_u 9.3750 (11.6667) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [20/27] time 0.346 (0.340) data 0.267 (0.262) loss_u loss_u 0.9238 (0.9078) acc_u 9.3750 (11.7188) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [25/27] time 0.344 (0.341) data 0.266 (0.262) loss_u loss_u 0.9346 (0.9149) acc_u 9.3750 (11.2500) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 539
confident_label rate tensor(0.4326, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 706
clean true:694
clean false:12
clean_rate:0.9830028328611898
noisy true:399
noisy false:527
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 926
epoch [19/200] batch [5/22] time 0.353 (0.357) data 0.275 (0.279) loss_x loss_x 0.5806 (0.5199) acc_x 84.3750 (86.8750) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [10/22] time 0.333 (0.350) data 0.255 (0.272) loss_x loss_x 0.4941 (0.5088) acc_x 84.3750 (85.9375) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [15/22] time 0.294 (0.341) data 0.217 (0.264) loss_x loss_x 0.6372 (0.5024) acc_x 81.2500 (86.8750) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/22] time 0.346 (0.340) data 0.268 (0.262) loss_x loss_x 0.3511 (0.4982) acc_x 90.6250 (87.1875) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/28] time 0.312 (0.333) data 0.233 (0.255) loss_u loss_u 0.9409 (0.9000) acc_u 6.2500 (11.8750) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [10/28] time 0.344 (0.333) data 0.265 (0.254) loss_u loss_u 0.9399 (0.9196) acc_u 6.2500 (10.0000) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [15/28] time 0.362 (0.336) data 0.283 (0.257) loss_u loss_u 0.9546 (0.9189) acc_u 6.2500 (10.0000) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [20/28] time 0.351 (0.337) data 0.273 (0.258) loss_u loss_u 0.9370 (0.9108) acc_u 6.2500 (10.7812) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [25/28] time 0.353 (0.338) data 0.274 (0.259) loss_u loss_u 0.9482 (0.9104) acc_u 3.1250 (10.6250) lr 1.9646e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 477
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:742
clean false:10
clean_rate:0.9867021276595744
noisy true:413
noisy false:467
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [20/200] batch [5/23] time 0.344 (0.348) data 0.267 (0.270) loss_x loss_x 0.5259 (0.6550) acc_x 81.2500 (83.7500) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [10/23] time 0.325 (0.341) data 0.247 (0.263) loss_x loss_x 1.3574 (0.6784) acc_x 71.8750 (84.6875) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/23] time 0.339 (0.343) data 0.260 (0.265) loss_x loss_x 0.8008 (0.6356) acc_x 87.5000 (86.0417) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/23] time 0.338 (0.342) data 0.259 (0.264) loss_x loss_x 0.5142 (0.5965) acc_x 84.3750 (86.0938) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [5/27] time 0.335 (0.331) data 0.256 (0.252) loss_u loss_u 0.8901 (0.9194) acc_u 15.6250 (9.3750) lr 1.9603e-03 eta 0:00:07
epoch [20/200] batch [10/27] time 0.349 (0.333) data 0.271 (0.255) loss_u loss_u 0.9028 (0.9223) acc_u 12.5000 (9.6875) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [15/27] time 0.343 (0.334) data 0.264 (0.256) loss_u loss_u 0.9336 (0.9160) acc_u 6.2500 (10.4167) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [20/27] time 0.344 (0.335) data 0.266 (0.256) loss_u loss_u 0.8706 (0.9066) acc_u 18.7500 (11.8750) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [25/27] time 0.344 (0.336) data 0.265 (0.257) loss_u loss_u 0.9248 (0.9101) acc_u 9.3750 (11.2500) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 476
confident_label rate tensor(0.4688, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 765
clean true:753
clean false:12
clean_rate:0.984313725490196
noisy true:403
noisy false:464
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 867
epoch [21/200] batch [5/23] time 0.312 (0.331) data 0.234 (0.253) loss_x loss_x 0.6807 (0.6461) acc_x 75.0000 (81.2500) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [10/23] time 0.338 (0.331) data 0.260 (0.253) loss_x loss_x 0.8740 (0.6497) acc_x 75.0000 (82.5000) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [15/23] time 0.298 (0.329) data 0.220 (0.251) loss_x loss_x 0.8335 (0.6048) acc_x 78.1250 (83.5417) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/23] time 0.335 (0.330) data 0.257 (0.252) loss_x loss_x 0.5103 (0.5613) acc_x 84.3750 (84.5312) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/27] time 0.314 (0.328) data 0.235 (0.250) loss_u loss_u 0.9150 (0.9055) acc_u 9.3750 (11.8750) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [10/27] time 0.349 (0.329) data 0.270 (0.251) loss_u loss_u 0.9683 (0.9204) acc_u 3.1250 (10.0000) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [15/27] time 0.351 (0.331) data 0.272 (0.253) loss_u loss_u 0.8691 (0.9224) acc_u 15.6250 (9.7917) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/27] time 0.336 (0.333) data 0.257 (0.255) loss_u loss_u 0.8862 (0.9117) acc_u 15.6250 (11.2500) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [25/27] time 0.358 (0.334) data 0.279 (0.256) loss_u loss_u 0.9517 (0.9096) acc_u 6.2500 (11.5000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 456
confident_label rate tensor(0.4669, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 762
clean true:752
clean false:10
clean_rate:0.9868766404199475
noisy true:424
noisy false:446
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 870
epoch [22/200] batch [5/23] time 0.350 (0.348) data 0.273 (0.270) loss_x loss_x 0.5142 (0.6560) acc_x 87.5000 (83.1250) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [10/23] time 0.326 (0.343) data 0.248 (0.265) loss_x loss_x 0.8086 (0.5942) acc_x 81.2500 (85.0000) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [15/23] time 0.350 (0.344) data 0.271 (0.267) loss_x loss_x 0.4092 (0.5874) acc_x 87.5000 (85.2083) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/23] time 0.344 (0.344) data 0.266 (0.266) loss_x loss_x 0.5649 (0.6001) acc_x 93.7500 (85.6250) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [5/27] time 0.296 (0.338) data 0.216 (0.260) loss_u loss_u 0.8643 (0.9047) acc_u 18.7500 (11.2500) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [10/27] time 0.333 (0.337) data 0.255 (0.258) loss_u loss_u 0.9180 (0.9025) acc_u 12.5000 (12.1875) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [15/27] time 0.345 (0.338) data 0.267 (0.260) loss_u loss_u 0.8984 (0.8937) acc_u 15.6250 (13.3333) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [20/27] time 0.344 (0.339) data 0.266 (0.260) loss_u loss_u 0.9175 (0.9027) acc_u 9.3750 (12.0312) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/27] time 0.337 (0.339) data 0.259 (0.261) loss_u loss_u 0.8901 (0.9045) acc_u 15.6250 (11.6250) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 450
confident_label rate tensor(0.4718, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 770
clean true:756
clean false:14
clean_rate:0.9818181818181818
noisy true:426
noisy false:436
after delete: len(clean_dataset) 770
after delete: len(noisy_dataset) 862
epoch [23/200] batch [5/24] time 0.329 (0.350) data 0.251 (0.272) loss_x loss_x 0.4971 (0.4426) acc_x 84.3750 (86.8750) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [10/24] time 0.344 (0.345) data 0.267 (0.268) loss_x loss_x 0.4167 (0.5319) acc_x 93.7500 (86.2500) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [15/24] time 0.351 (0.344) data 0.272 (0.267) loss_x loss_x 0.5591 (0.5282) acc_x 81.2500 (86.6667) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/24] time 0.388 (0.352) data 0.309 (0.274) loss_x loss_x 0.6694 (0.5174) acc_x 87.5000 (86.2500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [5/26] time 0.367 (0.356) data 0.288 (0.277) loss_u loss_u 0.9512 (0.9365) acc_u 6.2500 (8.1250) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [10/26] time 0.347 (0.354) data 0.269 (0.276) loss_u loss_u 0.9058 (0.9145) acc_u 12.5000 (10.6250) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [15/26] time 0.335 (0.353) data 0.257 (0.274) loss_u loss_u 0.8569 (0.9090) acc_u 15.6250 (10.8333) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/26] time 0.346 (0.353) data 0.267 (0.274) loss_u loss_u 0.9351 (0.9068) acc_u 6.2500 (10.9375) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [25/26] time 0.370 (0.354) data 0.291 (0.276) loss_u loss_u 0.9531 (0.9097) acc_u 6.2500 (10.6250) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 498
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:726
clean false:14
clean_rate:0.981081081081081
noisy true:408
noisy false:484
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [24/200] batch [5/23] time 0.344 (0.349) data 0.265 (0.271) loss_x loss_x 0.6465 (0.5895) acc_x 81.2500 (87.5000) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [10/23] time 0.332 (0.342) data 0.254 (0.264) loss_x loss_x 0.7515 (0.6072) acc_x 81.2500 (85.6250) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [15/23] time 0.353 (0.342) data 0.275 (0.264) loss_x loss_x 0.5010 (0.5863) acc_x 87.5000 (85.6250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/23] time 0.353 (0.344) data 0.276 (0.265) loss_x loss_x 0.5972 (0.5809) acc_x 81.2500 (85.4688) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [5/27] time 0.349 (0.339) data 0.270 (0.260) loss_u loss_u 0.8794 (0.8919) acc_u 12.5000 (13.1250) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [10/27] time 0.344 (0.340) data 0.265 (0.261) loss_u loss_u 0.8457 (0.8907) acc_u 21.8750 (13.7500) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [15/27] time 0.352 (0.340) data 0.274 (0.262) loss_u loss_u 0.7764 (0.8855) acc_u 25.0000 (14.3750) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [20/27] time 0.328 (0.339) data 0.250 (0.261) loss_u loss_u 0.8486 (0.8888) acc_u 18.7500 (13.7500) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [25/27] time 0.327 (0.338) data 0.249 (0.260) loss_u loss_u 0.8608 (0.8850) acc_u 18.7500 (14.2500) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 457
confident_label rate tensor(0.4706, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 768
clean true:757
clean false:11
clean_rate:0.9856770833333334
noisy true:418
noisy false:446
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 864
epoch [25/200] batch [5/24] time 0.332 (0.327) data 0.252 (0.248) loss_x loss_x 0.5044 (0.5229) acc_x 84.3750 (84.3750) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [10/24] time 0.337 (0.333) data 0.258 (0.254) loss_x loss_x 0.3752 (0.5489) acc_x 90.6250 (84.6875) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [15/24] time 0.322 (0.336) data 0.243 (0.257) loss_x loss_x 0.2903 (0.5468) acc_x 93.7500 (86.2500) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [20/24] time 0.342 (0.336) data 0.264 (0.258) loss_x loss_x 0.3425 (0.5765) acc_x 90.6250 (86.0938) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [5/27] time 0.345 (0.341) data 0.266 (0.262) loss_u loss_u 0.9478 (0.9165) acc_u 6.2500 (9.3750) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [10/27] time 0.334 (0.341) data 0.256 (0.262) loss_u loss_u 0.8940 (0.9050) acc_u 12.5000 (11.2500) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [15/27] time 0.341 (0.341) data 0.263 (0.262) loss_u loss_u 0.8394 (0.8984) acc_u 18.7500 (12.2917) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [20/27] time 0.342 (0.340) data 0.263 (0.262) loss_u loss_u 0.9253 (0.9059) acc_u 12.5000 (11.4062) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [25/27] time 0.338 (0.339) data 0.260 (0.261) loss_u loss_u 0.8784 (0.9062) acc_u 15.6250 (11.5000) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 465
confident_label rate tensor(0.4694, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 766
clean true:756
clean false:10
clean_rate:0.9869451697127938
noisy true:411
noisy false:455
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 866
epoch [26/200] batch [5/23] time 0.341 (0.339) data 0.263 (0.260) loss_x loss_x 0.3303 (0.4610) acc_x 87.5000 (91.8750) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [10/23] time 0.329 (0.330) data 0.251 (0.252) loss_x loss_x 0.4922 (0.4979) acc_x 87.5000 (89.0625) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [15/23] time 0.318 (0.332) data 0.240 (0.253) loss_x loss_x 0.5859 (0.5506) acc_x 87.5000 (87.5000) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/23] time 0.329 (0.331) data 0.250 (0.253) loss_x loss_x 0.6753 (0.5511) acc_x 87.5000 (87.5000) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/27] time 0.341 (0.333) data 0.262 (0.255) loss_u loss_u 0.9600 (0.9282) acc_u 6.2500 (9.3750) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [10/27] time 0.348 (0.335) data 0.269 (0.257) loss_u loss_u 0.8760 (0.9105) acc_u 18.7500 (12.1875) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [15/27] time 0.343 (0.336) data 0.266 (0.257) loss_u loss_u 0.8975 (0.9059) acc_u 12.5000 (12.0833) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [20/27] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.9272 (0.9059) acc_u 12.5000 (12.0312) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/27] time 0.338 (0.336) data 0.260 (0.258) loss_u loss_u 0.9150 (0.9041) acc_u 9.3750 (11.8750) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 449
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:742
clean false:11
clean_rate:0.9853917662682603
noisy true:441
noisy false:438
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [27/200] batch [5/23] time 0.292 (0.328) data 0.214 (0.250) loss_x loss_x 0.6318 (0.5027) acc_x 87.5000 (88.7500) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/23] time 0.332 (0.319) data 0.254 (0.241) loss_x loss_x 0.3982 (0.4916) acc_x 90.6250 (88.7500) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/23] time 0.328 (0.322) data 0.249 (0.244) loss_x loss_x 0.5454 (0.5347) acc_x 84.3750 (87.2917) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/23] time 0.341 (0.326) data 0.263 (0.248) loss_x loss_x 0.6177 (0.5086) acc_x 87.5000 (88.1250) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/27] time 0.335 (0.330) data 0.257 (0.252) loss_u loss_u 0.9004 (0.8826) acc_u 9.3750 (15.0000) lr 1.9239e-03 eta 0:00:07
epoch [27/200] batch [10/27] time 0.338 (0.333) data 0.258 (0.254) loss_u loss_u 0.8970 (0.8812) acc_u 12.5000 (15.0000) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [15/27] time 0.347 (0.334) data 0.268 (0.255) loss_u loss_u 0.8862 (0.8907) acc_u 12.5000 (13.5417) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [20/27] time 0.341 (0.334) data 0.263 (0.256) loss_u loss_u 0.8745 (0.8903) acc_u 12.5000 (13.4375) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [25/27] time 0.347 (0.335) data 0.269 (0.257) loss_u loss_u 0.9595 (0.8983) acc_u 3.1250 (12.5000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 453
confident_label rate tensor(0.4700, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 767
clean true:758
clean false:9
clean_rate:0.9882659713168188
noisy true:421
noisy false:444
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 865
epoch [28/200] batch [5/23] time 0.303 (0.310) data 0.224 (0.231) loss_x loss_x 0.6523 (0.5870) acc_x 71.8750 (81.8750) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/23] time 0.323 (0.322) data 0.245 (0.243) loss_x loss_x 0.7510 (0.5536) acc_x 81.2500 (85.6250) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [15/23] time 0.362 (0.329) data 0.285 (0.251) loss_x loss_x 0.2312 (0.4997) acc_x 93.7500 (87.0833) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/23] time 0.345 (0.332) data 0.268 (0.254) loss_x loss_x 0.4421 (0.4954) acc_x 87.5000 (87.5000) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/27] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9390 (0.9116) acc_u 6.2500 (10.6250) lr 1.9178e-03 eta 0:00:07
epoch [28/200] batch [10/27] time 0.326 (0.336) data 0.248 (0.258) loss_u loss_u 0.8960 (0.9002) acc_u 12.5000 (12.1875) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [15/27] time 0.340 (0.337) data 0.262 (0.259) loss_u loss_u 0.9316 (0.9052) acc_u 6.2500 (11.6667) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [20/27] time 0.341 (0.338) data 0.263 (0.260) loss_u loss_u 0.9297 (0.9013) acc_u 9.3750 (12.0312) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [25/27] time 0.343 (0.338) data 0.263 (0.260) loss_u loss_u 0.9014 (0.9030) acc_u 15.6250 (11.8750) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 430
confident_label rate tensor(0.4767, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 778
clean true:766
clean false:12
clean_rate:0.9845758354755784
noisy true:436
noisy false:418
after delete: len(clean_dataset) 778
after delete: len(noisy_dataset) 854
epoch [29/200] batch [5/24] time 0.303 (0.304) data 0.224 (0.225) loss_x loss_x 0.3242 (0.3785) acc_x 93.7500 (93.1250) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [10/24] time 0.342 (0.313) data 0.264 (0.234) loss_x loss_x 0.4238 (0.4701) acc_x 93.7500 (90.0000) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [15/24] time 0.353 (0.325) data 0.275 (0.247) loss_x loss_x 0.4775 (0.4617) acc_x 87.5000 (90.0000) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/24] time 0.342 (0.330) data 0.264 (0.252) loss_x loss_x 0.6211 (0.4976) acc_x 84.3750 (89.3750) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [5/26] time 0.324 (0.334) data 0.244 (0.256) loss_u loss_u 0.8989 (0.8772) acc_u 12.5000 (15.0000) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [10/26] time 0.332 (0.336) data 0.253 (0.258) loss_u loss_u 0.9048 (0.8860) acc_u 9.3750 (14.6875) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [15/26] time 0.345 (0.336) data 0.266 (0.258) loss_u loss_u 0.9058 (0.8922) acc_u 12.5000 (13.3333) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [20/26] time 0.344 (0.337) data 0.266 (0.259) loss_u loss_u 0.9570 (0.8989) acc_u 3.1250 (12.8125) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [25/26] time 0.350 (0.338) data 0.272 (0.260) loss_u loss_u 0.9580 (0.9046) acc_u 6.2500 (12.0000) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 435
confident_label rate tensor(0.4737, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 773
clean true:761
clean false:12
clean_rate:0.9844760672703752
noisy true:436
noisy false:423
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 859
epoch [30/200] batch [5/24] time 0.339 (0.316) data 0.260 (0.237) loss_x loss_x 0.4087 (0.5367) acc_x 90.6250 (86.8750) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/24] time 0.336 (0.326) data 0.258 (0.248) loss_x loss_x 0.2659 (0.4390) acc_x 93.7500 (89.6875) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/24] time 0.343 (0.329) data 0.265 (0.251) loss_x loss_x 0.3196 (0.4419) acc_x 93.7500 (90.8333) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/24] time 0.342 (0.332) data 0.264 (0.254) loss_x loss_x 0.2330 (0.4657) acc_x 90.6250 (89.6875) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [5/26] time 0.351 (0.337) data 0.273 (0.259) loss_u loss_u 0.9404 (0.9037) acc_u 6.2500 (11.8750) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [10/26] time 0.358 (0.339) data 0.279 (0.261) loss_u loss_u 0.8408 (0.8980) acc_u 21.8750 (12.8125) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [15/26] time 0.347 (0.340) data 0.269 (0.261) loss_u loss_u 0.9722 (0.9094) acc_u 0.0000 (11.0417) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [20/26] time 0.326 (0.338) data 0.247 (0.260) loss_u loss_u 0.8599 (0.9043) acc_u 15.6250 (11.8750) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/26] time 0.337 (0.338) data 0.259 (0.260) loss_u loss_u 0.8706 (0.9049) acc_u 21.8750 (11.7500) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 397
confident_label rate tensor(0.4969, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 811
clean true:796
clean false:15
clean_rate:0.9815043156596794
noisy true:439
noisy false:382
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 821
epoch [31/200] batch [5/25] time 0.346 (0.331) data 0.269 (0.253) loss_x loss_x 0.5615 (0.5254) acc_x 84.3750 (87.5000) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [10/25] time 0.329 (0.336) data 0.252 (0.258) loss_x loss_x 1.1426 (0.5967) acc_x 75.0000 (85.0000) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [15/25] time 0.322 (0.333) data 0.244 (0.255) loss_x loss_x 0.5264 (0.5984) acc_x 87.5000 (86.0417) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [20/25] time 0.334 (0.334) data 0.255 (0.256) loss_x loss_x 0.3274 (0.5671) acc_x 90.6250 (86.7188) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [25/25] time 0.335 (0.334) data 0.257 (0.256) loss_x loss_x 0.6733 (0.5614) acc_x 78.1250 (86.3750) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/25] time 0.328 (0.334) data 0.250 (0.256) loss_u loss_u 0.9194 (0.9204) acc_u 9.3750 (10.6250) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [10/25] time 0.341 (0.335) data 0.263 (0.257) loss_u loss_u 0.8677 (0.9173) acc_u 12.5000 (9.6875) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [15/25] time 0.348 (0.336) data 0.269 (0.258) loss_u loss_u 0.8901 (0.9174) acc_u 15.6250 (9.7917) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [20/25] time 0.330 (0.337) data 0.252 (0.259) loss_u loss_u 0.9194 (0.9190) acc_u 12.5000 (9.8438) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [25/25] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9111 (0.9164) acc_u 9.3750 (10.1250) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 420
confident_label rate tensor(0.4890, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 798
clean true:784
clean false:14
clean_rate:0.9824561403508771
noisy true:428
noisy false:406
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 834
epoch [32/200] batch [5/24] time 0.305 (0.307) data 0.226 (0.228) loss_x loss_x 0.3569 (0.4708) acc_x 93.7500 (90.0000) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [10/24] time 0.331 (0.318) data 0.252 (0.239) loss_x loss_x 0.5718 (0.4722) acc_x 84.3750 (90.0000) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/24] time 0.341 (0.326) data 0.263 (0.248) loss_x loss_x 0.4500 (0.5124) acc_x 90.6250 (89.1667) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/24] time 0.341 (0.327) data 0.263 (0.249) loss_x loss_x 0.3962 (0.4928) acc_x 90.6250 (89.6875) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [5/26] time 0.347 (0.333) data 0.269 (0.254) loss_u loss_u 0.8970 (0.8868) acc_u 12.5000 (14.3750) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [10/26] time 0.335 (0.334) data 0.257 (0.256) loss_u loss_u 0.9141 (0.8992) acc_u 9.3750 (12.8125) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [15/26] time 0.345 (0.335) data 0.267 (0.257) loss_u loss_u 0.9404 (0.8989) acc_u 9.3750 (12.7083) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/26] time 0.349 (0.335) data 0.271 (0.257) loss_u loss_u 0.8877 (0.9062) acc_u 15.6250 (11.8750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [25/26] time 0.323 (0.335) data 0.245 (0.257) loss_u loss_u 0.9736 (0.9144) acc_u 3.1250 (10.7500) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 415
confident_label rate tensor(0.4847, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 791
clean true:776
clean false:15
clean_rate:0.9810366624525917
noisy true:441
noisy false:400
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 841
epoch [33/200] batch [5/24] time 0.301 (0.305) data 0.223 (0.226) loss_x loss_x 0.3496 (0.4896) acc_x 93.7500 (88.7500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/24] time 0.342 (0.322) data 0.264 (0.243) loss_x loss_x 0.5508 (0.4877) acc_x 84.3750 (88.7500) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/24] time 0.344 (0.331) data 0.266 (0.253) loss_x loss_x 0.5054 (0.4891) acc_x 87.5000 (88.9583) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/24] time 0.345 (0.334) data 0.267 (0.256) loss_x loss_x 0.5371 (0.4800) acc_x 87.5000 (88.7500) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [5/26] time 0.342 (0.334) data 0.264 (0.256) loss_u loss_u 0.8784 (0.8851) acc_u 15.6250 (14.3750) lr 1.8838e-03 eta 0:00:07
epoch [33/200] batch [10/26] time 0.356 (0.335) data 0.278 (0.257) loss_u loss_u 0.9604 (0.8933) acc_u 6.2500 (13.4375) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [15/26] time 0.327 (0.335) data 0.249 (0.257) loss_u loss_u 0.9209 (0.8954) acc_u 15.6250 (13.3333) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [20/26] time 0.335 (0.335) data 0.257 (0.257) loss_u loss_u 0.9243 (0.9017) acc_u 9.3750 (12.3438) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [25/26] time 0.321 (0.334) data 0.243 (0.256) loss_u loss_u 0.9531 (0.9041) acc_u 6.2500 (12.1250) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 435
confident_label rate tensor(0.4786, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 781
clean true:771
clean false:10
clean_rate:0.9871959026888605
noisy true:426
noisy false:425
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 851
epoch [34/200] batch [5/24] time 0.291 (0.335) data 0.213 (0.257) loss_x loss_x 0.8867 (0.4985) acc_x 84.3750 (90.6250) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [10/24] time 0.293 (0.317) data 0.214 (0.239) loss_x loss_x 0.8174 (0.5335) acc_x 84.3750 (88.4375) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/24] time 0.331 (0.323) data 0.253 (0.245) loss_x loss_x 0.4216 (0.4895) acc_x 93.7500 (90.0000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/24] time 0.341 (0.326) data 0.263 (0.248) loss_x loss_x 0.2300 (0.4446) acc_x 96.8750 (91.2500) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [5/26] time 0.333 (0.327) data 0.255 (0.249) loss_u loss_u 0.9253 (0.8791) acc_u 12.5000 (15.6250) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [10/26] time 0.318 (0.327) data 0.240 (0.249) loss_u loss_u 0.8452 (0.8899) acc_u 18.7500 (13.7500) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [15/26] time 0.329 (0.328) data 0.251 (0.250) loss_u loss_u 0.9604 (0.8933) acc_u 6.2500 (13.9583) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/26] time 0.337 (0.329) data 0.259 (0.251) loss_u loss_u 0.9082 (0.8999) acc_u 12.5000 (12.8125) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [25/26] time 0.339 (0.331) data 0.260 (0.252) loss_u loss_u 0.8169 (0.8956) acc_u 21.8750 (13.2500) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 428
confident_label rate tensor(0.4816, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 786
clean true:776
clean false:10
clean_rate:0.9872773536895675
noisy true:428
noisy false:418
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 846
epoch [35/200] batch [5/24] time 0.335 (0.339) data 0.257 (0.261) loss_x loss_x 0.4138 (0.4751) acc_x 90.6250 (88.7500) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [10/24] time 0.331 (0.337) data 0.253 (0.259) loss_x loss_x 0.4353 (0.4298) acc_x 84.3750 (89.0625) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/24] time 0.300 (0.326) data 0.221 (0.248) loss_x loss_x 0.2839 (0.4525) acc_x 90.6250 (87.7083) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/24] time 0.317 (0.324) data 0.239 (0.246) loss_x loss_x 0.5117 (0.4456) acc_x 81.2500 (88.5938) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [5/26] time 0.328 (0.333) data 0.249 (0.255) loss_u loss_u 0.9385 (0.9494) acc_u 6.2500 (5.6250) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [10/26] time 0.332 (0.333) data 0.254 (0.255) loss_u loss_u 0.8418 (0.9060) acc_u 25.0000 (11.8750) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [15/26] time 0.340 (0.332) data 0.262 (0.254) loss_u loss_u 0.8833 (0.9073) acc_u 15.6250 (12.0833) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [20/26] time 0.341 (0.334) data 0.262 (0.256) loss_u loss_u 0.9062 (0.9065) acc_u 12.5000 (12.0312) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [25/26] time 0.346 (0.335) data 0.268 (0.257) loss_u loss_u 0.9219 (0.9035) acc_u 12.5000 (12.3750) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 416
confident_label rate tensor(0.4884, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 797
clean true:787
clean false:10
clean_rate:0.9874529485570891
noisy true:429
noisy false:406
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 835
epoch [36/200] batch [5/24] time 0.344 (0.355) data 0.266 (0.277) loss_x loss_x 0.3889 (0.4043) acc_x 84.3750 (89.3750) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [10/24] time 0.313 (0.345) data 0.234 (0.267) loss_x loss_x 0.3667 (0.4573) acc_x 90.6250 (88.4375) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/24] time 0.346 (0.336) data 0.268 (0.258) loss_x loss_x 0.3811 (0.4368) acc_x 93.7500 (89.5833) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [20/24] time 0.337 (0.336) data 0.258 (0.258) loss_x loss_x 0.6885 (0.4830) acc_x 81.2500 (87.9688) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [5/26] time 0.345 (0.335) data 0.266 (0.256) loss_u loss_u 0.9106 (0.9135) acc_u 9.3750 (10.6250) lr 1.8607e-03 eta 0:00:07
epoch [36/200] batch [10/26] time 0.336 (0.334) data 0.258 (0.256) loss_u loss_u 0.9321 (0.9167) acc_u 6.2500 (10.0000) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [15/26] time 0.337 (0.334) data 0.258 (0.256) loss_u loss_u 0.9126 (0.9072) acc_u 12.5000 (11.4583) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [20/26] time 0.336 (0.334) data 0.258 (0.256) loss_u loss_u 0.8760 (0.9050) acc_u 15.6250 (11.2500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/26] time 0.338 (0.335) data 0.259 (0.257) loss_u loss_u 0.8145 (0.9034) acc_u 18.7500 (11.6250) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 411
confident_label rate tensor(0.4847, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 791
clean true:779
clean false:12
clean_rate:0.9848293299620733
noisy true:442
noisy false:399
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 841
epoch [37/200] batch [5/24] time 0.355 (0.356) data 0.277 (0.278) loss_x loss_x 0.4773 (0.4721) acc_x 93.7500 (88.7500) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [10/24] time 0.299 (0.334) data 0.221 (0.256) loss_x loss_x 0.4360 (0.4513) acc_x 90.6250 (89.0625) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/24] time 0.330 (0.329) data 0.252 (0.251) loss_x loss_x 0.5684 (0.4792) acc_x 84.3750 (87.7083) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/24] time 0.337 (0.333) data 0.258 (0.254) loss_x loss_x 0.5659 (0.4652) acc_x 84.3750 (87.9688) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [5/26] time 0.351 (0.336) data 0.272 (0.257) loss_u loss_u 0.8652 (0.8827) acc_u 15.6250 (14.3750) lr 1.8526e-03 eta 0:00:07
epoch [37/200] batch [10/26] time 0.338 (0.336) data 0.259 (0.258) loss_u loss_u 0.8853 (0.8912) acc_u 12.5000 (13.1250) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [15/26] time 0.353 (0.336) data 0.274 (0.258) loss_u loss_u 0.8794 (0.8860) acc_u 12.5000 (13.9583) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [20/26] time 0.345 (0.337) data 0.266 (0.259) loss_u loss_u 0.9458 (0.8907) acc_u 6.2500 (13.5938) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [25/26] time 0.329 (0.337) data 0.250 (0.259) loss_u loss_u 0.9062 (0.8858) acc_u 9.3750 (14.1250) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 379
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 821
clean true:808
clean false:13
clean_rate:0.9841656516443362
noisy true:445
noisy false:366
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 811
epoch [38/200] batch [5/25] time 0.356 (0.351) data 0.277 (0.273) loss_x loss_x 0.3284 (0.3906) acc_x 96.8750 (91.8750) lr 1.8443e-03 eta 0:00:07
epoch [38/200] batch [10/25] time 0.302 (0.325) data 0.223 (0.247) loss_x loss_x 0.6475 (0.4622) acc_x 71.8750 (88.7500) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/25] time 0.352 (0.326) data 0.273 (0.247) loss_x loss_x 0.2742 (0.4180) acc_x 93.7500 (90.4167) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/25] time 0.340 (0.330) data 0.262 (0.251) loss_x loss_x 0.3645 (0.4061) acc_x 93.7500 (90.1562) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [25/25] time 0.356 (0.334) data 0.279 (0.255) loss_x loss_x 0.5400 (0.4225) acc_x 84.3750 (89.5000) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/25] time 0.338 (0.336) data 0.259 (0.257) loss_u loss_u 0.9219 (0.9092) acc_u 9.3750 (10.6250) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [10/25] time 0.351 (0.337) data 0.273 (0.259) loss_u loss_u 0.9409 (0.9122) acc_u 6.2500 (10.3125) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [15/25] time 0.327 (0.337) data 0.249 (0.259) loss_u loss_u 0.8667 (0.9067) acc_u 12.5000 (10.8333) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/25] time 0.352 (0.337) data 0.274 (0.259) loss_u loss_u 0.9609 (0.9164) acc_u 3.1250 (9.5312) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [25/25] time 0.338 (0.338) data 0.260 (0.259) loss_u loss_u 0.9512 (0.9172) acc_u 6.2500 (9.5000) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 404
confident_label rate tensor(0.4865, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 794
clean true:786
clean false:8
clean_rate:0.9899244332493703
noisy true:442
noisy false:396
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 838
epoch [39/200] batch [5/24] time 0.314 (0.327) data 0.235 (0.248) loss_x loss_x 0.1329 (0.3936) acc_x 100.0000 (93.1250) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [10/24] time 0.333 (0.324) data 0.255 (0.246) loss_x loss_x 0.3879 (0.4139) acc_x 96.8750 (92.5000) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/24] time 0.299 (0.321) data 0.221 (0.243) loss_x loss_x 0.4998 (0.4263) acc_x 90.6250 (91.6667) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [20/24] time 0.342 (0.322) data 0.264 (0.244) loss_x loss_x 0.4563 (0.4432) acc_x 87.5000 (90.0000) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [5/26] time 0.339 (0.328) data 0.260 (0.250) loss_u loss_u 0.8730 (0.9104) acc_u 15.6250 (11.2500) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [10/26] time 0.376 (0.331) data 0.297 (0.253) loss_u loss_u 0.8672 (0.8884) acc_u 15.6250 (13.4375) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [15/26] time 0.356 (0.335) data 0.275 (0.257) loss_u loss_u 0.9170 (0.8964) acc_u 12.5000 (12.5000) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/26] time 0.380 (0.338) data 0.301 (0.259) loss_u loss_u 0.8740 (0.8972) acc_u 15.6250 (12.5000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [25/26] time 0.353 (0.342) data 0.272 (0.263) loss_u loss_u 0.9600 (0.8940) acc_u 6.2500 (12.6250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 392
confident_label rate tensor(0.5006, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 817
clean true:803
clean false:14
clean_rate:0.9828641370869033
noisy true:437
noisy false:378
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 815
epoch [40/200] batch [5/25] time 0.355 (0.323) data 0.278 (0.245) loss_x loss_x 0.5352 (0.4503) acc_x 84.3750 (88.1250) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [10/25] time 0.339 (0.333) data 0.261 (0.255) loss_x loss_x 0.6240 (0.4605) acc_x 90.6250 (87.8125) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/25] time 0.336 (0.337) data 0.258 (0.259) loss_x loss_x 0.7500 (0.4783) acc_x 84.3750 (87.7083) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/25] time 0.357 (0.339) data 0.279 (0.261) loss_x loss_x 0.3977 (0.4619) acc_x 90.6250 (88.5938) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [25/25] time 0.328 (0.338) data 0.250 (0.260) loss_x loss_x 0.7021 (0.4868) acc_x 84.3750 (87.8750) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/25] time 0.351 (0.340) data 0.272 (0.262) loss_u loss_u 0.8833 (0.9239) acc_u 15.6250 (8.7500) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [10/25] time 0.339 (0.342) data 0.260 (0.264) loss_u loss_u 0.8828 (0.9206) acc_u 15.6250 (9.3750) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [15/25] time 0.331 (0.342) data 0.252 (0.264) loss_u loss_u 0.8872 (0.9119) acc_u 12.5000 (10.2083) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/25] time 0.325 (0.341) data 0.247 (0.263) loss_u loss_u 0.8657 (0.9173) acc_u 15.6250 (9.8438) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [25/25] time 0.379 (0.341) data 0.301 (0.263) loss_u loss_u 0.7666 (0.9104) acc_u 25.0000 (10.3750) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 393
confident_label rate tensor(0.4945, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 807
clean true:789
clean false:18
clean_rate:0.9776951672862454
noisy true:450
noisy false:375
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 825
epoch [41/200] batch [5/25] time 0.324 (0.344) data 0.246 (0.265) loss_x loss_x 0.3210 (0.3529) acc_x 93.7500 (94.3750) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [10/25] time 0.324 (0.336) data 0.245 (0.258) loss_x loss_x 0.2585 (0.4237) acc_x 100.0000 (91.5625) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [15/25] time 0.337 (0.334) data 0.259 (0.255) loss_x loss_x 0.6670 (0.4408) acc_x 81.2500 (90.8333) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [20/25] time 0.342 (0.337) data 0.263 (0.258) loss_x loss_x 0.6372 (0.4489) acc_x 81.2500 (89.8438) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [25/25] time 0.338 (0.339) data 0.261 (0.260) loss_x loss_x 0.5571 (0.4736) acc_x 90.6250 (89.3750) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/25] time 0.337 (0.339) data 0.259 (0.260) loss_u loss_u 0.8096 (0.8933) acc_u 18.7500 (11.2500) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [10/25] time 0.346 (0.339) data 0.268 (0.261) loss_u loss_u 0.8799 (0.8998) acc_u 12.5000 (11.5625) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [15/25] time 0.330 (0.339) data 0.250 (0.261) loss_u loss_u 0.9336 (0.8955) acc_u 9.3750 (12.5000) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [20/25] time 0.344 (0.338) data 0.266 (0.259) loss_u loss_u 0.9624 (0.8928) acc_u 6.2500 (12.9688) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [25/25] time 0.331 (0.338) data 0.253 (0.259) loss_u loss_u 0.8862 (0.8952) acc_u 12.5000 (12.5000) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 392
confident_label rate tensor(0.4982, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 813
clean true:802
clean false:11
clean_rate:0.986469864698647
noisy true:438
noisy false:381
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 819
epoch [42/200] batch [5/25] time 0.332 (0.351) data 0.253 (0.272) loss_x loss_x 0.5483 (0.4945) acc_x 78.1250 (86.2500) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [10/25] time 0.332 (0.343) data 0.253 (0.265) loss_x loss_x 0.5352 (0.4550) acc_x 81.2500 (86.8750) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [15/25] time 0.329 (0.341) data 0.252 (0.263) loss_x loss_x 0.2585 (0.4693) acc_x 96.8750 (87.9167) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [20/25] time 0.344 (0.341) data 0.266 (0.262) loss_x loss_x 0.2046 (0.4547) acc_x 96.8750 (88.5938) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [25/25] time 0.350 (0.339) data 0.272 (0.261) loss_x loss_x 0.4363 (0.4386) acc_x 87.5000 (88.7500) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/25] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.8364 (0.8920) acc_u 15.6250 (12.5000) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [10/25] time 0.326 (0.338) data 0.248 (0.260) loss_u loss_u 0.9336 (0.9196) acc_u 9.3750 (10.0000) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [15/25] time 0.342 (0.337) data 0.264 (0.259) loss_u loss_u 0.9028 (0.9061) acc_u 12.5000 (11.4583) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [20/25] time 0.330 (0.338) data 0.250 (0.260) loss_u loss_u 0.9722 (0.9117) acc_u 6.2500 (10.6250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [25/25] time 0.362 (0.339) data 0.282 (0.261) loss_u loss_u 0.9019 (0.9063) acc_u 12.5000 (11.5000) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 393
confident_label rate tensor(0.4957, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 809
clean true:799
clean false:10
clean_rate:0.9876390605686032
noisy true:440
noisy false:383
after delete: len(clean_dataset) 809
after delete: len(noisy_dataset) 823
epoch [43/200] batch [5/25] time 0.349 (0.358) data 0.272 (0.279) loss_x loss_x 0.2440 (0.4000) acc_x 96.8750 (90.6250) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [10/25] time 0.353 (0.340) data 0.275 (0.262) loss_x loss_x 0.2974 (0.3579) acc_x 90.6250 (91.5625) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [15/25] time 0.345 (0.340) data 0.267 (0.262) loss_x loss_x 0.4917 (0.3797) acc_x 90.6250 (90.8333) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/25] time 0.354 (0.341) data 0.275 (0.262) loss_x loss_x 0.3303 (0.3998) acc_x 87.5000 (89.6875) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [25/25] time 0.343 (0.342) data 0.263 (0.264) loss_x loss_x 0.3215 (0.4061) acc_x 90.6250 (89.5000) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/25] time 0.346 (0.342) data 0.268 (0.264) loss_u loss_u 0.8804 (0.9033) acc_u 15.6250 (11.8750) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [10/25] time 0.359 (0.343) data 0.280 (0.265) loss_u loss_u 0.9702 (0.9187) acc_u 3.1250 (9.6875) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [15/25] time 0.338 (0.343) data 0.258 (0.265) loss_u loss_u 0.8813 (0.9150) acc_u 15.6250 (10.4167) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/25] time 0.321 (0.343) data 0.243 (0.265) loss_u loss_u 0.9399 (0.9033) acc_u 6.2500 (11.5625) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [25/25] time 0.315 (0.342) data 0.236 (0.263) loss_u loss_u 0.9497 (0.9030) acc_u 3.1250 (11.6250) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 374
confident_label rate tensor(0.5061, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 826
clean true:812
clean false:14
clean_rate:0.9830508474576272
noisy true:446
noisy false:360
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 806
epoch [44/200] batch [5/25] time 0.337 (0.348) data 0.259 (0.270) loss_x loss_x 1.0166 (0.5376) acc_x 84.3750 (90.0000) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [10/25] time 0.349 (0.347) data 0.271 (0.269) loss_x loss_x 0.3882 (0.4839) acc_x 96.8750 (89.6875) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [15/25] time 0.342 (0.345) data 0.264 (0.267) loss_x loss_x 0.2747 (0.5153) acc_x 93.7500 (88.7500) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/25] time 0.329 (0.344) data 0.251 (0.266) loss_x loss_x 0.8789 (0.5181) acc_x 78.1250 (88.1250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [25/25] time 0.345 (0.344) data 0.267 (0.266) loss_x loss_x 0.4407 (0.5006) acc_x 87.5000 (88.2500) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/25] time 0.364 (0.346) data 0.286 (0.268) loss_u loss_u 0.8306 (0.8828) acc_u 18.7500 (13.1250) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [10/25] time 0.369 (0.347) data 0.291 (0.269) loss_u loss_u 0.8657 (0.9001) acc_u 18.7500 (11.5625) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [15/25] time 0.358 (0.348) data 0.279 (0.270) loss_u loss_u 0.9771 (0.9005) acc_u 6.2500 (12.2917) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/25] time 0.348 (0.347) data 0.270 (0.269) loss_u loss_u 0.9614 (0.9024) acc_u 6.2500 (12.1875) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [25/25] time 0.319 (0.345) data 0.241 (0.267) loss_u loss_u 0.9312 (0.8981) acc_u 9.3750 (12.7500) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 350
confident_label rate tensor(0.5092, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 831
clean true:821
clean false:10
clean_rate:0.9879663056558363
noisy true:461
noisy false:340
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 801
epoch [45/200] batch [5/25] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.7188 (0.5066) acc_x 78.1250 (88.7500) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [10/25] time 0.324 (0.336) data 0.246 (0.258) loss_x loss_x 0.6123 (0.4650) acc_x 84.3750 (88.4375) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [15/25] time 0.334 (0.334) data 0.256 (0.256) loss_x loss_x 0.3225 (0.4402) acc_x 93.7500 (89.7917) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/25] time 0.340 (0.336) data 0.263 (0.258) loss_x loss_x 0.2534 (0.4000) acc_x 96.8750 (91.0938) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/25] time 0.356 (0.338) data 0.278 (0.260) loss_x loss_x 0.4980 (0.4218) acc_x 84.3750 (90.2500) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/25] time 0.319 (0.337) data 0.240 (0.259) loss_u loss_u 0.8940 (0.9274) acc_u 12.5000 (8.7500) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [10/25] time 0.351 (0.339) data 0.273 (0.261) loss_u loss_u 0.8760 (0.9265) acc_u 18.7500 (9.0625) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [15/25] time 0.332 (0.338) data 0.254 (0.260) loss_u loss_u 0.9380 (0.9160) acc_u 6.2500 (10.2083) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/25] time 0.339 (0.339) data 0.261 (0.260) loss_u loss_u 0.8979 (0.9167) acc_u 12.5000 (10.3125) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/25] time 0.326 (0.338) data 0.247 (0.260) loss_u loss_u 0.9043 (0.9101) acc_u 12.5000 (11.2500) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 349
confident_label rate tensor(0.5110, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 834
clean true:825
clean false:9
clean_rate:0.9892086330935251
noisy true:458
noisy false:340
after delete: len(clean_dataset) 834
after delete: len(noisy_dataset) 798
epoch [46/200] batch [5/26] time 0.336 (0.350) data 0.258 (0.272) loss_x loss_x 0.5752 (0.3380) acc_x 87.5000 (91.8750) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [10/26] time 0.350 (0.343) data 0.272 (0.265) loss_x loss_x 0.3606 (0.4328) acc_x 90.6250 (90.3125) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [15/26] time 0.343 (0.340) data 0.265 (0.262) loss_x loss_x 0.1384 (0.3968) acc_x 100.0000 (91.0417) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/26] time 0.351 (0.341) data 0.272 (0.263) loss_x loss_x 0.2382 (0.4077) acc_x 100.0000 (91.2500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [25/26] time 0.347 (0.343) data 0.269 (0.265) loss_x loss_x 0.2957 (0.4216) acc_x 84.3750 (90.1250) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/24] time 0.350 (0.342) data 0.271 (0.264) loss_u loss_u 0.9453 (0.9187) acc_u 6.2500 (10.0000) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [10/24] time 0.347 (0.342) data 0.269 (0.264) loss_u loss_u 0.9321 (0.9143) acc_u 6.2500 (9.6875) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/24] time 0.322 (0.342) data 0.244 (0.264) loss_u loss_u 0.9492 (0.9042) acc_u 9.3750 (11.0417) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/24] time 0.348 (0.341) data 0.270 (0.263) loss_u loss_u 0.8989 (0.9052) acc_u 12.5000 (11.2500) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 378
confident_label rate tensor(0.4982, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 813
clean true:802
clean false:11
clean_rate:0.986469864698647
noisy true:452
noisy false:367
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 819
epoch [47/200] batch [5/25] time 0.333 (0.341) data 0.254 (0.262) loss_x loss_x 0.3948 (0.4596) acc_x 90.6250 (91.2500) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [10/25] time 0.340 (0.339) data 0.262 (0.260) loss_x loss_x 0.3152 (0.4149) acc_x 90.6250 (90.6250) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [15/25] time 0.328 (0.338) data 0.249 (0.259) loss_x loss_x 0.4924 (0.4178) acc_x 87.5000 (91.0417) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/25] time 0.346 (0.337) data 0.269 (0.259) loss_x loss_x 0.2769 (0.4163) acc_x 96.8750 (90.9375) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [25/25] time 0.343 (0.339) data 0.266 (0.261) loss_x loss_x 0.5825 (0.4153) acc_x 87.5000 (90.8750) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/25] time 0.346 (0.339) data 0.266 (0.261) loss_u loss_u 0.9785 (0.9216) acc_u 3.1250 (9.3750) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [10/25] time 0.352 (0.339) data 0.274 (0.260) loss_u loss_u 0.8276 (0.9069) acc_u 18.7500 (11.2500) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [15/25] time 0.339 (0.339) data 0.260 (0.261) loss_u loss_u 0.9570 (0.8879) acc_u 3.1250 (13.7500) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/25] time 0.331 (0.339) data 0.251 (0.261) loss_u loss_u 0.9429 (0.8891) acc_u 6.2500 (13.2812) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [25/25] time 0.348 (0.340) data 0.270 (0.262) loss_u loss_u 0.8589 (0.8884) acc_u 15.6250 (13.6250) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 366
confident_label rate tensor(0.5178, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 845
clean true:827
clean false:18
clean_rate:0.978698224852071
noisy true:439
noisy false:348
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 787
epoch [48/200] batch [5/26] time 0.341 (0.342) data 0.262 (0.264) loss_x loss_x 0.3726 (0.4865) acc_x 93.7500 (88.7500) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [10/26] time 0.349 (0.346) data 0.271 (0.268) loss_x loss_x 0.1774 (0.4040) acc_x 96.8750 (90.6250) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [15/26] time 0.325 (0.343) data 0.247 (0.265) loss_x loss_x 0.7222 (0.4418) acc_x 84.3750 (89.3750) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/26] time 0.345 (0.343) data 0.267 (0.265) loss_x loss_x 0.8784 (0.4662) acc_x 78.1250 (88.7500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [25/26] time 0.348 (0.342) data 0.270 (0.264) loss_x loss_x 0.4595 (0.4776) acc_x 87.5000 (87.8750) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/24] time 0.347 (0.342) data 0.269 (0.264) loss_u loss_u 0.8477 (0.8824) acc_u 15.6250 (12.5000) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [10/24] time 0.347 (0.342) data 0.269 (0.264) loss_u loss_u 0.9541 (0.9130) acc_u 6.2500 (9.0625) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/24] time 0.302 (0.340) data 0.223 (0.262) loss_u loss_u 0.9292 (0.9185) acc_u 9.3750 (8.9583) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/24] time 0.343 (0.340) data 0.264 (0.262) loss_u loss_u 0.8472 (0.9112) acc_u 18.7500 (10.1562) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 351
confident_label rate tensor(0.5172, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 844
clean true:831
clean false:13
clean_rate:0.9845971563981043
noisy true:450
noisy false:338
after delete: len(clean_dataset) 844
after delete: len(noisy_dataset) 788
epoch [49/200] batch [5/26] time 0.355 (0.351) data 0.277 (0.273) loss_x loss_x 0.5615 (0.4721) acc_x 90.6250 (88.7500) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [10/26] time 0.322 (0.343) data 0.244 (0.265) loss_x loss_x 0.2866 (0.4442) acc_x 90.6250 (89.6875) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [15/26] time 0.355 (0.340) data 0.277 (0.262) loss_x loss_x 0.3857 (0.4843) acc_x 93.7500 (89.3750) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/26] time 0.343 (0.338) data 0.265 (0.260) loss_x loss_x 0.3149 (0.4944) acc_x 87.5000 (88.9062) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [25/26] time 0.342 (0.339) data 0.264 (0.261) loss_x loss_x 0.3416 (0.4794) acc_x 96.8750 (89.5000) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/24] time 0.338 (0.338) data 0.259 (0.260) loss_u loss_u 0.9243 (0.8978) acc_u 9.3750 (11.8750) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [10/24] time 0.348 (0.339) data 0.270 (0.261) loss_u loss_u 0.8711 (0.9018) acc_u 18.7500 (12.1875) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/24] time 0.301 (0.336) data 0.222 (0.258) loss_u loss_u 0.9365 (0.9022) acc_u 9.3750 (12.2917) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/24] time 0.348 (0.335) data 0.270 (0.257) loss_u loss_u 0.9756 (0.9111) acc_u 3.1250 (11.2500) lr 1.7396e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.5165, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 843
clean true:829
clean false:14
clean_rate:0.9833926453143536
noisy true:448
noisy false:341
after delete: len(clean_dataset) 843
after delete: len(noisy_dataset) 789
epoch [50/200] batch [5/26] time 0.341 (0.349) data 0.263 (0.271) loss_x loss_x 0.4209 (0.4699) acc_x 90.6250 (86.8750) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [10/26] time 0.327 (0.344) data 0.249 (0.266) loss_x loss_x 0.7432 (0.4693) acc_x 78.1250 (87.1875) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [15/26] time 0.361 (0.347) data 0.284 (0.269) loss_x loss_x 0.4299 (0.4496) acc_x 87.5000 (87.7083) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/26] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.2932 (0.4227) acc_x 93.7500 (88.9062) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [25/26] time 0.335 (0.345) data 0.257 (0.267) loss_x loss_x 0.3064 (0.4045) acc_x 93.7500 (89.7500) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/24] time 0.330 (0.343) data 0.252 (0.265) loss_u loss_u 0.9053 (0.9201) acc_u 9.3750 (10.0000) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [10/24] time 0.304 (0.342) data 0.225 (0.264) loss_u loss_u 0.9053 (0.9146) acc_u 12.5000 (10.6250) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/24] time 0.299 (0.337) data 0.220 (0.259) loss_u loss_u 0.9009 (0.9163) acc_u 9.3750 (10.6250) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/24] time 0.344 (0.338) data 0.265 (0.260) loss_u loss_u 0.8706 (0.9130) acc_u 18.7500 (11.0938) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 361
confident_label rate tensor(0.5104, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 833
clean true:819
clean false:14
clean_rate:0.9831932773109243
noisy true:452
noisy false:347
after delete: len(clean_dataset) 833
after delete: len(noisy_dataset) 799
epoch [51/200] batch [5/26] time 0.349 (0.349) data 0.271 (0.270) loss_x loss_x 0.4417 (0.4713) acc_x 84.3750 (87.5000) lr 1.7181e-03 eta 0:00:07
epoch [51/200] batch [10/26] time 0.335 (0.344) data 0.256 (0.266) loss_x loss_x 0.2241 (0.4605) acc_x 93.7500 (89.0625) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [15/26] time 0.357 (0.343) data 0.279 (0.264) loss_x loss_x 0.3594 (0.4167) acc_x 87.5000 (90.0000) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/26] time 0.344 (0.340) data 0.265 (0.262) loss_x loss_x 0.5903 (0.4489) acc_x 81.2500 (89.8438) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [25/26] time 0.340 (0.341) data 0.262 (0.263) loss_x loss_x 0.4551 (0.4557) acc_x 90.6250 (89.6250) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/24] time 0.339 (0.339) data 0.260 (0.261) loss_u loss_u 0.8433 (0.8849) acc_u 21.8750 (13.7500) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [10/24] time 0.329 (0.338) data 0.249 (0.259) loss_u loss_u 0.8843 (0.8970) acc_u 12.5000 (11.2500) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/24] time 0.346 (0.335) data 0.268 (0.257) loss_u loss_u 0.9434 (0.8954) acc_u 6.2500 (11.6667) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/24] time 0.350 (0.336) data 0.271 (0.258) loss_u loss_u 0.8340 (0.8996) acc_u 18.7500 (11.4062) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 359
confident_label rate tensor(0.5159, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 842
clean true:826
clean false:16
clean_rate:0.9809976247030879
noisy true:447
noisy false:343
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 790
epoch [52/200] batch [5/26] time 0.332 (0.344) data 0.254 (0.266) loss_x loss_x 0.3901 (0.3639) acc_x 87.5000 (88.7500) lr 1.7071e-03 eta 0:00:07
epoch [52/200] batch [10/26] time 0.342 (0.339) data 0.265 (0.261) loss_x loss_x 0.6255 (0.4312) acc_x 75.0000 (86.8750) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [15/26] time 0.332 (0.338) data 0.254 (0.260) loss_x loss_x 0.6904 (0.4512) acc_x 87.5000 (87.2917) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/26] time 0.353 (0.342) data 0.275 (0.264) loss_x loss_x 0.5664 (0.4341) acc_x 93.7500 (89.0625) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [25/26] time 0.354 (0.343) data 0.276 (0.265) loss_x loss_x 0.2961 (0.4284) acc_x 96.8750 (89.5000) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/24] time 0.329 (0.343) data 0.250 (0.265) loss_u loss_u 0.8462 (0.9356) acc_u 15.6250 (7.5000) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [10/24] time 0.358 (0.343) data 0.279 (0.264) loss_u loss_u 0.9072 (0.9265) acc_u 9.3750 (8.4375) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/24] time 0.357 (0.343) data 0.278 (0.265) loss_u loss_u 0.9360 (0.9232) acc_u 9.3750 (9.3750) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/24] time 0.347 (0.343) data 0.268 (0.265) loss_u loss_u 0.8794 (0.9131) acc_u 18.7500 (10.7812) lr 1.7071e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 316
confident_label rate tensor(0.5233, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 854
clean true:841
clean false:13
clean_rate:0.9847775175644028
noisy true:475
noisy false:303
after delete: len(clean_dataset) 854
after delete: len(noisy_dataset) 778
epoch [53/200] batch [5/26] time 0.333 (0.344) data 0.255 (0.266) loss_x loss_x 0.3140 (0.4302) acc_x 90.6250 (88.7500) lr 1.6959e-03 eta 0:00:07
epoch [53/200] batch [10/26] time 0.345 (0.344) data 0.267 (0.265) loss_x loss_x 0.3220 (0.4216) acc_x 90.6250 (90.0000) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [15/26] time 0.349 (0.341) data 0.271 (0.262) loss_x loss_x 0.4343 (0.4573) acc_x 93.7500 (89.3750) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/26] time 0.332 (0.339) data 0.255 (0.261) loss_x loss_x 0.6606 (0.4929) acc_x 87.5000 (88.2812) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/26] time 0.345 (0.339) data 0.267 (0.261) loss_x loss_x 0.2274 (0.4764) acc_x 93.7500 (88.5000) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/24] time 0.311 (0.335) data 0.231 (0.256) loss_u loss_u 0.9487 (0.9448) acc_u 6.2500 (6.8750) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [10/24] time 0.332 (0.336) data 0.253 (0.257) loss_u loss_u 0.9463 (0.9143) acc_u 6.2500 (10.0000) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/24] time 0.333 (0.337) data 0.253 (0.258) loss_u loss_u 0.9385 (0.9127) acc_u 6.2500 (10.0000) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/24] time 0.339 (0.337) data 0.261 (0.259) loss_u loss_u 0.8765 (0.9040) acc_u 15.6250 (11.0938) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 354
confident_label rate tensor(0.5196, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 848
clean true:835
clean false:13
clean_rate:0.9846698113207547
noisy true:443
noisy false:341
after delete: len(clean_dataset) 848
after delete: len(noisy_dataset) 784
epoch [54/200] batch [5/26] time 0.354 (0.354) data 0.276 (0.276) loss_x loss_x 0.4436 (0.3576) acc_x 96.8750 (94.3750) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [10/26] time 0.348 (0.350) data 0.270 (0.273) loss_x loss_x 0.4792 (0.4142) acc_x 84.3750 (90.0000) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [15/26] time 0.342 (0.348) data 0.265 (0.270) loss_x loss_x 0.6016 (0.4702) acc_x 84.3750 (88.7500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/26] time 0.346 (0.347) data 0.267 (0.270) loss_x loss_x 0.5127 (0.4763) acc_x 87.5000 (87.9688) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/26] time 0.325 (0.344) data 0.247 (0.266) loss_x loss_x 0.2407 (0.4567) acc_x 100.0000 (88.5000) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/24] time 0.305 (0.339) data 0.226 (0.261) loss_u loss_u 0.8594 (0.8960) acc_u 15.6250 (11.2500) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [10/24] time 0.333 (0.338) data 0.255 (0.260) loss_u loss_u 0.8535 (0.8927) acc_u 15.6250 (11.8750) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [15/24] time 0.345 (0.337) data 0.266 (0.259) loss_u loss_u 0.9233 (0.8899) acc_u 9.3750 (12.7083) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/24] time 0.355 (0.338) data 0.277 (0.260) loss_u loss_u 0.9272 (0.8990) acc_u 9.3750 (12.0312) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 329
confident_label rate tensor(0.5270, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 860
clean true:846
clean false:14
clean_rate:0.9837209302325581
noisy true:457
noisy false:315
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 772
epoch [55/200] batch [5/26] time 0.352 (0.355) data 0.275 (0.277) loss_x loss_x 0.5259 (0.3424) acc_x 78.1250 (89.3750) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [10/26] time 0.328 (0.346) data 0.250 (0.268) loss_x loss_x 0.4014 (0.3567) acc_x 93.7500 (90.3125) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [15/26] time 0.342 (0.345) data 0.264 (0.267) loss_x loss_x 0.2400 (0.3566) acc_x 93.7500 (90.4167) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/26] time 0.345 (0.345) data 0.267 (0.268) loss_x loss_x 0.2788 (0.3392) acc_x 90.6250 (91.0938) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/26] time 0.333 (0.343) data 0.255 (0.266) loss_x loss_x 0.3430 (0.3389) acc_x 90.6250 (91.1250) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/24] time 0.332 (0.340) data 0.254 (0.261) loss_u loss_u 0.9482 (0.9003) acc_u 6.2500 (11.8750) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [10/24] time 0.342 (0.339) data 0.263 (0.261) loss_u loss_u 0.9541 (0.9025) acc_u 9.3750 (12.5000) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/24] time 0.348 (0.340) data 0.269 (0.262) loss_u loss_u 0.8315 (0.8983) acc_u 18.7500 (12.5000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/24] time 0.340 (0.340) data 0.260 (0.262) loss_u loss_u 0.8877 (0.9063) acc_u 9.3750 (11.2500) lr 1.6730e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 333
confident_label rate tensor(0.5221, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 852
clean true:839
clean false:13
clean_rate:0.9847417840375586
noisy true:460
noisy false:320
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 780
epoch [56/200] batch [5/26] time 0.342 (0.350) data 0.265 (0.272) loss_x loss_x 0.5371 (0.4481) acc_x 87.5000 (90.6250) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [10/26] time 0.335 (0.342) data 0.257 (0.264) loss_x loss_x 0.3831 (0.4286) acc_x 90.6250 (90.9375) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [15/26] time 0.352 (0.343) data 0.274 (0.265) loss_x loss_x 0.2482 (0.4267) acc_x 96.8750 (90.4167) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/26] time 0.337 (0.341) data 0.259 (0.264) loss_x loss_x 0.4241 (0.4176) acc_x 87.5000 (90.4688) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/26] time 0.332 (0.341) data 0.254 (0.263) loss_x loss_x 0.2432 (0.3996) acc_x 96.8750 (91.0000) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/24] time 0.306 (0.334) data 0.228 (0.256) loss_u loss_u 0.9272 (0.9115) acc_u 9.3750 (10.6250) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [10/24] time 0.342 (0.335) data 0.264 (0.257) loss_u loss_u 0.8462 (0.9124) acc_u 15.6250 (10.6250) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/24] time 0.360 (0.334) data 0.281 (0.256) loss_u loss_u 0.8579 (0.9085) acc_u 15.6250 (10.6250) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/24] time 0.352 (0.336) data 0.273 (0.258) loss_u loss_u 0.8857 (0.9081) acc_u 12.5000 (10.6250) lr 1.6613e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 320
confident_label rate tensor(0.5221, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 852
clean true:835
clean false:17
clean_rate:0.9800469483568075
noisy true:477
noisy false:303
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 780
epoch [57/200] batch [5/26] time 0.360 (0.355) data 0.281 (0.277) loss_x loss_x 0.4370 (0.3597) acc_x 90.6250 (91.2500) lr 1.6494e-03 eta 0:00:07
epoch [57/200] batch [10/26] time 0.343 (0.354) data 0.264 (0.276) loss_x loss_x 0.1671 (0.3689) acc_x 100.0000 (90.9375) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [15/26] time 0.379 (0.353) data 0.301 (0.275) loss_x loss_x 0.6919 (0.4101) acc_x 81.2500 (90.6250) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/26] time 0.351 (0.353) data 0.273 (0.275) loss_x loss_x 0.4177 (0.4112) acc_x 87.5000 (90.0000) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/26] time 0.346 (0.352) data 0.267 (0.274) loss_x loss_x 0.4924 (0.4142) acc_x 87.5000 (89.8750) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/24] time 0.303 (0.346) data 0.224 (0.268) loss_u loss_u 0.9331 (0.9055) acc_u 12.5000 (12.5000) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [10/24] time 0.348 (0.345) data 0.270 (0.267) loss_u loss_u 0.9556 (0.8978) acc_u 6.2500 (12.8125) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/24] time 0.341 (0.345) data 0.263 (0.267) loss_u loss_u 0.9702 (0.9128) acc_u 6.2500 (10.8333) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/24] time 0.338 (0.344) data 0.260 (0.266) loss_u loss_u 0.9438 (0.9097) acc_u 6.2500 (10.9375) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 352
confident_label rate tensor(0.5086, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 830
clean true:816
clean false:14
clean_rate:0.983132530120482
noisy true:464
noisy false:338
after delete: len(clean_dataset) 830
after delete: len(noisy_dataset) 802
epoch [58/200] batch [5/25] time 0.333 (0.356) data 0.255 (0.277) loss_x loss_x 0.2803 (0.2812) acc_x 90.6250 (93.7500) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [10/25] time 0.329 (0.344) data 0.252 (0.266) loss_x loss_x 0.4810 (0.3167) acc_x 84.3750 (92.5000) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [15/25] time 0.354 (0.343) data 0.276 (0.265) loss_x loss_x 0.2310 (0.3520) acc_x 96.8750 (91.0417) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/25] time 0.349 (0.343) data 0.272 (0.265) loss_x loss_x 0.3652 (0.3582) acc_x 96.8750 (92.1875) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [25/25] time 0.347 (0.343) data 0.269 (0.265) loss_x loss_x 0.4050 (0.3757) acc_x 90.6250 (91.2500) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/25] time 0.305 (0.339) data 0.225 (0.260) loss_u loss_u 0.9082 (0.8716) acc_u 15.6250 (16.2500) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [10/25] time 0.352 (0.338) data 0.273 (0.260) loss_u loss_u 0.9116 (0.9031) acc_u 12.5000 (11.8750) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [15/25] time 0.341 (0.340) data 0.261 (0.261) loss_u loss_u 0.8247 (0.8976) acc_u 21.8750 (12.9167) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/25] time 0.364 (0.341) data 0.285 (0.263) loss_u loss_u 0.8926 (0.8975) acc_u 12.5000 (12.8125) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [25/25] time 0.362 (0.343) data 0.283 (0.264) loss_u loss_u 0.8501 (0.8956) acc_u 18.7500 (13.2500) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 360
confident_label rate tensor(0.5147, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 840
clean true:824
clean false:16
clean_rate:0.9809523809523809
noisy true:448
noisy false:344
after delete: len(clean_dataset) 840
after delete: len(noisy_dataset) 792
epoch [59/200] batch [5/26] time 0.340 (0.343) data 0.262 (0.265) loss_x loss_x 0.3120 (0.3925) acc_x 93.7500 (90.0000) lr 1.6252e-03 eta 0:00:07
epoch [59/200] batch [10/26] time 0.336 (0.346) data 0.258 (0.268) loss_x loss_x 0.4211 (0.3748) acc_x 90.6250 (90.6250) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [15/26] time 0.341 (0.345) data 0.262 (0.267) loss_x loss_x 0.2013 (0.3659) acc_x 96.8750 (91.4583) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/26] time 0.352 (0.344) data 0.274 (0.266) loss_x loss_x 0.5298 (0.4054) acc_x 90.6250 (90.6250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/26] time 0.348 (0.345) data 0.270 (0.267) loss_x loss_x 0.4998 (0.4010) acc_x 90.6250 (90.6250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/24] time 0.304 (0.338) data 0.225 (0.260) loss_u loss_u 0.9038 (0.9244) acc_u 12.5000 (8.7500) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [10/24] time 0.346 (0.340) data 0.267 (0.261) loss_u loss_u 0.7837 (0.8927) acc_u 25.0000 (12.1875) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/24] time 0.350 (0.341) data 0.272 (0.262) loss_u loss_u 0.9302 (0.9000) acc_u 12.5000 (12.0833) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/24] time 0.352 (0.342) data 0.274 (0.263) loss_u loss_u 0.9600 (0.9071) acc_u 3.1250 (10.9375) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 328
confident_label rate tensor(0.5257, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 858
clean true:845
clean false:13
clean_rate:0.9848484848484849
noisy true:459
noisy false:315
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 774
epoch [60/200] batch [5/26] time 0.333 (0.355) data 0.255 (0.276) loss_x loss_x 0.5254 (0.5316) acc_x 87.5000 (85.6250) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [10/26] time 0.347 (0.346) data 0.270 (0.267) loss_x loss_x 0.5317 (0.4759) acc_x 81.2500 (87.1875) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [15/26] time 0.363 (0.344) data 0.285 (0.266) loss_x loss_x 0.2090 (0.4319) acc_x 96.8750 (88.3333) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/26] time 0.341 (0.343) data 0.263 (0.265) loss_x loss_x 0.2664 (0.4122) acc_x 93.7500 (88.7500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/26] time 0.331 (0.342) data 0.253 (0.264) loss_x loss_x 0.4622 (0.4256) acc_x 90.6250 (88.8750) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/24] time 0.311 (0.341) data 0.231 (0.263) loss_u loss_u 0.9146 (0.8957) acc_u 12.5000 (12.5000) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [10/24] time 0.372 (0.341) data 0.294 (0.262) loss_u loss_u 0.9141 (0.9064) acc_u 9.3750 (10.6250) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/24] time 0.356 (0.342) data 0.278 (0.263) loss_u loss_u 0.8774 (0.9094) acc_u 15.6250 (10.6250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/24] time 0.350 (0.342) data 0.271 (0.263) loss_u loss_u 0.8901 (0.9052) acc_u 12.5000 (11.2500) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 345
confident_label rate tensor(0.5153, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 841
clean true:830
clean false:11
clean_rate:0.9869203329369798
noisy true:457
noisy false:334
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 791
epoch [61/200] batch [5/26] time 0.347 (0.349) data 0.268 (0.271) loss_x loss_x 0.6768 (0.4716) acc_x 87.5000 (90.6250) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [10/26] time 0.338 (0.346) data 0.261 (0.268) loss_x loss_x 0.5664 (0.4114) acc_x 84.3750 (90.6250) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [15/26] time 0.341 (0.345) data 0.263 (0.267) loss_x loss_x 0.5615 (0.3985) acc_x 87.5000 (90.6250) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/26] time 0.337 (0.343) data 0.259 (0.265) loss_x loss_x 0.3374 (0.3778) acc_x 93.7500 (91.2500) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/26] time 0.325 (0.339) data 0.246 (0.261) loss_x loss_x 0.2037 (0.3799) acc_x 96.8750 (91.3750) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/24] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9053 (0.8967) acc_u 12.5000 (13.1250) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [10/24] time 0.357 (0.341) data 0.278 (0.263) loss_u loss_u 0.9341 (0.8945) acc_u 6.2500 (12.1875) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [15/24] time 0.334 (0.342) data 0.255 (0.264) loss_u loss_u 0.8994 (0.8945) acc_u 9.3750 (12.0833) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/24] time 0.341 (0.343) data 0.263 (0.264) loss_u loss_u 0.9199 (0.8975) acc_u 12.5000 (12.1875) lr 1.6004e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.5300, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 865
clean true:850
clean false:15
clean_rate:0.9826589595375722
noisy true:459
noisy false:308
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 767
epoch [62/200] batch [5/27] time 0.354 (0.355) data 0.275 (0.276) loss_x loss_x 0.2922 (0.4427) acc_x 93.7500 (90.0000) lr 1.5878e-03 eta 0:00:07
epoch [62/200] batch [10/27] time 0.349 (0.349) data 0.271 (0.270) loss_x loss_x 0.2037 (0.4549) acc_x 96.8750 (89.0625) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [15/27] time 0.338 (0.347) data 0.259 (0.269) loss_x loss_x 0.2864 (0.4676) acc_x 90.6250 (87.7083) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [20/27] time 0.318 (0.337) data 0.240 (0.259) loss_x loss_x 0.3008 (0.4838) acc_x 93.7500 (87.3438) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/27] time 0.348 (0.338) data 0.271 (0.260) loss_x loss_x 0.3091 (0.4454) acc_x 93.7500 (88.8750) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/23] time 0.344 (0.339) data 0.266 (0.261) loss_u loss_u 0.8994 (0.9062) acc_u 12.5000 (10.6250) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [10/23] time 0.351 (0.340) data 0.272 (0.262) loss_u loss_u 0.8330 (0.8992) acc_u 18.7500 (11.2500) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/23] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.8994 (0.9071) acc_u 12.5000 (10.2083) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/23] time 0.358 (0.341) data 0.279 (0.263) loss_u loss_u 0.9683 (0.9119) acc_u 6.2500 (10.3125) lr 1.5878e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.5270, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 860
clean true:840
clean false:20
clean_rate:0.9767441860465116
noisy true:454
noisy false:318
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 772
epoch [63/200] batch [5/26] time 0.332 (0.347) data 0.254 (0.268) loss_x loss_x 0.3147 (0.4450) acc_x 93.7500 (90.6250) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [10/26] time 0.340 (0.342) data 0.262 (0.264) loss_x loss_x 0.5156 (0.4394) acc_x 90.6250 (90.6250) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [15/26] time 0.326 (0.341) data 0.248 (0.263) loss_x loss_x 0.6753 (0.4326) acc_x 78.1250 (90.2083) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/26] time 0.303 (0.333) data 0.224 (0.254) loss_x loss_x 0.3889 (0.4299) acc_x 87.5000 (90.1562) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/26] time 0.354 (0.333) data 0.276 (0.255) loss_x loss_x 0.0892 (0.4274) acc_x 100.0000 (90.5000) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/24] time 0.339 (0.336) data 0.261 (0.258) loss_u loss_u 0.9199 (0.8891) acc_u 12.5000 (12.5000) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [10/24] time 0.350 (0.338) data 0.271 (0.260) loss_u loss_u 0.9419 (0.8850) acc_u 6.2500 (13.1250) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/24] time 0.342 (0.338) data 0.264 (0.260) loss_u loss_u 0.9302 (0.9006) acc_u 6.2500 (11.0417) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/24] time 0.342 (0.338) data 0.263 (0.260) loss_u loss_u 0.9771 (0.9008) acc_u 0.0000 (10.9375) lr 1.5750e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 310
confident_label rate tensor(0.5294, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 864
clean true:849
clean false:15
clean_rate:0.9826388888888888
noisy true:473
noisy false:295
after delete: len(clean_dataset) 864
after delete: len(noisy_dataset) 768
epoch [64/200] batch [5/27] time 0.321 (0.345) data 0.242 (0.267) loss_x loss_x 0.3542 (0.3945) acc_x 87.5000 (91.8750) lr 1.5621e-03 eta 0:00:07
epoch [64/200] batch [10/27] time 0.356 (0.343) data 0.277 (0.265) loss_x loss_x 0.4033 (0.4476) acc_x 87.5000 (90.0000) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [15/27] time 0.332 (0.339) data 0.254 (0.261) loss_x loss_x 0.4429 (0.4810) acc_x 87.5000 (88.9583) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [20/27] time 0.336 (0.336) data 0.258 (0.258) loss_x loss_x 0.6338 (0.4705) acc_x 84.3750 (88.7500) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/27] time 0.359 (0.339) data 0.281 (0.261) loss_x loss_x 0.2712 (0.4618) acc_x 93.7500 (89.0000) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/24] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9639 (0.9075) acc_u 3.1250 (11.2500) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [10/24] time 0.355 (0.341) data 0.277 (0.263) loss_u loss_u 0.8838 (0.9024) acc_u 18.7500 (11.8750) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [15/24] time 0.354 (0.341) data 0.275 (0.263) loss_u loss_u 0.9688 (0.9008) acc_u 3.1250 (11.6667) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/24] time 0.354 (0.341) data 0.276 (0.263) loss_u loss_u 0.8813 (0.8950) acc_u 12.5000 (12.3438) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 298
confident_label rate tensor(0.5404, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 882
clean true:864
clean false:18
clean_rate:0.9795918367346939
noisy true:470
noisy false:280
after delete: len(clean_dataset) 882
after delete: len(noisy_dataset) 750
epoch [65/200] batch [5/27] time 0.354 (0.341) data 0.277 (0.263) loss_x loss_x 0.4033 (0.3229) acc_x 90.6250 (92.5000) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [10/27] time 0.343 (0.340) data 0.265 (0.262) loss_x loss_x 0.2388 (0.3886) acc_x 93.7500 (90.0000) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [15/27] time 0.303 (0.325) data 0.224 (0.247) loss_x loss_x 0.5327 (0.4186) acc_x 87.5000 (88.3333) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/27] time 0.333 (0.325) data 0.255 (0.247) loss_x loss_x 0.3123 (0.4389) acc_x 90.6250 (89.0625) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/27] time 0.346 (0.328) data 0.268 (0.250) loss_x loss_x 0.5850 (0.4562) acc_x 90.6250 (88.7500) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/23] time 0.345 (0.331) data 0.267 (0.253) loss_u loss_u 0.8726 (0.9223) acc_u 15.6250 (8.7500) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/23] time 0.322 (0.333) data 0.244 (0.255) loss_u loss_u 0.9233 (0.9219) acc_u 6.2500 (8.7500) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/23] time 0.341 (0.334) data 0.262 (0.256) loss_u loss_u 0.9390 (0.9190) acc_u 9.3750 (9.1667) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/23] time 0.341 (0.336) data 0.263 (0.257) loss_u loss_u 0.8931 (0.9119) acc_u 9.3750 (10.0000) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 332
confident_label rate tensor(0.5221, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 852
clean true:840
clean false:12
clean_rate:0.9859154929577465
noisy true:460
noisy false:320
after delete: len(clean_dataset) 852
after delete: len(noisy_dataset) 780
epoch [66/200] batch [5/26] time 0.341 (0.344) data 0.264 (0.267) loss_x loss_x 0.3054 (0.3891) acc_x 93.7500 (91.2500) lr 1.5358e-03 eta 0:00:07
epoch [66/200] batch [10/26] time 0.337 (0.346) data 0.259 (0.268) loss_x loss_x 0.5176 (0.4287) acc_x 84.3750 (88.7500) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [15/26] time 0.341 (0.344) data 0.263 (0.265) loss_x loss_x 0.4773 (0.4572) acc_x 87.5000 (87.5000) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/26] time 0.324 (0.342) data 0.246 (0.263) loss_x loss_x 0.2893 (0.4623) acc_x 96.8750 (88.5938) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/26] time 0.342 (0.341) data 0.264 (0.263) loss_x loss_x 0.5786 (0.4564) acc_x 84.3750 (88.5000) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/24] time 0.319 (0.340) data 0.241 (0.262) loss_u loss_u 0.9351 (0.8859) acc_u 9.3750 (14.3750) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [10/24] time 0.343 (0.338) data 0.265 (0.260) loss_u loss_u 0.8735 (0.8924) acc_u 15.6250 (13.7500) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/24] time 0.338 (0.339) data 0.259 (0.261) loss_u loss_u 0.8813 (0.8951) acc_u 15.6250 (13.3333) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/24] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.9482 (0.8945) acc_u 6.2500 (13.4375) lr 1.5358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 293
confident_label rate tensor(0.5429, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 886
clean true:868
clean false:18
clean_rate:0.9796839729119639
noisy true:471
noisy false:275
after delete: len(clean_dataset) 886
after delete: len(noisy_dataset) 746
epoch [67/200] batch [5/27] time 0.328 (0.342) data 0.250 (0.264) loss_x loss_x 0.4587 (0.5427) acc_x 93.7500 (88.7500) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [10/27] time 0.326 (0.335) data 0.248 (0.257) loss_x loss_x 0.1638 (0.4374) acc_x 96.8750 (90.9375) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [15/27] time 0.299 (0.325) data 0.221 (0.246) loss_x loss_x 0.5415 (0.4251) acc_x 84.3750 (90.8333) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/27] time 0.352 (0.327) data 0.274 (0.249) loss_x loss_x 0.6196 (0.4492) acc_x 87.5000 (90.3125) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [25/27] time 0.339 (0.333) data 0.261 (0.254) loss_x loss_x 0.2764 (0.4393) acc_x 93.7500 (90.2500) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/23] time 0.332 (0.334) data 0.253 (0.256) loss_u loss_u 0.8750 (0.9083) acc_u 18.7500 (12.5000) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [10/23] time 0.298 (0.332) data 0.219 (0.254) loss_u loss_u 0.9194 (0.9222) acc_u 9.3750 (10.0000) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/23] time 0.357 (0.335) data 0.279 (0.256) loss_u loss_u 0.8892 (0.9144) acc_u 12.5000 (10.4167) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/23] time 0.346 (0.338) data 0.268 (0.260) loss_u loss_u 0.9434 (0.9115) acc_u 9.3750 (10.7812) lr 1.5225e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 319
confident_label rate tensor(0.5368, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 876
clean true:861
clean false:15
clean_rate:0.9828767123287672
noisy true:452
noisy false:304
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 756
epoch [68/200] batch [5/27] time 0.318 (0.344) data 0.241 (0.266) loss_x loss_x 0.4866 (0.3576) acc_x 87.5000 (91.8750) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [10/27] time 0.327 (0.338) data 0.249 (0.260) loss_x loss_x 0.3501 (0.3699) acc_x 90.6250 (91.2500) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [15/27] time 0.297 (0.337) data 0.219 (0.259) loss_x loss_x 0.2842 (0.3880) acc_x 93.7500 (90.4167) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [20/27] time 0.345 (0.335) data 0.267 (0.257) loss_x loss_x 0.1311 (0.3589) acc_x 100.0000 (91.2500) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/27] time 0.345 (0.336) data 0.268 (0.258) loss_x loss_x 0.6616 (0.4009) acc_x 84.3750 (90.3750) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/23] time 0.349 (0.339) data 0.269 (0.261) loss_u loss_u 0.9219 (0.9300) acc_u 12.5000 (8.7500) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [10/23] time 0.348 (0.340) data 0.269 (0.261) loss_u loss_u 0.9023 (0.9109) acc_u 12.5000 (10.6250) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/23] time 0.343 (0.340) data 0.265 (0.262) loss_u loss_u 0.9639 (0.9180) acc_u 3.1250 (10.0000) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/23] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.9263 (0.9153) acc_u 12.5000 (10.3125) lr 1.5090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 302
confident_label rate tensor(0.5325, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 869
clean true:859
clean false:10
clean_rate:0.9884925201380897
noisy true:471
noisy false:292
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 763
epoch [69/200] batch [5/27] time 0.349 (0.344) data 0.270 (0.266) loss_x loss_x 0.5117 (0.4907) acc_x 90.6250 (90.0000) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [10/27] time 0.350 (0.345) data 0.272 (0.267) loss_x loss_x 0.3240 (0.4661) acc_x 90.6250 (89.6875) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [15/27] time 0.303 (0.338) data 0.225 (0.260) loss_x loss_x 0.3035 (0.4367) acc_x 93.7500 (89.3750) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [20/27] time 0.354 (0.338) data 0.277 (0.260) loss_x loss_x 0.4578 (0.4276) acc_x 90.6250 (89.5312) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/27] time 0.341 (0.337) data 0.263 (0.259) loss_x loss_x 0.5703 (0.4417) acc_x 81.2500 (88.3750) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/23] time 0.363 (0.339) data 0.284 (0.261) loss_u loss_u 0.9292 (0.8965) acc_u 12.5000 (11.8750) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [10/23] time 0.346 (0.337) data 0.267 (0.259) loss_u loss_u 0.9272 (0.9071) acc_u 9.3750 (11.2500) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/23] time 0.312 (0.335) data 0.233 (0.257) loss_u loss_u 0.8511 (0.9120) acc_u 18.7500 (10.8333) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/23] time 0.339 (0.335) data 0.261 (0.256) loss_u loss_u 0.9360 (0.9158) acc_u 9.3750 (10.4688) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 284
confident_label rate tensor(0.5362, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 875
clean true:866
clean false:9
clean_rate:0.9897142857142858
noisy true:482
noisy false:275
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 757
epoch [70/200] batch [5/27] time 0.341 (0.349) data 0.263 (0.271) loss_x loss_x 0.5444 (0.4429) acc_x 84.3750 (91.8750) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [10/27] time 0.343 (0.348) data 0.265 (0.269) loss_x loss_x 0.5513 (0.4271) acc_x 87.5000 (90.9375) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [15/27] time 0.328 (0.345) data 0.250 (0.267) loss_x loss_x 0.3057 (0.4049) acc_x 93.7500 (91.8750) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [20/27] time 0.351 (0.337) data 0.272 (0.259) loss_x loss_x 0.5044 (0.3977) acc_x 87.5000 (91.2500) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/27] time 0.338 (0.339) data 0.261 (0.261) loss_x loss_x 0.4285 (0.4055) acc_x 87.5000 (90.6250) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/23] time 0.334 (0.339) data 0.256 (0.261) loss_u loss_u 0.9258 (0.9354) acc_u 6.2500 (6.8750) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [10/23] time 0.353 (0.338) data 0.274 (0.260) loss_u loss_u 0.8735 (0.9093) acc_u 15.6250 (10.6250) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/23] time 0.338 (0.339) data 0.260 (0.260) loss_u loss_u 0.9570 (0.9100) acc_u 6.2500 (10.4167) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/23] time 0.340 (0.340) data 0.261 (0.261) loss_u loss_u 0.9517 (0.9082) acc_u 9.3750 (11.2500) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 282
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:876
clean false:15
clean_rate:0.9831649831649831
noisy true:474
noisy false:267
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [71/200] batch [5/27] time 0.336 (0.341) data 0.259 (0.263) loss_x loss_x 0.3494 (0.3816) acc_x 90.6250 (86.8750) lr 1.4679e-03 eta 0:00:07
epoch [71/200] batch [10/27] time 0.341 (0.343) data 0.264 (0.265) loss_x loss_x 0.4531 (0.4406) acc_x 93.7500 (88.4375) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [15/27] time 0.320 (0.340) data 0.243 (0.262) loss_x loss_x 0.3728 (0.4159) acc_x 93.7500 (89.3750) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [20/27] time 0.354 (0.339) data 0.276 (0.261) loss_x loss_x 0.4180 (0.4193) acc_x 90.6250 (89.0625) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/27] time 0.328 (0.338) data 0.250 (0.260) loss_x loss_x 0.2306 (0.4147) acc_x 100.0000 (90.1250) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/23] time 0.333 (0.339) data 0.254 (0.261) loss_u loss_u 0.9556 (0.8875) acc_u 6.2500 (13.1250) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [10/23] time 0.347 (0.340) data 0.269 (0.262) loss_u loss_u 0.8989 (0.9126) acc_u 12.5000 (10.3125) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/23] time 0.343 (0.342) data 0.263 (0.264) loss_u loss_u 0.9282 (0.9043) acc_u 15.6250 (11.4583) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/23] time 0.345 (0.343) data 0.267 (0.265) loss_u loss_u 0.8608 (0.9056) acc_u 15.6250 (11.5625) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 289
confident_label rate tensor(0.5398, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 881
clean true:860
clean false:21
clean_rate:0.9761634506242906
noisy true:483
noisy false:268
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 751
epoch [72/200] batch [5/27] time 0.355 (0.350) data 0.277 (0.272) loss_x loss_x 0.3010 (0.3598) acc_x 93.7500 (92.5000) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [10/27] time 0.329 (0.347) data 0.251 (0.269) loss_x loss_x 0.8433 (0.3741) acc_x 81.2500 (91.8750) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [15/27] time 0.306 (0.337) data 0.227 (0.259) loss_x loss_x 0.2678 (0.3904) acc_x 96.8750 (91.6667) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [20/27] time 0.337 (0.334) data 0.260 (0.256) loss_x loss_x 0.4783 (0.4001) acc_x 84.3750 (90.7812) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [25/27] time 0.336 (0.336) data 0.258 (0.258) loss_x loss_x 0.3525 (0.3887) acc_x 90.6250 (91.1250) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/23] time 0.351 (0.337) data 0.272 (0.259) loss_u loss_u 0.9321 (0.9319) acc_u 9.3750 (8.7500) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [10/23] time 0.335 (0.337) data 0.257 (0.259) loss_u loss_u 0.9272 (0.9247) acc_u 6.2500 (9.3750) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/23] time 0.344 (0.338) data 0.266 (0.260) loss_u loss_u 0.9146 (0.9154) acc_u 9.3750 (10.0000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/23] time 0.347 (0.338) data 0.269 (0.260) loss_u loss_u 0.8584 (0.9130) acc_u 21.8750 (10.3125) lr 1.4540e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 292
confident_label rate tensor(0.5386, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 879
clean true:869
clean false:10
clean_rate:0.9886234357224118
noisy true:471
noisy false:282
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 753
epoch [73/200] batch [5/27] time 0.373 (0.352) data 0.295 (0.274) loss_x loss_x 0.3867 (0.4665) acc_x 87.5000 (90.0000) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [10/27] time 0.299 (0.342) data 0.221 (0.264) loss_x loss_x 0.4309 (0.4544) acc_x 84.3750 (89.6875) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [15/27] time 0.305 (0.330) data 0.226 (0.252) loss_x loss_x 0.3301 (0.4278) acc_x 90.6250 (90.8333) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/27] time 0.341 (0.332) data 0.263 (0.253) loss_x loss_x 0.3328 (0.4590) acc_x 93.7500 (89.5312) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/27] time 0.343 (0.332) data 0.265 (0.254) loss_x loss_x 0.3789 (0.4718) acc_x 93.7500 (88.7500) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/23] time 0.342 (0.335) data 0.264 (0.257) loss_u loss_u 0.8877 (0.9084) acc_u 12.5000 (10.6250) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [10/23] time 0.345 (0.336) data 0.267 (0.258) loss_u loss_u 0.8916 (0.9065) acc_u 12.5000 (11.2500) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [15/23] time 0.344 (0.338) data 0.265 (0.260) loss_u loss_u 0.8887 (0.9118) acc_u 15.6250 (10.6250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/23] time 0.341 (0.338) data 0.262 (0.260) loss_u loss_u 0.9395 (0.9148) acc_u 9.3750 (10.1562) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 310
confident_label rate tensor(0.5331, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 870
clean true:855
clean false:15
clean_rate:0.9827586206896551
noisy true:467
noisy false:295
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 762
epoch [74/200] batch [5/27] time 0.343 (0.336) data 0.265 (0.257) loss_x loss_x 0.6685 (0.5496) acc_x 84.3750 (86.8750) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [10/27] time 0.332 (0.334) data 0.254 (0.255) loss_x loss_x 0.3154 (0.4286) acc_x 87.5000 (89.6875) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [15/27] time 0.314 (0.329) data 0.231 (0.250) loss_x loss_x 0.6279 (0.4250) acc_x 81.2500 (89.3750) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/27] time 0.349 (0.332) data 0.271 (0.253) loss_x loss_x 0.4683 (0.4059) acc_x 90.6250 (90.1562) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/27] time 0.313 (0.334) data 0.236 (0.256) loss_x loss_x 0.5801 (0.4292) acc_x 87.5000 (89.7500) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/23] time 0.358 (0.335) data 0.280 (0.257) loss_u loss_u 0.9644 (0.9026) acc_u 3.1250 (11.8750) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [10/23] time 0.341 (0.336) data 0.262 (0.257) loss_u loss_u 0.8950 (0.8990) acc_u 12.5000 (12.1875) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/23] time 0.314 (0.334) data 0.234 (0.255) loss_u loss_u 0.8530 (0.8953) acc_u 15.6250 (12.2917) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/23] time 0.346 (0.335) data 0.268 (0.257) loss_u loss_u 0.9009 (0.8866) acc_u 9.3750 (13.2812) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.5435, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 887
clean true:870
clean false:17
clean_rate:0.9808342728297632
noisy true:475
noisy false:270
after delete: len(clean_dataset) 887
after delete: len(noisy_dataset) 745
epoch [75/200] batch [5/27] time 0.360 (0.352) data 0.282 (0.273) loss_x loss_x 0.4592 (0.3556) acc_x 93.7500 (92.5000) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [10/27] time 0.300 (0.340) data 0.221 (0.262) loss_x loss_x 0.7383 (0.4576) acc_x 75.0000 (90.3125) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [15/27] time 0.337 (0.333) data 0.259 (0.255) loss_x loss_x 0.2119 (0.4384) acc_x 96.8750 (90.0000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/27] time 0.331 (0.333) data 0.253 (0.255) loss_x loss_x 0.4937 (0.4367) acc_x 84.3750 (89.0625) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/27] time 0.337 (0.335) data 0.259 (0.257) loss_x loss_x 0.4626 (0.4333) acc_x 90.6250 (89.3750) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/23] time 0.361 (0.339) data 0.283 (0.260) loss_u loss_u 0.8472 (0.9125) acc_u 18.7500 (10.6250) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [10/23] time 0.332 (0.339) data 0.254 (0.260) loss_u loss_u 0.8965 (0.9110) acc_u 15.6250 (10.6250) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/23] time 0.345 (0.340) data 0.267 (0.261) loss_u loss_u 0.8901 (0.9120) acc_u 9.3750 (10.2083) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/23] time 0.330 (0.340) data 0.252 (0.262) loss_u loss_u 0.8638 (0.9100) acc_u 15.6250 (10.6250) lr 1.4115e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.5417, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 884
clean true:868
clean false:16
clean_rate:0.9819004524886877
noisy true:488
noisy false:260
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 748
epoch [76/200] batch [5/27] time 0.323 (0.344) data 0.244 (0.266) loss_x loss_x 0.5166 (0.3781) acc_x 90.6250 (91.8750) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [10/27] time 0.311 (0.324) data 0.232 (0.246) loss_x loss_x 0.3123 (0.3204) acc_x 93.7500 (93.7500) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [15/27] time 0.338 (0.327) data 0.260 (0.248) loss_x loss_x 0.3005 (0.3651) acc_x 93.7500 (91.2500) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/27] time 0.326 (0.330) data 0.249 (0.251) loss_x loss_x 0.6958 (0.3852) acc_x 78.1250 (89.6875) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/27] time 0.346 (0.330) data 0.267 (0.252) loss_x loss_x 0.3359 (0.3732) acc_x 87.5000 (89.8750) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/23] time 0.344 (0.332) data 0.264 (0.254) loss_u loss_u 0.8760 (0.8934) acc_u 12.5000 (12.5000) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/23] time 0.354 (0.331) data 0.276 (0.252) loss_u loss_u 0.8848 (0.9043) acc_u 12.5000 (11.2500) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/23] time 0.344 (0.332) data 0.266 (0.254) loss_u loss_u 0.9067 (0.9067) acc_u 9.3750 (10.8333) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/23] time 0.368 (0.334) data 0.290 (0.256) loss_u loss_u 0.8828 (0.9075) acc_u 12.5000 (10.7812) lr 1.3971e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 294
confident_label rate tensor(0.5417, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 884
clean true:871
clean false:13
clean_rate:0.9852941176470589
noisy true:467
noisy false:281
after delete: len(clean_dataset) 884
after delete: len(noisy_dataset) 748
epoch [77/200] batch [5/27] time 0.335 (0.345) data 0.257 (0.267) loss_x loss_x 0.1650 (0.3648) acc_x 100.0000 (91.8750) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [10/27] time 0.319 (0.337) data 0.240 (0.259) loss_x loss_x 0.3086 (0.3637) acc_x 90.6250 (91.5625) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [15/27] time 0.344 (0.342) data 0.267 (0.264) loss_x loss_x 0.3977 (0.3970) acc_x 93.7500 (90.6250) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [20/27] time 0.328 (0.340) data 0.250 (0.262) loss_x loss_x 0.3022 (0.3856) acc_x 90.6250 (90.1562) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/27] time 0.342 (0.339) data 0.264 (0.261) loss_x loss_x 0.5107 (0.3930) acc_x 87.5000 (90.1250) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/23] time 0.331 (0.338) data 0.253 (0.260) loss_u loss_u 0.8774 (0.8983) acc_u 12.5000 (11.2500) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [10/23] time 0.347 (0.339) data 0.268 (0.260) loss_u loss_u 0.9292 (0.9061) acc_u 6.2500 (10.0000) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/23] time 0.355 (0.340) data 0.277 (0.262) loss_u loss_u 0.8096 (0.9036) acc_u 25.0000 (10.6250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/23] time 0.346 (0.342) data 0.267 (0.263) loss_u loss_u 0.9243 (0.9071) acc_u 12.5000 (10.6250) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:879
clean false:12
clean_rate:0.9865319865319865
noisy true:490
noisy false:251
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [78/200] batch [5/27] time 0.332 (0.346) data 0.253 (0.268) loss_x loss_x 0.3232 (0.3225) acc_x 96.8750 (92.5000) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [10/27] time 0.307 (0.325) data 0.228 (0.247) loss_x loss_x 0.4014 (0.3621) acc_x 84.3750 (90.6250) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [15/27] time 0.334 (0.326) data 0.256 (0.247) loss_x loss_x 0.4067 (0.4017) acc_x 90.6250 (89.3750) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/27] time 0.345 (0.330) data 0.267 (0.252) loss_x loss_x 0.3828 (0.4062) acc_x 87.5000 (89.3750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/27] time 0.335 (0.333) data 0.258 (0.255) loss_x loss_x 0.3323 (0.4175) acc_x 93.7500 (89.2500) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/23] time 0.356 (0.336) data 0.277 (0.258) loss_u loss_u 0.9102 (0.9020) acc_u 9.3750 (11.2500) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [10/23] time 0.350 (0.338) data 0.272 (0.260) loss_u loss_u 0.9829 (0.9090) acc_u 0.0000 (11.2500) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/23] time 0.344 (0.338) data 0.266 (0.260) loss_u loss_u 0.9536 (0.9133) acc_u 9.3750 (11.0417) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/23] time 0.336 (0.339) data 0.256 (0.261) loss_u loss_u 0.9155 (0.9068) acc_u 9.3750 (11.4062) lr 1.3681e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 294
confident_label rate tensor(0.5368, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 876
clean true:863
clean false:13
clean_rate:0.9851598173515982
noisy true:475
noisy false:281
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 756
epoch [79/200] batch [5/27] time 0.340 (0.344) data 0.261 (0.266) loss_x loss_x 0.2172 (0.4411) acc_x 96.8750 (88.7500) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [10/27] time 0.347 (0.347) data 0.269 (0.269) loss_x loss_x 0.2397 (0.4200) acc_x 96.8750 (90.0000) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [15/27] time 0.338 (0.344) data 0.259 (0.266) loss_x loss_x 0.4990 (0.4393) acc_x 90.6250 (90.0000) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [20/27] time 0.353 (0.345) data 0.275 (0.267) loss_x loss_x 0.3994 (0.4185) acc_x 90.6250 (90.3125) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/27] time 0.341 (0.345) data 0.263 (0.267) loss_x loss_x 0.4929 (0.4194) acc_x 87.5000 (90.3750) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/23] time 0.350 (0.345) data 0.271 (0.267) loss_u loss_u 0.9048 (0.8961) acc_u 9.3750 (13.1250) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [10/23] time 0.343 (0.345) data 0.264 (0.267) loss_u loss_u 0.9282 (0.8979) acc_u 6.2500 (11.8750) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/23] time 0.343 (0.344) data 0.265 (0.266) loss_u loss_u 0.8140 (0.8913) acc_u 21.8750 (12.5000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/23] time 0.349 (0.344) data 0.270 (0.266) loss_u loss_u 0.8853 (0.8982) acc_u 18.7500 (12.1875) lr 1.3535e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 300
confident_label rate tensor(0.5300, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 865
clean true:851
clean false:14
clean_rate:0.9838150289017341
noisy true:481
noisy false:286
after delete: len(clean_dataset) 865
after delete: len(noisy_dataset) 767
epoch [80/200] batch [5/27] time 0.353 (0.345) data 0.275 (0.268) loss_x loss_x 0.3618 (0.4025) acc_x 90.6250 (89.3750) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [10/27] time 0.363 (0.346) data 0.284 (0.268) loss_x loss_x 0.2739 (0.4053) acc_x 93.7500 (90.3125) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [15/27] time 0.340 (0.344) data 0.263 (0.266) loss_x loss_x 0.3145 (0.4437) acc_x 90.6250 (89.3750) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [20/27] time 0.332 (0.342) data 0.254 (0.264) loss_x loss_x 0.5278 (0.4380) acc_x 87.5000 (89.0625) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/27] time 0.336 (0.343) data 0.258 (0.265) loss_x loss_x 0.5854 (0.4393) acc_x 78.1250 (89.2500) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/23] time 0.358 (0.345) data 0.280 (0.267) loss_u loss_u 0.9087 (0.8800) acc_u 9.3750 (12.5000) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [10/23] time 0.346 (0.345) data 0.268 (0.267) loss_u loss_u 0.9302 (0.8846) acc_u 6.2500 (12.8125) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/23] time 0.353 (0.345) data 0.274 (0.267) loss_u loss_u 0.9575 (0.8773) acc_u 3.1250 (13.7500) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/23] time 0.300 (0.343) data 0.220 (0.265) loss_u loss_u 0.9263 (0.8814) acc_u 9.3750 (13.1250) lr 1.3387e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 286
confident_label rate tensor(0.5496, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 897
clean true:880
clean false:17
clean_rate:0.9810479375696767
noisy true:466
noisy false:269
after delete: len(clean_dataset) 897
after delete: len(noisy_dataset) 735
epoch [81/200] batch [5/28] time 0.346 (0.350) data 0.267 (0.272) loss_x loss_x 0.4978 (0.4493) acc_x 90.6250 (86.8750) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [10/28] time 0.345 (0.348) data 0.267 (0.270) loss_x loss_x 0.3347 (0.4857) acc_x 90.6250 (85.6250) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [15/28] time 0.326 (0.343) data 0.248 (0.265) loss_x loss_x 0.3962 (0.4654) acc_x 90.6250 (86.6667) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [20/28] time 0.354 (0.337) data 0.275 (0.259) loss_x loss_x 0.0665 (0.4237) acc_x 100.0000 (87.8125) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/28] time 0.332 (0.338) data 0.254 (0.260) loss_x loss_x 0.4583 (0.4107) acc_x 90.6250 (88.5000) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [5/22] time 0.345 (0.339) data 0.266 (0.261) loss_u loss_u 0.9429 (0.9119) acc_u 6.2500 (10.0000) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/22] time 0.340 (0.339) data 0.262 (0.261) loss_u loss_u 0.9580 (0.9018) acc_u 9.3750 (11.5625) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [15/22] time 0.351 (0.340) data 0.272 (0.262) loss_u loss_u 0.9033 (0.9105) acc_u 12.5000 (10.8333) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/22] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9170 (0.9104) acc_u 9.3750 (10.3125) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 277
confident_label rate tensor(0.5411, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 883
clean true:870
clean false:13
clean_rate:0.9852774631936579
noisy true:485
noisy false:264
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 749
epoch [82/200] batch [5/27] time 0.350 (0.348) data 0.272 (0.270) loss_x loss_x 0.2186 (0.2888) acc_x 93.7500 (93.7500) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [10/27] time 0.357 (0.346) data 0.279 (0.269) loss_x loss_x 0.2559 (0.3917) acc_x 96.8750 (92.1875) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [15/27] time 0.344 (0.343) data 0.266 (0.265) loss_x loss_x 0.6636 (0.4020) acc_x 90.6250 (91.4583) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [20/27] time 0.350 (0.342) data 0.272 (0.264) loss_x loss_x 0.3369 (0.4007) acc_x 87.5000 (91.4062) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/27] time 0.348 (0.342) data 0.270 (0.265) loss_x loss_x 0.2269 (0.3957) acc_x 96.8750 (91.2500) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/23] time 0.326 (0.342) data 0.248 (0.264) loss_u loss_u 0.9478 (0.9101) acc_u 6.2500 (10.0000) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [10/23] time 0.347 (0.343) data 0.268 (0.265) loss_u loss_u 0.8823 (0.9102) acc_u 12.5000 (10.3125) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/23] time 0.351 (0.343) data 0.273 (0.265) loss_u loss_u 0.9727 (0.9107) acc_u 3.1250 (10.2083) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/23] time 0.350 (0.343) data 0.272 (0.265) loss_u loss_u 0.9106 (0.9088) acc_u 9.3750 (10.3125) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.5637, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 920
clean true:899
clean false:21
clean_rate:0.9771739130434782
noisy true:474
noisy false:238
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 712
epoch [83/200] batch [5/28] time 0.352 (0.345) data 0.275 (0.267) loss_x loss_x 0.4092 (0.4627) acc_x 90.6250 (92.5000) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [10/28] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.5532 (0.5107) acc_x 81.2500 (89.3750) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [15/28] time 0.326 (0.343) data 0.248 (0.265) loss_x loss_x 0.5703 (0.4859) acc_x 81.2500 (89.1667) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [20/28] time 0.344 (0.341) data 0.266 (0.262) loss_x loss_x 0.2590 (0.4538) acc_x 90.6250 (89.2188) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/28] time 0.360 (0.342) data 0.282 (0.264) loss_x loss_x 0.1803 (0.4210) acc_x 96.8750 (89.7500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [5/22] time 0.372 (0.344) data 0.294 (0.266) loss_u loss_u 0.8936 (0.9068) acc_u 15.6250 (11.2500) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/22] time 0.338 (0.344) data 0.260 (0.266) loss_u loss_u 0.9512 (0.9216) acc_u 3.1250 (9.3750) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/22] time 0.307 (0.342) data 0.230 (0.264) loss_u loss_u 0.9028 (0.9275) acc_u 12.5000 (8.7500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/22] time 0.341 (0.340) data 0.263 (0.261) loss_u loss_u 0.9189 (0.9281) acc_u 9.3750 (8.4375) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.5466, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 892
clean true:874
clean false:18
clean_rate:0.9798206278026906
noisy true:482
noisy false:258
after delete: len(clean_dataset) 892
after delete: len(noisy_dataset) 740
epoch [84/200] batch [5/27] time 0.343 (0.340) data 0.265 (0.263) loss_x loss_x 0.4658 (0.4376) acc_x 84.3750 (86.2500) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [10/27] time 0.347 (0.342) data 0.269 (0.264) loss_x loss_x 0.2068 (0.4608) acc_x 96.8750 (87.5000) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [15/27] time 0.356 (0.344) data 0.276 (0.265) loss_x loss_x 0.3232 (0.4235) acc_x 90.6250 (88.9583) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [20/27] time 0.307 (0.338) data 0.229 (0.260) loss_x loss_x 0.3179 (0.4061) acc_x 87.5000 (89.5312) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/27] time 0.386 (0.341) data 0.307 (0.263) loss_x loss_x 0.3213 (0.4270) acc_x 93.7500 (89.6250) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/23] time 0.372 (0.348) data 0.293 (0.269) loss_u loss_u 0.8804 (0.8788) acc_u 15.6250 (14.3750) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [10/23] time 0.345 (0.349) data 0.267 (0.270) loss_u loss_u 0.9048 (0.8716) acc_u 9.3750 (15.0000) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/23] time 0.333 (0.349) data 0.253 (0.270) loss_u loss_u 0.9575 (0.8824) acc_u 3.1250 (13.7500) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/23] time 0.327 (0.345) data 0.247 (0.266) loss_u loss_u 0.9106 (0.8928) acc_u 12.5000 (12.3438) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.5533, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 903
clean true:886
clean false:17
clean_rate:0.9811738648947951
noisy true:483
noisy false:246
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 729
epoch [85/200] batch [5/28] time 0.332 (0.345) data 0.254 (0.267) loss_x loss_x 0.3313 (0.3588) acc_x 93.7500 (93.7500) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [10/28] time 0.324 (0.343) data 0.246 (0.265) loss_x loss_x 0.2444 (0.3370) acc_x 96.8750 (92.1875) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [15/28] time 0.337 (0.341) data 0.260 (0.263) loss_x loss_x 0.9238 (0.3717) acc_x 81.2500 (92.0833) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [20/28] time 0.340 (0.342) data 0.262 (0.264) loss_x loss_x 0.3469 (0.3586) acc_x 90.6250 (92.0312) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/28] time 0.346 (0.343) data 0.267 (0.265) loss_x loss_x 0.3560 (0.3516) acc_x 90.6250 (91.8750) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [5/22] time 0.341 (0.344) data 0.262 (0.266) loss_u loss_u 0.9521 (0.9237) acc_u 9.3750 (10.0000) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/22] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.8589 (0.9111) acc_u 18.7500 (11.2500) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/22] time 0.318 (0.342) data 0.236 (0.264) loss_u loss_u 0.9512 (0.9171) acc_u 6.2500 (10.0000) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [20/22] time 0.336 (0.341) data 0.257 (0.263) loss_u loss_u 0.8760 (0.9153) acc_u 15.6250 (10.6250) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 275
confident_label rate tensor(0.5545, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 905
clean true:889
clean false:16
clean_rate:0.9823204419889503
noisy true:468
noisy false:259
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 727
epoch [86/200] batch [5/28] time 0.344 (0.351) data 0.266 (0.272) loss_x loss_x 0.2489 (0.3180) acc_x 90.6250 (91.8750) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [10/28] time 0.336 (0.347) data 0.259 (0.268) loss_x loss_x 0.4421 (0.3801) acc_x 87.5000 (90.3125) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [15/28] time 0.341 (0.346) data 0.263 (0.268) loss_x loss_x 0.3376 (0.3683) acc_x 93.7500 (90.8333) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [20/28] time 0.341 (0.347) data 0.263 (0.269) loss_x loss_x 0.4524 (0.3876) acc_x 84.3750 (90.1562) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/28] time 0.347 (0.346) data 0.269 (0.269) loss_x loss_x 0.6675 (0.3975) acc_x 84.3750 (89.7500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [5/22] time 0.315 (0.342) data 0.236 (0.264) loss_u loss_u 0.8823 (0.8979) acc_u 15.6250 (12.5000) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/22] time 0.347 (0.343) data 0.268 (0.265) loss_u loss_u 0.9648 (0.9174) acc_u 6.2500 (9.6875) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/22] time 0.340 (0.343) data 0.261 (0.265) loss_u loss_u 0.8711 (0.9179) acc_u 15.6250 (9.7917) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/22] time 0.352 (0.343) data 0.273 (0.265) loss_u loss_u 0.9150 (0.9158) acc_u 9.3750 (9.8438) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 281
confident_label rate tensor(0.5472, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 893
clean true:872
clean false:21
clean_rate:0.9764837625979843
noisy true:479
noisy false:260
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 739
epoch [87/200] batch [5/27] time 0.345 (0.351) data 0.267 (0.273) loss_x loss_x 0.2881 (0.4479) acc_x 93.7500 (88.7500) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [10/27] time 0.341 (0.348) data 0.263 (0.270) loss_x loss_x 0.3086 (0.4786) acc_x 96.8750 (88.4375) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [15/27] time 0.343 (0.344) data 0.265 (0.266) loss_x loss_x 0.2002 (0.4466) acc_x 96.8750 (89.5833) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [20/27] time 0.334 (0.344) data 0.257 (0.265) loss_x loss_x 0.3079 (0.4355) acc_x 90.6250 (89.6875) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/27] time 0.334 (0.342) data 0.256 (0.264) loss_x loss_x 0.8013 (0.4406) acc_x 78.1250 (89.7500) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/23] time 0.327 (0.348) data 0.248 (0.270) loss_u loss_u 0.9253 (0.8976) acc_u 12.5000 (13.1250) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [10/23] time 0.347 (0.347) data 0.269 (0.268) loss_u loss_u 0.8442 (0.9160) acc_u 18.7500 (10.3125) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/23] time 0.349 (0.347) data 0.270 (0.268) loss_u loss_u 0.7803 (0.8942) acc_u 25.0000 (12.7083) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/23] time 0.348 (0.347) data 0.270 (0.269) loss_u loss_u 0.8696 (0.8931) acc_u 12.5000 (12.3438) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.5460, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 891
clean true:883
clean false:8
clean_rate:0.9910213243546577
noisy true:484
noisy false:257
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 741
epoch [88/200] batch [5/27] time 0.344 (0.351) data 0.266 (0.272) loss_x loss_x 0.2588 (0.3228) acc_x 93.7500 (91.8750) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [10/27] time 0.337 (0.354) data 0.259 (0.276) loss_x loss_x 0.3748 (0.2723) acc_x 90.6250 (94.3750) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [15/27] time 0.346 (0.351) data 0.268 (0.273) loss_x loss_x 0.4377 (0.3062) acc_x 87.5000 (93.9583) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [20/27] time 0.331 (0.344) data 0.253 (0.266) loss_x loss_x 0.2617 (0.3228) acc_x 93.7500 (93.2812) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/27] time 0.349 (0.345) data 0.271 (0.267) loss_x loss_x 0.2820 (0.3295) acc_x 93.7500 (93.5000) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/23] time 0.305 (0.336) data 0.226 (0.258) loss_u loss_u 0.9507 (0.9068) acc_u 6.2500 (10.0000) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [10/23] time 0.343 (0.336) data 0.264 (0.257) loss_u loss_u 0.9102 (0.9128) acc_u 9.3750 (10.0000) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/23] time 0.328 (0.335) data 0.250 (0.257) loss_u loss_u 0.9023 (0.9059) acc_u 12.5000 (11.0417) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/23] time 0.330 (0.335) data 0.252 (0.257) loss_u loss_u 0.8809 (0.9015) acc_u 12.5000 (11.8750) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:885
clean false:14
clean_rate:0.9844271412680756
noisy true:487
noisy false:246
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [89/200] batch [5/28] time 0.353 (0.357) data 0.275 (0.279) loss_x loss_x 0.3274 (0.4427) acc_x 90.6250 (87.5000) lr 1.2028e-03 eta 0:00:08
epoch [89/200] batch [10/28] time 0.351 (0.349) data 0.273 (0.271) loss_x loss_x 0.3359 (0.4154) acc_x 90.6250 (89.3750) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [15/28] time 0.341 (0.347) data 0.264 (0.269) loss_x loss_x 0.5039 (0.4159) acc_x 84.3750 (89.1667) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [20/28] time 0.341 (0.345) data 0.264 (0.267) loss_x loss_x 0.3545 (0.4050) acc_x 90.6250 (89.8438) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/28] time 0.352 (0.344) data 0.274 (0.266) loss_x loss_x 0.2330 (0.4098) acc_x 100.0000 (89.7500) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [5/22] time 0.313 (0.339) data 0.234 (0.260) loss_u loss_u 0.8428 (0.9024) acc_u 18.7500 (11.2500) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/22] time 0.344 (0.338) data 0.265 (0.260) loss_u loss_u 0.9688 (0.8939) acc_u 3.1250 (11.8750) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/22] time 0.342 (0.339) data 0.264 (0.261) loss_u loss_u 0.9614 (0.8995) acc_u 6.2500 (11.8750) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/22] time 0.355 (0.340) data 0.277 (0.262) loss_u loss_u 0.9155 (0.9025) acc_u 9.3750 (11.7188) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 274
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:886
clean false:16
clean_rate:0.9822616407982262
noisy true:472
noisy false:258
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [90/200] batch [5/28] time 0.311 (0.325) data 0.233 (0.247) loss_x loss_x 0.1586 (0.4262) acc_x 100.0000 (91.2500) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [10/28] time 0.349 (0.332) data 0.272 (0.254) loss_x loss_x 0.3516 (0.3759) acc_x 93.7500 (92.5000) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [15/28] time 0.342 (0.336) data 0.264 (0.258) loss_x loss_x 0.5581 (0.4044) acc_x 84.3750 (91.4583) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [20/28] time 0.354 (0.338) data 0.276 (0.260) loss_x loss_x 0.2437 (0.4138) acc_x 93.7500 (90.7812) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/28] time 0.342 (0.339) data 0.264 (0.262) loss_x loss_x 0.2905 (0.4070) acc_x 90.6250 (90.1250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [5/22] time 0.296 (0.331) data 0.217 (0.253) loss_u loss_u 0.8945 (0.9075) acc_u 12.5000 (10.0000) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/22] time 0.331 (0.331) data 0.253 (0.253) loss_u loss_u 0.9355 (0.9146) acc_u 9.3750 (9.6875) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [15/22] time 0.340 (0.331) data 0.262 (0.253) loss_u loss_u 0.8521 (0.9178) acc_u 18.7500 (9.5833) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [20/22] time 0.335 (0.332) data 0.257 (0.254) loss_u loss_u 0.9731 (0.9156) acc_u 3.1250 (10.1562) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.5472, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 893
clean true:881
clean false:12
clean_rate:0.986562150055991
noisy true:483
noisy false:256
after delete: len(clean_dataset) 893
after delete: len(noisy_dataset) 739
epoch [91/200] batch [5/27] time 0.344 (0.346) data 0.266 (0.268) loss_x loss_x 0.2358 (0.2961) acc_x 96.8750 (95.6250) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [10/27] time 0.349 (0.343) data 0.271 (0.265) loss_x loss_x 0.3716 (0.2986) acc_x 93.7500 (94.3750) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [15/27] time 0.341 (0.345) data 0.263 (0.267) loss_x loss_x 0.3066 (0.3201) acc_x 90.6250 (93.3333) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [20/27] time 0.333 (0.345) data 0.256 (0.267) loss_x loss_x 0.3706 (0.3174) acc_x 90.6250 (93.5938) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/27] time 0.345 (0.344) data 0.267 (0.266) loss_x loss_x 0.5229 (0.3328) acc_x 84.3750 (93.0000) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/23] time 0.345 (0.345) data 0.266 (0.267) loss_u loss_u 0.9653 (0.9124) acc_u 9.3750 (12.5000) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [10/23] time 0.315 (0.342) data 0.236 (0.264) loss_u loss_u 0.8945 (0.9022) acc_u 12.5000 (12.5000) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/23] time 0.343 (0.341) data 0.264 (0.263) loss_u loss_u 0.9238 (0.9093) acc_u 9.3750 (11.4583) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/23] time 0.350 (0.341) data 0.272 (0.263) loss_u loss_u 0.8628 (0.9033) acc_u 18.7500 (11.8750) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:889
clean false:10
clean_rate:0.9888765294771968
noisy true:476
noisy false:257
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [92/200] batch [5/28] time 0.341 (0.345) data 0.263 (0.267) loss_x loss_x 0.2644 (0.3508) acc_x 96.8750 (91.2500) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [10/28] time 0.323 (0.340) data 0.245 (0.262) loss_x loss_x 0.3796 (0.3625) acc_x 87.5000 (91.5625) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [15/28] time 0.341 (0.339) data 0.263 (0.261) loss_x loss_x 0.4204 (0.3555) acc_x 87.5000 (91.4583) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [20/28] time 0.344 (0.339) data 0.266 (0.261) loss_x loss_x 0.1804 (0.3432) acc_x 100.0000 (92.0312) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/28] time 0.342 (0.339) data 0.264 (0.261) loss_x loss_x 0.2869 (0.3430) acc_x 96.8750 (92.2500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [5/22] time 0.333 (0.341) data 0.255 (0.263) loss_u loss_u 0.8853 (0.9229) acc_u 12.5000 (8.1250) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/22] time 0.313 (0.336) data 0.234 (0.258) loss_u loss_u 0.8569 (0.9111) acc_u 18.7500 (10.0000) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/22] time 0.336 (0.336) data 0.257 (0.258) loss_u loss_u 0.9355 (0.9108) acc_u 6.2500 (9.7917) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/22] time 0.347 (0.338) data 0.269 (0.259) loss_u loss_u 0.9443 (0.9069) acc_u 6.2500 (10.1562) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 248
confident_label rate tensor(0.5527, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 902
clean true:888
clean false:14
clean_rate:0.9844789356984479
noisy true:496
noisy false:234
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 730
epoch [93/200] batch [5/28] time 0.335 (0.344) data 0.257 (0.265) loss_x loss_x 0.7573 (0.4200) acc_x 81.2500 (90.0000) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [10/28] time 0.355 (0.344) data 0.278 (0.266) loss_x loss_x 0.4277 (0.4246) acc_x 81.2500 (89.0625) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [15/28] time 0.342 (0.345) data 0.263 (0.267) loss_x loss_x 0.3257 (0.4003) acc_x 93.7500 (89.5833) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [20/28] time 0.344 (0.345) data 0.266 (0.266) loss_x loss_x 0.6021 (0.3822) acc_x 87.5000 (90.6250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/28] time 0.349 (0.344) data 0.271 (0.266) loss_x loss_x 0.3713 (0.3933) acc_x 87.5000 (90.3750) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [5/22] time 0.346 (0.345) data 0.267 (0.267) loss_u loss_u 0.9673 (0.9042) acc_u 3.1250 (10.6250) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/22] time 0.299 (0.342) data 0.221 (0.264) loss_u loss_u 0.9561 (0.9034) acc_u 6.2500 (10.6250) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/22] time 0.327 (0.340) data 0.247 (0.261) loss_u loss_u 0.8794 (0.9024) acc_u 15.6250 (10.6250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/22] time 0.335 (0.340) data 0.257 (0.261) loss_u loss_u 0.9360 (0.9106) acc_u 6.2500 (9.8438) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.5539, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 904
clean true:891
clean false:13
clean_rate:0.9856194690265486
noisy true:485
noisy false:243
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 728
epoch [94/200] batch [5/28] time 0.349 (0.349) data 0.272 (0.271) loss_x loss_x 0.2346 (0.3096) acc_x 96.8750 (94.3750) lr 1.1253e-03 eta 0:00:08
epoch [94/200] batch [10/28] time 0.340 (0.347) data 0.261 (0.269) loss_x loss_x 0.3750 (0.3234) acc_x 87.5000 (91.8750) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [15/28] time 0.340 (0.345) data 0.263 (0.268) loss_x loss_x 0.3499 (0.3384) acc_x 90.6250 (91.6667) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [20/28] time 0.347 (0.345) data 0.270 (0.268) loss_x loss_x 0.3496 (0.3439) acc_x 93.7500 (91.7188) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/28] time 0.342 (0.345) data 0.264 (0.267) loss_x loss_x 0.5645 (0.3476) acc_x 84.3750 (91.8750) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [5/22] time 0.349 (0.345) data 0.270 (0.267) loss_u loss_u 0.9258 (0.9158) acc_u 9.3750 (11.2500) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/22] time 0.306 (0.341) data 0.227 (0.263) loss_u loss_u 0.9082 (0.9123) acc_u 9.3750 (10.3125) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/22] time 0.344 (0.341) data 0.265 (0.262) loss_u loss_u 0.8765 (0.9097) acc_u 12.5000 (10.4167) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/22] time 0.359 (0.342) data 0.281 (0.263) loss_u loss_u 0.9062 (0.9111) acc_u 9.3750 (10.3125) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.5576, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 910
clean true:894
clean false:16
clean_rate:0.9824175824175824
noisy true:488
noisy false:234
after delete: len(clean_dataset) 910
after delete: len(noisy_dataset) 722
epoch [95/200] batch [5/28] time 0.360 (0.350) data 0.282 (0.272) loss_x loss_x 0.3289 (0.3217) acc_x 93.7500 (91.8750) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [10/28] time 0.349 (0.348) data 0.271 (0.270) loss_x loss_x 0.2095 (0.2835) acc_x 93.7500 (91.8750) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [15/28] time 0.300 (0.337) data 0.223 (0.259) loss_x loss_x 0.2935 (0.2851) acc_x 93.7500 (92.0833) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [20/28] time 0.344 (0.339) data 0.266 (0.261) loss_x loss_x 0.6865 (0.2998) acc_x 81.2500 (91.8750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/28] time 0.350 (0.343) data 0.273 (0.265) loss_x loss_x 0.3716 (0.3326) acc_x 93.7500 (91.7500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [5/22] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9297 (0.9593) acc_u 6.2500 (4.3750) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/22] time 0.349 (0.341) data 0.270 (0.263) loss_u loss_u 0.9404 (0.9354) acc_u 6.2500 (7.8125) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/22] time 0.356 (0.342) data 0.276 (0.264) loss_u loss_u 0.9736 (0.9162) acc_u 3.1250 (10.2083) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/22] time 0.332 (0.342) data 0.253 (0.263) loss_u loss_u 0.8799 (0.9192) acc_u 12.5000 (9.6875) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 264
confident_label rate tensor(0.5533, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 903
clean true:888
clean false:15
clean_rate:0.9833887043189369
noisy true:480
noisy false:249
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 729
epoch [96/200] batch [5/28] time 0.350 (0.350) data 0.272 (0.272) loss_x loss_x 0.4622 (0.3930) acc_x 87.5000 (93.1250) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [10/28] time 0.343 (0.349) data 0.265 (0.271) loss_x loss_x 0.2654 (0.3642) acc_x 93.7500 (92.8125) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [15/28] time 0.337 (0.345) data 0.260 (0.268) loss_x loss_x 0.3979 (0.3654) acc_x 87.5000 (91.8750) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [20/28] time 0.350 (0.345) data 0.273 (0.267) loss_x loss_x 0.3337 (0.3749) acc_x 93.7500 (91.4062) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/28] time 0.341 (0.344) data 0.263 (0.266) loss_x loss_x 0.1349 (0.3571) acc_x 100.0000 (91.8750) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [5/22] time 0.320 (0.335) data 0.240 (0.257) loss_u loss_u 0.9385 (0.9069) acc_u 6.2500 (10.6250) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/22] time 0.337 (0.335) data 0.259 (0.257) loss_u loss_u 0.8696 (0.9093) acc_u 15.6250 (10.6250) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/22] time 0.327 (0.338) data 0.248 (0.259) loss_u loss_u 0.9526 (0.8971) acc_u 3.1250 (12.0833) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [20/22] time 0.349 (0.339) data 0.270 (0.260) loss_u loss_u 0.9170 (0.9030) acc_u 9.3750 (11.4062) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.5539, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 904
clean true:893
clean false:11
clean_rate:0.9878318584070797
noisy true:492
noisy false:236
after delete: len(clean_dataset) 904
after delete: len(noisy_dataset) 728
epoch [97/200] batch [5/28] time 0.343 (0.344) data 0.266 (0.266) loss_x loss_x 0.2407 (0.3702) acc_x 96.8750 (91.2500) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [10/28] time 0.352 (0.345) data 0.274 (0.267) loss_x loss_x 0.2249 (0.3531) acc_x 93.7500 (91.5625) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [15/28] time 0.310 (0.343) data 0.232 (0.266) loss_x loss_x 0.2971 (0.3642) acc_x 96.8750 (91.2500) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [20/28] time 0.350 (0.345) data 0.272 (0.267) loss_x loss_x 0.4324 (0.3586) acc_x 87.5000 (91.5625) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/28] time 0.336 (0.343) data 0.258 (0.265) loss_x loss_x 0.2534 (0.3723) acc_x 93.7500 (91.1250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [5/22] time 0.359 (0.342) data 0.281 (0.264) loss_u loss_u 0.9072 (0.9210) acc_u 9.3750 (8.7500) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/22] time 0.345 (0.342) data 0.268 (0.264) loss_u loss_u 0.9399 (0.9137) acc_u 6.2500 (10.0000) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/22] time 0.344 (0.342) data 0.266 (0.264) loss_u loss_u 0.8579 (0.9076) acc_u 18.7500 (11.6667) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/22] time 0.339 (0.341) data 0.261 (0.263) loss_u loss_u 0.8691 (0.9132) acc_u 18.7500 (11.2500) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.5558, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 907
clean true:893
clean false:14
clean_rate:0.9845644983461963
noisy true:477
noisy false:248
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 725
epoch [98/200] batch [5/28] time 0.353 (0.345) data 0.275 (0.268) loss_x loss_x 0.2128 (0.4338) acc_x 93.7500 (90.6250) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [10/28] time 0.340 (0.345) data 0.262 (0.267) loss_x loss_x 0.2908 (0.3969) acc_x 90.6250 (90.6250) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [15/28] time 0.338 (0.342) data 0.260 (0.264) loss_x loss_x 0.2971 (0.3854) acc_x 93.7500 (90.6250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [20/28] time 0.343 (0.343) data 0.265 (0.265) loss_x loss_x 0.3347 (0.3728) acc_x 87.5000 (90.9375) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/28] time 0.351 (0.341) data 0.273 (0.264) loss_x loss_x 0.5688 (0.3983) acc_x 84.3750 (89.7500) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [5/22] time 0.311 (0.337) data 0.233 (0.259) loss_u loss_u 0.9668 (0.9102) acc_u 3.1250 (10.0000) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/22] time 0.325 (0.339) data 0.247 (0.261) loss_u loss_u 0.9443 (0.9094) acc_u 6.2500 (10.3125) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/22] time 0.351 (0.339) data 0.272 (0.261) loss_u loss_u 0.9224 (0.9057) acc_u 12.5000 (10.8333) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/22] time 0.337 (0.338) data 0.258 (0.260) loss_u loss_u 0.9849 (0.9090) acc_u 3.1250 (10.6250) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.5558, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 907
clean true:891
clean false:16
clean_rate:0.9823594266813671
noisy true:482
noisy false:243
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 725
epoch [99/200] batch [5/28] time 0.339 (0.343) data 0.261 (0.264) loss_x loss_x 0.2964 (0.4118) acc_x 93.7500 (89.3750) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [10/28] time 0.346 (0.343) data 0.267 (0.265) loss_x loss_x 0.2471 (0.3339) acc_x 93.7500 (92.1875) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [15/28] time 0.339 (0.342) data 0.260 (0.264) loss_x loss_x 0.3406 (0.3446) acc_x 90.6250 (92.2917) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [20/28] time 0.353 (0.344) data 0.275 (0.265) loss_x loss_x 0.5806 (0.3569) acc_x 84.3750 (91.7188) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/28] time 0.307 (0.338) data 0.229 (0.259) loss_x loss_x 0.3755 (0.3504) acc_x 84.3750 (91.7500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [5/22] time 0.328 (0.337) data 0.250 (0.258) loss_u loss_u 0.9399 (0.9106) acc_u 6.2500 (10.0000) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [10/22] time 0.359 (0.337) data 0.279 (0.258) loss_u loss_u 0.9395 (0.9043) acc_u 6.2500 (10.9375) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/22] time 0.349 (0.338) data 0.271 (0.260) loss_u loss_u 0.9683 (0.9062) acc_u 6.2500 (11.2500) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/22] time 0.335 (0.339) data 0.255 (0.260) loss_u loss_u 0.8823 (0.9076) acc_u 12.5000 (10.7812) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.5570, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 909
clean true:894
clean false:15
clean_rate:0.9834983498349835
noisy true:477
noisy false:246
all clean rate:  [0.9829787234042553, 0.9882352941176471, 0.9912587412587412, 0.9878260869565217, 0.9918962722852512, 0.9919743178170144, 0.9922118380062306, 0.9887096774193549, 0.9895209580838323, 0.9863013698630136, 0.9849624060150376, 0.9868995633187773, 0.9827833572453372, 0.9826589595375722, 0.9847222222222223, 0.9831223628691983, 0.9845722300140253, 0.9838709677419355, 0.9830028328611898, 0.9867021276595744, 0.984313725490196, 0.9868766404199475, 0.9818181818181818, 0.981081081081081, 0.9856770833333334, 0.9869451697127938, 0.9853917662682603, 0.9882659713168188, 0.9845758354755784, 0.9844760672703752, 0.9815043156596794, 0.9824561403508771, 0.9810366624525917, 0.9871959026888605, 0.9872773536895675, 0.9874529485570891, 0.9848293299620733, 0.9841656516443362, 0.9899244332493703, 0.9828641370869033, 0.9776951672862454, 0.986469864698647, 0.9876390605686032, 0.9830508474576272, 0.9879663056558363, 0.9892086330935251, 0.986469864698647, 0.978698224852071, 0.9845971563981043, 0.9833926453143536, 0.9831932773109243, 0.9809976247030879, 0.9847775175644028, 0.9846698113207547, 0.9837209302325581, 0.9847417840375586, 0.9800469483568075, 0.983132530120482, 0.9809523809523809, 0.9848484848484849, 0.9869203329369798, 0.9826589595375722, 0.9767441860465116, 0.9826388888888888, 0.9795918367346939, 0.9859154929577465, 0.9796839729119639, 0.9828767123287672, 0.9884925201380897, 0.9897142857142858, 0.9831649831649831, 0.9761634506242906, 0.9886234357224118, 0.9827586206896551, 0.9808342728297632, 0.9819004524886877, 0.9852941176470589, 0.9865319865319865, 0.9851598173515982, 0.9838150289017341, 0.9810479375696767, 0.9852774631936579, 0.9771739130434782, 0.9798206278026906, 0.9811738648947951, 0.9823204419889503, 0.9764837625979843, 0.9910213243546577, 0.9844271412680756, 0.9822616407982262, 0.986562150055991, 0.9888765294771968, 0.9844789356984479, 0.9856194690265486, 0.9824175824175824, 0.9833887043189369, 0.9878318584070797, 0.9845644983461963, 0.9823594266813671, 0.9834983498349835]
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 723
epoch [100/200] batch [5/28] time 0.346 (0.349) data 0.268 (0.271) loss_x loss_x 0.4575 (0.3315) acc_x 87.5000 (90.6250) lr 1.0314e-03 eta 0:00:08
epoch [100/200] batch [10/28] time 0.335 (0.345) data 0.257 (0.268) loss_x loss_x 0.3560 (0.3845) acc_x 90.6250 (90.6250) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [15/28] time 0.345 (0.341) data 0.267 (0.263) loss_x loss_x 0.2954 (0.4257) acc_x 90.6250 (89.1667) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [20/28] time 0.302 (0.336) data 0.222 (0.258) loss_x loss_x 0.1570 (0.4062) acc_x 96.8750 (90.0000) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/28] time 0.300 (0.330) data 0.222 (0.251) loss_x loss_x 0.1852 (0.3917) acc_x 96.8750 (90.7500) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/22] time 0.344 (0.332) data 0.265 (0.254) loss_u loss_u 0.8906 (0.9231) acc_u 12.5000 (9.3750) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/22] time 0.346 (0.335) data 0.268 (0.256) loss_u loss_u 0.9712 (0.9244) acc_u 3.1250 (8.4375) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/22] time 0.340 (0.336) data 0.261 (0.258) loss_u loss_u 0.8804 (0.9193) acc_u 12.5000 (8.7500) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/22] time 0.340 (0.337) data 0.261 (0.258) loss_u loss_u 0.8330 (0.9161) acc_u 21.8750 (9.3750) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.5545, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 905
clean true:893
clean false:12
clean_rate:0.9867403314917127
noisy true:505
noisy false:222
after delete: len(clean_dataset) 905
after delete: len(noisy_dataset) 727
epoch [101/200] batch [5/28] time 0.368 (0.356) data 0.290 (0.278) loss_x loss_x 0.4402 (0.2872) acc_x 84.3750 (94.3750) lr 1.0157e-03 eta 0:00:08
epoch [101/200] batch [10/28] time 0.330 (0.348) data 0.252 (0.269) loss_x loss_x 0.4189 (0.3161) acc_x 93.7500 (94.0625) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [15/28] time 0.349 (0.346) data 0.271 (0.268) loss_x loss_x 0.3232 (0.3254) acc_x 90.6250 (92.2917) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [20/28] time 0.312 (0.336) data 0.233 (0.258) loss_x loss_x 0.4858 (0.3352) acc_x 90.6250 (91.5625) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/28] time 0.351 (0.337) data 0.273 (0.259) loss_x loss_x 0.2233 (0.3382) acc_x 93.7500 (91.7500) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [5/22] time 0.349 (0.340) data 0.271 (0.262) loss_u loss_u 0.8438 (0.9080) acc_u 18.7500 (11.2500) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/22] time 0.343 (0.341) data 0.264 (0.263) loss_u loss_u 0.9512 (0.9146) acc_u 6.2500 (10.6250) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/22] time 0.336 (0.339) data 0.257 (0.261) loss_u loss_u 0.9028 (0.9099) acc_u 9.3750 (10.6250) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/22] time 0.338 (0.339) data 0.259 (0.261) loss_u loss_u 0.8970 (0.9005) acc_u 12.5000 (11.7188) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.5680, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 927
clean true:910
clean false:17
clean_rate:0.9816612729234089
noisy true:487
noisy false:218
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 705
epoch [102/200] batch [5/28] time 0.340 (0.347) data 0.262 (0.269) loss_x loss_x 0.3171 (0.2911) acc_x 90.6250 (93.7500) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [10/28] time 0.355 (0.344) data 0.277 (0.266) loss_x loss_x 0.4277 (0.3256) acc_x 90.6250 (93.4375) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [15/28] time 0.337 (0.341) data 0.259 (0.263) loss_x loss_x 0.3772 (0.3701) acc_x 87.5000 (91.6667) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [20/28] time 0.305 (0.337) data 0.227 (0.259) loss_x loss_x 0.2666 (0.3614) acc_x 93.7500 (91.7188) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/28] time 0.332 (0.331) data 0.254 (0.253) loss_x loss_x 0.3359 (0.3969) acc_x 90.6250 (90.5000) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/22] time 0.354 (0.334) data 0.275 (0.255) loss_u loss_u 0.9375 (0.9585) acc_u 6.2500 (4.3750) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/22] time 0.343 (0.335) data 0.264 (0.257) loss_u loss_u 0.9541 (0.9320) acc_u 6.2500 (8.1250) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/22] time 0.339 (0.335) data 0.260 (0.257) loss_u loss_u 0.8481 (0.9228) acc_u 18.7500 (9.1667) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/22] time 0.331 (0.335) data 0.253 (0.257) loss_u loss_u 0.9619 (0.9249) acc_u 3.1250 (9.0625) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 912
clean true:900
clean false:12
clean_rate:0.9868421052631579
noisy true:495
noisy false:225
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 720
epoch [103/200] batch [5/28] time 0.346 (0.335) data 0.268 (0.257) loss_x loss_x 0.1947 (0.2825) acc_x 96.8750 (93.7500) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [10/28] time 0.322 (0.337) data 0.244 (0.259) loss_x loss_x 0.2576 (0.2784) acc_x 93.7500 (94.0625) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [15/28] time 0.347 (0.330) data 0.268 (0.252) loss_x loss_x 0.1226 (0.2769) acc_x 96.8750 (93.9583) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [20/28] time 0.290 (0.331) data 0.212 (0.253) loss_x loss_x 0.2744 (0.2883) acc_x 93.7500 (93.2812) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/28] time 0.353 (0.328) data 0.275 (0.250) loss_x loss_x 0.2952 (0.3311) acc_x 93.7500 (92.2500) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/22] time 0.346 (0.333) data 0.267 (0.255) loss_u loss_u 0.9434 (0.9320) acc_u 6.2500 (7.5000) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/22] time 0.354 (0.336) data 0.275 (0.258) loss_u loss_u 0.8921 (0.9277) acc_u 9.3750 (8.4375) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/22] time 0.336 (0.337) data 0.258 (0.258) loss_u loss_u 0.9072 (0.9218) acc_u 9.3750 (9.1667) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [20/22] time 0.348 (0.338) data 0.270 (0.259) loss_u loss_u 0.8867 (0.9135) acc_u 12.5000 (10.1562) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 272
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 906
clean true:888
clean false:18
clean_rate:0.9801324503311258
noisy true:472
noisy false:254
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 726
epoch [104/200] batch [5/28] time 0.350 (0.348) data 0.272 (0.270) loss_x loss_x 0.2817 (0.2564) acc_x 93.7500 (95.0000) lr 9.6859e-04 eta 0:00:08
epoch [104/200] batch [10/28] time 0.314 (0.344) data 0.236 (0.266) loss_x loss_x 0.2932 (0.3074) acc_x 93.7500 (92.5000) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [15/28] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.3198 (0.3187) acc_x 87.5000 (91.4583) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [20/28] time 0.296 (0.336) data 0.218 (0.258) loss_x loss_x 0.1603 (0.3272) acc_x 93.7500 (91.7188) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/28] time 0.343 (0.336) data 0.265 (0.257) loss_x loss_x 0.2159 (0.3199) acc_x 90.6250 (92.0000) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [5/22] time 0.336 (0.337) data 0.257 (0.258) loss_u loss_u 0.9072 (0.8939) acc_u 12.5000 (14.3750) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/22] time 0.349 (0.338) data 0.269 (0.259) loss_u loss_u 0.9077 (0.8999) acc_u 9.3750 (12.1875) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/22] time 0.337 (0.337) data 0.258 (0.259) loss_u loss_u 0.9375 (0.9099) acc_u 6.2500 (10.6250) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/22] time 0.344 (0.337) data 0.265 (0.258) loss_u loss_u 0.9268 (0.9021) acc_u 9.3750 (11.5625) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 258
confident_label rate tensor(0.5558, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 907
clean true:891
clean false:16
clean_rate:0.9823594266813671
noisy true:483
noisy false:242
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 725
epoch [105/200] batch [5/28] time 0.345 (0.351) data 0.267 (0.273) loss_x loss_x 0.3499 (0.3899) acc_x 96.8750 (91.2500) lr 9.5289e-04 eta 0:00:08
epoch [105/200] batch [10/28] time 0.386 (0.354) data 0.307 (0.275) loss_x loss_x 0.4238 (0.3488) acc_x 90.6250 (93.1250) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [15/28] time 0.348 (0.350) data 0.270 (0.272) loss_x loss_x 0.3357 (0.3842) acc_x 90.6250 (90.6250) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [20/28] time 0.349 (0.348) data 0.272 (0.270) loss_x loss_x 0.4133 (0.3640) acc_x 90.6250 (90.7812) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/28] time 0.373 (0.352) data 0.294 (0.273) loss_x loss_x 0.3569 (0.3830) acc_x 90.6250 (90.2500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [5/22] time 0.366 (0.359) data 0.286 (0.280) loss_u loss_u 0.9297 (0.9219) acc_u 6.2500 (8.7500) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [10/22] time 0.348 (0.358) data 0.269 (0.279) loss_u loss_u 0.9331 (0.9041) acc_u 6.2500 (10.9375) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/22] time 0.307 (0.353) data 0.228 (0.274) loss_u loss_u 0.9121 (0.9024) acc_u 9.3750 (11.2500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/22] time 0.357 (0.350) data 0.278 (0.271) loss_u loss_u 0.8735 (0.9008) acc_u 12.5000 (11.8750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 918
clean true:899
clean false:19
clean_rate:0.9793028322440087
noisy true:494
noisy false:220
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 714
epoch [106/200] batch [5/28] time 0.331 (0.341) data 0.252 (0.263) loss_x loss_x 0.3025 (0.2415) acc_x 93.7500 (94.3750) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [10/28] time 0.325 (0.341) data 0.247 (0.263) loss_x loss_x 0.6626 (0.3300) acc_x 81.2500 (92.8125) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [15/28] time 0.341 (0.343) data 0.264 (0.265) loss_x loss_x 0.1782 (0.3172) acc_x 96.8750 (92.9167) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [20/28] time 0.302 (0.341) data 0.224 (0.263) loss_x loss_x 0.3020 (0.3384) acc_x 90.6250 (92.1875) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/28] time 0.373 (0.340) data 0.294 (0.261) loss_x loss_x 0.2991 (0.3356) acc_x 90.6250 (91.8750) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [5/22] time 0.417 (0.347) data 0.338 (0.268) loss_u loss_u 0.8701 (0.9077) acc_u 15.6250 (11.2500) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/22] time 0.346 (0.345) data 0.267 (0.267) loss_u loss_u 0.8931 (0.9028) acc_u 9.3750 (11.5625) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/22] time 0.344 (0.344) data 0.265 (0.265) loss_u loss_u 0.9146 (0.9064) acc_u 9.3750 (11.2500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/22] time 0.343 (0.344) data 0.265 (0.265) loss_u loss_u 0.9185 (0.9070) acc_u 9.3750 (11.0938) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.5637, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 920
clean true:905
clean false:15
clean_rate:0.9836956521739131
noisy true:495
noisy false:217
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 712
epoch [107/200] batch [5/28] time 0.359 (0.355) data 0.281 (0.276) loss_x loss_x 0.2087 (0.3103) acc_x 96.8750 (95.0000) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [10/28] time 0.351 (0.350) data 0.273 (0.271) loss_x loss_x 0.2986 (0.2920) acc_x 90.6250 (94.0625) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [15/28] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.3784 (0.2964) acc_x 90.6250 (93.7500) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [20/28] time 0.290 (0.337) data 0.213 (0.258) loss_x loss_x 0.5840 (0.3186) acc_x 90.6250 (93.1250) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/28] time 0.292 (0.330) data 0.213 (0.252) loss_x loss_x 0.2549 (0.3353) acc_x 93.7500 (93.0000) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/22] time 0.357 (0.333) data 0.278 (0.255) loss_u loss_u 0.8862 (0.9076) acc_u 12.5000 (9.3750) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/22] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.9185 (0.9134) acc_u 9.3750 (9.6875) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/22] time 0.313 (0.335) data 0.235 (0.257) loss_u loss_u 0.9023 (0.9180) acc_u 12.5000 (9.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/22] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9570 (0.9208) acc_u 6.2500 (9.2188) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 236
confident_label rate tensor(0.5613, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 916
clean true:901
clean false:15
clean_rate:0.9836244541484717
noisy true:495
noisy false:221
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 716
epoch [108/200] batch [5/28] time 0.339 (0.351) data 0.260 (0.272) loss_x loss_x 0.4778 (0.4171) acc_x 81.2500 (89.3750) lr 9.0589e-04 eta 0:00:08
epoch [108/200] batch [10/28] time 0.349 (0.349) data 0.271 (0.271) loss_x loss_x 0.1384 (0.3275) acc_x 96.8750 (91.8750) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [15/28] time 0.305 (0.342) data 0.227 (0.264) loss_x loss_x 0.4282 (0.3117) acc_x 90.6250 (92.2917) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [20/28] time 0.313 (0.332) data 0.234 (0.254) loss_x loss_x 0.3093 (0.3428) acc_x 84.3750 (91.4062) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/28] time 0.341 (0.335) data 0.263 (0.257) loss_x loss_x 0.3877 (0.3565) acc_x 90.6250 (91.1250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [5/22] time 0.331 (0.337) data 0.253 (0.259) loss_u loss_u 0.9312 (0.9631) acc_u 6.2500 (3.7500) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/22] time 0.334 (0.338) data 0.256 (0.259) loss_u loss_u 0.9238 (0.9374) acc_u 9.3750 (7.1875) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/22] time 0.298 (0.336) data 0.220 (0.258) loss_u loss_u 0.8545 (0.9207) acc_u 15.6250 (8.7500) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/22] time 0.330 (0.337) data 0.250 (0.258) loss_u loss_u 0.9243 (0.9149) acc_u 6.2500 (9.6875) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.5674, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 926
clean true:907
clean false:19
clean_rate:0.9794816414686826
noisy true:493
noisy false:213
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 706
epoch [109/200] batch [5/28] time 0.342 (0.350) data 0.263 (0.272) loss_x loss_x 0.4341 (0.3262) acc_x 90.6250 (94.3750) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [10/28] time 0.345 (0.349) data 0.267 (0.270) loss_x loss_x 0.3945 (0.3279) acc_x 84.3750 (92.1875) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [15/28] time 0.305 (0.340) data 0.226 (0.262) loss_x loss_x 0.6016 (0.3301) acc_x 81.2500 (92.0833) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [20/28] time 0.345 (0.341) data 0.267 (0.263) loss_x loss_x 0.2920 (0.3327) acc_x 93.7500 (92.0312) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/28] time 0.381 (0.337) data 0.303 (0.259) loss_x loss_x 0.3799 (0.3466) acc_x 81.2500 (90.8750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [5/22] time 0.333 (0.337) data 0.255 (0.259) loss_u loss_u 0.9907 (0.9225) acc_u 0.0000 (9.3750) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/22] time 0.326 (0.339) data 0.246 (0.261) loss_u loss_u 0.9409 (0.9375) acc_u 6.2500 (7.1875) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/22] time 0.293 (0.338) data 0.215 (0.260) loss_u loss_u 0.9609 (0.9215) acc_u 6.2500 (9.1667) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [20/22] time 0.348 (0.336) data 0.271 (0.257) loss_u loss_u 0.9053 (0.9226) acc_u 12.5000 (8.9062) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:896
clean false:15
clean_rate:0.9835345773874863
noisy true:492
noisy false:229
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [110/200] batch [5/28] time 0.345 (0.353) data 0.267 (0.275) loss_x loss_x 0.4016 (0.4218) acc_x 93.7500 (91.8750) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [10/28] time 0.347 (0.349) data 0.269 (0.271) loss_x loss_x 0.2410 (0.4196) acc_x 93.7500 (90.3125) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [15/28] time 0.329 (0.346) data 0.251 (0.268) loss_x loss_x 0.3416 (0.4061) acc_x 93.7500 (90.8333) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [20/28] time 0.316 (0.340) data 0.238 (0.262) loss_x loss_x 0.3799 (0.3896) acc_x 90.6250 (91.2500) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/28] time 0.353 (0.338) data 0.275 (0.260) loss_x loss_x 0.2306 (0.3933) acc_x 96.8750 (91.0000) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [5/22] time 0.349 (0.340) data 0.270 (0.262) loss_u loss_u 0.9146 (0.8836) acc_u 9.3750 (13.1250) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/22] time 0.352 (0.342) data 0.273 (0.264) loss_u loss_u 0.9014 (0.9076) acc_u 12.5000 (10.3125) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/22] time 0.339 (0.342) data 0.261 (0.264) loss_u loss_u 0.8877 (0.9112) acc_u 15.6250 (10.2083) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [20/22] time 0.348 (0.342) data 0.268 (0.264) loss_u loss_u 0.8965 (0.9109) acc_u 12.5000 (10.4688) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 273
confident_label rate tensor(0.5496, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 897
clean true:879
clean false:18
clean_rate:0.979933110367893
noisy true:480
noisy false:255
after delete: len(clean_dataset) 897
after delete: len(noisy_dataset) 735
epoch [111/200] batch [5/28] time 0.357 (0.353) data 0.279 (0.275) loss_x loss_x 0.3516 (0.4612) acc_x 87.5000 (88.1250) lr 8.5910e-04 eta 0:00:08
epoch [111/200] batch [10/28] time 0.344 (0.353) data 0.267 (0.275) loss_x loss_x 0.2632 (0.3727) acc_x 93.7500 (90.9375) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [15/28] time 0.348 (0.351) data 0.268 (0.273) loss_x loss_x 0.6021 (0.3979) acc_x 90.6250 (90.8333) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [20/28] time 0.302 (0.347) data 0.223 (0.269) loss_x loss_x 0.2156 (0.3832) acc_x 93.7500 (90.9375) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/28] time 0.340 (0.346) data 0.262 (0.268) loss_x loss_x 0.3308 (0.3874) acc_x 90.6250 (90.7500) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [5/22] time 0.334 (0.345) data 0.255 (0.267) loss_u loss_u 0.8799 (0.9006) acc_u 15.6250 (13.1250) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/22] time 0.339 (0.345) data 0.259 (0.267) loss_u loss_u 0.8823 (0.8978) acc_u 9.3750 (12.1875) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/22] time 0.338 (0.346) data 0.260 (0.267) loss_u loss_u 0.9170 (0.9020) acc_u 9.3750 (11.2500) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [20/22] time 0.346 (0.345) data 0.267 (0.266) loss_u loss_u 0.8921 (0.8984) acc_u 15.6250 (11.8750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.5607, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 915
clean true:901
clean false:14
clean_rate:0.9846994535519126
noisy true:493
noisy false:224
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 717
epoch [112/200] batch [5/28] time 0.340 (0.333) data 0.262 (0.255) loss_x loss_x 0.6895 (0.3315) acc_x 87.5000 (93.1250) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [10/28] time 0.345 (0.332) data 0.267 (0.254) loss_x loss_x 0.4199 (0.3970) acc_x 90.6250 (90.3125) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [15/28] time 0.339 (0.335) data 0.261 (0.257) loss_x loss_x 0.1411 (0.3839) acc_x 96.8750 (91.0417) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [20/28] time 0.294 (0.332) data 0.216 (0.254) loss_x loss_x 0.6406 (0.3888) acc_x 87.5000 (90.4688) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/28] time 0.294 (0.326) data 0.215 (0.247) loss_x loss_x 0.3069 (0.3505) acc_x 90.6250 (91.6250) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/22] time 0.346 (0.330) data 0.268 (0.252) loss_u loss_u 0.9033 (0.9250) acc_u 9.3750 (8.1250) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/22] time 0.336 (0.331) data 0.258 (0.253) loss_u loss_u 0.7739 (0.9147) acc_u 25.0000 (9.6875) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [15/22] time 0.341 (0.331) data 0.263 (0.253) loss_u loss_u 0.9214 (0.9095) acc_u 6.2500 (10.0000) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [20/22] time 0.338 (0.332) data 0.259 (0.254) loss_u loss_u 0.9268 (0.9095) acc_u 12.5000 (10.4688) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 906
clean true:894
clean false:12
clean_rate:0.9867549668874173
noisy true:477
noisy false:249
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 726
epoch [113/200] batch [5/28] time 0.353 (0.339) data 0.274 (0.260) loss_x loss_x 0.3845 (0.3562) acc_x 87.5000 (91.2500) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [10/28] time 0.351 (0.348) data 0.273 (0.269) loss_x loss_x 0.2944 (0.3500) acc_x 90.6250 (91.8750) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [15/28] time 0.339 (0.345) data 0.260 (0.266) loss_x loss_x 0.2515 (0.3224) acc_x 90.6250 (92.2917) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [20/28] time 0.319 (0.343) data 0.241 (0.265) loss_x loss_x 0.2383 (0.3164) acc_x 90.6250 (92.3438) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/28] time 0.360 (0.341) data 0.281 (0.262) loss_x loss_x 0.4504 (0.3220) acc_x 93.7500 (92.6250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [5/22] time 0.334 (0.340) data 0.256 (0.261) loss_u loss_u 0.9146 (0.9103) acc_u 9.3750 (11.2500) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [10/22] time 0.331 (0.339) data 0.251 (0.260) loss_u loss_u 0.8149 (0.8875) acc_u 21.8750 (13.1250) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/22] time 0.359 (0.339) data 0.279 (0.260) loss_u loss_u 0.8496 (0.8972) acc_u 15.6250 (11.4583) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/22] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.9536 (0.8980) acc_u 6.2500 (11.4062) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.5643, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 921
clean true:910
clean false:11
clean_rate:0.988056460369164
noisy true:508
noisy false:203
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 711
epoch [114/200] batch [5/28] time 0.349 (0.357) data 0.271 (0.279) loss_x loss_x 0.1494 (0.2255) acc_x 96.8750 (93.1250) lr 8.1262e-04 eta 0:00:08
epoch [114/200] batch [10/28] time 0.338 (0.358) data 0.260 (0.280) loss_x loss_x 0.3315 (0.2844) acc_x 93.7500 (93.1250) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [15/28] time 0.333 (0.353) data 0.254 (0.275) loss_x loss_x 0.2844 (0.3201) acc_x 93.7500 (91.8750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [20/28] time 0.349 (0.348) data 0.271 (0.269) loss_x loss_x 0.5776 (0.3116) acc_x 84.3750 (92.5000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/28] time 0.342 (0.348) data 0.264 (0.270) loss_x loss_x 0.2467 (0.3141) acc_x 100.0000 (92.7500) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [5/22] time 0.348 (0.350) data 0.269 (0.272) loss_u loss_u 0.9194 (0.9331) acc_u 9.3750 (8.1250) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [10/22] time 0.335 (0.348) data 0.257 (0.270) loss_u loss_u 0.9395 (0.9256) acc_u 6.2500 (8.7500) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/22] time 0.347 (0.348) data 0.268 (0.269) loss_u loss_u 0.9736 (0.9312) acc_u 3.1250 (8.3333) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/22] time 0.331 (0.346) data 0.253 (0.268) loss_u loss_u 0.9497 (0.9251) acc_u 3.1250 (8.9062) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 242
confident_label rate tensor(0.5631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 919
clean true:905
clean false:14
clean_rate:0.984766050054407
noisy true:485
noisy false:228
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 713
epoch [115/200] batch [5/28] time 0.333 (0.342) data 0.254 (0.264) loss_x loss_x 0.4971 (0.5000) acc_x 90.6250 (88.1250) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [10/28] time 0.331 (0.342) data 0.252 (0.264) loss_x loss_x 0.4163 (0.4167) acc_x 84.3750 (89.6875) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [15/28] time 0.310 (0.336) data 0.231 (0.258) loss_x loss_x 0.3672 (0.3941) acc_x 93.7500 (90.8333) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [20/28] time 0.354 (0.338) data 0.276 (0.260) loss_x loss_x 0.5181 (0.3927) acc_x 90.6250 (90.9375) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/28] time 0.344 (0.339) data 0.266 (0.260) loss_x loss_x 0.3203 (0.4028) acc_x 93.7500 (90.7500) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [5/22] time 0.344 (0.341) data 0.266 (0.263) loss_u loss_u 0.7847 (0.9201) acc_u 25.0000 (9.3750) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/22] time 0.409 (0.343) data 0.330 (0.265) loss_u loss_u 0.9419 (0.9097) acc_u 6.2500 (9.6875) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/22] time 0.342 (0.343) data 0.264 (0.265) loss_u loss_u 0.9248 (0.9204) acc_u 6.2500 (8.5417) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [20/22] time 0.354 (0.343) data 0.275 (0.265) loss_u loss_u 0.9434 (0.9157) acc_u 6.2500 (9.0625) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 246
confident_label rate tensor(0.5502, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 898
clean true:885
clean false:13
clean_rate:0.9855233853006682
noisy true:501
noisy false:233
after delete: len(clean_dataset) 898
after delete: len(noisy_dataset) 734
epoch [116/200] batch [5/28] time 0.338 (0.344) data 0.260 (0.266) loss_x loss_x 0.4707 (0.3929) acc_x 96.8750 (91.2500) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [10/28] time 0.347 (0.347) data 0.269 (0.270) loss_x loss_x 0.3074 (0.4262) acc_x 93.7500 (90.9375) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [15/28] time 0.296 (0.335) data 0.217 (0.257) loss_x loss_x 0.4624 (0.3888) acc_x 90.6250 (91.6667) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [20/28] time 0.346 (0.333) data 0.269 (0.255) loss_x loss_x 0.1273 (0.3736) acc_x 100.0000 (92.0312) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/28] time 0.340 (0.336) data 0.263 (0.258) loss_x loss_x 0.5342 (0.3652) acc_x 78.1250 (91.8750) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [5/22] time 0.339 (0.338) data 0.261 (0.259) loss_u loss_u 0.9658 (0.8948) acc_u 3.1250 (11.2500) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/22] time 0.339 (0.338) data 0.260 (0.260) loss_u loss_u 0.9282 (0.8826) acc_u 6.2500 (13.1250) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/22] time 0.338 (0.339) data 0.260 (0.260) loss_u loss_u 0.8696 (0.8809) acc_u 15.6250 (13.9583) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/22] time 0.337 (0.339) data 0.258 (0.260) loss_u loss_u 0.9692 (0.8850) acc_u 3.1250 (13.4375) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.5643, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 921
clean true:903
clean false:18
clean_rate:0.9804560260586319
noisy true:477
noisy false:234
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 711
epoch [117/200] batch [5/28] time 0.359 (0.350) data 0.281 (0.272) loss_x loss_x 0.1974 (0.3036) acc_x 96.8750 (93.7500) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [10/28] time 0.341 (0.347) data 0.263 (0.269) loss_x loss_x 0.1564 (0.3088) acc_x 100.0000 (94.0625) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [15/28] time 0.346 (0.341) data 0.267 (0.263) loss_x loss_x 0.3757 (0.3170) acc_x 93.7500 (93.7500) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [20/28] time 0.349 (0.341) data 0.271 (0.262) loss_x loss_x 0.3262 (0.3036) acc_x 90.6250 (93.7500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/28] time 0.346 (0.343) data 0.267 (0.264) loss_x loss_x 0.2159 (0.3169) acc_x 93.7500 (93.1250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [5/22] time 0.346 (0.344) data 0.267 (0.265) loss_u loss_u 0.9980 (0.9352) acc_u 0.0000 (7.5000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/22] time 0.346 (0.344) data 0.267 (0.265) loss_u loss_u 0.8833 (0.9217) acc_u 12.5000 (9.0625) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/22] time 0.350 (0.345) data 0.271 (0.266) loss_u loss_u 0.8589 (0.9209) acc_u 12.5000 (8.9583) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/22] time 0.350 (0.345) data 0.271 (0.266) loss_u loss_u 0.8887 (0.9178) acc_u 18.7500 (9.8438) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 242
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 912
clean true:896
clean false:16
clean_rate:0.9824561403508771
noisy true:494
noisy false:226
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 720
epoch [118/200] batch [5/28] time 0.335 (0.332) data 0.257 (0.255) loss_x loss_x 0.2847 (0.2825) acc_x 93.7500 (94.3750) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [10/28] time 0.343 (0.338) data 0.265 (0.260) loss_x loss_x 0.3633 (0.3023) acc_x 93.7500 (92.8125) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [15/28] time 0.290 (0.327) data 0.213 (0.249) loss_x loss_x 0.2939 (0.3030) acc_x 96.8750 (93.1250) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [20/28] time 0.335 (0.326) data 0.257 (0.248) loss_x loss_x 0.5425 (0.3321) acc_x 87.5000 (92.6562) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/28] time 0.340 (0.330) data 0.262 (0.252) loss_x loss_x 0.2649 (0.3271) acc_x 93.7500 (93.0000) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/22] time 0.344 (0.334) data 0.265 (0.255) loss_u loss_u 0.8843 (0.9139) acc_u 15.6250 (10.6250) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/22] time 0.349 (0.334) data 0.270 (0.256) loss_u loss_u 0.8838 (0.9116) acc_u 12.5000 (10.6250) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/22] time 0.360 (0.336) data 0.282 (0.258) loss_u loss_u 0.8843 (0.9079) acc_u 12.5000 (11.2500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/22] time 0.331 (0.337) data 0.253 (0.259) loss_u loss_u 0.9512 (0.9077) acc_u 6.2500 (11.4062) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 223
confident_label rate tensor(0.5656, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 923
clean true:910
clean false:13
clean_rate:0.9859154929577465
noisy true:499
noisy false:210
after delete: len(clean_dataset) 923
after delete: len(noisy_dataset) 709
epoch [119/200] batch [5/28] time 0.339 (0.350) data 0.261 (0.272) loss_x loss_x 0.4702 (0.2841) acc_x 87.5000 (92.5000) lr 7.3613e-04 eta 0:00:08
epoch [119/200] batch [10/28] time 0.353 (0.349) data 0.276 (0.271) loss_x loss_x 0.1534 (0.2760) acc_x 96.8750 (93.7500) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [15/28] time 0.298 (0.343) data 0.220 (0.265) loss_x loss_x 0.2512 (0.2544) acc_x 90.6250 (94.1667) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [20/28] time 0.348 (0.338) data 0.270 (0.260) loss_x loss_x 0.2761 (0.2750) acc_x 93.7500 (93.2812) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/28] time 0.343 (0.339) data 0.265 (0.261) loss_x loss_x 0.3899 (0.2727) acc_x 87.5000 (93.3750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [5/22] time 0.342 (0.339) data 0.263 (0.261) loss_u loss_u 0.8965 (0.9041) acc_u 12.5000 (11.2500) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [10/22] time 0.333 (0.341) data 0.255 (0.263) loss_u loss_u 0.9258 (0.9102) acc_u 9.3750 (10.9375) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/22] time 0.352 (0.341) data 0.274 (0.263) loss_u loss_u 0.8755 (0.9156) acc_u 15.6250 (10.4167) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [20/22] time 0.325 (0.340) data 0.245 (0.262) loss_u loss_u 0.9395 (0.9176) acc_u 6.2500 (10.0000) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 245
confident_label rate tensor(0.5686, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 928
clean true:913
clean false:15
clean_rate:0.9838362068965517
noisy true:474
noisy false:230
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 704
epoch [120/200] batch [5/29] time 0.346 (0.343) data 0.268 (0.265) loss_x loss_x 0.2278 (0.3977) acc_x 93.7500 (91.2500) lr 7.2101e-04 eta 0:00:08
epoch [120/200] batch [10/29] time 0.339 (0.342) data 0.261 (0.264) loss_x loss_x 0.4287 (0.3953) acc_x 90.6250 (90.9375) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [15/29] time 0.337 (0.341) data 0.259 (0.264) loss_x loss_x 0.4438 (0.3958) acc_x 90.6250 (91.2500) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [20/29] time 0.300 (0.337) data 0.221 (0.259) loss_x loss_x 0.1934 (0.3803) acc_x 93.7500 (90.9375) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [25/29] time 0.340 (0.335) data 0.262 (0.257) loss_x loss_x 0.3374 (0.3744) acc_x 93.7500 (91.2500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [5/22] time 0.335 (0.335) data 0.257 (0.257) loss_u loss_u 0.9844 (0.9281) acc_u 0.0000 (7.5000) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [10/22] time 0.337 (0.337) data 0.258 (0.259) loss_u loss_u 0.9399 (0.9277) acc_u 6.2500 (8.4375) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/22] time 0.348 (0.337) data 0.269 (0.259) loss_u loss_u 0.8784 (0.9223) acc_u 9.3750 (8.7500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [20/22] time 0.389 (0.338) data 0.310 (0.260) loss_u loss_u 0.9390 (0.9226) acc_u 6.2500 (8.9062) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.5600, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 914
clean true:904
clean false:10
clean_rate:0.9890590809628009
noisy true:487
noisy false:231
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 718
epoch [121/200] batch [5/28] time 0.335 (0.347) data 0.257 (0.269) loss_x loss_x 0.3462 (0.2248) acc_x 90.6250 (95.0000) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [10/28] time 0.342 (0.346) data 0.263 (0.267) loss_x loss_x 0.6318 (0.2658) acc_x 78.1250 (94.0625) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [15/28] time 0.350 (0.345) data 0.272 (0.267) loss_x loss_x 0.1779 (0.2789) acc_x 100.0000 (93.9583) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [20/28] time 0.313 (0.346) data 0.235 (0.268) loss_x loss_x 0.3530 (0.2768) acc_x 90.6250 (93.9062) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/28] time 0.319 (0.338) data 0.241 (0.260) loss_x loss_x 0.3420 (0.2856) acc_x 93.7500 (93.5000) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [5/22] time 0.342 (0.339) data 0.263 (0.260) loss_u loss_u 0.9458 (0.9140) acc_u 6.2500 (9.3750) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [10/22] time 0.351 (0.340) data 0.273 (0.262) loss_u loss_u 0.8945 (0.9030) acc_u 12.5000 (10.9375) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/22] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.8901 (0.9085) acc_u 12.5000 (10.2083) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/22] time 0.347 (0.341) data 0.268 (0.263) loss_u loss_u 0.9438 (0.9078) acc_u 6.2500 (10.3125) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 918
clean true:898
clean false:20
clean_rate:0.9782135076252724
noisy true:490
noisy false:224
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 714
epoch [122/200] batch [5/28] time 0.337 (0.351) data 0.259 (0.273) loss_x loss_x 0.3867 (0.3686) acc_x 93.7500 (90.6250) lr 6.9098e-04 eta 0:00:08
epoch [122/200] batch [10/28] time 0.339 (0.347) data 0.261 (0.269) loss_x loss_x 0.3333 (0.3410) acc_x 90.6250 (91.2500) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [15/28] time 0.342 (0.344) data 0.264 (0.266) loss_x loss_x 0.2228 (0.3315) acc_x 93.7500 (91.0417) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [20/28] time 0.306 (0.341) data 0.227 (0.263) loss_x loss_x 0.1647 (0.3367) acc_x 96.8750 (91.0938) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/28] time 0.362 (0.339) data 0.283 (0.261) loss_x loss_x 0.2727 (0.3371) acc_x 93.7500 (91.3750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [5/22] time 0.338 (0.340) data 0.259 (0.262) loss_u loss_u 0.9321 (0.9051) acc_u 9.3750 (11.2500) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [10/22] time 0.341 (0.339) data 0.263 (0.261) loss_u loss_u 0.9326 (0.9112) acc_u 6.2500 (10.3125) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/22] time 0.342 (0.341) data 0.264 (0.263) loss_u loss_u 0.8984 (0.9141) acc_u 9.3750 (9.7917) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/22] time 0.346 (0.341) data 0.268 (0.263) loss_u loss_u 0.9058 (0.9052) acc_u 9.3750 (10.7812) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.5674, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 926
clean true:907
clean false:19
clean_rate:0.9794816414686826
noisy true:501
noisy false:205
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 706
epoch [123/200] batch [5/28] time 0.347 (0.351) data 0.269 (0.273) loss_x loss_x 0.2479 (0.4015) acc_x 90.6250 (88.7500) lr 6.7608e-04 eta 0:00:08
epoch [123/200] batch [10/28] time 0.340 (0.348) data 0.262 (0.270) loss_x loss_x 0.4656 (0.3804) acc_x 87.5000 (89.0625) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [15/28] time 0.359 (0.348) data 0.281 (0.270) loss_x loss_x 0.1881 (0.3478) acc_x 93.7500 (90.6250) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [20/28] time 0.356 (0.345) data 0.277 (0.267) loss_x loss_x 0.3938 (0.3406) acc_x 90.6250 (90.6250) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/28] time 0.339 (0.344) data 0.261 (0.266) loss_x loss_x 0.2151 (0.3405) acc_x 96.8750 (90.7500) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [5/22] time 0.347 (0.344) data 0.268 (0.266) loss_u loss_u 0.9673 (0.9399) acc_u 3.1250 (7.5000) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/22] time 0.336 (0.344) data 0.258 (0.266) loss_u loss_u 0.9541 (0.9279) acc_u 6.2500 (9.0625) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/22] time 0.345 (0.344) data 0.267 (0.265) loss_u loss_u 0.8726 (0.9167) acc_u 15.6250 (10.6250) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/22] time 0.346 (0.344) data 0.268 (0.266) loss_u loss_u 0.9214 (0.9159) acc_u 9.3750 (10.6250) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 230
confident_label rate tensor(0.5674, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 926
clean true:907
clean false:19
clean_rate:0.9794816414686826
noisy true:495
noisy false:211
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 706
epoch [124/200] batch [5/28] time 0.331 (0.344) data 0.253 (0.265) loss_x loss_x 0.5225 (0.4231) acc_x 90.6250 (91.2500) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [10/28] time 0.343 (0.343) data 0.266 (0.265) loss_x loss_x 0.1680 (0.3487) acc_x 93.7500 (92.5000) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [15/28] time 0.339 (0.332) data 0.260 (0.254) loss_x loss_x 0.2296 (0.3451) acc_x 93.7500 (92.0833) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [20/28] time 0.343 (0.334) data 0.264 (0.256) loss_x loss_x 0.3328 (0.3489) acc_x 93.7500 (91.8750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/28] time 0.340 (0.334) data 0.261 (0.256) loss_x loss_x 0.2686 (0.3365) acc_x 90.6250 (91.8750) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [5/22] time 0.359 (0.338) data 0.280 (0.260) loss_u loss_u 0.9634 (0.9151) acc_u 3.1250 (8.7500) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/22] time 0.342 (0.339) data 0.264 (0.261) loss_u loss_u 0.9219 (0.9308) acc_u 9.3750 (8.1250) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/22] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9707 (0.9229) acc_u 3.1250 (8.9583) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [20/22] time 0.343 (0.341) data 0.265 (0.262) loss_u loss_u 0.8296 (0.9077) acc_u 21.8750 (10.6250) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 912
clean true:897
clean false:15
clean_rate:0.9835526315789473
noisy true:491
noisy false:229
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 720
epoch [125/200] batch [5/28] time 0.355 (0.349) data 0.277 (0.271) loss_x loss_x 0.3376 (0.2606) acc_x 90.6250 (95.0000) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [10/28] time 0.346 (0.339) data 0.268 (0.261) loss_x loss_x 0.2649 (0.2842) acc_x 93.7500 (93.7500) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [15/28] time 0.309 (0.332) data 0.231 (0.254) loss_x loss_x 0.3965 (0.3166) acc_x 93.7500 (93.5417) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [20/28] time 0.323 (0.326) data 0.245 (0.248) loss_x loss_x 0.2150 (0.3618) acc_x 93.7500 (92.0312) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/28] time 0.343 (0.329) data 0.266 (0.250) loss_x loss_x 0.2085 (0.3340) acc_x 93.7500 (92.5000) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/22] time 0.344 (0.333) data 0.266 (0.255) loss_u loss_u 0.9072 (0.9263) acc_u 9.3750 (8.7500) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/22] time 0.343 (0.335) data 0.265 (0.257) loss_u loss_u 0.9116 (0.8953) acc_u 9.3750 (11.8750) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/22] time 0.339 (0.336) data 0.260 (0.258) loss_u loss_u 0.8667 (0.8889) acc_u 15.6250 (12.5000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/22] time 0.347 (0.337) data 0.269 (0.259) loss_u loss_u 0.9443 (0.8981) acc_u 6.2500 (11.4062) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.5607, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 915
clean true:901
clean false:14
clean_rate:0.9846994535519126
noisy true:481
noisy false:236
after delete: len(clean_dataset) 915
after delete: len(noisy_dataset) 717
epoch [126/200] batch [5/28] time 0.343 (0.345) data 0.266 (0.268) loss_x loss_x 0.4578 (0.3792) acc_x 90.6250 (91.2500) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [10/28] time 0.341 (0.343) data 0.263 (0.265) loss_x loss_x 0.3052 (0.3474) acc_x 90.6250 (90.9375) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [15/28] time 0.320 (0.342) data 0.241 (0.264) loss_x loss_x 0.2734 (0.3293) acc_x 90.6250 (91.0417) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [20/28] time 0.294 (0.333) data 0.216 (0.255) loss_x loss_x 0.0905 (0.3199) acc_x 100.0000 (91.5625) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/28] time 0.349 (0.336) data 0.271 (0.258) loss_x loss_x 0.3508 (0.3162) acc_x 93.7500 (92.2500) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [5/22] time 0.347 (0.340) data 0.268 (0.262) loss_u loss_u 0.8970 (0.8768) acc_u 12.5000 (13.7500) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/22] time 0.351 (0.342) data 0.272 (0.264) loss_u loss_u 0.9043 (0.8976) acc_u 15.6250 (12.8125) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/22] time 0.340 (0.344) data 0.261 (0.266) loss_u loss_u 0.9141 (0.9007) acc_u 9.3750 (11.8750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/22] time 0.336 (0.344) data 0.257 (0.265) loss_u loss_u 0.9678 (0.9079) acc_u 3.1250 (10.7812) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 240
confident_label rate tensor(0.5613, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 916
clean true:903
clean false:13
clean_rate:0.9858078602620087
noisy true:489
noisy false:227
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 716
epoch [127/200] batch [5/28] time 0.353 (0.354) data 0.275 (0.276) loss_x loss_x 0.3254 (0.3029) acc_x 96.8750 (95.0000) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [10/28] time 0.305 (0.333) data 0.227 (0.255) loss_x loss_x 0.2944 (0.3007) acc_x 90.6250 (95.0000) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [15/28] time 0.315 (0.325) data 0.238 (0.247) loss_x loss_x 0.2581 (0.3037) acc_x 90.6250 (93.3333) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [20/28] time 0.319 (0.323) data 0.241 (0.245) loss_x loss_x 0.2754 (0.3178) acc_x 93.7500 (92.6562) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/28] time 0.362 (0.327) data 0.284 (0.249) loss_x loss_x 0.3135 (0.3235) acc_x 96.8750 (92.6250) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/22] time 0.335 (0.329) data 0.257 (0.251) loss_u loss_u 0.9712 (0.9197) acc_u 3.1250 (8.7500) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [10/22] time 0.360 (0.331) data 0.280 (0.253) loss_u loss_u 0.9150 (0.9123) acc_u 9.3750 (9.6875) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [15/22] time 0.359 (0.334) data 0.280 (0.256) loss_u loss_u 0.9272 (0.9109) acc_u 9.3750 (9.5833) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/22] time 0.349 (0.336) data 0.269 (0.258) loss_u loss_u 0.9229 (0.9083) acc_u 9.3750 (9.8438) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.5613, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 916
clean true:900
clean false:16
clean_rate:0.982532751091703
noisy true:489
noisy false:227
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 716
epoch [128/200] batch [5/28] time 0.337 (0.351) data 0.260 (0.273) loss_x loss_x 0.3054 (0.3401) acc_x 96.8750 (96.2500) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [10/28] time 0.298 (0.334) data 0.220 (0.256) loss_x loss_x 0.3887 (0.3715) acc_x 84.3750 (92.1875) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [15/28] time 0.335 (0.327) data 0.257 (0.248) loss_x loss_x 0.3569 (0.3643) acc_x 96.8750 (92.7083) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [20/28] time 0.331 (0.328) data 0.252 (0.249) loss_x loss_x 0.4302 (0.3618) acc_x 93.7500 (92.5000) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/28] time 0.335 (0.331) data 0.257 (0.253) loss_x loss_x 0.4722 (0.3558) acc_x 87.5000 (92.2500) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/22] time 0.331 (0.332) data 0.253 (0.254) loss_u loss_u 0.9482 (0.9525) acc_u 9.3750 (5.6250) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [10/22] time 0.322 (0.333) data 0.243 (0.255) loss_u loss_u 0.8813 (0.9250) acc_u 12.5000 (8.1250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [15/22] time 0.342 (0.334) data 0.264 (0.256) loss_u loss_u 0.9248 (0.9141) acc_u 9.3750 (9.1667) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/22] time 0.336 (0.335) data 0.257 (0.256) loss_u loss_u 0.9512 (0.9100) acc_u 6.2500 (9.5312) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 227
confident_label rate tensor(0.5680, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 927
clean true:910
clean false:17
clean_rate:0.9816612729234089
noisy true:495
noisy false:210
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 705
epoch [129/200] batch [5/28] time 0.347 (0.350) data 0.269 (0.272) loss_x loss_x 0.3540 (0.2886) acc_x 93.7500 (93.1250) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [10/28] time 0.341 (0.339) data 0.263 (0.261) loss_x loss_x 0.1335 (0.2468) acc_x 100.0000 (95.0000) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [15/28] time 0.328 (0.330) data 0.249 (0.252) loss_x loss_x 0.5566 (0.3015) acc_x 90.6250 (93.7500) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [20/28] time 0.330 (0.331) data 0.252 (0.253) loss_x loss_x 0.2810 (0.2971) acc_x 90.6250 (93.2812) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/28] time 0.327 (0.332) data 0.249 (0.253) loss_x loss_x 0.4141 (0.3160) acc_x 84.3750 (92.6250) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/22] time 0.358 (0.334) data 0.279 (0.255) loss_u loss_u 0.9624 (0.9493) acc_u 3.1250 (5.6250) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/22] time 0.336 (0.335) data 0.258 (0.256) loss_u loss_u 0.8848 (0.9251) acc_u 12.5000 (8.4375) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/22] time 0.358 (0.335) data 0.279 (0.257) loss_u loss_u 0.7998 (0.9182) acc_u 25.0000 (9.5833) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [20/22] time 0.344 (0.336) data 0.265 (0.257) loss_u loss_u 0.8906 (0.9166) acc_u 12.5000 (9.6875) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.5619, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 917
clean true:905
clean false:12
clean_rate:0.9869138495092693
noisy true:503
noisy false:212
after delete: len(clean_dataset) 917
after delete: len(noisy_dataset) 715
epoch [130/200] batch [5/28] time 0.350 (0.358) data 0.271 (0.280) loss_x loss_x 0.1171 (0.2551) acc_x 100.0000 (96.2500) lr 5.7422e-04 eta 0:00:08
epoch [130/200] batch [10/28] time 0.298 (0.342) data 0.220 (0.264) loss_x loss_x 0.2688 (0.2818) acc_x 96.8750 (95.9375) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [15/28] time 0.348 (0.333) data 0.270 (0.255) loss_x loss_x 0.6196 (0.2934) acc_x 81.2500 (94.5833) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [20/28] time 0.351 (0.335) data 0.273 (0.257) loss_x loss_x 0.5488 (0.3127) acc_x 87.5000 (93.7500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/28] time 0.329 (0.336) data 0.251 (0.258) loss_x loss_x 0.4331 (0.3211) acc_x 93.7500 (93.2500) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [5/22] time 0.332 (0.338) data 0.253 (0.259) loss_u loss_u 0.9297 (0.9184) acc_u 9.3750 (9.3750) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [10/22] time 0.347 (0.338) data 0.269 (0.260) loss_u loss_u 0.8950 (0.9048) acc_u 12.5000 (11.8750) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/22] time 0.347 (0.339) data 0.269 (0.260) loss_u loss_u 0.9419 (0.9171) acc_u 6.2500 (10.0000) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [20/22] time 0.342 (0.338) data 0.264 (0.260) loss_u loss_u 0.8970 (0.9171) acc_u 15.6250 (10.1562) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 220
confident_label rate tensor(0.5711, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 932
clean true:918
clean false:14
clean_rate:0.9849785407725322
noisy true:494
noisy false:206
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 700
epoch [131/200] batch [5/29] time 0.346 (0.346) data 0.267 (0.269) loss_x loss_x 0.2299 (0.2156) acc_x 93.7500 (96.2500) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [10/29] time 0.334 (0.345) data 0.257 (0.267) loss_x loss_x 0.3079 (0.2434) acc_x 90.6250 (95.3125) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [15/29] time 0.325 (0.339) data 0.247 (0.261) loss_x loss_x 0.2903 (0.2840) acc_x 96.8750 (94.1667) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [20/29] time 0.346 (0.333) data 0.268 (0.255) loss_x loss_x 0.1483 (0.2917) acc_x 96.8750 (94.0625) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [25/29] time 0.330 (0.335) data 0.252 (0.257) loss_x loss_x 0.3147 (0.3066) acc_x 90.6250 (93.7500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [5/21] time 0.342 (0.335) data 0.263 (0.257) loss_u loss_u 0.9395 (0.9234) acc_u 6.2500 (8.7500) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [10/21] time 0.324 (0.336) data 0.244 (0.258) loss_u loss_u 0.9131 (0.9135) acc_u 12.5000 (10.3125) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [15/21] time 0.348 (0.337) data 0.270 (0.258) loss_u loss_u 0.8496 (0.9118) acc_u 18.7500 (10.2083) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/21] time 0.342 (0.337) data 0.264 (0.259) loss_u loss_u 0.9697 (0.9181) acc_u 3.1250 (9.5312) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.5643, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 921
clean true:906
clean false:15
clean_rate:0.9837133550488599
noisy true:495
noisy false:216
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 711
epoch [132/200] batch [5/28] time 0.353 (0.350) data 0.274 (0.272) loss_x loss_x 0.3284 (0.4385) acc_x 93.7500 (88.1250) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [10/28] time 0.327 (0.338) data 0.248 (0.259) loss_x loss_x 0.5610 (0.4322) acc_x 81.2500 (88.4375) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [15/28] time 0.292 (0.328) data 0.213 (0.250) loss_x loss_x 0.2233 (0.3884) acc_x 96.8750 (90.4167) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [20/28] time 0.343 (0.326) data 0.264 (0.247) loss_x loss_x 0.1288 (0.3665) acc_x 96.8750 (91.0938) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/28] time 0.328 (0.328) data 0.250 (0.250) loss_x loss_x 0.2466 (0.3656) acc_x 90.6250 (91.0000) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/22] time 0.333 (0.332) data 0.254 (0.253) loss_u loss_u 0.8999 (0.8945) acc_u 12.5000 (12.5000) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [10/22] time 0.326 (0.333) data 0.248 (0.254) loss_u loss_u 0.9360 (0.8886) acc_u 6.2500 (12.8125) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [15/22] time 0.336 (0.332) data 0.258 (0.254) loss_u loss_u 0.8721 (0.8924) acc_u 15.6250 (12.5000) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [20/22] time 0.404 (0.336) data 0.324 (0.258) loss_u loss_u 0.9072 (0.9061) acc_u 9.3750 (10.6250) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 242
confident_label rate tensor(0.5650, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 922
clean true:906
clean false:16
clean_rate:0.982646420824295
noisy true:484
noisy false:226
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 710
epoch [133/200] batch [5/28] time 0.337 (0.346) data 0.259 (0.268) loss_x loss_x 0.3579 (0.3942) acc_x 93.7500 (90.6250) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [10/28] time 0.345 (0.340) data 0.267 (0.262) loss_x loss_x 0.5010 (0.3925) acc_x 84.3750 (90.0000) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [15/28] time 0.327 (0.341) data 0.249 (0.263) loss_x loss_x 0.5269 (0.3545) acc_x 90.6250 (91.8750) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [20/28] time 0.294 (0.332) data 0.215 (0.254) loss_x loss_x 0.2744 (0.3411) acc_x 90.6250 (91.8750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/28] time 0.345 (0.331) data 0.267 (0.253) loss_x loss_x 0.3159 (0.3381) acc_x 93.7500 (92.0000) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/22] time 0.336 (0.335) data 0.258 (0.257) loss_u loss_u 0.8984 (0.9116) acc_u 15.6250 (10.6250) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [10/22] time 0.350 (0.337) data 0.271 (0.258) loss_u loss_u 0.9209 (0.9129) acc_u 9.3750 (10.3125) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/22] time 0.350 (0.339) data 0.271 (0.260) loss_u loss_u 0.9888 (0.9189) acc_u 0.0000 (8.9583) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/22] time 0.341 (0.340) data 0.262 (0.261) loss_u loss_u 0.9077 (0.9134) acc_u 12.5000 (9.6875) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.5631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 919
clean true:903
clean false:16
clean_rate:0.9825897714907508
noisy true:491
noisy false:222
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 713
epoch [134/200] batch [5/28] time 0.336 (0.347) data 0.258 (0.269) loss_x loss_x 0.3228 (0.2695) acc_x 93.7500 (94.3750) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [10/28] time 0.346 (0.348) data 0.268 (0.270) loss_x loss_x 0.8003 (0.3556) acc_x 81.2500 (92.5000) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [15/28] time 0.342 (0.346) data 0.265 (0.268) loss_x loss_x 0.5879 (0.3367) acc_x 84.3750 (92.7083) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [20/28] time 0.299 (0.336) data 0.221 (0.258) loss_x loss_x 0.4482 (0.3216) acc_x 84.3750 (92.8125) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/28] time 0.346 (0.336) data 0.268 (0.257) loss_x loss_x 0.1918 (0.3272) acc_x 90.6250 (92.0000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [5/22] time 0.364 (0.340) data 0.285 (0.262) loss_u loss_u 0.9531 (0.9207) acc_u 6.2500 (8.7500) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/22] time 0.345 (0.340) data 0.266 (0.262) loss_u loss_u 0.9976 (0.9108) acc_u 0.0000 (10.9375) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/22] time 0.351 (0.340) data 0.271 (0.261) loss_u loss_u 0.8633 (0.9034) acc_u 15.6250 (11.4583) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/22] time 0.357 (0.342) data 0.278 (0.263) loss_u loss_u 0.8579 (0.9039) acc_u 18.7500 (11.8750) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.5754, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 939
clean true:924
clean false:15
clean_rate:0.9840255591054313
noisy true:496
noisy false:197
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 693
epoch [135/200] batch [5/29] time 0.345 (0.351) data 0.267 (0.273) loss_x loss_x 0.3142 (0.3835) acc_x 93.7500 (88.7500) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [10/29] time 0.362 (0.350) data 0.283 (0.272) loss_x loss_x 0.6323 (0.3997) acc_x 87.5000 (89.3750) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [15/29] time 0.310 (0.345) data 0.230 (0.266) loss_x loss_x 0.3411 (0.3622) acc_x 93.7500 (91.2500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [20/29] time 0.362 (0.339) data 0.283 (0.260) loss_x loss_x 0.1144 (0.3354) acc_x 100.0000 (92.0312) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [25/29] time 0.380 (0.344) data 0.301 (0.265) loss_x loss_x 0.2496 (0.3263) acc_x 93.7500 (92.1250) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [5/21] time 0.362 (0.349) data 0.284 (0.270) loss_u loss_u 0.9038 (0.9262) acc_u 12.5000 (8.1250) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/21] time 0.342 (0.349) data 0.264 (0.270) loss_u loss_u 0.8589 (0.9243) acc_u 15.6250 (8.4375) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [15/21] time 0.359 (0.351) data 0.278 (0.272) loss_u loss_u 0.9204 (0.9295) acc_u 12.5000 (8.3333) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/21] time 0.336 (0.351) data 0.256 (0.271) loss_u loss_u 0.9126 (0.9310) acc_u 9.3750 (8.1250) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.5748, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 938
clean true:923
clean false:15
clean_rate:0.9840085287846482
noisy true:502
noisy false:192
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 694
epoch [136/200] batch [5/29] time 0.347 (0.348) data 0.270 (0.270) loss_x loss_x 0.4561 (0.3684) acc_x 87.5000 (88.7500) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [10/29] time 0.334 (0.344) data 0.256 (0.266) loss_x loss_x 0.4424 (0.3467) acc_x 90.6250 (90.9375) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [15/29] time 0.305 (0.329) data 0.226 (0.251) loss_x loss_x 0.4646 (0.3723) acc_x 84.3750 (89.7917) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [20/29] time 0.347 (0.331) data 0.268 (0.252) loss_x loss_x 0.4514 (0.3560) acc_x 90.6250 (90.3125) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/29] time 0.362 (0.335) data 0.284 (0.257) loss_x loss_x 0.1886 (0.3317) acc_x 96.8750 (90.8750) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [5/21] time 0.353 (0.339) data 0.274 (0.261) loss_u loss_u 0.9199 (0.9233) acc_u 9.3750 (8.7500) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [10/21] time 0.380 (0.341) data 0.301 (0.263) loss_u loss_u 0.9316 (0.9237) acc_u 6.2500 (8.7500) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/21] time 0.348 (0.341) data 0.270 (0.263) loss_u loss_u 0.9600 (0.9223) acc_u 3.1250 (8.7500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/21] time 0.336 (0.341) data 0.257 (0.263) loss_u loss_u 0.9565 (0.9261) acc_u 6.2500 (8.2812) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.5741, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 937
clean true:921
clean false:16
clean_rate:0.9829242262540021
noisy true:479
noisy false:216
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 695
epoch [137/200] batch [5/29] time 0.354 (0.359) data 0.276 (0.281) loss_x loss_x 0.2710 (0.3277) acc_x 93.7500 (91.2500) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [10/29] time 0.345 (0.351) data 0.267 (0.273) loss_x loss_x 0.4246 (0.3294) acc_x 87.5000 (92.1875) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [15/29] time 0.311 (0.337) data 0.233 (0.259) loss_x loss_x 0.2205 (0.3023) acc_x 96.8750 (93.3333) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [20/29] time 0.355 (0.341) data 0.277 (0.263) loss_x loss_x 0.3604 (0.3078) acc_x 90.6250 (93.4375) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [25/29] time 0.327 (0.343) data 0.249 (0.264) loss_x loss_x 0.4407 (0.3085) acc_x 90.6250 (93.7500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [5/21] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9351 (0.9201) acc_u 12.5000 (12.5000) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/21] time 0.343 (0.343) data 0.265 (0.265) loss_u loss_u 0.8784 (0.9228) acc_u 12.5000 (10.3125) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [15/21] time 0.329 (0.343) data 0.249 (0.265) loss_u loss_u 0.9722 (0.9292) acc_u 3.1250 (8.9583) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/21] time 0.331 (0.342) data 0.252 (0.264) loss_u loss_u 0.9297 (0.9354) acc_u 6.2500 (7.9688) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.5717, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 933
clean true:910
clean false:23
clean_rate:0.9753483386923901
noisy true:497
noisy false:202
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 699
epoch [138/200] batch [5/29] time 0.342 (0.343) data 0.264 (0.265) loss_x loss_x 0.8799 (0.6143) acc_x 84.3750 (85.0000) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [10/29] time 0.344 (0.341) data 0.266 (0.263) loss_x loss_x 0.3892 (0.4686) acc_x 96.8750 (89.6875) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [15/29] time 0.307 (0.328) data 0.227 (0.250) loss_x loss_x 0.9019 (0.4651) acc_x 81.2500 (89.7917) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [20/29] time 0.376 (0.335) data 0.296 (0.257) loss_x loss_x 0.3140 (0.4387) acc_x 87.5000 (90.1562) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [25/29] time 0.361 (0.342) data 0.282 (0.264) loss_x loss_x 0.3586 (0.4145) acc_x 90.6250 (90.5000) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [5/21] time 0.348 (0.346) data 0.269 (0.267) loss_u loss_u 0.9424 (0.9180) acc_u 6.2500 (9.3750) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [10/21] time 0.344 (0.347) data 0.265 (0.268) loss_u loss_u 0.8960 (0.9313) acc_u 9.3750 (7.5000) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [15/21] time 0.358 (0.347) data 0.279 (0.268) loss_u loss_u 0.9062 (0.9188) acc_u 12.5000 (8.9583) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [20/21] time 0.349 (0.348) data 0.269 (0.269) loss_u loss_u 0.9028 (0.9153) acc_u 9.3750 (9.3750) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.5650, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 922
clean true:902
clean false:20
clean_rate:0.9783080260303688
noisy true:493
noisy false:217
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 710
epoch [139/200] batch [5/28] time 0.349 (0.348) data 0.271 (0.269) loss_x loss_x 0.2502 (0.2348) acc_x 93.7500 (93.1250) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [10/28] time 0.304 (0.342) data 0.226 (0.264) loss_x loss_x 0.3411 (0.3233) acc_x 87.5000 (90.6250) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [15/28] time 0.297 (0.328) data 0.219 (0.250) loss_x loss_x 0.6436 (0.3415) acc_x 87.5000 (91.0417) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [20/28] time 0.336 (0.330) data 0.257 (0.252) loss_x loss_x 0.2568 (0.3491) acc_x 96.8750 (91.4062) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/28] time 0.343 (0.333) data 0.265 (0.255) loss_x loss_x 0.3010 (0.3378) acc_x 93.7500 (92.0000) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/22] time 0.346 (0.336) data 0.268 (0.257) loss_u loss_u 0.8857 (0.9194) acc_u 12.5000 (9.3750) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [10/22] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.8643 (0.9057) acc_u 18.7500 (11.8750) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/22] time 0.329 (0.338) data 0.249 (0.259) loss_u loss_u 0.9175 (0.9097) acc_u 9.3750 (11.2500) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/22] time 0.359 (0.338) data 0.280 (0.260) loss_u loss_u 0.9590 (0.9101) acc_u 6.2500 (11.0938) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.5576, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 910
clean true:897
clean false:13
clean_rate:0.9857142857142858
noisy true:501
noisy false:221
after delete: len(clean_dataset) 910
after delete: len(noisy_dataset) 722
epoch [140/200] batch [5/28] time 0.346 (0.351) data 0.268 (0.273) loss_x loss_x 0.3645 (0.3219) acc_x 93.7500 (91.8750) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [10/28] time 0.344 (0.346) data 0.265 (0.268) loss_x loss_x 0.3994 (0.3256) acc_x 93.7500 (91.5625) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [15/28] time 0.347 (0.346) data 0.270 (0.268) loss_x loss_x 0.5439 (0.3266) acc_x 84.3750 (91.6667) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [20/28] time 0.305 (0.345) data 0.226 (0.267) loss_x loss_x 0.5967 (0.3378) acc_x 75.0000 (91.2500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/28] time 0.346 (0.344) data 0.268 (0.266) loss_x loss_x 0.2271 (0.3152) acc_x 96.8750 (92.1250) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [5/22] time 0.335 (0.345) data 0.257 (0.266) loss_u loss_u 0.9883 (0.9266) acc_u 3.1250 (8.7500) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/22] time 0.343 (0.345) data 0.264 (0.267) loss_u loss_u 0.9644 (0.9325) acc_u 3.1250 (7.5000) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/22] time 0.339 (0.344) data 0.261 (0.266) loss_u loss_u 0.8896 (0.9222) acc_u 12.5000 (8.5417) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/22] time 0.376 (0.344) data 0.296 (0.266) loss_u loss_u 0.9033 (0.9066) acc_u 12.5000 (10.3125) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.5741, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 937
clean true:921
clean false:16
clean_rate:0.9829242262540021
noisy true:498
noisy false:197
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 695
epoch [141/200] batch [5/29] time 0.343 (0.352) data 0.265 (0.274) loss_x loss_x 0.3916 (0.2454) acc_x 87.5000 (95.0000) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [10/29] time 0.350 (0.347) data 0.273 (0.269) loss_x loss_x 0.2246 (0.2790) acc_x 96.8750 (95.0000) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [15/29] time 0.342 (0.346) data 0.264 (0.268) loss_x loss_x 0.5859 (0.3053) acc_x 87.5000 (93.5417) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [20/29] time 0.350 (0.342) data 0.272 (0.264) loss_x loss_x 0.5371 (0.3178) acc_x 84.3750 (92.6562) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [25/29] time 0.343 (0.343) data 0.266 (0.265) loss_x loss_x 0.1425 (0.2936) acc_x 93.7500 (93.2500) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [5/21] time 0.342 (0.344) data 0.264 (0.265) loss_u loss_u 0.9351 (0.9190) acc_u 9.3750 (10.6250) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/21] time 0.336 (0.342) data 0.257 (0.264) loss_u loss_u 0.9199 (0.9167) acc_u 9.3750 (10.3125) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [15/21] time 0.329 (0.343) data 0.249 (0.265) loss_u loss_u 0.9341 (0.9308) acc_u 9.3750 (8.7500) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [20/21] time 0.340 (0.342) data 0.261 (0.263) loss_u loss_u 0.9492 (0.9326) acc_u 6.2500 (8.4375) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.5699, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 930
clean true:912
clean false:18
clean_rate:0.9806451612903225
noisy true:496
noisy false:206
after delete: len(clean_dataset) 930
after delete: len(noisy_dataset) 702
epoch [142/200] batch [5/29] time 0.338 (0.343) data 0.260 (0.265) loss_x loss_x 0.1318 (0.3102) acc_x 100.0000 (93.7500) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [10/29] time 0.338 (0.344) data 0.260 (0.266) loss_x loss_x 0.1686 (0.2827) acc_x 96.8750 (93.4375) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [15/29] time 0.304 (0.331) data 0.226 (0.253) loss_x loss_x 0.2786 (0.2712) acc_x 93.7500 (93.9583) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [20/29] time 0.335 (0.334) data 0.257 (0.256) loss_x loss_x 0.3721 (0.2947) acc_x 87.5000 (93.4375) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [25/29] time 0.321 (0.336) data 0.243 (0.258) loss_x loss_x 0.3611 (0.2822) acc_x 90.6250 (93.7500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [5/21] time 0.331 (0.337) data 0.253 (0.259) loss_u loss_u 0.9214 (0.9074) acc_u 9.3750 (10.0000) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/21] time 0.351 (0.339) data 0.273 (0.261) loss_u loss_u 0.8130 (0.9011) acc_u 25.0000 (11.5625) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [15/21] time 0.339 (0.340) data 0.260 (0.262) loss_u loss_u 0.9429 (0.9055) acc_u 6.2500 (10.8333) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [20/21] time 0.357 (0.341) data 0.279 (0.262) loss_u loss_u 0.9360 (0.9123) acc_u 6.2500 (10.0000) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 227
confident_label rate tensor(0.5686, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 928
clean true:910
clean false:18
clean_rate:0.9806034482758621
noisy true:495
noisy false:209
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 704
epoch [143/200] batch [5/29] time 0.373 (0.359) data 0.296 (0.281) loss_x loss_x 0.1455 (0.2805) acc_x 96.8750 (93.1250) lr 3.9958e-04 eta 0:00:08
epoch [143/200] batch [10/29] time 0.322 (0.346) data 0.244 (0.267) loss_x loss_x 0.2313 (0.2918) acc_x 93.7500 (92.8125) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [15/29] time 0.301 (0.338) data 0.223 (0.260) loss_x loss_x 0.3240 (0.3191) acc_x 96.8750 (92.5000) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [20/29] time 0.345 (0.335) data 0.267 (0.257) loss_x loss_x 0.3242 (0.3377) acc_x 93.7500 (91.4062) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [25/29] time 0.353 (0.335) data 0.276 (0.257) loss_x loss_x 0.3552 (0.3286) acc_x 87.5000 (91.7500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [5/22] time 0.355 (0.339) data 0.277 (0.261) loss_u loss_u 0.8237 (0.9092) acc_u 18.7500 (9.3750) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [10/22] time 0.355 (0.339) data 0.277 (0.261) loss_u loss_u 0.9102 (0.9041) acc_u 9.3750 (10.6250) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/22] time 0.330 (0.339) data 0.251 (0.261) loss_u loss_u 0.8550 (0.9027) acc_u 18.7500 (11.2500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/22] time 0.345 (0.340) data 0.265 (0.262) loss_u loss_u 0.9390 (0.9079) acc_u 6.2500 (10.7812) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 217
confident_label rate tensor(0.5772, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 942
clean true:925
clean false:17
clean_rate:0.9819532908704883
noisy true:490
noisy false:200
after delete: len(clean_dataset) 942
after delete: len(noisy_dataset) 690
epoch [144/200] batch [5/29] time 0.304 (0.340) data 0.225 (0.261) loss_x loss_x 0.1958 (0.2987) acc_x 96.8750 (92.5000) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [10/29] time 0.354 (0.328) data 0.276 (0.249) loss_x loss_x 0.4119 (0.3023) acc_x 93.7500 (92.8125) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [15/29] time 0.341 (0.335) data 0.264 (0.257) loss_x loss_x 0.2483 (0.3177) acc_x 93.7500 (92.0833) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [20/29] time 0.337 (0.336) data 0.259 (0.258) loss_x loss_x 0.2230 (0.3162) acc_x 93.7500 (92.1875) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [25/29] time 0.336 (0.336) data 0.258 (0.257) loss_x loss_x 0.2842 (0.3180) acc_x 90.6250 (91.8750) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [5/21] time 0.314 (0.336) data 0.236 (0.257) loss_u loss_u 0.9346 (0.8949) acc_u 6.2500 (11.2500) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [10/21] time 0.346 (0.337) data 0.268 (0.259) loss_u loss_u 0.9624 (0.9206) acc_u 3.1250 (8.1250) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/21] time 0.339 (0.337) data 0.261 (0.259) loss_u loss_u 0.8867 (0.9259) acc_u 12.5000 (7.7083) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/21] time 0.343 (0.338) data 0.264 (0.260) loss_u loss_u 0.9185 (0.9257) acc_u 6.2500 (7.8125) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 221
confident_label rate tensor(0.5729, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 935
clean true:918
clean false:17
clean_rate:0.9818181818181818
noisy true:493
noisy false:204
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 697
epoch [145/200] batch [5/29] time 0.310 (0.332) data 0.231 (0.254) loss_x loss_x 0.3262 (0.2797) acc_x 93.7500 (94.3750) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [10/29] time 0.340 (0.332) data 0.262 (0.254) loss_x loss_x 0.3984 (0.3047) acc_x 90.6250 (93.1250) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [15/29] time 0.316 (0.329) data 0.238 (0.250) loss_x loss_x 0.5630 (0.2908) acc_x 84.3750 (93.7500) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [20/29] time 0.341 (0.332) data 0.263 (0.254) loss_x loss_x 0.7295 (0.3119) acc_x 87.5000 (93.2812) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/29] time 0.351 (0.335) data 0.273 (0.257) loss_x loss_x 0.1289 (0.3020) acc_x 100.0000 (93.8750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [5/21] time 0.344 (0.337) data 0.264 (0.259) loss_u loss_u 0.9985 (0.9491) acc_u 0.0000 (6.8750) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [10/21] time 0.336 (0.339) data 0.258 (0.260) loss_u loss_u 0.8657 (0.9312) acc_u 15.6250 (8.4375) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [15/21] time 0.351 (0.340) data 0.273 (0.262) loss_u loss_u 0.9302 (0.9223) acc_u 6.2500 (9.3750) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/21] time 0.351 (0.340) data 0.272 (0.262) loss_u loss_u 0.9585 (0.9255) acc_u 6.2500 (9.2188) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 220
confident_label rate tensor(0.5741, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 937
clean true:923
clean false:14
clean_rate:0.9850586979722519
noisy true:489
noisy false:206
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 695
epoch [146/200] batch [5/29] time 0.308 (0.312) data 0.230 (0.233) loss_x loss_x 0.5933 (0.3034) acc_x 90.6250 (95.0000) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [10/29] time 0.348 (0.326) data 0.269 (0.248) loss_x loss_x 0.2922 (0.2879) acc_x 93.7500 (94.0625) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [15/29] time 0.318 (0.326) data 0.239 (0.247) loss_x loss_x 0.3875 (0.3149) acc_x 90.6250 (92.9167) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [20/29] time 0.330 (0.325) data 0.252 (0.247) loss_x loss_x 0.2727 (0.3200) acc_x 96.8750 (92.8125) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/29] time 0.343 (0.329) data 0.265 (0.251) loss_x loss_x 0.3555 (0.3011) acc_x 84.3750 (92.8750) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [5/21] time 0.351 (0.333) data 0.273 (0.254) loss_u loss_u 0.9219 (0.9169) acc_u 9.3750 (8.1250) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [10/21] time 0.357 (0.333) data 0.279 (0.255) loss_u loss_u 0.9678 (0.9259) acc_u 3.1250 (8.1250) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/21] time 0.352 (0.335) data 0.273 (0.257) loss_u loss_u 0.9243 (0.9276) acc_u 9.3750 (8.1250) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/21] time 0.357 (0.336) data 0.278 (0.258) loss_u loss_u 0.9561 (0.9246) acc_u 6.2500 (8.7500) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 222
confident_label rate tensor(0.5686, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 928
clean true:911
clean false:17
clean_rate:0.9816810344827587
noisy true:499
noisy false:205
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 704
epoch [147/200] batch [5/29] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.3569 (0.3326) acc_x 90.6250 (91.8750) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [10/29] time 0.335 (0.327) data 0.257 (0.249) loss_x loss_x 0.2937 (0.3146) acc_x 87.5000 (93.1250) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [15/29] time 0.344 (0.321) data 0.266 (0.243) loss_x loss_x 0.3450 (0.3237) acc_x 93.7500 (92.7083) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [20/29] time 0.349 (0.328) data 0.271 (0.250) loss_x loss_x 0.1581 (0.3194) acc_x 96.8750 (92.6562) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/29] time 0.343 (0.332) data 0.265 (0.253) loss_x loss_x 0.3474 (0.3014) acc_x 90.6250 (93.1250) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [5/22] time 0.351 (0.335) data 0.272 (0.257) loss_u loss_u 0.8408 (0.8985) acc_u 15.6250 (10.6250) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [10/22] time 0.348 (0.336) data 0.270 (0.258) loss_u loss_u 0.8804 (0.9051) acc_u 12.5000 (10.6250) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/22] time 0.345 (0.337) data 0.267 (0.259) loss_u loss_u 0.9189 (0.9055) acc_u 9.3750 (10.6250) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/22] time 0.341 (0.337) data 0.262 (0.259) loss_u loss_u 0.9468 (0.9131) acc_u 6.2500 (9.8438) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 201
confident_label rate tensor(0.5748, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 938
clean true:925
clean false:13
clean_rate:0.9861407249466951
noisy true:506
noisy false:188
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 694
epoch [148/200] batch [5/29] time 0.354 (0.327) data 0.275 (0.249) loss_x loss_x 0.3079 (0.3617) acc_x 93.7500 (93.1250) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [10/29] time 0.341 (0.329) data 0.263 (0.251) loss_x loss_x 0.6816 (0.3866) acc_x 81.2500 (91.2500) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [15/29] time 0.355 (0.335) data 0.276 (0.257) loss_x loss_x 0.2983 (0.3722) acc_x 96.8750 (92.2917) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [20/29] time 0.328 (0.336) data 0.251 (0.258) loss_x loss_x 0.3545 (0.3546) acc_x 90.6250 (92.1875) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [25/29] time 0.351 (0.337) data 0.272 (0.259) loss_x loss_x 0.1888 (0.3399) acc_x 93.7500 (92.5000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [5/21] time 0.333 (0.338) data 0.254 (0.259) loss_u loss_u 0.8857 (0.9043) acc_u 15.6250 (12.5000) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [10/21] time 0.350 (0.339) data 0.272 (0.260) loss_u loss_u 0.9678 (0.9171) acc_u 3.1250 (10.0000) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [15/21] time 0.350 (0.340) data 0.273 (0.261) loss_u loss_u 0.9375 (0.9200) acc_u 9.3750 (10.0000) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/21] time 0.331 (0.340) data 0.252 (0.262) loss_u loss_u 0.9248 (0.9227) acc_u 9.3750 (9.5312) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 222
confident_label rate tensor(0.5729, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 935
clean true:919
clean false:16
clean_rate:0.9828877005347594
noisy true:491
noisy false:206
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 697
epoch [149/200] batch [5/29] time 0.307 (0.309) data 0.228 (0.230) loss_x loss_x 0.2876 (0.3449) acc_x 90.6250 (88.7500) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [10/29] time 0.341 (0.324) data 0.264 (0.246) loss_x loss_x 0.4307 (0.3259) acc_x 87.5000 (91.2500) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [15/29] time 0.345 (0.330) data 0.267 (0.252) loss_x loss_x 0.2773 (0.3068) acc_x 90.6250 (92.2917) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [20/29] time 0.338 (0.333) data 0.260 (0.255) loss_x loss_x 0.4653 (0.3108) acc_x 90.6250 (92.5000) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/29] time 0.348 (0.336) data 0.270 (0.258) loss_x loss_x 0.2859 (0.3198) acc_x 93.7500 (92.2500) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [5/21] time 0.347 (0.338) data 0.267 (0.260) loss_u loss_u 0.9146 (0.9043) acc_u 9.3750 (11.2500) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [10/21] time 0.346 (0.339) data 0.268 (0.261) loss_u loss_u 0.9980 (0.9221) acc_u 0.0000 (8.7500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/21] time 0.334 (0.338) data 0.256 (0.260) loss_u loss_u 0.9644 (0.9188) acc_u 3.1250 (9.1667) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/21] time 0.340 (0.339) data 0.261 (0.261) loss_u loss_u 0.9688 (0.9229) acc_u 3.1250 (8.5938) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 217
confident_label rate tensor(0.5754, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 939
clean true:922
clean false:17
clean_rate:0.9818956336528222
noisy true:493
noisy false:200
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 693
epoch [150/200] batch [5/29] time 0.327 (0.324) data 0.249 (0.245) loss_x loss_x 0.2339 (0.2481) acc_x 93.7500 (93.7500) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [10/29] time 0.314 (0.319) data 0.236 (0.240) loss_x loss_x 0.2742 (0.2844) acc_x 93.7500 (92.5000) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [15/29] time 0.335 (0.326) data 0.258 (0.248) loss_x loss_x 0.3691 (0.3009) acc_x 93.7500 (91.6667) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [20/29] time 0.346 (0.330) data 0.269 (0.252) loss_x loss_x 0.1361 (0.2956) acc_x 96.8750 (91.8750) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/29] time 0.354 (0.334) data 0.277 (0.256) loss_x loss_x 0.2800 (0.3062) acc_x 96.8750 (92.1250) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [5/21] time 0.361 (0.336) data 0.283 (0.258) loss_u loss_u 0.8369 (0.9215) acc_u 18.7500 (8.7500) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [10/21] time 0.342 (0.336) data 0.264 (0.258) loss_u loss_u 0.9385 (0.9271) acc_u 6.2500 (8.1250) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [15/21] time 0.339 (0.337) data 0.261 (0.259) loss_u loss_u 0.9351 (0.9235) acc_u 6.2500 (8.5417) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [20/21] time 0.327 (0.336) data 0.249 (0.258) loss_u loss_u 0.9502 (0.9246) acc_u 6.2500 (8.2812) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.5686, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 928
clean true:913
clean false:15
clean_rate:0.9838362068965517
noisy true:482
noisy false:222
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 704
epoch [151/200] batch [5/29] time 0.363 (0.337) data 0.284 (0.259) loss_x loss_x 0.1958 (0.2767) acc_x 96.8750 (93.1250) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [10/29] time 0.330 (0.339) data 0.252 (0.260) loss_x loss_x 0.3608 (0.2959) acc_x 93.7500 (93.7500) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [15/29] time 0.337 (0.337) data 0.259 (0.259) loss_x loss_x 0.2039 (0.2672) acc_x 96.8750 (94.5833) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [20/29] time 0.333 (0.338) data 0.255 (0.260) loss_x loss_x 0.2278 (0.2831) acc_x 93.7500 (94.5312) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [25/29] time 0.328 (0.339) data 0.250 (0.261) loss_x loss_x 0.5518 (0.2809) acc_x 87.5000 (94.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [5/22] time 0.341 (0.340) data 0.263 (0.262) loss_u loss_u 0.9492 (0.9037) acc_u 6.2500 (10.0000) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [10/22] time 0.351 (0.341) data 0.273 (0.263) loss_u loss_u 0.9243 (0.9151) acc_u 9.3750 (9.3750) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/22] time 0.343 (0.342) data 0.265 (0.263) loss_u loss_u 0.8989 (0.9150) acc_u 15.6250 (10.0000) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/22] time 0.346 (0.341) data 0.268 (0.263) loss_u loss_u 0.9312 (0.9085) acc_u 6.2500 (10.7812) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.5699, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 930
clean true:911
clean false:19
clean_rate:0.9795698924731183
noisy true:493
noisy false:209
after delete: len(clean_dataset) 930
after delete: len(noisy_dataset) 702
epoch [152/200] batch [5/29] time 0.339 (0.331) data 0.259 (0.253) loss_x loss_x 0.3069 (0.3579) acc_x 93.7500 (90.6250) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [10/29] time 0.343 (0.328) data 0.265 (0.250) loss_x loss_x 0.3005 (0.3257) acc_x 84.3750 (90.9375) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [15/29] time 0.330 (0.331) data 0.252 (0.253) loss_x loss_x 0.4824 (0.3529) acc_x 87.5000 (90.4167) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [20/29] time 0.333 (0.334) data 0.255 (0.256) loss_x loss_x 0.2817 (0.3531) acc_x 93.7500 (91.2500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [25/29] time 0.332 (0.335) data 0.254 (0.257) loss_x loss_x 0.4775 (0.3771) acc_x 81.2500 (90.2500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [5/21] time 0.353 (0.335) data 0.275 (0.257) loss_u loss_u 0.8071 (0.9140) acc_u 25.0000 (11.2500) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [10/21] time 0.328 (0.336) data 0.249 (0.258) loss_u loss_u 0.9946 (0.9257) acc_u 0.0000 (8.7500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [15/21] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.8506 (0.9166) acc_u 15.6250 (9.1667) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/21] time 0.332 (0.337) data 0.253 (0.259) loss_u loss_u 0.9785 (0.9081) acc_u 3.1250 (10.0000) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.5705, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 931
clean true:913
clean false:18
clean_rate:0.9806659505907627
noisy true:488
noisy false:213
after delete: len(clean_dataset) 931
after delete: len(noisy_dataset) 701
epoch [153/200] batch [5/29] time 0.347 (0.319) data 0.269 (0.241) loss_x loss_x 0.5659 (0.3941) acc_x 78.1250 (89.3750) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [10/29] time 0.320 (0.328) data 0.242 (0.250) loss_x loss_x 0.2378 (0.3626) acc_x 90.6250 (90.0000) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [15/29] time 0.345 (0.332) data 0.267 (0.254) loss_x loss_x 0.3801 (0.3654) acc_x 90.6250 (90.0000) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [20/29] time 0.344 (0.335) data 0.266 (0.257) loss_x loss_x 0.3726 (0.3598) acc_x 87.5000 (90.1562) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [25/29] time 0.354 (0.338) data 0.275 (0.260) loss_x loss_x 0.2479 (0.3700) acc_x 93.7500 (90.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [5/21] time 0.325 (0.338) data 0.247 (0.260) loss_u loss_u 0.9463 (0.9083) acc_u 6.2500 (9.3750) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [10/21] time 0.341 (0.338) data 0.262 (0.260) loss_u loss_u 0.8354 (0.9124) acc_u 18.7500 (9.3750) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/21] time 0.338 (0.338) data 0.259 (0.260) loss_u loss_u 0.8877 (0.9172) acc_u 12.5000 (8.7500) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/21] time 0.351 (0.338) data 0.272 (0.260) loss_u loss_u 0.9380 (0.9152) acc_u 6.2500 (9.0625) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5760, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 940
clean true:923
clean false:17
clean_rate:0.9819148936170212
noisy true:491
noisy false:201
after delete: len(clean_dataset) 940
after delete: len(noisy_dataset) 692
epoch [154/200] batch [5/29] time 0.331 (0.321) data 0.253 (0.242) loss_x loss_x 0.2208 (0.2093) acc_x 96.8750 (95.6250) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [10/29] time 0.319 (0.328) data 0.242 (0.249) loss_x loss_x 0.2668 (0.2494) acc_x 93.7500 (93.7500) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [15/29] time 0.341 (0.330) data 0.264 (0.252) loss_x loss_x 0.3428 (0.2644) acc_x 93.7500 (93.1250) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [20/29] time 0.332 (0.332) data 0.253 (0.254) loss_x loss_x 0.7363 (0.2808) acc_x 84.3750 (93.2812) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/29] time 0.341 (0.334) data 0.263 (0.256) loss_x loss_x 0.3000 (0.2777) acc_x 93.7500 (93.2500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [5/21] time 0.331 (0.337) data 0.252 (0.259) loss_u loss_u 0.9702 (0.9059) acc_u 3.1250 (10.6250) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [10/21] time 0.334 (0.337) data 0.256 (0.259) loss_u loss_u 0.8750 (0.8984) acc_u 12.5000 (11.2500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [15/21] time 0.336 (0.337) data 0.257 (0.259) loss_u loss_u 0.9077 (0.9079) acc_u 9.3750 (10.4167) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/21] time 0.335 (0.337) data 0.256 (0.259) loss_u loss_u 0.9600 (0.9137) acc_u 3.1250 (9.8438) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.5815, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 949
clean true:929
clean false:20
clean_rate:0.9789251844046365
noisy true:497
noisy false:186
after delete: len(clean_dataset) 949
after delete: len(noisy_dataset) 683
epoch [155/200] batch [5/29] time 0.329 (0.319) data 0.251 (0.240) loss_x loss_x 0.1721 (0.2783) acc_x 96.8750 (93.7500) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [10/29] time 0.340 (0.328) data 0.262 (0.250) loss_x loss_x 0.1794 (0.3037) acc_x 96.8750 (93.7500) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [15/29] time 0.352 (0.333) data 0.274 (0.255) loss_x loss_x 0.2544 (0.3166) acc_x 96.8750 (93.1250) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [20/29] time 0.323 (0.335) data 0.246 (0.257) loss_x loss_x 0.4734 (0.3180) acc_x 87.5000 (92.9688) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [25/29] time 0.339 (0.336) data 0.261 (0.258) loss_x loss_x 0.2822 (0.3166) acc_x 96.8750 (93.2500) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [5/21] time 0.346 (0.337) data 0.268 (0.258) loss_u loss_u 0.9409 (0.9502) acc_u 6.2500 (6.2500) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [10/21] time 0.345 (0.336) data 0.267 (0.258) loss_u loss_u 0.8887 (0.9379) acc_u 12.5000 (8.1250) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [15/21] time 0.343 (0.337) data 0.265 (0.259) loss_u loss_u 0.8799 (0.9349) acc_u 15.6250 (7.9167) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [20/21] time 0.332 (0.337) data 0.254 (0.259) loss_u loss_u 0.9497 (0.9294) acc_u 6.2500 (8.5938) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 219
confident_label rate tensor(0.5729, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 935
clean true:917
clean false:18
clean_rate:0.9807486631016042
noisy true:496
noisy false:201
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 697
epoch [156/200] batch [5/29] time 0.306 (0.305) data 0.227 (0.227) loss_x loss_x 0.4456 (0.4549) acc_x 87.5000 (90.6250) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [10/29] time 0.306 (0.304) data 0.228 (0.226) loss_x loss_x 0.3372 (0.3581) acc_x 90.6250 (93.1250) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [15/29] time 0.337 (0.320) data 0.259 (0.242) loss_x loss_x 0.4788 (0.3549) acc_x 84.3750 (92.2917) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [20/29] time 0.347 (0.326) data 0.269 (0.248) loss_x loss_x 0.1381 (0.3180) acc_x 100.0000 (93.1250) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/29] time 0.326 (0.328) data 0.247 (0.250) loss_x loss_x 0.3184 (0.3206) acc_x 93.7500 (93.2500) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [5/21] time 0.331 (0.330) data 0.253 (0.252) loss_u loss_u 0.9448 (0.9207) acc_u 6.2500 (8.7500) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/21] time 0.367 (0.332) data 0.288 (0.254) loss_u loss_u 0.9580 (0.9300) acc_u 3.1250 (7.8125) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/21] time 0.336 (0.333) data 0.257 (0.255) loss_u loss_u 0.9419 (0.9264) acc_u 6.2500 (8.3333) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/21] time 0.339 (0.334) data 0.260 (0.255) loss_u loss_u 0.8633 (0.9161) acc_u 15.6250 (9.3750) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 246
confident_label rate tensor(0.5699, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 930
clean true:912
clean false:18
clean_rate:0.9806451612903225
noisy true:474
noisy false:228
after delete: len(clean_dataset) 930
after delete: len(noisy_dataset) 702
epoch [157/200] batch [5/29] time 0.295 (0.336) data 0.217 (0.258) loss_x loss_x 0.1908 (0.3159) acc_x 100.0000 (92.5000) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [10/29] time 0.344 (0.331) data 0.266 (0.252) loss_x loss_x 0.2100 (0.2872) acc_x 96.8750 (93.1250) lr 2.3959e-04 eta 0:00:06
epoch [157/200] batch [15/29] time 0.347 (0.335) data 0.268 (0.257) loss_x loss_x 0.4248 (0.2859) acc_x 90.6250 (93.3333) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [20/29] time 0.349 (0.339) data 0.271 (0.261) loss_x loss_x 0.2910 (0.2753) acc_x 93.7500 (93.9062) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [25/29] time 0.344 (0.341) data 0.267 (0.263) loss_x loss_x 0.2559 (0.2867) acc_x 90.6250 (93.1250) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [5/21] time 0.351 (0.342) data 0.272 (0.264) loss_u loss_u 0.9648 (0.9206) acc_u 3.1250 (8.7500) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/21] time 0.330 (0.343) data 0.252 (0.264) loss_u loss_u 0.9482 (0.9238) acc_u 6.2500 (9.3750) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/21] time 0.343 (0.342) data 0.264 (0.264) loss_u loss_u 0.9004 (0.9136) acc_u 12.5000 (10.4167) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/21] time 0.318 (0.343) data 0.239 (0.264) loss_u loss_u 0.9658 (0.9188) acc_u 3.1250 (9.5312) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5821, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 950
clean true:931
clean false:19
clean_rate:0.98
noisy true:483
noisy false:199
after delete: len(clean_dataset) 950
after delete: len(noisy_dataset) 682
epoch [158/200] batch [5/29] time 0.290 (0.323) data 0.211 (0.244) loss_x loss_x 0.2788 (0.2361) acc_x 93.7500 (95.0000) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [10/29] time 0.336 (0.314) data 0.258 (0.236) loss_x loss_x 0.4414 (0.2641) acc_x 90.6250 (94.6875) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [15/29] time 0.353 (0.326) data 0.276 (0.248) loss_x loss_x 0.1097 (0.2762) acc_x 100.0000 (94.5833) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [20/29] time 0.345 (0.333) data 0.267 (0.255) loss_x loss_x 0.2954 (0.2761) acc_x 90.6250 (94.2188) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/29] time 0.333 (0.335) data 0.256 (0.257) loss_x loss_x 0.3474 (0.2799) acc_x 93.7500 (93.8750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [5/21] time 0.325 (0.339) data 0.247 (0.261) loss_u loss_u 0.8716 (0.9192) acc_u 12.5000 (8.7500) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/21] time 0.342 (0.339) data 0.262 (0.261) loss_u loss_u 0.9492 (0.9340) acc_u 6.2500 (7.1875) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [15/21] time 0.340 (0.341) data 0.261 (0.262) loss_u loss_u 0.9751 (0.9365) acc_u 3.1250 (6.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/21] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.9194 (0.9350) acc_u 9.3750 (7.0312) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 209
confident_label rate tensor(0.5803, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 947
clean true:927
clean false:20
clean_rate:0.9788806758183738
noisy true:496
noisy false:189
after delete: len(clean_dataset) 947
after delete: len(noisy_dataset) 685
epoch [159/200] batch [5/29] time 0.311 (0.319) data 0.232 (0.241) loss_x loss_x 0.1967 (0.2422) acc_x 93.7500 (95.0000) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [10/29] time 0.340 (0.320) data 0.262 (0.241) loss_x loss_x 0.2627 (0.2445) acc_x 93.7500 (94.6875) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [15/29] time 0.325 (0.326) data 0.247 (0.248) loss_x loss_x 0.3669 (0.2761) acc_x 84.3750 (93.5417) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [20/29] time 0.333 (0.330) data 0.254 (0.252) loss_x loss_x 0.2637 (0.2664) acc_x 90.6250 (93.7500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/29] time 0.343 (0.333) data 0.265 (0.255) loss_x loss_x 0.5054 (0.2837) acc_x 90.6250 (93.5000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [5/21] time 0.335 (0.335) data 0.256 (0.257) loss_u loss_u 0.9351 (0.9396) acc_u 6.2500 (5.6250) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [10/21] time 0.345 (0.335) data 0.267 (0.257) loss_u loss_u 0.9321 (0.9323) acc_u 6.2500 (6.8750) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [15/21] time 0.339 (0.336) data 0.261 (0.257) loss_u loss_u 0.8823 (0.9301) acc_u 12.5000 (7.9167) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/21] time 0.356 (0.337) data 0.278 (0.259) loss_u loss_u 0.9580 (0.9297) acc_u 3.1250 (7.8125) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.5686, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 928
clean true:911
clean false:17
clean_rate:0.9816810344827587
noisy true:487
noisy false:217
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 704
epoch [160/200] batch [5/29] time 0.307 (0.315) data 0.228 (0.236) loss_x loss_x 0.4060 (0.3358) acc_x 96.8750 (93.1250) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [10/29] time 0.343 (0.323) data 0.265 (0.245) loss_x loss_x 0.3608 (0.3161) acc_x 90.6250 (93.1250) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [15/29] time 0.331 (0.327) data 0.252 (0.249) loss_x loss_x 0.3113 (0.2872) acc_x 90.6250 (93.9583) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [20/29] time 0.348 (0.330) data 0.271 (0.252) loss_x loss_x 0.2163 (0.2707) acc_x 93.7500 (94.3750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/29] time 0.352 (0.334) data 0.274 (0.256) loss_x loss_x 0.4097 (0.2734) acc_x 90.6250 (94.1250) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [5/22] time 0.342 (0.335) data 0.263 (0.257) loss_u loss_u 0.9668 (0.9363) acc_u 3.1250 (7.5000) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [10/22] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.9531 (0.9327) acc_u 6.2500 (8.1250) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/22] time 0.330 (0.336) data 0.250 (0.257) loss_u loss_u 0.9316 (0.9308) acc_u 9.3750 (8.3333) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/22] time 0.346 (0.338) data 0.268 (0.260) loss_u loss_u 0.8779 (0.9158) acc_u 15.6250 (10.1562) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.5686, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 928
clean true:911
clean false:17
clean_rate:0.9816810344827587
noisy true:493
noisy false:211
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 704
epoch [161/200] batch [5/29] time 0.364 (0.323) data 0.285 (0.245) loss_x loss_x 0.1896 (0.2865) acc_x 93.7500 (92.5000) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [10/29] time 0.348 (0.337) data 0.270 (0.258) loss_x loss_x 0.2151 (0.2749) acc_x 93.7500 (92.8125) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [15/29] time 0.354 (0.342) data 0.276 (0.264) loss_x loss_x 0.2722 (0.2488) acc_x 93.7500 (94.1667) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [20/29] time 0.342 (0.342) data 0.263 (0.264) loss_x loss_x 0.2107 (0.2629) acc_x 96.8750 (93.2812) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [25/29] time 0.331 (0.343) data 0.253 (0.265) loss_x loss_x 0.1516 (0.2660) acc_x 100.0000 (93.3750) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [5/22] time 0.354 (0.343) data 0.275 (0.265) loss_u loss_u 0.8936 (0.9110) acc_u 12.5000 (10.0000) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [10/22] time 0.344 (0.344) data 0.264 (0.265) loss_u loss_u 0.9307 (0.9139) acc_u 6.2500 (9.6875) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/22] time 0.341 (0.343) data 0.263 (0.265) loss_u loss_u 0.8447 (0.9204) acc_u 18.7500 (9.3750) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/22] time 0.343 (0.344) data 0.266 (0.266) loss_u loss_u 0.9370 (0.9134) acc_u 6.2500 (10.1562) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.5723, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 934
clean true:915
clean false:19
clean_rate:0.9796573875802997
noisy true:480
noisy false:218
after delete: len(clean_dataset) 934
after delete: len(noisy_dataset) 698
epoch [162/200] batch [5/29] time 0.356 (0.343) data 0.277 (0.265) loss_x loss_x 0.2032 (0.3044) acc_x 96.8750 (91.8750) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [10/29] time 0.349 (0.345) data 0.271 (0.267) loss_x loss_x 0.5938 (0.3146) acc_x 84.3750 (91.2500) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [15/29] time 0.353 (0.343) data 0.275 (0.265) loss_x loss_x 0.1914 (0.3343) acc_x 93.7500 (91.6667) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [20/29] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.1998 (0.3093) acc_x 96.8750 (92.5000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [25/29] time 0.343 (0.343) data 0.265 (0.265) loss_x loss_x 0.4170 (0.3204) acc_x 90.6250 (92.0000) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [5/21] time 0.338 (0.340) data 0.259 (0.262) loss_u loss_u 0.9697 (0.9427) acc_u 6.2500 (8.1250) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [10/21] time 0.343 (0.341) data 0.264 (0.262) loss_u loss_u 0.9419 (0.9342) acc_u 6.2500 (8.4375) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [15/21] time 0.347 (0.341) data 0.268 (0.263) loss_u loss_u 0.9424 (0.9335) acc_u 9.3750 (7.9167) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/21] time 0.301 (0.339) data 0.222 (0.261) loss_u loss_u 0.9146 (0.9275) acc_u 12.5000 (8.5938) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 221
confident_label rate tensor(0.5748, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 938
clean true:920
clean false:18
clean_rate:0.9808102345415778
noisy true:491
noisy false:203
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 694
epoch [163/200] batch [5/29] time 0.299 (0.303) data 0.220 (0.225) loss_x loss_x 0.3601 (0.3727) acc_x 87.5000 (89.3750) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [10/29] time 0.340 (0.319) data 0.261 (0.240) loss_x loss_x 0.6343 (0.3569) acc_x 81.2500 (90.6250) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [15/29] time 0.344 (0.327) data 0.266 (0.249) loss_x loss_x 0.3723 (0.3679) acc_x 93.7500 (90.2083) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [20/29] time 0.346 (0.332) data 0.268 (0.254) loss_x loss_x 0.2798 (0.3721) acc_x 93.7500 (90.1562) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/29] time 0.344 (0.334) data 0.266 (0.256) loss_x loss_x 0.3660 (0.3611) acc_x 87.5000 (90.5000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [5/21] time 0.385 (0.337) data 0.307 (0.259) loss_u loss_u 0.8145 (0.8961) acc_u 21.8750 (11.8750) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [10/21] time 0.340 (0.339) data 0.262 (0.261) loss_u loss_u 0.8535 (0.9054) acc_u 18.7500 (11.5625) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [15/21] time 0.334 (0.339) data 0.253 (0.261) loss_u loss_u 0.8848 (0.9120) acc_u 15.6250 (10.8333) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/21] time 0.354 (0.340) data 0.276 (0.261) loss_u loss_u 0.9395 (0.9180) acc_u 6.2500 (9.8438) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 210
confident_label rate tensor(0.5692, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 929
clean true:912
clean false:17
clean_rate:0.9817007534983854
noisy true:510
noisy false:193
after delete: len(clean_dataset) 929
after delete: len(noisy_dataset) 703
epoch [164/200] batch [5/29] time 0.309 (0.311) data 0.231 (0.232) loss_x loss_x 0.3840 (0.2688) acc_x 93.7500 (94.3750) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [10/29] time 0.331 (0.324) data 0.253 (0.246) loss_x loss_x 0.5137 (0.3115) acc_x 90.6250 (92.8125) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [15/29] time 0.350 (0.330) data 0.272 (0.251) loss_x loss_x 0.2739 (0.3491) acc_x 93.7500 (92.5000) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [20/29] time 0.334 (0.335) data 0.257 (0.257) loss_x loss_x 0.3181 (0.3181) acc_x 93.7500 (93.1250) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [25/29] time 0.317 (0.337) data 0.238 (0.259) loss_x loss_x 0.1666 (0.3280) acc_x 96.8750 (92.8750) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [5/21] time 0.344 (0.337) data 0.265 (0.259) loss_u loss_u 0.8867 (0.9094) acc_u 15.6250 (10.6250) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [10/21] time 0.344 (0.337) data 0.266 (0.259) loss_u loss_u 0.8984 (0.9130) acc_u 15.6250 (10.0000) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/21] time 0.354 (0.338) data 0.276 (0.259) loss_u loss_u 0.8608 (0.9112) acc_u 15.6250 (10.2083) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/21] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.9692 (0.9083) acc_u 3.1250 (10.4688) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 211
confident_label rate tensor(0.5705, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 931
clean true:917
clean false:14
clean_rate:0.9849624060150376
noisy true:504
noisy false:197
after delete: len(clean_dataset) 931
after delete: len(noisy_dataset) 701
epoch [165/200] batch [5/29] time 0.336 (0.325) data 0.257 (0.247) loss_x loss_x 0.3789 (0.3125) acc_x 90.6250 (92.5000) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [10/29] time 0.355 (0.337) data 0.277 (0.258) loss_x loss_x 0.1871 (0.3073) acc_x 93.7500 (92.5000) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [15/29] time 0.354 (0.340) data 0.276 (0.262) loss_x loss_x 0.1110 (0.2794) acc_x 96.8750 (93.1250) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [20/29] time 0.341 (0.339) data 0.263 (0.261) loss_x loss_x 0.1235 (0.2911) acc_x 100.0000 (93.1250) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [25/29] time 0.329 (0.340) data 0.251 (0.262) loss_x loss_x 0.1544 (0.2748) acc_x 100.0000 (93.7500) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [5/21] time 0.345 (0.341) data 0.267 (0.262) loss_u loss_u 0.8833 (0.8700) acc_u 12.5000 (13.7500) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [10/21] time 0.349 (0.342) data 0.271 (0.264) loss_u loss_u 0.8887 (0.9071) acc_u 12.5000 (10.3125) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [15/21] time 0.327 (0.342) data 0.249 (0.264) loss_u loss_u 0.9038 (0.9120) acc_u 12.5000 (9.7917) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/21] time 0.330 (0.341) data 0.252 (0.263) loss_u loss_u 0.9683 (0.9183) acc_u 3.1250 (9.0625) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 215
confident_label rate tensor(0.5741, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 937
clean true:921
clean false:16
clean_rate:0.9829242262540021
noisy true:496
noisy false:199
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 695
epoch [166/200] batch [5/29] time 0.305 (0.328) data 0.226 (0.249) loss_x loss_x 0.5371 (0.3117) acc_x 87.5000 (93.1250) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [10/29] time 0.341 (0.334) data 0.264 (0.256) loss_x loss_x 0.1881 (0.2896) acc_x 93.7500 (94.0625) lr 1.5567e-04 eta 0:00:06
epoch [166/200] batch [15/29] time 0.351 (0.337) data 0.274 (0.259) loss_x loss_x 0.1335 (0.2707) acc_x 100.0000 (94.3750) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [20/29] time 0.348 (0.341) data 0.269 (0.263) loss_x loss_x 0.1742 (0.2859) acc_x 96.8750 (93.7500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [25/29] time 0.350 (0.341) data 0.272 (0.263) loss_x loss_x 0.3198 (0.2827) acc_x 90.6250 (93.8750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [5/21] time 0.333 (0.340) data 0.255 (0.262) loss_u loss_u 0.8672 (0.9125) acc_u 15.6250 (9.3750) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/21] time 0.356 (0.340) data 0.278 (0.262) loss_u loss_u 0.9600 (0.9106) acc_u 3.1250 (10.3125) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [15/21] time 0.345 (0.339) data 0.266 (0.261) loss_u loss_u 0.9360 (0.9160) acc_u 6.2500 (9.7917) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/21] time 0.332 (0.339) data 0.254 (0.260) loss_u loss_u 0.8462 (0.9214) acc_u 15.6250 (9.2188) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 211
confident_label rate tensor(0.5809, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 948
clean true:929
clean false:19
clean_rate:0.979957805907173
noisy true:492
noisy false:192
after delete: len(clean_dataset) 948
after delete: len(noisy_dataset) 684
epoch [167/200] batch [5/29] time 0.352 (0.348) data 0.273 (0.270) loss_x loss_x 0.2242 (0.2226) acc_x 96.8750 (96.2500) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [10/29] time 0.337 (0.348) data 0.260 (0.270) loss_x loss_x 0.3096 (0.2224) acc_x 93.7500 (95.0000) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [15/29] time 0.338 (0.346) data 0.260 (0.268) loss_x loss_x 0.1887 (0.2374) acc_x 93.7500 (94.7917) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [20/29] time 0.333 (0.344) data 0.256 (0.266) loss_x loss_x 0.2849 (0.2628) acc_x 93.7500 (94.0625) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [25/29] time 0.334 (0.342) data 0.256 (0.264) loss_x loss_x 0.2144 (0.2774) acc_x 96.8750 (93.6250) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [5/21] time 0.345 (0.344) data 0.267 (0.265) loss_u loss_u 0.9370 (0.8992) acc_u 6.2500 (10.0000) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [10/21] time 0.357 (0.344) data 0.278 (0.266) loss_u loss_u 0.9673 (0.9137) acc_u 3.1250 (9.0625) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/21] time 0.348 (0.344) data 0.270 (0.266) loss_u loss_u 0.9565 (0.9203) acc_u 3.1250 (8.3333) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/21] time 0.349 (0.344) data 0.270 (0.266) loss_u loss_u 0.9829 (0.9260) acc_u 3.1250 (7.6562) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 221
confident_label rate tensor(0.5723, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 934
clean true:913
clean false:21
clean_rate:0.9775160599571735
noisy true:498
noisy false:200
after delete: len(clean_dataset) 934
after delete: len(noisy_dataset) 698
epoch [168/200] batch [5/29] time 0.336 (0.324) data 0.257 (0.246) loss_x loss_x 0.3350 (0.4032) acc_x 90.6250 (93.1250) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [10/29] time 0.336 (0.320) data 0.258 (0.241) loss_x loss_x 0.2947 (0.3198) acc_x 96.8750 (94.3750) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [15/29] time 0.351 (0.329) data 0.273 (0.251) loss_x loss_x 0.2291 (0.3153) acc_x 93.7500 (93.7500) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [20/29] time 0.344 (0.333) data 0.265 (0.255) loss_x loss_x 0.2113 (0.3266) acc_x 93.7500 (93.2812) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [25/29] time 0.347 (0.335) data 0.268 (0.257) loss_x loss_x 0.3044 (0.3312) acc_x 93.7500 (93.0000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [5/21] time 0.355 (0.339) data 0.277 (0.261) loss_u loss_u 0.9092 (0.9283) acc_u 9.3750 (8.1250) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [10/21] time 0.354 (0.341) data 0.275 (0.262) loss_u loss_u 0.8984 (0.9172) acc_u 12.5000 (9.6875) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/21] time 0.329 (0.340) data 0.251 (0.262) loss_u loss_u 0.8613 (0.9158) acc_u 15.6250 (9.3750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/21] time 0.333 (0.339) data 0.255 (0.261) loss_u loss_u 0.9067 (0.9147) acc_u 12.5000 (9.5312) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.5760, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 940
clean true:925
clean false:15
clean_rate:0.9840425531914894
noisy true:482
noisy false:210
after delete: len(clean_dataset) 940
after delete: len(noisy_dataset) 692
epoch [169/200] batch [5/29] time 0.298 (0.326) data 0.220 (0.248) loss_x loss_x 0.4158 (0.2846) acc_x 87.5000 (95.0000) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [10/29] time 0.349 (0.335) data 0.271 (0.256) loss_x loss_x 0.2401 (0.2989) acc_x 96.8750 (94.3750) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [15/29] time 0.351 (0.339) data 0.273 (0.261) loss_x loss_x 0.1569 (0.2777) acc_x 96.8750 (94.5833) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [20/29] time 0.349 (0.342) data 0.271 (0.263) loss_x loss_x 0.2605 (0.2705) acc_x 90.6250 (94.0625) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [25/29] time 0.346 (0.342) data 0.268 (0.264) loss_x loss_x 0.1666 (0.2799) acc_x 93.7500 (93.6250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [5/21] time 0.328 (0.343) data 0.249 (0.264) loss_u loss_u 0.9141 (0.9284) acc_u 12.5000 (8.7500) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [10/21] time 0.339 (0.342) data 0.261 (0.264) loss_u loss_u 0.9512 (0.9145) acc_u 6.2500 (10.0000) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/21] time 0.350 (0.342) data 0.272 (0.263) loss_u loss_u 0.8823 (0.9155) acc_u 12.5000 (9.7917) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/21] time 0.333 (0.342) data 0.254 (0.263) loss_u loss_u 0.9644 (0.9166) acc_u 3.1250 (9.5312) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.5748, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 938
clean true:919
clean false:19
clean_rate:0.9797441364605544
noisy true:481
noisy false:213
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 694
epoch [170/200] batch [5/29] time 0.344 (0.340) data 0.266 (0.262) loss_x loss_x 0.3650 (0.4444) acc_x 90.6250 (88.7500) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [10/29] time 0.348 (0.343) data 0.270 (0.265) loss_x loss_x 0.3870 (0.3685) acc_x 93.7500 (90.9375) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [15/29] time 0.327 (0.345) data 0.249 (0.267) loss_x loss_x 0.3242 (0.3176) acc_x 96.8750 (92.7083) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [20/29] time 0.335 (0.343) data 0.257 (0.265) loss_x loss_x 0.2610 (0.3370) acc_x 90.6250 (92.6562) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [25/29] time 0.327 (0.342) data 0.249 (0.264) loss_x loss_x 0.3445 (0.3664) acc_x 90.6250 (91.7500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [5/21] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9824 (0.9192) acc_u 0.0000 (8.7500) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [10/21] time 0.333 (0.341) data 0.255 (0.263) loss_u loss_u 0.9097 (0.9138) acc_u 12.5000 (9.3750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/21] time 0.360 (0.341) data 0.281 (0.263) loss_u loss_u 0.9121 (0.9119) acc_u 9.3750 (9.5833) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/21] time 0.348 (0.340) data 0.270 (0.262) loss_u loss_u 0.9204 (0.9145) acc_u 12.5000 (9.3750) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 230
confident_label rate tensor(0.5723, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 934
clean true:915
clean false:19
clean_rate:0.9796573875802997
noisy true:487
noisy false:211
after delete: len(clean_dataset) 934
after delete: len(noisy_dataset) 698
epoch [171/200] batch [5/29] time 0.350 (0.349) data 0.272 (0.271) loss_x loss_x 0.3872 (0.2799) acc_x 90.6250 (93.7500) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [10/29] time 0.338 (0.348) data 0.259 (0.270) loss_x loss_x 0.2084 (0.2961) acc_x 93.7500 (93.4375) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [15/29] time 0.352 (0.349) data 0.274 (0.271) loss_x loss_x 0.2106 (0.2814) acc_x 96.8750 (93.9583) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [20/29] time 0.356 (0.349) data 0.278 (0.271) loss_x loss_x 0.2451 (0.2706) acc_x 96.8750 (94.5312) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [25/29] time 0.349 (0.349) data 0.271 (0.271) loss_x loss_x 0.2920 (0.2690) acc_x 93.7500 (94.1250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [5/21] time 0.352 (0.350) data 0.272 (0.272) loss_u loss_u 0.9351 (0.9167) acc_u 6.2500 (9.3750) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [10/21] time 0.357 (0.351) data 0.277 (0.273) loss_u loss_u 0.9980 (0.9194) acc_u 0.0000 (8.7500) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [15/21] time 0.307 (0.351) data 0.228 (0.272) loss_u loss_u 0.8862 (0.9172) acc_u 12.5000 (9.1667) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/21] time 0.362 (0.349) data 0.282 (0.270) loss_u loss_u 0.8848 (0.9133) acc_u 12.5000 (9.5312) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.5797, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 946
clean true:927
clean false:19
clean_rate:0.9799154334038055
noisy true:507
noisy false:179
after delete: len(clean_dataset) 946
after delete: len(noisy_dataset) 686
epoch [172/200] batch [5/29] time 0.337 (0.338) data 0.259 (0.259) loss_x loss_x 0.2024 (0.2064) acc_x 93.7500 (95.6250) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [10/29] time 0.345 (0.342) data 0.267 (0.264) loss_x loss_x 0.1747 (0.2603) acc_x 100.0000 (94.3750) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [15/29] time 0.338 (0.344) data 0.260 (0.265) loss_x loss_x 0.1726 (0.2747) acc_x 100.0000 (94.7917) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [20/29] time 0.351 (0.345) data 0.273 (0.267) loss_x loss_x 0.2900 (0.2908) acc_x 90.6250 (94.2188) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [25/29] time 0.343 (0.345) data 0.265 (0.267) loss_x loss_x 0.2421 (0.2901) acc_x 93.7500 (94.1250) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [5/21] time 0.339 (0.345) data 0.261 (0.267) loss_u loss_u 0.9316 (0.9263) acc_u 9.3750 (8.7500) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [10/21] time 0.351 (0.345) data 0.273 (0.267) loss_u loss_u 0.9038 (0.9148) acc_u 9.3750 (9.3750) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/21] time 0.338 (0.344) data 0.259 (0.266) loss_u loss_u 0.8467 (0.9192) acc_u 15.6250 (8.7500) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/21] time 0.303 (0.342) data 0.224 (0.264) loss_u loss_u 0.9292 (0.9226) acc_u 12.5000 (8.4375) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 223
confident_label rate tensor(0.5686, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 928
clean true:912
clean false:16
clean_rate:0.9827586206896551
noisy true:497
noisy false:207
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 704
epoch [173/200] batch [5/29] time 0.352 (0.354) data 0.273 (0.276) loss_x loss_x 0.1931 (0.2141) acc_x 100.0000 (96.2500) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [10/29] time 0.330 (0.350) data 0.252 (0.271) loss_x loss_x 0.5215 (0.2662) acc_x 84.3750 (93.4375) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [15/29] time 0.326 (0.345) data 0.248 (0.266) loss_x loss_x 0.4417 (0.2696) acc_x 90.6250 (93.7500) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [20/29] time 0.340 (0.345) data 0.262 (0.267) loss_x loss_x 0.5513 (0.3072) acc_x 84.3750 (92.8125) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [25/29] time 0.336 (0.344) data 0.258 (0.266) loss_x loss_x 0.3496 (0.3062) acc_x 93.7500 (93.0000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [5/22] time 0.338 (0.344) data 0.260 (0.266) loss_u loss_u 0.9609 (0.9373) acc_u 6.2500 (8.1250) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [10/22] time 0.334 (0.343) data 0.256 (0.265) loss_u loss_u 0.9214 (0.9387) acc_u 9.3750 (7.1875) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/22] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.9204 (0.9205) acc_u 6.2500 (9.1667) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/22] time 0.329 (0.342) data 0.251 (0.263) loss_u loss_u 0.9058 (0.9121) acc_u 12.5000 (10.1562) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.5662, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 924
clean true:904
clean false:20
clean_rate:0.9783549783549783
noisy true:479
noisy false:229
after delete: len(clean_dataset) 924
after delete: len(noisy_dataset) 708
epoch [174/200] batch [5/28] time 0.332 (0.349) data 0.253 (0.271) loss_x loss_x 0.2375 (0.3098) acc_x 93.7500 (92.5000) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [10/28] time 0.334 (0.346) data 0.255 (0.268) loss_x loss_x 0.1422 (0.3263) acc_x 96.8750 (92.5000) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [15/28] time 0.364 (0.344) data 0.286 (0.265) loss_x loss_x 0.2140 (0.3278) acc_x 96.8750 (92.2917) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [20/28] time 0.340 (0.344) data 0.261 (0.266) loss_x loss_x 0.3389 (0.3050) acc_x 90.6250 (92.9688) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/28] time 0.336 (0.342) data 0.259 (0.264) loss_x loss_x 0.4414 (0.2964) acc_x 87.5000 (93.1250) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [5/22] time 0.349 (0.343) data 0.271 (0.265) loss_u loss_u 0.9570 (0.8866) acc_u 3.1250 (12.5000) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [10/22] time 0.347 (0.343) data 0.268 (0.265) loss_u loss_u 0.9062 (0.8816) acc_u 9.3750 (13.1250) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/22] time 0.313 (0.342) data 0.234 (0.263) loss_u loss_u 0.8657 (0.8827) acc_u 12.5000 (13.1250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/22] time 0.341 (0.339) data 0.263 (0.261) loss_u loss_u 0.9419 (0.8864) acc_u 6.2500 (12.6562) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 200
confident_label rate tensor(0.5821, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 950
clean true:931
clean false:19
clean_rate:0.98
noisy true:501
noisy false:181
after delete: len(clean_dataset) 950
after delete: len(noisy_dataset) 682
epoch [175/200] batch [5/29] time 0.347 (0.330) data 0.269 (0.251) loss_x loss_x 0.2372 (0.2511) acc_x 96.8750 (96.2500) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [10/29] time 0.349 (0.334) data 0.271 (0.255) loss_x loss_x 0.2074 (0.2397) acc_x 96.8750 (95.9375) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [15/29] time 0.344 (0.338) data 0.267 (0.260) loss_x loss_x 0.3665 (0.2728) acc_x 84.3750 (93.7500) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [20/29] time 0.338 (0.340) data 0.260 (0.262) loss_x loss_x 0.3228 (0.2918) acc_x 90.6250 (92.8125) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [25/29] time 0.332 (0.339) data 0.255 (0.261) loss_x loss_x 0.3521 (0.2892) acc_x 87.5000 (92.7500) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [5/21] time 0.340 (0.338) data 0.262 (0.260) loss_u loss_u 0.9272 (0.9431) acc_u 9.3750 (7.5000) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [10/21] time 0.319 (0.338) data 0.240 (0.260) loss_u loss_u 0.9023 (0.9263) acc_u 12.5000 (9.0625) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [15/21] time 0.333 (0.337) data 0.254 (0.259) loss_u loss_u 0.9536 (0.9331) acc_u 6.2500 (7.9167) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/21] time 0.329 (0.338) data 0.250 (0.260) loss_u loss_u 0.9546 (0.9268) acc_u 3.1250 (8.7500) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 230
confident_label rate tensor(0.5674, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 926
clean true:910
clean false:16
clean_rate:0.9827213822894169
noisy true:492
noisy false:214
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 706
epoch [176/200] batch [5/28] time 0.367 (0.339) data 0.290 (0.261) loss_x loss_x 0.2559 (0.2321) acc_x 90.6250 (95.0000) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [10/28] time 0.348 (0.344) data 0.270 (0.266) loss_x loss_x 0.2778 (0.2354) acc_x 96.8750 (95.0000) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [15/28] time 0.355 (0.346) data 0.276 (0.267) loss_x loss_x 0.3608 (0.2469) acc_x 93.7500 (94.7917) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [20/28] time 0.350 (0.347) data 0.272 (0.269) loss_x loss_x 0.1823 (0.2568) acc_x 96.8750 (94.6875) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/28] time 0.349 (0.347) data 0.271 (0.269) loss_x loss_x 0.1455 (0.2509) acc_x 96.8750 (95.2500) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [5/22] time 0.347 (0.345) data 0.269 (0.267) loss_u loss_u 0.8857 (0.8572) acc_u 12.5000 (15.0000) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [10/22] time 0.323 (0.344) data 0.243 (0.266) loss_u loss_u 0.8833 (0.8912) acc_u 15.6250 (12.1875) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/22] time 0.342 (0.344) data 0.264 (0.266) loss_u loss_u 0.8677 (0.8952) acc_u 12.5000 (11.4583) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/22] time 0.346 (0.343) data 0.268 (0.265) loss_u loss_u 0.9683 (0.9021) acc_u 3.1250 (10.6250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.5784, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 944
clean true:928
clean false:16
clean_rate:0.9830508474576272
noisy true:497
noisy false:191
after delete: len(clean_dataset) 944
after delete: len(noisy_dataset) 688
epoch [177/200] batch [5/29] time 0.326 (0.341) data 0.248 (0.263) loss_x loss_x 0.2114 (0.1994) acc_x 93.7500 (96.8750) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [10/29] time 0.343 (0.340) data 0.265 (0.262) loss_x loss_x 0.2471 (0.2386) acc_x 93.7500 (95.6250) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [15/29] time 0.343 (0.340) data 0.265 (0.262) loss_x loss_x 0.1205 (0.2411) acc_x 100.0000 (95.2083) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [20/29] time 0.349 (0.341) data 0.271 (0.263) loss_x loss_x 0.2546 (0.2469) acc_x 96.8750 (95.4688) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [25/29] time 0.301 (0.339) data 0.224 (0.261) loss_x loss_x 0.2749 (0.2452) acc_x 90.6250 (95.1250) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [5/21] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.8887 (0.9125) acc_u 12.5000 (9.3750) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [10/21] time 0.347 (0.342) data 0.268 (0.264) loss_u loss_u 0.8882 (0.9174) acc_u 9.3750 (8.7500) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/21] time 0.350 (0.339) data 0.272 (0.261) loss_u loss_u 0.9150 (0.9223) acc_u 9.3750 (8.3333) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/21] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.8809 (0.9221) acc_u 12.5000 (8.2812) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.5705, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 931
clean true:914
clean false:17
clean_rate:0.9817400644468314
noisy true:506
noisy false:195
after delete: len(clean_dataset) 931
after delete: len(noisy_dataset) 701
epoch [178/200] batch [5/29] time 0.330 (0.326) data 0.252 (0.248) loss_x loss_x 0.4556 (0.2809) acc_x 90.6250 (93.7500) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [10/29] time 0.327 (0.334) data 0.248 (0.255) loss_x loss_x 0.3562 (0.2660) acc_x 90.6250 (94.3750) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [15/29] time 0.333 (0.337) data 0.255 (0.258) loss_x loss_x 0.1819 (0.2520) acc_x 96.8750 (94.7917) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [20/29] time 0.344 (0.338) data 0.266 (0.260) loss_x loss_x 0.2754 (0.2467) acc_x 93.7500 (95.0000) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [25/29] time 0.334 (0.339) data 0.255 (0.261) loss_x loss_x 0.1611 (0.2376) acc_x 96.8750 (95.1250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [5/21] time 0.331 (0.337) data 0.253 (0.259) loss_u loss_u 0.9575 (0.9038) acc_u 6.2500 (11.2500) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [10/21] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9282 (0.9077) acc_u 9.3750 (10.6250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/21] time 0.338 (0.336) data 0.259 (0.258) loss_u loss_u 0.9683 (0.9120) acc_u 3.1250 (10.2083) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/21] time 0.346 (0.337) data 0.268 (0.258) loss_u loss_u 0.8848 (0.9137) acc_u 12.5000 (9.6875) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 220
confident_label rate tensor(0.5711, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 932
clean true:916
clean false:16
clean_rate:0.9828326180257511
noisy true:496
noisy false:204
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 700
epoch [179/200] batch [5/29] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.5200 (0.3657) acc_x 87.5000 (90.6250) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [10/29] time 0.348 (0.343) data 0.269 (0.265) loss_x loss_x 0.3645 (0.3811) acc_x 90.6250 (90.3125) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [15/29] time 0.338 (0.348) data 0.260 (0.269) loss_x loss_x 0.5308 (0.3594) acc_x 84.3750 (91.0417) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [20/29] time 0.342 (0.347) data 0.264 (0.269) loss_x loss_x 0.2183 (0.3364) acc_x 93.7500 (91.8750) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [25/29] time 0.302 (0.344) data 0.224 (0.266) loss_x loss_x 0.2062 (0.3372) acc_x 100.0000 (91.8750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [5/21] time 0.339 (0.344) data 0.261 (0.266) loss_u loss_u 0.9414 (0.9083) acc_u 6.2500 (10.6250) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [10/21] time 0.344 (0.344) data 0.266 (0.266) loss_u loss_u 0.8906 (0.9065) acc_u 15.6250 (10.6250) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/21] time 0.422 (0.346) data 0.339 (0.267) loss_u loss_u 0.8867 (0.9101) acc_u 12.5000 (10.4167) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/21] time 0.395 (0.356) data 0.316 (0.277) loss_u loss_u 0.8940 (0.9088) acc_u 12.5000 (10.1562) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 223
confident_label rate tensor(0.5711, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 932
clean true:916
clean false:16
clean_rate:0.9828326180257511
noisy true:493
noisy false:207
after delete: len(clean_dataset) 932
after delete: len(noisy_dataset) 700
epoch [180/200] batch [5/29] time 0.340 (0.311) data 0.262 (0.232) loss_x loss_x 0.2629 (0.2317) acc_x 93.7500 (96.2500) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [10/29] time 0.338 (0.328) data 0.260 (0.250) loss_x loss_x 0.2384 (0.2583) acc_x 90.6250 (94.6875) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [15/29] time 0.321 (0.328) data 0.243 (0.250) loss_x loss_x 0.4734 (0.2791) acc_x 90.6250 (94.3750) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [20/29] time 0.299 (0.326) data 0.221 (0.248) loss_x loss_x 0.2971 (0.2944) acc_x 90.6250 (93.1250) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/29] time 0.334 (0.329) data 0.256 (0.251) loss_x loss_x 0.3560 (0.3036) acc_x 93.7500 (92.8750) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [5/21] time 0.368 (0.337) data 0.289 (0.259) loss_u loss_u 0.8975 (0.9282) acc_u 9.3750 (6.8750) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [10/21] time 0.349 (0.336) data 0.269 (0.257) loss_u loss_u 0.9590 (0.9129) acc_u 3.1250 (9.3750) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/21] time 0.429 (0.343) data 0.348 (0.265) loss_u loss_u 0.9287 (0.9157) acc_u 9.3750 (8.9583) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/21] time 0.405 (0.354) data 0.327 (0.275) loss_u loss_u 0.9248 (0.9169) acc_u 9.3750 (8.9062) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.5650, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 922
clean true:904
clean false:18
clean_rate:0.9804772234273319
noisy true:491
noisy false:219
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 710
epoch [181/200] batch [5/28] time 0.366 (0.357) data 0.288 (0.279) loss_x loss_x 0.1135 (0.1968) acc_x 100.0000 (98.1250) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [10/28] time 0.337 (0.351) data 0.259 (0.273) loss_x loss_x 0.2184 (0.2499) acc_x 93.7500 (95.9375) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [15/28] time 0.340 (0.349) data 0.262 (0.271) loss_x loss_x 0.2561 (0.2580) acc_x 87.5000 (94.7917) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [20/28] time 0.348 (0.349) data 0.270 (0.271) loss_x loss_x 0.2690 (0.2605) acc_x 93.7500 (94.3750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/28] time 0.334 (0.346) data 0.255 (0.268) loss_x loss_x 0.1936 (0.2564) acc_x 100.0000 (94.8750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [5/22] time 0.369 (0.347) data 0.291 (0.269) loss_u loss_u 0.8623 (0.9112) acc_u 15.6250 (10.6250) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [10/22] time 0.343 (0.347) data 0.264 (0.268) loss_u loss_u 0.9917 (0.9058) acc_u 3.1250 (11.2500) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/22] time 0.344 (0.346) data 0.266 (0.268) loss_u loss_u 0.9482 (0.9098) acc_u 6.2500 (10.6250) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/22] time 0.302 (0.344) data 0.223 (0.266) loss_u loss_u 0.9053 (0.8969) acc_u 12.5000 (11.8750) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.5735, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 936
clean true:918
clean false:18
clean_rate:0.9807692307692307
noisy true:485
noisy false:211
after delete: len(clean_dataset) 936
after delete: len(noisy_dataset) 696
epoch [182/200] batch [5/29] time 0.366 (0.348) data 0.287 (0.270) loss_x loss_x 0.1213 (0.2355) acc_x 100.0000 (95.6250) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [10/29] time 0.334 (0.348) data 0.257 (0.269) loss_x loss_x 0.4780 (0.2508) acc_x 87.5000 (94.6875) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [15/29] time 0.332 (0.346) data 0.255 (0.268) loss_x loss_x 0.3254 (0.2483) acc_x 90.6250 (94.3750) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [20/29] time 0.353 (0.347) data 0.273 (0.269) loss_x loss_x 0.1547 (0.2364) acc_x 96.8750 (94.6875) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [25/29] time 0.362 (0.350) data 0.282 (0.272) loss_x loss_x 0.2396 (0.2446) acc_x 96.8750 (94.2500) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [5/21] time 0.325 (0.346) data 0.246 (0.268) loss_u loss_u 0.9468 (0.9309) acc_u 6.2500 (6.8750) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [10/21] time 0.329 (0.345) data 0.250 (0.267) loss_u loss_u 0.9619 (0.9410) acc_u 3.1250 (5.9375) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/21] time 0.333 (0.344) data 0.254 (0.266) loss_u loss_u 0.9404 (0.9204) acc_u 6.2500 (8.1250) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/21] time 0.354 (0.344) data 0.276 (0.265) loss_u loss_u 0.8540 (0.9127) acc_u 15.6250 (9.2188) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 217
confident_label rate tensor(0.5741, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 937
clean true:923
clean false:14
clean_rate:0.9850586979722519
noisy true:492
noisy false:203
after delete: len(clean_dataset) 937
after delete: len(noisy_dataset) 695
epoch [183/200] batch [5/29] time 0.340 (0.334) data 0.262 (0.256) loss_x loss_x 0.1646 (0.2982) acc_x 93.7500 (90.6250) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [10/29] time 0.343 (0.336) data 0.265 (0.258) loss_x loss_x 0.3147 (0.2916) acc_x 93.7500 (92.5000) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [15/29] time 0.364 (0.337) data 0.286 (0.259) loss_x loss_x 0.2416 (0.3156) acc_x 93.7500 (92.0833) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [20/29] time 0.355 (0.337) data 0.277 (0.259) loss_x loss_x 0.3813 (0.3138) acc_x 93.7500 (92.5000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [25/29] time 0.344 (0.340) data 0.266 (0.262) loss_x loss_x 0.1700 (0.2981) acc_x 100.0000 (93.1250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [5/21] time 0.345 (0.342) data 0.266 (0.263) loss_u loss_u 0.9355 (0.8969) acc_u 6.2500 (11.2500) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [10/21] time 0.378 (0.343) data 0.299 (0.265) loss_u loss_u 0.9746 (0.9126) acc_u 3.1250 (10.0000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/21] time 0.345 (0.344) data 0.266 (0.266) loss_u loss_u 0.9365 (0.9128) acc_u 9.3750 (10.4167) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/21] time 0.353 (0.343) data 0.275 (0.265) loss_u loss_u 0.8945 (0.9197) acc_u 12.5000 (9.3750) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 193
confident_label rate tensor(0.5803, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 947
clean true:930
clean false:17
clean_rate:0.9820485744456178
noisy true:509
noisy false:176
after delete: len(clean_dataset) 947
after delete: len(noisy_dataset) 685
epoch [184/200] batch [5/29] time 0.353 (0.336) data 0.275 (0.257) loss_x loss_x 0.4060 (0.3290) acc_x 90.6250 (94.3750) lr 3.9706e-05 eta 0:00:08
epoch [184/200] batch [10/29] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.4189 (0.2968) acc_x 87.5000 (94.0625) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [15/29] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.4775 (0.3280) acc_x 90.6250 (93.3333) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [20/29] time 0.333 (0.345) data 0.255 (0.266) loss_x loss_x 0.3660 (0.3157) acc_x 93.7500 (93.1250) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [25/29] time 0.347 (0.343) data 0.268 (0.265) loss_x loss_x 0.3203 (0.3064) acc_x 90.6250 (93.2500) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [5/21] time 0.342 (0.340) data 0.263 (0.262) loss_u loss_u 0.8838 (0.9460) acc_u 12.5000 (5.6250) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [10/21] time 0.335 (0.340) data 0.257 (0.262) loss_u loss_u 0.9243 (0.9282) acc_u 9.3750 (8.1250) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/21] time 0.337 (0.340) data 0.259 (0.262) loss_u loss_u 0.9580 (0.9353) acc_u 3.1250 (7.0833) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/21] time 0.355 (0.340) data 0.276 (0.262) loss_u loss_u 0.9404 (0.9363) acc_u 6.2500 (7.1875) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.5760, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 940
clean true:923
clean false:17
clean_rate:0.9819148936170212
noisy true:502
noisy false:190
after delete: len(clean_dataset) 940
after delete: len(noisy_dataset) 692
epoch [185/200] batch [5/29] time 0.354 (0.342) data 0.276 (0.264) loss_x loss_x 0.3748 (0.3587) acc_x 93.7500 (91.8750) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [10/29] time 0.325 (0.337) data 0.246 (0.259) loss_x loss_x 0.2090 (0.3266) acc_x 96.8750 (92.1875) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [15/29] time 0.339 (0.339) data 0.261 (0.261) loss_x loss_x 0.1741 (0.3233) acc_x 96.8750 (92.7083) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [20/29] time 0.349 (0.339) data 0.271 (0.260) loss_x loss_x 0.2539 (0.3316) acc_x 93.7500 (92.3438) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [25/29] time 0.328 (0.339) data 0.250 (0.261) loss_x loss_x 0.2883 (0.3321) acc_x 93.7500 (92.3750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [5/21] time 0.338 (0.335) data 0.260 (0.257) loss_u loss_u 0.8960 (0.9170) acc_u 15.6250 (10.6250) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [10/21] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9766 (0.9157) acc_u 3.1250 (10.3125) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/21] time 0.360 (0.337) data 0.281 (0.259) loss_u loss_u 0.9390 (0.9146) acc_u 6.2500 (10.2083) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/21] time 0.293 (0.337) data 0.215 (0.258) loss_u loss_u 0.9644 (0.9157) acc_u 3.1250 (9.8438) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.5674, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 926
clean true:908
clean false:18
clean_rate:0.980561555075594
noisy true:500
noisy false:206
after delete: len(clean_dataset) 926
after delete: len(noisy_dataset) 706
epoch [186/200] batch [5/28] time 0.345 (0.345) data 0.268 (0.267) loss_x loss_x 0.2457 (0.2915) acc_x 93.7500 (91.8750) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [10/28] time 0.337 (0.341) data 0.259 (0.263) loss_x loss_x 0.3020 (0.2969) acc_x 96.8750 (92.8125) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [15/28] time 0.336 (0.342) data 0.258 (0.263) loss_x loss_x 0.3523 (0.3022) acc_x 87.5000 (92.2917) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [20/28] time 0.347 (0.342) data 0.269 (0.264) loss_x loss_x 0.2839 (0.2944) acc_x 96.8750 (92.5000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/28] time 0.323 (0.342) data 0.244 (0.264) loss_x loss_x 0.2251 (0.2821) acc_x 93.7500 (92.8750) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [5/22] time 0.349 (0.341) data 0.270 (0.262) loss_u loss_u 0.9800 (0.9016) acc_u 3.1250 (10.6250) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [10/22] time 0.333 (0.341) data 0.255 (0.262) loss_u loss_u 0.8975 (0.9115) acc_u 12.5000 (10.0000) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/22] time 0.354 (0.340) data 0.276 (0.262) loss_u loss_u 0.9712 (0.9106) acc_u 3.1250 (10.0000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/22] time 0.346 (0.339) data 0.268 (0.261) loss_u loss_u 0.9146 (0.9085) acc_u 9.3750 (10.1562) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.5772, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 942
clean true:924
clean false:18
clean_rate:0.9808917197452229
noisy true:496
noisy false:194
after delete: len(clean_dataset) 942
after delete: len(noisy_dataset) 690
epoch [187/200] batch [5/29] time 0.308 (0.314) data 0.229 (0.235) loss_x loss_x 0.1915 (0.2678) acc_x 96.8750 (95.0000) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [10/29] time 0.346 (0.319) data 0.268 (0.240) loss_x loss_x 0.2240 (0.2348) acc_x 93.7500 (94.6875) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [15/29] time 0.324 (0.323) data 0.245 (0.244) loss_x loss_x 0.1781 (0.2501) acc_x 96.8750 (93.7500) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [20/29] time 0.344 (0.330) data 0.266 (0.251) loss_x loss_x 0.2827 (0.2604) acc_x 93.7500 (93.7500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/29] time 0.342 (0.332) data 0.264 (0.254) loss_x loss_x 0.3625 (0.2820) acc_x 90.6250 (92.7500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [5/21] time 0.344 (0.336) data 0.264 (0.257) loss_u loss_u 0.8877 (0.9058) acc_u 12.5000 (10.6250) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [10/21] time 0.346 (0.338) data 0.267 (0.259) loss_u loss_u 0.9102 (0.9147) acc_u 12.5000 (10.0000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/21] time 0.338 (0.337) data 0.260 (0.259) loss_u loss_u 0.8809 (0.9117) acc_u 12.5000 (10.0000) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/21] time 0.329 (0.337) data 0.251 (0.259) loss_u loss_u 0.9492 (0.9158) acc_u 6.2500 (9.6875) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.5754, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 939
clean true:921
clean false:18
clean_rate:0.9808306709265175
noisy true:498
noisy false:195
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 693
epoch [188/200] batch [5/29] time 0.294 (0.319) data 0.216 (0.241) loss_x loss_x 0.2185 (0.2377) acc_x 90.6250 (93.7500) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [10/29] time 0.309 (0.310) data 0.230 (0.231) loss_x loss_x 0.3391 (0.2472) acc_x 90.6250 (94.3750) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [15/29] time 0.348 (0.319) data 0.270 (0.241) loss_x loss_x 0.2162 (0.2788) acc_x 96.8750 (93.9583) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [20/29] time 0.332 (0.325) data 0.252 (0.246) loss_x loss_x 0.1730 (0.2946) acc_x 96.8750 (93.4375) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/29] time 0.339 (0.327) data 0.261 (0.249) loss_x loss_x 0.2098 (0.2882) acc_x 93.7500 (93.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [5/21] time 0.344 (0.329) data 0.265 (0.251) loss_u loss_u 0.9341 (0.9179) acc_u 9.3750 (8.7500) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/21] time 0.338 (0.330) data 0.259 (0.252) loss_u loss_u 0.9990 (0.9302) acc_u 0.0000 (7.5000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/21] time 0.336 (0.330) data 0.257 (0.252) loss_u loss_u 0.8784 (0.9199) acc_u 12.5000 (8.7500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/21] time 0.323 (0.330) data 0.245 (0.252) loss_u loss_u 0.8745 (0.9126) acc_u 12.5000 (9.5312) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.5748, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 938
clean true:917
clean false:21
clean_rate:0.9776119402985075
noisy true:490
noisy false:204
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 694
epoch [189/200] batch [5/29] time 0.346 (0.347) data 0.268 (0.269) loss_x loss_x 0.3979 (0.2577) acc_x 90.6250 (95.6250) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [10/29] time 0.303 (0.332) data 0.224 (0.254) loss_x loss_x 0.3350 (0.2521) acc_x 93.7500 (95.3125) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [15/29] time 0.348 (0.325) data 0.270 (0.247) loss_x loss_x 0.3425 (0.3032) acc_x 90.6250 (92.9167) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [20/29] time 0.355 (0.330) data 0.276 (0.252) loss_x loss_x 0.3315 (0.3118) acc_x 87.5000 (92.1875) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/29] time 0.345 (0.332) data 0.267 (0.253) loss_x loss_x 0.3018 (0.3015) acc_x 93.7500 (93.1250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [5/21] time 0.339 (0.333) data 0.261 (0.255) loss_u loss_u 0.8735 (0.9066) acc_u 15.6250 (10.6250) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [10/21] time 0.349 (0.335) data 0.270 (0.256) loss_u loss_u 0.9604 (0.9171) acc_u 3.1250 (9.3750) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/21] time 0.345 (0.336) data 0.267 (0.257) loss_u loss_u 0.9629 (0.9145) acc_u 3.1250 (10.0000) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/21] time 0.356 (0.337) data 0.278 (0.258) loss_u loss_u 0.9980 (0.9200) acc_u 0.0000 (9.0625) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 215
confident_label rate tensor(0.5790, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 945
clean true:924
clean false:21
clean_rate:0.9777777777777777
noisy true:493
noisy false:194
after delete: len(clean_dataset) 945
after delete: len(noisy_dataset) 687
epoch [190/200] batch [5/29] time 0.310 (0.337) data 0.232 (0.259) loss_x loss_x 0.2603 (0.2326) acc_x 93.7500 (96.2500) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [10/29] time 0.336 (0.327) data 0.258 (0.248) loss_x loss_x 0.3306 (0.2686) acc_x 93.7500 (94.3750) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [15/29] time 0.343 (0.329) data 0.265 (0.250) loss_x loss_x 0.1525 (0.2547) acc_x 100.0000 (95.2083) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [20/29] time 0.346 (0.332) data 0.268 (0.254) loss_x loss_x 0.7773 (0.2942) acc_x 84.3750 (93.9062) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/29] time 0.343 (0.334) data 0.265 (0.255) loss_x loss_x 0.1412 (0.2774) acc_x 100.0000 (94.3750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [5/21] time 0.337 (0.335) data 0.258 (0.256) loss_u loss_u 0.8862 (0.9064) acc_u 12.5000 (9.3750) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [10/21] time 0.338 (0.334) data 0.259 (0.256) loss_u loss_u 0.9429 (0.9267) acc_u 6.2500 (7.1875) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/21] time 0.334 (0.335) data 0.256 (0.257) loss_u loss_u 0.9268 (0.9231) acc_u 6.2500 (7.9167) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/21] time 0.354 (0.337) data 0.276 (0.259) loss_u loss_u 0.9658 (0.9211) acc_u 3.1250 (8.2812) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5680, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 927
clean true:912
clean false:15
clean_rate:0.9838187702265372
noisy true:502
noisy false:203
after delete: len(clean_dataset) 927
after delete: len(noisy_dataset) 705
epoch [191/200] batch [5/28] time 0.346 (0.343) data 0.269 (0.265) loss_x loss_x 0.2419 (0.2940) acc_x 93.7500 (91.8750) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [10/28] time 0.317 (0.332) data 0.238 (0.254) loss_x loss_x 0.2583 (0.2892) acc_x 93.7500 (92.8125) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [15/28] time 0.348 (0.329) data 0.271 (0.251) loss_x loss_x 0.0865 (0.2883) acc_x 100.0000 (92.7083) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [20/28] time 0.329 (0.333) data 0.251 (0.255) loss_x loss_x 0.4019 (0.2786) acc_x 90.6250 (93.1250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/28] time 0.332 (0.334) data 0.253 (0.256) loss_x loss_x 0.3154 (0.2675) acc_x 93.7500 (94.0000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [5/22] time 0.351 (0.336) data 0.273 (0.257) loss_u loss_u 0.8838 (0.8979) acc_u 12.5000 (11.8750) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [10/22] time 0.319 (0.335) data 0.240 (0.257) loss_u loss_u 0.8877 (0.8977) acc_u 12.5000 (11.8750) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/22] time 0.343 (0.334) data 0.263 (0.256) loss_u loss_u 0.7998 (0.9007) acc_u 21.8750 (11.4583) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/22] time 0.378 (0.336) data 0.299 (0.258) loss_u loss_u 0.9287 (0.9050) acc_u 6.2500 (10.6250) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.5839, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 953
clean true:938
clean false:15
clean_rate:0.9842602308499475
noisy true:502
noisy false:177
after delete: len(clean_dataset) 953
after delete: len(noisy_dataset) 679
epoch [192/200] batch [5/29] time 0.290 (0.312) data 0.211 (0.234) loss_x loss_x 0.4758 (0.3256) acc_x 93.7500 (93.1250) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [10/29] time 0.342 (0.319) data 0.264 (0.241) loss_x loss_x 0.5103 (0.3101) acc_x 87.5000 (92.1875) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [15/29] time 0.320 (0.326) data 0.242 (0.248) loss_x loss_x 0.2932 (0.2927) acc_x 93.7500 (93.1250) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [20/29] time 0.329 (0.330) data 0.251 (0.252) loss_x loss_x 0.3005 (0.2854) acc_x 93.7500 (93.7500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/29] time 0.342 (0.333) data 0.264 (0.255) loss_x loss_x 0.4631 (0.2877) acc_x 90.6250 (93.5000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [5/21] time 0.333 (0.335) data 0.254 (0.257) loss_u loss_u 0.9453 (0.9343) acc_u 3.1250 (6.8750) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [10/21] time 0.330 (0.334) data 0.252 (0.256) loss_u loss_u 0.9380 (0.9208) acc_u 6.2500 (8.4375) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/21] time 0.325 (0.333) data 0.247 (0.255) loss_u loss_u 0.9673 (0.9229) acc_u 3.1250 (8.3333) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/21] time 0.347 (0.335) data 0.269 (0.256) loss_u loss_u 0.8848 (0.9255) acc_u 12.5000 (7.9688) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 216
confident_label rate tensor(0.5760, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 940
clean true:923
clean false:17
clean_rate:0.9819148936170212
noisy true:493
noisy false:199
after delete: len(clean_dataset) 940
after delete: len(noisy_dataset) 692
epoch [193/200] batch [5/29] time 0.308 (0.333) data 0.230 (0.255) loss_x loss_x 0.6118 (0.3349) acc_x 84.3750 (92.5000) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [10/29] time 0.349 (0.328) data 0.271 (0.250) loss_x loss_x 0.3291 (0.3150) acc_x 93.7500 (93.7500) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [15/29] time 0.324 (0.332) data 0.245 (0.254) loss_x loss_x 0.4468 (0.2928) acc_x 84.3750 (93.3333) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [20/29] time 0.340 (0.335) data 0.262 (0.257) loss_x loss_x 0.2542 (0.2616) acc_x 93.7500 (94.6875) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [25/29] time 0.345 (0.336) data 0.266 (0.258) loss_x loss_x 0.2184 (0.2589) acc_x 93.7500 (94.6250) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [5/21] time 0.335 (0.336) data 0.257 (0.258) loss_u loss_u 0.9390 (0.8857) acc_u 6.2500 (12.5000) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [10/21] time 0.299 (0.335) data 0.219 (0.257) loss_u loss_u 0.8711 (0.8967) acc_u 15.6250 (11.2500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/21] time 0.332 (0.336) data 0.253 (0.258) loss_u loss_u 0.9614 (0.9072) acc_u 3.1250 (10.0000) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/21] time 0.339 (0.337) data 0.260 (0.258) loss_u loss_u 0.9185 (0.9114) acc_u 9.3750 (9.6875) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 218
confident_label rate tensor(0.5748, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 938
clean true:921
clean false:17
clean_rate:0.9818763326226013
noisy true:493
noisy false:201
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 694
epoch [194/200] batch [5/29] time 0.298 (0.339) data 0.219 (0.260) loss_x loss_x 0.3203 (0.2619) acc_x 90.6250 (94.3750) lr 7.8853e-06 eta 0:00:08
epoch [194/200] batch [10/29] time 0.304 (0.320) data 0.225 (0.241) loss_x loss_x 0.4424 (0.2837) acc_x 87.5000 (93.7500) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [15/29] time 0.349 (0.325) data 0.271 (0.246) loss_x loss_x 0.3167 (0.2994) acc_x 93.7500 (92.9167) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [20/29] time 0.347 (0.327) data 0.269 (0.249) loss_x loss_x 0.1881 (0.2930) acc_x 93.7500 (93.2812) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/29] time 0.329 (0.328) data 0.251 (0.250) loss_x loss_x 0.1774 (0.2954) acc_x 96.8750 (93.2500) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [5/21] time 0.298 (0.326) data 0.220 (0.248) loss_u loss_u 0.9277 (0.9320) acc_u 9.3750 (8.7500) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [10/21] time 0.325 (0.323) data 0.247 (0.245) loss_u loss_u 0.9224 (0.9458) acc_u 12.5000 (7.1875) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/21] time 0.331 (0.326) data 0.253 (0.248) loss_u loss_u 0.8032 (0.9195) acc_u 21.8750 (10.0000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/21] time 0.328 (0.327) data 0.250 (0.249) loss_u loss_u 0.9297 (0.9147) acc_u 6.2500 (9.8438) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.5729, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 935
clean true:915
clean false:20
clean_rate:0.9786096256684492
noisy true:484
noisy false:213
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 697
epoch [195/200] batch [5/29] time 0.340 (0.356) data 0.262 (0.278) loss_x loss_x 0.3557 (0.3297) acc_x 90.6250 (93.1250) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [10/29] time 0.314 (0.337) data 0.235 (0.259) loss_x loss_x 0.3044 (0.3930) acc_x 90.6250 (91.2500) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [15/29] time 0.343 (0.332) data 0.265 (0.254) loss_x loss_x 0.4404 (0.3745) acc_x 90.6250 (92.0833) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [20/29] time 0.323 (0.334) data 0.245 (0.255) loss_x loss_x 0.3372 (0.3515) acc_x 93.7500 (91.8750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [25/29] time 0.374 (0.336) data 0.294 (0.258) loss_x loss_x 0.5142 (0.3507) acc_x 84.3750 (91.8750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [5/21] time 0.351 (0.341) data 0.272 (0.263) loss_u loss_u 0.9946 (0.9018) acc_u 0.0000 (11.2500) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/21] time 0.339 (0.342) data 0.261 (0.264) loss_u loss_u 0.9434 (0.9075) acc_u 6.2500 (10.0000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/21] time 0.334 (0.342) data 0.256 (0.263) loss_u loss_u 0.8804 (0.9091) acc_u 12.5000 (10.2083) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/21] time 0.339 (0.342) data 0.261 (0.263) loss_u loss_u 0.9624 (0.9133) acc_u 6.2500 (9.8438) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.5803, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 947
clean true:929
clean false:18
clean_rate:0.9809926082365364
noisy true:489
noisy false:196
after delete: len(clean_dataset) 947
after delete: len(noisy_dataset) 685
epoch [196/200] batch [5/29] time 0.344 (0.345) data 0.267 (0.267) loss_x loss_x 0.3230 (0.2901) acc_x 87.5000 (92.5000) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [10/29] time 0.315 (0.328) data 0.237 (0.250) loss_x loss_x 0.3521 (0.2870) acc_x 93.7500 (93.4375) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [15/29] time 0.345 (0.335) data 0.267 (0.257) loss_x loss_x 0.2405 (0.2595) acc_x 96.8750 (94.1667) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [20/29] time 0.370 (0.341) data 0.292 (0.262) loss_x loss_x 0.2400 (0.2644) acc_x 96.8750 (94.2188) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [25/29] time 0.295 (0.337) data 0.218 (0.258) loss_x loss_x 0.4248 (0.2718) acc_x 87.5000 (94.0000) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [5/21] time 0.355 (0.337) data 0.277 (0.259) loss_u loss_u 0.9360 (0.9330) acc_u 6.2500 (8.1250) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [10/21] time 0.326 (0.337) data 0.247 (0.259) loss_u loss_u 0.8760 (0.9193) acc_u 12.5000 (9.0625) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/21] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9614 (0.9243) acc_u 3.1250 (8.3333) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/21] time 0.345 (0.337) data 0.266 (0.259) loss_u loss_u 0.9624 (0.9250) acc_u 3.1250 (8.2812) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.5717, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 933
clean true:917
clean false:16
clean_rate:0.9828510182207931
noisy true:487
noisy false:212
after delete: len(clean_dataset) 933
after delete: len(noisy_dataset) 699
epoch [197/200] batch [5/29] time 0.349 (0.351) data 0.271 (0.273) loss_x loss_x 0.1421 (0.2393) acc_x 100.0000 (94.3750) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [10/29] time 0.374 (0.341) data 0.295 (0.263) loss_x loss_x 0.3115 (0.2665) acc_x 90.6250 (94.0625) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [15/29] time 0.345 (0.345) data 0.267 (0.267) loss_x loss_x 0.4275 (0.2733) acc_x 90.6250 (93.7500) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [20/29] time 0.338 (0.345) data 0.259 (0.267) loss_x loss_x 0.3760 (0.2843) acc_x 87.5000 (93.1250) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [25/29] time 0.359 (0.346) data 0.282 (0.268) loss_x loss_x 0.1311 (0.2757) acc_x 100.0000 (93.8750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [5/21] time 0.348 (0.345) data 0.269 (0.267) loss_u loss_u 0.9463 (0.8867) acc_u 3.1250 (11.2500) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/21] time 0.327 (0.344) data 0.248 (0.266) loss_u loss_u 0.8760 (0.9021) acc_u 15.6250 (10.0000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/21] time 0.344 (0.345) data 0.266 (0.266) loss_u loss_u 0.9082 (0.9058) acc_u 9.3750 (9.5833) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/21] time 0.344 (0.344) data 0.266 (0.266) loss_u loss_u 0.8989 (0.9056) acc_u 12.5000 (10.0000) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.5772, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 942
clean true:924
clean false:18
clean_rate:0.9808917197452229
noisy true:501
noisy false:189
after delete: len(clean_dataset) 942
after delete: len(noisy_dataset) 690
epoch [198/200] batch [5/29] time 0.308 (0.333) data 0.229 (0.255) loss_x loss_x 0.4001 (0.2743) acc_x 93.7500 (94.3750) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [10/29] time 0.350 (0.326) data 0.272 (0.248) loss_x loss_x 0.2791 (0.2540) acc_x 93.7500 (95.3125) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [15/29] time 0.338 (0.332) data 0.260 (0.254) loss_x loss_x 0.1335 (0.2424) acc_x 96.8750 (95.4167) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [20/29] time 0.342 (0.336) data 0.264 (0.258) loss_x loss_x 0.3860 (0.2573) acc_x 84.3750 (94.5312) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [25/29] time 0.335 (0.338) data 0.257 (0.260) loss_x loss_x 0.2605 (0.2703) acc_x 93.7500 (94.3750) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [5/21] time 0.333 (0.337) data 0.255 (0.259) loss_u loss_u 0.9199 (0.9254) acc_u 9.3750 (10.0000) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [10/21] time 0.345 (0.337) data 0.266 (0.259) loss_u loss_u 0.9585 (0.9121) acc_u 3.1250 (10.3125) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/21] time 0.339 (0.338) data 0.261 (0.259) loss_u loss_u 0.8711 (0.9182) acc_u 12.5000 (9.3750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/21] time 0.341 (0.338) data 0.262 (0.260) loss_u loss_u 0.9717 (0.9192) acc_u 0.0000 (8.9062) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.5760, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 940
clean true:922
clean false:18
clean_rate:0.9808510638297873
noisy true:497
noisy false:195
after delete: len(clean_dataset) 940
after delete: len(noisy_dataset) 692
epoch [199/200] batch [5/29] time 0.317 (0.345) data 0.238 (0.266) loss_x loss_x 0.3230 (0.3218) acc_x 93.7500 (91.8750) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [10/29] time 0.341 (0.337) data 0.258 (0.257) loss_x loss_x 0.6880 (0.3448) acc_x 84.3750 (90.9375) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [15/29] time 0.340 (0.339) data 0.261 (0.260) loss_x loss_x 0.5264 (0.3129) acc_x 90.6250 (92.9167) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [20/29] time 0.312 (0.336) data 0.234 (0.257) loss_x loss_x 0.2155 (0.2961) acc_x 96.8750 (93.4375) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [25/29] time 0.338 (0.337) data 0.260 (0.258) loss_x loss_x 0.3433 (0.3036) acc_x 93.7500 (93.6250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [5/21] time 0.327 (0.337) data 0.249 (0.258) loss_u loss_u 0.9478 (0.9159) acc_u 6.2500 (8.7500) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [10/21] time 0.350 (0.337) data 0.271 (0.258) loss_u loss_u 0.8711 (0.9199) acc_u 15.6250 (8.7500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/21] time 0.334 (0.338) data 0.255 (0.259) loss_u loss_u 0.9360 (0.9194) acc_u 6.2500 (8.7500) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/21] time 0.347 (0.337) data 0.269 (0.259) loss_u loss_u 0.9043 (0.9214) acc_u 9.3750 (8.7500) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.5803, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 947
clean true:928
clean false:19
clean_rate:0.9799366420274551
noisy true:498
noisy false:187
after delete: len(clean_dataset) 947
after delete: len(noisy_dataset) 685
epoch [200/200] batch [5/29] time 0.294 (0.296) data 0.217 (0.217) loss_x loss_x 0.0916 (0.3022) acc_x 100.0000 (93.1250) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [10/29] time 0.296 (0.297) data 0.219 (0.218) loss_x loss_x 0.3586 (0.2968) acc_x 87.5000 (92.1875) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [15/29] time 0.293 (0.297) data 0.214 (0.219) loss_x loss_x 0.4648 (0.3085) acc_x 90.6250 (91.4583) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [20/29] time 0.305 (0.297) data 0.227 (0.219) loss_x loss_x 0.1434 (0.3047) acc_x 96.8750 (91.8750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/29] time 0.307 (0.298) data 0.229 (0.219) loss_x loss_x 0.2686 (0.3083) acc_x 96.8750 (91.8750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [5/21] time 0.306 (0.300) data 0.227 (0.222) loss_u loss_u 0.8511 (0.9289) acc_u 15.6250 (7.5000) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/21] time 0.299 (0.300) data 0.220 (0.222) loss_u loss_u 0.9297 (0.9145) acc_u 9.3750 (9.6875) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/21] time 0.339 (0.307) data 0.258 (0.228) loss_u loss_u 0.9067 (0.9215) acc_u 9.3750 (8.7500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/21] time 0.302 (0.308) data 0.223 (0.229) loss_u loss_u 0.9102 (0.9250) acc_u 12.5000 (8.5938) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,178
* accuracy: 88.4%
* error: 11.6%
* macro_f1: 88.6%
Elapsed: 2:02:35
