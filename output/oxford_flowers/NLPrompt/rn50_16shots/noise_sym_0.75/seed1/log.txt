***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '102']
output_dir: output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.0674, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 110
clean true:96
clean false:14
clean_rate:0.8727272727272727
noisy true:279
noisy false:1243
after delete: len(clean_dataset) 110
after delete: len(noisy_dataset) 1522
epoch [1/200] batch [1/3] time 0.418 (0.418) data 0.251 (0.251) loss_x loss_x 2.5664 (2.5664) acc_x 56.2500 (56.2500) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/3] time 0.332 (0.375) data 0.254 (0.252) loss_x loss_x 2.9277 (2.7471) acc_x 31.2500 (43.7500) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [3/3] time 0.337 (0.362) data 0.259 (0.255) loss_x loss_x 2.8477 (2.7806) acc_x 31.2500 (39.5833) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/47] time 0.338 (0.348) data 0.260 (0.257) loss_u loss_u 0.9927 (0.9899) acc_u 0.0000 (1.2500) lr 1.0000e-05 eta 0:00:14
epoch [1/200] batch [10/47] time 0.293 (0.337) data 0.216 (0.251) loss_u loss_u 0.9932 (0.9876) acc_u 0.0000 (2.1875) lr 1.0000e-05 eta 0:00:12
epoch [1/200] batch [15/47] time 0.337 (0.332) data 0.260 (0.249) loss_u loss_u 0.9878 (0.9871) acc_u 3.1250 (2.0833) lr 1.0000e-05 eta 0:00:10
epoch [1/200] batch [20/47] time 0.326 (0.332) data 0.249 (0.250) loss_u loss_u 0.9883 (0.9876) acc_u 3.1250 (2.0312) lr 1.0000e-05 eta 0:00:08
epoch [1/200] batch [25/47] time 0.322 (0.333) data 0.244 (0.251) loss_u loss_u 0.9912 (0.9869) acc_u 0.0000 (2.2500) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [30/47] time 0.350 (0.334) data 0.273 (0.253) loss_u loss_u 0.9844 (0.9874) acc_u 3.1250 (2.1875) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [35/47] time 0.337 (0.334) data 0.260 (0.254) loss_u loss_u 0.9819 (0.9871) acc_u 3.1250 (2.2321) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [40/47] time 0.336 (0.335) data 0.258 (0.255) loss_u loss_u 0.9893 (0.9871) acc_u 0.0000 (2.1094) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [45/47] time 0.296 (0.331) data 0.218 (0.252) loss_u loss_u 0.9893 (0.9870) acc_u 3.1250 (2.0833) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1186
confident_label rate tensor(0.0815, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 133
clean true:124
clean false:9
clean_rate:0.9323308270676691
noisy true:322
noisy false:1177
after delete: len(clean_dataset) 133
after delete: len(noisy_dataset) 1499
epoch [2/200] batch [1/4] time 0.357 (0.357) data 0.280 (0.280) loss_x loss_x 2.6191 (2.6191) acc_x 43.7500 (43.7500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [2/4] time 0.344 (0.351) data 0.267 (0.273) loss_x loss_x 1.2363 (1.9277) acc_x 71.8750 (57.8125) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [3/4] time 0.344 (0.348) data 0.266 (0.271) loss_x loss_x 0.8691 (1.5749) acc_x 84.3750 (66.6667) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [4/4] time 0.348 (0.348) data 0.270 (0.271) loss_x loss_x 0.9419 (1.4166) acc_x 62.5000 (65.6250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/46] time 0.296 (0.326) data 0.218 (0.248) loss_u loss_u 0.9634 (0.9536) acc_u 6.2500 (8.1250) lr 2.0000e-03 eta 0:00:13
epoch [2/200] batch [10/46] time 0.346 (0.330) data 0.269 (0.252) loss_u loss_u 0.9487 (0.9453) acc_u 6.2500 (8.1250) lr 2.0000e-03 eta 0:00:11
epoch [2/200] batch [15/46] time 0.356 (0.332) data 0.277 (0.254) loss_u loss_u 0.9951 (0.9390) acc_u 0.0000 (8.1250) lr 2.0000e-03 eta 0:00:10
epoch [2/200] batch [20/46] time 0.340 (0.334) data 0.262 (0.256) loss_u loss_u 0.8481 (0.9321) acc_u 21.8750 (9.0625) lr 2.0000e-03 eta 0:00:08
epoch [2/200] batch [25/46] time 0.343 (0.335) data 0.265 (0.257) loss_u loss_u 0.9233 (0.9286) acc_u 6.2500 (9.1250) lr 2.0000e-03 eta 0:00:07
epoch [2/200] batch [30/46] time 0.329 (0.335) data 0.252 (0.257) loss_u loss_u 0.9780 (0.9330) acc_u 6.2500 (8.6458) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [35/46] time 0.333 (0.335) data 0.255 (0.257) loss_u loss_u 0.9307 (0.9337) acc_u 9.3750 (8.5714) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [40/46] time 0.348 (0.335) data 0.270 (0.257) loss_u loss_u 0.9282 (0.9324) acc_u 9.3750 (8.5938) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [45/46] time 0.293 (0.331) data 0.214 (0.254) loss_u loss_u 0.9023 (0.9309) acc_u 9.3750 (8.7500) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 740
confident_label rate tensor(0.1501, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 245
clean true:237
clean false:8
clean_rate:0.9673469387755103
noisy true:655
noisy false:732
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 1387
epoch [3/200] batch [5/7] time 0.330 (0.333) data 0.253 (0.256) loss_x loss_x 1.1494 (0.8469) acc_x 75.0000 (78.7500) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/43] time 0.335 (0.337) data 0.258 (0.259) loss_u loss_u 0.9385 (0.9744) acc_u 6.2500 (3.7500) lr 1.9999e-03 eta 0:00:12
epoch [3/200] batch [10/43] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9961 (0.9802) acc_u 0.0000 (2.1875) lr 1.9999e-03 eta 0:00:11
epoch [3/200] batch [15/43] time 0.338 (0.339) data 0.259 (0.261) loss_u loss_u 0.9980 (0.9771) acc_u 0.0000 (2.2917) lr 1.9999e-03 eta 0:00:09
epoch [3/200] batch [20/43] time 0.348 (0.340) data 0.269 (0.262) loss_u loss_u 0.9448 (0.9726) acc_u 12.5000 (3.2812) lr 1.9999e-03 eta 0:00:07
epoch [3/200] batch [25/43] time 0.353 (0.341) data 0.276 (0.263) loss_u loss_u 0.9946 (0.9724) acc_u 0.0000 (3.2500) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [30/43] time 0.315 (0.339) data 0.237 (0.261) loss_u loss_u 0.9893 (0.9710) acc_u 3.1250 (3.3333) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [35/43] time 0.342 (0.339) data 0.263 (0.261) loss_u loss_u 0.9932 (0.9692) acc_u 0.0000 (3.4821) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [40/43] time 0.346 (0.339) data 0.269 (0.261) loss_u loss_u 0.9858 (0.9707) acc_u 0.0000 (3.2812) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 723
confident_label rate tensor(0.1471, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 240
clean true:234
clean false:6
clean_rate:0.975
noisy true:675
noisy false:717
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 1392
epoch [4/200] batch [5/7] time 0.345 (0.341) data 0.267 (0.264) loss_x loss_x 0.8081 (0.8299) acc_x 81.2500 (82.5000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/43] time 0.338 (0.338) data 0.260 (0.260) loss_u loss_u 0.9766 (0.9714) acc_u 3.1250 (4.3750) lr 1.9995e-03 eta 0:00:12
epoch [4/200] batch [10/43] time 0.341 (0.340) data 0.264 (0.263) loss_u loss_u 0.9390 (0.9674) acc_u 9.3750 (4.3750) lr 1.9995e-03 eta 0:00:11
epoch [4/200] batch [15/43] time 0.340 (0.341) data 0.263 (0.264) loss_u loss_u 0.9922 (0.9754) acc_u 0.0000 (3.1250) lr 1.9995e-03 eta 0:00:09
epoch [4/200] batch [20/43] time 0.346 (0.343) data 0.269 (0.265) loss_u loss_u 0.9482 (0.9705) acc_u 6.2500 (3.4375) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [25/43] time 0.334 (0.343) data 0.256 (0.265) loss_u loss_u 0.9932 (0.9698) acc_u 0.0000 (3.3750) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [30/43] time 0.338 (0.343) data 0.260 (0.265) loss_u loss_u 0.9985 (0.9713) acc_u 0.0000 (3.1250) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [35/43] time 0.341 (0.344) data 0.263 (0.266) loss_u loss_u 0.9702 (0.9720) acc_u 3.1250 (3.0357) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [40/43] time 0.337 (0.343) data 0.260 (0.266) loss_u loss_u 0.9795 (0.9709) acc_u 3.1250 (3.1250) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 742
confident_label rate tensor(0.1471, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 240
clean true:230
clean false:10
clean_rate:0.9583333333333334
noisy true:660
noisy false:732
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 1392
epoch [5/200] batch [5/7] time 0.342 (0.320) data 0.264 (0.242) loss_x loss_x 1.0537 (0.7473) acc_x 75.0000 (81.2500) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/43] time 0.338 (0.333) data 0.261 (0.256) loss_u loss_u 0.9507 (0.9775) acc_u 6.2500 (1.8750) lr 1.9989e-03 eta 0:00:12
epoch [5/200] batch [10/43] time 0.342 (0.337) data 0.264 (0.259) loss_u loss_u 0.9805 (0.9657) acc_u 3.1250 (3.7500) lr 1.9989e-03 eta 0:00:11
epoch [5/200] batch [15/43] time 0.327 (0.337) data 0.249 (0.259) loss_u loss_u 0.9209 (0.9611) acc_u 9.3750 (4.7917) lr 1.9989e-03 eta 0:00:09
epoch [5/200] batch [20/43] time 0.340 (0.335) data 0.261 (0.257) loss_u loss_u 0.9722 (0.9628) acc_u 3.1250 (4.3750) lr 1.9989e-03 eta 0:00:07
epoch [5/200] batch [25/43] time 0.333 (0.336) data 0.255 (0.258) loss_u loss_u 0.9922 (0.9635) acc_u 0.0000 (4.2500) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [30/43] time 0.351 (0.337) data 0.273 (0.259) loss_u loss_u 0.9741 (0.9669) acc_u 3.1250 (3.9583) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [35/43] time 0.334 (0.336) data 0.256 (0.258) loss_u loss_u 0.9419 (0.9676) acc_u 6.2500 (3.7500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [40/43] time 0.329 (0.335) data 0.251 (0.257) loss_u loss_u 0.9468 (0.9694) acc_u 6.2500 (3.5156) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 748
confident_label rate tensor(0.1507, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 246
clean true:236
clean false:10
clean_rate:0.959349593495935
noisy true:648
noisy false:738
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 1386
epoch [6/200] batch [5/7] time 0.324 (0.312) data 0.246 (0.235) loss_x loss_x 0.8149 (0.6720) acc_x 81.2500 (81.8750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/43] time 0.366 (0.332) data 0.288 (0.255) loss_u loss_u 0.9072 (0.9488) acc_u 15.6250 (6.2500) lr 1.9980e-03 eta 0:00:12
epoch [6/200] batch [10/43] time 0.290 (0.324) data 0.213 (0.246) loss_u loss_u 0.9375 (0.9565) acc_u 6.2500 (5.3125) lr 1.9980e-03 eta 0:00:10
epoch [6/200] batch [15/43] time 0.316 (0.321) data 0.238 (0.244) loss_u loss_u 0.9722 (0.9612) acc_u 3.1250 (4.3750) lr 1.9980e-03 eta 0:00:08
epoch [6/200] batch [20/43] time 0.341 (0.325) data 0.264 (0.247) loss_u loss_u 0.9629 (0.9657) acc_u 6.2500 (3.9062) lr 1.9980e-03 eta 0:00:07
epoch [6/200] batch [25/43] time 0.337 (0.327) data 0.259 (0.250) loss_u loss_u 0.9819 (0.9631) acc_u 6.2500 (4.5000) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [30/43] time 0.347 (0.328) data 0.269 (0.251) loss_u loss_u 0.9434 (0.9651) acc_u 6.2500 (4.0625) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [35/43] time 0.342 (0.330) data 0.265 (0.252) loss_u loss_u 0.9429 (0.9647) acc_u 6.2500 (4.0179) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [40/43] time 0.342 (0.331) data 0.264 (0.254) loss_u loss_u 0.9609 (0.9662) acc_u 6.2500 (3.8281) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 710
confident_label rate tensor(0.1538, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 251
clean true:243
clean false:8
clean_rate:0.9681274900398407
noisy true:679
noisy false:702
after delete: len(clean_dataset) 251
after delete: len(noisy_dataset) 1381
epoch [7/200] batch [5/7] time 0.299 (0.333) data 0.221 (0.255) loss_x loss_x 0.8896 (0.6617) acc_x 81.2500 (83.1250) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/43] time 0.328 (0.320) data 0.249 (0.242) loss_u loss_u 0.9980 (0.9814) acc_u 0.0000 (1.8750) lr 1.9969e-03 eta 0:00:12
epoch [7/200] batch [10/43] time 0.341 (0.326) data 0.263 (0.248) loss_u loss_u 0.9927 (0.9737) acc_u 0.0000 (2.5000) lr 1.9969e-03 eta 0:00:10
epoch [7/200] batch [15/43] time 0.338 (0.330) data 0.260 (0.252) loss_u loss_u 0.9409 (0.9689) acc_u 6.2500 (2.9167) lr 1.9969e-03 eta 0:00:09
epoch [7/200] batch [20/43] time 0.344 (0.334) data 0.266 (0.256) loss_u loss_u 0.9653 (0.9657) acc_u 3.1250 (3.4375) lr 1.9969e-03 eta 0:00:07
epoch [7/200] batch [25/43] time 0.338 (0.335) data 0.260 (0.257) loss_u loss_u 0.9575 (0.9687) acc_u 3.1250 (3.1250) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [30/43] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9878 (0.9690) acc_u 0.0000 (3.0208) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [35/43] time 0.342 (0.336) data 0.265 (0.258) loss_u loss_u 0.9600 (0.9696) acc_u 6.2500 (3.1250) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [40/43] time 0.350 (0.336) data 0.273 (0.259) loss_u loss_u 0.9517 (0.9699) acc_u 6.2500 (3.2031) lr 1.9969e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 713
confident_label rate tensor(0.1538, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 251
clean true:239
clean false:12
clean_rate:0.952191235059761
noisy true:680
noisy false:701
after delete: len(clean_dataset) 251
after delete: len(noisy_dataset) 1381
epoch [8/200] batch [5/7] time 0.349 (0.346) data 0.271 (0.268) loss_x loss_x 0.7349 (0.8108) acc_x 75.0000 (80.0000) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/43] time 0.304 (0.333) data 0.226 (0.255) loss_u loss_u 0.9766 (0.9781) acc_u 3.1250 (2.5000) lr 1.9956e-03 eta 0:00:12
epoch [8/200] batch [10/43] time 0.340 (0.329) data 0.261 (0.251) loss_u loss_u 0.9487 (0.9704) acc_u 6.2500 (3.4375) lr 1.9956e-03 eta 0:00:10
epoch [8/200] batch [15/43] time 0.335 (0.331) data 0.258 (0.253) loss_u loss_u 0.9946 (0.9627) acc_u 0.0000 (4.5833) lr 1.9956e-03 eta 0:00:09
epoch [8/200] batch [20/43] time 0.326 (0.331) data 0.247 (0.253) loss_u loss_u 0.9854 (0.9643) acc_u 3.1250 (4.6875) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [25/43] time 0.342 (0.333) data 0.263 (0.254) loss_u loss_u 0.9512 (0.9620) acc_u 6.2500 (4.6250) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [30/43] time 0.342 (0.334) data 0.263 (0.256) loss_u loss_u 0.9795 (0.9654) acc_u 3.1250 (4.1667) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [35/43] time 0.345 (0.336) data 0.267 (0.258) loss_u loss_u 0.9541 (0.9660) acc_u 6.2500 (4.1071) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [40/43] time 0.338 (0.337) data 0.260 (0.258) loss_u loss_u 0.9814 (0.9682) acc_u 3.1250 (3.9062) lr 1.9956e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 700
confident_label rate tensor(0.1526, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 249
clean true:244
clean false:5
clean_rate:0.9799196787148594
noisy true:688
noisy false:695
after delete: len(clean_dataset) 249
after delete: len(noisy_dataset) 1383
epoch [9/200] batch [5/7] time 0.341 (0.343) data 0.264 (0.265) loss_x loss_x 0.9902 (0.6615) acc_x 84.3750 (86.2500) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/43] time 0.352 (0.347) data 0.274 (0.270) loss_u loss_u 0.9790 (0.9616) acc_u 3.1250 (4.3750) lr 1.9940e-03 eta 0:00:13
epoch [9/200] batch [10/43] time 0.309 (0.340) data 0.231 (0.262) loss_u loss_u 0.9932 (0.9668) acc_u 0.0000 (4.3750) lr 1.9940e-03 eta 0:00:11
epoch [9/200] batch [15/43] time 0.336 (0.339) data 0.258 (0.261) loss_u loss_u 0.9785 (0.9640) acc_u 3.1250 (4.5833) lr 1.9940e-03 eta 0:00:09
epoch [9/200] batch [20/43] time 0.353 (0.340) data 0.275 (0.262) loss_u loss_u 0.9492 (0.9658) acc_u 6.2500 (4.5312) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [25/43] time 0.343 (0.341) data 0.265 (0.263) loss_u loss_u 0.9985 (0.9648) acc_u 0.0000 (4.6250) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [30/43] time 0.342 (0.341) data 0.265 (0.263) loss_u loss_u 0.9780 (0.9657) acc_u 3.1250 (4.3750) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [35/43] time 0.335 (0.340) data 0.257 (0.262) loss_u loss_u 0.9849 (0.9652) acc_u 3.1250 (4.3750) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [40/43] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.9707 (0.9648) acc_u 3.1250 (4.3750) lr 1.9940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 702
confident_label rate tensor(0.1593, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 260
clean true:251
clean false:9
clean_rate:0.9653846153846154
noisy true:679
noisy false:693
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 1372
epoch [10/200] batch [5/8] time 0.346 (0.349) data 0.269 (0.272) loss_x loss_x 0.7446 (0.6854) acc_x 78.1250 (80.6250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [5/42] time 0.342 (0.345) data 0.263 (0.267) loss_u loss_u 0.9443 (0.9476) acc_u 6.2500 (6.8750) lr 1.9921e-03 eta 0:00:12
epoch [10/200] batch [10/42] time 0.326 (0.343) data 0.248 (0.266) loss_u loss_u 0.9780 (0.9606) acc_u 0.0000 (4.6875) lr 1.9921e-03 eta 0:00:10
epoch [10/200] batch [15/42] time 0.337 (0.342) data 0.259 (0.264) loss_u loss_u 0.9980 (0.9641) acc_u 0.0000 (4.3750) lr 1.9921e-03 eta 0:00:09
epoch [10/200] batch [20/42] time 0.333 (0.341) data 0.255 (0.263) loss_u loss_u 0.9453 (0.9641) acc_u 6.2500 (4.3750) lr 1.9921e-03 eta 0:00:07
epoch [10/200] batch [25/42] time 0.346 (0.341) data 0.269 (0.263) loss_u loss_u 0.9922 (0.9664) acc_u 0.0000 (4.0000) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [30/42] time 0.317 (0.340) data 0.239 (0.262) loss_u loss_u 0.9844 (0.9665) acc_u 3.1250 (3.9583) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [35/42] time 0.337 (0.340) data 0.259 (0.262) loss_u loss_u 0.9614 (0.9666) acc_u 3.1250 (3.9286) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [40/42] time 0.344 (0.340) data 0.267 (0.262) loss_u loss_u 0.9902 (0.9681) acc_u 0.0000 (3.7500) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 671
confident_label rate tensor(0.1636, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 267
clean true:259
clean false:8
clean_rate:0.9700374531835206
noisy true:702
noisy false:663
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 1365
epoch [11/200] batch [5/8] time 0.328 (0.338) data 0.251 (0.260) loss_x loss_x 1.0352 (0.8185) acc_x 75.0000 (76.2500) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [5/42] time 0.344 (0.337) data 0.267 (0.259) loss_u loss_u 0.9893 (0.9817) acc_u 0.0000 (1.2500) lr 1.9900e-03 eta 0:00:12
epoch [11/200] batch [10/42] time 0.288 (0.331) data 0.211 (0.253) loss_u loss_u 0.9917 (0.9874) acc_u 0.0000 (0.6250) lr 1.9900e-03 eta 0:00:10
epoch [11/200] batch [15/42] time 0.329 (0.330) data 0.250 (0.252) loss_u loss_u 0.9409 (0.9810) acc_u 9.3750 (1.8750) lr 1.9900e-03 eta 0:00:08
epoch [11/200] batch [20/42] time 0.308 (0.329) data 0.230 (0.251) loss_u loss_u 0.9492 (0.9805) acc_u 9.3750 (2.3438) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [25/42] time 0.339 (0.330) data 0.261 (0.253) loss_u loss_u 0.9619 (0.9772) acc_u 3.1250 (2.7500) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [30/42] time 0.341 (0.333) data 0.263 (0.255) loss_u loss_u 0.9868 (0.9751) acc_u 3.1250 (3.2292) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [35/42] time 0.347 (0.334) data 0.269 (0.256) loss_u loss_u 0.9590 (0.9727) acc_u 3.1250 (3.4821) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [40/42] time 0.347 (0.336) data 0.270 (0.258) loss_u loss_u 0.9585 (0.9716) acc_u 6.2500 (3.5938) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 690
confident_label rate tensor(0.1667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 272
clean true:256
clean false:16
clean_rate:0.9411764705882353
noisy true:686
noisy false:674
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 1360
epoch [12/200] batch [5/8] time 0.349 (0.340) data 0.272 (0.263) loss_x loss_x 1.1152 (0.7423) acc_x 75.0000 (80.6250) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [5/42] time 0.297 (0.339) data 0.220 (0.262) loss_u loss_u 0.9438 (0.9437) acc_u 6.2500 (6.2500) lr 1.9877e-03 eta 0:00:12
epoch [12/200] batch [10/42] time 0.331 (0.340) data 0.253 (0.262) loss_u loss_u 0.9912 (0.9599) acc_u 0.0000 (4.3750) lr 1.9877e-03 eta 0:00:10
epoch [12/200] batch [15/42] time 0.327 (0.338) data 0.249 (0.260) loss_u loss_u 0.9673 (0.9651) acc_u 6.2500 (3.9583) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [20/42] time 0.327 (0.336) data 0.250 (0.259) loss_u loss_u 0.9487 (0.9618) acc_u 6.2500 (4.5312) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [25/42] time 0.337 (0.337) data 0.260 (0.260) loss_u loss_u 0.9844 (0.9665) acc_u 3.1250 (4.0000) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [30/42] time 0.336 (0.338) data 0.258 (0.261) loss_u loss_u 0.9429 (0.9657) acc_u 6.2500 (4.2708) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [35/42] time 0.340 (0.338) data 0.263 (0.260) loss_u loss_u 0.9692 (0.9662) acc_u 3.1250 (4.1964) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [40/42] time 0.344 (0.338) data 0.265 (0.260) loss_u loss_u 0.9531 (0.9670) acc_u 6.2500 (4.1406) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 658
confident_label rate tensor(0.1667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 272
clean true:264
clean false:8
clean_rate:0.9705882352941176
noisy true:710
noisy false:650
after delete: len(clean_dataset) 272
after delete: len(noisy_dataset) 1360
epoch [13/200] batch [5/8] time 0.337 (0.347) data 0.260 (0.270) loss_x loss_x 0.7402 (0.7149) acc_x 81.2500 (80.0000) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [5/42] time 0.343 (0.345) data 0.265 (0.268) loss_u loss_u 0.9971 (0.9830) acc_u 0.0000 (1.8750) lr 1.9851e-03 eta 0:00:12
epoch [13/200] batch [10/42] time 0.349 (0.346) data 0.271 (0.268) loss_u loss_u 0.9937 (0.9753) acc_u 0.0000 (2.8125) lr 1.9851e-03 eta 0:00:11
epoch [13/200] batch [15/42] time 0.339 (0.345) data 0.262 (0.268) loss_u loss_u 0.9702 (0.9774) acc_u 3.1250 (2.5000) lr 1.9851e-03 eta 0:00:09
epoch [13/200] batch [20/42] time 0.342 (0.345) data 0.265 (0.267) loss_u loss_u 0.9663 (0.9737) acc_u 3.1250 (2.8125) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [25/42] time 0.337 (0.344) data 0.259 (0.266) loss_u loss_u 0.9795 (0.9690) acc_u 3.1250 (3.8750) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [30/42] time 0.349 (0.344) data 0.271 (0.266) loss_u loss_u 0.9707 (0.9685) acc_u 3.1250 (3.9583) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [35/42] time 0.346 (0.344) data 0.268 (0.266) loss_u loss_u 0.9961 (0.9693) acc_u 0.0000 (3.9286) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [40/42] time 0.350 (0.344) data 0.271 (0.266) loss_u loss_u 0.9453 (0.9686) acc_u 6.2500 (3.9844) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 672
confident_label rate tensor(0.1630, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 266
clean true:253
clean false:13
clean_rate:0.9511278195488722
noisy true:707
noisy false:659
after delete: len(clean_dataset) 266
after delete: len(noisy_dataset) 1366
epoch [14/200] batch [5/8] time 0.315 (0.347) data 0.237 (0.269) loss_x loss_x 1.1816 (0.8882) acc_x 78.1250 (81.8750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [5/42] time 0.342 (0.332) data 0.264 (0.254) loss_u loss_u 0.9609 (0.9707) acc_u 6.2500 (3.1250) lr 1.9823e-03 eta 0:00:12
epoch [14/200] batch [10/42] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9902 (0.9741) acc_u 0.0000 (2.5000) lr 1.9823e-03 eta 0:00:10
epoch [14/200] batch [15/42] time 0.331 (0.337) data 0.253 (0.259) loss_u loss_u 0.9648 (0.9698) acc_u 3.1250 (3.3333) lr 1.9823e-03 eta 0:00:09
epoch [14/200] batch [20/42] time 0.350 (0.339) data 0.273 (0.261) loss_u loss_u 0.9268 (0.9666) acc_u 9.3750 (3.7500) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [25/42] time 0.346 (0.340) data 0.269 (0.262) loss_u loss_u 0.9312 (0.9654) acc_u 9.3750 (3.8750) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [30/42] time 0.332 (0.339) data 0.254 (0.261) loss_u loss_u 0.9873 (0.9631) acc_u 0.0000 (4.3750) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [35/42] time 0.352 (0.339) data 0.274 (0.262) loss_u loss_u 0.9404 (0.9643) acc_u 6.2500 (4.1071) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [40/42] time 0.333 (0.340) data 0.254 (0.262) loss_u loss_u 0.9775 (0.9635) acc_u 3.1250 (4.1406) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 695
confident_label rate tensor(0.1624, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 265
clean true:256
clean false:9
clean_rate:0.9660377358490566
noisy true:681
noisy false:686
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 1367
epoch [15/200] batch [5/8] time 0.353 (0.349) data 0.276 (0.271) loss_x loss_x 1.1699 (0.7161) acc_x 84.3750 (85.6250) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [5/42] time 0.349 (0.351) data 0.271 (0.273) loss_u loss_u 0.9644 (0.9744) acc_u 6.2500 (3.7500) lr 1.9792e-03 eta 0:00:12
epoch [15/200] batch [10/42] time 0.348 (0.350) data 0.271 (0.272) loss_u loss_u 0.9551 (0.9725) acc_u 3.1250 (3.1250) lr 1.9792e-03 eta 0:00:11
epoch [15/200] batch [15/42] time 0.331 (0.347) data 0.254 (0.269) loss_u loss_u 0.9888 (0.9738) acc_u 3.1250 (3.1250) lr 1.9792e-03 eta 0:00:09
epoch [15/200] batch [20/42] time 0.338 (0.345) data 0.259 (0.267) loss_u loss_u 0.9375 (0.9696) acc_u 9.3750 (3.9062) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [25/42] time 0.353 (0.346) data 0.275 (0.268) loss_u loss_u 0.9414 (0.9662) acc_u 9.3750 (4.5000) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [30/42] time 0.354 (0.346) data 0.276 (0.268) loss_u loss_u 0.9551 (0.9653) acc_u 3.1250 (4.2708) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [35/42] time 0.381 (0.347) data 0.303 (0.269) loss_u loss_u 0.9688 (0.9673) acc_u 3.1250 (4.0179) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [40/42] time 0.331 (0.346) data 0.252 (0.268) loss_u loss_u 0.9888 (0.9660) acc_u 0.0000 (4.2188) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 646
confident_label rate tensor(0.1795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 293
clean true:280
clean false:13
clean_rate:0.9556313993174061
noisy true:706
noisy false:633
after delete: len(clean_dataset) 293
after delete: len(noisy_dataset) 1339
epoch [16/200] batch [5/9] time 0.345 (0.355) data 0.268 (0.278) loss_x loss_x 0.7480 (0.8709) acc_x 84.3750 (81.2500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [5/41] time 0.352 (0.350) data 0.275 (0.272) loss_u loss_u 0.9897 (0.9945) acc_u 0.0000 (0.0000) lr 1.9759e-03 eta 0:00:12
epoch [16/200] batch [10/41] time 0.344 (0.348) data 0.266 (0.270) loss_u loss_u 0.9985 (0.9870) acc_u 0.0000 (1.2500) lr 1.9759e-03 eta 0:00:10
epoch [16/200] batch [15/41] time 0.332 (0.346) data 0.254 (0.268) loss_u loss_u 0.9595 (0.9825) acc_u 6.2500 (1.8750) lr 1.9759e-03 eta 0:00:08
epoch [16/200] batch [20/41] time 0.330 (0.346) data 0.252 (0.268) loss_u loss_u 0.9321 (0.9795) acc_u 9.3750 (2.3438) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [25/41] time 0.342 (0.346) data 0.264 (0.268) loss_u loss_u 0.8970 (0.9761) acc_u 12.5000 (2.6250) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [30/41] time 0.336 (0.343) data 0.258 (0.265) loss_u loss_u 0.9873 (0.9757) acc_u 3.1250 (2.7083) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [35/41] time 0.365 (0.342) data 0.286 (0.265) loss_u loss_u 0.9990 (0.9780) acc_u 0.0000 (2.4107) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [40/41] time 0.344 (0.343) data 0.265 (0.265) loss_u loss_u 0.9663 (0.9780) acc_u 6.2500 (2.5000) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 663
confident_label rate tensor(0.1722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 281
clean true:269
clean false:12
clean_rate:0.9572953736654805
noisy true:700
noisy false:651
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 1351
epoch [17/200] batch [5/8] time 0.346 (0.349) data 0.269 (0.272) loss_x loss_x 0.8486 (0.8595) acc_x 75.0000 (82.5000) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [5/42] time 0.349 (0.354) data 0.272 (0.276) loss_u loss_u 0.9814 (0.9506) acc_u 3.1250 (6.8750) lr 1.9724e-03 eta 0:00:13
epoch [17/200] batch [10/42] time 0.338 (0.350) data 0.260 (0.272) loss_u loss_u 0.9482 (0.9612) acc_u 6.2500 (5.0000) lr 1.9724e-03 eta 0:00:11
epoch [17/200] batch [15/42] time 0.356 (0.351) data 0.278 (0.273) loss_u loss_u 0.9668 (0.9689) acc_u 6.2500 (3.9583) lr 1.9724e-03 eta 0:00:09
epoch [17/200] batch [20/42] time 0.345 (0.349) data 0.266 (0.272) loss_u loss_u 0.9688 (0.9705) acc_u 6.2500 (3.9062) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [25/42] time 0.332 (0.347) data 0.254 (0.270) loss_u loss_u 0.9683 (0.9684) acc_u 3.1250 (4.0000) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [30/42] time 0.353 (0.345) data 0.275 (0.267) loss_u loss_u 0.9878 (0.9692) acc_u 0.0000 (3.9583) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [35/42] time 0.356 (0.342) data 0.278 (0.264) loss_u loss_u 0.9863 (0.9719) acc_u 0.0000 (3.4821) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [40/42] time 0.353 (0.342) data 0.275 (0.265) loss_u loss_u 0.9814 (0.9730) acc_u 3.1250 (3.3594) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 611
confident_label rate tensor(0.1752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 286
clean true:278
clean false:8
clean_rate:0.972027972027972
noisy true:743
noisy false:603
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 1346
epoch [18/200] batch [5/8] time 0.355 (0.350) data 0.277 (0.272) loss_x loss_x 0.5693 (0.5756) acc_x 81.2500 (84.3750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [5/42] time 0.303 (0.333) data 0.223 (0.255) loss_u loss_u 0.9565 (0.9733) acc_u 3.1250 (2.5000) lr 1.9686e-03 eta 0:00:12
epoch [18/200] batch [10/42] time 0.345 (0.338) data 0.266 (0.259) loss_u loss_u 0.9961 (0.9820) acc_u 0.0000 (1.5625) lr 1.9686e-03 eta 0:00:10
epoch [18/200] batch [15/42] time 0.332 (0.338) data 0.254 (0.260) loss_u loss_u 0.9819 (0.9813) acc_u 3.1250 (2.0833) lr 1.9686e-03 eta 0:00:09
epoch [18/200] batch [20/42] time 0.339 (0.339) data 0.262 (0.261) loss_u loss_u 0.9971 (0.9785) acc_u 0.0000 (2.3438) lr 1.9686e-03 eta 0:00:07
epoch [18/200] batch [25/42] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9956 (0.9805) acc_u 0.0000 (2.1250) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [30/42] time 0.352 (0.342) data 0.274 (0.264) loss_u loss_u 0.9785 (0.9788) acc_u 3.1250 (2.3958) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [35/42] time 0.353 (0.342) data 0.275 (0.264) loss_u loss_u 0.9595 (0.9777) acc_u 3.1250 (2.5893) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [40/42] time 0.366 (0.343) data 0.287 (0.265) loss_u loss_u 0.9541 (0.9747) acc_u 6.2500 (2.8906) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 639
confident_label rate tensor(0.1728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 282
clean true:272
clean false:10
clean_rate:0.9645390070921985
noisy true:721
noisy false:629
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1350
epoch [19/200] batch [5/8] time 0.340 (0.350) data 0.263 (0.273) loss_x loss_x 0.5024 (0.4733) acc_x 90.6250 (88.7500) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [5/42] time 0.330 (0.340) data 0.252 (0.262) loss_u loss_u 0.9775 (0.9823) acc_u 3.1250 (1.8750) lr 1.9646e-03 eta 0:00:12
epoch [19/200] batch [10/42] time 0.347 (0.340) data 0.269 (0.263) loss_u loss_u 0.9380 (0.9750) acc_u 9.3750 (3.1250) lr 1.9646e-03 eta 0:00:10
epoch [19/200] batch [15/42] time 0.347 (0.341) data 0.268 (0.264) loss_u loss_u 0.9844 (0.9771) acc_u 3.1250 (2.9167) lr 1.9646e-03 eta 0:00:09
epoch [19/200] batch [20/42] time 0.325 (0.341) data 0.247 (0.263) loss_u loss_u 0.9648 (0.9781) acc_u 6.2500 (2.8125) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [25/42] time 0.307 (0.336) data 0.228 (0.258) loss_u loss_u 0.9922 (0.9771) acc_u 0.0000 (2.8750) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [30/42] time 0.347 (0.336) data 0.270 (0.258) loss_u loss_u 0.9644 (0.9745) acc_u 3.1250 (3.2292) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [35/42] time 0.346 (0.337) data 0.268 (0.259) loss_u loss_u 0.9658 (0.9748) acc_u 3.1250 (3.0357) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [40/42] time 0.339 (0.338) data 0.261 (0.260) loss_u loss_u 0.9995 (0.9768) acc_u 0.0000 (2.7344) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 623
confident_label rate tensor(0.1734, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 283
clean true:277
clean false:6
clean_rate:0.9787985865724381
noisy true:732
noisy false:617
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 1349
epoch [20/200] batch [5/8] time 0.299 (0.335) data 0.222 (0.258) loss_x loss_x 0.3206 (0.5471) acc_x 93.7500 (88.7500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [5/42] time 0.316 (0.329) data 0.237 (0.252) loss_u loss_u 0.9663 (0.9690) acc_u 6.2500 (3.7500) lr 1.9603e-03 eta 0:00:12
epoch [20/200] batch [10/42] time 0.344 (0.332) data 0.265 (0.254) loss_u loss_u 0.9692 (0.9779) acc_u 3.1250 (2.5000) lr 1.9603e-03 eta 0:00:10
epoch [20/200] batch [15/42] time 0.325 (0.333) data 0.246 (0.255) loss_u loss_u 0.9380 (0.9771) acc_u 6.2500 (2.5000) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [20/42] time 0.303 (0.331) data 0.224 (0.253) loss_u loss_u 0.9761 (0.9754) acc_u 3.1250 (2.6562) lr 1.9603e-03 eta 0:00:07
epoch [20/200] batch [25/42] time 0.312 (0.327) data 0.233 (0.249) loss_u loss_u 0.9482 (0.9721) acc_u 6.2500 (3.1250) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [30/42] time 0.350 (0.328) data 0.271 (0.250) loss_u loss_u 0.9688 (0.9750) acc_u 3.1250 (2.7083) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [35/42] time 0.342 (0.330) data 0.264 (0.252) loss_u loss_u 0.9668 (0.9746) acc_u 3.1250 (2.7679) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [40/42] time 0.343 (0.331) data 0.266 (0.253) loss_u loss_u 0.9614 (0.9736) acc_u 6.2500 (3.0469) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 641
confident_label rate tensor(0.1746, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 285
clean true:272
clean false:13
clean_rate:0.9543859649122807
noisy true:719
noisy false:628
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 1347
epoch [21/200] batch [5/8] time 0.342 (0.344) data 0.265 (0.266) loss_x loss_x 0.5322 (0.7709) acc_x 84.3750 (81.2500) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [5/42] time 0.341 (0.343) data 0.262 (0.266) loss_u loss_u 0.9233 (0.9580) acc_u 9.3750 (5.6250) lr 1.9558e-03 eta 0:00:12
epoch [21/200] batch [10/42] time 0.329 (0.340) data 0.252 (0.262) loss_u loss_u 0.9897 (0.9699) acc_u 3.1250 (3.7500) lr 1.9558e-03 eta 0:00:10
epoch [21/200] batch [15/42] time 0.354 (0.340) data 0.276 (0.262) loss_u loss_u 0.9570 (0.9704) acc_u 3.1250 (3.5417) lr 1.9558e-03 eta 0:00:09
epoch [21/200] batch [20/42] time 0.333 (0.341) data 0.254 (0.263) loss_u loss_u 0.9702 (0.9695) acc_u 3.1250 (3.9062) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [25/42] time 0.301 (0.340) data 0.223 (0.262) loss_u loss_u 0.9644 (0.9685) acc_u 6.2500 (4.1250) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [30/42] time 0.313 (0.336) data 0.236 (0.258) loss_u loss_u 0.9727 (0.9714) acc_u 3.1250 (3.6458) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [35/42] time 0.338 (0.337) data 0.260 (0.259) loss_u loss_u 0.9966 (0.9710) acc_u 0.0000 (3.6607) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [40/42] time 0.334 (0.337) data 0.256 (0.260) loss_u loss_u 0.9927 (0.9727) acc_u 0.0000 (3.4375) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 611
confident_label rate tensor(0.1691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 276
clean true:266
clean false:10
clean_rate:0.9637681159420289
noisy true:755
noisy false:601
after delete: len(clean_dataset) 276
after delete: len(noisy_dataset) 1356
epoch [22/200] batch [5/8] time 0.327 (0.343) data 0.250 (0.265) loss_x loss_x 0.5171 (0.5932) acc_x 87.5000 (88.7500) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [5/42] time 0.345 (0.341) data 0.267 (0.263) loss_u loss_u 0.9976 (0.9681) acc_u 0.0000 (3.7500) lr 1.9511e-03 eta 0:00:12
epoch [22/200] batch [10/42] time 0.346 (0.339) data 0.268 (0.262) loss_u loss_u 0.9624 (0.9636) acc_u 6.2500 (4.3750) lr 1.9511e-03 eta 0:00:10
epoch [22/200] batch [15/42] time 0.339 (0.341) data 0.260 (0.263) loss_u loss_u 0.9438 (0.9618) acc_u 9.3750 (4.7917) lr 1.9511e-03 eta 0:00:09
epoch [22/200] batch [20/42] time 0.359 (0.343) data 0.280 (0.265) loss_u loss_u 0.9922 (0.9669) acc_u 3.1250 (4.0625) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [25/42] time 0.351 (0.343) data 0.273 (0.265) loss_u loss_u 0.9531 (0.9657) acc_u 6.2500 (4.2500) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [30/42] time 0.356 (0.344) data 0.279 (0.266) loss_u loss_u 0.9648 (0.9631) acc_u 6.2500 (4.3750) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [35/42] time 0.342 (0.344) data 0.265 (0.266) loss_u loss_u 0.9844 (0.9631) acc_u 3.1250 (4.5536) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [40/42] time 0.340 (0.344) data 0.262 (0.266) loss_u loss_u 0.9478 (0.9642) acc_u 6.2500 (4.4531) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 601
confident_label rate tensor(0.1752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 286
clean true:281
clean false:5
clean_rate:0.9825174825174825
noisy true:750
noisy false:596
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 1346
epoch [23/200] batch [5/8] time 0.332 (0.343) data 0.255 (0.266) loss_x loss_x 0.5449 (0.6536) acc_x 90.6250 (84.3750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [5/42] time 0.323 (0.337) data 0.244 (0.259) loss_u loss_u 0.9678 (0.9675) acc_u 6.2500 (3.7500) lr 1.9461e-03 eta 0:00:12
epoch [23/200] batch [10/42] time 0.351 (0.339) data 0.272 (0.261) loss_u loss_u 0.9473 (0.9662) acc_u 6.2500 (3.7500) lr 1.9461e-03 eta 0:00:10
epoch [23/200] batch [15/42] time 0.338 (0.340) data 0.261 (0.262) loss_u loss_u 0.9976 (0.9715) acc_u 0.0000 (3.1250) lr 1.9461e-03 eta 0:00:09
epoch [23/200] batch [20/42] time 0.345 (0.339) data 0.268 (0.261) loss_u loss_u 1.0000 (0.9701) acc_u 0.0000 (3.4375) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [25/42] time 0.335 (0.340) data 0.256 (0.262) loss_u loss_u 0.9902 (0.9705) acc_u 3.1250 (3.5000) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [30/42] time 0.330 (0.340) data 0.252 (0.262) loss_u loss_u 0.9712 (0.9692) acc_u 3.1250 (3.7500) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [35/42] time 0.335 (0.341) data 0.256 (0.263) loss_u loss_u 0.9526 (0.9694) acc_u 6.2500 (3.7500) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [40/42] time 0.331 (0.341) data 0.253 (0.263) loss_u loss_u 0.9307 (0.9693) acc_u 6.2500 (3.8281) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 646
confident_label rate tensor(0.1777, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 290
clean true:279
clean false:11
clean_rate:0.9620689655172414
noisy true:707
noisy false:635
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 1342
epoch [24/200] batch [5/9] time 0.335 (0.344) data 0.258 (0.267) loss_x loss_x 0.6479 (0.7645) acc_x 84.3750 (81.2500) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [5/41] time 0.332 (0.342) data 0.253 (0.264) loss_u loss_u 0.9746 (0.9789) acc_u 3.1250 (1.8750) lr 1.9409e-03 eta 0:00:12
epoch [24/200] batch [10/41] time 0.340 (0.342) data 0.263 (0.265) loss_u loss_u 0.9990 (0.9770) acc_u 0.0000 (2.1875) lr 1.9409e-03 eta 0:00:10
epoch [24/200] batch [15/41] time 0.304 (0.335) data 0.225 (0.257) loss_u loss_u 0.9541 (0.9730) acc_u 6.2500 (2.9167) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [20/41] time 0.336 (0.335) data 0.258 (0.257) loss_u loss_u 0.9858 (0.9717) acc_u 3.1250 (3.1250) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [25/41] time 0.344 (0.337) data 0.266 (0.259) loss_u loss_u 0.9839 (0.9723) acc_u 3.1250 (3.1250) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [30/41] time 0.350 (0.337) data 0.272 (0.259) loss_u loss_u 0.9565 (0.9718) acc_u 6.2500 (3.1250) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [35/41] time 0.351 (0.338) data 0.273 (0.260) loss_u loss_u 0.9639 (0.9720) acc_u 3.1250 (3.2143) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [40/41] time 0.369 (0.340) data 0.290 (0.262) loss_u loss_u 0.9985 (0.9704) acc_u 0.0000 (3.3594) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 583
confident_label rate tensor(0.1777, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 290
clean true:283
clean false:7
clean_rate:0.9758620689655172
noisy true:766
noisy false:576
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 1342
epoch [25/200] batch [5/9] time 0.334 (0.340) data 0.257 (0.263) loss_x loss_x 0.4695 (0.5260) acc_x 84.3750 (87.5000) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [5/41] time 0.319 (0.335) data 0.241 (0.258) loss_u loss_u 0.9985 (0.9628) acc_u 0.0000 (4.3750) lr 1.9354e-03 eta 0:00:12
epoch [25/200] batch [10/41] time 0.295 (0.335) data 0.217 (0.257) loss_u loss_u 0.9185 (0.9565) acc_u 9.3750 (5.3125) lr 1.9354e-03 eta 0:00:10
epoch [25/200] batch [15/41] time 0.341 (0.333) data 0.262 (0.255) loss_u loss_u 0.9580 (0.9597) acc_u 6.2500 (4.7917) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [20/41] time 0.352 (0.336) data 0.274 (0.258) loss_u loss_u 0.9658 (0.9646) acc_u 3.1250 (4.2188) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [25/41] time 0.351 (0.337) data 0.272 (0.259) loss_u loss_u 0.9609 (0.9666) acc_u 3.1250 (3.8750) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [30/41] time 0.328 (0.338) data 0.250 (0.260) loss_u loss_u 0.9922 (0.9695) acc_u 0.0000 (3.4375) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [35/41] time 0.339 (0.339) data 0.261 (0.262) loss_u loss_u 0.9795 (0.9692) acc_u 3.1250 (3.5714) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [40/41] time 0.335 (0.340) data 0.257 (0.262) loss_u loss_u 0.9722 (0.9707) acc_u 3.1250 (3.3594) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 601
confident_label rate tensor(0.1820, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 297
clean true:287
clean false:10
clean_rate:0.9663299663299664
noisy true:744
noisy false:591
after delete: len(clean_dataset) 297
after delete: len(noisy_dataset) 1335
epoch [26/200] batch [5/9] time 0.363 (0.342) data 0.285 (0.265) loss_x loss_x 0.3735 (0.4789) acc_x 93.7500 (91.2500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [5/41] time 0.395 (0.360) data 0.317 (0.281) loss_u loss_u 0.9961 (0.9834) acc_u 0.0000 (1.8750) lr 1.9298e-03 eta 0:00:12
epoch [26/200] batch [10/41] time 0.369 (0.363) data 0.290 (0.284) loss_u loss_u 0.9746 (0.9779) acc_u 3.1250 (3.1250) lr 1.9298e-03 eta 0:00:11
epoch [26/200] batch [15/41] time 0.348 (0.361) data 0.270 (0.282) loss_u loss_u 0.9756 (0.9745) acc_u 3.1250 (3.5417) lr 1.9298e-03 eta 0:00:09
epoch [26/200] batch [20/41] time 0.339 (0.358) data 0.260 (0.279) loss_u loss_u 0.9956 (0.9740) acc_u 0.0000 (3.5938) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [25/41] time 0.337 (0.357) data 0.258 (0.278) loss_u loss_u 0.9443 (0.9702) acc_u 6.2500 (4.0000) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [30/41] time 0.352 (0.356) data 0.275 (0.277) loss_u loss_u 0.9814 (0.9704) acc_u 3.1250 (4.0625) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [35/41] time 0.373 (0.354) data 0.295 (0.275) loss_u loss_u 0.9980 (0.9718) acc_u 0.0000 (3.7500) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [40/41] time 0.309 (0.353) data 0.231 (0.275) loss_u loss_u 0.8628 (0.9703) acc_u 15.6250 (3.7500) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 588
confident_label rate tensor(0.1900, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 310
clean true:299
clean false:11
clean_rate:0.964516129032258
noisy true:745
noisy false:577
after delete: len(clean_dataset) 310
after delete: len(noisy_dataset) 1322
epoch [27/200] batch [5/9] time 0.334 (0.347) data 0.257 (0.269) loss_x loss_x 0.5752 (0.5647) acc_x 87.5000 (88.7500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [5/41] time 0.346 (0.345) data 0.267 (0.267) loss_u loss_u 0.9951 (0.9657) acc_u 0.0000 (3.1250) lr 1.9239e-03 eta 0:00:12
epoch [27/200] batch [10/41] time 0.323 (0.343) data 0.245 (0.265) loss_u loss_u 0.9683 (0.9705) acc_u 3.1250 (3.1250) lr 1.9239e-03 eta 0:00:10
epoch [27/200] batch [15/41] time 0.309 (0.335) data 0.231 (0.257) loss_u loss_u 0.9937 (0.9755) acc_u 0.0000 (2.7083) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [20/41] time 0.346 (0.337) data 0.268 (0.259) loss_u loss_u 0.9980 (0.9777) acc_u 0.0000 (2.5000) lr 1.9239e-03 eta 0:00:07
epoch [27/200] batch [25/41] time 0.343 (0.337) data 0.265 (0.259) loss_u loss_u 0.9668 (0.9761) acc_u 3.1250 (2.6250) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [30/41] time 0.361 (0.339) data 0.283 (0.261) loss_u loss_u 0.9600 (0.9763) acc_u 6.2500 (2.6042) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [35/41] time 0.334 (0.340) data 0.256 (0.262) loss_u loss_u 0.9971 (0.9778) acc_u 0.0000 (2.5000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [40/41] time 0.333 (0.340) data 0.255 (0.262) loss_u loss_u 0.9727 (0.9787) acc_u 3.1250 (2.4219) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 619
confident_label rate tensor(0.1728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 282
clean true:272
clean false:10
clean_rate:0.9645390070921985
noisy true:741
noisy false:609
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1350
epoch [28/200] batch [5/8] time 0.347 (0.350) data 0.270 (0.272) loss_x loss_x 0.2571 (0.5504) acc_x 96.8750 (88.1250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [5/42] time 0.357 (0.345) data 0.280 (0.267) loss_u loss_u 0.9556 (0.9690) acc_u 3.1250 (3.1250) lr 1.9178e-03 eta 0:00:12
epoch [28/200] batch [10/42] time 0.331 (0.342) data 0.252 (0.264) loss_u loss_u 0.9561 (0.9527) acc_u 6.2500 (5.0000) lr 1.9178e-03 eta 0:00:10
epoch [28/200] batch [15/42] time 0.302 (0.333) data 0.223 (0.255) loss_u loss_u 0.9907 (0.9599) acc_u 3.1250 (4.3750) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [20/42] time 0.338 (0.335) data 0.260 (0.257) loss_u loss_u 0.9941 (0.9629) acc_u 0.0000 (4.2188) lr 1.9178e-03 eta 0:00:07
epoch [28/200] batch [25/42] time 0.339 (0.337) data 0.262 (0.259) loss_u loss_u 0.9858 (0.9651) acc_u 3.1250 (4.0000) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [30/42] time 0.353 (0.339) data 0.275 (0.261) loss_u loss_u 0.9541 (0.9679) acc_u 9.3750 (3.8542) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [35/42] time 0.347 (0.338) data 0.270 (0.260) loss_u loss_u 0.9702 (0.9658) acc_u 6.2500 (4.1964) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [40/42] time 0.340 (0.338) data 0.263 (0.260) loss_u loss_u 0.9883 (0.9669) acc_u 0.0000 (3.9844) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 641
confident_label rate tensor(0.1820, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 297
clean true:285
clean false:12
clean_rate:0.9595959595959596
noisy true:706
noisy false:629
after delete: len(clean_dataset) 297
after delete: len(noisy_dataset) 1335
epoch [29/200] batch [5/9] time 0.332 (0.347) data 0.254 (0.269) loss_x loss_x 0.4062 (0.5601) acc_x 87.5000 (86.2500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [5/41] time 0.353 (0.344) data 0.275 (0.267) loss_u loss_u 0.9062 (0.9503) acc_u 12.5000 (6.8750) lr 1.9114e-03 eta 0:00:12
epoch [29/200] batch [10/41] time 0.305 (0.341) data 0.225 (0.263) loss_u loss_u 0.9688 (0.9593) acc_u 3.1250 (5.0000) lr 1.9114e-03 eta 0:00:10
epoch [29/200] batch [15/41] time 0.371 (0.338) data 0.293 (0.260) loss_u loss_u 0.9980 (0.9698) acc_u 0.0000 (3.5417) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [20/41] time 0.335 (0.338) data 0.258 (0.260) loss_u loss_u 0.9727 (0.9736) acc_u 3.1250 (3.1250) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [25/41] time 0.349 (0.338) data 0.271 (0.260) loss_u loss_u 0.9937 (0.9762) acc_u 0.0000 (2.8750) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [30/41] time 0.361 (0.340) data 0.282 (0.262) loss_u loss_u 0.9775 (0.9753) acc_u 3.1250 (3.0208) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [35/41] time 0.327 (0.337) data 0.248 (0.259) loss_u loss_u 0.8984 (0.9728) acc_u 12.5000 (3.3036) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [40/41] time 0.380 (0.340) data 0.301 (0.261) loss_u loss_u 0.9521 (0.9694) acc_u 6.2500 (3.6719) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 620
confident_label rate tensor(0.1808, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 295
clean true:285
clean false:10
clean_rate:0.9661016949152542
noisy true:727
noisy false:610
after delete: len(clean_dataset) 295
after delete: len(noisy_dataset) 1337
epoch [30/200] batch [5/9] time 0.350 (0.369) data 0.272 (0.290) loss_x loss_x 0.4937 (0.5840) acc_x 87.5000 (87.5000) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [5/41] time 0.373 (0.370) data 0.294 (0.291) loss_u loss_u 0.9980 (0.9779) acc_u 0.0000 (3.7500) lr 1.9048e-03 eta 0:00:13
epoch [30/200] batch [10/41] time 0.357 (0.363) data 0.278 (0.285) loss_u loss_u 0.9751 (0.9723) acc_u 3.1250 (4.0625) lr 1.9048e-03 eta 0:00:11
epoch [30/200] batch [15/41] time 0.355 (0.361) data 0.276 (0.282) loss_u loss_u 0.9946 (0.9635) acc_u 0.0000 (4.7917) lr 1.9048e-03 eta 0:00:09
epoch [30/200] batch [20/41] time 0.346 (0.358) data 0.266 (0.280) loss_u loss_u 0.9946 (0.9676) acc_u 0.0000 (4.2188) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [25/41] time 0.352 (0.357) data 0.274 (0.278) loss_u loss_u 0.9395 (0.9673) acc_u 6.2500 (4.2500) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [30/41] time 0.355 (0.357) data 0.276 (0.278) loss_u loss_u 0.9678 (0.9656) acc_u 3.1250 (4.5833) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [35/41] time 0.362 (0.356) data 0.283 (0.277) loss_u loss_u 0.9883 (0.9673) acc_u 0.0000 (4.2857) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [40/41] time 0.351 (0.354) data 0.273 (0.276) loss_u loss_u 0.9941 (0.9693) acc_u 0.0000 (3.9844) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 616
confident_label rate tensor(0.1795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 293
clean true:278
clean false:15
clean_rate:0.9488054607508533
noisy true:738
noisy false:601
after delete: len(clean_dataset) 293
after delete: len(noisy_dataset) 1339
epoch [31/200] batch [5/9] time 0.358 (0.360) data 0.280 (0.281) loss_x loss_x 0.5547 (0.4820) acc_x 87.5000 (90.6250) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [5/41] time 0.348 (0.360) data 0.270 (0.282) loss_u loss_u 0.9707 (0.9579) acc_u 3.1250 (4.3750) lr 1.8980e-03 eta 0:00:12
epoch [31/200] batch [10/41] time 0.352 (0.352) data 0.273 (0.273) loss_u loss_u 0.9854 (0.9665) acc_u 3.1250 (3.7500) lr 1.8980e-03 eta 0:00:10
epoch [31/200] batch [15/41] time 0.354 (0.351) data 0.275 (0.272) loss_u loss_u 0.9683 (0.9650) acc_u 3.1250 (3.7500) lr 1.8980e-03 eta 0:00:09
epoch [31/200] batch [20/41] time 0.336 (0.350) data 0.258 (0.271) loss_u loss_u 0.9717 (0.9678) acc_u 3.1250 (3.7500) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [25/41] time 0.363 (0.350) data 0.284 (0.271) loss_u loss_u 0.9185 (0.9663) acc_u 12.5000 (4.1250) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [30/41] time 0.354 (0.350) data 0.275 (0.271) loss_u loss_u 0.9927 (0.9705) acc_u 0.0000 (3.7500) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [35/41] time 0.382 (0.350) data 0.302 (0.271) loss_u loss_u 0.9707 (0.9718) acc_u 3.1250 (3.6607) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [40/41] time 0.350 (0.350) data 0.270 (0.271) loss_u loss_u 0.9570 (0.9707) acc_u 3.1250 (3.7500) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 612
confident_label rate tensor(0.1814, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 296
clean true:287
clean false:9
clean_rate:0.9695945945945946
noisy true:733
noisy false:603
after delete: len(clean_dataset) 296
after delete: len(noisy_dataset) 1336
epoch [32/200] batch [5/9] time 0.361 (0.352) data 0.282 (0.273) loss_x loss_x 0.3875 (0.5938) acc_x 93.7500 (85.6250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [5/41] time 0.342 (0.339) data 0.264 (0.260) loss_u loss_u 0.9478 (0.9707) acc_u 6.2500 (3.7500) lr 1.8910e-03 eta 0:00:12
epoch [32/200] batch [10/41] time 0.375 (0.343) data 0.297 (0.264) loss_u loss_u 0.9336 (0.9687) acc_u 9.3750 (3.7500) lr 1.8910e-03 eta 0:00:10
epoch [32/200] batch [15/41] time 0.336 (0.343) data 0.258 (0.265) loss_u loss_u 0.9736 (0.9636) acc_u 3.1250 (4.3750) lr 1.8910e-03 eta 0:00:08
epoch [32/200] batch [20/41] time 0.346 (0.343) data 0.267 (0.265) loss_u loss_u 0.9644 (0.9668) acc_u 3.1250 (3.9062) lr 1.8910e-03 eta 0:00:07
epoch [32/200] batch [25/41] time 0.339 (0.344) data 0.261 (0.265) loss_u loss_u 0.9985 (0.9684) acc_u 0.0000 (3.7500) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [30/41] time 0.362 (0.345) data 0.283 (0.266) loss_u loss_u 0.9224 (0.9683) acc_u 9.3750 (3.7500) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [35/41] time 0.350 (0.345) data 0.271 (0.266) loss_u loss_u 0.9521 (0.9673) acc_u 9.3750 (4.0179) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [40/41] time 0.306 (0.344) data 0.228 (0.265) loss_u loss_u 0.9258 (0.9677) acc_u 9.3750 (3.9844) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 591
confident_label rate tensor(0.1857, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 303
clean true:292
clean false:11
clean_rate:0.9636963696369637
noisy true:749
noisy false:580
after delete: len(clean_dataset) 303
after delete: len(noisy_dataset) 1329
epoch [33/200] batch [5/9] time 0.333 (0.339) data 0.255 (0.261) loss_x loss_x 0.3660 (0.6263) acc_x 90.6250 (87.5000) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [5/41] time 0.337 (0.329) data 0.259 (0.250) loss_u loss_u 0.9985 (0.9659) acc_u 0.0000 (3.7500) lr 1.8838e-03 eta 0:00:11
epoch [33/200] batch [10/41] time 0.344 (0.335) data 0.266 (0.257) loss_u loss_u 0.9629 (0.9727) acc_u 6.2500 (3.7500) lr 1.8838e-03 eta 0:00:10
epoch [33/200] batch [15/41] time 0.358 (0.339) data 0.279 (0.261) loss_u loss_u 0.9556 (0.9710) acc_u 3.1250 (3.7500) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [20/41] time 0.353 (0.342) data 0.274 (0.263) loss_u loss_u 0.9976 (0.9726) acc_u 0.0000 (3.4375) lr 1.8838e-03 eta 0:00:07
epoch [33/200] batch [25/41] time 0.337 (0.341) data 0.259 (0.263) loss_u loss_u 0.9819 (0.9743) acc_u 3.1250 (3.2500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [30/41] time 0.348 (0.342) data 0.270 (0.264) loss_u loss_u 0.9390 (0.9729) acc_u 6.2500 (3.3333) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [35/41] time 0.346 (0.342) data 0.268 (0.264) loss_u loss_u 0.9507 (0.9729) acc_u 6.2500 (3.3036) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [40/41] time 0.340 (0.343) data 0.261 (0.265) loss_u loss_u 0.9912 (0.9733) acc_u 0.0000 (3.2812) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 586
confident_label rate tensor(0.1826, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 298
clean true:282
clean false:16
clean_rate:0.9463087248322147
noisy true:764
noisy false:570
after delete: len(clean_dataset) 298
after delete: len(noisy_dataset) 1334
epoch [34/200] batch [5/9] time 0.350 (0.338) data 0.272 (0.259) loss_x loss_x 0.6479 (0.8063) acc_x 84.3750 (81.8750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [5/41] time 0.346 (0.344) data 0.267 (0.265) loss_u loss_u 0.9287 (0.9617) acc_u 9.3750 (5.0000) lr 1.8763e-03 eta 0:00:12
epoch [34/200] batch [10/41] time 0.338 (0.345) data 0.259 (0.267) loss_u loss_u 0.9062 (0.9555) acc_u 9.3750 (5.3125) lr 1.8763e-03 eta 0:00:10
epoch [34/200] batch [15/41] time 0.335 (0.345) data 0.256 (0.266) loss_u loss_u 0.9409 (0.9592) acc_u 6.2500 (4.7917) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [20/41] time 0.332 (0.344) data 0.254 (0.266) loss_u loss_u 0.9775 (0.9588) acc_u 3.1250 (5.0000) lr 1.8763e-03 eta 0:00:07
epoch [34/200] batch [25/41] time 0.354 (0.345) data 0.275 (0.267) loss_u loss_u 0.9673 (0.9584) acc_u 3.1250 (4.8750) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [30/41] time 0.347 (0.345) data 0.267 (0.266) loss_u loss_u 0.9751 (0.9622) acc_u 3.1250 (4.3750) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [35/41] time 0.356 (0.345) data 0.278 (0.266) loss_u loss_u 0.9883 (0.9633) acc_u 3.1250 (4.4643) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [40/41] time 0.302 (0.344) data 0.222 (0.265) loss_u loss_u 0.9248 (0.9626) acc_u 9.3750 (4.4531) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 585
confident_label rate tensor(0.1795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 293
clean true:283
clean false:10
clean_rate:0.9658703071672355
noisy true:764
noisy false:575
after delete: len(clean_dataset) 293
after delete: len(noisy_dataset) 1339
epoch [35/200] batch [5/9] time 0.310 (0.324) data 0.233 (0.246) loss_x loss_x 0.5483 (0.3978) acc_x 87.5000 (91.8750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [5/41] time 0.361 (0.345) data 0.282 (0.266) loss_u loss_u 0.9834 (0.9797) acc_u 3.1250 (2.5000) lr 1.8686e-03 eta 0:00:12
epoch [35/200] batch [10/41] time 0.340 (0.346) data 0.261 (0.268) loss_u loss_u 0.9585 (0.9724) acc_u 6.2500 (3.4375) lr 1.8686e-03 eta 0:00:10
epoch [35/200] batch [15/41] time 0.337 (0.345) data 0.259 (0.267) loss_u loss_u 0.9736 (0.9694) acc_u 3.1250 (3.5417) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [20/41] time 0.337 (0.344) data 0.258 (0.266) loss_u loss_u 0.9712 (0.9686) acc_u 3.1250 (3.5938) lr 1.8686e-03 eta 0:00:07
epoch [35/200] batch [25/41] time 0.356 (0.346) data 0.278 (0.268) loss_u loss_u 0.9985 (0.9694) acc_u 0.0000 (3.7500) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [30/41] time 0.353 (0.347) data 0.275 (0.268) loss_u loss_u 0.9390 (0.9684) acc_u 6.2500 (3.8542) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [35/41] time 0.355 (0.347) data 0.277 (0.269) loss_u loss_u 0.9961 (0.9674) acc_u 0.0000 (3.9286) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [40/41] time 0.338 (0.347) data 0.260 (0.269) loss_u loss_u 0.9761 (0.9670) acc_u 6.2500 (3.9844) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 606
confident_label rate tensor(0.1777, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 290
clean true:277
clean false:13
clean_rate:0.9551724137931035
noisy true:749
noisy false:593
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 1342
epoch [36/200] batch [5/9] time 0.378 (0.354) data 0.299 (0.275) loss_x loss_x 0.2629 (0.4203) acc_x 96.8750 (91.8750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [5/41] time 0.336 (0.348) data 0.258 (0.269) loss_u loss_u 0.8535 (0.9479) acc_u 18.7500 (6.2500) lr 1.8607e-03 eta 0:00:12
epoch [36/200] batch [10/41] time 0.376 (0.354) data 0.297 (0.275) loss_u loss_u 0.9990 (0.9588) acc_u 0.0000 (5.0000) lr 1.8607e-03 eta 0:00:10
epoch [36/200] batch [15/41] time 0.339 (0.355) data 0.261 (0.277) loss_u loss_u 0.9404 (0.9567) acc_u 6.2500 (5.2083) lr 1.8607e-03 eta 0:00:09
epoch [36/200] batch [20/41] time 0.363 (0.355) data 0.284 (0.276) loss_u loss_u 0.9995 (0.9597) acc_u 0.0000 (4.6875) lr 1.8607e-03 eta 0:00:07
epoch [36/200] batch [25/41] time 0.331 (0.353) data 0.253 (0.274) loss_u loss_u 0.9771 (0.9606) acc_u 0.0000 (4.5000) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [30/41] time 0.340 (0.351) data 0.262 (0.273) loss_u loss_u 0.9326 (0.9610) acc_u 9.3750 (4.5833) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [35/41] time 0.331 (0.350) data 0.253 (0.272) loss_u loss_u 0.9019 (0.9619) acc_u 12.5000 (4.4643) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [40/41] time 0.305 (0.345) data 0.226 (0.266) loss_u loss_u 0.9395 (0.9627) acc_u 6.2500 (4.2969) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 569
confident_label rate tensor(0.1875, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 306
clean true:294
clean false:12
clean_rate:0.9607843137254902
noisy true:769
noisy false:557
after delete: len(clean_dataset) 306
after delete: len(noisy_dataset) 1326
epoch [37/200] batch [5/9] time 0.319 (0.344) data 0.241 (0.266) loss_x loss_x 0.6211 (0.5985) acc_x 84.3750 (88.7500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [5/41] time 0.361 (0.348) data 0.283 (0.270) loss_u loss_u 0.9995 (0.9812) acc_u 0.0000 (3.1250) lr 1.8526e-03 eta 0:00:12
epoch [37/200] batch [10/41] time 0.357 (0.354) data 0.278 (0.276) loss_u loss_u 0.9736 (0.9816) acc_u 3.1250 (2.8125) lr 1.8526e-03 eta 0:00:10
epoch [37/200] batch [15/41] time 0.404 (0.359) data 0.325 (0.281) loss_u loss_u 0.9058 (0.9736) acc_u 9.3750 (3.3333) lr 1.8526e-03 eta 0:00:09
epoch [37/200] batch [20/41] time 0.440 (0.365) data 0.361 (0.287) loss_u loss_u 0.9961 (0.9711) acc_u 0.0000 (3.5938) lr 1.8526e-03 eta 0:00:07
epoch [37/200] batch [25/41] time 0.435 (0.366) data 0.357 (0.288) loss_u loss_u 0.9790 (0.9729) acc_u 3.1250 (3.3750) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [30/41] time 0.370 (0.366) data 0.291 (0.288) loss_u loss_u 0.9658 (0.9737) acc_u 3.1250 (3.2292) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [35/41] time 0.350 (0.365) data 0.272 (0.287) loss_u loss_u 0.9688 (0.9730) acc_u 3.1250 (3.2143) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [40/41] time 0.349 (0.363) data 0.269 (0.285) loss_u loss_u 0.9990 (0.9726) acc_u 0.0000 (3.2812) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 580
confident_label rate tensor(0.1918, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 313
clean true:303
clean false:10
clean_rate:0.9680511182108626
noisy true:749
noisy false:570
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 1319
epoch [38/200] batch [5/9] time 0.383 (0.365) data 0.305 (0.287) loss_x loss_x 0.3230 (0.4454) acc_x 93.7500 (93.1250) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [5/41] time 0.371 (0.369) data 0.293 (0.291) loss_u loss_u 0.9917 (0.9841) acc_u 0.0000 (1.8750) lr 1.8443e-03 eta 0:00:13
epoch [38/200] batch [10/41] time 0.345 (0.367) data 0.267 (0.289) loss_u loss_u 0.9575 (0.9577) acc_u 6.2500 (5.3125) lr 1.8443e-03 eta 0:00:11
epoch [38/200] batch [15/41] time 0.362 (0.366) data 0.283 (0.288) loss_u loss_u 0.9971 (0.9605) acc_u 0.0000 (4.5833) lr 1.8443e-03 eta 0:00:09
epoch [38/200] batch [20/41] time 0.356 (0.364) data 0.278 (0.285) loss_u loss_u 0.9722 (0.9671) acc_u 3.1250 (3.7500) lr 1.8443e-03 eta 0:00:07
epoch [38/200] batch [25/41] time 0.367 (0.365) data 0.289 (0.286) loss_u loss_u 0.9971 (0.9706) acc_u 0.0000 (3.3750) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [30/41] time 0.305 (0.361) data 0.227 (0.283) loss_u loss_u 1.0000 (0.9716) acc_u 0.0000 (3.3333) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [35/41] time 0.348 (0.356) data 0.270 (0.278) loss_u loss_u 0.9556 (0.9723) acc_u 9.3750 (3.3036) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [40/41] time 0.367 (0.357) data 0.289 (0.279) loss_u loss_u 0.9839 (0.9737) acc_u 3.1250 (3.1250) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 574
confident_label rate tensor(0.1887, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 308
clean true:296
clean false:12
clean_rate:0.961038961038961
noisy true:762
noisy false:562
after delete: len(clean_dataset) 308
after delete: len(noisy_dataset) 1324
epoch [39/200] batch [5/9] time 0.350 (0.317) data 0.272 (0.239) loss_x loss_x 0.3787 (0.4784) acc_x 87.5000 (85.6250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [5/41] time 0.356 (0.342) data 0.278 (0.264) loss_u loss_u 0.9873 (0.9592) acc_u 3.1250 (5.0000) lr 1.8358e-03 eta 0:00:12
epoch [39/200] batch [10/41] time 0.373 (0.349) data 0.294 (0.271) loss_u loss_u 0.9658 (0.9681) acc_u 3.1250 (3.7500) lr 1.8358e-03 eta 0:00:10
epoch [39/200] batch [15/41] time 0.362 (0.354) data 0.284 (0.275) loss_u loss_u 0.9570 (0.9666) acc_u 6.2500 (4.1667) lr 1.8358e-03 eta 0:00:09
epoch [39/200] batch [20/41] time 0.404 (0.355) data 0.325 (0.276) loss_u loss_u 0.9575 (0.9708) acc_u 6.2500 (3.4375) lr 1.8358e-03 eta 0:00:07
epoch [39/200] batch [25/41] time 0.368 (0.355) data 0.290 (0.276) loss_u loss_u 0.9971 (0.9706) acc_u 0.0000 (3.3750) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [30/41] time 0.374 (0.355) data 0.295 (0.276) loss_u loss_u 0.8975 (0.9669) acc_u 12.5000 (3.9583) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [35/41] time 0.306 (0.352) data 0.228 (0.274) loss_u loss_u 0.9805 (0.9686) acc_u 3.1250 (3.8393) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [40/41] time 0.320 (0.350) data 0.242 (0.271) loss_u loss_u 0.9961 (0.9709) acc_u 0.0000 (3.5156) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 550
confident_label rate tensor(0.1961, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 320
clean true:305
clean false:15
clean_rate:0.953125
noisy true:777
noisy false:535
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 1312
epoch [40/200] batch [5/10] time 0.313 (0.330) data 0.235 (0.252) loss_x loss_x 0.4182 (0.4569) acc_x 90.6250 (90.0000) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [10/10] time 0.374 (0.339) data 0.296 (0.261) loss_x loss_x 0.4167 (0.5456) acc_x 93.7500 (88.7500) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/41] time 0.342 (0.343) data 0.263 (0.265) loss_u loss_u 0.9951 (0.9824) acc_u 0.0000 (2.5000) lr 1.8271e-03 eta 0:00:12
epoch [40/200] batch [10/41] time 0.371 (0.347) data 0.293 (0.269) loss_u loss_u 0.9966 (0.9855) acc_u 0.0000 (2.1875) lr 1.8271e-03 eta 0:00:10
epoch [40/200] batch [15/41] time 0.387 (0.351) data 0.308 (0.273) loss_u loss_u 0.9419 (0.9699) acc_u 6.2500 (4.1667) lr 1.8271e-03 eta 0:00:09
epoch [40/200] batch [20/41] time 0.389 (0.352) data 0.311 (0.274) loss_u loss_u 0.9658 (0.9724) acc_u 3.1250 (3.5938) lr 1.8271e-03 eta 0:00:07
epoch [40/200] batch [25/41] time 0.335 (0.353) data 0.257 (0.275) loss_u loss_u 0.9922 (0.9721) acc_u 0.0000 (3.5000) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [30/41] time 0.352 (0.353) data 0.272 (0.275) loss_u loss_u 0.9702 (0.9752) acc_u 3.1250 (3.1250) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [35/41] time 0.307 (0.348) data 0.228 (0.269) loss_u loss_u 0.9482 (0.9730) acc_u 6.2500 (3.4821) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [40/41] time 0.369 (0.347) data 0.290 (0.269) loss_u loss_u 0.9878 (0.9751) acc_u 0.0000 (3.1250) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.1942, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 317
clean true:303
clean false:14
clean_rate:0.9558359621451105
noisy true:780
noisy false:535
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 1315
epoch [41/200] batch [5/9] time 0.300 (0.337) data 0.222 (0.258) loss_x loss_x 0.4395 (0.4769) acc_x 87.5000 (88.1250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [5/41] time 0.363 (0.347) data 0.285 (0.269) loss_u loss_u 0.9614 (0.9700) acc_u 6.2500 (3.1250) lr 1.8181e-03 eta 0:00:12
epoch [41/200] batch [10/41] time 0.396 (0.354) data 0.316 (0.275) loss_u loss_u 0.9692 (0.9705) acc_u 3.1250 (3.1250) lr 1.8181e-03 eta 0:00:10
epoch [41/200] batch [15/41] time 0.343 (0.354) data 0.265 (0.276) loss_u loss_u 0.9385 (0.9705) acc_u 6.2500 (3.1250) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [20/41] time 0.366 (0.356) data 0.288 (0.278) loss_u loss_u 0.9775 (0.9681) acc_u 3.1250 (3.4375) lr 1.8181e-03 eta 0:00:07
epoch [41/200] batch [25/41] time 0.361 (0.357) data 0.282 (0.278) loss_u loss_u 0.9517 (0.9711) acc_u 6.2500 (3.1250) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [30/41] time 0.355 (0.356) data 0.276 (0.277) loss_u loss_u 0.9590 (0.9731) acc_u 6.2500 (3.0208) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [35/41] time 0.378 (0.354) data 0.299 (0.275) loss_u loss_u 0.9985 (0.9739) acc_u 0.0000 (2.9464) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [40/41] time 0.347 (0.353) data 0.269 (0.275) loss_u loss_u 0.9727 (0.9754) acc_u 3.1250 (2.7344) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 575
confident_label rate tensor(0.1973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 322
clean true:309
clean false:13
clean_rate:0.9596273291925466
noisy true:748
noisy false:562
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 1310
epoch [42/200] batch [5/10] time 0.359 (0.356) data 0.280 (0.277) loss_x loss_x 0.5288 (0.4962) acc_x 87.5000 (86.2500) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/10] time 0.339 (0.351) data 0.260 (0.273) loss_x loss_x 0.7202 (0.5891) acc_x 87.5000 (85.9375) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/40] time 0.347 (0.351) data 0.266 (0.273) loss_u loss_u 0.9341 (0.9713) acc_u 6.2500 (2.5000) lr 1.8090e-03 eta 0:00:12
epoch [42/200] batch [10/40] time 0.351 (0.351) data 0.273 (0.272) loss_u loss_u 0.9951 (0.9725) acc_u 0.0000 (2.8125) lr 1.8090e-03 eta 0:00:10
epoch [42/200] batch [15/40] time 0.347 (0.354) data 0.269 (0.275) loss_u loss_u 0.9863 (0.9724) acc_u 0.0000 (2.9167) lr 1.8090e-03 eta 0:00:08
epoch [42/200] batch [20/40] time 0.336 (0.356) data 0.256 (0.277) loss_u loss_u 0.9751 (0.9760) acc_u 3.1250 (2.8125) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [25/40] time 0.354 (0.355) data 0.276 (0.276) loss_u loss_u 0.9780 (0.9769) acc_u 3.1250 (2.6250) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [30/40] time 0.305 (0.353) data 0.226 (0.274) loss_u loss_u 0.9707 (0.9739) acc_u 3.1250 (3.0208) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [35/40] time 0.363 (0.350) data 0.284 (0.271) loss_u loss_u 0.9980 (0.9754) acc_u 0.0000 (2.7679) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [40/40] time 0.346 (0.350) data 0.268 (0.272) loss_u loss_u 0.9688 (0.9726) acc_u 6.2500 (3.1250) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 567
confident_label rate tensor(0.1991, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 325
clean true:308
clean false:17
clean_rate:0.9476923076923077
noisy true:757
noisy false:550
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 1307
epoch [43/200] batch [5/10] time 0.428 (0.358) data 0.351 (0.279) loss_x loss_x 0.7300 (0.4980) acc_x 84.3750 (88.7500) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/10] time 0.363 (0.420) data 0.284 (0.341) loss_x loss_x 0.8071 (0.5582) acc_x 81.2500 (87.8125) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/40] time 0.385 (0.402) data 0.306 (0.323) loss_u loss_u 0.9443 (0.9583) acc_u 6.2500 (5.0000) lr 1.7997e-03 eta 0:00:14
epoch [43/200] batch [10/40] time 0.334 (0.386) data 0.256 (0.308) loss_u loss_u 0.9707 (0.9670) acc_u 3.1250 (3.7500) lr 1.7997e-03 eta 0:00:11
epoch [43/200] batch [15/40] time 0.346 (0.382) data 0.267 (0.304) loss_u loss_u 0.9985 (0.9659) acc_u 0.0000 (3.9583) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [20/40] time 0.342 (0.377) data 0.264 (0.298) loss_u loss_u 0.9536 (0.9647) acc_u 6.2500 (4.2188) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [25/40] time 0.386 (0.374) data 0.308 (0.295) loss_u loss_u 0.9668 (0.9699) acc_u 3.1250 (3.5000) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [30/40] time 0.340 (0.374) data 0.261 (0.295) loss_u loss_u 0.9688 (0.9728) acc_u 3.1250 (3.1250) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [35/40] time 0.329 (0.370) data 0.250 (0.292) loss_u loss_u 0.9448 (0.9726) acc_u 6.2500 (3.1250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [40/40] time 0.356 (0.372) data 0.276 (0.293) loss_u loss_u 0.9980 (0.9747) acc_u 0.0000 (2.9688) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 526
confident_label rate tensor(0.2016, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 329
clean true:310
clean false:19
clean_rate:0.9422492401215805
noisy true:796
noisy false:507
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1303
epoch [44/200] batch [5/10] time 0.350 (0.332) data 0.272 (0.253) loss_x loss_x 0.6743 (0.6430) acc_x 90.6250 (85.6250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/10] time 0.337 (0.340) data 0.259 (0.262) loss_x loss_x 0.6914 (0.5574) acc_x 81.2500 (87.5000) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/40] time 0.366 (0.345) data 0.286 (0.267) loss_u loss_u 0.9810 (0.9859) acc_u 3.1250 (2.5000) lr 1.7902e-03 eta 0:00:12
epoch [44/200] batch [10/40] time 0.330 (0.345) data 0.252 (0.267) loss_u loss_u 0.9922 (0.9806) acc_u 0.0000 (2.5000) lr 1.7902e-03 eta 0:00:10
epoch [44/200] batch [15/40] time 0.344 (0.343) data 0.265 (0.265) loss_u loss_u 0.9468 (0.9742) acc_u 6.2500 (3.1250) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [20/40] time 0.342 (0.346) data 0.264 (0.268) loss_u loss_u 0.9956 (0.9758) acc_u 0.0000 (2.9688) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [25/40] time 0.338 (0.347) data 0.259 (0.268) loss_u loss_u 0.9688 (0.9746) acc_u 3.1250 (3.0000) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [30/40] time 0.317 (0.345) data 0.238 (0.267) loss_u loss_u 0.9990 (0.9760) acc_u 0.0000 (2.8125) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [35/40] time 0.337 (0.345) data 0.257 (0.267) loss_u loss_u 0.9746 (0.9756) acc_u 3.1250 (2.8571) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [40/40] time 0.318 (0.344) data 0.239 (0.265) loss_u loss_u 0.9702 (0.9757) acc_u 3.1250 (2.8906) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 551
confident_label rate tensor(0.1949, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 318
clean true:304
clean false:14
clean_rate:0.9559748427672956
noisy true:777
noisy false:537
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1314
epoch [45/200] batch [5/9] time 0.345 (0.326) data 0.267 (0.248) loss_x loss_x 0.4014 (0.5055) acc_x 90.6250 (89.3750) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [5/41] time 0.362 (0.345) data 0.283 (0.267) loss_u loss_u 0.9712 (0.9583) acc_u 3.1250 (4.3750) lr 1.7804e-03 eta 0:00:12
epoch [45/200] batch [10/41] time 0.346 (0.349) data 0.268 (0.271) loss_u loss_u 0.9355 (0.9603) acc_u 9.3750 (4.3750) lr 1.7804e-03 eta 0:00:10
epoch [45/200] batch [15/41] time 0.369 (0.352) data 0.291 (0.274) loss_u loss_u 0.9985 (0.9630) acc_u 0.0000 (3.9583) lr 1.7804e-03 eta 0:00:09
epoch [45/200] batch [20/41] time 0.357 (0.352) data 0.279 (0.274) loss_u loss_u 0.9971 (0.9673) acc_u 0.0000 (3.4375) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [25/41] time 0.365 (0.354) data 0.287 (0.276) loss_u loss_u 0.9976 (0.9698) acc_u 0.0000 (3.2500) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [30/41] time 0.350 (0.354) data 0.272 (0.276) loss_u loss_u 0.9678 (0.9700) acc_u 3.1250 (3.4375) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [35/41] time 0.384 (0.355) data 0.305 (0.276) loss_u loss_u 0.9751 (0.9695) acc_u 3.1250 (3.4821) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [40/41] time 0.384 (0.356) data 0.305 (0.278) loss_u loss_u 0.9785 (0.9693) acc_u 3.1250 (3.5156) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 547
confident_label rate tensor(0.1942, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 317
clean true:303
clean false:14
clean_rate:0.9558359621451105
noisy true:782
noisy false:533
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 1315
epoch [46/200] batch [5/9] time 0.349 (0.354) data 0.271 (0.276) loss_x loss_x 0.3176 (0.6775) acc_x 90.6250 (86.8750) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [5/41] time 0.338 (0.346) data 0.260 (0.268) loss_u loss_u 0.9556 (0.9680) acc_u 6.2500 (3.7500) lr 1.7705e-03 eta 0:00:12
epoch [46/200] batch [10/41] time 0.365 (0.347) data 0.287 (0.269) loss_u loss_u 0.9902 (0.9667) acc_u 0.0000 (4.0625) lr 1.7705e-03 eta 0:00:10
epoch [46/200] batch [15/41] time 0.372 (0.351) data 0.294 (0.272) loss_u loss_u 0.9512 (0.9657) acc_u 9.3750 (4.1667) lr 1.7705e-03 eta 0:00:09
epoch [46/200] batch [20/41] time 0.328 (0.349) data 0.248 (0.271) loss_u loss_u 0.9551 (0.9626) acc_u 6.2500 (4.3750) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [25/41] time 0.328 (0.347) data 0.250 (0.269) loss_u loss_u 0.9980 (0.9647) acc_u 0.0000 (4.1250) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [30/41] time 0.352 (0.346) data 0.274 (0.267) loss_u loss_u 0.9590 (0.9674) acc_u 3.1250 (3.7500) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [35/41] time 0.347 (0.346) data 0.269 (0.268) loss_u loss_u 0.9883 (0.9683) acc_u 3.1250 (3.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [40/41] time 0.294 (0.345) data 0.215 (0.266) loss_u loss_u 0.9863 (0.9698) acc_u 0.0000 (3.5156) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 595
confident_label rate tensor(0.1991, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 325
clean true:304
clean false:21
clean_rate:0.9353846153846154
noisy true:733
noisy false:574
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 1307
epoch [47/200] batch [5/10] time 0.347 (0.354) data 0.269 (0.275) loss_x loss_x 0.3083 (0.6214) acc_x 93.7500 (84.3750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/10] time 0.357 (0.355) data 0.278 (0.277) loss_x loss_x 1.0752 (0.6191) acc_x 75.0000 (85.6250) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/40] time 0.366 (0.356) data 0.288 (0.278) loss_u loss_u 0.9785 (0.9687) acc_u 3.1250 (3.7500) lr 1.7604e-03 eta 0:00:12
epoch [47/200] batch [10/40] time 0.336 (0.354) data 0.258 (0.276) loss_u loss_u 0.9390 (0.9704) acc_u 9.3750 (3.4375) lr 1.7604e-03 eta 0:00:10
epoch [47/200] batch [15/40] time 0.332 (0.352) data 0.253 (0.274) loss_u loss_u 0.9878 (0.9738) acc_u 0.0000 (2.9167) lr 1.7604e-03 eta 0:00:08
epoch [47/200] batch [20/40] time 0.346 (0.350) data 0.268 (0.272) loss_u loss_u 0.9966 (0.9758) acc_u 0.0000 (2.6562) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [25/40] time 0.339 (0.350) data 0.261 (0.271) loss_u loss_u 0.9512 (0.9727) acc_u 6.2500 (3.0000) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [30/40] time 0.353 (0.349) data 0.274 (0.271) loss_u loss_u 0.9810 (0.9709) acc_u 3.1250 (3.3333) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [35/40] time 0.330 (0.345) data 0.252 (0.266) loss_u loss_u 0.9463 (0.9714) acc_u 6.2500 (3.3036) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [40/40] time 0.342 (0.343) data 0.263 (0.265) loss_u loss_u 0.9810 (0.9734) acc_u 3.1250 (3.0469) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 550
confident_label rate tensor(0.1949, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 318
clean true:308
clean false:10
clean_rate:0.9685534591194969
noisy true:774
noisy false:540
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1314
epoch [48/200] batch [5/9] time 0.351 (0.359) data 0.273 (0.282) loss_x loss_x 0.9077 (0.5547) acc_x 87.5000 (90.0000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [5/41] time 0.354 (0.354) data 0.275 (0.276) loss_u loss_u 0.9429 (0.9640) acc_u 6.2500 (4.3750) lr 1.7501e-03 eta 0:00:12
epoch [48/200] batch [10/41] time 0.306 (0.349) data 0.228 (0.271) loss_u loss_u 0.9663 (0.9771) acc_u 3.1250 (2.5000) lr 1.7501e-03 eta 0:00:10
epoch [48/200] batch [15/41] time 0.365 (0.348) data 0.287 (0.270) loss_u loss_u 0.9727 (0.9742) acc_u 3.1250 (2.9167) lr 1.7501e-03 eta 0:00:09
epoch [48/200] batch [20/41] time 0.346 (0.348) data 0.267 (0.270) loss_u loss_u 0.9697 (0.9738) acc_u 6.2500 (3.2812) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [25/41] time 0.355 (0.350) data 0.277 (0.271) loss_u loss_u 0.9604 (0.9721) acc_u 6.2500 (3.5000) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [30/41] time 0.343 (0.349) data 0.264 (0.270) loss_u loss_u 0.9600 (0.9721) acc_u 6.2500 (3.5417) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [35/41] time 0.301 (0.345) data 0.222 (0.266) loss_u loss_u 0.9590 (0.9734) acc_u 3.1250 (3.3929) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [40/41] time 0.305 (0.343) data 0.226 (0.265) loss_u loss_u 0.9805 (0.9744) acc_u 6.2500 (3.2812) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 556
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 319
clean true:304
clean false:15
clean_rate:0.9529780564263323
noisy true:772
noisy false:541
after delete: len(clean_dataset) 319
after delete: len(noisy_dataset) 1313
epoch [49/200] batch [5/9] time 0.346 (0.358) data 0.268 (0.280) loss_x loss_x 0.6611 (0.7630) acc_x 87.5000 (85.6250) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [5/41] time 0.342 (0.360) data 0.262 (0.282) loss_u loss_u 0.9805 (0.9603) acc_u 3.1250 (4.3750) lr 1.7396e-03 eta 0:00:12
epoch [49/200] batch [10/41] time 0.362 (0.359) data 0.284 (0.280) loss_u loss_u 0.9326 (0.9646) acc_u 6.2500 (3.7500) lr 1.7396e-03 eta 0:00:11
epoch [49/200] batch [15/41] time 0.318 (0.359) data 0.240 (0.280) loss_u loss_u 0.9458 (0.9658) acc_u 6.2500 (3.5417) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [20/41] time 0.345 (0.358) data 0.266 (0.279) loss_u loss_u 0.9976 (0.9718) acc_u 0.0000 (2.9688) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [25/41] time 0.343 (0.356) data 0.264 (0.277) loss_u loss_u 0.9531 (0.9707) acc_u 6.2500 (3.2500) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [30/41] time 0.348 (0.353) data 0.268 (0.274) loss_u loss_u 0.9976 (0.9708) acc_u 0.0000 (3.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [35/41] time 0.372 (0.353) data 0.294 (0.274) loss_u loss_u 0.9995 (0.9701) acc_u 0.0000 (3.2143) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [40/41] time 0.299 (0.349) data 0.221 (0.270) loss_u loss_u 0.9219 (0.9705) acc_u 9.3750 (3.1250) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 531
confident_label rate tensor(0.1936, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 316
clean true:303
clean false:13
clean_rate:0.9588607594936709
noisy true:798
noisy false:518
after delete: len(clean_dataset) 316
after delete: len(noisy_dataset) 1316
epoch [50/200] batch [5/9] time 0.358 (0.352) data 0.281 (0.274) loss_x loss_x 0.8813 (0.7200) acc_x 81.2500 (82.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [5/41] time 0.363 (0.349) data 0.285 (0.270) loss_u loss_u 0.9990 (0.9641) acc_u 0.0000 (3.7500) lr 1.7290e-03 eta 0:00:12
epoch [50/200] batch [10/41] time 0.336 (0.350) data 0.258 (0.272) loss_u loss_u 0.9941 (0.9735) acc_u 0.0000 (2.8125) lr 1.7290e-03 eta 0:00:10
epoch [50/200] batch [15/41] time 0.364 (0.350) data 0.283 (0.272) loss_u loss_u 0.9248 (0.9711) acc_u 9.3750 (3.1250) lr 1.7290e-03 eta 0:00:09
epoch [50/200] batch [20/41] time 0.355 (0.351) data 0.277 (0.273) loss_u loss_u 0.9810 (0.9729) acc_u 3.1250 (3.1250) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [25/41] time 0.341 (0.350) data 0.263 (0.272) loss_u loss_u 0.9858 (0.9714) acc_u 0.0000 (3.2500) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [30/41] time 0.342 (0.350) data 0.264 (0.271) loss_u loss_u 0.9951 (0.9715) acc_u 0.0000 (3.2292) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [35/41] time 0.350 (0.349) data 0.272 (0.271) loss_u loss_u 0.9673 (0.9719) acc_u 3.1250 (3.2143) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [40/41] time 0.293 (0.344) data 0.214 (0.266) loss_u loss_u 0.9600 (0.9711) acc_u 6.2500 (3.2812) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 526
confident_label rate tensor(0.2022, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 330
clean true:312
clean false:18
clean_rate:0.9454545454545454
noisy true:794
noisy false:508
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 1302
epoch [51/200] batch [5/10] time 0.381 (0.370) data 0.303 (0.292) loss_x loss_x 0.4329 (0.5726) acc_x 87.5000 (88.1250) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/10] time 0.349 (0.363) data 0.271 (0.284) loss_x loss_x 0.4280 (0.4998) acc_x 87.5000 (90.3125) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/40] time 0.384 (0.360) data 0.305 (0.282) loss_u loss_u 0.9990 (0.9886) acc_u 0.0000 (0.6250) lr 1.7181e-03 eta 0:00:12
epoch [51/200] batch [10/40] time 0.353 (0.358) data 0.275 (0.279) loss_u loss_u 0.9106 (0.9762) acc_u 9.3750 (2.5000) lr 1.7181e-03 eta 0:00:10
epoch [51/200] batch [15/40] time 0.343 (0.356) data 0.264 (0.277) loss_u loss_u 0.9771 (0.9753) acc_u 3.1250 (2.5000) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [20/40] time 0.345 (0.356) data 0.266 (0.278) loss_u loss_u 0.9751 (0.9771) acc_u 3.1250 (2.3438) lr 1.7181e-03 eta 0:00:07
epoch [51/200] batch [25/40] time 0.366 (0.356) data 0.288 (0.277) loss_u loss_u 0.9448 (0.9725) acc_u 6.2500 (3.0000) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [30/40] time 0.354 (0.356) data 0.276 (0.277) loss_u loss_u 0.9536 (0.9729) acc_u 6.2500 (3.0208) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [35/40] time 0.320 (0.353) data 0.242 (0.275) loss_u loss_u 0.9927 (0.9723) acc_u 0.0000 (3.0357) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [40/40] time 0.337 (0.352) data 0.258 (0.273) loss_u loss_u 0.9673 (0.9723) acc_u 3.1250 (3.0469) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 545
confident_label rate tensor(0.1991, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 325
clean true:307
clean false:18
clean_rate:0.9446153846153846
noisy true:780
noisy false:527
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 1307
epoch [52/200] batch [5/10] time 0.299 (0.329) data 0.221 (0.250) loss_x loss_x 0.4741 (0.4114) acc_x 87.5000 (90.0000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/10] time 0.348 (0.342) data 0.270 (0.263) loss_x loss_x 0.4211 (0.4800) acc_x 90.6250 (87.8125) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/40] time 0.353 (0.345) data 0.275 (0.267) loss_u loss_u 0.9937 (0.9829) acc_u 0.0000 (1.8750) lr 1.7071e-03 eta 0:00:12
epoch [52/200] batch [10/40] time 0.335 (0.346) data 0.257 (0.268) loss_u loss_u 0.9541 (0.9775) acc_u 3.1250 (2.1875) lr 1.7071e-03 eta 0:00:10
epoch [52/200] batch [15/40] time 0.337 (0.347) data 0.259 (0.268) loss_u loss_u 0.9961 (0.9705) acc_u 0.0000 (3.3333) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [20/40] time 0.352 (0.347) data 0.272 (0.268) loss_u loss_u 0.9517 (0.9736) acc_u 6.2500 (3.1250) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [25/40] time 0.345 (0.349) data 0.267 (0.271) loss_u loss_u 0.9805 (0.9737) acc_u 3.1250 (3.1250) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [30/40] time 0.296 (0.343) data 0.218 (0.265) loss_u loss_u 0.9678 (0.9717) acc_u 3.1250 (3.3333) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [35/40] time 0.327 (0.341) data 0.248 (0.263) loss_u loss_u 0.9932 (0.9734) acc_u 0.0000 (3.2143) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [40/40] time 0.320 (0.341) data 0.240 (0.262) loss_u loss_u 0.9316 (0.9726) acc_u 9.3750 (3.2812) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 533
confident_label rate tensor(0.2004, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 327
clean true:315
clean false:12
clean_rate:0.963302752293578
noisy true:784
noisy false:521
after delete: len(clean_dataset) 327
after delete: len(noisy_dataset) 1305
epoch [53/200] batch [5/10] time 0.316 (0.341) data 0.237 (0.263) loss_x loss_x 0.4812 (0.5028) acc_x 90.6250 (86.2500) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/10] time 0.359 (0.334) data 0.281 (0.256) loss_x loss_x 0.2620 (0.4627) acc_x 93.7500 (87.5000) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/40] time 0.339 (0.339) data 0.261 (0.261) loss_u loss_u 0.9766 (0.9783) acc_u 3.1250 (3.1250) lr 1.6959e-03 eta 0:00:11
epoch [53/200] batch [10/40] time 0.363 (0.343) data 0.284 (0.265) loss_u loss_u 0.9688 (0.9769) acc_u 3.1250 (3.7500) lr 1.6959e-03 eta 0:00:10
epoch [53/200] batch [15/40] time 0.355 (0.347) data 0.277 (0.269) loss_u loss_u 0.9912 (0.9763) acc_u 0.0000 (3.3333) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [20/40] time 0.368 (0.349) data 0.289 (0.271) loss_u loss_u 0.9717 (0.9759) acc_u 3.1250 (3.1250) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [25/40] time 0.377 (0.351) data 0.299 (0.273) loss_u loss_u 0.9961 (0.9785) acc_u 0.0000 (2.7500) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [30/40] time 0.338 (0.351) data 0.258 (0.273) loss_u loss_u 0.9644 (0.9753) acc_u 3.1250 (3.1250) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [35/40] time 0.351 (0.350) data 0.272 (0.271) loss_u loss_u 0.9673 (0.9741) acc_u 3.1250 (3.2143) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [40/40] time 0.345 (0.349) data 0.265 (0.271) loss_u loss_u 0.9961 (0.9751) acc_u 0.0000 (3.0469) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 531
confident_label rate tensor(0.2022, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 330
clean true:312
clean false:18
clean_rate:0.9454545454545454
noisy true:789
noisy false:513
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 1302
epoch [54/200] batch [5/10] time 0.354 (0.363) data 0.276 (0.284) loss_x loss_x 0.3933 (0.6038) acc_x 87.5000 (90.0000) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/10] time 0.339 (0.355) data 0.262 (0.277) loss_x loss_x 0.4199 (0.5341) acc_x 90.6250 (89.3750) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/40] time 0.344 (0.350) data 0.265 (0.272) loss_u loss_u 0.9976 (0.9845) acc_u 0.0000 (1.2500) lr 1.6845e-03 eta 0:00:12
epoch [54/200] batch [10/40] time 0.385 (0.353) data 0.306 (0.274) loss_u loss_u 0.9707 (0.9724) acc_u 3.1250 (2.8125) lr 1.6845e-03 eta 0:00:10
epoch [54/200] batch [15/40] time 0.367 (0.352) data 0.288 (0.274) loss_u loss_u 0.9990 (0.9795) acc_u 0.0000 (2.0833) lr 1.6845e-03 eta 0:00:08
epoch [54/200] batch [20/40] time 0.343 (0.352) data 0.265 (0.273) loss_u loss_u 0.9580 (0.9777) acc_u 3.1250 (2.3438) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [25/40] time 0.355 (0.351) data 0.276 (0.273) loss_u loss_u 0.9912 (0.9758) acc_u 0.0000 (2.6250) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [30/40] time 0.290 (0.348) data 0.212 (0.269) loss_u loss_u 0.9961 (0.9765) acc_u 0.0000 (2.6042) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [35/40] time 0.356 (0.345) data 0.277 (0.267) loss_u loss_u 0.9785 (0.9773) acc_u 3.1250 (2.6786) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [40/40] time 0.360 (0.347) data 0.282 (0.269) loss_u loss_u 0.9956 (0.9769) acc_u 3.1250 (2.7344) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 533
confident_label rate tensor(0.2028, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 331
clean true:314
clean false:17
clean_rate:0.9486404833836858
noisy true:785
noisy false:516
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1301
epoch [55/200] batch [5/10] time 0.363 (0.341) data 0.286 (0.263) loss_x loss_x 0.3103 (0.4556) acc_x 93.7500 (89.3750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/10] time 0.347 (0.345) data 0.269 (0.267) loss_x loss_x 0.4216 (0.5401) acc_x 93.7500 (88.1250) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/40] time 0.364 (0.351) data 0.286 (0.273) loss_u loss_u 0.9678 (0.9796) acc_u 3.1250 (1.8750) lr 1.6730e-03 eta 0:00:12
epoch [55/200] batch [10/40] time 0.380 (0.350) data 0.302 (0.272) loss_u loss_u 0.9995 (0.9765) acc_u 0.0000 (2.5000) lr 1.6730e-03 eta 0:00:10
epoch [55/200] batch [15/40] time 0.362 (0.350) data 0.283 (0.272) loss_u loss_u 0.9951 (0.9769) acc_u 0.0000 (2.2917) lr 1.6730e-03 eta 0:00:08
epoch [55/200] batch [20/40] time 0.349 (0.349) data 0.270 (0.271) loss_u loss_u 0.9751 (0.9748) acc_u 3.1250 (2.6562) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [25/40] time 0.340 (0.348) data 0.262 (0.270) loss_u loss_u 0.9697 (0.9732) acc_u 3.1250 (2.8750) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [30/40] time 0.300 (0.347) data 0.221 (0.269) loss_u loss_u 0.9985 (0.9729) acc_u 0.0000 (2.9167) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [35/40] time 0.307 (0.342) data 0.228 (0.264) loss_u loss_u 0.9316 (0.9727) acc_u 6.2500 (3.0357) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [40/40] time 0.327 (0.341) data 0.249 (0.263) loss_u loss_u 0.9980 (0.9738) acc_u 0.0000 (2.8906) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 537
confident_label rate tensor(0.1985, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 324
clean true:308
clean false:16
clean_rate:0.9506172839506173
noisy true:787
noisy false:521
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 1308
epoch [56/200] batch [5/10] time 0.373 (0.346) data 0.295 (0.268) loss_x loss_x 0.4033 (0.4865) acc_x 90.6250 (88.7500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/10] time 0.336 (0.346) data 0.259 (0.269) loss_x loss_x 0.2437 (0.4335) acc_x 90.6250 (90.3125) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/40] time 0.340 (0.349) data 0.262 (0.271) loss_u loss_u 0.9614 (0.9785) acc_u 3.1250 (1.8750) lr 1.6613e-03 eta 0:00:12
epoch [56/200] batch [10/40] time 0.358 (0.348) data 0.280 (0.270) loss_u loss_u 0.9688 (0.9672) acc_u 6.2500 (3.4375) lr 1.6613e-03 eta 0:00:10
epoch [56/200] batch [15/40] time 0.340 (0.348) data 0.262 (0.270) loss_u loss_u 0.9961 (0.9717) acc_u 0.0000 (2.9167) lr 1.6613e-03 eta 0:00:08
epoch [56/200] batch [20/40] time 0.354 (0.348) data 0.275 (0.270) loss_u loss_u 0.9429 (0.9710) acc_u 6.2500 (3.1250) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [25/40] time 0.339 (0.348) data 0.261 (0.270) loss_u loss_u 0.9961 (0.9747) acc_u 0.0000 (2.6250) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [30/40] time 0.349 (0.348) data 0.271 (0.270) loss_u loss_u 0.9648 (0.9722) acc_u 3.1250 (3.0208) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [35/40] time 0.302 (0.345) data 0.224 (0.267) loss_u loss_u 0.9604 (0.9727) acc_u 3.1250 (2.9464) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [40/40] time 0.349 (0.344) data 0.271 (0.266) loss_u loss_u 0.9814 (0.9735) acc_u 6.2500 (3.0469) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 514
confident_label rate tensor(0.2059, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 336
clean true:315
clean false:21
clean_rate:0.9375
noisy true:803
noisy false:493
after delete: len(clean_dataset) 336
after delete: len(noisy_dataset) 1296
epoch [57/200] batch [5/10] time 0.367 (0.351) data 0.289 (0.273) loss_x loss_x 0.4456 (0.4305) acc_x 93.7500 (93.7500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/10] time 0.424 (0.344) data 0.346 (0.266) loss_x loss_x 0.3442 (0.4712) acc_x 96.8750 (92.8125) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/40] time 0.367 (0.363) data 0.290 (0.285) loss_u loss_u 0.9961 (0.9914) acc_u 0.0000 (0.6250) lr 1.6494e-03 eta 0:00:12
epoch [57/200] batch [10/40] time 0.385 (0.364) data 0.307 (0.286) loss_u loss_u 0.9785 (0.9821) acc_u 3.1250 (1.8750) lr 1.6494e-03 eta 0:00:10
epoch [57/200] batch [15/40] time 0.345 (0.362) data 0.266 (0.283) loss_u loss_u 0.9995 (0.9871) acc_u 0.0000 (1.2500) lr 1.6494e-03 eta 0:00:09
epoch [57/200] batch [20/40] time 0.362 (0.359) data 0.284 (0.281) loss_u loss_u 0.9775 (0.9827) acc_u 3.1250 (1.7188) lr 1.6494e-03 eta 0:00:07
epoch [57/200] batch [25/40] time 0.345 (0.358) data 0.267 (0.280) loss_u loss_u 0.9463 (0.9754) acc_u 6.2500 (2.6250) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [30/40] time 0.345 (0.356) data 0.266 (0.278) loss_u loss_u 0.9995 (0.9767) acc_u 0.0000 (2.6042) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [35/40] time 0.311 (0.351) data 0.232 (0.273) loss_u loss_u 0.9663 (0.9761) acc_u 3.1250 (2.6786) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [40/40] time 0.352 (0.349) data 0.275 (0.270) loss_u loss_u 0.9893 (0.9776) acc_u 0.0000 (2.5781) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 500
confident_label rate tensor(0.2034, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 332
clean true:320
clean false:12
clean_rate:0.963855421686747
noisy true:812
noisy false:488
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1300
epoch [58/200] batch [5/10] time 0.362 (0.366) data 0.284 (0.288) loss_x loss_x 0.4634 (0.5447) acc_x 87.5000 (86.2500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/10] time 0.347 (0.364) data 0.269 (0.287) loss_x loss_x 0.5317 (0.4938) acc_x 84.3750 (88.1250) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/40] time 0.349 (0.357) data 0.271 (0.278) loss_u loss_u 0.9756 (0.9752) acc_u 3.1250 (2.5000) lr 1.6374e-03 eta 0:00:12
epoch [58/200] batch [10/40] time 0.351 (0.353) data 0.271 (0.275) loss_u loss_u 0.9956 (0.9727) acc_u 0.0000 (3.1250) lr 1.6374e-03 eta 0:00:10
epoch [58/200] batch [15/40] time 0.351 (0.353) data 0.273 (0.275) loss_u loss_u 0.9600 (0.9694) acc_u 6.2500 (3.3333) lr 1.6374e-03 eta 0:00:08
epoch [58/200] batch [20/40] time 0.331 (0.354) data 0.253 (0.276) loss_u loss_u 0.9810 (0.9727) acc_u 0.0000 (2.8125) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [25/40] time 0.365 (0.355) data 0.286 (0.276) loss_u loss_u 0.9668 (0.9709) acc_u 3.1250 (3.1250) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [30/40] time 0.342 (0.355) data 0.263 (0.277) loss_u loss_u 0.9956 (0.9724) acc_u 0.0000 (3.0208) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [35/40] time 0.336 (0.353) data 0.257 (0.274) loss_u loss_u 0.9956 (0.9744) acc_u 0.0000 (2.7679) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [40/40] time 0.327 (0.351) data 0.248 (0.273) loss_u loss_u 0.9014 (0.9728) acc_u 12.5000 (2.9688) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 531
confident_label rate tensor(0.2034, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 332
clean true:317
clean false:15
clean_rate:0.9548192771084337
noisy true:784
noisy false:516
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1300
epoch [59/200] batch [5/10] time 0.305 (0.328) data 0.227 (0.250) loss_x loss_x 0.3789 (0.3896) acc_x 93.7500 (92.5000) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/10] time 0.317 (0.320) data 0.239 (0.242) loss_x loss_x 0.3210 (0.4612) acc_x 93.7500 (89.6875) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/40] time 0.340 (0.317) data 0.262 (0.239) loss_u loss_u 0.9995 (0.9820) acc_u 0.0000 (1.8750) lr 1.6252e-03 eta 0:00:11
epoch [59/200] batch [10/40] time 0.345 (0.325) data 0.265 (0.247) loss_u loss_u 0.9595 (0.9792) acc_u 6.2500 (2.5000) lr 1.6252e-03 eta 0:00:09
epoch [59/200] batch [15/40] time 0.333 (0.329) data 0.254 (0.250) loss_u loss_u 0.9438 (0.9763) acc_u 6.2500 (2.7083) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [20/40] time 0.347 (0.332) data 0.268 (0.254) loss_u loss_u 0.9980 (0.9786) acc_u 0.0000 (2.5000) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [25/40] time 0.326 (0.332) data 0.246 (0.254) loss_u loss_u 0.9985 (0.9787) acc_u 0.0000 (2.3750) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [30/40] time 0.334 (0.334) data 0.256 (0.256) loss_u loss_u 0.9468 (0.9762) acc_u 6.2500 (2.6042) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [35/40] time 0.337 (0.336) data 0.259 (0.258) loss_u loss_u 0.9985 (0.9759) acc_u 0.0000 (2.5893) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [40/40] time 0.302 (0.335) data 0.224 (0.257) loss_u loss_u 0.9932 (0.9758) acc_u 3.1250 (2.7344) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 544
confident_label rate tensor(0.1973, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 322
clean true:306
clean false:16
clean_rate:0.9503105590062112
noisy true:782
noisy false:528
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 1310
epoch [60/200] batch [5/10] time 0.353 (0.354) data 0.276 (0.276) loss_x loss_x 0.1493 (0.4497) acc_x 100.0000 (88.7500) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/10] time 0.341 (0.338) data 0.263 (0.261) loss_x loss_x 0.7241 (0.5253) acc_x 81.2500 (85.6250) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/40] time 0.342 (0.331) data 0.264 (0.253) loss_u loss_u 0.9731 (0.9605) acc_u 3.1250 (4.3750) lr 1.6129e-03 eta 0:00:11
epoch [60/200] batch [10/40] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9814 (0.9670) acc_u 3.1250 (3.7500) lr 1.6129e-03 eta 0:00:10
epoch [60/200] batch [15/40] time 0.349 (0.339) data 0.271 (0.261) loss_u loss_u 0.9463 (0.9698) acc_u 9.3750 (3.7500) lr 1.6129e-03 eta 0:00:08
epoch [60/200] batch [20/40] time 0.342 (0.343) data 0.264 (0.264) loss_u loss_u 0.9771 (0.9718) acc_u 3.1250 (3.5938) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [25/40] time 0.347 (0.343) data 0.270 (0.265) loss_u loss_u 0.9395 (0.9674) acc_u 6.2500 (4.0000) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [30/40] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.9683 (0.9667) acc_u 3.1250 (3.9583) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [35/40] time 0.342 (0.344) data 0.262 (0.266) loss_u loss_u 0.9751 (0.9688) acc_u 3.1250 (3.6607) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [40/40] time 0.351 (0.345) data 0.272 (0.266) loss_u loss_u 0.9805 (0.9704) acc_u 3.1250 (3.4375) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 536
confident_label rate tensor(0.2040, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 333
clean true:315
clean false:18
clean_rate:0.9459459459459459
noisy true:781
noisy false:518
after delete: len(clean_dataset) 333
after delete: len(noisy_dataset) 1299
epoch [61/200] batch [5/10] time 0.347 (0.331) data 0.269 (0.253) loss_x loss_x 0.3855 (0.4706) acc_x 90.6250 (90.6250) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/10] time 0.322 (0.336) data 0.245 (0.258) loss_x loss_x 0.3499 (0.4476) acc_x 90.6250 (90.6250) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/40] time 0.341 (0.343) data 0.262 (0.265) loss_u loss_u 0.9985 (0.9725) acc_u 0.0000 (2.5000) lr 1.6004e-03 eta 0:00:12
epoch [61/200] batch [10/40] time 0.355 (0.345) data 0.278 (0.266) loss_u loss_u 0.9697 (0.9709) acc_u 3.1250 (3.4375) lr 1.6004e-03 eta 0:00:10
epoch [61/200] batch [15/40] time 0.388 (0.349) data 0.310 (0.271) loss_u loss_u 0.9414 (0.9703) acc_u 6.2500 (3.3333) lr 1.6004e-03 eta 0:00:08
epoch [61/200] batch [20/40] time 0.352 (0.349) data 0.274 (0.271) loss_u loss_u 0.9771 (0.9707) acc_u 3.1250 (3.2812) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [25/40] time 0.354 (0.351) data 0.276 (0.273) loss_u loss_u 0.9683 (0.9696) acc_u 3.1250 (3.2500) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [30/40] time 0.366 (0.353) data 0.288 (0.275) loss_u loss_u 0.9468 (0.9727) acc_u 6.2500 (2.9167) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [35/40] time 0.373 (0.355) data 0.295 (0.276) loss_u loss_u 0.9683 (0.9703) acc_u 3.1250 (3.3036) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [40/40] time 0.344 (0.354) data 0.266 (0.275) loss_u loss_u 0.9507 (0.9709) acc_u 6.2500 (3.2031) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 546
confident_label rate tensor(0.1985, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 324
clean true:306
clean false:18
clean_rate:0.9444444444444444
noisy true:780
noisy false:528
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 1308
epoch [62/200] batch [5/10] time 0.350 (0.339) data 0.272 (0.260) loss_x loss_x 0.4348 (0.3976) acc_x 93.7500 (91.2500) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/10] time 0.337 (0.346) data 0.260 (0.268) loss_x loss_x 0.3792 (0.4352) acc_x 93.7500 (90.3125) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/40] time 0.353 (0.345) data 0.275 (0.267) loss_u loss_u 0.9380 (0.9716) acc_u 6.2500 (3.1250) lr 1.5878e-03 eta 0:00:12
epoch [62/200] batch [10/40] time 0.359 (0.348) data 0.281 (0.270) loss_u loss_u 0.9595 (0.9642) acc_u 6.2500 (3.7500) lr 1.5878e-03 eta 0:00:10
epoch [62/200] batch [15/40] time 0.332 (0.348) data 0.254 (0.270) loss_u loss_u 0.9702 (0.9671) acc_u 3.1250 (3.5417) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [20/40] time 0.355 (0.349) data 0.277 (0.270) loss_u loss_u 0.9961 (0.9675) acc_u 0.0000 (3.7500) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [25/40] time 0.352 (0.349) data 0.274 (0.270) loss_u loss_u 0.9780 (0.9703) acc_u 3.1250 (3.3750) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [30/40] time 0.372 (0.349) data 0.294 (0.271) loss_u loss_u 0.9966 (0.9708) acc_u 0.0000 (3.2292) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [35/40] time 0.334 (0.348) data 0.257 (0.270) loss_u loss_u 0.9839 (0.9677) acc_u 3.1250 (3.5714) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [40/40] time 0.348 (0.349) data 0.270 (0.271) loss_u loss_u 0.9819 (0.9680) acc_u 3.1250 (3.5156) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 544
confident_label rate tensor(0.1961, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 320
clean true:301
clean false:19
clean_rate:0.940625
noisy true:787
noisy false:525
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 1312
epoch [63/200] batch [5/10] time 0.367 (0.354) data 0.289 (0.276) loss_x loss_x 0.3386 (0.4390) acc_x 93.7500 (91.2500) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/10] time 0.359 (0.353) data 0.281 (0.275) loss_x loss_x 0.3171 (0.4060) acc_x 93.7500 (92.1875) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/41] time 0.374 (0.355) data 0.295 (0.277) loss_u loss_u 0.9839 (0.9717) acc_u 3.1250 (3.1250) lr 1.5750e-03 eta 0:00:12
epoch [63/200] batch [10/41] time 0.365 (0.354) data 0.288 (0.276) loss_u loss_u 0.9961 (0.9657) acc_u 0.0000 (3.7500) lr 1.5750e-03 eta 0:00:10
epoch [63/200] batch [15/41] time 0.342 (0.353) data 0.264 (0.275) loss_u loss_u 0.9526 (0.9616) acc_u 6.2500 (4.3750) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [20/41] time 0.354 (0.352) data 0.274 (0.274) loss_u loss_u 0.9453 (0.9610) acc_u 6.2500 (4.5312) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [25/41] time 0.339 (0.351) data 0.262 (0.273) loss_u loss_u 0.9995 (0.9631) acc_u 0.0000 (4.2500) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [30/41] time 0.352 (0.350) data 0.273 (0.272) loss_u loss_u 0.9980 (0.9657) acc_u 0.0000 (3.9583) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [35/41] time 0.354 (0.350) data 0.276 (0.272) loss_u loss_u 0.9790 (0.9674) acc_u 3.1250 (3.8393) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [40/41] time 0.323 (0.349) data 0.244 (0.271) loss_u loss_u 0.9580 (0.9674) acc_u 6.2500 (3.9062) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 519
confident_label rate tensor(0.2083, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 340
clean true:319
clean false:21
clean_rate:0.9382352941176471
noisy true:794
noisy false:498
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1292
epoch [64/200] batch [5/10] time 0.340 (0.312) data 0.262 (0.234) loss_x loss_x 0.5986 (0.4992) acc_x 81.2500 (86.8750) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/10] time 0.347 (0.337) data 0.269 (0.259) loss_x loss_x 0.8184 (0.5342) acc_x 84.3750 (85.9375) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/40] time 0.330 (0.340) data 0.252 (0.262) loss_u loss_u 0.9707 (0.9774) acc_u 3.1250 (2.5000) lr 1.5621e-03 eta 0:00:11
epoch [64/200] batch [10/40] time 0.335 (0.343) data 0.256 (0.265) loss_u loss_u 0.9263 (0.9708) acc_u 9.3750 (3.4375) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [15/40] time 0.331 (0.343) data 0.253 (0.265) loss_u loss_u 0.9971 (0.9751) acc_u 0.0000 (2.7083) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [20/40] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.9590 (0.9746) acc_u 6.2500 (2.9688) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [25/40] time 0.344 (0.345) data 0.267 (0.267) loss_u loss_u 0.9761 (0.9768) acc_u 3.1250 (2.7500) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [30/40] time 0.352 (0.346) data 0.274 (0.268) loss_u loss_u 1.0000 (0.9766) acc_u 0.0000 (2.7083) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [35/40] time 0.326 (0.347) data 0.248 (0.269) loss_u loss_u 0.9644 (0.9775) acc_u 3.1250 (2.5893) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [40/40] time 0.350 (0.347) data 0.272 (0.269) loss_u loss_u 0.9868 (0.9784) acc_u 0.0000 (2.4219) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 582
confident_label rate tensor(0.1906, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 311
clean true:294
clean false:17
clean_rate:0.9453376205787781
noisy true:756
noisy false:565
after delete: len(clean_dataset) 311
after delete: len(noisy_dataset) 1321
epoch [65/200] batch [5/9] time 0.306 (0.329) data 0.228 (0.251) loss_x loss_x 0.2864 (0.4730) acc_x 93.7500 (90.0000) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [5/41] time 0.381 (0.336) data 0.303 (0.257) loss_u loss_u 0.9414 (0.9618) acc_u 6.2500 (3.7500) lr 1.5490e-03 eta 0:00:12
epoch [65/200] batch [10/41] time 0.367 (0.341) data 0.289 (0.263) loss_u loss_u 0.9893 (0.9610) acc_u 0.0000 (4.0625) lr 1.5490e-03 eta 0:00:10
epoch [65/200] batch [15/41] time 0.333 (0.341) data 0.254 (0.263) loss_u loss_u 0.9727 (0.9625) acc_u 3.1250 (4.1667) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [20/41] time 0.351 (0.343) data 0.273 (0.265) loss_u loss_u 0.9961 (0.9604) acc_u 0.0000 (4.5312) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [25/41] time 0.333 (0.342) data 0.254 (0.263) loss_u loss_u 0.9355 (0.9583) acc_u 9.3750 (5.0000) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [30/41] time 0.343 (0.343) data 0.264 (0.265) loss_u loss_u 0.9976 (0.9622) acc_u 0.0000 (4.5833) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [35/41] time 0.354 (0.345) data 0.276 (0.266) loss_u loss_u 0.9614 (0.9598) acc_u 6.2500 (4.8214) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [40/41] time 0.360 (0.346) data 0.282 (0.268) loss_u loss_u 0.9697 (0.9602) acc_u 3.1250 (4.7656) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 522
confident_label rate tensor(0.2047, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 334
clean true:316
clean false:18
clean_rate:0.9461077844311377
noisy true:794
noisy false:504
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1298
epoch [66/200] batch [5/10] time 0.316 (0.359) data 0.237 (0.281) loss_x loss_x 0.4163 (0.5350) acc_x 90.6250 (85.6250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/10] time 0.311 (0.339) data 0.233 (0.261) loss_x loss_x 0.6938 (0.5498) acc_x 90.6250 (87.8125) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/40] time 0.347 (0.339) data 0.265 (0.260) loss_u loss_u 0.9482 (0.9814) acc_u 6.2500 (1.8750) lr 1.5358e-03 eta 0:00:11
epoch [66/200] batch [10/40] time 0.350 (0.341) data 0.272 (0.263) loss_u loss_u 0.9292 (0.9691) acc_u 9.3750 (3.1250) lr 1.5358e-03 eta 0:00:10
epoch [66/200] batch [15/40] time 0.347 (0.346) data 0.269 (0.267) loss_u loss_u 0.9688 (0.9722) acc_u 3.1250 (2.9167) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [20/40] time 0.335 (0.347) data 0.257 (0.268) loss_u loss_u 0.9805 (0.9721) acc_u 3.1250 (3.1250) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [25/40] time 0.327 (0.346) data 0.249 (0.267) loss_u loss_u 0.9966 (0.9725) acc_u 0.0000 (3.0000) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [30/40] time 0.338 (0.346) data 0.259 (0.268) loss_u loss_u 0.9995 (0.9737) acc_u 0.0000 (2.8125) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [35/40] time 0.380 (0.346) data 0.302 (0.268) loss_u loss_u 0.9897 (0.9704) acc_u 0.0000 (3.3036) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [40/40] time 0.332 (0.346) data 0.254 (0.268) loss_u loss_u 0.9990 (0.9710) acc_u 0.0000 (3.2812) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 537
confident_label rate tensor(0.2126, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 347
clean true:327
clean false:20
clean_rate:0.9423631123919308
noisy true:768
noisy false:517
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1285
epoch [67/200] batch [5/10] time 0.315 (0.330) data 0.236 (0.251) loss_x loss_x 0.4612 (0.3997) acc_x 90.6250 (93.1250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/10] time 0.347 (0.342) data 0.269 (0.264) loss_x loss_x 0.4993 (0.4369) acc_x 90.6250 (91.8750) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/40] time 0.350 (0.346) data 0.272 (0.267) loss_u loss_u 0.9688 (0.9843) acc_u 3.1250 (1.2500) lr 1.5225e-03 eta 0:00:12
epoch [67/200] batch [10/40] time 0.365 (0.346) data 0.287 (0.268) loss_u loss_u 0.9419 (0.9809) acc_u 6.2500 (1.8750) lr 1.5225e-03 eta 0:00:10
epoch [67/200] batch [15/40] time 0.354 (0.346) data 0.277 (0.268) loss_u loss_u 0.9673 (0.9799) acc_u 6.2500 (2.2917) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [20/40] time 0.344 (0.345) data 0.266 (0.267) loss_u loss_u 0.9434 (0.9806) acc_u 6.2500 (2.1875) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [25/40] time 0.380 (0.347) data 0.302 (0.269) loss_u loss_u 0.9590 (0.9781) acc_u 3.1250 (2.6250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [30/40] time 0.366 (0.348) data 0.288 (0.269) loss_u loss_u 0.9995 (0.9779) acc_u 0.0000 (2.6042) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [35/40] time 0.367 (0.349) data 0.289 (0.271) loss_u loss_u 0.9941 (0.9770) acc_u 0.0000 (2.5893) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [40/40] time 0.355 (0.350) data 0.277 (0.271) loss_u loss_u 0.9712 (0.9783) acc_u 3.1250 (2.4219) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 521
confident_label rate tensor(0.2053, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 335
clean true:316
clean false:19
clean_rate:0.9432835820895522
noisy true:795
noisy false:502
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1297
epoch [68/200] batch [5/10] time 0.328 (0.323) data 0.250 (0.245) loss_x loss_x 0.4070 (0.5916) acc_x 90.6250 (87.5000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/10] time 0.358 (0.339) data 0.279 (0.261) loss_x loss_x 0.3542 (0.5268) acc_x 90.6250 (87.8125) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/40] time 0.343 (0.345) data 0.265 (0.266) loss_u loss_u 0.9697 (0.9594) acc_u 3.1250 (4.3750) lr 1.5090e-03 eta 0:00:12
epoch [68/200] batch [10/40] time 0.338 (0.346) data 0.260 (0.267) loss_u loss_u 0.9473 (0.9637) acc_u 6.2500 (4.0625) lr 1.5090e-03 eta 0:00:10
epoch [68/200] batch [15/40] time 0.360 (0.345) data 0.279 (0.267) loss_u loss_u 0.9961 (0.9660) acc_u 0.0000 (3.7500) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [20/40] time 0.356 (0.346) data 0.278 (0.268) loss_u loss_u 0.9766 (0.9667) acc_u 3.1250 (3.5938) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [25/40] time 0.354 (0.347) data 0.276 (0.269) loss_u loss_u 0.9644 (0.9687) acc_u 3.1250 (3.2500) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [30/40] time 0.348 (0.347) data 0.270 (0.269) loss_u loss_u 0.9785 (0.9708) acc_u 3.1250 (3.1250) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [35/40] time 0.352 (0.346) data 0.274 (0.268) loss_u loss_u 0.9697 (0.9717) acc_u 3.1250 (3.0357) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [40/40] time 0.340 (0.346) data 0.261 (0.268) loss_u loss_u 0.9404 (0.9706) acc_u 6.2500 (3.1250) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 510
confident_label rate tensor(0.2047, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 334
clean true:318
clean false:16
clean_rate:0.9520958083832335
noisy true:804
noisy false:494
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1298
epoch [69/200] batch [5/10] time 0.308 (0.317) data 0.229 (0.238) loss_x loss_x 0.3794 (0.4017) acc_x 87.5000 (89.3750) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/10] time 0.366 (0.321) data 0.288 (0.243) loss_x loss_x 0.4336 (0.3592) acc_x 90.6250 (91.2500) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/40] time 0.357 (0.333) data 0.279 (0.255) loss_u loss_u 0.9966 (0.9938) acc_u 0.0000 (0.6250) lr 1.4955e-03 eta 0:00:11
epoch [69/200] batch [10/40] time 0.348 (0.340) data 0.270 (0.261) loss_u loss_u 0.9995 (0.9799) acc_u 0.0000 (2.1875) lr 1.4955e-03 eta 0:00:10
epoch [69/200] batch [15/40] time 0.368 (0.346) data 0.290 (0.267) loss_u loss_u 0.9087 (0.9691) acc_u 9.3750 (3.3333) lr 1.4955e-03 eta 0:00:08
epoch [69/200] batch [20/40] time 0.333 (0.346) data 0.254 (0.267) loss_u loss_u 0.9097 (0.9713) acc_u 9.3750 (2.9688) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [25/40] time 0.349 (0.347) data 0.271 (0.268) loss_u loss_u 0.9902 (0.9736) acc_u 0.0000 (2.7500) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [30/40] time 0.369 (0.348) data 0.291 (0.269) loss_u loss_u 0.9385 (0.9726) acc_u 6.2500 (2.9167) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [35/40] time 0.356 (0.348) data 0.276 (0.270) loss_u loss_u 0.9775 (0.9722) acc_u 3.1250 (3.0357) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [40/40] time 0.348 (0.348) data 0.270 (0.270) loss_u loss_u 0.9668 (0.9703) acc_u 6.2500 (3.2812) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 490
confident_label rate tensor(0.2102, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 343
clean true:327
clean false:16
clean_rate:0.9533527696793003
noisy true:815
noisy false:474
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1289
epoch [70/200] batch [5/10] time 0.317 (0.341) data 0.240 (0.263) loss_x loss_x 0.3621 (0.3394) acc_x 96.8750 (90.6250) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/10] time 0.311 (0.330) data 0.233 (0.252) loss_x loss_x 0.2937 (0.3338) acc_x 90.6250 (91.5625) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/40] time 0.357 (0.341) data 0.279 (0.262) loss_u loss_u 0.9717 (0.9681) acc_u 3.1250 (3.7500) lr 1.4818e-03 eta 0:00:11
epoch [70/200] batch [10/40] time 0.339 (0.340) data 0.261 (0.262) loss_u loss_u 0.9082 (0.9667) acc_u 9.3750 (3.7500) lr 1.4818e-03 eta 0:00:10
epoch [70/200] batch [15/40] time 0.358 (0.342) data 0.280 (0.264) loss_u loss_u 0.9990 (0.9711) acc_u 0.0000 (3.3333) lr 1.4818e-03 eta 0:00:08
epoch [70/200] batch [20/40] time 0.352 (0.343) data 0.274 (0.265) loss_u loss_u 0.9673 (0.9726) acc_u 3.1250 (3.1250) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [25/40] time 0.348 (0.342) data 0.270 (0.264) loss_u loss_u 0.9990 (0.9746) acc_u 0.0000 (2.7500) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [30/40] time 0.359 (0.342) data 0.281 (0.264) loss_u loss_u 0.9678 (0.9719) acc_u 3.1250 (3.0208) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [35/40] time 0.368 (0.343) data 0.290 (0.264) loss_u loss_u 0.9878 (0.9735) acc_u 3.1250 (2.8571) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [40/40] time 0.375 (0.344) data 0.297 (0.266) loss_u loss_u 0.9932 (0.9739) acc_u 0.0000 (2.8906) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 492
confident_label rate tensor(0.2151, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 351
clean true:334
clean false:17
clean_rate:0.9515669515669516
noisy true:806
noisy false:475
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1281
epoch [71/200] batch [5/10] time 0.299 (0.332) data 0.221 (0.254) loss_x loss_x 0.3123 (0.5319) acc_x 93.7500 (89.3750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/10] time 0.305 (0.319) data 0.228 (0.241) loss_x loss_x 0.2664 (0.4370) acc_x 96.8750 (91.8750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/40] time 0.339 (0.324) data 0.261 (0.246) loss_u loss_u 0.9834 (0.9646) acc_u 3.1250 (4.3750) lr 1.4679e-03 eta 0:00:11
epoch [71/200] batch [10/40] time 0.369 (0.329) data 0.291 (0.251) loss_u loss_u 0.9980 (0.9746) acc_u 0.0000 (2.5000) lr 1.4679e-03 eta 0:00:09
epoch [71/200] batch [15/40] time 0.345 (0.334) data 0.267 (0.256) loss_u loss_u 0.9951 (0.9795) acc_u 3.1250 (2.2917) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [20/40] time 0.345 (0.337) data 0.267 (0.259) loss_u loss_u 0.9985 (0.9791) acc_u 0.0000 (2.3438) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [25/40] time 0.354 (0.338) data 0.277 (0.260) loss_u loss_u 0.9849 (0.9791) acc_u 0.0000 (2.2500) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [30/40] time 0.345 (0.338) data 0.267 (0.260) loss_u loss_u 0.9819 (0.9813) acc_u 3.1250 (1.9792) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [35/40] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.9678 (0.9782) acc_u 3.1250 (2.3214) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [40/40] time 0.335 (0.339) data 0.256 (0.261) loss_u loss_u 0.9976 (0.9799) acc_u 0.0000 (2.1094) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 530
confident_label rate tensor(0.2059, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 336
clean true:323
clean false:13
clean_rate:0.9613095238095238
noisy true:779
noisy false:517
after delete: len(clean_dataset) 336
after delete: len(noisy_dataset) 1296
epoch [72/200] batch [5/10] time 0.382 (0.366) data 0.304 (0.288) loss_x loss_x 0.4004 (0.4172) acc_x 90.6250 (90.6250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/10] time 0.302 (0.343) data 0.224 (0.266) loss_x loss_x 0.2334 (0.4059) acc_x 96.8750 (90.9375) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/40] time 0.359 (0.347) data 0.279 (0.269) loss_u loss_u 0.9985 (0.9676) acc_u 0.0000 (3.7500) lr 1.4540e-03 eta 0:00:12
epoch [72/200] batch [10/40] time 0.297 (0.338) data 0.218 (0.260) loss_u loss_u 0.9683 (0.9730) acc_u 3.1250 (3.1250) lr 1.4540e-03 eta 0:00:10
epoch [72/200] batch [15/40] time 0.338 (0.335) data 0.259 (0.256) loss_u loss_u 0.9995 (0.9762) acc_u 0.0000 (2.7083) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [20/40] time 0.359 (0.336) data 0.281 (0.258) loss_u loss_u 0.9390 (0.9719) acc_u 6.2500 (3.2812) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [25/40] time 0.360 (0.341) data 0.281 (0.263) loss_u loss_u 0.9995 (0.9710) acc_u 0.0000 (3.2500) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [30/40] time 0.355 (0.344) data 0.277 (0.265) loss_u loss_u 0.9697 (0.9713) acc_u 3.1250 (3.3333) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [35/40] time 0.369 (0.345) data 0.291 (0.267) loss_u loss_u 0.9697 (0.9723) acc_u 3.1250 (3.3036) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [40/40] time 0.347 (0.346) data 0.269 (0.267) loss_u loss_u 0.9575 (0.9715) acc_u 6.2500 (3.4375) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 533
confident_label rate tensor(0.2120, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 346
clean true:328
clean false:18
clean_rate:0.9479768786127167
noisy true:771
noisy false:515
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1286
epoch [73/200] batch [5/10] time 0.307 (0.315) data 0.229 (0.237) loss_x loss_x 0.3494 (0.4892) acc_x 90.6250 (86.2500) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/10] time 0.347 (0.324) data 0.268 (0.246) loss_x loss_x 0.2111 (0.4389) acc_x 96.8750 (87.5000) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/40] time 0.347 (0.332) data 0.268 (0.254) loss_u loss_u 0.9951 (0.9922) acc_u 0.0000 (0.6250) lr 1.4399e-03 eta 0:00:11
epoch [73/200] batch [10/40] time 0.318 (0.325) data 0.238 (0.247) loss_u loss_u 0.9634 (0.9792) acc_u 6.2500 (3.1250) lr 1.4399e-03 eta 0:00:09
epoch [73/200] batch [15/40] time 0.352 (0.330) data 0.274 (0.252) loss_u loss_u 0.9399 (0.9735) acc_u 9.3750 (3.7500) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [20/40] time 0.352 (0.335) data 0.274 (0.256) loss_u loss_u 0.9678 (0.9745) acc_u 6.2500 (3.5938) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [25/40] time 0.359 (0.337) data 0.281 (0.259) loss_u loss_u 0.9946 (0.9768) acc_u 0.0000 (3.3750) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [30/40] time 0.356 (0.340) data 0.278 (0.261) loss_u loss_u 0.9902 (0.9777) acc_u 0.0000 (3.1250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [35/40] time 0.349 (0.342) data 0.271 (0.264) loss_u loss_u 0.9966 (0.9775) acc_u 0.0000 (3.0357) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [40/40] time 0.331 (0.342) data 0.254 (0.264) loss_u loss_u 0.9194 (0.9774) acc_u 9.3750 (2.9688) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 513
confident_label rate tensor(0.2096, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 342
clean true:325
clean false:17
clean_rate:0.9502923976608187
noisy true:794
noisy false:496
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1290
epoch [74/200] batch [5/10] time 0.366 (0.330) data 0.289 (0.253) loss_x loss_x 0.2864 (0.4532) acc_x 93.7500 (88.7500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/10] time 0.347 (0.338) data 0.270 (0.260) loss_x loss_x 0.3325 (0.4765) acc_x 90.6250 (86.8750) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/40] time 0.298 (0.325) data 0.220 (0.247) loss_u loss_u 0.9858 (0.9769) acc_u 0.0000 (1.8750) lr 1.4258e-03 eta 0:00:11
epoch [74/200] batch [10/40] time 0.338 (0.326) data 0.259 (0.248) loss_u loss_u 0.9546 (0.9712) acc_u 3.1250 (2.8125) lr 1.4258e-03 eta 0:00:09
epoch [74/200] batch [15/40] time 0.354 (0.331) data 0.276 (0.253) loss_u loss_u 0.9990 (0.9759) acc_u 0.0000 (2.5000) lr 1.4258e-03 eta 0:00:08
epoch [74/200] batch [20/40] time 0.386 (0.334) data 0.306 (0.256) loss_u loss_u 0.9995 (0.9767) acc_u 0.0000 (2.5000) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [25/40] time 0.344 (0.336) data 0.267 (0.258) loss_u loss_u 0.9644 (0.9775) acc_u 3.1250 (2.3750) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [30/40] time 0.355 (0.338) data 0.277 (0.260) loss_u loss_u 0.9927 (0.9762) acc_u 0.0000 (2.6042) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [35/40] time 0.354 (0.337) data 0.275 (0.259) loss_u loss_u 0.9761 (0.9750) acc_u 3.1250 (2.7679) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [40/40] time 0.347 (0.338) data 0.269 (0.260) loss_u loss_u 0.9292 (0.9736) acc_u 9.3750 (2.9688) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 488
confident_label rate tensor(0.2083, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 340
clean true:317
clean false:23
clean_rate:0.9323529411764706
noisy true:827
noisy false:465
after delete: len(clean_dataset) 340
after delete: len(noisy_dataset) 1292
epoch [75/200] batch [5/10] time 0.353 (0.333) data 0.275 (0.255) loss_x loss_x 0.3882 (0.4792) acc_x 93.7500 (90.0000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/10] time 0.360 (0.341) data 0.282 (0.263) loss_x loss_x 0.4695 (0.5171) acc_x 93.7500 (90.6250) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/40] time 0.361 (0.343) data 0.282 (0.265) loss_u loss_u 0.9883 (0.9718) acc_u 0.0000 (2.5000) lr 1.4115e-03 eta 0:00:12
epoch [75/200] batch [10/40] time 0.342 (0.346) data 0.265 (0.268) loss_u loss_u 0.9795 (0.9685) acc_u 3.1250 (3.7500) lr 1.4115e-03 eta 0:00:10
epoch [75/200] batch [15/40] time 0.357 (0.347) data 0.279 (0.269) loss_u loss_u 0.9717 (0.9643) acc_u 3.1250 (4.1667) lr 1.4115e-03 eta 0:00:08
epoch [75/200] batch [20/40] time 0.351 (0.347) data 0.273 (0.269) loss_u loss_u 0.9756 (0.9688) acc_u 3.1250 (3.4375) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [25/40] time 0.344 (0.347) data 0.266 (0.268) loss_u loss_u 0.9287 (0.9668) acc_u 9.3750 (3.6250) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [30/40] time 0.368 (0.347) data 0.290 (0.269) loss_u loss_u 0.9561 (0.9664) acc_u 6.2500 (3.7500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [35/40] time 0.342 (0.348) data 0.265 (0.270) loss_u loss_u 0.9990 (0.9665) acc_u 0.0000 (3.7500) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [40/40] time 0.334 (0.348) data 0.256 (0.270) loss_u loss_u 0.9673 (0.9682) acc_u 3.1250 (3.5156) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 546
confident_label rate tensor(0.2102, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 343
clean true:318
clean false:25
clean_rate:0.9271137026239067
noisy true:768
noisy false:521
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1289
epoch [76/200] batch [5/10] time 0.347 (0.322) data 0.269 (0.244) loss_x loss_x 0.4167 (0.3806) acc_x 90.6250 (90.6250) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [10/10] time 0.329 (0.333) data 0.250 (0.255) loss_x loss_x 0.1266 (0.4380) acc_x 100.0000 (90.9375) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/40] time 0.290 (0.320) data 0.212 (0.242) loss_u loss_u 0.8877 (0.9443) acc_u 12.5000 (7.5000) lr 1.3971e-03 eta 0:00:11
epoch [76/200] batch [10/40] time 0.324 (0.316) data 0.247 (0.238) loss_u loss_u 0.9683 (0.9562) acc_u 3.1250 (5.9375) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [15/40] time 0.334 (0.322) data 0.255 (0.244) loss_u loss_u 0.9829 (0.9617) acc_u 0.0000 (4.7917) lr 1.3971e-03 eta 0:00:08
epoch [76/200] batch [20/40] time 0.353 (0.326) data 0.276 (0.248) loss_u loss_u 0.9707 (0.9653) acc_u 3.1250 (4.2188) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [25/40] time 0.342 (0.329) data 0.264 (0.251) loss_u loss_u 0.9683 (0.9654) acc_u 3.1250 (4.1250) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [30/40] time 0.356 (0.332) data 0.277 (0.254) loss_u loss_u 0.9995 (0.9690) acc_u 0.0000 (3.7500) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [35/40] time 0.352 (0.335) data 0.274 (0.257) loss_u loss_u 0.9683 (0.9703) acc_u 3.1250 (3.5714) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [40/40] time 0.350 (0.336) data 0.271 (0.258) loss_u loss_u 0.9980 (0.9706) acc_u 0.0000 (3.5156) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 512
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 345
clean true:327
clean false:18
clean_rate:0.9478260869565217
noisy true:793
noisy false:494
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1287
epoch [77/200] batch [5/10] time 0.364 (0.361) data 0.286 (0.283) loss_x loss_x 0.2939 (0.4209) acc_x 93.7500 (92.5000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/10] time 0.303 (0.349) data 0.226 (0.271) loss_x loss_x 0.9409 (0.4929) acc_x 84.3750 (90.6250) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/40] time 0.350 (0.336) data 0.272 (0.258) loss_u loss_u 0.9761 (0.9605) acc_u 3.1250 (4.3750) lr 1.3827e-03 eta 0:00:11
epoch [77/200] batch [10/40] time 0.334 (0.340) data 0.256 (0.262) loss_u loss_u 0.9922 (0.9684) acc_u 0.0000 (3.4375) lr 1.3827e-03 eta 0:00:10
epoch [77/200] batch [15/40] time 0.347 (0.339) data 0.269 (0.260) loss_u loss_u 0.9976 (0.9711) acc_u 0.0000 (2.9167) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [20/40] time 0.382 (0.342) data 0.304 (0.263) loss_u loss_u 0.9893 (0.9723) acc_u 0.0000 (2.8125) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [25/40] time 0.337 (0.342) data 0.259 (0.264) loss_u loss_u 0.9673 (0.9736) acc_u 3.1250 (2.7500) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [30/40] time 0.379 (0.344) data 0.301 (0.266) loss_u loss_u 0.9624 (0.9713) acc_u 3.1250 (2.9167) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [35/40] time 0.325 (0.344) data 0.247 (0.266) loss_u loss_u 0.9990 (0.9723) acc_u 0.0000 (2.8571) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [40/40] time 0.339 (0.344) data 0.260 (0.265) loss_u loss_u 0.9565 (0.9733) acc_u 3.1250 (2.8125) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 518
confident_label rate tensor(0.2120, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 346
clean true:322
clean false:24
clean_rate:0.930635838150289
noisy true:792
noisy false:494
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1286
epoch [78/200] batch [5/10] time 0.345 (0.347) data 0.267 (0.270) loss_x loss_x 0.3196 (0.3731) acc_x 90.6250 (93.1250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/10] time 0.329 (0.344) data 0.252 (0.266) loss_x loss_x 0.3435 (0.3416) acc_x 93.7500 (93.7500) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/40] time 0.343 (0.336) data 0.265 (0.258) loss_u loss_u 0.9893 (0.9757) acc_u 0.0000 (2.5000) lr 1.3681e-03 eta 0:00:11
epoch [78/200] batch [10/40] time 0.295 (0.334) data 0.217 (0.256) loss_u loss_u 0.9697 (0.9745) acc_u 3.1250 (2.5000) lr 1.3681e-03 eta 0:00:10
epoch [78/200] batch [15/40] time 0.353 (0.339) data 0.275 (0.261) loss_u loss_u 0.9668 (0.9739) acc_u 3.1250 (2.5000) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [20/40] time 0.361 (0.341) data 0.283 (0.263) loss_u loss_u 0.9629 (0.9762) acc_u 6.2500 (2.3438) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [25/40] time 0.347 (0.343) data 0.268 (0.265) loss_u loss_u 0.9956 (0.9723) acc_u 0.0000 (2.7500) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [30/40] time 0.292 (0.342) data 0.213 (0.263) loss_u loss_u 0.9980 (0.9731) acc_u 0.0000 (2.7083) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [35/40] time 0.337 (0.339) data 0.259 (0.261) loss_u loss_u 0.9292 (0.9715) acc_u 9.3750 (2.9464) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [40/40] time 0.333 (0.339) data 0.255 (0.260) loss_u loss_u 0.9438 (0.9720) acc_u 6.2500 (2.8906) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 502
confident_label rate tensor(0.2126, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 347
clean true:326
clean false:21
clean_rate:0.9394812680115274
noisy true:804
noisy false:481
after delete: len(clean_dataset) 347
after delete: len(noisy_dataset) 1285
epoch [79/200] batch [5/10] time 0.350 (0.348) data 0.273 (0.270) loss_x loss_x 0.3318 (0.3972) acc_x 90.6250 (92.5000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/10] time 0.330 (0.346) data 0.252 (0.268) loss_x loss_x 0.3123 (0.3603) acc_x 93.7500 (92.8125) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/40] time 0.340 (0.343) data 0.262 (0.265) loss_u loss_u 0.9688 (0.9705) acc_u 3.1250 (4.3750) lr 1.3535e-03 eta 0:00:12
epoch [79/200] batch [10/40] time 0.318 (0.342) data 0.239 (0.264) loss_u loss_u 0.9990 (0.9714) acc_u 0.0000 (4.0625) lr 1.3535e-03 eta 0:00:10
epoch [79/200] batch [15/40] time 0.328 (0.343) data 0.249 (0.265) loss_u loss_u 0.9150 (0.9683) acc_u 9.3750 (3.9583) lr 1.3535e-03 eta 0:00:08
epoch [79/200] batch [20/40] time 0.353 (0.344) data 0.275 (0.266) loss_u loss_u 0.9990 (0.9754) acc_u 0.0000 (2.9688) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [25/40] time 0.348 (0.344) data 0.270 (0.266) loss_u loss_u 0.9976 (0.9740) acc_u 0.0000 (3.0000) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [30/40] time 0.295 (0.342) data 0.216 (0.264) loss_u loss_u 0.9458 (0.9742) acc_u 6.2500 (3.0208) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [35/40] time 0.337 (0.340) data 0.259 (0.262) loss_u loss_u 0.9971 (0.9732) acc_u 0.0000 (3.2143) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [40/40] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9819 (0.9742) acc_u 3.1250 (3.0469) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 510
confident_label rate tensor(0.2108, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 344
clean true:322
clean false:22
clean_rate:0.936046511627907
noisy true:800
noisy false:488
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1288
epoch [80/200] batch [5/10] time 0.338 (0.347) data 0.260 (0.269) loss_x loss_x 0.6348 (0.5049) acc_x 87.5000 (88.7500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/10] time 0.339 (0.344) data 0.261 (0.266) loss_x loss_x 0.7495 (0.4647) acc_x 81.2500 (90.0000) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/40] time 0.354 (0.345) data 0.276 (0.267) loss_u loss_u 0.9282 (0.9541) acc_u 9.3750 (5.0000) lr 1.3387e-03 eta 0:00:12
epoch [80/200] batch [10/40] time 0.349 (0.346) data 0.271 (0.268) loss_u loss_u 0.9990 (0.9653) acc_u 0.0000 (3.7500) lr 1.3387e-03 eta 0:00:10
epoch [80/200] batch [15/40] time 0.355 (0.347) data 0.276 (0.269) loss_u loss_u 0.9399 (0.9632) acc_u 6.2500 (3.9583) lr 1.3387e-03 eta 0:00:08
epoch [80/200] batch [20/40] time 0.336 (0.343) data 0.257 (0.265) loss_u loss_u 0.9580 (0.9675) acc_u 9.3750 (3.7500) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [25/40] time 0.345 (0.344) data 0.267 (0.266) loss_u loss_u 0.9834 (0.9692) acc_u 3.1250 (3.6250) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [30/40] time 0.307 (0.340) data 0.228 (0.262) loss_u loss_u 0.9961 (0.9704) acc_u 0.0000 (3.4375) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [35/40] time 0.372 (0.339) data 0.294 (0.261) loss_u loss_u 0.9785 (0.9708) acc_u 3.1250 (3.3929) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [40/40] time 0.335 (0.341) data 0.257 (0.262) loss_u loss_u 0.9736 (0.9694) acc_u 3.1250 (3.5156) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 521
confident_label rate tensor(0.2151, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 351
clean true:329
clean false:22
clean_rate:0.9373219373219374
noisy true:782
noisy false:499
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1281
epoch [81/200] batch [5/10] time 0.353 (0.345) data 0.275 (0.268) loss_x loss_x 0.3611 (0.5287) acc_x 90.6250 (89.3750) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/10] time 0.342 (0.342) data 0.264 (0.264) loss_x loss_x 0.2869 (0.4974) acc_x 93.7500 (88.7500) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/40] time 0.341 (0.344) data 0.263 (0.266) loss_u loss_u 0.9658 (0.9817) acc_u 3.1250 (2.5000) lr 1.3239e-03 eta 0:00:12
epoch [81/200] batch [10/40] time 0.345 (0.344) data 0.267 (0.266) loss_u loss_u 0.9819 (0.9816) acc_u 3.1250 (2.5000) lr 1.3239e-03 eta 0:00:10
epoch [81/200] batch [15/40] time 0.302 (0.339) data 0.224 (0.261) loss_u loss_u 0.9985 (0.9801) acc_u 0.0000 (2.5000) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [20/40] time 0.350 (0.338) data 0.271 (0.260) loss_u loss_u 0.9985 (0.9793) acc_u 0.0000 (2.6562) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [25/40] time 0.303 (0.338) data 0.223 (0.260) loss_u loss_u 0.9282 (0.9796) acc_u 6.2500 (2.3750) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [30/40] time 0.340 (0.338) data 0.261 (0.260) loss_u loss_u 0.9697 (0.9768) acc_u 3.1250 (2.8125) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [35/40] time 0.331 (0.340) data 0.253 (0.262) loss_u loss_u 0.9648 (0.9767) acc_u 3.1250 (2.7679) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [40/40] time 0.347 (0.341) data 0.269 (0.263) loss_u loss_u 0.9844 (0.9771) acc_u 0.0000 (2.6562) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 495
confident_label rate tensor(0.2175, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 355
clean true:333
clean false:22
clean_rate:0.9380281690140845
noisy true:804
noisy false:473
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1277
epoch [82/200] batch [5/11] time 0.352 (0.346) data 0.274 (0.268) loss_x loss_x 0.3000 (0.4335) acc_x 90.6250 (90.6250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/11] time 0.342 (0.345) data 0.265 (0.268) loss_x loss_x 0.3040 (0.4274) acc_x 90.6250 (90.0000) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/39] time 0.356 (0.344) data 0.277 (0.266) loss_u loss_u 0.9976 (0.9870) acc_u 0.0000 (1.2500) lr 1.3090e-03 eta 0:00:11
epoch [82/200] batch [10/39] time 0.356 (0.344) data 0.278 (0.266) loss_u loss_u 0.9385 (0.9846) acc_u 6.2500 (1.2500) lr 1.3090e-03 eta 0:00:09
epoch [82/200] batch [15/39] time 0.339 (0.344) data 0.261 (0.266) loss_u loss_u 0.9424 (0.9759) acc_u 9.3750 (2.5000) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [20/39] time 0.325 (0.344) data 0.246 (0.266) loss_u loss_u 0.9902 (0.9749) acc_u 3.1250 (2.6562) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [25/39] time 0.343 (0.341) data 0.265 (0.263) loss_u loss_u 0.9976 (0.9761) acc_u 0.0000 (2.5000) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [30/39] time 0.355 (0.341) data 0.277 (0.263) loss_u loss_u 0.9995 (0.9745) acc_u 0.0000 (2.6042) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [35/39] time 0.338 (0.341) data 0.260 (0.263) loss_u loss_u 0.9990 (0.9757) acc_u 0.0000 (2.5893) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 530
confident_label rate tensor(0.2188, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 357
clean true:330
clean false:27
clean_rate:0.9243697478991597
noisy true:772
noisy false:503
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1275
epoch [83/200] batch [5/11] time 0.347 (0.344) data 0.269 (0.266) loss_x loss_x 0.5903 (0.5697) acc_x 87.5000 (86.2500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/11] time 0.346 (0.345) data 0.268 (0.268) loss_x loss_x 0.5093 (0.5146) acc_x 90.6250 (88.1250) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/39] time 0.360 (0.349) data 0.282 (0.272) loss_u loss_u 0.9917 (0.9812) acc_u 3.1250 (2.5000) lr 1.2940e-03 eta 0:00:11
epoch [83/200] batch [10/39] time 0.342 (0.347) data 0.264 (0.269) loss_u loss_u 0.9990 (0.9865) acc_u 0.0000 (1.5625) lr 1.2940e-03 eta 0:00:10
epoch [83/200] batch [15/39] time 0.349 (0.347) data 0.270 (0.269) loss_u loss_u 0.9961 (0.9789) acc_u 0.0000 (2.0833) lr 1.2940e-03 eta 0:00:08
epoch [83/200] batch [20/39] time 0.344 (0.347) data 0.266 (0.269) loss_u loss_u 0.9463 (0.9730) acc_u 9.3750 (2.9688) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [25/39] time 0.324 (0.347) data 0.245 (0.269) loss_u loss_u 0.9980 (0.9727) acc_u 0.0000 (3.0000) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [30/39] time 0.335 (0.345) data 0.255 (0.267) loss_u loss_u 0.9683 (0.9741) acc_u 3.1250 (2.8125) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [35/39] time 0.345 (0.345) data 0.267 (0.267) loss_u loss_u 0.9424 (0.9742) acc_u 6.2500 (2.7679) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 509
confident_label rate tensor(0.2108, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 344
clean true:321
clean false:23
clean_rate:0.9331395348837209
noisy true:802
noisy false:486
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1288
epoch [84/200] batch [5/10] time 0.349 (0.348) data 0.271 (0.270) loss_x loss_x 0.5347 (0.4145) acc_x 90.6250 (94.3750) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/10] time 0.343 (0.343) data 0.266 (0.265) loss_x loss_x 0.4644 (0.4117) acc_x 84.3750 (91.2500) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/40] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9912 (0.9568) acc_u 0.0000 (5.0000) lr 1.2790e-03 eta 0:00:11
epoch [84/200] batch [10/40] time 0.331 (0.337) data 0.253 (0.259) loss_u loss_u 0.9722 (0.9656) acc_u 3.1250 (3.7500) lr 1.2790e-03 eta 0:00:10
epoch [84/200] batch [15/40] time 0.351 (0.339) data 0.273 (0.261) loss_u loss_u 0.9585 (0.9666) acc_u 3.1250 (3.9583) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [20/40] time 0.368 (0.341) data 0.289 (0.263) loss_u loss_u 0.9717 (0.9672) acc_u 3.1250 (3.7500) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [25/40] time 0.333 (0.341) data 0.256 (0.264) loss_u loss_u 0.9663 (0.9647) acc_u 3.1250 (3.8750) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [30/40] time 0.340 (0.339) data 0.262 (0.262) loss_u loss_u 0.9678 (0.9671) acc_u 3.1250 (3.5417) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [35/40] time 0.328 (0.339) data 0.250 (0.261) loss_u loss_u 0.9873 (0.9660) acc_u 3.1250 (3.8393) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [40/40] time 0.350 (0.339) data 0.272 (0.261) loss_u loss_u 0.9995 (0.9700) acc_u 0.0000 (3.3594) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 490
confident_label rate tensor(0.2114, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 345
clean true:326
clean false:19
clean_rate:0.9449275362318841
noisy true:816
noisy false:471
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1287
epoch [85/200] batch [5/10] time 0.344 (0.341) data 0.266 (0.263) loss_x loss_x 0.5044 (0.4591) acc_x 84.3750 (88.1250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/10] time 0.344 (0.343) data 0.266 (0.265) loss_x loss_x 0.5356 (0.3989) acc_x 93.7500 (90.9375) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/40] time 0.349 (0.343) data 0.271 (0.265) loss_u loss_u 0.9019 (0.9760) acc_u 12.5000 (3.1250) lr 1.2639e-03 eta 0:00:12
epoch [85/200] batch [10/40] time 0.350 (0.345) data 0.272 (0.267) loss_u loss_u 0.9907 (0.9794) acc_u 0.0000 (2.1875) lr 1.2639e-03 eta 0:00:10
epoch [85/200] batch [15/40] time 0.347 (0.345) data 0.269 (0.267) loss_u loss_u 0.9810 (0.9740) acc_u 3.1250 (2.9167) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [20/40] time 0.348 (0.345) data 0.270 (0.267) loss_u loss_u 0.9683 (0.9704) acc_u 3.1250 (3.2812) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [25/40] time 0.375 (0.346) data 0.296 (0.268) loss_u loss_u 0.9966 (0.9724) acc_u 0.0000 (3.0000) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [30/40] time 0.342 (0.343) data 0.265 (0.265) loss_u loss_u 0.9688 (0.9739) acc_u 3.1250 (2.8125) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [35/40] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9111 (0.9721) acc_u 9.3750 (3.0357) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [40/40] time 0.343 (0.342) data 0.265 (0.264) loss_u loss_u 0.9692 (0.9708) acc_u 3.1250 (3.2812) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 505
confident_label rate tensor(0.2151, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 351
clean true:333
clean false:18
clean_rate:0.9487179487179487
noisy true:794
noisy false:487
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1281
epoch [86/200] batch [5/10] time 0.347 (0.341) data 0.270 (0.263) loss_x loss_x 0.7930 (0.4497) acc_x 87.5000 (89.3750) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/10] time 0.319 (0.347) data 0.242 (0.269) loss_x loss_x 0.3169 (0.3698) acc_x 90.6250 (90.9375) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/40] time 0.336 (0.344) data 0.257 (0.267) loss_u loss_u 0.9849 (0.9834) acc_u 3.1250 (2.5000) lr 1.2487e-03 eta 0:00:12
epoch [86/200] batch [10/40] time 0.333 (0.344) data 0.255 (0.266) loss_u loss_u 0.9990 (0.9811) acc_u 0.0000 (2.5000) lr 1.2487e-03 eta 0:00:10
epoch [86/200] batch [15/40] time 0.339 (0.341) data 0.261 (0.263) loss_u loss_u 0.9688 (0.9813) acc_u 3.1250 (2.5000) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [20/40] time 0.341 (0.340) data 0.264 (0.262) loss_u loss_u 0.9824 (0.9812) acc_u 3.1250 (2.3438) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [25/40] time 0.338 (0.341) data 0.259 (0.263) loss_u loss_u 0.9932 (0.9829) acc_u 0.0000 (2.1250) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [30/40] time 0.311 (0.340) data 0.232 (0.262) loss_u loss_u 0.9316 (0.9773) acc_u 9.3750 (2.7083) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [35/40] time 0.334 (0.338) data 0.255 (0.260) loss_u loss_u 0.9404 (0.9761) acc_u 6.2500 (2.7679) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [40/40] time 0.341 (0.339) data 0.263 (0.261) loss_u loss_u 0.9692 (0.9773) acc_u 3.1250 (2.5781) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 504
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 356
clean true:336
clean false:20
clean_rate:0.9438202247191011
noisy true:792
noisy false:484
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1276
epoch [87/200] batch [5/11] time 0.384 (0.382) data 0.306 (0.304) loss_x loss_x 0.4824 (0.3867) acc_x 84.3750 (89.3750) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/11] time 0.406 (0.389) data 0.328 (0.310) loss_x loss_x 0.5962 (0.3945) acc_x 84.3750 (89.6875) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/39] time 0.382 (0.380) data 0.304 (0.302) loss_u loss_u 0.9600 (0.9743) acc_u 3.1250 (2.5000) lr 1.2334e-03 eta 0:00:12
epoch [87/200] batch [10/39] time 0.357 (0.379) data 0.279 (0.300) loss_u loss_u 0.9878 (0.9793) acc_u 3.1250 (2.1875) lr 1.2334e-03 eta 0:00:10
epoch [87/200] batch [15/39] time 0.400 (0.376) data 0.321 (0.298) loss_u loss_u 0.9844 (0.9768) acc_u 0.0000 (2.2917) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [20/39] time 0.354 (0.378) data 0.276 (0.300) loss_u loss_u 0.9722 (0.9783) acc_u 6.2500 (2.3438) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [25/39] time 0.405 (0.375) data 0.327 (0.296) loss_u loss_u 0.9551 (0.9783) acc_u 6.2500 (2.3750) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [30/39] time 0.340 (0.371) data 0.261 (0.293) loss_u loss_u 0.9526 (0.9755) acc_u 6.2500 (2.7083) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [35/39] time 0.325 (0.367) data 0.248 (0.289) loss_u loss_u 0.9956 (0.9771) acc_u 0.0000 (2.5000) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 515
confident_label rate tensor(0.2102, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 343
clean true:321
clean false:22
clean_rate:0.9358600583090378
noisy true:796
noisy false:493
after delete: len(clean_dataset) 343
after delete: len(noisy_dataset) 1289
epoch [88/200] batch [5/10] time 0.340 (0.343) data 0.263 (0.266) loss_x loss_x 0.2871 (0.3567) acc_x 90.6250 (93.1250) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/10] time 0.332 (0.341) data 0.254 (0.264) loss_x loss_x 0.3452 (0.3941) acc_x 93.7500 (91.8750) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/40] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9985 (0.9743) acc_u 0.0000 (2.5000) lr 1.2181e-03 eta 0:00:11
epoch [88/200] batch [10/40] time 0.351 (0.343) data 0.273 (0.265) loss_u loss_u 0.9990 (0.9765) acc_u 0.0000 (2.5000) lr 1.2181e-03 eta 0:00:10
epoch [88/200] batch [15/40] time 0.342 (0.343) data 0.264 (0.265) loss_u loss_u 0.9678 (0.9694) acc_u 3.1250 (3.3333) lr 1.2181e-03 eta 0:00:08
epoch [88/200] batch [20/40] time 0.346 (0.349) data 0.267 (0.271) loss_u loss_u 0.9673 (0.9708) acc_u 3.1250 (3.2812) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [25/40] time 0.390 (0.358) data 0.312 (0.279) loss_u loss_u 0.9385 (0.9695) acc_u 6.2500 (3.3750) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [30/40] time 0.335 (0.355) data 0.258 (0.277) loss_u loss_u 0.9263 (0.9679) acc_u 9.3750 (3.6458) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [35/40] time 0.318 (0.350) data 0.240 (0.272) loss_u loss_u 0.9702 (0.9669) acc_u 3.1250 (3.8393) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [40/40] time 0.338 (0.350) data 0.259 (0.271) loss_u loss_u 0.9526 (0.9677) acc_u 6.2500 (3.7500) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 470
confident_label rate tensor(0.2169, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 354
clean true:335
clean false:19
clean_rate:0.9463276836158192
noisy true:827
noisy false:451
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1278
epoch [89/200] batch [5/11] time 0.351 (0.353) data 0.274 (0.276) loss_x loss_x 0.4211 (0.4198) acc_x 87.5000 (90.0000) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/11] time 0.355 (0.347) data 0.278 (0.270) loss_x loss_x 0.4438 (0.4542) acc_x 90.6250 (89.6875) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/39] time 0.342 (0.345) data 0.264 (0.268) loss_u loss_u 0.9990 (0.9871) acc_u 0.0000 (1.8750) lr 1.2028e-03 eta 0:00:11
epoch [89/200] batch [10/39] time 0.416 (0.348) data 0.336 (0.271) loss_u loss_u 0.9858 (0.9908) acc_u 3.1250 (1.5625) lr 1.2028e-03 eta 0:00:10
epoch [89/200] batch [15/39] time 0.353 (0.350) data 0.275 (0.272) loss_u loss_u 0.9834 (0.9884) acc_u 3.1250 (1.6667) lr 1.2028e-03 eta 0:00:08
epoch [89/200] batch [20/39] time 0.331 (0.347) data 0.252 (0.269) loss_u loss_u 0.9434 (0.9822) acc_u 6.2500 (2.1875) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [25/39] time 0.336 (0.346) data 0.257 (0.268) loss_u loss_u 0.9678 (0.9799) acc_u 3.1250 (2.5000) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [30/39] time 0.323 (0.344) data 0.245 (0.266) loss_u loss_u 0.9834 (0.9798) acc_u 3.1250 (2.5000) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [35/39] time 0.353 (0.344) data 0.275 (0.266) loss_u loss_u 0.9858 (0.9796) acc_u 3.1250 (2.5893) lr 1.2028e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 484
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 360
clean true:340
clean false:20
clean_rate:0.9444444444444444
noisy true:808
noisy false:464
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1272
epoch [90/200] batch [5/11] time 0.353 (0.356) data 0.276 (0.278) loss_x loss_x 0.4988 (0.4374) acc_x 93.7500 (90.0000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/11] time 0.338 (0.352) data 0.260 (0.274) loss_x loss_x 0.1948 (0.3823) acc_x 93.7500 (90.3125) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/39] time 0.327 (0.349) data 0.250 (0.271) loss_u loss_u 0.9785 (0.9869) acc_u 3.1250 (1.2500) lr 1.1874e-03 eta 0:00:11
epoch [90/200] batch [10/39] time 0.355 (0.343) data 0.277 (0.265) loss_u loss_u 0.9814 (0.9865) acc_u 3.1250 (1.2500) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [15/39] time 0.335 (0.341) data 0.257 (0.263) loss_u loss_u 0.9995 (0.9892) acc_u 0.0000 (1.0417) lr 1.1874e-03 eta 0:00:08
epoch [90/200] batch [20/39] time 0.325 (0.340) data 0.246 (0.262) loss_u loss_u 0.9688 (0.9870) acc_u 3.1250 (1.2500) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [25/39] time 0.352 (0.341) data 0.272 (0.263) loss_u loss_u 0.9746 (0.9858) acc_u 3.1250 (1.3750) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [30/39] time 0.349 (0.344) data 0.271 (0.266) loss_u loss_u 0.9639 (0.9806) acc_u 6.2500 (2.0833) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [35/39] time 0.349 (0.348) data 0.271 (0.270) loss_u loss_u 0.9995 (0.9793) acc_u 0.0000 (2.3214) lr 1.1874e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 493
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 359
clean true:338
clean false:21
clean_rate:0.9415041782729805
noisy true:801
noisy false:472
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1273
epoch [91/200] batch [5/11] time 0.355 (0.362) data 0.278 (0.284) loss_x loss_x 0.2776 (0.3886) acc_x 90.6250 (89.3750) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/11] time 0.345 (0.355) data 0.266 (0.277) loss_x loss_x 0.3291 (0.3585) acc_x 93.7500 (90.3125) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/39] time 0.352 (0.353) data 0.274 (0.275) loss_u loss_u 0.9478 (0.9763) acc_u 6.2500 (2.5000) lr 1.1719e-03 eta 0:00:11
epoch [91/200] batch [10/39] time 0.362 (0.351) data 0.284 (0.273) loss_u loss_u 0.9502 (0.9726) acc_u 6.2500 (2.8125) lr 1.1719e-03 eta 0:00:10
epoch [91/200] batch [15/39] time 0.345 (0.349) data 0.266 (0.271) loss_u loss_u 0.9824 (0.9714) acc_u 3.1250 (3.1250) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [20/39] time 0.309 (0.349) data 0.230 (0.271) loss_u loss_u 1.0000 (0.9736) acc_u 0.0000 (2.9688) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [25/39] time 0.370 (0.344) data 0.292 (0.266) loss_u loss_u 0.9971 (0.9780) acc_u 0.0000 (2.5000) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [30/39] time 0.347 (0.344) data 0.269 (0.266) loss_u loss_u 0.9619 (0.9780) acc_u 6.2500 (2.6042) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [35/39] time 0.363 (0.345) data 0.286 (0.267) loss_u loss_u 0.9980 (0.9800) acc_u 0.0000 (2.3214) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 491
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 359
clean true:331
clean false:28
clean_rate:0.9220055710306406
noisy true:810
noisy false:463
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1273
epoch [92/200] batch [5/11] time 0.341 (0.343) data 0.264 (0.265) loss_x loss_x 0.7944 (0.5338) acc_x 78.1250 (87.5000) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/11] time 0.339 (0.344) data 0.262 (0.266) loss_x loss_x 0.3008 (0.4956) acc_x 90.6250 (89.0625) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/39] time 0.362 (0.354) data 0.285 (0.276) loss_u loss_u 0.9775 (0.9713) acc_u 0.0000 (2.5000) lr 1.1564e-03 eta 0:00:12
epoch [92/200] batch [10/39] time 0.292 (0.350) data 0.214 (0.272) loss_u loss_u 0.9634 (0.9708) acc_u 3.1250 (3.4375) lr 1.1564e-03 eta 0:00:10
epoch [92/200] batch [15/39] time 0.341 (0.345) data 0.263 (0.267) loss_u loss_u 0.9927 (0.9718) acc_u 0.0000 (3.3333) lr 1.1564e-03 eta 0:00:08
epoch [92/200] batch [20/39] time 0.298 (0.343) data 0.218 (0.265) loss_u loss_u 0.9736 (0.9719) acc_u 3.1250 (3.4375) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [25/39] time 0.341 (0.341) data 0.262 (0.263) loss_u loss_u 0.9995 (0.9728) acc_u 0.0000 (3.2500) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [30/39] time 0.348 (0.342) data 0.269 (0.264) loss_u loss_u 0.9570 (0.9748) acc_u 3.1250 (2.9167) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [35/39] time 0.341 (0.343) data 0.263 (0.265) loss_u loss_u 0.9990 (0.9751) acc_u 0.0000 (2.8571) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 498
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 360
clean true:332
clean false:28
clean_rate:0.9222222222222223
noisy true:802
noisy false:470
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1272
epoch [93/200] batch [5/11] time 0.349 (0.346) data 0.270 (0.268) loss_x loss_x 0.2644 (0.4178) acc_x 93.7500 (90.6250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/11] time 0.342 (0.344) data 0.264 (0.266) loss_x loss_x 0.2109 (0.4737) acc_x 93.7500 (90.3125) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/39] time 0.333 (0.346) data 0.256 (0.267) loss_u loss_u 0.9268 (0.9606) acc_u 9.3750 (5.0000) lr 1.1409e-03 eta 0:00:11
epoch [93/200] batch [10/39] time 0.344 (0.344) data 0.266 (0.266) loss_u loss_u 0.9595 (0.9647) acc_u 9.3750 (4.6875) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [15/39] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.9995 (0.9725) acc_u 0.0000 (3.5417) lr 1.1409e-03 eta 0:00:08
epoch [93/200] batch [20/39] time 0.354 (0.345) data 0.275 (0.267) loss_u loss_u 0.9707 (0.9746) acc_u 3.1250 (3.2812) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [25/39] time 0.334 (0.343) data 0.256 (0.264) loss_u loss_u 0.9849 (0.9746) acc_u 3.1250 (3.2500) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [30/39] time 0.343 (0.342) data 0.265 (0.264) loss_u loss_u 0.9961 (0.9769) acc_u 0.0000 (2.9167) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [35/39] time 0.339 (0.343) data 0.261 (0.265) loss_u loss_u 0.9326 (0.9764) acc_u 9.3750 (2.9464) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 485
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 360
clean true:342
clean false:18
clean_rate:0.95
noisy true:805
noisy false:467
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1272
epoch [94/200] batch [5/11] time 0.350 (0.351) data 0.273 (0.273) loss_x loss_x 0.3142 (0.4965) acc_x 90.6250 (87.5000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/11] time 0.328 (0.342) data 0.250 (0.265) loss_x loss_x 0.5161 (0.4337) acc_x 81.2500 (88.4375) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/39] time 0.351 (0.346) data 0.273 (0.268) loss_u loss_u 0.9951 (0.9851) acc_u 0.0000 (1.2500) lr 1.1253e-03 eta 0:00:11
epoch [94/200] batch [10/39] time 0.344 (0.345) data 0.267 (0.267) loss_u loss_u 0.9980 (0.9846) acc_u 0.0000 (1.2500) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [15/39] time 0.357 (0.344) data 0.279 (0.266) loss_u loss_u 0.9839 (0.9808) acc_u 0.0000 (1.6667) lr 1.1253e-03 eta 0:00:08
epoch [94/200] batch [20/39] time 0.348 (0.343) data 0.269 (0.266) loss_u loss_u 0.9995 (0.9816) acc_u 0.0000 (1.7188) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [25/39] time 0.345 (0.346) data 0.266 (0.268) loss_u loss_u 0.9932 (0.9801) acc_u 0.0000 (2.0000) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [30/39] time 0.307 (0.344) data 0.228 (0.266) loss_u loss_u 0.9995 (0.9809) acc_u 0.0000 (1.9792) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [35/39] time 0.369 (0.345) data 0.291 (0.266) loss_u loss_u 0.9980 (0.9791) acc_u 0.0000 (2.2321) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 496
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 356
clean true:334
clean false:22
clean_rate:0.9382022471910112
noisy true:802
noisy false:474
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1276
epoch [95/200] batch [5/11] time 0.348 (0.358) data 0.270 (0.281) loss_x loss_x 0.3608 (0.3796) acc_x 90.6250 (90.6250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/11] time 0.344 (0.355) data 0.266 (0.278) loss_x loss_x 0.3369 (0.3703) acc_x 90.6250 (90.6250) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/39] time 0.353 (0.354) data 0.275 (0.276) loss_u loss_u 0.9976 (0.9810) acc_u 0.0000 (1.8750) lr 1.1097e-03 eta 0:00:12
epoch [95/200] batch [10/39] time 0.294 (0.349) data 0.216 (0.271) loss_u loss_u 0.9634 (0.9779) acc_u 6.2500 (2.5000) lr 1.1097e-03 eta 0:00:10
epoch [95/200] batch [15/39] time 0.341 (0.345) data 0.264 (0.267) loss_u loss_u 0.9639 (0.9790) acc_u 3.1250 (2.2917) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [20/39] time 0.353 (0.344) data 0.274 (0.266) loss_u loss_u 0.9614 (0.9767) acc_u 3.1250 (2.6562) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [25/39] time 0.348 (0.344) data 0.270 (0.266) loss_u loss_u 0.9775 (0.9756) acc_u 3.1250 (2.7500) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [30/39] time 0.332 (0.344) data 0.254 (0.266) loss_u loss_u 0.9624 (0.9745) acc_u 6.2500 (2.8125) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [35/39] time 0.327 (0.344) data 0.248 (0.266) loss_u loss_u 0.9683 (0.9763) acc_u 3.1250 (2.5893) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 492
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 360
clean true:337
clean false:23
clean_rate:0.9361111111111111
noisy true:803
noisy false:469
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1272
epoch [96/200] batch [5/11] time 0.348 (0.388) data 0.270 (0.310) loss_x loss_x 0.7432 (0.4433) acc_x 84.3750 (91.2500) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/11] time 0.334 (0.372) data 0.255 (0.294) loss_x loss_x 0.4971 (0.3988) acc_x 93.7500 (91.8750) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/39] time 0.355 (0.363) data 0.277 (0.285) loss_u loss_u 1.0000 (0.9858) acc_u 0.0000 (1.8750) lr 1.0941e-03 eta 0:00:12
epoch [96/200] batch [10/39] time 0.365 (0.362) data 0.287 (0.284) loss_u loss_u 0.9375 (0.9781) acc_u 9.3750 (2.8125) lr 1.0941e-03 eta 0:00:10
epoch [96/200] batch [15/39] time 0.375 (0.364) data 0.296 (0.286) loss_u loss_u 0.9585 (0.9775) acc_u 3.1250 (2.5000) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [20/39] time 0.504 (0.370) data 0.426 (0.292) loss_u loss_u 0.9980 (0.9791) acc_u 0.0000 (2.5000) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [25/39] time 0.507 (0.376) data 0.428 (0.298) loss_u loss_u 0.9971 (0.9764) acc_u 0.0000 (2.7500) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [30/39] time 0.318 (0.374) data 0.239 (0.296) loss_u loss_u 0.9844 (0.9733) acc_u 3.1250 (3.0208) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [35/39] time 0.328 (0.369) data 0.250 (0.291) loss_u loss_u 0.9995 (0.9747) acc_u 0.0000 (2.8571) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 498
confident_label rate tensor(0.2169, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 354
clean true:329
clean false:25
clean_rate:0.9293785310734464
noisy true:805
noisy false:473
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1278
epoch [97/200] batch [5/11] time 0.346 (0.348) data 0.268 (0.270) loss_x loss_x 0.5435 (0.4605) acc_x 90.6250 (90.6250) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/11] time 0.351 (0.348) data 0.272 (0.270) loss_x loss_x 0.1087 (0.4047) acc_x 100.0000 (92.8125) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/39] time 0.321 (0.346) data 0.243 (0.268) loss_u loss_u 0.9526 (0.9533) acc_u 6.2500 (5.0000) lr 1.0785e-03 eta 0:00:11
epoch [97/200] batch [10/39] time 0.365 (0.345) data 0.286 (0.266) loss_u loss_u 0.9648 (0.9690) acc_u 6.2500 (3.7500) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [15/39] time 0.343 (0.347) data 0.264 (0.268) loss_u loss_u 0.9985 (0.9710) acc_u 0.0000 (3.3333) lr 1.0785e-03 eta 0:00:08
epoch [97/200] batch [20/39] time 0.354 (0.348) data 0.276 (0.270) loss_u loss_u 0.9712 (0.9742) acc_u 3.1250 (2.8125) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [25/39] time 0.361 (0.348) data 0.283 (0.270) loss_u loss_u 0.9565 (0.9693) acc_u 6.2500 (3.5000) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [30/39] time 0.342 (0.348) data 0.263 (0.270) loss_u loss_u 0.9634 (0.9709) acc_u 3.1250 (3.3333) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [35/39] time 0.314 (0.344) data 0.235 (0.265) loss_u loss_u 0.9678 (0.9703) acc_u 3.1250 (3.3929) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 518
confident_label rate tensor(0.2163, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 353
clean true:331
clean false:22
clean_rate:0.9376770538243626
noisy true:783
noisy false:496
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1279
epoch [98/200] batch [5/11] time 0.352 (0.354) data 0.275 (0.277) loss_x loss_x 0.5459 (0.3685) acc_x 81.2500 (90.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/11] time 0.326 (0.345) data 0.248 (0.267) loss_x loss_x 0.4255 (0.3637) acc_x 84.3750 (91.5625) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/39] time 0.342 (0.339) data 0.264 (0.260) loss_u loss_u 0.9995 (0.9759) acc_u 0.0000 (3.1250) lr 1.0628e-03 eta 0:00:11
epoch [98/200] batch [10/39] time 0.360 (0.343) data 0.279 (0.264) loss_u loss_u 0.9395 (0.9701) acc_u 6.2500 (3.4375) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [15/39] time 0.360 (0.345) data 0.281 (0.266) loss_u loss_u 0.9727 (0.9739) acc_u 3.1250 (2.9167) lr 1.0628e-03 eta 0:00:08
epoch [98/200] batch [20/39] time 0.346 (0.346) data 0.266 (0.268) loss_u loss_u 0.9990 (0.9740) acc_u 0.0000 (2.8125) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [25/39] time 0.354 (0.348) data 0.274 (0.269) loss_u loss_u 0.9844 (0.9723) acc_u 3.1250 (3.1250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [30/39] time 0.344 (0.348) data 0.265 (0.269) loss_u loss_u 0.9980 (0.9730) acc_u 0.0000 (3.1250) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [35/39] time 0.358 (0.347) data 0.279 (0.268) loss_u loss_u 0.9360 (0.9720) acc_u 6.2500 (3.2143) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2267, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 370
clean true:348
clean false:22
clean_rate:0.9405405405405406
noisy true:816
noisy false:446
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1262
epoch [99/200] batch [5/11] time 0.359 (0.353) data 0.281 (0.275) loss_x loss_x 0.2321 (0.3979) acc_x 93.7500 (90.6250) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/11] time 0.339 (0.353) data 0.261 (0.275) loss_x loss_x 0.2295 (0.3273) acc_x 93.7500 (91.5625) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/39] time 0.352 (0.352) data 0.274 (0.275) loss_u loss_u 0.9990 (0.9725) acc_u 0.0000 (2.5000) lr 1.0471e-03 eta 0:00:11
epoch [99/200] batch [10/39] time 0.356 (0.353) data 0.278 (0.275) loss_u loss_u 0.9976 (0.9746) acc_u 0.0000 (2.5000) lr 1.0471e-03 eta 0:00:10
epoch [99/200] batch [15/39] time 0.345 (0.353) data 0.267 (0.275) loss_u loss_u 0.9976 (0.9777) acc_u 0.0000 (2.5000) lr 1.0471e-03 eta 0:00:08
epoch [99/200] batch [20/39] time 0.351 (0.355) data 0.273 (0.276) loss_u loss_u 0.9868 (0.9807) acc_u 3.1250 (2.3438) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [25/39] time 0.367 (0.355) data 0.289 (0.277) loss_u loss_u 0.9980 (0.9797) acc_u 0.0000 (2.6250) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [30/39] time 0.302 (0.350) data 0.223 (0.272) loss_u loss_u 0.9678 (0.9793) acc_u 3.1250 (2.6042) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [35/39] time 0.359 (0.349) data 0.281 (0.270) loss_u loss_u 0.9966 (0.9785) acc_u 0.0000 (2.5893) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 492
confident_label rate tensor(0.2181, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 356
clean true:334
clean false:22
clean_rate:0.9382022471910112
noisy true:806
noisy false:470
all clean rate:  [0.8727272727272727, 0.9323308270676691, 0.9673469387755103, 0.975, 0.9583333333333334, 0.959349593495935, 0.9681274900398407, 0.952191235059761, 0.9799196787148594, 0.9653846153846154, 0.9700374531835206, 0.9411764705882353, 0.9705882352941176, 0.9511278195488722, 0.9660377358490566, 0.9556313993174061, 0.9572953736654805, 0.972027972027972, 0.9645390070921985, 0.9787985865724381, 0.9543859649122807, 0.9637681159420289, 0.9825174825174825, 0.9620689655172414, 0.9758620689655172, 0.9663299663299664, 0.964516129032258, 0.9645390070921985, 0.9595959595959596, 0.9661016949152542, 0.9488054607508533, 0.9695945945945946, 0.9636963696369637, 0.9463087248322147, 0.9658703071672355, 0.9551724137931035, 0.9607843137254902, 0.9680511182108626, 0.961038961038961, 0.953125, 0.9558359621451105, 0.9596273291925466, 0.9476923076923077, 0.9422492401215805, 0.9559748427672956, 0.9558359621451105, 0.9353846153846154, 0.9685534591194969, 0.9529780564263323, 0.9588607594936709, 0.9454545454545454, 0.9446153846153846, 0.963302752293578, 0.9454545454545454, 0.9486404833836858, 0.9506172839506173, 0.9375, 0.963855421686747, 0.9548192771084337, 0.9503105590062112, 0.9459459459459459, 0.9444444444444444, 0.940625, 0.9382352941176471, 0.9453376205787781, 0.9461077844311377, 0.9423631123919308, 0.9432835820895522, 0.9520958083832335, 0.9533527696793003, 0.9515669515669516, 0.9613095238095238, 0.9479768786127167, 0.9502923976608187, 0.9323529411764706, 0.9271137026239067, 0.9478260869565217, 0.930635838150289, 0.9394812680115274, 0.936046511627907, 0.9373219373219374, 0.9380281690140845, 0.9243697478991597, 0.9331395348837209, 0.9449275362318841, 0.9487179487179487, 0.9438202247191011, 0.9358600583090378, 0.9463276836158192, 0.9444444444444444, 0.9415041782729805, 0.9220055710306406, 0.9222222222222223, 0.95, 0.9382022471910112, 0.9361111111111111, 0.9293785310734464, 0.9376770538243626, 0.9405405405405406, 0.9382022471910112]
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1276
epoch [100/200] batch [5/11] time 0.336 (0.342) data 0.258 (0.264) loss_x loss_x 0.6729 (0.4411) acc_x 87.5000 (91.8750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/11] time 0.330 (0.337) data 0.253 (0.260) loss_x loss_x 0.1793 (0.4320) acc_x 96.8750 (90.3125) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/39] time 0.353 (0.340) data 0.274 (0.262) loss_u loss_u 0.9429 (0.9650) acc_u 9.3750 (4.3750) lr 1.0314e-03 eta 0:00:11
epoch [100/200] batch [10/39] time 0.336 (0.343) data 0.257 (0.265) loss_u loss_u 0.9966 (0.9756) acc_u 0.0000 (2.8125) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [15/39] time 0.392 (0.347) data 0.313 (0.269) loss_u loss_u 0.9321 (0.9709) acc_u 9.3750 (3.3333) lr 1.0314e-03 eta 0:00:08
epoch [100/200] batch [20/39] time 0.348 (0.351) data 0.267 (0.273) loss_u loss_u 0.9976 (0.9740) acc_u 0.0000 (2.9688) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [25/39] time 0.363 (0.354) data 0.283 (0.275) loss_u loss_u 0.9688 (0.9725) acc_u 3.1250 (3.1250) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [30/39] time 0.392 (0.351) data 0.314 (0.272) loss_u loss_u 0.9683 (0.9737) acc_u 3.1250 (2.9167) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [35/39] time 0.369 (0.351) data 0.290 (0.273) loss_u loss_u 0.9385 (0.9732) acc_u 6.2500 (2.9464) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2249, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 367
clean true:343
clean false:24
clean_rate:0.9346049046321526
noisy true:821
noisy false:444
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1265
epoch [101/200] batch [5/11] time 0.340 (0.346) data 0.262 (0.269) loss_x loss_x 0.6128 (0.4644) acc_x 87.5000 (93.1250) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/11] time 0.366 (0.347) data 0.288 (0.269) loss_x loss_x 0.7769 (0.4818) acc_x 87.5000 (91.2500) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/39] time 0.352 (0.346) data 0.274 (0.268) loss_u loss_u 0.9575 (0.9584) acc_u 3.1250 (4.3750) lr 1.0157e-03 eta 0:00:11
epoch [101/200] batch [10/39] time 0.344 (0.346) data 0.266 (0.268) loss_u loss_u 0.9683 (0.9735) acc_u 3.1250 (2.5000) lr 1.0157e-03 eta 0:00:10
epoch [101/200] batch [15/39] time 0.354 (0.347) data 0.275 (0.269) loss_u loss_u 0.9189 (0.9683) acc_u 9.3750 (3.1250) lr 1.0157e-03 eta 0:00:08
epoch [101/200] batch [20/39] time 0.353 (0.348) data 0.275 (0.270) loss_u loss_u 0.9497 (0.9709) acc_u 6.2500 (2.9688) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [25/39] time 0.346 (0.349) data 0.268 (0.271) loss_u loss_u 0.9980 (0.9738) acc_u 0.0000 (2.6250) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [30/39] time 0.350 (0.348) data 0.272 (0.270) loss_u loss_u 0.9990 (0.9750) acc_u 0.0000 (2.5000) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [35/39] time 0.342 (0.348) data 0.263 (0.270) loss_u loss_u 0.9634 (0.9759) acc_u 3.1250 (2.4107) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 534
confident_label rate tensor(0.2138, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 349
clean true:328
clean false:21
clean_rate:0.9398280802292264
noisy true:770
noisy false:513
after delete: len(clean_dataset) 349
after delete: len(noisy_dataset) 1283
epoch [102/200] batch [5/10] time 0.338 (0.342) data 0.261 (0.264) loss_x loss_x 0.9175 (0.5234) acc_x 87.5000 (88.7500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/10] time 0.335 (0.342) data 0.258 (0.265) loss_x loss_x 0.6870 (0.5180) acc_x 84.3750 (89.3750) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/40] time 0.338 (0.343) data 0.260 (0.265) loss_u loss_u 0.9219 (0.9560) acc_u 9.3750 (5.0000) lr 1.0000e-03 eta 0:00:12
epoch [102/200] batch [10/40] time 0.347 (0.341) data 0.269 (0.264) loss_u loss_u 0.9585 (0.9664) acc_u 6.2500 (4.0625) lr 1.0000e-03 eta 0:00:10
epoch [102/200] batch [15/40] time 0.347 (0.354) data 0.269 (0.276) loss_u loss_u 0.9658 (0.9681) acc_u 3.1250 (3.7500) lr 1.0000e-03 eta 0:00:08
epoch [102/200] batch [20/40] time 0.320 (0.350) data 0.241 (0.272) loss_u loss_u 0.9961 (0.9698) acc_u 0.0000 (3.5938) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [25/40] time 0.320 (0.343) data 0.242 (0.265) loss_u loss_u 0.9692 (0.9677) acc_u 3.1250 (3.7500) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [30/40] time 0.336 (0.342) data 0.258 (0.264) loss_u loss_u 0.9995 (0.9710) acc_u 0.0000 (3.2292) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [35/40] time 0.361 (0.343) data 0.283 (0.265) loss_u loss_u 0.9766 (0.9703) acc_u 6.2500 (3.3929) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [40/40] time 0.350 (0.343) data 0.272 (0.265) loss_u loss_u 0.9751 (0.9688) acc_u 6.2500 (3.6719) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 469
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 359
clean true:338
clean false:21
clean_rate:0.9415041782729805
noisy true:825
noisy false:448
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1273
epoch [103/200] batch [5/11] time 0.356 (0.351) data 0.279 (0.274) loss_x loss_x 0.3826 (0.4573) acc_x 90.6250 (89.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/11] time 0.346 (0.348) data 0.268 (0.271) loss_x loss_x 0.6445 (0.4660) acc_x 84.3750 (90.0000) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/39] time 0.342 (0.346) data 0.263 (0.268) loss_u loss_u 0.9688 (0.9752) acc_u 3.1250 (2.5000) lr 9.8429e-04 eta 0:00:11
epoch [103/200] batch [10/39] time 0.339 (0.346) data 0.262 (0.268) loss_u loss_u 0.9966 (0.9786) acc_u 0.0000 (2.5000) lr 9.8429e-04 eta 0:00:10
epoch [103/200] batch [15/39] time 0.361 (0.346) data 0.283 (0.268) loss_u loss_u 0.9990 (0.9790) acc_u 0.0000 (2.5000) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [20/39] time 0.307 (0.343) data 0.228 (0.265) loss_u loss_u 0.9990 (0.9782) acc_u 0.0000 (2.5000) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [25/39] time 0.326 (0.339) data 0.249 (0.261) loss_u loss_u 0.9985 (0.9788) acc_u 0.0000 (2.3750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [30/39] time 0.338 (0.338) data 0.260 (0.260) loss_u loss_u 0.9795 (0.9763) acc_u 0.0000 (2.6042) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [35/39] time 0.349 (0.339) data 0.271 (0.261) loss_u loss_u 0.9727 (0.9743) acc_u 6.2500 (2.8571) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.2200, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 359
clean true:338
clean false:21
clean_rate:0.9415041782729805
noisy true:822
noisy false:451
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1273
epoch [104/200] batch [5/11] time 0.371 (0.403) data 0.294 (0.325) loss_x loss_x 0.2988 (0.3381) acc_x 96.8750 (93.7500) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/11] time 0.340 (0.373) data 0.263 (0.295) loss_x loss_x 0.1350 (0.3565) acc_x 100.0000 (93.4375) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/39] time 0.352 (0.365) data 0.274 (0.287) loss_u loss_u 0.9727 (0.9638) acc_u 3.1250 (4.3750) lr 9.6859e-04 eta 0:00:12
epoch [104/200] batch [10/39] time 0.360 (0.363) data 0.282 (0.285) loss_u loss_u 0.9644 (0.9753) acc_u 6.2500 (3.1250) lr 9.6859e-04 eta 0:00:10
epoch [104/200] batch [15/39] time 0.348 (0.360) data 0.265 (0.282) loss_u loss_u 0.9424 (0.9754) acc_u 6.2500 (2.9167) lr 9.6859e-04 eta 0:00:08
epoch [104/200] batch [20/39] time 0.328 (0.360) data 0.245 (0.281) loss_u loss_u 0.9541 (0.9749) acc_u 6.2500 (3.1250) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [25/39] time 0.318 (0.354) data 0.236 (0.274) loss_u loss_u 0.9668 (0.9744) acc_u 3.1250 (3.0000) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [30/39] time 0.336 (0.353) data 0.258 (0.273) loss_u loss_u 0.9131 (0.9736) acc_u 9.3750 (3.0208) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [35/39] time 0.341 (0.351) data 0.263 (0.271) loss_u loss_u 0.9771 (0.9740) acc_u 3.1250 (3.0357) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 489
confident_label rate tensor(0.2243, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 366
clean true:342
clean false:24
clean_rate:0.9344262295081968
noisy true:801
noisy false:465
after delete: len(clean_dataset) 366
after delete: len(noisy_dataset) 1266
epoch [105/200] batch [5/11] time 0.351 (0.350) data 0.273 (0.272) loss_x loss_x 0.4556 (0.3593) acc_x 93.7500 (93.7500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/11] time 0.356 (0.351) data 0.278 (0.273) loss_x loss_x 0.1979 (0.3559) acc_x 96.8750 (93.1250) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/39] time 0.353 (0.350) data 0.275 (0.272) loss_u loss_u 0.9277 (0.9824) acc_u 6.2500 (1.8750) lr 9.5289e-04 eta 0:00:11
epoch [105/200] batch [10/39] time 0.353 (0.349) data 0.275 (0.271) loss_u loss_u 0.9976 (0.9814) acc_u 0.0000 (1.8750) lr 9.5289e-04 eta 0:00:10
epoch [105/200] batch [15/39] time 0.348 (0.349) data 0.270 (0.271) loss_u loss_u 0.9785 (0.9832) acc_u 3.1250 (1.8750) lr 9.5289e-04 eta 0:00:08
epoch [105/200] batch [20/39] time 0.300 (0.344) data 0.221 (0.266) loss_u loss_u 0.9995 (0.9833) acc_u 0.0000 (1.8750) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [25/39] time 0.350 (0.342) data 0.271 (0.264) loss_u loss_u 0.9697 (0.9838) acc_u 6.2500 (1.8750) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [30/39] time 0.343 (0.342) data 0.265 (0.264) loss_u loss_u 0.9961 (0.9814) acc_u 0.0000 (2.1875) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [35/39] time 0.368 (0.343) data 0.290 (0.265) loss_u loss_u 0.9717 (0.9800) acc_u 6.2500 (2.3214) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 499
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 358
clean true:338
clean false:20
clean_rate:0.9441340782122905
noisy true:795
noisy false:479
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1274
epoch [106/200] batch [5/11] time 0.349 (0.352) data 0.272 (0.274) loss_x loss_x 0.3145 (0.2406) acc_x 93.7500 (95.6250) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/11] time 0.345 (0.350) data 0.267 (0.272) loss_x loss_x 0.4404 (0.3231) acc_x 90.6250 (93.1250) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/39] time 0.299 (0.343) data 0.221 (0.266) loss_u loss_u 0.9951 (0.9856) acc_u 0.0000 (1.8750) lr 9.3721e-04 eta 0:00:11
epoch [106/200] batch [10/39] time 0.345 (0.344) data 0.267 (0.266) loss_u loss_u 0.9785 (0.9808) acc_u 3.1250 (2.1875) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [15/39] time 0.345 (0.344) data 0.266 (0.266) loss_u loss_u 0.9629 (0.9771) acc_u 3.1250 (2.5000) lr 9.3721e-04 eta 0:00:08
epoch [106/200] batch [20/39] time 0.310 (0.341) data 0.232 (0.263) loss_u loss_u 0.9995 (0.9757) acc_u 0.0000 (2.8125) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [25/39] time 0.304 (0.336) data 0.226 (0.258) loss_u loss_u 0.9473 (0.9767) acc_u 6.2500 (2.6250) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [30/39] time 0.409 (0.341) data 0.331 (0.263) loss_u loss_u 0.9946 (0.9760) acc_u 0.0000 (2.6042) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [35/39] time 0.375 (0.342) data 0.296 (0.264) loss_u loss_u 0.9980 (0.9758) acc_u 0.0000 (2.6786) lr 9.3721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 480
confident_label rate tensor(0.2249, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 367
clean true:344
clean false:23
clean_rate:0.9373297002724795
noisy true:808
noisy false:457
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1265
epoch [107/200] batch [5/11] time 0.337 (0.350) data 0.259 (0.272) loss_x loss_x 0.3445 (0.2639) acc_x 96.8750 (95.6250) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/11] time 0.350 (0.349) data 0.272 (0.271) loss_x loss_x 0.3408 (0.3579) acc_x 93.7500 (92.1875) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/39] time 0.328 (0.345) data 0.250 (0.267) loss_u loss_u 0.9683 (0.9777) acc_u 3.1250 (2.5000) lr 9.2154e-04 eta 0:00:11
epoch [107/200] batch [10/39] time 0.344 (0.344) data 0.267 (0.266) loss_u loss_u 0.9692 (0.9717) acc_u 3.1250 (3.1250) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [15/39] time 0.337 (0.344) data 0.259 (0.266) loss_u loss_u 0.9980 (0.9803) acc_u 0.0000 (2.0833) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [20/39] time 0.331 (0.343) data 0.252 (0.265) loss_u loss_u 0.9961 (0.9840) acc_u 0.0000 (1.7188) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [25/39] time 0.301 (0.339) data 0.222 (0.260) loss_u loss_u 0.9448 (0.9820) acc_u 6.2500 (1.8750) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [30/39] time 0.359 (0.338) data 0.281 (0.260) loss_u loss_u 0.9858 (0.9803) acc_u 3.1250 (2.0833) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [35/39] time 0.334 (0.339) data 0.256 (0.261) loss_u loss_u 0.9658 (0.9758) acc_u 3.1250 (2.5000) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 505
confident_label rate tensor(0.2194, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 358
clean true:331
clean false:27
clean_rate:0.9245810055865922
noisy true:796
noisy false:478
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1274
epoch [108/200] batch [5/11] time 0.361 (0.350) data 0.283 (0.272) loss_x loss_x 0.2825 (0.2869) acc_x 90.6250 (91.8750) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/11] time 0.304 (0.342) data 0.226 (0.264) loss_x loss_x 0.2581 (0.3056) acc_x 93.7500 (92.1875) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/39] time 0.340 (0.333) data 0.262 (0.255) loss_u loss_u 0.9688 (0.9592) acc_u 3.1250 (5.0000) lr 9.0589e-04 eta 0:00:11
epoch [108/200] batch [10/39] time 0.343 (0.335) data 0.265 (0.257) loss_u loss_u 0.9893 (0.9741) acc_u 0.0000 (2.8125) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [15/39] time 0.338 (0.335) data 0.260 (0.257) loss_u loss_u 0.9756 (0.9712) acc_u 3.1250 (3.5417) lr 9.0589e-04 eta 0:00:08
epoch [108/200] batch [20/39] time 0.301 (0.332) data 0.222 (0.254) loss_u loss_u 0.9995 (0.9750) acc_u 0.0000 (3.1250) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [25/39] time 0.345 (0.331) data 0.267 (0.253) loss_u loss_u 0.9697 (0.9718) acc_u 3.1250 (3.3750) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [30/39] time 0.343 (0.332) data 0.264 (0.254) loss_u loss_u 0.9995 (0.9721) acc_u 0.0000 (3.3333) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [35/39] time 0.359 (0.335) data 0.281 (0.256) loss_u loss_u 0.9941 (0.9713) acc_u 0.0000 (3.3929) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 360
clean true:338
clean false:22
clean_rate:0.9388888888888889
noisy true:826
noisy false:446
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1272
epoch [109/200] batch [5/11] time 0.361 (0.353) data 0.284 (0.276) loss_x loss_x 0.5938 (0.3973) acc_x 84.3750 (90.0000) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/11] time 0.333 (0.347) data 0.256 (0.269) loss_x loss_x 0.4810 (0.4451) acc_x 87.5000 (90.0000) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/39] time 0.340 (0.348) data 0.262 (0.270) loss_u loss_u 0.9209 (0.9631) acc_u 9.3750 (4.3750) lr 8.9027e-04 eta 0:00:11
epoch [109/200] batch [10/39] time 0.353 (0.348) data 0.274 (0.270) loss_u loss_u 0.9995 (0.9696) acc_u 0.0000 (3.1250) lr 8.9027e-04 eta 0:00:10
epoch [109/200] batch [15/39] time 0.344 (0.347) data 0.266 (0.269) loss_u loss_u 0.9683 (0.9692) acc_u 3.1250 (3.1250) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [20/39] time 0.302 (0.342) data 0.224 (0.264) loss_u loss_u 0.9795 (0.9724) acc_u 3.1250 (2.8125) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [25/39] time 0.320 (0.339) data 0.242 (0.261) loss_u loss_u 0.9570 (0.9725) acc_u 3.1250 (2.7500) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [30/39] time 0.329 (0.338) data 0.252 (0.260) loss_u loss_u 0.9185 (0.9705) acc_u 9.3750 (3.0208) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [35/39] time 0.330 (0.338) data 0.252 (0.260) loss_u loss_u 0.9951 (0.9701) acc_u 0.0000 (3.1250) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 475
confident_label rate tensor(0.2261, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 369
clean true:340
clean false:29
clean_rate:0.9214092140921409
noisy true:817
noisy false:446
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1263
epoch [110/200] batch [5/11] time 0.358 (0.347) data 0.281 (0.270) loss_x loss_x 0.3113 (0.3513) acc_x 93.7500 (92.5000) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/11] time 0.348 (0.348) data 0.270 (0.271) loss_x loss_x 0.3804 (0.4068) acc_x 87.5000 (90.6250) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/39] time 0.349 (0.346) data 0.272 (0.269) loss_u loss_u 0.9976 (0.9974) acc_u 0.0000 (0.0000) lr 8.7467e-04 eta 0:00:11
epoch [110/200] batch [10/39] time 0.348 (0.345) data 0.269 (0.267) loss_u loss_u 0.9688 (0.9844) acc_u 3.1250 (1.5625) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [15/39] time 0.326 (0.343) data 0.248 (0.266) loss_u loss_u 0.9990 (0.9839) acc_u 0.0000 (1.6667) lr 8.7467e-04 eta 0:00:08
epoch [110/200] batch [20/39] time 0.314 (0.337) data 0.235 (0.259) loss_u loss_u 0.9966 (0.9843) acc_u 0.0000 (1.5625) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [25/39] time 0.338 (0.336) data 0.260 (0.258) loss_u loss_u 0.9697 (0.9817) acc_u 3.1250 (1.8750) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [30/39] time 0.331 (0.337) data 0.253 (0.259) loss_u loss_u 0.9722 (0.9796) acc_u 3.1250 (2.0833) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [35/39] time 0.385 (0.338) data 0.307 (0.260) loss_u loss_u 0.9985 (0.9811) acc_u 0.0000 (1.9643) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 509
confident_label rate tensor(0.2145, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 350
clean true:331
clean false:19
clean_rate:0.9457142857142857
noisy true:792
noisy false:490
after delete: len(clean_dataset) 350
after delete: len(noisy_dataset) 1282
epoch [111/200] batch [5/10] time 0.338 (0.342) data 0.260 (0.264) loss_x loss_x 0.3381 (0.4093) acc_x 96.8750 (93.1250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/10] time 0.336 (0.340) data 0.258 (0.263) loss_x loss_x 0.8652 (0.4694) acc_x 68.7500 (89.3750) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/40] time 0.347 (0.342) data 0.270 (0.264) loss_u loss_u 0.9736 (0.9761) acc_u 3.1250 (2.5000) lr 8.5910e-04 eta 0:00:11
epoch [111/200] batch [10/40] time 0.367 (0.346) data 0.289 (0.267) loss_u loss_u 1.0000 (0.9762) acc_u 0.0000 (2.5000) lr 8.5910e-04 eta 0:00:10
epoch [111/200] batch [15/40] time 0.338 (0.347) data 0.260 (0.269) loss_u loss_u 0.9990 (0.9781) acc_u 0.0000 (2.2917) lr 8.5910e-04 eta 0:00:08
epoch [111/200] batch [20/40] time 0.297 (0.342) data 0.218 (0.264) loss_u loss_u 0.9707 (0.9747) acc_u 3.1250 (2.6562) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [25/40] time 0.375 (0.344) data 0.295 (0.266) loss_u loss_u 0.9893 (0.9730) acc_u 3.1250 (3.1250) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [30/40] time 0.440 (0.347) data 0.361 (0.268) loss_u loss_u 0.9448 (0.9705) acc_u 3.1250 (3.2292) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [35/40] time 0.422 (0.351) data 0.343 (0.272) loss_u loss_u 0.9683 (0.9699) acc_u 3.1250 (3.3929) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [40/40] time 0.367 (0.355) data 0.288 (0.276) loss_u loss_u 0.9688 (0.9690) acc_u 3.1250 (3.5156) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 482
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 365
clean true:341
clean false:24
clean_rate:0.9342465753424658
noisy true:809
noisy false:458
after delete: len(clean_dataset) 365
after delete: len(noisy_dataset) 1267
epoch [112/200] batch [5/11] time 0.345 (0.378) data 0.268 (0.300) loss_x loss_x 0.5166 (0.4053) acc_x 87.5000 (91.8750) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/11] time 0.354 (0.364) data 0.277 (0.286) loss_x loss_x 0.5278 (0.3881) acc_x 87.5000 (91.2500) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/39] time 0.351 (0.360) data 0.274 (0.282) loss_u loss_u 1.0000 (0.9902) acc_u 0.0000 (1.8750) lr 8.4357e-04 eta 0:00:12
epoch [112/200] batch [10/39] time 0.361 (0.359) data 0.284 (0.282) loss_u loss_u 0.9775 (0.9813) acc_u 3.1250 (2.5000) lr 8.4357e-04 eta 0:00:10
epoch [112/200] batch [15/39] time 0.291 (0.352) data 0.212 (0.274) loss_u loss_u 0.9634 (0.9800) acc_u 6.2500 (2.5000) lr 8.4357e-04 eta 0:00:08
epoch [112/200] batch [20/39] time 0.342 (0.346) data 0.264 (0.268) loss_u loss_u 0.8779 (0.9740) acc_u 12.5000 (3.1250) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [25/39] time 0.335 (0.345) data 0.256 (0.267) loss_u loss_u 0.9419 (0.9733) acc_u 6.2500 (3.1250) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [30/39] time 0.350 (0.347) data 0.272 (0.269) loss_u loss_u 0.9849 (0.9738) acc_u 3.1250 (3.1250) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [35/39] time 0.387 (0.353) data 0.308 (0.275) loss_u loss_u 0.9663 (0.9726) acc_u 3.1250 (3.1250) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 496
confident_label rate tensor(0.2230, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 364
clean true:345
clean false:19
clean_rate:0.9478021978021978
noisy true:791
noisy false:477
after delete: len(clean_dataset) 364
after delete: len(noisy_dataset) 1268
epoch [113/200] batch [5/11] time 0.341 (0.347) data 0.263 (0.269) loss_x loss_x 0.4021 (0.3347) acc_x 93.7500 (93.1250) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/11] time 0.343 (0.348) data 0.265 (0.270) loss_x loss_x 0.1606 (0.3314) acc_x 100.0000 (92.8125) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/39] time 0.330 (0.346) data 0.252 (0.268) loss_u loss_u 0.9673 (0.9736) acc_u 3.1250 (2.5000) lr 8.2807e-04 eta 0:00:11
epoch [113/200] batch [10/39] time 0.359 (0.347) data 0.281 (0.269) loss_u loss_u 0.9990 (0.9824) acc_u 0.0000 (1.5625) lr 8.2807e-04 eta 0:00:10
epoch [113/200] batch [15/39] time 0.307 (0.344) data 0.228 (0.266) loss_u loss_u 0.9990 (0.9791) acc_u 0.0000 (2.0833) lr 8.2807e-04 eta 0:00:08
epoch [113/200] batch [20/39] time 0.335 (0.340) data 0.255 (0.262) loss_u loss_u 0.9595 (0.9794) acc_u 3.1250 (2.0312) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [25/39] time 0.335 (0.341) data 0.256 (0.263) loss_u loss_u 0.9800 (0.9791) acc_u 3.1250 (2.2500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [30/39] time 0.335 (0.341) data 0.256 (0.262) loss_u loss_u 0.9824 (0.9798) acc_u 3.1250 (2.1875) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [35/39] time 0.350 (0.342) data 0.268 (0.264) loss_u loss_u 0.9546 (0.9784) acc_u 6.2500 (2.4107) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 453
confident_label rate tensor(0.2267, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 370
clean true:350
clean false:20
clean_rate:0.9459459459459459
noisy true:829
noisy false:433
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1262
epoch [114/200] batch [5/11] time 0.462 (0.432) data 0.383 (0.287) loss_x loss_x 0.4678 (0.4082) acc_x 90.6250 (90.0000) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/11] time 0.451 (0.464) data 0.291 (0.310) loss_x loss_x 0.3933 (0.4933) acc_x 87.5000 (89.6875) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/39] time 0.429 (0.462) data 0.265 (0.304) loss_u loss_u 0.9385 (0.9742) acc_u 6.2500 (2.5000) lr 8.1262e-04 eta 0:00:15
epoch [114/200] batch [10/39] time 0.417 (0.452) data 0.249 (0.295) loss_u loss_u 0.9985 (0.9727) acc_u 0.0000 (2.8125) lr 8.1262e-04 eta 0:00:13
epoch [114/200] batch [15/39] time 0.438 (0.449) data 0.269 (0.290) loss_u loss_u 0.9844 (0.9775) acc_u 3.1250 (2.2917) lr 8.1262e-04 eta 0:00:10
epoch [114/200] batch [20/39] time 0.333 (0.443) data 0.255 (0.286) loss_u loss_u 0.9663 (0.9765) acc_u 3.1250 (2.5000) lr 8.1262e-04 eta 0:00:08
epoch [114/200] batch [25/39] time 0.433 (0.442) data 0.272 (0.284) loss_u loss_u 0.9995 (0.9769) acc_u 0.0000 (2.5000) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [30/39] time 0.461 (0.441) data 0.291 (0.283) loss_u loss_u 0.9941 (0.9783) acc_u 0.0000 (2.3958) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [35/39] time 0.383 (0.438) data 0.218 (0.280) loss_u loss_u 0.9780 (0.9779) acc_u 3.1250 (2.5000) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 493
confident_label rate tensor(0.2261, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 369
clean true:342
clean false:27
clean_rate:0.926829268292683
noisy true:797
noisy false:466
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1263
epoch [115/200] batch [5/11] time 0.469 (0.423) data 0.311 (0.280) loss_x loss_x 0.2778 (0.3315) acc_x 90.6250 (91.2500) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [10/11] time 0.508 (0.448) data 0.348 (0.296) loss_x loss_x 0.5449 (0.3609) acc_x 84.3750 (90.0000) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/39] time 0.439 (0.452) data 0.258 (0.300) loss_u loss_u 0.9956 (0.9771) acc_u 0.0000 (2.5000) lr 7.9721e-04 eta 0:00:15
epoch [115/200] batch [10/39] time 0.472 (0.443) data 0.305 (0.287) loss_u loss_u 0.9678 (0.9750) acc_u 6.2500 (3.1250) lr 7.9721e-04 eta 0:00:12
epoch [115/200] batch [15/39] time 0.529 (0.455) data 0.366 (0.298) loss_u loss_u 0.9966 (0.9740) acc_u 0.0000 (3.1250) lr 7.9721e-04 eta 0:00:10
epoch [115/200] batch [20/39] time 0.467 (0.461) data 0.305 (0.305) loss_u loss_u 1.0000 (0.9769) acc_u 0.0000 (2.6562) lr 7.9721e-04 eta 0:00:08
epoch [115/200] batch [25/39] time 0.464 (0.462) data 0.296 (0.304) loss_u loss_u 0.9688 (0.9777) acc_u 3.1250 (2.5000) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [30/39] time 0.419 (0.459) data 0.250 (0.302) loss_u loss_u 0.9873 (0.9765) acc_u 3.1250 (2.8125) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [35/39] time 0.439 (0.452) data 0.270 (0.294) loss_u loss_u 0.9922 (0.9769) acc_u 0.0000 (2.6786) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 365
clean true:342
clean false:23
clean_rate:0.936986301369863
noisy true:818
noisy false:449
after delete: len(clean_dataset) 365
after delete: len(noisy_dataset) 1267
epoch [116/200] batch [5/11] time 0.480 (0.487) data 0.320 (0.328) loss_x loss_x 0.3447 (0.4099) acc_x 93.7500 (91.2500) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/11] time 0.449 (0.467) data 0.285 (0.307) loss_x loss_x 0.3552 (0.3631) acc_x 93.7500 (92.5000) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/39] time 0.425 (0.457) data 0.347 (0.301) loss_u loss_u 0.9985 (0.9771) acc_u 0.0000 (3.1250) lr 7.8186e-04 eta 0:00:15
epoch [116/200] batch [10/39] time 0.549 (0.466) data 0.382 (0.307) loss_u loss_u 0.9922 (0.9750) acc_u 0.0000 (2.8125) lr 7.8186e-04 eta 0:00:13
epoch [116/200] batch [15/39] time 0.449 (0.473) data 0.280 (0.312) loss_u loss_u 0.9355 (0.9690) acc_u 9.3750 (3.5417) lr 7.8186e-04 eta 0:00:11
epoch [116/200] batch [20/39] time 0.421 (0.459) data 0.252 (0.301) loss_u loss_u 0.9521 (0.9723) acc_u 6.2500 (3.2812) lr 7.8186e-04 eta 0:00:08
epoch [116/200] batch [25/39] time 0.437 (0.457) data 0.270 (0.297) loss_u loss_u 0.9888 (0.9707) acc_u 0.0000 (3.3750) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [30/39] time 0.350 (0.451) data 0.272 (0.292) loss_u loss_u 0.9990 (0.9728) acc_u 0.0000 (3.0208) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [35/39] time 0.461 (0.449) data 0.295 (0.290) loss_u loss_u 0.9980 (0.9744) acc_u 0.0000 (2.7679) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 471
confident_label rate tensor(0.2237, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 365
clean true:339
clean false:26
clean_rate:0.9287671232876712
noisy true:822
noisy false:445
after delete: len(clean_dataset) 365
after delete: len(noisy_dataset) 1267
epoch [117/200] batch [5/11] time 0.432 (0.397) data 0.272 (0.253) loss_x loss_x 0.3518 (0.3067) acc_x 96.8750 (93.7500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/11] time 0.449 (0.429) data 0.287 (0.277) loss_x loss_x 0.5098 (0.3123) acc_x 87.5000 (92.8125) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/39] time 0.338 (0.431) data 0.259 (0.280) loss_u loss_u 0.9482 (0.9761) acc_u 6.2500 (2.5000) lr 7.6655e-04 eta 0:00:14
epoch [117/200] batch [10/39] time 0.451 (0.438) data 0.288 (0.284) loss_u loss_u 0.9946 (0.9702) acc_u 0.0000 (3.4375) lr 7.6655e-04 eta 0:00:12
epoch [117/200] batch [15/39] time 0.433 (0.440) data 0.271 (0.283) loss_u loss_u 0.9976 (0.9727) acc_u 0.0000 (3.1250) lr 7.6655e-04 eta 0:00:10
epoch [117/200] batch [20/39] time 0.436 (0.437) data 0.270 (0.281) loss_u loss_u 0.9985 (0.9690) acc_u 0.0000 (3.5938) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [25/39] time 0.445 (0.435) data 0.275 (0.278) loss_u loss_u 0.9829 (0.9706) acc_u 3.1250 (3.3750) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [30/39] time 0.436 (0.436) data 0.272 (0.277) loss_u loss_u 0.9697 (0.9723) acc_u 3.1250 (3.1250) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [35/39] time 0.398 (0.433) data 0.230 (0.275) loss_u loss_u 0.9932 (0.9715) acc_u 0.0000 (3.2143) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 483
confident_label rate tensor(0.2224, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 363
clean true:338
clean false:25
clean_rate:0.931129476584022
noisy true:811
noisy false:458
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1269
epoch [118/200] batch [5/11] time 0.452 (0.441) data 0.285 (0.278) loss_x loss_x 0.2034 (0.2424) acc_x 96.8750 (95.6250) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/11] time 0.426 (0.444) data 0.265 (0.281) loss_x loss_x 0.5146 (0.3618) acc_x 87.5000 (92.1875) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/39] time 0.439 (0.443) data 0.276 (0.278) loss_u loss_u 0.9688 (0.9785) acc_u 3.1250 (1.8750) lr 7.5131e-04 eta 0:00:15
epoch [118/200] batch [10/39] time 0.537 (0.475) data 0.368 (0.310) loss_u loss_u 0.9980 (0.9711) acc_u 0.0000 (2.8125) lr 7.5131e-04 eta 0:00:13
epoch [118/200] batch [15/39] time 0.454 (0.465) data 0.289 (0.303) loss_u loss_u 0.9673 (0.9728) acc_u 3.1250 (2.7083) lr 7.5131e-04 eta 0:00:11
epoch [118/200] batch [20/39] time 0.438 (0.461) data 0.274 (0.299) loss_u loss_u 0.9497 (0.9719) acc_u 6.2500 (2.9688) lr 7.5131e-04 eta 0:00:08
epoch [118/200] batch [25/39] time 0.455 (0.460) data 0.290 (0.297) loss_u loss_u 0.9478 (0.9650) acc_u 6.2500 (3.7500) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [30/39] time 0.443 (0.455) data 0.275 (0.294) loss_u loss_u 0.9404 (0.9671) acc_u 6.2500 (3.5417) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [35/39] time 0.454 (0.450) data 0.284 (0.288) loss_u loss_u 0.9673 (0.9688) acc_u 6.2500 (3.4821) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2273, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 371
clean true:341
clean false:30
clean_rate:0.9191374663072777
noisy true:823
noisy false:438
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1261
epoch [119/200] batch [5/11] time 0.489 (0.443) data 0.327 (0.290) loss_x loss_x 0.1724 (0.3102) acc_x 100.0000 (93.7500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/11] time 0.477 (0.476) data 0.315 (0.317) loss_x loss_x 0.7842 (0.3660) acc_x 87.5000 (93.1250) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/39] time 0.460 (0.469) data 0.294 (0.313) loss_u loss_u 0.9702 (0.9396) acc_u 3.1250 (6.2500) lr 7.3613e-04 eta 0:00:15
epoch [119/200] batch [10/39] time 0.445 (0.470) data 0.278 (0.312) loss_u loss_u 0.9976 (0.9533) acc_u 0.0000 (4.6875) lr 7.3613e-04 eta 0:00:13
epoch [119/200] batch [15/39] time 0.431 (0.463) data 0.266 (0.304) loss_u loss_u 0.9995 (0.9615) acc_u 0.0000 (4.1667) lr 7.3613e-04 eta 0:00:11
epoch [119/200] batch [20/39] time 0.484 (0.463) data 0.319 (0.302) loss_u loss_u 0.9761 (0.9672) acc_u 3.1250 (3.5938) lr 7.3613e-04 eta 0:00:08
epoch [119/200] batch [25/39] time 0.431 (0.466) data 0.265 (0.304) loss_u loss_u 0.9062 (0.9673) acc_u 9.3750 (3.5000) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [30/39] time 0.420 (0.463) data 0.229 (0.303) loss_u loss_u 0.9487 (0.9705) acc_u 6.2500 (3.1250) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [35/39] time 0.426 (0.456) data 0.262 (0.295) loss_u loss_u 0.9951 (0.9734) acc_u 0.0000 (2.7679) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 491
confident_label rate tensor(0.2224, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 363
clean true:334
clean false:29
clean_rate:0.9201101928374655
noisy true:807
noisy false:462
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1269
epoch [120/200] batch [5/11] time 0.445 (0.470) data 0.281 (0.322) loss_x loss_x 0.3079 (0.3276) acc_x 96.8750 (93.1250) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/11] time 0.433 (0.469) data 0.268 (0.313) loss_x loss_x 0.4109 (0.3020) acc_x 90.6250 (93.1250) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/39] time 0.412 (0.460) data 0.248 (0.300) loss_u loss_u 0.9839 (0.9546) acc_u 3.1250 (5.6250) lr 7.2101e-04 eta 0:00:15
epoch [120/200] batch [10/39] time 0.510 (0.463) data 0.341 (0.305) loss_u loss_u 0.9976 (0.9628) acc_u 0.0000 (4.3750) lr 7.2101e-04 eta 0:00:13
epoch [120/200] batch [15/39] time 0.471 (0.463) data 0.302 (0.303) loss_u loss_u 0.9990 (0.9650) acc_u 0.0000 (4.1667) lr 7.2101e-04 eta 0:00:11
epoch [120/200] batch [20/39] time 0.461 (0.463) data 0.294 (0.304) loss_u loss_u 0.9932 (0.9681) acc_u 3.1250 (3.9062) lr 7.2101e-04 eta 0:00:08
epoch [120/200] batch [25/39] time 0.428 (0.466) data 0.259 (0.306) loss_u loss_u 0.9736 (0.9689) acc_u 3.1250 (3.7500) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [30/39] time 0.457 (0.462) data 0.287 (0.301) loss_u loss_u 0.9780 (0.9670) acc_u 3.1250 (3.9583) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [35/39] time 0.429 (0.461) data 0.264 (0.302) loss_u loss_u 0.9878 (0.9673) acc_u 0.0000 (3.9286) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 457
confident_label rate tensor(0.2335, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 381
clean true:350
clean false:31
clean_rate:0.9186351706036745
noisy true:825
noisy false:426
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1251
epoch [121/200] batch [5/11] time 0.449 (0.485) data 0.287 (0.323) loss_x loss_x 0.1877 (0.1961) acc_x 96.8750 (97.5000) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [10/11] time 0.436 (0.466) data 0.276 (0.304) loss_x loss_x 0.5532 (0.3079) acc_x 84.3750 (93.4375) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/39] time 0.506 (0.464) data 0.338 (0.303) loss_u loss_u 0.9912 (0.9825) acc_u 0.0000 (1.2500) lr 7.0596e-04 eta 0:00:15
epoch [121/200] batch [10/39] time 0.479 (0.468) data 0.309 (0.307) loss_u loss_u 0.9873 (0.9827) acc_u 3.1250 (1.5625) lr 7.0596e-04 eta 0:00:13
epoch [121/200] batch [15/39] time 0.460 (0.464) data 0.299 (0.302) loss_u loss_u 0.9946 (0.9847) acc_u 0.0000 (1.4583) lr 7.0596e-04 eta 0:00:11
epoch [121/200] batch [20/39] time 0.495 (0.468) data 0.333 (0.305) loss_u loss_u 0.9976 (0.9867) acc_u 0.0000 (1.2500) lr 7.0596e-04 eta 0:00:08
epoch [121/200] batch [25/39] time 0.401 (0.460) data 0.234 (0.297) loss_u loss_u 0.9868 (0.9844) acc_u 3.1250 (1.5000) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [30/39] time 0.485 (0.459) data 0.317 (0.298) loss_u loss_u 0.9600 (0.9850) acc_u 3.1250 (1.5625) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [35/39] time 0.388 (0.454) data 0.232 (0.292) loss_u loss_u 0.9868 (0.9816) acc_u 3.1250 (2.0536) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 482
confident_label rate tensor(0.2224, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 363
clean true:335
clean false:28
clean_rate:0.9228650137741047
noisy true:815
noisy false:454
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1269
epoch [122/200] batch [5/11] time 0.436 (0.456) data 0.275 (0.290) loss_x loss_x 0.4714 (0.3829) acc_x 87.5000 (91.8750) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/11] time 0.389 (0.436) data 0.228 (0.273) loss_x loss_x 0.1821 (0.3046) acc_x 96.8750 (94.0625) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/39] time 0.395 (0.433) data 0.317 (0.275) loss_u loss_u 0.9458 (0.9424) acc_u 9.3750 (6.8750) lr 6.9098e-04 eta 0:00:14
epoch [122/200] batch [10/39] time 0.439 (0.434) data 0.275 (0.276) loss_u loss_u 0.9150 (0.9456) acc_u 9.3750 (6.2500) lr 6.9098e-04 eta 0:00:12
epoch [122/200] batch [15/39] time 0.431 (0.436) data 0.265 (0.277) loss_u loss_u 0.9956 (0.9571) acc_u 0.0000 (5.0000) lr 6.9098e-04 eta 0:00:10
epoch [122/200] batch [20/39] time 0.475 (0.431) data 0.306 (0.273) loss_u loss_u 0.9961 (0.9645) acc_u 0.0000 (4.0625) lr 6.9098e-04 eta 0:00:08
epoch [122/200] batch [25/39] time 0.432 (0.434) data 0.271 (0.275) loss_u loss_u 0.9990 (0.9660) acc_u 0.0000 (3.7500) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [30/39] time 0.378 (0.437) data 0.299 (0.279) loss_u loss_u 0.9590 (0.9674) acc_u 6.2500 (3.6458) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [35/39] time 0.458 (0.440) data 0.290 (0.282) loss_u loss_u 0.9722 (0.9707) acc_u 3.1250 (3.3036) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 462
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 383
clean true:352
clean false:31
clean_rate:0.9190600522193212
noisy true:818
noisy false:431
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1249
epoch [123/200] batch [5/11] time 0.442 (0.427) data 0.279 (0.280) loss_x loss_x 0.4592 (0.4084) acc_x 87.5000 (87.5000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/11] time 0.432 (0.452) data 0.267 (0.296) loss_x loss_x 0.3420 (0.4079) acc_x 84.3750 (89.0625) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/39] time 0.440 (0.451) data 0.273 (0.297) loss_u loss_u 0.9717 (0.9914) acc_u 3.1250 (0.6250) lr 6.7608e-04 eta 0:00:15
epoch [123/200] batch [10/39] time 0.461 (0.458) data 0.298 (0.302) loss_u loss_u 0.9897 (0.9848) acc_u 3.1250 (1.8750) lr 6.7608e-04 eta 0:00:13
epoch [123/200] batch [15/39] time 0.402 (0.455) data 0.236 (0.298) loss_u loss_u 0.9995 (0.9797) acc_u 0.0000 (2.5000) lr 6.7608e-04 eta 0:00:10
epoch [123/200] batch [20/39] time 0.500 (0.456) data 0.342 (0.300) loss_u loss_u 0.9849 (0.9809) acc_u 0.0000 (2.1875) lr 6.7608e-04 eta 0:00:08
epoch [123/200] batch [25/39] time 0.461 (0.460) data 0.300 (0.303) loss_u loss_u 0.9995 (0.9823) acc_u 0.0000 (2.0000) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [30/39] time 0.492 (0.463) data 0.324 (0.305) loss_u loss_u 0.9629 (0.9778) acc_u 3.1250 (2.3958) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [35/39] time 0.442 (0.462) data 0.276 (0.303) loss_u loss_u 0.9897 (0.9784) acc_u 3.1250 (2.4107) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 449
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:348
clean false:26
clean_rate:0.93048128342246
noisy true:835
noisy false:423
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [124/200] batch [5/11] time 0.367 (0.444) data 0.289 (0.297) loss_x loss_x 0.2035 (0.3985) acc_x 96.8750 (91.2500) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/11] time 0.424 (0.447) data 0.261 (0.289) loss_x loss_x 0.2734 (0.3427) acc_x 96.8750 (92.1875) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/39] time 0.472 (0.440) data 0.302 (0.278) loss_u loss_u 0.9541 (0.9599) acc_u 6.2500 (5.0000) lr 6.6126e-04 eta 0:00:14
epoch [124/200] batch [10/39] time 0.462 (0.442) data 0.299 (0.284) loss_u loss_u 0.9858 (0.9772) acc_u 3.1250 (2.8125) lr 6.6126e-04 eta 0:00:12
epoch [124/200] batch [15/39] time 0.498 (0.448) data 0.334 (0.289) loss_u loss_u 0.9741 (0.9720) acc_u 3.1250 (3.5417) lr 6.6126e-04 eta 0:00:10
epoch [124/200] batch [20/39] time 0.462 (0.449) data 0.296 (0.289) loss_u loss_u 0.9824 (0.9750) acc_u 0.0000 (2.9688) lr 6.6126e-04 eta 0:00:08
epoch [124/200] batch [25/39] time 0.415 (0.449) data 0.249 (0.288) loss_u loss_u 0.9492 (0.9755) acc_u 6.2500 (2.8750) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [30/39] time 0.472 (0.450) data 0.305 (0.289) loss_u loss_u 0.9717 (0.9716) acc_u 3.1250 (3.2292) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [35/39] time 0.448 (0.450) data 0.287 (0.291) loss_u loss_u 0.9795 (0.9718) acc_u 3.1250 (3.2143) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 467
confident_label rate tensor(0.2298, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 375
clean true:352
clean false:23
clean_rate:0.9386666666666666
noisy true:813
noisy false:444
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1257
epoch [125/200] batch [5/11] time 0.394 (0.417) data 0.227 (0.270) loss_x loss_x 0.2698 (0.4070) acc_x 93.7500 (90.0000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/11] time 0.489 (0.429) data 0.323 (0.273) loss_x loss_x 0.1897 (0.3544) acc_x 93.7500 (90.9375) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/39] time 0.499 (0.450) data 0.332 (0.290) loss_u loss_u 0.9917 (0.9876) acc_u 0.0000 (1.2500) lr 6.4653e-04 eta 0:00:15
epoch [125/200] batch [10/39] time 0.448 (0.453) data 0.278 (0.295) loss_u loss_u 0.9912 (0.9849) acc_u 0.0000 (1.5625) lr 6.4653e-04 eta 0:00:13
epoch [125/200] batch [15/39] time 0.476 (0.466) data 0.312 (0.306) loss_u loss_u 0.9736 (0.9817) acc_u 3.1250 (1.8750) lr 6.4653e-04 eta 0:00:11
epoch [125/200] batch [20/39] time 0.477 (0.459) data 0.311 (0.301) loss_u loss_u 0.9995 (0.9833) acc_u 0.0000 (1.7188) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [25/39] time 0.492 (0.463) data 0.329 (0.304) loss_u loss_u 0.9697 (0.9775) acc_u 3.1250 (2.2500) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [30/39] time 0.527 (0.468) data 0.359 (0.309) loss_u loss_u 0.9673 (0.9790) acc_u 3.1250 (2.1875) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [35/39] time 0.385 (0.468) data 0.224 (0.309) loss_u loss_u 0.9653 (0.9778) acc_u 3.1250 (2.3214) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2304, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 376
clean true:349
clean false:27
clean_rate:0.9281914893617021
noisy true:815
noisy false:441
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1256
epoch [126/200] batch [5/11] time 0.492 (0.456) data 0.330 (0.294) loss_x loss_x 0.2629 (0.3390) acc_x 96.8750 (93.1250) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [10/11] time 0.561 (0.471) data 0.405 (0.318) loss_x loss_x 0.1498 (0.3101) acc_x 100.0000 (93.4375) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/39] time 0.401 (0.457) data 0.233 (0.300) loss_u loss_u 0.9712 (0.9768) acc_u 3.1250 (2.5000) lr 6.3188e-04 eta 0:00:15
epoch [126/200] batch [10/39] time 0.430 (0.451) data 0.269 (0.296) loss_u loss_u 0.9995 (0.9813) acc_u 0.0000 (2.1875) lr 6.3188e-04 eta 0:00:13
epoch [126/200] batch [15/39] time 0.490 (0.457) data 0.322 (0.299) loss_u loss_u 0.9736 (0.9808) acc_u 3.1250 (2.2917) lr 6.3188e-04 eta 0:00:10
epoch [126/200] batch [20/39] time 0.453 (0.458) data 0.283 (0.299) loss_u loss_u 0.9995 (0.9789) acc_u 0.0000 (2.3438) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [25/39] time 0.432 (0.454) data 0.266 (0.295) loss_u loss_u 0.9995 (0.9790) acc_u 0.0000 (2.3750) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [30/39] time 0.476 (0.454) data 0.308 (0.294) loss_u loss_u 0.9932 (0.9763) acc_u 0.0000 (2.7083) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [35/39] time 0.448 (0.453) data 0.289 (0.293) loss_u loss_u 0.9995 (0.9767) acc_u 0.0000 (2.7679) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 461
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:346
clean false:28
clean_rate:0.9251336898395722
noisy true:825
noisy false:433
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [127/200] batch [5/11] time 0.495 (0.452) data 0.334 (0.287) loss_x loss_x 0.2021 (0.3033) acc_x 96.8750 (93.7500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [10/11] time 0.477 (0.476) data 0.318 (0.313) loss_x loss_x 0.2593 (0.2855) acc_x 96.8750 (92.8125) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/39] time 0.508 (0.470) data 0.339 (0.311) loss_u loss_u 0.9985 (0.9757) acc_u 0.0000 (3.1250) lr 6.1732e-04 eta 0:00:15
epoch [127/200] batch [10/39] time 0.458 (0.472) data 0.294 (0.311) loss_u loss_u 0.9897 (0.9694) acc_u 0.0000 (3.1250) lr 6.1732e-04 eta 0:00:13
epoch [127/200] batch [15/39] time 0.382 (0.464) data 0.226 (0.303) loss_u loss_u 0.9956 (0.9743) acc_u 0.0000 (2.9167) lr 6.1732e-04 eta 0:00:11
epoch [127/200] batch [20/39] time 0.459 (0.463) data 0.298 (0.301) loss_u loss_u 0.9468 (0.9710) acc_u 6.2500 (3.2812) lr 6.1732e-04 eta 0:00:08
epoch [127/200] batch [25/39] time 0.457 (0.465) data 0.295 (0.303) loss_u loss_u 0.9712 (0.9732) acc_u 3.1250 (3.0000) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [30/39] time 0.480 (0.468) data 0.318 (0.305) loss_u loss_u 0.9619 (0.9718) acc_u 3.1250 (3.0208) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [35/39] time 0.429 (0.465) data 0.266 (0.303) loss_u loss_u 0.9678 (0.9738) acc_u 3.1250 (2.7679) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 480
confident_label rate tensor(0.2261, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 369
clean true:340
clean false:29
clean_rate:0.9214092140921409
noisy true:812
noisy false:451
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1263
epoch [128/200] batch [5/11] time 0.463 (0.451) data 0.288 (0.302) loss_x loss_x 0.3943 (0.4084) acc_x 90.6250 (92.5000) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/11] time 0.431 (0.449) data 0.273 (0.293) loss_x loss_x 0.5474 (0.3727) acc_x 87.5000 (91.5625) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/39] time 0.512 (0.465) data 0.351 (0.305) loss_u loss_u 1.0000 (0.9857) acc_u 0.0000 (1.2500) lr 6.0285e-04 eta 0:00:15
epoch [128/200] batch [10/39] time 0.501 (0.466) data 0.334 (0.308) loss_u loss_u 0.9663 (0.9778) acc_u 3.1250 (2.5000) lr 6.0285e-04 eta 0:00:13
epoch [128/200] batch [15/39] time 0.497 (0.469) data 0.336 (0.310) loss_u loss_u 0.9688 (0.9736) acc_u 3.1250 (2.9167) lr 6.0285e-04 eta 0:00:11
epoch [128/200] batch [20/39] time 0.375 (0.465) data 0.218 (0.306) loss_u loss_u 0.9668 (0.9748) acc_u 3.1250 (2.8125) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [25/39] time 0.441 (0.456) data 0.275 (0.296) loss_u loss_u 0.9712 (0.9725) acc_u 3.1250 (3.1250) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [30/39] time 0.418 (0.453) data 0.253 (0.292) loss_u loss_u 0.9663 (0.9733) acc_u 3.1250 (3.0208) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [35/39] time 0.433 (0.450) data 0.267 (0.289) loss_u loss_u 0.9707 (0.9754) acc_u 3.1250 (2.8571) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 480
confident_label rate tensor(0.2316, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 378
clean true:347
clean false:31
clean_rate:0.917989417989418
noisy true:805
noisy false:449
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1254
epoch [129/200] batch [5/11] time 0.437 (0.428) data 0.276 (0.264) loss_x loss_x 0.1691 (0.3097) acc_x 100.0000 (93.7500) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/11] time 0.476 (0.449) data 0.312 (0.292) loss_x loss_x 0.2205 (0.3525) acc_x 96.8750 (91.5625) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/39] time 0.522 (0.462) data 0.353 (0.301) loss_u loss_u 0.9692 (0.9758) acc_u 3.1250 (2.5000) lr 5.8849e-04 eta 0:00:15
epoch [129/200] batch [10/39] time 0.423 (0.456) data 0.254 (0.294) loss_u loss_u 0.9707 (0.9803) acc_u 3.1250 (2.1875) lr 5.8849e-04 eta 0:00:13
epoch [129/200] batch [15/39] time 0.538 (0.458) data 0.374 (0.295) loss_u loss_u 0.9956 (0.9829) acc_u 0.0000 (1.8750) lr 5.8849e-04 eta 0:00:10
epoch [129/200] batch [20/39] time 0.349 (0.457) data 0.269 (0.297) loss_u loss_u 0.9951 (0.9837) acc_u 0.0000 (1.7188) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [25/39] time 0.435 (0.452) data 0.270 (0.293) loss_u loss_u 0.9482 (0.9840) acc_u 6.2500 (1.7500) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [30/39] time 0.437 (0.450) data 0.271 (0.290) loss_u loss_u 0.9941 (0.9821) acc_u 0.0000 (1.8750) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [35/39] time 0.438 (0.449) data 0.272 (0.291) loss_u loss_u 0.9985 (0.9801) acc_u 0.0000 (2.1429) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 482
confident_label rate tensor(0.2286, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 373
clean true:341
clean false:32
clean_rate:0.9142091152815014
noisy true:809
noisy false:450
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1259
epoch [130/200] batch [5/11] time 0.382 (0.433) data 0.304 (0.288) loss_x loss_x 0.4026 (0.2879) acc_x 93.7500 (94.3750) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [10/11] time 0.444 (0.436) data 0.280 (0.281) loss_x loss_x 0.2603 (0.3170) acc_x 93.7500 (93.1250) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/39] time 0.484 (0.442) data 0.316 (0.283) loss_u loss_u 0.9995 (0.9698) acc_u 0.0000 (3.1250) lr 5.7422e-04 eta 0:00:15
epoch [130/200] batch [10/39] time 0.438 (0.438) data 0.271 (0.281) loss_u loss_u 0.9653 (0.9710) acc_u 3.1250 (3.1250) lr 5.7422e-04 eta 0:00:12
epoch [130/200] batch [15/39] time 0.436 (0.439) data 0.274 (0.280) loss_u loss_u 0.9756 (0.9714) acc_u 3.1250 (3.1250) lr 5.7422e-04 eta 0:00:10
epoch [130/200] batch [20/39] time 0.417 (0.439) data 0.246 (0.279) loss_u loss_u 0.9116 (0.9692) acc_u 9.3750 (3.2812) lr 5.7422e-04 eta 0:00:08
epoch [130/200] batch [25/39] time 0.436 (0.437) data 0.266 (0.278) loss_u loss_u 0.9766 (0.9707) acc_u 3.1250 (3.2500) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [30/39] time 0.433 (0.436) data 0.263 (0.275) loss_u loss_u 0.9648 (0.9713) acc_u 3.1250 (3.1250) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [35/39] time 0.457 (0.437) data 0.286 (0.276) loss_u loss_u 0.9858 (0.9697) acc_u 3.1250 (3.3036) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 477
confident_label rate tensor(0.2286, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 373
clean true:350
clean false:23
clean_rate:0.938337801608579
noisy true:805
noisy false:454
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1259
epoch [131/200] batch [5/11] time 0.419 (0.439) data 0.260 (0.294) loss_x loss_x 0.1335 (0.2560) acc_x 100.0000 (95.6250) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/11] time 0.461 (0.444) data 0.296 (0.291) loss_x loss_x 0.1538 (0.2931) acc_x 96.8750 (93.7500) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/39] time 0.461 (0.450) data 0.294 (0.293) loss_u loss_u 0.9814 (0.9713) acc_u 3.1250 (3.7500) lr 5.6006e-04 eta 0:00:15
epoch [131/200] batch [10/39] time 0.459 (0.447) data 0.295 (0.292) loss_u loss_u 0.9697 (0.9751) acc_u 3.1250 (3.1250) lr 5.6006e-04 eta 0:00:12
epoch [131/200] batch [15/39] time 0.445 (0.444) data 0.282 (0.288) loss_u loss_u 0.9976 (0.9795) acc_u 0.0000 (2.5000) lr 5.6006e-04 eta 0:00:10
epoch [131/200] batch [20/39] time 0.321 (0.439) data 0.220 (0.285) loss_u loss_u 0.9951 (0.9787) acc_u 0.0000 (2.5000) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [25/39] time 0.418 (0.433) data 0.250 (0.277) loss_u loss_u 0.9712 (0.9781) acc_u 3.1250 (2.5000) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [30/39] time 0.439 (0.432) data 0.272 (0.276) loss_u loss_u 0.9985 (0.9785) acc_u 0.0000 (2.3958) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [35/39] time 0.430 (0.429) data 0.260 (0.273) loss_u loss_u 0.9790 (0.9780) acc_u 3.1250 (2.5893) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 467
confident_label rate tensor(0.2310, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 377
clean true:345
clean false:32
clean_rate:0.9151193633952255
noisy true:820
noisy false:435
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1255
epoch [132/200] batch [5/11] time 0.385 (0.418) data 0.221 (0.272) loss_x loss_x 0.3345 (0.3218) acc_x 90.6250 (93.1250) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/11] time 0.464 (0.427) data 0.302 (0.273) loss_x loss_x 0.3611 (0.3636) acc_x 87.5000 (91.5625) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/39] time 0.541 (0.442) data 0.376 (0.290) loss_u loss_u 0.9995 (0.9833) acc_u 0.0000 (1.8750) lr 5.4601e-04 eta 0:00:15
epoch [132/200] batch [10/39] time 0.476 (0.453) data 0.317 (0.299) loss_u loss_u 0.9746 (0.9821) acc_u 3.1250 (2.1875) lr 5.4601e-04 eta 0:00:13
epoch [132/200] batch [15/39] time 0.467 (0.458) data 0.302 (0.302) loss_u loss_u 0.9722 (0.9789) acc_u 3.1250 (2.5000) lr 5.4601e-04 eta 0:00:11
epoch [132/200] batch [20/39] time 0.462 (0.457) data 0.303 (0.302) loss_u loss_u 0.9971 (0.9758) acc_u 0.0000 (2.8125) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [25/39] time 0.385 (0.455) data 0.220 (0.298) loss_u loss_u 0.9766 (0.9777) acc_u 3.1250 (2.6250) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [30/39] time 0.442 (0.449) data 0.282 (0.294) loss_u loss_u 0.9980 (0.9778) acc_u 0.0000 (2.6042) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [35/39] time 0.439 (0.447) data 0.276 (0.291) loss_u loss_u 0.9380 (0.9760) acc_u 6.2500 (2.8571) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 483
confident_label rate tensor(0.2249, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 367
clean true:341
clean false:26
clean_rate:0.9291553133514986
noisy true:808
noisy false:457
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1265
epoch [133/200] batch [5/11] time 0.482 (0.489) data 0.317 (0.320) loss_x loss_x 0.3608 (0.2827) acc_x 90.6250 (93.1250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/11] time 0.431 (0.460) data 0.266 (0.294) loss_x loss_x 0.4590 (0.3756) acc_x 84.3750 (90.3125) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/39] time 0.496 (0.471) data 0.332 (0.310) loss_u loss_u 0.9956 (0.9687) acc_u 0.0000 (3.1250) lr 5.3207e-04 eta 0:00:16
epoch [133/200] batch [10/39] time 0.539 (0.478) data 0.371 (0.316) loss_u loss_u 0.9966 (0.9781) acc_u 0.0000 (2.5000) lr 5.3207e-04 eta 0:00:13
epoch [133/200] batch [15/39] time 0.340 (0.482) data 0.261 (0.323) loss_u loss_u 0.9712 (0.9750) acc_u 3.1250 (2.7083) lr 5.3207e-04 eta 0:00:11
epoch [133/200] batch [20/39] time 0.439 (0.469) data 0.278 (0.310) loss_u loss_u 0.8872 (0.9684) acc_u 12.5000 (3.5938) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [25/39] time 0.435 (0.468) data 0.271 (0.307) loss_u loss_u 0.9922 (0.9682) acc_u 0.0000 (3.5000) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [30/39] time 0.443 (0.462) data 0.282 (0.303) loss_u loss_u 0.9941 (0.9708) acc_u 0.0000 (3.1250) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [35/39] time 0.432 (0.459) data 0.270 (0.299) loss_u loss_u 0.9907 (0.9721) acc_u 0.0000 (3.0357) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 459
confident_label rate tensor(0.2298, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 375
clean true:347
clean false:28
clean_rate:0.9253333333333333
noisy true:826
noisy false:431
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1257
epoch [134/200] batch [5/11] time 0.357 (0.450) data 0.278 (0.304) loss_x loss_x 0.3542 (0.3166) acc_x 96.8750 (93.7500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/11] time 0.437 (0.451) data 0.274 (0.296) loss_x loss_x 0.4932 (0.3667) acc_x 93.7500 (93.1250) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/39] time 0.448 (0.456) data 0.279 (0.296) loss_u loss_u 0.9727 (0.9838) acc_u 3.1250 (1.8750) lr 5.1825e-04 eta 0:00:15
epoch [134/200] batch [10/39] time 0.452 (0.457) data 0.284 (0.297) loss_u loss_u 0.9575 (0.9749) acc_u 6.2500 (3.1250) lr 5.1825e-04 eta 0:00:13
epoch [134/200] batch [15/39] time 0.491 (0.454) data 0.322 (0.293) loss_u loss_u 0.9951 (0.9748) acc_u 0.0000 (3.1250) lr 5.1825e-04 eta 0:00:10
epoch [134/200] batch [20/39] time 0.443 (0.449) data 0.275 (0.290) loss_u loss_u 0.9785 (0.9719) acc_u 3.1250 (3.4375) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [25/39] time 0.440 (0.447) data 0.276 (0.287) loss_u loss_u 0.9785 (0.9746) acc_u 3.1250 (3.1250) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [30/39] time 0.387 (0.442) data 0.222 (0.281) loss_u loss_u 0.9629 (0.9749) acc_u 3.1250 (3.0208) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [35/39] time 0.509 (0.439) data 0.341 (0.279) loss_u loss_u 0.9678 (0.9741) acc_u 3.1250 (2.9464) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 487
confident_label rate tensor(0.2267, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 370
clean true:343
clean false:27
clean_rate:0.927027027027027
noisy true:802
noisy false:460
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1262
epoch [135/200] batch [5/11] time 0.451 (0.430) data 0.287 (0.287) loss_x loss_x 0.1737 (0.2384) acc_x 100.0000 (96.2500) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/11] time 0.395 (0.446) data 0.231 (0.293) loss_x loss_x 0.2607 (0.3111) acc_x 100.0000 (94.6875) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/39] time 0.373 (0.435) data 0.295 (0.282) loss_u loss_u 0.9717 (0.9832) acc_u 3.1250 (1.8750) lr 5.0454e-04 eta 0:00:14
epoch [135/200] batch [10/39] time 0.441 (0.443) data 0.273 (0.287) loss_u loss_u 0.9277 (0.9796) acc_u 9.3750 (2.1875) lr 5.0454e-04 eta 0:00:12
epoch [135/200] batch [15/39] time 0.448 (0.445) data 0.279 (0.287) loss_u loss_u 0.9976 (0.9783) acc_u 0.0000 (2.5000) lr 5.0454e-04 eta 0:00:10
epoch [135/200] batch [20/39] time 0.440 (0.440) data 0.271 (0.283) loss_u loss_u 0.9678 (0.9772) acc_u 3.1250 (2.5000) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [25/39] time 0.443 (0.439) data 0.273 (0.281) loss_u loss_u 0.9531 (0.9742) acc_u 6.2500 (2.8750) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [30/39] time 0.431 (0.439) data 0.262 (0.279) loss_u loss_u 0.9380 (0.9704) acc_u 6.2500 (3.3333) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [35/39] time 0.432 (0.439) data 0.266 (0.281) loss_u loss_u 0.9575 (0.9698) acc_u 6.2500 (3.4821) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 495
confident_label rate tensor(0.2298, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 375
clean true:341
clean false:34
clean_rate:0.9093333333333333
noisy true:796
noisy false:461
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1257
epoch [136/200] batch [5/11] time 0.439 (0.452) data 0.276 (0.306) loss_x loss_x 0.3650 (0.3129) acc_x 93.7500 (91.8750) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/11] time 0.443 (0.453) data 0.283 (0.300) loss_x loss_x 0.4580 (0.3767) acc_x 84.3750 (90.6250) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/39] time 0.341 (0.438) data 0.264 (0.286) loss_u loss_u 0.9937 (0.9665) acc_u 0.0000 (3.1250) lr 4.9096e-04 eta 0:00:14
epoch [136/200] batch [10/39] time 0.458 (0.441) data 0.294 (0.286) loss_u loss_u 0.9912 (0.9675) acc_u 0.0000 (3.4375) lr 4.9096e-04 eta 0:00:12
epoch [136/200] batch [15/39] time 0.424 (0.442) data 0.267 (0.285) loss_u loss_u 0.9902 (0.9701) acc_u 3.1250 (3.3333) lr 4.9096e-04 eta 0:00:10
epoch [136/200] batch [20/39] time 0.401 (0.436) data 0.230 (0.278) loss_u loss_u 0.9854 (0.9701) acc_u 3.1250 (3.5938) lr 4.9096e-04 eta 0:00:08
epoch [136/200] batch [25/39] time 0.425 (0.435) data 0.262 (0.276) loss_u loss_u 0.9897 (0.9733) acc_u 3.1250 (3.2500) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [30/39] time 0.427 (0.435) data 0.258 (0.275) loss_u loss_u 0.9263 (0.9700) acc_u 9.3750 (3.6458) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [35/39] time 0.450 (0.434) data 0.283 (0.276) loss_u loss_u 0.9692 (0.9724) acc_u 3.1250 (3.3036) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 469
confident_label rate tensor(0.2359, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 385
clean true:350
clean false:35
clean_rate:0.9090909090909091
noisy true:813
noisy false:434
after delete: len(clean_dataset) 385
after delete: len(noisy_dataset) 1247
epoch [137/200] batch [5/12] time 0.474 (0.436) data 0.311 (0.281) loss_x loss_x 0.2659 (0.3396) acc_x 93.7500 (91.8750) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/12] time 0.425 (0.440) data 0.266 (0.281) loss_x loss_x 0.5698 (0.3519) acc_x 90.6250 (91.8750) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/38] time 0.481 (0.447) data 0.316 (0.288) loss_u loss_u 0.9678 (0.9741) acc_u 3.1250 (3.1250) lr 4.7750e-04 eta 0:00:14
epoch [137/200] batch [10/38] time 0.454 (0.448) data 0.290 (0.288) loss_u loss_u 0.9941 (0.9784) acc_u 0.0000 (2.5000) lr 4.7750e-04 eta 0:00:12
epoch [137/200] batch [15/38] time 0.460 (0.449) data 0.293 (0.288) loss_u loss_u 0.9531 (0.9760) acc_u 6.2500 (2.9167) lr 4.7750e-04 eta 0:00:10
epoch [137/200] batch [20/38] time 0.453 (0.448) data 0.288 (0.289) loss_u loss_u 0.9795 (0.9788) acc_u 3.1250 (2.6562) lr 4.7750e-04 eta 0:00:08
epoch [137/200] batch [25/38] time 0.439 (0.449) data 0.274 (0.289) loss_u loss_u 0.9907 (0.9796) acc_u 0.0000 (2.5000) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [30/38] time 0.384 (0.446) data 0.221 (0.286) loss_u loss_u 0.9990 (0.9780) acc_u 0.0000 (2.6042) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [35/38] time 0.452 (0.443) data 0.282 (0.282) loss_u loss_u 0.9507 (0.9786) acc_u 6.2500 (2.5000) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 469
confident_label rate tensor(0.2267, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 370
clean true:340
clean false:30
clean_rate:0.918918918918919
noisy true:823
noisy false:439
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1262
epoch [138/200] batch [5/11] time 0.467 (0.431) data 0.302 (0.284) loss_x loss_x 0.2323 (0.2697) acc_x 93.7500 (94.3750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/11] time 0.466 (0.445) data 0.307 (0.291) loss_x loss_x 0.3818 (0.2642) acc_x 93.7500 (94.6875) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/39] time 0.295 (0.436) data 0.216 (0.283) loss_u loss_u 0.9844 (0.9744) acc_u 0.0000 (2.5000) lr 4.6417e-04 eta 0:00:14
epoch [138/200] batch [10/39] time 0.438 (0.428) data 0.279 (0.272) loss_u loss_u 0.9756 (0.9759) acc_u 3.1250 (2.5000) lr 4.6417e-04 eta 0:00:12
epoch [138/200] batch [15/39] time 0.475 (0.435) data 0.310 (0.277) loss_u loss_u 0.9136 (0.9742) acc_u 9.3750 (2.7083) lr 4.6417e-04 eta 0:00:10
epoch [138/200] batch [20/39] time 0.443 (0.435) data 0.278 (0.279) loss_u loss_u 0.9951 (0.9769) acc_u 0.0000 (2.3438) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [25/39] time 0.433 (0.435) data 0.271 (0.278) loss_u loss_u 0.9297 (0.9729) acc_u 9.3750 (3.0000) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [30/39] time 0.391 (0.434) data 0.230 (0.276) loss_u loss_u 0.9995 (0.9739) acc_u 0.0000 (3.0208) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [35/39] time 0.413 (0.430) data 0.244 (0.274) loss_u loss_u 0.9971 (0.9741) acc_u 0.0000 (2.9464) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 460
confident_label rate tensor(0.2359, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 385
clean true:351
clean false:34
clean_rate:0.9116883116883117
noisy true:821
noisy false:426
after delete: len(clean_dataset) 385
after delete: len(noisy_dataset) 1247
epoch [139/200] batch [5/12] time 0.501 (0.441) data 0.330 (0.294) loss_x loss_x 0.1236 (0.3925) acc_x 96.8750 (91.2500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/12] time 0.444 (0.454) data 0.280 (0.298) loss_x loss_x 0.3862 (0.3620) acc_x 90.6250 (91.8750) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/38] time 0.438 (0.446) data 0.269 (0.291) loss_u loss_u 0.9263 (0.9718) acc_u 9.3750 (3.1250) lr 4.5098e-04 eta 0:00:14
epoch [139/200] batch [10/38] time 0.460 (0.448) data 0.292 (0.290) loss_u loss_u 0.9893 (0.9812) acc_u 0.0000 (1.8750) lr 4.5098e-04 eta 0:00:12
epoch [139/200] batch [15/38] time 0.472 (0.451) data 0.302 (0.291) loss_u loss_u 0.9883 (0.9805) acc_u 0.0000 (1.8750) lr 4.5098e-04 eta 0:00:10
epoch [139/200] batch [20/38] time 0.391 (0.446) data 0.222 (0.287) loss_u loss_u 1.0000 (0.9812) acc_u 0.0000 (1.8750) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [25/38] time 0.436 (0.444) data 0.273 (0.284) loss_u loss_u 0.9106 (0.9785) acc_u 9.3750 (2.2500) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [30/38] time 0.365 (0.443) data 0.260 (0.284) loss_u loss_u 0.9937 (0.9746) acc_u 0.0000 (2.8125) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [35/38] time 0.435 (0.442) data 0.271 (0.283) loss_u loss_u 0.9990 (0.9764) acc_u 0.0000 (2.6786) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 473
confident_label rate tensor(0.2322, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 379
clean true:348
clean false:31
clean_rate:0.9182058047493403
noisy true:811
noisy false:442
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1253
epoch [140/200] batch [5/11] time 0.442 (0.440) data 0.280 (0.295) loss_x loss_x 0.3696 (0.3209) acc_x 93.7500 (95.0000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/11] time 0.402 (0.418) data 0.238 (0.263) loss_x loss_x 0.2705 (0.2601) acc_x 93.7500 (95.6250) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/39] time 0.447 (0.440) data 0.277 (0.280) loss_u loss_u 0.9995 (0.9775) acc_u 0.0000 (1.8750) lr 4.3792e-04 eta 0:00:14
epoch [140/200] batch [10/39] time 0.460 (0.447) data 0.290 (0.286) loss_u loss_u 0.9492 (0.9733) acc_u 6.2500 (2.8125) lr 4.3792e-04 eta 0:00:12
epoch [140/200] batch [15/39] time 0.473 (0.451) data 0.304 (0.288) loss_u loss_u 0.9702 (0.9695) acc_u 3.1250 (3.3333) lr 4.3792e-04 eta 0:00:10
epoch [140/200] batch [20/39] time 0.488 (0.447) data 0.327 (0.289) loss_u loss_u 0.9775 (0.9687) acc_u 3.1250 (3.4375) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [25/39] time 0.417 (0.446) data 0.247 (0.286) loss_u loss_u 0.9761 (0.9725) acc_u 3.1250 (3.1250) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [30/39] time 0.456 (0.445) data 0.286 (0.284) loss_u loss_u 0.9990 (0.9735) acc_u 0.0000 (3.0208) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [35/39] time 0.426 (0.442) data 0.262 (0.282) loss_u loss_u 0.9697 (0.9749) acc_u 3.1250 (2.8571) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 480
confident_label rate tensor(0.2261, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 369
clean true:341
clean false:28
clean_rate:0.924119241192412
noisy true:811
noisy false:452
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1263
epoch [141/200] batch [5/11] time 0.447 (0.445) data 0.284 (0.300) loss_x loss_x 0.2235 (0.3721) acc_x 93.7500 (93.7500) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/11] time 0.450 (0.449) data 0.288 (0.296) loss_x loss_x 0.3455 (0.3721) acc_x 93.7500 (91.8750) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/39] time 0.451 (0.450) data 0.289 (0.293) loss_u loss_u 0.9995 (0.9655) acc_u 0.0000 (3.7500) lr 4.2499e-04 eta 0:00:15
epoch [141/200] batch [10/39] time 0.454 (0.443) data 0.289 (0.290) loss_u loss_u 0.9463 (0.9730) acc_u 6.2500 (2.8125) lr 4.2499e-04 eta 0:00:12
epoch [141/200] batch [15/39] time 0.456 (0.441) data 0.286 (0.285) loss_u loss_u 0.9351 (0.9688) acc_u 9.3750 (3.3333) lr 4.2499e-04 eta 0:00:10
epoch [141/200] batch [20/39] time 0.448 (0.439) data 0.281 (0.281) loss_u loss_u 0.9951 (0.9705) acc_u 0.0000 (3.1250) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [25/39] time 0.484 (0.439) data 0.317 (0.283) loss_u loss_u 0.9971 (0.9708) acc_u 0.0000 (3.1250) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [30/39] time 0.462 (0.441) data 0.292 (0.283) loss_u loss_u 0.9678 (0.9677) acc_u 3.1250 (3.6458) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [35/39] time 0.467 (0.441) data 0.291 (0.284) loss_u loss_u 0.9556 (0.9690) acc_u 6.2500 (3.4821) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 473
confident_label rate tensor(0.2267, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 370
clean true:340
clean false:30
clean_rate:0.918918918918919
noisy true:819
noisy false:443
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1262
epoch [142/200] batch [5/11] time 0.452 (0.448) data 0.292 (0.298) loss_x loss_x 0.2534 (0.3118) acc_x 93.7500 (93.7500) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/11] time 0.450 (0.457) data 0.291 (0.302) loss_x loss_x 0.2206 (0.2935) acc_x 93.7500 (95.0000) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/39] time 0.365 (0.449) data 0.283 (0.296) loss_u loss_u 0.9985 (0.9868) acc_u 0.0000 (1.2500) lr 4.1221e-04 eta 0:00:15
epoch [142/200] batch [10/39] time 0.441 (0.448) data 0.273 (0.292) loss_u loss_u 0.9692 (0.9731) acc_u 3.1250 (2.8125) lr 4.1221e-04 eta 0:00:13
epoch [142/200] batch [15/39] time 0.431 (0.446) data 0.265 (0.289) loss_u loss_u 0.9961 (0.9640) acc_u 0.0000 (3.7500) lr 4.1221e-04 eta 0:00:10
epoch [142/200] batch [20/39] time 0.459 (0.443) data 0.292 (0.288) loss_u loss_u 0.9805 (0.9650) acc_u 3.1250 (3.9062) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [25/39] time 0.453 (0.443) data 0.286 (0.286) loss_u loss_u 0.9951 (0.9663) acc_u 0.0000 (3.7500) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [30/39] time 0.397 (0.443) data 0.228 (0.284) loss_u loss_u 0.9717 (0.9688) acc_u 3.1250 (3.4375) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [35/39] time 0.437 (0.438) data 0.274 (0.280) loss_u loss_u 0.9976 (0.9688) acc_u 0.0000 (3.3929) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2304, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 376
clean true:342
clean false:34
clean_rate:0.9095744680851063
noisy true:822
noisy false:434
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1256
epoch [143/200] batch [5/11] time 0.457 (0.436) data 0.301 (0.273) loss_x loss_x 0.1561 (0.3402) acc_x 100.0000 (93.7500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/11] time 0.497 (0.458) data 0.339 (0.295) loss_x loss_x 0.2122 (0.3498) acc_x 96.8750 (93.4375) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/39] time 0.385 (0.438) data 0.225 (0.280) loss_u loss_u 0.9502 (0.9824) acc_u 6.2500 (1.8750) lr 3.9958e-04 eta 0:00:14
epoch [143/200] batch [10/39] time 0.517 (0.448) data 0.353 (0.289) loss_u loss_u 0.9692 (0.9725) acc_u 3.1250 (2.8125) lr 3.9958e-04 eta 0:00:12
epoch [143/200] batch [15/39] time 0.476 (0.455) data 0.314 (0.295) loss_u loss_u 0.9609 (0.9706) acc_u 3.1250 (2.9167) lr 3.9958e-04 eta 0:00:10
epoch [143/200] batch [20/39] time 0.448 (0.454) data 0.289 (0.296) loss_u loss_u 0.9658 (0.9680) acc_u 3.1250 (3.4375) lr 3.9958e-04 eta 0:00:08
epoch [143/200] batch [25/39] time 0.496 (0.459) data 0.329 (0.300) loss_u loss_u 0.9995 (0.9708) acc_u 0.0000 (3.1250) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [30/39] time 0.470 (0.458) data 0.304 (0.301) loss_u loss_u 0.9995 (0.9729) acc_u 0.0000 (2.9167) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [35/39] time 0.456 (0.457) data 0.290 (0.298) loss_u loss_u 0.9375 (0.9733) acc_u 6.2500 (2.9464) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 456
confident_label rate tensor(0.2286, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 373
clean true:346
clean false:27
clean_rate:0.9276139410187667
noisy true:830
noisy false:429
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1259
epoch [144/200] batch [5/11] time 0.454 (0.423) data 0.290 (0.276) loss_x loss_x 0.1516 (0.2754) acc_x 96.8750 (93.1250) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/11] time 0.469 (0.453) data 0.304 (0.298) loss_x loss_x 0.2352 (0.2726) acc_x 96.8750 (94.0625) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/39] time 0.491 (0.465) data 0.321 (0.310) loss_u loss_u 0.9526 (0.9525) acc_u 6.2500 (5.6250) lr 3.8709e-04 eta 0:00:15
epoch [144/200] batch [10/39] time 0.496 (0.464) data 0.328 (0.306) loss_u loss_u 0.9521 (0.9583) acc_u 6.2500 (5.0000) lr 3.8709e-04 eta 0:00:13
epoch [144/200] batch [15/39] time 0.447 (0.468) data 0.281 (0.309) loss_u loss_u 0.9775 (0.9646) acc_u 3.1250 (4.1667) lr 3.8709e-04 eta 0:00:11
epoch [144/200] batch [20/39] time 0.413 (0.467) data 0.247 (0.309) loss_u loss_u 0.9761 (0.9692) acc_u 3.1250 (3.5938) lr 3.8709e-04 eta 0:00:08
epoch [144/200] batch [25/39] time 0.477 (0.462) data 0.313 (0.304) loss_u loss_u 0.9438 (0.9704) acc_u 6.2500 (3.3750) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [30/39] time 0.446 (0.460) data 0.279 (0.303) loss_u loss_u 0.9971 (0.9722) acc_u 0.0000 (3.2292) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [35/39] time 0.494 (0.462) data 0.330 (0.304) loss_u loss_u 0.9971 (0.9719) acc_u 0.0000 (3.3036) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 462
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:343
clean false:31
clean_rate:0.9171122994652406
noisy true:827
noisy false:431
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [145/200] batch [5/11] time 0.469 (0.424) data 0.305 (0.277) loss_x loss_x 0.4763 (0.3609) acc_x 81.2500 (91.2500) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/11] time 0.472 (0.460) data 0.308 (0.305) loss_x loss_x 0.2108 (0.3113) acc_x 90.6250 (92.1875) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/39] time 0.424 (0.462) data 0.259 (0.302) loss_u loss_u 0.9370 (0.9500) acc_u 6.2500 (5.6250) lr 3.7476e-04 eta 0:00:15
epoch [145/200] batch [10/39] time 0.473 (0.462) data 0.306 (0.301) loss_u loss_u 0.9951 (0.9670) acc_u 0.0000 (3.7500) lr 3.7476e-04 eta 0:00:13
epoch [145/200] batch [15/39] time 0.436 (0.464) data 0.274 (0.302) loss_u loss_u 0.9849 (0.9659) acc_u 0.0000 (3.7500) lr 3.7476e-04 eta 0:00:11
epoch [145/200] batch [20/39] time 0.489 (0.461) data 0.326 (0.301) loss_u loss_u 0.9995 (0.9709) acc_u 0.0000 (3.2812) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [25/39] time 0.467 (0.464) data 0.304 (0.303) loss_u loss_u 0.9780 (0.9720) acc_u 3.1250 (3.1250) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [30/39] time 0.449 (0.462) data 0.284 (0.303) loss_u loss_u 0.9805 (0.9691) acc_u 3.1250 (3.4375) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [35/39] time 0.420 (0.458) data 0.254 (0.297) loss_u loss_u 0.9985 (0.9710) acc_u 0.0000 (3.2143) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 473
confident_label rate tensor(0.2310, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 377
clean true:349
clean false:28
clean_rate:0.9257294429708223
noisy true:810
noisy false:445
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1255
epoch [146/200] batch [5/11] time 0.460 (0.432) data 0.296 (0.287) loss_x loss_x 0.8047 (0.4755) acc_x 87.5000 (90.6250) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/11] time 0.422 (0.439) data 0.258 (0.286) loss_x loss_x 0.2771 (0.3625) acc_x 93.7500 (92.8125) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/39] time 0.374 (0.434) data 0.230 (0.278) loss_u loss_u 0.9937 (0.9880) acc_u 0.0000 (1.2500) lr 3.6258e-04 eta 0:00:14
epoch [146/200] batch [10/39] time 0.513 (0.437) data 0.344 (0.280) loss_u loss_u 0.9658 (0.9797) acc_u 3.1250 (2.1875) lr 3.6258e-04 eta 0:00:12
epoch [146/200] batch [15/39] time 0.459 (0.450) data 0.291 (0.291) loss_u loss_u 0.9409 (0.9796) acc_u 6.2500 (2.2917) lr 3.6258e-04 eta 0:00:10
epoch [146/200] batch [20/39] time 0.486 (0.456) data 0.318 (0.299) loss_u loss_u 0.9990 (0.9787) acc_u 0.0000 (2.1875) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [25/39] time 0.484 (0.459) data 0.316 (0.301) loss_u loss_u 0.9937 (0.9776) acc_u 0.0000 (2.3750) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [30/39] time 0.605 (0.462) data 0.437 (0.305) loss_u loss_u 0.9409 (0.9752) acc_u 6.2500 (2.7083) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [35/39] time 0.421 (0.461) data 0.261 (0.303) loss_u loss_u 0.9990 (0.9755) acc_u 0.0000 (2.6786) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 478
confident_label rate tensor(0.2328, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 380
clean true:347
clean false:33
clean_rate:0.9131578947368421
noisy true:807
noisy false:445
after delete: len(clean_dataset) 380
after delete: len(noisy_dataset) 1252
epoch [147/200] batch [5/11] time 0.494 (0.436) data 0.333 (0.291) loss_x loss_x 0.1168 (0.2950) acc_x 100.0000 (93.7500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/11] time 0.454 (0.454) data 0.293 (0.301) loss_x loss_x 0.2605 (0.2841) acc_x 90.6250 (93.4375) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/39] time 0.444 (0.453) data 0.277 (0.299) loss_u loss_u 0.9961 (0.9688) acc_u 0.0000 (3.1250) lr 3.5055e-04 eta 0:00:15
epoch [147/200] batch [10/39] time 0.441 (0.450) data 0.273 (0.293) loss_u loss_u 0.9985 (0.9683) acc_u 0.0000 (3.4375) lr 3.5055e-04 eta 0:00:13
epoch [147/200] batch [15/39] time 0.466 (0.450) data 0.300 (0.291) loss_u loss_u 0.9941 (0.9729) acc_u 0.0000 (2.9167) lr 3.5055e-04 eta 0:00:10
epoch [147/200] batch [20/39] time 0.386 (0.440) data 0.223 (0.283) loss_u loss_u 1.0000 (0.9718) acc_u 0.0000 (2.9688) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [25/39] time 0.461 (0.439) data 0.298 (0.281) loss_u loss_u 0.9990 (0.9730) acc_u 0.0000 (2.8750) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [30/39] time 0.384 (0.440) data 0.305 (0.283) loss_u loss_u 0.9790 (0.9743) acc_u 3.1250 (2.8125) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [35/39] time 0.461 (0.443) data 0.293 (0.284) loss_u loss_u 0.9438 (0.9742) acc_u 6.2500 (2.8571) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 490
confident_label rate tensor(0.2286, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 373
clean true:343
clean false:30
clean_rate:0.9195710455764075
noisy true:799
noisy false:460
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1259
epoch [148/200] batch [5/11] time 0.396 (0.393) data 0.234 (0.246) loss_x loss_x 0.1787 (0.3286) acc_x 96.8750 (93.7500) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/11] time 0.469 (0.423) data 0.305 (0.269) loss_x loss_x 0.3289 (0.3880) acc_x 90.6250 (92.8125) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/39] time 0.457 (0.442) data 0.286 (0.288) loss_u loss_u 0.9731 (0.9794) acc_u 3.1250 (2.5000) lr 3.3869e-04 eta 0:00:15
epoch [148/200] batch [10/39] time 0.535 (0.461) data 0.373 (0.306) loss_u loss_u 0.9839 (0.9752) acc_u 3.1250 (2.8125) lr 3.3869e-04 eta 0:00:13
epoch [148/200] batch [15/39] time 0.372 (0.458) data 0.269 (0.304) loss_u loss_u 0.9707 (0.9727) acc_u 3.1250 (2.9167) lr 3.3869e-04 eta 0:00:10
epoch [148/200] batch [20/39] time 0.447 (0.461) data 0.277 (0.305) loss_u loss_u 0.9688 (0.9725) acc_u 3.1250 (2.9688) lr 3.3869e-04 eta 0:00:08
epoch [148/200] batch [25/39] time 0.425 (0.459) data 0.257 (0.301) loss_u loss_u 0.9541 (0.9718) acc_u 6.2500 (3.1250) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [30/39] time 0.519 (0.455) data 0.355 (0.298) loss_u loss_u 0.9570 (0.9744) acc_u 6.2500 (2.9167) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [35/39] time 0.473 (0.468) data 0.304 (0.311) loss_u loss_u 0.9712 (0.9740) acc_u 3.1250 (2.9464) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2384, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 389
clean true:354
clean false:35
clean_rate:0.910025706940874
noisy true:810
noisy false:433
after delete: len(clean_dataset) 389
after delete: len(noisy_dataset) 1243
epoch [149/200] batch [5/12] time 0.441 (0.433) data 0.279 (0.287) loss_x loss_x 0.3042 (0.3223) acc_x 90.6250 (93.1250) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/12] time 0.455 (0.442) data 0.293 (0.289) loss_x loss_x 0.1853 (0.2821) acc_x 96.8750 (94.3750) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/38] time 0.402 (0.429) data 0.224 (0.276) loss_u loss_u 0.9980 (0.9757) acc_u 0.0000 (2.5000) lr 3.2699e-04 eta 0:00:14
epoch [149/200] batch [10/38] time 0.447 (0.431) data 0.285 (0.276) loss_u loss_u 0.9683 (0.9704) acc_u 3.1250 (2.8125) lr 3.2699e-04 eta 0:00:12
epoch [149/200] batch [15/38] time 0.456 (0.435) data 0.292 (0.278) loss_u loss_u 0.9951 (0.9772) acc_u 0.0000 (2.0833) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [20/38] time 0.432 (0.437) data 0.268 (0.278) loss_u loss_u 0.9692 (0.9760) acc_u 3.1250 (2.3438) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [25/38] time 0.426 (0.440) data 0.263 (0.280) loss_u loss_u 0.9756 (0.9780) acc_u 3.1250 (2.1250) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [30/38] time 0.367 (0.439) data 0.268 (0.280) loss_u loss_u 0.9976 (0.9787) acc_u 0.0000 (2.0833) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [35/38] time 0.440 (0.437) data 0.273 (0.277) loss_u loss_u 0.9912 (0.9792) acc_u 0.0000 (1.9643) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 469
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 383
clean true:345
clean false:38
clean_rate:0.9007832898172323
noisy true:818
noisy false:431
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1249
epoch [150/200] batch [5/11] time 0.450 (0.449) data 0.286 (0.302) loss_x loss_x 0.3132 (0.3764) acc_x 87.5000 (91.2500) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/11] time 0.455 (0.465) data 0.289 (0.310) loss_x loss_x 0.1499 (0.3128) acc_x 100.0000 (93.1250) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/39] time 0.429 (0.462) data 0.264 (0.308) loss_u loss_u 0.9497 (0.9817) acc_u 6.2500 (1.8750) lr 3.1545e-04 eta 0:00:15
epoch [150/200] batch [10/39] time 0.435 (0.459) data 0.276 (0.302) loss_u loss_u 0.9199 (0.9686) acc_u 9.3750 (3.4375) lr 3.1545e-04 eta 0:00:13
epoch [150/200] batch [15/39] time 0.465 (0.456) data 0.294 (0.298) loss_u loss_u 0.9961 (0.9692) acc_u 0.0000 (3.3333) lr 3.1545e-04 eta 0:00:10
epoch [150/200] batch [20/39] time 0.404 (0.451) data 0.242 (0.292) loss_u loss_u 0.9863 (0.9727) acc_u 3.1250 (3.1250) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [25/39] time 0.425 (0.449) data 0.264 (0.289) loss_u loss_u 0.9951 (0.9724) acc_u 0.0000 (3.1250) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [30/39] time 0.470 (0.447) data 0.299 (0.287) loss_u loss_u 0.9697 (0.9701) acc_u 3.1250 (3.4375) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [35/39] time 0.446 (0.445) data 0.280 (0.284) loss_u loss_u 0.9932 (0.9731) acc_u 3.1250 (3.1250) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 472
confident_label rate tensor(0.2298, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 375
clean true:345
clean false:30
clean_rate:0.92
noisy true:815
noisy false:442
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1257
epoch [151/200] batch [5/11] time 0.398 (0.415) data 0.234 (0.265) loss_x loss_x 0.1309 (0.2810) acc_x 100.0000 (93.7500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/11] time 0.447 (0.417) data 0.283 (0.260) loss_x loss_x 0.4050 (0.3277) acc_x 90.6250 (92.5000) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/39] time 0.433 (0.441) data 0.331 (0.284) loss_u loss_u 0.8940 (0.9492) acc_u 15.6250 (6.2500) lr 3.0409e-04 eta 0:00:15
epoch [151/200] batch [10/39] time 0.455 (0.450) data 0.286 (0.290) loss_u loss_u 0.9995 (0.9673) acc_u 0.0000 (4.0625) lr 3.0409e-04 eta 0:00:13
epoch [151/200] batch [15/39] time 0.475 (0.455) data 0.313 (0.294) loss_u loss_u 0.9766 (0.9669) acc_u 3.1250 (3.9583) lr 3.0409e-04 eta 0:00:10
epoch [151/200] batch [20/39] time 0.483 (0.455) data 0.317 (0.296) loss_u loss_u 0.9995 (0.9667) acc_u 0.0000 (3.9062) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [25/39] time 0.519 (0.458) data 0.357 (0.298) loss_u loss_u 0.9844 (0.9653) acc_u 3.1250 (4.0000) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [30/39] time 0.429 (0.456) data 0.259 (0.296) loss_u loss_u 0.9556 (0.9686) acc_u 6.2500 (3.6458) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [35/39] time 0.428 (0.452) data 0.266 (0.291) loss_u loss_u 0.9995 (0.9705) acc_u 0.0000 (3.3929) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 478
confident_label rate tensor(0.2255, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 368
clean true:342
clean false:26
clean_rate:0.9293478260869565
noisy true:812
noisy false:452
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1264
epoch [152/200] batch [5/11] time 0.497 (0.482) data 0.332 (0.334) loss_x loss_x 0.2993 (0.2985) acc_x 96.8750 (95.0000) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/11] time 0.490 (0.481) data 0.325 (0.324) loss_x loss_x 0.2350 (0.3438) acc_x 93.7500 (93.7500) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/39] time 0.485 (0.482) data 0.322 (0.327) loss_u loss_u 0.9468 (0.9761) acc_u 6.2500 (3.1250) lr 2.9289e-04 eta 0:00:16
epoch [152/200] batch [10/39] time 0.434 (0.471) data 0.264 (0.313) loss_u loss_u 0.9814 (0.9718) acc_u 3.1250 (3.4375) lr 2.9289e-04 eta 0:00:13
epoch [152/200] batch [15/39] time 0.342 (0.464) data 0.262 (0.308) loss_u loss_u 0.9683 (0.9673) acc_u 3.1250 (3.7500) lr 2.9289e-04 eta 0:00:11
epoch [152/200] batch [20/39] time 0.508 (0.464) data 0.343 (0.305) loss_u loss_u 0.9795 (0.9674) acc_u 3.1250 (3.7500) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [25/39] time 0.503 (0.469) data 0.343 (0.309) loss_u loss_u 0.9111 (0.9644) acc_u 9.3750 (4.2500) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [30/39] time 0.380 (0.461) data 0.222 (0.302) loss_u loss_u 0.9727 (0.9649) acc_u 3.1250 (4.1667) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [35/39] time 0.382 (0.452) data 0.219 (0.293) loss_u loss_u 0.9688 (0.9657) acc_u 3.1250 (4.0179) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 467
confident_label rate tensor(0.2328, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 380
clean true:349
clean false:31
clean_rate:0.9184210526315789
noisy true:816
noisy false:436
after delete: len(clean_dataset) 380
after delete: len(noisy_dataset) 1252
epoch [153/200] batch [5/11] time 0.385 (0.453) data 0.224 (0.309) loss_x loss_x 0.2654 (0.2696) acc_x 90.6250 (92.5000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/11] time 0.512 (0.436) data 0.353 (0.284) loss_x loss_x 0.2032 (0.2793) acc_x 100.0000 (93.1250) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/39] time 0.398 (0.452) data 0.320 (0.302) loss_u loss_u 0.9688 (0.9824) acc_u 3.1250 (1.8750) lr 2.8187e-04 eta 0:00:15
epoch [153/200] batch [10/39] time 0.489 (0.467) data 0.321 (0.312) loss_u loss_u 0.9780 (0.9765) acc_u 3.1250 (2.8125) lr 2.8187e-04 eta 0:00:13
epoch [153/200] batch [15/39] time 0.418 (0.467) data 0.248 (0.310) loss_u loss_u 0.9746 (0.9763) acc_u 3.1250 (2.9167) lr 2.8187e-04 eta 0:00:11
epoch [153/200] batch [20/39] time 0.512 (0.465) data 0.344 (0.309) loss_u loss_u 0.9351 (0.9739) acc_u 6.2500 (2.9688) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [25/39] time 0.461 (0.467) data 0.302 (0.310) loss_u loss_u 0.9893 (0.9760) acc_u 3.1250 (2.7500) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [30/39] time 0.424 (0.467) data 0.263 (0.310) loss_u loss_u 0.9634 (0.9737) acc_u 6.2500 (3.0208) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [35/39] time 0.419 (0.462) data 0.250 (0.304) loss_u loss_u 0.9932 (0.9750) acc_u 0.0000 (2.8571) lr 2.8187e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 460
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 384
clean true:351
clean false:33
clean_rate:0.9140625
noisy true:821
noisy false:427
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1248
epoch [154/200] batch [5/12] time 0.468 (0.438) data 0.309 (0.290) loss_x loss_x 0.1104 (0.3985) acc_x 100.0000 (91.8750) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/12] time 0.396 (0.424) data 0.238 (0.270) loss_x loss_x 0.6904 (0.4477) acc_x 87.5000 (90.3125) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/39] time 0.388 (0.419) data 0.229 (0.262) loss_u loss_u 0.9990 (0.9921) acc_u 0.0000 (0.6250) lr 2.7103e-04 eta 0:00:14
epoch [154/200] batch [10/39] time 0.446 (0.424) data 0.281 (0.267) loss_u loss_u 0.9771 (0.9900) acc_u 3.1250 (0.9375) lr 2.7103e-04 eta 0:00:12
epoch [154/200] batch [15/39] time 0.455 (0.427) data 0.286 (0.267) loss_u loss_u 0.9648 (0.9840) acc_u 3.1250 (1.6667) lr 2.7103e-04 eta 0:00:10
epoch [154/200] batch [20/39] time 0.436 (0.426) data 0.272 (0.269) loss_u loss_u 0.9976 (0.9824) acc_u 0.0000 (1.8750) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [25/39] time 0.446 (0.430) data 0.276 (0.271) loss_u loss_u 0.9429 (0.9810) acc_u 9.3750 (2.1250) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [30/39] time 0.445 (0.430) data 0.271 (0.272) loss_u loss_u 0.9673 (0.9801) acc_u 3.1250 (2.1875) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [35/39] time 0.419 (0.430) data 0.252 (0.271) loss_u loss_u 0.9448 (0.9791) acc_u 6.2500 (2.3214) lr 2.7103e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 450
confident_label rate tensor(0.2322, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 379
clean true:351
clean false:28
clean_rate:0.9261213720316622
noisy true:831
noisy false:422
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1253
epoch [155/200] batch [5/11] time 0.466 (0.448) data 0.304 (0.285) loss_x loss_x 0.3503 (0.2446) acc_x 93.7500 (96.2500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/11] time 0.444 (0.439) data 0.281 (0.286) loss_x loss_x 0.3005 (0.3099) acc_x 93.7500 (93.7500) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/39] time 0.472 (0.448) data 0.307 (0.290) loss_u loss_u 0.9844 (0.9665) acc_u 3.1250 (3.7500) lr 2.6037e-04 eta 0:00:15
epoch [155/200] batch [10/39] time 0.440 (0.448) data 0.273 (0.292) loss_u loss_u 0.9683 (0.9699) acc_u 3.1250 (3.7500) lr 2.6037e-04 eta 0:00:13
epoch [155/200] batch [15/39] time 0.454 (0.450) data 0.288 (0.291) loss_u loss_u 0.9976 (0.9732) acc_u 0.0000 (3.3333) lr 2.6037e-04 eta 0:00:10
epoch [155/200] batch [20/39] time 0.369 (0.444) data 0.291 (0.287) loss_u loss_u 0.9087 (0.9716) acc_u 9.3750 (3.5938) lr 2.6037e-04 eta 0:00:08
epoch [155/200] batch [25/39] time 0.432 (0.439) data 0.267 (0.282) loss_u loss_u 0.9424 (0.9730) acc_u 6.2500 (3.2500) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [30/39] time 0.438 (0.441) data 0.270 (0.282) loss_u loss_u 0.9751 (0.9740) acc_u 3.1250 (3.2292) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [35/39] time 0.439 (0.440) data 0.269 (0.281) loss_u loss_u 0.9736 (0.9745) acc_u 3.1250 (3.1250) lr 2.6037e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 467
confident_label rate tensor(0.2261, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 369
clean true:341
clean false:28
clean_rate:0.924119241192412
noisy true:824
noisy false:439
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1263
epoch [156/200] batch [5/11] time 0.431 (0.409) data 0.266 (0.262) loss_x loss_x 0.2942 (0.3104) acc_x 90.6250 (94.3750) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/11] time 0.452 (0.416) data 0.286 (0.261) loss_x loss_x 0.2561 (0.2776) acc_x 93.7500 (95.0000) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/39] time 0.348 (0.425) data 0.269 (0.271) loss_u loss_u 0.9980 (0.9888) acc_u 0.0000 (1.8750) lr 2.4989e-04 eta 0:00:14
epoch [156/200] batch [10/39] time 0.467 (0.430) data 0.304 (0.274) loss_u loss_u 0.9629 (0.9806) acc_u 3.1250 (2.5000) lr 2.4989e-04 eta 0:00:12
epoch [156/200] batch [15/39] time 0.462 (0.435) data 0.296 (0.278) loss_u loss_u 0.9702 (0.9769) acc_u 3.1250 (2.7083) lr 2.4989e-04 eta 0:00:10
epoch [156/200] batch [20/39] time 0.440 (0.435) data 0.278 (0.279) loss_u loss_u 0.9746 (0.9772) acc_u 3.1250 (2.5000) lr 2.4989e-04 eta 0:00:08
epoch [156/200] batch [25/39] time 0.458 (0.439) data 0.289 (0.281) loss_u loss_u 0.9990 (0.9787) acc_u 0.0000 (2.2500) lr 2.4989e-04 eta 0:00:06
epoch [156/200] batch [30/39] time 0.457 (0.441) data 0.299 (0.284) loss_u loss_u 0.9634 (0.9790) acc_u 3.1250 (2.1875) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [35/39] time 0.443 (0.439) data 0.276 (0.283) loss_u loss_u 0.9375 (0.9760) acc_u 6.2500 (2.5893) lr 2.4989e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 482
confident_label rate tensor(0.2298, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 375
clean true:339
clean false:36
clean_rate:0.904
noisy true:811
noisy false:446
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1257
epoch [157/200] batch [5/11] time 0.451 (0.406) data 0.287 (0.258) loss_x loss_x 0.1646 (0.2260) acc_x 96.8750 (96.2500) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/11] time 0.465 (0.434) data 0.300 (0.278) loss_x loss_x 0.2512 (0.2998) acc_x 93.7500 (94.0625) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/39] time 0.401 (0.445) data 0.323 (0.291) loss_u loss_u 0.9526 (0.9662) acc_u 6.2500 (3.7500) lr 2.3959e-04 eta 0:00:15
epoch [157/200] batch [10/39] time 0.472 (0.452) data 0.305 (0.295) loss_u loss_u 0.9990 (0.9723) acc_u 0.0000 (3.1250) lr 2.3959e-04 eta 0:00:13
epoch [157/200] batch [15/39] time 0.406 (0.441) data 0.238 (0.283) loss_u loss_u 0.9463 (0.9729) acc_u 6.2500 (3.1250) lr 2.3959e-04 eta 0:00:10
epoch [157/200] batch [20/39] time 0.375 (0.432) data 0.295 (0.281) loss_u loss_u 0.9766 (0.9710) acc_u 3.1250 (3.2812) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [25/39] time 0.377 (0.428) data 0.299 (0.286) loss_u loss_u 0.9712 (0.9704) acc_u 3.1250 (3.3750) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [30/39] time 0.369 (0.424) data 0.290 (0.290) loss_u loss_u 0.9707 (0.9722) acc_u 3.1250 (3.1250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [35/39] time 0.346 (0.416) data 0.268 (0.289) loss_u loss_u 0.9414 (0.9709) acc_u 6.2500 (3.2143) lr 2.3959e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 476
confident_label rate tensor(0.2304, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 376
clean true:347
clean false:29
clean_rate:0.9228723404255319
noisy true:809
noisy false:447
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1256
epoch [158/200] batch [5/11] time 0.355 (0.353) data 0.278 (0.276) loss_x loss_x 0.4956 (0.2848) acc_x 84.3750 (93.1250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/11] time 0.347 (0.348) data 0.270 (0.270) loss_x loss_x 0.1584 (0.2972) acc_x 100.0000 (93.1250) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/39] time 0.349 (0.348) data 0.271 (0.270) loss_u loss_u 0.9727 (0.9931) acc_u 3.1250 (0.6250) lr 2.2949e-04 eta 0:00:11
epoch [158/200] batch [10/39] time 0.295 (0.338) data 0.216 (0.260) loss_u loss_u 0.9697 (0.9868) acc_u 3.1250 (1.2500) lr 2.2949e-04 eta 0:00:09
epoch [158/200] batch [15/39] time 0.375 (0.344) data 0.295 (0.265) loss_u loss_u 0.9980 (0.9810) acc_u 0.0000 (2.0833) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [20/39] time 0.349 (0.343) data 0.271 (0.265) loss_u loss_u 0.9697 (0.9783) acc_u 3.1250 (2.3438) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [25/39] time 0.331 (0.342) data 0.253 (0.264) loss_u loss_u 0.9214 (0.9773) acc_u 9.3750 (2.5000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [30/39] time 0.346 (0.341) data 0.268 (0.263) loss_u loss_u 0.9751 (0.9738) acc_u 3.1250 (2.9167) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [35/39] time 0.361 (0.343) data 0.281 (0.265) loss_u loss_u 0.9697 (0.9753) acc_u 3.1250 (2.6786) lr 2.2949e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 488
confident_label rate tensor(0.2316, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 378
clean true:344
clean false:34
clean_rate:0.91005291005291
noisy true:800
noisy false:454
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1254
epoch [159/200] batch [5/11] time 0.350 (0.344) data 0.273 (0.266) loss_x loss_x 0.2815 (0.3637) acc_x 90.6250 (91.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/11] time 0.346 (0.344) data 0.269 (0.266) loss_x loss_x 0.1881 (0.3080) acc_x 96.8750 (92.8125) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/39] time 0.349 (0.345) data 0.271 (0.267) loss_u loss_u 0.9717 (0.9740) acc_u 3.1250 (3.1250) lr 2.1957e-04 eta 0:00:11
epoch [159/200] batch [10/39] time 0.325 (0.338) data 0.246 (0.260) loss_u loss_u 0.9941 (0.9809) acc_u 0.0000 (1.8750) lr 2.1957e-04 eta 0:00:09
epoch [159/200] batch [15/39] time 0.347 (0.339) data 0.269 (0.261) loss_u loss_u 0.9717 (0.9782) acc_u 3.1250 (2.2917) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [20/39] time 0.343 (0.340) data 0.265 (0.262) loss_u loss_u 0.9922 (0.9813) acc_u 0.0000 (1.8750) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [25/39] time 0.344 (0.343) data 0.266 (0.265) loss_u loss_u 0.9985 (0.9808) acc_u 0.0000 (2.0000) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [30/39] time 0.343 (0.342) data 0.265 (0.264) loss_u loss_u 0.9854 (0.9745) acc_u 3.1250 (2.7083) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [35/39] time 0.339 (0.343) data 0.261 (0.265) loss_u loss_u 0.9634 (0.9721) acc_u 6.2500 (3.0357) lr 2.1957e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 467
confident_label rate tensor(0.2322, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 379
clean true:345
clean false:34
clean_rate:0.9102902374670184
noisy true:820
noisy false:433
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1253
epoch [160/200] batch [5/11] time 0.346 (0.352) data 0.268 (0.274) loss_x loss_x 0.4312 (0.3128) acc_x 93.7500 (95.6250) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [10/11] time 0.340 (0.346) data 0.262 (0.268) loss_x loss_x 0.4756 (0.3427) acc_x 90.6250 (94.3750) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/39] time 0.305 (0.339) data 0.226 (0.261) loss_u loss_u 0.9580 (0.9646) acc_u 3.1250 (3.1250) lr 2.0984e-04 eta 0:00:11
epoch [160/200] batch [10/39] time 0.362 (0.334) data 0.284 (0.255) loss_u loss_u 0.9854 (0.9667) acc_u 0.0000 (3.1250) lr 2.0984e-04 eta 0:00:09
epoch [160/200] batch [15/39] time 0.343 (0.341) data 0.266 (0.263) loss_u loss_u 0.9980 (0.9700) acc_u 0.0000 (2.9167) lr 2.0984e-04 eta 0:00:08
epoch [160/200] batch [20/39] time 0.364 (0.350) data 0.286 (0.272) loss_u loss_u 0.9995 (0.9673) acc_u 0.0000 (3.2812) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [25/39] time 0.366 (0.350) data 0.288 (0.271) loss_u loss_u 0.9712 (0.9681) acc_u 3.1250 (3.2500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [30/39] time 0.342 (0.349) data 0.263 (0.270) loss_u loss_u 0.9878 (0.9696) acc_u 0.0000 (3.0208) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [35/39] time 0.336 (0.348) data 0.257 (0.270) loss_u loss_u 0.9990 (0.9714) acc_u 0.0000 (2.8571) lr 2.0984e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 469
confident_label rate tensor(0.2328, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 380
clean true:348
clean false:32
clean_rate:0.9157894736842105
noisy true:815
noisy false:437
after delete: len(clean_dataset) 380
after delete: len(noisy_dataset) 1252
epoch [161/200] batch [5/11] time 0.348 (0.351) data 0.271 (0.273) loss_x loss_x 0.3145 (0.3383) acc_x 87.5000 (93.7500) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/11] time 0.345 (0.350) data 0.268 (0.272) loss_x loss_x 0.6582 (0.3500) acc_x 90.6250 (92.8125) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/39] time 0.324 (0.346) data 0.246 (0.268) loss_u loss_u 0.9819 (0.9809) acc_u 3.1250 (2.5000) lr 2.0032e-04 eta 0:00:11
epoch [161/200] batch [10/39] time 0.346 (0.339) data 0.268 (0.261) loss_u loss_u 0.9849 (0.9705) acc_u 0.0000 (3.4375) lr 2.0032e-04 eta 0:00:09
epoch [161/200] batch [15/39] time 0.350 (0.349) data 0.273 (0.271) loss_u loss_u 0.9941 (0.9675) acc_u 0.0000 (3.5417) lr 2.0032e-04 eta 0:00:08
epoch [161/200] batch [20/39] time 0.325 (0.347) data 0.247 (0.269) loss_u loss_u 0.9707 (0.9693) acc_u 3.1250 (3.4375) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [25/39] time 0.332 (0.346) data 0.254 (0.268) loss_u loss_u 0.9199 (0.9697) acc_u 9.3750 (3.3750) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [30/39] time 0.333 (0.346) data 0.255 (0.268) loss_u loss_u 0.9941 (0.9728) acc_u 0.0000 (3.0208) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [35/39] time 0.329 (0.346) data 0.250 (0.267) loss_u loss_u 0.9575 (0.9733) acc_u 6.2500 (2.9464) lr 2.0032e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 467
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 384
clean true:351
clean false:33
clean_rate:0.9140625
noisy true:814
noisy false:434
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1248
epoch [162/200] batch [5/12] time 0.353 (0.345) data 0.275 (0.268) loss_x loss_x 0.2468 (0.3768) acc_x 96.8750 (92.5000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/12] time 0.344 (0.346) data 0.266 (0.269) loss_x loss_x 0.6396 (0.3554) acc_x 90.6250 (93.4375) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/39] time 0.345 (0.340) data 0.267 (0.262) loss_u loss_u 0.9995 (0.9844) acc_u 0.0000 (1.8750) lr 1.9098e-04 eta 0:00:11
epoch [162/200] batch [10/39] time 0.331 (0.335) data 0.253 (0.257) loss_u loss_u 0.9995 (0.9793) acc_u 0.0000 (2.5000) lr 1.9098e-04 eta 0:00:09
epoch [162/200] batch [15/39] time 0.337 (0.335) data 0.259 (0.257) loss_u loss_u 0.9702 (0.9795) acc_u 3.1250 (2.2917) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [20/39] time 0.336 (0.337) data 0.258 (0.259) loss_u loss_u 0.9951 (0.9808) acc_u 0.0000 (2.1875) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [25/39] time 0.343 (0.337) data 0.264 (0.259) loss_u loss_u 0.9746 (0.9769) acc_u 3.1250 (2.5000) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [30/39] time 0.331 (0.336) data 0.253 (0.258) loss_u loss_u 0.9980 (0.9805) acc_u 0.0000 (2.0833) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [35/39] time 0.327 (0.336) data 0.249 (0.257) loss_u loss_u 0.9619 (0.9801) acc_u 3.1250 (2.1429) lr 1.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 484
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 383
clean true:349
clean false:34
clean_rate:0.9112271540469974
noisy true:799
noisy false:450
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1249
epoch [163/200] batch [5/11] time 0.345 (0.353) data 0.267 (0.274) loss_x loss_x 0.4512 (0.2807) acc_x 90.6250 (95.0000) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/11] time 0.367 (0.363) data 0.290 (0.284) loss_x loss_x 0.5688 (0.2903) acc_x 84.3750 (94.3750) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/39] time 0.334 (0.360) data 0.254 (0.281) loss_u loss_u 0.9741 (0.9936) acc_u 3.1250 (0.6250) lr 1.8185e-04 eta 0:00:12
epoch [163/200] batch [10/39] time 0.373 (0.362) data 0.295 (0.284) loss_u loss_u 0.9985 (0.9780) acc_u 0.0000 (2.1875) lr 1.8185e-04 eta 0:00:10
epoch [163/200] batch [15/39] time 0.347 (0.362) data 0.269 (0.284) loss_u loss_u 0.9990 (0.9804) acc_u 0.0000 (1.8750) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [20/39] time 0.391 (0.363) data 0.313 (0.284) loss_u loss_u 0.9619 (0.9805) acc_u 3.1250 (1.8750) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [25/39] time 0.366 (0.365) data 0.288 (0.286) loss_u loss_u 0.9922 (0.9768) acc_u 0.0000 (2.5000) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [30/39] time 0.373 (0.365) data 0.294 (0.286) loss_u loss_u 0.9658 (0.9754) acc_u 3.1250 (2.7083) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [35/39] time 0.363 (0.364) data 0.285 (0.285) loss_u loss_u 0.9985 (0.9777) acc_u 0.0000 (2.4107) lr 1.8185e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 464
confident_label rate tensor(0.2267, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 370
clean true:338
clean false:32
clean_rate:0.9135135135135135
noisy true:830
noisy false:432
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1262
epoch [164/200] batch [5/11] time 0.351 (0.344) data 0.274 (0.267) loss_x loss_x 0.2729 (0.2428) acc_x 96.8750 (96.8750) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [10/11] time 0.342 (0.347) data 0.264 (0.269) loss_x loss_x 0.2281 (0.2387) acc_x 93.7500 (95.6250) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/39] time 0.295 (0.337) data 0.216 (0.259) loss_u loss_u 0.9961 (0.9589) acc_u 0.0000 (5.0000) lr 1.7292e-04 eta 0:00:11
epoch [164/200] batch [10/39] time 0.350 (0.333) data 0.272 (0.255) loss_u loss_u 0.9443 (0.9624) acc_u 6.2500 (4.3750) lr 1.7292e-04 eta 0:00:09
epoch [164/200] batch [15/39] time 0.342 (0.335) data 0.264 (0.256) loss_u loss_u 0.9985 (0.9699) acc_u 0.0000 (3.3333) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [20/39] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9971 (0.9699) acc_u 0.0000 (3.2812) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [25/39] time 0.362 (0.338) data 0.284 (0.260) loss_u loss_u 0.9985 (0.9729) acc_u 0.0000 (3.0000) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [30/39] time 0.362 (0.339) data 0.284 (0.261) loss_u loss_u 0.9648 (0.9707) acc_u 3.1250 (3.2292) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [35/39] time 0.335 (0.339) data 0.257 (0.261) loss_u loss_u 0.9795 (0.9705) acc_u 3.1250 (3.3036) lr 1.7292e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2365, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 386
clean true:352
clean false:34
clean_rate:0.9119170984455959
noisy true:812
noisy false:434
after delete: len(clean_dataset) 386
after delete: len(noisy_dataset) 1246
epoch [165/200] batch [5/12] time 0.316 (0.354) data 0.237 (0.276) loss_x loss_x 0.2296 (0.2557) acc_x 96.8750 (94.3750) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/12] time 0.347 (0.355) data 0.268 (0.277) loss_x loss_x 0.4053 (0.3246) acc_x 87.5000 (91.8750) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/38] time 0.386 (0.355) data 0.306 (0.277) loss_u loss_u 0.9966 (0.9973) acc_u 0.0000 (0.0000) lr 1.6419e-04 eta 0:00:11
epoch [165/200] batch [10/38] time 0.361 (0.357) data 0.282 (0.278) loss_u loss_u 0.9902 (0.9831) acc_u 3.1250 (2.1875) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [15/38] time 0.367 (0.358) data 0.289 (0.279) loss_u loss_u 0.9995 (0.9850) acc_u 0.0000 (1.8750) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [20/38] time 0.377 (0.361) data 0.297 (0.282) loss_u loss_u 0.9575 (0.9797) acc_u 6.2500 (2.5000) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [25/38] time 0.361 (0.361) data 0.282 (0.282) loss_u loss_u 0.9688 (0.9789) acc_u 3.1250 (2.5000) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [30/38] time 0.316 (0.360) data 0.236 (0.281) loss_u loss_u 0.9937 (0.9775) acc_u 0.0000 (2.6042) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [35/38] time 0.377 (0.358) data 0.297 (0.279) loss_u loss_u 0.9805 (0.9782) acc_u 0.0000 (2.4107) lr 1.6419e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 466
confident_label rate tensor(0.2347, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 383
clean true:356
clean false:27
clean_rate:0.9295039164490861
noisy true:810
noisy false:439
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1249
epoch [166/200] batch [5/11] time 0.318 (0.322) data 0.241 (0.243) loss_x loss_x 0.1887 (0.2533) acc_x 100.0000 (95.6250) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/11] time 0.341 (0.331) data 0.264 (0.253) loss_x loss_x 0.2312 (0.2618) acc_x 96.8750 (94.3750) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/39] time 0.341 (0.334) data 0.263 (0.256) loss_u loss_u 0.9995 (0.9760) acc_u 0.0000 (2.5000) lr 1.5567e-04 eta 0:00:11
epoch [166/200] batch [10/39] time 0.346 (0.336) data 0.267 (0.258) loss_u loss_u 0.9902 (0.9783) acc_u 3.1250 (2.5000) lr 1.5567e-04 eta 0:00:09
epoch [166/200] batch [15/39] time 0.358 (0.339) data 0.281 (0.261) loss_u loss_u 0.9946 (0.9766) acc_u 0.0000 (2.5000) lr 1.5567e-04 eta 0:00:08
epoch [166/200] batch [20/39] time 0.346 (0.341) data 0.266 (0.262) loss_u loss_u 0.9902 (0.9774) acc_u 3.1250 (2.5000) lr 1.5567e-04 eta 0:00:06
epoch [166/200] batch [25/39] time 0.335 (0.340) data 0.255 (0.262) loss_u loss_u 0.9990 (0.9770) acc_u 0.0000 (2.6250) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [30/39] time 0.353 (0.343) data 0.275 (0.264) loss_u loss_u 0.9688 (0.9781) acc_u 3.1250 (2.3958) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [35/39] time 0.332 (0.343) data 0.254 (0.265) loss_u loss_u 0.9697 (0.9771) acc_u 3.1250 (2.5893) lr 1.5567e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 477
confident_label rate tensor(0.2341, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 382
clean true:348
clean false:34
clean_rate:0.9109947643979057
noisy true:807
noisy false:443
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1250
epoch [167/200] batch [5/11] time 0.360 (0.355) data 0.282 (0.277) loss_x loss_x 0.3696 (0.3835) acc_x 90.6250 (91.8750) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [10/11] time 0.350 (0.352) data 0.273 (0.274) loss_x loss_x 0.2375 (0.3170) acc_x 93.7500 (93.7500) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/39] time 0.342 (0.349) data 0.263 (0.271) loss_u loss_u 0.9858 (0.9802) acc_u 3.1250 (2.5000) lr 1.4736e-04 eta 0:00:11
epoch [167/200] batch [10/39] time 0.346 (0.347) data 0.268 (0.269) loss_u loss_u 0.9810 (0.9858) acc_u 3.1250 (1.8750) lr 1.4736e-04 eta 0:00:10
epoch [167/200] batch [15/39] time 0.345 (0.347) data 0.267 (0.269) loss_u loss_u 0.9927 (0.9832) acc_u 0.0000 (1.8750) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [20/39] time 0.358 (0.350) data 0.279 (0.272) loss_u loss_u 0.9834 (0.9856) acc_u 3.1250 (1.5625) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [25/39] time 0.356 (0.350) data 0.278 (0.272) loss_u loss_u 0.9966 (0.9812) acc_u 0.0000 (2.0000) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [30/39] time 0.347 (0.350) data 0.268 (0.272) loss_u loss_u 0.9849 (0.9811) acc_u 3.1250 (2.0833) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [35/39] time 0.349 (0.350) data 0.270 (0.272) loss_u loss_u 0.9946 (0.9790) acc_u 0.0000 (2.3214) lr 1.4736e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 459
confident_label rate tensor(0.2371, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 387
clean true:357
clean false:30
clean_rate:0.9224806201550387
noisy true:816
noisy false:429
after delete: len(clean_dataset) 387
after delete: len(noisy_dataset) 1245
epoch [168/200] batch [5/12] time 0.336 (0.346) data 0.258 (0.268) loss_x loss_x 0.6343 (0.4319) acc_x 93.7500 (91.8750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/12] time 0.336 (0.340) data 0.258 (0.262) loss_x loss_x 0.2639 (0.3801) acc_x 96.8750 (92.1875) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/38] time 0.361 (0.340) data 0.282 (0.262) loss_u loss_u 0.9897 (0.9711) acc_u 0.0000 (3.1250) lr 1.3926e-04 eta 0:00:11
epoch [168/200] batch [10/38] time 0.364 (0.343) data 0.285 (0.265) loss_u loss_u 0.9761 (0.9797) acc_u 3.1250 (2.1875) lr 1.3926e-04 eta 0:00:09
epoch [168/200] batch [15/38] time 0.321 (0.343) data 0.244 (0.265) loss_u loss_u 0.9507 (0.9714) acc_u 6.2500 (3.1250) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [20/38] time 0.329 (0.341) data 0.249 (0.263) loss_u loss_u 0.9971 (0.9737) acc_u 0.0000 (2.8125) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [25/38] time 0.351 (0.342) data 0.273 (0.263) loss_u loss_u 0.9985 (0.9756) acc_u 0.0000 (2.6250) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [30/38] time 0.341 (0.342) data 0.263 (0.263) loss_u loss_u 0.9868 (0.9772) acc_u 3.1250 (2.5000) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [35/38] time 0.339 (0.341) data 0.261 (0.263) loss_u loss_u 0.9985 (0.9787) acc_u 0.0000 (2.3214) lr 1.3926e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 483
confident_label rate tensor(0.2273, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 371
clean true:339
clean false:32
clean_rate:0.9137466307277629
noisy true:810
noisy false:451
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1261
epoch [169/200] batch [5/11] time 0.332 (0.347) data 0.255 (0.270) loss_x loss_x 0.4695 (0.3457) acc_x 84.3750 (91.2500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/11] time 0.335 (0.343) data 0.257 (0.265) loss_x loss_x 0.4006 (0.3781) acc_x 93.7500 (91.5625) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/39] time 0.334 (0.343) data 0.255 (0.265) loss_u loss_u 0.9707 (0.9724) acc_u 3.1250 (3.1250) lr 1.3137e-04 eta 0:00:11
epoch [169/200] batch [10/39] time 0.318 (0.339) data 0.240 (0.261) loss_u loss_u 0.9717 (0.9644) acc_u 3.1250 (3.7500) lr 1.3137e-04 eta 0:00:09
epoch [169/200] batch [15/39] time 0.319 (0.339) data 0.241 (0.261) loss_u loss_u 0.9658 (0.9644) acc_u 3.1250 (3.7500) lr 1.3137e-04 eta 0:00:08
epoch [169/200] batch [20/39] time 0.333 (0.338) data 0.255 (0.260) loss_u loss_u 0.9976 (0.9620) acc_u 0.0000 (4.0625) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [25/39] time 0.341 (0.338) data 0.264 (0.260) loss_u loss_u 0.9966 (0.9652) acc_u 0.0000 (3.6250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [30/39] time 0.344 (0.339) data 0.266 (0.261) loss_u loss_u 0.9595 (0.9685) acc_u 6.2500 (3.3333) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [35/39] time 0.333 (0.339) data 0.255 (0.261) loss_u loss_u 0.9995 (0.9689) acc_u 0.0000 (3.3036) lr 1.3137e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 471
confident_label rate tensor(0.2408, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 393
clean true:358
clean false:35
clean_rate:0.910941475826972
noisy true:803
noisy false:436
after delete: len(clean_dataset) 393
after delete: len(noisy_dataset) 1239
epoch [170/200] batch [5/12] time 0.309 (0.309) data 0.231 (0.230) loss_x loss_x 0.2542 (0.2584) acc_x 96.8750 (95.6250) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/12] time 0.343 (0.328) data 0.266 (0.250) loss_x loss_x 0.2423 (0.2951) acc_x 96.8750 (93.1250) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/38] time 0.342 (0.333) data 0.263 (0.255) loss_u loss_u 0.9990 (0.9829) acc_u 0.0000 (1.8750) lr 1.2369e-04 eta 0:00:10
epoch [170/200] batch [10/38] time 0.332 (0.333) data 0.254 (0.255) loss_u loss_u 0.9824 (0.9848) acc_u 3.1250 (1.8750) lr 1.2369e-04 eta 0:00:09
epoch [170/200] batch [15/38] time 0.343 (0.334) data 0.266 (0.256) loss_u loss_u 0.9995 (0.9839) acc_u 0.0000 (2.0833) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [20/38] time 0.351 (0.334) data 0.273 (0.256) loss_u loss_u 0.9688 (0.9850) acc_u 3.1250 (1.8750) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [25/38] time 0.345 (0.335) data 0.268 (0.257) loss_u loss_u 1.0000 (0.9833) acc_u 0.0000 (2.0000) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [30/38] time 0.337 (0.336) data 0.258 (0.258) loss_u loss_u 0.9819 (0.9817) acc_u 3.1250 (2.1875) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [35/38] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9990 (0.9822) acc_u 0.0000 (2.0536) lr 1.2369e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 479
confident_label rate tensor(0.2335, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 381
clean true:345
clean false:36
clean_rate:0.905511811023622
noisy true:808
noisy false:443
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1251
epoch [171/200] batch [5/11] time 0.305 (0.333) data 0.227 (0.254) loss_x loss_x 0.2537 (0.2914) acc_x 96.8750 (95.0000) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/11] time 0.335 (0.322) data 0.257 (0.243) loss_x loss_x 0.3088 (0.2702) acc_x 93.7500 (95.3125) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/39] time 0.338 (0.327) data 0.260 (0.249) loss_u loss_u 0.9673 (0.9877) acc_u 3.1250 (1.2500) lr 1.1623e-04 eta 0:00:11
epoch [171/200] batch [10/39] time 0.330 (0.330) data 0.252 (0.251) loss_u loss_u 0.9956 (0.9793) acc_u 0.0000 (2.1875) lr 1.1623e-04 eta 0:00:09
epoch [171/200] batch [15/39] time 0.346 (0.332) data 0.269 (0.254) loss_u loss_u 0.9722 (0.9741) acc_u 3.1250 (2.7083) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [20/39] time 0.349 (0.335) data 0.270 (0.257) loss_u loss_u 0.9692 (0.9707) acc_u 3.1250 (3.1250) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [25/39] time 0.349 (0.336) data 0.271 (0.258) loss_u loss_u 0.9678 (0.9702) acc_u 3.1250 (3.1250) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [30/39] time 0.350 (0.338) data 0.272 (0.260) loss_u loss_u 0.9795 (0.9721) acc_u 3.1250 (3.0208) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [35/39] time 0.350 (0.340) data 0.271 (0.261) loss_u loss_u 0.9785 (0.9718) acc_u 3.1250 (3.0357) lr 1.1623e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 481
confident_label rate tensor(0.2322, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 379
clean true:349
clean false:30
clean_rate:0.920844327176781
noisy true:802
noisy false:451
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1253
epoch [172/200] batch [5/11] time 0.384 (0.339) data 0.307 (0.261) loss_x loss_x 0.2964 (0.3387) acc_x 93.7500 (91.2500) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/11] time 0.351 (0.341) data 0.274 (0.263) loss_x loss_x 0.1996 (0.3076) acc_x 96.8750 (92.8125) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/39] time 0.340 (0.346) data 0.261 (0.267) loss_u loss_u 0.9639 (0.9765) acc_u 3.1250 (2.5000) lr 1.0899e-04 eta 0:00:11
epoch [172/200] batch [10/39] time 0.346 (0.347) data 0.268 (0.268) loss_u loss_u 0.9868 (0.9789) acc_u 3.1250 (2.5000) lr 1.0899e-04 eta 0:00:10
epoch [172/200] batch [15/39] time 0.365 (0.345) data 0.287 (0.267) loss_u loss_u 0.9990 (0.9797) acc_u 0.0000 (2.7083) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [20/39] time 0.347 (0.345) data 0.269 (0.267) loss_u loss_u 0.9990 (0.9828) acc_u 0.0000 (2.1875) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [25/39] time 0.352 (0.345) data 0.274 (0.267) loss_u loss_u 0.9795 (0.9806) acc_u 3.1250 (2.5000) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [30/39] time 0.338 (0.347) data 0.260 (0.269) loss_u loss_u 0.9702 (0.9785) acc_u 3.1250 (2.6042) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [35/39] time 0.352 (0.347) data 0.274 (0.269) loss_u loss_u 0.9980 (0.9780) acc_u 0.0000 (2.5893) lr 1.0899e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 461
confident_label rate tensor(0.2341, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 382
clean true:346
clean false:36
clean_rate:0.9057591623036649
noisy true:825
noisy false:425
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1250
epoch [173/200] batch [5/11] time 0.335 (0.343) data 0.258 (0.266) loss_x loss_x 0.5005 (0.3052) acc_x 84.3750 (92.5000) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/11] time 0.342 (0.340) data 0.264 (0.262) loss_x loss_x 0.1714 (0.2693) acc_x 96.8750 (94.3750) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/39] time 0.337 (0.340) data 0.258 (0.262) loss_u loss_u 0.9980 (0.9766) acc_u 0.0000 (2.5000) lr 1.0197e-04 eta 0:00:11
epoch [173/200] batch [10/39] time 0.344 (0.339) data 0.266 (0.261) loss_u loss_u 0.9980 (0.9785) acc_u 0.0000 (2.1875) lr 1.0197e-04 eta 0:00:09
epoch [173/200] batch [15/39] time 0.338 (0.341) data 0.260 (0.262) loss_u loss_u 0.9424 (0.9709) acc_u 6.2500 (2.9167) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [20/39] time 0.340 (0.341) data 0.261 (0.263) loss_u loss_u 0.9380 (0.9714) acc_u 9.3750 (2.9688) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [25/39] time 0.344 (0.341) data 0.265 (0.263) loss_u loss_u 0.9658 (0.9724) acc_u 3.1250 (2.7500) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [30/39] time 0.357 (0.342) data 0.278 (0.264) loss_u loss_u 0.9712 (0.9739) acc_u 3.1250 (2.6042) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [35/39] time 0.327 (0.343) data 0.249 (0.265) loss_u loss_u 0.9790 (0.9756) acc_u 3.1250 (2.5000) lr 1.0197e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 471
confident_label rate tensor(0.2292, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 374
clean true:342
clean false:32
clean_rate:0.9144385026737968
noisy true:819
noisy false:439
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1258
epoch [174/200] batch [5/11] time 0.336 (0.309) data 0.259 (0.230) loss_x loss_x 0.3311 (0.2559) acc_x 87.5000 (93.7500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/11] time 0.339 (0.322) data 0.261 (0.244) loss_x loss_x 0.1178 (0.2564) acc_x 100.0000 (94.0625) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/39] time 0.340 (0.330) data 0.262 (0.251) loss_u loss_u 0.9834 (0.9640) acc_u 3.1250 (3.7500) lr 9.5173e-05 eta 0:00:11
epoch [174/200] batch [10/39] time 0.347 (0.333) data 0.269 (0.255) loss_u loss_u 0.9678 (0.9589) acc_u 3.1250 (5.0000) lr 9.5173e-05 eta 0:00:09
epoch [174/200] batch [15/39] time 0.348 (0.334) data 0.271 (0.256) loss_u loss_u 0.9688 (0.9663) acc_u 3.1250 (3.9583) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [20/39] time 0.331 (0.332) data 0.253 (0.254) loss_u loss_u 0.9819 (0.9702) acc_u 3.1250 (3.5938) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [25/39] time 0.344 (0.332) data 0.266 (0.254) loss_u loss_u 0.9990 (0.9692) acc_u 0.0000 (3.6250) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [30/39] time 0.347 (0.333) data 0.269 (0.255) loss_u loss_u 0.9565 (0.9708) acc_u 3.1250 (3.3333) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [35/39] time 0.349 (0.334) data 0.270 (0.256) loss_u loss_u 0.9639 (0.9718) acc_u 6.2500 (3.2143) lr 9.5173e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 475
confident_label rate tensor(0.2304, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 376
clean true:342
clean false:34
clean_rate:0.9095744680851063
noisy true:815
noisy false:441
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1256
epoch [175/200] batch [5/11] time 0.300 (0.342) data 0.222 (0.264) loss_x loss_x 0.1115 (0.3422) acc_x 100.0000 (93.7500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/11] time 0.308 (0.323) data 0.230 (0.245) loss_x loss_x 0.1881 (0.2799) acc_x 96.8750 (95.3125) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/39] time 0.339 (0.329) data 0.260 (0.251) loss_u loss_u 0.9951 (0.9966) acc_u 0.0000 (0.0000) lr 8.8597e-05 eta 0:00:11
epoch [175/200] batch [10/39] time 0.348 (0.331) data 0.270 (0.253) loss_u loss_u 0.9697 (0.9721) acc_u 3.1250 (2.8125) lr 8.8597e-05 eta 0:00:09
epoch [175/200] batch [15/39] time 0.345 (0.333) data 0.268 (0.255) loss_u loss_u 0.9995 (0.9733) acc_u 0.0000 (2.9167) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [20/39] time 0.348 (0.335) data 0.271 (0.257) loss_u loss_u 0.9678 (0.9698) acc_u 3.1250 (3.2812) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [25/39] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9995 (0.9700) acc_u 0.0000 (3.3750) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [30/39] time 0.321 (0.337) data 0.242 (0.259) loss_u loss_u 0.9800 (0.9705) acc_u 3.1250 (3.3333) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [35/39] time 0.335 (0.337) data 0.256 (0.259) loss_u loss_u 0.9688 (0.9701) acc_u 3.1250 (3.3036) lr 8.8597e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 467
confident_label rate tensor(0.2298, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 375
clean true:342
clean false:33
clean_rate:0.912
noisy true:823
noisy false:434
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1257
epoch [176/200] batch [5/11] time 0.332 (0.341) data 0.254 (0.263) loss_x loss_x 0.5093 (0.3790) acc_x 87.5000 (90.0000) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/11] time 0.293 (0.326) data 0.215 (0.248) loss_x loss_x 0.2676 (0.2978) acc_x 93.7500 (94.0625) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/39] time 0.338 (0.331) data 0.260 (0.253) loss_u loss_u 0.9790 (0.9605) acc_u 3.1250 (5.0000) lr 8.2245e-05 eta 0:00:11
epoch [176/200] batch [10/39] time 0.362 (0.336) data 0.283 (0.258) loss_u loss_u 0.9995 (0.9704) acc_u 0.0000 (3.7500) lr 8.2245e-05 eta 0:00:09
epoch [176/200] batch [15/39] time 0.374 (0.339) data 0.296 (0.261) loss_u loss_u 0.9683 (0.9672) acc_u 3.1250 (3.9583) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [20/39] time 0.343 (0.340) data 0.265 (0.262) loss_u loss_u 0.9751 (0.9660) acc_u 3.1250 (4.0625) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [25/39] time 0.346 (0.341) data 0.268 (0.263) loss_u loss_u 0.9995 (0.9673) acc_u 0.0000 (3.8750) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [30/39] time 0.348 (0.342) data 0.270 (0.264) loss_u loss_u 0.9712 (0.9690) acc_u 3.1250 (3.6458) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [35/39] time 0.357 (0.343) data 0.278 (0.265) loss_u loss_u 0.9956 (0.9700) acc_u 0.0000 (3.5714) lr 8.2245e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 444
confident_label rate tensor(0.2414, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 394
clean true:357
clean false:37
clean_rate:0.9060913705583756
noisy true:831
noisy false:407
after delete: len(clean_dataset) 394
after delete: len(noisy_dataset) 1238
epoch [177/200] batch [5/12] time 0.347 (0.349) data 0.270 (0.271) loss_x loss_x 0.2400 (0.2621) acc_x 96.8750 (93.7500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/12] time 0.303 (0.336) data 0.225 (0.258) loss_x loss_x 0.4636 (0.3378) acc_x 87.5000 (92.5000) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/38] time 0.340 (0.334) data 0.261 (0.256) loss_u loss_u 0.9624 (0.9771) acc_u 3.1250 (2.5000) lr 7.6120e-05 eta 0:00:11
epoch [177/200] batch [10/38] time 0.299 (0.332) data 0.221 (0.254) loss_u loss_u 0.9634 (0.9833) acc_u 3.1250 (1.5625) lr 7.6120e-05 eta 0:00:09
epoch [177/200] batch [15/38] time 0.347 (0.331) data 0.269 (0.252) loss_u loss_u 0.9990 (0.9839) acc_u 0.0000 (1.6667) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [20/38] time 0.343 (0.333) data 0.265 (0.255) loss_u loss_u 0.9683 (0.9822) acc_u 3.1250 (1.8750) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [25/38] time 0.338 (0.333) data 0.260 (0.255) loss_u loss_u 1.0000 (0.9780) acc_u 0.0000 (2.3750) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [30/38] time 0.330 (0.334) data 0.252 (0.256) loss_u loss_u 0.9990 (0.9794) acc_u 0.0000 (2.1875) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [35/38] time 0.343 (0.335) data 0.265 (0.257) loss_u loss_u 0.9761 (0.9791) acc_u 3.1250 (2.2321) lr 7.6120e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 483
confident_label rate tensor(0.2316, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 378
clean true:345
clean false:33
clean_rate:0.9126984126984127
noisy true:804
noisy false:450
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1254
epoch [178/200] batch [5/11] time 0.333 (0.339) data 0.256 (0.261) loss_x loss_x 0.4487 (0.3795) acc_x 87.5000 (90.6250) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/11] time 0.321 (0.338) data 0.244 (0.261) loss_x loss_x 0.3862 (0.3056) acc_x 93.7500 (93.1250) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/39] time 0.313 (0.348) data 0.234 (0.270) loss_u loss_u 0.9756 (0.9820) acc_u 3.1250 (2.5000) lr 7.0224e-05 eta 0:00:11
epoch [178/200] batch [10/39] time 0.348 (0.345) data 0.271 (0.266) loss_u loss_u 0.9390 (0.9736) acc_u 6.2500 (2.8125) lr 7.0224e-05 eta 0:00:09
epoch [178/200] batch [15/39] time 0.338 (0.344) data 0.260 (0.265) loss_u loss_u 0.9541 (0.9770) acc_u 6.2500 (2.5000) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [20/39] time 0.343 (0.342) data 0.265 (0.264) loss_u loss_u 0.9995 (0.9779) acc_u 0.0000 (2.3438) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [25/39] time 0.341 (0.342) data 0.263 (0.264) loss_u loss_u 0.9736 (0.9762) acc_u 3.1250 (2.6250) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [30/39] time 0.346 (0.342) data 0.268 (0.263) loss_u loss_u 0.9399 (0.9746) acc_u 6.2500 (2.8125) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [35/39] time 0.355 (0.343) data 0.276 (0.265) loss_u loss_u 0.9829 (0.9736) acc_u 0.0000 (2.8571) lr 7.0224e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 483
confident_label rate tensor(0.2316, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 378
clean true:344
clean false:34
clean_rate:0.91005291005291
noisy true:805
noisy false:449
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1254
epoch [179/200] batch [5/11] time 0.347 (0.346) data 0.268 (0.268) loss_x loss_x 0.1974 (0.2247) acc_x 96.8750 (94.3750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/11] time 0.402 (0.366) data 0.325 (0.289) loss_x loss_x 0.1686 (0.2469) acc_x 96.8750 (94.0625) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/39] time 0.363 (0.364) data 0.284 (0.286) loss_u loss_u 0.9712 (0.9746) acc_u 3.1250 (3.1250) lr 6.4556e-05 eta 0:00:12
epoch [179/200] batch [10/39] time 0.337 (0.354) data 0.259 (0.276) loss_u loss_u 0.9409 (0.9644) acc_u 6.2500 (4.0625) lr 6.4556e-05 eta 0:00:10
epoch [179/200] batch [15/39] time 0.345 (0.350) data 0.267 (0.272) loss_u loss_u 0.9688 (0.9676) acc_u 3.1250 (3.5417) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [20/39] time 0.360 (0.350) data 0.281 (0.272) loss_u loss_u 0.9692 (0.9672) acc_u 3.1250 (3.5938) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [25/39] time 0.346 (0.349) data 0.268 (0.271) loss_u loss_u 0.9692 (0.9669) acc_u 3.1250 (3.6250) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [30/39] time 0.332 (0.347) data 0.254 (0.269) loss_u loss_u 0.9995 (0.9694) acc_u 0.0000 (3.3333) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [35/39] time 0.344 (0.347) data 0.267 (0.269) loss_u loss_u 0.9980 (0.9696) acc_u 0.0000 (3.3929) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 482
confident_label rate tensor(0.2365, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 386
clean true:348
clean false:38
clean_rate:0.9015544041450777
noisy true:802
noisy false:444
after delete: len(clean_dataset) 386
after delete: len(noisy_dataset) 1246
epoch [180/200] batch [5/12] time 0.352 (0.347) data 0.275 (0.269) loss_x loss_x 0.2991 (0.3103) acc_x 93.7500 (93.7500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/12] time 0.348 (0.348) data 0.269 (0.270) loss_x loss_x 0.4504 (0.3443) acc_x 87.5000 (93.7500) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/38] time 0.320 (0.337) data 0.242 (0.259) loss_u loss_u 0.9980 (0.9745) acc_u 0.0000 (2.5000) lr 5.9119e-05 eta 0:00:11
epoch [180/200] batch [10/38] time 0.351 (0.339) data 0.273 (0.261) loss_u loss_u 0.9561 (0.9766) acc_u 6.2500 (2.8125) lr 5.9119e-05 eta 0:00:09
epoch [180/200] batch [15/38] time 0.334 (0.339) data 0.257 (0.261) loss_u loss_u 0.9702 (0.9771) acc_u 3.1250 (2.7083) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [20/38] time 0.341 (0.340) data 0.262 (0.262) loss_u loss_u 0.9893 (0.9785) acc_u 0.0000 (2.5000) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [25/38] time 0.370 (0.341) data 0.292 (0.263) loss_u loss_u 0.9697 (0.9779) acc_u 3.1250 (2.5000) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [30/38] time 0.316 (0.340) data 0.237 (0.262) loss_u loss_u 0.9849 (0.9778) acc_u 3.1250 (2.5000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [35/38] time 0.455 (0.341) data 0.375 (0.262) loss_u loss_u 1.0000 (0.9787) acc_u 0.0000 (2.4107) lr 5.9119e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 489
confident_label rate tensor(0.2365, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 386
clean true:354
clean false:32
clean_rate:0.917098445595855
noisy true:789
noisy false:457
after delete: len(clean_dataset) 386
after delete: len(noisy_dataset) 1246
epoch [181/200] batch [5/12] time 0.333 (0.355) data 0.255 (0.277) loss_x loss_x 0.2279 (0.3044) acc_x 96.8750 (92.5000) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/12] time 0.315 (0.331) data 0.236 (0.253) loss_x loss_x 0.3611 (0.2945) acc_x 90.6250 (92.8125) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/38] time 0.346 (0.334) data 0.269 (0.256) loss_u loss_u 0.9189 (0.9743) acc_u 9.3750 (3.1250) lr 5.3915e-05 eta 0:00:11
epoch [181/200] batch [10/38] time 0.356 (0.337) data 0.278 (0.259) loss_u loss_u 0.9639 (0.9701) acc_u 3.1250 (3.4375) lr 5.3915e-05 eta 0:00:09
epoch [181/200] batch [15/38] time 0.348 (0.340) data 0.270 (0.262) loss_u loss_u 0.9458 (0.9710) acc_u 6.2500 (3.3333) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [20/38] time 0.334 (0.341) data 0.256 (0.262) loss_u loss_u 0.9971 (0.9763) acc_u 0.0000 (2.6562) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [25/38] time 0.303 (0.340) data 0.225 (0.262) loss_u loss_u 0.9692 (0.9762) acc_u 3.1250 (2.6250) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [30/38] time 0.317 (0.338) data 0.239 (0.260) loss_u loss_u 0.9746 (0.9778) acc_u 3.1250 (2.5000) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [35/38] time 0.347 (0.338) data 0.269 (0.260) loss_u loss_u 0.9990 (0.9782) acc_u 0.0000 (2.4107) lr 5.3915e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 480
confident_label rate tensor(0.2359, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 385
clean true:353
clean false:32
clean_rate:0.9168831168831169
noisy true:799
noisy false:448
after delete: len(clean_dataset) 385
after delete: len(noisy_dataset) 1247
epoch [182/200] batch [5/12] time 0.373 (0.349) data 0.295 (0.271) loss_x loss_x 0.3547 (0.3403) acc_x 87.5000 (91.2500) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/12] time 0.360 (0.353) data 0.283 (0.275) loss_x loss_x 0.4302 (0.3638) acc_x 90.6250 (91.5625) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/38] time 0.338 (0.351) data 0.260 (0.273) loss_u loss_u 0.9126 (0.9681) acc_u 12.5000 (4.3750) lr 4.8943e-05 eta 0:00:11
epoch [182/200] batch [10/38] time 0.351 (0.350) data 0.273 (0.272) loss_u loss_u 0.9971 (0.9780) acc_u 0.0000 (2.8125) lr 4.8943e-05 eta 0:00:09
epoch [182/200] batch [15/38] time 0.334 (0.352) data 0.256 (0.273) loss_u loss_u 0.9995 (0.9772) acc_u 0.0000 (2.7083) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [20/38] time 0.353 (0.352) data 0.275 (0.273) loss_u loss_u 0.9995 (0.9785) acc_u 0.0000 (2.6562) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [25/38] time 0.351 (0.352) data 0.272 (0.274) loss_u loss_u 0.9990 (0.9801) acc_u 0.0000 (2.3750) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [30/38] time 0.325 (0.350) data 0.247 (0.272) loss_u loss_u 0.9888 (0.9808) acc_u 3.1250 (2.2917) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [35/38] time 0.326 (0.349) data 0.248 (0.270) loss_u loss_u 0.9639 (0.9788) acc_u 3.1250 (2.4107) lr 4.8943e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 477
confident_label rate tensor(0.2335, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 381
clean true:353
clean false:28
clean_rate:0.926509186351706
noisy true:802
noisy false:449
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1251
epoch [183/200] batch [5/11] time 0.358 (0.339) data 0.281 (0.261) loss_x loss_x 0.1963 (0.1861) acc_x 96.8750 (97.5000) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/11] time 0.339 (0.340) data 0.261 (0.262) loss_x loss_x 0.2048 (0.2900) acc_x 96.8750 (95.9375) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/39] time 0.337 (0.342) data 0.258 (0.263) loss_u loss_u 0.9668 (0.9632) acc_u 3.1250 (4.3750) lr 4.4207e-05 eta 0:00:11
epoch [183/200] batch [10/39] time 0.337 (0.341) data 0.259 (0.262) loss_u loss_u 0.9995 (0.9677) acc_u 0.0000 (3.7500) lr 4.4207e-05 eta 0:00:09
epoch [183/200] batch [15/39] time 0.346 (0.342) data 0.268 (0.264) loss_u loss_u 0.9844 (0.9670) acc_u 3.1250 (3.9583) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [20/39] time 0.319 (0.341) data 0.241 (0.262) loss_u loss_u 0.9658 (0.9672) acc_u 3.1250 (3.9062) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [25/39] time 0.358 (0.342) data 0.280 (0.264) loss_u loss_u 0.9722 (0.9688) acc_u 3.1250 (3.6250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [30/39] time 0.337 (0.343) data 0.259 (0.265) loss_u loss_u 0.9829 (0.9699) acc_u 3.1250 (3.4375) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [35/39] time 0.335 (0.342) data 0.258 (0.264) loss_u loss_u 0.9990 (0.9719) acc_u 0.0000 (3.2143) lr 4.4207e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 474
confident_label rate tensor(0.2335, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 381
clean true:346
clean false:35
clean_rate:0.9081364829396326
noisy true:812
noisy false:439
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1251
epoch [184/200] batch [5/11] time 0.346 (0.337) data 0.268 (0.259) loss_x loss_x 0.2615 (0.2725) acc_x 96.8750 (95.0000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/11] time 0.341 (0.340) data 0.263 (0.263) loss_x loss_x 0.1205 (0.2441) acc_x 96.8750 (96.5625) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/39] time 0.312 (0.340) data 0.235 (0.262) loss_u loss_u 0.9595 (0.9848) acc_u 6.2500 (1.8750) lr 3.9706e-05 eta 0:00:11
epoch [184/200] batch [10/39] time 0.297 (0.329) data 0.218 (0.251) loss_u loss_u 0.9380 (0.9828) acc_u 9.3750 (2.1875) lr 3.9706e-05 eta 0:00:09
epoch [184/200] batch [15/39] time 0.297 (0.323) data 0.220 (0.246) loss_u loss_u 0.9482 (0.9831) acc_u 6.2500 (2.0833) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [20/39] time 0.306 (0.321) data 0.228 (0.244) loss_u loss_u 0.9697 (0.9790) acc_u 3.1250 (2.5000) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [25/39] time 0.300 (0.319) data 0.223 (0.241) loss_u loss_u 0.9683 (0.9788) acc_u 3.1250 (2.5000) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [30/39] time 0.297 (0.317) data 0.220 (0.239) loss_u loss_u 0.9751 (0.9774) acc_u 3.1250 (2.6042) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [35/39] time 0.307 (0.316) data 0.229 (0.239) loss_u loss_u 0.9966 (0.9762) acc_u 0.0000 (2.6786) lr 3.9706e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2335, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 381
clean true:345
clean false:36
clean_rate:0.905511811023622
noisy true:819
noisy false:432
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1251
epoch [185/200] batch [5/11] time 0.335 (0.344) data 0.257 (0.266) loss_x loss_x 0.3645 (0.4436) acc_x 90.6250 (93.1250) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [10/11] time 0.328 (0.336) data 0.251 (0.258) loss_x loss_x 0.3440 (0.4659) acc_x 90.6250 (90.9375) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/39] time 0.331 (0.335) data 0.252 (0.257) loss_u loss_u 0.9526 (0.9698) acc_u 6.2500 (3.1250) lr 3.5443e-05 eta 0:00:11
epoch [185/200] batch [10/39] time 0.342 (0.335) data 0.263 (0.257) loss_u loss_u 0.9434 (0.9725) acc_u 6.2500 (2.8125) lr 3.5443e-05 eta 0:00:09
epoch [185/200] batch [15/39] time 0.297 (0.334) data 0.220 (0.256) loss_u loss_u 0.9380 (0.9700) acc_u 6.2500 (3.3333) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [20/39] time 0.303 (0.329) data 0.224 (0.251) loss_u loss_u 0.9956 (0.9713) acc_u 0.0000 (3.1250) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [25/39] time 0.299 (0.326) data 0.221 (0.248) loss_u loss_u 1.0000 (0.9735) acc_u 0.0000 (3.0000) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [30/39] time 0.364 (0.329) data 0.286 (0.251) loss_u loss_u 0.9614 (0.9743) acc_u 3.1250 (2.8125) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [35/39] time 0.355 (0.332) data 0.277 (0.254) loss_u loss_u 0.9683 (0.9710) acc_u 3.1250 (3.2143) lr 3.5443e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 460
confident_label rate tensor(0.2390, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 390
clean true:357
clean false:33
clean_rate:0.9153846153846154
noisy true:815
noisy false:427
after delete: len(clean_dataset) 390
after delete: len(noisy_dataset) 1242
epoch [186/200] batch [5/12] time 0.312 (0.310) data 0.234 (0.232) loss_x loss_x 0.2668 (0.2844) acc_x 96.8750 (95.0000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/12] time 0.290 (0.306) data 0.212 (0.228) loss_x loss_x 0.4331 (0.3370) acc_x 90.6250 (93.4375) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/38] time 0.296 (0.303) data 0.216 (0.225) loss_u loss_u 0.9756 (0.9812) acc_u 3.1250 (1.8750) lr 3.1417e-05 eta 0:00:10
epoch [186/200] batch [10/38] time 0.295 (0.303) data 0.216 (0.224) loss_u loss_u 0.9653 (0.9819) acc_u 6.2500 (1.8750) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [15/38] time 0.323 (0.305) data 0.241 (0.227) loss_u loss_u 0.9766 (0.9818) acc_u 3.1250 (2.0833) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [20/38] time 0.292 (0.305) data 0.214 (0.226) loss_u loss_u 1.0000 (0.9830) acc_u 0.0000 (2.1875) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [25/38] time 0.289 (0.304) data 0.211 (0.225) loss_u loss_u 0.9995 (0.9834) acc_u 0.0000 (2.1250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [30/38] time 0.299 (0.303) data 0.220 (0.224) loss_u loss_u 0.9731 (0.9828) acc_u 3.1250 (2.0833) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [35/38] time 0.316 (0.303) data 0.238 (0.225) loss_u loss_u 0.9966 (0.9822) acc_u 0.0000 (2.1429) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 456
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 384
clean true:351
clean false:33
clean_rate:0.9140625
noisy true:825
noisy false:423
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1248
epoch [187/200] batch [5/12] time 0.304 (0.301) data 0.226 (0.223) loss_x loss_x 0.1044 (0.2477) acc_x 100.0000 (96.2500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/12] time 0.299 (0.297) data 0.221 (0.219) loss_x loss_x 0.2159 (0.2563) acc_x 93.7500 (94.6875) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/39] time 0.294 (0.298) data 0.216 (0.220) loss_u loss_u 0.9980 (0.9784) acc_u 0.0000 (2.5000) lr 2.7630e-05 eta 0:00:10
epoch [187/200] batch [10/39] time 0.291 (0.296) data 0.213 (0.218) loss_u loss_u 0.9990 (0.9793) acc_u 0.0000 (2.5000) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [15/39] time 0.291 (0.296) data 0.213 (0.217) loss_u loss_u 0.9976 (0.9741) acc_u 0.0000 (3.1250) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [20/39] time 0.294 (0.295) data 0.216 (0.217) loss_u loss_u 0.9414 (0.9707) acc_u 6.2500 (3.4375) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [25/39] time 0.291 (0.295) data 0.212 (0.216) loss_u loss_u 0.9976 (0.9704) acc_u 0.0000 (3.3750) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [30/39] time 0.299 (0.295) data 0.221 (0.217) loss_u loss_u 0.9980 (0.9725) acc_u 0.0000 (3.0208) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [35/39] time 0.298 (0.295) data 0.220 (0.217) loss_u loss_u 0.9702 (0.9740) acc_u 3.1250 (2.8571) lr 2.7630e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 471
confident_label rate tensor(0.2335, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 381
clean true:346
clean false:35
clean_rate:0.9081364829396326
noisy true:815
noisy false:436
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1251
epoch [188/200] batch [5/11] time 0.290 (0.295) data 0.212 (0.216) loss_x loss_x 0.4868 (0.4300) acc_x 84.3750 (91.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/11] time 0.295 (0.297) data 0.218 (0.219) loss_x loss_x 0.3794 (0.3820) acc_x 90.6250 (91.5625) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/39] time 0.299 (0.297) data 0.220 (0.218) loss_u loss_u 0.9980 (0.9847) acc_u 0.0000 (1.2500) lr 2.4083e-05 eta 0:00:10
epoch [188/200] batch [10/39] time 0.286 (0.296) data 0.208 (0.218) loss_u loss_u 0.9600 (0.9856) acc_u 6.2500 (1.5625) lr 2.4083e-05 eta 0:00:08
epoch [188/200] batch [15/39] time 0.299 (0.296) data 0.220 (0.217) loss_u loss_u 0.9775 (0.9846) acc_u 3.1250 (1.6667) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [20/39] time 0.286 (0.296) data 0.207 (0.217) loss_u loss_u 0.9351 (0.9813) acc_u 6.2500 (1.8750) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [25/39] time 0.298 (0.296) data 0.219 (0.218) loss_u loss_u 0.9990 (0.9792) acc_u 0.0000 (2.1250) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [30/39] time 0.297 (0.297) data 0.218 (0.218) loss_u loss_u 0.9619 (0.9749) acc_u 6.2500 (2.7083) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [35/39] time 0.301 (0.297) data 0.222 (0.218) loss_u loss_u 0.9790 (0.9737) acc_u 3.1250 (2.8571) lr 2.4083e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 495
confident_label rate tensor(0.2328, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 380
clean true:344
clean false:36
clean_rate:0.9052631578947369
noisy true:793
noisy false:459
after delete: len(clean_dataset) 380
after delete: len(noisy_dataset) 1252
epoch [189/200] batch [5/11] time 0.289 (0.294) data 0.211 (0.216) loss_x loss_x 0.2939 (0.3531) acc_x 93.7500 (91.8750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/11] time 0.289 (0.293) data 0.211 (0.215) loss_x loss_x 0.3250 (0.3573) acc_x 90.6250 (90.9375) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/39] time 0.295 (0.294) data 0.217 (0.216) loss_u loss_u 0.9995 (0.9677) acc_u 0.0000 (3.7500) lr 2.0777e-05 eta 0:00:10
epoch [189/200] batch [10/39] time 0.287 (0.294) data 0.208 (0.216) loss_u loss_u 0.9673 (0.9689) acc_u 3.1250 (3.4375) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [15/39] time 0.304 (0.294) data 0.225 (0.216) loss_u loss_u 0.9878 (0.9754) acc_u 0.0000 (2.5000) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [20/39] time 0.295 (0.294) data 0.216 (0.216) loss_u loss_u 0.9990 (0.9725) acc_u 0.0000 (2.9688) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [25/39] time 0.296 (0.295) data 0.218 (0.216) loss_u loss_u 0.9688 (0.9712) acc_u 3.1250 (3.1250) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [30/39] time 0.299 (0.295) data 0.220 (0.216) loss_u loss_u 0.9707 (0.9703) acc_u 3.1250 (3.1250) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [35/39] time 0.292 (0.295) data 0.213 (0.217) loss_u loss_u 0.9424 (0.9699) acc_u 6.2500 (3.2143) lr 2.0777e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 469
confident_label rate tensor(0.2341, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 382
clean true:348
clean false:34
clean_rate:0.9109947643979057
noisy true:815
noisy false:435
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1250
epoch [190/200] batch [5/11] time 0.309 (0.306) data 0.230 (0.227) loss_x loss_x 0.2607 (0.2454) acc_x 96.8750 (94.3750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/11] time 0.302 (0.305) data 0.223 (0.226) loss_x loss_x 0.2036 (0.2818) acc_x 96.8750 (94.0625) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/39] time 0.312 (0.302) data 0.232 (0.223) loss_u loss_u 0.9985 (0.9855) acc_u 0.0000 (1.2500) lr 1.7713e-05 eta 0:00:10
epoch [190/200] batch [10/39] time 0.297 (0.301) data 0.218 (0.222) loss_u loss_u 0.9995 (0.9817) acc_u 0.0000 (1.8750) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [15/39] time 0.298 (0.300) data 0.219 (0.221) loss_u loss_u 0.9805 (0.9814) acc_u 0.0000 (1.6667) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [20/39] time 0.306 (0.300) data 0.226 (0.221) loss_u loss_u 0.9956 (0.9808) acc_u 0.0000 (1.8750) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [25/39] time 0.297 (0.300) data 0.218 (0.221) loss_u loss_u 0.9824 (0.9778) acc_u 3.1250 (2.2500) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [30/39] time 0.300 (0.300) data 0.220 (0.221) loss_u loss_u 0.9482 (0.9772) acc_u 6.2500 (2.3958) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [35/39] time 0.294 (0.300) data 0.214 (0.221) loss_u loss_u 0.9702 (0.9769) acc_u 3.1250 (2.4107) lr 1.7713e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 485
confident_label rate tensor(0.2298, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 375
clean true:343
clean false:32
clean_rate:0.9146666666666666
noisy true:804
noisy false:453
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1257
epoch [191/200] batch [5/11] time 0.306 (0.302) data 0.228 (0.224) loss_x loss_x 0.3230 (0.2738) acc_x 93.7500 (93.1250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/11] time 0.296 (0.303) data 0.218 (0.225) loss_x loss_x 0.1816 (0.2793) acc_x 93.7500 (94.0625) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/39] time 0.289 (0.300) data 0.210 (0.222) loss_u loss_u 0.9170 (0.9380) acc_u 9.3750 (6.8750) lr 1.4891e-05 eta 0:00:10
epoch [191/200] batch [10/39] time 0.294 (0.299) data 0.215 (0.220) loss_u loss_u 0.9702 (0.9591) acc_u 3.1250 (4.3750) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [15/39] time 0.294 (0.298) data 0.216 (0.219) loss_u loss_u 0.9980 (0.9620) acc_u 0.0000 (3.9583) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [20/39] time 0.284 (0.296) data 0.205 (0.218) loss_u loss_u 0.9727 (0.9647) acc_u 3.1250 (3.7500) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [25/39] time 0.314 (0.297) data 0.233 (0.218) loss_u loss_u 0.9761 (0.9671) acc_u 3.1250 (3.6250) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [30/39] time 0.292 (0.297) data 0.213 (0.218) loss_u loss_u 0.9712 (0.9704) acc_u 3.1250 (3.2292) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [35/39] time 0.294 (0.297) data 0.215 (0.218) loss_u loss_u 0.9985 (0.9698) acc_u 0.0000 (3.3036) lr 1.4891e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 466
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 384
clean true:348
clean false:36
clean_rate:0.90625
noisy true:818
noisy false:430
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1248
epoch [192/200] batch [5/12] time 0.292 (0.293) data 0.215 (0.215) loss_x loss_x 0.3279 (0.3328) acc_x 87.5000 (91.8750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/12] time 0.292 (0.303) data 0.214 (0.226) loss_x loss_x 0.3213 (0.2973) acc_x 93.7500 (93.7500) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/39] time 0.294 (0.302) data 0.216 (0.224) loss_u loss_u 0.9995 (0.9851) acc_u 0.0000 (1.8750) lr 1.2312e-05 eta 0:00:10
epoch [192/200] batch [10/39] time 0.299 (0.301) data 0.220 (0.223) loss_u loss_u 0.9541 (0.9834) acc_u 3.1250 (1.5625) lr 1.2312e-05 eta 0:00:08
epoch [192/200] batch [15/39] time 0.300 (0.300) data 0.222 (0.222) loss_u loss_u 0.9678 (0.9819) acc_u 3.1250 (2.0833) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [20/39] time 0.288 (0.299) data 0.209 (0.220) loss_u loss_u 0.9849 (0.9794) acc_u 0.0000 (2.1875) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [25/39] time 0.289 (0.298) data 0.211 (0.220) loss_u loss_u 0.9985 (0.9804) acc_u 0.0000 (2.1250) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [30/39] time 0.294 (0.298) data 0.215 (0.219) loss_u loss_u 0.9810 (0.9798) acc_u 3.1250 (2.2917) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [35/39] time 0.297 (0.297) data 0.218 (0.219) loss_u loss_u 0.9688 (0.9798) acc_u 3.1250 (2.2321) lr 1.2312e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 456
confident_label rate tensor(0.2408, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 393
clean true:357
clean false:36
clean_rate:0.9083969465648855
noisy true:819
noisy false:420
after delete: len(clean_dataset) 393
after delete: len(noisy_dataset) 1239
epoch [193/200] batch [5/12] time 0.299 (0.300) data 0.222 (0.222) loss_x loss_x 0.3213 (0.3549) acc_x 93.7500 (91.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/12] time 0.293 (0.297) data 0.215 (0.219) loss_x loss_x 0.2335 (0.2846) acc_x 93.7500 (93.1250) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/38] time 0.303 (0.296) data 0.225 (0.218) loss_u loss_u 1.0000 (0.9833) acc_u 0.0000 (1.8750) lr 9.9763e-06 eta 0:00:09
epoch [193/200] batch [10/38] time 0.293 (0.297) data 0.214 (0.218) loss_u loss_u 0.9780 (0.9787) acc_u 3.1250 (2.1875) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [15/38] time 0.290 (0.297) data 0.211 (0.218) loss_u loss_u 0.9487 (0.9798) acc_u 6.2500 (2.2917) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [20/38] time 0.297 (0.296) data 0.218 (0.218) loss_u loss_u 0.9648 (0.9823) acc_u 3.1250 (1.8750) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [25/38] time 0.292 (0.296) data 0.213 (0.218) loss_u loss_u 1.0000 (0.9831) acc_u 0.0000 (1.7500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [30/38] time 0.294 (0.296) data 0.215 (0.218) loss_u loss_u 0.9619 (0.9822) acc_u 3.1250 (1.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [35/38] time 0.294 (0.296) data 0.216 (0.217) loss_u loss_u 0.9478 (0.9812) acc_u 6.2500 (1.9643) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 459
confident_label rate tensor(0.2322, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 379
clean true:347
clean false:32
clean_rate:0.9155672823218998
noisy true:826
noisy false:427
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1253
epoch [194/200] batch [5/11] time 0.316 (0.310) data 0.237 (0.232) loss_x loss_x 0.2275 (0.2412) acc_x 96.8750 (95.6250) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/11] time 0.291 (0.307) data 0.213 (0.229) loss_x loss_x 0.5298 (0.2750) acc_x 87.5000 (95.0000) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/39] time 0.303 (0.305) data 0.224 (0.226) loss_u loss_u 0.9399 (0.9527) acc_u 6.2500 (4.3750) lr 7.8853e-06 eta 0:00:10
epoch [194/200] batch [10/39] time 0.301 (0.304) data 0.222 (0.225) loss_u loss_u 0.9673 (0.9635) acc_u 3.1250 (3.7500) lr 7.8853e-06 eta 0:00:08
epoch [194/200] batch [15/39] time 0.296 (0.302) data 0.217 (0.223) loss_u loss_u 0.9688 (0.9707) acc_u 3.1250 (2.9167) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [20/39] time 0.292 (0.301) data 0.213 (0.223) loss_u loss_u 0.9951 (0.9724) acc_u 0.0000 (2.8125) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [25/39] time 0.296 (0.301) data 0.218 (0.222) loss_u loss_u 0.9985 (0.9745) acc_u 0.0000 (2.6250) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [30/39] time 0.297 (0.300) data 0.219 (0.222) loss_u loss_u 0.9497 (0.9751) acc_u 3.1250 (2.5000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [35/39] time 0.290 (0.300) data 0.212 (0.221) loss_u loss_u 0.9692 (0.9754) acc_u 3.1250 (2.5000) lr 7.8853e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 468
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 384
clean true:345
clean false:39
clean_rate:0.8984375
noisy true:819
noisy false:429
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1248
epoch [195/200] batch [5/12] time 0.295 (0.292) data 0.216 (0.214) loss_x loss_x 0.3096 (0.3461) acc_x 93.7500 (91.2500) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/12] time 0.299 (0.294) data 0.221 (0.216) loss_x loss_x 1.1494 (0.4424) acc_x 84.3750 (90.6250) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/39] time 0.301 (0.295) data 0.222 (0.217) loss_u loss_u 0.9434 (0.9590) acc_u 6.2500 (4.3750) lr 6.0390e-06 eta 0:00:10
epoch [195/200] batch [10/39] time 0.307 (0.295) data 0.228 (0.217) loss_u loss_u 0.9995 (0.9756) acc_u 0.0000 (2.5000) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [15/39] time 0.290 (0.295) data 0.212 (0.217) loss_u loss_u 0.9819 (0.9784) acc_u 3.1250 (2.5000) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [20/39] time 0.286 (0.294) data 0.207 (0.216) loss_u loss_u 0.9814 (0.9720) acc_u 3.1250 (3.2812) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [25/39] time 0.291 (0.295) data 0.213 (0.216) loss_u loss_u 0.9995 (0.9739) acc_u 0.0000 (3.0000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [30/39] time 0.299 (0.295) data 0.221 (0.216) loss_u loss_u 0.9741 (0.9731) acc_u 6.2500 (3.2292) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [35/39] time 0.301 (0.295) data 0.223 (0.217) loss_u loss_u 0.9517 (0.9714) acc_u 6.2500 (3.4821) lr 6.0390e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 485
confident_label rate tensor(0.2298, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 375
clean true:348
clean false:27
clean_rate:0.928
noisy true:799
noisy false:458
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1257
epoch [196/200] batch [5/11] time 0.292 (0.289) data 0.214 (0.211) loss_x loss_x 0.1559 (0.3966) acc_x 100.0000 (90.6250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/11] time 0.294 (0.291) data 0.216 (0.213) loss_x loss_x 0.3430 (0.3469) acc_x 90.6250 (92.1875) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/39] time 0.289 (0.292) data 0.210 (0.214) loss_u loss_u 0.9683 (0.9686) acc_u 3.1250 (3.1250) lr 4.4380e-06 eta 0:00:09
epoch [196/200] batch [10/39] time 0.303 (0.292) data 0.225 (0.214) loss_u loss_u 0.9780 (0.9743) acc_u 3.1250 (2.8125) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [15/39] time 0.292 (0.292) data 0.213 (0.214) loss_u loss_u 0.9683 (0.9761) acc_u 3.1250 (2.5000) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [20/39] time 0.298 (0.293) data 0.219 (0.214) loss_u loss_u 0.9995 (0.9729) acc_u 0.0000 (2.9688) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [25/39] time 0.301 (0.293) data 0.222 (0.215) loss_u loss_u 0.9595 (0.9684) acc_u 3.1250 (3.3750) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [30/39] time 0.299 (0.294) data 0.221 (0.216) loss_u loss_u 0.9609 (0.9692) acc_u 6.2500 (3.3333) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [35/39] time 0.296 (0.294) data 0.218 (0.215) loss_u loss_u 0.9980 (0.9708) acc_u 0.0000 (3.2143) lr 4.4380e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 486
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 384
clean true:350
clean false:34
clean_rate:0.9114583333333334
noisy true:796
noisy false:452
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1248
epoch [197/200] batch [5/12] time 0.300 (0.297) data 0.222 (0.219) loss_x loss_x 0.2625 (0.2844) acc_x 90.6250 (94.3750) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/12] time 0.294 (0.295) data 0.216 (0.217) loss_x loss_x 0.4585 (0.3553) acc_x 90.6250 (91.8750) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/39] time 0.293 (0.294) data 0.215 (0.216) loss_u loss_u 0.9395 (0.9576) acc_u 6.2500 (4.3750) lr 3.0827e-06 eta 0:00:10
epoch [197/200] batch [10/39] time 0.290 (0.294) data 0.211 (0.216) loss_u loss_u 0.9448 (0.9650) acc_u 6.2500 (3.4375) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [15/39] time 0.291 (0.294) data 0.213 (0.216) loss_u loss_u 0.9995 (0.9701) acc_u 0.0000 (2.9167) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [20/39] time 0.290 (0.294) data 0.212 (0.215) loss_u loss_u 0.9717 (0.9760) acc_u 3.1250 (2.3438) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [25/39] time 0.289 (0.293) data 0.211 (0.215) loss_u loss_u 0.9980 (0.9760) acc_u 0.0000 (2.3750) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [30/39] time 0.298 (0.293) data 0.220 (0.215) loss_u loss_u 0.9346 (0.9747) acc_u 6.2500 (2.6042) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [35/39] time 0.292 (0.294) data 0.214 (0.215) loss_u loss_u 1.0000 (0.9769) acc_u 0.0000 (2.5000) lr 3.0827e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 476
confident_label rate tensor(0.2396, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 391
clean true:353
clean false:38
clean_rate:0.9028132992327366
noisy true:803
noisy false:438
after delete: len(clean_dataset) 391
after delete: len(noisy_dataset) 1241
epoch [198/200] batch [5/12] time 0.294 (0.299) data 0.216 (0.221) loss_x loss_x 0.1930 (0.3256) acc_x 93.7500 (93.1250) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/12] time 0.290 (0.298) data 0.212 (0.220) loss_x loss_x 0.4026 (0.2907) acc_x 93.7500 (94.0625) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/38] time 0.292 (0.299) data 0.214 (0.221) loss_u loss_u 0.9932 (0.9873) acc_u 0.0000 (1.2500) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [10/38] time 0.290 (0.298) data 0.212 (0.220) loss_u loss_u 0.9888 (0.9749) acc_u 0.0000 (2.5000) lr 1.9733e-06 eta 0:00:08
epoch [198/200] batch [15/38] time 0.295 (0.298) data 0.216 (0.220) loss_u loss_u 0.9980 (0.9818) acc_u 0.0000 (1.8750) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [20/38] time 0.298 (0.298) data 0.220 (0.219) loss_u loss_u 0.9736 (0.9823) acc_u 3.1250 (1.8750) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [25/38] time 0.295 (0.298) data 0.217 (0.219) loss_u loss_u 0.9902 (0.9766) acc_u 0.0000 (2.5000) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [30/38] time 0.289 (0.297) data 0.210 (0.219) loss_u loss_u 0.9976 (0.9795) acc_u 0.0000 (2.1875) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [35/38] time 0.296 (0.298) data 0.218 (0.219) loss_u loss_u 0.9390 (0.9779) acc_u 6.2500 (2.3214) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 476
confident_label rate tensor(0.2279, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 372
clean true:339
clean false:33
clean_rate:0.9112903225806451
noisy true:817
noisy false:443
after delete: len(clean_dataset) 372
after delete: len(noisy_dataset) 1260
epoch [199/200] batch [5/11] time 0.294 (0.300) data 0.216 (0.222) loss_x loss_x 0.2732 (0.2410) acc_x 93.7500 (96.8750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/11] time 0.293 (0.298) data 0.216 (0.221) loss_x loss_x 0.1178 (0.2703) acc_x 100.0000 (94.3750) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/39] time 0.297 (0.298) data 0.218 (0.220) loss_u loss_u 0.9746 (0.9587) acc_u 3.1250 (5.0000) lr 1.1101e-06 eta 0:00:10
epoch [199/200] batch [10/39] time 0.290 (0.297) data 0.211 (0.219) loss_u loss_u 0.9517 (0.9573) acc_u 6.2500 (5.0000) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [15/39] time 0.296 (0.296) data 0.217 (0.218) loss_u loss_u 0.9922 (0.9640) acc_u 0.0000 (3.9583) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [20/39] time 0.296 (0.296) data 0.217 (0.218) loss_u loss_u 0.9995 (0.9679) acc_u 0.0000 (3.5938) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [25/39] time 0.301 (0.297) data 0.223 (0.218) loss_u loss_u 0.9536 (0.9689) acc_u 6.2500 (3.6250) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [30/39] time 0.296 (0.296) data 0.218 (0.218) loss_u loss_u 0.9985 (0.9707) acc_u 0.0000 (3.3333) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [35/39] time 0.294 (0.296) data 0.216 (0.218) loss_u loss_u 0.9951 (0.9712) acc_u 0.0000 (3.3036) lr 1.1101e-06 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 466
confident_label rate tensor(0.2353, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 384
clean true:353
clean false:31
clean_rate:0.9192708333333334
noisy true:813
noisy false:435
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1248
epoch [200/200] batch [5/12] time 0.299 (0.295) data 0.221 (0.216) loss_x loss_x 0.3298 (0.2282) acc_x 93.7500 (95.6250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/12] time 0.292 (0.292) data 0.213 (0.213) loss_x loss_x 0.3325 (0.2980) acc_x 93.7500 (94.6875) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/39] time 0.307 (0.294) data 0.228 (0.215) loss_u loss_u 0.9712 (0.9879) acc_u 3.1250 (1.2500) lr 4.9344e-07 eta 0:00:09
epoch [200/200] batch [10/39] time 0.288 (0.294) data 0.209 (0.215) loss_u loss_u 0.9458 (0.9786) acc_u 6.2500 (2.5000) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [15/39] time 0.311 (0.294) data 0.232 (0.215) loss_u loss_u 0.9990 (0.9742) acc_u 0.0000 (2.9167) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [20/39] time 0.300 (0.296) data 0.222 (0.217) loss_u loss_u 0.9702 (0.9739) acc_u 3.1250 (2.9688) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [25/39] time 0.297 (0.297) data 0.217 (0.218) loss_u loss_u 0.9819 (0.9748) acc_u 3.1250 (2.8750) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [30/39] time 0.295 (0.296) data 0.216 (0.217) loss_u loss_u 0.9736 (0.9739) acc_u 3.1250 (2.9167) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [35/39] time 0.296 (0.297) data 0.217 (0.218) loss_u loss_u 0.9990 (0.9758) acc_u 0.0000 (2.6786) lr 4.9344e-07 eta 0:00:01
Checkpoint saved to output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 1,848
* accuracy: 75.0%
* error: 25.0%
* macro_f1: 72.8%
Elapsed: 2:12:03
