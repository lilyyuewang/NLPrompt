***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '102']
output_dir: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1256
confident_label rate tensor(0.0631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 103
clean true:96
clean false:7
clean_rate:0.9320388349514563
noisy true:280
noisy false:1249
after delete: len(clean_dataset) 103
after delete: len(noisy_dataset) 1529
epoch [1/200] batch [1/3] time 0.460 (0.460) data 0.286 (0.286) loss_x loss_x 2.7734 (2.7734) acc_x 37.5000 (37.5000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/3] time 0.358 (0.409) data 0.280 (0.283) loss_x loss_x 2.4121 (2.5928) acc_x 62.5000 (50.0000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [3/3] time 0.350 (0.389) data 0.273 (0.279) loss_x loss_x 2.9102 (2.6986) acc_x 34.3750 (44.7917) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/47] time 0.329 (0.361) data 0.252 (0.268) loss_u loss_u 0.9917 (0.9870) acc_u 0.0000 (2.5000) lr 1.0000e-05 eta 0:00:15
epoch [1/200] batch [10/47] time 0.330 (0.349) data 0.251 (0.262) loss_u loss_u 0.9902 (0.9857) acc_u 6.2500 (2.8125) lr 1.0000e-05 eta 0:00:12
epoch [1/200] batch [15/47] time 0.349 (0.343) data 0.271 (0.259) loss_u loss_u 0.9858 (0.9867) acc_u 6.2500 (2.5000) lr 1.0000e-05 eta 0:00:10
epoch [1/200] batch [20/47] time 0.337 (0.343) data 0.259 (0.260) loss_u loss_u 0.9893 (0.9865) acc_u 0.0000 (2.0312) lr 1.0000e-05 eta 0:00:09
epoch [1/200] batch [25/47] time 0.332 (0.342) data 0.253 (0.260) loss_u loss_u 0.9844 (0.9860) acc_u 0.0000 (2.2500) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [30/47] time 0.338 (0.341) data 0.259 (0.260) loss_u loss_u 0.9834 (0.9857) acc_u 3.1250 (2.2917) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [35/47] time 0.286 (0.337) data 0.208 (0.256) loss_u loss_u 0.9888 (0.9857) acc_u 0.0000 (2.2321) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [40/47] time 0.332 (0.334) data 0.253 (0.253) loss_u loss_u 0.9863 (0.9855) acc_u 3.1250 (2.4219) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [45/47] time 0.342 (0.335) data 0.264 (0.254) loss_u loss_u 0.9858 (0.9859) acc_u 3.1250 (2.2917) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1147
confident_label rate tensor(0.0809, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 132
clean true:130
clean false:2
clean_rate:0.9848484848484849
noisy true:355
noisy false:1145
after delete: len(clean_dataset) 132
after delete: len(noisy_dataset) 1500
epoch [2/200] batch [1/4] time 0.366 (0.366) data 0.288 (0.288) loss_x loss_x 2.6016 (2.6016) acc_x 37.5000 (37.5000) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [2/4] time 0.362 (0.364) data 0.285 (0.286) loss_x loss_x 1.1523 (1.8770) acc_x 78.1250 (57.8125) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [3/4] time 0.353 (0.360) data 0.275 (0.283) loss_x loss_x 1.0234 (1.5924) acc_x 81.2500 (65.6250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [4/4] time 0.336 (0.354) data 0.259 (0.277) loss_x loss_x 0.9214 (1.4247) acc_x 81.2500 (69.5312) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/46] time 0.338 (0.343) data 0.259 (0.265) loss_u loss_u 0.9131 (0.9402) acc_u 12.5000 (6.8750) lr 2.0000e-03 eta 0:00:14
epoch [2/200] batch [10/46] time 0.339 (0.343) data 0.262 (0.265) loss_u loss_u 0.9697 (0.9339) acc_u 6.2500 (8.4375) lr 2.0000e-03 eta 0:00:12
epoch [2/200] batch [15/46] time 0.323 (0.341) data 0.246 (0.263) loss_u loss_u 0.9268 (0.9367) acc_u 9.3750 (7.9167) lr 2.0000e-03 eta 0:00:10
epoch [2/200] batch [20/46] time 0.329 (0.338) data 0.252 (0.261) loss_u loss_u 0.9229 (0.9335) acc_u 9.3750 (8.2812) lr 2.0000e-03 eta 0:00:08
epoch [2/200] batch [25/46] time 0.349 (0.339) data 0.271 (0.261) loss_u loss_u 0.8887 (0.9329) acc_u 12.5000 (8.1250) lr 2.0000e-03 eta 0:00:07
epoch [2/200] batch [30/46] time 0.286 (0.333) data 0.207 (0.255) loss_u loss_u 0.8916 (0.9305) acc_u 12.5000 (8.4375) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [35/46] time 0.321 (0.331) data 0.244 (0.253) loss_u loss_u 0.9561 (0.9358) acc_u 6.2500 (7.8571) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [40/46] time 0.297 (0.330) data 0.220 (0.252) loss_u loss_u 0.9727 (0.9350) acc_u 3.1250 (7.9688) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [45/46] time 0.342 (0.330) data 0.264 (0.252) loss_u loss_u 0.9546 (0.9357) acc_u 3.1250 (7.8472) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 755
confident_label rate tensor(0.1452, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 237
clean true:228
clean false:9
clean_rate:0.9620253164556962
noisy true:649
noisy false:746
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 1395
epoch [3/200] batch [5/7] time 0.335 (0.349) data 0.258 (0.271) loss_x loss_x 0.7700 (0.8777) acc_x 71.8750 (78.1250) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/43] time 0.349 (0.346) data 0.271 (0.268) loss_u loss_u 0.9668 (0.9746) acc_u 3.1250 (2.5000) lr 1.9999e-03 eta 0:00:13
epoch [3/200] batch [10/43] time 0.344 (0.343) data 0.267 (0.265) loss_u loss_u 0.9468 (0.9740) acc_u 6.2500 (2.5000) lr 1.9999e-03 eta 0:00:11
epoch [3/200] batch [15/43] time 0.326 (0.341) data 0.247 (0.263) loss_u loss_u 0.9751 (0.9770) acc_u 3.1250 (2.2917) lr 1.9999e-03 eta 0:00:09
epoch [3/200] batch [20/43] time 0.347 (0.341) data 0.269 (0.263) loss_u loss_u 0.9683 (0.9737) acc_u 3.1250 (2.9688) lr 1.9999e-03 eta 0:00:07
epoch [3/200] batch [25/43] time 0.295 (0.338) data 0.216 (0.260) loss_u loss_u 0.9492 (0.9726) acc_u 6.2500 (2.8750) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [30/43] time 0.337 (0.336) data 0.260 (0.258) loss_u loss_u 0.9316 (0.9708) acc_u 9.3750 (3.0208) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [35/43] time 0.361 (0.337) data 0.283 (0.259) loss_u loss_u 0.9312 (0.9705) acc_u 9.3750 (3.2143) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [40/43] time 0.356 (0.338) data 0.278 (0.260) loss_u loss_u 0.9790 (0.9687) acc_u 3.1250 (3.5938) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 760
confident_label rate tensor(0.1428, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 233
clean true:223
clean false:10
clean_rate:0.9570815450643777
noisy true:649
noisy false:750
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 1399
epoch [4/200] batch [5/7] time 0.338 (0.342) data 0.261 (0.264) loss_x loss_x 1.1172 (0.8746) acc_x 75.0000 (78.1250) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/43] time 0.347 (0.342) data 0.268 (0.264) loss_u loss_u 0.9819 (0.9809) acc_u 3.1250 (2.5000) lr 1.9995e-03 eta 0:00:12
epoch [4/200] batch [10/43] time 0.335 (0.339) data 0.256 (0.261) loss_u loss_u 0.9365 (0.9694) acc_u 6.2500 (3.1250) lr 1.9995e-03 eta 0:00:11
epoch [4/200] batch [15/43] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9482 (0.9584) acc_u 6.2500 (5.0000) lr 1.9995e-03 eta 0:00:09
epoch [4/200] batch [20/43] time 0.330 (0.341) data 0.253 (0.263) loss_u loss_u 0.9814 (0.9616) acc_u 0.0000 (4.5312) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [25/43] time 0.321 (0.336) data 0.244 (0.258) loss_u loss_u 0.9766 (0.9607) acc_u 3.1250 (4.6250) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [30/43] time 0.346 (0.337) data 0.269 (0.260) loss_u loss_u 0.9873 (0.9613) acc_u 0.0000 (4.5833) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [35/43] time 0.295 (0.333) data 0.217 (0.255) loss_u loss_u 0.9673 (0.9613) acc_u 3.1250 (4.6429) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [40/43] time 0.330 (0.333) data 0.252 (0.255) loss_u loss_u 0.9341 (0.9607) acc_u 6.2500 (4.7656) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 745
confident_label rate tensor(0.1562, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 255
clean true:241
clean false:14
clean_rate:0.9450980392156862
noisy true:646
noisy false:731
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 1377
epoch [5/200] batch [5/7] time 0.327 (0.340) data 0.250 (0.263) loss_x loss_x 0.6025 (0.9784) acc_x 81.2500 (74.3750) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/43] time 0.419 (0.346) data 0.342 (0.269) loss_u loss_u 0.9546 (0.9632) acc_u 3.1250 (3.1250) lr 1.9989e-03 eta 0:00:13
epoch [5/200] batch [10/43] time 0.342 (0.345) data 0.264 (0.267) loss_u loss_u 0.9624 (0.9596) acc_u 6.2500 (5.0000) lr 1.9989e-03 eta 0:00:11
epoch [5/200] batch [15/43] time 0.337 (0.344) data 0.259 (0.266) loss_u loss_u 0.9810 (0.9632) acc_u 3.1250 (4.3750) lr 1.9989e-03 eta 0:00:09
epoch [5/200] batch [20/43] time 0.335 (0.341) data 0.257 (0.264) loss_u loss_u 0.9043 (0.9603) acc_u 9.3750 (4.5312) lr 1.9989e-03 eta 0:00:07
epoch [5/200] batch [25/43] time 0.338 (0.341) data 0.260 (0.263) loss_u loss_u 0.9233 (0.9613) acc_u 9.3750 (4.7500) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [30/43] time 0.310 (0.337) data 0.232 (0.259) loss_u loss_u 0.9761 (0.9621) acc_u 3.1250 (4.4792) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [35/43] time 0.347 (0.337) data 0.269 (0.260) loss_u loss_u 0.9980 (0.9650) acc_u 0.0000 (4.0179) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [40/43] time 0.348 (0.338) data 0.270 (0.260) loss_u loss_u 0.9946 (0.9668) acc_u 0.0000 (3.7500) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 764
confident_label rate tensor(0.1507, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 246
clean true:233
clean false:13
clean_rate:0.9471544715447154
noisy true:635
noisy false:751
after delete: len(clean_dataset) 246
after delete: len(noisy_dataset) 1386
epoch [6/200] batch [5/7] time 0.334 (0.346) data 0.257 (0.268) loss_x loss_x 0.8662 (0.7506) acc_x 78.1250 (83.1250) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/43] time 0.334 (0.342) data 0.256 (0.264) loss_u loss_u 0.9238 (0.9513) acc_u 6.2500 (5.6250) lr 1.9980e-03 eta 0:00:12
epoch [6/200] batch [10/43] time 0.350 (0.339) data 0.273 (0.261) loss_u loss_u 0.9761 (0.9623) acc_u 6.2500 (5.0000) lr 1.9980e-03 eta 0:00:11
epoch [6/200] batch [15/43] time 0.323 (0.337) data 0.245 (0.259) loss_u loss_u 0.9214 (0.9613) acc_u 9.3750 (4.7917) lr 1.9980e-03 eta 0:00:09
epoch [6/200] batch [20/43] time 0.336 (0.335) data 0.258 (0.257) loss_u loss_u 0.9609 (0.9644) acc_u 3.1250 (4.5312) lr 1.9980e-03 eta 0:00:07
epoch [6/200] batch [25/43] time 0.310 (0.333) data 0.231 (0.255) loss_u loss_u 0.9902 (0.9627) acc_u 3.1250 (4.7500) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [30/43] time 0.301 (0.329) data 0.224 (0.251) loss_u loss_u 0.9922 (0.9655) acc_u 0.0000 (4.3750) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [35/43] time 0.307 (0.328) data 0.228 (0.250) loss_u loss_u 0.9849 (0.9673) acc_u 3.1250 (4.0179) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [40/43] time 0.316 (0.329) data 0.237 (0.251) loss_u loss_u 0.9116 (0.9670) acc_u 15.6250 (4.1406) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 731
confident_label rate tensor(0.1458, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 238
clean true:227
clean false:11
clean_rate:0.9537815126050421
noisy true:674
noisy false:720
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 1394
epoch [7/200] batch [5/7] time 0.355 (0.354) data 0.277 (0.275) loss_x loss_x 0.6909 (0.6163) acc_x 81.2500 (84.3750) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/43] time 0.351 (0.346) data 0.273 (0.268) loss_u loss_u 0.9131 (0.9591) acc_u 9.3750 (5.6250) lr 1.9969e-03 eta 0:00:13
epoch [7/200] batch [10/43] time 0.327 (0.345) data 0.249 (0.267) loss_u loss_u 0.9370 (0.9586) acc_u 6.2500 (4.6875) lr 1.9969e-03 eta 0:00:11
epoch [7/200] batch [15/43] time 0.340 (0.345) data 0.262 (0.267) loss_u loss_u 0.9434 (0.9580) acc_u 9.3750 (4.7917) lr 1.9969e-03 eta 0:00:09
epoch [7/200] batch [20/43] time 0.304 (0.340) data 0.226 (0.262) loss_u loss_u 0.9741 (0.9609) acc_u 3.1250 (4.6875) lr 1.9969e-03 eta 0:00:07
epoch [7/200] batch [25/43] time 0.334 (0.336) data 0.256 (0.258) loss_u loss_u 0.9775 (0.9585) acc_u 3.1250 (5.1250) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [30/43] time 0.350 (0.337) data 0.272 (0.259) loss_u loss_u 0.9312 (0.9560) acc_u 6.2500 (5.4167) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [35/43] time 0.348 (0.336) data 0.269 (0.258) loss_u loss_u 0.9551 (0.9574) acc_u 3.1250 (5.0893) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [40/43] time 0.338 (0.337) data 0.259 (0.259) loss_u loss_u 0.9980 (0.9600) acc_u 0.0000 (4.6875) lr 1.9969e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 713
confident_label rate tensor(0.1501, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 245
clean true:233
clean false:12
clean_rate:0.9510204081632653
noisy true:686
noisy false:701
after delete: len(clean_dataset) 245
after delete: len(noisy_dataset) 1387
epoch [8/200] batch [5/7] time 0.331 (0.345) data 0.253 (0.267) loss_x loss_x 0.8408 (0.6790) acc_x 84.3750 (85.0000) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/43] time 0.360 (0.341) data 0.282 (0.264) loss_u loss_u 0.9800 (0.9567) acc_u 3.1250 (5.0000) lr 1.9956e-03 eta 0:00:12
epoch [8/200] batch [10/43] time 0.350 (0.342) data 0.272 (0.265) loss_u loss_u 0.9722 (0.9660) acc_u 3.1250 (4.0625) lr 1.9956e-03 eta 0:00:11
epoch [8/200] batch [15/43] time 0.331 (0.342) data 0.254 (0.265) loss_u loss_u 0.9355 (0.9686) acc_u 6.2500 (3.5417) lr 1.9956e-03 eta 0:00:09
epoch [8/200] batch [20/43] time 0.308 (0.340) data 0.230 (0.262) loss_u loss_u 0.9331 (0.9648) acc_u 9.3750 (4.0625) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [25/43] time 0.335 (0.337) data 0.258 (0.259) loss_u loss_u 0.9937 (0.9666) acc_u 0.0000 (3.8750) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [30/43] time 0.344 (0.335) data 0.266 (0.257) loss_u loss_u 0.9536 (0.9649) acc_u 6.2500 (4.3750) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [35/43] time 0.343 (0.336) data 0.264 (0.258) loss_u loss_u 0.9780 (0.9657) acc_u 0.0000 (4.1964) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [40/43] time 0.338 (0.337) data 0.261 (0.259) loss_u loss_u 0.9224 (0.9630) acc_u 9.3750 (4.5312) lr 1.9956e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 715
confident_label rate tensor(0.1648, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 269
clean true:257
clean false:12
clean_rate:0.9553903345724907
noisy true:660
noisy false:703
after delete: len(clean_dataset) 269
after delete: len(noisy_dataset) 1363
epoch [9/200] batch [5/8] time 0.343 (0.348) data 0.265 (0.270) loss_x loss_x 0.7510 (0.8029) acc_x 78.1250 (78.7500) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [5/42] time 0.344 (0.345) data 0.265 (0.267) loss_u loss_u 0.9756 (0.9501) acc_u 3.1250 (4.3750) lr 1.9940e-03 eta 0:00:12
epoch [9/200] batch [10/42] time 0.337 (0.345) data 0.259 (0.267) loss_u loss_u 0.9600 (0.9606) acc_u 3.1250 (3.4375) lr 1.9940e-03 eta 0:00:11
epoch [9/200] batch [15/42] time 0.328 (0.344) data 0.250 (0.266) loss_u loss_u 0.9868 (0.9648) acc_u 3.1250 (3.3333) lr 1.9940e-03 eta 0:00:09
epoch [9/200] batch [20/42] time 0.308 (0.338) data 0.230 (0.260) loss_u loss_u 0.9814 (0.9635) acc_u 3.1250 (3.7500) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [25/42] time 0.335 (0.336) data 0.257 (0.258) loss_u loss_u 0.9595 (0.9629) acc_u 3.1250 (3.7500) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [30/42] time 0.349 (0.334) data 0.272 (0.256) loss_u loss_u 0.9609 (0.9646) acc_u 3.1250 (3.6458) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [35/42] time 0.338 (0.332) data 0.261 (0.254) loss_u loss_u 0.9370 (0.9632) acc_u 6.2500 (3.7500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [40/42] time 0.352 (0.333) data 0.274 (0.255) loss_u loss_u 0.9658 (0.9622) acc_u 6.2500 (3.9062) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 724
confident_label rate tensor(0.1661, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 271
clean true:250
clean false:21
clean_rate:0.922509225092251
noisy true:658
noisy false:703
after delete: len(clean_dataset) 271
after delete: len(noisy_dataset) 1361
epoch [10/200] batch [5/8] time 0.341 (0.345) data 0.263 (0.268) loss_x loss_x 0.9702 (0.6804) acc_x 65.6250 (83.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [5/42] time 0.332 (0.337) data 0.255 (0.260) loss_u loss_u 0.9946 (0.9783) acc_u 0.0000 (1.8750) lr 1.9921e-03 eta 0:00:12
epoch [10/200] batch [10/42] time 0.345 (0.337) data 0.267 (0.259) loss_u loss_u 0.9922 (0.9717) acc_u 0.0000 (2.8125) lr 1.9921e-03 eta 0:00:10
epoch [10/200] batch [15/42] time 0.331 (0.337) data 0.254 (0.259) loss_u loss_u 0.9424 (0.9624) acc_u 6.2500 (3.9583) lr 1.9921e-03 eta 0:00:09
epoch [10/200] batch [20/42] time 0.313 (0.336) data 0.234 (0.258) loss_u loss_u 0.9141 (0.9591) acc_u 12.5000 (4.6875) lr 1.9921e-03 eta 0:00:07
epoch [10/200] batch [25/42] time 0.344 (0.335) data 0.266 (0.257) loss_u loss_u 0.9526 (0.9577) acc_u 6.2500 (5.0000) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [30/42] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.9668 (0.9610) acc_u 3.1250 (4.4792) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [35/42] time 0.336 (0.337) data 0.259 (0.259) loss_u loss_u 0.9849 (0.9626) acc_u 3.1250 (4.2857) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [40/42] time 0.339 (0.337) data 0.261 (0.259) loss_u loss_u 0.9517 (0.9621) acc_u 3.1250 (4.2969) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 753
confident_label rate tensor(0.1605, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 262
clean true:241
clean false:21
clean_rate:0.9198473282442748
noisy true:638
noisy false:732
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 1370
epoch [11/200] batch [5/8] time 0.327 (0.338) data 0.250 (0.260) loss_x loss_x 0.6099 (0.5322) acc_x 87.5000 (88.7500) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [5/42] time 0.347 (0.339) data 0.270 (0.261) loss_u loss_u 0.9658 (0.9601) acc_u 3.1250 (4.3750) lr 1.9900e-03 eta 0:00:12
epoch [11/200] batch [10/42] time 0.324 (0.338) data 0.246 (0.261) loss_u loss_u 0.9731 (0.9701) acc_u 3.1250 (3.1250) lr 1.9900e-03 eta 0:00:10
epoch [11/200] batch [15/42] time 0.329 (0.338) data 0.251 (0.260) loss_u loss_u 0.9624 (0.9645) acc_u 3.1250 (3.9583) lr 1.9900e-03 eta 0:00:09
epoch [11/200] batch [20/42] time 0.340 (0.337) data 0.261 (0.259) loss_u loss_u 0.9424 (0.9627) acc_u 9.3750 (4.3750) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [25/42] time 0.342 (0.337) data 0.264 (0.259) loss_u loss_u 0.9351 (0.9655) acc_u 9.3750 (4.0000) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [30/42] time 0.345 (0.338) data 0.266 (0.260) loss_u loss_u 0.9561 (0.9640) acc_u 6.2500 (4.2708) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [35/42] time 0.330 (0.338) data 0.252 (0.260) loss_u loss_u 0.9482 (0.9615) acc_u 6.2500 (4.6429) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [40/42] time 0.334 (0.339) data 0.256 (0.261) loss_u loss_u 0.9688 (0.9620) acc_u 3.1250 (4.6094) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 729
confident_label rate tensor(0.1654, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 270
clean true:254
clean false:16
clean_rate:0.9407407407407408
noisy true:649
noisy false:713
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 1362
epoch [12/200] batch [5/8] time 0.347 (0.345) data 0.270 (0.267) loss_x loss_x 0.7559 (0.7075) acc_x 78.1250 (81.8750) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [5/42] time 0.353 (0.348) data 0.272 (0.269) loss_u loss_u 0.9722 (0.9560) acc_u 3.1250 (6.2500) lr 1.9877e-03 eta 0:00:12
epoch [12/200] batch [10/42] time 0.370 (0.351) data 0.292 (0.273) loss_u loss_u 0.9517 (0.9632) acc_u 6.2500 (5.0000) lr 1.9877e-03 eta 0:00:11
epoch [12/200] batch [15/42] time 0.355 (0.353) data 0.277 (0.275) loss_u loss_u 0.9717 (0.9667) acc_u 3.1250 (4.1667) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [20/42] time 0.363 (0.354) data 0.284 (0.276) loss_u loss_u 0.9360 (0.9674) acc_u 6.2500 (4.0625) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [25/42] time 0.361 (0.355) data 0.283 (0.277) loss_u loss_u 0.9712 (0.9664) acc_u 3.1250 (4.0000) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [30/42] time 0.296 (0.352) data 0.218 (0.274) loss_u loss_u 0.9697 (0.9681) acc_u 9.3750 (3.9583) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [35/42] time 0.342 (0.348) data 0.263 (0.269) loss_u loss_u 0.9438 (0.9687) acc_u 6.2500 (3.7500) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [40/42] time 0.347 (0.345) data 0.269 (0.266) loss_u loss_u 0.9072 (0.9686) acc_u 9.3750 (3.6719) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 705
confident_label rate tensor(0.1734, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 283
clean true:260
clean false:23
clean_rate:0.9187279151943463
noisy true:667
noisy false:682
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 1349
epoch [13/200] batch [5/8] time 0.336 (0.343) data 0.258 (0.265) loss_x loss_x 0.7246 (0.7655) acc_x 81.2500 (81.8750) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [5/42] time 0.338 (0.343) data 0.259 (0.265) loss_u loss_u 0.9351 (0.9640) acc_u 9.3750 (5.0000) lr 1.9851e-03 eta 0:00:12
epoch [13/200] batch [10/42] time 0.333 (0.341) data 0.256 (0.263) loss_u loss_u 0.9868 (0.9704) acc_u 3.1250 (3.7500) lr 1.9851e-03 eta 0:00:10
epoch [13/200] batch [15/42] time 0.302 (0.339) data 0.224 (0.261) loss_u loss_u 0.9907 (0.9701) acc_u 0.0000 (3.3333) lr 1.9851e-03 eta 0:00:09
epoch [13/200] batch [20/42] time 0.316 (0.332) data 0.237 (0.254) loss_u loss_u 0.9639 (0.9697) acc_u 6.2500 (3.4375) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [25/42] time 0.340 (0.333) data 0.261 (0.255) loss_u loss_u 0.9751 (0.9722) acc_u 3.1250 (3.2500) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [30/42] time 0.337 (0.334) data 0.258 (0.256) loss_u loss_u 0.9775 (0.9723) acc_u 0.0000 (3.0208) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [35/42] time 0.334 (0.334) data 0.256 (0.256) loss_u loss_u 0.9497 (0.9703) acc_u 3.1250 (3.3929) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [40/42] time 0.321 (0.331) data 0.243 (0.253) loss_u loss_u 0.9712 (0.9703) acc_u 3.1250 (3.4375) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 727
confident_label rate tensor(0.1636, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 267
clean true:239
clean false:28
clean_rate:0.8951310861423221
noisy true:666
noisy false:699
after delete: len(clean_dataset) 267
after delete: len(noisy_dataset) 1365
epoch [14/200] batch [5/8] time 0.346 (0.345) data 0.268 (0.267) loss_x loss_x 0.7646 (0.7804) acc_x 81.2500 (80.0000) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [5/42] time 0.345 (0.342) data 0.266 (0.264) loss_u loss_u 0.9463 (0.9615) acc_u 6.2500 (4.3750) lr 1.9823e-03 eta 0:00:12
epoch [14/200] batch [10/42] time 0.347 (0.342) data 0.268 (0.264) loss_u loss_u 0.9375 (0.9626) acc_u 6.2500 (4.0625) lr 1.9823e-03 eta 0:00:10
epoch [14/200] batch [15/42] time 0.318 (0.338) data 0.240 (0.260) loss_u loss_u 0.9517 (0.9579) acc_u 6.2500 (4.5833) lr 1.9823e-03 eta 0:00:09
epoch [14/200] batch [20/42] time 0.349 (0.333) data 0.270 (0.255) loss_u loss_u 0.9932 (0.9617) acc_u 0.0000 (4.2188) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [25/42] time 0.332 (0.334) data 0.254 (0.256) loss_u loss_u 0.9351 (0.9573) acc_u 6.2500 (5.0000) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [30/42] time 0.329 (0.335) data 0.251 (0.257) loss_u loss_u 0.8740 (0.9569) acc_u 15.6250 (5.1042) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [35/42] time 0.307 (0.333) data 0.229 (0.255) loss_u loss_u 0.9253 (0.9564) acc_u 9.3750 (5.0893) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [40/42] time 0.354 (0.334) data 0.276 (0.256) loss_u loss_u 0.9365 (0.9560) acc_u 9.3750 (5.1562) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 729
confident_label rate tensor(0.1752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 286
clean true:245
clean false:41
clean_rate:0.8566433566433567
noisy true:658
noisy false:688
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 1346
epoch [15/200] batch [5/8] time 0.344 (0.351) data 0.267 (0.274) loss_x loss_x 0.7412 (0.7117) acc_x 81.2500 (82.5000) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [5/42] time 0.359 (0.344) data 0.281 (0.267) loss_u loss_u 0.9478 (0.9439) acc_u 6.2500 (6.8750) lr 1.9792e-03 eta 0:00:12
epoch [15/200] batch [10/42] time 0.326 (0.343) data 0.247 (0.265) loss_u loss_u 0.9941 (0.9391) acc_u 0.0000 (7.5000) lr 1.9792e-03 eta 0:00:10
epoch [15/200] batch [15/42] time 0.338 (0.340) data 0.261 (0.263) loss_u loss_u 0.9448 (0.9461) acc_u 6.2500 (6.4583) lr 1.9792e-03 eta 0:00:09
epoch [15/200] batch [20/42] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.9858 (0.9545) acc_u 3.1250 (5.4688) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [25/42] time 0.343 (0.341) data 0.266 (0.264) loss_u loss_u 0.9795 (0.9575) acc_u 0.0000 (5.1250) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [30/42] time 0.349 (0.341) data 0.272 (0.263) loss_u loss_u 0.9502 (0.9583) acc_u 6.2500 (5.0000) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [35/42] time 0.344 (0.341) data 0.266 (0.263) loss_u loss_u 0.9473 (0.9580) acc_u 6.2500 (5.0893) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [40/42] time 0.338 (0.341) data 0.260 (0.263) loss_u loss_u 0.9678 (0.9576) acc_u 3.1250 (5.2344) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 731
confident_label rate tensor(0.1783, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 291
clean true:246
clean false:45
clean_rate:0.845360824742268
noisy true:655
noisy false:686
after delete: len(clean_dataset) 291
after delete: len(noisy_dataset) 1341
epoch [16/200] batch [5/9] time 0.347 (0.353) data 0.270 (0.275) loss_x loss_x 0.5186 (0.7126) acc_x 87.5000 (81.2500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [5/41] time 0.343 (0.343) data 0.265 (0.265) loss_u loss_u 0.9595 (0.9489) acc_u 9.3750 (8.1250) lr 1.9759e-03 eta 0:00:12
epoch [16/200] batch [10/41] time 0.322 (0.340) data 0.243 (0.262) loss_u loss_u 0.9771 (0.9555) acc_u 3.1250 (6.8750) lr 1.9759e-03 eta 0:00:10
epoch [16/200] batch [15/41] time 0.325 (0.335) data 0.247 (0.257) loss_u loss_u 0.9219 (0.9481) acc_u 9.3750 (7.2917) lr 1.9759e-03 eta 0:00:08
epoch [16/200] batch [20/41] time 0.347 (0.335) data 0.270 (0.257) loss_u loss_u 0.9189 (0.9474) acc_u 9.3750 (7.0312) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [25/41] time 0.341 (0.336) data 0.262 (0.258) loss_u loss_u 0.9927 (0.9521) acc_u 0.0000 (6.3750) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [30/41] time 0.302 (0.333) data 0.223 (0.255) loss_u loss_u 0.9531 (0.9527) acc_u 6.2500 (6.2500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [35/41] time 0.347 (0.334) data 0.269 (0.256) loss_u loss_u 0.9360 (0.9504) acc_u 6.2500 (6.4286) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [40/41] time 0.349 (0.336) data 0.271 (0.258) loss_u loss_u 0.9458 (0.9510) acc_u 6.2500 (6.2500) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 732
confident_label rate tensor(0.1832, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 299
clean true:247
clean false:52
clean_rate:0.8260869565217391
noisy true:653
noisy false:680
after delete: len(clean_dataset) 299
after delete: len(noisy_dataset) 1333
epoch [17/200] batch [5/9] time 0.349 (0.350) data 0.272 (0.272) loss_x loss_x 0.4668 (0.7592) acc_x 87.5000 (81.2500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [5/41] time 0.336 (0.342) data 0.259 (0.265) loss_u loss_u 0.9551 (0.9461) acc_u 6.2500 (6.8750) lr 1.9724e-03 eta 0:00:12
epoch [17/200] batch [10/41] time 0.296 (0.331) data 0.218 (0.254) loss_u loss_u 0.9966 (0.9567) acc_u 0.0000 (5.0000) lr 1.9724e-03 eta 0:00:10
epoch [17/200] batch [15/41] time 0.360 (0.332) data 0.283 (0.254) loss_u loss_u 0.9858 (0.9576) acc_u 3.1250 (5.4167) lr 1.9724e-03 eta 0:00:08
epoch [17/200] batch [20/41] time 0.335 (0.334) data 0.258 (0.256) loss_u loss_u 0.9546 (0.9517) acc_u 3.1250 (6.0938) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [25/41] time 0.329 (0.334) data 0.252 (0.256) loss_u loss_u 0.9893 (0.9537) acc_u 0.0000 (5.7500) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [30/41] time 0.303 (0.330) data 0.225 (0.252) loss_u loss_u 0.9414 (0.9574) acc_u 6.2500 (5.2083) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [35/41] time 0.333 (0.329) data 0.255 (0.251) loss_u loss_u 0.9087 (0.9566) acc_u 9.3750 (5.2679) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [40/41] time 0.346 (0.330) data 0.268 (0.253) loss_u loss_u 0.9243 (0.9562) acc_u 6.2500 (5.2344) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 689
confident_label rate tensor(0.1979, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 323
clean true:255
clean false:68
clean_rate:0.7894736842105263
noisy true:688
noisy false:621
after delete: len(clean_dataset) 323
after delete: len(noisy_dataset) 1309
epoch [18/200] batch [5/10] time 0.350 (0.352) data 0.273 (0.274) loss_x loss_x 0.5425 (0.6791) acc_x 93.7500 (87.5000) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/10] time 0.344 (0.348) data 0.266 (0.270) loss_x loss_x 0.9868 (0.7118) acc_x 78.1250 (84.6875) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/40] time 0.339 (0.346) data 0.260 (0.268) loss_u loss_u 0.9805 (0.9753) acc_u 3.1250 (3.7500) lr 1.9686e-03 eta 0:00:12
epoch [18/200] batch [10/40] time 0.352 (0.346) data 0.274 (0.268) loss_u loss_u 0.9395 (0.9736) acc_u 6.2500 (3.4375) lr 1.9686e-03 eta 0:00:10
epoch [18/200] batch [15/40] time 0.298 (0.337) data 0.220 (0.259) loss_u loss_u 0.9336 (0.9679) acc_u 9.3750 (4.1667) lr 1.9686e-03 eta 0:00:08
epoch [18/200] batch [20/40] time 0.335 (0.336) data 0.257 (0.258) loss_u loss_u 0.9941 (0.9691) acc_u 0.0000 (3.9062) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [25/40] time 0.341 (0.337) data 0.264 (0.259) loss_u loss_u 0.9126 (0.9681) acc_u 12.5000 (4.0000) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [30/40] time 0.336 (0.336) data 0.258 (0.259) loss_u loss_u 0.9092 (0.9664) acc_u 9.3750 (4.1667) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [35/40] time 0.332 (0.337) data 0.255 (0.259) loss_u loss_u 0.9697 (0.9650) acc_u 3.1250 (4.3750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [40/40] time 0.344 (0.337) data 0.266 (0.259) loss_u loss_u 0.9951 (0.9644) acc_u 0.0000 (4.3750) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 697
confident_label rate tensor(0.1979, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 323
clean true:266
clean false:57
clean_rate:0.8235294117647058
noisy true:669
noisy false:640
after delete: len(clean_dataset) 323
after delete: len(noisy_dataset) 1309
epoch [19/200] batch [5/10] time 0.341 (0.348) data 0.264 (0.270) loss_x loss_x 0.7085 (0.6565) acc_x 81.2500 (79.3750) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/10] time 0.358 (0.345) data 0.281 (0.268) loss_x loss_x 0.5776 (0.6379) acc_x 90.6250 (83.1250) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/40] time 0.337 (0.342) data 0.259 (0.265) loss_u loss_u 0.9526 (0.9529) acc_u 9.3750 (6.2500) lr 1.9646e-03 eta 0:00:11
epoch [19/200] batch [10/40] time 0.348 (0.341) data 0.271 (0.264) loss_u loss_u 0.9888 (0.9638) acc_u 0.0000 (4.6875) lr 1.9646e-03 eta 0:00:10
epoch [19/200] batch [15/40] time 0.292 (0.337) data 0.213 (0.259) loss_u loss_u 0.9849 (0.9631) acc_u 0.0000 (4.1667) lr 1.9646e-03 eta 0:00:08
epoch [19/200] batch [20/40] time 0.301 (0.330) data 0.223 (0.253) loss_u loss_u 0.9917 (0.9674) acc_u 0.0000 (3.7500) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [25/40] time 0.343 (0.332) data 0.265 (0.254) loss_u loss_u 0.9907 (0.9700) acc_u 0.0000 (3.3750) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [30/40] time 0.356 (0.333) data 0.277 (0.256) loss_u loss_u 0.9858 (0.9680) acc_u 0.0000 (3.7500) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [35/40] time 0.345 (0.334) data 0.267 (0.256) loss_u loss_u 0.9780 (0.9674) acc_u 3.1250 (3.8393) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [40/40] time 0.337 (0.335) data 0.259 (0.257) loss_u loss_u 0.9678 (0.9648) acc_u 6.2500 (4.3750) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 697
confident_label rate tensor(0.1998, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 326
clean true:263
clean false:63
clean_rate:0.8067484662576687
noisy true:672
noisy false:634
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 1306
epoch [20/200] batch [5/10] time 0.337 (0.349) data 0.259 (0.272) loss_x loss_x 0.6016 (0.4929) acc_x 84.3750 (88.1250) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/10] time 0.343 (0.346) data 0.266 (0.268) loss_x loss_x 0.6763 (0.5930) acc_x 81.2500 (86.8750) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/40] time 0.348 (0.342) data 0.270 (0.265) loss_u loss_u 0.9204 (0.9435) acc_u 9.3750 (5.6250) lr 1.9603e-03 eta 0:00:11
epoch [20/200] batch [10/40] time 0.343 (0.342) data 0.265 (0.265) loss_u loss_u 0.9976 (0.9470) acc_u 0.0000 (5.6250) lr 1.9603e-03 eta 0:00:10
epoch [20/200] batch [15/40] time 0.313 (0.340) data 0.234 (0.263) loss_u loss_u 0.9634 (0.9584) acc_u 3.1250 (4.3750) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [20/40] time 0.343 (0.341) data 0.265 (0.263) loss_u loss_u 0.9604 (0.9592) acc_u 3.1250 (4.3750) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [25/40] time 0.334 (0.341) data 0.256 (0.263) loss_u loss_u 0.8882 (0.9559) acc_u 15.6250 (5.0000) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [30/40] time 0.346 (0.342) data 0.269 (0.264) loss_u loss_u 0.9351 (0.9560) acc_u 6.2500 (4.8958) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [35/40] time 0.307 (0.339) data 0.229 (0.262) loss_u loss_u 0.9722 (0.9597) acc_u 3.1250 (4.5536) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [40/40] time 0.343 (0.340) data 0.265 (0.262) loss_u loss_u 0.9375 (0.9597) acc_u 9.3750 (4.5312) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 714
confident_label rate tensor(0.2010, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 328
clean true:254
clean false:74
clean_rate:0.774390243902439
noisy true:664
noisy false:640
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1304
epoch [21/200] batch [5/10] time 0.348 (0.341) data 0.270 (0.264) loss_x loss_x 0.7471 (0.6683) acc_x 81.2500 (83.7500) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/10] time 0.342 (0.345) data 0.265 (0.267) loss_x loss_x 0.5332 (0.6383) acc_x 90.6250 (84.0625) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/40] time 0.350 (0.347) data 0.272 (0.269) loss_u loss_u 0.9927 (0.9618) acc_u 0.0000 (3.7500) lr 1.9558e-03 eta 0:00:12
epoch [21/200] batch [10/40] time 0.338 (0.345) data 0.259 (0.267) loss_u loss_u 0.9985 (0.9670) acc_u 0.0000 (3.4375) lr 1.9558e-03 eta 0:00:10
epoch [21/200] batch [15/40] time 0.336 (0.340) data 0.258 (0.262) loss_u loss_u 0.9648 (0.9683) acc_u 3.1250 (3.7500) lr 1.9558e-03 eta 0:00:08
epoch [21/200] batch [20/40] time 0.352 (0.341) data 0.274 (0.263) loss_u loss_u 0.9683 (0.9675) acc_u 3.1250 (3.7500) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [25/40] time 0.336 (0.341) data 0.258 (0.263) loss_u loss_u 0.9634 (0.9630) acc_u 3.1250 (4.3750) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [30/40] time 0.346 (0.341) data 0.269 (0.264) loss_u loss_u 0.9766 (0.9616) acc_u 3.1250 (4.7917) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [35/40] time 0.346 (0.342) data 0.268 (0.264) loss_u loss_u 0.9634 (0.9604) acc_u 6.2500 (5.0893) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [40/40] time 0.347 (0.342) data 0.270 (0.264) loss_u loss_u 0.9336 (0.9568) acc_u 9.3750 (5.4688) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 702
confident_label rate tensor(0.1985, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 324
clean true:258
clean false:66
clean_rate:0.7962962962962963
noisy true:672
noisy false:636
after delete: len(clean_dataset) 324
after delete: len(noisy_dataset) 1308
epoch [22/200] batch [5/10] time 0.351 (0.339) data 0.274 (0.262) loss_x loss_x 0.4143 (0.4368) acc_x 90.6250 (89.3750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/10] time 0.344 (0.342) data 0.266 (0.264) loss_x loss_x 0.4578 (0.5587) acc_x 90.6250 (86.8750) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/40] time 0.337 (0.340) data 0.260 (0.263) loss_u loss_u 0.9932 (0.9553) acc_u 0.0000 (5.6250) lr 1.9511e-03 eta 0:00:11
epoch [22/200] batch [10/40] time 0.340 (0.340) data 0.262 (0.263) loss_u loss_u 0.9429 (0.9493) acc_u 6.2500 (6.5625) lr 1.9511e-03 eta 0:00:10
epoch [22/200] batch [15/40] time 0.335 (0.338) data 0.256 (0.260) loss_u loss_u 0.9561 (0.9496) acc_u 6.2500 (6.2500) lr 1.9511e-03 eta 0:00:08
epoch [22/200] batch [20/40] time 0.345 (0.335) data 0.266 (0.257) loss_u loss_u 0.9990 (0.9524) acc_u 0.0000 (5.9375) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [25/40] time 0.335 (0.336) data 0.257 (0.258) loss_u loss_u 0.9590 (0.9507) acc_u 3.1250 (6.1250) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [30/40] time 0.351 (0.337) data 0.273 (0.259) loss_u loss_u 0.9375 (0.9537) acc_u 6.2500 (5.7292) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [35/40] time 0.344 (0.337) data 0.266 (0.259) loss_u loss_u 0.9150 (0.9535) acc_u 9.3750 (5.6250) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [40/40] time 0.343 (0.338) data 0.265 (0.260) loss_u loss_u 0.9497 (0.9538) acc_u 9.3750 (5.6250) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 712
confident_label rate tensor(0.2120, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 346
clean true:261
clean false:85
clean_rate:0.7543352601156069
noisy true:659
noisy false:627
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1286
epoch [23/200] batch [5/10] time 0.351 (0.353) data 0.274 (0.276) loss_x loss_x 0.5708 (0.4716) acc_x 81.2500 (88.7500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/10] time 0.334 (0.348) data 0.256 (0.271) loss_x loss_x 0.6899 (0.6118) acc_x 81.2500 (85.0000) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/40] time 0.349 (0.347) data 0.271 (0.269) loss_u loss_u 0.9492 (0.9427) acc_u 6.2500 (6.8750) lr 1.9461e-03 eta 0:00:12
epoch [23/200] batch [10/40] time 0.337 (0.344) data 0.260 (0.267) loss_u loss_u 0.9888 (0.9376) acc_u 0.0000 (7.5000) lr 1.9461e-03 eta 0:00:10
epoch [23/200] batch [15/40] time 0.304 (0.341) data 0.226 (0.263) loss_u loss_u 0.9854 (0.9486) acc_u 0.0000 (6.2500) lr 1.9461e-03 eta 0:00:08
epoch [23/200] batch [20/40] time 0.332 (0.336) data 0.254 (0.259) loss_u loss_u 0.9653 (0.9555) acc_u 3.1250 (5.4688) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [25/40] time 0.342 (0.337) data 0.264 (0.259) loss_u loss_u 0.9595 (0.9549) acc_u 6.2500 (5.5000) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [30/40] time 0.357 (0.339) data 0.279 (0.261) loss_u loss_u 0.9604 (0.9560) acc_u 9.3750 (5.5208) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [35/40] time 0.358 (0.339) data 0.280 (0.261) loss_u loss_u 0.9941 (0.9581) acc_u 0.0000 (5.1786) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [40/40] time 0.350 (0.340) data 0.272 (0.262) loss_u loss_u 0.9761 (0.9567) acc_u 3.1250 (5.3906) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 684
confident_label rate tensor(0.2047, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 334
clean true:258
clean false:76
clean_rate:0.7724550898203593
noisy true:690
noisy false:608
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1298
epoch [24/200] batch [5/10] time 0.346 (0.342) data 0.269 (0.264) loss_x loss_x 0.3140 (0.6362) acc_x 93.7500 (82.5000) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/10] time 0.345 (0.342) data 0.268 (0.265) loss_x loss_x 0.7471 (0.6566) acc_x 90.6250 (84.6875) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/40] time 0.326 (0.338) data 0.248 (0.261) loss_u loss_u 0.9741 (0.9732) acc_u 3.1250 (3.1250) lr 1.9409e-03 eta 0:00:11
epoch [24/200] batch [10/40] time 0.337 (0.337) data 0.259 (0.260) loss_u loss_u 0.9985 (0.9696) acc_u 0.0000 (3.7500) lr 1.9409e-03 eta 0:00:10
epoch [24/200] batch [15/40] time 0.332 (0.337) data 0.254 (0.259) loss_u loss_u 0.9795 (0.9619) acc_u 3.1250 (4.7917) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [20/40] time 0.297 (0.331) data 0.218 (0.253) loss_u loss_u 0.8799 (0.9557) acc_u 12.5000 (5.4688) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [25/40] time 0.299 (0.328) data 0.220 (0.250) loss_u loss_u 0.8950 (0.9500) acc_u 15.6250 (6.2500) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [30/40] time 0.342 (0.325) data 0.265 (0.247) loss_u loss_u 0.9761 (0.9514) acc_u 3.1250 (6.1458) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [35/40] time 0.347 (0.327) data 0.270 (0.249) loss_u loss_u 0.9688 (0.9509) acc_u 6.2500 (6.2500) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [40/40] time 0.336 (0.328) data 0.259 (0.250) loss_u loss_u 0.9585 (0.9477) acc_u 6.2500 (6.6406) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 707
confident_label rate tensor(0.2206, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 360
clean true:262
clean false:98
clean_rate:0.7277777777777777
noisy true:663
noisy false:609
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1272
epoch [25/200] batch [5/11] time 0.342 (0.341) data 0.265 (0.263) loss_x loss_x 0.6987 (0.7415) acc_x 84.3750 (81.8750) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/11] time 0.350 (0.341) data 0.273 (0.264) loss_x loss_x 0.7373 (0.6824) acc_x 87.5000 (83.1250) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/39] time 0.315 (0.336) data 0.236 (0.258) loss_u loss_u 0.9863 (0.9620) acc_u 0.0000 (5.0000) lr 1.9354e-03 eta 0:00:11
epoch [25/200] batch [10/39] time 0.327 (0.335) data 0.248 (0.257) loss_u loss_u 0.9829 (0.9585) acc_u 3.1250 (5.0000) lr 1.9354e-03 eta 0:00:09
epoch [25/200] batch [15/39] time 0.328 (0.336) data 0.251 (0.258) loss_u loss_u 0.9941 (0.9609) acc_u 0.0000 (4.7917) lr 1.9354e-03 eta 0:00:08
epoch [25/200] batch [20/39] time 0.333 (0.335) data 0.255 (0.257) loss_u loss_u 0.9966 (0.9643) acc_u 0.0000 (4.3750) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [25/39] time 0.331 (0.334) data 0.253 (0.256) loss_u loss_u 0.9009 (0.9631) acc_u 12.5000 (4.6250) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [30/39] time 0.310 (0.330) data 0.231 (0.252) loss_u loss_u 0.9668 (0.9646) acc_u 3.1250 (4.4792) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [35/39] time 0.348 (0.331) data 0.270 (0.253) loss_u loss_u 0.9741 (0.9622) acc_u 3.1250 (4.9107) lr 1.9354e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 712
confident_label rate tensor(0.2151, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 351
clean true:250
clean false:101
clean_rate:0.7122507122507122
noisy true:670
noisy false:611
after delete: len(clean_dataset) 351
after delete: len(noisy_dataset) 1281
epoch [26/200] batch [5/10] time 0.345 (0.345) data 0.267 (0.267) loss_x loss_x 0.3040 (0.5694) acc_x 90.6250 (87.5000) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/10] time 0.348 (0.341) data 0.270 (0.263) loss_x loss_x 0.4124 (0.5995) acc_x 90.6250 (86.2500) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/40] time 0.348 (0.341) data 0.270 (0.263) loss_u loss_u 0.9927 (0.9538) acc_u 0.0000 (5.6250) lr 1.9298e-03 eta 0:00:11
epoch [26/200] batch [10/40] time 0.348 (0.342) data 0.270 (0.264) loss_u loss_u 0.9888 (0.9497) acc_u 0.0000 (6.2500) lr 1.9298e-03 eta 0:00:10
epoch [26/200] batch [15/40] time 0.332 (0.342) data 0.255 (0.264) loss_u loss_u 0.9590 (0.9529) acc_u 3.1250 (5.4167) lr 1.9298e-03 eta 0:00:08
epoch [26/200] batch [20/40] time 0.349 (0.341) data 0.272 (0.263) loss_u loss_u 0.9912 (0.9566) acc_u 0.0000 (5.1562) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [25/40] time 0.332 (0.341) data 0.253 (0.263) loss_u loss_u 0.9834 (0.9555) acc_u 3.1250 (5.3750) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [30/40] time 0.350 (0.341) data 0.272 (0.264) loss_u loss_u 0.9390 (0.9512) acc_u 6.2500 (6.0417) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [35/40] time 0.302 (0.338) data 0.223 (0.260) loss_u loss_u 0.9634 (0.9488) acc_u 6.2500 (6.3393) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [40/40] time 0.305 (0.336) data 0.227 (0.258) loss_u loss_u 0.9585 (0.9514) acc_u 3.1250 (5.9375) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 684
confident_label rate tensor(0.2322, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 379
clean true:277
clean false:102
clean_rate:0.7308707124010554
noisy true:671
noisy false:582
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1253
epoch [27/200] batch [5/11] time 0.344 (0.341) data 0.266 (0.263) loss_x loss_x 0.3865 (0.6089) acc_x 87.5000 (83.7500) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/11] time 0.335 (0.341) data 0.257 (0.263) loss_x loss_x 0.8174 (0.6075) acc_x 75.0000 (84.0625) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/39] time 0.334 (0.339) data 0.256 (0.262) loss_u loss_u 0.9165 (0.9519) acc_u 9.3750 (5.6250) lr 1.9239e-03 eta 0:00:11
epoch [27/200] batch [10/39] time 0.343 (0.340) data 0.265 (0.263) loss_u loss_u 0.9351 (0.9610) acc_u 6.2500 (4.3750) lr 1.9239e-03 eta 0:00:09
epoch [27/200] batch [15/39] time 0.337 (0.340) data 0.260 (0.263) loss_u loss_u 0.9155 (0.9574) acc_u 9.3750 (5.0000) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [20/39] time 0.323 (0.339) data 0.246 (0.262) loss_u loss_u 0.9966 (0.9604) acc_u 0.0000 (4.3750) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [25/39] time 0.344 (0.339) data 0.266 (0.261) loss_u loss_u 0.9629 (0.9583) acc_u 6.2500 (4.8750) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [30/39] time 0.346 (0.340) data 0.268 (0.262) loss_u loss_u 0.9985 (0.9598) acc_u 0.0000 (4.6875) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [35/39] time 0.294 (0.335) data 0.215 (0.258) loss_u loss_u 0.9458 (0.9601) acc_u 6.2500 (4.6429) lr 1.9239e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 690
confident_label rate tensor(0.2310, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 377
clean true:268
clean false:109
clean_rate:0.7108753315649867
noisy true:674
noisy false:581
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1255
epoch [28/200] batch [5/11] time 0.337 (0.338) data 0.259 (0.260) loss_x loss_x 0.8779 (0.7718) acc_x 84.3750 (83.1250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/11] time 0.328 (0.339) data 0.251 (0.261) loss_x loss_x 0.5918 (0.6828) acc_x 87.5000 (85.0000) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/39] time 0.335 (0.339) data 0.257 (0.262) loss_u loss_u 0.9663 (0.9584) acc_u 6.2500 (4.3750) lr 1.9178e-03 eta 0:00:11
epoch [28/200] batch [10/39] time 0.337 (0.340) data 0.260 (0.263) loss_u loss_u 0.9365 (0.9500) acc_u 6.2500 (5.9375) lr 1.9178e-03 eta 0:00:09
epoch [28/200] batch [15/39] time 0.344 (0.341) data 0.266 (0.263) loss_u loss_u 0.9043 (0.9476) acc_u 15.6250 (6.6667) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [20/39] time 0.348 (0.341) data 0.269 (0.264) loss_u loss_u 0.9453 (0.9479) acc_u 9.3750 (6.7188) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [25/39] time 0.338 (0.340) data 0.260 (0.263) loss_u loss_u 0.9478 (0.9521) acc_u 9.3750 (6.1250) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [30/39] time 0.336 (0.340) data 0.258 (0.263) loss_u loss_u 0.9590 (0.9520) acc_u 3.1250 (6.0417) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [35/39] time 0.289 (0.338) data 0.210 (0.260) loss_u loss_u 0.9492 (0.9527) acc_u 6.2500 (5.8929) lr 1.9178e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 662
confident_label rate tensor(0.2377, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 388
clean true:271
clean false:117
clean_rate:0.6984536082474226
noisy true:699
noisy false:545
after delete: len(clean_dataset) 388
after delete: len(noisy_dataset) 1244
epoch [29/200] batch [5/12] time 0.351 (0.348) data 0.274 (0.270) loss_x loss_x 0.5576 (0.7642) acc_x 87.5000 (81.8750) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/12] time 0.348 (0.346) data 0.270 (0.268) loss_x loss_x 0.4065 (0.7248) acc_x 87.5000 (81.5625) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/38] time 0.341 (0.341) data 0.263 (0.264) loss_u loss_u 0.9946 (0.9698) acc_u 0.0000 (3.7500) lr 1.9114e-03 eta 0:00:11
epoch [29/200] batch [10/38] time 0.355 (0.342) data 0.277 (0.264) loss_u loss_u 0.9385 (0.9533) acc_u 9.3750 (5.6250) lr 1.9114e-03 eta 0:00:09
epoch [29/200] batch [15/38] time 0.341 (0.340) data 0.263 (0.262) loss_u loss_u 0.9971 (0.9611) acc_u 0.0000 (5.0000) lr 1.9114e-03 eta 0:00:07
epoch [29/200] batch [20/38] time 0.334 (0.340) data 0.256 (0.262) loss_u loss_u 0.9561 (0.9568) acc_u 6.2500 (5.6250) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [25/38] time 0.336 (0.340) data 0.258 (0.262) loss_u loss_u 0.9116 (0.9514) acc_u 12.5000 (6.2500) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [30/38] time 0.351 (0.341) data 0.274 (0.263) loss_u loss_u 0.9722 (0.9542) acc_u 3.1250 (5.8333) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [35/38] time 0.316 (0.338) data 0.237 (0.260) loss_u loss_u 0.9419 (0.9538) acc_u 9.3750 (5.9821) lr 1.9114e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 662
confident_label rate tensor(0.2494, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 407
clean true:282
clean false:125
clean_rate:0.6928746928746928
noisy true:688
noisy false:537
after delete: len(clean_dataset) 407
after delete: len(noisy_dataset) 1225
epoch [30/200] batch [5/12] time 0.342 (0.336) data 0.264 (0.258) loss_x loss_x 0.3923 (0.5931) acc_x 93.7500 (86.2500) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/12] time 0.340 (0.337) data 0.262 (0.260) loss_x loss_x 0.7256 (0.6085) acc_x 87.5000 (85.9375) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/38] time 0.344 (0.340) data 0.267 (0.263) loss_u loss_u 0.9263 (0.9516) acc_u 12.5000 (6.2500) lr 1.9048e-03 eta 0:00:11
epoch [30/200] batch [10/38] time 0.352 (0.341) data 0.275 (0.263) loss_u loss_u 0.9590 (0.9479) acc_u 6.2500 (6.8750) lr 1.9048e-03 eta 0:00:09
epoch [30/200] batch [15/38] time 0.339 (0.341) data 0.261 (0.264) loss_u loss_u 0.9492 (0.9548) acc_u 6.2500 (6.0417) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [20/38] time 0.335 (0.340) data 0.257 (0.262) loss_u loss_u 0.9683 (0.9526) acc_u 6.2500 (6.2500) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [25/38] time 0.342 (0.341) data 0.264 (0.263) loss_u loss_u 0.9771 (0.9601) acc_u 3.1250 (5.2500) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [30/38] time 0.332 (0.340) data 0.255 (0.263) loss_u loss_u 0.9497 (0.9603) acc_u 9.3750 (5.4167) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [35/38] time 0.345 (0.341) data 0.267 (0.263) loss_u loss_u 0.9458 (0.9610) acc_u 6.2500 (5.2679) lr 1.9048e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 685
confident_label rate tensor(0.2420, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 395
clean true:277
clean false:118
clean_rate:0.7012658227848101
noisy true:670
noisy false:567
after delete: len(clean_dataset) 395
after delete: len(noisy_dataset) 1237
epoch [31/200] batch [5/12] time 0.336 (0.354) data 0.259 (0.277) loss_x loss_x 0.9629 (0.6392) acc_x 84.3750 (84.3750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/12] time 0.337 (0.350) data 0.259 (0.272) loss_x loss_x 0.3794 (0.5992) acc_x 93.7500 (86.2500) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/38] time 0.339 (0.342) data 0.261 (0.264) loss_u loss_u 0.9380 (0.9544) acc_u 6.2500 (5.0000) lr 1.8980e-03 eta 0:00:11
epoch [31/200] batch [10/38] time 0.328 (0.340) data 0.250 (0.263) loss_u loss_u 0.9268 (0.9587) acc_u 12.5000 (5.0000) lr 1.8980e-03 eta 0:00:09
epoch [31/200] batch [15/38] time 0.348 (0.340) data 0.270 (0.262) loss_u loss_u 0.9282 (0.9592) acc_u 9.3750 (5.0000) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [20/38] time 0.333 (0.340) data 0.255 (0.262) loss_u loss_u 0.9619 (0.9631) acc_u 3.1250 (4.3750) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [25/38] time 0.331 (0.338) data 0.253 (0.260) loss_u loss_u 0.9800 (0.9603) acc_u 0.0000 (4.7500) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [30/38] time 0.327 (0.338) data 0.249 (0.260) loss_u loss_u 0.9146 (0.9569) acc_u 12.5000 (5.2083) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [35/38] time 0.334 (0.338) data 0.255 (0.260) loss_u loss_u 0.9658 (0.9548) acc_u 3.1250 (5.5357) lr 1.8980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 686
confident_label rate tensor(0.2365, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 386
clean true:266
clean false:120
clean_rate:0.689119170984456
noisy true:680
noisy false:566
after delete: len(clean_dataset) 386
after delete: len(noisy_dataset) 1246
epoch [32/200] batch [5/12] time 0.332 (0.343) data 0.254 (0.266) loss_x loss_x 0.6763 (0.4081) acc_x 78.1250 (89.3750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/12] time 0.351 (0.343) data 0.274 (0.265) loss_x loss_x 0.1968 (0.4450) acc_x 96.8750 (88.4375) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/38] time 0.348 (0.340) data 0.270 (0.262) loss_u loss_u 0.9404 (0.9325) acc_u 6.2500 (8.7500) lr 1.8910e-03 eta 0:00:11
epoch [32/200] batch [10/38] time 0.333 (0.341) data 0.255 (0.264) loss_u loss_u 0.9751 (0.9512) acc_u 3.1250 (6.8750) lr 1.8910e-03 eta 0:00:09
epoch [32/200] batch [15/38] time 0.338 (0.341) data 0.260 (0.264) loss_u loss_u 0.9565 (0.9545) acc_u 6.2500 (6.2500) lr 1.8910e-03 eta 0:00:07
epoch [32/200] batch [20/38] time 0.345 (0.341) data 0.268 (0.263) loss_u loss_u 0.9419 (0.9539) acc_u 6.2500 (5.9375) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [25/38] time 0.341 (0.340) data 0.264 (0.263) loss_u loss_u 0.9712 (0.9527) acc_u 6.2500 (6.1250) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [30/38] time 0.342 (0.339) data 0.264 (0.262) loss_u loss_u 0.9873 (0.9524) acc_u 0.0000 (6.0417) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [35/38] time 0.297 (0.337) data 0.219 (0.260) loss_u loss_u 0.9102 (0.9529) acc_u 12.5000 (5.9821) lr 1.8910e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 698
confident_label rate tensor(0.2439, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 398
clean true:266
clean false:132
clean_rate:0.6683417085427136
noisy true:668
noisy false:566
after delete: len(clean_dataset) 398
after delete: len(noisy_dataset) 1234
epoch [33/200] batch [5/12] time 0.348 (0.350) data 0.271 (0.272) loss_x loss_x 0.3384 (0.6386) acc_x 90.6250 (91.2500) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/12] time 0.341 (0.351) data 0.264 (0.273) loss_x loss_x 0.8682 (0.5490) acc_x 78.1250 (90.3125) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/38] time 0.354 (0.350) data 0.276 (0.272) loss_u loss_u 0.9751 (0.9823) acc_u 3.1250 (1.8750) lr 1.8838e-03 eta 0:00:11
epoch [33/200] batch [10/38] time 0.334 (0.348) data 0.257 (0.271) loss_u loss_u 0.9653 (0.9791) acc_u 3.1250 (2.5000) lr 1.8838e-03 eta 0:00:09
epoch [33/200] batch [15/38] time 0.324 (0.346) data 0.246 (0.269) loss_u loss_u 0.9180 (0.9665) acc_u 9.3750 (3.9583) lr 1.8838e-03 eta 0:00:07
epoch [33/200] batch [20/38] time 0.349 (0.346) data 0.271 (0.268) loss_u loss_u 0.8882 (0.9613) acc_u 15.6250 (5.0000) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [25/38] time 0.331 (0.344) data 0.253 (0.266) loss_u loss_u 0.9209 (0.9606) acc_u 12.5000 (5.0000) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [30/38] time 0.337 (0.343) data 0.259 (0.266) loss_u loss_u 0.9546 (0.9581) acc_u 6.2500 (5.2083) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [35/38] time 0.308 (0.340) data 0.230 (0.262) loss_u loss_u 0.9775 (0.9542) acc_u 3.1250 (5.7143) lr 1.8838e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 681
confident_label rate tensor(0.2384, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 389
clean true:267
clean false:122
clean_rate:0.6863753213367609
noisy true:684
noisy false:559
after delete: len(clean_dataset) 389
after delete: len(noisy_dataset) 1243
epoch [34/200] batch [5/12] time 0.335 (0.346) data 0.256 (0.268) loss_x loss_x 0.9341 (0.5448) acc_x 81.2500 (86.8750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/12] time 0.332 (0.341) data 0.254 (0.263) loss_x loss_x 0.5522 (0.5395) acc_x 90.6250 (87.8125) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/38] time 0.330 (0.337) data 0.252 (0.259) loss_u loss_u 0.9390 (0.9399) acc_u 6.2500 (7.5000) lr 1.8763e-03 eta 0:00:11
epoch [34/200] batch [10/38] time 0.334 (0.338) data 0.256 (0.260) loss_u loss_u 0.9980 (0.9463) acc_u 0.0000 (7.1875) lr 1.8763e-03 eta 0:00:09
epoch [34/200] batch [15/38] time 0.330 (0.337) data 0.252 (0.260) loss_u loss_u 0.9595 (0.9497) acc_u 6.2500 (6.4583) lr 1.8763e-03 eta 0:00:07
epoch [34/200] batch [20/38] time 0.341 (0.337) data 0.264 (0.259) loss_u loss_u 0.8755 (0.9465) acc_u 15.6250 (6.7188) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [25/38] time 0.334 (0.337) data 0.256 (0.259) loss_u loss_u 0.9941 (0.9544) acc_u 0.0000 (5.7500) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [30/38] time 0.336 (0.336) data 0.258 (0.258) loss_u loss_u 0.9966 (0.9534) acc_u 0.0000 (5.8333) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [35/38] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9404 (0.9485) acc_u 6.2500 (6.3393) lr 1.8763e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 715
confident_label rate tensor(0.2377, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 388
clean true:255
clean false:133
clean_rate:0.6572164948453608
noisy true:662
noisy false:582
after delete: len(clean_dataset) 388
after delete: len(noisy_dataset) 1244
epoch [35/200] batch [5/12] time 0.346 (0.330) data 0.268 (0.253) loss_x loss_x 0.6089 (0.5217) acc_x 81.2500 (87.5000) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/12] time 0.342 (0.342) data 0.265 (0.265) loss_x loss_x 0.3718 (0.4953) acc_x 90.6250 (87.1875) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/38] time 0.325 (0.341) data 0.247 (0.264) loss_u loss_u 0.9600 (0.9241) acc_u 6.2500 (10.0000) lr 1.8686e-03 eta 0:00:11
epoch [35/200] batch [10/38] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9434 (0.9227) acc_u 9.3750 (10.3125) lr 1.8686e-03 eta 0:00:09
epoch [35/200] batch [15/38] time 0.359 (0.339) data 0.282 (0.262) loss_u loss_u 0.9814 (0.9285) acc_u 3.1250 (9.3750) lr 1.8686e-03 eta 0:00:07
epoch [35/200] batch [20/38] time 0.327 (0.337) data 0.249 (0.260) loss_u loss_u 0.9360 (0.9317) acc_u 9.3750 (8.7500) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [25/38] time 0.309 (0.334) data 0.230 (0.256) loss_u loss_u 0.9604 (0.9343) acc_u 6.2500 (8.5000) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [30/38] time 0.347 (0.333) data 0.269 (0.255) loss_u loss_u 0.9395 (0.9393) acc_u 9.3750 (7.8125) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [35/38] time 0.349 (0.334) data 0.271 (0.256) loss_u loss_u 0.9663 (0.9414) acc_u 3.1250 (7.5000) lr 1.8686e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 680
confident_label rate tensor(0.2482, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 405
clean true:275
clean false:130
clean_rate:0.6790123456790124
noisy true:677
noisy false:550
after delete: len(clean_dataset) 405
after delete: len(noisy_dataset) 1227
epoch [36/200] batch [5/12] time 0.350 (0.342) data 0.273 (0.265) loss_x loss_x 0.4609 (0.5032) acc_x 84.3750 (88.7500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/12] time 0.343 (0.341) data 0.266 (0.263) loss_x loss_x 0.5815 (0.5106) acc_x 81.2500 (86.8750) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/38] time 0.317 (0.338) data 0.239 (0.261) loss_u loss_u 0.9673 (0.9719) acc_u 3.1250 (3.1250) lr 1.8607e-03 eta 0:00:11
epoch [36/200] batch [10/38] time 0.336 (0.337) data 0.257 (0.260) loss_u loss_u 0.9380 (0.9625) acc_u 9.3750 (4.3750) lr 1.8607e-03 eta 0:00:09
epoch [36/200] batch [15/38] time 0.330 (0.337) data 0.252 (0.259) loss_u loss_u 0.9824 (0.9643) acc_u 3.1250 (4.5833) lr 1.8607e-03 eta 0:00:07
epoch [36/200] batch [20/38] time 0.352 (0.338) data 0.275 (0.260) loss_u loss_u 0.9619 (0.9554) acc_u 6.2500 (5.4688) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [25/38] time 0.302 (0.337) data 0.223 (0.259) loss_u loss_u 0.9146 (0.9562) acc_u 9.3750 (5.3750) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [30/38] time 0.351 (0.335) data 0.274 (0.257) loss_u loss_u 0.8745 (0.9498) acc_u 15.6250 (6.1458) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [35/38] time 0.348 (0.336) data 0.270 (0.258) loss_u loss_u 0.9897 (0.9488) acc_u 0.0000 (6.1607) lr 1.8607e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 696
confident_label rate tensor(0.2414, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 394
clean true:263
clean false:131
clean_rate:0.6675126903553299
noisy true:673
noisy false:565
after delete: len(clean_dataset) 394
after delete: len(noisy_dataset) 1238
epoch [37/200] batch [5/12] time 0.317 (0.344) data 0.240 (0.267) loss_x loss_x 0.5356 (0.3402) acc_x 87.5000 (93.7500) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/12] time 0.342 (0.341) data 0.265 (0.264) loss_x loss_x 0.4885 (0.4160) acc_x 84.3750 (90.6250) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/38] time 0.326 (0.339) data 0.248 (0.262) loss_u loss_u 0.9678 (0.9612) acc_u 3.1250 (5.0000) lr 1.8526e-03 eta 0:00:11
epoch [37/200] batch [10/38] time 0.340 (0.339) data 0.262 (0.262) loss_u loss_u 0.9956 (0.9603) acc_u 0.0000 (4.6875) lr 1.8526e-03 eta 0:00:09
epoch [37/200] batch [15/38] time 0.336 (0.339) data 0.258 (0.261) loss_u loss_u 0.9238 (0.9509) acc_u 6.2500 (5.4167) lr 1.8526e-03 eta 0:00:07
epoch [37/200] batch [20/38] time 0.341 (0.339) data 0.263 (0.261) loss_u loss_u 0.9404 (0.9550) acc_u 6.2500 (5.1562) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [25/38] time 0.346 (0.339) data 0.269 (0.261) loss_u loss_u 0.9443 (0.9573) acc_u 6.2500 (4.8750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [30/38] time 0.295 (0.334) data 0.216 (0.256) loss_u loss_u 0.9771 (0.9532) acc_u 3.1250 (5.3125) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [35/38] time 0.348 (0.334) data 0.271 (0.256) loss_u loss_u 0.8525 (0.9496) acc_u 18.7500 (5.9821) lr 1.8526e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 669
confident_label rate tensor(0.2463, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 402
clean true:273
clean false:129
clean_rate:0.6791044776119403
noisy true:690
noisy false:540
after delete: len(clean_dataset) 402
after delete: len(noisy_dataset) 1230
epoch [38/200] batch [5/12] time 0.350 (0.347) data 0.273 (0.270) loss_x loss_x 0.2969 (0.4713) acc_x 90.6250 (86.8750) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/12] time 0.345 (0.347) data 0.268 (0.270) loss_x loss_x 0.4597 (0.4688) acc_x 96.8750 (88.4375) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/38] time 0.340 (0.346) data 0.262 (0.268) loss_u loss_u 0.9854 (0.9545) acc_u 3.1250 (6.2500) lr 1.8443e-03 eta 0:00:11
epoch [38/200] batch [10/38] time 0.344 (0.345) data 0.267 (0.267) loss_u loss_u 0.9673 (0.9502) acc_u 6.2500 (6.2500) lr 1.8443e-03 eta 0:00:09
epoch [38/200] batch [15/38] time 0.333 (0.343) data 0.255 (0.266) loss_u loss_u 0.9575 (0.9501) acc_u 6.2500 (6.0417) lr 1.8443e-03 eta 0:00:07
epoch [38/200] batch [20/38] time 0.338 (0.338) data 0.260 (0.261) loss_u loss_u 0.9136 (0.9503) acc_u 9.3750 (5.9375) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [25/38] time 0.331 (0.338) data 0.254 (0.261) loss_u loss_u 0.9819 (0.9536) acc_u 3.1250 (5.6250) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [30/38] time 0.314 (0.337) data 0.235 (0.259) loss_u loss_u 0.9961 (0.9524) acc_u 0.0000 (5.7292) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [35/38] time 0.348 (0.336) data 0.270 (0.258) loss_u loss_u 0.9238 (0.9534) acc_u 9.3750 (5.5357) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 683
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 409
clean true:272
clean false:137
clean_rate:0.6650366748166259
noisy true:677
noisy false:546
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1223
epoch [39/200] batch [5/12] time 0.351 (0.349) data 0.274 (0.271) loss_x loss_x 0.4294 (0.4040) acc_x 87.5000 (91.2500) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/12] time 0.344 (0.347) data 0.267 (0.270) loss_x loss_x 0.7734 (0.4272) acc_x 78.1250 (89.6875) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/38] time 0.347 (0.344) data 0.270 (0.267) loss_u loss_u 0.9453 (0.9582) acc_u 6.2500 (5.0000) lr 1.8358e-03 eta 0:00:11
epoch [39/200] batch [10/38] time 0.342 (0.344) data 0.264 (0.267) loss_u loss_u 0.9639 (0.9573) acc_u 3.1250 (5.0000) lr 1.8358e-03 eta 0:00:09
epoch [39/200] batch [15/38] time 0.345 (0.343) data 0.266 (0.265) loss_u loss_u 0.9868 (0.9564) acc_u 3.1250 (5.2083) lr 1.8358e-03 eta 0:00:07
epoch [39/200] batch [20/38] time 0.341 (0.342) data 0.263 (0.265) loss_u loss_u 0.9922 (0.9571) acc_u 0.0000 (5.0000) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [25/38] time 0.335 (0.342) data 0.257 (0.264) loss_u loss_u 0.9678 (0.9578) acc_u 3.1250 (5.0000) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [30/38] time 0.340 (0.341) data 0.262 (0.264) loss_u loss_u 0.9775 (0.9583) acc_u 3.1250 (5.0000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [35/38] time 0.301 (0.337) data 0.222 (0.260) loss_u loss_u 0.9307 (0.9565) acc_u 6.2500 (5.0893) lr 1.8358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 690
confident_label rate tensor(0.2414, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 394
clean true:263
clean false:131
clean_rate:0.6675126903553299
noisy true:679
noisy false:559
after delete: len(clean_dataset) 394
after delete: len(noisy_dataset) 1238
epoch [40/200] batch [5/12] time 0.295 (0.320) data 0.218 (0.243) loss_x loss_x 0.7393 (0.6275) acc_x 78.1250 (84.3750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/12] time 0.345 (0.322) data 0.268 (0.244) loss_x loss_x 0.6831 (0.5660) acc_x 84.3750 (86.5625) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/38] time 0.337 (0.331) data 0.259 (0.253) loss_u loss_u 0.9922 (0.9684) acc_u 0.0000 (3.7500) lr 1.8271e-03 eta 0:00:10
epoch [40/200] batch [10/38] time 0.343 (0.334) data 0.265 (0.256) loss_u loss_u 0.9092 (0.9604) acc_u 9.3750 (4.6875) lr 1.8271e-03 eta 0:00:09
epoch [40/200] batch [15/38] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.9399 (0.9529) acc_u 9.3750 (5.8333) lr 1.8271e-03 eta 0:00:07
epoch [40/200] batch [20/38] time 0.343 (0.336) data 0.266 (0.258) loss_u loss_u 0.9912 (0.9571) acc_u 0.0000 (5.1562) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [25/38] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9707 (0.9538) acc_u 3.1250 (5.3750) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [30/38] time 0.341 (0.335) data 0.263 (0.257) loss_u loss_u 0.9580 (0.9527) acc_u 3.1250 (5.6250) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [35/38] time 0.316 (0.334) data 0.236 (0.256) loss_u loss_u 0.9277 (0.9513) acc_u 9.3750 (5.6250) lr 1.8271e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 679
confident_label rate tensor(0.2610, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 426
clean true:282
clean false:144
clean_rate:0.6619718309859155
noisy true:671
noisy false:535
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1206
epoch [41/200] batch [5/13] time 0.348 (0.349) data 0.271 (0.271) loss_x loss_x 0.4246 (0.4980) acc_x 90.6250 (88.1250) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/13] time 0.317 (0.335) data 0.240 (0.258) loss_x loss_x 0.4729 (0.4214) acc_x 84.3750 (89.6875) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [5/37] time 0.337 (0.340) data 0.259 (0.263) loss_u loss_u 0.9927 (0.9684) acc_u 3.1250 (4.3750) lr 1.8181e-03 eta 0:00:10
epoch [41/200] batch [10/37] time 0.329 (0.340) data 0.251 (0.262) loss_u loss_u 0.9575 (0.9665) acc_u 9.3750 (4.6875) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [15/37] time 0.322 (0.337) data 0.244 (0.260) loss_u loss_u 0.9258 (0.9627) acc_u 9.3750 (5.0000) lr 1.8181e-03 eta 0:00:07
epoch [41/200] batch [20/37] time 0.322 (0.337) data 0.245 (0.259) loss_u loss_u 0.9414 (0.9655) acc_u 6.2500 (4.5312) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [25/37] time 0.362 (0.337) data 0.285 (0.260) loss_u loss_u 0.9995 (0.9679) acc_u 0.0000 (4.1250) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [30/37] time 0.348 (0.338) data 0.270 (0.260) loss_u loss_u 0.9727 (0.9685) acc_u 3.1250 (3.9583) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [35/37] time 0.343 (0.338) data 0.265 (0.261) loss_u loss_u 0.9561 (0.9666) acc_u 6.2500 (4.1071) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 680
confident_label rate tensor(0.2537, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 414
clean true:284
clean false:130
clean_rate:0.6859903381642513
noisy true:668
noisy false:550
after delete: len(clean_dataset) 414
after delete: len(noisy_dataset) 1218
epoch [42/200] batch [5/12] time 0.352 (0.359) data 0.273 (0.281) loss_x loss_x 0.5469 (0.3795) acc_x 90.6250 (92.5000) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/12] time 0.349 (0.346) data 0.270 (0.267) loss_x loss_x 0.4817 (0.3988) acc_x 93.7500 (90.6250) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/38] time 0.366 (0.359) data 0.287 (0.280) loss_u loss_u 0.9521 (0.9706) acc_u 9.3750 (3.7500) lr 1.8090e-03 eta 0:00:11
epoch [42/200] batch [10/38] time 0.367 (0.362) data 0.288 (0.284) loss_u loss_u 0.9956 (0.9715) acc_u 0.0000 (3.1250) lr 1.8090e-03 eta 0:00:10
epoch [42/200] batch [15/38] time 0.322 (0.358) data 0.244 (0.280) loss_u loss_u 0.9756 (0.9664) acc_u 3.1250 (3.9583) lr 1.8090e-03 eta 0:00:08
epoch [42/200] batch [20/38] time 0.339 (0.356) data 0.260 (0.277) loss_u loss_u 0.9902 (0.9631) acc_u 3.1250 (4.2188) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [25/38] time 0.335 (0.353) data 0.256 (0.274) loss_u loss_u 0.9229 (0.9596) acc_u 9.3750 (4.6250) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [30/38] time 0.352 (0.351) data 0.273 (0.273) loss_u loss_u 0.9692 (0.9581) acc_u 3.1250 (4.8958) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [35/38] time 0.364 (0.351) data 0.286 (0.273) loss_u loss_u 0.9805 (0.9586) acc_u 6.2500 (4.9107) lr 1.8090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 677
confident_label rate tensor(0.2475, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 404
clean true:272
clean false:132
clean_rate:0.6732673267326733
noisy true:683
noisy false:545
after delete: len(clean_dataset) 404
after delete: len(noisy_dataset) 1228
epoch [43/200] batch [5/12] time 0.304 (0.340) data 0.226 (0.263) loss_x loss_x 0.5464 (0.3863) acc_x 87.5000 (91.2500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/12] time 0.328 (0.324) data 0.250 (0.247) loss_x loss_x 0.4573 (0.3993) acc_x 90.6250 (91.2500) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/38] time 0.340 (0.332) data 0.262 (0.254) loss_u loss_u 0.9375 (0.9580) acc_u 6.2500 (4.3750) lr 1.7997e-03 eta 0:00:10
epoch [43/200] batch [10/38] time 0.333 (0.335) data 0.255 (0.257) loss_u loss_u 0.9111 (0.9517) acc_u 9.3750 (5.0000) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [15/38] time 0.338 (0.334) data 0.260 (0.256) loss_u loss_u 0.9336 (0.9515) acc_u 9.3750 (5.2083) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [20/38] time 0.346 (0.336) data 0.268 (0.258) loss_u loss_u 0.9590 (0.9467) acc_u 6.2500 (5.9375) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [25/38] time 0.356 (0.338) data 0.278 (0.260) loss_u loss_u 0.9634 (0.9504) acc_u 3.1250 (5.5000) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [30/38] time 0.341 (0.339) data 0.263 (0.262) loss_u loss_u 0.9824 (0.9525) acc_u 3.1250 (5.3125) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [35/38] time 0.353 (0.341) data 0.275 (0.263) loss_u loss_u 0.9512 (0.9498) acc_u 6.2500 (5.7143) lr 1.7997e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 706
confident_label rate tensor(0.2574, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 420
clean true:267
clean false:153
clean_rate:0.6357142857142857
noisy true:659
noisy false:553
after delete: len(clean_dataset) 420
after delete: len(noisy_dataset) 1212
epoch [44/200] batch [5/13] time 0.345 (0.325) data 0.268 (0.247) loss_x loss_x 0.5410 (0.4789) acc_x 87.5000 (88.7500) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/13] time 0.305 (0.332) data 0.227 (0.254) loss_x loss_x 1.0557 (0.5534) acc_x 78.1250 (87.1875) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/37] time 0.331 (0.329) data 0.254 (0.251) loss_u loss_u 0.9736 (0.9706) acc_u 3.1250 (3.7500) lr 1.7902e-03 eta 0:00:10
epoch [44/200] batch [10/37] time 0.347 (0.332) data 0.269 (0.255) loss_u loss_u 0.9365 (0.9519) acc_u 6.2500 (5.6250) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [15/37] time 0.332 (0.334) data 0.255 (0.256) loss_u loss_u 0.9971 (0.9502) acc_u 0.0000 (5.8333) lr 1.7902e-03 eta 0:00:07
epoch [44/200] batch [20/37] time 0.359 (0.337) data 0.281 (0.259) loss_u loss_u 0.9604 (0.9561) acc_u 3.1250 (5.0000) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [25/37] time 0.336 (0.338) data 0.259 (0.260) loss_u loss_u 0.9531 (0.9561) acc_u 6.2500 (5.0000) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [30/37] time 0.353 (0.339) data 0.274 (0.261) loss_u loss_u 0.9658 (0.9554) acc_u 6.2500 (5.2083) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [35/37] time 0.341 (0.338) data 0.264 (0.261) loss_u loss_u 0.9644 (0.9534) acc_u 6.2500 (5.4464) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 692
confident_label rate tensor(0.2586, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 422
clean true:272
clean false:150
clean_rate:0.6445497630331753
noisy true:668
noisy false:542
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1210
epoch [45/200] batch [5/13] time 0.332 (0.334) data 0.254 (0.257) loss_x loss_x 0.4783 (0.4021) acc_x 90.6250 (91.2500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/13] time 0.331 (0.331) data 0.253 (0.253) loss_x loss_x 0.8989 (0.4774) acc_x 90.6250 (90.6250) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/37] time 0.334 (0.333) data 0.256 (0.255) loss_u loss_u 0.9688 (0.9446) acc_u 6.2500 (6.2500) lr 1.7804e-03 eta 0:00:10
epoch [45/200] batch [10/37] time 0.335 (0.333) data 0.257 (0.255) loss_u loss_u 0.9570 (0.9560) acc_u 3.1250 (5.0000) lr 1.7804e-03 eta 0:00:08
epoch [45/200] batch [15/37] time 0.330 (0.335) data 0.252 (0.258) loss_u loss_u 0.9990 (0.9569) acc_u 0.0000 (5.4167) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [20/37] time 0.344 (0.337) data 0.266 (0.260) loss_u loss_u 0.9385 (0.9551) acc_u 6.2500 (5.6250) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [25/37] time 0.357 (0.339) data 0.280 (0.261) loss_u loss_u 0.9683 (0.9592) acc_u 3.1250 (5.0000) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [30/37] time 0.346 (0.339) data 0.268 (0.261) loss_u loss_u 0.9858 (0.9585) acc_u 0.0000 (4.8958) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [35/37] time 0.344 (0.338) data 0.266 (0.261) loss_u loss_u 0.9893 (0.9583) acc_u 0.0000 (4.9107) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 708
confident_label rate tensor(0.2641, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 431
clean true:268
clean false:163
clean_rate:0.6218097447795824
noisy true:656
noisy false:545
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1201
epoch [46/200] batch [5/13] time 0.336 (0.326) data 0.258 (0.248) loss_x loss_x 0.4531 (0.5540) acc_x 87.5000 (86.2500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/13] time 0.345 (0.334) data 0.268 (0.256) loss_x loss_x 0.5332 (0.5724) acc_x 90.6250 (85.6250) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [5/37] time 0.346 (0.337) data 0.269 (0.259) loss_u loss_u 0.9702 (0.9239) acc_u 3.1250 (8.7500) lr 1.7705e-03 eta 0:00:10
epoch [46/200] batch [10/37] time 0.329 (0.338) data 0.251 (0.260) loss_u loss_u 0.9761 (0.9505) acc_u 3.1250 (5.6250) lr 1.7705e-03 eta 0:00:09
epoch [46/200] batch [15/37] time 0.341 (0.337) data 0.263 (0.260) loss_u loss_u 0.9517 (0.9531) acc_u 6.2500 (5.4167) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [20/37] time 0.336 (0.338) data 0.258 (0.260) loss_u loss_u 0.9741 (0.9547) acc_u 3.1250 (5.3125) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [25/37] time 0.341 (0.338) data 0.264 (0.260) loss_u loss_u 0.9722 (0.9543) acc_u 3.1250 (5.5000) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [30/37] time 0.339 (0.337) data 0.262 (0.260) loss_u loss_u 0.9819 (0.9572) acc_u 3.1250 (5.1042) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [35/37] time 0.321 (0.338) data 0.243 (0.260) loss_u loss_u 0.9863 (0.9546) acc_u 3.1250 (5.5357) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 678
confident_label rate tensor(0.2518, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 411
clean true:266
clean false:145
clean_rate:0.6472019464720195
noisy true:688
noisy false:533
after delete: len(clean_dataset) 411
after delete: len(noisy_dataset) 1221
epoch [47/200] batch [5/12] time 0.296 (0.311) data 0.218 (0.233) loss_x loss_x 0.5186 (0.6135) acc_x 87.5000 (86.2500) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/12] time 0.329 (0.324) data 0.251 (0.246) loss_x loss_x 0.4890 (0.5509) acc_x 84.3750 (87.1875) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/38] time 0.321 (0.329) data 0.242 (0.251) loss_u loss_u 0.9565 (0.9542) acc_u 6.2500 (5.0000) lr 1.7604e-03 eta 0:00:10
epoch [47/200] batch [10/38] time 0.338 (0.331) data 0.260 (0.253) loss_u loss_u 0.9434 (0.9464) acc_u 6.2500 (6.8750) lr 1.7604e-03 eta 0:00:09
epoch [47/200] batch [15/38] time 0.335 (0.334) data 0.257 (0.256) loss_u loss_u 0.9189 (0.9533) acc_u 9.3750 (6.0417) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [20/38] time 0.335 (0.334) data 0.257 (0.256) loss_u loss_u 0.9902 (0.9509) acc_u 0.0000 (6.2500) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [25/38] time 0.344 (0.335) data 0.266 (0.257) loss_u loss_u 0.9395 (0.9498) acc_u 6.2500 (6.3750) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [30/38] time 0.348 (0.336) data 0.270 (0.258) loss_u loss_u 0.9004 (0.9498) acc_u 12.5000 (6.4583) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [35/38] time 0.345 (0.337) data 0.268 (0.259) loss_u loss_u 0.9971 (0.9505) acc_u 0.0000 (6.4286) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 705
confident_label rate tensor(0.2592, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 423
clean true:267
clean false:156
clean_rate:0.6312056737588653
noisy true:660
noisy false:549
after delete: len(clean_dataset) 423
after delete: len(noisy_dataset) 1209
epoch [48/200] batch [5/13] time 0.345 (0.344) data 0.268 (0.266) loss_x loss_x 0.5000 (0.3592) acc_x 84.3750 (90.6250) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/13] time 0.298 (0.339) data 0.220 (0.261) loss_x loss_x 0.3323 (0.3399) acc_x 90.6250 (91.8750) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [5/37] time 0.318 (0.331) data 0.240 (0.253) loss_u loss_u 0.9678 (0.9435) acc_u 3.1250 (6.8750) lr 1.7501e-03 eta 0:00:10
epoch [48/200] batch [10/37] time 0.329 (0.333) data 0.251 (0.255) loss_u loss_u 0.9009 (0.9362) acc_u 9.3750 (7.1875) lr 1.7501e-03 eta 0:00:08
epoch [48/200] batch [15/37] time 0.335 (0.335) data 0.257 (0.257) loss_u loss_u 0.9663 (0.9467) acc_u 3.1250 (6.0417) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [20/37] time 0.338 (0.335) data 0.260 (0.258) loss_u loss_u 0.9775 (0.9530) acc_u 3.1250 (5.3125) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [25/37] time 0.334 (0.335) data 0.257 (0.258) loss_u loss_u 0.9961 (0.9542) acc_u 0.0000 (5.2500) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [30/37] time 0.340 (0.336) data 0.263 (0.258) loss_u loss_u 0.9829 (0.9537) acc_u 3.1250 (5.4167) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [35/37] time 0.343 (0.336) data 0.266 (0.258) loss_u loss_u 0.9873 (0.9551) acc_u 0.0000 (5.0893) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 693
confident_label rate tensor(0.2574, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 420
clean true:271
clean false:149
clean_rate:0.6452380952380953
noisy true:668
noisy false:544
after delete: len(clean_dataset) 420
after delete: len(noisy_dataset) 1212
epoch [49/200] batch [5/13] time 0.341 (0.349) data 0.263 (0.271) loss_x loss_x 0.2429 (0.3971) acc_x 100.0000 (90.0000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/13] time 0.329 (0.338) data 0.252 (0.260) loss_x loss_x 0.2327 (0.4250) acc_x 93.7500 (89.0625) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [5/37] time 0.373 (0.336) data 0.294 (0.258) loss_u loss_u 0.9272 (0.9509) acc_u 9.3750 (5.6250) lr 1.7396e-03 eta 0:00:10
epoch [49/200] batch [10/37] time 0.335 (0.339) data 0.256 (0.261) loss_u loss_u 0.9565 (0.9596) acc_u 6.2500 (5.0000) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [15/37] time 0.343 (0.340) data 0.266 (0.262) loss_u loss_u 0.9370 (0.9506) acc_u 9.3750 (6.2500) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [20/37] time 0.344 (0.340) data 0.267 (0.262) loss_u loss_u 0.9634 (0.9511) acc_u 3.1250 (6.0938) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [25/37] time 0.347 (0.341) data 0.269 (0.262) loss_u loss_u 0.9409 (0.9511) acc_u 6.2500 (5.8750) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [30/37] time 0.357 (0.341) data 0.279 (0.263) loss_u loss_u 0.9536 (0.9509) acc_u 9.3750 (6.0417) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [35/37] time 0.329 (0.341) data 0.251 (0.263) loss_u loss_u 0.8857 (0.9488) acc_u 15.6250 (6.3393) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 724
confident_label rate tensor(0.2635, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 430
clean true:271
clean false:159
clean_rate:0.6302325581395349
noisy true:637
noisy false:565
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1202
epoch [50/200] batch [5/13] time 0.360 (0.350) data 0.282 (0.272) loss_x loss_x 0.5220 (0.6216) acc_x 90.6250 (85.6250) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/13] time 0.304 (0.336) data 0.226 (0.259) loss_x loss_x 0.3374 (0.5286) acc_x 90.6250 (87.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [5/37] time 0.325 (0.330) data 0.247 (0.253) loss_u loss_u 0.9155 (0.9625) acc_u 12.5000 (5.6250) lr 1.7290e-03 eta 0:00:10
epoch [50/200] batch [10/37] time 0.332 (0.330) data 0.254 (0.253) loss_u loss_u 0.9634 (0.9667) acc_u 3.1250 (4.0625) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [15/37] time 0.336 (0.331) data 0.258 (0.253) loss_u loss_u 0.9419 (0.9626) acc_u 6.2500 (4.7917) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [20/37] time 0.349 (0.333) data 0.271 (0.255) loss_u loss_u 0.9653 (0.9613) acc_u 3.1250 (4.8438) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [25/37] time 0.338 (0.335) data 0.260 (0.257) loss_u loss_u 0.9565 (0.9583) acc_u 6.2500 (5.1250) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [30/37] time 0.328 (0.336) data 0.250 (0.258) loss_u loss_u 0.9702 (0.9568) acc_u 3.1250 (5.3125) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [35/37] time 0.340 (0.336) data 0.262 (0.258) loss_u loss_u 0.9043 (0.9548) acc_u 12.5000 (5.6250) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 721
confident_label rate tensor(0.2574, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 420
clean true:275
clean false:145
clean_rate:0.6547619047619048
noisy true:636
noisy false:576
after delete: len(clean_dataset) 420
after delete: len(noisy_dataset) 1212
epoch [51/200] batch [5/13] time 0.345 (0.345) data 0.267 (0.267) loss_x loss_x 0.4998 (0.3657) acc_x 90.6250 (91.2500) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/13] time 0.305 (0.337) data 0.227 (0.260) loss_x loss_x 0.3853 (0.4457) acc_x 90.6250 (90.0000) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [5/37] time 0.332 (0.322) data 0.251 (0.244) loss_u loss_u 0.9570 (0.9506) acc_u 3.1250 (6.2500) lr 1.7181e-03 eta 0:00:10
epoch [51/200] batch [10/37] time 0.334 (0.326) data 0.256 (0.249) loss_u loss_u 0.9438 (0.9454) acc_u 6.2500 (6.8750) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [15/37] time 0.333 (0.328) data 0.255 (0.250) loss_u loss_u 0.9458 (0.9479) acc_u 6.2500 (6.2500) lr 1.7181e-03 eta 0:00:07
epoch [51/200] batch [20/37] time 0.345 (0.329) data 0.266 (0.251) loss_u loss_u 0.9839 (0.9519) acc_u 3.1250 (5.9375) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [25/37] time 0.353 (0.331) data 0.275 (0.253) loss_u loss_u 0.8770 (0.9486) acc_u 12.5000 (6.2500) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [30/37] time 0.351 (0.333) data 0.273 (0.255) loss_u loss_u 0.9814 (0.9505) acc_u 3.1250 (6.0417) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [35/37] time 0.339 (0.334) data 0.262 (0.256) loss_u loss_u 0.9292 (0.9475) acc_u 6.2500 (6.1607) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 677
confident_label rate tensor(0.2678, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 437
clean true:277
clean false:160
clean_rate:0.6338672768878718
noisy true:678
noisy false:517
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1195
epoch [52/200] batch [5/13] time 0.339 (0.347) data 0.261 (0.269) loss_x loss_x 0.3259 (0.5664) acc_x 90.6250 (86.8750) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/13] time 0.339 (0.343) data 0.262 (0.266) loss_x loss_x 0.5498 (0.5261) acc_x 87.5000 (88.4375) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [5/37] time 0.290 (0.336) data 0.211 (0.259) loss_u loss_u 0.9722 (0.9510) acc_u 3.1250 (5.0000) lr 1.7071e-03 eta 0:00:10
epoch [52/200] batch [10/37] time 0.343 (0.334) data 0.265 (0.256) loss_u loss_u 0.9790 (0.9573) acc_u 3.1250 (4.0625) lr 1.7071e-03 eta 0:00:09
epoch [52/200] batch [15/37] time 0.342 (0.334) data 0.265 (0.256) loss_u loss_u 0.9761 (0.9580) acc_u 6.2500 (4.5833) lr 1.7071e-03 eta 0:00:07
epoch [52/200] batch [20/37] time 0.346 (0.334) data 0.268 (0.256) loss_u loss_u 0.9922 (0.9612) acc_u 0.0000 (4.3750) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [25/37] time 0.356 (0.334) data 0.278 (0.256) loss_u loss_u 0.9165 (0.9559) acc_u 9.3750 (5.2500) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [30/37] time 0.348 (0.335) data 0.270 (0.257) loss_u loss_u 0.9766 (0.9544) acc_u 3.1250 (5.5208) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [35/37] time 0.337 (0.335) data 0.259 (0.257) loss_u loss_u 0.9268 (0.9548) acc_u 9.3750 (5.4464) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 681
confident_label rate tensor(0.2727, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 445
clean true:284
clean false:161
clean_rate:0.6382022471910113
noisy true:667
noisy false:520
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1187
epoch [53/200] batch [5/13] time 0.344 (0.354) data 0.267 (0.277) loss_x loss_x 0.5459 (0.4128) acc_x 84.3750 (90.0000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/13] time 0.344 (0.350) data 0.267 (0.273) loss_x loss_x 0.3396 (0.4623) acc_x 93.7500 (90.3125) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [5/37] time 0.321 (0.346) data 0.242 (0.269) loss_u loss_u 0.9663 (0.9381) acc_u 3.1250 (8.1250) lr 1.6959e-03 eta 0:00:11
epoch [53/200] batch [10/37] time 0.310 (0.337) data 0.231 (0.260) loss_u loss_u 0.9478 (0.9342) acc_u 6.2500 (8.4375) lr 1.6959e-03 eta 0:00:09
epoch [53/200] batch [15/37] time 0.338 (0.336) data 0.260 (0.259) loss_u loss_u 0.9512 (0.9435) acc_u 6.2500 (7.5000) lr 1.6959e-03 eta 0:00:07
epoch [53/200] batch [20/37] time 0.340 (0.337) data 0.262 (0.259) loss_u loss_u 0.9287 (0.9425) acc_u 9.3750 (7.5000) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [25/37] time 0.337 (0.337) data 0.259 (0.259) loss_u loss_u 0.9780 (0.9445) acc_u 3.1250 (7.0000) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [30/37] time 0.333 (0.336) data 0.254 (0.258) loss_u loss_u 0.9995 (0.9474) acc_u 0.0000 (6.6667) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [35/37] time 0.318 (0.336) data 0.240 (0.258) loss_u loss_u 0.9614 (0.9515) acc_u 3.1250 (6.0714) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 684
confident_label rate tensor(0.2745, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 448
clean true:279
clean false:169
clean_rate:0.6227678571428571
noisy true:669
noisy false:515
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1184
epoch [54/200] batch [5/14] time 0.346 (0.346) data 0.268 (0.268) loss_x loss_x 0.5601 (0.5084) acc_x 84.3750 (88.1250) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/14] time 0.348 (0.344) data 0.271 (0.266) loss_x loss_x 0.4148 (0.5309) acc_x 87.5000 (87.1875) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [5/37] time 0.323 (0.346) data 0.245 (0.269) loss_u loss_u 0.9331 (0.9472) acc_u 6.2500 (6.2500) lr 1.6845e-03 eta 0:00:11
epoch [54/200] batch [10/37] time 0.302 (0.337) data 0.224 (0.260) loss_u loss_u 0.9951 (0.9502) acc_u 0.0000 (5.6250) lr 1.6845e-03 eta 0:00:09
epoch [54/200] batch [15/37] time 0.335 (0.338) data 0.257 (0.260) loss_u loss_u 0.9956 (0.9460) acc_u 0.0000 (6.4583) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [20/37] time 0.325 (0.338) data 0.247 (0.260) loss_u loss_u 0.9932 (0.9552) acc_u 0.0000 (5.3125) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [25/37] time 0.325 (0.337) data 0.247 (0.259) loss_u loss_u 0.9282 (0.9547) acc_u 6.2500 (5.2500) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [30/37] time 0.332 (0.337) data 0.254 (0.259) loss_u loss_u 0.9370 (0.9552) acc_u 6.2500 (5.2083) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [35/37] time 0.336 (0.337) data 0.258 (0.260) loss_u loss_u 0.9678 (0.9545) acc_u 3.1250 (5.4464) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 688
confident_label rate tensor(0.2819, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 460
clean true:296
clean false:164
clean_rate:0.6434782608695652
noisy true:648
noisy false:524
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1172
epoch [55/200] batch [5/14] time 0.294 (0.347) data 0.217 (0.270) loss_x loss_x 0.6846 (0.5334) acc_x 81.2500 (87.5000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/14] time 0.342 (0.345) data 0.265 (0.267) loss_x loss_x 0.1923 (0.4755) acc_x 100.0000 (89.0625) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [5/36] time 0.307 (0.339) data 0.228 (0.261) loss_u loss_u 0.9580 (0.9250) acc_u 6.2500 (9.3750) lr 1.6730e-03 eta 0:00:10
epoch [55/200] batch [10/36] time 0.334 (0.332) data 0.256 (0.254) loss_u loss_u 0.9502 (0.9289) acc_u 6.2500 (8.1250) lr 1.6730e-03 eta 0:00:08
epoch [55/200] batch [15/36] time 0.348 (0.334) data 0.270 (0.256) loss_u loss_u 0.9512 (0.9456) acc_u 6.2500 (6.4583) lr 1.6730e-03 eta 0:00:07
epoch [55/200] batch [20/36] time 0.324 (0.334) data 0.246 (0.256) loss_u loss_u 0.9390 (0.9478) acc_u 6.2500 (6.4062) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [25/36] time 0.351 (0.335) data 0.273 (0.257) loss_u loss_u 0.9219 (0.9485) acc_u 9.3750 (6.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [30/36] time 0.333 (0.334) data 0.255 (0.257) loss_u loss_u 0.9556 (0.9500) acc_u 6.2500 (6.2500) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [35/36] time 0.333 (0.334) data 0.255 (0.256) loss_u loss_u 0.9814 (0.9522) acc_u 3.1250 (6.1607) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 690
confident_label rate tensor(0.2721, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 444
clean true:276
clean false:168
clean_rate:0.6216216216216216
noisy true:666
noisy false:522
after delete: len(clean_dataset) 444
after delete: len(noisy_dataset) 1188
epoch [56/200] batch [5/13] time 0.345 (0.346) data 0.267 (0.269) loss_x loss_x 0.2554 (0.5587) acc_x 100.0000 (86.8750) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/13] time 0.359 (0.348) data 0.281 (0.270) loss_x loss_x 0.2505 (0.5283) acc_x 93.7500 (86.2500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [5/37] time 0.336 (0.344) data 0.258 (0.266) loss_u loss_u 0.9639 (0.9574) acc_u 3.1250 (5.0000) lr 1.6613e-03 eta 0:00:11
epoch [56/200] batch [10/37] time 0.299 (0.336) data 0.221 (0.258) loss_u loss_u 0.8828 (0.9382) acc_u 15.6250 (7.1875) lr 1.6613e-03 eta 0:00:09
epoch [56/200] batch [15/37] time 0.334 (0.336) data 0.255 (0.258) loss_u loss_u 0.8911 (0.9466) acc_u 12.5000 (6.0417) lr 1.6613e-03 eta 0:00:07
epoch [56/200] batch [20/37] time 0.337 (0.336) data 0.259 (0.258) loss_u loss_u 0.9297 (0.9424) acc_u 6.2500 (6.4062) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [25/37] time 0.342 (0.335) data 0.264 (0.258) loss_u loss_u 0.9805 (0.9443) acc_u 3.1250 (6.3750) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [30/37] time 0.337 (0.336) data 0.260 (0.259) loss_u loss_u 0.9556 (0.9457) acc_u 6.2500 (6.2500) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [35/37] time 0.326 (0.337) data 0.249 (0.259) loss_u loss_u 0.9614 (0.9469) acc_u 3.1250 (5.9821) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 667
confident_label rate tensor(0.2745, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 448
clean true:285
clean false:163
clean_rate:0.6361607142857143
noisy true:680
noisy false:504
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1184
epoch [57/200] batch [5/14] time 0.359 (0.354) data 0.282 (0.277) loss_x loss_x 0.3147 (0.4120) acc_x 93.7500 (90.6250) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/14] time 0.352 (0.345) data 0.275 (0.268) loss_x loss_x 0.6001 (0.4760) acc_x 81.2500 (88.7500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [5/37] time 0.312 (0.344) data 0.233 (0.267) loss_u loss_u 0.9854 (0.9431) acc_u 3.1250 (6.8750) lr 1.6494e-03 eta 0:00:11
epoch [57/200] batch [10/37] time 0.307 (0.335) data 0.229 (0.257) loss_u loss_u 0.9331 (0.9491) acc_u 6.2500 (5.9375) lr 1.6494e-03 eta 0:00:09
epoch [57/200] batch [15/37] time 0.358 (0.335) data 0.280 (0.257) loss_u loss_u 0.9902 (0.9567) acc_u 0.0000 (4.7917) lr 1.6494e-03 eta 0:00:07
epoch [57/200] batch [20/37] time 0.355 (0.338) data 0.277 (0.260) loss_u loss_u 0.9521 (0.9571) acc_u 6.2500 (4.8438) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [25/37] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.9673 (0.9599) acc_u 3.1250 (4.6250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [30/37] time 0.331 (0.341) data 0.253 (0.263) loss_u loss_u 0.9287 (0.9545) acc_u 9.3750 (5.5208) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [35/37] time 0.344 (0.341) data 0.266 (0.263) loss_u loss_u 0.8999 (0.9507) acc_u 12.5000 (5.9821) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 674
confident_label rate tensor(0.2788, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 455
clean true:283
clean false:172
clean_rate:0.621978021978022
noisy true:675
noisy false:502
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1177
epoch [58/200] batch [5/14] time 0.342 (0.344) data 0.265 (0.266) loss_x loss_x 0.3875 (0.3870) acc_x 90.6250 (92.5000) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/14] time 0.344 (0.346) data 0.267 (0.268) loss_x loss_x 0.3142 (0.4181) acc_x 90.6250 (89.3750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [5/36] time 0.292 (0.340) data 0.214 (0.262) loss_u loss_u 0.9346 (0.9352) acc_u 9.3750 (8.1250) lr 1.6374e-03 eta 0:00:10
epoch [58/200] batch [10/36] time 0.294 (0.331) data 0.215 (0.253) loss_u loss_u 0.9824 (0.9412) acc_u 0.0000 (6.8750) lr 1.6374e-03 eta 0:00:08
epoch [58/200] batch [15/36] time 0.346 (0.333) data 0.267 (0.255) loss_u loss_u 0.9517 (0.9423) acc_u 6.2500 (6.4583) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [20/36] time 0.346 (0.334) data 0.268 (0.256) loss_u loss_u 0.9082 (0.9439) acc_u 9.3750 (6.4062) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [25/36] time 0.348 (0.335) data 0.269 (0.257) loss_u loss_u 0.9448 (0.9496) acc_u 6.2500 (5.7500) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [30/36] time 0.336 (0.336) data 0.258 (0.258) loss_u loss_u 0.9883 (0.9502) acc_u 0.0000 (5.6250) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [35/36] time 0.334 (0.337) data 0.256 (0.259) loss_u loss_u 0.9487 (0.9522) acc_u 6.2500 (5.3571) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 691
confident_label rate tensor(0.2880, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 470
clean true:288
clean false:182
clean_rate:0.6127659574468085
noisy true:653
noisy false:509
after delete: len(clean_dataset) 470
after delete: len(noisy_dataset) 1162
epoch [59/200] batch [5/14] time 0.340 (0.351) data 0.263 (0.273) loss_x loss_x 0.4763 (0.3858) acc_x 87.5000 (90.0000) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/14] time 0.346 (0.349) data 0.268 (0.271) loss_x loss_x 1.0605 (0.5121) acc_x 81.2500 (88.1250) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [5/36] time 0.297 (0.345) data 0.218 (0.267) loss_u loss_u 0.9985 (0.9800) acc_u 0.0000 (1.8750) lr 1.6252e-03 eta 0:00:10
epoch [59/200] batch [10/36] time 0.322 (0.338) data 0.244 (0.260) loss_u loss_u 0.9912 (0.9632) acc_u 0.0000 (4.0625) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [15/36] time 0.341 (0.337) data 0.263 (0.259) loss_u loss_u 0.9209 (0.9501) acc_u 12.5000 (6.2500) lr 1.6252e-03 eta 0:00:07
epoch [59/200] batch [20/36] time 0.332 (0.337) data 0.254 (0.259) loss_u loss_u 0.9565 (0.9458) acc_u 6.2500 (6.7188) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [25/36] time 0.353 (0.338) data 0.275 (0.260) loss_u loss_u 0.9927 (0.9451) acc_u 0.0000 (6.8750) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [30/36] time 0.336 (0.338) data 0.258 (0.261) loss_u loss_u 0.8955 (0.9430) acc_u 15.6250 (7.1875) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [35/36] time 0.341 (0.339) data 0.263 (0.261) loss_u loss_u 0.9521 (0.9475) acc_u 6.2500 (6.6071) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 723
confident_label rate tensor(0.2800, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 457
clean true:276
clean false:181
clean_rate:0.6039387308533917
noisy true:633
noisy false:542
after delete: len(clean_dataset) 457
after delete: len(noisy_dataset) 1175
epoch [60/200] batch [5/14] time 0.296 (0.312) data 0.218 (0.234) loss_x loss_x 0.3777 (0.4110) acc_x 93.7500 (90.6250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/14] time 0.343 (0.334) data 0.266 (0.256) loss_x loss_x 0.4512 (0.4233) acc_x 84.3750 (89.6875) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [5/36] time 0.292 (0.335) data 0.213 (0.258) loss_u loss_u 0.9985 (0.9678) acc_u 0.0000 (3.7500) lr 1.6129e-03 eta 0:00:10
epoch [60/200] batch [10/36] time 0.307 (0.329) data 0.228 (0.252) loss_u loss_u 0.9727 (0.9598) acc_u 3.1250 (4.6875) lr 1.6129e-03 eta 0:00:08
epoch [60/200] batch [15/36] time 0.338 (0.333) data 0.260 (0.256) loss_u loss_u 0.9692 (0.9595) acc_u 3.1250 (5.2083) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [20/36] time 0.343 (0.334) data 0.265 (0.256) loss_u loss_u 0.8838 (0.9545) acc_u 15.6250 (5.9375) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [25/36] time 0.367 (0.336) data 0.288 (0.258) loss_u loss_u 0.9619 (0.9546) acc_u 3.1250 (5.7500) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [30/36] time 0.350 (0.336) data 0.272 (0.258) loss_u loss_u 0.9639 (0.9542) acc_u 3.1250 (5.8333) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [35/36] time 0.379 (0.337) data 0.301 (0.259) loss_u loss_u 0.9429 (0.9526) acc_u 6.2500 (5.8929) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 714
confident_label rate tensor(0.2757, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 450
clean true:271
clean false:179
clean_rate:0.6022222222222222
noisy true:647
noisy false:535
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1182
epoch [61/200] batch [5/14] time 0.312 (0.338) data 0.235 (0.259) loss_x loss_x 0.4924 (0.6056) acc_x 90.6250 (85.6250) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/14] time 0.362 (0.324) data 0.285 (0.246) loss_x loss_x 0.8413 (0.5775) acc_x 81.2500 (86.5625) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [5/36] time 0.338 (0.334) data 0.261 (0.256) loss_u loss_u 0.9795 (0.9437) acc_u 3.1250 (6.8750) lr 1.6004e-03 eta 0:00:10
epoch [61/200] batch [10/36] time 0.296 (0.332) data 0.218 (0.255) loss_u loss_u 0.9253 (0.9432) acc_u 12.5000 (7.1875) lr 1.6004e-03 eta 0:00:08
epoch [61/200] batch [15/36] time 0.330 (0.328) data 0.252 (0.250) loss_u loss_u 0.9302 (0.9368) acc_u 9.3750 (8.3333) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [20/36] time 0.332 (0.329) data 0.255 (0.252) loss_u loss_u 0.9692 (0.9411) acc_u 3.1250 (7.8125) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [25/36] time 0.343 (0.331) data 0.265 (0.253) loss_u loss_u 0.9385 (0.9402) acc_u 6.2500 (8.0000) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [30/36] time 0.344 (0.333) data 0.266 (0.255) loss_u loss_u 0.9463 (0.9435) acc_u 6.2500 (7.3958) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [35/36] time 0.331 (0.333) data 0.253 (0.256) loss_u loss_u 0.9663 (0.9445) acc_u 3.1250 (7.2321) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 685
confident_label rate tensor(0.2855, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 466
clean true:281
clean false:185
clean_rate:0.6030042918454935
noisy true:666
noisy false:500
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 1166
epoch [62/200] batch [5/14] time 0.361 (0.346) data 0.283 (0.268) loss_x loss_x 0.9077 (0.5769) acc_x 78.1250 (85.0000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/14] time 0.346 (0.349) data 0.269 (0.272) loss_x loss_x 0.3813 (0.4857) acc_x 87.5000 (87.5000) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [5/36] time 0.347 (0.347) data 0.270 (0.270) loss_u loss_u 0.9360 (0.9545) acc_u 9.3750 (6.2500) lr 1.5878e-03 eta 0:00:10
epoch [62/200] batch [10/36] time 0.355 (0.347) data 0.277 (0.270) loss_u loss_u 0.9668 (0.9522) acc_u 3.1250 (5.9375) lr 1.5878e-03 eta 0:00:09
epoch [62/200] batch [15/36] time 0.334 (0.345) data 0.255 (0.268) loss_u loss_u 0.9492 (0.9502) acc_u 6.2500 (6.2500) lr 1.5878e-03 eta 0:00:07
epoch [62/200] batch [20/36] time 0.304 (0.340) data 0.226 (0.262) loss_u loss_u 0.9375 (0.9501) acc_u 6.2500 (6.2500) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [25/36] time 0.333 (0.340) data 0.254 (0.262) loss_u loss_u 0.9043 (0.9490) acc_u 9.3750 (6.2500) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [30/36] time 0.340 (0.340) data 0.263 (0.262) loss_u loss_u 0.9424 (0.9514) acc_u 6.2500 (5.8333) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [35/36] time 0.348 (0.339) data 0.271 (0.261) loss_u loss_u 0.9883 (0.9528) acc_u 3.1250 (5.6250) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 688
confident_label rate tensor(0.2886, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 471
clean true:287
clean false:184
clean_rate:0.6093418259023354
noisy true:657
noisy false:504
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1161
epoch [63/200] batch [5/14] time 0.359 (0.352) data 0.281 (0.274) loss_x loss_x 0.4302 (0.4665) acc_x 87.5000 (88.7500) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/14] time 0.342 (0.350) data 0.265 (0.272) loss_x loss_x 0.2793 (0.4058) acc_x 96.8750 (90.6250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [5/36] time 0.340 (0.347) data 0.263 (0.269) loss_u loss_u 0.9736 (0.9554) acc_u 3.1250 (5.0000) lr 1.5750e-03 eta 0:00:10
epoch [63/200] batch [10/36] time 0.349 (0.346) data 0.270 (0.269) loss_u loss_u 0.9648 (0.9626) acc_u 6.2500 (4.3750) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [15/36] time 0.346 (0.346) data 0.267 (0.268) loss_u loss_u 0.9741 (0.9611) acc_u 3.1250 (4.5833) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [20/36] time 0.320 (0.343) data 0.241 (0.265) loss_u loss_u 0.9399 (0.9577) acc_u 9.3750 (5.1562) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [25/36] time 0.337 (0.342) data 0.259 (0.264) loss_u loss_u 0.9976 (0.9561) acc_u 0.0000 (5.3750) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [30/36] time 0.342 (0.342) data 0.264 (0.264) loss_u loss_u 0.9663 (0.9564) acc_u 3.1250 (5.2083) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [35/36] time 0.329 (0.341) data 0.251 (0.263) loss_u loss_u 0.9575 (0.9561) acc_u 3.1250 (5.4464) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 697
confident_label rate tensor(0.2947, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 481
clean true:290
clean false:191
clean_rate:0.6029106029106029
noisy true:645
noisy false:506
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1151
epoch [64/200] batch [5/15] time 0.360 (0.348) data 0.281 (0.271) loss_x loss_x 0.3823 (0.5673) acc_x 90.6250 (86.2500) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/15] time 0.342 (0.344) data 0.264 (0.267) loss_x loss_x 0.4614 (0.6092) acc_x 90.6250 (85.0000) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/15] time 0.296 (0.340) data 0.219 (0.262) loss_x loss_x 0.5869 (0.5466) acc_x 87.5000 (86.4583) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/35] time 0.341 (0.339) data 0.263 (0.262) loss_u loss_u 0.9688 (0.9497) acc_u 3.1250 (6.2500) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [10/35] time 0.336 (0.340) data 0.259 (0.263) loss_u loss_u 0.9819 (0.9555) acc_u 6.2500 (5.6250) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [15/35] time 0.305 (0.340) data 0.227 (0.263) loss_u loss_u 0.8989 (0.9512) acc_u 12.5000 (6.0417) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [20/35] time 0.314 (0.335) data 0.236 (0.257) loss_u loss_u 0.9976 (0.9593) acc_u 0.0000 (5.1562) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [25/35] time 0.327 (0.336) data 0.249 (0.258) loss_u loss_u 0.9414 (0.9580) acc_u 6.2500 (5.3750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [30/35] time 0.352 (0.337) data 0.274 (0.259) loss_u loss_u 0.9111 (0.9583) acc_u 9.3750 (5.2083) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [35/35] time 0.333 (0.337) data 0.255 (0.259) loss_u loss_u 0.9707 (0.9585) acc_u 3.1250 (5.0893) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 684
confident_label rate tensor(0.2770, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 452
clean true:278
clean false:174
clean_rate:0.6150442477876106
noisy true:670
noisy false:510
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 1180
epoch [65/200] batch [5/14] time 0.348 (0.342) data 0.271 (0.265) loss_x loss_x 0.3203 (0.4496) acc_x 93.7500 (88.7500) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [10/14] time 0.341 (0.343) data 0.264 (0.266) loss_x loss_x 0.6353 (0.4494) acc_x 78.1250 (87.5000) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [5/36] time 0.356 (0.351) data 0.277 (0.273) loss_u loss_u 0.9595 (0.9627) acc_u 3.1250 (4.3750) lr 1.5490e-03 eta 0:00:10
epoch [65/200] batch [10/36] time 0.350 (0.353) data 0.271 (0.275) loss_u loss_u 0.8706 (0.9588) acc_u 18.7500 (5.3125) lr 1.5490e-03 eta 0:00:09
epoch [65/200] batch [15/36] time 0.354 (0.354) data 0.275 (0.276) loss_u loss_u 0.8818 (0.9552) acc_u 12.5000 (5.6250) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [20/36] time 0.351 (0.353) data 0.273 (0.275) loss_u loss_u 0.9360 (0.9503) acc_u 9.3750 (6.4062) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [25/36] time 0.305 (0.350) data 0.226 (0.272) loss_u loss_u 0.9209 (0.9498) acc_u 9.3750 (6.3750) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [30/36] time 0.349 (0.349) data 0.271 (0.271) loss_u loss_u 0.9248 (0.9473) acc_u 9.3750 (6.8750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [35/36] time 0.340 (0.349) data 0.259 (0.271) loss_u loss_u 0.9302 (0.9432) acc_u 9.3750 (7.2321) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 726
confident_label rate tensor(0.2941, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 480
clean true:284
clean false:196
clean_rate:0.5916666666666667
noisy true:622
noisy false:530
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1152
epoch [66/200] batch [5/15] time 0.348 (0.352) data 0.271 (0.275) loss_x loss_x 0.3647 (0.5814) acc_x 93.7500 (83.1250) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/15] time 0.294 (0.335) data 0.217 (0.258) loss_x loss_x 0.4172 (0.6023) acc_x 87.5000 (84.0625) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/15] time 0.341 (0.337) data 0.264 (0.260) loss_x loss_x 0.3440 (0.5202) acc_x 87.5000 (85.8333) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/36] time 0.335 (0.337) data 0.258 (0.260) loss_u loss_u 0.9287 (0.9540) acc_u 6.2500 (4.3750) lr 1.5358e-03 eta 0:00:10
epoch [66/200] batch [10/36] time 0.355 (0.339) data 0.277 (0.261) loss_u loss_u 0.9995 (0.9575) acc_u 0.0000 (4.3750) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [15/36] time 0.335 (0.340) data 0.258 (0.262) loss_u loss_u 0.9668 (0.9561) acc_u 3.1250 (4.3750) lr 1.5358e-03 eta 0:00:07
epoch [66/200] batch [20/36] time 0.294 (0.336) data 0.216 (0.258) loss_u loss_u 0.9434 (0.9606) acc_u 6.2500 (4.2188) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [25/36] time 0.342 (0.333) data 0.265 (0.255) loss_u loss_u 0.8945 (0.9587) acc_u 9.3750 (4.5000) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [30/36] time 0.364 (0.334) data 0.285 (0.256) loss_u loss_u 0.9604 (0.9581) acc_u 3.1250 (4.4792) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [35/36] time 0.341 (0.335) data 0.263 (0.257) loss_u loss_u 0.9385 (0.9541) acc_u 6.2500 (5.0000) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 686
confident_label rate tensor(0.2892, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 472
clean true:286
clean false:186
clean_rate:0.6059322033898306
noisy true:660
noisy false:500
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 1160
epoch [67/200] batch [5/14] time 0.342 (0.347) data 0.265 (0.270) loss_x loss_x 0.5464 (0.5540) acc_x 90.6250 (86.8750) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/14] time 0.344 (0.346) data 0.267 (0.268) loss_x loss_x 0.3030 (0.4789) acc_x 96.8750 (89.0625) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [5/36] time 0.344 (0.344) data 0.267 (0.267) loss_u loss_u 0.9399 (0.9661) acc_u 6.2500 (4.3750) lr 1.5225e-03 eta 0:00:10
epoch [67/200] batch [10/36] time 0.311 (0.345) data 0.232 (0.268) loss_u loss_u 0.8833 (0.9553) acc_u 15.6250 (5.3125) lr 1.5225e-03 eta 0:00:08
epoch [67/200] batch [15/36] time 0.370 (0.343) data 0.291 (0.266) loss_u loss_u 0.9546 (0.9547) acc_u 6.2500 (5.4167) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [20/36] time 0.362 (0.348) data 0.283 (0.270) loss_u loss_u 0.9321 (0.9523) acc_u 6.2500 (5.9375) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [25/36] time 0.346 (0.348) data 0.268 (0.270) loss_u loss_u 0.8960 (0.9458) acc_u 9.3750 (6.6250) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [30/36] time 0.333 (0.347) data 0.255 (0.270) loss_u loss_u 0.8745 (0.9405) acc_u 15.6250 (7.2917) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [35/36] time 0.350 (0.347) data 0.272 (0.269) loss_u loss_u 0.9727 (0.9447) acc_u 3.1250 (6.7857) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 735
confident_label rate tensor(0.2788, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 455
clean true:268
clean false:187
clean_rate:0.589010989010989
noisy true:629
noisy false:548
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1177
epoch [68/200] batch [5/14] time 0.353 (0.351) data 0.276 (0.274) loss_x loss_x 0.6807 (0.5822) acc_x 87.5000 (87.5000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/14] time 0.339 (0.338) data 0.261 (0.261) loss_x loss_x 0.1648 (0.5237) acc_x 96.8750 (88.1250) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [5/36] time 0.341 (0.337) data 0.264 (0.259) loss_u loss_u 0.9673 (0.9417) acc_u 3.1250 (6.2500) lr 1.5090e-03 eta 0:00:10
epoch [68/200] batch [10/36] time 0.349 (0.338) data 0.271 (0.260) loss_u loss_u 0.8818 (0.9346) acc_u 15.6250 (7.8125) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [15/36] time 0.333 (0.339) data 0.256 (0.261) loss_u loss_u 0.9922 (0.9376) acc_u 0.0000 (7.5000) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [20/36] time 0.319 (0.337) data 0.240 (0.259) loss_u loss_u 0.9487 (0.9320) acc_u 6.2500 (8.1250) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [25/36] time 0.371 (0.337) data 0.293 (0.259) loss_u loss_u 0.9668 (0.9391) acc_u 3.1250 (7.3750) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [30/36] time 0.344 (0.336) data 0.266 (0.258) loss_u loss_u 0.9116 (0.9417) acc_u 9.3750 (6.9792) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [35/36] time 0.330 (0.337) data 0.252 (0.259) loss_u loss_u 0.8994 (0.9392) acc_u 9.3750 (7.2321) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 699
confident_label rate tensor(0.2886, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 471
clean true:279
clean false:192
clean_rate:0.5923566878980892
noisy true:654
noisy false:507
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1161
epoch [69/200] batch [5/14] time 0.369 (0.353) data 0.291 (0.275) loss_x loss_x 0.3923 (0.5665) acc_x 90.6250 (88.7500) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/14] time 0.348 (0.354) data 0.269 (0.276) loss_x loss_x 0.1991 (0.4730) acc_x 100.0000 (90.0000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [5/36] time 0.346 (0.348) data 0.268 (0.270) loss_u loss_u 0.9116 (0.9584) acc_u 9.3750 (5.0000) lr 1.4955e-03 eta 0:00:10
epoch [69/200] batch [10/36] time 0.298 (0.338) data 0.220 (0.260) loss_u loss_u 0.9297 (0.9527) acc_u 6.2500 (5.6250) lr 1.4955e-03 eta 0:00:08
epoch [69/200] batch [15/36] time 0.347 (0.337) data 0.270 (0.259) loss_u loss_u 0.9531 (0.9475) acc_u 6.2500 (6.6667) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [20/36] time 0.298 (0.331) data 0.220 (0.254) loss_u loss_u 0.8896 (0.9425) acc_u 15.6250 (7.3438) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [25/36] time 0.336 (0.330) data 0.258 (0.253) loss_u loss_u 0.8794 (0.9420) acc_u 12.5000 (7.3750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [30/36] time 0.320 (0.331) data 0.242 (0.253) loss_u loss_u 0.8945 (0.9413) acc_u 12.5000 (7.6042) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [35/36] time 0.336 (0.331) data 0.257 (0.253) loss_u loss_u 0.9287 (0.9414) acc_u 6.2500 (7.4107) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 698
confident_label rate tensor(0.2960, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 483
clean true:286
clean false:197
clean_rate:0.5921325051759835
noisy true:648
noisy false:501
after delete: len(clean_dataset) 483
after delete: len(noisy_dataset) 1149
epoch [70/200] batch [5/15] time 0.347 (0.354) data 0.270 (0.276) loss_x loss_x 0.3118 (0.4028) acc_x 90.6250 (88.1250) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/15] time 0.373 (0.353) data 0.296 (0.276) loss_x loss_x 0.5269 (0.4114) acc_x 90.6250 (89.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/15] time 0.340 (0.350) data 0.263 (0.272) loss_x loss_x 0.3254 (0.4127) acc_x 93.7500 (90.6250) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/35] time 0.324 (0.348) data 0.247 (0.270) loss_u loss_u 0.8901 (0.9191) acc_u 12.5000 (9.3750) lr 1.4818e-03 eta 0:00:10
epoch [70/200] batch [10/35] time 0.334 (0.346) data 0.256 (0.268) loss_u loss_u 0.9814 (0.9343) acc_u 0.0000 (8.1250) lr 1.4818e-03 eta 0:00:08
epoch [70/200] batch [15/35] time 0.339 (0.345) data 0.260 (0.267) loss_u loss_u 0.9668 (0.9366) acc_u 6.2500 (7.7083) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [20/35] time 0.306 (0.344) data 0.229 (0.267) loss_u loss_u 0.9224 (0.9427) acc_u 9.3750 (6.8750) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [25/35] time 0.336 (0.343) data 0.258 (0.266) loss_u loss_u 0.8950 (0.9402) acc_u 12.5000 (7.0000) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [30/35] time 0.330 (0.344) data 0.252 (0.266) loss_u loss_u 0.9175 (0.9427) acc_u 9.3750 (6.5625) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [35/35] time 0.333 (0.343) data 0.254 (0.265) loss_u loss_u 0.8940 (0.9440) acc_u 12.5000 (6.3393) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 700
confident_label rate tensor(0.2947, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 481
clean true:280
clean false:201
clean_rate:0.5821205821205822
noisy true:652
noisy false:499
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1151
epoch [71/200] batch [5/15] time 0.340 (0.350) data 0.262 (0.273) loss_x loss_x 0.6431 (0.4755) acc_x 84.3750 (88.1250) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/15] time 0.334 (0.348) data 0.257 (0.270) loss_x loss_x 0.6108 (0.4455) acc_x 84.3750 (89.6875) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/15] time 0.302 (0.336) data 0.225 (0.259) loss_x loss_x 0.2028 (0.4598) acc_x 100.0000 (89.5833) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/35] time 0.342 (0.337) data 0.264 (0.259) loss_u loss_u 0.9497 (0.9575) acc_u 9.3750 (6.2500) lr 1.4679e-03 eta 0:00:10
epoch [71/200] batch [10/35] time 0.304 (0.336) data 0.224 (0.259) loss_u loss_u 0.9297 (0.9454) acc_u 12.5000 (7.5000) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [15/35] time 0.336 (0.337) data 0.258 (0.259) loss_u loss_u 0.9980 (0.9510) acc_u 0.0000 (6.4583) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [20/35] time 0.344 (0.335) data 0.266 (0.258) loss_u loss_u 0.9316 (0.9482) acc_u 9.3750 (6.5625) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [25/35] time 0.344 (0.335) data 0.266 (0.257) loss_u loss_u 0.9360 (0.9464) acc_u 6.2500 (6.5000) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [30/35] time 0.339 (0.336) data 0.261 (0.258) loss_u loss_u 0.9404 (0.9468) acc_u 6.2500 (6.5625) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [35/35] time 0.325 (0.336) data 0.248 (0.258) loss_u loss_u 0.9653 (0.9449) acc_u 3.1250 (6.9643) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 711
confident_label rate tensor(0.2966, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 484
clean true:276
clean false:208
clean_rate:0.5702479338842975
noisy true:645
noisy false:503
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1148
epoch [72/200] batch [5/15] time 0.330 (0.346) data 0.253 (0.268) loss_x loss_x 0.2050 (0.3510) acc_x 93.7500 (92.5000) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/15] time 0.334 (0.342) data 0.256 (0.265) loss_x loss_x 0.4351 (0.4126) acc_x 87.5000 (90.0000) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/15] time 0.326 (0.339) data 0.249 (0.262) loss_x loss_x 0.6245 (0.4240) acc_x 84.3750 (90.0000) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/35] time 0.342 (0.340) data 0.264 (0.262) loss_u loss_u 0.8169 (0.9239) acc_u 21.8750 (8.1250) lr 1.4540e-03 eta 0:00:10
epoch [72/200] batch [10/35] time 0.355 (0.343) data 0.276 (0.265) loss_u loss_u 0.9839 (0.9404) acc_u 0.0000 (6.2500) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [15/35] time 0.339 (0.343) data 0.261 (0.266) loss_u loss_u 0.9585 (0.9389) acc_u 6.2500 (6.8750) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [20/35] time 0.308 (0.341) data 0.229 (0.263) loss_u loss_u 0.9478 (0.9380) acc_u 6.2500 (7.1875) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [25/35] time 0.354 (0.337) data 0.275 (0.259) loss_u loss_u 0.9658 (0.9405) acc_u 3.1250 (6.8750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [30/35] time 0.347 (0.338) data 0.268 (0.260) loss_u loss_u 0.8994 (0.9337) acc_u 12.5000 (7.7083) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [35/35] time 0.334 (0.337) data 0.256 (0.259) loss_u loss_u 0.9673 (0.9349) acc_u 3.1250 (7.5893) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 740
confident_label rate tensor(0.2947, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 481
clean true:268
clean false:213
clean_rate:0.5571725571725572
noisy true:624
noisy false:527
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1151
epoch [73/200] batch [5/15] time 0.332 (0.338) data 0.253 (0.260) loss_x loss_x 0.5396 (0.4650) acc_x 87.5000 (89.3750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/15] time 0.344 (0.340) data 0.267 (0.262) loss_x loss_x 0.5566 (0.5017) acc_x 81.2500 (88.4375) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/15] time 0.335 (0.340) data 0.258 (0.262) loss_x loss_x 0.5908 (0.4610) acc_x 90.6250 (90.0000) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/35] time 0.347 (0.340) data 0.270 (0.262) loss_u loss_u 0.9238 (0.9490) acc_u 9.3750 (6.2500) lr 1.4399e-03 eta 0:00:10
epoch [73/200] batch [10/35] time 0.361 (0.342) data 0.283 (0.264) loss_u loss_u 0.9634 (0.9264) acc_u 3.1250 (8.4375) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [15/35] time 0.311 (0.341) data 0.233 (0.263) loss_u loss_u 0.9404 (0.9290) acc_u 6.2500 (8.5417) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [20/35] time 0.339 (0.339) data 0.261 (0.261) loss_u loss_u 0.9727 (0.9342) acc_u 6.2500 (7.9688) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [25/35] time 0.314 (0.336) data 0.236 (0.258) loss_u loss_u 0.9272 (0.9347) acc_u 9.3750 (7.8750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [30/35] time 0.343 (0.337) data 0.264 (0.259) loss_u loss_u 0.9209 (0.9351) acc_u 9.3750 (7.8125) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [35/35] time 0.339 (0.338) data 0.261 (0.260) loss_u loss_u 0.9146 (0.9327) acc_u 9.3750 (8.0357) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 771
confident_label rate tensor(0.3064, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 500
clean true:272
clean false:228
clean_rate:0.544
noisy true:589
noisy false:543
after delete: len(clean_dataset) 500
after delete: len(noisy_dataset) 1132
epoch [74/200] batch [5/15] time 0.358 (0.352) data 0.280 (0.274) loss_x loss_x 0.7393 (0.4418) acc_x 81.2500 (90.0000) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [10/15] time 0.333 (0.348) data 0.255 (0.270) loss_x loss_x 0.5488 (0.3944) acc_x 84.3750 (90.3125) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/15] time 0.344 (0.347) data 0.267 (0.270) loss_x loss_x 0.7944 (0.4381) acc_x 81.2500 (88.1250) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/35] time 0.347 (0.347) data 0.269 (0.269) loss_u loss_u 0.9731 (0.9492) acc_u 3.1250 (5.6250) lr 1.4258e-03 eta 0:00:10
epoch [74/200] batch [10/35] time 0.334 (0.347) data 0.257 (0.269) loss_u loss_u 0.9443 (0.9548) acc_u 9.3750 (5.3125) lr 1.4258e-03 eta 0:00:08
epoch [74/200] batch [15/35] time 0.354 (0.347) data 0.276 (0.269) loss_u loss_u 0.9136 (0.9572) acc_u 12.5000 (5.4167) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [20/35] time 0.295 (0.345) data 0.216 (0.267) loss_u loss_u 0.9902 (0.9530) acc_u 0.0000 (5.9375) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [25/35] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.9478 (0.9514) acc_u 6.2500 (5.7500) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [30/35] time 0.330 (0.340) data 0.252 (0.262) loss_u loss_u 0.9517 (0.9483) acc_u 6.2500 (6.2500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [35/35] time 0.353 (0.340) data 0.275 (0.263) loss_u loss_u 0.8799 (0.9465) acc_u 15.6250 (6.6071) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 747
confident_label rate tensor(0.3070, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 501
clean true:279
clean false:222
clean_rate:0.5568862275449101
noisy true:606
noisy false:525
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1131
epoch [75/200] batch [5/15] time 0.346 (0.343) data 0.269 (0.266) loss_x loss_x 0.4707 (0.4286) acc_x 81.2500 (86.8750) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/15] time 0.297 (0.329) data 0.220 (0.252) loss_x loss_x 0.4258 (0.3859) acc_x 90.6250 (89.3750) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/15] time 0.340 (0.333) data 0.262 (0.256) loss_x loss_x 0.4905 (0.4042) acc_x 90.6250 (89.7917) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/35] time 0.340 (0.335) data 0.263 (0.258) loss_u loss_u 0.9897 (0.9338) acc_u 0.0000 (6.8750) lr 1.4115e-03 eta 0:00:10
epoch [75/200] batch [10/35] time 0.320 (0.335) data 0.242 (0.258) loss_u loss_u 0.9883 (0.9365) acc_u 3.1250 (7.1875) lr 1.4115e-03 eta 0:00:08
epoch [75/200] batch [15/35] time 0.339 (0.335) data 0.262 (0.258) loss_u loss_u 0.9448 (0.9408) acc_u 6.2500 (6.8750) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [20/35] time 0.355 (0.336) data 0.277 (0.259) loss_u loss_u 0.9629 (0.9441) acc_u 6.2500 (6.5625) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [25/35] time 0.332 (0.333) data 0.252 (0.256) loss_u loss_u 0.9468 (0.9460) acc_u 6.2500 (6.3750) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [30/35] time 0.339 (0.334) data 0.262 (0.256) loss_u loss_u 0.9375 (0.9446) acc_u 6.2500 (6.4583) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [35/35] time 0.343 (0.335) data 0.266 (0.257) loss_u loss_u 0.9209 (0.9424) acc_u 9.3750 (6.7857) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 732
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 511
clean true:284
clean false:227
clean_rate:0.5557729941291585
noisy true:616
noisy false:505
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1121
epoch [76/200] batch [5/15] time 0.345 (0.348) data 0.267 (0.270) loss_x loss_x 0.3608 (0.4656) acc_x 93.7500 (91.8750) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/15] time 0.340 (0.344) data 0.263 (0.266) loss_x loss_x 0.4231 (0.4710) acc_x 87.5000 (89.0625) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/15] time 0.355 (0.345) data 0.278 (0.267) loss_x loss_x 0.3848 (0.4645) acc_x 84.3750 (88.7500) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/35] time 0.333 (0.345) data 0.255 (0.267) loss_u loss_u 0.9829 (0.9515) acc_u 3.1250 (5.6250) lr 1.3971e-03 eta 0:00:10
epoch [76/200] batch [10/35] time 0.346 (0.346) data 0.268 (0.268) loss_u loss_u 0.9575 (0.9509) acc_u 6.2500 (5.6250) lr 1.3971e-03 eta 0:00:08
epoch [76/200] batch [15/35] time 0.347 (0.345) data 0.269 (0.267) loss_u loss_u 0.9873 (0.9550) acc_u 0.0000 (5.2083) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [20/35] time 0.355 (0.345) data 0.277 (0.267) loss_u loss_u 0.9277 (0.9525) acc_u 6.2500 (5.3125) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [25/35] time 0.297 (0.343) data 0.218 (0.265) loss_u loss_u 0.9692 (0.9537) acc_u 3.1250 (5.2500) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [30/35] time 0.307 (0.338) data 0.229 (0.260) loss_u loss_u 0.8521 (0.9461) acc_u 18.7500 (6.1458) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [35/35] time 0.337 (0.339) data 0.259 (0.261) loss_u loss_u 0.9561 (0.9487) acc_u 3.1250 (5.8036) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 723
confident_label rate tensor(0.3039, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 496
clean true:278
clean false:218
clean_rate:0.5604838709677419
noisy true:631
noisy false:505
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1136
epoch [77/200] batch [5/15] time 0.358 (0.355) data 0.281 (0.277) loss_x loss_x 0.4749 (0.3623) acc_x 90.6250 (93.1250) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/15] time 0.359 (0.359) data 0.282 (0.282) loss_x loss_x 0.3911 (0.4141) acc_x 93.7500 (90.3125) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/15] time 0.345 (0.357) data 0.267 (0.279) loss_x loss_x 0.4995 (0.3934) acc_x 87.5000 (90.8333) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/35] time 0.359 (0.355) data 0.282 (0.277) loss_u loss_u 0.9497 (0.9656) acc_u 9.3750 (3.1250) lr 1.3827e-03 eta 0:00:10
epoch [77/200] batch [10/35] time 0.352 (0.353) data 0.274 (0.275) loss_u loss_u 0.9819 (0.9603) acc_u 0.0000 (3.7500) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [15/35] time 0.333 (0.351) data 0.256 (0.273) loss_u loss_u 0.9521 (0.9447) acc_u 6.2500 (5.8333) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [20/35] time 0.345 (0.350) data 0.267 (0.272) loss_u loss_u 0.9448 (0.9450) acc_u 6.2500 (6.0938) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [25/35] time 0.302 (0.346) data 0.223 (0.268) loss_u loss_u 0.9438 (0.9464) acc_u 6.2500 (6.0000) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [30/35] time 0.345 (0.346) data 0.268 (0.268) loss_u loss_u 0.8994 (0.9428) acc_u 9.3750 (6.4583) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [35/35] time 0.345 (0.346) data 0.267 (0.268) loss_u loss_u 0.9160 (0.9456) acc_u 9.3750 (6.2500) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 741
confident_label rate tensor(0.3058, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 499
clean true:275
clean false:224
clean_rate:0.5511022044088176
noisy true:616
noisy false:517
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1133
epoch [78/200] batch [5/15] time 0.363 (0.354) data 0.285 (0.277) loss_x loss_x 0.5620 (0.5204) acc_x 93.7500 (90.6250) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/15] time 0.348 (0.352) data 0.271 (0.274) loss_x loss_x 0.3340 (0.4425) acc_x 93.7500 (91.2500) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/15] time 0.342 (0.349) data 0.265 (0.271) loss_x loss_x 0.5503 (0.4295) acc_x 84.3750 (90.8333) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/35] time 0.348 (0.346) data 0.270 (0.268) loss_u loss_u 0.9854 (0.9370) acc_u 0.0000 (8.7500) lr 1.3681e-03 eta 0:00:10
epoch [78/200] batch [10/35] time 0.342 (0.346) data 0.265 (0.269) loss_u loss_u 0.9658 (0.9436) acc_u 3.1250 (6.8750) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [15/35] time 0.346 (0.346) data 0.269 (0.268) loss_u loss_u 0.9771 (0.9464) acc_u 3.1250 (6.8750) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [20/35] time 0.360 (0.346) data 0.281 (0.268) loss_u loss_u 0.9736 (0.9490) acc_u 6.2500 (6.7188) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [25/35] time 0.295 (0.344) data 0.217 (0.266) loss_u loss_u 0.8442 (0.9440) acc_u 18.7500 (7.2500) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [30/35] time 0.340 (0.340) data 0.263 (0.262) loss_u loss_u 0.8486 (0.9389) acc_u 18.7500 (7.7083) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [35/35] time 0.328 (0.340) data 0.250 (0.262) loss_u loss_u 0.8413 (0.9357) acc_u 15.6250 (7.8571) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 753
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 504
clean true:279
clean false:225
clean_rate:0.5535714285714286
noisy true:600
noisy false:528
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1128
epoch [79/200] batch [5/15] time 0.330 (0.386) data 0.253 (0.308) loss_x loss_x 0.6104 (0.4209) acc_x 87.5000 (88.1250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/15] time 0.345 (0.365) data 0.267 (0.288) loss_x loss_x 0.6118 (0.4612) acc_x 87.5000 (87.5000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/15] time 0.339 (0.358) data 0.262 (0.281) loss_x loss_x 0.5576 (0.4546) acc_x 87.5000 (87.5000) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/35] time 0.324 (0.352) data 0.246 (0.275) loss_u loss_u 0.9780 (0.9417) acc_u 3.1250 (6.8750) lr 1.3535e-03 eta 0:00:10
epoch [79/200] batch [10/35] time 0.330 (0.350) data 0.252 (0.272) loss_u loss_u 0.9355 (0.9405) acc_u 6.2500 (6.8750) lr 1.3535e-03 eta 0:00:08
epoch [79/200] batch [15/35] time 0.341 (0.349) data 0.264 (0.272) loss_u loss_u 0.9565 (0.9413) acc_u 6.2500 (6.6667) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [20/35] time 0.341 (0.348) data 0.264 (0.271) loss_u loss_u 0.9302 (0.9393) acc_u 9.3750 (7.1875) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [25/35] time 0.323 (0.346) data 0.246 (0.269) loss_u loss_u 0.9238 (0.9425) acc_u 9.3750 (6.8750) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [30/35] time 0.309 (0.344) data 0.231 (0.266) loss_u loss_u 0.8813 (0.9440) acc_u 15.6250 (6.7708) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [35/35] time 0.299 (0.339) data 0.220 (0.262) loss_u loss_u 0.9409 (0.9413) acc_u 6.2500 (7.1429) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 748
confident_label rate tensor(0.3107, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 507
clean true:278
clean false:229
clean_rate:0.5483234714003945
noisy true:606
noisy false:519
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1125
epoch [80/200] batch [5/15] time 0.348 (0.313) data 0.271 (0.235) loss_x loss_x 0.5029 (0.4697) acc_x 93.7500 (90.0000) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/15] time 0.341 (0.329) data 0.264 (0.251) loss_x loss_x 0.3994 (0.4084) acc_x 87.5000 (90.9375) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/15] time 0.350 (0.334) data 0.273 (0.256) loss_x loss_x 0.8091 (0.4342) acc_x 84.3750 (89.5833) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/35] time 0.333 (0.338) data 0.255 (0.260) loss_u loss_u 0.9990 (0.9499) acc_u 0.0000 (6.8750) lr 1.3387e-03 eta 0:00:10
epoch [80/200] batch [10/35] time 0.334 (0.338) data 0.257 (0.261) loss_u loss_u 0.8657 (0.9269) acc_u 15.6250 (9.3750) lr 1.3387e-03 eta 0:00:08
epoch [80/200] batch [15/35] time 0.338 (0.338) data 0.260 (0.260) loss_u loss_u 0.9365 (0.9371) acc_u 6.2500 (7.9167) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [20/35] time 0.327 (0.338) data 0.249 (0.260) loss_u loss_u 0.9224 (0.9360) acc_u 9.3750 (8.2812) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [25/35] time 0.344 (0.338) data 0.266 (0.260) loss_u loss_u 0.9814 (0.9424) acc_u 3.1250 (7.6250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [30/35] time 0.340 (0.339) data 0.262 (0.261) loss_u loss_u 0.9663 (0.9424) acc_u 3.1250 (7.3958) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [35/35] time 0.473 (0.345) data 0.395 (0.267) loss_u loss_u 0.9541 (0.9419) acc_u 6.2500 (7.5000) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 745
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 515
clean true:283
clean false:232
clean_rate:0.5495145631067961
noisy true:604
noisy false:513
after delete: len(clean_dataset) 515
after delete: len(noisy_dataset) 1117
epoch [81/200] batch [5/16] time 0.351 (0.337) data 0.274 (0.259) loss_x loss_x 0.3660 (0.4597) acc_x 93.7500 (89.3750) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/16] time 0.346 (0.344) data 0.269 (0.266) loss_x loss_x 0.3411 (0.3767) acc_x 93.7500 (91.5625) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/16] time 0.330 (0.342) data 0.253 (0.265) loss_x loss_x 0.4756 (0.4484) acc_x 84.3750 (88.5417) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/34] time 0.299 (0.341) data 0.222 (0.264) loss_u loss_u 0.9756 (0.9343) acc_u 3.1250 (7.5000) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [10/34] time 0.327 (0.339) data 0.248 (0.261) loss_u loss_u 0.9072 (0.9444) acc_u 9.3750 (6.5625) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [15/34] time 0.340 (0.340) data 0.261 (0.262) loss_u loss_u 0.9712 (0.9437) acc_u 3.1250 (6.8750) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [20/34] time 0.348 (0.341) data 0.269 (0.264) loss_u loss_u 0.9233 (0.9416) acc_u 6.2500 (6.8750) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [25/34] time 0.341 (0.342) data 0.263 (0.264) loss_u loss_u 0.9517 (0.9418) acc_u 6.2500 (6.8750) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [30/34] time 0.350 (0.342) data 0.272 (0.264) loss_u loss_u 0.9502 (0.9431) acc_u 6.2500 (6.6667) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 739
confident_label rate tensor(0.2966, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 484
clean true:270
clean false:214
clean_rate:0.5578512396694215
noisy true:623
noisy false:525
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1148
epoch [82/200] batch [5/15] time 0.353 (0.357) data 0.276 (0.279) loss_x loss_x 0.4424 (0.5030) acc_x 93.7500 (88.1250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/15] time 0.351 (0.353) data 0.274 (0.276) loss_x loss_x 0.3638 (0.4508) acc_x 90.6250 (89.6875) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/15] time 0.339 (0.351) data 0.260 (0.273) loss_x loss_x 0.4878 (0.4467) acc_x 81.2500 (90.0000) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/35] time 0.337 (0.349) data 0.259 (0.271) loss_u loss_u 0.9258 (0.9132) acc_u 9.3750 (9.3750) lr 1.3090e-03 eta 0:00:10
epoch [82/200] batch [10/35] time 0.330 (0.349) data 0.253 (0.271) loss_u loss_u 0.9688 (0.9271) acc_u 3.1250 (8.1250) lr 1.3090e-03 eta 0:00:08
epoch [82/200] batch [15/35] time 0.341 (0.347) data 0.263 (0.270) loss_u loss_u 0.9468 (0.9357) acc_u 6.2500 (7.0833) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [20/35] time 0.339 (0.347) data 0.262 (0.269) loss_u loss_u 0.9272 (0.9433) acc_u 9.3750 (6.2500) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [25/35] time 0.338 (0.346) data 0.260 (0.269) loss_u loss_u 0.9922 (0.9462) acc_u 0.0000 (5.8750) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [30/35] time 0.338 (0.346) data 0.260 (0.269) loss_u loss_u 0.9683 (0.9418) acc_u 6.2500 (6.4583) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [35/35] time 0.300 (0.344) data 0.222 (0.266) loss_u loss_u 0.8608 (0.9348) acc_u 12.5000 (7.0536) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 718
confident_label rate tensor(0.3180, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 519
clean true:282
clean false:237
clean_rate:0.5433526011560693
noisy true:632
noisy false:481
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1113
epoch [83/200] batch [5/16] time 0.324 (0.325) data 0.246 (0.248) loss_x loss_x 0.3472 (0.3564) acc_x 93.7500 (91.8750) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/16] time 0.333 (0.333) data 0.256 (0.255) loss_x loss_x 0.4885 (0.4206) acc_x 87.5000 (89.6875) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/16] time 0.346 (0.338) data 0.269 (0.260) loss_x loss_x 0.5083 (0.4173) acc_x 84.3750 (89.1667) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/34] time 0.332 (0.336) data 0.254 (0.258) loss_u loss_u 0.9355 (0.9659) acc_u 6.2500 (3.1250) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [10/34] time 0.347 (0.337) data 0.270 (0.259) loss_u loss_u 0.8877 (0.9271) acc_u 12.5000 (8.1250) lr 1.2940e-03 eta 0:00:08
epoch [83/200] batch [15/34] time 0.342 (0.338) data 0.264 (0.260) loss_u loss_u 0.9644 (0.9426) acc_u 3.1250 (6.4583) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [20/34] time 0.325 (0.338) data 0.247 (0.260) loss_u loss_u 0.9170 (0.9378) acc_u 9.3750 (7.3438) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [25/34] time 0.335 (0.338) data 0.256 (0.261) loss_u loss_u 0.9658 (0.9396) acc_u 3.1250 (7.1250) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [30/34] time 0.357 (0.339) data 0.278 (0.261) loss_u loss_u 0.9600 (0.9390) acc_u 6.2500 (7.1875) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 746
confident_label rate tensor(0.3223, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 526
clean true:285
clean false:241
clean_rate:0.5418250950570342
noisy true:601
noisy false:505
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1106
epoch [84/200] batch [5/16] time 0.306 (0.335) data 0.228 (0.257) loss_x loss_x 0.2422 (0.3333) acc_x 100.0000 (93.7500) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/16] time 0.352 (0.333) data 0.275 (0.255) loss_x loss_x 0.5054 (0.4613) acc_x 87.5000 (89.0625) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/16] time 0.343 (0.338) data 0.266 (0.260) loss_x loss_x 0.4915 (0.4557) acc_x 90.6250 (89.1667) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/34] time 0.339 (0.339) data 0.261 (0.262) loss_u loss_u 0.9253 (0.9563) acc_u 9.3750 (4.3750) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [10/34] time 0.340 (0.341) data 0.262 (0.263) loss_u loss_u 0.9468 (0.9571) acc_u 6.2500 (4.3750) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [15/34] time 0.335 (0.338) data 0.258 (0.260) loss_u loss_u 0.9443 (0.9396) acc_u 6.2500 (6.8750) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [20/34] time 0.330 (0.338) data 0.252 (0.260) loss_u loss_u 0.9702 (0.9356) acc_u 3.1250 (7.5000) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [25/34] time 0.344 (0.339) data 0.266 (0.261) loss_u loss_u 0.9282 (0.9382) acc_u 6.2500 (7.1250) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [30/34] time 0.332 (0.340) data 0.254 (0.262) loss_u loss_u 0.9854 (0.9401) acc_u 3.1250 (7.0833) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 730
confident_label rate tensor(0.3272, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 534
clean true:286
clean false:248
clean_rate:0.5355805243445693
noisy true:616
noisy false:482
after delete: len(clean_dataset) 534
after delete: len(noisy_dataset) 1098
epoch [85/200] batch [5/16] time 0.305 (0.331) data 0.228 (0.253) loss_x loss_x 0.5874 (0.5422) acc_x 78.1250 (83.1250) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/16] time 0.340 (0.325) data 0.262 (0.247) loss_x loss_x 0.8105 (0.4611) acc_x 78.1250 (86.5625) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/16] time 0.321 (0.330) data 0.243 (0.252) loss_x loss_x 0.5361 (0.5154) acc_x 84.3750 (85.4167) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/34] time 0.333 (0.333) data 0.254 (0.255) loss_u loss_u 0.9946 (0.9556) acc_u 0.0000 (5.0000) lr 1.2639e-03 eta 0:00:09
epoch [85/200] batch [10/34] time 0.325 (0.334) data 0.246 (0.256) loss_u loss_u 0.9937 (0.9664) acc_u 0.0000 (3.7500) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [15/34] time 0.330 (0.335) data 0.253 (0.257) loss_u loss_u 0.9673 (0.9545) acc_u 6.2500 (5.4167) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [20/34] time 0.352 (0.336) data 0.274 (0.258) loss_u loss_u 0.8604 (0.9444) acc_u 15.6250 (6.2500) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [25/34] time 0.341 (0.336) data 0.263 (0.258) loss_u loss_u 0.9678 (0.9463) acc_u 6.2500 (6.2500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [30/34] time 0.339 (0.337) data 0.262 (0.259) loss_u loss_u 0.9028 (0.9449) acc_u 9.3750 (6.5625) lr 1.2639e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 708
confident_label rate tensor(0.3174, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 518
clean true:284
clean false:234
clean_rate:0.5482625482625483
noisy true:640
noisy false:474
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1114
epoch [86/200] batch [5/16] time 0.332 (0.334) data 0.254 (0.257) loss_x loss_x 0.3992 (0.5055) acc_x 90.6250 (87.5000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/16] time 0.300 (0.324) data 0.222 (0.246) loss_x loss_x 0.5527 (0.4840) acc_x 90.6250 (88.4375) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/16] time 0.333 (0.321) data 0.256 (0.244) loss_x loss_x 0.6221 (0.4713) acc_x 87.5000 (89.7917) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/34] time 0.335 (0.325) data 0.258 (0.247) loss_u loss_u 0.9395 (0.9261) acc_u 12.5000 (9.3750) lr 1.2487e-03 eta 0:00:09
epoch [86/200] batch [10/34] time 0.335 (0.326) data 0.257 (0.248) loss_u loss_u 0.8970 (0.9282) acc_u 15.6250 (8.7500) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [15/34] time 0.341 (0.328) data 0.264 (0.251) loss_u loss_u 0.9404 (0.9323) acc_u 6.2500 (8.1250) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [20/34] time 0.340 (0.330) data 0.262 (0.252) loss_u loss_u 0.9028 (0.9320) acc_u 9.3750 (8.2812) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [25/34] time 0.343 (0.332) data 0.265 (0.254) loss_u loss_u 0.9272 (0.9308) acc_u 9.3750 (8.5000) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [30/34] time 0.333 (0.333) data 0.255 (0.255) loss_u loss_u 0.8076 (0.9292) acc_u 18.7500 (8.4375) lr 1.2487e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 705
confident_label rate tensor(0.3211, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 524
clean true:287
clean false:237
clean_rate:0.5477099236641222
noisy true:640
noisy false:468
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1108
epoch [87/200] batch [5/16] time 0.343 (0.346) data 0.266 (0.269) loss_x loss_x 0.4585 (0.3902) acc_x 90.6250 (91.8750) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/16] time 0.337 (0.343) data 0.259 (0.266) loss_x loss_x 0.3218 (0.3628) acc_x 96.8750 (92.1875) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/16] time 0.353 (0.345) data 0.275 (0.267) loss_x loss_x 0.2214 (0.3543) acc_x 96.8750 (92.2917) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/34] time 0.302 (0.341) data 0.223 (0.263) loss_u loss_u 0.9082 (0.9353) acc_u 9.3750 (7.5000) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [10/34] time 0.360 (0.341) data 0.283 (0.263) loss_u loss_u 0.9883 (0.9371) acc_u 0.0000 (7.5000) lr 1.2334e-03 eta 0:00:08
epoch [87/200] batch [15/34] time 0.355 (0.342) data 0.276 (0.265) loss_u loss_u 0.9604 (0.9325) acc_u 3.1250 (7.5000) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [20/34] time 0.337 (0.343) data 0.259 (0.265) loss_u loss_u 0.9434 (0.9354) acc_u 6.2500 (7.3438) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [25/34] time 0.387 (0.347) data 0.309 (0.269) loss_u loss_u 0.9316 (0.9320) acc_u 9.3750 (7.8750) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [30/34] time 0.336 (0.347) data 0.259 (0.269) loss_u loss_u 0.8823 (0.9350) acc_u 15.6250 (7.8125) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 731
confident_label rate tensor(0.3217, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 525
clean true:277
clean false:248
clean_rate:0.5276190476190477
noisy true:624
noisy false:483
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1107
epoch [88/200] batch [5/16] time 0.351 (0.361) data 0.273 (0.283) loss_x loss_x 0.4062 (0.4629) acc_x 93.7500 (89.3750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/16] time 0.347 (0.356) data 0.269 (0.279) loss_x loss_x 0.3772 (0.4728) acc_x 87.5000 (88.1250) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/16] time 0.353 (0.355) data 0.275 (0.277) loss_x loss_x 0.1251 (0.3960) acc_x 100.0000 (90.2083) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/34] time 0.341 (0.343) data 0.263 (0.265) loss_u loss_u 0.9536 (0.9347) acc_u 6.2500 (6.8750) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [10/34] time 0.342 (0.344) data 0.264 (0.267) loss_u loss_u 0.9448 (0.9324) acc_u 6.2500 (7.8125) lr 1.2181e-03 eta 0:00:08
epoch [88/200] batch [15/34] time 0.331 (0.343) data 0.252 (0.265) loss_u loss_u 0.9658 (0.9314) acc_u 3.1250 (7.9167) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [20/34] time 0.296 (0.340) data 0.218 (0.262) loss_u loss_u 0.9502 (0.9349) acc_u 9.3750 (7.6562) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [25/34] time 0.350 (0.340) data 0.272 (0.262) loss_u loss_u 0.9282 (0.9349) acc_u 9.3750 (7.6250) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [30/34] time 0.338 (0.340) data 0.260 (0.263) loss_u loss_u 0.9028 (0.9369) acc_u 12.5000 (7.5000) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 719
confident_label rate tensor(0.3211, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 524
clean true:290
clean false:234
clean_rate:0.5534351145038168
noisy true:623
noisy false:485
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1108
epoch [89/200] batch [5/16] time 0.351 (0.352) data 0.274 (0.274) loss_x loss_x 0.2849 (0.5058) acc_x 93.7500 (88.1250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/16] time 0.353 (0.350) data 0.275 (0.273) loss_x loss_x 0.2839 (0.4171) acc_x 93.7500 (90.6250) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/16] time 0.354 (0.348) data 0.277 (0.271) loss_x loss_x 0.3484 (0.4134) acc_x 93.7500 (90.6250) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/34] time 0.324 (0.341) data 0.247 (0.264) loss_u loss_u 0.8960 (0.8962) acc_u 12.5000 (12.5000) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [10/34] time 0.340 (0.342) data 0.263 (0.264) loss_u loss_u 0.9331 (0.9164) acc_u 6.2500 (10.0000) lr 1.2028e-03 eta 0:00:08
epoch [89/200] batch [15/34] time 0.338 (0.341) data 0.261 (0.263) loss_u loss_u 0.9990 (0.9251) acc_u 0.0000 (8.5417) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [20/34] time 0.335 (0.341) data 0.257 (0.264) loss_u loss_u 0.9141 (0.9207) acc_u 9.3750 (9.0625) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [25/34] time 0.336 (0.342) data 0.259 (0.264) loss_u loss_u 0.9551 (0.9284) acc_u 6.2500 (8.1250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [30/34] time 0.322 (0.341) data 0.244 (0.264) loss_u loss_u 0.9443 (0.9287) acc_u 6.2500 (8.2292) lr 1.2028e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 748
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 522
clean true:281
clean false:241
clean_rate:0.5383141762452107
noisy true:603
noisy false:507
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1110
epoch [90/200] batch [5/16] time 0.339 (0.341) data 0.262 (0.264) loss_x loss_x 0.1772 (0.3400) acc_x 96.8750 (91.8750) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/16] time 0.342 (0.342) data 0.265 (0.264) loss_x loss_x 0.3525 (0.3278) acc_x 87.5000 (91.2500) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/16] time 0.349 (0.344) data 0.272 (0.266) loss_x loss_x 0.5483 (0.3415) acc_x 84.3750 (91.2500) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/34] time 0.302 (0.333) data 0.224 (0.255) loss_u loss_u 0.9043 (0.9469) acc_u 9.3750 (6.2500) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [10/34] time 0.344 (0.334) data 0.266 (0.256) loss_u loss_u 0.8037 (0.9229) acc_u 21.8750 (10.0000) lr 1.1874e-03 eta 0:00:08
epoch [90/200] batch [15/34] time 0.331 (0.333) data 0.254 (0.256) loss_u loss_u 0.8726 (0.9229) acc_u 15.6250 (10.0000) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [20/34] time 0.349 (0.335) data 0.270 (0.257) loss_u loss_u 0.9639 (0.9300) acc_u 3.1250 (8.9062) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [25/34] time 0.342 (0.335) data 0.263 (0.257) loss_u loss_u 0.9312 (0.9302) acc_u 9.3750 (8.8750) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [30/34] time 0.358 (0.336) data 0.279 (0.258) loss_u loss_u 0.9697 (0.9285) acc_u 6.2500 (9.2708) lr 1.1874e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 753
confident_label rate tensor(0.3235, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 528
clean true:283
clean false:245
clean_rate:0.5359848484848485
noisy true:596
noisy false:508
after delete: len(clean_dataset) 528
after delete: len(noisy_dataset) 1104
epoch [91/200] batch [5/16] time 0.346 (0.352) data 0.268 (0.274) loss_x loss_x 0.2700 (0.3508) acc_x 93.7500 (91.2500) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/16] time 0.350 (0.346) data 0.271 (0.269) loss_x loss_x 0.2319 (0.3864) acc_x 93.7500 (90.3125) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/16] time 0.341 (0.346) data 0.264 (0.268) loss_x loss_x 0.4287 (0.4066) acc_x 84.3750 (89.3750) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/34] time 0.342 (0.342) data 0.264 (0.264) loss_u loss_u 0.9287 (0.9263) acc_u 9.3750 (9.3750) lr 1.1719e-03 eta 0:00:09
epoch [91/200] batch [10/34] time 0.337 (0.340) data 0.259 (0.262) loss_u loss_u 0.9463 (0.9396) acc_u 6.2500 (7.1875) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [15/34] time 0.367 (0.341) data 0.289 (0.263) loss_u loss_u 0.9292 (0.9357) acc_u 9.3750 (7.5000) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [20/34] time 0.348 (0.341) data 0.270 (0.263) loss_u loss_u 0.9707 (0.9385) acc_u 6.2500 (7.3438) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [25/34] time 0.353 (0.342) data 0.274 (0.264) loss_u loss_u 0.9561 (0.9352) acc_u 6.2500 (7.6250) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [30/34] time 0.345 (0.342) data 0.268 (0.264) loss_u loss_u 0.9331 (0.9391) acc_u 6.2500 (6.9792) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 725
confident_label rate tensor(0.3290, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 537
clean true:289
clean false:248
clean_rate:0.5381750465549349
noisy true:618
noisy false:477
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1095
epoch [92/200] batch [5/16] time 0.350 (0.347) data 0.273 (0.270) loss_x loss_x 0.4612 (0.4894) acc_x 90.6250 (89.3750) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/16] time 0.330 (0.347) data 0.252 (0.269) loss_x loss_x 0.3494 (0.4267) acc_x 90.6250 (90.3125) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/16] time 0.301 (0.336) data 0.223 (0.258) loss_x loss_x 0.2888 (0.4529) acc_x 90.6250 (89.7917) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/34] time 0.343 (0.332) data 0.266 (0.254) loss_u loss_u 0.9858 (0.9780) acc_u 0.0000 (2.5000) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [10/34] time 0.334 (0.333) data 0.256 (0.255) loss_u loss_u 0.9658 (0.9515) acc_u 3.1250 (5.3125) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [15/34] time 0.347 (0.335) data 0.270 (0.258) loss_u loss_u 0.9316 (0.9445) acc_u 6.2500 (6.0417) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [20/34] time 0.348 (0.337) data 0.270 (0.259) loss_u loss_u 0.8984 (0.9403) acc_u 12.5000 (6.8750) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [25/34] time 0.339 (0.338) data 0.262 (0.260) loss_u loss_u 0.9658 (0.9397) acc_u 3.1250 (7.1250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [30/34] time 0.335 (0.338) data 0.257 (0.260) loss_u loss_u 0.9678 (0.9404) acc_u 3.1250 (6.9792) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 757
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 522
clean true:274
clean false:248
clean_rate:0.524904214559387
noisy true:601
noisy false:509
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1110
epoch [93/200] batch [5/16] time 0.336 (0.343) data 0.258 (0.265) loss_x loss_x 0.4993 (0.3492) acc_x 90.6250 (90.0000) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/16] time 0.344 (0.339) data 0.267 (0.262) loss_x loss_x 0.2534 (0.3522) acc_x 96.8750 (91.5625) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/16] time 0.306 (0.332) data 0.228 (0.254) loss_x loss_x 0.3977 (0.3967) acc_x 87.5000 (90.2083) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/34] time 0.357 (0.335) data 0.279 (0.257) loss_u loss_u 0.9629 (0.9581) acc_u 3.1250 (5.0000) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [10/34] time 0.351 (0.337) data 0.273 (0.259) loss_u loss_u 0.9761 (0.9510) acc_u 3.1250 (5.9375) lr 1.1409e-03 eta 0:00:08
epoch [93/200] batch [15/34] time 0.342 (0.338) data 0.264 (0.260) loss_u loss_u 0.9702 (0.9477) acc_u 3.1250 (6.0417) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [20/34] time 0.341 (0.336) data 0.263 (0.259) loss_u loss_u 0.8975 (0.9409) acc_u 15.6250 (7.0312) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [25/34] time 0.354 (0.338) data 0.276 (0.260) loss_u loss_u 0.9790 (0.9397) acc_u 0.0000 (6.8750) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [30/34] time 0.366 (0.339) data 0.287 (0.261) loss_u loss_u 0.9604 (0.9366) acc_u 3.1250 (7.2917) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 747
confident_label rate tensor(0.3254, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 531
clean true:278
clean false:253
clean_rate:0.5235404896421846
noisy true:607
noisy false:494
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1101
epoch [94/200] batch [5/16] time 0.327 (0.342) data 0.249 (0.264) loss_x loss_x 0.4961 (0.4748) acc_x 84.3750 (87.5000) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/16] time 0.327 (0.337) data 0.249 (0.259) loss_x loss_x 0.3704 (0.4285) acc_x 90.6250 (88.4375) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/16] time 0.301 (0.326) data 0.223 (0.248) loss_x loss_x 0.3325 (0.3862) acc_x 90.6250 (89.5833) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/34] time 0.348 (0.328) data 0.270 (0.250) loss_u loss_u 0.9697 (0.9527) acc_u 3.1250 (4.3750) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [10/34] time 0.335 (0.332) data 0.257 (0.254) loss_u loss_u 0.9390 (0.9434) acc_u 6.2500 (6.2500) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [15/34] time 0.361 (0.335) data 0.283 (0.257) loss_u loss_u 0.9756 (0.9395) acc_u 3.1250 (6.8750) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [20/34] time 0.344 (0.337) data 0.266 (0.259) loss_u loss_u 0.9351 (0.9388) acc_u 9.3750 (7.1875) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [25/34] time 0.339 (0.339) data 0.262 (0.261) loss_u loss_u 0.8901 (0.9361) acc_u 12.5000 (7.6250) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [30/34] time 0.336 (0.338) data 0.258 (0.260) loss_u loss_u 0.9771 (0.9381) acc_u 3.1250 (7.3958) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 719
confident_label rate tensor(0.3272, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 534
clean true:283
clean false:251
clean_rate:0.5299625468164794
noisy true:630
noisy false:468
after delete: len(clean_dataset) 534
after delete: len(noisy_dataset) 1098
epoch [95/200] batch [5/16] time 0.345 (0.349) data 0.268 (0.271) loss_x loss_x 0.2100 (0.3997) acc_x 96.8750 (90.6250) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/16] time 0.341 (0.346) data 0.264 (0.268) loss_x loss_x 0.2141 (0.3348) acc_x 96.8750 (91.8750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/16] time 0.295 (0.331) data 0.216 (0.253) loss_x loss_x 0.4841 (0.3543) acc_x 90.6250 (91.6667) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/34] time 0.340 (0.330) data 0.262 (0.252) loss_u loss_u 0.9668 (0.9496) acc_u 3.1250 (5.6250) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [10/34] time 0.340 (0.332) data 0.262 (0.255) loss_u loss_u 0.9951 (0.9475) acc_u 0.0000 (5.6250) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [15/34] time 0.317 (0.332) data 0.239 (0.254) loss_u loss_u 0.9209 (0.9477) acc_u 9.3750 (5.8333) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [20/34] time 0.335 (0.333) data 0.258 (0.255) loss_u loss_u 0.9111 (0.9449) acc_u 9.3750 (6.0938) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [25/34] time 0.338 (0.334) data 0.260 (0.257) loss_u loss_u 0.9468 (0.9416) acc_u 6.2500 (6.5000) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [30/34] time 0.326 (0.334) data 0.249 (0.257) loss_u loss_u 0.9131 (0.9390) acc_u 12.5000 (6.9792) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 711
confident_label rate tensor(0.3254, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 531
clean true:283
clean false:248
clean_rate:0.5329566854990584
noisy true:638
noisy false:463
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1101
epoch [96/200] batch [5/16] time 0.345 (0.346) data 0.268 (0.269) loss_x loss_x 0.2778 (0.3717) acc_x 96.8750 (88.7500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/16] time 0.350 (0.346) data 0.273 (0.268) loss_x loss_x 0.2861 (0.3415) acc_x 96.8750 (91.8750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/16] time 0.324 (0.341) data 0.247 (0.264) loss_x loss_x 0.1946 (0.3244) acc_x 93.7500 (92.5000) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/34] time 0.307 (0.332) data 0.228 (0.255) loss_u loss_u 0.9209 (0.9409) acc_u 9.3750 (6.8750) lr 1.0941e-03 eta 0:00:09
epoch [96/200] batch [10/34] time 0.337 (0.328) data 0.259 (0.251) loss_u loss_u 0.8799 (0.9373) acc_u 15.6250 (6.8750) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [15/34] time 0.327 (0.330) data 0.249 (0.252) loss_u loss_u 0.9941 (0.9457) acc_u 3.1250 (6.2500) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [20/34] time 0.343 (0.333) data 0.265 (0.255) loss_u loss_u 0.9331 (0.9382) acc_u 6.2500 (7.1875) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [25/34] time 0.339 (0.334) data 0.262 (0.256) loss_u loss_u 0.9102 (0.9390) acc_u 9.3750 (6.8750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [30/34] time 0.346 (0.335) data 0.268 (0.257) loss_u loss_u 0.9092 (0.9397) acc_u 12.5000 (6.8750) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 718
confident_label rate tensor(0.3266, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 533
clean true:290
clean false:243
clean_rate:0.5440900562851783
noisy true:624
noisy false:475
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1099
epoch [97/200] batch [5/16] time 0.342 (0.347) data 0.265 (0.269) loss_x loss_x 0.2917 (0.3500) acc_x 100.0000 (93.1250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/16] time 0.339 (0.353) data 0.262 (0.275) loss_x loss_x 0.3962 (0.3499) acc_x 93.7500 (92.5000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/16] time 0.313 (0.340) data 0.236 (0.262) loss_x loss_x 0.6577 (0.3972) acc_x 90.6250 (90.4167) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/34] time 0.311 (0.332) data 0.232 (0.255) loss_u loss_u 0.9297 (0.9407) acc_u 12.5000 (8.1250) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [10/34] time 0.352 (0.334) data 0.275 (0.257) loss_u loss_u 0.9155 (0.9357) acc_u 12.5000 (8.4375) lr 1.0785e-03 eta 0:00:08
epoch [97/200] batch [15/34] time 0.367 (0.337) data 0.288 (0.259) loss_u loss_u 0.9604 (0.9421) acc_u 6.2500 (7.5000) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [20/34] time 0.351 (0.338) data 0.273 (0.260) loss_u loss_u 0.9683 (0.9369) acc_u 3.1250 (7.6562) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [25/34] time 0.340 (0.337) data 0.262 (0.259) loss_u loss_u 0.9277 (0.9331) acc_u 9.3750 (8.1250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [30/34] time 0.355 (0.341) data 0.277 (0.263) loss_u loss_u 0.8940 (0.9293) acc_u 12.5000 (8.6458) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 716
confident_label rate tensor(0.3352, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 547
clean true:289
clean false:258
clean_rate:0.5283363802559415
noisy true:627
noisy false:458
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1085
epoch [98/200] batch [5/17] time 0.352 (0.349) data 0.275 (0.271) loss_x loss_x 0.1539 (0.2510) acc_x 96.8750 (95.0000) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [10/17] time 0.348 (0.344) data 0.271 (0.267) loss_x loss_x 0.4802 (0.3796) acc_x 84.3750 (92.8125) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/17] time 0.336 (0.344) data 0.259 (0.267) loss_x loss_x 0.4375 (0.3906) acc_x 87.5000 (91.4583) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/33] time 0.307 (0.336) data 0.228 (0.258) loss_u loss_u 0.9980 (0.9482) acc_u 0.0000 (6.8750) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [10/33] time 0.353 (0.335) data 0.276 (0.258) loss_u loss_u 0.9067 (0.9533) acc_u 12.5000 (5.9375) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [15/33] time 0.356 (0.337) data 0.279 (0.260) loss_u loss_u 0.8711 (0.9468) acc_u 15.6250 (6.8750) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [20/33] time 0.317 (0.338) data 0.240 (0.260) loss_u loss_u 0.9448 (0.9422) acc_u 6.2500 (7.1875) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [25/33] time 0.341 (0.339) data 0.264 (0.261) loss_u loss_u 0.9321 (0.9436) acc_u 9.3750 (6.8750) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [30/33] time 0.341 (0.339) data 0.264 (0.262) loss_u loss_u 0.9590 (0.9424) acc_u 3.1250 (6.7708) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 731
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 548
clean true:286
clean false:262
clean_rate:0.5218978102189781
noisy true:615
noisy false:469
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1084
epoch [99/200] batch [5/17] time 0.351 (0.345) data 0.273 (0.267) loss_x loss_x 0.2085 (0.4409) acc_x 96.8750 (90.0000) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/17] time 0.340 (0.341) data 0.262 (0.263) loss_x loss_x 0.5190 (0.4319) acc_x 90.6250 (89.3750) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/17] time 0.294 (0.338) data 0.217 (0.261) loss_x loss_x 0.3125 (0.3982) acc_x 90.6250 (90.6250) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/33] time 0.311 (0.330) data 0.232 (0.252) loss_u loss_u 0.9185 (0.9248) acc_u 9.3750 (8.7500) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [10/33] time 0.345 (0.332) data 0.268 (0.254) loss_u loss_u 0.9897 (0.9429) acc_u 0.0000 (6.5625) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [15/33] time 0.339 (0.334) data 0.262 (0.256) loss_u loss_u 0.9229 (0.9311) acc_u 6.2500 (7.9167) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [20/33] time 0.332 (0.335) data 0.254 (0.257) loss_u loss_u 0.9277 (0.9348) acc_u 9.3750 (7.6562) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [25/33] time 0.357 (0.336) data 0.278 (0.258) loss_u loss_u 0.8984 (0.9315) acc_u 9.3750 (8.0000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [30/33] time 0.337 (0.337) data 0.260 (0.259) loss_u loss_u 0.9766 (0.9370) acc_u 3.1250 (7.1875) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 730
confident_label rate tensor(0.3315, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 541
clean true:286
clean false:255
clean_rate:0.5286506469500925
noisy true:616
noisy false:475
all clean rate:  [0.9320388349514563, 0.9848484848484849, 0.9620253164556962, 0.9570815450643777, 0.9450980392156862, 0.9471544715447154, 0.9537815126050421, 0.9510204081632653, 0.9553903345724907, 0.922509225092251, 0.9198473282442748, 0.9407407407407408, 0.9187279151943463, 0.8951310861423221, 0.8566433566433567, 0.845360824742268, 0.8260869565217391, 0.7894736842105263, 0.8235294117647058, 0.8067484662576687, 0.774390243902439, 0.7962962962962963, 0.7543352601156069, 0.7724550898203593, 0.7277777777777777, 0.7122507122507122, 0.7308707124010554, 0.7108753315649867, 0.6984536082474226, 0.6928746928746928, 0.7012658227848101, 0.689119170984456, 0.6683417085427136, 0.6863753213367609, 0.6572164948453608, 0.6790123456790124, 0.6675126903553299, 0.6791044776119403, 0.6650366748166259, 0.6675126903553299, 0.6619718309859155, 0.6859903381642513, 0.6732673267326733, 0.6357142857142857, 0.6445497630331753, 0.6218097447795824, 0.6472019464720195, 0.6312056737588653, 0.6452380952380953, 0.6302325581395349, 0.6547619047619048, 0.6338672768878718, 0.6382022471910113, 0.6227678571428571, 0.6434782608695652, 0.6216216216216216, 0.6361607142857143, 0.621978021978022, 0.6127659574468085, 0.6039387308533917, 0.6022222222222222, 0.6030042918454935, 0.6093418259023354, 0.6029106029106029, 0.6150442477876106, 0.5916666666666667, 0.6059322033898306, 0.589010989010989, 0.5923566878980892, 0.5921325051759835, 0.5821205821205822, 0.5702479338842975, 0.5571725571725572, 0.544, 0.5568862275449101, 0.5557729941291585, 0.5604838709677419, 0.5511022044088176, 0.5535714285714286, 0.5483234714003945, 0.5495145631067961, 0.5578512396694215, 0.5433526011560693, 0.5418250950570342, 0.5355805243445693, 0.5482625482625483, 0.5477099236641222, 0.5276190476190477, 0.5534351145038168, 0.5383141762452107, 0.5359848484848485, 0.5381750465549349, 0.524904214559387, 0.5235404896421846, 0.5299625468164794, 0.5329566854990584, 0.5440900562851783, 0.5283363802559415, 0.5218978102189781, 0.5286506469500925]
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1091
epoch [100/200] batch [5/16] time 0.335 (0.347) data 0.257 (0.269) loss_x loss_x 0.3179 (0.4318) acc_x 93.7500 (89.3750) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/16] time 0.338 (0.344) data 0.260 (0.266) loss_x loss_x 0.3162 (0.3906) acc_x 93.7500 (89.3750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/16] time 0.341 (0.342) data 0.264 (0.264) loss_x loss_x 0.4399 (0.3730) acc_x 87.5000 (90.4167) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/34] time 0.310 (0.337) data 0.232 (0.260) loss_u loss_u 0.9717 (0.9531) acc_u 3.1250 (5.6250) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [10/34] time 0.308 (0.332) data 0.229 (0.254) loss_u loss_u 0.8853 (0.9301) acc_u 12.5000 (8.4375) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [15/34] time 0.353 (0.333) data 0.275 (0.255) loss_u loss_u 0.9282 (0.9353) acc_u 6.2500 (7.5000) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [20/34] time 0.346 (0.335) data 0.269 (0.258) loss_u loss_u 0.9390 (0.9382) acc_u 6.2500 (7.1875) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [25/34] time 0.298 (0.334) data 0.221 (0.256) loss_u loss_u 0.9736 (0.9386) acc_u 3.1250 (7.2500) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [30/34] time 0.328 (0.332) data 0.250 (0.254) loss_u loss_u 0.9644 (0.9410) acc_u 3.1250 (7.1875) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 724
confident_label rate tensor(0.3290, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 537
clean true:279
clean false:258
clean_rate:0.5195530726256983
noisy true:629
noisy false:466
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1095
epoch [101/200] batch [5/16] time 0.347 (0.354) data 0.270 (0.276) loss_x loss_x 0.2334 (0.3284) acc_x 96.8750 (93.1250) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/16] time 0.329 (0.344) data 0.252 (0.266) loss_x loss_x 0.4104 (0.3708) acc_x 90.6250 (91.2500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/16] time 0.330 (0.340) data 0.252 (0.263) loss_x loss_x 0.4392 (0.3925) acc_x 90.6250 (90.8333) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/34] time 0.341 (0.340) data 0.263 (0.262) loss_u loss_u 0.9453 (0.9226) acc_u 9.3750 (10.0000) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [10/34] time 0.306 (0.340) data 0.227 (0.262) loss_u loss_u 0.9688 (0.9424) acc_u 3.1250 (6.8750) lr 1.0157e-03 eta 0:00:08
epoch [101/200] batch [15/34] time 0.336 (0.335) data 0.257 (0.257) loss_u loss_u 0.8979 (0.9365) acc_u 12.5000 (7.7083) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [20/34] time 0.345 (0.335) data 0.268 (0.257) loss_u loss_u 0.8638 (0.9370) acc_u 15.6250 (7.5000) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [25/34] time 0.344 (0.336) data 0.267 (0.258) loss_u loss_u 0.9160 (0.9317) acc_u 9.3750 (8.2500) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [30/34] time 0.349 (0.337) data 0.269 (0.259) loss_u loss_u 0.9004 (0.9321) acc_u 9.3750 (8.1250) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 719
confident_label rate tensor(0.3333, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 544
clean true:283
clean false:261
clean_rate:0.5202205882352942
noisy true:630
noisy false:458
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 1088
epoch [102/200] batch [5/17] time 0.339 (0.346) data 0.262 (0.268) loss_x loss_x 0.3303 (0.4293) acc_x 93.7500 (92.5000) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/17] time 0.343 (0.347) data 0.266 (0.269) loss_x loss_x 0.2739 (0.4095) acc_x 93.7500 (91.8750) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/17] time 0.339 (0.344) data 0.262 (0.267) loss_x loss_x 0.3501 (0.3916) acc_x 87.5000 (91.8750) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/34] time 0.360 (0.343) data 0.281 (0.265) loss_u loss_u 0.9893 (0.9727) acc_u 0.0000 (2.5000) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [10/34] time 0.350 (0.344) data 0.273 (0.266) loss_u loss_u 0.9375 (0.9456) acc_u 6.2500 (5.9375) lr 1.0000e-03 eta 0:00:08
epoch [102/200] batch [15/34] time 0.300 (0.339) data 0.221 (0.261) loss_u loss_u 0.9028 (0.9451) acc_u 9.3750 (5.8333) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [20/34] time 0.351 (0.337) data 0.273 (0.259) loss_u loss_u 0.9644 (0.9406) acc_u 3.1250 (6.4062) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [25/34] time 0.319 (0.338) data 0.241 (0.260) loss_u loss_u 0.9609 (0.9353) acc_u 3.1250 (6.8750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [30/34] time 0.355 (0.339) data 0.277 (0.261) loss_u loss_u 0.9683 (0.9380) acc_u 3.1250 (6.5625) lr 1.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 737
confident_label rate tensor(0.3346, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 546
clean true:291
clean false:255
clean_rate:0.532967032967033
noisy true:604
noisy false:482
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 1086
epoch [103/200] batch [5/17] time 0.334 (0.340) data 0.257 (0.262) loss_x loss_x 0.6743 (0.4468) acc_x 84.3750 (88.7500) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [10/17] time 0.344 (0.338) data 0.267 (0.261) loss_x loss_x 0.4314 (0.4075) acc_x 84.3750 (89.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/17] time 0.312 (0.326) data 0.235 (0.249) loss_x loss_x 0.5439 (0.4196) acc_x 78.1250 (87.9167) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/33] time 0.333 (0.328) data 0.255 (0.250) loss_u loss_u 0.9438 (0.9419) acc_u 6.2500 (6.2500) lr 9.8429e-04 eta 0:00:09
epoch [103/200] batch [10/33] time 0.346 (0.331) data 0.267 (0.253) loss_u loss_u 0.8994 (0.9329) acc_u 12.5000 (7.8125) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [15/33] time 0.307 (0.327) data 0.228 (0.249) loss_u loss_u 0.9341 (0.9343) acc_u 6.2500 (7.2917) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [20/33] time 0.341 (0.330) data 0.263 (0.252) loss_u loss_u 0.8760 (0.9389) acc_u 15.6250 (6.8750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [25/33] time 0.343 (0.331) data 0.266 (0.254) loss_u loss_u 0.8804 (0.9356) acc_u 12.5000 (7.1250) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [30/33] time 0.339 (0.332) data 0.262 (0.254) loss_u loss_u 0.9819 (0.9387) acc_u 0.0000 (6.7708) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 731
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 562
clean true:287
clean false:275
clean_rate:0.5106761565836299
noisy true:614
noisy false:456
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1070
epoch [104/200] batch [5/17] time 0.356 (0.353) data 0.279 (0.275) loss_x loss_x 0.3894 (0.4544) acc_x 87.5000 (86.2500) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/17] time 0.357 (0.349) data 0.279 (0.271) loss_x loss_x 0.4058 (0.4062) acc_x 87.5000 (88.1250) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/17] time 0.337 (0.346) data 0.260 (0.269) loss_x loss_x 0.5615 (0.3946) acc_x 84.3750 (88.7500) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/33] time 0.348 (0.346) data 0.270 (0.268) loss_u loss_u 0.9800 (0.9352) acc_u 3.1250 (6.2500) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [10/33] time 0.317 (0.345) data 0.238 (0.268) loss_u loss_u 0.9810 (0.9404) acc_u 3.1250 (6.5625) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [15/33] time 0.296 (0.339) data 0.217 (0.261) loss_u loss_u 0.9712 (0.9475) acc_u 3.1250 (5.4167) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [20/33] time 0.340 (0.338) data 0.262 (0.260) loss_u loss_u 0.9658 (0.9545) acc_u 3.1250 (4.8438) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [25/33] time 0.346 (0.338) data 0.269 (0.261) loss_u loss_u 0.9819 (0.9537) acc_u 0.0000 (5.1250) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [30/33] time 0.342 (0.339) data 0.264 (0.261) loss_u loss_u 0.9150 (0.9510) acc_u 12.5000 (5.6250) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 711
confident_label rate tensor(0.3364, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 549
clean true:291
clean false:258
clean_rate:0.5300546448087432
noisy true:630
noisy false:453
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1083
epoch [105/200] batch [5/17] time 0.351 (0.342) data 0.274 (0.264) loss_x loss_x 0.4370 (0.3641) acc_x 84.3750 (90.0000) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/17] time 0.352 (0.347) data 0.274 (0.270) loss_x loss_x 0.1992 (0.3580) acc_x 100.0000 (91.2500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/17] time 0.345 (0.346) data 0.267 (0.269) loss_x loss_x 0.2522 (0.3706) acc_x 90.6250 (90.6250) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/33] time 0.344 (0.346) data 0.267 (0.268) loss_u loss_u 0.9639 (0.9364) acc_u 3.1250 (8.1250) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [10/33] time 0.329 (0.344) data 0.251 (0.266) loss_u loss_u 0.9326 (0.9328) acc_u 9.3750 (8.1250) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [15/33] time 0.346 (0.342) data 0.267 (0.264) loss_u loss_u 0.9683 (0.9349) acc_u 3.1250 (8.3333) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [20/33] time 0.338 (0.341) data 0.260 (0.264) loss_u loss_u 0.9468 (0.9379) acc_u 6.2500 (7.8125) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [25/33] time 0.336 (0.342) data 0.258 (0.264) loss_u loss_u 0.9355 (0.9406) acc_u 6.2500 (7.6250) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [30/33] time 0.295 (0.339) data 0.217 (0.262) loss_u loss_u 0.9556 (0.9412) acc_u 6.2500 (7.5000) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 739
confident_label rate tensor(0.3401, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 555
clean true:287
clean false:268
clean_rate:0.5171171171171172
noisy true:606
noisy false:471
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1077
epoch [106/200] batch [5/17] time 0.339 (0.344) data 0.262 (0.266) loss_x loss_x 0.4199 (0.3679) acc_x 87.5000 (90.6250) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [10/17] time 0.345 (0.344) data 0.268 (0.267) loss_x loss_x 0.1145 (0.3637) acc_x 100.0000 (91.2500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/17] time 0.333 (0.344) data 0.256 (0.267) loss_x loss_x 0.7510 (0.4090) acc_x 78.1250 (89.7917) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/33] time 0.340 (0.341) data 0.263 (0.263) loss_u loss_u 0.9790 (0.9610) acc_u 3.1250 (4.3750) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [10/33] time 0.317 (0.334) data 0.239 (0.256) loss_u loss_u 0.9761 (0.9416) acc_u 3.1250 (6.5625) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [15/33] time 0.337 (0.332) data 0.260 (0.254) loss_u loss_u 0.9258 (0.9446) acc_u 9.3750 (6.2500) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [20/33] time 0.343 (0.335) data 0.265 (0.257) loss_u loss_u 0.9727 (0.9416) acc_u 3.1250 (6.8750) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [25/33] time 0.324 (0.336) data 0.246 (0.259) loss_u loss_u 0.9248 (0.9398) acc_u 9.3750 (7.0000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [30/33] time 0.341 (0.337) data 0.263 (0.259) loss_u loss_u 0.9380 (0.9371) acc_u 9.3750 (7.5000) lr 9.3721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 761
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 562
clean true:280
clean false:282
clean_rate:0.498220640569395
noisy true:591
noisy false:479
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1070
epoch [107/200] batch [5/17] time 0.341 (0.372) data 0.263 (0.294) loss_x loss_x 0.4124 (0.4490) acc_x 90.6250 (91.2500) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [10/17] time 0.356 (0.359) data 0.278 (0.282) loss_x loss_x 0.1359 (0.4020) acc_x 100.0000 (92.1875) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/17] time 0.310 (0.350) data 0.231 (0.272) loss_x loss_x 0.3745 (0.4163) acc_x 90.6250 (91.8750) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/33] time 0.361 (0.348) data 0.282 (0.270) loss_u loss_u 0.9194 (0.9219) acc_u 9.3750 (9.3750) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [10/33] time 0.311 (0.346) data 0.232 (0.268) loss_u loss_u 0.9336 (0.9284) acc_u 9.3750 (8.7500) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [15/33] time 0.331 (0.344) data 0.252 (0.266) loss_u loss_u 0.9883 (0.9356) acc_u 0.0000 (7.5000) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [20/33] time 0.348 (0.344) data 0.270 (0.266) loss_u loss_u 0.8916 (0.9309) acc_u 12.5000 (8.1250) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [25/33] time 0.323 (0.344) data 0.244 (0.266) loss_u loss_u 0.9507 (0.9343) acc_u 9.3750 (8.0000) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [30/33] time 0.290 (0.338) data 0.212 (0.260) loss_u loss_u 0.9790 (0.9384) acc_u 3.1250 (7.3958) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 734
confident_label rate tensor(0.3462, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 565
clean true:294
clean false:271
clean_rate:0.5203539823008849
noisy true:604
noisy false:463
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1067
epoch [108/200] batch [5/17] time 0.344 (0.342) data 0.266 (0.264) loss_x loss_x 0.4006 (0.4534) acc_x 87.5000 (85.6250) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [10/17] time 0.364 (0.344) data 0.286 (0.266) loss_x loss_x 0.2502 (0.4122) acc_x 93.7500 (88.7500) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/17] time 0.295 (0.343) data 0.218 (0.265) loss_x loss_x 0.4292 (0.4239) acc_x 90.6250 (88.9583) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/33] time 0.334 (0.336) data 0.256 (0.258) loss_u loss_u 0.9497 (0.9481) acc_u 3.1250 (5.0000) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [10/33] time 0.296 (0.336) data 0.218 (0.258) loss_u loss_u 0.8838 (0.9410) acc_u 12.5000 (6.5625) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [15/33] time 0.319 (0.331) data 0.242 (0.253) loss_u loss_u 0.9233 (0.9450) acc_u 12.5000 (6.2500) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [20/33] time 0.340 (0.333) data 0.262 (0.255) loss_u loss_u 0.9688 (0.9382) acc_u 3.1250 (7.1875) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [25/33] time 0.335 (0.335) data 0.257 (0.257) loss_u loss_u 0.9995 (0.9413) acc_u 0.0000 (6.7500) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [30/33] time 0.352 (0.335) data 0.273 (0.257) loss_u loss_u 0.9341 (0.9425) acc_u 9.3750 (6.6667) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 741
confident_label rate tensor(0.3339, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 545
clean true:284
clean false:261
clean_rate:0.5211009174311927
noisy true:607
noisy false:480
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1087
epoch [109/200] batch [5/17] time 0.398 (0.364) data 0.319 (0.286) loss_x loss_x 0.5020 (0.4199) acc_x 84.3750 (88.7500) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [10/17] time 0.349 (0.363) data 0.272 (0.284) loss_x loss_x 0.5098 (0.4300) acc_x 90.6250 (88.4375) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/17] time 0.354 (0.357) data 0.277 (0.279) loss_x loss_x 0.2715 (0.4124) acc_x 90.6250 (89.7917) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/33] time 0.345 (0.353) data 0.268 (0.275) loss_u loss_u 0.9648 (0.9339) acc_u 6.2500 (9.3750) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [10/33] time 0.339 (0.352) data 0.261 (0.274) loss_u loss_u 0.8325 (0.9247) acc_u 18.7500 (9.3750) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [15/33] time 0.310 (0.348) data 0.231 (0.270) loss_u loss_u 0.8916 (0.9203) acc_u 12.5000 (9.5833) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [20/33] time 0.340 (0.344) data 0.262 (0.266) loss_u loss_u 0.9985 (0.9246) acc_u 0.0000 (8.9062) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [25/33] time 0.347 (0.345) data 0.268 (0.267) loss_u loss_u 0.9580 (0.9222) acc_u 3.1250 (9.0000) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [30/33] time 0.357 (0.344) data 0.278 (0.266) loss_u loss_u 0.8999 (0.9211) acc_u 15.6250 (9.4792) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 743
confident_label rate tensor(0.3474, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 567
clean true:285
clean false:282
clean_rate:0.5026455026455027
noisy true:604
noisy false:461
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1065
epoch [110/200] batch [5/17] time 0.340 (0.357) data 0.263 (0.280) loss_x loss_x 0.3645 (0.3746) acc_x 84.3750 (89.3750) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/17] time 0.342 (0.350) data 0.265 (0.272) loss_x loss_x 0.4368 (0.3631) acc_x 90.6250 (89.6875) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/17] time 0.343 (0.346) data 0.266 (0.269) loss_x loss_x 0.2847 (0.3537) acc_x 90.6250 (90.0000) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/33] time 0.305 (0.343) data 0.227 (0.265) loss_u loss_u 0.9966 (0.9479) acc_u 0.0000 (5.6250) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [10/33] time 0.298 (0.341) data 0.220 (0.263) loss_u loss_u 0.9736 (0.9451) acc_u 3.1250 (6.2500) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [15/33] time 0.302 (0.334) data 0.224 (0.256) loss_u loss_u 0.8633 (0.9348) acc_u 15.6250 (7.5000) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [20/33] time 0.340 (0.335) data 0.262 (0.257) loss_u loss_u 0.9204 (0.9353) acc_u 9.3750 (7.3438) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [25/33] time 0.341 (0.336) data 0.264 (0.258) loss_u loss_u 0.9180 (0.9403) acc_u 9.3750 (6.8750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [30/33] time 0.352 (0.337) data 0.274 (0.259) loss_u loss_u 0.9414 (0.9396) acc_u 6.2500 (6.9792) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 733
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 548
clean true:284
clean false:264
clean_rate:0.5182481751824818
noisy true:615
noisy false:469
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1084
epoch [111/200] batch [5/17] time 0.358 (0.365) data 0.280 (0.287) loss_x loss_x 0.2223 (0.4602) acc_x 96.8750 (90.0000) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/17] time 0.353 (0.358) data 0.276 (0.280) loss_x loss_x 0.2578 (0.4061) acc_x 90.6250 (89.6875) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/17] time 0.358 (0.356) data 0.280 (0.278) loss_x loss_x 0.3975 (0.3942) acc_x 87.5000 (89.5833) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/33] time 0.340 (0.352) data 0.262 (0.275) loss_u loss_u 0.8892 (0.9282) acc_u 12.5000 (7.5000) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [10/33] time 0.351 (0.350) data 0.272 (0.273) loss_u loss_u 0.9771 (0.9472) acc_u 3.1250 (5.9375) lr 8.5910e-04 eta 0:00:08
epoch [111/200] batch [15/33] time 0.306 (0.343) data 0.227 (0.265) loss_u loss_u 0.8413 (0.9291) acc_u 15.6250 (7.7083) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [20/33] time 0.348 (0.344) data 0.269 (0.266) loss_u loss_u 0.8994 (0.9327) acc_u 15.6250 (7.5000) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [25/33] time 0.328 (0.343) data 0.250 (0.265) loss_u loss_u 0.9375 (0.9283) acc_u 9.3750 (8.1250) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [30/33] time 0.346 (0.343) data 0.267 (0.265) loss_u loss_u 0.9673 (0.9294) acc_u 3.1250 (7.7083) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 748
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 562
clean true:278
clean false:284
clean_rate:0.49466192170818507
noisy true:606
noisy false:464
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1070
epoch [112/200] batch [5/17] time 0.340 (0.344) data 0.262 (0.267) loss_x loss_x 0.3518 (0.3533) acc_x 93.7500 (90.6250) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/17] time 0.339 (0.340) data 0.262 (0.262) loss_x loss_x 0.2590 (0.3510) acc_x 93.7500 (91.5625) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/17] time 0.348 (0.339) data 0.271 (0.261) loss_x loss_x 0.2871 (0.3519) acc_x 93.7500 (91.2500) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/33] time 0.333 (0.339) data 0.256 (0.262) loss_u loss_u 0.9717 (0.9561) acc_u 3.1250 (5.0000) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [10/33] time 0.313 (0.338) data 0.236 (0.260) loss_u loss_u 0.8984 (0.9334) acc_u 12.5000 (7.1875) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [15/33] time 0.339 (0.334) data 0.260 (0.256) loss_u loss_u 0.9399 (0.9320) acc_u 6.2500 (7.5000) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [20/33] time 0.357 (0.336) data 0.279 (0.258) loss_u loss_u 0.9648 (0.9314) acc_u 6.2500 (7.6562) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [25/33] time 0.337 (0.337) data 0.259 (0.259) loss_u loss_u 0.9434 (0.9376) acc_u 12.5000 (7.1250) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [30/33] time 0.344 (0.338) data 0.265 (0.260) loss_u loss_u 0.8828 (0.9358) acc_u 12.5000 (7.2917) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 759
confident_label rate tensor(0.3499, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 571
clean true:286
clean false:285
clean_rate:0.500875656742557
noisy true:587
noisy false:474
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1061
epoch [113/200] batch [5/17] time 0.331 (0.348) data 0.254 (0.270) loss_x loss_x 0.2822 (0.3812) acc_x 96.8750 (90.0000) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/17] time 0.347 (0.349) data 0.270 (0.272) loss_x loss_x 0.1127 (0.3130) acc_x 100.0000 (92.5000) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/17] time 0.332 (0.347) data 0.254 (0.270) loss_x loss_x 0.2135 (0.3616) acc_x 93.7500 (92.2917) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/33] time 0.330 (0.345) data 0.253 (0.268) loss_u loss_u 0.9346 (0.9404) acc_u 6.2500 (8.1250) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [10/33] time 0.346 (0.344) data 0.267 (0.266) loss_u loss_u 0.9395 (0.9419) acc_u 6.2500 (6.8750) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [15/33] time 0.344 (0.342) data 0.265 (0.264) loss_u loss_u 0.9961 (0.9423) acc_u 0.0000 (6.8750) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [20/33] time 0.314 (0.339) data 0.237 (0.261) loss_u loss_u 0.9355 (0.9394) acc_u 6.2500 (7.0312) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [25/33] time 0.338 (0.339) data 0.260 (0.261) loss_u loss_u 0.9604 (0.9391) acc_u 3.1250 (7.1250) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [30/33] time 0.333 (0.339) data 0.255 (0.262) loss_u loss_u 0.9482 (0.9396) acc_u 6.2500 (7.0833) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 763
confident_label rate tensor(0.3456, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 564
clean true:282
clean false:282
clean_rate:0.5
noisy true:587
noisy false:481
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1068
epoch [114/200] batch [5/17] time 0.328 (0.344) data 0.251 (0.267) loss_x loss_x 0.2428 (0.2915) acc_x 96.8750 (94.3750) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/17] time 0.346 (0.346) data 0.269 (0.268) loss_x loss_x 0.2053 (0.2930) acc_x 90.6250 (93.1250) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/17] time 0.329 (0.346) data 0.251 (0.269) loss_x loss_x 0.2815 (0.2839) acc_x 93.7500 (93.3333) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/33] time 0.346 (0.343) data 0.269 (0.266) loss_u loss_u 0.9434 (0.9365) acc_u 6.2500 (8.1250) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [10/33] time 0.300 (0.340) data 0.221 (0.262) loss_u loss_u 0.9751 (0.9343) acc_u 3.1250 (8.1250) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [15/33] time 0.303 (0.333) data 0.225 (0.256) loss_u loss_u 0.8970 (0.9347) acc_u 12.5000 (8.1250) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [20/33] time 0.335 (0.333) data 0.256 (0.255) loss_u loss_u 0.9492 (0.9352) acc_u 6.2500 (8.1250) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [25/33] time 0.346 (0.335) data 0.268 (0.257) loss_u loss_u 0.9531 (0.9421) acc_u 6.2500 (7.2500) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [30/33] time 0.349 (0.335) data 0.271 (0.257) loss_u loss_u 0.9448 (0.9381) acc_u 9.3750 (7.8125) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 752
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:281
clean false:282
clean_rate:0.4991119005328597
noisy true:599
noisy false:470
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [115/200] batch [5/17] time 0.336 (0.351) data 0.259 (0.273) loss_x loss_x 0.2278 (0.2613) acc_x 100.0000 (96.2500) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/17] time 0.349 (0.348) data 0.270 (0.270) loss_x loss_x 0.5635 (0.3026) acc_x 90.6250 (95.0000) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/17] time 0.349 (0.353) data 0.271 (0.275) loss_x loss_x 0.3723 (0.3110) acc_x 87.5000 (93.7500) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/33] time 0.351 (0.350) data 0.273 (0.272) loss_u loss_u 0.9136 (0.9297) acc_u 9.3750 (8.1250) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [10/33] time 0.337 (0.348) data 0.259 (0.270) loss_u loss_u 0.9209 (0.9183) acc_u 9.3750 (9.0625) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [15/33] time 0.355 (0.347) data 0.276 (0.269) loss_u loss_u 0.9385 (0.9315) acc_u 9.3750 (7.9167) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [20/33] time 0.300 (0.341) data 0.222 (0.263) loss_u loss_u 0.9492 (0.9334) acc_u 9.3750 (7.8125) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [25/33] time 0.348 (0.340) data 0.270 (0.262) loss_u loss_u 0.9331 (0.9313) acc_u 6.2500 (8.0000) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [30/33] time 0.341 (0.341) data 0.263 (0.263) loss_u loss_u 0.9233 (0.9327) acc_u 6.2500 (7.9167) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 745
confident_label rate tensor(0.3572, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 583
clean true:287
clean false:296
clean_rate:0.4922813036020583
noisy true:600
noisy false:449
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1049
epoch [116/200] batch [5/18] time 0.340 (0.345) data 0.263 (0.268) loss_x loss_x 0.4146 (0.2810) acc_x 84.3750 (91.8750) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [10/18] time 0.344 (0.344) data 0.265 (0.267) loss_x loss_x 0.3682 (0.3746) acc_x 90.6250 (89.3750) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/18] time 0.341 (0.346) data 0.264 (0.268) loss_x loss_x 0.5630 (0.3739) acc_x 84.3750 (89.3750) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [5/32] time 0.357 (0.346) data 0.279 (0.269) loss_u loss_u 0.9536 (0.9723) acc_u 6.2500 (3.7500) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [10/32] time 0.360 (0.345) data 0.282 (0.268) loss_u loss_u 0.9614 (0.9598) acc_u 3.1250 (4.6875) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [15/32] time 0.341 (0.346) data 0.264 (0.268) loss_u loss_u 0.9937 (0.9616) acc_u 0.0000 (4.1667) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [20/32] time 0.332 (0.343) data 0.254 (0.265) loss_u loss_u 0.9683 (0.9553) acc_u 3.1250 (5.0000) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [25/32] time 0.346 (0.343) data 0.268 (0.265) loss_u loss_u 0.8823 (0.9486) acc_u 15.6250 (6.1250) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [30/32] time 0.317 (0.342) data 0.239 (0.264) loss_u loss_u 0.9756 (0.9463) acc_u 3.1250 (6.3542) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 765
confident_label rate tensor(0.3517, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 574
clean true:285
clean false:289
clean_rate:0.4965156794425087
noisy true:582
noisy false:476
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1058
epoch [117/200] batch [5/17] time 0.346 (0.351) data 0.269 (0.274) loss_x loss_x 0.2830 (0.3674) acc_x 93.7500 (90.6250) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [10/17] time 0.336 (0.344) data 0.258 (0.267) loss_x loss_x 0.2742 (0.3380) acc_x 93.7500 (91.8750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/17] time 0.328 (0.343) data 0.251 (0.265) loss_x loss_x 0.5962 (0.4025) acc_x 81.2500 (90.0000) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/33] time 0.342 (0.340) data 0.264 (0.263) loss_u loss_u 0.9526 (0.9204) acc_u 3.1250 (8.7500) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [10/33] time 0.356 (0.339) data 0.278 (0.262) loss_u loss_u 0.9131 (0.9245) acc_u 12.5000 (8.4375) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [15/33] time 0.350 (0.341) data 0.272 (0.263) loss_u loss_u 0.9390 (0.9285) acc_u 3.1250 (8.1250) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [20/33] time 0.316 (0.339) data 0.238 (0.262) loss_u loss_u 0.9463 (0.9304) acc_u 6.2500 (8.2812) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [25/33] time 0.352 (0.339) data 0.274 (0.261) loss_u loss_u 0.9663 (0.9323) acc_u 3.1250 (7.8750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [30/33] time 0.338 (0.340) data 0.259 (0.262) loss_u loss_u 0.9580 (0.9361) acc_u 6.2500 (7.6042) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 742
confident_label rate tensor(0.3395, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 554
clean true:280
clean false:274
clean_rate:0.5054151624548736
noisy true:610
noisy false:468
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1078
epoch [118/200] batch [5/17] time 0.352 (0.347) data 0.275 (0.270) loss_x loss_x 0.4343 (0.4100) acc_x 87.5000 (90.0000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/17] time 0.343 (0.350) data 0.265 (0.273) loss_x loss_x 0.3901 (0.3642) acc_x 93.7500 (90.9375) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/17] time 0.346 (0.350) data 0.268 (0.272) loss_x loss_x 0.2637 (0.3110) acc_x 90.6250 (92.7083) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/33] time 0.340 (0.348) data 0.261 (0.271) loss_u loss_u 0.8730 (0.9125) acc_u 12.5000 (10.6250) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [10/33] time 0.346 (0.349) data 0.267 (0.271) loss_u loss_u 0.9507 (0.9263) acc_u 6.2500 (9.0625) lr 7.5131e-04 eta 0:00:08
epoch [118/200] batch [15/33] time 0.336 (0.348) data 0.258 (0.270) loss_u loss_u 0.8940 (0.9287) acc_u 12.5000 (8.7500) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [20/33] time 0.292 (0.342) data 0.213 (0.264) loss_u loss_u 0.8862 (0.9264) acc_u 12.5000 (8.9062) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [25/33] time 0.356 (0.340) data 0.278 (0.262) loss_u loss_u 0.9688 (0.9303) acc_u 3.1250 (8.5000) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [30/33] time 0.350 (0.340) data 0.271 (0.262) loss_u loss_u 0.9160 (0.9280) acc_u 9.3750 (8.6458) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 760
confident_label rate tensor(0.3444, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 562
clean true:280
clean false:282
clean_rate:0.498220640569395
noisy true:592
noisy false:478
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1070
epoch [119/200] batch [5/17] time 0.345 (0.352) data 0.267 (0.275) loss_x loss_x 0.3208 (0.2341) acc_x 90.6250 (93.7500) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/17] time 0.346 (0.347) data 0.269 (0.270) loss_x loss_x 0.4854 (0.3210) acc_x 90.6250 (91.5625) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/17] time 0.330 (0.344) data 0.253 (0.267) loss_x loss_x 0.4233 (0.3586) acc_x 87.5000 (90.6250) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/33] time 0.363 (0.346) data 0.285 (0.268) loss_u loss_u 0.9727 (0.9425) acc_u 3.1250 (6.2500) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [10/33] time 0.341 (0.346) data 0.263 (0.268) loss_u loss_u 0.8262 (0.9259) acc_u 21.8750 (8.4375) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [15/33] time 0.340 (0.346) data 0.262 (0.268) loss_u loss_u 0.9385 (0.9282) acc_u 6.2500 (8.7500) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [20/33] time 0.325 (0.345) data 0.246 (0.267) loss_u loss_u 0.9219 (0.9294) acc_u 9.3750 (8.7500) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [25/33] time 0.318 (0.343) data 0.241 (0.265) loss_u loss_u 0.9263 (0.9297) acc_u 9.3750 (8.6250) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [30/33] time 0.343 (0.341) data 0.266 (0.264) loss_u loss_u 0.9590 (0.9333) acc_u 6.2500 (8.3333) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 739
confident_label rate tensor(0.3493, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 570
clean true:287
clean false:283
clean_rate:0.5035087719298246
noisy true:606
noisy false:456
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1062
epoch [120/200] batch [5/17] time 0.337 (0.353) data 0.260 (0.275) loss_x loss_x 0.2722 (0.3199) acc_x 93.7500 (91.2500) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/17] time 0.328 (0.347) data 0.251 (0.270) loss_x loss_x 0.3452 (0.3655) acc_x 84.3750 (90.0000) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/17] time 0.349 (0.345) data 0.272 (0.268) loss_x loss_x 0.3032 (0.3743) acc_x 93.7500 (90.4167) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/33] time 0.353 (0.346) data 0.275 (0.268) loss_u loss_u 0.9312 (0.9650) acc_u 6.2500 (3.1250) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [10/33] time 0.340 (0.346) data 0.262 (0.268) loss_u loss_u 0.9102 (0.9515) acc_u 9.3750 (5.6250) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [15/33] time 0.364 (0.347) data 0.286 (0.269) loss_u loss_u 0.9160 (0.9500) acc_u 9.3750 (5.6250) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [20/33] time 0.332 (0.342) data 0.254 (0.264) loss_u loss_u 0.9150 (0.9475) acc_u 9.3750 (5.9375) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [25/33] time 0.333 (0.342) data 0.255 (0.264) loss_u loss_u 0.8979 (0.9390) acc_u 12.5000 (7.0000) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [30/33] time 0.377 (0.342) data 0.299 (0.264) loss_u loss_u 0.9536 (0.9370) acc_u 3.1250 (7.1875) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 738
confident_label rate tensor(0.3462, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 565
clean true:289
clean false:276
clean_rate:0.511504424778761
noisy true:605
noisy false:462
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1067
epoch [121/200] batch [5/17] time 0.337 (0.340) data 0.260 (0.262) loss_x loss_x 0.4502 (0.3561) acc_x 87.5000 (90.6250) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/17] time 0.341 (0.342) data 0.264 (0.264) loss_x loss_x 0.2634 (0.3549) acc_x 90.6250 (90.6250) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/17] time 0.333 (0.341) data 0.256 (0.264) loss_x loss_x 0.3252 (0.3449) acc_x 90.6250 (91.0417) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/33] time 0.346 (0.343) data 0.268 (0.265) loss_u loss_u 0.9131 (0.9309) acc_u 9.3750 (7.5000) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [10/33] time 0.310 (0.341) data 0.233 (0.263) loss_u loss_u 0.9370 (0.9297) acc_u 6.2500 (7.5000) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [15/33] time 0.291 (0.339) data 0.213 (0.261) loss_u loss_u 0.9585 (0.9370) acc_u 3.1250 (6.6667) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [20/33] time 0.343 (0.341) data 0.264 (0.263) loss_u loss_u 0.9219 (0.9396) acc_u 9.3750 (6.5625) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [25/33] time 0.349 (0.339) data 0.271 (0.261) loss_u loss_u 0.9556 (0.9392) acc_u 6.2500 (6.7500) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [30/33] time 0.350 (0.339) data 0.272 (0.261) loss_u loss_u 0.9331 (0.9371) acc_u 6.2500 (7.0833) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 763
confident_label rate tensor(0.3395, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 554
clean true:276
clean false:278
clean_rate:0.4981949458483754
noisy true:593
noisy false:485
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1078
epoch [122/200] batch [5/17] time 0.334 (0.351) data 0.257 (0.273) loss_x loss_x 0.1992 (0.2853) acc_x 93.7500 (93.7500) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/17] time 0.345 (0.348) data 0.268 (0.271) loss_x loss_x 0.3374 (0.3047) acc_x 90.6250 (93.4375) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/17] time 0.375 (0.351) data 0.297 (0.274) loss_x loss_x 0.2812 (0.3120) acc_x 93.7500 (92.9167) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/33] time 0.363 (0.351) data 0.284 (0.273) loss_u loss_u 0.9702 (0.9553) acc_u 3.1250 (5.0000) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [10/33] time 0.318 (0.345) data 0.240 (0.268) loss_u loss_u 0.9136 (0.9405) acc_u 9.3750 (7.1875) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [15/33] time 0.339 (0.341) data 0.261 (0.263) loss_u loss_u 0.9951 (0.9326) acc_u 0.0000 (7.9167) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [20/33] time 0.340 (0.341) data 0.262 (0.263) loss_u loss_u 0.8794 (0.9311) acc_u 15.6250 (8.2812) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [25/33] time 0.352 (0.342) data 0.275 (0.264) loss_u loss_u 0.9189 (0.9295) acc_u 9.3750 (8.3750) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [30/33] time 0.352 (0.342) data 0.274 (0.264) loss_u loss_u 0.9077 (0.9292) acc_u 9.3750 (8.5417) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 762
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:284
clean false:292
clean_rate:0.4930555555555556
noisy true:586
noisy false:470
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [123/200] batch [5/18] time 0.356 (0.356) data 0.280 (0.278) loss_x loss_x 0.2822 (0.3294) acc_x 96.8750 (92.5000) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/18] time 0.335 (0.351) data 0.258 (0.274) loss_x loss_x 0.2937 (0.3307) acc_x 93.7500 (91.2500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/18] time 0.341 (0.347) data 0.263 (0.269) loss_x loss_x 0.3091 (0.3356) acc_x 90.6250 (91.4583) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [5/33] time 0.349 (0.347) data 0.271 (0.270) loss_u loss_u 0.9482 (0.9438) acc_u 6.2500 (6.8750) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [10/33] time 0.317 (0.347) data 0.239 (0.269) loss_u loss_u 0.9673 (0.9434) acc_u 6.2500 (6.8750) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [15/33] time 0.344 (0.342) data 0.267 (0.264) loss_u loss_u 0.9546 (0.9469) acc_u 3.1250 (6.0417) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [20/33] time 0.373 (0.342) data 0.295 (0.264) loss_u loss_u 0.9692 (0.9474) acc_u 3.1250 (6.0938) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [25/33] time 0.334 (0.341) data 0.256 (0.264) loss_u loss_u 0.9624 (0.9474) acc_u 3.1250 (6.0000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [30/33] time 0.334 (0.341) data 0.256 (0.263) loss_u loss_u 0.9932 (0.9459) acc_u 0.0000 (6.5625) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 733
confident_label rate tensor(0.3450, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 563
clean true:284
clean false:279
clean_rate:0.5044404973357016
noisy true:615
noisy false:454
after delete: len(clean_dataset) 563
after delete: len(noisy_dataset) 1069
epoch [124/200] batch [5/17] time 0.342 (0.345) data 0.264 (0.268) loss_x loss_x 0.3691 (0.2436) acc_x 90.6250 (95.0000) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/17] time 0.345 (0.341) data 0.267 (0.264) loss_x loss_x 0.3970 (0.2985) acc_x 96.8750 (93.7500) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/17] time 0.330 (0.338) data 0.252 (0.261) loss_x loss_x 0.2520 (0.3119) acc_x 90.6250 (92.9167) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/33] time 0.345 (0.339) data 0.267 (0.261) loss_u loss_u 0.8696 (0.8939) acc_u 15.6250 (12.5000) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [10/33] time 0.338 (0.339) data 0.261 (0.261) loss_u loss_u 0.8032 (0.9110) acc_u 25.0000 (10.6250) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [15/33] time 0.356 (0.340) data 0.278 (0.263) loss_u loss_u 0.9668 (0.9180) acc_u 3.1250 (9.3750) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [20/33] time 0.320 (0.337) data 0.242 (0.259) loss_u loss_u 0.9312 (0.9198) acc_u 6.2500 (9.2188) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [25/33] time 0.304 (0.335) data 0.226 (0.257) loss_u loss_u 0.8784 (0.9263) acc_u 15.6250 (8.6250) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [30/33] time 0.340 (0.335) data 0.262 (0.257) loss_u loss_u 0.9561 (0.9271) acc_u 6.2500 (8.5417) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 770
confident_label rate tensor(0.3523, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 575
clean true:282
clean false:293
clean_rate:0.49043478260869566
noisy true:580
noisy false:477
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1057
epoch [125/200] batch [5/17] time 0.346 (0.344) data 0.269 (0.267) loss_x loss_x 0.2454 (0.2414) acc_x 87.5000 (93.7500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/17] time 0.343 (0.342) data 0.266 (0.265) loss_x loss_x 0.2839 (0.3307) acc_x 87.5000 (91.5625) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/17] time 0.328 (0.344) data 0.251 (0.266) loss_x loss_x 0.6362 (0.3795) acc_x 87.5000 (91.4583) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/33] time 0.345 (0.343) data 0.267 (0.265) loss_u loss_u 0.9985 (0.9595) acc_u 0.0000 (5.6250) lr 6.4653e-04 eta 0:00:09
epoch [125/200] batch [10/33] time 0.342 (0.343) data 0.264 (0.266) loss_u loss_u 0.9463 (0.9446) acc_u 6.2500 (6.8750) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [15/33] time 0.344 (0.344) data 0.265 (0.267) loss_u loss_u 0.9531 (0.9378) acc_u 9.3750 (7.7083) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [20/33] time 0.299 (0.343) data 0.221 (0.265) loss_u loss_u 0.9644 (0.9398) acc_u 3.1250 (7.3438) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [25/33] time 0.340 (0.340) data 0.262 (0.262) loss_u loss_u 0.9517 (0.9339) acc_u 0.0000 (7.8750) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [30/33] time 0.343 (0.340) data 0.266 (0.262) loss_u loss_u 0.9229 (0.9335) acc_u 6.2500 (7.8125) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 731
confident_label rate tensor(0.3462, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 565
clean true:289
clean false:276
clean_rate:0.511504424778761
noisy true:612
noisy false:455
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1067
epoch [126/200] batch [5/17] time 0.345 (0.347) data 0.268 (0.270) loss_x loss_x 0.5112 (0.3749) acc_x 84.3750 (91.8750) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/17] time 0.340 (0.344) data 0.262 (0.266) loss_x loss_x 0.3657 (0.3413) acc_x 90.6250 (92.8125) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/17] time 0.330 (0.345) data 0.253 (0.267) loss_x loss_x 0.3469 (0.3490) acc_x 90.6250 (92.5000) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/33] time 0.331 (0.343) data 0.253 (0.266) loss_u loss_u 0.9395 (0.9118) acc_u 9.3750 (11.2500) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [10/33] time 0.339 (0.343) data 0.261 (0.265) loss_u loss_u 0.9385 (0.9363) acc_u 6.2500 (7.5000) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [15/33] time 0.351 (0.343) data 0.273 (0.265) loss_u loss_u 0.8931 (0.9312) acc_u 12.5000 (8.1250) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [20/33] time 0.377 (0.340) data 0.299 (0.263) loss_u loss_u 0.9414 (0.9335) acc_u 6.2500 (7.8125) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [25/33] time 0.332 (0.340) data 0.254 (0.262) loss_u loss_u 0.9263 (0.9283) acc_u 6.2500 (8.3750) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [30/33] time 0.336 (0.340) data 0.258 (0.262) loss_u loss_u 0.9453 (0.9270) acc_u 6.2500 (8.3333) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 761
confident_label rate tensor(0.3585, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 585
clean true:289
clean false:296
clean_rate:0.49401709401709404
noisy true:582
noisy false:465
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1047
epoch [127/200] batch [5/18] time 0.338 (0.350) data 0.261 (0.272) loss_x loss_x 0.6436 (0.4276) acc_x 81.2500 (90.0000) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/18] time 0.341 (0.350) data 0.264 (0.272) loss_x loss_x 0.2520 (0.3629) acc_x 93.7500 (90.6250) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/18] time 0.371 (0.352) data 0.293 (0.275) loss_x loss_x 0.4746 (0.3603) acc_x 84.3750 (91.0417) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [5/32] time 0.345 (0.353) data 0.266 (0.276) loss_u loss_u 0.9570 (0.9354) acc_u 3.1250 (8.1250) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [10/32] time 0.333 (0.351) data 0.255 (0.273) loss_u loss_u 0.9541 (0.9354) acc_u 6.2500 (7.8125) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [15/32] time 0.339 (0.348) data 0.261 (0.271) loss_u loss_u 0.9683 (0.9293) acc_u 3.1250 (8.5417) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [20/32] time 0.347 (0.347) data 0.270 (0.269) loss_u loss_u 0.9131 (0.9332) acc_u 9.3750 (7.9688) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [25/32] time 0.321 (0.346) data 0.244 (0.268) loss_u loss_u 0.9834 (0.9418) acc_u 3.1250 (6.8750) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [30/32] time 0.302 (0.342) data 0.224 (0.264) loss_u loss_u 0.9468 (0.9431) acc_u 3.1250 (6.5625) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 751
confident_label rate tensor(0.3560, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 581
clean true:293
clean false:288
clean_rate:0.504302925989673
noisy true:588
noisy false:463
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1051
epoch [128/200] batch [5/18] time 0.359 (0.348) data 0.282 (0.271) loss_x loss_x 0.2688 (0.3259) acc_x 93.7500 (92.5000) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/18] time 0.342 (0.343) data 0.265 (0.266) loss_x loss_x 0.3831 (0.3552) acc_x 87.5000 (92.1875) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/18] time 0.341 (0.340) data 0.264 (0.263) loss_x loss_x 0.4214 (0.3698) acc_x 96.8750 (92.5000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [5/32] time 0.350 (0.339) data 0.272 (0.262) loss_u loss_u 0.8936 (0.9184) acc_u 12.5000 (9.3750) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [10/32] time 0.339 (0.339) data 0.261 (0.262) loss_u loss_u 0.8496 (0.9136) acc_u 18.7500 (10.0000) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [15/32] time 0.297 (0.340) data 0.219 (0.263) loss_u loss_u 0.9629 (0.9267) acc_u 3.1250 (8.5417) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [20/32] time 0.305 (0.338) data 0.226 (0.260) loss_u loss_u 0.9155 (0.9307) acc_u 12.5000 (8.1250) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [25/32] time 0.349 (0.340) data 0.272 (0.263) loss_u loss_u 0.9829 (0.9331) acc_u 0.0000 (7.7500) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [30/32] time 0.377 (0.340) data 0.299 (0.263) loss_u loss_u 0.9375 (0.9359) acc_u 6.2500 (7.3958) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 747
confident_label rate tensor(0.3529, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 576
clean true:286
clean false:290
clean_rate:0.4965277777777778
noisy true:599
noisy false:457
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1056
epoch [129/200] batch [5/18] time 0.350 (0.353) data 0.273 (0.275) loss_x loss_x 0.2925 (0.3811) acc_x 96.8750 (90.6250) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [10/18] time 0.339 (0.346) data 0.261 (0.268) loss_x loss_x 0.2644 (0.3734) acc_x 93.7500 (91.8750) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/18] time 0.321 (0.341) data 0.243 (0.264) loss_x loss_x 0.2163 (0.3482) acc_x 96.8750 (92.0833) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [5/33] time 0.338 (0.340) data 0.260 (0.263) loss_u loss_u 0.9688 (0.9531) acc_u 3.1250 (5.0000) lr 5.8849e-04 eta 0:00:09
epoch [129/200] batch [10/33] time 0.339 (0.340) data 0.261 (0.263) loss_u loss_u 0.9434 (0.9522) acc_u 6.2500 (5.0000) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [15/33] time 0.327 (0.340) data 0.249 (0.262) loss_u loss_u 0.9751 (0.9524) acc_u 3.1250 (5.2083) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [20/33] time 0.337 (0.340) data 0.258 (0.262) loss_u loss_u 0.8955 (0.9472) acc_u 9.3750 (5.6250) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [25/33] time 0.330 (0.346) data 0.251 (0.268) loss_u loss_u 0.8418 (0.9446) acc_u 21.8750 (6.0000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [30/33] time 0.344 (0.347) data 0.266 (0.269) loss_u loss_u 0.9365 (0.9417) acc_u 9.3750 (6.5625) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 758
confident_label rate tensor(0.3493, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 570
clean true:289
clean false:281
clean_rate:0.5070175438596491
noisy true:585
noisy false:477
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1062
epoch [130/200] batch [5/17] time 0.336 (0.342) data 0.258 (0.265) loss_x loss_x 0.1143 (0.2196) acc_x 96.8750 (95.0000) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/17] time 0.366 (0.348) data 0.288 (0.270) loss_x loss_x 0.4641 (0.3480) acc_x 90.6250 (91.5625) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/17] time 0.341 (0.345) data 0.264 (0.267) loss_x loss_x 0.5669 (0.3726) acc_x 84.3750 (90.6250) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/33] time 0.329 (0.345) data 0.252 (0.267) loss_u loss_u 0.8960 (0.9059) acc_u 12.5000 (11.8750) lr 5.7422e-04 eta 0:00:09
epoch [130/200] batch [10/33] time 0.351 (0.345) data 0.274 (0.267) loss_u loss_u 0.9331 (0.9262) acc_u 9.3750 (9.0625) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [15/33] time 0.335 (0.343) data 0.257 (0.266) loss_u loss_u 0.9023 (0.9348) acc_u 12.5000 (8.1250) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [20/33] time 0.305 (0.342) data 0.226 (0.264) loss_u loss_u 0.9893 (0.9344) acc_u 3.1250 (8.2812) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [25/33] time 0.300 (0.337) data 0.221 (0.259) loss_u loss_u 0.9229 (0.9276) acc_u 9.3750 (9.0000) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [30/33] time 0.336 (0.337) data 0.257 (0.259) loss_u loss_u 0.9688 (0.9297) acc_u 6.2500 (8.7500) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 754
confident_label rate tensor(0.3591, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 586
clean true:280
clean false:306
clean_rate:0.4778156996587031
noisy true:598
noisy false:448
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1046
epoch [131/200] batch [5/18] time 0.332 (0.350) data 0.254 (0.273) loss_x loss_x 0.3601 (0.3014) acc_x 87.5000 (92.5000) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/18] time 0.344 (0.351) data 0.267 (0.273) loss_x loss_x 0.3152 (0.3034) acc_x 90.6250 (92.8125) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/18] time 0.337 (0.348) data 0.259 (0.270) loss_x loss_x 0.3213 (0.3065) acc_x 93.7500 (93.3333) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [5/32] time 0.346 (0.344) data 0.268 (0.267) loss_u loss_u 0.9282 (0.9372) acc_u 6.2500 (6.2500) lr 5.6006e-04 eta 0:00:09
epoch [131/200] batch [10/32] time 0.349 (0.345) data 0.271 (0.267) loss_u loss_u 0.9429 (0.9476) acc_u 6.2500 (5.3125) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [15/32] time 0.340 (0.343) data 0.263 (0.266) loss_u loss_u 0.9424 (0.9428) acc_u 6.2500 (6.0417) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [20/32] time 0.296 (0.341) data 0.217 (0.263) loss_u loss_u 0.9658 (0.9405) acc_u 6.2500 (6.5625) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [25/32] time 0.333 (0.338) data 0.256 (0.260) loss_u loss_u 0.9785 (0.9451) acc_u 3.1250 (6.2500) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [30/32] time 0.334 (0.338) data 0.255 (0.261) loss_u loss_u 0.9492 (0.9454) acc_u 6.2500 (6.2500) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 774
confident_label rate tensor(0.3591, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 586
clean true:290
clean false:296
clean_rate:0.4948805460750853
noisy true:568
noisy false:478
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1046
epoch [132/200] batch [5/18] time 0.344 (0.341) data 0.266 (0.263) loss_x loss_x 0.4543 (0.4062) acc_x 93.7500 (90.0000) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/18] time 0.342 (0.342) data 0.264 (0.264) loss_x loss_x 0.3625 (0.3469) acc_x 90.6250 (92.1875) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/18] time 0.353 (0.341) data 0.276 (0.263) loss_x loss_x 0.4060 (0.3310) acc_x 87.5000 (92.5000) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [5/32] time 0.351 (0.346) data 0.273 (0.268) loss_u loss_u 0.9277 (0.9157) acc_u 9.3750 (10.0000) lr 5.4601e-04 eta 0:00:09
epoch [132/200] batch [10/32] time 0.349 (0.346) data 0.271 (0.268) loss_u loss_u 0.8955 (0.9325) acc_u 12.5000 (8.1250) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [15/32] time 0.307 (0.343) data 0.229 (0.265) loss_u loss_u 1.0000 (0.9372) acc_u 0.0000 (7.5000) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [20/32] time 0.340 (0.339) data 0.261 (0.261) loss_u loss_u 0.9731 (0.9437) acc_u 3.1250 (6.5625) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [25/32] time 0.346 (0.339) data 0.267 (0.261) loss_u loss_u 0.9272 (0.9409) acc_u 9.3750 (7.0000) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [30/32] time 0.292 (0.337) data 0.214 (0.260) loss_u loss_u 0.8970 (0.9396) acc_u 12.5000 (7.0833) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 773
confident_label rate tensor(0.3603, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 588
clean true:279
clean false:309
clean_rate:0.4744897959183674
noisy true:580
noisy false:464
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1044
epoch [133/200] batch [5/18] time 0.347 (0.353) data 0.270 (0.275) loss_x loss_x 0.1864 (0.2387) acc_x 96.8750 (94.3750) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/18] time 0.340 (0.348) data 0.263 (0.270) loss_x loss_x 0.3418 (0.2724) acc_x 90.6250 (93.1250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/18] time 0.331 (0.345) data 0.254 (0.268) loss_x loss_x 0.5278 (0.3426) acc_x 84.3750 (91.4583) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [5/32] time 0.347 (0.343) data 0.269 (0.266) loss_u loss_u 0.8760 (0.9411) acc_u 12.5000 (6.2500) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [10/32] time 0.345 (0.345) data 0.267 (0.267) loss_u loss_u 0.9629 (0.9516) acc_u 3.1250 (5.0000) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [15/32] time 0.294 (0.344) data 0.216 (0.266) loss_u loss_u 0.9326 (0.9408) acc_u 9.3750 (6.4583) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [20/32] time 0.357 (0.341) data 0.279 (0.263) loss_u loss_u 0.9375 (0.9386) acc_u 9.3750 (6.8750) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [25/32] time 0.339 (0.341) data 0.261 (0.263) loss_u loss_u 0.9761 (0.9435) acc_u 3.1250 (6.2500) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [30/32] time 0.341 (0.340) data 0.263 (0.262) loss_u loss_u 0.9707 (0.9410) acc_u 3.1250 (6.4583) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 762
confident_label rate tensor(0.3609, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 589
clean true:286
clean false:303
clean_rate:0.4855687606112054
noisy true:584
noisy false:459
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 1043
epoch [134/200] batch [5/18] time 0.342 (0.352) data 0.265 (0.275) loss_x loss_x 0.2426 (0.3281) acc_x 90.6250 (92.5000) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/18] time 0.354 (0.349) data 0.276 (0.272) loss_x loss_x 0.0840 (0.3430) acc_x 100.0000 (92.1875) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/18] time 0.345 (0.348) data 0.267 (0.271) loss_x loss_x 0.2722 (0.3547) acc_x 96.8750 (92.5000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [5/32] time 0.330 (0.346) data 0.252 (0.269) loss_u loss_u 0.8921 (0.9144) acc_u 12.5000 (10.0000) lr 5.1825e-04 eta 0:00:09
epoch [134/200] batch [10/32] time 0.337 (0.346) data 0.260 (0.268) loss_u loss_u 0.9331 (0.9247) acc_u 6.2500 (8.4375) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [15/32] time 0.295 (0.340) data 0.216 (0.262) loss_u loss_u 0.9663 (0.9282) acc_u 3.1250 (8.1250) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [20/32] time 0.359 (0.340) data 0.280 (0.263) loss_u loss_u 0.8872 (0.9292) acc_u 12.5000 (7.9688) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [25/32] time 0.356 (0.342) data 0.279 (0.264) loss_u loss_u 0.8726 (0.9304) acc_u 15.6250 (7.7500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [30/32] time 0.306 (0.341) data 0.228 (0.263) loss_u loss_u 0.9102 (0.9292) acc_u 12.5000 (7.9167) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 743
confident_label rate tensor(0.3548, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 579
clean true:288
clean false:291
clean_rate:0.49740932642487046
noisy true:601
noisy false:452
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1053
epoch [135/200] batch [5/18] time 0.353 (0.355) data 0.275 (0.277) loss_x loss_x 0.3020 (0.3099) acc_x 96.8750 (93.7500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/18] time 0.348 (0.352) data 0.271 (0.275) loss_x loss_x 0.2688 (0.3053) acc_x 93.7500 (92.5000) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/18] time 0.352 (0.349) data 0.275 (0.271) loss_x loss_x 0.4221 (0.3310) acc_x 90.6250 (92.7083) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [5/32] time 0.337 (0.347) data 0.260 (0.269) loss_u loss_u 0.9360 (0.9031) acc_u 6.2500 (11.2500) lr 5.0454e-04 eta 0:00:09
epoch [135/200] batch [10/32] time 0.343 (0.347) data 0.265 (0.269) loss_u loss_u 0.9492 (0.9227) acc_u 6.2500 (8.7500) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [15/32] time 0.300 (0.341) data 0.221 (0.263) loss_u loss_u 0.9487 (0.9272) acc_u 6.2500 (8.3333) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [20/32] time 0.352 (0.340) data 0.275 (0.262) loss_u loss_u 0.9785 (0.9248) acc_u 3.1250 (9.0625) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [25/32] time 0.329 (0.340) data 0.252 (0.262) loss_u loss_u 0.9951 (0.9305) acc_u 0.0000 (8.2500) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [30/32] time 0.343 (0.340) data 0.266 (0.263) loss_u loss_u 0.9697 (0.9307) acc_u 6.2500 (8.3333) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 754
confident_label rate tensor(0.3560, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 581
clean true:279
clean false:302
clean_rate:0.4802065404475043
noisy true:599
noisy false:452
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1051
epoch [136/200] batch [5/18] time 0.322 (0.342) data 0.245 (0.265) loss_x loss_x 0.4641 (0.4072) acc_x 78.1250 (88.1250) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/18] time 0.350 (0.345) data 0.272 (0.267) loss_x loss_x 0.2067 (0.3764) acc_x 93.7500 (90.3125) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/18] time 0.323 (0.343) data 0.246 (0.266) loss_x loss_x 0.1837 (0.3588) acc_x 100.0000 (90.6250) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [5/32] time 0.352 (0.341) data 0.274 (0.264) loss_u loss_u 0.9409 (0.9243) acc_u 6.2500 (9.3750) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [10/32] time 0.346 (0.342) data 0.269 (0.265) loss_u loss_u 0.9434 (0.9324) acc_u 6.2500 (7.5000) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [15/32] time 0.299 (0.342) data 0.220 (0.265) loss_u loss_u 0.9688 (0.9282) acc_u 3.1250 (8.1250) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [20/32] time 0.313 (0.338) data 0.234 (0.261) loss_u loss_u 0.9658 (0.9329) acc_u 3.1250 (7.5000) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [25/32] time 0.347 (0.340) data 0.269 (0.262) loss_u loss_u 0.9805 (0.9326) acc_u 3.1250 (7.6250) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [30/32] time 0.343 (0.340) data 0.265 (0.262) loss_u loss_u 0.9136 (0.9278) acc_u 9.3750 (8.1250) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 751
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 598
clean true:288
clean false:310
clean_rate:0.4816053511705686
noisy true:593
noisy false:441
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1034
epoch [137/200] batch [5/18] time 0.345 (0.353) data 0.268 (0.276) loss_x loss_x 0.2197 (0.3177) acc_x 96.8750 (91.2500) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/18] time 0.346 (0.351) data 0.269 (0.274) loss_x loss_x 0.2673 (0.2961) acc_x 93.7500 (93.4375) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/18] time 0.335 (0.351) data 0.257 (0.273) loss_x loss_x 0.4016 (0.3227) acc_x 93.7500 (92.9167) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [5/32] time 0.359 (0.349) data 0.280 (0.271) loss_u loss_u 0.9419 (0.9512) acc_u 6.2500 (4.3750) lr 4.7750e-04 eta 0:00:09
epoch [137/200] batch [10/32] time 0.362 (0.349) data 0.285 (0.271) loss_u loss_u 0.9570 (0.9509) acc_u 6.2500 (5.0000) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [15/32] time 0.352 (0.349) data 0.275 (0.271) loss_u loss_u 0.9229 (0.9450) acc_u 12.5000 (6.0417) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [20/32] time 0.303 (0.343) data 0.224 (0.265) loss_u loss_u 0.9111 (0.9477) acc_u 9.3750 (5.7812) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [25/32] time 0.346 (0.342) data 0.268 (0.264) loss_u loss_u 0.9233 (0.9486) acc_u 9.3750 (5.7500) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [30/32] time 0.340 (0.343) data 0.263 (0.265) loss_u loss_u 0.9131 (0.9428) acc_u 9.3750 (6.5625) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 742
confident_label rate tensor(0.3603, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 588
clean true:293
clean false:295
clean_rate:0.49829931972789115
noisy true:597
noisy false:447
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1044
epoch [138/200] batch [5/18] time 0.358 (0.353) data 0.280 (0.275) loss_x loss_x 0.2130 (0.4078) acc_x 96.8750 (90.6250) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/18] time 0.338 (0.346) data 0.260 (0.268) loss_x loss_x 0.3040 (0.4301) acc_x 93.7500 (89.3750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/18] time 0.338 (0.345) data 0.261 (0.267) loss_x loss_x 0.5361 (0.4067) acc_x 87.5000 (90.4167) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [5/32] time 0.353 (0.344) data 0.274 (0.266) loss_u loss_u 0.9321 (0.9223) acc_u 9.3750 (8.1250) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [10/32] time 0.350 (0.345) data 0.273 (0.267) loss_u loss_u 0.8677 (0.9344) acc_u 15.6250 (7.1875) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [15/32] time 0.344 (0.345) data 0.266 (0.267) loss_u loss_u 0.9170 (0.9436) acc_u 9.3750 (6.2500) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [20/32] time 0.300 (0.340) data 0.222 (0.263) loss_u loss_u 0.9160 (0.9387) acc_u 15.6250 (7.1875) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [25/32] time 0.334 (0.339) data 0.257 (0.261) loss_u loss_u 0.9092 (0.9381) acc_u 12.5000 (7.3750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [30/32] time 0.334 (0.340) data 0.256 (0.262) loss_u loss_u 0.8872 (0.9349) acc_u 12.5000 (7.6042) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 771
confident_label rate tensor(0.3585, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 585
clean true:275
clean false:310
clean_rate:0.4700854700854701
noisy true:586
noisy false:461
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1047
epoch [139/200] batch [5/18] time 0.339 (0.347) data 0.262 (0.269) loss_x loss_x 0.5337 (0.3902) acc_x 93.7500 (91.8750) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/18] time 0.338 (0.344) data 0.261 (0.267) loss_x loss_x 0.2756 (0.3771) acc_x 90.6250 (90.0000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/18] time 0.327 (0.343) data 0.250 (0.266) loss_x loss_x 0.2620 (0.3707) acc_x 87.5000 (90.6250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [5/32] time 0.337 (0.340) data 0.259 (0.263) loss_u loss_u 0.9502 (0.9168) acc_u 6.2500 (10.0000) lr 4.5098e-04 eta 0:00:09
epoch [139/200] batch [10/32] time 0.345 (0.341) data 0.267 (0.263) loss_u loss_u 0.9531 (0.9148) acc_u 9.3750 (10.3125) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [15/32] time 0.337 (0.341) data 0.260 (0.263) loss_u loss_u 0.8999 (0.9148) acc_u 12.5000 (10.2083) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [20/32] time 0.302 (0.340) data 0.224 (0.263) loss_u loss_u 0.9619 (0.9132) acc_u 3.1250 (10.3125) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [25/32] time 0.304 (0.336) data 0.225 (0.258) loss_u loss_u 0.9199 (0.9211) acc_u 9.3750 (9.3750) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [30/32] time 0.323 (0.335) data 0.244 (0.258) loss_u loss_u 0.9351 (0.9261) acc_u 6.2500 (8.7500) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 760
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 598
clean true:285
clean false:313
clean_rate:0.4765886287625418
noisy true:587
noisy false:447
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1034
epoch [140/200] batch [5/18] time 0.345 (0.348) data 0.268 (0.270) loss_x loss_x 0.3484 (0.3953) acc_x 93.7500 (91.2500) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/18] time 0.351 (0.346) data 0.274 (0.268) loss_x loss_x 0.3401 (0.3578) acc_x 90.6250 (90.9375) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/18] time 0.345 (0.345) data 0.268 (0.268) loss_x loss_x 0.1886 (0.3647) acc_x 96.8750 (91.2500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [5/32] time 0.368 (0.349) data 0.290 (0.271) loss_u loss_u 0.9531 (0.9286) acc_u 6.2500 (9.3750) lr 4.3792e-04 eta 0:00:09
epoch [140/200] batch [10/32] time 0.329 (0.349) data 0.251 (0.271) loss_u loss_u 0.9360 (0.9265) acc_u 9.3750 (9.6875) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [15/32] time 0.341 (0.347) data 0.264 (0.269) loss_u loss_u 0.9033 (0.9299) acc_u 12.5000 (9.1667) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [20/32] time 0.336 (0.348) data 0.258 (0.270) loss_u loss_u 0.9419 (0.9385) acc_u 6.2500 (7.8125) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [25/32] time 0.350 (0.348) data 0.272 (0.270) loss_u loss_u 0.9199 (0.9388) acc_u 9.3750 (7.5000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [30/32] time 0.375 (0.356) data 0.295 (0.278) loss_u loss_u 0.8604 (0.9372) acc_u 15.6250 (7.7083) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 768
confident_label rate tensor(0.3634, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 593
clean true:277
clean false:316
clean_rate:0.4671163575042159
noisy true:587
noisy false:452
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1039
epoch [141/200] batch [5/18] time 0.354 (0.357) data 0.276 (0.279) loss_x loss_x 0.3376 (0.2886) acc_x 93.7500 (93.7500) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/18] time 0.345 (0.348) data 0.267 (0.270) loss_x loss_x 0.7227 (0.3375) acc_x 84.3750 (92.5000) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/18] time 0.337 (0.343) data 0.259 (0.265) loss_x loss_x 0.3574 (0.3435) acc_x 84.3750 (92.2917) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [5/32] time 0.352 (0.344) data 0.275 (0.266) loss_u loss_u 0.9497 (0.9535) acc_u 6.2500 (6.2500) lr 4.2499e-04 eta 0:00:09
epoch [141/200] batch [10/32] time 0.447 (0.348) data 0.368 (0.270) loss_u loss_u 0.9829 (0.9487) acc_u 3.1250 (5.9375) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [15/32] time 0.319 (0.344) data 0.240 (0.266) loss_u loss_u 0.8770 (0.9446) acc_u 12.5000 (6.2500) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [20/32] time 0.349 (0.344) data 0.272 (0.265) loss_u loss_u 0.9209 (0.9399) acc_u 9.3750 (7.0312) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [25/32] time 0.342 (0.344) data 0.265 (0.266) loss_u loss_u 0.9644 (0.9378) acc_u 3.1250 (7.0000) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [30/32] time 0.347 (0.344) data 0.270 (0.266) loss_u loss_u 0.9009 (0.9393) acc_u 9.3750 (6.8750) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 781
confident_label rate tensor(0.3603, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 588
clean true:269
clean false:319
clean_rate:0.4574829931972789
noisy true:582
noisy false:462
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1044
epoch [142/200] batch [5/18] time 0.340 (0.339) data 0.262 (0.262) loss_x loss_x 0.3259 (0.2842) acc_x 93.7500 (93.1250) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/18] time 0.338 (0.340) data 0.260 (0.263) loss_x loss_x 0.3589 (0.2620) acc_x 90.6250 (93.1250) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/18] time 0.329 (0.340) data 0.252 (0.262) loss_x loss_x 0.2729 (0.3119) acc_x 96.8750 (92.5000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [5/32] time 0.341 (0.339) data 0.264 (0.261) loss_u loss_u 0.8857 (0.9089) acc_u 12.5000 (10.6250) lr 4.1221e-04 eta 0:00:09
epoch [142/200] batch [10/32] time 0.348 (0.340) data 0.271 (0.263) loss_u loss_u 0.9819 (0.9299) acc_u 3.1250 (8.4375) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [15/32] time 0.305 (0.339) data 0.226 (0.262) loss_u loss_u 0.9707 (0.9399) acc_u 3.1250 (7.0833) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [20/32] time 0.306 (0.336) data 0.228 (0.258) loss_u loss_u 0.9688 (0.9397) acc_u 3.1250 (7.1875) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [25/32] time 0.334 (0.336) data 0.256 (0.259) loss_u loss_u 0.8960 (0.9357) acc_u 12.5000 (7.6250) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [30/32] time 0.337 (0.337) data 0.259 (0.260) loss_u loss_u 0.9800 (0.9367) acc_u 0.0000 (7.2917) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 772
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 606
clean true:281
clean false:325
clean_rate:0.4636963696369637
noisy true:579
noisy false:447
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1026
epoch [143/200] batch [5/18] time 0.355 (0.349) data 0.278 (0.272) loss_x loss_x 0.3506 (0.2968) acc_x 90.6250 (93.7500) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/18] time 0.355 (0.353) data 0.277 (0.275) loss_x loss_x 0.1840 (0.3048) acc_x 96.8750 (93.4375) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/18] time 0.343 (0.353) data 0.266 (0.275) loss_x loss_x 0.5630 (0.3119) acc_x 87.5000 (92.7083) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [5/32] time 0.336 (0.350) data 0.257 (0.272) loss_u loss_u 0.9160 (0.9648) acc_u 9.3750 (3.7500) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [10/32] time 0.341 (0.349) data 0.264 (0.271) loss_u loss_u 0.9424 (0.9478) acc_u 6.2500 (6.2500) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [15/32] time 0.331 (0.347) data 0.253 (0.270) loss_u loss_u 0.9697 (0.9549) acc_u 3.1250 (5.2083) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [20/32] time 0.294 (0.345) data 0.216 (0.267) loss_u loss_u 0.9160 (0.9529) acc_u 9.3750 (5.4688) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [25/32] time 0.340 (0.344) data 0.262 (0.266) loss_u loss_u 0.8042 (0.9471) acc_u 18.7500 (5.7500) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [30/32] time 0.347 (0.344) data 0.269 (0.267) loss_u loss_u 0.9688 (0.9438) acc_u 3.1250 (6.2500) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 768
confident_label rate tensor(0.3609, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 589
clean true:276
clean false:313
clean_rate:0.4685908319185059
noisy true:588
noisy false:455
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 1043
epoch [144/200] batch [5/18] time 0.322 (0.332) data 0.244 (0.255) loss_x loss_x 0.5850 (0.3952) acc_x 81.2500 (88.7500) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/18] time 0.338 (0.332) data 0.261 (0.255) loss_x loss_x 0.1070 (0.3574) acc_x 100.0000 (90.9375) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/18] time 0.361 (0.334) data 0.284 (0.257) loss_x loss_x 0.1451 (0.3148) acc_x 100.0000 (92.0833) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [5/32] time 0.351 (0.336) data 0.272 (0.258) loss_u loss_u 0.8618 (0.9239) acc_u 15.6250 (8.7500) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [10/32] time 0.345 (0.336) data 0.268 (0.258) loss_u loss_u 0.9126 (0.9269) acc_u 9.3750 (7.8125) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [15/32] time 0.321 (0.335) data 0.243 (0.258) loss_u loss_u 0.9482 (0.9308) acc_u 3.1250 (7.2917) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [20/32] time 0.345 (0.337) data 0.267 (0.259) loss_u loss_u 0.9116 (0.9275) acc_u 9.3750 (7.8125) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [25/32] time 0.306 (0.334) data 0.227 (0.257) loss_u loss_u 0.9395 (0.9284) acc_u 6.2500 (7.7500) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [30/32] time 0.441 (0.336) data 0.363 (0.258) loss_u loss_u 0.8794 (0.9302) acc_u 12.5000 (7.7083) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 750
confident_label rate tensor(0.3683, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 601
clean true:283
clean false:318
clean_rate:0.47088186356073214
noisy true:599
noisy false:432
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1031
epoch [145/200] batch [5/18] time 0.352 (0.354) data 0.275 (0.276) loss_x loss_x 0.2957 (0.4281) acc_x 90.6250 (89.3750) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/18] time 0.336 (0.352) data 0.259 (0.274) loss_x loss_x 0.4006 (0.3605) acc_x 87.5000 (90.9375) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/18] time 0.345 (0.348) data 0.268 (0.270) loss_x loss_x 0.2842 (0.3482) acc_x 93.7500 (91.6667) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [5/32] time 0.331 (0.343) data 0.252 (0.265) loss_u loss_u 0.9580 (0.9319) acc_u 6.2500 (8.1250) lr 3.7476e-04 eta 0:00:09
epoch [145/200] batch [10/32] time 0.340 (0.343) data 0.261 (0.265) loss_u loss_u 0.9790 (0.9457) acc_u 0.0000 (6.2500) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [15/32] time 0.347 (0.342) data 0.268 (0.264) loss_u loss_u 0.9604 (0.9465) acc_u 3.1250 (6.0417) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [20/32] time 0.337 (0.342) data 0.259 (0.264) loss_u loss_u 0.9097 (0.9404) acc_u 12.5000 (6.8750) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [25/32] time 0.294 (0.341) data 0.216 (0.263) loss_u loss_u 0.9951 (0.9447) acc_u 0.0000 (6.3750) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [30/32] time 0.341 (0.339) data 0.263 (0.261) loss_u loss_u 0.9683 (0.9475) acc_u 3.1250 (5.9375) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 772
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 617
clean true:288
clean false:329
clean_rate:0.46677471636953
noisy true:572
noisy false:443
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 1015
epoch [146/200] batch [5/19] time 0.331 (0.343) data 0.254 (0.266) loss_x loss_x 0.3008 (0.2892) acc_x 90.6250 (95.0000) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/19] time 0.335 (0.344) data 0.257 (0.266) loss_x loss_x 0.2854 (0.3109) acc_x 90.6250 (94.0625) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/19] time 0.342 (0.342) data 0.264 (0.265) loss_x loss_x 0.2837 (0.2867) acc_x 87.5000 (93.5417) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [5/31] time 0.337 (0.343) data 0.259 (0.265) loss_u loss_u 0.9941 (0.9539) acc_u 0.0000 (6.2500) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [10/31] time 0.338 (0.343) data 0.260 (0.265) loss_u loss_u 0.8833 (0.9433) acc_u 15.6250 (7.1875) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [15/31] time 0.353 (0.345) data 0.276 (0.267) loss_u loss_u 0.9805 (0.9441) acc_u 6.2500 (7.0833) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [20/31] time 0.330 (0.345) data 0.253 (0.267) loss_u loss_u 0.9819 (0.9466) acc_u 3.1250 (6.8750) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [25/31] time 0.303 (0.345) data 0.224 (0.267) loss_u loss_u 0.9263 (0.9454) acc_u 6.2500 (7.0000) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [30/31] time 0.302 (0.340) data 0.223 (0.262) loss_u loss_u 0.9971 (0.9493) acc_u 0.0000 (6.5625) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 745
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:297
clean false:317
clean_rate:0.4837133550488599
noisy true:590
noisy false:428
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [147/200] batch [5/19] time 0.345 (0.349) data 0.267 (0.271) loss_x loss_x 0.2837 (0.3330) acc_x 96.8750 (92.5000) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/19] time 0.339 (0.344) data 0.261 (0.267) loss_x loss_x 0.2690 (0.3555) acc_x 90.6250 (90.0000) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/19] time 0.336 (0.341) data 0.259 (0.263) loss_x loss_x 0.3452 (0.3548) acc_x 90.6250 (90.2083) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [5/31] time 0.353 (0.344) data 0.275 (0.267) loss_u loss_u 0.9941 (0.9598) acc_u 0.0000 (3.1250) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [10/31] time 0.328 (0.344) data 0.250 (0.266) loss_u loss_u 0.9438 (0.9444) acc_u 6.2500 (5.6250) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [15/31] time 0.329 (0.342) data 0.251 (0.265) loss_u loss_u 0.9414 (0.9479) acc_u 9.3750 (5.8333) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [20/31] time 0.343 (0.342) data 0.265 (0.264) loss_u loss_u 0.9663 (0.9508) acc_u 3.1250 (5.3125) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [25/31] time 0.328 (0.341) data 0.250 (0.263) loss_u loss_u 0.9907 (0.9475) acc_u 0.0000 (5.7500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [30/31] time 0.348 (0.339) data 0.270 (0.261) loss_u loss_u 0.9751 (0.9509) acc_u 3.1250 (5.4167) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 778
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 608
clean true:281
clean false:327
clean_rate:0.4621710526315789
noisy true:573
noisy false:451
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1024
epoch [148/200] batch [5/19] time 0.350 (0.342) data 0.272 (0.265) loss_x loss_x 0.2834 (0.4189) acc_x 93.7500 (90.6250) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/19] time 0.342 (0.340) data 0.265 (0.263) loss_x loss_x 0.4844 (0.4127) acc_x 87.5000 (90.9375) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [15/19] time 0.361 (0.343) data 0.284 (0.266) loss_x loss_x 0.2881 (0.3816) acc_x 93.7500 (90.8333) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [5/32] time 0.351 (0.343) data 0.272 (0.266) loss_u loss_u 0.9673 (0.9547) acc_u 3.1250 (5.0000) lr 3.3869e-04 eta 0:00:09
epoch [148/200] batch [10/32] time 0.343 (0.343) data 0.265 (0.265) loss_u loss_u 0.8906 (0.9440) acc_u 12.5000 (6.5625) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [15/32] time 0.338 (0.343) data 0.260 (0.265) loss_u loss_u 0.9668 (0.9507) acc_u 6.2500 (5.8333) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [20/32] time 0.337 (0.342) data 0.259 (0.265) loss_u loss_u 0.8921 (0.9495) acc_u 12.5000 (6.0938) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [25/32] time 0.357 (0.342) data 0.279 (0.265) loss_u loss_u 0.9048 (0.9458) acc_u 12.5000 (6.6250) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [30/32] time 0.329 (0.342) data 0.250 (0.264) loss_u loss_u 0.9976 (0.9467) acc_u 0.0000 (6.3542) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 754
confident_label rate tensor(0.3572, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 583
clean true:279
clean false:304
clean_rate:0.47855917667238423
noisy true:599
noisy false:450
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1049
epoch [149/200] batch [5/18] time 0.338 (0.339) data 0.260 (0.261) loss_x loss_x 0.4270 (0.3159) acc_x 93.7500 (93.1250) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/18] time 0.348 (0.343) data 0.271 (0.265) loss_x loss_x 0.4363 (0.3083) acc_x 90.6250 (92.8125) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/18] time 0.351 (0.344) data 0.273 (0.267) loss_x loss_x 0.2905 (0.3062) acc_x 90.6250 (92.2917) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [5/32] time 0.337 (0.346) data 0.258 (0.269) loss_u loss_u 0.9033 (0.9315) acc_u 12.5000 (7.5000) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [10/32] time 0.335 (0.346) data 0.257 (0.268) loss_u loss_u 0.9292 (0.9307) acc_u 9.3750 (7.8125) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [15/32] time 0.340 (0.346) data 0.263 (0.269) loss_u loss_u 0.9795 (0.9368) acc_u 0.0000 (6.8750) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [20/32] time 0.345 (0.346) data 0.268 (0.268) loss_u loss_u 0.9092 (0.9306) acc_u 9.3750 (7.6562) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [25/32] time 0.332 (0.345) data 0.254 (0.268) loss_u loss_u 0.9448 (0.9325) acc_u 6.2500 (7.3750) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [30/32] time 0.306 (0.344) data 0.227 (0.266) loss_u loss_u 0.9409 (0.9302) acc_u 6.2500 (7.8125) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 769
confident_label rate tensor(0.3646, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 595
clean true:282
clean false:313
clean_rate:0.47394957983193275
noisy true:581
noisy false:456
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1037
epoch [150/200] batch [5/18] time 0.362 (0.356) data 0.285 (0.278) loss_x loss_x 0.2206 (0.2047) acc_x 93.7500 (94.3750) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/18] time 0.338 (0.350) data 0.260 (0.273) loss_x loss_x 0.2559 (0.2615) acc_x 96.8750 (92.8125) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/18] time 0.357 (0.348) data 0.277 (0.270) loss_x loss_x 0.3765 (0.3102) acc_x 84.3750 (91.8750) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [5/32] time 0.370 (0.347) data 0.292 (0.269) loss_u loss_u 0.9194 (0.9407) acc_u 6.2500 (6.2500) lr 3.1545e-04 eta 0:00:09
epoch [150/200] batch [10/32] time 0.337 (0.347) data 0.259 (0.269) loss_u loss_u 0.9683 (0.9324) acc_u 3.1250 (7.1875) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [15/32] time 0.337 (0.347) data 0.259 (0.269) loss_u loss_u 0.9609 (0.9379) acc_u 6.2500 (6.6667) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [20/32] time 0.331 (0.345) data 0.253 (0.267) loss_u loss_u 0.9585 (0.9405) acc_u 3.1250 (6.4062) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [25/32] time 0.331 (0.344) data 0.254 (0.266) loss_u loss_u 0.9268 (0.9391) acc_u 9.3750 (6.7500) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [30/32] time 0.334 (0.342) data 0.255 (0.264) loss_u loss_u 0.9517 (0.9381) acc_u 6.2500 (6.7708) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 771
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:290
clean false:324
clean_rate:0.4723127035830619
noisy true:571
noisy false:447
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [151/200] batch [5/19] time 0.355 (0.348) data 0.278 (0.271) loss_x loss_x 0.4426 (0.3403) acc_x 84.3750 (91.2500) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/19] time 0.355 (0.351) data 0.277 (0.273) loss_x loss_x 0.2864 (0.3848) acc_x 93.7500 (89.6875) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [15/19] time 0.351 (0.352) data 0.274 (0.274) loss_x loss_x 0.2454 (0.3532) acc_x 93.7500 (91.4583) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [5/31] time 0.344 (0.349) data 0.265 (0.272) loss_u loss_u 0.9707 (0.9426) acc_u 3.1250 (6.2500) lr 3.0409e-04 eta 0:00:09
epoch [151/200] batch [10/31] time 0.336 (0.348) data 0.259 (0.270) loss_u loss_u 0.8994 (0.9417) acc_u 9.3750 (6.2500) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [15/31] time 0.351 (0.347) data 0.274 (0.269) loss_u loss_u 0.9214 (0.9386) acc_u 9.3750 (7.0833) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [20/31] time 0.341 (0.347) data 0.263 (0.269) loss_u loss_u 0.9761 (0.9450) acc_u 3.1250 (6.2500) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [25/31] time 0.345 (0.346) data 0.267 (0.268) loss_u loss_u 0.9453 (0.9458) acc_u 9.3750 (6.1250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [30/31] time 0.299 (0.343) data 0.220 (0.265) loss_u loss_u 0.9951 (0.9471) acc_u 0.0000 (6.0417) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 779
confident_label rate tensor(0.3640, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 594
clean true:278
clean false:316
clean_rate:0.468013468013468
noisy true:575
noisy false:463
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1038
epoch [152/200] batch [5/18] time 0.323 (0.336) data 0.246 (0.259) loss_x loss_x 0.4343 (0.3159) acc_x 84.3750 (93.7500) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/18] time 0.313 (0.332) data 0.236 (0.254) loss_x loss_x 0.3694 (0.3481) acc_x 93.7500 (92.8125) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/18] time 0.350 (0.336) data 0.273 (0.258) loss_x loss_x 0.4268 (0.3552) acc_x 90.6250 (92.0833) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [5/32] time 0.338 (0.337) data 0.260 (0.259) loss_u loss_u 0.9346 (0.9282) acc_u 6.2500 (7.5000) lr 2.9289e-04 eta 0:00:09
epoch [152/200] batch [10/32] time 0.335 (0.338) data 0.257 (0.261) loss_u loss_u 0.9580 (0.9208) acc_u 3.1250 (8.1250) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [15/32] time 0.326 (0.337) data 0.249 (0.259) loss_u loss_u 0.9116 (0.9085) acc_u 12.5000 (10.0000) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [20/32] time 0.353 (0.337) data 0.276 (0.260) loss_u loss_u 0.9683 (0.9248) acc_u 3.1250 (8.4375) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [25/32] time 0.338 (0.337) data 0.260 (0.259) loss_u loss_u 0.9722 (0.9317) acc_u 3.1250 (7.7500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [30/32] time 0.343 (0.337) data 0.263 (0.259) loss_u loss_u 0.9634 (0.9338) acc_u 3.1250 (7.3958) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 782
confident_label rate tensor(0.3646, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 595
clean true:280
clean false:315
clean_rate:0.47058823529411764
noisy true:570
noisy false:467
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1037
epoch [153/200] batch [5/18] time 0.336 (0.344) data 0.259 (0.266) loss_x loss_x 0.1865 (0.2828) acc_x 96.8750 (91.8750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/18] time 0.325 (0.335) data 0.248 (0.257) loss_x loss_x 0.2603 (0.2653) acc_x 93.7500 (93.4375) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/18] time 0.336 (0.336) data 0.257 (0.258) loss_x loss_x 0.1180 (0.2812) acc_x 100.0000 (93.3333) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [5/32] time 0.347 (0.337) data 0.270 (0.259) loss_u loss_u 0.9458 (0.9378) acc_u 6.2500 (7.5000) lr 2.8187e-04 eta 0:00:09
epoch [153/200] batch [10/32] time 0.359 (0.337) data 0.281 (0.260) loss_u loss_u 0.9824 (0.9359) acc_u 3.1250 (7.5000) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [15/32] time 0.339 (0.339) data 0.260 (0.261) loss_u loss_u 0.9868 (0.9255) acc_u 0.0000 (8.5417) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [20/32] time 0.336 (0.340) data 0.258 (0.262) loss_u loss_u 0.9282 (0.9329) acc_u 9.3750 (7.6562) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [25/32] time 0.344 (0.341) data 0.267 (0.263) loss_u loss_u 0.8892 (0.9300) acc_u 12.5000 (7.8750) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [30/32] time 0.359 (0.341) data 0.282 (0.264) loss_u loss_u 0.9141 (0.9243) acc_u 6.2500 (8.5417) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 763
confident_label rate tensor(0.3676, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 600
clean true:280
clean false:320
clean_rate:0.4666666666666667
noisy true:589
noisy false:443
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1032
epoch [154/200] batch [5/18] time 0.317 (0.339) data 0.240 (0.261) loss_x loss_x 0.3313 (0.4340) acc_x 90.6250 (91.2500) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/18] time 0.344 (0.338) data 0.267 (0.261) loss_x loss_x 0.3599 (0.3745) acc_x 90.6250 (91.5625) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/18] time 0.312 (0.337) data 0.234 (0.259) loss_x loss_x 0.3035 (0.3595) acc_x 93.7500 (92.0833) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [5/32] time 0.350 (0.341) data 0.271 (0.263) loss_u loss_u 0.9834 (0.9516) acc_u 0.0000 (5.6250) lr 2.7103e-04 eta 0:00:09
epoch [154/200] batch [10/32] time 0.338 (0.341) data 0.259 (0.263) loss_u loss_u 0.9150 (0.9421) acc_u 9.3750 (6.5625) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [15/32] time 0.344 (0.341) data 0.266 (0.264) loss_u loss_u 0.9263 (0.9401) acc_u 9.3750 (6.8750) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [20/32] time 0.341 (0.340) data 0.262 (0.262) loss_u loss_u 0.9502 (0.9433) acc_u 3.1250 (6.4062) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [25/32] time 0.339 (0.340) data 0.260 (0.263) loss_u loss_u 0.8604 (0.9383) acc_u 15.6250 (6.7500) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [30/32] time 0.342 (0.341) data 0.264 (0.263) loss_u loss_u 0.9634 (0.9386) acc_u 6.2500 (6.8750) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 759
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 617
clean true:293
clean false:324
clean_rate:0.47487844408427876
noisy true:580
noisy false:435
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 1015
epoch [155/200] batch [5/19] time 0.334 (0.353) data 0.256 (0.276) loss_x loss_x 0.4277 (0.2238) acc_x 93.7500 (97.5000) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/19] time 0.372 (0.349) data 0.294 (0.271) loss_x loss_x 0.2462 (0.2536) acc_x 93.7500 (95.6250) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [15/19] time 0.358 (0.350) data 0.281 (0.273) loss_x loss_x 0.7490 (0.2876) acc_x 84.3750 (95.0000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [5/31] time 0.334 (0.350) data 0.256 (0.273) loss_u loss_u 0.9844 (0.9562) acc_u 3.1250 (5.0000) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [10/31] time 0.344 (0.350) data 0.267 (0.273) loss_u loss_u 0.8574 (0.9376) acc_u 15.6250 (7.5000) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [15/31] time 0.353 (0.348) data 0.276 (0.271) loss_u loss_u 0.9214 (0.9380) acc_u 9.3750 (7.2917) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [20/31] time 0.350 (0.347) data 0.272 (0.270) loss_u loss_u 0.9600 (0.9430) acc_u 6.2500 (6.7188) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [25/31] time 0.360 (0.346) data 0.282 (0.268) loss_u loss_u 0.8652 (0.9390) acc_u 15.6250 (7.2500) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [30/31] time 0.306 (0.345) data 0.227 (0.267) loss_u loss_u 0.9517 (0.9433) acc_u 6.2500 (6.6667) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 781
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:288
clean false:326
clean_rate:0.46905537459283386
noisy true:563
noisy false:455
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [156/200] batch [5/19] time 0.330 (0.343) data 0.252 (0.265) loss_x loss_x 0.3740 (0.3021) acc_x 87.5000 (91.8750) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/19] time 0.336 (0.342) data 0.259 (0.264) loss_x loss_x 0.2301 (0.2849) acc_x 96.8750 (93.1250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/19] time 0.352 (0.342) data 0.275 (0.265) loss_x loss_x 0.2954 (0.2820) acc_x 93.7500 (93.5417) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [5/31] time 0.351 (0.344) data 0.273 (0.266) loss_u loss_u 0.9395 (0.9358) acc_u 6.2500 (6.8750) lr 2.4989e-04 eta 0:00:08
epoch [156/200] batch [10/31] time 0.328 (0.344) data 0.250 (0.266) loss_u loss_u 0.9683 (0.9417) acc_u 3.1250 (6.8750) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [15/31] time 0.355 (0.343) data 0.278 (0.265) loss_u loss_u 0.9961 (0.9431) acc_u 0.0000 (6.6667) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [20/31] time 0.332 (0.342) data 0.255 (0.265) loss_u loss_u 0.9404 (0.9432) acc_u 6.2500 (6.7188) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [25/31] time 0.344 (0.342) data 0.267 (0.265) loss_u loss_u 0.9868 (0.9462) acc_u 3.1250 (6.2500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [30/31] time 0.292 (0.338) data 0.213 (0.261) loss_u loss_u 0.9922 (0.9455) acc_u 0.0000 (6.4583) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 782
confident_label rate tensor(0.3683, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 601
clean true:285
clean false:316
clean_rate:0.47420965058236275
noisy true:565
noisy false:466
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1031
epoch [157/200] batch [5/18] time 0.395 (0.355) data 0.317 (0.277) loss_x loss_x 0.3320 (0.2912) acc_x 90.6250 (93.1250) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/18] time 0.360 (0.350) data 0.283 (0.271) loss_x loss_x 0.3098 (0.2685) acc_x 93.7500 (94.6875) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/18] time 0.344 (0.349) data 0.266 (0.271) loss_x loss_x 0.2673 (0.2941) acc_x 96.8750 (93.7500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [5/32] time 0.352 (0.348) data 0.274 (0.270) loss_u loss_u 0.9409 (0.9348) acc_u 9.3750 (8.7500) lr 2.3959e-04 eta 0:00:09
epoch [157/200] batch [10/32] time 0.347 (0.348) data 0.270 (0.270) loss_u loss_u 0.9829 (0.9532) acc_u 3.1250 (5.9375) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [15/32] time 0.347 (0.348) data 0.269 (0.270) loss_u loss_u 0.9126 (0.9420) acc_u 9.3750 (6.8750) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [20/32] time 0.344 (0.348) data 0.266 (0.269) loss_u loss_u 0.9517 (0.9423) acc_u 6.2500 (6.7188) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [25/32] time 0.339 (0.347) data 0.260 (0.269) loss_u loss_u 0.9507 (0.9444) acc_u 6.2500 (6.5000) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [30/32] time 0.343 (0.345) data 0.266 (0.266) loss_u loss_u 0.8120 (0.9381) acc_u 21.8750 (7.2917) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 766
confident_label rate tensor(0.3707, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 605
clean true:285
clean false:320
clean_rate:0.47107438016528924
noisy true:581
noisy false:446
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1027
epoch [158/200] batch [5/18] time 0.350 (0.346) data 0.273 (0.269) loss_x loss_x 0.1893 (0.2417) acc_x 93.7500 (94.3750) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/18] time 0.349 (0.349) data 0.271 (0.271) loss_x loss_x 0.2659 (0.2531) acc_x 93.7500 (94.0625) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/18] time 0.329 (0.346) data 0.252 (0.269) loss_x loss_x 0.3438 (0.2833) acc_x 93.7500 (93.7500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [5/32] time 0.324 (0.342) data 0.246 (0.265) loss_u loss_u 0.8936 (0.9330) acc_u 12.5000 (7.5000) lr 2.2949e-04 eta 0:00:09
epoch [158/200] batch [10/32] time 0.353 (0.341) data 0.275 (0.263) loss_u loss_u 0.9121 (0.9253) acc_u 9.3750 (8.7500) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [15/32] time 0.335 (0.341) data 0.257 (0.263) loss_u loss_u 0.9346 (0.9326) acc_u 6.2500 (8.1250) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [20/32] time 0.326 (0.341) data 0.248 (0.263) loss_u loss_u 0.9165 (0.9366) acc_u 9.3750 (7.5000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [25/32] time 0.362 (0.341) data 0.283 (0.263) loss_u loss_u 0.9175 (0.9335) acc_u 9.3750 (7.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [30/32] time 0.310 (0.338) data 0.231 (0.260) loss_u loss_u 0.9736 (0.9357) acc_u 3.1250 (7.5000) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 765
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 599
clean true:283
clean false:316
clean_rate:0.4724540901502504
noisy true:584
noisy false:449
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1033
epoch [159/200] batch [5/18] time 0.350 (0.347) data 0.272 (0.270) loss_x loss_x 0.4368 (0.3225) acc_x 93.7500 (91.8750) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/18] time 0.355 (0.351) data 0.276 (0.273) loss_x loss_x 0.2275 (0.3164) acc_x 90.6250 (91.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/18] time 0.333 (0.346) data 0.255 (0.269) loss_x loss_x 0.2188 (0.2886) acc_x 96.8750 (92.5000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [5/32] time 0.357 (0.346) data 0.279 (0.268) loss_u loss_u 0.9380 (0.9514) acc_u 6.2500 (5.0000) lr 2.1957e-04 eta 0:00:09
epoch [159/200] batch [10/32] time 0.358 (0.347) data 0.281 (0.269) loss_u loss_u 0.9399 (0.9478) acc_u 6.2500 (5.3125) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [15/32] time 0.349 (0.346) data 0.271 (0.269) loss_u loss_u 0.9292 (0.9296) acc_u 9.3750 (7.9167) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [20/32] time 0.345 (0.346) data 0.267 (0.269) loss_u loss_u 0.9434 (0.9264) acc_u 6.2500 (8.2812) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [25/32] time 0.305 (0.345) data 0.227 (0.267) loss_u loss_u 0.8892 (0.9248) acc_u 12.5000 (8.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [30/32] time 0.357 (0.342) data 0.280 (0.264) loss_u loss_u 0.9121 (0.9262) acc_u 12.5000 (8.1250) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 780
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 608
clean true:281
clean false:327
clean_rate:0.4621710526315789
noisy true:571
noisy false:453
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1024
epoch [160/200] batch [5/19] time 0.346 (0.343) data 0.269 (0.265) loss_x loss_x 0.1737 (0.2721) acc_x 96.8750 (95.6250) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/19] time 0.339 (0.345) data 0.262 (0.268) loss_x loss_x 0.2981 (0.2884) acc_x 90.6250 (94.3750) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [15/19] time 0.333 (0.340) data 0.256 (0.263) loss_x loss_x 0.2201 (0.3221) acc_x 96.8750 (93.9583) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [5/32] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9434 (0.9263) acc_u 6.2500 (8.1250) lr 2.0984e-04 eta 0:00:09
epoch [160/200] batch [10/32] time 0.346 (0.341) data 0.268 (0.263) loss_u loss_u 0.9639 (0.9218) acc_u 3.1250 (8.7500) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [15/32] time 0.345 (0.341) data 0.268 (0.263) loss_u loss_u 0.9551 (0.9314) acc_u 6.2500 (7.9167) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [20/32] time 0.346 (0.342) data 0.268 (0.264) loss_u loss_u 0.9980 (0.9328) acc_u 0.0000 (7.6562) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [25/32] time 0.342 (0.341) data 0.264 (0.264) loss_u loss_u 0.9624 (0.9378) acc_u 3.1250 (7.1250) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [30/32] time 0.337 (0.339) data 0.260 (0.261) loss_u loss_u 0.8931 (0.9371) acc_u 12.5000 (7.2917) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 758
confident_label rate tensor(0.3683, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 601
clean true:283
clean false:318
clean_rate:0.47088186356073214
noisy true:591
noisy false:440
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1031
epoch [161/200] batch [5/18] time 0.340 (0.349) data 0.263 (0.271) loss_x loss_x 0.3230 (0.3586) acc_x 93.7500 (92.5000) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/18] time 0.338 (0.343) data 0.261 (0.265) loss_x loss_x 0.2896 (0.2933) acc_x 96.8750 (94.0625) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/18] time 0.329 (0.341) data 0.252 (0.264) loss_x loss_x 0.7549 (0.2999) acc_x 81.2500 (94.1667) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [5/32] time 0.330 (0.342) data 0.252 (0.264) loss_u loss_u 0.9556 (0.9227) acc_u 6.2500 (8.7500) lr 2.0032e-04 eta 0:00:09
epoch [161/200] batch [10/32] time 0.334 (0.341) data 0.256 (0.263) loss_u loss_u 0.9097 (0.9195) acc_u 9.3750 (8.7500) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [15/32] time 0.331 (0.340) data 0.253 (0.262) loss_u loss_u 0.9375 (0.9330) acc_u 9.3750 (7.5000) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [20/32] time 0.354 (0.340) data 0.276 (0.263) loss_u loss_u 0.9619 (0.9352) acc_u 3.1250 (7.3438) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [25/32] time 0.337 (0.341) data 0.259 (0.263) loss_u loss_u 0.9780 (0.9335) acc_u 3.1250 (7.6250) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [30/32] time 0.300 (0.338) data 0.222 (0.261) loss_u loss_u 0.9106 (0.9311) acc_u 9.3750 (7.9167) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 778
confident_label rate tensor(0.3634, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 593
clean true:276
clean false:317
clean_rate:0.4654300168634064
noisy true:578
noisy false:461
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1039
epoch [162/200] batch [5/18] time 0.345 (0.351) data 0.268 (0.273) loss_x loss_x 0.2971 (0.3385) acc_x 93.7500 (91.2500) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/18] time 0.352 (0.347) data 0.274 (0.270) loss_x loss_x 0.5220 (0.3769) acc_x 93.7500 (91.8750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/18] time 0.343 (0.346) data 0.266 (0.269) loss_x loss_x 0.3142 (0.3771) acc_x 93.7500 (91.6667) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [5/32] time 0.349 (0.346) data 0.271 (0.268) loss_u loss_u 0.9985 (0.9534) acc_u 0.0000 (5.0000) lr 1.9098e-04 eta 0:00:09
epoch [162/200] batch [10/32] time 0.337 (0.345) data 0.260 (0.267) loss_u loss_u 0.9453 (0.9358) acc_u 6.2500 (7.5000) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [15/32] time 0.348 (0.345) data 0.271 (0.267) loss_u loss_u 0.9346 (0.9309) acc_u 6.2500 (7.9167) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [20/32] time 0.348 (0.346) data 0.269 (0.268) loss_u loss_u 0.9351 (0.9285) acc_u 9.3750 (8.1250) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [25/32] time 0.355 (0.346) data 0.275 (0.268) loss_u loss_u 0.9468 (0.9300) acc_u 6.2500 (8.0000) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [30/32] time 0.342 (0.346) data 0.264 (0.268) loss_u loss_u 0.8911 (0.9255) acc_u 9.3750 (8.3333) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 762
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 610
clean true:286
clean false:324
clean_rate:0.46885245901639344
noisy true:584
noisy false:438
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1022
epoch [163/200] batch [5/19] time 0.330 (0.323) data 0.252 (0.245) loss_x loss_x 0.3523 (0.3408) acc_x 90.6250 (92.5000) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/19] time 0.352 (0.331) data 0.275 (0.254) loss_x loss_x 0.5781 (0.3703) acc_x 93.7500 (92.1875) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/19] time 0.321 (0.336) data 0.243 (0.258) loss_x loss_x 1.0527 (0.3833) acc_x 81.2500 (92.2917) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [5/31] time 0.332 (0.336) data 0.254 (0.259) loss_u loss_u 0.9937 (0.9492) acc_u 0.0000 (6.2500) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [10/31] time 0.348 (0.338) data 0.271 (0.261) loss_u loss_u 0.9814 (0.9343) acc_u 3.1250 (7.5000) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [15/31] time 0.344 (0.339) data 0.267 (0.261) loss_u loss_u 0.9126 (0.9288) acc_u 12.5000 (8.1250) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [20/31] time 0.353 (0.340) data 0.274 (0.262) loss_u loss_u 0.9072 (0.9349) acc_u 12.5000 (7.5000) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [25/31] time 0.334 (0.340) data 0.256 (0.262) loss_u loss_u 0.9487 (0.9379) acc_u 6.2500 (7.2500) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [30/31] time 0.350 (0.341) data 0.272 (0.263) loss_u loss_u 0.9541 (0.9390) acc_u 3.1250 (6.9792) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 750
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 610
clean true:286
clean false:324
clean_rate:0.46885245901639344
noisy true:596
noisy false:426
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1022
epoch [164/200] batch [5/19] time 0.347 (0.349) data 0.271 (0.272) loss_x loss_x 0.2188 (0.3055) acc_x 93.7500 (94.3750) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/19] time 0.342 (0.350) data 0.265 (0.273) loss_x loss_x 0.2194 (0.2641) acc_x 90.6250 (95.3125) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/19] time 0.345 (0.349) data 0.268 (0.272) loss_x loss_x 0.1353 (0.2639) acc_x 100.0000 (95.2083) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [5/31] time 0.355 (0.351) data 0.276 (0.273) loss_u loss_u 0.9238 (0.9318) acc_u 12.5000 (7.5000) lr 1.7292e-04 eta 0:00:09
epoch [164/200] batch [10/31] time 0.346 (0.349) data 0.269 (0.272) loss_u loss_u 0.9326 (0.9190) acc_u 6.2500 (8.7500) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [15/31] time 0.350 (0.349) data 0.272 (0.271) loss_u loss_u 0.9673 (0.9272) acc_u 3.1250 (7.9167) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [20/31] time 0.366 (0.349) data 0.288 (0.272) loss_u loss_u 0.9985 (0.9321) acc_u 0.0000 (7.5000) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [25/31] time 0.352 (0.349) data 0.273 (0.272) loss_u loss_u 0.9731 (0.9371) acc_u 3.1250 (6.8750) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [30/31] time 0.301 (0.344) data 0.222 (0.267) loss_u loss_u 0.9360 (0.9383) acc_u 6.2500 (6.7708) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 764
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 598
clean true:286
clean false:312
clean_rate:0.4782608695652174
noisy true:582
noisy false:452
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1034
epoch [165/200] batch [5/18] time 0.342 (0.357) data 0.264 (0.280) loss_x loss_x 0.5010 (0.3219) acc_x 87.5000 (93.7500) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/18] time 0.341 (0.353) data 0.264 (0.276) loss_x loss_x 0.2045 (0.3002) acc_x 93.7500 (93.4375) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/18] time 0.313 (0.347) data 0.235 (0.270) loss_x loss_x 0.5386 (0.3177) acc_x 90.6250 (93.3333) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [5/32] time 0.357 (0.347) data 0.278 (0.269) loss_u loss_u 0.9438 (0.9241) acc_u 6.2500 (8.7500) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [10/32] time 0.358 (0.348) data 0.279 (0.270) loss_u loss_u 0.9404 (0.9302) acc_u 9.3750 (7.8125) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [15/32] time 0.330 (0.348) data 0.251 (0.270) loss_u loss_u 0.9688 (0.9381) acc_u 3.1250 (7.0833) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [20/32] time 0.345 (0.347) data 0.267 (0.269) loss_u loss_u 0.9395 (0.9316) acc_u 6.2500 (7.6562) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [25/32] time 0.334 (0.347) data 0.256 (0.269) loss_u loss_u 0.9438 (0.9358) acc_u 6.2500 (7.2500) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [30/32] time 0.305 (0.343) data 0.226 (0.265) loss_u loss_u 0.8906 (0.9322) acc_u 12.5000 (7.7083) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 782
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 599
clean true:281
clean false:318
clean_rate:0.4691151919866444
noisy true:569
noisy false:464
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1033
epoch [166/200] batch [5/18] time 0.330 (0.339) data 0.252 (0.262) loss_x loss_x 0.2031 (0.3214) acc_x 93.7500 (93.7500) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/18] time 0.333 (0.336) data 0.256 (0.258) loss_x loss_x 0.2532 (0.3219) acc_x 93.7500 (93.4375) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/18] time 0.344 (0.336) data 0.266 (0.258) loss_x loss_x 0.5645 (0.3347) acc_x 87.5000 (92.2917) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [5/32] time 0.338 (0.339) data 0.261 (0.261) loss_u loss_u 0.7505 (0.8976) acc_u 28.1250 (11.8750) lr 1.5567e-04 eta 0:00:09
epoch [166/200] batch [10/32] time 0.367 (0.341) data 0.290 (0.263) loss_u loss_u 0.9087 (0.9125) acc_u 12.5000 (10.6250) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [15/32] time 0.344 (0.340) data 0.266 (0.262) loss_u loss_u 0.9067 (0.9239) acc_u 12.5000 (9.3750) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [20/32] time 0.350 (0.340) data 0.272 (0.262) loss_u loss_u 0.8848 (0.9271) acc_u 12.5000 (8.5938) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [25/32] time 0.334 (0.341) data 0.256 (0.263) loss_u loss_u 0.8877 (0.9290) acc_u 12.5000 (8.6250) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [30/32] time 0.340 (0.340) data 0.260 (0.262) loss_u loss_u 0.9146 (0.9302) acc_u 9.3750 (8.3333) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 761
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 608
clean true:288
clean false:320
clean_rate:0.47368421052631576
noisy true:583
noisy false:441
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1024
epoch [167/200] batch [5/19] time 0.358 (0.362) data 0.281 (0.284) loss_x loss_x 0.3276 (0.3962) acc_x 96.8750 (93.1250) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [10/19] time 0.346 (0.356) data 0.268 (0.279) loss_x loss_x 0.3435 (0.3403) acc_x 96.8750 (94.3750) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/19] time 0.355 (0.353) data 0.278 (0.276) loss_x loss_x 0.2041 (0.2945) acc_x 100.0000 (95.0000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [5/32] time 0.339 (0.350) data 0.260 (0.273) loss_u loss_u 0.9434 (0.9238) acc_u 6.2500 (8.1250) lr 1.4736e-04 eta 0:00:09
epoch [167/200] batch [10/32] time 0.336 (0.348) data 0.257 (0.270) loss_u loss_u 0.9614 (0.9361) acc_u 6.2500 (6.8750) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [15/32] time 0.348 (0.347) data 0.270 (0.269) loss_u loss_u 0.9634 (0.9370) acc_u 3.1250 (6.8750) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [20/32] time 0.344 (0.345) data 0.266 (0.267) loss_u loss_u 0.9502 (0.9377) acc_u 6.2500 (7.0312) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [25/32] time 0.344 (0.347) data 0.265 (0.269) loss_u loss_u 0.9360 (0.9335) acc_u 9.3750 (7.3750) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [30/32] time 0.299 (0.343) data 0.220 (0.265) loss_u loss_u 0.9409 (0.9359) acc_u 6.2500 (7.0833) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 770
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:290
clean false:329
clean_rate:0.46849757673667203
noisy true:572
noisy false:441
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [168/200] batch [5/19] time 0.343 (0.352) data 0.266 (0.274) loss_x loss_x 0.2598 (0.2497) acc_x 96.8750 (95.0000) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/19] time 0.348 (0.345) data 0.270 (0.268) loss_x loss_x 0.1768 (0.2369) acc_x 96.8750 (95.9375) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/19] time 0.341 (0.344) data 0.264 (0.267) loss_x loss_x 0.2917 (0.2601) acc_x 93.7500 (95.2083) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [5/31] time 0.355 (0.346) data 0.277 (0.269) loss_u loss_u 0.9375 (0.9117) acc_u 6.2500 (10.0000) lr 1.3926e-04 eta 0:00:09
epoch [168/200] batch [10/31] time 0.331 (0.345) data 0.253 (0.268) loss_u loss_u 0.9917 (0.9376) acc_u 0.0000 (6.8750) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [15/31] time 0.351 (0.345) data 0.273 (0.267) loss_u loss_u 0.9121 (0.9412) acc_u 9.3750 (6.4583) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [20/31] time 0.333 (0.343) data 0.255 (0.265) loss_u loss_u 0.9053 (0.9442) acc_u 12.5000 (6.2500) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [25/31] time 0.297 (0.341) data 0.218 (0.263) loss_u loss_u 0.9194 (0.9456) acc_u 9.3750 (6.0000) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [30/31] time 0.334 (0.337) data 0.256 (0.260) loss_u loss_u 0.9214 (0.9450) acc_u 6.2500 (5.9375) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 752
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 616
clean true:293
clean false:323
clean_rate:0.47564935064935066
noisy true:587
noisy false:429
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1016
epoch [169/200] batch [5/19] time 0.348 (0.350) data 0.271 (0.272) loss_x loss_x 0.5103 (0.2735) acc_x 90.6250 (93.7500) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [10/19] time 0.342 (0.346) data 0.265 (0.268) loss_x loss_x 0.2896 (0.2947) acc_x 93.7500 (93.7500) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/19] time 0.348 (0.344) data 0.270 (0.267) loss_x loss_x 0.1843 (0.2603) acc_x 96.8750 (94.5833) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [5/31] time 0.352 (0.345) data 0.274 (0.267) loss_u loss_u 0.9517 (0.9430) acc_u 6.2500 (5.6250) lr 1.3137e-04 eta 0:00:08
epoch [169/200] batch [10/31] time 0.348 (0.344) data 0.271 (0.267) loss_u loss_u 0.8931 (0.9328) acc_u 12.5000 (7.1875) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [15/31] time 0.330 (0.344) data 0.252 (0.266) loss_u loss_u 0.9902 (0.9340) acc_u 0.0000 (7.5000) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [20/31] time 0.329 (0.344) data 0.251 (0.266) loss_u loss_u 0.9644 (0.9413) acc_u 6.2500 (6.7188) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [25/31] time 0.296 (0.341) data 0.218 (0.263) loss_u loss_u 0.9165 (0.9397) acc_u 9.3750 (7.0000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [30/31] time 0.340 (0.339) data 0.261 (0.261) loss_u loss_u 0.9976 (0.9434) acc_u 0.0000 (6.5625) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 762
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 616
clean true:289
clean false:327
clean_rate:0.46915584415584416
noisy true:581
noisy false:435
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1016
epoch [170/200] batch [5/19] time 0.360 (0.349) data 0.283 (0.272) loss_x loss_x 0.2120 (0.3282) acc_x 96.8750 (90.0000) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/19] time 0.351 (0.347) data 0.274 (0.269) loss_x loss_x 0.2542 (0.3517) acc_x 93.7500 (90.0000) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/19] time 0.353 (0.348) data 0.276 (0.270) loss_x loss_x 0.2720 (0.3238) acc_x 93.7500 (91.2500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [5/31] time 0.342 (0.346) data 0.264 (0.269) loss_u loss_u 0.9302 (0.9335) acc_u 9.3750 (6.8750) lr 1.2369e-04 eta 0:00:09
epoch [170/200] batch [10/31] time 0.334 (0.346) data 0.256 (0.268) loss_u loss_u 0.9355 (0.9375) acc_u 6.2500 (6.5625) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [15/31] time 0.318 (0.345) data 0.240 (0.267) loss_u loss_u 0.9688 (0.9447) acc_u 3.1250 (6.0417) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [20/31] time 0.347 (0.345) data 0.270 (0.267) loss_u loss_u 0.9199 (0.9476) acc_u 9.3750 (5.9375) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [25/31] time 0.333 (0.345) data 0.254 (0.267) loss_u loss_u 0.9419 (0.9501) acc_u 6.2500 (5.5000) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [30/31] time 0.311 (0.340) data 0.232 (0.262) loss_u loss_u 0.9580 (0.9480) acc_u 3.1250 (5.5208) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 769
confident_label rate tensor(0.3768, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 615
clean true:289
clean false:326
clean_rate:0.46991869918699186
noisy true:574
noisy false:443
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1017
epoch [171/200] batch [5/19] time 0.346 (0.351) data 0.269 (0.274) loss_x loss_x 0.3550 (0.3554) acc_x 90.6250 (90.6250) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [10/19] time 0.363 (0.352) data 0.286 (0.275) loss_x loss_x 0.1526 (0.2822) acc_x 100.0000 (93.1250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [15/19] time 0.344 (0.346) data 0.267 (0.269) loss_x loss_x 0.2257 (0.2801) acc_x 96.8750 (93.3333) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [5/31] time 0.341 (0.345) data 0.262 (0.268) loss_u loss_u 0.9731 (0.9467) acc_u 3.1250 (5.6250) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [10/31] time 0.336 (0.343) data 0.258 (0.265) loss_u loss_u 0.9878 (0.9559) acc_u 3.1250 (5.0000) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [15/31] time 0.326 (0.341) data 0.248 (0.263) loss_u loss_u 0.8804 (0.9515) acc_u 12.5000 (5.4167) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [20/31] time 0.325 (0.339) data 0.247 (0.262) loss_u loss_u 0.9360 (0.9481) acc_u 6.2500 (5.7812) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [25/31] time 0.341 (0.339) data 0.262 (0.262) loss_u loss_u 0.8955 (0.9438) acc_u 12.5000 (6.2500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [30/31] time 0.351 (0.340) data 0.272 (0.263) loss_u loss_u 0.8271 (0.9401) acc_u 18.7500 (6.6667) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 771
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 610
clean true:282
clean false:328
clean_rate:0.46229508196721314
noisy true:579
noisy false:443
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1022
epoch [172/200] batch [5/19] time 0.328 (0.339) data 0.251 (0.261) loss_x loss_x 0.4214 (0.4582) acc_x 87.5000 (89.3750) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/19] time 0.346 (0.344) data 0.269 (0.266) loss_x loss_x 0.7241 (0.4149) acc_x 81.2500 (90.3125) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/19] time 0.347 (0.344) data 0.270 (0.266) loss_x loss_x 0.1661 (0.4121) acc_x 96.8750 (90.8333) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [5/31] time 0.347 (0.342) data 0.270 (0.264) loss_u loss_u 0.9536 (0.9423) acc_u 6.2500 (6.2500) lr 1.0899e-04 eta 0:00:08
epoch [172/200] batch [10/31] time 0.352 (0.342) data 0.275 (0.264) loss_u loss_u 0.9302 (0.9341) acc_u 6.2500 (6.8750) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [15/31] time 0.341 (0.343) data 0.262 (0.265) loss_u loss_u 0.8677 (0.9298) acc_u 15.6250 (7.7083) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [20/31] time 0.330 (0.342) data 0.253 (0.265) loss_u loss_u 0.9292 (0.9316) acc_u 9.3750 (7.5000) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [25/31] time 0.328 (0.341) data 0.249 (0.264) loss_u loss_u 0.9819 (0.9340) acc_u 3.1250 (7.3750) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [30/31] time 0.300 (0.337) data 0.221 (0.259) loss_u loss_u 0.9282 (0.9327) acc_u 6.2500 (7.5000) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 774
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 607
clean true:281
clean false:326
clean_rate:0.46293245469522243
noisy true:577
noisy false:448
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1025
epoch [173/200] batch [5/18] time 0.355 (0.336) data 0.277 (0.258) loss_x loss_x 0.3262 (0.2653) acc_x 93.7500 (95.0000) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/18] time 0.349 (0.341) data 0.272 (0.263) loss_x loss_x 0.2375 (0.2890) acc_x 96.8750 (94.3750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/18] time 0.344 (0.343) data 0.267 (0.266) loss_x loss_x 0.3044 (0.2632) acc_x 93.7500 (95.2083) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [5/32] time 0.345 (0.343) data 0.266 (0.265) loss_u loss_u 0.9951 (0.9528) acc_u 0.0000 (5.0000) lr 1.0197e-04 eta 0:00:09
epoch [173/200] batch [10/32] time 0.339 (0.343) data 0.260 (0.265) loss_u loss_u 0.9951 (0.9476) acc_u 0.0000 (5.6250) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [15/32] time 0.352 (0.344) data 0.274 (0.266) loss_u loss_u 0.9668 (0.9425) acc_u 9.3750 (7.0833) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [20/32] time 0.341 (0.343) data 0.263 (0.265) loss_u loss_u 0.9136 (0.9440) acc_u 9.3750 (6.7188) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [25/32] time 0.374 (0.345) data 0.296 (0.267) loss_u loss_u 0.9087 (0.9395) acc_u 9.3750 (7.0000) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [30/32] time 0.306 (0.343) data 0.228 (0.265) loss_u loss_u 0.8994 (0.9426) acc_u 9.3750 (6.4583) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 763
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 613
clean true:290
clean false:323
clean_rate:0.4730831973898858
noisy true:579
noisy false:440
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1019
epoch [174/200] batch [5/19] time 0.331 (0.337) data 0.254 (0.259) loss_x loss_x 0.2325 (0.2607) acc_x 96.8750 (92.5000) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/19] time 0.333 (0.338) data 0.255 (0.260) loss_x loss_x 0.4849 (0.2685) acc_x 87.5000 (92.8125) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [15/19] time 0.330 (0.338) data 0.253 (0.261) loss_x loss_x 0.1888 (0.2843) acc_x 100.0000 (92.9167) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [5/31] time 0.343 (0.340) data 0.266 (0.263) loss_u loss_u 0.8979 (0.9160) acc_u 12.5000 (8.7500) lr 9.5173e-05 eta 0:00:08
epoch [174/200] batch [10/31] time 0.338 (0.340) data 0.260 (0.262) loss_u loss_u 0.9717 (0.9288) acc_u 3.1250 (7.5000) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [15/31] time 0.346 (0.341) data 0.269 (0.263) loss_u loss_u 0.9673 (0.9306) acc_u 6.2500 (7.7083) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [20/31] time 0.324 (0.340) data 0.247 (0.262) loss_u loss_u 0.9443 (0.9339) acc_u 6.2500 (7.3438) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [25/31] time 0.327 (0.338) data 0.248 (0.261) loss_u loss_u 0.8237 (0.9324) acc_u 21.8750 (7.6250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [30/31] time 0.334 (0.338) data 0.255 (0.260) loss_u loss_u 0.9844 (0.9359) acc_u 0.0000 (7.1875) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 748
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 607
clean true:287
clean false:320
clean_rate:0.4728171334431631
noisy true:597
noisy false:428
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1025
epoch [175/200] batch [5/18] time 0.303 (0.329) data 0.225 (0.251) loss_x loss_x 0.2856 (0.3682) acc_x 93.7500 (90.6250) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/18] time 0.353 (0.322) data 0.276 (0.244) loss_x loss_x 0.1482 (0.3614) acc_x 96.8750 (91.5625) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/18] time 0.345 (0.328) data 0.267 (0.250) loss_x loss_x 0.2668 (0.3454) acc_x 90.6250 (91.4583) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/32] time 0.344 (0.329) data 0.267 (0.251) loss_u loss_u 0.9297 (0.9358) acc_u 9.3750 (7.5000) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [10/32] time 0.333 (0.331) data 0.255 (0.253) loss_u loss_u 0.9741 (0.9427) acc_u 3.1250 (6.8750) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [15/32] time 0.356 (0.333) data 0.279 (0.255) loss_u loss_u 0.8555 (0.9376) acc_u 15.6250 (7.5000) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [20/32] time 0.342 (0.335) data 0.265 (0.257) loss_u loss_u 0.8315 (0.9332) acc_u 18.7500 (7.8125) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [25/32] time 0.354 (0.337) data 0.276 (0.259) loss_u loss_u 0.9292 (0.9310) acc_u 6.2500 (8.0000) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [30/32] time 0.346 (0.337) data 0.268 (0.259) loss_u loss_u 0.9980 (0.9406) acc_u 0.0000 (6.7708) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 766
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 610
clean true:281
clean false:329
clean_rate:0.460655737704918
noisy true:585
noisy false:437
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1022
epoch [176/200] batch [5/19] time 0.347 (0.357) data 0.269 (0.279) loss_x loss_x 0.3699 (0.3771) acc_x 90.6250 (92.5000) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/19] time 0.346 (0.354) data 0.269 (0.276) loss_x loss_x 0.2000 (0.3024) acc_x 93.7500 (92.8125) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/19] time 0.348 (0.351) data 0.271 (0.274) loss_x loss_x 0.3677 (0.2933) acc_x 87.5000 (93.1250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [5/31] time 0.352 (0.351) data 0.274 (0.273) loss_u loss_u 0.9912 (0.9489) acc_u 0.0000 (5.6250) lr 8.2245e-05 eta 0:00:09
epoch [176/200] batch [10/31] time 0.332 (0.350) data 0.255 (0.272) loss_u loss_u 0.9399 (0.9462) acc_u 6.2500 (6.5625) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [15/31] time 0.330 (0.349) data 0.252 (0.271) loss_u loss_u 0.9268 (0.9463) acc_u 9.3750 (6.4583) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [20/31] time 0.324 (0.346) data 0.246 (0.268) loss_u loss_u 0.9463 (0.9417) acc_u 6.2500 (7.0312) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [25/31] time 0.313 (0.343) data 0.235 (0.266) loss_u loss_u 0.9487 (0.9384) acc_u 6.2500 (7.3750) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [30/31] time 0.308 (0.342) data 0.229 (0.264) loss_u loss_u 0.9536 (0.9397) acc_u 9.3750 (7.2917) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 772
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 598
clean true:282
clean false:316
clean_rate:0.47157190635451507
noisy true:578
noisy false:456
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1034
epoch [177/200] batch [5/18] time 0.330 (0.351) data 0.253 (0.274) loss_x loss_x 0.2786 (0.3037) acc_x 93.7500 (93.7500) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/18] time 0.354 (0.349) data 0.276 (0.272) loss_x loss_x 0.1661 (0.2662) acc_x 96.8750 (94.0625) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/18] time 0.341 (0.348) data 0.263 (0.271) loss_x loss_x 0.3855 (0.2758) acc_x 90.6250 (93.7500) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [5/32] time 0.321 (0.344) data 0.243 (0.267) loss_u loss_u 0.8984 (0.9544) acc_u 15.6250 (6.8750) lr 7.6120e-05 eta 0:00:09
epoch [177/200] batch [10/32] time 0.342 (0.342) data 0.265 (0.264) loss_u loss_u 0.9258 (0.9266) acc_u 9.3750 (9.3750) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [15/32] time 0.359 (0.343) data 0.281 (0.265) loss_u loss_u 0.8877 (0.9297) acc_u 15.6250 (8.9583) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [20/32] time 0.309 (0.342) data 0.232 (0.264) loss_u loss_u 0.9624 (0.9295) acc_u 3.1250 (8.5938) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [25/32] time 0.330 (0.341) data 0.252 (0.264) loss_u loss_u 0.8877 (0.9254) acc_u 12.5000 (8.8750) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [30/32] time 0.360 (0.342) data 0.281 (0.264) loss_u loss_u 0.9351 (0.9248) acc_u 6.2500 (8.7500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 763
confident_label rate tensor(0.3732, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 609
clean true:291
clean false:318
clean_rate:0.47783251231527096
noisy true:578
noisy false:445
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1023
epoch [178/200] batch [5/19] time 0.348 (0.342) data 0.271 (0.264) loss_x loss_x 0.2634 (0.1796) acc_x 93.7500 (96.2500) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/19] time 0.344 (0.342) data 0.267 (0.265) loss_x loss_x 0.1929 (0.1914) acc_x 96.8750 (95.6250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/19] time 0.338 (0.342) data 0.260 (0.265) loss_x loss_x 0.1312 (0.1899) acc_x 100.0000 (95.6250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [5/31] time 0.306 (0.342) data 0.228 (0.264) loss_u loss_u 0.9395 (0.9262) acc_u 6.2500 (8.1250) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [10/31] time 0.362 (0.340) data 0.284 (0.262) loss_u loss_u 0.9746 (0.9481) acc_u 3.1250 (5.9375) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [15/31] time 0.355 (0.342) data 0.277 (0.264) loss_u loss_u 0.9624 (0.9443) acc_u 3.1250 (6.2500) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [20/31] time 0.312 (0.342) data 0.234 (0.264) loss_u loss_u 0.9419 (0.9417) acc_u 6.2500 (6.7188) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [25/31] time 0.329 (0.339) data 0.252 (0.261) loss_u loss_u 0.8823 (0.9412) acc_u 12.5000 (6.6250) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [30/31] time 0.343 (0.340) data 0.266 (0.262) loss_u loss_u 0.9277 (0.9388) acc_u 12.5000 (7.0833) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 768
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 612
clean true:295
clean false:317
clean_rate:0.4820261437908497
noisy true:569
noisy false:451
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1020
epoch [179/200] batch [5/19] time 0.356 (0.349) data 0.278 (0.271) loss_x loss_x 0.3545 (0.3421) acc_x 90.6250 (91.2500) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/19] time 0.354 (0.347) data 0.276 (0.269) loss_x loss_x 0.3669 (0.3031) acc_x 87.5000 (92.1875) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/19] time 0.350 (0.345) data 0.272 (0.268) loss_x loss_x 0.0850 (0.3260) acc_x 100.0000 (91.2500) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [5/31] time 0.351 (0.343) data 0.272 (0.265) loss_u loss_u 0.9204 (0.9351) acc_u 9.3750 (6.8750) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [10/31] time 0.356 (0.344) data 0.278 (0.266) loss_u loss_u 0.9497 (0.9391) acc_u 3.1250 (6.5625) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [15/31] time 0.331 (0.342) data 0.253 (0.264) loss_u loss_u 0.9312 (0.9300) acc_u 6.2500 (7.7083) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [20/31] time 0.340 (0.342) data 0.262 (0.264) loss_u loss_u 0.9478 (0.9336) acc_u 6.2500 (7.1875) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [25/31] time 0.352 (0.341) data 0.273 (0.263) loss_u loss_u 0.9971 (0.9369) acc_u 0.0000 (6.8750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [30/31] time 0.299 (0.339) data 0.221 (0.261) loss_u loss_u 0.9893 (0.9396) acc_u 3.1250 (6.7708) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 762
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 606
clean true:289
clean false:317
clean_rate:0.4768976897689769
noisy true:581
noisy false:445
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1026
epoch [180/200] batch [5/18] time 0.360 (0.353) data 0.282 (0.276) loss_x loss_x 0.1440 (0.3235) acc_x 100.0000 (91.2500) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/18] time 0.349 (0.351) data 0.271 (0.273) loss_x loss_x 0.1613 (0.2783) acc_x 96.8750 (93.4375) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/18] time 0.345 (0.352) data 0.268 (0.274) loss_x loss_x 0.1597 (0.3058) acc_x 100.0000 (93.1250) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [5/32] time 0.343 (0.343) data 0.265 (0.265) loss_u loss_u 0.9072 (0.9338) acc_u 9.3750 (6.8750) lr 5.9119e-05 eta 0:00:09
epoch [180/200] batch [10/32] time 0.341 (0.342) data 0.262 (0.265) loss_u loss_u 0.9653 (0.9345) acc_u 3.1250 (7.1875) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [15/32] time 0.342 (0.342) data 0.264 (0.265) loss_u loss_u 0.9028 (0.9315) acc_u 12.5000 (7.9167) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [20/32] time 0.339 (0.341) data 0.262 (0.264) loss_u loss_u 0.7959 (0.9231) acc_u 21.8750 (8.7500) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [25/32] time 0.405 (0.343) data 0.325 (0.266) loss_u loss_u 0.9907 (0.9296) acc_u 0.0000 (8.0000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [30/32] time 0.339 (0.351) data 0.260 (0.273) loss_u loss_u 0.9678 (0.9310) acc_u 3.1250 (7.8125) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 772
confident_label rate tensor(0.3768, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 615
clean true:281
clean false:334
clean_rate:0.45691056910569106
noisy true:579
noisy false:438
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1017
epoch [181/200] batch [5/19] time 0.352 (0.357) data 0.274 (0.279) loss_x loss_x 0.2181 (0.2682) acc_x 96.8750 (91.8750) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [10/19] time 0.366 (0.358) data 0.289 (0.279) loss_x loss_x 0.2186 (0.2930) acc_x 93.7500 (91.8750) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/19] time 0.315 (0.351) data 0.236 (0.273) loss_x loss_x 0.3403 (0.2994) acc_x 90.6250 (91.4583) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [5/31] time 0.339 (0.346) data 0.261 (0.268) loss_u loss_u 0.9521 (0.9460) acc_u 6.2500 (5.6250) lr 5.3915e-05 eta 0:00:09
epoch [181/200] batch [10/31] time 0.335 (0.346) data 0.257 (0.268) loss_u loss_u 0.9463 (0.9518) acc_u 6.2500 (5.0000) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [15/31] time 0.332 (0.341) data 0.253 (0.263) loss_u loss_u 0.9482 (0.9452) acc_u 3.1250 (5.6250) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [20/31] time 0.363 (0.341) data 0.285 (0.263) loss_u loss_u 0.8765 (0.9415) acc_u 15.6250 (6.5625) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [25/31] time 0.484 (0.350) data 0.405 (0.272) loss_u loss_u 0.9976 (0.9448) acc_u 0.0000 (6.2500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [30/31] time 0.344 (0.353) data 0.265 (0.274) loss_u loss_u 0.9702 (0.9459) acc_u 6.2500 (6.2500) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 761
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 611
clean true:290
clean false:321
clean_rate:0.4746317512274959
noisy true:581
noisy false:440
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1021
epoch [182/200] batch [5/19] time 0.350 (0.329) data 0.272 (0.250) loss_x loss_x 0.2322 (0.2406) acc_x 93.7500 (96.2500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/19] time 0.349 (0.345) data 0.272 (0.267) loss_x loss_x 0.4346 (0.2648) acc_x 90.6250 (95.0000) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/19] time 0.301 (0.342) data 0.224 (0.264) loss_x loss_x 0.2568 (0.2556) acc_x 93.7500 (94.3750) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [5/31] time 0.343 (0.338) data 0.265 (0.260) loss_u loss_u 0.9707 (0.9696) acc_u 3.1250 (3.7500) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [10/31] time 0.361 (0.340) data 0.283 (0.263) loss_u loss_u 0.9253 (0.9537) acc_u 6.2500 (5.3125) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [15/31] time 0.325 (0.339) data 0.247 (0.261) loss_u loss_u 0.9248 (0.9466) acc_u 9.3750 (6.0417) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [20/31] time 0.299 (0.336) data 0.221 (0.258) loss_u loss_u 0.9683 (0.9509) acc_u 3.1250 (5.6250) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [25/31] time 0.340 (0.338) data 0.262 (0.260) loss_u loss_u 0.9058 (0.9489) acc_u 9.3750 (6.0000) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [30/31] time 0.336 (0.338) data 0.259 (0.260) loss_u loss_u 0.9424 (0.9456) acc_u 6.2500 (6.2500) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 763
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:295
clean false:324
clean_rate:0.4765751211631664
noisy true:574
noisy false:439
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [183/200] batch [5/19] time 0.356 (0.352) data 0.279 (0.274) loss_x loss_x 0.1743 (0.2631) acc_x 96.8750 (93.7500) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/19] time 0.337 (0.348) data 0.259 (0.270) loss_x loss_x 0.3843 (0.3162) acc_x 93.7500 (91.8750) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/19] time 0.333 (0.346) data 0.255 (0.269) loss_x loss_x 0.2542 (0.3033) acc_x 93.7500 (93.1250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [5/31] time 0.329 (0.345) data 0.252 (0.268) loss_u loss_u 0.9648 (0.9657) acc_u 6.2500 (3.7500) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [10/31] time 0.350 (0.345) data 0.272 (0.268) loss_u loss_u 0.9951 (0.9431) acc_u 0.0000 (6.2500) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [15/31] time 0.352 (0.342) data 0.274 (0.265) loss_u loss_u 0.9985 (0.9420) acc_u 0.0000 (6.4583) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [20/31] time 0.347 (0.342) data 0.268 (0.264) loss_u loss_u 0.9414 (0.9431) acc_u 6.2500 (6.4062) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [25/31] time 0.376 (0.345) data 0.297 (0.267) loss_u loss_u 0.9512 (0.9450) acc_u 6.2500 (6.1250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [30/31] time 0.352 (0.346) data 0.274 (0.268) loss_u loss_u 0.9438 (0.9455) acc_u 6.2500 (6.2500) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 770
confident_label rate tensor(0.3652, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 596
clean true:281
clean false:315
clean_rate:0.4714765100671141
noisy true:581
noisy false:455
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1036
epoch [184/200] batch [5/18] time 0.347 (0.351) data 0.269 (0.273) loss_x loss_x 0.5503 (0.3615) acc_x 87.5000 (91.8750) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/18] time 0.348 (0.347) data 0.271 (0.270) loss_x loss_x 0.3904 (0.3720) acc_x 90.6250 (92.1875) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/18] time 0.356 (0.347) data 0.278 (0.270) loss_x loss_x 0.3721 (0.3481) acc_x 93.7500 (92.7083) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [5/32] time 0.333 (0.344) data 0.255 (0.267) loss_u loss_u 0.8877 (0.9286) acc_u 12.5000 (9.3750) lr 3.9706e-05 eta 0:00:09
epoch [184/200] batch [10/32] time 0.348 (0.345) data 0.270 (0.268) loss_u loss_u 0.8887 (0.9215) acc_u 12.5000 (9.6875) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [15/32] time 0.337 (0.345) data 0.259 (0.267) loss_u loss_u 0.9692 (0.9235) acc_u 3.1250 (9.3750) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [20/32] time 0.352 (0.345) data 0.274 (0.267) loss_u loss_u 0.8745 (0.9251) acc_u 15.6250 (8.9062) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [25/32] time 0.342 (0.345) data 0.265 (0.267) loss_u loss_u 0.9678 (0.9255) acc_u 3.1250 (8.8750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [30/32] time 0.352 (0.345) data 0.273 (0.267) loss_u loss_u 0.9390 (0.9287) acc_u 3.1250 (8.3333) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 758
confident_label rate tensor(0.3732, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 609
clean true:286
clean false:323
clean_rate:0.4696223316912972
noisy true:588
noisy false:435
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1023
epoch [185/200] batch [5/19] time 0.351 (0.365) data 0.273 (0.287) loss_x loss_x 0.2375 (0.2347) acc_x 93.7500 (95.6250) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [10/19] time 0.339 (0.356) data 0.261 (0.279) loss_x loss_x 0.3320 (0.2858) acc_x 96.8750 (94.3750) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/19] time 0.355 (0.355) data 0.278 (0.278) loss_x loss_x 0.3169 (0.3112) acc_x 96.8750 (93.9583) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [5/31] time 0.386 (0.352) data 0.308 (0.274) loss_u loss_u 0.9673 (0.9236) acc_u 3.1250 (8.1250) lr 3.5443e-05 eta 0:00:09
epoch [185/200] batch [10/31] time 0.372 (0.351) data 0.293 (0.273) loss_u loss_u 0.9624 (0.9251) acc_u 3.1250 (8.1250) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [15/31] time 0.345 (0.349) data 0.266 (0.271) loss_u loss_u 0.9316 (0.9331) acc_u 9.3750 (7.5000) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [20/31] time 0.329 (0.348) data 0.251 (0.270) loss_u loss_u 0.9800 (0.9352) acc_u 3.1250 (7.5000) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [25/31] time 0.360 (0.347) data 0.282 (0.269) loss_u loss_u 0.9492 (0.9380) acc_u 6.2500 (7.1250) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [30/31] time 0.296 (0.344) data 0.217 (0.266) loss_u loss_u 0.9722 (0.9391) acc_u 6.2500 (7.0833) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 777
confident_label rate tensor(0.3676, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 600
clean true:280
clean false:320
clean_rate:0.4666666666666667
noisy true:575
noisy false:457
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1032
epoch [186/200] batch [5/18] time 0.327 (0.346) data 0.250 (0.269) loss_x loss_x 0.2251 (0.3075) acc_x 90.6250 (93.1250) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/18] time 0.357 (0.345) data 0.279 (0.268) loss_x loss_x 0.2620 (0.2818) acc_x 93.7500 (93.7500) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/18] time 0.340 (0.347) data 0.262 (0.269) loss_x loss_x 0.2101 (0.2970) acc_x 96.8750 (93.3333) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [5/32] time 0.341 (0.344) data 0.263 (0.267) loss_u loss_u 0.9434 (0.9110) acc_u 6.2500 (9.3750) lr 3.1417e-05 eta 0:00:09
epoch [186/200] batch [10/32] time 0.339 (0.345) data 0.261 (0.267) loss_u loss_u 0.8403 (0.9210) acc_u 18.7500 (8.4375) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [15/32] time 0.360 (0.346) data 0.282 (0.269) loss_u loss_u 0.9780 (0.9263) acc_u 3.1250 (7.9167) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [20/32] time 0.339 (0.346) data 0.261 (0.268) loss_u loss_u 0.9346 (0.9285) acc_u 9.3750 (7.9688) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [25/32] time 0.338 (0.345) data 0.260 (0.267) loss_u loss_u 0.9023 (0.9297) acc_u 9.3750 (7.8750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [30/32] time 0.307 (0.343) data 0.228 (0.265) loss_u loss_u 0.9995 (0.9318) acc_u 0.0000 (7.7083) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 766
confident_label rate tensor(0.3658, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 597
clean true:281
clean false:316
clean_rate:0.47068676716917923
noisy true:585
noisy false:450
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1035
epoch [187/200] batch [5/18] time 0.335 (0.343) data 0.257 (0.265) loss_x loss_x 0.1482 (0.2976) acc_x 100.0000 (92.5000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/18] time 0.350 (0.344) data 0.272 (0.267) loss_x loss_x 0.2839 (0.2783) acc_x 90.6250 (93.1250) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/18] time 0.354 (0.342) data 0.276 (0.265) loss_x loss_x 0.5049 (0.3144) acc_x 84.3750 (91.2500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [5/32] time 0.356 (0.341) data 0.277 (0.263) loss_u loss_u 0.9678 (0.9611) acc_u 3.1250 (5.0000) lr 2.7630e-05 eta 0:00:09
epoch [187/200] batch [10/32] time 0.350 (0.337) data 0.272 (0.260) loss_u loss_u 0.9795 (0.9465) acc_u 3.1250 (6.2500) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [15/32] time 0.364 (0.341) data 0.285 (0.263) loss_u loss_u 0.8975 (0.9436) acc_u 12.5000 (6.4583) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [20/32] time 0.340 (0.344) data 0.260 (0.266) loss_u loss_u 0.8862 (0.9417) acc_u 12.5000 (6.4062) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [25/32] time 0.350 (0.344) data 0.271 (0.266) loss_u loss_u 0.9365 (0.9390) acc_u 6.2500 (6.5000) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [30/32] time 0.332 (0.342) data 0.252 (0.264) loss_u loss_u 0.8955 (0.9338) acc_u 12.5000 (7.1875) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 760
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 619
clean true:290
clean false:329
clean_rate:0.46849757673667203
noisy true:582
noisy false:431
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 1013
epoch [188/200] batch [5/19] time 0.339 (0.345) data 0.261 (0.267) loss_x loss_x 0.3970 (0.3115) acc_x 90.6250 (90.6250) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/19] time 0.348 (0.344) data 0.269 (0.266) loss_x loss_x 0.1327 (0.2768) acc_x 96.8750 (92.5000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/19] time 0.345 (0.348) data 0.267 (0.270) loss_x loss_x 0.2015 (0.3380) acc_x 93.7500 (91.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [5/31] time 0.351 (0.348) data 0.273 (0.270) loss_u loss_u 0.9067 (0.9554) acc_u 9.3750 (5.0000) lr 2.4083e-05 eta 0:00:09
epoch [188/200] batch [10/31] time 0.343 (0.347) data 0.265 (0.269) loss_u loss_u 0.9971 (0.9468) acc_u 0.0000 (5.9375) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [15/31] time 0.338 (0.346) data 0.259 (0.267) loss_u loss_u 0.9912 (0.9465) acc_u 0.0000 (6.0417) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [20/31] time 0.336 (0.343) data 0.258 (0.265) loss_u loss_u 0.9385 (0.9471) acc_u 6.2500 (6.0938) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [25/31] time 0.306 (0.344) data 0.226 (0.266) loss_u loss_u 0.8765 (0.9461) acc_u 12.5000 (6.2500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [30/31] time 0.333 (0.340) data 0.256 (0.262) loss_u loss_u 0.9683 (0.9472) acc_u 3.1250 (6.1458) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 777
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 612
clean true:286
clean false:326
clean_rate:0.4673202614379085
noisy true:569
noisy false:451
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1020
epoch [189/200] batch [5/19] time 0.350 (0.353) data 0.272 (0.275) loss_x loss_x 0.2583 (0.2731) acc_x 87.5000 (94.3750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/19] time 0.350 (0.353) data 0.273 (0.275) loss_x loss_x 0.3315 (0.2882) acc_x 90.6250 (92.8125) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/19] time 0.333 (0.348) data 0.254 (0.270) loss_x loss_x 0.2141 (0.2870) acc_x 93.7500 (93.1250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [5/31] time 0.353 (0.347) data 0.276 (0.270) loss_u loss_u 0.9946 (0.9754) acc_u 0.0000 (3.1250) lr 2.0777e-05 eta 0:00:09
epoch [189/200] batch [10/31] time 0.337 (0.345) data 0.260 (0.268) loss_u loss_u 0.8804 (0.9513) acc_u 15.6250 (5.9375) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [15/31] time 0.334 (0.344) data 0.257 (0.266) loss_u loss_u 0.9683 (0.9559) acc_u 3.1250 (5.2083) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [20/31] time 0.358 (0.343) data 0.280 (0.266) loss_u loss_u 0.8413 (0.9443) acc_u 18.7500 (6.5625) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [25/31] time 0.333 (0.341) data 0.255 (0.263) loss_u loss_u 0.9458 (0.9417) acc_u 9.3750 (6.8750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [30/31] time 0.351 (0.341) data 0.273 (0.263) loss_u loss_u 0.8931 (0.9410) acc_u 12.5000 (6.8750) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 768
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 599
clean true:276
clean false:323
clean_rate:0.4607679465776294
noisy true:588
noisy false:445
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1033
epoch [190/200] batch [5/18] time 0.350 (0.352) data 0.272 (0.274) loss_x loss_x 0.2529 (0.2503) acc_x 87.5000 (91.8750) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/18] time 0.333 (0.343) data 0.255 (0.266) loss_x loss_x 0.2046 (0.2695) acc_x 93.7500 (93.7500) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/18] time 0.336 (0.339) data 0.259 (0.261) loss_x loss_x 0.4661 (0.3060) acc_x 90.6250 (93.1250) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [5/32] time 0.348 (0.337) data 0.270 (0.260) loss_u loss_u 0.8857 (0.9188) acc_u 12.5000 (8.7500) lr 1.7713e-05 eta 0:00:09
epoch [190/200] batch [10/32] time 0.300 (0.336) data 0.223 (0.259) loss_u loss_u 0.9253 (0.9219) acc_u 9.3750 (8.4375) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [15/32] time 0.305 (0.331) data 0.227 (0.254) loss_u loss_u 0.9497 (0.9167) acc_u 6.2500 (9.1667) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [20/32] time 0.339 (0.331) data 0.261 (0.254) loss_u loss_u 0.9780 (0.9249) acc_u 3.1250 (8.4375) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [25/32] time 0.308 (0.329) data 0.229 (0.251) loss_u loss_u 0.9956 (0.9301) acc_u 0.0000 (8.0000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [30/32] time 0.326 (0.330) data 0.247 (0.252) loss_u loss_u 0.9893 (0.9288) acc_u 0.0000 (8.1250) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 756
confident_label rate tensor(0.3732, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 609
clean true:291
clean false:318
clean_rate:0.47783251231527096
noisy true:585
noisy false:438
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1023
epoch [191/200] batch [5/19] time 0.353 (0.348) data 0.276 (0.271) loss_x loss_x 0.1094 (0.2904) acc_x 100.0000 (91.8750) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/19] time 0.360 (0.352) data 0.282 (0.275) loss_x loss_x 0.2930 (0.2625) acc_x 93.7500 (93.4375) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/19] time 0.339 (0.347) data 0.262 (0.269) loss_x loss_x 0.2771 (0.2623) acc_x 96.8750 (93.9583) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [5/31] time 0.350 (0.343) data 0.271 (0.265) loss_u loss_u 0.9458 (0.9195) acc_u 6.2500 (8.7500) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [10/31] time 0.346 (0.342) data 0.268 (0.264) loss_u loss_u 0.8506 (0.9236) acc_u 15.6250 (8.4375) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [15/31] time 0.330 (0.342) data 0.252 (0.265) loss_u loss_u 0.9019 (0.9339) acc_u 9.3750 (7.0833) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [20/31] time 0.328 (0.343) data 0.249 (0.265) loss_u loss_u 0.9102 (0.9369) acc_u 9.3750 (6.8750) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [25/31] time 0.313 (0.340) data 0.234 (0.262) loss_u loss_u 0.9380 (0.9360) acc_u 6.2500 (7.0000) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [30/31] time 0.348 (0.339) data 0.271 (0.261) loss_u loss_u 0.9404 (0.9369) acc_u 6.2500 (6.9792) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 794
confident_label rate tensor(0.3707, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 605
clean true:273
clean false:332
clean_rate:0.4512396694214876
noisy true:565
noisy false:462
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1027
epoch [192/200] batch [5/18] time 0.350 (0.355) data 0.273 (0.277) loss_x loss_x 0.1267 (0.2782) acc_x 100.0000 (94.3750) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/18] time 0.349 (0.347) data 0.271 (0.270) loss_x loss_x 0.4329 (0.2988) acc_x 87.5000 (93.4375) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/18] time 0.336 (0.344) data 0.259 (0.267) loss_x loss_x 0.2532 (0.2782) acc_x 93.7500 (94.1667) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [5/32] time 0.345 (0.341) data 0.267 (0.263) loss_u loss_u 0.9351 (0.9500) acc_u 9.3750 (5.6250) lr 1.2312e-05 eta 0:00:09
epoch [192/200] batch [10/32] time 0.353 (0.341) data 0.275 (0.264) loss_u loss_u 0.9082 (0.9490) acc_u 9.3750 (5.6250) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [15/32] time 0.321 (0.339) data 0.244 (0.262) loss_u loss_u 0.9365 (0.9548) acc_u 6.2500 (4.7917) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [20/32] time 0.286 (0.337) data 0.207 (0.260) loss_u loss_u 0.9824 (0.9531) acc_u 3.1250 (5.3125) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [25/32] time 0.307 (0.333) data 0.228 (0.255) loss_u loss_u 0.9702 (0.9505) acc_u 3.1250 (5.6250) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [30/32] time 0.332 (0.333) data 0.255 (0.255) loss_u loss_u 0.9106 (0.9370) acc_u 15.6250 (7.5000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 756
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 607
clean true:289
clean false:318
clean_rate:0.47611202635914335
noisy true:587
noisy false:438
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1025
epoch [193/200] batch [5/18] time 0.354 (0.350) data 0.276 (0.273) loss_x loss_x 0.3923 (0.3525) acc_x 90.6250 (93.1250) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/18] time 0.336 (0.346) data 0.259 (0.268) loss_x loss_x 0.1388 (0.3208) acc_x 100.0000 (93.7500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/18] time 0.337 (0.344) data 0.259 (0.266) loss_x loss_x 0.1697 (0.2981) acc_x 100.0000 (93.7500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [5/32] time 0.329 (0.345) data 0.252 (0.268) loss_u loss_u 0.9858 (0.9552) acc_u 3.1250 (6.2500) lr 9.9763e-06 eta 0:00:09
epoch [193/200] batch [10/32] time 0.338 (0.345) data 0.260 (0.268) loss_u loss_u 0.9961 (0.9571) acc_u 0.0000 (5.3125) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [15/32] time 0.334 (0.344) data 0.256 (0.266) loss_u loss_u 0.8965 (0.9465) acc_u 12.5000 (6.4583) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [20/32] time 0.338 (0.342) data 0.260 (0.264) loss_u loss_u 0.9336 (0.9437) acc_u 9.3750 (6.8750) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [25/32] time 0.343 (0.342) data 0.265 (0.264) loss_u loss_u 0.8965 (0.9395) acc_u 12.5000 (7.2500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [30/32] time 0.298 (0.337) data 0.219 (0.259) loss_u loss_u 0.9219 (0.9375) acc_u 9.3750 (7.3958) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 766
confident_label rate tensor(0.3689, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 602
clean true:288
clean false:314
clean_rate:0.47840531561461797
noisy true:578
noisy false:452
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1030
epoch [194/200] batch [5/18] time 0.343 (0.349) data 0.265 (0.271) loss_x loss_x 0.5371 (0.3024) acc_x 81.2500 (90.6250) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/18] time 0.368 (0.350) data 0.291 (0.272) loss_x loss_x 0.4778 (0.2928) acc_x 87.5000 (92.8125) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/18] time 0.351 (0.348) data 0.273 (0.270) loss_x loss_x 0.1237 (0.2815) acc_x 96.8750 (93.3333) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [5/32] time 0.322 (0.350) data 0.243 (0.272) loss_u loss_u 0.9521 (0.8945) acc_u 6.2500 (11.8750) lr 7.8853e-06 eta 0:00:09
epoch [194/200] batch [10/32] time 0.326 (0.351) data 0.248 (0.273) loss_u loss_u 0.9316 (0.9066) acc_u 12.5000 (10.6250) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [15/32] time 0.344 (0.350) data 0.266 (0.272) loss_u loss_u 0.9746 (0.9194) acc_u 3.1250 (9.3750) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [20/32] time 0.341 (0.349) data 0.263 (0.271) loss_u loss_u 0.9541 (0.9320) acc_u 6.2500 (7.8125) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [25/32] time 0.299 (0.346) data 0.220 (0.268) loss_u loss_u 0.9043 (0.9284) acc_u 12.5000 (8.3750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [30/32] time 0.326 (0.342) data 0.247 (0.264) loss_u loss_u 0.9980 (0.9300) acc_u 0.0000 (8.2292) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 775
confident_label rate tensor(0.3689, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 602
clean true:281
clean false:321
clean_rate:0.46677740863787376
noisy true:576
noisy false:454
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1030
epoch [195/200] batch [5/18] time 0.331 (0.343) data 0.253 (0.265) loss_x loss_x 0.1869 (0.2517) acc_x 93.7500 (94.3750) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/18] time 0.338 (0.342) data 0.260 (0.265) loss_x loss_x 0.1249 (0.2369) acc_x 100.0000 (95.3125) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/18] time 0.350 (0.340) data 0.268 (0.262) loss_x loss_x 0.4014 (0.2540) acc_x 93.7500 (95.2083) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [5/32] time 0.352 (0.342) data 0.273 (0.264) loss_u loss_u 0.8970 (0.9403) acc_u 12.5000 (6.8750) lr 6.0390e-06 eta 0:00:09
epoch [195/200] batch [10/32] time 0.353 (0.343) data 0.275 (0.265) loss_u loss_u 0.8794 (0.9436) acc_u 15.6250 (6.5625) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [15/32] time 0.349 (0.345) data 0.271 (0.267) loss_u loss_u 0.9385 (0.9462) acc_u 6.2500 (6.0417) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [20/32] time 0.303 (0.343) data 0.224 (0.265) loss_u loss_u 0.9727 (0.9474) acc_u 3.1250 (5.7812) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [25/32] time 0.299 (0.338) data 0.220 (0.260) loss_u loss_u 0.9248 (0.9449) acc_u 9.3750 (6.1250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [30/32] time 0.343 (0.339) data 0.265 (0.261) loss_u loss_u 0.8823 (0.9402) acc_u 12.5000 (6.6667) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 764
confident_label rate tensor(0.3824, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 624
clean true:286
clean false:338
clean_rate:0.4583333333333333
noisy true:582
noisy false:426
after delete: len(clean_dataset) 624
after delete: len(noisy_dataset) 1008
epoch [196/200] batch [5/19] time 0.345 (0.352) data 0.267 (0.274) loss_x loss_x 0.2402 (0.3181) acc_x 93.7500 (91.8750) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/19] time 0.327 (0.350) data 0.250 (0.272) loss_x loss_x 0.3352 (0.2957) acc_x 90.6250 (92.5000) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/19] time 0.338 (0.348) data 0.260 (0.270) loss_x loss_x 0.3267 (0.2990) acc_x 90.6250 (92.7083) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [5/31] time 0.351 (0.347) data 0.273 (0.270) loss_u loss_u 0.9111 (0.9473) acc_u 9.3750 (5.0000) lr 4.4380e-06 eta 0:00:09
epoch [196/200] batch [10/31] time 0.337 (0.346) data 0.259 (0.268) loss_u loss_u 0.9102 (0.9455) acc_u 9.3750 (5.6250) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [15/31] time 0.339 (0.345) data 0.260 (0.267) loss_u loss_u 0.9062 (0.9347) acc_u 12.5000 (7.2917) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [20/31] time 0.311 (0.342) data 0.233 (0.265) loss_u loss_u 0.9404 (0.9382) acc_u 6.2500 (6.8750) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [25/31] time 0.331 (0.339) data 0.254 (0.261) loss_u loss_u 0.9663 (0.9410) acc_u 6.2500 (6.7500) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [30/31] time 0.323 (0.339) data 0.245 (0.261) loss_u loss_u 0.9053 (0.9440) acc_u 12.5000 (6.3542) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 764
confident_label rate tensor(0.3768, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 615
clean true:292
clean false:323
clean_rate:0.47479674796747967
noisy true:576
noisy false:441
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1017
epoch [197/200] batch [5/19] time 0.344 (0.356) data 0.266 (0.279) loss_x loss_x 0.2273 (0.2473) acc_x 93.7500 (95.6250) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/19] time 0.327 (0.350) data 0.249 (0.272) loss_x loss_x 0.2469 (0.2522) acc_x 100.0000 (94.3750) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/19] time 0.345 (0.347) data 0.267 (0.269) loss_x loss_x 0.1508 (0.2348) acc_x 96.8750 (95.0000) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [5/31] time 0.342 (0.344) data 0.264 (0.266) loss_u loss_u 0.9409 (0.9544) acc_u 9.3750 (5.6250) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [10/31] time 0.336 (0.344) data 0.259 (0.266) loss_u loss_u 0.9551 (0.9420) acc_u 6.2500 (6.8750) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [15/31] time 0.327 (0.342) data 0.248 (0.265) loss_u loss_u 0.9702 (0.9483) acc_u 3.1250 (6.0417) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [20/31] time 0.304 (0.342) data 0.225 (0.264) loss_u loss_u 0.9453 (0.9503) acc_u 6.2500 (5.7812) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [25/31] time 0.304 (0.337) data 0.226 (0.259) loss_u loss_u 0.9282 (0.9481) acc_u 9.3750 (6.0000) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [30/31] time 0.329 (0.338) data 0.251 (0.260) loss_u loss_u 0.9541 (0.9446) acc_u 3.1250 (6.2500) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 765
confident_label rate tensor(0.3664, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 598
clean true:285
clean false:313
clean_rate:0.4765886287625418
noisy true:582
noisy false:452
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1034
epoch [198/200] batch [5/18] time 0.348 (0.348) data 0.271 (0.271) loss_x loss_x 0.3660 (0.2768) acc_x 87.5000 (93.1250) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/18] time 0.341 (0.343) data 0.264 (0.266) loss_x loss_x 0.5298 (0.3425) acc_x 87.5000 (92.8125) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/18] time 0.345 (0.340) data 0.268 (0.263) loss_x loss_x 0.3445 (0.3229) acc_x 84.3750 (93.1250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [5/32] time 0.356 (0.344) data 0.277 (0.266) loss_u loss_u 0.9907 (0.9503) acc_u 0.0000 (5.6250) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [10/32] time 0.344 (0.344) data 0.266 (0.267) loss_u loss_u 0.9146 (0.9328) acc_u 9.3750 (7.5000) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [15/32] time 0.341 (0.343) data 0.262 (0.266) loss_u loss_u 0.8823 (0.9186) acc_u 15.6250 (9.3750) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [20/32] time 0.352 (0.343) data 0.273 (0.265) loss_u loss_u 0.9463 (0.9237) acc_u 6.2500 (8.7500) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [25/32] time 0.307 (0.342) data 0.229 (0.264) loss_u loss_u 0.9404 (0.9303) acc_u 6.2500 (8.0000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [30/32] time 0.349 (0.340) data 0.271 (0.262) loss_u loss_u 0.9775 (0.9314) acc_u 3.1250 (7.8125) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 770
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 614
clean true:284
clean false:330
clean_rate:0.46254071661237783
noisy true:578
noisy false:440
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1018
epoch [199/200] batch [5/19] time 0.347 (0.352) data 0.269 (0.274) loss_x loss_x 0.4099 (0.2803) acc_x 90.6250 (93.1250) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/19] time 0.370 (0.340) data 0.292 (0.263) loss_x loss_x 0.1416 (0.2628) acc_x 96.8750 (93.4375) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/19] time 0.350 (0.340) data 0.273 (0.262) loss_x loss_x 0.2343 (0.2728) acc_x 96.8750 (93.5417) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [5/31] time 0.344 (0.339) data 0.265 (0.261) loss_u loss_u 0.9707 (0.9417) acc_u 3.1250 (6.8750) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [10/31] time 0.333 (0.338) data 0.255 (0.261) loss_u loss_u 0.9092 (0.9379) acc_u 9.3750 (7.1875) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [15/31] time 0.351 (0.339) data 0.274 (0.261) loss_u loss_u 0.9053 (0.9410) acc_u 12.5000 (7.0833) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [20/31] time 0.358 (0.340) data 0.279 (0.263) loss_u loss_u 0.9717 (0.9467) acc_u 3.1250 (6.5625) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [25/31] time 0.307 (0.338) data 0.227 (0.260) loss_u loss_u 0.9800 (0.9454) acc_u 3.1250 (6.7500) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [30/31] time 0.337 (0.338) data 0.259 (0.260) loss_u loss_u 0.9756 (0.9412) acc_u 3.1250 (7.1875) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 781
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 617
clean true:287
clean false:330
clean_rate:0.4651539708265802
noisy true:564
noisy false:451
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 1015
epoch [200/200] batch [5/19] time 0.357 (0.338) data 0.280 (0.259) loss_x loss_x 0.1844 (0.2904) acc_x 93.7500 (92.5000) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/19] time 0.337 (0.338) data 0.259 (0.260) loss_x loss_x 0.3657 (0.3066) acc_x 93.7500 (93.1250) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/19] time 0.336 (0.338) data 0.259 (0.260) loss_x loss_x 0.2164 (0.3081) acc_x 93.7500 (92.7083) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [5/31] time 0.346 (0.342) data 0.269 (0.265) loss_u loss_u 0.8916 (0.9167) acc_u 15.6250 (10.0000) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [10/31] time 0.335 (0.341) data 0.258 (0.264) loss_u loss_u 0.9985 (0.9243) acc_u 0.0000 (9.0625) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [15/31] time 0.336 (0.342) data 0.257 (0.264) loss_u loss_u 0.9570 (0.9322) acc_u 3.1250 (8.1250) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [20/31] time 0.320 (0.340) data 0.242 (0.262) loss_u loss_u 0.9653 (0.9402) acc_u 3.1250 (7.0312) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [25/31] time 0.308 (0.339) data 0.230 (0.261) loss_u loss_u 0.9512 (0.9358) acc_u 3.1250 (7.3750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [30/31] time 0.349 (0.337) data 0.271 (0.259) loss_u loss_u 0.9976 (0.9432) acc_u 0.0000 (6.4583) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/oxford_flowers/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 1,291
* accuracy: 52.4%
* error: 47.6%
* macro_f1: 53.9%
Elapsed: 2:02:01
