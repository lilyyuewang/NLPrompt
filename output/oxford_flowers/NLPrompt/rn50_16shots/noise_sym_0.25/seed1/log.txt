***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.25', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '102']
output_dir: output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.25/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.25
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.25/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.25/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 282
clean true:280
clean false:2
clean_rate:0.9929078014184397
noisy true:95
noisy false:1255
after delete: len(clean_dataset) 282
after delete: len(noisy_dataset) 1350
epoch [1/200] batch [5/8] time 0.341 (0.391) data 0.214 (0.259) loss_x loss_x 2.6055 (2.7348) acc_x 40.6250 (38.7500) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [5/42] time 0.513 (0.392) data 0.383 (0.262) loss_u loss_u 0.9756 (0.9744) acc_u 3.1250 (5.6250) lr 1.0000e-05 eta 0:00:14
epoch [1/200] batch [10/42] time 0.427 (0.407) data 0.299 (0.277) loss_u loss_u 0.9692 (0.9730) acc_u 6.2500 (5.9375) lr 1.0000e-05 eta 0:00:13
epoch [1/200] batch [15/42] time 0.406 (0.409) data 0.281 (0.280) loss_u loss_u 0.9741 (0.9700) acc_u 6.2500 (7.0833) lr 1.0000e-05 eta 0:00:11
epoch [1/200] batch [20/42] time 0.337 (0.402) data 0.211 (0.274) loss_u loss_u 0.9556 (0.9674) acc_u 6.2500 (7.8125) lr 1.0000e-05 eta 0:00:08
epoch [1/200] batch [25/42] time 0.352 (0.395) data 0.225 (0.267) loss_u loss_u 0.9072 (0.9600) acc_u 12.5000 (8.5000) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [30/42] time 0.440 (0.396) data 0.313 (0.270) loss_u loss_u 0.9756 (0.9589) acc_u 3.1250 (8.7500) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [35/42] time 0.388 (0.398) data 0.261 (0.271) loss_u loss_u 0.9365 (0.9572) acc_u 12.5000 (9.2857) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [40/42] time 0.504 (0.399) data 0.373 (0.272) loss_u loss_u 0.9087 (0.9559) acc_u 31.2500 (9.7656) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1014
confident_label rate tensor(0.2782, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 454
clean true:450
clean false:4
clean_rate:0.9911894273127754
noisy true:168
noisy false:1010
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1178
epoch [2/200] batch [5/14] time 0.398 (0.404) data 0.272 (0.280) loss_x loss_x 0.8174 (1.1955) acc_x 81.2500 (68.7500) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [10/14] time 0.357 (0.392) data 0.235 (0.268) loss_x loss_x 0.9482 (0.9668) acc_x 78.1250 (75.3125) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [5/36] time 0.364 (0.377) data 0.236 (0.252) loss_u loss_u 0.8364 (0.8498) acc_u 25.0000 (20.0000) lr 2.0000e-03 eta 0:00:11
epoch [2/200] batch [10/36] time 0.514 (0.385) data 0.389 (0.261) loss_u loss_u 0.8125 (0.8393) acc_u 21.8750 (21.2500) lr 2.0000e-03 eta 0:00:10
epoch [2/200] batch [15/36] time 0.382 (0.387) data 0.256 (0.263) loss_u loss_u 0.8501 (0.8270) acc_u 18.7500 (22.2917) lr 2.0000e-03 eta 0:00:08
epoch [2/200] batch [20/36] time 0.436 (0.390) data 0.312 (0.266) loss_u loss_u 0.7803 (0.8155) acc_u 25.0000 (24.2188) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [25/36] time 0.426 (0.397) data 0.300 (0.272) loss_u loss_u 0.7739 (0.8081) acc_u 21.8750 (24.5000) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [30/36] time 0.415 (0.398) data 0.288 (0.273) loss_u loss_u 0.8530 (0.8030) acc_u 21.8750 (25.5208) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [35/36] time 0.359 (0.400) data 0.233 (0.274) loss_u loss_u 0.7974 (0.8037) acc_u 28.1250 (25.8036) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 722
confident_label rate tensor(0.4222, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 689
clean true:687
clean false:2
clean_rate:0.9970972423802612
noisy true:223
noisy false:720
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 943
epoch [3/200] batch [5/21] time 0.416 (0.415) data 0.290 (0.290) loss_x loss_x 0.5308 (0.7031) acc_x 93.7500 (85.0000) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [10/21] time 0.399 (0.403) data 0.272 (0.275) loss_x loss_x 0.4915 (0.6615) acc_x 90.6250 (84.0625) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [15/21] time 0.348 (0.390) data 0.219 (0.263) loss_x loss_x 0.6284 (0.6921) acc_x 81.2500 (82.7083) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/21] time 0.405 (0.395) data 0.280 (0.268) loss_x loss_x 0.5562 (0.6830) acc_x 84.3750 (82.6562) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/29] time 0.415 (0.403) data 0.288 (0.276) loss_u loss_u 0.9316 (0.8953) acc_u 6.2500 (12.5000) lr 1.9999e-03 eta 0:00:09
epoch [3/200] batch [10/29] time 0.349 (0.402) data 0.271 (0.276) loss_u loss_u 0.8516 (0.8801) acc_u 25.0000 (16.2500) lr 1.9999e-03 eta 0:00:07
epoch [3/200] batch [15/29] time 0.445 (0.406) data 0.320 (0.280) loss_u loss_u 0.8389 (0.8821) acc_u 21.8750 (15.4167) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [20/29] time 0.430 (0.410) data 0.300 (0.284) loss_u loss_u 0.8501 (0.8842) acc_u 18.7500 (15.1562) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [25/29] time 0.429 (0.409) data 0.304 (0.282) loss_u loss_u 0.8442 (0.8767) acc_u 18.7500 (16.0000) lr 1.9999e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 701
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 709
clean true:709
clean false:0
clean_rate:1.0
noisy true:222
noisy false:701
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 923
epoch [4/200] batch [5/22] time 0.425 (0.437) data 0.299 (0.313) loss_x loss_x 0.7534 (0.8140) acc_x 81.2500 (78.1250) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [10/22] time 0.389 (0.417) data 0.266 (0.296) loss_x loss_x 0.5986 (0.7584) acc_x 81.2500 (79.3750) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [15/22] time 0.382 (0.407) data 0.261 (0.286) loss_x loss_x 0.9062 (0.7441) acc_x 81.2500 (81.0417) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/22] time 0.372 (0.405) data 0.247 (0.283) loss_x loss_x 0.5444 (0.6970) acc_x 90.6250 (82.1875) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/28] time 0.356 (0.395) data 0.229 (0.272) loss_u loss_u 0.9028 (0.8681) acc_u 12.5000 (16.8750) lr 1.9995e-03 eta 0:00:09
epoch [4/200] batch [10/28] time 0.381 (0.391) data 0.255 (0.268) loss_u loss_u 0.8374 (0.8812) acc_u 25.0000 (15.3125) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [15/28] time 0.429 (0.395) data 0.301 (0.272) loss_u loss_u 0.9272 (0.8847) acc_u 9.3750 (15.0000) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [20/28] time 0.410 (0.398) data 0.284 (0.274) loss_u loss_u 0.8589 (0.8764) acc_u 15.6250 (16.2500) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [25/28] time 0.385 (0.400) data 0.255 (0.275) loss_u loss_u 0.8311 (0.8784) acc_u 21.8750 (15.7500) lr 1.9995e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 681
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 721
clean true:720
clean false:1
clean_rate:0.9986130374479889
noisy true:231
noisy false:680
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 911
epoch [5/200] batch [5/22] time 0.453 (0.439) data 0.326 (0.313) loss_x loss_x 0.7061 (0.8803) acc_x 81.2500 (79.3750) lr 1.9989e-03 eta 0:00:07
epoch [5/200] batch [10/22] time 0.441 (0.439) data 0.316 (0.313) loss_x loss_x 0.7959 (0.8354) acc_x 84.3750 (80.3125) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [15/22] time 0.398 (0.418) data 0.272 (0.292) loss_x loss_x 0.7964 (0.8126) acc_x 84.3750 (80.2083) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/22] time 0.338 (0.408) data 0.254 (0.284) loss_x loss_x 0.3574 (0.7854) acc_x 90.6250 (80.7812) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/28] time 0.415 (0.401) data 0.288 (0.279) loss_u loss_u 0.8916 (0.8757) acc_u 12.5000 (16.8750) lr 1.9989e-03 eta 0:00:09
epoch [5/200] batch [10/28] time 0.416 (0.403) data 0.289 (0.280) loss_u loss_u 0.8242 (0.8730) acc_u 25.0000 (16.5625) lr 1.9989e-03 eta 0:00:07
epoch [5/200] batch [15/28] time 0.470 (0.404) data 0.342 (0.280) loss_u loss_u 0.9116 (0.8767) acc_u 12.5000 (16.0417) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [20/28] time 0.398 (0.406) data 0.272 (0.281) loss_u loss_u 0.8569 (0.8707) acc_u 18.7500 (16.5625) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [25/28] time 0.446 (0.408) data 0.321 (0.284) loss_u loss_u 0.8462 (0.8715) acc_u 18.7500 (17.0000) lr 1.9989e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 660
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:729
clean false:0
clean_rate:1.0
noisy true:243
noisy false:660
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [6/200] batch [5/22] time 0.407 (0.447) data 0.280 (0.313) loss_x loss_x 0.7212 (0.6524) acc_x 78.1250 (83.7500) lr 1.9980e-03 eta 0:00:07
epoch [6/200] batch [10/22] time 0.426 (0.430) data 0.300 (0.300) loss_x loss_x 0.8003 (0.6503) acc_x 78.1250 (84.0625) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [15/22] time 0.407 (0.436) data 0.281 (0.307) loss_x loss_x 0.8491 (0.6487) acc_x 75.0000 (84.5833) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [20/22] time 0.391 (0.425) data 0.269 (0.297) loss_x loss_x 0.5410 (0.6599) acc_x 87.5000 (84.3750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/28] time 0.398 (0.415) data 0.269 (0.287) loss_u loss_u 0.8989 (0.8816) acc_u 12.5000 (15.6250) lr 1.9980e-03 eta 0:00:09
epoch [6/200] batch [10/28] time 0.416 (0.415) data 0.291 (0.289) loss_u loss_u 0.9214 (0.8734) acc_u 9.3750 (15.3125) lr 1.9980e-03 eta 0:00:07
epoch [6/200] batch [15/28] time 0.388 (0.416) data 0.261 (0.290) loss_u loss_u 0.8335 (0.8743) acc_u 25.0000 (16.2500) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [20/28] time 0.369 (0.411) data 0.240 (0.285) loss_u loss_u 0.8774 (0.8708) acc_u 15.6250 (16.4062) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [25/28] time 0.467 (0.412) data 0.341 (0.285) loss_u loss_u 0.8081 (0.8644) acc_u 21.8750 (17.3750) lr 1.9980e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 618
confident_label rate tensor(0.4730, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 772
clean true:771
clean false:1
clean_rate:0.9987046632124352
noisy true:243
noisy false:617
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 860
epoch [7/200] batch [5/24] time 0.464 (0.435) data 0.339 (0.310) loss_x loss_x 0.7891 (0.8276) acc_x 81.2500 (80.6250) lr 1.9969e-03 eta 0:00:08
epoch [7/200] batch [10/24] time 0.397 (0.435) data 0.271 (0.309) loss_x loss_x 0.5420 (0.7051) acc_x 84.3750 (82.5000) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [15/24] time 0.450 (0.434) data 0.327 (0.308) loss_x loss_x 0.6724 (0.7030) acc_x 81.2500 (82.5000) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/24] time 0.392 (0.431) data 0.267 (0.305) loss_x loss_x 0.9863 (0.7143) acc_x 71.8750 (82.3438) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [5/26] time 0.363 (0.413) data 0.228 (0.288) loss_u loss_u 0.8433 (0.8798) acc_u 21.8750 (16.2500) lr 1.9969e-03 eta 0:00:08
epoch [7/200] batch [10/26] time 0.411 (0.409) data 0.283 (0.284) loss_u loss_u 0.8896 (0.8824) acc_u 15.6250 (15.3125) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [15/26] time 0.419 (0.411) data 0.292 (0.285) loss_u loss_u 0.8423 (0.8754) acc_u 18.7500 (15.6250) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [20/26] time 0.479 (0.413) data 0.352 (0.287) loss_u loss_u 0.8867 (0.8781) acc_u 12.5000 (15.3125) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [25/26] time 0.506 (0.416) data 0.381 (0.290) loss_u loss_u 0.8833 (0.8778) acc_u 12.5000 (15.3750) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 600
confident_label rate tensor(0.4835, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 789
clean true:789
clean false:0
clean_rate:1.0
noisy true:243
noisy false:600
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 843
epoch [8/200] batch [5/24] time 0.415 (0.449) data 0.289 (0.333) loss_x loss_x 0.4609 (0.6693) acc_x 90.6250 (82.5000) lr 1.9956e-03 eta 0:00:08
epoch [8/200] batch [10/24] time 0.357 (0.407) data 0.228 (0.286) loss_x loss_x 0.6157 (0.6142) acc_x 81.2500 (83.4375) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [15/24] time 0.516 (0.420) data 0.389 (0.297) loss_x loss_x 0.5942 (0.6343) acc_x 81.2500 (83.7500) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [20/24] time 0.387 (0.418) data 0.262 (0.295) loss_x loss_x 0.6099 (0.6523) acc_x 78.1250 (83.2812) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [5/26] time 0.390 (0.412) data 0.261 (0.287) loss_u loss_u 0.9614 (0.9078) acc_u 6.2500 (11.2500) lr 1.9956e-03 eta 0:00:08
epoch [8/200] batch [10/26] time 0.407 (0.414) data 0.278 (0.288) loss_u loss_u 0.8940 (0.8861) acc_u 15.6250 (13.4375) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [15/26] time 0.427 (0.412) data 0.302 (0.288) loss_u loss_u 0.8916 (0.8926) acc_u 12.5000 (12.5000) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [20/26] time 0.368 (0.409) data 0.242 (0.284) loss_u loss_u 0.8823 (0.8854) acc_u 12.5000 (13.9062) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [25/26] time 0.390 (0.408) data 0.264 (0.284) loss_u loss_u 0.7646 (0.8782) acc_u 28.1250 (14.6250) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 591
confident_label rate tensor(0.4884, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 797
clean true:797
clean false:0
clean_rate:1.0
noisy true:244
noisy false:591
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 835
epoch [9/200] batch [5/24] time 0.396 (0.428) data 0.272 (0.304) loss_x loss_x 0.6870 (0.6459) acc_x 84.3750 (81.8750) lr 1.9940e-03 eta 0:00:08
epoch [9/200] batch [10/24] time 0.455 (0.429) data 0.329 (0.304) loss_x loss_x 0.4626 (0.6255) acc_x 93.7500 (84.3750) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [15/24] time 0.491 (0.444) data 0.366 (0.319) loss_x loss_x 0.5674 (0.6429) acc_x 90.6250 (84.1667) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [20/24] time 0.435 (0.431) data 0.308 (0.308) loss_x loss_x 0.5068 (0.6315) acc_x 87.5000 (84.3750) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [5/26] time 0.555 (0.415) data 0.428 (0.291) loss_u loss_u 0.9292 (0.8554) acc_u 9.3750 (16.8750) lr 1.9940e-03 eta 0:00:08
epoch [9/200] batch [10/26] time 0.436 (0.422) data 0.309 (0.298) loss_u loss_u 0.8896 (0.8559) acc_u 9.3750 (16.8750) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [15/26] time 0.357 (0.420) data 0.228 (0.295) loss_u loss_u 0.9126 (0.8633) acc_u 15.6250 (16.8750) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [20/26] time 0.421 (0.417) data 0.292 (0.292) loss_u loss_u 0.9326 (0.8716) acc_u 6.2500 (16.2500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [25/26] time 0.393 (0.415) data 0.266 (0.290) loss_u loss_u 0.9106 (0.8751) acc_u 9.3750 (15.7500) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 575
confident_label rate tensor(0.4884, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 797
clean true:796
clean false:1
clean_rate:0.998745294855709
noisy true:261
noisy false:574
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 835
epoch [10/200] batch [5/24] time 0.368 (0.422) data 0.273 (0.300) loss_x loss_x 0.5264 (0.6007) acc_x 87.5000 (86.2500) lr 1.9921e-03 eta 0:00:08
epoch [10/200] batch [10/24] time 0.461 (0.425) data 0.336 (0.307) loss_x loss_x 0.6108 (0.6010) acc_x 81.2500 (85.6250) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [15/24] time 0.396 (0.419) data 0.269 (0.299) loss_x loss_x 0.7905 (0.6270) acc_x 81.2500 (84.7917) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [20/24] time 0.348 (0.409) data 0.220 (0.287) loss_x loss_x 0.4758 (0.6328) acc_x 84.3750 (85.1562) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [5/26] time 0.468 (0.408) data 0.340 (0.285) loss_u loss_u 0.8589 (0.8806) acc_u 15.6250 (15.6250) lr 1.9921e-03 eta 0:00:08
epoch [10/200] batch [10/26] time 0.410 (0.411) data 0.282 (0.287) loss_u loss_u 0.8945 (0.8775) acc_u 15.6250 (15.9375) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [15/26] time 0.417 (0.414) data 0.292 (0.291) loss_u loss_u 0.8145 (0.8780) acc_u 25.0000 (15.6250) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [20/26] time 0.421 (0.414) data 0.298 (0.291) loss_u loss_u 0.8979 (0.8821) acc_u 12.5000 (15.0000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [25/26] time 0.401 (0.414) data 0.271 (0.290) loss_u loss_u 0.8662 (0.8737) acc_u 18.7500 (16.2500) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 539
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 815
clean true:815
clean false:0
clean_rate:1.0
noisy true:278
noisy false:539
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 817
epoch [11/200] batch [5/25] time 0.405 (0.414) data 0.277 (0.286) loss_x loss_x 0.5679 (0.6226) acc_x 87.5000 (85.0000) lr 1.9900e-03 eta 0:00:08
epoch [11/200] batch [10/25] time 0.437 (0.417) data 0.309 (0.290) loss_x loss_x 0.4573 (0.6563) acc_x 87.5000 (84.6875) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [15/25] time 0.404 (0.417) data 0.275 (0.290) loss_x loss_x 0.5967 (0.6277) acc_x 81.2500 (84.5833) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [20/25] time 0.352 (0.404) data 0.221 (0.276) loss_x loss_x 1.0430 (0.6737) acc_x 84.3750 (84.2188) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [25/25] time 0.374 (0.398) data 0.248 (0.270) loss_x loss_x 0.5913 (0.6405) acc_x 81.2500 (84.6250) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/25] time 0.397 (0.400) data 0.270 (0.272) loss_u loss_u 0.8613 (0.9112) acc_u 21.8750 (13.1250) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [10/25] time 0.377 (0.395) data 0.252 (0.270) loss_u loss_u 0.8369 (0.8843) acc_u 21.8750 (15.0000) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [15/25] time 0.375 (0.395) data 0.245 (0.270) loss_u loss_u 0.9097 (0.8869) acc_u 9.3750 (14.3750) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [20/25] time 0.395 (0.395) data 0.268 (0.269) loss_u loss_u 0.8604 (0.8783) acc_u 15.6250 (15.1562) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/25] time 0.424 (0.397) data 0.297 (0.271) loss_u loss_u 0.8340 (0.8745) acc_u 21.8750 (15.7500) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 537
confident_label rate tensor(0.5141, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 839
clean true:838
clean false:1
clean_rate:0.99880810488677
noisy true:257
noisy false:536
after delete: len(clean_dataset) 839
after delete: len(noisy_dataset) 793
epoch [12/200] batch [5/26] time 0.395 (0.416) data 0.269 (0.289) loss_x loss_x 0.8862 (0.5789) acc_x 75.0000 (83.1250) lr 1.9877e-03 eta 0:00:08
epoch [12/200] batch [10/26] time 0.435 (0.419) data 0.298 (0.291) loss_x loss_x 0.4055 (0.5384) acc_x 87.5000 (85.3125) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [15/26] time 0.402 (0.418) data 0.275 (0.291) loss_x loss_x 0.4453 (0.5727) acc_x 90.6250 (85.2083) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [20/26] time 0.355 (0.410) data 0.232 (0.283) loss_x loss_x 0.6367 (0.5681) acc_x 84.3750 (85.6250) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [25/26] time 0.357 (0.400) data 0.232 (0.273) loss_x loss_x 0.6196 (0.5860) acc_x 87.5000 (85.0000) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/24] time 0.383 (0.395) data 0.257 (0.268) loss_u loss_u 0.9229 (0.8915) acc_u 9.3750 (14.3750) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [10/24] time 0.417 (0.398) data 0.289 (0.271) loss_u loss_u 0.9209 (0.8806) acc_u 12.5000 (15.3125) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [15/24] time 0.401 (0.400) data 0.274 (0.274) loss_u loss_u 0.9116 (0.8874) acc_u 12.5000 (14.3750) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [20/24] time 0.427 (0.402) data 0.300 (0.275) loss_u loss_u 0.9165 (0.8960) acc_u 9.3750 (13.1250) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 548
confident_label rate tensor(0.5049, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 824
clean true:823
clean false:1
clean_rate:0.9987864077669902
noisy true:261
noisy false:547
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 808
epoch [13/200] batch [5/25] time 0.424 (0.402) data 0.294 (0.286) loss_x loss_x 0.6489 (0.5863) acc_x 78.1250 (82.5000) lr 1.9851e-03 eta 0:00:08
epoch [13/200] batch [10/25] time 0.441 (0.419) data 0.312 (0.298) loss_x loss_x 0.3215 (0.5593) acc_x 93.7500 (85.6250) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [15/25] time 0.370 (0.417) data 0.243 (0.293) loss_x loss_x 0.4207 (0.5219) acc_x 96.8750 (87.0833) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/25] time 0.356 (0.403) data 0.231 (0.279) loss_x loss_x 0.8018 (0.5518) acc_x 75.0000 (86.5625) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [25/25] time 0.379 (0.403) data 0.250 (0.279) loss_x loss_x 0.6958 (0.5483) acc_x 81.2500 (86.6250) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/25] time 0.412 (0.399) data 0.283 (0.274) loss_u loss_u 0.8882 (0.8791) acc_u 9.3750 (16.2500) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [10/25] time 0.394 (0.401) data 0.267 (0.277) loss_u loss_u 0.8643 (0.8626) acc_u 15.6250 (18.1250) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [15/25] time 0.391 (0.402) data 0.266 (0.277) loss_u loss_u 0.8330 (0.8730) acc_u 28.1250 (17.2917) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/25] time 0.403 (0.404) data 0.278 (0.279) loss_u loss_u 0.9160 (0.8718) acc_u 6.2500 (16.7188) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [25/25] time 0.451 (0.405) data 0.324 (0.280) loss_u loss_u 0.7427 (0.8659) acc_u 40.6250 (17.8750) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 531
confident_label rate tensor(0.5208, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 850
clean true:848
clean false:2
clean_rate:0.9976470588235294
noisy true:253
noisy false:529
after delete: len(clean_dataset) 850
after delete: len(noisy_dataset) 782
epoch [14/200] batch [5/26] time 0.416 (0.424) data 0.290 (0.307) loss_x loss_x 0.3770 (0.4449) acc_x 90.6250 (91.2500) lr 1.9823e-03 eta 0:00:08
epoch [14/200] batch [10/26] time 0.459 (0.440) data 0.333 (0.319) loss_x loss_x 0.4463 (0.5574) acc_x 87.5000 (86.8750) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [15/26] time 0.373 (0.427) data 0.251 (0.305) loss_x loss_x 0.6025 (0.5867) acc_x 93.7500 (87.0833) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [20/26] time 0.389 (0.417) data 0.264 (0.294) loss_x loss_x 0.4375 (0.5511) acc_x 90.6250 (87.6562) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [25/26] time 0.419 (0.415) data 0.293 (0.292) loss_x loss_x 0.6938 (0.5556) acc_x 84.3750 (87.2500) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/24] time 0.477 (0.424) data 0.350 (0.300) loss_u loss_u 0.8428 (0.8677) acc_u 18.7500 (15.6250) lr 1.9823e-03 eta 0:00:08
epoch [14/200] batch [10/24] time 0.461 (0.429) data 0.338 (0.305) loss_u loss_u 0.8687 (0.8797) acc_u 15.6250 (14.3750) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [15/24] time 0.347 (0.425) data 0.220 (0.301) loss_u loss_u 0.8145 (0.8681) acc_u 18.7500 (15.6250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [20/24] time 0.393 (0.419) data 0.265 (0.294) loss_u loss_u 0.7827 (0.8640) acc_u 25.0000 (16.0938) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 524
confident_label rate tensor(0.5116, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 835
clean true:835
clean false:0
clean_rate:1.0
noisy true:273
noisy false:524
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 797
epoch [15/200] batch [5/26] time 0.420 (0.409) data 0.295 (0.285) loss_x loss_x 0.3823 (0.4332) acc_x 90.6250 (92.5000) lr 1.9792e-03 eta 0:00:08
epoch [15/200] batch [10/26] time 0.392 (0.403) data 0.268 (0.278) loss_x loss_x 0.3499 (0.5754) acc_x 90.6250 (88.7500) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [15/26] time 0.392 (0.403) data 0.266 (0.275) loss_x loss_x 0.7832 (0.6003) acc_x 81.2500 (87.7083) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [20/26] time 0.402 (0.400) data 0.275 (0.273) loss_x loss_x 0.4001 (0.5773) acc_x 87.5000 (87.6562) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/26] time 0.371 (0.393) data 0.243 (0.266) loss_x loss_x 0.4705 (0.5564) acc_x 87.5000 (88.0000) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/24] time 0.381 (0.393) data 0.253 (0.266) loss_u loss_u 0.8789 (0.8497) acc_u 18.7500 (21.2500) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [10/24] time 0.397 (0.393) data 0.271 (0.265) loss_u loss_u 0.8198 (0.8505) acc_u 21.8750 (20.3125) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/24] time 0.398 (0.393) data 0.268 (0.265) loss_u loss_u 0.8931 (0.8615) acc_u 12.5000 (18.3333) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [20/24] time 0.395 (0.391) data 0.268 (0.265) loss_u loss_u 0.8149 (0.8628) acc_u 28.1250 (18.1250) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 486
confident_label rate tensor(0.5294, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 864
clean true:864
clean false:0
clean_rate:1.0
noisy true:282
noisy false:486
after delete: len(clean_dataset) 864
after delete: len(noisy_dataset) 768
epoch [16/200] batch [5/27] time 0.408 (0.401) data 0.284 (0.277) loss_x loss_x 0.4883 (0.4749) acc_x 93.7500 (90.0000) lr 1.9759e-03 eta 0:00:08
epoch [16/200] batch [10/27] time 0.353 (0.380) data 0.225 (0.254) loss_x loss_x 0.5371 (0.5458) acc_x 87.5000 (88.4375) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [15/27] time 0.402 (0.377) data 0.275 (0.251) loss_x loss_x 0.5137 (0.5332) acc_x 84.3750 (88.1250) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [20/27] time 0.345 (0.380) data 0.268 (0.256) loss_x loss_x 0.3423 (0.5317) acc_x 87.5000 (87.5000) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/27] time 0.402 (0.385) data 0.277 (0.261) loss_x loss_x 0.4817 (0.5220) acc_x 84.3750 (88.0000) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/24] time 0.392 (0.389) data 0.264 (0.264) loss_u loss_u 0.9097 (0.8970) acc_u 12.5000 (11.8750) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [10/24] time 0.401 (0.391) data 0.273 (0.266) loss_u loss_u 0.8037 (0.8893) acc_u 25.0000 (13.4375) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [15/24] time 0.412 (0.393) data 0.285 (0.268) loss_u loss_u 0.8022 (0.8765) acc_u 25.0000 (15.2083) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [20/24] time 0.514 (0.400) data 0.385 (0.275) loss_u loss_u 0.8770 (0.8770) acc_u 15.6250 (15.4688) lr 1.9759e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 495
confident_label rate tensor(0.5319, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 868
clean true:867
clean false:1
clean_rate:0.9988479262672811
noisy true:270
noisy false:494
after delete: len(clean_dataset) 868
after delete: len(noisy_dataset) 764
epoch [17/200] batch [5/27] time 0.431 (0.414) data 0.307 (0.288) loss_x loss_x 0.5132 (0.5130) acc_x 87.5000 (87.5000) lr 1.9724e-03 eta 0:00:09
epoch [17/200] batch [10/27] time 0.394 (0.412) data 0.269 (0.286) loss_x loss_x 0.3193 (0.4639) acc_x 93.7500 (88.1250) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [15/27] time 0.398 (0.407) data 0.272 (0.281) loss_x loss_x 0.5986 (0.4907) acc_x 87.5000 (88.5417) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [20/27] time 0.379 (0.403) data 0.254 (0.277) loss_x loss_x 0.5840 (0.5352) acc_x 87.5000 (87.0312) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/27] time 0.397 (0.403) data 0.271 (0.278) loss_x loss_x 0.4270 (0.5360) acc_x 93.7500 (86.8750) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/23] time 0.397 (0.401) data 0.272 (0.276) loss_u loss_u 0.8745 (0.8692) acc_u 15.6250 (16.8750) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [10/23] time 0.400 (0.402) data 0.273 (0.277) loss_u loss_u 0.7534 (0.8558) acc_u 28.1250 (18.1250) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [15/23] time 0.391 (0.402) data 0.262 (0.277) loss_u loss_u 0.9204 (0.8654) acc_u 15.6250 (16.6667) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [20/23] time 0.434 (0.403) data 0.308 (0.279) loss_u loss_u 0.7783 (0.8632) acc_u 25.0000 (17.1875) lr 1.9724e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 458
confident_label rate tensor(0.5509, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 899
clean true:897
clean false:2
clean_rate:0.9977753058954394
noisy true:277
noisy false:456
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 733
epoch [18/200] batch [5/28] time 0.430 (0.410) data 0.303 (0.289) loss_x loss_x 0.5356 (0.4526) acc_x 93.7500 (92.5000) lr 1.9686e-03 eta 0:00:09
epoch [18/200] batch [10/28] time 0.432 (0.419) data 0.309 (0.295) loss_x loss_x 0.4336 (0.4934) acc_x 90.6250 (89.0625) lr 1.9686e-03 eta 0:00:07
epoch [18/200] batch [15/28] time 0.356 (0.403) data 0.230 (0.278) loss_x loss_x 0.5674 (0.4919) acc_x 84.3750 (89.3750) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [20/28] time 0.371 (0.395) data 0.245 (0.270) loss_x loss_x 0.3372 (0.4631) acc_x 93.7500 (89.8438) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [25/28] time 0.438 (0.396) data 0.314 (0.270) loss_x loss_x 0.3237 (0.5286) acc_x 90.6250 (88.2500) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [5/22] time 0.412 (0.396) data 0.287 (0.273) loss_u loss_u 0.7720 (0.8491) acc_u 25.0000 (18.7500) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [10/22] time 0.426 (0.399) data 0.301 (0.276) loss_u loss_u 0.9258 (0.8752) acc_u 9.3750 (15.0000) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [15/22] time 0.416 (0.402) data 0.286 (0.278) loss_u loss_u 0.9106 (0.8822) acc_u 12.5000 (14.7917) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/22] time 0.380 (0.402) data 0.255 (0.278) loss_u loss_u 0.8374 (0.8811) acc_u 21.8750 (15.0000) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 482
confident_label rate tensor(0.5392, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 880
clean true:877
clean false:3
clean_rate:0.9965909090909091
noisy true:273
noisy false:479
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 752
epoch [19/200] batch [5/27] time 0.421 (0.433) data 0.296 (0.307) loss_x loss_x 0.7275 (0.6003) acc_x 81.2500 (87.5000) lr 1.9646e-03 eta 0:00:09
epoch [19/200] batch [10/27] time 0.396 (0.419) data 0.270 (0.293) loss_x loss_x 0.4961 (0.5191) acc_x 93.7500 (89.0625) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [15/27] time 0.419 (0.403) data 0.295 (0.277) loss_x loss_x 0.6035 (0.5349) acc_x 81.2500 (87.2917) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [20/27] time 0.393 (0.398) data 0.268 (0.274) loss_x loss_x 0.4939 (0.5315) acc_x 87.5000 (87.0312) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [25/27] time 0.375 (0.395) data 0.249 (0.271) loss_x loss_x 0.3845 (0.5256) acc_x 90.6250 (87.1250) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/23] time 0.432 (0.400) data 0.308 (0.275) loss_u loss_u 0.9497 (0.8640) acc_u 6.2500 (15.6250) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [10/23] time 0.453 (0.403) data 0.325 (0.278) loss_u loss_u 0.7764 (0.8421) acc_u 28.1250 (18.4375) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [15/23] time 0.433 (0.403) data 0.309 (0.279) loss_u loss_u 0.9067 (0.8598) acc_u 12.5000 (16.2500) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [20/23] time 0.405 (0.405) data 0.280 (0.281) loss_u loss_u 0.8867 (0.8632) acc_u 15.6250 (16.0938) lr 1.9646e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 465
confident_label rate tensor(0.5447, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 889
clean true:887
clean false:2
clean_rate:0.9977502812148481
noisy true:280
noisy false:463
after delete: len(clean_dataset) 889
after delete: len(noisy_dataset) 743
epoch [20/200] batch [5/27] time 0.396 (0.410) data 0.272 (0.284) loss_x loss_x 0.4426 (0.6407) acc_x 90.6250 (83.7500) lr 1.9603e-03 eta 0:00:09
epoch [20/200] batch [10/27] time 0.393 (0.409) data 0.268 (0.282) loss_x loss_x 0.8330 (0.5675) acc_x 75.0000 (85.3125) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [15/27] time 0.384 (0.406) data 0.256 (0.279) loss_x loss_x 0.5020 (0.4983) acc_x 84.3750 (87.2917) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [20/27] time 0.391 (0.403) data 0.264 (0.277) loss_x loss_x 0.2605 (0.4747) acc_x 90.6250 (87.9688) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [25/27] time 0.392 (0.401) data 0.265 (0.274) loss_x loss_x 0.5669 (0.4793) acc_x 90.6250 (88.7500) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/23] time 0.382 (0.399) data 0.257 (0.274) loss_u loss_u 0.7954 (0.8724) acc_u 25.0000 (15.6250) lr 1.9603e-03 eta 0:00:07
epoch [20/200] batch [10/23] time 0.384 (0.399) data 0.261 (0.274) loss_u loss_u 0.9150 (0.8490) acc_u 12.5000 (18.1250) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [15/23] time 0.341 (0.396) data 0.214 (0.271) loss_u loss_u 0.7388 (0.8471) acc_u 28.1250 (18.1250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [20/23] time 0.411 (0.394) data 0.287 (0.269) loss_u loss_u 0.9160 (0.8620) acc_u 12.5000 (16.7188) lr 1.9603e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 440
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 912
clean true:910
clean false:2
clean_rate:0.9978070175438597
noisy true:282
noisy false:438
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 720
epoch [21/200] batch [5/28] time 0.422 (0.423) data 0.295 (0.296) loss_x loss_x 0.4170 (0.4599) acc_x 96.8750 (88.7500) lr 1.9558e-03 eta 0:00:09
epoch [21/200] batch [10/28] time 0.462 (0.436) data 0.335 (0.310) loss_x loss_x 0.2489 (0.4761) acc_x 96.8750 (89.0625) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [15/28] time 0.431 (0.440) data 0.306 (0.315) loss_x loss_x 0.4224 (0.5030) acc_x 84.3750 (87.7083) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [20/28] time 0.384 (0.435) data 0.260 (0.310) loss_x loss_x 0.4517 (0.4779) acc_x 90.6250 (88.9062) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [25/28] time 0.342 (0.420) data 0.218 (0.295) loss_x loss_x 0.6606 (0.4765) acc_x 87.5000 (89.1250) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [5/22] time 0.381 (0.406) data 0.253 (0.281) loss_u loss_u 0.9482 (0.9171) acc_u 9.3750 (10.0000) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [10/22] time 0.395 (0.407) data 0.268 (0.282) loss_u loss_u 0.9604 (0.8901) acc_u 3.1250 (12.8125) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [15/22] time 0.405 (0.403) data 0.279 (0.279) loss_u loss_u 0.8828 (0.8917) acc_u 15.6250 (12.9167) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/22] time 0.403 (0.403) data 0.278 (0.279) loss_u loss_u 0.8516 (0.8869) acc_u 21.8750 (13.5938) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 456
confident_label rate tensor(0.5478, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 894
clean true:893
clean false:1
clean_rate:0.9988814317673378
noisy true:283
noisy false:455
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 738
epoch [22/200] batch [5/27] time 0.395 (0.408) data 0.270 (0.291) loss_x loss_x 0.5825 (0.4720) acc_x 87.5000 (89.3750) lr 1.9511e-03 eta 0:00:08
epoch [22/200] batch [10/27] time 0.358 (0.397) data 0.230 (0.275) loss_x loss_x 0.4961 (0.4688) acc_x 84.3750 (86.8750) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [15/27] time 0.388 (0.390) data 0.263 (0.267) loss_x loss_x 0.3398 (0.4927) acc_x 90.6250 (86.0417) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [20/27] time 0.438 (0.397) data 0.314 (0.274) loss_x loss_x 0.4392 (0.4740) acc_x 84.3750 (86.2500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/27] time 0.389 (0.396) data 0.264 (0.272) loss_x loss_x 0.8750 (0.4956) acc_x 81.2500 (86.3750) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/23] time 0.365 (0.392) data 0.240 (0.269) loss_u loss_u 0.8618 (0.8145) acc_u 18.7500 (23.1250) lr 1.9511e-03 eta 0:00:07
epoch [22/200] batch [10/23] time 0.405 (0.389) data 0.278 (0.265) loss_u loss_u 0.8799 (0.8454) acc_u 15.6250 (20.0000) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [15/23] time 0.398 (0.391) data 0.268 (0.267) loss_u loss_u 0.7827 (0.8490) acc_u 25.0000 (18.9583) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [20/23] time 0.386 (0.392) data 0.258 (0.268) loss_u loss_u 0.8281 (0.8530) acc_u 21.8750 (18.5938) lr 1.9511e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 430
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 906
clean true:903
clean false:3
clean_rate:0.9966887417218543
noisy true:299
noisy false:427
after delete: len(clean_dataset) 906
after delete: len(noisy_dataset) 726
epoch [23/200] batch [5/28] time 0.447 (0.423) data 0.319 (0.297) loss_x loss_x 0.2749 (0.4336) acc_x 96.8750 (90.0000) lr 1.9461e-03 eta 0:00:09
epoch [23/200] batch [10/28] time 0.448 (0.433) data 0.322 (0.307) loss_x loss_x 0.2610 (0.4298) acc_x 93.7500 (90.6250) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [15/28] time 0.385 (0.424) data 0.259 (0.298) loss_x loss_x 0.9844 (0.4982) acc_x 78.1250 (89.1667) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [20/28] time 0.400 (0.421) data 0.275 (0.298) loss_x loss_x 0.4041 (0.4846) acc_x 90.6250 (89.3750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [25/28] time 0.387 (0.419) data 0.265 (0.295) loss_x loss_x 0.3416 (0.4789) acc_x 90.6250 (89.1250) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [5/22] time 0.394 (0.408) data 0.269 (0.284) loss_u loss_u 0.7891 (0.8438) acc_u 31.2500 (20.6250) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [10/22] time 0.391 (0.407) data 0.267 (0.283) loss_u loss_u 0.8872 (0.8700) acc_u 12.5000 (16.5625) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [15/22] time 0.352 (0.403) data 0.226 (0.280) loss_u loss_u 0.8774 (0.8738) acc_u 15.6250 (16.0417) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/22] time 0.476 (0.401) data 0.348 (0.278) loss_u loss_u 0.9429 (0.8759) acc_u 9.3750 (15.9375) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 424
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 918
clean true:917
clean false:1
clean_rate:0.9989106753812637
noisy true:291
noisy false:423
after delete: len(clean_dataset) 918
after delete: len(noisy_dataset) 714
epoch [24/200] batch [5/28] time 0.398 (0.404) data 0.273 (0.279) loss_x loss_x 0.4880 (0.4663) acc_x 90.6250 (89.3750) lr 1.9409e-03 eta 0:00:09
epoch [24/200] batch [10/28] time 0.394 (0.415) data 0.270 (0.290) loss_x loss_x 0.4619 (0.4684) acc_x 87.5000 (89.3750) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [15/28] time 0.430 (0.417) data 0.307 (0.292) loss_x loss_x 0.3860 (0.5013) acc_x 87.5000 (88.1250) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [20/28] time 0.421 (0.423) data 0.296 (0.300) loss_x loss_x 0.2520 (0.4872) acc_x 96.8750 (88.4375) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [25/28] time 0.392 (0.424) data 0.265 (0.300) loss_x loss_x 0.5913 (0.4839) acc_x 84.3750 (88.5000) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [5/22] time 0.393 (0.416) data 0.265 (0.291) loss_u loss_u 0.8730 (0.8779) acc_u 15.6250 (15.0000) lr 1.9409e-03 eta 0:00:07
epoch [24/200] batch [10/22] time 0.346 (0.412) data 0.220 (0.287) loss_u loss_u 0.8911 (0.8742) acc_u 12.5000 (15.3125) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [15/22] time 0.402 (0.410) data 0.273 (0.285) loss_u loss_u 0.8286 (0.8687) acc_u 21.8750 (16.2500) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/22] time 0.428 (0.410) data 0.299 (0.285) loss_u loss_u 0.8765 (0.8627) acc_u 12.5000 (17.0312) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 423
confident_label rate tensor(0.5631, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 919
clean true:918
clean false:1
clean_rate:0.998911860718172
noisy true:291
noisy false:422
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 713
epoch [25/200] batch [5/28] time 0.433 (0.409) data 0.308 (0.285) loss_x loss_x 0.5044 (0.4633) acc_x 87.5000 (88.1250) lr 1.9354e-03 eta 0:00:09
epoch [25/200] batch [10/28] time 0.407 (0.407) data 0.284 (0.283) loss_x loss_x 0.3311 (0.4960) acc_x 90.6250 (88.4375) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [15/28] time 0.381 (0.396) data 0.254 (0.274) loss_x loss_x 0.4226 (0.4685) acc_x 87.5000 (89.1667) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [20/28] time 0.415 (0.397) data 0.290 (0.274) loss_x loss_x 0.3818 (0.4762) acc_x 87.5000 (88.5938) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/28] time 0.403 (0.397) data 0.276 (0.274) loss_x loss_x 0.3691 (0.4708) acc_x 90.6250 (88.1250) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [5/22] time 0.402 (0.405) data 0.276 (0.281) loss_u loss_u 0.8730 (0.8774) acc_u 18.7500 (18.1250) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [10/22] time 0.340 (0.402) data 0.263 (0.279) loss_u loss_u 0.8877 (0.8703) acc_u 15.6250 (17.8125) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [15/22] time 0.406 (0.400) data 0.278 (0.275) loss_u loss_u 0.9082 (0.8665) acc_u 9.3750 (17.2917) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/22] time 0.420 (0.398) data 0.291 (0.273) loss_u loss_u 0.8662 (0.8637) acc_u 21.8750 (17.6562) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 414
confident_label rate tensor(0.5668, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 925
clean true:924
clean false:1
clean_rate:0.9989189189189189
noisy true:294
noisy false:413
after delete: len(clean_dataset) 925
after delete: len(noisy_dataset) 707
epoch [26/200] batch [5/28] time 0.497 (0.422) data 0.371 (0.306) loss_x loss_x 0.2487 (0.4234) acc_x 100.0000 (92.5000) lr 1.9298e-03 eta 0:00:09
epoch [26/200] batch [10/28] time 0.417 (0.422) data 0.291 (0.302) loss_x loss_x 0.7026 (0.4368) acc_x 87.5000 (92.8125) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [15/28] time 0.414 (0.421) data 0.292 (0.299) loss_x loss_x 0.6416 (0.4736) acc_x 87.5000 (91.8750) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [20/28] time 0.430 (0.422) data 0.305 (0.298) loss_x loss_x 0.5498 (0.4466) acc_x 84.3750 (92.1875) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [25/28] time 0.401 (0.422) data 0.269 (0.298) loss_x loss_x 0.3140 (0.4401) acc_x 96.8750 (92.0000) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [5/22] time 0.399 (0.417) data 0.274 (0.294) loss_u loss_u 0.7466 (0.8592) acc_u 31.2500 (16.8750) lr 1.9298e-03 eta 0:00:07
epoch [26/200] batch [10/22] time 0.396 (0.413) data 0.271 (0.290) loss_u loss_u 0.8774 (0.8738) acc_u 18.7500 (15.6250) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [15/22] time 0.343 (0.406) data 0.216 (0.282) loss_u loss_u 0.8198 (0.8675) acc_u 21.8750 (16.4583) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/22] time 0.325 (0.401) data 0.246 (0.277) loss_u loss_u 0.8901 (0.8676) acc_u 12.5000 (16.7188) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 418
confident_label rate tensor(0.5692, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 929
clean true:927
clean false:2
clean_rate:0.9978471474703983
noisy true:287
noisy false:416
after delete: len(clean_dataset) 929
after delete: len(noisy_dataset) 703
epoch [27/200] batch [5/29] time 0.393 (0.413) data 0.266 (0.302) loss_x loss_x 0.5098 (0.5076) acc_x 93.7500 (88.7500) lr 1.9239e-03 eta 0:00:09
epoch [27/200] batch [10/29] time 0.410 (0.408) data 0.283 (0.290) loss_x loss_x 0.3279 (0.4865) acc_x 90.6250 (90.0000) lr 1.9239e-03 eta 0:00:07
epoch [27/200] batch [15/29] time 0.396 (0.407) data 0.270 (0.287) loss_x loss_x 0.8237 (0.5382) acc_x 81.2500 (87.5000) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [20/29] time 0.400 (0.406) data 0.276 (0.285) loss_x loss_x 0.4451 (0.4931) acc_x 87.5000 (88.5938) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/29] time 0.411 (0.404) data 0.287 (0.281) loss_x loss_x 0.3655 (0.4842) acc_x 90.6250 (88.8750) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [5/21] time 0.353 (0.392) data 0.226 (0.269) loss_u loss_u 0.8535 (0.8665) acc_u 18.7500 (17.5000) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [10/21] time 0.419 (0.394) data 0.289 (0.271) loss_u loss_u 0.7881 (0.8676) acc_u 25.0000 (16.5625) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/21] time 0.398 (0.393) data 0.272 (0.269) loss_u loss_u 0.9424 (0.8758) acc_u 9.3750 (15.4167) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/21] time 0.388 (0.393) data 0.262 (0.269) loss_u loss_u 0.8013 (0.8677) acc_u 25.0000 (16.5625) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 430
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 911
clean true:908
clean false:3
clean_rate:0.9967069154774972
noisy true:294
noisy false:427
after delete: len(clean_dataset) 911
after delete: len(noisy_dataset) 721
epoch [28/200] batch [5/28] time 0.409 (0.399) data 0.285 (0.275) loss_x loss_x 0.6040 (0.5649) acc_x 81.2500 (85.6250) lr 1.9178e-03 eta 0:00:09
epoch [28/200] batch [10/28] time 0.356 (0.385) data 0.230 (0.261) loss_x loss_x 0.3853 (0.5465) acc_x 87.5000 (85.9375) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [15/28] time 0.406 (0.376) data 0.279 (0.252) loss_x loss_x 0.3596 (0.5527) acc_x 87.5000 (85.6250) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [20/28] time 0.416 (0.385) data 0.291 (0.260) loss_x loss_x 0.4949 (0.5155) acc_x 90.6250 (86.7188) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [25/28] time 0.388 (0.389) data 0.263 (0.265) loss_x loss_x 0.6040 (0.5048) acc_x 75.0000 (86.7500) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [5/22] time 0.397 (0.391) data 0.267 (0.266) loss_u loss_u 0.8286 (0.8447) acc_u 18.7500 (20.6250) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [10/22] time 0.319 (0.390) data 0.241 (0.266) loss_u loss_u 0.9482 (0.8504) acc_u 9.3750 (19.0625) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [15/22] time 0.379 (0.391) data 0.253 (0.266) loss_u loss_u 0.9233 (0.8623) acc_u 9.3750 (17.5000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/22] time 0.398 (0.390) data 0.273 (0.265) loss_u loss_u 0.8379 (0.8662) acc_u 18.7500 (16.8750) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 416
confident_label rate tensor(0.5699, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 930
clean true:929
clean false:1
clean_rate:0.9989247311827957
noisy true:287
noisy false:415
after delete: len(clean_dataset) 930
after delete: len(noisy_dataset) 702
epoch [29/200] batch [5/29] time 0.427 (0.421) data 0.303 (0.306) loss_x loss_x 0.7461 (0.4769) acc_x 84.3750 (90.6250) lr 1.9114e-03 eta 0:00:10
epoch [29/200] batch [10/29] time 0.429 (0.428) data 0.302 (0.307) loss_x loss_x 0.2214 (0.4366) acc_x 96.8750 (90.6250) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [15/29] time 0.415 (0.422) data 0.289 (0.300) loss_x loss_x 0.7168 (0.4661) acc_x 71.8750 (88.5417) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [20/29] time 0.417 (0.419) data 0.292 (0.296) loss_x loss_x 0.5991 (0.4736) acc_x 78.1250 (87.9688) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/29] time 0.413 (0.417) data 0.285 (0.293) loss_x loss_x 0.4917 (0.4627) acc_x 87.5000 (88.3750) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [5/21] time 0.407 (0.410) data 0.276 (0.287) loss_u loss_u 0.8638 (0.8773) acc_u 21.8750 (17.5000) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [10/21] time 0.402 (0.408) data 0.273 (0.284) loss_u loss_u 0.9321 (0.8788) acc_u 9.3750 (16.2500) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [15/21] time 0.345 (0.408) data 0.220 (0.284) loss_u loss_u 0.8140 (0.8732) acc_u 21.8750 (16.0417) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/21] time 0.401 (0.404) data 0.273 (0.279) loss_u loss_u 0.8804 (0.8732) acc_u 15.6250 (15.7812) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 387
confident_label rate tensor(0.5839, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 953
clean true:951
clean false:2
clean_rate:0.9979013641133263
noisy true:294
noisy false:385
after delete: len(clean_dataset) 953
after delete: len(noisy_dataset) 679
epoch [30/200] batch [5/29] time 0.388 (0.419) data 0.266 (0.304) loss_x loss_x 0.5898 (0.4611) acc_x 87.5000 (88.7500) lr 1.9048e-03 eta 0:00:10
epoch [30/200] batch [10/29] time 0.403 (0.416) data 0.277 (0.296) loss_x loss_x 0.2622 (0.4011) acc_x 96.8750 (89.3750) lr 1.9048e-03 eta 0:00:07
epoch [30/200] batch [15/29] time 0.416 (0.409) data 0.290 (0.288) loss_x loss_x 0.1582 (0.3842) acc_x 100.0000 (90.0000) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [20/29] time 0.346 (0.400) data 0.222 (0.278) loss_x loss_x 0.2683 (0.4267) acc_x 90.6250 (89.0625) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [25/29] time 0.356 (0.397) data 0.278 (0.275) loss_x loss_x 0.3030 (0.4307) acc_x 90.6250 (89.3750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [5/21] time 0.406 (0.397) data 0.276 (0.274) loss_u loss_u 0.9175 (0.8992) acc_u 9.3750 (13.1250) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [10/21] time 0.400 (0.397) data 0.275 (0.274) loss_u loss_u 0.7930 (0.8777) acc_u 21.8750 (14.3750) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/21] time 0.378 (0.397) data 0.252 (0.273) loss_u loss_u 0.8608 (0.8863) acc_u 18.7500 (13.3333) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/21] time 0.409 (0.398) data 0.282 (0.274) loss_u loss_u 0.8003 (0.8804) acc_u 25.0000 (13.9062) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 414
confident_label rate tensor(0.5558, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 907
clean true:905
clean false:2
clean_rate:0.9977949283351709
noisy true:313
noisy false:412
after delete: len(clean_dataset) 907
after delete: len(noisy_dataset) 725
epoch [31/200] batch [5/28] time 0.420 (0.421) data 0.283 (0.292) loss_x loss_x 0.3870 (0.3636) acc_x 90.6250 (89.3750) lr 1.8980e-03 eta 0:00:09
epoch [31/200] batch [10/28] time 0.409 (0.414) data 0.283 (0.286) loss_x loss_x 0.4570 (0.4597) acc_x 84.3750 (86.8750) lr 1.8980e-03 eta 0:00:07
epoch [31/200] batch [15/28] time 0.404 (0.415) data 0.275 (0.287) loss_x loss_x 0.4905 (0.4699) acc_x 87.5000 (87.0833) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [20/28] time 0.390 (0.411) data 0.264 (0.284) loss_x loss_x 0.6279 (0.5119) acc_x 90.6250 (86.0938) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [25/28] time 0.387 (0.408) data 0.261 (0.281) loss_x loss_x 0.4106 (0.5089) acc_x 87.5000 (86.2500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [5/22] time 0.399 (0.404) data 0.271 (0.279) loss_u loss_u 0.9331 (0.8873) acc_u 9.3750 (15.0000) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [10/22] time 0.380 (0.403) data 0.257 (0.278) loss_u loss_u 0.7637 (0.8698) acc_u 25.0000 (16.2500) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [15/22] time 0.343 (0.400) data 0.217 (0.274) loss_u loss_u 0.8921 (0.8687) acc_u 12.5000 (16.4583) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/22] time 0.342 (0.395) data 0.218 (0.269) loss_u loss_u 0.7686 (0.8542) acc_u 28.1250 (18.2812) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 384
confident_label rate tensor(0.5784, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 944
clean true:943
clean false:1
clean_rate:0.9989406779661016
noisy true:305
noisy false:383
after delete: len(clean_dataset) 944
after delete: len(noisy_dataset) 688
epoch [32/200] batch [5/29] time 0.396 (0.407) data 0.273 (0.279) loss_x loss_x 0.2646 (0.3024) acc_x 93.7500 (92.5000) lr 1.8910e-03 eta 0:00:09
epoch [32/200] batch [10/29] time 0.409 (0.404) data 0.281 (0.276) loss_x loss_x 0.2729 (0.3620) acc_x 93.7500 (91.5625) lr 1.8910e-03 eta 0:00:07
epoch [32/200] batch [15/29] time 0.418 (0.401) data 0.289 (0.274) loss_x loss_x 0.4026 (0.3885) acc_x 84.3750 (90.2083) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [20/29] time 0.398 (0.399) data 0.276 (0.274) loss_x loss_x 0.3621 (0.4187) acc_x 96.8750 (89.3750) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [25/29] time 0.394 (0.398) data 0.272 (0.274) loss_x loss_x 0.4099 (0.4536) acc_x 93.7500 (88.2500) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [5/21] time 0.407 (0.399) data 0.279 (0.274) loss_u loss_u 0.8716 (0.8506) acc_u 15.6250 (16.8750) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [10/21] time 0.363 (0.395) data 0.240 (0.269) loss_u loss_u 0.9248 (0.8741) acc_u 6.2500 (15.3125) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/21] time 0.395 (0.394) data 0.265 (0.269) loss_u loss_u 0.8916 (0.8833) acc_u 15.6250 (14.3750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/21] time 0.398 (0.392) data 0.275 (0.268) loss_u loss_u 0.8638 (0.8702) acc_u 15.6250 (15.9375) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 393
confident_label rate tensor(0.5809, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 948
clean true:947
clean false:1
clean_rate:0.9989451476793249
noisy true:292
noisy false:392
after delete: len(clean_dataset) 948
after delete: len(noisy_dataset) 684
epoch [33/200] batch [5/29] time 0.409 (0.430) data 0.283 (0.305) loss_x loss_x 0.3342 (0.4064) acc_x 93.7500 (91.8750) lr 1.8838e-03 eta 0:00:10
epoch [33/200] batch [10/29] time 0.417 (0.423) data 0.290 (0.297) loss_x loss_x 0.6245 (0.4775) acc_x 87.5000 (88.7500) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [15/29] time 0.430 (0.420) data 0.304 (0.297) loss_x loss_x 0.1617 (0.4518) acc_x 96.8750 (88.5417) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [20/29] time 0.355 (0.405) data 0.229 (0.281) loss_x loss_x 0.2659 (0.4549) acc_x 93.7500 (88.9062) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/29] time 0.385 (0.399) data 0.259 (0.275) loss_x loss_x 0.2271 (0.4438) acc_x 93.7500 (88.7500) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [5/21] time 0.408 (0.401) data 0.279 (0.276) loss_u loss_u 0.9097 (0.8348) acc_u 9.3750 (21.2500) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [10/21] time 0.407 (0.402) data 0.277 (0.276) loss_u loss_u 0.9023 (0.8529) acc_u 12.5000 (19.0625) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/21] time 0.409 (0.404) data 0.277 (0.278) loss_u loss_u 0.8281 (0.8623) acc_u 21.8750 (17.2917) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/21] time 0.349 (0.399) data 0.221 (0.273) loss_u loss_u 0.8955 (0.8693) acc_u 12.5000 (16.0938) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 370
confident_label rate tensor(0.5968, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 974
clean true:969
clean false:5
clean_rate:0.9948665297741273
noisy true:293
noisy false:365
after delete: len(clean_dataset) 974
after delete: len(noisy_dataset) 658
epoch [34/200] batch [5/30] time 0.365 (0.372) data 0.240 (0.247) loss_x loss_x 0.5679 (0.4580) acc_x 81.2500 (87.5000) lr 1.8763e-03 eta 0:00:09
epoch [34/200] batch [10/30] time 0.424 (0.386) data 0.303 (0.261) loss_x loss_x 0.3042 (0.4235) acc_x 90.6250 (89.3750) lr 1.8763e-03 eta 0:00:07
epoch [34/200] batch [15/30] time 0.484 (0.399) data 0.358 (0.274) loss_x loss_x 0.5444 (0.4313) acc_x 87.5000 (89.5833) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [20/30] time 0.415 (0.409) data 0.290 (0.284) loss_x loss_x 0.3105 (0.4703) acc_x 93.7500 (89.0625) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [25/30] time 0.416 (0.411) data 0.294 (0.288) loss_x loss_x 0.7407 (0.4691) acc_x 84.3750 (89.2500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [30/30] time 0.392 (0.414) data 0.268 (0.291) loss_x loss_x 0.2361 (0.4536) acc_x 90.6250 (89.2708) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/20] time 0.488 (0.415) data 0.360 (0.291) loss_u loss_u 0.8193 (0.8688) acc_u 21.8750 (15.6250) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [10/20] time 0.390 (0.416) data 0.268 (0.292) loss_u loss_u 0.8545 (0.8841) acc_u 18.7500 (13.7500) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/20] time 0.429 (0.416) data 0.304 (0.292) loss_u loss_u 0.8809 (0.8863) acc_u 15.6250 (13.3333) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/20] time 0.417 (0.414) data 0.291 (0.290) loss_u loss_u 0.9277 (0.8898) acc_u 9.3750 (12.9688) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.5919, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 966
clean true:966
clean false:0
clean_rate:1.0
noisy true:299
noisy false:367
after delete: len(clean_dataset) 966
after delete: len(noisy_dataset) 666
epoch [35/200] batch [5/30] time 0.408 (0.432) data 0.282 (0.304) loss_x loss_x 0.6572 (0.3954) acc_x 84.3750 (91.8750) lr 1.8686e-03 eta 0:00:10
epoch [35/200] batch [10/30] time 0.418 (0.422) data 0.289 (0.299) loss_x loss_x 0.1919 (0.4268) acc_x 100.0000 (90.9375) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [15/30] time 0.529 (0.417) data 0.402 (0.300) loss_x loss_x 0.5869 (0.4424) acc_x 81.2500 (90.2083) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [20/30] time 0.427 (0.417) data 0.303 (0.298) loss_x loss_x 0.3530 (0.4869) acc_x 93.7500 (89.8438) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [25/30] time 0.434 (0.419) data 0.308 (0.299) loss_x loss_x 0.6904 (0.4647) acc_x 81.2500 (89.8750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [30/30] time 0.440 (0.416) data 0.313 (0.295) loss_x loss_x 0.4138 (0.4429) acc_x 90.6250 (90.6250) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/20] time 0.346 (0.410) data 0.216 (0.288) loss_u loss_u 0.8628 (0.8591) acc_u 15.6250 (16.2500) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [10/20] time 0.416 (0.407) data 0.289 (0.284) loss_u loss_u 0.9194 (0.8783) acc_u 12.5000 (14.6875) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/20] time 0.362 (0.404) data 0.235 (0.280) loss_u loss_u 0.8569 (0.8781) acc_u 15.6250 (14.3750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/20] time 0.377 (0.401) data 0.247 (0.277) loss_u loss_u 0.8384 (0.8738) acc_u 21.8750 (15.4688) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 366
confident_label rate tensor(0.5895, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 962
clean true:960
clean false:2
clean_rate:0.997920997920998
noisy true:306
noisy false:364
after delete: len(clean_dataset) 962
after delete: len(noisy_dataset) 670
epoch [36/200] batch [5/30] time 0.382 (0.386) data 0.257 (0.270) loss_x loss_x 0.2971 (0.3561) acc_x 93.7500 (93.1250) lr 1.8607e-03 eta 0:00:09
epoch [36/200] batch [10/30] time 0.410 (0.395) data 0.284 (0.274) loss_x loss_x 0.3577 (0.3988) acc_x 90.6250 (91.5625) lr 1.8607e-03 eta 0:00:07
epoch [36/200] batch [15/30] time 0.405 (0.399) data 0.281 (0.277) loss_x loss_x 0.4282 (0.3813) acc_x 93.7500 (91.2500) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [20/30] time 0.347 (0.397) data 0.219 (0.274) loss_x loss_x 0.5303 (0.3878) acc_x 87.5000 (91.2500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [25/30] time 0.415 (0.393) data 0.288 (0.269) loss_x loss_x 0.4094 (0.3990) acc_x 81.2500 (90.3750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [30/30] time 0.388 (0.396) data 0.261 (0.271) loss_x loss_x 0.2245 (0.3997) acc_x 100.0000 (90.5208) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/20] time 0.379 (0.398) data 0.248 (0.273) loss_u loss_u 0.7573 (0.8498) acc_u 34.3750 (18.1250) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/20] time 0.414 (0.398) data 0.283 (0.273) loss_u loss_u 0.8311 (0.8646) acc_u 18.7500 (16.2500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [15/20] time 0.411 (0.398) data 0.282 (0.273) loss_u loss_u 0.9160 (0.8713) acc_u 9.3750 (15.0000) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/20] time 0.403 (0.398) data 0.278 (0.273) loss_u loss_u 0.9385 (0.8659) acc_u 9.3750 (15.9375) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 385
confident_label rate tensor(0.5839, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 953
clean true:950
clean false:3
clean_rate:0.9968520461699895
noisy true:297
noisy false:382
after delete: len(clean_dataset) 953
after delete: len(noisy_dataset) 679
epoch [37/200] batch [5/29] time 0.361 (0.381) data 0.236 (0.257) loss_x loss_x 0.6099 (0.3767) acc_x 84.3750 (90.6250) lr 1.8526e-03 eta 0:00:09
epoch [37/200] batch [10/29] time 0.428 (0.389) data 0.306 (0.265) loss_x loss_x 0.5054 (0.4308) acc_x 90.6250 (90.6250) lr 1.8526e-03 eta 0:00:07
epoch [37/200] batch [15/29] time 0.418 (0.403) data 0.294 (0.278) loss_x loss_x 0.2216 (0.4314) acc_x 93.7500 (89.7917) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [20/29] time 0.392 (0.403) data 0.268 (0.276) loss_x loss_x 0.3213 (0.4222) acc_x 90.6250 (90.0000) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [25/29] time 0.416 (0.404) data 0.289 (0.277) loss_x loss_x 0.2654 (0.4173) acc_x 93.7500 (90.5000) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [5/21] time 0.433 (0.413) data 0.303 (0.287) loss_u loss_u 0.9180 (0.8972) acc_u 9.3750 (13.1250) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [10/21] time 0.436 (0.417) data 0.307 (0.291) loss_u loss_u 0.7739 (0.8662) acc_u 25.0000 (16.5625) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/21] time 0.364 (0.416) data 0.233 (0.289) loss_u loss_u 0.8647 (0.8489) acc_u 15.6250 (17.9167) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/21] time 0.295 (0.409) data 0.216 (0.283) loss_u loss_u 0.8887 (0.8526) acc_u 15.6250 (18.1250) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 364
confident_label rate tensor(0.5876, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 959
clean true:958
clean false:1
clean_rate:0.9989572471324296
noisy true:310
noisy false:363
after delete: len(clean_dataset) 959
after delete: len(noisy_dataset) 673
epoch [38/200] batch [5/29] time 0.430 (0.411) data 0.303 (0.285) loss_x loss_x 0.3557 (0.3640) acc_x 90.6250 (90.6250) lr 1.8443e-03 eta 0:00:09
epoch [38/200] batch [10/29] time 0.448 (0.425) data 0.323 (0.300) loss_x loss_x 0.8804 (0.4329) acc_x 87.5000 (90.0000) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [15/29] time 0.429 (0.428) data 0.304 (0.302) loss_x loss_x 0.9614 (0.4439) acc_x 84.3750 (90.4167) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [20/29] time 0.436 (0.422) data 0.313 (0.299) loss_x loss_x 0.2452 (0.4252) acc_x 96.8750 (90.7812) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/29] time 0.412 (0.426) data 0.286 (0.302) loss_x loss_x 0.5542 (0.4099) acc_x 81.2500 (91.1250) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [5/21] time 0.400 (0.422) data 0.275 (0.297) loss_u loss_u 0.8672 (0.8467) acc_u 15.6250 (16.8750) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [10/21] time 0.410 (0.424) data 0.285 (0.299) loss_u loss_u 0.8091 (0.8504) acc_u 28.1250 (17.1875) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/21] time 0.399 (0.426) data 0.272 (0.300) loss_u loss_u 0.8481 (0.8533) acc_u 18.7500 (17.2917) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/21] time 0.389 (0.422) data 0.264 (0.297) loss_u loss_u 0.8896 (0.8552) acc_u 12.5000 (16.8750) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 360
confident_label rate tensor(0.5974, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 975
clean true:974
clean false:1
clean_rate:0.9989743589743589
noisy true:298
noisy false:359
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 657
epoch [39/200] batch [5/30] time 0.393 (0.406) data 0.267 (0.281) loss_x loss_x 0.4341 (0.4432) acc_x 93.7500 (91.2500) lr 1.8358e-03 eta 0:00:10
epoch [39/200] batch [10/30] time 0.398 (0.405) data 0.266 (0.280) loss_x loss_x 0.4973 (0.4325) acc_x 84.3750 (90.3125) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [15/30] time 0.342 (0.397) data 0.216 (0.271) loss_x loss_x 0.6362 (0.4279) acc_x 84.3750 (89.7917) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [20/30] time 0.411 (0.403) data 0.281 (0.277) loss_x loss_x 0.4504 (0.4436) acc_x 87.5000 (89.8438) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [25/30] time 0.417 (0.408) data 0.289 (0.282) loss_x loss_x 0.2629 (0.4390) acc_x 93.7500 (89.5000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [30/30] time 0.429 (0.407) data 0.301 (0.281) loss_x loss_x 0.3987 (0.4387) acc_x 87.5000 (89.3750) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/20] time 0.381 (0.408) data 0.256 (0.283) loss_u loss_u 0.8936 (0.9213) acc_u 18.7500 (10.6250) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [10/20] time 0.404 (0.405) data 0.280 (0.280) loss_u loss_u 0.8477 (0.8959) acc_u 15.6250 (13.4375) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/20] time 0.404 (0.405) data 0.279 (0.281) loss_u loss_u 0.8677 (0.8893) acc_u 15.6250 (13.5417) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [20/20] time 0.397 (0.405) data 0.270 (0.280) loss_u loss_u 0.9038 (0.8886) acc_u 12.5000 (13.9062) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 346
confident_label rate tensor(0.5999, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 979
clean true:977
clean false:2
clean_rate:0.9979570990806946
noisy true:309
noisy false:344
after delete: len(clean_dataset) 979
after delete: len(noisy_dataset) 653
epoch [40/200] batch [5/30] time 0.401 (0.396) data 0.275 (0.270) loss_x loss_x 0.8037 (0.5065) acc_x 87.5000 (88.7500) lr 1.8271e-03 eta 0:00:09
epoch [40/200] batch [10/30] time 0.435 (0.419) data 0.308 (0.292) loss_x loss_x 0.7212 (0.4809) acc_x 78.1250 (88.4375) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [15/30] time 0.439 (0.429) data 0.312 (0.302) loss_x loss_x 0.4946 (0.4740) acc_x 90.6250 (88.9583) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [20/30] time 0.401 (0.433) data 0.272 (0.307) loss_x loss_x 0.6602 (0.5050) acc_x 84.3750 (87.6562) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [25/30] time 0.398 (0.425) data 0.271 (0.299) loss_x loss_x 0.3491 (0.4928) acc_x 93.7500 (88.0000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [30/30] time 0.388 (0.422) data 0.265 (0.296) loss_x loss_x 0.2817 (0.4833) acc_x 93.7500 (87.7083) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/20] time 0.442 (0.421) data 0.314 (0.295) loss_u loss_u 0.8999 (0.8686) acc_u 12.5000 (14.3750) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [10/20] time 0.451 (0.421) data 0.324 (0.295) loss_u loss_u 0.8882 (0.8808) acc_u 12.5000 (13.4375) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/20] time 0.359 (0.417) data 0.231 (0.291) loss_u loss_u 0.9346 (0.8801) acc_u 6.2500 (13.5417) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [20/20] time 0.410 (0.417) data 0.282 (0.290) loss_u loss_u 0.8320 (0.8779) acc_u 18.7500 (13.7500) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 341
confident_label rate tensor(0.6029, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 984
clean true:983
clean false:1
clean_rate:0.9989837398373984
noisy true:308
noisy false:340
after delete: len(clean_dataset) 984
after delete: len(noisy_dataset) 648
epoch [41/200] batch [5/30] time 0.329 (0.381) data 0.249 (0.266) loss_x loss_x 0.4812 (0.4121) acc_x 87.5000 (90.0000) lr 1.8181e-03 eta 0:00:09
epoch [41/200] batch [10/30] time 0.403 (0.386) data 0.278 (0.266) loss_x loss_x 0.6069 (0.4138) acc_x 87.5000 (90.6250) lr 1.8181e-03 eta 0:00:07
epoch [41/200] batch [15/30] time 0.419 (0.394) data 0.292 (0.273) loss_x loss_x 0.3813 (0.4024) acc_x 90.6250 (90.6250) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [20/30] time 0.355 (0.397) data 0.229 (0.275) loss_x loss_x 0.1687 (0.3803) acc_x 96.8750 (91.0938) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [25/30] time 0.405 (0.400) data 0.280 (0.277) loss_x loss_x 0.3481 (0.4027) acc_x 90.6250 (90.6250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [30/30] time 0.412 (0.403) data 0.283 (0.279) loss_x loss_x 0.7656 (0.4143) acc_x 78.1250 (90.0000) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/20] time 0.442 (0.407) data 0.313 (0.283) loss_u loss_u 0.9014 (0.8851) acc_u 9.3750 (12.5000) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [10/20] time 0.497 (0.411) data 0.372 (0.288) loss_u loss_u 0.8501 (0.8794) acc_u 18.7500 (13.4375) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/20] time 0.402 (0.414) data 0.277 (0.290) loss_u loss_u 0.8110 (0.8828) acc_u 21.8750 (13.3333) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/20] time 0.394 (0.414) data 0.268 (0.290) loss_u loss_u 0.7432 (0.8786) acc_u 28.1250 (13.9062) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 357
confident_label rate tensor(0.5956, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 972
clean true:970
clean false:2
clean_rate:0.9979423868312757
noisy true:305
noisy false:355
after delete: len(clean_dataset) 972
after delete: len(noisy_dataset) 660
epoch [42/200] batch [5/30] time 0.416 (0.368) data 0.292 (0.243) loss_x loss_x 0.4104 (0.3813) acc_x 93.7500 (91.8750) lr 1.8090e-03 eta 0:00:09
epoch [42/200] batch [10/30] time 0.391 (0.382) data 0.265 (0.256) loss_x loss_x 0.5713 (0.3939) acc_x 84.3750 (91.5625) lr 1.8090e-03 eta 0:00:07
epoch [42/200] batch [15/30] time 0.413 (0.396) data 0.287 (0.270) loss_x loss_x 0.2062 (0.4157) acc_x 96.8750 (90.4167) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [20/30] time 0.415 (0.400) data 0.289 (0.275) loss_x loss_x 0.2734 (0.4388) acc_x 93.7500 (89.2188) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [25/30] time 0.410 (0.401) data 0.284 (0.277) loss_x loss_x 0.3396 (0.3970) acc_x 93.7500 (90.6250) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [30/30] time 0.401 (0.402) data 0.277 (0.278) loss_x loss_x 0.5454 (0.4009) acc_x 84.3750 (90.4167) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/20] time 0.392 (0.406) data 0.264 (0.281) loss_u loss_u 0.9248 (0.8841) acc_u 9.3750 (13.1250) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [10/20] time 0.400 (0.408) data 0.273 (0.283) loss_u loss_u 0.8462 (0.8853) acc_u 18.7500 (12.8125) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/20] time 0.403 (0.406) data 0.276 (0.281) loss_u loss_u 0.8848 (0.8828) acc_u 15.6250 (13.5417) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/20] time 0.354 (0.402) data 0.231 (0.277) loss_u loss_u 0.8296 (0.8739) acc_u 21.8750 (14.6875) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 359
confident_label rate tensor(0.5956, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 972
clean true:970
clean false:2
clean_rate:0.9979423868312757
noisy true:303
noisy false:357
after delete: len(clean_dataset) 972
after delete: len(noisy_dataset) 660
epoch [43/200] batch [5/30] time 0.399 (0.400) data 0.271 (0.274) loss_x loss_x 0.6841 (0.4385) acc_x 84.3750 (87.5000) lr 1.7997e-03 eta 0:00:09
epoch [43/200] batch [10/30] time 0.409 (0.400) data 0.282 (0.273) loss_x loss_x 0.5107 (0.3818) acc_x 84.3750 (90.3125) lr 1.7997e-03 eta 0:00:07
epoch [43/200] batch [15/30] time 0.389 (0.402) data 0.262 (0.275) loss_x loss_x 0.2517 (0.3932) acc_x 93.7500 (90.4167) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [20/30] time 0.423 (0.405) data 0.294 (0.279) loss_x loss_x 0.3066 (0.4017) acc_x 93.7500 (89.8438) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [25/30] time 0.413 (0.403) data 0.291 (0.278) loss_x loss_x 0.3462 (0.3996) acc_x 93.7500 (90.0000) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [30/30] time 0.353 (0.401) data 0.225 (0.275) loss_x loss_x 0.3779 (0.4071) acc_x 90.6250 (89.6875) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/20] time 0.403 (0.398) data 0.277 (0.272) loss_u loss_u 0.8911 (0.8755) acc_u 15.6250 (15.0000) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/20] time 0.407 (0.398) data 0.280 (0.272) loss_u loss_u 0.7031 (0.8672) acc_u 37.5000 (15.9375) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/20] time 0.405 (0.398) data 0.276 (0.272) loss_u loss_u 0.9229 (0.8736) acc_u 12.5000 (15.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/20] time 0.415 (0.400) data 0.285 (0.275) loss_u loss_u 0.9531 (0.8740) acc_u 6.2500 (15.3125) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 331
confident_label rate tensor(0.6085, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 993
clean true:990
clean false:3
clean_rate:0.9969788519637462
noisy true:311
noisy false:328
after delete: len(clean_dataset) 993
after delete: len(noisy_dataset) 639
epoch [44/200] batch [5/31] time 0.400 (0.408) data 0.275 (0.283) loss_x loss_x 0.7720 (0.5314) acc_x 84.3750 (90.0000) lr 1.7902e-03 eta 0:00:10
epoch [44/200] batch [10/31] time 0.359 (0.395) data 0.234 (0.270) loss_x loss_x 0.4487 (0.4969) acc_x 90.6250 (89.6875) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [15/31] time 0.408 (0.381) data 0.282 (0.262) loss_x loss_x 0.1216 (0.4197) acc_x 100.0000 (91.6667) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [20/31] time 0.404 (0.387) data 0.278 (0.266) loss_x loss_x 0.4502 (0.4217) acc_x 87.5000 (91.2500) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [25/31] time 0.419 (0.391) data 0.290 (0.269) loss_x loss_x 0.3770 (0.4019) acc_x 90.6250 (91.3750) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [30/31] time 0.412 (0.394) data 0.286 (0.272) loss_x loss_x 0.4395 (0.4013) acc_x 93.7500 (91.3542) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/19] time 0.373 (0.395) data 0.295 (0.272) loss_u loss_u 0.8877 (0.8604) acc_u 12.5000 (15.6250) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/19] time 0.479 (0.398) data 0.348 (0.274) loss_u loss_u 0.8120 (0.8594) acc_u 21.8750 (16.5625) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/19] time 0.408 (0.398) data 0.281 (0.274) loss_u loss_u 0.8413 (0.8700) acc_u 21.8750 (16.0417) lr 1.7902e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.5901, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 963
clean true:962
clean false:1
clean_rate:0.9989615784008308
noisy true:303
noisy false:366
after delete: len(clean_dataset) 963
after delete: len(noisy_dataset) 669
epoch [45/200] batch [5/30] time 0.449 (0.407) data 0.322 (0.283) loss_x loss_x 0.5327 (0.4981) acc_x 81.2500 (86.8750) lr 1.7804e-03 eta 0:00:10
epoch [45/200] batch [10/30] time 0.408 (0.414) data 0.282 (0.289) loss_x loss_x 0.4839 (0.4403) acc_x 90.6250 (88.7500) lr 1.7804e-03 eta 0:00:08
epoch [45/200] batch [15/30] time 0.410 (0.407) data 0.284 (0.282) loss_x loss_x 0.4409 (0.4311) acc_x 87.5000 (89.1667) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [20/30] time 0.399 (0.410) data 0.273 (0.284) loss_x loss_x 0.3054 (0.4113) acc_x 90.6250 (89.3750) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [25/30] time 0.425 (0.412) data 0.297 (0.285) loss_x loss_x 0.2676 (0.4108) acc_x 93.7500 (89.5000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [30/30] time 0.379 (0.408) data 0.254 (0.283) loss_x loss_x 0.4697 (0.4097) acc_x 84.3750 (89.2708) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/20] time 0.380 (0.405) data 0.254 (0.280) loss_u loss_u 0.8003 (0.8326) acc_u 18.7500 (18.7500) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [10/20] time 0.396 (0.405) data 0.270 (0.280) loss_u loss_u 0.8374 (0.8531) acc_u 21.8750 (18.1250) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/20] time 0.344 (0.400) data 0.219 (0.275) loss_u loss_u 0.8286 (0.8549) acc_u 18.7500 (17.7083) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/20] time 0.411 (0.399) data 0.284 (0.273) loss_u loss_u 0.8350 (0.8493) acc_u 18.7500 (18.1250) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 327
confident_label rate tensor(0.6127, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1000
clean true:999
clean false:1
clean_rate:0.999
noisy true:306
noisy false:326
after delete: len(clean_dataset) 1000
after delete: len(noisy_dataset) 632
epoch [46/200] batch [5/31] time 0.498 (0.465) data 0.375 (0.349) loss_x loss_x 0.6738 (0.4112) acc_x 84.3750 (90.6250) lr 1.7705e-03 eta 0:00:12
epoch [46/200] batch [10/31] time 0.413 (0.446) data 0.288 (0.326) loss_x loss_x 0.4531 (0.4652) acc_x 84.3750 (88.7500) lr 1.7705e-03 eta 0:00:09
epoch [46/200] batch [15/31] time 0.390 (0.435) data 0.267 (0.313) loss_x loss_x 0.6699 (0.4662) acc_x 84.3750 (88.5417) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [20/31] time 0.402 (0.424) data 0.277 (0.302) loss_x loss_x 0.2429 (0.4433) acc_x 93.7500 (88.5938) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [25/31] time 0.293 (0.413) data 0.215 (0.292) loss_x loss_x 0.4192 (0.4460) acc_x 84.3750 (88.5000) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/31] time 0.418 (0.412) data 0.292 (0.289) loss_x loss_x 0.5664 (0.4323) acc_x 84.3750 (88.6458) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/19] time 0.415 (0.415) data 0.287 (0.291) loss_u loss_u 0.9351 (0.8756) acc_u 9.3750 (15.6250) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/19] time 0.498 (0.418) data 0.371 (0.294) loss_u loss_u 0.8975 (0.8750) acc_u 12.5000 (15.6250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/19] time 0.382 (0.419) data 0.256 (0.295) loss_u loss_u 0.8979 (0.8758) acc_u 15.6250 (15.2083) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 333
confident_label rate tensor(0.6060, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 989
clean true:987
clean false:2
clean_rate:0.9979777553083923
noisy true:312
noisy false:331
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 643
epoch [47/200] batch [5/30] time 0.397 (0.406) data 0.270 (0.281) loss_x loss_x 0.2452 (0.3091) acc_x 96.8750 (93.7500) lr 1.7604e-03 eta 0:00:10
epoch [47/200] batch [10/30] time 0.370 (0.391) data 0.245 (0.266) loss_x loss_x 0.3115 (0.3620) acc_x 90.6250 (91.2500) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [15/30] time 0.374 (0.387) data 0.247 (0.265) loss_x loss_x 0.2803 (0.3352) acc_x 90.6250 (92.0833) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [20/30] time 0.395 (0.393) data 0.268 (0.269) loss_x loss_x 0.3223 (0.3717) acc_x 90.6250 (91.8750) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/30] time 0.370 (0.391) data 0.244 (0.267) loss_x loss_x 0.5337 (0.3714) acc_x 81.2500 (91.5000) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/30] time 0.474 (0.397) data 0.351 (0.273) loss_x loss_x 0.3560 (0.3595) acc_x 87.5000 (91.9792) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/20] time 0.388 (0.398) data 0.263 (0.273) loss_u loss_u 0.7905 (0.8819) acc_u 21.8750 (15.6250) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/20] time 0.424 (0.398) data 0.298 (0.272) loss_u loss_u 0.8218 (0.8587) acc_u 18.7500 (17.1875) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/20] time 0.383 (0.398) data 0.258 (0.273) loss_u loss_u 0.8872 (0.8646) acc_u 12.5000 (16.6667) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/20] time 0.404 (0.399) data 0.278 (0.274) loss_u loss_u 0.9453 (0.8748) acc_u 6.2500 (15.4688) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 333
confident_label rate tensor(0.6054, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 988
clean true:987
clean false:1
clean_rate:0.9989878542510121
noisy true:312
noisy false:332
after delete: len(clean_dataset) 988
after delete: len(noisy_dataset) 644
epoch [48/200] batch [5/30] time 0.411 (0.418) data 0.285 (0.292) loss_x loss_x 0.3254 (0.3105) acc_x 93.7500 (93.7500) lr 1.7501e-03 eta 0:00:10
epoch [48/200] batch [10/30] time 0.453 (0.431) data 0.327 (0.305) loss_x loss_x 0.5317 (0.3343) acc_x 96.8750 (94.0625) lr 1.7501e-03 eta 0:00:08
epoch [48/200] batch [15/30] time 0.387 (0.421) data 0.260 (0.295) loss_x loss_x 0.6851 (0.3594) acc_x 90.6250 (93.1250) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [20/30] time 0.382 (0.414) data 0.303 (0.290) loss_x loss_x 0.5010 (0.3988) acc_x 84.3750 (90.9375) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [25/30] time 0.372 (0.413) data 0.250 (0.289) loss_x loss_x 0.4766 (0.4063) acc_x 93.7500 (91.0000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [30/30] time 0.430 (0.414) data 0.306 (0.289) loss_x loss_x 0.3826 (0.3939) acc_x 96.8750 (91.2500) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/20] time 0.409 (0.414) data 0.282 (0.288) loss_u loss_u 0.9175 (0.8685) acc_u 9.3750 (15.0000) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [10/20] time 0.353 (0.408) data 0.225 (0.282) loss_u loss_u 0.8613 (0.8773) acc_u 15.6250 (14.3750) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/20] time 0.388 (0.403) data 0.262 (0.278) loss_u loss_u 0.7539 (0.8710) acc_u 31.2500 (14.7917) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/20] time 0.442 (0.403) data 0.316 (0.278) loss_u loss_u 0.8760 (0.8730) acc_u 12.5000 (14.8438) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 349
confident_label rate tensor(0.5993, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 978
clean true:976
clean false:2
clean_rate:0.9979550102249489
noisy true:307
noisy false:347
after delete: len(clean_dataset) 978
after delete: len(noisy_dataset) 654
epoch [49/200] batch [5/30] time 0.329 (0.426) data 0.252 (0.311) loss_x loss_x 0.3181 (0.3540) acc_x 90.6250 (91.8750) lr 1.7396e-03 eta 0:00:10
epoch [49/200] batch [10/30] time 0.422 (0.447) data 0.296 (0.327) loss_x loss_x 0.3472 (0.2904) acc_x 87.5000 (94.3750) lr 1.7396e-03 eta 0:00:08
epoch [49/200] batch [15/30] time 0.400 (0.442) data 0.274 (0.320) loss_x loss_x 0.6504 (0.3235) acc_x 87.5000 (93.5417) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [20/30] time 0.355 (0.431) data 0.228 (0.308) loss_x loss_x 0.3987 (0.3711) acc_x 90.6250 (92.0312) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [25/30] time 0.391 (0.418) data 0.263 (0.294) loss_x loss_x 0.3411 (0.3523) acc_x 87.5000 (92.2500) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [30/30] time 0.438 (0.414) data 0.312 (0.289) loss_x loss_x 0.2488 (0.3531) acc_x 96.8750 (92.2917) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/20] time 0.424 (0.414) data 0.297 (0.290) loss_u loss_u 0.7183 (0.8258) acc_u 31.2500 (21.2500) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [10/20] time 0.447 (0.417) data 0.323 (0.294) loss_u loss_u 0.9277 (0.8538) acc_u 6.2500 (17.1875) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/20] time 0.429 (0.419) data 0.303 (0.296) loss_u loss_u 0.9419 (0.8611) acc_u 6.2500 (16.0417) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/20] time 0.422 (0.419) data 0.296 (0.295) loss_u loss_u 0.8931 (0.8623) acc_u 15.6250 (16.4062) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 317
confident_label rate tensor(0.6134, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1001
clean true:999
clean false:2
clean_rate:0.998001998001998
noisy true:316
noisy false:315
after delete: len(clean_dataset) 1001
after delete: len(noisy_dataset) 631
epoch [50/200] batch [5/31] time 0.350 (0.381) data 0.223 (0.254) loss_x loss_x 0.4297 (0.3599) acc_x 93.7500 (91.8750) lr 1.7290e-03 eta 0:00:09
epoch [50/200] batch [10/31] time 0.413 (0.388) data 0.288 (0.267) loss_x loss_x 0.2705 (0.3397) acc_x 93.7500 (93.1250) lr 1.7290e-03 eta 0:00:08
epoch [50/200] batch [15/31] time 0.413 (0.399) data 0.288 (0.277) loss_x loss_x 0.3430 (0.3283) acc_x 90.6250 (93.3333) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [20/31] time 0.453 (0.405) data 0.328 (0.282) loss_x loss_x 0.3027 (0.3374) acc_x 93.7500 (92.9688) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [25/31] time 0.384 (0.407) data 0.261 (0.284) loss_x loss_x 0.5635 (0.3592) acc_x 93.7500 (92.0000) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [30/31] time 0.365 (0.400) data 0.240 (0.277) loss_x loss_x 0.5005 (0.3595) acc_x 84.3750 (91.8750) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/19] time 0.405 (0.400) data 0.279 (0.276) loss_u loss_u 0.8135 (0.8603) acc_u 21.8750 (17.5000) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/19] time 0.365 (0.399) data 0.239 (0.275) loss_u loss_u 0.9595 (0.8762) acc_u 6.2500 (15.0000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/19] time 0.402 (0.398) data 0.274 (0.274) loss_u loss_u 0.9546 (0.8762) acc_u 6.2500 (15.0000) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 313
confident_label rate tensor(0.6146, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1003
clean true:1001
clean false:2
clean_rate:0.9980059820538385
noisy true:318
noisy false:311
after delete: len(clean_dataset) 1003
after delete: len(noisy_dataset) 629
epoch [51/200] batch [5/31] time 0.422 (0.457) data 0.297 (0.331) loss_x loss_x 0.4839 (0.3897) acc_x 87.5000 (90.6250) lr 1.7181e-03 eta 0:00:11
epoch [51/200] batch [10/31] time 0.414 (0.453) data 0.290 (0.327) loss_x loss_x 0.6577 (0.4075) acc_x 87.5000 (91.2500) lr 1.7181e-03 eta 0:00:09
epoch [51/200] batch [15/31] time 0.424 (0.444) data 0.298 (0.318) loss_x loss_x 0.2510 (0.3784) acc_x 96.8750 (91.8750) lr 1.7181e-03 eta 0:00:07
epoch [51/200] batch [20/31] time 0.455 (0.437) data 0.329 (0.314) loss_x loss_x 0.2988 (0.4034) acc_x 93.7500 (91.2500) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [25/31] time 0.422 (0.437) data 0.259 (0.314) loss_x loss_x 0.2788 (0.3874) acc_x 93.7500 (91.5000) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [30/31] time 0.390 (0.429) data 0.267 (0.306) loss_x loss_x 0.2363 (0.3778) acc_x 100.0000 (91.4583) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/19] time 0.402 (0.421) data 0.275 (0.297) loss_u loss_u 0.8696 (0.8957) acc_u 12.5000 (12.5000) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/19] time 0.387 (0.420) data 0.259 (0.295) loss_u loss_u 0.8857 (0.8835) acc_u 15.6250 (14.6875) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/19] time 0.382 (0.417) data 0.258 (0.292) loss_u loss_u 0.9307 (0.8765) acc_u 9.3750 (15.4167) lr 1.7181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 335
confident_label rate tensor(0.6085, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 993
clean true:991
clean false:2
clean_rate:0.9979859013091642
noisy true:306
noisy false:333
after delete: len(clean_dataset) 993
after delete: len(noisy_dataset) 639
epoch [52/200] batch [5/31] time 0.431 (0.416) data 0.302 (0.289) loss_x loss_x 0.2551 (0.3827) acc_x 90.6250 (89.3750) lr 1.7071e-03 eta 0:00:10
epoch [52/200] batch [10/31] time 0.347 (0.402) data 0.270 (0.280) loss_x loss_x 0.2788 (0.4766) acc_x 93.7500 (88.1250) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [15/31] time 0.344 (0.399) data 0.219 (0.276) loss_x loss_x 0.4907 (0.4774) acc_x 87.5000 (87.5000) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [20/31] time 0.360 (0.388) data 0.236 (0.264) loss_x loss_x 0.3647 (0.4778) acc_x 93.7500 (87.9688) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [25/31] time 0.385 (0.389) data 0.259 (0.265) loss_x loss_x 0.3059 (0.4626) acc_x 96.8750 (88.5000) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/31] time 0.344 (0.389) data 0.266 (0.267) loss_x loss_x 0.2380 (0.4369) acc_x 93.7500 (89.1667) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/19] time 0.412 (0.392) data 0.285 (0.269) loss_u loss_u 0.8857 (0.8534) acc_u 15.6250 (18.7500) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [10/19] time 0.395 (0.394) data 0.268 (0.270) loss_u loss_u 0.8652 (0.8516) acc_u 12.5000 (18.1250) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/19] time 0.398 (0.393) data 0.273 (0.270) loss_u loss_u 0.9590 (0.8676) acc_u 6.2500 (16.4583) lr 1.7071e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 316
confident_label rate tensor(0.6158, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1005
clean true:1004
clean false:1
clean_rate:0.9990049751243781
noisy true:312
noisy false:315
after delete: len(clean_dataset) 1005
after delete: len(noisy_dataset) 627
epoch [53/200] batch [5/31] time 0.393 (0.378) data 0.267 (0.253) loss_x loss_x 0.4602 (0.4858) acc_x 90.6250 (88.7500) lr 1.6959e-03 eta 0:00:09
epoch [53/200] batch [10/31] time 0.388 (0.383) data 0.264 (0.262) loss_x loss_x 0.2422 (0.3952) acc_x 96.8750 (91.8750) lr 1.6959e-03 eta 0:00:08
epoch [53/200] batch [15/31] time 0.404 (0.390) data 0.280 (0.268) loss_x loss_x 0.3574 (0.3892) acc_x 87.5000 (91.0417) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [20/31] time 0.394 (0.392) data 0.269 (0.270) loss_x loss_x 0.6650 (0.3991) acc_x 84.3750 (90.6250) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [25/31] time 0.348 (0.393) data 0.270 (0.272) loss_x loss_x 0.3013 (0.3748) acc_x 93.7500 (91.0000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [30/31] time 0.414 (0.394) data 0.287 (0.273) loss_x loss_x 0.2452 (0.3591) acc_x 90.6250 (91.4583) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/19] time 0.363 (0.396) data 0.237 (0.274) loss_u loss_u 0.8613 (0.8100) acc_u 18.7500 (21.8750) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/19] time 0.411 (0.397) data 0.285 (0.274) loss_u loss_u 0.9229 (0.8594) acc_u 9.3750 (15.9375) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/19] time 0.352 (0.396) data 0.225 (0.273) loss_u loss_u 0.9688 (0.8772) acc_u 3.1250 (13.5417) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 318
confident_label rate tensor(0.6127, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1000
clean true:999
clean false:1
clean_rate:0.999
noisy true:315
noisy false:317
after delete: len(clean_dataset) 1000
after delete: len(noisy_dataset) 632
epoch [54/200] batch [5/31] time 0.422 (0.404) data 0.297 (0.271) loss_x loss_x 0.4519 (0.3953) acc_x 84.3750 (89.3750) lr 1.6845e-03 eta 0:00:10
epoch [54/200] batch [10/31] time 0.405 (0.404) data 0.280 (0.275) loss_x loss_x 0.4863 (0.4222) acc_x 87.5000 (88.7500) lr 1.6845e-03 eta 0:00:08
epoch [54/200] batch [15/31] time 0.406 (0.402) data 0.282 (0.275) loss_x loss_x 0.1403 (0.4000) acc_x 100.0000 (90.0000) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [20/31] time 0.398 (0.400) data 0.272 (0.273) loss_x loss_x 0.3062 (0.4025) acc_x 93.7500 (89.5312) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [25/31] time 0.398 (0.399) data 0.272 (0.273) loss_x loss_x 0.2361 (0.4088) acc_x 96.8750 (89.5000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [30/31] time 0.344 (0.395) data 0.217 (0.269) loss_x loss_x 0.3889 (0.4187) acc_x 93.7500 (89.4792) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/19] time 0.396 (0.390) data 0.267 (0.265) loss_u loss_u 0.9033 (0.9022) acc_u 12.5000 (12.5000) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [10/19] time 0.383 (0.390) data 0.256 (0.265) loss_u loss_u 0.8579 (0.8875) acc_u 15.6250 (13.7500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/19] time 0.371 (0.391) data 0.245 (0.265) loss_u loss_u 0.8667 (0.8862) acc_u 15.6250 (13.9583) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 318
confident_label rate tensor(0.6195, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1011
clean true:1009
clean false:2
clean_rate:0.9980217606330366
noisy true:305
noisy false:316
after delete: len(clean_dataset) 1011
after delete: len(noisy_dataset) 621
epoch [55/200] batch [5/31] time 0.435 (0.428) data 0.309 (0.303) loss_x loss_x 0.3352 (0.3172) acc_x 93.7500 (91.8750) lr 1.6730e-03 eta 0:00:11
epoch [55/200] batch [10/31] time 0.421 (0.429) data 0.293 (0.303) loss_x loss_x 0.5518 (0.3788) acc_x 90.6250 (90.6250) lr 1.6730e-03 eta 0:00:09
epoch [55/200] batch [15/31] time 0.351 (0.409) data 0.225 (0.283) loss_x loss_x 0.6577 (0.3664) acc_x 81.2500 (90.8333) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [20/31] time 0.408 (0.411) data 0.283 (0.284) loss_x loss_x 0.2299 (0.3600) acc_x 96.8750 (91.0938) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [25/31] time 0.464 (0.417) data 0.340 (0.292) loss_x loss_x 0.3035 (0.3715) acc_x 90.6250 (91.1250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [30/31] time 0.379 (0.418) data 0.256 (0.293) loss_x loss_x 0.4807 (0.3837) acc_x 87.5000 (90.8333) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/19] time 0.402 (0.414) data 0.277 (0.289) loss_u loss_u 0.9512 (0.8876) acc_u 6.2500 (13.7500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/19] time 0.402 (0.412) data 0.275 (0.287) loss_u loss_u 0.8301 (0.8846) acc_u 18.7500 (13.7500) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/19] time 0.392 (0.410) data 0.267 (0.284) loss_u loss_u 0.8667 (0.8832) acc_u 15.6250 (13.9583) lr 1.6730e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 340
confident_label rate tensor(0.6017, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 982
clean true:982
clean false:0
clean_rate:1.0
noisy true:310
noisy false:340
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 650
epoch [56/200] batch [5/30] time 0.467 (0.429) data 0.341 (0.302) loss_x loss_x 0.4814 (0.4878) acc_x 84.3750 (85.6250) lr 1.6613e-03 eta 0:00:10
epoch [56/200] batch [10/30] time 0.421 (0.417) data 0.295 (0.291) loss_x loss_x 0.5474 (0.4291) acc_x 81.2500 (88.7500) lr 1.6613e-03 eta 0:00:08
epoch [56/200] batch [15/30] time 0.449 (0.417) data 0.323 (0.291) loss_x loss_x 0.6685 (0.4453) acc_x 81.2500 (88.3333) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [20/30] time 0.342 (0.413) data 0.264 (0.289) loss_x loss_x 0.6021 (0.4432) acc_x 84.3750 (88.2812) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [25/30] time 0.393 (0.412) data 0.270 (0.288) loss_x loss_x 0.3979 (0.4298) acc_x 87.5000 (88.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/30] time 0.390 (0.407) data 0.263 (0.283) loss_x loss_x 0.5684 (0.4221) acc_x 84.3750 (88.8542) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/20] time 0.404 (0.406) data 0.277 (0.281) loss_u loss_u 0.8281 (0.8824) acc_u 21.8750 (13.7500) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [10/20] time 0.399 (0.406) data 0.270 (0.281) loss_u loss_u 0.8164 (0.8727) acc_u 21.8750 (14.3750) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/20] time 0.405 (0.406) data 0.277 (0.281) loss_u loss_u 0.8101 (0.8620) acc_u 25.0000 (15.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/20] time 0.403 (0.408) data 0.274 (0.282) loss_u loss_u 0.8545 (0.8621) acc_u 18.7500 (15.9375) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 330
confident_label rate tensor(0.6091, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 994
clean true:993
clean false:1
clean_rate:0.9989939637826962
noisy true:309
noisy false:329
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 638
epoch [57/200] batch [5/31] time 0.470 (0.449) data 0.333 (0.331) loss_x loss_x 0.3157 (0.4350) acc_x 90.6250 (89.3750) lr 1.6494e-03 eta 0:00:11
epoch [57/200] batch [10/31] time 0.409 (0.443) data 0.282 (0.321) loss_x loss_x 0.5098 (0.3889) acc_x 87.5000 (90.3125) lr 1.6494e-03 eta 0:00:09
epoch [57/200] batch [15/31] time 0.406 (0.427) data 0.282 (0.304) loss_x loss_x 0.4958 (0.3806) acc_x 87.5000 (91.2500) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [20/31] time 0.412 (0.425) data 0.284 (0.302) loss_x loss_x 0.4968 (0.3707) acc_x 84.3750 (91.2500) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [25/31] time 0.400 (0.420) data 0.272 (0.296) loss_x loss_x 0.3235 (0.3652) acc_x 87.5000 (91.2500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [30/31] time 0.343 (0.408) data 0.217 (0.284) loss_x loss_x 0.4578 (0.3553) acc_x 87.5000 (91.4583) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/19] time 0.402 (0.407) data 0.276 (0.284) loss_u loss_u 0.7793 (0.8618) acc_u 28.1250 (15.6250) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [10/19] time 0.395 (0.408) data 0.270 (0.283) loss_u loss_u 0.8081 (0.8609) acc_u 21.8750 (16.5625) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/19] time 0.424 (0.408) data 0.295 (0.283) loss_u loss_u 0.8823 (0.8676) acc_u 12.5000 (15.6250) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 316
confident_label rate tensor(0.6115, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 998
clean true:995
clean false:3
clean_rate:0.996993987975952
noisy true:321
noisy false:313
after delete: len(clean_dataset) 998
after delete: len(noisy_dataset) 634
epoch [58/200] batch [5/31] time 0.424 (0.405) data 0.290 (0.277) loss_x loss_x 0.2935 (0.2844) acc_x 96.8750 (95.6250) lr 1.6374e-03 eta 0:00:10
epoch [58/200] batch [10/31] time 0.353 (0.386) data 0.223 (0.258) loss_x loss_x 0.4158 (0.3622) acc_x 96.8750 (93.4375) lr 1.6374e-03 eta 0:00:08
epoch [58/200] batch [15/31] time 0.407 (0.383) data 0.282 (0.262) loss_x loss_x 0.2338 (0.3738) acc_x 100.0000 (92.9167) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [20/31] time 0.405 (0.387) data 0.280 (0.265) loss_x loss_x 0.1526 (0.3867) acc_x 100.0000 (91.8750) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [25/31] time 0.403 (0.389) data 0.277 (0.267) loss_x loss_x 0.3665 (0.3897) acc_x 96.8750 (91.6250) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [30/31] time 0.397 (0.391) data 0.274 (0.268) loss_x loss_x 0.3542 (0.3813) acc_x 93.7500 (91.8750) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/19] time 0.420 (0.393) data 0.293 (0.269) loss_u loss_u 0.8887 (0.8875) acc_u 15.6250 (13.1250) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/19] time 0.401 (0.394) data 0.273 (0.270) loss_u loss_u 0.8389 (0.8704) acc_u 21.8750 (15.6250) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/19] time 0.399 (0.396) data 0.270 (0.271) loss_u loss_u 0.8804 (0.8761) acc_u 15.6250 (15.2083) lr 1.6374e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 301
confident_label rate tensor(0.6213, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1014
clean true:1012
clean false:2
clean_rate:0.9980276134122288
noisy true:319
noisy false:299
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 618
epoch [59/200] batch [5/31] time 0.344 (0.379) data 0.218 (0.254) loss_x loss_x 0.2461 (0.4081) acc_x 96.8750 (89.3750) lr 1.6252e-03 eta 0:00:09
epoch [59/200] batch [10/31] time 0.366 (0.381) data 0.288 (0.261) loss_x loss_x 0.3201 (0.4232) acc_x 96.8750 (90.0000) lr 1.6252e-03 eta 0:00:07
epoch [59/200] batch [15/31] time 0.409 (0.393) data 0.285 (0.271) loss_x loss_x 0.5928 (0.4349) acc_x 81.2500 (88.7500) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [20/31] time 0.386 (0.393) data 0.261 (0.270) loss_x loss_x 0.3352 (0.4357) acc_x 87.5000 (88.7500) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [25/31] time 0.421 (0.398) data 0.295 (0.274) loss_x loss_x 0.1349 (0.4301) acc_x 100.0000 (88.7500) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [30/31] time 0.402 (0.402) data 0.276 (0.277) loss_x loss_x 0.5098 (0.4138) acc_x 87.5000 (89.5833) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/19] time 0.431 (0.403) data 0.305 (0.278) loss_u loss_u 0.8521 (0.8988) acc_u 18.7500 (11.8750) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/19] time 0.402 (0.403) data 0.275 (0.278) loss_u loss_u 0.8569 (0.8842) acc_u 18.7500 (14.0625) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/19] time 0.372 (0.401) data 0.245 (0.276) loss_u loss_u 0.8911 (0.8834) acc_u 12.5000 (13.7500) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 309
confident_label rate tensor(0.6183, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1009
clean true:1006
clean false:3
clean_rate:0.9970267591674926
noisy true:317
noisy false:306
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 623
epoch [60/200] batch [5/31] time 0.390 (0.392) data 0.263 (0.265) loss_x loss_x 0.3760 (0.3794) acc_x 90.6250 (90.0000) lr 1.6129e-03 eta 0:00:10
epoch [60/200] batch [10/31] time 0.390 (0.401) data 0.268 (0.280) loss_x loss_x 0.2385 (0.3509) acc_x 96.8750 (91.5625) lr 1.6129e-03 eta 0:00:08
epoch [60/200] batch [15/31] time 0.355 (0.391) data 0.233 (0.269) loss_x loss_x 0.3242 (0.3906) acc_x 96.8750 (90.8333) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [20/31] time 0.426 (0.392) data 0.303 (0.269) loss_x loss_x 0.4463 (0.3919) acc_x 90.6250 (90.6250) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [25/31] time 0.342 (0.385) data 0.220 (0.262) loss_x loss_x 0.3555 (0.3757) acc_x 93.7500 (91.3750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [30/31] time 0.394 (0.384) data 0.271 (0.261) loss_x loss_x 0.3062 (0.3869) acc_x 96.8750 (90.9375) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/19] time 0.421 (0.387) data 0.296 (0.263) loss_u loss_u 0.8423 (0.8955) acc_u 18.7500 (13.7500) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/19] time 0.393 (0.388) data 0.266 (0.265) loss_u loss_u 0.8159 (0.8591) acc_u 21.8750 (17.5000) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/19] time 0.410 (0.392) data 0.284 (0.269) loss_u loss_u 0.8975 (0.8802) acc_u 12.5000 (14.5833) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 289
confident_label rate tensor(0.6324, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1032
clean true:1031
clean false:1
clean_rate:0.999031007751938
noisy true:312
noisy false:288
after delete: len(clean_dataset) 1032
after delete: len(noisy_dataset) 600
epoch [61/200] batch [5/32] time 0.419 (0.426) data 0.293 (0.301) loss_x loss_x 0.1838 (0.2369) acc_x 100.0000 (95.6250) lr 1.6004e-03 eta 0:00:11
epoch [61/200] batch [10/32] time 0.373 (0.393) data 0.248 (0.267) loss_x loss_x 0.4556 (0.2986) acc_x 90.6250 (94.0625) lr 1.6004e-03 eta 0:00:08
epoch [61/200] batch [15/32] time 0.406 (0.391) data 0.282 (0.265) loss_x loss_x 0.2269 (0.3062) acc_x 93.7500 (93.3333) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [20/32] time 0.419 (0.392) data 0.293 (0.267) loss_x loss_x 0.4817 (0.3188) acc_x 87.5000 (92.9688) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [25/32] time 0.430 (0.394) data 0.305 (0.271) loss_x loss_x 0.2102 (0.3164) acc_x 96.8750 (92.5000) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [30/32] time 0.372 (0.397) data 0.248 (0.274) loss_x loss_x 0.6406 (0.3324) acc_x 84.3750 (92.5000) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/18] time 0.389 (0.399) data 0.264 (0.276) loss_u loss_u 0.8818 (0.8791) acc_u 12.5000 (13.7500) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [10/18] time 0.352 (0.399) data 0.273 (0.277) loss_u loss_u 0.9277 (0.8898) acc_u 9.3750 (12.5000) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/18] time 0.378 (0.399) data 0.252 (0.276) loss_u loss_u 0.9229 (0.8841) acc_u 9.3750 (13.5417) lr 1.6004e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 277
confident_label rate tensor(0.6342, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1035
clean true:1033
clean false:2
clean_rate:0.9980676328502416
noisy true:322
noisy false:275
after delete: len(clean_dataset) 1035
after delete: len(noisy_dataset) 597
epoch [62/200] batch [5/32] time 0.407 (0.426) data 0.282 (0.300) loss_x loss_x 0.3367 (0.4694) acc_x 93.7500 (90.0000) lr 1.5878e-03 eta 0:00:11
epoch [62/200] batch [10/32] time 0.400 (0.413) data 0.273 (0.287) loss_x loss_x 0.6279 (0.4694) acc_x 90.6250 (90.3125) lr 1.5878e-03 eta 0:00:09
epoch [62/200] batch [15/32] time 0.392 (0.407) data 0.264 (0.282) loss_x loss_x 0.2654 (0.4199) acc_x 93.7500 (91.2500) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [20/32] time 0.417 (0.403) data 0.266 (0.279) loss_x loss_x 0.3621 (0.3908) acc_x 90.6250 (91.5625) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [25/32] time 0.387 (0.404) data 0.258 (0.279) loss_x loss_x 0.1818 (0.3797) acc_x 96.8750 (91.5000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [30/32] time 0.402 (0.403) data 0.277 (0.278) loss_x loss_x 0.7207 (0.4049) acc_x 81.2500 (91.0417) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/18] time 0.350 (0.398) data 0.221 (0.273) loss_u loss_u 0.9580 (0.8838) acc_u 3.1250 (13.7500) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/18] time 0.403 (0.395) data 0.276 (0.270) loss_u loss_u 0.9561 (0.8986) acc_u 6.2500 (12.1875) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/18] time 0.346 (0.395) data 0.264 (0.271) loss_u loss_u 0.8022 (0.8878) acc_u 25.0000 (13.5417) lr 1.5878e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 285
confident_label rate tensor(0.6311, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1030
clean true:1029
clean false:1
clean_rate:0.9990291262135922
noisy true:318
noisy false:284
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 602
epoch [63/200] batch [5/32] time 0.388 (0.419) data 0.264 (0.293) loss_x loss_x 0.7437 (0.5118) acc_x 81.2500 (87.5000) lr 1.5750e-03 eta 0:00:11
epoch [63/200] batch [10/32] time 0.420 (0.407) data 0.294 (0.281) loss_x loss_x 0.4102 (0.4087) acc_x 90.6250 (90.6250) lr 1.5750e-03 eta 0:00:08
epoch [63/200] batch [15/32] time 0.404 (0.404) data 0.277 (0.279) loss_x loss_x 0.4497 (0.4067) acc_x 87.5000 (90.2083) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [20/32] time 0.429 (0.400) data 0.304 (0.277) loss_x loss_x 0.2473 (0.4057) acc_x 93.7500 (90.4688) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [25/32] time 0.409 (0.402) data 0.285 (0.278) loss_x loss_x 0.6079 (0.4272) acc_x 84.3750 (89.6250) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [30/32] time 0.405 (0.403) data 0.279 (0.279) loss_x loss_x 0.4211 (0.4410) acc_x 90.6250 (89.1667) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/18] time 0.435 (0.405) data 0.311 (0.280) loss_u loss_u 0.8721 (0.8816) acc_u 15.6250 (13.1250) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/18] time 0.398 (0.405) data 0.271 (0.281) loss_u loss_u 0.8896 (0.8822) acc_u 12.5000 (13.4375) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/18] time 0.406 (0.405) data 0.278 (0.281) loss_u loss_u 0.8545 (0.8670) acc_u 15.6250 (15.2083) lr 1.5750e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 297
confident_label rate tensor(0.6262, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1022
clean true:1020
clean false:2
clean_rate:0.9980430528375733
noisy true:315
noisy false:295
after delete: len(clean_dataset) 1022
after delete: len(noisy_dataset) 610
epoch [64/200] batch [5/31] time 0.430 (0.408) data 0.304 (0.282) loss_x loss_x 0.3032 (0.5110) acc_x 93.7500 (86.2500) lr 1.5621e-03 eta 0:00:10
epoch [64/200] batch [10/31] time 0.390 (0.407) data 0.266 (0.281) loss_x loss_x 0.2905 (0.4262) acc_x 90.6250 (88.4375) lr 1.5621e-03 eta 0:00:08
epoch [64/200] batch [15/31] time 0.397 (0.404) data 0.274 (0.279) loss_x loss_x 0.2168 (0.3916) acc_x 93.7500 (89.3750) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [20/31] time 0.341 (0.393) data 0.217 (0.267) loss_x loss_x 0.2549 (0.3604) acc_x 96.8750 (90.6250) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [25/31] time 0.361 (0.393) data 0.260 (0.269) loss_x loss_x 0.3911 (0.3588) acc_x 93.7500 (90.6250) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [30/31] time 0.373 (0.396) data 0.248 (0.272) loss_x loss_x 0.3120 (0.3753) acc_x 96.8750 (90.4167) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/19] time 0.345 (0.392) data 0.222 (0.268) loss_u loss_u 0.8286 (0.8905) acc_u 18.7500 (11.8750) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/19] time 0.406 (0.390) data 0.278 (0.265) loss_u loss_u 0.9033 (0.8889) acc_u 15.6250 (12.8125) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/19] time 0.353 (0.389) data 0.224 (0.264) loss_u loss_u 0.8438 (0.8710) acc_u 15.6250 (14.7917) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.6379, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1041
clean true:1041
clean false:0
clean_rate:1.0
noisy true:308
noisy false:283
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 591
epoch [65/200] batch [5/32] time 0.429 (0.434) data 0.302 (0.308) loss_x loss_x 0.2756 (0.2804) acc_x 93.7500 (94.3750) lr 1.5490e-03 eta 0:00:11
epoch [65/200] batch [10/32] time 0.421 (0.426) data 0.298 (0.306) loss_x loss_x 0.8218 (0.3836) acc_x 78.1250 (90.9375) lr 1.5490e-03 eta 0:00:09
epoch [65/200] batch [15/32] time 0.391 (0.419) data 0.269 (0.298) loss_x loss_x 0.5303 (0.4031) acc_x 87.5000 (90.4167) lr 1.5490e-03 eta 0:00:07
epoch [65/200] batch [20/32] time 0.404 (0.413) data 0.278 (0.291) loss_x loss_x 0.2673 (0.3965) acc_x 90.6250 (90.1562) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [25/32] time 0.352 (0.412) data 0.227 (0.289) loss_x loss_x 0.1331 (0.3788) acc_x 93.7500 (90.5000) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [30/32] time 0.440 (0.404) data 0.311 (0.280) loss_x loss_x 0.4097 (0.3919) acc_x 93.7500 (90.5208) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/18] time 0.429 (0.402) data 0.306 (0.280) loss_u loss_u 0.9214 (0.9021) acc_u 9.3750 (13.1250) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/18] time 0.423 (0.406) data 0.299 (0.283) loss_u loss_u 0.9355 (0.8947) acc_u 9.3750 (13.4375) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/18] time 0.424 (0.407) data 0.297 (0.284) loss_u loss_u 0.8740 (0.8981) acc_u 15.6250 (12.9167) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.6409, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1046
clean true:1045
clean false:1
clean_rate:0.9990439770554493
noisy true:324
noisy false:262
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 586
epoch [66/200] batch [5/32] time 0.422 (0.406) data 0.296 (0.289) loss_x loss_x 0.4456 (0.4178) acc_x 87.5000 (88.7500) lr 1.5358e-03 eta 0:00:10
epoch [66/200] batch [10/32] time 0.358 (0.398) data 0.232 (0.277) loss_x loss_x 0.2654 (0.3959) acc_x 93.7500 (90.0000) lr 1.5358e-03 eta 0:00:08
epoch [66/200] batch [15/32] time 0.355 (0.393) data 0.232 (0.270) loss_x loss_x 0.3835 (0.4416) acc_x 90.6250 (90.2083) lr 1.5358e-03 eta 0:00:06
epoch [66/200] batch [20/32] time 0.415 (0.393) data 0.289 (0.270) loss_x loss_x 0.3374 (0.4242) acc_x 96.8750 (90.9375) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [25/32] time 0.341 (0.389) data 0.263 (0.268) loss_x loss_x 0.4656 (0.4151) acc_x 87.5000 (90.7500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [30/32] time 0.447 (0.393) data 0.321 (0.271) loss_x loss_x 0.7407 (0.4291) acc_x 81.2500 (90.3125) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/18] time 0.416 (0.400) data 0.289 (0.276) loss_u loss_u 0.9219 (0.9000) acc_u 9.3750 (12.5000) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/18] time 0.418 (0.403) data 0.293 (0.279) loss_u loss_u 0.9463 (0.8909) acc_u 6.2500 (13.1250) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/18] time 0.451 (0.405) data 0.320 (0.281) loss_u loss_u 0.8530 (0.8849) acc_u 18.7500 (14.3750) lr 1.5358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 297
confident_label rate tensor(0.6317, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1031
clean true:1030
clean false:1
clean_rate:0.9990300678952473
noisy true:305
noisy false:296
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 601
epoch [67/200] batch [5/32] time 0.448 (0.416) data 0.280 (0.282) loss_x loss_x 0.3064 (0.4121) acc_x 87.5000 (88.7500) lr 1.5225e-03 eta 0:00:11
epoch [67/200] batch [10/32] time 0.434 (0.412) data 0.308 (0.283) loss_x loss_x 0.1998 (0.4405) acc_x 93.7500 (88.7500) lr 1.5225e-03 eta 0:00:09
epoch [67/200] batch [15/32] time 0.419 (0.422) data 0.292 (0.293) loss_x loss_x 0.5781 (0.4191) acc_x 90.6250 (89.3750) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [20/32] time 0.353 (0.411) data 0.227 (0.283) loss_x loss_x 0.3833 (0.4323) acc_x 93.7500 (89.2188) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [25/32] time 0.361 (0.401) data 0.231 (0.272) loss_x loss_x 0.2637 (0.4423) acc_x 96.8750 (88.8750) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [30/32] time 0.358 (0.394) data 0.232 (0.266) loss_x loss_x 0.5957 (0.4458) acc_x 78.1250 (88.5417) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/18] time 0.354 (0.398) data 0.226 (0.270) loss_u loss_u 0.9277 (0.8549) acc_u 6.2500 (15.6250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/18] time 0.390 (0.394) data 0.284 (0.266) loss_u loss_u 0.8613 (0.8565) acc_u 15.6250 (16.5625) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/18] time 0.396 (0.395) data 0.270 (0.268) loss_u loss_u 0.8301 (0.8501) acc_u 18.7500 (17.2917) lr 1.5225e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 296
confident_label rate tensor(0.6183, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1009
clean true:1008
clean false:1
clean_rate:0.9990089197224975
noisy true:328
noisy false:295
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 623
epoch [68/200] batch [5/31] time 0.422 (0.417) data 0.297 (0.291) loss_x loss_x 0.3499 (0.3621) acc_x 96.8750 (92.5000) lr 1.5090e-03 eta 0:00:10
epoch [68/200] batch [10/31] time 0.428 (0.417) data 0.303 (0.291) loss_x loss_x 0.2319 (0.4229) acc_x 96.8750 (90.0000) lr 1.5090e-03 eta 0:00:08
epoch [68/200] batch [15/31] time 0.430 (0.419) data 0.304 (0.293) loss_x loss_x 0.3657 (0.3755) acc_x 87.5000 (91.4583) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [20/31] time 0.402 (0.415) data 0.275 (0.289) loss_x loss_x 0.3013 (0.3686) acc_x 87.5000 (91.2500) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [25/31] time 0.392 (0.409) data 0.265 (0.283) loss_x loss_x 0.3784 (0.3796) acc_x 87.5000 (90.7500) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [30/31] time 0.385 (0.404) data 0.261 (0.278) loss_x loss_x 0.3152 (0.3897) acc_x 96.8750 (90.6250) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/19] time 0.344 (0.400) data 0.218 (0.274) loss_u loss_u 0.8501 (0.8476) acc_u 18.7500 (18.7500) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/19] time 0.398 (0.398) data 0.271 (0.272) loss_u loss_u 0.8579 (0.8534) acc_u 15.6250 (17.5000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/19] time 0.394 (0.399) data 0.265 (0.272) loss_u loss_u 0.9336 (0.8605) acc_u 9.3750 (16.6667) lr 1.5090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.6471, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1056
clean true:1052
clean false:4
clean_rate:0.9962121212121212
noisy true:311
noisy false:265
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 576
epoch [69/200] batch [5/33] time 0.423 (0.374) data 0.300 (0.248) loss_x loss_x 0.4033 (0.4278) acc_x 93.7500 (90.6250) lr 1.4955e-03 eta 0:00:10
epoch [69/200] batch [10/33] time 0.416 (0.388) data 0.289 (0.263) loss_x loss_x 0.3320 (0.3697) acc_x 96.8750 (91.5625) lr 1.4955e-03 eta 0:00:08
epoch [69/200] batch [15/33] time 0.401 (0.396) data 0.277 (0.271) loss_x loss_x 0.8779 (0.4193) acc_x 84.3750 (90.6250) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [20/33] time 0.410 (0.398) data 0.285 (0.273) loss_x loss_x 0.2505 (0.4213) acc_x 96.8750 (90.9375) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [25/33] time 0.390 (0.399) data 0.267 (0.274) loss_x loss_x 0.2455 (0.4355) acc_x 90.6250 (90.5000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [30/33] time 0.358 (0.394) data 0.233 (0.271) loss_x loss_x 0.3208 (0.4206) acc_x 93.7500 (90.4167) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [5/18] time 0.402 (0.395) data 0.276 (0.271) loss_u loss_u 0.8716 (0.8758) acc_u 15.6250 (15.0000) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/18] time 0.409 (0.397) data 0.281 (0.272) loss_u loss_u 0.9214 (0.8994) acc_u 12.5000 (12.5000) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/18] time 0.353 (0.395) data 0.224 (0.271) loss_u loss_u 0.8867 (0.8939) acc_u 15.6250 (13.5417) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.6464, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1055
clean true:1050
clean false:5
clean_rate:0.995260663507109
noisy true:329
noisy false:248
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 577
epoch [70/200] batch [5/32] time 0.413 (0.408) data 0.287 (0.282) loss_x loss_x 0.3215 (0.4177) acc_x 87.5000 (89.3750) lr 1.4818e-03 eta 0:00:11
epoch [70/200] batch [10/32] time 0.430 (0.424) data 0.305 (0.298) loss_x loss_x 0.4158 (0.3727) acc_x 90.6250 (90.6250) lr 1.4818e-03 eta 0:00:09
epoch [70/200] batch [15/32] time 0.404 (0.418) data 0.281 (0.296) loss_x loss_x 0.2585 (0.3640) acc_x 90.6250 (90.6250) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [20/32] time 0.381 (0.414) data 0.256 (0.291) loss_x loss_x 0.1353 (0.3677) acc_x 100.0000 (91.4062) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [25/32] time 0.380 (0.409) data 0.258 (0.286) loss_x loss_x 0.3479 (0.3631) acc_x 93.7500 (91.6250) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [30/32] time 0.376 (0.400) data 0.254 (0.276) loss_x loss_x 0.2742 (0.3697) acc_x 93.7500 (91.4583) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/18] time 0.431 (0.399) data 0.305 (0.276) loss_u loss_u 0.7563 (0.8163) acc_u 28.1250 (21.8750) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/18] time 0.411 (0.401) data 0.285 (0.277) loss_u loss_u 0.8662 (0.8583) acc_u 15.6250 (16.5625) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/18] time 0.403 (0.401) data 0.275 (0.277) loss_u loss_u 0.8960 (0.8836) acc_u 9.3750 (13.5417) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.6268, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1023
clean true:1022
clean false:1
clean_rate:0.9990224828934506
noisy true:327
noisy false:282
after delete: len(clean_dataset) 1023
after delete: len(noisy_dataset) 609
epoch [71/200] batch [5/31] time 0.423 (0.435) data 0.296 (0.308) loss_x loss_x 0.3623 (0.4510) acc_x 93.7500 (91.8750) lr 1.4679e-03 eta 0:00:11
epoch [71/200] batch [10/31] time 0.424 (0.428) data 0.295 (0.302) loss_x loss_x 0.3032 (0.3721) acc_x 90.6250 (92.8125) lr 1.4679e-03 eta 0:00:08
epoch [71/200] batch [15/31] time 0.363 (0.411) data 0.238 (0.285) loss_x loss_x 0.3135 (0.3478) acc_x 96.8750 (93.5417) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [20/31] time 0.408 (0.402) data 0.281 (0.278) loss_x loss_x 0.2766 (0.3577) acc_x 90.6250 (93.4375) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [25/31] time 0.406 (0.404) data 0.281 (0.280) loss_x loss_x 0.1696 (0.3568) acc_x 93.7500 (92.8750) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [30/31] time 0.380 (0.402) data 0.254 (0.277) loss_x loss_x 0.2456 (0.3522) acc_x 93.7500 (92.9167) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/19] time 0.388 (0.400) data 0.258 (0.275) loss_u loss_u 0.8491 (0.8572) acc_u 15.6250 (16.8750) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/19] time 0.409 (0.400) data 0.281 (0.275) loss_u loss_u 0.8950 (0.8512) acc_u 12.5000 (17.8125) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/19] time 0.388 (0.401) data 0.260 (0.276) loss_u loss_u 0.9111 (0.8627) acc_u 12.5000 (16.8750) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.6409, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1046
clean true:1045
clean false:1
clean_rate:0.9990439770554493
noisy true:330
noisy false:256
after delete: len(clean_dataset) 1046
after delete: len(noisy_dataset) 586
epoch [72/200] batch [5/32] time 0.411 (0.425) data 0.284 (0.299) loss_x loss_x 0.3987 (0.4208) acc_x 87.5000 (92.5000) lr 1.4540e-03 eta 0:00:11
epoch [72/200] batch [10/32] time 0.435 (0.421) data 0.309 (0.295) loss_x loss_x 0.6108 (0.4269) acc_x 81.2500 (90.3125) lr 1.4540e-03 eta 0:00:09
epoch [72/200] batch [15/32] time 0.402 (0.421) data 0.275 (0.295) loss_x loss_x 0.3308 (0.4125) acc_x 90.6250 (90.8333) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [20/32] time 0.422 (0.414) data 0.292 (0.289) loss_x loss_x 0.1774 (0.3978) acc_x 96.8750 (91.0938) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [25/32] time 0.391 (0.410) data 0.266 (0.285) loss_x loss_x 0.4839 (0.4238) acc_x 90.6250 (90.2500) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [30/32] time 0.379 (0.407) data 0.257 (0.282) loss_x loss_x 0.4177 (0.4177) acc_x 90.6250 (90.5208) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/18] time 0.417 (0.408) data 0.292 (0.284) loss_u loss_u 0.9546 (0.8709) acc_u 6.2500 (14.3750) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/18] time 0.341 (0.405) data 0.233 (0.281) loss_u loss_u 0.9102 (0.8857) acc_u 12.5000 (13.1250) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [15/18] time 0.349 (0.402) data 0.217 (0.277) loss_u loss_u 0.8042 (0.8746) acc_u 21.8750 (14.3750) lr 1.4540e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.6428, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1049
clean true:1047
clean false:2
clean_rate:0.998093422306959
noisy true:329
noisy false:254
after delete: len(clean_dataset) 1049
after delete: len(noisy_dataset) 583
epoch [73/200] batch [5/32] time 0.393 (0.412) data 0.270 (0.288) loss_x loss_x 0.4158 (0.3620) acc_x 93.7500 (90.6250) lr 1.4399e-03 eta 0:00:11
epoch [73/200] batch [10/32] time 0.404 (0.407) data 0.279 (0.283) loss_x loss_x 0.3647 (0.3566) acc_x 96.8750 (91.8750) lr 1.4399e-03 eta 0:00:08
epoch [73/200] batch [15/32] time 0.472 (0.416) data 0.346 (0.291) loss_x loss_x 0.4954 (0.4285) acc_x 90.6250 (91.0417) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [20/32] time 0.412 (0.417) data 0.287 (0.295) loss_x loss_x 0.2203 (0.4172) acc_x 96.8750 (91.0938) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [25/32] time 0.401 (0.422) data 0.279 (0.299) loss_x loss_x 0.2739 (0.4161) acc_x 93.7500 (90.5000) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [30/32] time 0.344 (0.415) data 0.221 (0.292) loss_x loss_x 0.6274 (0.4045) acc_x 84.3750 (90.7292) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/18] time 0.398 (0.408) data 0.272 (0.284) loss_u loss_u 0.7788 (0.8406) acc_u 25.0000 (19.3750) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/18] time 0.394 (0.409) data 0.270 (0.286) loss_u loss_u 0.8662 (0.8666) acc_u 15.6250 (15.9375) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/18] time 0.380 (0.408) data 0.254 (0.285) loss_u loss_u 0.8989 (0.8714) acc_u 9.3750 (15.2083) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.6422, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1048
clean true:1047
clean false:1
clean_rate:0.9990458015267175
noisy true:332
noisy false:252
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 584
epoch [74/200] batch [5/32] time 0.366 (0.410) data 0.289 (0.295) loss_x loss_x 0.2773 (0.3360) acc_x 93.7500 (93.1250) lr 1.4258e-03 eta 0:00:11
epoch [74/200] batch [10/32] time 0.424 (0.413) data 0.295 (0.292) loss_x loss_x 0.4329 (0.3456) acc_x 87.5000 (92.5000) lr 1.4258e-03 eta 0:00:09
epoch [74/200] batch [15/32] time 0.384 (0.399) data 0.256 (0.277) loss_x loss_x 0.3303 (0.3469) acc_x 93.7500 (92.0833) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [20/32] time 0.414 (0.404) data 0.289 (0.281) loss_x loss_x 0.2386 (0.3303) acc_x 100.0000 (92.5000) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [25/32] time 0.354 (0.406) data 0.229 (0.283) loss_x loss_x 0.4016 (0.3419) acc_x 87.5000 (91.8750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [30/32] time 0.353 (0.397) data 0.229 (0.273) loss_x loss_x 0.1550 (0.3474) acc_x 96.8750 (91.6667) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/18] time 0.354 (0.388) data 0.231 (0.266) loss_u loss_u 0.9531 (0.8902) acc_u 6.2500 (12.5000) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/18] time 0.450 (0.390) data 0.324 (0.267) loss_u loss_u 0.8423 (0.8780) acc_u 21.8750 (15.3125) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/18] time 0.396 (0.392) data 0.267 (0.268) loss_u loss_u 0.8638 (0.8853) acc_u 15.6250 (14.1667) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.6458, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1054
clean true:1051
clean false:3
clean_rate:0.9971537001897534
noisy true:325
noisy false:253
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 578
epoch [75/200] batch [5/32] time 0.443 (0.444) data 0.319 (0.318) loss_x loss_x 0.2830 (0.3097) acc_x 93.7500 (92.5000) lr 1.4115e-03 eta 0:00:11
epoch [75/200] batch [10/32] time 0.442 (0.445) data 0.316 (0.318) loss_x loss_x 0.4082 (0.3741) acc_x 90.6250 (91.2500) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [15/32] time 0.522 (0.446) data 0.398 (0.323) loss_x loss_x 0.4243 (0.3623) acc_x 93.7500 (92.0833) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [20/32] time 0.396 (0.435) data 0.272 (0.311) loss_x loss_x 0.4509 (0.3670) acc_x 90.6250 (91.8750) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [25/32] time 0.425 (0.434) data 0.304 (0.310) loss_x loss_x 0.3530 (0.3498) acc_x 90.6250 (92.1250) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [30/32] time 0.387 (0.431) data 0.261 (0.307) loss_x loss_x 0.7534 (0.3646) acc_x 87.5000 (91.7708) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/18] time 0.362 (0.423) data 0.234 (0.299) loss_u loss_u 0.9194 (0.9095) acc_u 9.3750 (12.5000) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [10/18] time 0.519 (0.419) data 0.390 (0.295) loss_u loss_u 0.8877 (0.8894) acc_u 15.6250 (13.7500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/18] time 0.408 (0.418) data 0.286 (0.294) loss_u loss_u 0.9751 (0.8904) acc_u 0.0000 (13.3333) lr 1.4115e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 272
confident_label rate tensor(0.6373, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1040
clean true:1038
clean false:2
clean_rate:0.9980769230769231
noisy true:322
noisy false:270
after delete: len(clean_dataset) 1040
after delete: len(noisy_dataset) 592
epoch [76/200] batch [5/32] time 0.402 (0.425) data 0.276 (0.300) loss_x loss_x 0.5034 (0.3159) acc_x 84.3750 (91.2500) lr 1.3971e-03 eta 0:00:11
epoch [76/200] batch [10/32] time 0.414 (0.429) data 0.291 (0.304) loss_x loss_x 0.3625 (0.3669) acc_x 87.5000 (89.0625) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [15/32] time 0.397 (0.431) data 0.304 (0.308) loss_x loss_x 0.3972 (0.3752) acc_x 93.7500 (90.2083) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [20/32] time 0.354 (0.433) data 0.229 (0.309) loss_x loss_x 0.2489 (0.3529) acc_x 96.8750 (91.0938) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [25/32] time 0.352 (0.416) data 0.226 (0.292) loss_x loss_x 0.1897 (0.3384) acc_x 96.8750 (91.5000) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [30/32] time 0.358 (0.408) data 0.234 (0.284) loss_x loss_x 0.3281 (0.3537) acc_x 90.6250 (91.1458) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/18] time 0.368 (0.402) data 0.240 (0.277) loss_u loss_u 0.9683 (0.9168) acc_u 3.1250 (10.6250) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/18] time 0.391 (0.399) data 0.263 (0.274) loss_u loss_u 0.8145 (0.8853) acc_u 21.8750 (14.3750) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/18] time 0.394 (0.399) data 0.266 (0.273) loss_u loss_u 0.8208 (0.8692) acc_u 21.8750 (16.2500) lr 1.3971e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 272
confident_label rate tensor(0.6385, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1042
clean true:1040
clean false:2
clean_rate:0.9980806142034548
noisy true:320
noisy false:270
after delete: len(clean_dataset) 1042
after delete: len(noisy_dataset) 590
epoch [77/200] batch [5/32] time 0.348 (0.402) data 0.221 (0.277) loss_x loss_x 0.4690 (0.4105) acc_x 81.2500 (88.1250) lr 1.3827e-03 eta 0:00:10
epoch [77/200] batch [10/32] time 0.424 (0.390) data 0.300 (0.264) loss_x loss_x 0.6694 (0.3627) acc_x 81.2500 (90.0000) lr 1.3827e-03 eta 0:00:08
epoch [77/200] batch [15/32] time 0.403 (0.397) data 0.276 (0.271) loss_x loss_x 0.3298 (0.3605) acc_x 90.6250 (90.4167) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [20/32] time 0.403 (0.403) data 0.279 (0.277) loss_x loss_x 0.4119 (0.3307) acc_x 87.5000 (91.2500) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [25/32] time 0.429 (0.406) data 0.300 (0.279) loss_x loss_x 0.3542 (0.3245) acc_x 96.8750 (91.7500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [30/32] time 0.385 (0.407) data 0.261 (0.281) loss_x loss_x 0.5786 (0.3364) acc_x 84.3750 (91.7708) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/18] time 0.372 (0.400) data 0.249 (0.276) loss_u loss_u 0.9048 (0.8604) acc_u 12.5000 (15.6250) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/18] time 0.385 (0.396) data 0.257 (0.272) loss_u loss_u 0.8086 (0.8494) acc_u 25.0000 (18.4375) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/18] time 0.389 (0.396) data 0.259 (0.272) loss_u loss_u 0.8667 (0.8639) acc_u 12.5000 (16.4583) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.6434, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1050
clean true:1046
clean false:4
clean_rate:0.9961904761904762
noisy true:318
noisy false:264
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 582
epoch [78/200] batch [5/32] time 0.423 (0.426) data 0.298 (0.304) loss_x loss_x 0.3403 (0.2963) acc_x 90.6250 (94.3750) lr 1.3681e-03 eta 0:00:11
epoch [78/200] batch [10/32] time 0.417 (0.419) data 0.293 (0.296) loss_x loss_x 0.2815 (0.2858) acc_x 90.6250 (93.7500) lr 1.3681e-03 eta 0:00:09
epoch [78/200] batch [15/32] time 0.408 (0.415) data 0.283 (0.291) loss_x loss_x 0.3208 (0.2832) acc_x 96.8750 (94.3750) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [20/32] time 0.403 (0.410) data 0.277 (0.286) loss_x loss_x 0.2445 (0.2706) acc_x 90.6250 (94.0625) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [25/32] time 0.367 (0.401) data 0.242 (0.277) loss_x loss_x 0.4761 (0.2817) acc_x 81.2500 (93.5000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [30/32] time 0.370 (0.391) data 0.247 (0.270) loss_x loss_x 0.2593 (0.3047) acc_x 93.7500 (92.9167) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/18] time 0.390 (0.390) data 0.263 (0.268) loss_u loss_u 0.8652 (0.8839) acc_u 12.5000 (13.1250) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/18] time 0.384 (0.388) data 0.256 (0.265) loss_u loss_u 0.9082 (0.8789) acc_u 12.5000 (14.3750) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/18] time 0.411 (0.386) data 0.283 (0.263) loss_u loss_u 0.8589 (0.8801) acc_u 18.7500 (14.7917) lr 1.3681e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.6440, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1051
clean true:1048
clean false:3
clean_rate:0.9971455756422455
noisy true:318
noisy false:263
after delete: len(clean_dataset) 1051
after delete: len(noisy_dataset) 581
epoch [79/200] batch [5/32] time 0.426 (0.421) data 0.299 (0.293) loss_x loss_x 0.1456 (0.3115) acc_x 96.8750 (92.5000) lr 1.3535e-03 eta 0:00:11
epoch [79/200] batch [10/32] time 0.396 (0.407) data 0.266 (0.279) loss_x loss_x 0.3352 (0.3272) acc_x 93.7500 (92.5000) lr 1.3535e-03 eta 0:00:08
epoch [79/200] batch [15/32] time 0.411 (0.414) data 0.288 (0.287) loss_x loss_x 0.3459 (0.3450) acc_x 87.5000 (91.6667) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [20/32] time 0.450 (0.420) data 0.325 (0.296) loss_x loss_x 0.4009 (0.3335) acc_x 93.7500 (92.1875) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [25/32] time 0.405 (0.418) data 0.280 (0.293) loss_x loss_x 0.6875 (0.3592) acc_x 87.5000 (91.7500) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [30/32] time 0.413 (0.416) data 0.286 (0.290) loss_x loss_x 0.4084 (0.3742) acc_x 90.6250 (91.3542) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/18] time 0.390 (0.418) data 0.262 (0.292) loss_u loss_u 0.8472 (0.8628) acc_u 18.7500 (15.6250) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/18] time 0.351 (0.413) data 0.223 (0.287) loss_u loss_u 0.8892 (0.8667) acc_u 12.5000 (15.0000) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/18] time 0.445 (0.410) data 0.321 (0.285) loss_u loss_u 0.9590 (0.8853) acc_u 3.1250 (13.5417) lr 1.3535e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.6446, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1052
clean true:1050
clean false:2
clean_rate:0.9980988593155894
noisy true:326
noisy false:254
after delete: len(clean_dataset) 1052
after delete: len(noisy_dataset) 580
epoch [80/200] batch [5/32] time 0.415 (0.423) data 0.287 (0.297) loss_x loss_x 0.5337 (0.3916) acc_x 90.6250 (90.6250) lr 1.3387e-03 eta 0:00:11
epoch [80/200] batch [10/32] time 0.413 (0.412) data 0.287 (0.286) loss_x loss_x 0.2217 (0.3798) acc_x 96.8750 (91.2500) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [15/32] time 0.351 (0.392) data 0.222 (0.266) loss_x loss_x 0.2477 (0.3887) acc_x 90.6250 (90.6250) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [20/32] time 0.388 (0.393) data 0.264 (0.267) loss_x loss_x 0.2084 (0.3632) acc_x 96.8750 (91.4062) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [25/32] time 0.431 (0.399) data 0.306 (0.273) loss_x loss_x 0.1948 (0.3438) acc_x 96.8750 (91.6250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [30/32] time 0.411 (0.400) data 0.285 (0.274) loss_x loss_x 0.5137 (0.3610) acc_x 84.3750 (91.0417) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/18] time 0.390 (0.397) data 0.265 (0.272) loss_u loss_u 0.9844 (0.8899) acc_u 0.0000 (11.2500) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/18] time 0.344 (0.393) data 0.216 (0.268) loss_u loss_u 0.9502 (0.8981) acc_u 6.2500 (11.5625) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [15/18] time 0.345 (0.388) data 0.219 (0.263) loss_u loss_u 0.9238 (0.8846) acc_u 9.3750 (13.3333) lr 1.3387e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.6354, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1037
clean true:1034
clean false:3
clean_rate:0.9971070395371263
noisy true:328
noisy false:267
after delete: len(clean_dataset) 1037
after delete: len(noisy_dataset) 595
epoch [81/200] batch [5/32] time 0.428 (0.431) data 0.303 (0.305) loss_x loss_x 0.3188 (0.3791) acc_x 93.7500 (93.1250) lr 1.3239e-03 eta 0:00:11
epoch [81/200] batch [10/32] time 0.444 (0.433) data 0.319 (0.308) loss_x loss_x 0.2101 (0.3819) acc_x 96.8750 (92.5000) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [15/32] time 0.460 (0.441) data 0.335 (0.315) loss_x loss_x 0.3098 (0.3799) acc_x 93.7500 (91.8750) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [20/32] time 0.391 (0.433) data 0.265 (0.310) loss_x loss_x 0.1851 (0.3874) acc_x 100.0000 (91.8750) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [25/32] time 0.392 (0.428) data 0.267 (0.305) loss_x loss_x 0.1802 (0.3626) acc_x 93.7500 (92.2500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [30/32] time 0.392 (0.424) data 0.267 (0.300) loss_x loss_x 0.3354 (0.3646) acc_x 90.6250 (91.9792) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/18] time 0.352 (0.413) data 0.225 (0.288) loss_u loss_u 0.9336 (0.8634) acc_u 9.3750 (16.2500) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/18] time 0.369 (0.406) data 0.243 (0.281) loss_u loss_u 0.8516 (0.8447) acc_u 21.8750 (18.7500) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/18] time 0.363 (0.401) data 0.232 (0.275) loss_u loss_u 0.9067 (0.8576) acc_u 12.5000 (17.5000) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.6495, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1060
clean true:1057
clean false:3
clean_rate:0.9971698113207547
noisy true:323
noisy false:249
after delete: len(clean_dataset) 1060
after delete: len(noisy_dataset) 572
epoch [82/200] batch [5/33] time 0.414 (0.424) data 0.289 (0.299) loss_x loss_x 0.2932 (0.3702) acc_x 93.7500 (91.8750) lr 1.3090e-03 eta 0:00:11
epoch [82/200] batch [10/33] time 0.414 (0.424) data 0.288 (0.298) loss_x loss_x 0.4480 (0.3698) acc_x 93.7500 (92.1875) lr 1.3090e-03 eta 0:00:09
epoch [82/200] batch [15/33] time 0.402 (0.423) data 0.277 (0.297) loss_x loss_x 0.2441 (0.3668) acc_x 96.8750 (91.4583) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [20/33] time 0.404 (0.409) data 0.279 (0.283) loss_x loss_x 0.3286 (0.3532) acc_x 93.7500 (91.7188) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [25/33] time 0.339 (0.400) data 0.215 (0.277) loss_x loss_x 0.5146 (0.3788) acc_x 90.6250 (90.3750) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [30/33] time 0.344 (0.390) data 0.219 (0.266) loss_x loss_x 0.1688 (0.3651) acc_x 100.0000 (90.8333) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [5/17] time 0.389 (0.390) data 0.262 (0.266) loss_u loss_u 0.8848 (0.8826) acc_u 12.5000 (13.1250) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [10/17] time 0.389 (0.390) data 0.262 (0.265) loss_u loss_u 0.9102 (0.8960) acc_u 9.3750 (11.5625) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/17] time 0.384 (0.390) data 0.257 (0.265) loss_u loss_u 0.9170 (0.8870) acc_u 9.3750 (13.1250) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.6403, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1045
clean true:1044
clean false:1
clean_rate:0.999043062200957
noisy true:328
noisy false:259
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 587
epoch [83/200] batch [5/32] time 0.441 (0.442) data 0.315 (0.315) loss_x loss_x 0.8013 (0.4729) acc_x 84.3750 (86.8750) lr 1.2940e-03 eta 0:00:11
epoch [83/200] batch [10/32] time 0.351 (0.425) data 0.224 (0.298) loss_x loss_x 0.2854 (0.4290) acc_x 93.7500 (88.7500) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [15/32] time 0.489 (0.411) data 0.361 (0.290) loss_x loss_x 0.2030 (0.4234) acc_x 93.7500 (89.3750) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [20/32] time 0.434 (0.413) data 0.307 (0.291) loss_x loss_x 0.4414 (0.4110) acc_x 87.5000 (89.8438) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [25/32] time 0.422 (0.413) data 0.298 (0.291) loss_x loss_x 0.5693 (0.3935) acc_x 87.5000 (90.1250) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [30/32] time 0.404 (0.411) data 0.278 (0.288) loss_x loss_x 0.2761 (0.3883) acc_x 90.6250 (90.1042) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/18] time 0.401 (0.414) data 0.276 (0.290) loss_u loss_u 0.8755 (0.8696) acc_u 12.5000 (15.0000) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/18] time 0.386 (0.413) data 0.258 (0.288) loss_u loss_u 0.8569 (0.8635) acc_u 18.7500 (16.2500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/18] time 0.383 (0.410) data 0.259 (0.286) loss_u loss_u 0.7363 (0.8719) acc_u 31.2500 (15.6250) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 273
confident_label rate tensor(0.6360, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1038
clean true:1037
clean false:1
clean_rate:0.9990366088631984
noisy true:322
noisy false:272
after delete: len(clean_dataset) 1038
after delete: len(noisy_dataset) 594
epoch [84/200] batch [5/32] time 0.403 (0.405) data 0.278 (0.288) loss_x loss_x 0.2264 (0.2880) acc_x 93.7500 (90.6250) lr 1.2790e-03 eta 0:00:10
epoch [84/200] batch [10/32] time 0.406 (0.410) data 0.278 (0.288) loss_x loss_x 0.5728 (0.3204) acc_x 90.6250 (91.8750) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [15/32] time 0.410 (0.413) data 0.285 (0.290) loss_x loss_x 0.3340 (0.2992) acc_x 90.6250 (92.2917) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [20/32] time 0.392 (0.413) data 0.264 (0.289) loss_x loss_x 0.2451 (0.3023) acc_x 93.7500 (92.6562) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [25/32] time 0.412 (0.412) data 0.285 (0.287) loss_x loss_x 0.1263 (0.2852) acc_x 96.8750 (93.1250) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [30/32] time 0.420 (0.410) data 0.294 (0.287) loss_x loss_x 0.4426 (0.3056) acc_x 87.5000 (92.5000) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/18] time 0.398 (0.409) data 0.272 (0.285) loss_u loss_u 0.9248 (0.8664) acc_u 9.3750 (16.8750) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/18] time 0.355 (0.405) data 0.222 (0.280) loss_u loss_u 0.8042 (0.8595) acc_u 25.0000 (18.1250) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/18] time 0.406 (0.403) data 0.277 (0.278) loss_u loss_u 0.9375 (0.8676) acc_u 12.5000 (16.8750) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.6483, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1058
clean true:1056
clean false:2
clean_rate:0.998109640831758
noisy true:327
noisy false:247
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 574
epoch [85/200] batch [5/33] time 0.388 (0.403) data 0.264 (0.278) loss_x loss_x 0.5205 (0.3713) acc_x 87.5000 (91.8750) lr 1.2639e-03 eta 0:00:11
epoch [85/200] batch [10/33] time 0.410 (0.403) data 0.284 (0.278) loss_x loss_x 0.1783 (0.3273) acc_x 96.8750 (93.1250) lr 1.2639e-03 eta 0:00:09
epoch [85/200] batch [15/33] time 0.464 (0.425) data 0.336 (0.300) loss_x loss_x 0.3374 (0.3079) acc_x 90.6250 (93.5417) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [20/33] time 0.402 (0.416) data 0.275 (0.291) loss_x loss_x 0.2939 (0.3213) acc_x 93.7500 (92.8125) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [25/33] time 0.351 (0.404) data 0.224 (0.278) loss_x loss_x 0.4033 (0.3203) acc_x 90.6250 (92.6250) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [30/33] time 0.437 (0.402) data 0.311 (0.278) loss_x loss_x 0.1946 (0.3245) acc_x 93.7500 (92.7083) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [5/17] time 0.423 (0.409) data 0.294 (0.284) loss_u loss_u 0.8975 (0.8730) acc_u 12.5000 (15.0000) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [10/17] time 0.459 (0.413) data 0.333 (0.289) loss_u loss_u 0.9512 (0.8858) acc_u 6.2500 (13.7500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/17] time 0.433 (0.417) data 0.305 (0.292) loss_u loss_u 0.8389 (0.8740) acc_u 18.7500 (14.5833) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.6422, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1048
clean true:1045
clean false:3
clean_rate:0.9971374045801527
noisy true:319
noisy false:265
after delete: len(clean_dataset) 1048
after delete: len(noisy_dataset) 584
epoch [86/200] batch [5/32] time 0.365 (0.380) data 0.238 (0.254) loss_x loss_x 0.3618 (0.3511) acc_x 93.7500 (91.8750) lr 1.2487e-03 eta 0:00:10
epoch [86/200] batch [10/32] time 0.413 (0.381) data 0.290 (0.261) loss_x loss_x 0.3298 (0.3782) acc_x 93.7500 (92.5000) lr 1.2487e-03 eta 0:00:08
epoch [86/200] batch [15/32] time 0.454 (0.409) data 0.332 (0.287) loss_x loss_x 0.2396 (0.3396) acc_x 93.7500 (92.9167) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [20/32] time 0.434 (0.419) data 0.310 (0.297) loss_x loss_x 0.2211 (0.3300) acc_x 96.8750 (92.9688) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [25/32] time 0.463 (0.427) data 0.338 (0.304) loss_x loss_x 0.1986 (0.3288) acc_x 100.0000 (92.8750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [30/32] time 0.414 (0.430) data 0.291 (0.307) loss_x loss_x 0.2671 (0.3211) acc_x 96.8750 (93.1250) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/18] time 0.456 (0.433) data 0.328 (0.309) loss_u loss_u 0.8379 (0.8614) acc_u 18.7500 (18.1250) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/18] time 0.519 (0.436) data 0.395 (0.312) loss_u loss_u 0.8691 (0.8773) acc_u 12.5000 (15.0000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [15/18] time 0.413 (0.437) data 0.287 (0.313) loss_u loss_u 0.8755 (0.8804) acc_u 12.5000 (13.9583) lr 1.2487e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 245
confident_label rate tensor(0.6532, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1066
clean true:1064
clean false:2
clean_rate:0.99812382739212
noisy true:323
noisy false:243
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 566
epoch [87/200] batch [5/33] time 0.453 (0.408) data 0.326 (0.283) loss_x loss_x 0.4233 (0.2904) acc_x 93.7500 (95.0000) lr 1.2334e-03 eta 0:00:11
epoch [87/200] batch [10/33] time 0.458 (0.430) data 0.334 (0.304) loss_x loss_x 0.4944 (0.3169) acc_x 90.6250 (93.1250) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [15/33] time 0.415 (0.432) data 0.290 (0.307) loss_x loss_x 0.2245 (0.3299) acc_x 96.8750 (92.7083) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [20/33] time 0.424 (0.429) data 0.347 (0.306) loss_x loss_x 0.4373 (0.3510) acc_x 87.5000 (92.5000) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [25/33] time 0.460 (0.432) data 0.337 (0.309) loss_x loss_x 0.2812 (0.3453) acc_x 90.6250 (92.6250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [30/33] time 0.421 (0.436) data 0.294 (0.313) loss_x loss_x 0.4019 (0.3476) acc_x 87.5000 (92.2917) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [5/17] time 0.450 (0.428) data 0.324 (0.304) loss_u loss_u 0.8179 (0.8572) acc_u 21.8750 (17.5000) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/17] time 0.470 (0.428) data 0.345 (0.305) loss_u loss_u 0.8804 (0.8678) acc_u 15.6250 (15.9375) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/17] time 0.411 (0.429) data 0.286 (0.305) loss_u loss_u 0.9092 (0.8821) acc_u 9.3750 (14.1667) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.6532, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1066
clean true:1063
clean false:3
clean_rate:0.9971857410881801
noisy true:326
noisy false:240
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 566
epoch [88/200] batch [5/33] time 0.393 (0.409) data 0.268 (0.283) loss_x loss_x 0.2993 (0.2937) acc_x 93.7500 (93.7500) lr 1.2181e-03 eta 0:00:11
epoch [88/200] batch [10/33] time 0.407 (0.405) data 0.282 (0.285) loss_x loss_x 0.5278 (0.3331) acc_x 87.5000 (92.5000) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [15/33] time 0.387 (0.404) data 0.261 (0.283) loss_x loss_x 0.5015 (0.3327) acc_x 90.6250 (93.1250) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [20/33] time 0.417 (0.399) data 0.295 (0.276) loss_x loss_x 0.4197 (0.3480) acc_x 90.6250 (92.5000) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [25/33] time 0.404 (0.398) data 0.277 (0.275) loss_x loss_x 0.3435 (0.3541) acc_x 90.6250 (92.0000) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [30/33] time 0.430 (0.401) data 0.303 (0.277) loss_x loss_x 0.1759 (0.3535) acc_x 100.0000 (92.6042) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [5/17] time 0.389 (0.401) data 0.261 (0.276) loss_u loss_u 0.8677 (0.8932) acc_u 15.6250 (14.3750) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/17] time 0.424 (0.402) data 0.302 (0.278) loss_u loss_u 0.8950 (0.8888) acc_u 12.5000 (14.0625) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/17] time 0.416 (0.402) data 0.291 (0.278) loss_u loss_u 0.8926 (0.9001) acc_u 12.5000 (13.1250) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.6489, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1059
clean true:1056
clean false:3
clean_rate:0.9971671388101983
noisy true:325
noisy false:248
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 573
epoch [89/200] batch [5/33] time 0.373 (0.392) data 0.247 (0.267) loss_x loss_x 0.2935 (0.3331) acc_x 96.8750 (90.6250) lr 1.2028e-03 eta 0:00:10
epoch [89/200] batch [10/33] time 0.431 (0.399) data 0.305 (0.274) loss_x loss_x 0.4492 (0.3612) acc_x 90.6250 (91.5625) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [15/33] time 0.414 (0.409) data 0.287 (0.284) loss_x loss_x 0.4780 (0.3375) acc_x 93.7500 (92.5000) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [20/33] time 0.422 (0.412) data 0.297 (0.287) loss_x loss_x 0.6699 (0.3515) acc_x 81.2500 (92.1875) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [25/33] time 0.463 (0.418) data 0.336 (0.293) loss_x loss_x 0.5386 (0.3665) acc_x 84.3750 (91.5000) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [30/33] time 0.416 (0.416) data 0.293 (0.292) loss_x loss_x 0.4663 (0.3567) acc_x 84.3750 (91.5625) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [5/17] time 0.439 (0.420) data 0.312 (0.296) loss_u loss_u 0.9009 (0.9127) acc_u 12.5000 (10.6250) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/17] time 0.444 (0.423) data 0.315 (0.298) loss_u loss_u 0.8550 (0.9038) acc_u 18.7500 (12.1875) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/17] time 0.387 (0.420) data 0.259 (0.295) loss_u loss_u 0.8770 (0.8824) acc_u 12.5000 (14.5833) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.6520, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1064
clean true:1062
clean false:2
clean_rate:0.9981203007518797
noisy true:320
noisy false:248
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 568
epoch [90/200] batch [5/33] time 0.384 (0.423) data 0.260 (0.296) loss_x loss_x 0.3608 (0.3628) acc_x 87.5000 (90.6250) lr 1.1874e-03 eta 0:00:11
epoch [90/200] batch [10/33] time 0.457 (0.420) data 0.332 (0.298) loss_x loss_x 0.2490 (0.3128) acc_x 96.8750 (92.5000) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [15/33] time 0.487 (0.441) data 0.363 (0.319) loss_x loss_x 0.4165 (0.3784) acc_x 90.6250 (91.2500) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [20/33] time 0.401 (0.439) data 0.271 (0.316) loss_x loss_x 0.3352 (0.3676) acc_x 87.5000 (91.7188) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [25/33] time 0.426 (0.436) data 0.303 (0.312) loss_x loss_x 0.1925 (0.3517) acc_x 96.8750 (92.5000) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [30/33] time 0.344 (0.419) data 0.217 (0.297) loss_x loss_x 0.1725 (0.3434) acc_x 96.8750 (92.6042) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [5/17] time 0.381 (0.410) data 0.252 (0.286) loss_u loss_u 0.8760 (0.9069) acc_u 15.6250 (10.6250) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [10/17] time 0.430 (0.411) data 0.301 (0.288) loss_u loss_u 0.9048 (0.9067) acc_u 12.5000 (10.3125) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/17] time 0.427 (0.412) data 0.302 (0.289) loss_u loss_u 0.7744 (0.8878) acc_u 28.1250 (13.5417) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.6428, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1049
clean true:1047
clean false:2
clean_rate:0.998093422306959
noisy true:335
noisy false:248
after delete: len(clean_dataset) 1049
after delete: len(noisy_dataset) 583
epoch [91/200] batch [5/32] time 0.442 (0.399) data 0.317 (0.282) loss_x loss_x 0.1820 (0.3446) acc_x 96.8750 (90.6250) lr 1.1719e-03 eta 0:00:10
epoch [91/200] batch [10/32] time 0.410 (0.406) data 0.283 (0.285) loss_x loss_x 0.2303 (0.3447) acc_x 93.7500 (91.5625) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [15/32] time 0.383 (0.402) data 0.257 (0.279) loss_x loss_x 0.1772 (0.3236) acc_x 100.0000 (92.9167) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [20/32] time 0.405 (0.407) data 0.277 (0.283) loss_x loss_x 0.2449 (0.3184) acc_x 93.7500 (93.4375) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [25/32] time 0.413 (0.408) data 0.288 (0.284) loss_x loss_x 0.4519 (0.3266) acc_x 87.5000 (92.6250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [30/32] time 0.429 (0.411) data 0.305 (0.287) loss_x loss_x 0.2817 (0.3213) acc_x 93.7500 (92.9167) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/18] time 0.412 (0.412) data 0.287 (0.288) loss_u loss_u 0.9019 (0.8786) acc_u 9.3750 (12.5000) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/18] time 0.423 (0.412) data 0.297 (0.289) loss_u loss_u 0.9126 (0.8716) acc_u 12.5000 (14.0625) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/18] time 0.434 (0.415) data 0.310 (0.291) loss_u loss_u 0.9443 (0.8739) acc_u 9.3750 (14.3750) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 242
confident_label rate tensor(0.6513, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1063
clean true:1061
clean false:2
clean_rate:0.9981185324553151
noisy true:329
noisy false:240
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 569
epoch [92/200] batch [5/33] time 0.419 (0.425) data 0.295 (0.300) loss_x loss_x 0.1843 (0.3222) acc_x 96.8750 (91.2500) lr 1.1564e-03 eta 0:00:11
epoch [92/200] batch [10/33] time 0.432 (0.430) data 0.306 (0.303) loss_x loss_x 0.1674 (0.2833) acc_x 96.8750 (92.8125) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [15/33] time 0.436 (0.428) data 0.308 (0.302) loss_x loss_x 0.1377 (0.2855) acc_x 100.0000 (93.5417) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [20/33] time 0.480 (0.436) data 0.353 (0.309) loss_x loss_x 0.3372 (0.3012) acc_x 90.6250 (92.8125) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [25/33] time 0.492 (0.441) data 0.368 (0.315) loss_x loss_x 0.3130 (0.3023) acc_x 90.6250 (92.6250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [30/33] time 0.389 (0.437) data 0.261 (0.311) loss_x loss_x 0.5845 (0.3144) acc_x 87.5000 (92.2917) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [5/17] time 0.500 (0.431) data 0.375 (0.306) loss_u loss_u 0.8657 (0.8684) acc_u 15.6250 (15.0000) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/17] time 0.364 (0.428) data 0.237 (0.302) loss_u loss_u 0.9639 (0.8750) acc_u 3.1250 (14.0625) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/17] time 0.384 (0.421) data 0.262 (0.296) loss_u loss_u 0.8838 (0.8767) acc_u 15.6250 (14.3750) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.6495, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1060
clean true:1057
clean false:3
clean_rate:0.9971698113207547
noisy true:334
noisy false:238
after delete: len(clean_dataset) 1060
after delete: len(noisy_dataset) 572
epoch [93/200] batch [5/33] time 0.438 (0.436) data 0.313 (0.311) loss_x loss_x 0.3418 (0.3275) acc_x 90.6250 (91.2500) lr 1.1409e-03 eta 0:00:12
epoch [93/200] batch [10/33] time 0.422 (0.428) data 0.298 (0.303) loss_x loss_x 0.1354 (0.2705) acc_x 100.0000 (93.7500) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [15/33] time 0.389 (0.413) data 0.266 (0.289) loss_x loss_x 0.4753 (0.3473) acc_x 90.6250 (92.0833) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [20/33] time 0.404 (0.408) data 0.276 (0.283) loss_x loss_x 0.1855 (0.3404) acc_x 96.8750 (91.8750) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [25/33] time 0.361 (0.403) data 0.236 (0.278) loss_x loss_x 0.3245 (0.3375) acc_x 93.7500 (91.5000) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [30/33] time 0.408 (0.402) data 0.283 (0.278) loss_x loss_x 0.2140 (0.3349) acc_x 96.8750 (91.4583) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [5/17] time 0.401 (0.406) data 0.274 (0.282) loss_u loss_u 0.8613 (0.8871) acc_u 15.6250 (13.1250) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [10/17] time 0.387 (0.404) data 0.259 (0.280) loss_u loss_u 0.8413 (0.8739) acc_u 18.7500 (15.3125) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/17] time 0.340 (0.402) data 0.263 (0.279) loss_u loss_u 0.8062 (0.8877) acc_u 25.0000 (13.5417) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.6434, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1050
clean true:1048
clean false:2
clean_rate:0.9980952380952381
noisy true:323
noisy false:259
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 582
epoch [94/200] batch [5/32] time 0.389 (0.407) data 0.264 (0.281) loss_x loss_x 0.4424 (0.3092) acc_x 90.6250 (94.3750) lr 1.1253e-03 eta 0:00:10
epoch [94/200] batch [10/32] time 0.412 (0.417) data 0.287 (0.291) loss_x loss_x 0.4067 (0.3225) acc_x 87.5000 (92.8125) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [15/32] time 0.416 (0.413) data 0.291 (0.290) loss_x loss_x 0.4131 (0.3186) acc_x 90.6250 (92.9167) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [20/32] time 0.405 (0.412) data 0.281 (0.289) loss_x loss_x 0.3008 (0.3073) acc_x 87.5000 (92.9688) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [25/32] time 0.426 (0.411) data 0.304 (0.288) loss_x loss_x 0.5991 (0.3358) acc_x 84.3750 (92.3750) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [30/32] time 0.409 (0.410) data 0.285 (0.287) loss_x loss_x 0.1599 (0.3307) acc_x 100.0000 (92.6042) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/18] time 0.412 (0.409) data 0.287 (0.285) loss_u loss_u 0.9336 (0.8524) acc_u 6.2500 (17.5000) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/18] time 0.399 (0.410) data 0.272 (0.285) loss_u loss_u 0.9668 (0.8555) acc_u 3.1250 (16.2500) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [15/18] time 0.387 (0.407) data 0.264 (0.283) loss_u loss_u 0.8926 (0.8712) acc_u 15.6250 (14.7917) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.6618, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1080
clean true:1075
clean false:5
clean_rate:0.9953703703703703
noisy true:318
noisy false:234
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 552
epoch [95/200] batch [5/33] time 0.441 (0.427) data 0.315 (0.301) loss_x loss_x 0.2280 (0.2925) acc_x 93.7500 (92.5000) lr 1.1097e-03 eta 0:00:11
epoch [95/200] batch [10/33] time 0.415 (0.424) data 0.291 (0.299) loss_x loss_x 0.4031 (0.3161) acc_x 90.6250 (93.1250) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [15/33] time 0.437 (0.418) data 0.311 (0.293) loss_x loss_x 0.3479 (0.3520) acc_x 90.6250 (92.7083) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [20/33] time 0.347 (0.414) data 0.270 (0.291) loss_x loss_x 0.2825 (0.3624) acc_x 96.8750 (91.7188) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [25/33] time 0.422 (0.412) data 0.297 (0.288) loss_x loss_x 0.1649 (0.3441) acc_x 100.0000 (92.1250) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [30/33] time 0.387 (0.410) data 0.264 (0.286) loss_x loss_x 0.3508 (0.3478) acc_x 90.6250 (92.2917) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [5/17] time 0.381 (0.410) data 0.254 (0.285) loss_u loss_u 0.8301 (0.8712) acc_u 25.0000 (15.6250) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/17] time 0.416 (0.413) data 0.286 (0.288) loss_u loss_u 0.9189 (0.8834) acc_u 9.3750 (13.7500) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/17] time 0.406 (0.409) data 0.276 (0.286) loss_u loss_u 0.8604 (0.8884) acc_u 18.7500 (13.1250) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.6483, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1058
clean true:1053
clean false:5
clean_rate:0.995274102079395
noisy true:338
noisy false:236
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 574
epoch [96/200] batch [5/33] time 0.481 (0.469) data 0.356 (0.352) loss_x loss_x 0.2466 (0.3000) acc_x 96.8750 (95.0000) lr 1.0941e-03 eta 0:00:13
epoch [96/200] batch [10/33] time 0.491 (0.459) data 0.367 (0.337) loss_x loss_x 0.0946 (0.3035) acc_x 100.0000 (93.7500) lr 1.0941e-03 eta 0:00:10
epoch [96/200] batch [15/33] time 0.376 (0.449) data 0.248 (0.326) loss_x loss_x 0.4280 (0.3279) acc_x 84.3750 (92.2917) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [20/33] time 0.497 (0.439) data 0.373 (0.315) loss_x loss_x 0.2629 (0.3239) acc_x 93.7500 (92.6562) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [25/33] time 0.433 (0.446) data 0.308 (0.321) loss_x loss_x 0.5278 (0.3292) acc_x 87.5000 (92.8750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [30/33] time 0.383 (0.435) data 0.256 (0.311) loss_x loss_x 0.2441 (0.3435) acc_x 96.8750 (92.5000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [5/17] time 0.466 (0.432) data 0.342 (0.309) loss_u loss_u 0.8008 (0.8511) acc_u 21.8750 (16.2500) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/17] time 0.436 (0.434) data 0.311 (0.310) loss_u loss_u 0.8604 (0.8576) acc_u 18.7500 (16.2500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/17] time 0.402 (0.436) data 0.273 (0.312) loss_u loss_u 0.8271 (0.8656) acc_u 18.7500 (15.4167) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.6513, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1063
clean true:1062
clean false:1
clean_rate:0.9990592662276576
noisy true:327
noisy false:242
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 569
epoch [97/200] batch [5/33] time 0.411 (0.402) data 0.286 (0.286) loss_x loss_x 0.1969 (0.3439) acc_x 96.8750 (91.2500) lr 1.0785e-03 eta 0:00:11
epoch [97/200] batch [10/33] time 0.437 (0.410) data 0.314 (0.290) loss_x loss_x 0.1814 (0.2849) acc_x 96.8750 (94.0625) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [15/33] time 0.390 (0.403) data 0.267 (0.281) loss_x loss_x 0.5454 (0.2958) acc_x 90.6250 (93.3333) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [20/33] time 0.419 (0.407) data 0.294 (0.284) loss_x loss_x 0.1633 (0.3166) acc_x 96.8750 (92.8125) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [25/33] time 0.403 (0.407) data 0.278 (0.283) loss_x loss_x 0.3630 (0.3150) acc_x 90.6250 (93.0000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [30/33] time 0.408 (0.408) data 0.284 (0.284) loss_x loss_x 0.4719 (0.3258) acc_x 87.5000 (92.6042) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [5/17] time 0.422 (0.409) data 0.293 (0.284) loss_u loss_u 0.9453 (0.8839) acc_u 6.2500 (13.7500) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [10/17] time 0.397 (0.407) data 0.273 (0.283) loss_u loss_u 0.8564 (0.8700) acc_u 18.7500 (15.9375) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/17] time 0.354 (0.402) data 0.230 (0.278) loss_u loss_u 0.9385 (0.8781) acc_u 6.2500 (14.7917) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.6538, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1067
clean true:1065
clean false:2
clean_rate:0.9981255857544518
noisy true:336
noisy false:229
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 565
epoch [98/200] batch [5/33] time 0.429 (0.405) data 0.305 (0.290) loss_x loss_x 0.3384 (0.3641) acc_x 93.7500 (90.6250) lr 1.0628e-03 eta 0:00:11
epoch [98/200] batch [10/33] time 0.398 (0.408) data 0.275 (0.288) loss_x loss_x 0.4473 (0.3519) acc_x 87.5000 (91.2500) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [15/33] time 0.427 (0.411) data 0.301 (0.289) loss_x loss_x 0.3638 (0.3268) acc_x 90.6250 (92.2917) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [20/33] time 0.411 (0.406) data 0.287 (0.287) loss_x loss_x 0.3652 (0.3528) acc_x 87.5000 (91.2500) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [25/33] time 0.445 (0.413) data 0.319 (0.292) loss_x loss_x 0.3477 (0.3379) acc_x 93.7500 (91.7500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [30/33] time 0.367 (0.408) data 0.241 (0.286) loss_x loss_x 0.1937 (0.3309) acc_x 100.0000 (91.9792) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [5/17] time 0.408 (0.404) data 0.282 (0.282) loss_u loss_u 0.8965 (0.8582) acc_u 12.5000 (16.8750) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [10/17] time 0.436 (0.405) data 0.309 (0.282) loss_u loss_u 0.9009 (0.8699) acc_u 15.6250 (15.6250) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/17] time 0.406 (0.403) data 0.278 (0.280) loss_u loss_u 0.8535 (0.8774) acc_u 18.7500 (14.5833) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 214
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1086
clean false:2
clean_rate:0.9981617647058824
noisy true:332
noisy false:212
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [99/200] batch [5/34] time 0.417 (0.406) data 0.290 (0.280) loss_x loss_x 0.1443 (0.2479) acc_x 100.0000 (95.0000) lr 1.0471e-03 eta 0:00:11
epoch [99/200] batch [10/34] time 0.366 (0.432) data 0.243 (0.302) loss_x loss_x 0.3411 (0.2565) acc_x 96.8750 (95.0000) lr 1.0471e-03 eta 0:00:10
epoch [99/200] batch [15/34] time 0.359 (0.407) data 0.233 (0.277) loss_x loss_x 0.4375 (0.2659) acc_x 90.6250 (94.7917) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [20/34] time 0.429 (0.406) data 0.304 (0.278) loss_x loss_x 0.2241 (0.2653) acc_x 93.7500 (94.5312) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [25/34] time 0.407 (0.407) data 0.280 (0.279) loss_x loss_x 0.1719 (0.2621) acc_x 96.8750 (94.8750) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [30/34] time 0.399 (0.405) data 0.272 (0.277) loss_x loss_x 0.2292 (0.2844) acc_x 93.7500 (93.9583) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [5/17] time 0.433 (0.407) data 0.308 (0.281) loss_u loss_u 0.7993 (0.8923) acc_u 21.8750 (11.8750) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/17] time 0.406 (0.408) data 0.281 (0.282) loss_u loss_u 0.8765 (0.9092) acc_u 15.6250 (10.0000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/17] time 0.412 (0.410) data 0.283 (0.283) loss_u loss_u 0.9795 (0.9034) acc_u 3.1250 (10.8333) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.6556, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1070
clean true:1068
clean false:2
clean_rate:0.9981308411214953
noisy true:335
noisy false:227
all clean rate:  [0.9929078014184397, 0.9911894273127754, 0.9970972423802612, 1.0, 0.9986130374479889, 1.0, 0.9987046632124352, 1.0, 1.0, 0.998745294855709, 1.0, 0.99880810488677, 0.9987864077669902, 0.9976470588235294, 1.0, 1.0, 0.9988479262672811, 0.9977753058954394, 0.9965909090909091, 0.9977502812148481, 0.9978070175438597, 0.9988814317673378, 0.9966887417218543, 0.9989106753812637, 0.998911860718172, 0.9989189189189189, 0.9978471474703983, 0.9967069154774972, 0.9989247311827957, 0.9979013641133263, 0.9977949283351709, 0.9989406779661016, 0.9989451476793249, 0.9948665297741273, 1.0, 0.997920997920998, 0.9968520461699895, 0.9989572471324296, 0.9989743589743589, 0.9979570990806946, 0.9989837398373984, 0.9979423868312757, 0.9979423868312757, 0.9969788519637462, 0.9989615784008308, 0.999, 0.9979777553083923, 0.9989878542510121, 0.9979550102249489, 0.998001998001998, 0.9980059820538385, 0.9979859013091642, 0.9990049751243781, 0.999, 0.9980217606330366, 1.0, 0.9989939637826962, 0.996993987975952, 0.9980276134122288, 0.9970267591674926, 0.999031007751938, 0.9980676328502416, 0.9990291262135922, 0.9980430528375733, 1.0, 0.9990439770554493, 0.9990300678952473, 0.9990089197224975, 0.9962121212121212, 0.995260663507109, 0.9990224828934506, 0.9990439770554493, 0.998093422306959, 0.9990458015267175, 0.9971537001897534, 0.9980769230769231, 0.9980806142034548, 0.9961904761904762, 0.9971455756422455, 0.9980988593155894, 0.9971070395371263, 0.9971698113207547, 0.999043062200957, 0.9990366088631984, 0.998109640831758, 0.9971374045801527, 0.99812382739212, 0.9971857410881801, 0.9971671388101983, 0.9981203007518797, 0.998093422306959, 0.9981185324553151, 0.9971698113207547, 0.9980952380952381, 0.9953703703703703, 0.995274102079395, 0.9990592662276576, 0.9981255857544518, 0.9981617647058824, 0.9981308411214953]
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 562
epoch [100/200] batch [5/33] time 0.403 (0.404) data 0.280 (0.280) loss_x loss_x 0.3132 (0.2155) acc_x 90.6250 (95.0000) lr 1.0314e-03 eta 0:00:11
epoch [100/200] batch [10/33] time 0.332 (0.387) data 0.254 (0.268) loss_x loss_x 0.3616 (0.2729) acc_x 93.7500 (93.1250) lr 1.0314e-03 eta 0:00:08
epoch [100/200] batch [15/33] time 0.402 (0.392) data 0.277 (0.271) loss_x loss_x 0.2539 (0.2906) acc_x 96.8750 (92.9167) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [20/33] time 0.394 (0.391) data 0.269 (0.269) loss_x loss_x 0.1899 (0.3027) acc_x 93.7500 (92.3438) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [25/33] time 0.396 (0.391) data 0.274 (0.269) loss_x loss_x 0.1309 (0.2771) acc_x 100.0000 (93.5000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [30/33] time 0.382 (0.392) data 0.254 (0.269) loss_x loss_x 0.3611 (0.2939) acc_x 90.6250 (93.1250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [5/17] time 0.401 (0.393) data 0.274 (0.271) loss_u loss_u 0.8755 (0.9035) acc_u 15.6250 (12.5000) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [10/17] time 0.426 (0.396) data 0.296 (0.273) loss_u loss_u 0.8931 (0.8958) acc_u 12.5000 (12.1875) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/17] time 0.374 (0.392) data 0.247 (0.268) loss_u loss_u 0.8740 (0.9020) acc_u 15.6250 (11.4583) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.6477, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1057
clean true:1053
clean false:4
clean_rate:0.9962157048249763
noisy true:332
noisy false:243
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 575
epoch [101/200] batch [5/33] time 0.414 (0.421) data 0.286 (0.290) loss_x loss_x 0.2888 (0.3844) acc_x 90.6250 (89.3750) lr 1.0157e-03 eta 0:00:11
epoch [101/200] batch [10/33] time 0.443 (0.432) data 0.317 (0.303) loss_x loss_x 0.2759 (0.3510) acc_x 93.7500 (91.5625) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [15/33] time 0.411 (0.429) data 0.285 (0.302) loss_x loss_x 0.2014 (0.3217) acc_x 93.7500 (92.0833) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [20/33] time 0.384 (0.420) data 0.259 (0.293) loss_x loss_x 0.3228 (0.3513) acc_x 93.7500 (90.7812) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [25/33] time 0.399 (0.411) data 0.272 (0.286) loss_x loss_x 0.1454 (0.3402) acc_x 100.0000 (91.6250) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [30/33] time 0.361 (0.403) data 0.233 (0.277) loss_x loss_x 0.2910 (0.3303) acc_x 93.7500 (91.7708) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [5/17] time 0.386 (0.404) data 0.259 (0.279) loss_u loss_u 0.8560 (0.8514) acc_u 15.6250 (17.5000) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/17] time 0.374 (0.403) data 0.248 (0.277) loss_u loss_u 0.9248 (0.8656) acc_u 9.3750 (15.9375) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/17] time 0.418 (0.401) data 0.290 (0.275) loss_u loss_u 0.9307 (0.8660) acc_u 9.3750 (15.8333) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 255
confident_label rate tensor(0.6477, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1057
clean true:1054
clean false:3
clean_rate:0.9971617786187322
noisy true:323
noisy false:252
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 575
epoch [102/200] batch [5/33] time 0.426 (0.402) data 0.297 (0.283) loss_x loss_x 0.1324 (0.2714) acc_x 93.7500 (91.8750) lr 1.0000e-03 eta 0:00:11
epoch [102/200] batch [10/33] time 0.406 (0.400) data 0.280 (0.277) loss_x loss_x 0.3113 (0.3107) acc_x 93.7500 (92.1875) lr 1.0000e-03 eta 0:00:09
epoch [102/200] batch [15/33] time 0.352 (0.396) data 0.226 (0.273) loss_x loss_x 0.2296 (0.3478) acc_x 93.7500 (91.0417) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [20/33] time 0.414 (0.392) data 0.288 (0.268) loss_x loss_x 0.3215 (0.3149) acc_x 90.6250 (92.3438) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [25/33] time 0.446 (0.396) data 0.318 (0.272) loss_x loss_x 0.4026 (0.3229) acc_x 93.7500 (92.2500) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [30/33] time 0.419 (0.400) data 0.252 (0.275) loss_x loss_x 0.2098 (0.3223) acc_x 96.8750 (92.3958) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [5/17] time 0.390 (0.391) data 0.261 (0.266) loss_u loss_u 0.9482 (0.9304) acc_u 6.2500 (8.1250) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/17] time 0.418 (0.393) data 0.291 (0.268) loss_u loss_u 0.8765 (0.8986) acc_u 15.6250 (11.8750) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/17] time 0.417 (0.395) data 0.288 (0.270) loss_u loss_u 0.7622 (0.8767) acc_u 28.1250 (14.5833) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 246
confident_label rate tensor(0.6507, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1062
clean true:1060
clean false:2
clean_rate:0.9981167608286252
noisy true:326
noisy false:244
after delete: len(clean_dataset) 1062
after delete: len(noisy_dataset) 570
epoch [103/200] batch [5/33] time 0.451 (0.387) data 0.326 (0.279) loss_x loss_x 0.3430 (0.3241) acc_x 90.6250 (92.5000) lr 9.8429e-04 eta 0:00:10
epoch [103/200] batch [10/33] time 0.398 (0.404) data 0.276 (0.288) loss_x loss_x 0.1913 (0.3341) acc_x 96.8750 (92.5000) lr 9.8429e-04 eta 0:00:09
epoch [103/200] batch [15/33] time 0.423 (0.407) data 0.298 (0.288) loss_x loss_x 0.4570 (0.3133) acc_x 87.5000 (92.9167) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [20/33] time 0.413 (0.407) data 0.284 (0.286) loss_x loss_x 0.5415 (0.3121) acc_x 84.3750 (92.6562) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [25/33] time 0.396 (0.409) data 0.271 (0.288) loss_x loss_x 0.1641 (0.3113) acc_x 96.8750 (92.7500) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [30/33] time 0.453 (0.409) data 0.329 (0.286) loss_x loss_x 0.3025 (0.3098) acc_x 90.6250 (92.7083) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [5/17] time 0.383 (0.410) data 0.257 (0.289) loss_u loss_u 0.8794 (0.8946) acc_u 15.6250 (11.8750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [10/17] time 0.450 (0.412) data 0.322 (0.290) loss_u loss_u 0.8564 (0.8757) acc_u 18.7500 (14.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/17] time 0.352 (0.409) data 0.223 (0.286) loss_u loss_u 0.8789 (0.8842) acc_u 15.6250 (13.3333) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 235
confident_label rate tensor(0.6599, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1077
clean true:1074
clean false:3
clean_rate:0.9972144846796658
noisy true:323
noisy false:232
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 555
epoch [104/200] batch [5/33] time 0.399 (0.435) data 0.277 (0.310) loss_x loss_x 0.3401 (0.3151) acc_x 93.7500 (93.1250) lr 9.6859e-04 eta 0:00:12
epoch [104/200] batch [10/33] time 0.417 (0.429) data 0.292 (0.304) loss_x loss_x 0.3896 (0.3450) acc_x 96.8750 (93.4375) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [15/33] time 0.413 (0.432) data 0.285 (0.307) loss_x loss_x 0.5566 (0.3401) acc_x 87.5000 (92.7083) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [20/33] time 0.428 (0.436) data 0.300 (0.311) loss_x loss_x 0.2825 (0.3325) acc_x 93.7500 (92.3438) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [25/33] time 0.352 (0.426) data 0.232 (0.300) loss_x loss_x 0.1201 (0.3181) acc_x 100.0000 (92.6250) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [30/33] time 0.409 (0.421) data 0.283 (0.297) loss_x loss_x 0.2097 (0.2997) acc_x 96.8750 (92.9167) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [5/17] time 0.346 (0.422) data 0.218 (0.297) loss_u loss_u 0.9448 (0.9034) acc_u 6.2500 (11.8750) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/17] time 0.484 (0.424) data 0.357 (0.300) loss_u loss_u 0.9346 (0.9046) acc_u 9.3750 (11.5625) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/17] time 0.410 (0.422) data 0.287 (0.298) loss_u loss_u 0.8486 (0.9044) acc_u 18.7500 (11.8750) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 245
confident_label rate tensor(0.6513, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1063
clean true:1061
clean false:2
clean_rate:0.9981185324553151
noisy true:326
noisy false:243
after delete: len(clean_dataset) 1063
after delete: len(noisy_dataset) 569
epoch [105/200] batch [5/33] time 0.347 (0.375) data 0.222 (0.249) loss_x loss_x 0.4299 (0.3356) acc_x 87.5000 (91.2500) lr 9.5289e-04 eta 0:00:10
epoch [105/200] batch [10/33] time 0.437 (0.381) data 0.311 (0.254) loss_x loss_x 0.2524 (0.3296) acc_x 96.8750 (91.2500) lr 9.5289e-04 eta 0:00:08
epoch [105/200] batch [15/33] time 0.392 (0.405) data 0.265 (0.279) loss_x loss_x 0.2732 (0.3267) acc_x 93.7500 (91.2500) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [20/33] time 0.468 (0.414) data 0.346 (0.288) loss_x loss_x 0.2700 (0.3078) acc_x 93.7500 (91.7188) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [25/33] time 0.408 (0.420) data 0.280 (0.293) loss_x loss_x 0.2583 (0.3089) acc_x 90.6250 (91.2500) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [30/33] time 0.397 (0.417) data 0.272 (0.292) loss_x loss_x 0.3516 (0.3141) acc_x 96.8750 (91.8750) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [5/17] time 0.381 (0.411) data 0.253 (0.286) loss_u loss_u 0.8794 (0.8513) acc_u 12.5000 (16.2500) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/17] time 0.407 (0.409) data 0.280 (0.283) loss_u loss_u 0.9648 (0.8938) acc_u 3.1250 (11.5625) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/17] time 0.427 (0.412) data 0.303 (0.286) loss_u loss_u 0.8091 (0.8850) acc_u 25.0000 (13.3333) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.6477, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1057
clean true:1054
clean false:3
clean_rate:0.9971617786187322
noisy true:334
noisy false:241
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 575
epoch [106/200] batch [5/33] time 0.453 (0.450) data 0.328 (0.319) loss_x loss_x 0.2064 (0.2934) acc_x 96.8750 (93.1250) lr 9.3721e-04 eta 0:00:12
epoch [106/200] batch [10/33] time 0.441 (0.439) data 0.317 (0.311) loss_x loss_x 0.3486 (0.3000) acc_x 96.8750 (93.1250) lr 9.3721e-04 eta 0:00:10
epoch [106/200] batch [15/33] time 0.422 (0.441) data 0.294 (0.314) loss_x loss_x 0.1060 (0.2883) acc_x 100.0000 (93.7500) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [20/33] time 0.396 (0.437) data 0.270 (0.311) loss_x loss_x 0.2371 (0.2820) acc_x 93.7500 (93.9062) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [25/33] time 0.399 (0.429) data 0.270 (0.303) loss_x loss_x 0.1516 (0.2775) acc_x 100.0000 (94.1250) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [30/33] time 0.304 (0.418) data 0.218 (0.294) loss_x loss_x 0.5356 (0.2814) acc_x 90.6250 (94.2708) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [5/17] time 0.443 (0.422) data 0.313 (0.297) loss_u loss_u 0.8628 (0.8599) acc_u 15.6250 (16.2500) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/17] time 0.411 (0.425) data 0.285 (0.300) loss_u loss_u 0.8745 (0.8655) acc_u 12.5000 (15.0000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/17] time 0.460 (0.427) data 0.334 (0.302) loss_u loss_u 0.7773 (0.8677) acc_u 25.0000 (14.7917) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.6532, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1066
clean true:1063
clean false:3
clean_rate:0.9971857410881801
noisy true:328
noisy false:238
after delete: len(clean_dataset) 1066
after delete: len(noisy_dataset) 566
epoch [107/200] batch [5/33] time 0.403 (0.421) data 0.281 (0.295) loss_x loss_x 0.4026 (0.3314) acc_x 87.5000 (92.5000) lr 9.2154e-04 eta 0:00:11
epoch [107/200] batch [10/33] time 0.354 (0.406) data 0.228 (0.280) loss_x loss_x 0.3472 (0.3044) acc_x 90.6250 (93.4375) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [15/33] time 0.463 (0.419) data 0.336 (0.293) loss_x loss_x 0.1757 (0.2753) acc_x 96.8750 (93.5417) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [20/33] time 0.388 (0.420) data 0.261 (0.294) loss_x loss_x 0.3293 (0.3029) acc_x 90.6250 (92.9688) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [25/33] time 0.386 (0.408) data 0.262 (0.286) loss_x loss_x 0.1941 (0.3078) acc_x 96.8750 (93.1250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [30/33] time 0.465 (0.413) data 0.336 (0.290) loss_x loss_x 0.4329 (0.3044) acc_x 93.7500 (93.1250) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [5/17] time 0.440 (0.422) data 0.311 (0.298) loss_u loss_u 0.8267 (0.8720) acc_u 18.7500 (14.3750) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/17] time 0.384 (0.421) data 0.260 (0.297) loss_u loss_u 0.8799 (0.8649) acc_u 12.5000 (14.6875) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/17] time 0.473 (0.422) data 0.348 (0.297) loss_u loss_u 0.8916 (0.8678) acc_u 15.6250 (14.7917) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 258
confident_label rate tensor(0.6471, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1056
clean true:1053
clean false:3
clean_rate:0.9971590909090909
noisy true:321
noisy false:255
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 576
epoch [108/200] batch [5/33] time 0.424 (0.427) data 0.297 (0.301) loss_x loss_x 0.2947 (0.3649) acc_x 96.8750 (91.8750) lr 9.0589e-04 eta 0:00:11
epoch [108/200] batch [10/33] time 0.461 (0.443) data 0.337 (0.317) loss_x loss_x 0.2771 (0.3646) acc_x 93.7500 (91.2500) lr 9.0589e-04 eta 0:00:10
epoch [108/200] batch [15/33] time 0.423 (0.438) data 0.298 (0.312) loss_x loss_x 0.2959 (0.3454) acc_x 93.7500 (92.5000) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [20/33] time 0.356 (0.420) data 0.228 (0.293) loss_x loss_x 0.3125 (0.3522) acc_x 90.6250 (92.5000) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [25/33] time 0.424 (0.419) data 0.297 (0.293) loss_x loss_x 0.3416 (0.3427) acc_x 87.5000 (92.3750) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [30/33] time 0.394 (0.418) data 0.267 (0.293) loss_x loss_x 0.1869 (0.3295) acc_x 100.0000 (92.9167) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [5/18] time 0.410 (0.413) data 0.279 (0.287) loss_u loss_u 0.8457 (0.8613) acc_u 18.7500 (16.2500) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/18] time 0.382 (0.412) data 0.257 (0.286) loss_u loss_u 0.8447 (0.8705) acc_u 15.6250 (15.0000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/18] time 0.410 (0.411) data 0.283 (0.286) loss_u loss_u 0.8960 (0.8631) acc_u 9.3750 (15.6250) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 255
confident_label rate tensor(0.6471, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1056
clean true:1053
clean false:3
clean_rate:0.9971590909090909
noisy true:324
noisy false:252
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 576
epoch [109/200] batch [5/33] time 0.359 (0.419) data 0.234 (0.293) loss_x loss_x 0.4363 (0.2741) acc_x 90.6250 (95.0000) lr 8.9027e-04 eta 0:00:11
epoch [109/200] batch [10/33] time 0.369 (0.400) data 0.245 (0.274) loss_x loss_x 0.1898 (0.2835) acc_x 96.8750 (94.3750) lr 8.9027e-04 eta 0:00:09
epoch [109/200] batch [15/33] time 0.379 (0.401) data 0.255 (0.275) loss_x loss_x 0.2109 (0.2960) acc_x 96.8750 (93.5417) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [20/33] time 0.393 (0.398) data 0.265 (0.272) loss_x loss_x 0.2905 (0.2905) acc_x 90.6250 (93.4375) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [25/33] time 0.402 (0.397) data 0.277 (0.271) loss_x loss_x 0.1627 (0.3056) acc_x 96.8750 (92.8750) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [30/33] time 0.408 (0.397) data 0.285 (0.272) loss_x loss_x 0.1340 (0.2974) acc_x 100.0000 (93.5417) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [5/18] time 0.439 (0.400) data 0.308 (0.274) loss_u loss_u 0.9102 (0.8530) acc_u 9.3750 (18.1250) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/18] time 0.419 (0.402) data 0.291 (0.276) loss_u loss_u 0.8813 (0.8673) acc_u 12.5000 (15.9375) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [15/18] time 0.409 (0.404) data 0.280 (0.278) loss_u loss_u 0.9248 (0.8724) acc_u 6.2500 (15.2083) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 220
confident_label rate tensor(0.6673, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1089
clean true:1085
clean false:4
clean_rate:0.9963269054178145
noisy true:327
noisy false:216
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 543
epoch [110/200] batch [5/34] time 0.400 (0.413) data 0.271 (0.280) loss_x loss_x 0.1366 (0.3418) acc_x 96.8750 (92.5000) lr 8.7467e-04 eta 0:00:11
epoch [110/200] batch [10/34] time 0.427 (0.412) data 0.302 (0.282) loss_x loss_x 0.5049 (0.3161) acc_x 90.6250 (93.4375) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [15/34] time 0.398 (0.414) data 0.269 (0.286) loss_x loss_x 0.2216 (0.2957) acc_x 96.8750 (93.5417) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [20/34] time 0.358 (0.412) data 0.236 (0.285) loss_x loss_x 0.6294 (0.3064) acc_x 84.3750 (93.1250) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [25/34] time 0.379 (0.404) data 0.250 (0.277) loss_x loss_x 0.2727 (0.2994) acc_x 90.6250 (92.8750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [30/34] time 0.395 (0.403) data 0.270 (0.276) loss_x loss_x 0.2720 (0.2963) acc_x 90.6250 (92.6042) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [5/16] time 0.371 (0.401) data 0.243 (0.275) loss_u loss_u 0.9326 (0.9082) acc_u 6.2500 (10.6250) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/16] time 0.401 (0.399) data 0.272 (0.273) loss_u loss_u 0.8833 (0.9013) acc_u 12.5000 (11.8750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/16] time 0.396 (0.396) data 0.270 (0.270) loss_u loss_u 0.9453 (0.8967) acc_u 6.2500 (12.5000) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 226
confident_label rate tensor(0.6630, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1082
clean true:1079
clean false:3
clean_rate:0.9972273567467652
noisy true:327
noisy false:223
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 550
epoch [111/200] batch [5/33] time 0.414 (0.425) data 0.286 (0.299) loss_x loss_x 0.1565 (0.4414) acc_x 96.8750 (90.0000) lr 8.5910e-04 eta 0:00:11
epoch [111/200] batch [10/33] time 0.427 (0.424) data 0.301 (0.298) loss_x loss_x 0.2795 (0.3662) acc_x 93.7500 (92.1875) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [15/33] time 0.442 (0.430) data 0.314 (0.304) loss_x loss_x 0.3481 (0.3430) acc_x 90.6250 (92.2917) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [20/33] time 0.382 (0.428) data 0.258 (0.301) loss_x loss_x 0.1575 (0.3258) acc_x 96.8750 (92.8125) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [25/33] time 0.418 (0.420) data 0.294 (0.296) loss_x loss_x 0.3843 (0.3310) acc_x 90.6250 (92.3750) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [30/33] time 0.447 (0.420) data 0.323 (0.295) loss_x loss_x 0.1096 (0.3340) acc_x 100.0000 (92.6042) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [5/17] time 0.378 (0.410) data 0.253 (0.285) loss_u loss_u 0.8472 (0.8953) acc_u 18.7500 (11.8750) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/17] time 0.415 (0.412) data 0.290 (0.287) loss_u loss_u 0.8877 (0.8887) acc_u 12.5000 (13.1250) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/17] time 0.418 (0.414) data 0.291 (0.288) loss_u loss_u 0.8599 (0.8881) acc_u 18.7500 (13.5417) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.6483, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1058
clean true:1054
clean false:4
clean_rate:0.996219281663516
noisy true:331
noisy false:243
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 574
epoch [112/200] batch [5/33] time 0.378 (0.414) data 0.301 (0.296) loss_x loss_x 0.2695 (0.3403) acc_x 93.7500 (92.5000) lr 8.4357e-04 eta 0:00:11
epoch [112/200] batch [10/33] time 0.420 (0.423) data 0.297 (0.302) loss_x loss_x 0.3486 (0.3507) acc_x 90.6250 (92.5000) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [15/33] time 0.367 (0.414) data 0.242 (0.292) loss_x loss_x 0.3259 (0.3378) acc_x 90.6250 (92.7083) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [20/33] time 0.462 (0.408) data 0.336 (0.284) loss_x loss_x 0.2058 (0.3213) acc_x 93.7500 (92.8125) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [25/33] time 0.404 (0.409) data 0.277 (0.285) loss_x loss_x 0.3320 (0.3230) acc_x 93.7500 (93.0000) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [30/33] time 0.412 (0.411) data 0.287 (0.286) loss_x loss_x 0.5796 (0.3415) acc_x 90.6250 (92.3958) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [5/17] time 0.400 (0.408) data 0.274 (0.284) loss_u loss_u 0.9097 (0.8516) acc_u 9.3750 (16.8750) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/17] time 0.405 (0.407) data 0.280 (0.284) loss_u loss_u 0.8896 (0.8695) acc_u 12.5000 (15.3125) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/17] time 0.403 (0.409) data 0.278 (0.285) loss_u loss_u 0.8359 (0.8682) acc_u 15.6250 (15.0000) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.6642, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1084
clean true:1082
clean false:2
clean_rate:0.9981549815498155
noisy true:321
noisy false:227
after delete: len(clean_dataset) 1084
after delete: len(noisy_dataset) 548
epoch [113/200] batch [5/33] time 0.430 (0.423) data 0.306 (0.298) loss_x loss_x 0.3020 (0.2676) acc_x 90.6250 (94.3750) lr 8.2807e-04 eta 0:00:11
epoch [113/200] batch [10/33] time 0.407 (0.412) data 0.283 (0.294) loss_x loss_x 0.1698 (0.2750) acc_x 96.8750 (94.3750) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [15/33] time 0.398 (0.411) data 0.273 (0.291) loss_x loss_x 0.1705 (0.2727) acc_x 96.8750 (93.7500) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [20/33] time 0.387 (0.411) data 0.264 (0.291) loss_x loss_x 0.2534 (0.2943) acc_x 93.7500 (93.1250) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [25/33] time 0.418 (0.413) data 0.295 (0.291) loss_x loss_x 0.2441 (0.2975) acc_x 96.8750 (93.1250) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [30/33] time 0.402 (0.411) data 0.278 (0.289) loss_x loss_x 0.1080 (0.2797) acc_x 100.0000 (93.7500) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [5/17] time 0.388 (0.409) data 0.263 (0.286) loss_u loss_u 0.9038 (0.9305) acc_u 9.3750 (8.7500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/17] time 0.364 (0.408) data 0.236 (0.284) loss_u loss_u 0.8809 (0.9078) acc_u 12.5000 (11.5625) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/17] time 0.384 (0.405) data 0.255 (0.281) loss_u loss_u 0.8633 (0.8962) acc_u 12.5000 (12.2917) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.6587, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1075
clean true:1072
clean false:3
clean_rate:0.9972093023255814
noisy true:331
noisy false:226
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 557
epoch [114/200] batch [5/33] time 0.411 (0.417) data 0.281 (0.291) loss_x loss_x 0.1716 (0.2578) acc_x 96.8750 (95.0000) lr 8.1262e-04 eta 0:00:11
epoch [114/200] batch [10/33] time 0.434 (0.418) data 0.307 (0.292) loss_x loss_x 0.3745 (0.2621) acc_x 90.6250 (94.0625) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [15/33] time 0.414 (0.415) data 0.290 (0.289) loss_x loss_x 0.1376 (0.2580) acc_x 100.0000 (94.7917) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [20/33] time 0.417 (0.410) data 0.295 (0.287) loss_x loss_x 0.5088 (0.2751) acc_x 81.2500 (93.5938) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [25/33] time 0.381 (0.404) data 0.252 (0.281) loss_x loss_x 0.1534 (0.2851) acc_x 100.0000 (93.2500) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [30/33] time 0.397 (0.398) data 0.272 (0.274) loss_x loss_x 0.3745 (0.2947) acc_x 90.6250 (93.0208) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [5/17] time 0.488 (0.401) data 0.362 (0.277) loss_u loss_u 0.8926 (0.8650) acc_u 12.5000 (15.0000) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/17] time 0.425 (0.404) data 0.270 (0.279) loss_u loss_u 0.9639 (0.8607) acc_u 3.1250 (16.2500) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/17] time 0.417 (0.405) data 0.292 (0.280) loss_u loss_u 0.9409 (0.8767) acc_u 9.3750 (14.5833) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.6618, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1080
clean true:1078
clean false:2
clean_rate:0.9981481481481481
noisy true:315
noisy false:237
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 552
epoch [115/200] batch [5/33] time 0.320 (0.422) data 0.243 (0.305) loss_x loss_x 0.6089 (0.3670) acc_x 90.6250 (91.8750) lr 7.9721e-04 eta 0:00:11
epoch [115/200] batch [10/33] time 0.376 (0.400) data 0.251 (0.277) loss_x loss_x 0.3296 (0.3288) acc_x 93.7500 (91.2500) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [15/33] time 0.387 (0.397) data 0.263 (0.274) loss_x loss_x 0.3103 (0.3068) acc_x 90.6250 (92.2917) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [20/33] time 0.411 (0.404) data 0.285 (0.281) loss_x loss_x 0.2927 (0.3063) acc_x 93.7500 (92.3438) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [25/33] time 0.427 (0.417) data 0.302 (0.293) loss_x loss_x 0.2939 (0.3007) acc_x 96.8750 (92.6250) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [30/33] time 0.418 (0.416) data 0.280 (0.292) loss_x loss_x 0.3770 (0.3035) acc_x 87.5000 (92.5000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [5/17] time 0.400 (0.413) data 0.269 (0.288) loss_u loss_u 0.9473 (0.9290) acc_u 9.3750 (10.0000) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/17] time 0.406 (0.410) data 0.278 (0.285) loss_u loss_u 0.9194 (0.9101) acc_u 9.3750 (10.9375) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/17] time 0.420 (0.408) data 0.294 (0.283) loss_u loss_u 0.8364 (0.9048) acc_u 25.0000 (11.6667) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.6562, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1071
clean true:1068
clean false:3
clean_rate:0.9971988795518207
noisy true:336
noisy false:225
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 561
epoch [116/200] batch [5/33] time 0.407 (0.385) data 0.284 (0.270) loss_x loss_x 0.2123 (0.3084) acc_x 93.7500 (91.8750) lr 7.8186e-04 eta 0:00:10
epoch [116/200] batch [10/33] time 0.386 (0.404) data 0.260 (0.283) loss_x loss_x 0.2043 (0.2823) acc_x 96.8750 (92.5000) lr 7.8186e-04 eta 0:00:09
epoch [116/200] batch [15/33] time 0.319 (0.401) data 0.240 (0.282) loss_x loss_x 0.2976 (0.2887) acc_x 90.6250 (92.5000) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [20/33] time 0.498 (0.415) data 0.376 (0.295) loss_x loss_x 0.1687 (0.2698) acc_x 96.8750 (93.2812) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [25/33] time 0.413 (0.419) data 0.289 (0.297) loss_x loss_x 0.2344 (0.2767) acc_x 93.7500 (93.1250) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [30/33] time 0.454 (0.423) data 0.329 (0.301) loss_x loss_x 0.3362 (0.2969) acc_x 90.6250 (92.3958) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [5/17] time 0.370 (0.419) data 0.243 (0.296) loss_u loss_u 0.8682 (0.8921) acc_u 12.5000 (13.1250) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/17] time 0.404 (0.415) data 0.273 (0.291) loss_u loss_u 0.9355 (0.8852) acc_u 6.2500 (13.7500) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/17] time 0.426 (0.413) data 0.303 (0.289) loss_u loss_u 0.9053 (0.8870) acc_u 12.5000 (13.1250) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.6520, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1064
clean true:1060
clean false:4
clean_rate:0.9962406015037594
noisy true:334
noisy false:234
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 568
epoch [117/200] batch [5/33] time 0.399 (0.372) data 0.275 (0.247) loss_x loss_x 0.2098 (0.2965) acc_x 93.7500 (93.1250) lr 7.6655e-04 eta 0:00:10
epoch [117/200] batch [10/33] time 0.444 (0.397) data 0.315 (0.271) loss_x loss_x 0.2600 (0.2630) acc_x 93.7500 (93.4375) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [15/33] time 0.358 (0.400) data 0.261 (0.275) loss_x loss_x 0.2517 (0.2667) acc_x 90.6250 (93.5417) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [20/33] time 0.369 (0.399) data 0.246 (0.274) loss_x loss_x 0.6421 (0.2938) acc_x 90.6250 (93.4375) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [25/33] time 0.391 (0.399) data 0.266 (0.274) loss_x loss_x 0.3760 (0.3054) acc_x 90.6250 (93.0000) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [30/33] time 0.390 (0.397) data 0.265 (0.272) loss_x loss_x 0.1818 (0.3027) acc_x 93.7500 (93.1250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [5/17] time 0.416 (0.399) data 0.290 (0.274) loss_u loss_u 0.9072 (0.8634) acc_u 9.3750 (15.0000) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [10/17] time 0.387 (0.398) data 0.258 (0.273) loss_u loss_u 0.9312 (0.8841) acc_u 9.3750 (13.1250) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/17] time 0.411 (0.399) data 0.276 (0.273) loss_u loss_u 0.7964 (0.8714) acc_u 21.8750 (14.7917) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.6624, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1081
clean true:1079
clean false:2
clean_rate:0.9981498612395929
noisy true:341
noisy false:210
after delete: len(clean_dataset) 1081
after delete: len(noisy_dataset) 551
epoch [118/200] batch [5/33] time 0.399 (0.405) data 0.273 (0.279) loss_x loss_x 0.5103 (0.3275) acc_x 87.5000 (91.8750) lr 7.5131e-04 eta 0:00:11
epoch [118/200] batch [10/33] time 0.403 (0.387) data 0.277 (0.261) loss_x loss_x 0.2766 (0.3152) acc_x 93.7500 (92.8125) lr 7.5131e-04 eta 0:00:08
epoch [118/200] batch [15/33] time 0.406 (0.390) data 0.279 (0.264) loss_x loss_x 0.1796 (0.3235) acc_x 96.8750 (92.2917) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [20/33] time 0.402 (0.391) data 0.276 (0.268) loss_x loss_x 0.2446 (0.2949) acc_x 90.6250 (92.8125) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [25/33] time 0.400 (0.394) data 0.277 (0.269) loss_x loss_x 0.3782 (0.3090) acc_x 87.5000 (92.1250) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [30/33] time 0.399 (0.395) data 0.274 (0.271) loss_x loss_x 0.1530 (0.3257) acc_x 96.8750 (91.8750) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [5/17] time 0.398 (0.397) data 0.272 (0.272) loss_u loss_u 0.8813 (0.9009) acc_u 15.6250 (11.2500) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/17] time 0.361 (0.396) data 0.283 (0.272) loss_u loss_u 0.9277 (0.8889) acc_u 6.2500 (12.1875) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/17] time 0.412 (0.396) data 0.287 (0.272) loss_u loss_u 0.9126 (0.8882) acc_u 12.5000 (12.2917) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.6618, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1080
clean true:1077
clean false:3
clean_rate:0.9972222222222222
noisy true:331
noisy false:221
after delete: len(clean_dataset) 1080
after delete: len(noisy_dataset) 552
epoch [119/200] batch [5/33] time 0.347 (0.380) data 0.221 (0.256) loss_x loss_x 0.3184 (0.2660) acc_x 96.8750 (94.3750) lr 7.3613e-04 eta 0:00:10
epoch [119/200] batch [10/33] time 0.388 (0.378) data 0.261 (0.253) loss_x loss_x 0.3506 (0.3137) acc_x 87.5000 (92.1875) lr 7.3613e-04 eta 0:00:08
epoch [119/200] batch [15/33] time 0.377 (0.374) data 0.248 (0.252) loss_x loss_x 0.6382 (0.3248) acc_x 84.3750 (91.8750) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [20/33] time 0.351 (0.373) data 0.227 (0.250) loss_x loss_x 0.4287 (0.3129) acc_x 93.7500 (92.8125) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [25/33] time 0.450 (0.384) data 0.322 (0.262) loss_x loss_x 0.3101 (0.3041) acc_x 93.7500 (93.2500) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [30/33] time 0.416 (0.390) data 0.292 (0.267) loss_x loss_x 0.3196 (0.3026) acc_x 87.5000 (93.0208) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [5/17] time 0.446 (0.389) data 0.318 (0.267) loss_u loss_u 0.9556 (0.8983) acc_u 6.2500 (11.8750) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/17] time 0.441 (0.396) data 0.318 (0.274) loss_u loss_u 0.8208 (0.9004) acc_u 21.8750 (11.5625) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/17] time 0.431 (0.399) data 0.305 (0.276) loss_u loss_u 0.8730 (0.8999) acc_u 15.6250 (12.0833) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 217
confident_label rate tensor(0.6661, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1087
clean true:1083
clean false:4
clean_rate:0.9963201471941122
noisy true:332
noisy false:213
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 545
epoch [120/200] batch [5/33] time 0.406 (0.426) data 0.284 (0.302) loss_x loss_x 0.1820 (0.3365) acc_x 96.8750 (92.5000) lr 7.2101e-04 eta 0:00:11
epoch [120/200] batch [10/33] time 0.409 (0.419) data 0.284 (0.295) loss_x loss_x 0.2710 (0.3103) acc_x 93.7500 (91.5625) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [15/33] time 0.351 (0.411) data 0.224 (0.286) loss_x loss_x 0.3638 (0.3395) acc_x 96.8750 (91.8750) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [20/33] time 0.390 (0.399) data 0.263 (0.273) loss_x loss_x 0.4299 (0.3195) acc_x 87.5000 (92.3438) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [25/33] time 0.395 (0.397) data 0.267 (0.271) loss_x loss_x 0.1307 (0.3437) acc_x 96.8750 (91.5000) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [30/33] time 0.407 (0.398) data 0.282 (0.272) loss_x loss_x 0.2356 (0.3377) acc_x 93.7500 (91.7708) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [5/17] time 0.388 (0.397) data 0.260 (0.271) loss_u loss_u 0.9302 (0.8915) acc_u 6.2500 (11.8750) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/17] time 0.400 (0.398) data 0.270 (0.272) loss_u loss_u 0.9121 (0.8835) acc_u 12.5000 (12.8125) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/17] time 0.417 (0.399) data 0.289 (0.274) loss_u loss_u 0.8965 (0.8960) acc_u 9.3750 (11.0417) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1094
clean false:4
clean_rate:0.9963570127504554
noisy true:342
noisy false:192
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [121/200] batch [5/34] time 0.468 (0.459) data 0.344 (0.334) loss_x loss_x 0.2302 (0.2843) acc_x 96.8750 (92.5000) lr 7.0596e-04 eta 0:00:13
epoch [121/200] batch [10/34] time 0.436 (0.445) data 0.311 (0.320) loss_x loss_x 0.1742 (0.2533) acc_x 96.8750 (93.7500) lr 7.0596e-04 eta 0:00:10
epoch [121/200] batch [15/34] time 0.446 (0.446) data 0.324 (0.322) loss_x loss_x 0.1593 (0.2877) acc_x 100.0000 (93.7500) lr 7.0596e-04 eta 0:00:08
epoch [121/200] batch [20/34] time 0.355 (0.435) data 0.230 (0.312) loss_x loss_x 0.2435 (0.3107) acc_x 96.8750 (93.2812) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [25/34] time 0.364 (0.421) data 0.241 (0.298) loss_x loss_x 0.3152 (0.3116) acc_x 93.7500 (93.1250) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [30/34] time 0.353 (0.410) data 0.223 (0.286) loss_x loss_x 0.3665 (0.3121) acc_x 90.6250 (92.9167) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [5/16] time 0.417 (0.411) data 0.289 (0.286) loss_u loss_u 0.8369 (0.8713) acc_u 21.8750 (16.2500) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/16] time 0.374 (0.412) data 0.246 (0.287) loss_u loss_u 0.9102 (0.9020) acc_u 9.3750 (11.5625) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/16] time 0.378 (0.407) data 0.276 (0.282) loss_u loss_u 0.9019 (0.9037) acc_u 12.5000 (11.4583) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 212
confident_label rate tensor(0.6697, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1093
clean true:1090
clean false:3
clean_rate:0.9972552607502287
noisy true:330
noisy false:209
after delete: len(clean_dataset) 1093
after delete: len(noisy_dataset) 539
epoch [122/200] batch [5/34] time 0.398 (0.396) data 0.271 (0.271) loss_x loss_x 0.3003 (0.2745) acc_x 90.6250 (93.1250) lr 6.9098e-04 eta 0:00:11
epoch [122/200] batch [10/34] time 0.413 (0.392) data 0.290 (0.272) loss_x loss_x 0.3215 (0.2893) acc_x 93.7500 (93.4375) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [15/34] time 0.418 (0.402) data 0.294 (0.280) loss_x loss_x 0.3445 (0.2801) acc_x 90.6250 (93.5417) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [20/34] time 0.419 (0.402) data 0.293 (0.280) loss_x loss_x 0.2103 (0.2750) acc_x 93.7500 (93.5938) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [25/34] time 0.405 (0.404) data 0.281 (0.280) loss_x loss_x 0.2455 (0.2745) acc_x 93.7500 (93.3750) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [30/34] time 0.299 (0.398) data 0.221 (0.277) loss_x loss_x 0.1360 (0.2613) acc_x 96.8750 (93.9583) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [5/16] time 0.376 (0.395) data 0.248 (0.272) loss_u loss_u 0.9375 (0.9341) acc_u 6.2500 (7.5000) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/16] time 0.384 (0.394) data 0.257 (0.271) loss_u loss_u 0.8716 (0.9070) acc_u 15.6250 (11.2500) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/16] time 0.421 (0.396) data 0.295 (0.272) loss_u loss_u 0.8975 (0.9005) acc_u 9.3750 (12.0833) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.6673, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1089
clean true:1085
clean false:4
clean_rate:0.9963269054178145
noisy true:334
noisy false:209
after delete: len(clean_dataset) 1089
after delete: len(noisy_dataset) 543
epoch [123/200] batch [5/34] time 0.411 (0.387) data 0.286 (0.263) loss_x loss_x 0.1676 (0.2673) acc_x 93.7500 (93.1250) lr 6.7608e-04 eta 0:00:11
epoch [123/200] batch [10/34] time 0.426 (0.404) data 0.302 (0.279) loss_x loss_x 0.1306 (0.2830) acc_x 96.8750 (92.1875) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [15/34] time 0.373 (0.411) data 0.247 (0.286) loss_x loss_x 0.1388 (0.2772) acc_x 96.8750 (92.7083) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [20/34] time 0.440 (0.406) data 0.313 (0.280) loss_x loss_x 0.2766 (0.2800) acc_x 93.7500 (92.5000) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [25/34] time 0.463 (0.412) data 0.337 (0.287) loss_x loss_x 0.5781 (0.2895) acc_x 87.5000 (92.7500) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [30/34] time 0.484 (0.419) data 0.357 (0.293) loss_x loss_x 0.3250 (0.2817) acc_x 93.7500 (93.1250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [5/16] time 0.392 (0.416) data 0.265 (0.292) loss_u loss_u 0.8535 (0.8932) acc_u 15.6250 (11.2500) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/16] time 0.401 (0.412) data 0.273 (0.287) loss_u loss_u 0.9067 (0.9158) acc_u 12.5000 (9.6875) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/16] time 0.412 (0.411) data 0.282 (0.285) loss_u loss_u 0.9092 (0.9036) acc_u 12.5000 (11.4583) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 217
confident_label rate tensor(0.6636, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1083
clean true:1080
clean false:3
clean_rate:0.997229916897507
noisy true:335
noisy false:214
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 549
epoch [124/200] batch [5/33] time 0.351 (0.354) data 0.225 (0.230) loss_x loss_x 0.2120 (0.2208) acc_x 93.7500 (95.0000) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [10/33] time 0.440 (0.382) data 0.314 (0.262) loss_x loss_x 0.3623 (0.2505) acc_x 87.5000 (94.0625) lr 6.6126e-04 eta 0:00:08
epoch [124/200] batch [15/33] time 0.445 (0.404) data 0.323 (0.282) loss_x loss_x 0.1948 (0.2895) acc_x 96.8750 (93.5417) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [20/33] time 0.399 (0.407) data 0.276 (0.284) loss_x loss_x 0.5474 (0.3202) acc_x 75.0000 (92.5000) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [25/33] time 0.429 (0.409) data 0.305 (0.286) loss_x loss_x 0.3286 (0.3297) acc_x 87.5000 (92.3750) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [30/33] time 0.407 (0.412) data 0.282 (0.288) loss_x loss_x 0.5479 (0.3469) acc_x 90.6250 (92.0833) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [5/17] time 0.354 (0.406) data 0.227 (0.282) loss_u loss_u 0.8140 (0.8771) acc_u 21.8750 (14.3750) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/17] time 0.360 (0.400) data 0.282 (0.276) loss_u loss_u 0.8779 (0.8943) acc_u 12.5000 (11.8750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/17] time 0.406 (0.403) data 0.280 (0.279) loss_u loss_u 0.8896 (0.8891) acc_u 15.6250 (13.1250) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 227
confident_label rate tensor(0.6556, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1070
clean true:1069
clean false:1
clean_rate:0.9990654205607477
noisy true:336
noisy false:226
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 562
epoch [125/200] batch [5/33] time 0.396 (0.405) data 0.270 (0.280) loss_x loss_x 0.1860 (0.2701) acc_x 96.8750 (94.3750) lr 6.4653e-04 eta 0:00:11
epoch [125/200] batch [10/33] time 0.389 (0.409) data 0.265 (0.283) loss_x loss_x 0.3125 (0.3252) acc_x 87.5000 (93.1250) lr 6.4653e-04 eta 0:00:09
epoch [125/200] batch [15/33] time 0.410 (0.409) data 0.284 (0.283) loss_x loss_x 0.1957 (0.2759) acc_x 96.8750 (94.3750) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [20/33] time 0.364 (0.406) data 0.286 (0.283) loss_x loss_x 0.1221 (0.2843) acc_x 96.8750 (94.2188) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [25/33] time 0.396 (0.407) data 0.271 (0.284) loss_x loss_x 0.3835 (0.2832) acc_x 87.5000 (94.1250) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [30/33] time 0.399 (0.407) data 0.274 (0.283) loss_x loss_x 0.1487 (0.3015) acc_x 93.7500 (93.4375) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [5/17] time 0.352 (0.398) data 0.227 (0.273) loss_u loss_u 0.7451 (0.8628) acc_u 28.1250 (15.6250) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/17] time 0.397 (0.398) data 0.269 (0.273) loss_u loss_u 0.9009 (0.8748) acc_u 9.3750 (14.3750) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/17] time 0.450 (0.399) data 0.294 (0.274) loss_u loss_u 0.8931 (0.8812) acc_u 12.5000 (13.5417) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 216
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1085
clean false:3
clean_rate:0.9972426470588235
noisy true:331
noisy false:213
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [126/200] batch [5/34] time 0.451 (0.443) data 0.324 (0.318) loss_x loss_x 0.1283 (0.2809) acc_x 100.0000 (93.7500) lr 6.3188e-04 eta 0:00:12
epoch [126/200] batch [10/34] time 0.430 (0.431) data 0.300 (0.305) loss_x loss_x 0.1827 (0.2871) acc_x 96.8750 (93.7500) lr 6.3188e-04 eta 0:00:10
epoch [126/200] batch [15/34] time 0.366 (0.428) data 0.238 (0.301) loss_x loss_x 0.1987 (0.3153) acc_x 96.8750 (92.2917) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [20/34] time 0.356 (0.410) data 0.231 (0.283) loss_x loss_x 0.6167 (0.3155) acc_x 84.3750 (92.3438) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [25/34] time 0.435 (0.412) data 0.305 (0.285) loss_x loss_x 0.2952 (0.3019) acc_x 96.8750 (92.6250) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [30/34] time 0.400 (0.411) data 0.274 (0.284) loss_x loss_x 0.3547 (0.3093) acc_x 90.6250 (92.3958) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [5/17] time 0.342 (0.407) data 0.264 (0.282) loss_u loss_u 0.8877 (0.9171) acc_u 12.5000 (11.8750) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/17] time 0.381 (0.404) data 0.257 (0.279) loss_u loss_u 0.8491 (0.9001) acc_u 18.7500 (12.5000) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/17] time 0.400 (0.403) data 0.273 (0.278) loss_u loss_u 0.9229 (0.9039) acc_u 9.3750 (11.8750) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 216
confident_label rate tensor(0.6648, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1085
clean true:1082
clean false:3
clean_rate:0.9972350230414746
noisy true:334
noisy false:213
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 547
epoch [127/200] batch [5/33] time 0.400 (0.406) data 0.273 (0.280) loss_x loss_x 0.4246 (0.3468) acc_x 93.7500 (93.7500) lr 6.1732e-04 eta 0:00:11
epoch [127/200] batch [10/33] time 0.468 (0.422) data 0.344 (0.296) loss_x loss_x 0.2196 (0.3166) acc_x 93.7500 (93.4375) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [15/33] time 0.401 (0.414) data 0.275 (0.287) loss_x loss_x 0.0747 (0.3233) acc_x 100.0000 (93.5417) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [20/33] time 0.413 (0.406) data 0.289 (0.280) loss_x loss_x 0.2040 (0.3119) acc_x 96.8750 (93.4375) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [25/33] time 0.424 (0.407) data 0.298 (0.280) loss_x loss_x 0.3049 (0.3039) acc_x 90.6250 (93.6250) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [30/33] time 0.408 (0.408) data 0.283 (0.283) loss_x loss_x 0.1758 (0.3029) acc_x 96.8750 (93.3333) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [5/17] time 0.416 (0.409) data 0.287 (0.284) loss_u loss_u 0.9253 (0.9245) acc_u 9.3750 (9.3750) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/17] time 0.391 (0.408) data 0.263 (0.282) loss_u loss_u 0.7891 (0.8926) acc_u 25.0000 (12.5000) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/17] time 0.367 (0.404) data 0.239 (0.278) loss_u loss_u 0.9346 (0.8991) acc_u 9.3750 (11.8750) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.6654, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1086
clean true:1083
clean false:3
clean_rate:0.9972375690607734
noisy true:324
noisy false:222
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 546
epoch [128/200] batch [5/33] time 0.416 (0.414) data 0.288 (0.288) loss_x loss_x 0.3687 (0.3355) acc_x 93.7500 (92.5000) lr 6.0285e-04 eta 0:00:11
epoch [128/200] batch [10/33] time 0.408 (0.413) data 0.281 (0.287) loss_x loss_x 0.1914 (0.2636) acc_x 93.7500 (94.6875) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [15/33] time 0.417 (0.417) data 0.288 (0.290) loss_x loss_x 0.1727 (0.2946) acc_x 96.8750 (94.1667) lr 6.0285e-04 eta 0:00:07
epoch [128/200] batch [20/33] time 0.434 (0.415) data 0.307 (0.291) loss_x loss_x 0.3394 (0.3123) acc_x 96.8750 (93.7500) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [25/33] time 0.415 (0.415) data 0.290 (0.291) loss_x loss_x 0.2443 (0.2890) acc_x 90.6250 (93.8750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [30/33] time 0.418 (0.414) data 0.292 (0.289) loss_x loss_x 0.2927 (0.2904) acc_x 93.7500 (93.8542) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [5/17] time 0.401 (0.412) data 0.275 (0.287) loss_u loss_u 0.9067 (0.8985) acc_u 9.3750 (10.6250) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/17] time 0.424 (0.412) data 0.294 (0.288) loss_u loss_u 0.8711 (0.8958) acc_u 15.6250 (11.5625) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/17] time 0.360 (0.408) data 0.232 (0.283) loss_u loss_u 0.9160 (0.8976) acc_u 9.3750 (11.6667) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.6562, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1071
clean true:1069
clean false:2
clean_rate:0.9981325863678805
noisy true:334
noisy false:227
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 561
epoch [129/200] batch [5/33] time 0.389 (0.413) data 0.265 (0.286) loss_x loss_x 0.6963 (0.3993) acc_x 84.3750 (91.2500) lr 5.8849e-04 eta 0:00:11
epoch [129/200] batch [10/33] time 0.305 (0.380) data 0.226 (0.258) loss_x loss_x 0.4966 (0.3709) acc_x 84.3750 (90.6250) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [15/33] time 0.408 (0.387) data 0.281 (0.264) loss_x loss_x 0.1616 (0.3256) acc_x 93.7500 (91.4583) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [20/33] time 0.377 (0.389) data 0.253 (0.265) loss_x loss_x 0.2080 (0.3336) acc_x 93.7500 (91.4062) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [25/33] time 0.414 (0.395) data 0.292 (0.271) loss_x loss_x 0.3782 (0.3442) acc_x 87.5000 (91.1250) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [30/33] time 0.411 (0.399) data 0.288 (0.275) loss_x loss_x 0.1569 (0.3263) acc_x 96.8750 (91.5625) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [5/17] time 0.407 (0.399) data 0.282 (0.276) loss_u loss_u 0.9370 (0.8874) acc_u 6.2500 (12.5000) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [10/17] time 0.433 (0.401) data 0.306 (0.277) loss_u loss_u 0.8188 (0.8863) acc_u 18.7500 (12.5000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/17] time 0.395 (0.400) data 0.271 (0.276) loss_u loss_u 0.8940 (0.8856) acc_u 12.5000 (12.7083) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 193
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1099
clean false:3
clean_rate:0.9972776769509982
noisy true:340
noisy false:190
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [130/200] batch [5/34] time 0.469 (0.456) data 0.343 (0.330) loss_x loss_x 0.1654 (0.3714) acc_x 100.0000 (93.1250) lr 5.7422e-04 eta 0:00:13
epoch [130/200] batch [10/34] time 0.500 (0.457) data 0.374 (0.333) loss_x loss_x 0.2559 (0.3180) acc_x 96.8750 (93.1250) lr 5.7422e-04 eta 0:00:10
epoch [130/200] batch [15/34] time 0.431 (0.443) data 0.303 (0.318) loss_x loss_x 0.2798 (0.2928) acc_x 87.5000 (92.9167) lr 5.7422e-04 eta 0:00:08
epoch [130/200] batch [20/34] time 0.450 (0.443) data 0.323 (0.318) loss_x loss_x 0.1159 (0.2694) acc_x 100.0000 (94.0625) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [25/34] time 0.480 (0.446) data 0.354 (0.320) loss_x loss_x 0.1769 (0.2558) acc_x 100.0000 (94.5000) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [30/34] time 0.405 (0.441) data 0.281 (0.317) loss_x loss_x 0.5566 (0.2655) acc_x 84.3750 (94.3750) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [5/16] time 0.347 (0.433) data 0.218 (0.308) loss_u loss_u 0.8862 (0.9317) acc_u 15.6250 (8.7500) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/16] time 0.489 (0.435) data 0.362 (0.310) loss_u loss_u 0.8403 (0.9220) acc_u 18.7500 (9.3750) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/16] time 0.391 (0.434) data 0.263 (0.309) loss_u loss_u 0.9399 (0.9123) acc_u 9.3750 (10.4167) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 216
confident_label rate tensor(0.6703, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1094
clean true:1089
clean false:5
clean_rate:0.9954296160877514
noisy true:327
noisy false:211
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 538
epoch [131/200] batch [5/34] time 0.494 (0.437) data 0.369 (0.312) loss_x loss_x 0.0889 (0.2587) acc_x 100.0000 (95.0000) lr 5.6006e-04 eta 0:00:12
epoch [131/200] batch [10/34] time 0.490 (0.454) data 0.363 (0.329) loss_x loss_x 0.2168 (0.2404) acc_x 90.6250 (95.6250) lr 5.6006e-04 eta 0:00:10
epoch [131/200] batch [15/34] time 0.455 (0.449) data 0.328 (0.327) loss_x loss_x 0.4539 (0.2561) acc_x 87.5000 (94.3750) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [20/34] time 0.422 (0.440) data 0.290 (0.316) loss_x loss_x 0.1815 (0.2545) acc_x 100.0000 (94.6875) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [25/34] time 0.412 (0.437) data 0.284 (0.313) loss_x loss_x 0.4080 (0.2581) acc_x 87.5000 (94.1250) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [30/34] time 0.424 (0.433) data 0.298 (0.309) loss_x loss_x 0.3245 (0.2776) acc_x 90.6250 (93.9583) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [5/16] time 0.420 (0.431) data 0.292 (0.306) loss_u loss_u 0.9482 (0.9132) acc_u 6.2500 (10.6250) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/16] time 0.405 (0.426) data 0.275 (0.301) loss_u loss_u 0.8696 (0.9021) acc_u 18.7500 (11.5625) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/16] time 0.385 (0.422) data 0.255 (0.298) loss_u loss_u 0.9302 (0.8996) acc_u 9.3750 (12.2917) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 231
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1079
clean true:1075
clean false:4
clean_rate:0.9962928637627433
noisy true:326
noisy false:227
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 553
epoch [132/200] batch [5/33] time 0.396 (0.393) data 0.271 (0.268) loss_x loss_x 0.4600 (0.3215) acc_x 90.6250 (93.7500) lr 5.4601e-04 eta 0:00:11
epoch [132/200] batch [10/33] time 0.415 (0.404) data 0.291 (0.280) loss_x loss_x 0.4399 (0.2990) acc_x 90.6250 (93.7500) lr 5.4601e-04 eta 0:00:09
epoch [132/200] batch [15/33] time 0.427 (0.412) data 0.300 (0.288) loss_x loss_x 0.3389 (0.3004) acc_x 90.6250 (93.5417) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [20/33] time 0.402 (0.412) data 0.274 (0.288) loss_x loss_x 0.1526 (0.2898) acc_x 96.8750 (93.4375) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [25/33] time 0.393 (0.408) data 0.268 (0.283) loss_x loss_x 0.2576 (0.2836) acc_x 93.7500 (93.6250) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [30/33] time 0.401 (0.409) data 0.276 (0.284) loss_x loss_x 0.2654 (0.2747) acc_x 96.8750 (93.8542) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [5/17] time 0.424 (0.409) data 0.293 (0.283) loss_u loss_u 0.9277 (0.8915) acc_u 6.2500 (11.2500) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/17] time 0.411 (0.408) data 0.282 (0.283) loss_u loss_u 0.8921 (0.8802) acc_u 9.3750 (12.8125) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/17] time 0.359 (0.405) data 0.229 (0.279) loss_u loss_u 0.8779 (0.8753) acc_u 12.5000 (13.5417) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.6636, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1083
clean true:1080
clean false:3
clean_rate:0.997229916897507
noisy true:327
noisy false:222
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 549
epoch [133/200] batch [5/33] time 0.416 (0.416) data 0.290 (0.291) loss_x loss_x 0.1002 (0.2396) acc_x 100.0000 (93.7500) lr 5.3207e-04 eta 0:00:11
epoch [133/200] batch [10/33] time 0.404 (0.408) data 0.277 (0.283) loss_x loss_x 0.2357 (0.2432) acc_x 96.8750 (94.6875) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [15/33] time 0.420 (0.411) data 0.294 (0.286) loss_x loss_x 0.2654 (0.2852) acc_x 96.8750 (93.7500) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [20/33] time 0.399 (0.408) data 0.274 (0.283) loss_x loss_x 0.2749 (0.3104) acc_x 90.6250 (93.4375) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [25/33] time 0.398 (0.405) data 0.277 (0.282) loss_x loss_x 0.2764 (0.3171) acc_x 90.6250 (93.0000) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [30/33] time 0.391 (0.407) data 0.266 (0.283) loss_x loss_x 0.2139 (0.3099) acc_x 96.8750 (92.9167) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [5/17] time 0.417 (0.404) data 0.292 (0.280) loss_u loss_u 0.9531 (0.8675) acc_u 6.2500 (15.0000) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/17] time 0.441 (0.407) data 0.314 (0.282) loss_u loss_u 0.8545 (0.8827) acc_u 15.6250 (13.1250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/17] time 0.400 (0.405) data 0.271 (0.280) loss_u loss_u 0.9175 (0.8812) acc_u 9.3750 (13.7500) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 199
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1093
clean false:4
clean_rate:0.9963536918869644
noisy true:340
noisy false:195
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [134/200] batch [5/34] time 0.422 (0.421) data 0.297 (0.298) loss_x loss_x 0.4216 (0.2654) acc_x 93.7500 (94.3750) lr 5.1825e-04 eta 0:00:12
epoch [134/200] batch [10/34] time 0.409 (0.422) data 0.285 (0.298) loss_x loss_x 0.3667 (0.2806) acc_x 93.7500 (94.0625) lr 5.1825e-04 eta 0:00:10
epoch [134/200] batch [15/34] time 0.360 (0.409) data 0.235 (0.284) loss_x loss_x 0.6030 (0.3006) acc_x 87.5000 (93.7500) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [20/34] time 0.445 (0.408) data 0.320 (0.283) loss_x loss_x 0.2639 (0.2905) acc_x 93.7500 (94.2188) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [25/34] time 0.426 (0.409) data 0.301 (0.284) loss_x loss_x 0.1602 (0.2820) acc_x 96.8750 (94.1250) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [30/34] time 0.401 (0.407) data 0.276 (0.284) loss_x loss_x 0.3252 (0.2881) acc_x 90.6250 (93.7500) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [5/16] time 0.399 (0.405) data 0.275 (0.282) loss_u loss_u 0.8447 (0.8902) acc_u 18.7500 (13.1250) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/16] time 0.384 (0.404) data 0.261 (0.280) loss_u loss_u 0.9551 (0.8988) acc_u 6.2500 (12.1875) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/16] time 0.381 (0.403) data 0.254 (0.278) loss_u loss_u 0.9424 (0.9039) acc_u 12.5000 (11.8750) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1084
clean false:4
clean_rate:0.9963235294117647
noisy true:324
noisy false:220
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [135/200] batch [5/34] time 0.478 (0.466) data 0.315 (0.342) loss_x loss_x 0.2169 (0.3012) acc_x 93.7500 (93.1250) lr 5.0454e-04 eta 0:00:13
epoch [135/200] batch [10/34] time 0.454 (0.472) data 0.329 (0.348) loss_x loss_x 0.2837 (0.2711) acc_x 90.6250 (93.1250) lr 5.0454e-04 eta 0:00:11
epoch [135/200] batch [15/34] time 0.404 (0.455) data 0.276 (0.330) loss_x loss_x 0.2556 (0.2548) acc_x 96.8750 (94.3750) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [20/34] time 0.417 (0.442) data 0.290 (0.317) loss_x loss_x 0.3867 (0.2758) acc_x 93.7500 (93.7500) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [25/34] time 0.453 (0.446) data 0.326 (0.321) loss_x loss_x 0.2791 (0.2885) acc_x 93.7500 (93.2500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [30/34] time 0.403 (0.444) data 0.279 (0.319) loss_x loss_x 0.2737 (0.2954) acc_x 93.7500 (93.0208) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [5/17] time 0.376 (0.441) data 0.249 (0.316) loss_u loss_u 0.9487 (0.8953) acc_u 6.2500 (12.5000) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/17] time 0.372 (0.434) data 0.246 (0.309) loss_u loss_u 0.8633 (0.8873) acc_u 15.6250 (13.7500) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [15/17] time 0.400 (0.427) data 0.274 (0.301) loss_u loss_u 0.8623 (0.8974) acc_u 18.7500 (12.9167) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.6587, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1075
clean true:1072
clean false:3
clean_rate:0.9972093023255814
noisy true:328
noisy false:229
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 557
epoch [136/200] batch [5/33] time 0.431 (0.445) data 0.304 (0.319) loss_x loss_x 0.1279 (0.2022) acc_x 100.0000 (94.3750) lr 4.9096e-04 eta 0:00:12
epoch [136/200] batch [10/33] time 0.413 (0.430) data 0.286 (0.304) loss_x loss_x 0.4148 (0.2720) acc_x 90.6250 (93.4375) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [15/33] time 0.411 (0.424) data 0.287 (0.298) loss_x loss_x 0.3855 (0.2709) acc_x 87.5000 (93.9583) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [20/33] time 0.407 (0.430) data 0.328 (0.306) loss_x loss_x 0.3381 (0.2945) acc_x 93.7500 (93.9062) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [25/33] time 0.477 (0.431) data 0.350 (0.306) loss_x loss_x 0.0599 (0.2704) acc_x 100.0000 (94.3750) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [30/33] time 0.407 (0.429) data 0.277 (0.304) loss_x loss_x 0.2952 (0.2675) acc_x 93.7500 (94.5833) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [5/17] time 0.432 (0.427) data 0.305 (0.302) loss_u loss_u 0.9683 (0.8764) acc_u 3.1250 (13.7500) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [10/17] time 0.398 (0.426) data 0.273 (0.301) loss_u loss_u 0.8618 (0.8648) acc_u 15.6250 (15.6250) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/17] time 0.403 (0.425) data 0.277 (0.299) loss_u loss_u 0.8560 (0.8686) acc_u 15.6250 (14.7917) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 210
confident_label rate tensor(0.6612, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1079
clean true:1077
clean false:2
clean_rate:0.9981464318813716
noisy true:345
noisy false:208
after delete: len(clean_dataset) 1079
after delete: len(noisy_dataset) 553
epoch [137/200] batch [5/33] time 0.457 (0.457) data 0.331 (0.330) loss_x loss_x 0.2080 (0.2655) acc_x 96.8750 (95.0000) lr 4.7750e-04 eta 0:00:12
epoch [137/200] batch [10/33] time 0.356 (0.422) data 0.231 (0.299) loss_x loss_x 0.1539 (0.2770) acc_x 96.8750 (94.6875) lr 4.7750e-04 eta 0:00:09
epoch [137/200] batch [15/33] time 0.440 (0.413) data 0.314 (0.289) loss_x loss_x 0.2393 (0.2534) acc_x 93.7500 (94.7917) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [20/33] time 0.445 (0.426) data 0.319 (0.302) loss_x loss_x 0.2615 (0.2614) acc_x 96.8750 (94.3750) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [25/33] time 0.381 (0.421) data 0.255 (0.297) loss_x loss_x 0.3752 (0.2856) acc_x 90.6250 (93.5000) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [30/33] time 0.400 (0.417) data 0.270 (0.294) loss_x loss_x 0.2539 (0.2810) acc_x 90.6250 (93.6458) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [5/17] time 0.424 (0.424) data 0.297 (0.300) loss_u loss_u 0.8940 (0.8894) acc_u 15.6250 (13.1250) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/17] time 0.366 (0.419) data 0.241 (0.295) loss_u loss_u 0.9219 (0.8749) acc_u 6.2500 (14.3750) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/17] time 0.358 (0.415) data 0.230 (0.291) loss_u loss_u 0.8438 (0.8800) acc_u 18.7500 (13.7500) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 215
confident_label rate tensor(0.6654, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1086
clean true:1084
clean false:2
clean_rate:0.998158379373849
noisy true:333
noisy false:213
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 546
epoch [138/200] batch [5/33] time 0.399 (0.409) data 0.275 (0.293) loss_x loss_x 0.3123 (0.2905) acc_x 93.7500 (94.3750) lr 4.6417e-04 eta 0:00:11
epoch [138/200] batch [10/33] time 0.452 (0.404) data 0.326 (0.283) loss_x loss_x 0.4666 (0.3663) acc_x 87.5000 (92.8125) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [15/33] time 0.415 (0.412) data 0.290 (0.290) loss_x loss_x 0.1896 (0.3406) acc_x 96.8750 (92.5000) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [20/33] time 0.457 (0.420) data 0.331 (0.298) loss_x loss_x 0.2932 (0.3170) acc_x 93.7500 (92.9688) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [25/33] time 0.375 (0.419) data 0.298 (0.298) loss_x loss_x 0.2438 (0.3120) acc_x 93.7500 (93.1250) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [30/33] time 0.448 (0.427) data 0.325 (0.305) loss_x loss_x 0.2097 (0.3108) acc_x 100.0000 (93.4375) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [5/17] time 0.395 (0.426) data 0.269 (0.303) loss_u loss_u 0.8457 (0.8791) acc_u 15.6250 (13.1250) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [10/17] time 0.349 (0.421) data 0.218 (0.297) loss_u loss_u 0.8594 (0.8808) acc_u 18.7500 (13.7500) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/17] time 0.394 (0.414) data 0.268 (0.291) loss_u loss_u 0.9697 (0.8852) acc_u 3.1250 (13.3333) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.6587, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1075
clean true:1071
clean false:4
clean_rate:0.9962790697674418
noisy true:329
noisy false:228
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 557
epoch [139/200] batch [5/33] time 0.436 (0.444) data 0.310 (0.317) loss_x loss_x 0.1553 (0.2611) acc_x 100.0000 (95.0000) lr 4.5098e-04 eta 0:00:12
epoch [139/200] batch [10/33] time 0.446 (0.438) data 0.321 (0.316) loss_x loss_x 0.2664 (0.2740) acc_x 90.6250 (93.7500) lr 4.5098e-04 eta 0:00:10
epoch [139/200] batch [15/33] time 0.468 (0.434) data 0.341 (0.311) loss_x loss_x 0.2146 (0.2736) acc_x 100.0000 (94.1667) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [20/33] time 0.356 (0.416) data 0.232 (0.292) loss_x loss_x 0.6138 (0.2956) acc_x 87.5000 (93.4375) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [25/33] time 0.431 (0.418) data 0.305 (0.294) loss_x loss_x 0.1284 (0.2830) acc_x 100.0000 (93.8750) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [30/33] time 0.402 (0.417) data 0.276 (0.292) loss_x loss_x 0.2374 (0.2955) acc_x 90.6250 (93.0208) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [5/17] time 0.352 (0.407) data 0.221 (0.282) loss_u loss_u 0.8281 (0.8446) acc_u 18.7500 (17.5000) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/17] time 0.354 (0.401) data 0.227 (0.276) loss_u loss_u 0.8252 (0.8553) acc_u 18.7500 (16.5625) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/17] time 0.389 (0.397) data 0.262 (0.272) loss_u loss_u 0.7910 (0.8560) acc_u 25.0000 (16.4583) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 205
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1094
clean false:3
clean_rate:0.9972652689152234
noisy true:333
noisy false:202
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [140/200] batch [5/34] time 0.453 (0.471) data 0.327 (0.345) loss_x loss_x 0.1996 (0.3400) acc_x 93.7500 (92.5000) lr 4.3792e-04 eta 0:00:13
epoch [140/200] batch [10/34] time 0.421 (0.451) data 0.297 (0.326) loss_x loss_x 0.1254 (0.2993) acc_x 96.8750 (93.7500) lr 4.3792e-04 eta 0:00:10
epoch [140/200] batch [15/34] time 0.397 (0.448) data 0.273 (0.326) loss_x loss_x 0.1436 (0.3329) acc_x 96.8750 (92.0833) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [20/34] time 0.391 (0.433) data 0.267 (0.310) loss_x loss_x 0.1500 (0.3345) acc_x 96.8750 (92.0312) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [25/34] time 0.402 (0.430) data 0.275 (0.306) loss_x loss_x 0.2360 (0.3132) acc_x 93.7500 (92.2500) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [30/34] time 0.502 (0.432) data 0.377 (0.308) loss_x loss_x 0.0587 (0.3141) acc_x 100.0000 (92.6042) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [5/16] time 0.363 (0.422) data 0.236 (0.299) loss_u loss_u 0.9062 (0.9108) acc_u 9.3750 (9.3750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/16] time 0.476 (0.417) data 0.353 (0.294) loss_u loss_u 0.8521 (0.8900) acc_u 15.6250 (11.5625) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/16] time 0.461 (0.423) data 0.332 (0.299) loss_u loss_u 0.9385 (0.9013) acc_u 6.2500 (10.4167) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 213
confident_label rate tensor(0.6599, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1077
clean true:1074
clean false:3
clean_rate:0.9972144846796658
noisy true:345
noisy false:210
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 555
epoch [141/200] batch [5/33] time 0.438 (0.462) data 0.312 (0.328) loss_x loss_x 0.1696 (0.2709) acc_x 100.0000 (95.0000) lr 4.2499e-04 eta 0:00:12
epoch [141/200] batch [10/33] time 0.510 (0.459) data 0.382 (0.328) loss_x loss_x 0.2115 (0.2497) acc_x 93.7500 (95.6250) lr 4.2499e-04 eta 0:00:10
epoch [141/200] batch [15/33] time 0.455 (0.447) data 0.329 (0.318) loss_x loss_x 0.1917 (0.2649) acc_x 100.0000 (95.4167) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [20/33] time 0.364 (0.424) data 0.238 (0.295) loss_x loss_x 0.4570 (0.2946) acc_x 87.5000 (94.3750) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [25/33] time 0.422 (0.418) data 0.299 (0.291) loss_x loss_x 0.1399 (0.2955) acc_x 100.0000 (94.2500) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [30/33] time 0.407 (0.417) data 0.282 (0.291) loss_x loss_x 0.3708 (0.3101) acc_x 93.7500 (93.9583) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [5/17] time 0.351 (0.409) data 0.222 (0.283) loss_u loss_u 0.9321 (0.9096) acc_u 6.2500 (10.6250) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/17] time 0.388 (0.406) data 0.259 (0.280) loss_u loss_u 0.8516 (0.8762) acc_u 18.7500 (14.6875) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/17] time 0.464 (0.406) data 0.337 (0.280) loss_u loss_u 0.9009 (0.8701) acc_u 12.5000 (15.4167) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 208
confident_label rate tensor(0.6667, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1088
clean true:1085
clean false:3
clean_rate:0.9972426470588235
noisy true:339
noisy false:205
after delete: len(clean_dataset) 1088
after delete: len(noisy_dataset) 544
epoch [142/200] batch [5/34] time 0.409 (0.437) data 0.286 (0.311) loss_x loss_x 0.4436 (0.2698) acc_x 84.3750 (93.7500) lr 4.1221e-04 eta 0:00:12
epoch [142/200] batch [10/34] time 0.480 (0.435) data 0.351 (0.309) loss_x loss_x 0.2148 (0.2455) acc_x 96.8750 (95.0000) lr 4.1221e-04 eta 0:00:10
epoch [142/200] batch [15/34] time 0.441 (0.436) data 0.314 (0.310) loss_x loss_x 0.4810 (0.2764) acc_x 84.3750 (93.5417) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [20/34] time 0.420 (0.432) data 0.297 (0.308) loss_x loss_x 0.9380 (0.3051) acc_x 84.3750 (93.5938) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [25/34] time 0.373 (0.429) data 0.250 (0.305) loss_x loss_x 0.2654 (0.2928) acc_x 96.8750 (93.8750) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [30/34] time 0.385 (0.422) data 0.259 (0.298) loss_x loss_x 0.5024 (0.2805) acc_x 87.5000 (94.0625) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [5/17] time 0.392 (0.415) data 0.267 (0.291) loss_u loss_u 0.8589 (0.8751) acc_u 15.6250 (13.7500) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/17] time 0.462 (0.418) data 0.335 (0.294) loss_u loss_u 0.8633 (0.8887) acc_u 15.6250 (12.8125) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/17] time 0.432 (0.418) data 0.304 (0.294) loss_u loss_u 0.8779 (0.8917) acc_u 15.6250 (12.5000) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.6703, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1094
clean true:1091
clean false:3
clean_rate:0.9972577696526508
noisy true:343
noisy false:195
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 538
epoch [143/200] batch [5/34] time 0.448 (0.443) data 0.322 (0.318) loss_x loss_x 0.4966 (0.3226) acc_x 87.5000 (92.5000) lr 3.9958e-04 eta 0:00:12
epoch [143/200] batch [10/34] time 0.399 (0.422) data 0.272 (0.297) loss_x loss_x 0.4058 (0.3417) acc_x 90.6250 (91.8750) lr 3.9958e-04 eta 0:00:10
epoch [143/200] batch [15/34] time 0.477 (0.431) data 0.330 (0.308) loss_x loss_x 0.2634 (0.3174) acc_x 96.8750 (93.3333) lr 3.9958e-04 eta 0:00:08
epoch [143/200] batch [20/34] time 0.474 (0.431) data 0.348 (0.307) loss_x loss_x 0.5933 (0.3345) acc_x 81.2500 (92.3438) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [25/34] time 0.398 (0.434) data 0.270 (0.310) loss_x loss_x 0.2209 (0.3047) acc_x 96.8750 (93.3750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [30/34] time 0.385 (0.422) data 0.258 (0.297) loss_x loss_x 0.4180 (0.3025) acc_x 93.7500 (93.4375) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [5/16] time 0.382 (0.423) data 0.251 (0.297) loss_u loss_u 0.8657 (0.8911) acc_u 15.6250 (13.1250) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/16] time 0.424 (0.423) data 0.296 (0.297) loss_u loss_u 0.8242 (0.8896) acc_u 18.7500 (12.8125) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/16] time 0.420 (0.425) data 0.294 (0.298) loss_u loss_u 0.8359 (0.8965) acc_u 21.8750 (12.2917) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 194
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1094
clean false:3
clean_rate:0.9972652689152234
noisy true:344
noisy false:191
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [144/200] batch [5/34] time 0.440 (0.449) data 0.315 (0.325) loss_x loss_x 0.3062 (0.3765) acc_x 93.7500 (91.8750) lr 3.8709e-04 eta 0:00:13
epoch [144/200] batch [10/34] time 0.385 (0.438) data 0.260 (0.313) loss_x loss_x 0.6025 (0.3749) acc_x 90.6250 (91.5625) lr 3.8709e-04 eta 0:00:10
epoch [144/200] batch [15/34] time 0.413 (0.421) data 0.290 (0.299) loss_x loss_x 0.1583 (0.3172) acc_x 100.0000 (92.7083) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [20/34] time 0.438 (0.425) data 0.314 (0.303) loss_x loss_x 0.1587 (0.3060) acc_x 100.0000 (93.2812) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [25/34] time 0.414 (0.426) data 0.286 (0.304) loss_x loss_x 0.4487 (0.3114) acc_x 90.6250 (93.5000) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [30/34] time 0.400 (0.427) data 0.275 (0.304) loss_x loss_x 0.1252 (0.2938) acc_x 100.0000 (94.0625) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [5/16] time 0.348 (0.415) data 0.221 (0.292) loss_u loss_u 0.8979 (0.8751) acc_u 12.5000 (14.3750) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/16] time 0.405 (0.416) data 0.275 (0.293) loss_u loss_u 0.9082 (0.8919) acc_u 12.5000 (12.5000) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/16] time 0.441 (0.417) data 0.310 (0.294) loss_u loss_u 0.8525 (0.8902) acc_u 15.6250 (12.5000) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 205
confident_label rate tensor(0.6691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1092
clean true:1089
clean false:3
clean_rate:0.9972527472527473
noisy true:338
noisy false:202
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 540
epoch [145/200] batch [5/34] time 0.467 (0.450) data 0.341 (0.325) loss_x loss_x 0.2644 (0.2604) acc_x 93.7500 (96.2500) lr 3.7476e-04 eta 0:00:13
epoch [145/200] batch [10/34] time 0.462 (0.452) data 0.337 (0.326) loss_x loss_x 0.2421 (0.2835) acc_x 96.8750 (95.0000) lr 3.7476e-04 eta 0:00:10
epoch [145/200] batch [15/34] time 0.461 (0.451) data 0.338 (0.328) loss_x loss_x 0.0659 (0.2728) acc_x 100.0000 (94.3750) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [20/34] time 0.406 (0.434) data 0.281 (0.310) loss_x loss_x 0.3320 (0.2929) acc_x 93.7500 (93.9062) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [25/34] time 0.395 (0.432) data 0.271 (0.308) loss_x loss_x 0.1975 (0.2910) acc_x 93.7500 (93.7500) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [30/34] time 0.374 (0.424) data 0.248 (0.299) loss_x loss_x 0.3123 (0.3026) acc_x 90.6250 (93.5417) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [5/16] time 0.426 (0.420) data 0.300 (0.297) loss_u loss_u 0.8789 (0.8795) acc_u 12.5000 (13.1250) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/16] time 0.348 (0.415) data 0.219 (0.291) loss_u loss_u 0.8730 (0.8711) acc_u 15.6250 (14.3750) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/16] time 0.401 (0.413) data 0.275 (0.289) loss_u loss_u 0.8027 (0.8774) acc_u 21.8750 (13.9583) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 205
confident_label rate tensor(0.6679, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1090
clean true:1086
clean false:4
clean_rate:0.9963302752293578
noisy true:341
noisy false:201
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 542
epoch [146/200] batch [5/34] time 0.395 (0.433) data 0.268 (0.307) loss_x loss_x 0.2717 (0.3531) acc_x 96.8750 (91.2500) lr 3.6258e-04 eta 0:00:12
epoch [146/200] batch [10/34] time 0.446 (0.420) data 0.314 (0.293) loss_x loss_x 0.4983 (0.3578) acc_x 87.5000 (91.5625) lr 3.6258e-04 eta 0:00:10
epoch [146/200] batch [15/34] time 0.488 (0.429) data 0.360 (0.302) loss_x loss_x 0.3264 (0.3586) acc_x 90.6250 (92.0833) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [20/34] time 0.412 (0.431) data 0.285 (0.304) loss_x loss_x 0.3413 (0.3304) acc_x 96.8750 (92.8125) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [25/34] time 0.468 (0.438) data 0.343 (0.311) loss_x loss_x 0.2489 (0.3280) acc_x 93.7500 (93.0000) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [30/34] time 0.466 (0.440) data 0.338 (0.314) loss_x loss_x 0.2832 (0.3116) acc_x 93.7500 (93.5417) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [5/16] time 0.394 (0.426) data 0.267 (0.300) loss_u loss_u 0.9180 (0.8741) acc_u 9.3750 (13.7500) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/16] time 0.393 (0.423) data 0.264 (0.297) loss_u loss_u 0.9688 (0.8787) acc_u 3.1250 (13.7500) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/16] time 0.434 (0.420) data 0.304 (0.294) loss_u loss_u 0.8960 (0.8829) acc_u 12.5000 (13.7500) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6685, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1091
clean true:1088
clean false:3
clean_rate:0.997250229147571
noisy true:348
noisy false:193
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 541
epoch [147/200] batch [5/34] time 0.438 (0.442) data 0.311 (0.317) loss_x loss_x 0.1643 (0.2643) acc_x 93.7500 (91.8750) lr 3.5055e-04 eta 0:00:12
epoch [147/200] batch [10/34] time 0.440 (0.437) data 0.315 (0.312) loss_x loss_x 0.1156 (0.2763) acc_x 100.0000 (92.5000) lr 3.5055e-04 eta 0:00:10
epoch [147/200] batch [15/34] time 0.399 (0.428) data 0.268 (0.302) loss_x loss_x 0.3845 (0.2845) acc_x 93.7500 (93.3333) lr 3.5055e-04 eta 0:00:08
epoch [147/200] batch [20/34] time 0.487 (0.432) data 0.363 (0.306) loss_x loss_x 0.4019 (0.3126) acc_x 90.6250 (92.5000) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [25/34] time 0.415 (0.430) data 0.292 (0.307) loss_x loss_x 0.2317 (0.2962) acc_x 100.0000 (93.2500) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [30/34] time 0.419 (0.430) data 0.292 (0.306) loss_x loss_x 0.4075 (0.2810) acc_x 90.6250 (93.9583) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [5/16] time 0.388 (0.422) data 0.260 (0.298) loss_u loss_u 0.8638 (0.8755) acc_u 15.6250 (15.6250) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/16] time 0.387 (0.417) data 0.261 (0.294) loss_u loss_u 0.9136 (0.8852) acc_u 9.3750 (13.7500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/16] time 0.378 (0.414) data 0.252 (0.290) loss_u loss_u 0.8232 (0.8844) acc_u 18.7500 (13.1250) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 216
confident_label rate tensor(0.6648, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1085
clean true:1081
clean false:4
clean_rate:0.9963133640552996
noisy true:335
noisy false:212
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 547
epoch [148/200] batch [5/33] time 0.436 (0.475) data 0.311 (0.350) loss_x loss_x 0.6343 (0.3826) acc_x 84.3750 (89.3750) lr 3.3869e-04 eta 0:00:13
epoch [148/200] batch [10/33] time 0.443 (0.458) data 0.318 (0.332) loss_x loss_x 0.2563 (0.3197) acc_x 93.7500 (91.8750) lr 3.3869e-04 eta 0:00:10
epoch [148/200] batch [15/33] time 0.377 (0.435) data 0.250 (0.309) loss_x loss_x 0.2242 (0.3120) acc_x 96.8750 (92.7083) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [20/33] time 0.403 (0.431) data 0.278 (0.305) loss_x loss_x 0.2913 (0.3006) acc_x 93.7500 (93.2812) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [25/33] time 0.412 (0.426) data 0.288 (0.300) loss_x loss_x 0.2324 (0.2929) acc_x 96.8750 (93.6250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [30/33] time 0.343 (0.419) data 0.244 (0.295) loss_x loss_x 0.3711 (0.2977) acc_x 93.7500 (93.4375) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [5/17] time 0.360 (0.420) data 0.233 (0.296) loss_u loss_u 0.9297 (0.9084) acc_u 9.3750 (10.6250) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [10/17] time 0.404 (0.413) data 0.276 (0.289) loss_u loss_u 0.8760 (0.8903) acc_u 15.6250 (13.4375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/17] time 0.392 (0.412) data 0.262 (0.287) loss_u loss_u 0.8960 (0.8761) acc_u 9.3750 (14.3750) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 204
confident_label rate tensor(0.6703, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1094
clean true:1091
clean false:3
clean_rate:0.9972577696526508
noisy true:337
noisy false:201
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 538
epoch [149/200] batch [5/34] time 0.446 (0.418) data 0.319 (0.281) loss_x loss_x 0.4182 (0.2463) acc_x 90.6250 (95.6250) lr 3.2699e-04 eta 0:00:12
epoch [149/200] batch [10/34] time 0.443 (0.418) data 0.313 (0.287) loss_x loss_x 0.2891 (0.2791) acc_x 90.6250 (94.0625) lr 3.2699e-04 eta 0:00:10
epoch [149/200] batch [15/34] time 0.451 (0.430) data 0.324 (0.300) loss_x loss_x 0.2155 (0.2931) acc_x 93.7500 (93.5417) lr 3.2699e-04 eta 0:00:08
epoch [149/200] batch [20/34] time 0.412 (0.430) data 0.288 (0.302) loss_x loss_x 0.4414 (0.3065) acc_x 93.7500 (93.2812) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [25/34] time 0.348 (0.430) data 0.221 (0.302) loss_x loss_x 0.3701 (0.2947) acc_x 90.6250 (93.3750) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [30/34] time 0.368 (0.419) data 0.290 (0.293) loss_x loss_x 0.2267 (0.3121) acc_x 90.6250 (93.0208) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [5/16] time 0.468 (0.423) data 0.342 (0.297) loss_u loss_u 0.9678 (0.8805) acc_u 3.1250 (13.7500) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/16] time 0.404 (0.420) data 0.275 (0.294) loss_u loss_u 0.9111 (0.8966) acc_u 9.3750 (11.2500) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/16] time 0.390 (0.418) data 0.262 (0.292) loss_u loss_u 0.9072 (0.8954) acc_u 9.3750 (11.4583) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6716, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1096
clean true:1093
clean false:3
clean_rate:0.9972627737226277
noisy true:347
noisy false:189
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 536
epoch [150/200] batch [5/34] time 0.431 (0.408) data 0.305 (0.281) loss_x loss_x 0.4915 (0.2890) acc_x 84.3750 (93.1250) lr 3.1545e-04 eta 0:00:11
epoch [150/200] batch [10/34] time 0.360 (0.389) data 0.233 (0.262) loss_x loss_x 0.2166 (0.2652) acc_x 96.8750 (94.3750) lr 3.1545e-04 eta 0:00:09
epoch [150/200] batch [15/34] time 0.430 (0.400) data 0.305 (0.273) loss_x loss_x 0.3752 (0.2823) acc_x 90.6250 (93.5417) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [20/34] time 0.410 (0.408) data 0.284 (0.281) loss_x loss_x 0.1769 (0.2673) acc_x 96.8750 (93.9062) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [25/34] time 0.386 (0.404) data 0.260 (0.278) loss_x loss_x 0.3652 (0.2613) acc_x 87.5000 (94.0000) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [30/34] time 0.411 (0.404) data 0.284 (0.279) loss_x loss_x 0.0573 (0.2571) acc_x 100.0000 (94.2708) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [5/16] time 0.398 (0.407) data 0.271 (0.281) loss_u loss_u 0.9014 (0.9209) acc_u 12.5000 (8.7500) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/16] time 0.487 (0.412) data 0.359 (0.286) loss_u loss_u 0.8589 (0.9055) acc_u 15.6250 (10.6250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/16] time 0.404 (0.412) data 0.272 (0.286) loss_u loss_u 0.8618 (0.8927) acc_u 18.7500 (12.5000) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1092
clean true:1089
clean false:3
clean_rate:0.9972527472527473
noisy true:351
noisy false:189
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 540
epoch [151/200] batch [5/34] time 0.470 (0.425) data 0.342 (0.298) loss_x loss_x 0.2222 (0.2727) acc_x 96.8750 (95.0000) lr 3.0409e-04 eta 0:00:12
epoch [151/200] batch [10/34] time 0.478 (0.441) data 0.354 (0.315) loss_x loss_x 0.5713 (0.3442) acc_x 87.5000 (92.5000) lr 3.0409e-04 eta 0:00:10
epoch [151/200] batch [15/34] time 0.411 (0.431) data 0.287 (0.309) loss_x loss_x 0.5049 (0.3436) acc_x 84.3750 (91.8750) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [20/34] time 0.424 (0.435) data 0.295 (0.311) loss_x loss_x 0.2944 (0.3368) acc_x 93.7500 (91.7188) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [25/34] time 0.487 (0.444) data 0.363 (0.320) loss_x loss_x 0.0921 (0.3168) acc_x 100.0000 (92.8750) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [30/34] time 0.437 (0.442) data 0.314 (0.318) loss_x loss_x 0.2600 (0.2997) acc_x 93.7500 (93.3333) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [5/16] time 0.402 (0.434) data 0.242 (0.309) loss_u loss_u 0.9419 (0.9021) acc_u 6.2500 (10.6250) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/16] time 0.388 (0.429) data 0.263 (0.304) loss_u loss_u 0.8311 (0.8787) acc_u 18.7500 (13.7500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/16] time 0.382 (0.424) data 0.255 (0.299) loss_u loss_u 0.7109 (0.8687) acc_u 31.2500 (14.5833) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.6765, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1104
clean true:1100
clean false:4
clean_rate:0.9963768115942029
noisy true:341
noisy false:187
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 528
epoch [152/200] batch [5/34] time 0.430 (0.465) data 0.304 (0.339) loss_x loss_x 0.1416 (0.2905) acc_x 96.8750 (91.8750) lr 2.9289e-04 eta 0:00:13
epoch [152/200] batch [10/34] time 0.433 (0.455) data 0.309 (0.334) loss_x loss_x 0.2415 (0.3243) acc_x 93.7500 (90.3125) lr 2.9289e-04 eta 0:00:10
epoch [152/200] batch [15/34] time 0.522 (0.454) data 0.396 (0.332) loss_x loss_x 0.2710 (0.2998) acc_x 87.5000 (91.6667) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [20/34] time 0.373 (0.446) data 0.248 (0.323) loss_x loss_x 0.2966 (0.2849) acc_x 87.5000 (92.1875) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [25/34] time 0.405 (0.436) data 0.278 (0.311) loss_x loss_x 0.1857 (0.2960) acc_x 100.0000 (92.5000) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [30/34] time 0.416 (0.433) data 0.289 (0.308) loss_x loss_x 0.2164 (0.3174) acc_x 96.8750 (92.6042) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [5/16] time 0.372 (0.419) data 0.231 (0.295) loss_u loss_u 0.9365 (0.8999) acc_u 6.2500 (11.2500) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/16] time 0.356 (0.411) data 0.227 (0.286) loss_u loss_u 0.9517 (0.9088) acc_u 6.2500 (10.0000) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/16] time 0.425 (0.408) data 0.298 (0.283) loss_u loss_u 0.8848 (0.8971) acc_u 12.5000 (11.4583) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1100
clean true:1097
clean false:3
clean_rate:0.9972727272727273
noisy true:339
noisy false:193
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 532
epoch [153/200] batch [5/34] time 0.344 (0.357) data 0.215 (0.229) loss_x loss_x 0.5874 (0.4031) acc_x 87.5000 (91.8750) lr 2.8187e-04 eta 0:00:10
epoch [153/200] batch [10/34] time 0.391 (0.372) data 0.264 (0.244) loss_x loss_x 0.2264 (0.3434) acc_x 93.7500 (93.4375) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [15/34] time 0.432 (0.392) data 0.304 (0.264) loss_x loss_x 0.2642 (0.3184) acc_x 90.6250 (93.5417) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [20/34] time 0.484 (0.409) data 0.356 (0.281) loss_x loss_x 0.2515 (0.2946) acc_x 93.7500 (94.0625) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [25/34] time 0.422 (0.411) data 0.298 (0.283) loss_x loss_x 0.4492 (0.2939) acc_x 90.6250 (94.2500) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [30/34] time 0.366 (0.415) data 0.288 (0.289) loss_x loss_x 0.1782 (0.3037) acc_x 96.8750 (93.6458) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [5/16] time 0.349 (0.413) data 0.222 (0.285) loss_u loss_u 0.9268 (0.8892) acc_u 9.3750 (11.8750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/16] time 0.403 (0.409) data 0.274 (0.282) loss_u loss_u 0.8076 (0.8760) acc_u 21.8750 (13.7500) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/16] time 0.400 (0.406) data 0.273 (0.279) loss_u loss_u 0.8564 (0.8802) acc_u 15.6250 (13.3333) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 204
confident_label rate tensor(0.6703, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1094
clean true:1090
clean false:4
clean_rate:0.9963436928702011
noisy true:338
noisy false:200
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 538
epoch [154/200] batch [5/34] time 0.460 (0.424) data 0.338 (0.300) loss_x loss_x 0.3557 (0.3616) acc_x 90.6250 (91.2500) lr 2.7103e-04 eta 0:00:12
epoch [154/200] batch [10/34] time 0.425 (0.437) data 0.300 (0.313) loss_x loss_x 0.2429 (0.3721) acc_x 90.6250 (90.9375) lr 2.7103e-04 eta 0:00:10
epoch [154/200] batch [15/34] time 0.440 (0.439) data 0.313 (0.314) loss_x loss_x 0.1937 (0.3455) acc_x 96.8750 (91.4583) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [20/34] time 0.401 (0.439) data 0.276 (0.317) loss_x loss_x 0.1077 (0.3268) acc_x 100.0000 (92.0312) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [25/34] time 0.461 (0.440) data 0.334 (0.317) loss_x loss_x 0.1587 (0.3068) acc_x 100.0000 (92.8750) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [30/34] time 0.405 (0.438) data 0.279 (0.314) loss_x loss_x 0.4294 (0.3086) acc_x 93.7500 (93.0208) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [5/16] time 0.379 (0.431) data 0.250 (0.307) loss_u loss_u 0.9551 (0.8405) acc_u 6.2500 (18.1250) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/16] time 0.406 (0.424) data 0.277 (0.299) loss_u loss_u 0.8887 (0.8637) acc_u 12.5000 (15.9375) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/16] time 0.378 (0.421) data 0.247 (0.295) loss_u loss_u 0.8945 (0.8753) acc_u 12.5000 (14.5833) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 199
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1092
clean false:3
clean_rate:0.9972602739726028
noisy true:341
noisy false:196
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [155/200] batch [5/34] time 0.388 (0.386) data 0.264 (0.275) loss_x loss_x 0.5781 (0.2733) acc_x 84.3750 (93.1250) lr 2.6037e-04 eta 0:00:11
epoch [155/200] batch [10/34] time 0.414 (0.402) data 0.290 (0.284) loss_x loss_x 0.2135 (0.2521) acc_x 93.7500 (93.4375) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [15/34] time 0.405 (0.404) data 0.280 (0.284) loss_x loss_x 0.1699 (0.2402) acc_x 96.8750 (93.9583) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [20/34] time 0.417 (0.406) data 0.293 (0.285) loss_x loss_x 0.2654 (0.2374) acc_x 96.8750 (94.2188) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [25/34] time 0.308 (0.395) data 0.228 (0.275) loss_x loss_x 0.1820 (0.2360) acc_x 100.0000 (94.2500) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [30/34] time 0.436 (0.399) data 0.311 (0.279) loss_x loss_x 0.2651 (0.2333) acc_x 93.7500 (94.2708) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [5/16] time 0.387 (0.402) data 0.261 (0.280) loss_u loss_u 0.9204 (0.8870) acc_u 12.5000 (14.3750) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/16] time 0.395 (0.401) data 0.268 (0.279) loss_u loss_u 0.9282 (0.8864) acc_u 6.2500 (13.4375) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/16] time 0.417 (0.401) data 0.291 (0.278) loss_u loss_u 0.9536 (0.8882) acc_u 6.2500 (13.1250) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 188
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1103
clean false:5
clean_rate:0.9954873646209387
noisy true:341
noisy false:183
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [156/200] batch [5/34] time 0.367 (0.404) data 0.245 (0.281) loss_x loss_x 0.2057 (0.2230) acc_x 96.8750 (96.8750) lr 2.4989e-04 eta 0:00:11
epoch [156/200] batch [10/34] time 0.373 (0.385) data 0.243 (0.260) loss_x loss_x 0.2971 (0.2420) acc_x 96.8750 (95.6250) lr 2.4989e-04 eta 0:00:09
epoch [156/200] batch [15/34] time 0.440 (0.392) data 0.316 (0.267) loss_x loss_x 0.3257 (0.2743) acc_x 90.6250 (94.3750) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [20/34] time 0.416 (0.403) data 0.288 (0.277) loss_x loss_x 0.1885 (0.2759) acc_x 100.0000 (94.2188) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [25/34] time 0.431 (0.407) data 0.303 (0.281) loss_x loss_x 0.3606 (0.2746) acc_x 90.6250 (94.2500) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [30/34] time 0.434 (0.408) data 0.311 (0.284) loss_x loss_x 0.1428 (0.2886) acc_x 100.0000 (94.3750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [5/16] time 0.386 (0.411) data 0.262 (0.286) loss_u loss_u 0.8530 (0.8672) acc_u 15.6250 (14.3750) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/16] time 0.381 (0.406) data 0.256 (0.282) loss_u loss_u 0.9131 (0.8747) acc_u 9.3750 (14.0625) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/16] time 0.398 (0.405) data 0.271 (0.280) loss_u loss_u 0.9033 (0.8946) acc_u 12.5000 (11.8750) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1093
clean false:5
clean_rate:0.9954462659380692
noisy true:341
noisy false:193
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [157/200] batch [5/34] time 0.404 (0.436) data 0.297 (0.313) loss_x loss_x 0.4668 (0.3176) acc_x 93.7500 (95.0000) lr 2.3959e-04 eta 0:00:12
epoch [157/200] batch [10/34] time 0.426 (0.428) data 0.299 (0.303) loss_x loss_x 0.2588 (0.2887) acc_x 93.7500 (94.3750) lr 2.3959e-04 eta 0:00:10
epoch [157/200] batch [15/34] time 0.395 (0.421) data 0.270 (0.296) loss_x loss_x 0.1792 (0.2614) acc_x 96.8750 (94.5833) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [20/34] time 0.419 (0.417) data 0.292 (0.292) loss_x loss_x 0.1929 (0.2715) acc_x 93.7500 (94.2188) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [25/34] time 0.419 (0.417) data 0.294 (0.292) loss_x loss_x 0.3040 (0.2796) acc_x 93.7500 (93.7500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [30/34] time 0.396 (0.416) data 0.271 (0.291) loss_x loss_x 0.5229 (0.2915) acc_x 81.2500 (92.9167) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [5/16] time 0.348 (0.410) data 0.220 (0.284) loss_u loss_u 0.9180 (0.9093) acc_u 9.3750 (9.3750) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/16] time 0.386 (0.406) data 0.268 (0.280) loss_u loss_u 0.8564 (0.8847) acc_u 15.6250 (13.1250) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/16] time 0.406 (0.405) data 0.280 (0.280) loss_u loss_u 0.8345 (0.8768) acc_u 18.7500 (14.1667) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.6740, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1100
clean true:1098
clean false:2
clean_rate:0.9981818181818182
noisy true:345
noisy false:187
after delete: len(clean_dataset) 1100
after delete: len(noisy_dataset) 532
epoch [158/200] batch [5/34] time 0.445 (0.432) data 0.319 (0.307) loss_x loss_x 0.2817 (0.2355) acc_x 90.6250 (95.0000) lr 2.2949e-04 eta 0:00:12
epoch [158/200] batch [10/34] time 0.479 (0.449) data 0.355 (0.324) loss_x loss_x 0.3530 (0.2615) acc_x 90.6250 (94.0625) lr 2.2949e-04 eta 0:00:10
epoch [158/200] batch [15/34] time 0.464 (0.446) data 0.341 (0.324) loss_x loss_x 0.2389 (0.2949) acc_x 93.7500 (93.3333) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [20/34] time 0.360 (0.424) data 0.233 (0.301) loss_x loss_x 0.2352 (0.2972) acc_x 96.8750 (92.9688) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [25/34] time 0.420 (0.419) data 0.294 (0.295) loss_x loss_x 0.2646 (0.2863) acc_x 93.7500 (93.3750) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [30/34] time 0.454 (0.419) data 0.328 (0.295) loss_x loss_x 0.2754 (0.2844) acc_x 96.8750 (93.3333) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [5/16] time 0.405 (0.416) data 0.281 (0.292) loss_u loss_u 0.9248 (0.9223) acc_u 9.3750 (9.3750) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/16] time 0.457 (0.415) data 0.332 (0.290) loss_u loss_u 0.8950 (0.9012) acc_u 9.3750 (10.6250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/16] time 0.438 (0.416) data 0.303 (0.291) loss_u loss_u 0.9385 (0.8952) acc_u 6.2500 (11.6667) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.6691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1092
clean true:1089
clean false:3
clean_rate:0.9972527472527473
noisy true:352
noisy false:188
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 540
epoch [159/200] batch [5/34] time 0.429 (0.381) data 0.304 (0.256) loss_x loss_x 0.2493 (0.3052) acc_x 96.8750 (93.7500) lr 2.1957e-04 eta 0:00:11
epoch [159/200] batch [10/34] time 0.421 (0.402) data 0.296 (0.277) loss_x loss_x 0.2059 (0.2578) acc_x 96.8750 (94.3750) lr 2.1957e-04 eta 0:00:09
epoch [159/200] batch [15/34] time 0.375 (0.412) data 0.250 (0.287) loss_x loss_x 0.3491 (0.2683) acc_x 90.6250 (93.7500) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [20/34] time 0.376 (0.405) data 0.254 (0.280) loss_x loss_x 0.4431 (0.2649) acc_x 90.6250 (93.9062) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [25/34] time 0.397 (0.401) data 0.272 (0.276) loss_x loss_x 0.1484 (0.2660) acc_x 96.8750 (93.6250) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [30/34] time 0.404 (0.399) data 0.278 (0.274) loss_x loss_x 0.2690 (0.2561) acc_x 93.7500 (93.9583) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [5/16] time 0.391 (0.396) data 0.265 (0.271) loss_u loss_u 0.8354 (0.8987) acc_u 18.7500 (11.2500) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/16] time 0.345 (0.390) data 0.218 (0.265) loss_u loss_u 0.9004 (0.8827) acc_u 9.3750 (13.1250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/16] time 0.389 (0.391) data 0.262 (0.265) loss_u loss_u 0.9429 (0.8911) acc_u 12.5000 (12.9167) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 199
confident_label rate tensor(0.6722, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1097
clean true:1094
clean false:3
clean_rate:0.9972652689152234
noisy true:339
noisy false:196
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 535
epoch [160/200] batch [5/34] time 0.434 (0.445) data 0.309 (0.321) loss_x loss_x 0.4165 (0.3286) acc_x 90.6250 (91.8750) lr 2.0984e-04 eta 0:00:12
epoch [160/200] batch [10/34] time 0.430 (0.433) data 0.304 (0.308) loss_x loss_x 0.1698 (0.2939) acc_x 93.7500 (93.1250) lr 2.0984e-04 eta 0:00:10
epoch [160/200] batch [15/34] time 0.420 (0.439) data 0.295 (0.314) loss_x loss_x 0.3662 (0.2982) acc_x 90.6250 (93.3333) lr 2.0984e-04 eta 0:00:08
epoch [160/200] batch [20/34] time 0.500 (0.442) data 0.375 (0.320) loss_x loss_x 0.2079 (0.2805) acc_x 93.7500 (93.9062) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [25/34] time 0.398 (0.437) data 0.273 (0.314) loss_x loss_x 0.1832 (0.2624) acc_x 100.0000 (94.5000) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [30/34] time 0.367 (0.431) data 0.241 (0.307) loss_x loss_x 0.2058 (0.2584) acc_x 96.8750 (94.6875) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [5/16] time 0.393 (0.417) data 0.270 (0.293) loss_u loss_u 0.9116 (0.8924) acc_u 9.3750 (13.7500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/16] time 0.400 (0.412) data 0.276 (0.289) loss_u loss_u 0.8701 (0.9021) acc_u 12.5000 (11.5625) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/16] time 0.442 (0.411) data 0.312 (0.288) loss_u loss_u 0.8154 (0.8912) acc_u 18.7500 (12.7083) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 182
confident_label rate tensor(0.6820, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1113
clean true:1110
clean false:3
clean_rate:0.9973045822102425
noisy true:340
noisy false:179
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 519
epoch [161/200] batch [5/34] time 0.368 (0.411) data 0.242 (0.279) loss_x loss_x 0.3162 (0.2196) acc_x 93.7500 (95.6250) lr 2.0032e-04 eta 0:00:11
epoch [161/200] batch [10/34] time 0.479 (0.405) data 0.350 (0.276) loss_x loss_x 0.1490 (0.2514) acc_x 96.8750 (94.6875) lr 2.0032e-04 eta 0:00:09
epoch [161/200] batch [15/34] time 0.424 (0.413) data 0.294 (0.284) loss_x loss_x 0.2610 (0.2553) acc_x 93.7500 (94.7917) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [20/34] time 0.450 (0.418) data 0.322 (0.289) loss_x loss_x 0.1492 (0.2668) acc_x 96.8750 (94.2188) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [25/34] time 0.408 (0.419) data 0.278 (0.290) loss_x loss_x 0.2781 (0.2869) acc_x 93.7500 (93.5000) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [30/34] time 0.405 (0.419) data 0.279 (0.291) loss_x loss_x 0.2432 (0.2793) acc_x 93.7500 (93.8542) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [5/16] time 0.404 (0.412) data 0.275 (0.285) loss_u loss_u 0.8613 (0.8981) acc_u 15.6250 (11.8750) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/16] time 0.448 (0.412) data 0.321 (0.285) loss_u loss_u 0.9370 (0.8966) acc_u 6.2500 (12.1875) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/16] time 0.430 (0.418) data 0.301 (0.291) loss_u loss_u 0.9453 (0.9067) acc_u 6.2500 (10.8333) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 199
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1094
clean false:4
clean_rate:0.9963570127504554
noisy true:339
noisy false:195
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [162/200] batch [5/34] time 0.441 (0.429) data 0.316 (0.303) loss_x loss_x 0.3108 (0.2496) acc_x 90.6250 (93.1250) lr 1.9098e-04 eta 0:00:12
epoch [162/200] batch [10/34] time 0.426 (0.433) data 0.299 (0.307) loss_x loss_x 0.3782 (0.2449) acc_x 93.7500 (94.0625) lr 1.9098e-04 eta 0:00:10
epoch [162/200] batch [15/34] time 0.413 (0.425) data 0.288 (0.299) loss_x loss_x 0.2451 (0.2816) acc_x 90.6250 (93.3333) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [20/34] time 0.424 (0.422) data 0.296 (0.296) loss_x loss_x 0.1108 (0.2548) acc_x 100.0000 (94.5312) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [25/34] time 0.424 (0.418) data 0.299 (0.291) loss_x loss_x 0.2637 (0.2529) acc_x 90.6250 (94.3750) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [30/34] time 0.418 (0.417) data 0.293 (0.291) loss_x loss_x 0.2438 (0.2590) acc_x 93.7500 (93.9583) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [5/16] time 0.364 (0.407) data 0.235 (0.280) loss_u loss_u 0.8081 (0.8854) acc_u 21.8750 (12.5000) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/16] time 0.390 (0.405) data 0.260 (0.278) loss_u loss_u 0.9609 (0.8946) acc_u 6.2500 (11.5625) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/16] time 0.390 (0.403) data 0.262 (0.276) loss_u loss_u 0.9268 (0.8785) acc_u 9.3750 (13.5417) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 209
confident_label rate tensor(0.6710, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1095
clean true:1091
clean false:4
clean_rate:0.9963470319634703
noisy true:332
noisy false:205
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 537
epoch [163/200] batch [5/34] time 0.432 (0.424) data 0.309 (0.298) loss_x loss_x 0.0837 (0.2782) acc_x 100.0000 (95.6250) lr 1.8185e-04 eta 0:00:12
epoch [163/200] batch [10/34] time 0.424 (0.418) data 0.303 (0.293) loss_x loss_x 0.1837 (0.2837) acc_x 96.8750 (94.6875) lr 1.8185e-04 eta 0:00:10
epoch [163/200] batch [15/34] time 0.408 (0.411) data 0.284 (0.289) loss_x loss_x 0.1382 (0.2927) acc_x 100.0000 (94.3750) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [20/34] time 0.410 (0.411) data 0.284 (0.289) loss_x loss_x 0.2795 (0.2837) acc_x 93.7500 (94.3750) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [25/34] time 0.391 (0.410) data 0.266 (0.288) loss_x loss_x 0.3164 (0.2726) acc_x 93.7500 (94.6250) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [30/34] time 0.380 (0.408) data 0.269 (0.285) loss_x loss_x 0.2695 (0.2695) acc_x 93.7500 (94.4792) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [5/16] time 0.363 (0.402) data 0.238 (0.277) loss_u loss_u 0.8369 (0.8854) acc_u 18.7500 (12.5000) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/16] time 0.414 (0.399) data 0.287 (0.274) loss_u loss_u 0.8335 (0.8691) acc_u 18.7500 (14.0625) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/16] time 0.409 (0.396) data 0.280 (0.271) loss_u loss_u 0.8574 (0.8696) acc_u 15.6250 (14.1667) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.6728, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1098
clean true:1095
clean false:3
clean_rate:0.9972677595628415
noisy true:339
noisy false:195
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 534
epoch [164/200] batch [5/34] time 0.412 (0.413) data 0.286 (0.287) loss_x loss_x 0.3105 (0.4432) acc_x 87.5000 (90.0000) lr 1.7292e-04 eta 0:00:11
epoch [164/200] batch [10/34] time 0.398 (0.410) data 0.272 (0.284) loss_x loss_x 0.1761 (0.3338) acc_x 96.8750 (93.1250) lr 1.7292e-04 eta 0:00:09
epoch [164/200] batch [15/34] time 0.392 (0.406) data 0.268 (0.281) loss_x loss_x 0.1108 (0.3101) acc_x 100.0000 (93.7500) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [20/34] time 0.406 (0.407) data 0.281 (0.281) loss_x loss_x 0.1998 (0.2993) acc_x 96.8750 (94.0625) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [25/34] time 0.348 (0.399) data 0.221 (0.273) loss_x loss_x 0.5049 (0.3016) acc_x 87.5000 (93.8750) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [30/34] time 0.387 (0.395) data 0.263 (0.269) loss_x loss_x 0.2876 (0.3013) acc_x 93.7500 (93.8542) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [5/16] time 0.406 (0.396) data 0.280 (0.271) loss_u loss_u 0.8115 (0.8931) acc_u 21.8750 (11.2500) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/16] time 0.368 (0.393) data 0.243 (0.268) loss_u loss_u 0.8491 (0.8881) acc_u 18.7500 (12.1875) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/16] time 0.379 (0.393) data 0.253 (0.268) loss_u loss_u 0.9521 (0.8844) acc_u 6.2500 (12.7083) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 192
confident_label rate tensor(0.6808, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1111
clean true:1109
clean false:2
clean_rate:0.9981998199819982
noisy true:331
noisy false:190
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 521
epoch [165/200] batch [5/34] time 0.399 (0.409) data 0.272 (0.281) loss_x loss_x 0.2113 (0.2110) acc_x 96.8750 (96.8750) lr 1.6419e-04 eta 0:00:11
epoch [165/200] batch [10/34] time 0.401 (0.409) data 0.275 (0.282) loss_x loss_x 0.2003 (0.2340) acc_x 93.7500 (95.0000) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [15/34] time 0.421 (0.422) data 0.295 (0.295) loss_x loss_x 0.7119 (0.2684) acc_x 93.7500 (94.7917) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [20/34] time 0.463 (0.426) data 0.337 (0.299) loss_x loss_x 0.3379 (0.2789) acc_x 93.7500 (94.5312) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [25/34] time 0.412 (0.428) data 0.287 (0.301) loss_x loss_x 0.2008 (0.2831) acc_x 93.7500 (94.5000) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [30/34] time 0.417 (0.426) data 0.291 (0.303) loss_x loss_x 0.1823 (0.2768) acc_x 96.8750 (94.6875) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [5/16] time 0.408 (0.423) data 0.282 (0.299) loss_u loss_u 0.9375 (0.8899) acc_u 9.3750 (13.1250) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/16] time 0.349 (0.419) data 0.224 (0.294) loss_u loss_u 0.9395 (0.9050) acc_u 6.2500 (11.5625) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/16] time 0.405 (0.415) data 0.278 (0.290) loss_u loss_u 0.9155 (0.9043) acc_u 9.3750 (11.2500) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 216
confident_label rate tensor(0.6654, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1086
clean true:1083
clean false:3
clean_rate:0.9972375690607734
noisy true:333
noisy false:213
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 546
epoch [166/200] batch [5/33] time 0.420 (0.449) data 0.296 (0.325) loss_x loss_x 0.3706 (0.3687) acc_x 93.7500 (94.3750) lr 1.5567e-04 eta 0:00:12
epoch [166/200] batch [10/33] time 0.389 (0.438) data 0.262 (0.314) loss_x loss_x 0.1957 (0.3067) acc_x 93.7500 (94.3750) lr 1.5567e-04 eta 0:00:10
epoch [166/200] batch [15/33] time 0.405 (0.424) data 0.280 (0.299) loss_x loss_x 0.3174 (0.3098) acc_x 93.7500 (93.1250) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [20/33] time 0.380 (0.417) data 0.254 (0.292) loss_x loss_x 0.4380 (0.3216) acc_x 90.6250 (92.3438) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [25/33] time 0.403 (0.413) data 0.277 (0.288) loss_x loss_x 0.2000 (0.3265) acc_x 96.8750 (92.0000) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [30/33] time 0.389 (0.408) data 0.266 (0.285) loss_x loss_x 0.2422 (0.3238) acc_x 90.6250 (91.9792) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [5/17] time 0.393 (0.401) data 0.266 (0.277) loss_u loss_u 0.8589 (0.8839) acc_u 18.7500 (13.7500) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/17] time 0.400 (0.401) data 0.277 (0.277) loss_u loss_u 0.8804 (0.8554) acc_u 15.6250 (17.5000) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/17] time 0.354 (0.397) data 0.226 (0.273) loss_u loss_u 0.8960 (0.8607) acc_u 12.5000 (17.2917) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 200
confident_label rate tensor(0.6716, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1096
clean true:1092
clean false:4
clean_rate:0.9963503649635036
noisy true:340
noisy false:196
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 536
epoch [167/200] batch [5/34] time 0.439 (0.419) data 0.310 (0.291) loss_x loss_x 0.1260 (0.1918) acc_x 100.0000 (95.6250) lr 1.4736e-04 eta 0:00:12
epoch [167/200] batch [10/34] time 0.355 (0.404) data 0.240 (0.282) loss_x loss_x 0.2539 (0.2475) acc_x 96.8750 (94.6875) lr 1.4736e-04 eta 0:00:09
epoch [167/200] batch [15/34] time 0.428 (0.394) data 0.301 (0.271) loss_x loss_x 0.2401 (0.2592) acc_x 96.8750 (94.5833) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [20/34] time 0.413 (0.400) data 0.289 (0.277) loss_x loss_x 0.2549 (0.2746) acc_x 93.7500 (94.2188) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [25/34] time 0.415 (0.405) data 0.292 (0.281) loss_x loss_x 0.2546 (0.2666) acc_x 90.6250 (94.3750) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [30/34] time 0.418 (0.409) data 0.293 (0.285) loss_x loss_x 0.4202 (0.2703) acc_x 90.6250 (94.4792) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [5/16] time 0.450 (0.411) data 0.320 (0.288) loss_u loss_u 0.8569 (0.8850) acc_u 15.6250 (13.7500) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/16] time 0.402 (0.411) data 0.279 (0.288) loss_u loss_u 0.9429 (0.8876) acc_u 6.2500 (13.4375) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/16] time 0.390 (0.409) data 0.262 (0.285) loss_u loss_u 0.8833 (0.8886) acc_u 15.6250 (13.7500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 204
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1098
clean false:4
clean_rate:0.9963702359346642
noisy true:330
noisy false:200
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [168/200] batch [5/34] time 0.442 (0.436) data 0.316 (0.310) loss_x loss_x 0.2510 (0.2872) acc_x 93.7500 (95.0000) lr 1.3926e-04 eta 0:00:12
epoch [168/200] batch [10/34] time 0.417 (0.428) data 0.290 (0.301) loss_x loss_x 0.2312 (0.2667) acc_x 96.8750 (95.0000) lr 1.3926e-04 eta 0:00:10
epoch [168/200] batch [15/34] time 0.421 (0.425) data 0.295 (0.301) loss_x loss_x 0.3040 (0.2619) acc_x 90.6250 (94.3750) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [20/34] time 0.432 (0.432) data 0.307 (0.308) loss_x loss_x 0.3325 (0.2589) acc_x 90.6250 (94.5312) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [25/34] time 0.393 (0.432) data 0.267 (0.309) loss_x loss_x 0.3120 (0.2619) acc_x 96.8750 (94.6250) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [30/34] time 0.420 (0.430) data 0.296 (0.306) loss_x loss_x 0.2365 (0.2464) acc_x 93.7500 (95.1042) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [5/16] time 0.408 (0.426) data 0.280 (0.303) loss_u loss_u 0.9731 (0.9124) acc_u 3.1250 (9.3750) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/16] time 0.361 (0.420) data 0.235 (0.296) loss_u loss_u 0.9961 (0.9049) acc_u 0.0000 (10.3125) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/16] time 0.386 (0.417) data 0.260 (0.293) loss_u loss_u 0.9146 (0.8961) acc_u 9.3750 (11.4583) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1106
clean false:2
clean_rate:0.9981949458483754
noisy true:345
noisy false:179
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [169/200] batch [5/34] time 0.400 (0.433) data 0.276 (0.299) loss_x loss_x 0.2303 (0.2842) acc_x 96.8750 (91.8750) lr 1.3137e-04 eta 0:00:12
epoch [169/200] batch [10/34] time 0.426 (0.418) data 0.299 (0.288) loss_x loss_x 0.1240 (0.2792) acc_x 100.0000 (93.4375) lr 1.3137e-04 eta 0:00:10
epoch [169/200] batch [15/34] time 0.404 (0.419) data 0.278 (0.290) loss_x loss_x 0.2615 (0.2607) acc_x 93.7500 (94.3750) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [20/34] time 0.405 (0.419) data 0.278 (0.291) loss_x loss_x 0.2625 (0.2455) acc_x 96.8750 (94.5312) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [25/34] time 0.350 (0.414) data 0.223 (0.286) loss_x loss_x 0.1208 (0.2491) acc_x 96.8750 (94.1250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [30/34] time 0.447 (0.408) data 0.321 (0.282) loss_x loss_x 0.3401 (0.2594) acc_x 87.5000 (93.8542) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [5/16] time 0.422 (0.410) data 0.295 (0.284) loss_u loss_u 0.9062 (0.9179) acc_u 9.3750 (9.3750) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [10/16] time 0.351 (0.409) data 0.273 (0.283) loss_u loss_u 0.8818 (0.9071) acc_u 12.5000 (10.6250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/16] time 0.394 (0.407) data 0.268 (0.282) loss_u loss_u 0.7866 (0.8917) acc_u 21.8750 (11.8750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 199
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1099
clean false:4
clean_rate:0.9963735267452403
noisy true:334
noisy false:195
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [170/200] batch [5/34] time 0.407 (0.399) data 0.279 (0.284) loss_x loss_x 0.2729 (0.2223) acc_x 93.7500 (95.6250) lr 1.2369e-04 eta 0:00:11
epoch [170/200] batch [10/34] time 0.438 (0.408) data 0.313 (0.288) loss_x loss_x 0.4124 (0.3016) acc_x 87.5000 (94.3750) lr 1.2369e-04 eta 0:00:09
epoch [170/200] batch [15/34] time 0.394 (0.411) data 0.269 (0.289) loss_x loss_x 0.1947 (0.2844) acc_x 96.8750 (94.5833) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [20/34] time 0.385 (0.411) data 0.259 (0.289) loss_x loss_x 0.3562 (0.2863) acc_x 90.6250 (95.0000) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [25/34] time 0.411 (0.415) data 0.289 (0.291) loss_x loss_x 0.0888 (0.2728) acc_x 100.0000 (94.8750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [30/34] time 0.402 (0.413) data 0.276 (0.289) loss_x loss_x 0.3655 (0.2615) acc_x 90.6250 (94.8958) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [5/16] time 0.399 (0.411) data 0.271 (0.286) loss_u loss_u 0.9062 (0.9124) acc_u 12.5000 (10.0000) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/16] time 0.355 (0.404) data 0.227 (0.279) loss_u loss_u 0.8237 (0.8900) acc_u 18.7500 (12.1875) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/16] time 0.381 (0.403) data 0.254 (0.277) loss_u loss_u 0.8574 (0.8905) acc_u 15.6250 (12.2917) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 186
confident_label rate tensor(0.6771, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1105
clean true:1102
clean false:3
clean_rate:0.9972850678733032
noisy true:344
noisy false:183
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 527
epoch [171/200] batch [5/34] time 0.347 (0.351) data 0.220 (0.225) loss_x loss_x 0.3435 (0.2500) acc_x 87.5000 (93.1250) lr 1.1623e-04 eta 0:00:10
epoch [171/200] batch [10/34] time 0.347 (0.349) data 0.221 (0.222) loss_x loss_x 0.1421 (0.2314) acc_x 100.0000 (95.0000) lr 1.1623e-04 eta 0:00:08
epoch [171/200] batch [15/34] time 0.384 (0.355) data 0.306 (0.232) loss_x loss_x 0.1886 (0.2345) acc_x 96.8750 (95.0000) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [20/34] time 0.347 (0.359) data 0.220 (0.235) loss_x loss_x 0.2369 (0.2601) acc_x 96.8750 (94.3750) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [25/34] time 0.350 (0.357) data 0.220 (0.232) loss_x loss_x 0.1249 (0.2578) acc_x 100.0000 (94.2500) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [30/34] time 0.349 (0.355) data 0.222 (0.230) loss_x loss_x 0.1786 (0.2648) acc_x 96.8750 (94.1667) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [5/16] time 0.345 (0.354) data 0.217 (0.228) loss_u loss_u 0.9277 (0.8884) acc_u 9.3750 (12.5000) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/16] time 0.345 (0.353) data 0.218 (0.227) loss_u loss_u 0.9058 (0.8943) acc_u 9.3750 (12.1875) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/16] time 0.349 (0.352) data 0.223 (0.226) loss_u loss_u 0.9468 (0.8964) acc_u 6.2500 (11.4583) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.6648, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1085
clean true:1081
clean false:4
clean_rate:0.9963133640552996
noisy true:345
noisy false:202
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 547
epoch [172/200] batch [5/33] time 0.336 (0.342) data 0.209 (0.218) loss_x loss_x 0.1907 (0.2217) acc_x 96.8750 (96.8750) lr 1.0899e-04 eta 0:00:09
epoch [172/200] batch [10/33] time 0.344 (0.341) data 0.217 (0.216) loss_x loss_x 0.2832 (0.2431) acc_x 93.7500 (95.0000) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [15/33] time 0.329 (0.340) data 0.204 (0.215) loss_x loss_x 0.2524 (0.2659) acc_x 96.8750 (94.3750) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [20/33] time 0.342 (0.341) data 0.216 (0.215) loss_x loss_x 0.3713 (0.2828) acc_x 93.7500 (94.0625) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [25/33] time 0.335 (0.341) data 0.210 (0.215) loss_x loss_x 0.7666 (0.2892) acc_x 87.5000 (94.2500) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [30/33] time 0.340 (0.341) data 0.216 (0.215) loss_x loss_x 0.1342 (0.2813) acc_x 100.0000 (94.3750) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [5/17] time 0.345 (0.342) data 0.215 (0.216) loss_u loss_u 0.8848 (0.8450) acc_u 12.5000 (17.5000) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/17] time 0.336 (0.340) data 0.209 (0.215) loss_u loss_u 0.9023 (0.8683) acc_u 12.5000 (15.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/17] time 0.335 (0.340) data 0.208 (0.215) loss_u loss_u 0.8804 (0.8596) acc_u 12.5000 (16.4583) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.6826, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1114
clean true:1110
clean false:4
clean_rate:0.9964093357271095
noisy true:339
noisy false:179
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 518
epoch [173/200] batch [5/34] time 0.386 (0.350) data 0.259 (0.223) loss_x loss_x 0.1610 (0.3155) acc_x 96.8750 (92.5000) lr 1.0197e-04 eta 0:00:10
epoch [173/200] batch [10/34] time 0.339 (0.347) data 0.212 (0.221) loss_x loss_x 0.2825 (0.3040) acc_x 93.7500 (92.1875) lr 1.0197e-04 eta 0:00:08
epoch [173/200] batch [15/34] time 0.325 (0.343) data 0.199 (0.217) loss_x loss_x 0.5566 (0.3019) acc_x 84.3750 (92.9167) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [20/34] time 0.340 (0.342) data 0.214 (0.216) loss_x loss_x 0.2208 (0.2967) acc_x 96.8750 (92.9688) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [25/34] time 0.332 (0.341) data 0.206 (0.215) loss_x loss_x 0.4827 (0.3024) acc_x 87.5000 (93.0000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [30/34] time 0.341 (0.342) data 0.214 (0.215) loss_x loss_x 0.2727 (0.2996) acc_x 96.8750 (93.2292) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [5/16] time 0.368 (0.342) data 0.216 (0.216) loss_u loss_u 0.8770 (0.9035) acc_u 12.5000 (11.2500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/16] time 0.340 (0.343) data 0.214 (0.217) loss_u loss_u 0.9082 (0.9002) acc_u 9.3750 (11.5625) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/16] time 0.335 (0.343) data 0.203 (0.217) loss_u loss_u 0.9409 (0.9075) acc_u 6.2500 (10.4167) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 209
confident_label rate tensor(0.6648, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1085
clean true:1080
clean false:5
clean_rate:0.9953917050691244
noisy true:343
noisy false:204
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 547
epoch [174/200] batch [5/33] time 0.343 (0.342) data 0.218 (0.216) loss_x loss_x 0.2311 (0.3373) acc_x 87.5000 (90.6250) lr 9.5173e-05 eta 0:00:09
epoch [174/200] batch [10/33] time 0.352 (0.342) data 0.224 (0.215) loss_x loss_x 0.1743 (0.2769) acc_x 93.7500 (91.8750) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [15/33] time 0.343 (0.342) data 0.216 (0.216) loss_x loss_x 0.1207 (0.2674) acc_x 100.0000 (93.1250) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [20/33] time 0.349 (0.342) data 0.219 (0.215) loss_x loss_x 0.3689 (0.2589) acc_x 87.5000 (93.5938) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [25/33] time 0.345 (0.343) data 0.219 (0.216) loss_x loss_x 0.2048 (0.2419) acc_x 93.7500 (94.1250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [30/33] time 0.336 (0.341) data 0.210 (0.215) loss_x loss_x 0.2346 (0.2391) acc_x 96.8750 (94.5833) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [5/17] time 0.336 (0.342) data 0.210 (0.216) loss_u loss_u 0.8003 (0.8597) acc_u 21.8750 (16.8750) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/17] time 0.353 (0.342) data 0.225 (0.216) loss_u loss_u 0.8262 (0.8540) acc_u 21.8750 (16.8750) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/17] time 0.348 (0.343) data 0.218 (0.216) loss_u loss_u 0.8701 (0.8648) acc_u 12.5000 (15.4167) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 188
confident_label rate tensor(0.6771, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1105
clean true:1101
clean false:4
clean_rate:0.9963800904977376
noisy true:343
noisy false:184
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 527
epoch [175/200] batch [5/34] time 0.347 (0.348) data 0.221 (0.224) loss_x loss_x 0.4973 (0.3248) acc_x 87.5000 (91.8750) lr 8.8597e-05 eta 0:00:10
epoch [175/200] batch [10/34] time 0.342 (0.347) data 0.217 (0.223) loss_x loss_x 0.4238 (0.3432) acc_x 90.6250 (91.2500) lr 8.8597e-05 eta 0:00:08
epoch [175/200] batch [15/34] time 0.345 (0.348) data 0.219 (0.222) loss_x loss_x 0.1049 (0.3065) acc_x 96.8750 (92.5000) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [20/34] time 0.356 (0.347) data 0.230 (0.222) loss_x loss_x 0.2788 (0.2796) acc_x 93.7500 (93.4375) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [25/34] time 0.329 (0.347) data 0.202 (0.221) loss_x loss_x 0.5098 (0.2782) acc_x 84.3750 (93.3750) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [30/34] time 0.293 (0.344) data 0.214 (0.220) loss_x loss_x 0.3965 (0.2816) acc_x 90.6250 (93.3333) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [5/16] time 0.345 (0.344) data 0.215 (0.219) loss_u loss_u 0.9043 (0.9338) acc_u 12.5000 (8.1250) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/16] time 0.341 (0.344) data 0.212 (0.219) loss_u loss_u 0.9219 (0.9082) acc_u 9.3750 (10.9375) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/16] time 0.338 (0.344) data 0.211 (0.218) loss_u loss_u 0.8857 (0.9006) acc_u 12.5000 (11.6667) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 207
confident_label rate tensor(0.6716, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1096
clean true:1095
clean false:1
clean_rate:0.9990875912408759
noisy true:330
noisy false:206
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 536
epoch [176/200] batch [5/34] time 0.371 (0.390) data 0.243 (0.262) loss_x loss_x 0.1597 (0.1990) acc_x 96.8750 (96.8750) lr 8.2245e-05 eta 0:00:11
epoch [176/200] batch [10/34] time 0.336 (0.366) data 0.209 (0.238) loss_x loss_x 0.4197 (0.2262) acc_x 87.5000 (96.5625) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [15/34] time 0.347 (0.353) data 0.220 (0.230) loss_x loss_x 0.1920 (0.2502) acc_x 96.8750 (95.8333) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [20/34] time 0.342 (0.350) data 0.215 (0.226) loss_x loss_x 0.7163 (0.2740) acc_x 81.2500 (94.6875) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [25/34] time 0.337 (0.347) data 0.212 (0.223) loss_x loss_x 0.1177 (0.2778) acc_x 100.0000 (94.6250) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [30/34] time 0.329 (0.346) data 0.205 (0.222) loss_x loss_x 0.7339 (0.2865) acc_x 84.3750 (94.4792) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [5/16] time 0.343 (0.344) data 0.215 (0.219) loss_u loss_u 0.8330 (0.8707) acc_u 18.7500 (14.3750) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/16] time 0.405 (0.346) data 0.239 (0.221) loss_u loss_u 0.8047 (0.8730) acc_u 21.8750 (14.0625) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/16] time 0.358 (0.346) data 0.228 (0.221) loss_u loss_u 0.8848 (0.8828) acc_u 12.5000 (13.1250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 193
confident_label rate tensor(0.6765, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1104
clean true:1100
clean false:4
clean_rate:0.9963768115942029
noisy true:339
noisy false:189
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 528
epoch [177/200] batch [5/34] time 0.332 (0.355) data 0.208 (0.229) loss_x loss_x 0.1970 (0.3318) acc_x 100.0000 (95.6250) lr 7.6120e-05 eta 0:00:10
epoch [177/200] batch [10/34] time 0.349 (0.347) data 0.222 (0.221) loss_x loss_x 0.1521 (0.2637) acc_x 96.8750 (95.3125) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [15/34] time 0.338 (0.342) data 0.213 (0.219) loss_x loss_x 0.2296 (0.2914) acc_x 96.8750 (94.1667) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [20/34] time 0.340 (0.341) data 0.214 (0.218) loss_x loss_x 0.1354 (0.2864) acc_x 96.8750 (93.9062) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [25/34] time 0.332 (0.340) data 0.207 (0.216) loss_x loss_x 0.2344 (0.2694) acc_x 96.8750 (94.2500) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [30/34] time 0.342 (0.340) data 0.215 (0.216) loss_x loss_x 0.1949 (0.2646) acc_x 96.8750 (94.3750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [5/16] time 0.350 (0.341) data 0.221 (0.216) loss_u loss_u 0.8530 (0.8646) acc_u 15.6250 (14.3750) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/16] time 0.341 (0.341) data 0.216 (0.216) loss_u loss_u 0.9048 (0.8830) acc_u 9.3750 (12.5000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/16] time 0.355 (0.341) data 0.212 (0.216) loss_u loss_u 0.9395 (0.8984) acc_u 6.2500 (11.0417) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 166
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1123
clean true:1118
clean false:5
clean_rate:0.9955476402493322
noisy true:348
noisy false:161
after delete: len(clean_dataset) 1123
after delete: len(noisy_dataset) 509
epoch [178/200] batch [5/35] time 0.339 (0.339) data 0.212 (0.212) loss_x loss_x 0.2615 (0.2599) acc_x 93.7500 (94.3750) lr 7.0224e-05 eta 0:00:10
epoch [178/200] batch [10/35] time 0.343 (0.342) data 0.215 (0.214) loss_x loss_x 0.2151 (0.2470) acc_x 96.8750 (95.0000) lr 7.0224e-05 eta 0:00:08
epoch [178/200] batch [15/35] time 0.350 (0.341) data 0.223 (0.214) loss_x loss_x 0.1571 (0.2575) acc_x 96.8750 (94.1667) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [20/35] time 0.337 (0.341) data 0.210 (0.214) loss_x loss_x 0.3669 (0.2558) acc_x 93.7500 (94.0625) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [25/35] time 0.343 (0.341) data 0.214 (0.214) loss_x loss_x 0.4231 (0.2858) acc_x 87.5000 (93.2500) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [30/35] time 0.339 (0.340) data 0.212 (0.213) loss_x loss_x 0.5381 (0.2943) acc_x 87.5000 (93.3333) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [35/35] time 0.339 (0.341) data 0.210 (0.213) loss_x loss_x 0.3098 (0.2868) acc_x 93.7500 (93.5714) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/15] time 0.293 (0.340) data 0.215 (0.214) loss_u loss_u 0.9370 (0.8852) acc_u 6.2500 (12.5000) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/15] time 0.350 (0.341) data 0.220 (0.214) loss_u loss_u 0.9087 (0.9007) acc_u 12.5000 (11.2500) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/15] time 0.345 (0.341) data 0.216 (0.214) loss_u loss_u 0.8633 (0.9113) acc_u 18.7500 (10.4167) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6783, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1107
clean true:1103
clean false:4
clean_rate:0.996386630532972
noisy true:339
noisy false:186
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 525
epoch [179/200] batch [5/34] time 0.339 (0.334) data 0.214 (0.218) loss_x loss_x 0.2930 (0.3792) acc_x 90.6250 (91.2500) lr 6.4556e-05 eta 0:00:09
epoch [179/200] batch [10/34] time 0.340 (0.338) data 0.214 (0.218) loss_x loss_x 0.6030 (0.3303) acc_x 87.5000 (91.5625) lr 6.4556e-05 eta 0:00:08
epoch [179/200] batch [15/34] time 0.339 (0.339) data 0.213 (0.216) loss_x loss_x 0.3052 (0.3016) acc_x 93.7500 (93.1250) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [20/34] time 0.346 (0.340) data 0.220 (0.217) loss_x loss_x 0.1429 (0.2757) acc_x 96.8750 (94.3750) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [25/34] time 0.322 (0.339) data 0.198 (0.215) loss_x loss_x 0.4363 (0.2822) acc_x 90.6250 (94.2500) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [30/34] time 0.342 (0.339) data 0.217 (0.215) loss_x loss_x 0.1395 (0.2647) acc_x 96.8750 (94.6875) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [5/16] time 0.350 (0.338) data 0.222 (0.215) loss_u loss_u 0.9268 (0.9059) acc_u 9.3750 (11.2500) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/16] time 0.340 (0.338) data 0.213 (0.215) loss_u loss_u 0.8442 (0.8933) acc_u 15.6250 (12.1875) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/16] time 0.345 (0.339) data 0.219 (0.215) loss_u loss_u 0.8589 (0.8900) acc_u 15.6250 (12.2917) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 178
confident_label rate tensor(0.6838, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1116
clean true:1112
clean false:4
clean_rate:0.996415770609319
noisy true:342
noisy false:174
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 516
epoch [180/200] batch [5/34] time 0.340 (0.345) data 0.214 (0.219) loss_x loss_x 0.2445 (0.2990) acc_x 96.8750 (95.6250) lr 5.9119e-05 eta 0:00:09
epoch [180/200] batch [10/34] time 0.348 (0.343) data 0.224 (0.218) loss_x loss_x 0.3257 (0.2845) acc_x 90.6250 (94.6875) lr 5.9119e-05 eta 0:00:08
epoch [180/200] batch [15/34] time 0.341 (0.342) data 0.215 (0.216) loss_x loss_x 0.1824 (0.2809) acc_x 93.7500 (94.5833) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [20/34] time 0.349 (0.342) data 0.219 (0.216) loss_x loss_x 0.1865 (0.2802) acc_x 93.7500 (94.3750) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [25/34] time 0.342 (0.342) data 0.218 (0.216) loss_x loss_x 0.5010 (0.2874) acc_x 90.6250 (94.1250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [30/34] time 0.347 (0.344) data 0.218 (0.218) loss_x loss_x 0.2834 (0.2973) acc_x 96.8750 (93.8542) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [5/16] time 0.343 (0.343) data 0.218 (0.218) loss_u loss_u 0.8931 (0.9156) acc_u 12.5000 (10.0000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/16] time 0.348 (0.343) data 0.222 (0.218) loss_u loss_u 0.9692 (0.9128) acc_u 3.1250 (9.6875) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/16] time 0.346 (0.343) data 0.219 (0.219) loss_u loss_u 0.9692 (0.9183) acc_u 6.2500 (9.3750) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.6716, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1096
clean true:1094
clean false:2
clean_rate:0.9981751824817519
noisy true:347
noisy false:189
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 536
epoch [181/200] batch [5/34] time 0.345 (0.342) data 0.218 (0.215) loss_x loss_x 0.1107 (0.2423) acc_x 100.0000 (94.3750) lr 5.3915e-05 eta 0:00:09
epoch [181/200] batch [10/34] time 0.343 (0.342) data 0.216 (0.215) loss_x loss_x 0.2932 (0.2608) acc_x 96.8750 (94.3750) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [15/34] time 0.346 (0.339) data 0.220 (0.216) loss_x loss_x 0.1786 (0.2713) acc_x 96.8750 (93.5417) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [20/34] time 0.346 (0.339) data 0.217 (0.215) loss_x loss_x 0.4075 (0.2763) acc_x 87.5000 (93.1250) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [25/34] time 0.342 (0.339) data 0.217 (0.214) loss_x loss_x 0.3228 (0.2938) acc_x 90.6250 (93.0000) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [30/34] time 0.346 (0.340) data 0.218 (0.215) loss_x loss_x 0.2654 (0.2853) acc_x 93.7500 (93.0208) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [5/16] time 0.349 (0.341) data 0.221 (0.215) loss_u loss_u 0.9194 (0.8911) acc_u 9.3750 (13.1250) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/16] time 0.342 (0.340) data 0.218 (0.215) loss_u loss_u 0.8447 (0.8879) acc_u 18.7500 (13.4375) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/16] time 0.342 (0.340) data 0.214 (0.215) loss_u loss_u 0.8794 (0.8866) acc_u 12.5000 (13.3333) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 191
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1099
clean false:4
clean_rate:0.9963735267452403
noisy true:342
noisy false:187
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [182/200] batch [5/34] time 0.349 (0.352) data 0.222 (0.224) loss_x loss_x 0.1700 (0.3184) acc_x 96.8750 (93.7500) lr 4.8943e-05 eta 0:00:10
epoch [182/200] batch [10/34] time 0.353 (0.348) data 0.228 (0.222) loss_x loss_x 0.1777 (0.2703) acc_x 100.0000 (94.3750) lr 4.8943e-05 eta 0:00:08
epoch [182/200] batch [15/34] time 0.341 (0.347) data 0.215 (0.220) loss_x loss_x 0.1843 (0.2616) acc_x 96.8750 (94.5833) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [20/34] time 0.341 (0.346) data 0.213 (0.219) loss_x loss_x 0.1447 (0.2436) acc_x 96.8750 (95.0000) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [25/34] time 0.338 (0.344) data 0.212 (0.218) loss_x loss_x 0.2654 (0.2352) acc_x 93.7500 (95.2500) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [30/34] time 0.336 (0.341) data 0.211 (0.217) loss_x loss_x 0.3821 (0.2532) acc_x 93.7500 (95.0000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [5/16] time 0.337 (0.340) data 0.210 (0.216) loss_u loss_u 0.9165 (0.9098) acc_u 9.3750 (9.3750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/16] time 0.386 (0.342) data 0.258 (0.217) loss_u loss_u 0.9448 (0.8960) acc_u 3.1250 (10.9375) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/16] time 0.381 (0.345) data 0.254 (0.220) loss_u loss_u 0.9497 (0.8963) acc_u 6.2500 (11.4583) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 188
confident_label rate tensor(0.6771, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1105
clean true:1101
clean false:4
clean_rate:0.9963800904977376
noisy true:343
noisy false:184
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 527
epoch [183/200] batch [5/34] time 0.329 (0.345) data 0.205 (0.220) loss_x loss_x 0.3689 (0.2732) acc_x 87.5000 (93.7500) lr 4.4207e-05 eta 0:00:10
epoch [183/200] batch [10/34] time 0.339 (0.343) data 0.214 (0.218) loss_x loss_x 0.4226 (0.2813) acc_x 90.6250 (93.4375) lr 4.4207e-05 eta 0:00:08
epoch [183/200] batch [15/34] time 0.343 (0.343) data 0.217 (0.218) loss_x loss_x 0.2808 (0.2659) acc_x 90.6250 (93.7500) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [20/34] time 0.338 (0.342) data 0.213 (0.217) loss_x loss_x 0.1213 (0.2513) acc_x 100.0000 (94.2188) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [25/34] time 0.343 (0.341) data 0.220 (0.217) loss_x loss_x 0.2421 (0.2709) acc_x 93.7500 (93.7500) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [30/34] time 0.348 (0.341) data 0.224 (0.217) loss_x loss_x 0.1504 (0.2738) acc_x 96.8750 (93.5417) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [5/16] time 0.345 (0.342) data 0.219 (0.217) loss_u loss_u 0.7729 (0.8812) acc_u 25.0000 (12.5000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/16] time 0.351 (0.342) data 0.224 (0.217) loss_u loss_u 0.8784 (0.8935) acc_u 12.5000 (11.2500) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/16] time 0.334 (0.342) data 0.210 (0.217) loss_u loss_u 0.8823 (0.9006) acc_u 15.6250 (11.0417) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 179
confident_label rate tensor(0.6838, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1116
clean true:1112
clean false:4
clean_rate:0.996415770609319
noisy true:341
noisy false:175
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 516
epoch [184/200] batch [5/34] time 0.344 (0.348) data 0.218 (0.221) loss_x loss_x 0.1870 (0.2197) acc_x 90.6250 (93.7500) lr 3.9706e-05 eta 0:00:10
epoch [184/200] batch [10/34] time 0.340 (0.345) data 0.214 (0.218) loss_x loss_x 0.3420 (0.2935) acc_x 93.7500 (90.9375) lr 3.9706e-05 eta 0:00:08
epoch [184/200] batch [15/34] time 0.364 (0.347) data 0.237 (0.220) loss_x loss_x 0.3530 (0.2913) acc_x 93.7500 (92.0833) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [20/34] time 0.348 (0.346) data 0.217 (0.219) loss_x loss_x 0.5479 (0.2877) acc_x 90.6250 (92.3438) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [25/34] time 0.339 (0.345) data 0.212 (0.218) loss_x loss_x 0.2559 (0.2806) acc_x 90.6250 (92.6250) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [30/34] time 0.334 (0.344) data 0.205 (0.217) loss_x loss_x 0.3320 (0.2909) acc_x 96.8750 (92.7083) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [5/16] time 0.348 (0.345) data 0.223 (0.219) loss_u loss_u 0.9106 (0.9103) acc_u 9.3750 (10.0000) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/16] time 0.347 (0.345) data 0.217 (0.219) loss_u loss_u 0.9351 (0.9128) acc_u 6.2500 (9.6875) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/16] time 0.334 (0.344) data 0.205 (0.218) loss_u loss_u 0.8413 (0.9076) acc_u 18.7500 (10.4167) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 184
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1109
clean true:1107
clean false:2
clean_rate:0.9981965734896303
noisy true:341
noisy false:182
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 523
epoch [185/200] batch [5/34] time 0.328 (0.345) data 0.205 (0.214) loss_x loss_x 0.5889 (0.2746) acc_x 87.5000 (95.0000) lr 3.5443e-05 eta 0:00:10
epoch [185/200] batch [10/34] time 0.341 (0.342) data 0.215 (0.214) loss_x loss_x 0.1915 (0.2940) acc_x 96.8750 (94.6875) lr 3.5443e-05 eta 0:00:08
epoch [185/200] batch [15/34] time 0.331 (0.342) data 0.205 (0.214) loss_x loss_x 0.4055 (0.2963) acc_x 90.6250 (94.1667) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [20/34] time 0.342 (0.341) data 0.216 (0.214) loss_x loss_x 0.3062 (0.2913) acc_x 96.8750 (94.6875) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [25/34] time 0.347 (0.342) data 0.218 (0.215) loss_x loss_x 0.1902 (0.2842) acc_x 96.8750 (94.8750) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [30/34] time 0.335 (0.341) data 0.208 (0.214) loss_x loss_x 0.2515 (0.2749) acc_x 93.7500 (94.7917) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [5/16] time 0.344 (0.342) data 0.216 (0.215) loss_u loss_u 0.8657 (0.8866) acc_u 15.6250 (13.1250) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/16] time 0.343 (0.341) data 0.216 (0.215) loss_u loss_u 0.9180 (0.8993) acc_u 9.3750 (11.5625) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/16] time 0.351 (0.342) data 0.228 (0.215) loss_u loss_u 0.7563 (0.8888) acc_u 25.0000 (12.5000) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 206
confident_label rate tensor(0.6679, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1090
clean true:1087
clean false:3
clean_rate:0.9972477064220183
noisy true:339
noisy false:203
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 542
epoch [186/200] batch [5/34] time 0.339 (0.340) data 0.213 (0.214) loss_x loss_x 0.1316 (0.2392) acc_x 96.8750 (93.7500) lr 3.1417e-05 eta 0:00:09
epoch [186/200] batch [10/34] time 0.341 (0.340) data 0.216 (0.214) loss_x loss_x 0.3435 (0.3156) acc_x 93.7500 (92.8125) lr 3.1417e-05 eta 0:00:08
epoch [186/200] batch [15/34] time 0.378 (0.341) data 0.212 (0.215) loss_x loss_x 0.2062 (0.2887) acc_x 93.7500 (93.7500) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [20/34] time 0.336 (0.340) data 0.208 (0.214) loss_x loss_x 0.2534 (0.2981) acc_x 93.7500 (93.7500) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [25/34] time 0.334 (0.340) data 0.209 (0.214) loss_x loss_x 0.5864 (0.3094) acc_x 81.2500 (93.2500) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [30/34] time 0.344 (0.340) data 0.218 (0.214) loss_x loss_x 0.2089 (0.3039) acc_x 96.8750 (93.4375) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [5/16] time 0.346 (0.341) data 0.220 (0.214) loss_u loss_u 0.9062 (0.9360) acc_u 9.3750 (6.8750) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/16] time 0.338 (0.341) data 0.211 (0.214) loss_u loss_u 0.7056 (0.8635) acc_u 34.3750 (15.3125) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/16] time 0.362 (0.340) data 0.209 (0.214) loss_u loss_u 0.9092 (0.8712) acc_u 12.5000 (14.3750) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 173
confident_label rate tensor(0.6857, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1119
clean true:1115
clean false:4
clean_rate:0.9964253798033958
noisy true:344
noisy false:169
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 513
epoch [187/200] batch [5/34] time 0.346 (0.339) data 0.223 (0.215) loss_x loss_x 0.1093 (0.2171) acc_x 96.8750 (94.3750) lr 2.7630e-05 eta 0:00:09
epoch [187/200] batch [10/34] time 0.333 (0.338) data 0.210 (0.214) loss_x loss_x 0.3489 (0.2617) acc_x 87.5000 (94.0625) lr 2.7630e-05 eta 0:00:08
epoch [187/200] batch [15/34] time 0.332 (0.338) data 0.207 (0.214) loss_x loss_x 0.3149 (0.3108) acc_x 93.7500 (92.7083) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [20/34] time 0.333 (0.338) data 0.206 (0.213) loss_x loss_x 0.4473 (0.3142) acc_x 90.6250 (92.9688) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [25/34] time 0.340 (0.336) data 0.214 (0.213) loss_x loss_x 0.2158 (0.2995) acc_x 96.8750 (93.5000) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [30/34] time 0.345 (0.337) data 0.215 (0.213) loss_x loss_x 0.2888 (0.3010) acc_x 96.8750 (93.6458) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [5/16] time 0.335 (0.338) data 0.211 (0.213) loss_u loss_u 0.8960 (0.9267) acc_u 12.5000 (8.1250) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/16] time 0.353 (0.339) data 0.226 (0.214) loss_u loss_u 0.9438 (0.9274) acc_u 6.2500 (8.4375) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/16] time 0.338 (0.339) data 0.209 (0.214) loss_u loss_u 0.8271 (0.9216) acc_u 18.7500 (8.7500) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 181
confident_label rate tensor(0.6808, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1111
clean true:1107
clean false:4
clean_rate:0.9963996399639964
noisy true:344
noisy false:177
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 521
epoch [188/200] batch [5/34] time 0.335 (0.343) data 0.208 (0.217) loss_x loss_x 0.4336 (0.2649) acc_x 90.6250 (95.6250) lr 2.4083e-05 eta 0:00:09
epoch [188/200] batch [10/34] time 0.337 (0.341) data 0.211 (0.215) loss_x loss_x 0.1372 (0.2130) acc_x 100.0000 (96.8750) lr 2.4083e-05 eta 0:00:08
epoch [188/200] batch [15/34] time 0.342 (0.341) data 0.216 (0.215) loss_x loss_x 0.2029 (0.2494) acc_x 93.7500 (95.8333) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [20/34] time 0.332 (0.340) data 0.213 (0.215) loss_x loss_x 0.4182 (0.2881) acc_x 90.6250 (94.2188) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [25/34] time 0.335 (0.338) data 0.209 (0.214) loss_x loss_x 0.1846 (0.2782) acc_x 96.8750 (94.6250) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [30/34] time 0.345 (0.338) data 0.218 (0.214) loss_x loss_x 0.3335 (0.2797) acc_x 96.8750 (94.5833) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [5/16] time 0.343 (0.339) data 0.216 (0.214) loss_u loss_u 0.9136 (0.9085) acc_u 9.3750 (10.6250) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/16] time 0.339 (0.339) data 0.212 (0.214) loss_u loss_u 0.8696 (0.8918) acc_u 15.6250 (12.8125) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/16] time 0.338 (0.340) data 0.209 (0.214) loss_u loss_u 0.9712 (0.8976) acc_u 6.2500 (12.2917) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 187
confident_label rate tensor(0.6752, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1102
clean true:1098
clean false:4
clean_rate:0.9963702359346642
noisy true:347
noisy false:183
after delete: len(clean_dataset) 1102
after delete: len(noisy_dataset) 530
epoch [189/200] batch [5/34] time 0.353 (0.351) data 0.226 (0.224) loss_x loss_x 0.1605 (0.2488) acc_x 93.7500 (93.7500) lr 2.0777e-05 eta 0:00:10
epoch [189/200] batch [10/34] time 0.352 (0.349) data 0.224 (0.221) loss_x loss_x 0.0437 (0.2505) acc_x 100.0000 (94.3750) lr 2.0777e-05 eta 0:00:08
epoch [189/200] batch [15/34] time 0.353 (0.344) data 0.228 (0.220) loss_x loss_x 0.1168 (0.2472) acc_x 100.0000 (94.1667) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [20/34] time 0.336 (0.342) data 0.210 (0.217) loss_x loss_x 0.2247 (0.2420) acc_x 96.8750 (94.3750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [25/34] time 0.338 (0.342) data 0.213 (0.217) loss_x loss_x 0.1823 (0.2348) acc_x 93.7500 (95.0000) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [30/34] time 0.342 (0.341) data 0.217 (0.216) loss_x loss_x 0.1887 (0.2233) acc_x 96.8750 (95.5208) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [5/16] time 0.319 (0.341) data 0.221 (0.216) loss_u loss_u 0.8799 (0.8611) acc_u 15.6250 (16.2500) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/16] time 0.347 (0.342) data 0.221 (0.217) loss_u loss_u 0.9336 (0.8976) acc_u 6.2500 (11.2500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/16] time 0.338 (0.342) data 0.214 (0.216) loss_u loss_u 0.8628 (0.8924) acc_u 12.5000 (11.8750) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 203
confident_label rate tensor(0.6716, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1096
clean true:1093
clean false:3
clean_rate:0.9972627737226277
noisy true:336
noisy false:200
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 536
epoch [190/200] batch [5/34] time 0.346 (0.345) data 0.220 (0.221) loss_x loss_x 0.2296 (0.3079) acc_x 96.8750 (93.1250) lr 1.7713e-05 eta 0:00:10
epoch [190/200] batch [10/34] time 0.341 (0.342) data 0.213 (0.217) loss_x loss_x 0.1918 (0.3150) acc_x 93.7500 (92.8125) lr 1.7713e-05 eta 0:00:08
epoch [190/200] batch [15/34] time 0.334 (0.341) data 0.208 (0.216) loss_x loss_x 0.4380 (0.2758) acc_x 87.5000 (93.7500) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [20/34] time 0.338 (0.341) data 0.212 (0.216) loss_x loss_x 0.1665 (0.2849) acc_x 96.8750 (93.2812) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [25/34] time 0.337 (0.341) data 0.211 (0.215) loss_x loss_x 0.5859 (0.2885) acc_x 78.1250 (93.1250) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [30/34] time 0.355 (0.342) data 0.229 (0.216) loss_x loss_x 0.2083 (0.2714) acc_x 90.6250 (93.4375) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [5/16] time 0.349 (0.342) data 0.217 (0.215) loss_u loss_u 0.8506 (0.8997) acc_u 15.6250 (11.8750) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/16] time 0.337 (0.342) data 0.210 (0.215) loss_u loss_u 0.7969 (0.8778) acc_u 21.8750 (14.0625) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/16] time 0.340 (0.342) data 0.212 (0.216) loss_u loss_u 0.9282 (0.8841) acc_u 6.2500 (12.7083) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 195
confident_label rate tensor(0.6691, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1092
clean true:1091
clean false:1
clean_rate:0.9990842490842491
noisy true:346
noisy false:194
after delete: len(clean_dataset) 1092
after delete: len(noisy_dataset) 540
epoch [191/200] batch [5/34] time 0.348 (0.353) data 0.222 (0.224) loss_x loss_x 0.1351 (0.2086) acc_x 100.0000 (96.2500) lr 1.4891e-05 eta 0:00:10
epoch [191/200] batch [10/34] time 0.343 (0.348) data 0.216 (0.221) loss_x loss_x 0.1399 (0.2147) acc_x 100.0000 (95.9375) lr 1.4891e-05 eta 0:00:08
epoch [191/200] batch [15/34] time 0.343 (0.348) data 0.215 (0.221) loss_x loss_x 0.1808 (0.2024) acc_x 96.8750 (96.0417) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [20/34] time 0.349 (0.346) data 0.221 (0.219) loss_x loss_x 0.3037 (0.2194) acc_x 96.8750 (95.9375) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [25/34] time 0.342 (0.345) data 0.214 (0.218) loss_x loss_x 0.3389 (0.2474) acc_x 93.7500 (95.1250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [30/34] time 0.287 (0.344) data 0.210 (0.219) loss_x loss_x 0.3135 (0.2389) acc_x 93.7500 (95.2083) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [5/16] time 0.344 (0.344) data 0.215 (0.218) loss_u loss_u 0.7886 (0.8905) acc_u 21.8750 (11.2500) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/16] time 0.346 (0.343) data 0.218 (0.217) loss_u loss_u 0.8105 (0.8861) acc_u 18.7500 (11.8750) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/16] time 0.344 (0.343) data 0.217 (0.217) loss_u loss_u 0.8267 (0.8795) acc_u 18.7500 (12.7083) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 198
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1110
clean true:1105
clean false:5
clean_rate:0.9954954954954955
noisy true:329
noisy false:193
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 522
epoch [192/200] batch [5/34] time 0.341 (0.342) data 0.215 (0.217) loss_x loss_x 0.1649 (0.2721) acc_x 96.8750 (93.7500) lr 1.2312e-05 eta 0:00:09
epoch [192/200] batch [10/34] time 0.333 (0.340) data 0.209 (0.215) loss_x loss_x 0.3013 (0.2600) acc_x 93.7500 (94.3750) lr 1.2312e-05 eta 0:00:08
epoch [192/200] batch [15/34] time 0.333 (0.340) data 0.207 (0.215) loss_x loss_x 0.2355 (0.2676) acc_x 93.7500 (94.3750) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [20/34] time 0.339 (0.340) data 0.210 (0.214) loss_x loss_x 0.2820 (0.2715) acc_x 93.7500 (93.9062) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [25/34] time 0.343 (0.340) data 0.217 (0.214) loss_x loss_x 0.1346 (0.2731) acc_x 96.8750 (94.0000) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [30/34] time 0.337 (0.339) data 0.211 (0.213) loss_x loss_x 0.1683 (0.2595) acc_x 100.0000 (94.5833) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [5/16] time 0.348 (0.340) data 0.219 (0.214) loss_u loss_u 0.8877 (0.8890) acc_u 12.5000 (13.1250) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/16] time 0.297 (0.339) data 0.219 (0.214) loss_u loss_u 0.8735 (0.8901) acc_u 15.6250 (12.8125) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/16] time 0.336 (0.339) data 0.209 (0.214) loss_u loss_u 0.9668 (0.9048) acc_u 3.1250 (11.2500) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 176
confident_label rate tensor(0.6814, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1112
clean true:1108
clean false:4
clean_rate:0.9964028776978417
noisy true:348
noisy false:172
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 520
epoch [193/200] batch [5/34] time 0.344 (0.353) data 0.217 (0.222) loss_x loss_x 0.2212 (0.3607) acc_x 87.5000 (88.1250) lr 9.9763e-06 eta 0:00:10
epoch [193/200] batch [10/34] time 0.340 (0.347) data 0.215 (0.219) loss_x loss_x 0.2920 (0.3642) acc_x 93.7500 (90.3125) lr 9.9763e-06 eta 0:00:08
epoch [193/200] batch [15/34] time 0.335 (0.345) data 0.211 (0.218) loss_x loss_x 0.3933 (0.3295) acc_x 93.7500 (91.8750) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [20/34] time 0.335 (0.343) data 0.206 (0.216) loss_x loss_x 0.3030 (0.3288) acc_x 93.7500 (91.8750) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [25/34] time 0.294 (0.341) data 0.216 (0.216) loss_x loss_x 0.2825 (0.3229) acc_x 90.6250 (92.0000) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [30/34] time 0.335 (0.340) data 0.210 (0.215) loss_x loss_x 0.2216 (0.3376) acc_x 96.8750 (91.7708) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [5/16] time 0.336 (0.340) data 0.210 (0.215) loss_u loss_u 0.9028 (0.9187) acc_u 12.5000 (10.0000) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/16] time 0.357 (0.341) data 0.231 (0.215) loss_u loss_u 0.8833 (0.9117) acc_u 15.6250 (10.9375) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/16] time 0.333 (0.341) data 0.209 (0.215) loss_u loss_u 0.9478 (0.9026) acc_u 6.2500 (11.8750) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6789, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1108
clean true:1105
clean false:3
clean_rate:0.9972924187725631
noisy true:337
noisy false:187
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 524
epoch [194/200] batch [5/34] time 0.333 (0.322) data 0.209 (0.216) loss_x loss_x 0.4858 (0.2178) acc_x 90.6250 (96.8750) lr 7.8853e-06 eta 0:00:09
epoch [194/200] batch [10/34] time 0.330 (0.328) data 0.208 (0.214) loss_x loss_x 0.4202 (0.2351) acc_x 87.5000 (95.3125) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [15/34] time 0.341 (0.332) data 0.219 (0.215) loss_x loss_x 0.1246 (0.2438) acc_x 100.0000 (95.6250) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [20/34] time 0.338 (0.334) data 0.213 (0.214) loss_x loss_x 0.3181 (0.2588) acc_x 96.8750 (95.3125) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [25/34] time 0.338 (0.335) data 0.213 (0.214) loss_x loss_x 0.2317 (0.2659) acc_x 96.8750 (95.1250) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [30/34] time 0.280 (0.334) data 0.202 (0.214) loss_x loss_x 0.2350 (0.2619) acc_x 96.8750 (95.1042) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [5/16] time 0.345 (0.336) data 0.219 (0.214) loss_u loss_u 0.8979 (0.8954) acc_u 12.5000 (12.5000) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/16] time 0.347 (0.337) data 0.219 (0.215) loss_u loss_u 0.9414 (0.8840) acc_u 6.2500 (13.1250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/16] time 0.330 (0.337) data 0.204 (0.214) loss_u loss_u 0.8472 (0.8948) acc_u 18.7500 (12.0833) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 165
confident_label rate tensor(0.6826, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1114
clean true:1111
clean false:3
clean_rate:0.9973070017953322
noisy true:356
noisy false:162
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 518
epoch [195/200] batch [5/34] time 0.340 (0.341) data 0.214 (0.214) loss_x loss_x 0.3667 (0.1992) acc_x 93.7500 (97.5000) lr 6.0390e-06 eta 0:00:09
epoch [195/200] batch [10/34] time 0.337 (0.341) data 0.211 (0.215) loss_x loss_x 0.2781 (0.2101) acc_x 90.6250 (95.3125) lr 6.0390e-06 eta 0:00:08
epoch [195/200] batch [15/34] time 0.345 (0.341) data 0.218 (0.215) loss_x loss_x 0.3010 (0.2237) acc_x 93.7500 (95.0000) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [20/34] time 0.337 (0.339) data 0.208 (0.213) loss_x loss_x 0.2642 (0.2446) acc_x 96.8750 (95.1562) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [25/34] time 0.340 (0.340) data 0.212 (0.214) loss_x loss_x 0.2085 (0.2574) acc_x 93.7500 (94.8750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [30/34] time 0.339 (0.340) data 0.212 (0.213) loss_x loss_x 0.4060 (0.2584) acc_x 90.6250 (94.6875) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [5/16] time 0.342 (0.341) data 0.216 (0.214) loss_u loss_u 0.9385 (0.9121) acc_u 6.2500 (9.3750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/16] time 0.345 (0.340) data 0.216 (0.215) loss_u loss_u 0.8398 (0.9059) acc_u 15.6250 (10.0000) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/16] time 0.341 (0.340) data 0.215 (0.215) loss_u loss_u 0.9062 (0.9056) acc_u 9.3750 (10.2083) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 186
confident_label rate tensor(0.6765, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1104
clean true:1101
clean false:3
clean_rate:0.9972826086956522
noisy true:345
noisy false:183
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 528
epoch [196/200] batch [5/34] time 0.337 (0.344) data 0.212 (0.217) loss_x loss_x 0.2162 (0.2825) acc_x 93.7500 (93.7500) lr 4.4380e-06 eta 0:00:09
epoch [196/200] batch [10/34] time 0.344 (0.345) data 0.216 (0.218) loss_x loss_x 0.2864 (0.2730) acc_x 93.7500 (94.6875) lr 4.4380e-06 eta 0:00:08
epoch [196/200] batch [15/34] time 0.336 (0.341) data 0.213 (0.218) loss_x loss_x 0.4282 (0.2647) acc_x 87.5000 (94.5833) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [20/34] time 0.331 (0.339) data 0.206 (0.216) loss_x loss_x 0.2874 (0.2813) acc_x 90.6250 (94.0625) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [25/34] time 0.333 (0.340) data 0.208 (0.216) loss_x loss_x 0.2825 (0.2806) acc_x 93.7500 (94.1250) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [30/34] time 0.337 (0.340) data 0.212 (0.216) loss_x loss_x 0.4099 (0.2782) acc_x 93.7500 (94.5833) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [5/16] time 0.340 (0.339) data 0.215 (0.216) loss_u loss_u 0.8955 (0.9024) acc_u 12.5000 (10.6250) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/16] time 0.336 (0.339) data 0.208 (0.216) loss_u loss_u 0.8877 (0.8982) acc_u 12.5000 (11.5625) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/16] time 0.351 (0.341) data 0.225 (0.217) loss_u loss_u 0.8774 (0.8979) acc_u 15.6250 (12.0833) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 183
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1110
clean true:1106
clean false:4
clean_rate:0.9963963963963964
noisy true:343
noisy false:179
after delete: len(clean_dataset) 1110
after delete: len(noisy_dataset) 522
epoch [197/200] batch [5/34] time 0.332 (0.348) data 0.206 (0.222) loss_x loss_x 0.2856 (0.3095) acc_x 96.8750 (93.7500) lr 3.0827e-06 eta 0:00:10
epoch [197/200] batch [10/34] time 0.343 (0.342) data 0.217 (0.220) loss_x loss_x 0.2496 (0.2852) acc_x 93.7500 (94.3750) lr 3.0827e-06 eta 0:00:08
epoch [197/200] batch [15/34] time 0.341 (0.343) data 0.211 (0.219) loss_x loss_x 0.3845 (0.2944) acc_x 96.8750 (94.1667) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [20/34] time 0.352 (0.343) data 0.224 (0.218) loss_x loss_x 0.0956 (0.2802) acc_x 100.0000 (94.3750) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [25/34] time 0.342 (0.342) data 0.217 (0.217) loss_x loss_x 0.2247 (0.3123) acc_x 93.7500 (93.5000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [30/34] time 0.357 (0.343) data 0.226 (0.218) loss_x loss_x 0.2219 (0.2898) acc_x 96.8750 (93.9583) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [5/16] time 0.347 (0.343) data 0.219 (0.217) loss_u loss_u 0.8652 (0.8983) acc_u 15.6250 (12.5000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/16] time 0.351 (0.344) data 0.222 (0.218) loss_u loss_u 0.9404 (0.8978) acc_u 9.3750 (12.1875) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/16] time 0.344 (0.344) data 0.216 (0.218) loss_u loss_u 0.8813 (0.9017) acc_u 12.5000 (11.6667) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 190
confident_label rate tensor(0.6820, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1113
clean true:1108
clean false:5
clean_rate:0.995507637017071
noisy true:334
noisy false:185
after delete: len(clean_dataset) 1113
after delete: len(noisy_dataset) 519
epoch [198/200] batch [5/34] time 0.340 (0.342) data 0.211 (0.216) loss_x loss_x 0.2585 (0.3057) acc_x 96.8750 (94.3750) lr 1.9733e-06 eta 0:00:09
epoch [198/200] batch [10/34] time 0.333 (0.342) data 0.206 (0.216) loss_x loss_x 0.3137 (0.2506) acc_x 90.6250 (95.0000) lr 1.9733e-06 eta 0:00:08
epoch [198/200] batch [15/34] time 0.343 (0.342) data 0.217 (0.216) loss_x loss_x 0.5566 (0.2520) acc_x 84.3750 (94.7917) lr 1.9733e-06 eta 0:00:06
epoch [198/200] batch [20/34] time 0.340 (0.342) data 0.214 (0.216) loss_x loss_x 0.1755 (0.2400) acc_x 96.8750 (94.6875) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [25/34] time 0.329 (0.341) data 0.203 (0.215) loss_x loss_x 0.4995 (0.2514) acc_x 90.6250 (94.5000) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [30/34] time 0.333 (0.341) data 0.205 (0.215) loss_x loss_x 0.2362 (0.2507) acc_x 96.8750 (94.7917) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [5/16] time 0.307 (0.341) data 0.214 (0.215) loss_u loss_u 0.9170 (0.9187) acc_u 9.3750 (9.3750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/16] time 0.336 (0.340) data 0.210 (0.215) loss_u loss_u 0.9595 (0.9052) acc_u 3.1250 (11.2500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/16] time 0.344 (0.340) data 0.217 (0.215) loss_u loss_u 0.8672 (0.8984) acc_u 12.5000 (11.4583) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 196
confident_label rate tensor(0.6734, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1099
clean true:1096
clean false:3
clean_rate:0.997270245677889
noisy true:340
noisy false:193
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 533
epoch [199/200] batch [5/34] time 0.335 (0.343) data 0.209 (0.216) loss_x loss_x 0.2588 (0.3374) acc_x 93.7500 (91.2500) lr 1.1101e-06 eta 0:00:09
epoch [199/200] batch [10/34] time 0.344 (0.345) data 0.219 (0.219) loss_x loss_x 0.1353 (0.2741) acc_x 96.8750 (92.8125) lr 1.1101e-06 eta 0:00:08
epoch [199/200] batch [15/34] time 0.348 (0.345) data 0.219 (0.219) loss_x loss_x 0.1062 (0.2651) acc_x 100.0000 (93.5417) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [20/34] time 0.346 (0.345) data 0.219 (0.219) loss_x loss_x 0.1265 (0.2709) acc_x 100.0000 (93.4375) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [25/34] time 0.339 (0.344) data 0.214 (0.218) loss_x loss_x 0.3076 (0.2854) acc_x 93.7500 (93.2500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [30/34] time 0.358 (0.345) data 0.231 (0.218) loss_x loss_x 0.6245 (0.2878) acc_x 84.3750 (93.1250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [5/16] time 0.349 (0.346) data 0.220 (0.219) loss_u loss_u 0.9321 (0.9272) acc_u 6.2500 (8.1250) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/16] time 0.354 (0.346) data 0.224 (0.219) loss_u loss_u 0.8486 (0.8909) acc_u 18.7500 (12.5000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/16] time 0.351 (0.346) data 0.224 (0.219) loss_u loss_u 0.9282 (0.8976) acc_u 9.3750 (12.0833) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 189
confident_label rate tensor(0.6759, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 1103
clean true:1099
clean false:4
clean_rate:0.9963735267452403
noisy true:344
noisy false:185
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 529
epoch [200/200] batch [5/34] time 0.347 (0.345) data 0.221 (0.218) loss_x loss_x 0.1505 (0.2144) acc_x 100.0000 (97.5000) lr 4.9344e-07 eta 0:00:09
epoch [200/200] batch [10/34] time 0.331 (0.344) data 0.206 (0.218) loss_x loss_x 0.7319 (0.2933) acc_x 87.5000 (95.3125) lr 4.9344e-07 eta 0:00:08
epoch [200/200] batch [15/34] time 0.340 (0.343) data 0.216 (0.217) loss_x loss_x 0.3525 (0.2772) acc_x 93.7500 (95.8333) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [20/34] time 0.342 (0.343) data 0.215 (0.217) loss_x loss_x 0.1187 (0.3144) acc_x 100.0000 (94.6875) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [25/34] time 0.285 (0.340) data 0.208 (0.216) loss_x loss_x 0.2079 (0.3038) acc_x 96.8750 (94.7500) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [30/34] time 0.342 (0.341) data 0.216 (0.217) loss_x loss_x 0.1797 (0.2852) acc_x 96.8750 (95.1042) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [5/16] time 0.344 (0.342) data 0.218 (0.217) loss_u loss_u 0.9746 (0.8891) acc_u 3.1250 (12.5000) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/16] time 0.349 (0.344) data 0.224 (0.218) loss_u loss_u 0.9331 (0.8883) acc_u 9.3750 (12.8125) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/16] time 0.359 (0.344) data 0.232 (0.219) loss_u loss_u 0.8813 (0.8943) acc_u 12.5000 (12.0833) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.25/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,223
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 89.5%
Elapsed: 2:28:42
