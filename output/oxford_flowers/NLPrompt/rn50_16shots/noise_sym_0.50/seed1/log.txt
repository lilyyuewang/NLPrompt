***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/oxford_flowers.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '102']
output_dir: output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: OxfordFlowers
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 102
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: OxfordFlowers
Reading split from /home/convex/datasets/nlprompt/oxford_flowers/split_zhou_OxfordFlowers.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/oxford_flowers/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 51
Data loader size: 5
Data loader size: 25
---------  -------------
Dataset    OxfordFlowers
# classes  102
# train_x  1,632
# val      408
# test     2,463
---------  -------------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1257
confident_label rate tensor(0.1195, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 195
clean true:193
clean false:2
clean_rate:0.9897435897435898
noisy true:182
noisy false:1255
after delete: len(clean_dataset) 195
after delete: len(noisy_dataset) 1437
epoch [1/200] batch [5/6] time 0.428 (0.440) data 0.302 (0.290) loss_x loss_x 2.7773 (2.7711) acc_x 34.3750 (35.0000) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/44] time 0.376 (0.423) data 0.248 (0.289) loss_u loss_u 0.9688 (0.9762) acc_u 6.2500 (5.6250) lr 1.0000e-05 eta 0:00:16
epoch [1/200] batch [10/44] time 0.422 (0.416) data 0.295 (0.284) loss_u loss_u 0.9805 (0.9769) acc_u 6.2500 (4.6875) lr 1.0000e-05 eta 0:00:14
epoch [1/200] batch [15/44] time 0.387 (0.407) data 0.258 (0.276) loss_u loss_u 0.9858 (0.9781) acc_u 3.1250 (4.5833) lr 1.0000e-05 eta 0:00:11
epoch [1/200] batch [20/44] time 0.389 (0.404) data 0.260 (0.274) loss_u loss_u 0.9810 (0.9783) acc_u 3.1250 (4.5312) lr 1.0000e-05 eta 0:00:09
epoch [1/200] batch [25/44] time 0.399 (0.407) data 0.320 (0.278) loss_u loss_u 0.9580 (0.9778) acc_u 9.3750 (4.7500) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [30/44] time 0.336 (0.401) data 0.208 (0.272) loss_u loss_u 0.9790 (0.9783) acc_u 3.1250 (4.2708) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [35/44] time 0.427 (0.401) data 0.301 (0.272) loss_u loss_u 0.9590 (0.9777) acc_u 9.3750 (4.2857) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [40/44] time 0.345 (0.399) data 0.216 (0.270) loss_u loss_u 0.9551 (0.9767) acc_u 9.3750 (4.3750) lr 1.0000e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 1083
confident_label rate tensor(0.1562, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 255
clean true:252
clean false:3
clean_rate:0.9882352941176471
noisy true:297
noisy false:1080
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 1377
epoch [2/200] batch [5/7] time 0.387 (0.406) data 0.261 (0.280) loss_x loss_x 0.8315 (1.3312) acc_x 84.3750 (74.3750) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/43] time 0.423 (0.421) data 0.293 (0.291) loss_u loss_u 0.9209 (0.8814) acc_u 12.5000 (15.0000) lr 2.0000e-03 eta 0:00:16
epoch [2/200] batch [10/43] time 0.422 (0.422) data 0.295 (0.292) loss_u loss_u 0.7651 (0.8562) acc_u 34.3750 (18.4375) lr 2.0000e-03 eta 0:00:13
epoch [2/200] batch [15/43] time 0.450 (0.430) data 0.323 (0.301) loss_u loss_u 0.7886 (0.8604) acc_u 25.0000 (17.9167) lr 2.0000e-03 eta 0:00:12
epoch [2/200] batch [20/43] time 0.419 (0.430) data 0.291 (0.301) loss_u loss_u 0.8882 (0.8627) acc_u 21.8750 (18.7500) lr 2.0000e-03 eta 0:00:09
epoch [2/200] batch [25/43] time 0.462 (0.431) data 0.334 (0.303) loss_u loss_u 0.9248 (0.8639) acc_u 9.3750 (18.0000) lr 2.0000e-03 eta 0:00:07
epoch [2/200] batch [30/43] time 0.421 (0.429) data 0.294 (0.301) loss_u loss_u 0.9204 (0.8681) acc_u 9.3750 (17.1875) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [35/43] time 0.445 (0.433) data 0.316 (0.306) loss_u loss_u 0.8262 (0.8698) acc_u 21.8750 (16.9643) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [40/43] time 0.399 (0.432) data 0.272 (0.304) loss_u loss_u 0.8667 (0.8710) acc_u 15.6250 (17.1094) lr 2.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 732
confident_label rate tensor(0.2757, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 450
clean true:443
clean false:7
clean_rate:0.9844444444444445
noisy true:457
noisy false:725
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1182
epoch [3/200] batch [5/14] time 0.399 (0.417) data 0.273 (0.290) loss_x loss_x 0.7642 (0.9446) acc_x 87.5000 (79.3750) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [10/14] time 0.411 (0.421) data 0.284 (0.295) loss_x loss_x 1.1201 (0.9617) acc_x 75.0000 (77.8125) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [5/36] time 0.424 (0.418) data 0.297 (0.294) loss_u loss_u 0.9116 (0.9164) acc_u 9.3750 (11.2500) lr 1.9999e-03 eta 0:00:12
epoch [3/200] batch [10/36] time 0.397 (0.417) data 0.267 (0.292) loss_u loss_u 0.9380 (0.9327) acc_u 6.2500 (9.0625) lr 1.9999e-03 eta 0:00:10
epoch [3/200] batch [15/36] time 0.428 (0.418) data 0.304 (0.292) loss_u loss_u 0.9653 (0.9381) acc_u 3.1250 (7.9167) lr 1.9999e-03 eta 0:00:08
epoch [3/200] batch [20/36] time 0.449 (0.416) data 0.318 (0.289) loss_u loss_u 0.9248 (0.9383) acc_u 9.3750 (7.8125) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [25/36] time 0.381 (0.412) data 0.252 (0.287) loss_u loss_u 0.9351 (0.9380) acc_u 9.3750 (8.1250) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [30/36] time 0.399 (0.413) data 0.273 (0.287) loss_u loss_u 0.8853 (0.9343) acc_u 21.8750 (8.5417) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [35/36] time 0.467 (0.414) data 0.338 (0.288) loss_u loss_u 0.9414 (0.9339) acc_u 6.2500 (8.6607) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 708
confident_label rate tensor(0.2831, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 462
clean true:455
clean false:7
clean_rate:0.9848484848484849
noisy true:469
noisy false:701
after delete: len(clean_dataset) 462
after delete: len(noisy_dataset) 1170
epoch [4/200] batch [5/14] time 0.380 (0.393) data 0.252 (0.266) loss_x loss_x 0.8867 (0.8520) acc_x 68.7500 (75.0000) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/14] time 0.362 (0.387) data 0.284 (0.264) loss_x loss_x 0.7412 (0.7897) acc_x 81.2500 (78.7500) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [5/36] time 0.432 (0.407) data 0.307 (0.283) loss_u loss_u 0.8281 (0.9159) acc_u 25.0000 (11.2500) lr 1.9995e-03 eta 0:00:12
epoch [4/200] batch [10/36] time 0.386 (0.411) data 0.259 (0.286) loss_u loss_u 0.9678 (0.9352) acc_u 3.1250 (8.1250) lr 1.9995e-03 eta 0:00:10
epoch [4/200] batch [15/36] time 0.400 (0.412) data 0.272 (0.285) loss_u loss_u 0.9287 (0.9314) acc_u 9.3750 (8.7500) lr 1.9995e-03 eta 0:00:08
epoch [4/200] batch [20/36] time 0.420 (0.414) data 0.292 (0.287) loss_u loss_u 0.9570 (0.9343) acc_u 3.1250 (8.1250) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [25/36] time 0.408 (0.413) data 0.278 (0.287) loss_u loss_u 0.8447 (0.9293) acc_u 21.8750 (9.1250) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [30/36] time 0.415 (0.413) data 0.287 (0.287) loss_u loss_u 0.9546 (0.9336) acc_u 3.1250 (8.4375) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [35/36] time 0.427 (0.415) data 0.300 (0.289) loss_u loss_u 0.9248 (0.9347) acc_u 6.2500 (7.9464) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 723
confident_label rate tensor(0.2892, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 472
clean true:463
clean false:9
clean_rate:0.9809322033898306
noisy true:446
noisy false:714
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 1160
epoch [5/200] batch [5/14] time 0.419 (0.408) data 0.293 (0.292) loss_x loss_x 0.5986 (0.8352) acc_x 84.3750 (79.3750) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [10/14] time 0.398 (0.405) data 0.272 (0.283) loss_x loss_x 0.6377 (0.8324) acc_x 81.2500 (79.0625) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [5/36] time 0.415 (0.413) data 0.284 (0.289) loss_u loss_u 0.9551 (0.9385) acc_u 3.1250 (6.8750) lr 1.9989e-03 eta 0:00:12
epoch [5/200] batch [10/36] time 0.448 (0.414) data 0.321 (0.289) loss_u loss_u 0.9185 (0.9363) acc_u 6.2500 (7.1875) lr 1.9989e-03 eta 0:00:10
epoch [5/200] batch [15/36] time 0.356 (0.406) data 0.226 (0.280) loss_u loss_u 0.8481 (0.9305) acc_u 15.6250 (8.1250) lr 1.9989e-03 eta 0:00:08
epoch [5/200] batch [20/36] time 0.405 (0.405) data 0.276 (0.279) loss_u loss_u 0.9546 (0.9332) acc_u 6.2500 (7.8125) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [25/36] time 0.430 (0.405) data 0.299 (0.278) loss_u loss_u 0.9487 (0.9383) acc_u 6.2500 (7.3750) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [30/36] time 0.405 (0.406) data 0.277 (0.279) loss_u loss_u 0.9111 (0.9341) acc_u 9.3750 (7.8125) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [35/36] time 0.377 (0.407) data 0.298 (0.281) loss_u loss_u 0.8765 (0.9338) acc_u 15.6250 (7.7679) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 678
confident_label rate tensor(0.2990, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 488
clean true:484
clean false:4
clean_rate:0.9918032786885246
noisy true:470
noisy false:674
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1144
epoch [6/200] batch [5/15] time 0.416 (0.454) data 0.288 (0.326) loss_x loss_x 0.6938 (0.6950) acc_x 81.2500 (80.6250) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/15] time 0.310 (0.414) data 0.231 (0.291) loss_x loss_x 0.5161 (0.7342) acc_x 90.6250 (81.8750) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/15] time 0.412 (0.409) data 0.283 (0.283) loss_x loss_x 0.7725 (0.7590) acc_x 78.1250 (80.8333) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/35] time 0.423 (0.413) data 0.294 (0.286) loss_u loss_u 0.9141 (0.9419) acc_u 12.5000 (6.8750) lr 1.9980e-03 eta 0:00:12
epoch [6/200] batch [10/35] time 0.402 (0.412) data 0.269 (0.285) loss_u loss_u 0.9512 (0.9368) acc_u 3.1250 (7.8125) lr 1.9980e-03 eta 0:00:10
epoch [6/200] batch [15/35] time 0.412 (0.416) data 0.334 (0.290) loss_u loss_u 0.9482 (0.9354) acc_u 6.2500 (8.3333) lr 1.9980e-03 eta 0:00:08
epoch [6/200] batch [20/35] time 0.425 (0.417) data 0.299 (0.290) loss_u loss_u 0.9126 (0.9301) acc_u 12.5000 (8.9062) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [25/35] time 0.425 (0.418) data 0.299 (0.290) loss_u loss_u 0.9062 (0.9323) acc_u 12.5000 (8.5000) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [30/35] time 0.433 (0.419) data 0.304 (0.291) loss_u loss_u 0.9331 (0.9334) acc_u 6.2500 (8.1250) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [35/35] time 0.426 (0.420) data 0.347 (0.293) loss_u loss_u 0.9048 (0.9301) acc_u 9.3750 (8.8393) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 659
confident_label rate tensor(0.3058, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 499
clean true:489
clean false:10
clean_rate:0.9799599198396793
noisy true:484
noisy false:649
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1133
epoch [7/200] batch [5/15] time 0.403 (0.419) data 0.277 (0.292) loss_x loss_x 0.3674 (0.5203) acc_x 93.7500 (87.5000) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/15] time 0.407 (0.416) data 0.281 (0.290) loss_x loss_x 0.5850 (0.6488) acc_x 84.3750 (81.8750) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/15] time 0.390 (0.416) data 0.264 (0.292) loss_x loss_x 0.7275 (0.6709) acc_x 87.5000 (82.7083) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/35] time 0.403 (0.417) data 0.273 (0.292) loss_u loss_u 0.9600 (0.9334) acc_u 3.1250 (6.8750) lr 1.9969e-03 eta 0:00:12
epoch [7/200] batch [10/35] time 0.442 (0.415) data 0.315 (0.290) loss_u loss_u 0.9419 (0.9362) acc_u 6.2500 (7.5000) lr 1.9969e-03 eta 0:00:10
epoch [7/200] batch [15/35] time 0.432 (0.419) data 0.297 (0.292) loss_u loss_u 0.9292 (0.9242) acc_u 6.2500 (8.7500) lr 1.9969e-03 eta 0:00:08
epoch [7/200] batch [20/35] time 0.363 (0.412) data 0.236 (0.287) loss_u loss_u 0.9507 (0.9332) acc_u 6.2500 (7.6562) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [25/35] time 0.413 (0.414) data 0.282 (0.289) loss_u loss_u 0.9521 (0.9297) acc_u 3.1250 (8.2500) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [30/35] time 0.400 (0.413) data 0.271 (0.287) loss_u loss_u 0.9126 (0.9294) acc_u 9.3750 (8.2292) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [35/35] time 0.425 (0.415) data 0.297 (0.289) loss_u loss_u 0.9771 (0.9332) acc_u 3.1250 (7.7679) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 660
confident_label rate tensor(0.3033, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 495
clean true:491
clean false:4
clean_rate:0.9919191919191919
noisy true:481
noisy false:656
after delete: len(clean_dataset) 495
after delete: len(noisy_dataset) 1137
epoch [8/200] batch [5/15] time 0.403 (0.409) data 0.276 (0.293) loss_x loss_x 1.0498 (0.8090) acc_x 81.2500 (80.6250) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/15] time 0.436 (0.418) data 0.309 (0.296) loss_x loss_x 0.6772 (0.7729) acc_x 84.3750 (80.9375) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/15] time 0.363 (0.409) data 0.233 (0.284) loss_x loss_x 0.7593 (0.7144) acc_x 78.1250 (82.2917) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/35] time 0.397 (0.401) data 0.269 (0.275) loss_u loss_u 0.9668 (0.9202) acc_u 6.2500 (9.3750) lr 1.9956e-03 eta 0:00:12
epoch [8/200] batch [10/35] time 0.388 (0.402) data 0.258 (0.276) loss_u loss_u 0.8750 (0.9200) acc_u 15.6250 (9.3750) lr 1.9956e-03 eta 0:00:10
epoch [8/200] batch [15/35] time 0.439 (0.399) data 0.315 (0.274) loss_u loss_u 0.8945 (0.9298) acc_u 12.5000 (8.3333) lr 1.9956e-03 eta 0:00:07
epoch [8/200] batch [20/35] time 0.456 (0.402) data 0.328 (0.277) loss_u loss_u 0.9600 (0.9272) acc_u 3.1250 (8.7500) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [25/35] time 0.467 (0.406) data 0.340 (0.281) loss_u loss_u 0.9399 (0.9254) acc_u 6.2500 (8.8750) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [30/35] time 0.405 (0.407) data 0.326 (0.282) loss_u loss_u 0.9175 (0.9203) acc_u 6.2500 (9.3750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [35/35] time 0.416 (0.409) data 0.288 (0.284) loss_u loss_u 0.8687 (0.9213) acc_u 15.6250 (9.5536) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 610
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 522
clean true:515
clean false:7
clean_rate:0.9865900383141762
noisy true:507
noisy false:603
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1110
epoch [9/200] batch [5/16] time 0.433 (0.440) data 0.303 (0.311) loss_x loss_x 1.0420 (0.7368) acc_x 75.0000 (79.3750) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/16] time 0.411 (0.436) data 0.284 (0.308) loss_x loss_x 0.8374 (0.7780) acc_x 87.5000 (79.0625) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/16] time 0.401 (0.423) data 0.270 (0.295) loss_x loss_x 0.4968 (0.7430) acc_x 84.3750 (79.7917) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/34] time 0.412 (0.420) data 0.285 (0.293) loss_u loss_u 0.9810 (0.9318) acc_u 0.0000 (6.8750) lr 1.9940e-03 eta 0:00:12
epoch [9/200] batch [10/34] time 0.402 (0.419) data 0.273 (0.292) loss_u loss_u 0.9478 (0.9259) acc_u 6.2500 (8.1250) lr 1.9940e-03 eta 0:00:10
epoch [9/200] batch [15/34] time 0.429 (0.419) data 0.302 (0.292) loss_u loss_u 0.9316 (0.9282) acc_u 9.3750 (8.7500) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [20/34] time 0.410 (0.420) data 0.283 (0.292) loss_u loss_u 0.9204 (0.9301) acc_u 12.5000 (8.4375) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [25/34] time 0.352 (0.418) data 0.222 (0.290) loss_u loss_u 0.8716 (0.9292) acc_u 15.6250 (8.6250) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [30/34] time 0.367 (0.410) data 0.229 (0.283) loss_u loss_u 0.9453 (0.9278) acc_u 6.2500 (8.9583) lr 1.9940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 634
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 506
clean true:501
clean false:5
clean_rate:0.9901185770750988
noisy true:497
noisy false:629
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1126
epoch [10/200] batch [5/15] time 0.427 (0.419) data 0.300 (0.291) loss_x loss_x 0.3367 (0.5717) acc_x 96.8750 (90.0000) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/15] time 0.482 (0.428) data 0.354 (0.300) loss_x loss_x 1.0596 (0.6132) acc_x 71.8750 (87.5000) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/15] time 0.421 (0.432) data 0.294 (0.303) loss_x loss_x 0.4856 (0.6654) acc_x 87.5000 (86.0417) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/35] time 0.411 (0.427) data 0.333 (0.301) loss_u loss_u 0.9668 (0.9494) acc_u 3.1250 (6.2500) lr 1.9921e-03 eta 0:00:12
epoch [10/200] batch [10/35] time 0.413 (0.426) data 0.281 (0.298) loss_u loss_u 0.8599 (0.9339) acc_u 21.8750 (8.4375) lr 1.9921e-03 eta 0:00:10
epoch [10/200] batch [15/35] time 0.427 (0.422) data 0.295 (0.294) loss_u loss_u 0.8813 (0.9255) acc_u 18.7500 (9.5833) lr 1.9921e-03 eta 0:00:08
epoch [10/200] batch [20/35] time 0.404 (0.424) data 0.278 (0.296) loss_u loss_u 0.9302 (0.9295) acc_u 9.3750 (9.0625) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [25/35] time 0.438 (0.422) data 0.310 (0.295) loss_u loss_u 0.9429 (0.9326) acc_u 6.2500 (8.3750) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [30/35] time 0.393 (0.422) data 0.266 (0.296) loss_u loss_u 0.9121 (0.9315) acc_u 9.3750 (8.3333) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [35/35] time 0.459 (0.422) data 0.332 (0.295) loss_u loss_u 0.8950 (0.9294) acc_u 12.5000 (8.6607) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 615
confident_label rate tensor(0.3309, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 540
clean true:533
clean false:7
clean_rate:0.987037037037037
noisy true:484
noisy false:608
after delete: len(clean_dataset) 540
after delete: len(noisy_dataset) 1092
epoch [11/200] batch [5/16] time 0.324 (0.401) data 0.246 (0.285) loss_x loss_x 1.0195 (0.7918) acc_x 65.6250 (78.1250) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/16] time 0.414 (0.409) data 0.285 (0.283) loss_x loss_x 1.1367 (0.8168) acc_x 71.8750 (79.3750) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/16] time 0.400 (0.411) data 0.272 (0.284) loss_x loss_x 0.7378 (0.7914) acc_x 75.0000 (80.0000) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/34] time 0.460 (0.420) data 0.328 (0.293) loss_u loss_u 0.9619 (0.9418) acc_u 3.1250 (8.1250) lr 1.9900e-03 eta 0:00:12
epoch [11/200] batch [10/34] time 0.357 (0.415) data 0.229 (0.289) loss_u loss_u 0.8984 (0.9350) acc_u 15.6250 (9.0625) lr 1.9900e-03 eta 0:00:09
epoch [11/200] batch [15/34] time 0.428 (0.411) data 0.301 (0.285) loss_u loss_u 0.9561 (0.9270) acc_u 6.2500 (9.7917) lr 1.9900e-03 eta 0:00:07
epoch [11/200] batch [20/34] time 0.419 (0.413) data 0.294 (0.286) loss_u loss_u 0.9390 (0.9313) acc_u 9.3750 (8.9062) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [25/34] time 0.422 (0.416) data 0.291 (0.289) loss_u loss_u 0.9438 (0.9356) acc_u 9.3750 (8.5000) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [30/34] time 0.453 (0.416) data 0.323 (0.291) loss_u loss_u 0.9375 (0.9338) acc_u 6.2500 (8.7500) lr 1.9900e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 582
confident_label rate tensor(0.3358, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 548
clean true:546
clean false:2
clean_rate:0.9963503649635036
noisy true:504
noisy false:580
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1084
epoch [12/200] batch [5/17] time 0.411 (0.436) data 0.282 (0.298) loss_x loss_x 0.7861 (0.6225) acc_x 78.1250 (80.6250) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [10/17] time 0.406 (0.420) data 0.280 (0.288) loss_x loss_x 0.8472 (0.6313) acc_x 81.2500 (82.1875) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/17] time 0.424 (0.419) data 0.294 (0.288) loss_x loss_x 0.7314 (0.6330) acc_x 81.2500 (82.5000) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/33] time 0.397 (0.421) data 0.266 (0.291) loss_u loss_u 0.9238 (0.9319) acc_u 9.3750 (9.3750) lr 1.9877e-03 eta 0:00:11
epoch [12/200] batch [10/33] time 0.433 (0.419) data 0.304 (0.289) loss_u loss_u 0.9536 (0.9353) acc_u 9.3750 (8.7500) lr 1.9877e-03 eta 0:00:09
epoch [12/200] batch [15/33] time 0.358 (0.416) data 0.280 (0.287) loss_u loss_u 0.9614 (0.9364) acc_u 6.2500 (8.7500) lr 1.9877e-03 eta 0:00:07
epoch [12/200] batch [20/33] time 0.476 (0.419) data 0.347 (0.289) loss_u loss_u 0.9922 (0.9400) acc_u 0.0000 (8.1250) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [25/33] time 0.433 (0.420) data 0.304 (0.290) loss_u loss_u 0.9185 (0.9391) acc_u 9.3750 (8.3750) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [30/33] time 0.418 (0.422) data 0.289 (0.292) loss_u loss_u 0.9326 (0.9384) acc_u 9.3750 (8.4375) lr 1.9877e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 602
confident_label rate tensor(0.3321, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 542
clean true:534
clean false:8
clean_rate:0.985239852398524
noisy true:496
noisy false:594
after delete: len(clean_dataset) 542
after delete: len(noisy_dataset) 1090
epoch [13/200] batch [5/16] time 0.306 (0.406) data 0.227 (0.288) loss_x loss_x 1.0850 (0.8171) acc_x 81.2500 (82.5000) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/16] time 0.368 (0.380) data 0.242 (0.257) loss_x loss_x 0.6982 (0.7602) acc_x 81.2500 (83.7500) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/16] time 0.414 (0.391) data 0.283 (0.267) loss_x loss_x 0.3921 (0.6519) acc_x 93.7500 (86.8750) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/34] time 0.456 (0.401) data 0.325 (0.276) loss_u loss_u 0.9390 (0.9548) acc_u 6.2500 (5.6250) lr 1.9851e-03 eta 0:00:11
epoch [13/200] batch [10/34] time 0.421 (0.405) data 0.288 (0.278) loss_u loss_u 0.9121 (0.9412) acc_u 9.3750 (6.8750) lr 1.9851e-03 eta 0:00:09
epoch [13/200] batch [15/34] time 0.431 (0.403) data 0.304 (0.279) loss_u loss_u 0.9365 (0.9308) acc_u 9.3750 (8.3333) lr 1.9851e-03 eta 0:00:07
epoch [13/200] batch [20/34] time 0.388 (0.402) data 0.259 (0.278) loss_u loss_u 0.9282 (0.9348) acc_u 12.5000 (8.2812) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [25/34] time 0.406 (0.403) data 0.278 (0.278) loss_u loss_u 0.9185 (0.9369) acc_u 12.5000 (8.1250) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [30/34] time 0.465 (0.409) data 0.332 (0.284) loss_u loss_u 0.8960 (0.9363) acc_u 12.5000 (8.2292) lr 1.9851e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 617
confident_label rate tensor(0.3217, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 525
clean true:516
clean false:9
clean_rate:0.9828571428571429
noisy true:499
noisy false:608
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1107
epoch [14/200] batch [5/16] time 0.425 (0.413) data 0.301 (0.288) loss_x loss_x 0.6270 (0.5993) acc_x 90.6250 (88.7500) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/16] time 0.451 (0.431) data 0.324 (0.305) loss_x loss_x 0.3350 (0.5898) acc_x 93.7500 (87.5000) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/16] time 0.428 (0.430) data 0.300 (0.307) loss_x loss_x 0.7476 (0.5771) acc_x 78.1250 (87.0833) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/34] time 0.409 (0.424) data 0.280 (0.300) loss_u loss_u 0.9902 (0.9403) acc_u 3.1250 (8.1250) lr 1.9823e-03 eta 0:00:12
epoch [14/200] batch [10/34] time 0.424 (0.421) data 0.295 (0.296) loss_u loss_u 0.8081 (0.9196) acc_u 21.8750 (10.3125) lr 1.9823e-03 eta 0:00:10
epoch [14/200] batch [15/34] time 0.398 (0.421) data 0.268 (0.296) loss_u loss_u 0.9541 (0.9161) acc_u 6.2500 (10.2083) lr 1.9823e-03 eta 0:00:08
epoch [14/200] batch [20/34] time 0.417 (0.418) data 0.291 (0.294) loss_u loss_u 0.9023 (0.9208) acc_u 9.3750 (9.6875) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [25/34] time 0.365 (0.413) data 0.236 (0.288) loss_u loss_u 0.9502 (0.9174) acc_u 6.2500 (10.2500) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [30/34] time 0.409 (0.413) data 0.281 (0.288) loss_u loss_u 0.9082 (0.9201) acc_u 9.3750 (9.6875) lr 1.9823e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 549
confident_label rate tensor(0.3493, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 570
clean true:566
clean false:4
clean_rate:0.9929824561403509
noisy true:517
noisy false:545
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1062
epoch [15/200] batch [5/17] time 0.405 (0.407) data 0.274 (0.279) loss_x loss_x 0.6958 (0.6034) acc_x 87.5000 (85.6250) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [10/17] time 0.460 (0.414) data 0.338 (0.292) loss_x loss_x 0.6479 (0.6753) acc_x 84.3750 (83.4375) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/17] time 0.473 (0.419) data 0.347 (0.296) loss_x loss_x 0.7192 (0.6405) acc_x 90.6250 (84.3750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/33] time 0.426 (0.420) data 0.296 (0.297) loss_u loss_u 0.9829 (0.9435) acc_u 0.0000 (6.8750) lr 1.9792e-03 eta 0:00:11
epoch [15/200] batch [10/33] time 0.392 (0.410) data 0.266 (0.286) loss_u loss_u 0.8906 (0.9359) acc_u 15.6250 (8.4375) lr 1.9792e-03 eta 0:00:09
epoch [15/200] batch [15/33] time 0.410 (0.413) data 0.281 (0.288) loss_u loss_u 0.9238 (0.9374) acc_u 9.3750 (7.7083) lr 1.9792e-03 eta 0:00:07
epoch [15/200] batch [20/33] time 0.416 (0.414) data 0.287 (0.289) loss_u loss_u 0.8965 (0.9422) acc_u 12.5000 (7.1875) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [25/33] time 0.399 (0.416) data 0.320 (0.292) loss_u loss_u 0.9321 (0.9374) acc_u 9.3750 (7.5000) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [30/33] time 0.400 (0.418) data 0.275 (0.293) loss_u loss_u 0.9526 (0.9340) acc_u 3.1250 (7.8125) lr 1.9792e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 498
confident_label rate tensor(0.3701, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 604
clean true:596
clean false:8
clean_rate:0.9867549668874173
noisy true:538
noisy false:490
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1028
epoch [16/200] batch [5/18] time 0.456 (0.426) data 0.329 (0.298) loss_x loss_x 0.5137 (0.5813) acc_x 90.6250 (83.7500) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/18] time 0.430 (0.419) data 0.301 (0.292) loss_x loss_x 0.6069 (0.5248) acc_x 84.3750 (86.5625) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [15/18] time 0.433 (0.420) data 0.308 (0.293) loss_x loss_x 0.3513 (0.6121) acc_x 90.6250 (84.5833) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [5/32] time 0.444 (0.423) data 0.317 (0.299) loss_u loss_u 0.9336 (0.9124) acc_u 6.2500 (9.3750) lr 1.9759e-03 eta 0:00:11
epoch [16/200] batch [10/32] time 0.444 (0.427) data 0.317 (0.303) loss_u loss_u 0.9644 (0.9344) acc_u 6.2500 (8.1250) lr 1.9759e-03 eta 0:00:09
epoch [16/200] batch [15/32] time 0.403 (0.426) data 0.275 (0.302) loss_u loss_u 0.9702 (0.9438) acc_u 3.1250 (7.0833) lr 1.9759e-03 eta 0:00:07
epoch [16/200] batch [20/32] time 0.357 (0.422) data 0.232 (0.297) loss_u loss_u 0.9375 (0.9478) acc_u 9.3750 (6.7188) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [25/32] time 0.460 (0.421) data 0.331 (0.296) loss_u loss_u 0.9570 (0.9466) acc_u 9.3750 (7.2500) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [30/32] time 0.433 (0.423) data 0.305 (0.298) loss_u loss_u 0.9058 (0.9444) acc_u 12.5000 (7.2917) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 510
confident_label rate tensor(0.3560, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 581
clean true:576
clean false:5
clean_rate:0.9913941480206541
noisy true:546
noisy false:505
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1051
epoch [17/200] batch [5/18] time 0.449 (0.450) data 0.319 (0.321) loss_x loss_x 0.4177 (0.5689) acc_x 87.5000 (84.3750) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/18] time 0.455 (0.435) data 0.329 (0.310) loss_x loss_x 0.5845 (0.6064) acc_x 84.3750 (84.0625) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/18] time 0.401 (0.436) data 0.273 (0.311) loss_x loss_x 0.7231 (0.6329) acc_x 90.6250 (84.5833) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [5/32] time 0.395 (0.430) data 0.267 (0.304) loss_u loss_u 0.9321 (0.9297) acc_u 9.3750 (8.7500) lr 1.9724e-03 eta 0:00:11
epoch [17/200] batch [10/32] time 0.441 (0.430) data 0.313 (0.302) loss_u loss_u 0.9004 (0.9191) acc_u 12.5000 (10.3125) lr 1.9724e-03 eta 0:00:09
epoch [17/200] batch [15/32] time 0.384 (0.423) data 0.254 (0.295) loss_u loss_u 0.9800 (0.9251) acc_u 3.1250 (10.0000) lr 1.9724e-03 eta 0:00:07
epoch [17/200] batch [20/32] time 0.427 (0.422) data 0.300 (0.294) loss_u loss_u 0.9829 (0.9367) acc_u 3.1250 (8.7500) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [25/32] time 0.490 (0.427) data 0.367 (0.299) loss_u loss_u 0.9971 (0.9376) acc_u 0.0000 (8.2500) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [30/32] time 0.438 (0.430) data 0.309 (0.302) loss_u loss_u 0.9053 (0.9375) acc_u 15.6250 (8.2292) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 476
confident_label rate tensor(0.3683, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 601
clean true:597
clean false:4
clean_rate:0.9933444259567388
noisy true:559
noisy false:472
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1031
epoch [18/200] batch [5/18] time 0.477 (0.435) data 0.352 (0.317) loss_x loss_x 0.3015 (0.4617) acc_x 96.8750 (91.2500) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [10/18] time 0.478 (0.420) data 0.348 (0.297) loss_x loss_x 0.7139 (0.5927) acc_x 84.3750 (85.9375) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/18] time 0.417 (0.425) data 0.291 (0.301) loss_x loss_x 0.5127 (0.5920) acc_x 90.6250 (85.8333) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [5/32] time 0.388 (0.422) data 0.261 (0.297) loss_u loss_u 0.9419 (0.9557) acc_u 6.2500 (6.2500) lr 1.9686e-03 eta 0:00:11
epoch [18/200] batch [10/32] time 0.401 (0.419) data 0.270 (0.294) loss_u loss_u 0.9526 (0.9494) acc_u 6.2500 (6.5625) lr 1.9686e-03 eta 0:00:09
epoch [18/200] batch [15/32] time 0.429 (0.418) data 0.299 (0.292) loss_u loss_u 0.9053 (0.9432) acc_u 9.3750 (7.0833) lr 1.9686e-03 eta 0:00:07
epoch [18/200] batch [20/32] time 0.431 (0.417) data 0.304 (0.291) loss_u loss_u 0.9214 (0.9413) acc_u 12.5000 (7.1875) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [25/32] time 0.424 (0.419) data 0.271 (0.293) loss_u loss_u 0.9165 (0.9390) acc_u 12.5000 (7.6250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [30/32] time 0.445 (0.417) data 0.317 (0.291) loss_u loss_u 0.8984 (0.9364) acc_u 12.5000 (8.2292) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 507
confident_label rate tensor(0.3634, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 593
clean true:586
clean false:7
clean_rate:0.9881956155143339
noisy true:539
noisy false:500
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1039
epoch [19/200] batch [5/18] time 0.421 (0.434) data 0.294 (0.306) loss_x loss_x 0.5503 (0.5065) acc_x 90.6250 (90.0000) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/18] time 0.436 (0.425) data 0.310 (0.297) loss_x loss_x 0.3306 (0.5177) acc_x 93.7500 (87.8125) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/18] time 0.447 (0.427) data 0.320 (0.299) loss_x loss_x 0.6113 (0.4979) acc_x 87.5000 (88.9583) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [5/32] time 0.426 (0.432) data 0.296 (0.304) loss_u loss_u 0.9292 (0.9297) acc_u 6.2500 (8.1250) lr 1.9646e-03 eta 0:00:11
epoch [19/200] batch [10/32] time 0.387 (0.426) data 0.256 (0.297) loss_u loss_u 0.9170 (0.9258) acc_u 12.5000 (9.3750) lr 1.9646e-03 eta 0:00:09
epoch [19/200] batch [15/32] time 0.344 (0.412) data 0.217 (0.286) loss_u loss_u 0.9541 (0.9271) acc_u 6.2500 (9.5833) lr 1.9646e-03 eta 0:00:07
epoch [19/200] batch [20/32] time 0.411 (0.414) data 0.284 (0.288) loss_u loss_u 0.9443 (0.9326) acc_u 9.3750 (9.0625) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [25/32] time 0.356 (0.409) data 0.226 (0.283) loss_u loss_u 0.9336 (0.9301) acc_u 6.2500 (9.2500) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [30/32] time 0.438 (0.408) data 0.312 (0.282) loss_u loss_u 0.9448 (0.9325) acc_u 9.3750 (8.9583) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 462
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 611
clean true:605
clean false:6
clean_rate:0.9901800327332242
noisy true:565
noisy false:456
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1021
epoch [20/200] batch [5/19] time 0.423 (0.453) data 0.297 (0.326) loss_x loss_x 0.2332 (0.5064) acc_x 100.0000 (86.8750) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [10/19] time 0.420 (0.443) data 0.293 (0.316) loss_x loss_x 0.7026 (0.6442) acc_x 78.1250 (84.6875) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/19] time 0.350 (0.429) data 0.266 (0.306) loss_x loss_x 0.4487 (0.6245) acc_x 93.7500 (85.6250) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [5/31] time 0.362 (0.414) data 0.231 (0.289) loss_u loss_u 0.9893 (0.9380) acc_u 0.0000 (8.1250) lr 1.9603e-03 eta 0:00:10
epoch [20/200] batch [10/31] time 0.414 (0.411) data 0.284 (0.285) loss_u loss_u 0.9019 (0.9375) acc_u 9.3750 (7.5000) lr 1.9603e-03 eta 0:00:08
epoch [20/200] batch [15/31] time 0.470 (0.412) data 0.345 (0.286) loss_u loss_u 0.9492 (0.9409) acc_u 9.3750 (7.5000) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [20/31] time 0.416 (0.413) data 0.287 (0.288) loss_u loss_u 0.9243 (0.9384) acc_u 9.3750 (7.6562) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [25/31] time 0.451 (0.417) data 0.325 (0.292) loss_u loss_u 0.9458 (0.9387) acc_u 6.2500 (7.7500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [30/31] time 0.436 (0.418) data 0.307 (0.293) loss_u loss_u 0.9365 (0.9395) acc_u 9.3750 (7.7083) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 473
confident_label rate tensor(0.3646, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 595
clean true:590
clean false:5
clean_rate:0.9915966386554622
noisy true:569
noisy false:468
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1037
epoch [21/200] batch [5/18] time 0.426 (0.414) data 0.301 (0.287) loss_x loss_x 0.5088 (0.6024) acc_x 84.3750 (83.7500) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [10/18] time 0.410 (0.417) data 0.284 (0.295) loss_x loss_x 0.5435 (0.6716) acc_x 87.5000 (83.4375) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [15/18] time 0.404 (0.422) data 0.276 (0.299) loss_x loss_x 0.7705 (0.6244) acc_x 81.2500 (84.5833) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [5/32] time 0.426 (0.416) data 0.299 (0.291) loss_u loss_u 0.9629 (0.9206) acc_u 3.1250 (9.3750) lr 1.9558e-03 eta 0:00:11
epoch [21/200] batch [10/32] time 0.431 (0.419) data 0.304 (0.295) loss_u loss_u 0.8950 (0.9165) acc_u 12.5000 (10.0000) lr 1.9558e-03 eta 0:00:09
epoch [21/200] batch [15/32] time 0.432 (0.424) data 0.302 (0.300) loss_u loss_u 0.9414 (0.9226) acc_u 9.3750 (9.1667) lr 1.9558e-03 eta 0:00:07
epoch [21/200] batch [20/32] time 0.435 (0.425) data 0.306 (0.301) loss_u loss_u 0.9219 (0.9221) acc_u 9.3750 (9.3750) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [25/32] time 0.406 (0.424) data 0.280 (0.300) loss_u loss_u 0.9395 (0.9169) acc_u 9.3750 (10.5000) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [30/32] time 0.402 (0.419) data 0.274 (0.295) loss_u loss_u 0.9458 (0.9209) acc_u 9.3750 (10.0000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 451
confident_label rate tensor(0.3768, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 615
clean true:612
clean false:3
clean_rate:0.9951219512195122
noisy true:569
noisy false:448
after delete: len(clean_dataset) 615
after delete: len(noisy_dataset) 1017
epoch [22/200] batch [5/19] time 0.445 (0.431) data 0.318 (0.304) loss_x loss_x 0.4822 (0.5275) acc_x 87.5000 (87.5000) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [10/19] time 0.423 (0.428) data 0.295 (0.300) loss_x loss_x 0.7051 (0.5674) acc_x 75.0000 (85.6250) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/19] time 0.396 (0.424) data 0.271 (0.296) loss_x loss_x 0.5146 (0.5634) acc_x 87.5000 (86.2500) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [5/31] time 0.373 (0.406) data 0.247 (0.282) loss_u loss_u 0.9375 (0.9417) acc_u 6.2500 (6.2500) lr 1.9511e-03 eta 0:00:10
epoch [22/200] batch [10/31] time 0.434 (0.407) data 0.307 (0.282) loss_u loss_u 0.8979 (0.9374) acc_u 12.5000 (7.5000) lr 1.9511e-03 eta 0:00:08
epoch [22/200] batch [15/31] time 0.417 (0.413) data 0.291 (0.288) loss_u loss_u 0.8931 (0.9341) acc_u 12.5000 (8.3333) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [20/31] time 0.450 (0.417) data 0.322 (0.292) loss_u loss_u 0.9146 (0.9323) acc_u 12.5000 (8.4375) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [25/31] time 0.436 (0.417) data 0.306 (0.292) loss_u loss_u 0.9434 (0.9386) acc_u 6.2500 (7.7500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [30/31] time 0.420 (0.420) data 0.292 (0.295) loss_u loss_u 0.9111 (0.9398) acc_u 9.3750 (7.7083) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 452
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 608
clean true:599
clean false:9
clean_rate:0.9851973684210527
noisy true:581
noisy false:443
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1024
epoch [23/200] batch [5/19] time 0.355 (0.404) data 0.228 (0.278) loss_x loss_x 0.3542 (0.5697) acc_x 90.6250 (86.8750) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [10/19] time 0.367 (0.394) data 0.242 (0.267) loss_x loss_x 0.6450 (0.5648) acc_x 84.3750 (85.0000) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/19] time 0.376 (0.398) data 0.298 (0.275) loss_x loss_x 0.5454 (0.5785) acc_x 84.3750 (84.3750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [5/32] time 0.424 (0.402) data 0.294 (0.277) loss_u loss_u 0.8916 (0.9365) acc_u 12.5000 (7.5000) lr 1.9461e-03 eta 0:00:10
epoch [23/200] batch [10/32] time 0.439 (0.410) data 0.310 (0.285) loss_u loss_u 0.9614 (0.9436) acc_u 3.1250 (6.5625) lr 1.9461e-03 eta 0:00:09
epoch [23/200] batch [15/32] time 0.440 (0.412) data 0.314 (0.288) loss_u loss_u 0.9370 (0.9390) acc_u 6.2500 (7.2917) lr 1.9461e-03 eta 0:00:07
epoch [23/200] batch [20/32] time 0.491 (0.417) data 0.361 (0.292) loss_u loss_u 0.9429 (0.9364) acc_u 6.2500 (7.6562) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [25/32] time 0.415 (0.420) data 0.287 (0.294) loss_u loss_u 0.9150 (0.9327) acc_u 9.3750 (8.1250) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [30/32] time 0.439 (0.424) data 0.308 (0.298) loss_u loss_u 0.9053 (0.9341) acc_u 12.5000 (8.0208) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 481
confident_label rate tensor(0.3732, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 609
clean true:601
clean false:8
clean_rate:0.986863711001642
noisy true:550
noisy false:473
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1023
epoch [24/200] batch [5/19] time 0.440 (0.427) data 0.310 (0.299) loss_x loss_x 0.3689 (0.3928) acc_x 96.8750 (90.6250) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/19] time 0.425 (0.429) data 0.301 (0.301) loss_x loss_x 0.5947 (0.4815) acc_x 87.5000 (89.0625) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/19] time 0.444 (0.422) data 0.317 (0.294) loss_x loss_x 0.4141 (0.5052) acc_x 90.6250 (88.3333) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [5/31] time 0.437 (0.422) data 0.308 (0.297) loss_u loss_u 0.9014 (0.9527) acc_u 15.6250 (6.8750) lr 1.9409e-03 eta 0:00:10
epoch [24/200] batch [10/31] time 0.450 (0.424) data 0.320 (0.299) loss_u loss_u 0.8721 (0.9187) acc_u 15.6250 (10.9375) lr 1.9409e-03 eta 0:00:08
epoch [24/200] batch [15/31] time 0.412 (0.423) data 0.285 (0.298) loss_u loss_u 0.8892 (0.9127) acc_u 15.6250 (11.6667) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [20/31] time 0.408 (0.421) data 0.284 (0.297) loss_u loss_u 0.9634 (0.9232) acc_u 6.2500 (10.3125) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [25/31] time 0.480 (0.425) data 0.352 (0.300) loss_u loss_u 0.9355 (0.9264) acc_u 6.2500 (10.0000) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [30/31] time 0.439 (0.425) data 0.312 (0.300) loss_u loss_u 0.9688 (0.9298) acc_u 6.2500 (9.5833) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 465
confident_label rate tensor(0.3701, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 604
clean true:599
clean false:5
clean_rate:0.9917218543046358
noisy true:568
noisy false:460
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1028
epoch [25/200] batch [5/18] time 0.401 (0.433) data 0.274 (0.307) loss_x loss_x 0.6997 (0.6506) acc_x 87.5000 (80.6250) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [10/18] time 0.413 (0.414) data 0.287 (0.288) loss_x loss_x 0.5952 (0.5571) acc_x 84.3750 (85.0000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/18] time 0.364 (0.409) data 0.235 (0.281) loss_x loss_x 0.3250 (0.5118) acc_x 93.7500 (86.8750) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [5/32] time 0.419 (0.408) data 0.291 (0.281) loss_u loss_u 0.9072 (0.9023) acc_u 9.3750 (12.5000) lr 1.9354e-03 eta 0:00:11
epoch [25/200] batch [10/32] time 0.415 (0.411) data 0.287 (0.285) loss_u loss_u 0.9707 (0.9176) acc_u 3.1250 (10.0000) lr 1.9354e-03 eta 0:00:09
epoch [25/200] batch [15/32] time 0.444 (0.415) data 0.314 (0.289) loss_u loss_u 0.9375 (0.9259) acc_u 6.2500 (8.9583) lr 1.9354e-03 eta 0:00:07
epoch [25/200] batch [20/32] time 0.470 (0.418) data 0.339 (0.291) loss_u loss_u 0.9102 (0.9228) acc_u 9.3750 (9.3750) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [25/32] time 0.432 (0.422) data 0.305 (0.295) loss_u loss_u 0.9180 (0.9244) acc_u 9.3750 (9.1250) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [30/32] time 0.459 (0.423) data 0.330 (0.297) loss_u loss_u 0.8691 (0.9178) acc_u 15.6250 (9.8958) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 438
confident_label rate tensor(0.3854, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 629
clean true:620
clean false:9
clean_rate:0.985691573926868
noisy true:574
noisy false:429
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 1003
epoch [26/200] batch [5/19] time 0.399 (0.430) data 0.271 (0.303) loss_x loss_x 0.4768 (0.3927) acc_x 90.6250 (90.0000) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [10/19] time 0.426 (0.419) data 0.302 (0.292) loss_x loss_x 0.3462 (0.3991) acc_x 90.6250 (90.3125) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/19] time 0.439 (0.417) data 0.313 (0.294) loss_x loss_x 0.6768 (0.4629) acc_x 87.5000 (89.3750) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [5/31] time 0.433 (0.428) data 0.306 (0.303) loss_u loss_u 0.9541 (0.9476) acc_u 9.3750 (6.2500) lr 1.9298e-03 eta 0:00:11
epoch [26/200] batch [10/31] time 0.411 (0.429) data 0.283 (0.303) loss_u loss_u 0.9399 (0.9469) acc_u 9.3750 (6.2500) lr 1.9298e-03 eta 0:00:09
epoch [26/200] batch [15/31] time 0.467 (0.429) data 0.336 (0.304) loss_u loss_u 0.9746 (0.9423) acc_u 3.1250 (7.0833) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [20/31] time 0.428 (0.432) data 0.296 (0.306) loss_u loss_u 0.9136 (0.9328) acc_u 12.5000 (8.2812) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [25/31] time 0.387 (0.429) data 0.260 (0.303) loss_u loss_u 0.9697 (0.9329) acc_u 3.1250 (8.1250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [30/31] time 0.438 (0.428) data 0.309 (0.302) loss_u loss_u 0.9673 (0.9369) acc_u 3.1250 (7.8125) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 437
confident_label rate tensor(0.3934, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 642
clean true:633
clean false:9
clean_rate:0.985981308411215
noisy true:562
noisy false:428
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 990
epoch [27/200] batch [5/20] time 0.395 (0.405) data 0.270 (0.278) loss_x loss_x 0.7886 (0.5692) acc_x 84.3750 (87.5000) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [10/20] time 0.436 (0.413) data 0.311 (0.286) loss_x loss_x 0.6123 (0.5546) acc_x 78.1250 (85.6250) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/20] time 0.415 (0.418) data 0.338 (0.294) loss_x loss_x 0.2754 (0.5579) acc_x 93.7500 (86.0417) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/20] time 0.401 (0.415) data 0.276 (0.290) loss_x loss_x 0.7563 (0.5729) acc_x 81.2500 (85.7812) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/30] time 0.417 (0.421) data 0.290 (0.296) loss_u loss_u 0.8672 (0.9145) acc_u 15.6250 (11.2500) lr 1.9239e-03 eta 0:00:10
epoch [27/200] batch [10/30] time 0.371 (0.417) data 0.265 (0.293) loss_u loss_u 0.9209 (0.9281) acc_u 12.5000 (9.0625) lr 1.9239e-03 eta 0:00:08
epoch [27/200] batch [15/30] time 0.438 (0.418) data 0.310 (0.292) loss_u loss_u 0.9893 (0.9381) acc_u 3.1250 (8.3333) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [20/30] time 0.481 (0.420) data 0.354 (0.295) loss_u loss_u 0.8926 (0.9389) acc_u 15.6250 (8.1250) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [25/30] time 0.417 (0.423) data 0.288 (0.296) loss_u loss_u 0.9990 (0.9434) acc_u 0.0000 (7.3750) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [30/30] time 0.400 (0.425) data 0.271 (0.298) loss_u loss_u 0.9019 (0.9449) acc_u 12.5000 (7.0833) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 447
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 625
clean true:617
clean false:8
clean_rate:0.9872
noisy true:568
noisy false:439
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 1007
epoch [28/200] batch [5/19] time 0.398 (0.428) data 0.271 (0.301) loss_x loss_x 0.4409 (0.4933) acc_x 93.7500 (88.7500) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/19] time 0.433 (0.411) data 0.309 (0.284) loss_x loss_x 0.3652 (0.4959) acc_x 90.6250 (88.4375) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/19] time 0.452 (0.416) data 0.325 (0.289) loss_x loss_x 0.3560 (0.4849) acc_x 90.6250 (88.3333) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [5/31] time 0.423 (0.423) data 0.294 (0.295) loss_u loss_u 0.9951 (0.9414) acc_u 0.0000 (7.5000) lr 1.9178e-03 eta 0:00:10
epoch [28/200] batch [10/31] time 0.476 (0.428) data 0.347 (0.300) loss_u loss_u 0.9424 (0.9482) acc_u 9.3750 (6.5625) lr 1.9178e-03 eta 0:00:08
epoch [28/200] batch [15/31] time 0.431 (0.427) data 0.301 (0.299) loss_u loss_u 0.9131 (0.9423) acc_u 9.3750 (6.8750) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [20/31] time 0.421 (0.427) data 0.294 (0.301) loss_u loss_u 0.9409 (0.9415) acc_u 6.2500 (6.8750) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [25/31] time 0.360 (0.422) data 0.233 (0.295) loss_u loss_u 0.9561 (0.9456) acc_u 6.2500 (6.3750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [30/31] time 0.340 (0.417) data 0.215 (0.289) loss_u loss_u 0.8955 (0.9384) acc_u 9.3750 (7.3958) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 431
confident_label rate tensor(0.3928, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 641
clean true:633
clean false:8
clean_rate:0.9875195007800313
noisy true:568
noisy false:423
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 991
epoch [29/200] batch [5/20] time 0.430 (0.428) data 0.302 (0.299) loss_x loss_x 0.5049 (0.4504) acc_x 87.5000 (88.7500) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [10/20] time 0.423 (0.422) data 0.296 (0.294) loss_x loss_x 0.5532 (0.4744) acc_x 84.3750 (87.8125) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [15/20] time 0.407 (0.426) data 0.279 (0.298) loss_x loss_x 0.5752 (0.5125) acc_x 81.2500 (86.0417) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/20] time 0.441 (0.419) data 0.313 (0.296) loss_x loss_x 0.7217 (0.5152) acc_x 84.3750 (86.4062) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/30] time 0.364 (0.420) data 0.234 (0.296) loss_u loss_u 0.9712 (0.9158) acc_u 3.1250 (11.2500) lr 1.9114e-03 eta 0:00:10
epoch [29/200] batch [10/30] time 0.372 (0.411) data 0.243 (0.286) loss_u loss_u 0.9097 (0.9289) acc_u 12.5000 (9.3750) lr 1.9114e-03 eta 0:00:08
epoch [29/200] batch [15/30] time 0.409 (0.413) data 0.281 (0.287) loss_u loss_u 0.9175 (0.9262) acc_u 12.5000 (9.5833) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [20/30] time 0.396 (0.415) data 0.316 (0.290) loss_u loss_u 0.9155 (0.9280) acc_u 9.3750 (8.9062) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [25/30] time 0.415 (0.416) data 0.285 (0.290) loss_u loss_u 0.9092 (0.9298) acc_u 9.3750 (8.5000) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [30/30] time 0.404 (0.415) data 0.276 (0.289) loss_u loss_u 0.9595 (0.9326) acc_u 6.2500 (8.2292) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 430
confident_label rate tensor(0.3891, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 635
clean true:627
clean false:8
clean_rate:0.9874015748031496
noisy true:575
noisy false:422
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 997
epoch [30/200] batch [5/19] time 0.391 (0.402) data 0.265 (0.275) loss_x loss_x 1.7090 (0.8750) acc_x 75.0000 (84.3750) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/19] time 0.415 (0.410) data 0.288 (0.282) loss_x loss_x 0.6069 (0.6767) acc_x 81.2500 (86.8750) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/19] time 0.421 (0.409) data 0.294 (0.282) loss_x loss_x 0.4863 (0.6271) acc_x 84.3750 (86.8750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [5/31] time 0.403 (0.397) data 0.276 (0.270) loss_u loss_u 0.9263 (0.9330) acc_u 9.3750 (6.8750) lr 1.9048e-03 eta 0:00:10
epoch [30/200] batch [10/31] time 0.411 (0.399) data 0.281 (0.272) loss_u loss_u 0.9141 (0.9361) acc_u 12.5000 (7.1875) lr 1.9048e-03 eta 0:00:08
epoch [30/200] batch [15/31] time 0.395 (0.403) data 0.269 (0.276) loss_u loss_u 0.8921 (0.9253) acc_u 9.3750 (8.5417) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [20/31] time 0.445 (0.407) data 0.316 (0.281) loss_u loss_u 0.9717 (0.9360) acc_u 3.1250 (7.5000) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [25/31] time 0.431 (0.409) data 0.306 (0.283) loss_u loss_u 0.9546 (0.9310) acc_u 6.2500 (8.2500) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [30/31] time 0.401 (0.412) data 0.320 (0.287) loss_u loss_u 0.9688 (0.9295) acc_u 3.1250 (8.4375) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 400
confident_label rate tensor(0.3983, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 650
clean true:644
clean false:6
clean_rate:0.9907692307692307
noisy true:588
noisy false:394
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 982
epoch [31/200] batch [5/20] time 0.392 (0.409) data 0.267 (0.283) loss_x loss_x 0.6553 (0.5811) acc_x 87.5000 (86.8750) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [10/20] time 0.443 (0.409) data 0.317 (0.283) loss_x loss_x 0.3743 (0.5566) acc_x 96.8750 (87.8125) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [15/20] time 0.416 (0.416) data 0.290 (0.292) loss_x loss_x 0.5151 (0.5003) acc_x 84.3750 (88.9583) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/20] time 0.415 (0.422) data 0.290 (0.297) loss_x loss_x 0.4377 (0.4886) acc_x 90.6250 (89.0625) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/30] time 0.433 (0.422) data 0.305 (0.297) loss_u loss_u 0.9590 (0.9607) acc_u 6.2500 (5.0000) lr 1.8980e-03 eta 0:00:10
epoch [31/200] batch [10/30] time 0.446 (0.421) data 0.320 (0.295) loss_u loss_u 0.9131 (0.9463) acc_u 9.3750 (6.5625) lr 1.8980e-03 eta 0:00:08
epoch [31/200] batch [15/30] time 0.422 (0.425) data 0.293 (0.299) loss_u loss_u 0.9072 (0.9426) acc_u 9.3750 (6.8750) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [20/30] time 0.404 (0.424) data 0.275 (0.298) loss_u loss_u 0.9546 (0.9394) acc_u 6.2500 (7.5000) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [25/30] time 0.470 (0.422) data 0.343 (0.296) loss_u loss_u 0.9526 (0.9425) acc_u 3.1250 (6.8750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [30/30] time 0.396 (0.423) data 0.269 (0.297) loss_u loss_u 0.9341 (0.9435) acc_u 6.2500 (6.7708) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 422
confident_label rate tensor(0.3940, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 643
clean true:632
clean false:11
clean_rate:0.9828926905132193
noisy true:578
noisy false:411
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 989
epoch [32/200] batch [5/20] time 0.459 (0.414) data 0.332 (0.288) loss_x loss_x 0.5801 (0.4932) acc_x 90.6250 (88.1250) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [10/20] time 0.483 (0.411) data 0.353 (0.293) loss_x loss_x 0.7729 (0.4859) acc_x 81.2500 (88.7500) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/20] time 0.439 (0.417) data 0.313 (0.296) loss_x loss_x 0.4685 (0.4757) acc_x 87.5000 (88.5417) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/20] time 0.443 (0.419) data 0.318 (0.297) loss_x loss_x 0.5396 (0.4419) acc_x 84.3750 (89.5312) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/30] time 0.437 (0.425) data 0.307 (0.302) loss_u loss_u 0.9150 (0.9263) acc_u 12.5000 (9.3750) lr 1.8910e-03 eta 0:00:10
epoch [32/200] batch [10/30] time 0.445 (0.427) data 0.317 (0.304) loss_u loss_u 0.9648 (0.9303) acc_u 3.1250 (8.7500) lr 1.8910e-03 eta 0:00:08
epoch [32/200] batch [15/30] time 0.406 (0.423) data 0.277 (0.299) loss_u loss_u 0.9155 (0.9320) acc_u 12.5000 (8.3333) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [20/30] time 0.442 (0.424) data 0.312 (0.300) loss_u loss_u 0.9482 (0.9322) acc_u 6.2500 (8.5938) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [25/30] time 0.452 (0.427) data 0.324 (0.302) loss_u loss_u 0.9321 (0.9293) acc_u 6.2500 (8.6250) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [30/30] time 0.434 (0.425) data 0.263 (0.299) loss_u loss_u 0.9731 (0.9291) acc_u 3.1250 (8.6458) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 411
confident_label rate tensor(0.3915, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 639
clean true:632
clean false:7
clean_rate:0.9890453834115805
noisy true:589
noisy false:404
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 993
epoch [33/200] batch [5/19] time 0.434 (0.414) data 0.308 (0.288) loss_x loss_x 0.3308 (0.3308) acc_x 93.7500 (92.5000) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/19] time 0.393 (0.415) data 0.266 (0.288) loss_x loss_x 0.5361 (0.3641) acc_x 87.5000 (91.5625) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/19] time 0.422 (0.413) data 0.297 (0.287) loss_x loss_x 0.5581 (0.3971) acc_x 81.2500 (90.0000) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [5/31] time 0.437 (0.417) data 0.310 (0.292) loss_u loss_u 0.9438 (0.9382) acc_u 9.3750 (7.5000) lr 1.8838e-03 eta 0:00:10
epoch [33/200] batch [10/31] time 0.441 (0.420) data 0.314 (0.294) loss_u loss_u 0.9668 (0.9428) acc_u 3.1250 (6.8750) lr 1.8838e-03 eta 0:00:08
epoch [33/200] batch [15/31] time 0.413 (0.422) data 0.284 (0.295) loss_u loss_u 0.8491 (0.9330) acc_u 18.7500 (7.9167) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [20/31] time 0.446 (0.420) data 0.319 (0.293) loss_u loss_u 0.9912 (0.9368) acc_u 0.0000 (7.5000) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [25/31] time 0.401 (0.422) data 0.275 (0.295) loss_u loss_u 0.9268 (0.9340) acc_u 9.3750 (8.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [30/31] time 0.396 (0.419) data 0.270 (0.292) loss_u loss_u 0.9795 (0.9338) acc_u 3.1250 (8.0208) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 395
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 662
clean true:656
clean false:6
clean_rate:0.9909365558912386
noisy true:581
noisy false:389
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 970
epoch [34/200] batch [5/20] time 0.434 (0.416) data 0.308 (0.289) loss_x loss_x 0.2559 (0.4574) acc_x 96.8750 (91.2500) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [10/20] time 0.433 (0.417) data 0.305 (0.290) loss_x loss_x 0.2593 (0.4250) acc_x 93.7500 (91.2500) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/20] time 0.402 (0.415) data 0.273 (0.288) loss_x loss_x 0.4551 (0.4302) acc_x 93.7500 (91.6667) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/20] time 0.359 (0.409) data 0.234 (0.282) loss_x loss_x 0.6265 (0.4210) acc_x 87.5000 (91.7188) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/30] time 0.419 (0.409) data 0.293 (0.283) loss_u loss_u 0.9673 (0.9442) acc_u 3.1250 (6.2500) lr 1.8763e-03 eta 0:00:10
epoch [34/200] batch [10/30] time 0.419 (0.411) data 0.291 (0.286) loss_u loss_u 0.9282 (0.9430) acc_u 9.3750 (7.1875) lr 1.8763e-03 eta 0:00:08
epoch [34/200] batch [15/30] time 0.434 (0.416) data 0.307 (0.290) loss_u loss_u 0.9229 (0.9364) acc_u 12.5000 (8.3333) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [20/30] time 0.460 (0.419) data 0.334 (0.292) loss_u loss_u 0.9761 (0.9456) acc_u 0.0000 (6.7188) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [25/30] time 0.397 (0.419) data 0.269 (0.292) loss_u loss_u 0.9443 (0.9472) acc_u 6.2500 (6.5000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [30/30] time 0.408 (0.417) data 0.281 (0.290) loss_u loss_u 0.9121 (0.9451) acc_u 9.3750 (6.7708) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 382
confident_label rate tensor(0.4032, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 658
clean true:651
clean false:7
clean_rate:0.9893617021276596
noisy true:599
noisy false:375
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 974
epoch [35/200] batch [5/20] time 0.486 (0.425) data 0.354 (0.305) loss_x loss_x 0.1354 (0.3814) acc_x 100.0000 (93.1250) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [10/20] time 0.460 (0.436) data 0.333 (0.312) loss_x loss_x 0.4614 (0.3712) acc_x 87.5000 (92.5000) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/20] time 0.457 (0.435) data 0.324 (0.310) loss_x loss_x 0.3508 (0.3910) acc_x 90.6250 (90.8333) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/20] time 0.417 (0.435) data 0.291 (0.310) loss_x loss_x 0.6309 (0.4220) acc_x 78.1250 (89.2188) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/30] time 0.473 (0.438) data 0.302 (0.312) loss_u loss_u 0.9443 (0.9619) acc_u 6.2500 (3.7500) lr 1.8686e-03 eta 0:00:10
epoch [35/200] batch [10/30] time 0.403 (0.432) data 0.275 (0.306) loss_u loss_u 0.9199 (0.9608) acc_u 9.3750 (4.6875) lr 1.8686e-03 eta 0:00:08
epoch [35/200] batch [15/30] time 0.416 (0.433) data 0.288 (0.306) loss_u loss_u 0.9307 (0.9559) acc_u 9.3750 (5.2083) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [20/30] time 0.456 (0.432) data 0.329 (0.305) loss_u loss_u 0.8525 (0.9487) acc_u 18.7500 (6.0938) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [25/30] time 0.369 (0.425) data 0.240 (0.298) loss_u loss_u 0.9438 (0.9418) acc_u 6.2500 (6.6250) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [30/30] time 0.377 (0.421) data 0.256 (0.294) loss_u loss_u 0.9536 (0.9406) acc_u 6.2500 (6.7708) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 413
confident_label rate tensor(0.4013, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 655
clean true:646
clean false:9
clean_rate:0.9862595419847329
noisy true:573
noisy false:404
after delete: len(clean_dataset) 655
after delete: len(noisy_dataset) 977
epoch [36/200] batch [5/20] time 0.417 (0.437) data 0.291 (0.309) loss_x loss_x 0.4036 (0.4348) acc_x 90.6250 (88.1250) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [10/20] time 0.402 (0.430) data 0.275 (0.302) loss_x loss_x 0.2620 (0.4122) acc_x 93.7500 (89.3750) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/20] time 0.410 (0.423) data 0.281 (0.296) loss_x loss_x 0.5049 (0.3965) acc_x 87.5000 (90.4167) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/20] time 0.417 (0.422) data 0.291 (0.298) loss_x loss_x 0.4080 (0.4107) acc_x 87.5000 (90.0000) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/30] time 0.390 (0.422) data 0.261 (0.297) loss_u loss_u 0.9741 (0.9416) acc_u 3.1250 (7.5000) lr 1.8607e-03 eta 0:00:10
epoch [36/200] batch [10/30] time 0.413 (0.414) data 0.285 (0.290) loss_u loss_u 0.9341 (0.9421) acc_u 9.3750 (7.5000) lr 1.8607e-03 eta 0:00:08
epoch [36/200] batch [15/30] time 0.408 (0.414) data 0.281 (0.289) loss_u loss_u 0.8848 (0.9382) acc_u 12.5000 (7.5000) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [20/30] time 0.414 (0.416) data 0.288 (0.290) loss_u loss_u 0.8740 (0.9333) acc_u 15.6250 (8.2812) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [25/30] time 0.391 (0.415) data 0.261 (0.290) loss_u loss_u 0.9834 (0.9364) acc_u 3.1250 (8.0000) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [30/30] time 0.398 (0.409) data 0.268 (0.284) loss_u loss_u 0.9678 (0.9383) acc_u 3.1250 (7.7083) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 378
confident_label rate tensor(0.3995, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 652
clean true:644
clean false:8
clean_rate:0.9877300613496932
noisy true:610
noisy false:370
after delete: len(clean_dataset) 652
after delete: len(noisy_dataset) 980
epoch [37/200] batch [5/20] time 0.397 (0.431) data 0.271 (0.304) loss_x loss_x 0.2495 (0.3131) acc_x 96.8750 (92.5000) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [10/20] time 0.377 (0.401) data 0.250 (0.274) loss_x loss_x 0.2793 (0.3756) acc_x 90.6250 (91.2500) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/20] time 0.472 (0.411) data 0.344 (0.283) loss_x loss_x 0.2155 (0.4141) acc_x 100.0000 (91.6667) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/20] time 0.430 (0.416) data 0.302 (0.288) loss_x loss_x 0.6064 (0.4029) acc_x 90.6250 (92.0312) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/30] time 0.438 (0.415) data 0.309 (0.290) loss_u loss_u 0.9072 (0.9245) acc_u 12.5000 (8.7500) lr 1.8526e-03 eta 0:00:10
epoch [37/200] batch [10/30] time 0.420 (0.416) data 0.294 (0.290) loss_u loss_u 0.9478 (0.9265) acc_u 6.2500 (8.7500) lr 1.8526e-03 eta 0:00:08
epoch [37/200] batch [15/30] time 0.419 (0.419) data 0.291 (0.293) loss_u loss_u 0.9697 (0.9385) acc_u 3.1250 (7.2917) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [20/30] time 0.375 (0.421) data 0.297 (0.296) loss_u loss_u 0.9482 (0.9332) acc_u 9.3750 (8.5938) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [25/30] time 0.394 (0.418) data 0.267 (0.292) loss_u loss_u 0.9683 (0.9356) acc_u 3.1250 (8.1250) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [30/30] time 0.381 (0.416) data 0.252 (0.290) loss_u loss_u 0.9111 (0.9349) acc_u 9.3750 (8.0208) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 368
confident_label rate tensor(0.4130, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 674
clean true:666
clean false:8
clean_rate:0.9881305637982196
noisy true:598
noisy false:360
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 958
epoch [38/200] batch [5/21] time 0.417 (0.394) data 0.292 (0.269) loss_x loss_x 0.3499 (0.5344) acc_x 90.6250 (85.6250) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [10/21] time 0.413 (0.412) data 0.289 (0.287) loss_x loss_x 0.2534 (0.4995) acc_x 96.8750 (88.1250) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/21] time 0.448 (0.418) data 0.322 (0.292) loss_x loss_x 0.6470 (0.4743) acc_x 87.5000 (88.9583) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/21] time 0.421 (0.420) data 0.296 (0.294) loss_x loss_x 0.4966 (0.4601) acc_x 87.5000 (89.0625) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/29] time 0.394 (0.417) data 0.266 (0.292) loss_u loss_u 0.9375 (0.9175) acc_u 6.2500 (10.0000) lr 1.8443e-03 eta 0:00:10
epoch [38/200] batch [10/29] time 0.474 (0.423) data 0.345 (0.298) loss_u loss_u 0.9624 (0.9354) acc_u 6.2500 (8.4375) lr 1.8443e-03 eta 0:00:08
epoch [38/200] batch [15/29] time 0.453 (0.428) data 0.325 (0.302) loss_u loss_u 0.9653 (0.9467) acc_u 3.1250 (6.8750) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [20/29] time 0.429 (0.428) data 0.302 (0.303) loss_u loss_u 0.9692 (0.9489) acc_u 3.1250 (6.4062) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/29] time 0.358 (0.422) data 0.230 (0.297) loss_u loss_u 0.9351 (0.9511) acc_u 9.3750 (6.2500) lr 1.8443e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 393
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 665
clean true:655
clean false:10
clean_rate:0.9849624060150376
noisy true:584
noisy false:383
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 967
epoch [39/200] batch [5/20] time 0.404 (0.428) data 0.278 (0.301) loss_x loss_x 0.3865 (0.5065) acc_x 93.7500 (86.8750) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [10/20] time 0.528 (0.427) data 0.402 (0.301) loss_x loss_x 0.3604 (0.5061) acc_x 93.7500 (86.8750) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/20] time 0.514 (0.433) data 0.388 (0.306) loss_x loss_x 0.7124 (0.5049) acc_x 78.1250 (86.6667) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [20/20] time 0.433 (0.435) data 0.307 (0.311) loss_x loss_x 0.2854 (0.5033) acc_x 93.7500 (86.8750) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/30] time 0.448 (0.442) data 0.320 (0.317) loss_u loss_u 0.9189 (0.9156) acc_u 9.3750 (10.0000) lr 1.8358e-03 eta 0:00:11
epoch [39/200] batch [10/30] time 0.413 (0.436) data 0.260 (0.310) loss_u loss_u 0.9351 (0.9300) acc_u 6.2500 (7.5000) lr 1.8358e-03 eta 0:00:08
epoch [39/200] batch [15/30] time 0.468 (0.436) data 0.340 (0.309) loss_u loss_u 0.9775 (0.9402) acc_u 3.1250 (6.6667) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [20/30] time 0.453 (0.435) data 0.325 (0.308) loss_u loss_u 0.9438 (0.9458) acc_u 6.2500 (6.0938) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [25/30] time 0.391 (0.435) data 0.264 (0.308) loss_u loss_u 0.8862 (0.9404) acc_u 12.5000 (6.8750) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [30/30] time 0.400 (0.430) data 0.266 (0.303) loss_u loss_u 0.9443 (0.9405) acc_u 9.3750 (7.0833) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 407
confident_label rate tensor(0.3934, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 642
clean true:635
clean false:7
clean_rate:0.9890965732087228
noisy true:590
noisy false:400
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 990
epoch [40/200] batch [5/20] time 0.430 (0.435) data 0.303 (0.308) loss_x loss_x 0.3801 (0.4199) acc_x 90.6250 (90.0000) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [10/20] time 0.412 (0.440) data 0.286 (0.314) loss_x loss_x 0.4585 (0.4688) acc_x 93.7500 (88.7500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/20] time 0.374 (0.417) data 0.246 (0.293) loss_x loss_x 0.4241 (0.4723) acc_x 93.7500 (89.5833) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [20/20] time 0.441 (0.421) data 0.316 (0.297) loss_x loss_x 1.0195 (0.5195) acc_x 78.1250 (88.2812) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/30] time 0.452 (0.431) data 0.326 (0.306) loss_u loss_u 0.9434 (0.9452) acc_u 6.2500 (6.2500) lr 1.8271e-03 eta 0:00:10
epoch [40/200] batch [10/30] time 0.407 (0.431) data 0.279 (0.307) loss_u loss_u 0.9995 (0.9287) acc_u 0.0000 (8.4375) lr 1.8271e-03 eta 0:00:08
epoch [40/200] batch [15/30] time 0.441 (0.431) data 0.312 (0.306) loss_u loss_u 0.9990 (0.9310) acc_u 0.0000 (8.1250) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [20/30] time 0.463 (0.436) data 0.337 (0.311) loss_u loss_u 0.8320 (0.9242) acc_u 18.7500 (9.0625) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [25/30] time 0.374 (0.430) data 0.247 (0.306) loss_u loss_u 0.9448 (0.9304) acc_u 6.2500 (8.3750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [30/30] time 0.431 (0.427) data 0.304 (0.303) loss_u loss_u 0.9624 (0.9301) acc_u 6.2500 (8.5417) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 414
confident_label rate tensor(0.3946, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 644
clean true:633
clean false:11
clean_rate:0.9829192546583851
noisy true:585
noisy false:403
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 988
epoch [41/200] batch [5/20] time 0.392 (0.429) data 0.265 (0.301) loss_x loss_x 0.6006 (0.5468) acc_x 87.5000 (84.3750) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [10/20] time 0.421 (0.413) data 0.293 (0.286) loss_x loss_x 0.5649 (0.4715) acc_x 90.6250 (86.8750) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/20] time 0.383 (0.423) data 0.305 (0.299) loss_x loss_x 0.4270 (0.5090) acc_x 93.7500 (86.6667) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/20] time 0.446 (0.424) data 0.319 (0.302) loss_x loss_x 0.4526 (0.4847) acc_x 81.2500 (87.1875) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/30] time 0.419 (0.429) data 0.290 (0.306) loss_u loss_u 0.9517 (0.9083) acc_u 9.3750 (11.8750) lr 1.8181e-03 eta 0:00:10
epoch [41/200] batch [10/30] time 0.469 (0.433) data 0.342 (0.309) loss_u loss_u 0.8525 (0.9122) acc_u 18.7500 (11.5625) lr 1.8181e-03 eta 0:00:08
epoch [41/200] batch [15/30] time 0.400 (0.434) data 0.273 (0.309) loss_u loss_u 0.9155 (0.9164) acc_u 12.5000 (10.6250) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [20/30] time 0.392 (0.436) data 0.261 (0.311) loss_u loss_u 0.9321 (0.9227) acc_u 9.3750 (10.0000) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [25/30] time 0.392 (0.429) data 0.263 (0.304) loss_u loss_u 0.9736 (0.9254) acc_u 3.1250 (9.5000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [30/30] time 0.390 (0.424) data 0.260 (0.299) loss_u loss_u 0.9287 (0.9254) acc_u 6.2500 (9.4792) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 400
confident_label rate tensor(0.3971, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 648
clean true:642
clean false:6
clean_rate:0.9907407407407407
noisy true:590
noisy false:394
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 984
epoch [42/200] batch [5/20] time 0.417 (0.420) data 0.288 (0.301) loss_x loss_x 0.3782 (0.4907) acc_x 87.5000 (86.8750) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [10/20] time 0.443 (0.426) data 0.315 (0.303) loss_x loss_x 0.2302 (0.4604) acc_x 96.8750 (87.8125) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/20] time 0.484 (0.433) data 0.358 (0.309) loss_x loss_x 0.3269 (0.4758) acc_x 90.6250 (88.3333) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/20] time 0.450 (0.435) data 0.323 (0.310) loss_x loss_x 0.7017 (0.4878) acc_x 81.2500 (87.6562) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/30] time 0.365 (0.421) data 0.234 (0.296) loss_u loss_u 0.8828 (0.8995) acc_u 12.5000 (11.8750) lr 1.8090e-03 eta 0:00:10
epoch [42/200] batch [10/30] time 0.428 (0.419) data 0.299 (0.293) loss_u loss_u 0.9409 (0.9175) acc_u 6.2500 (9.6875) lr 1.8090e-03 eta 0:00:08
epoch [42/200] batch [15/30] time 0.396 (0.418) data 0.267 (0.292) loss_u loss_u 0.8901 (0.9226) acc_u 12.5000 (8.9583) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [20/30] time 0.385 (0.414) data 0.261 (0.288) loss_u loss_u 0.9541 (0.9264) acc_u 6.2500 (8.9062) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [25/30] time 0.385 (0.411) data 0.256 (0.284) loss_u loss_u 0.9316 (0.9309) acc_u 6.2500 (8.3750) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [30/30] time 0.457 (0.410) data 0.330 (0.283) loss_u loss_u 0.8477 (0.9306) acc_u 18.7500 (8.4375) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 376
confident_label rate tensor(0.4056, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 662
clean true:655
clean false:7
clean_rate:0.9894259818731118
noisy true:601
noisy false:369
after delete: len(clean_dataset) 662
after delete: len(noisy_dataset) 970
epoch [43/200] batch [5/20] time 0.437 (0.408) data 0.313 (0.280) loss_x loss_x 0.3599 (0.3979) acc_x 90.6250 (91.8750) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [10/20] time 0.464 (0.431) data 0.339 (0.305) loss_x loss_x 0.4075 (0.4506) acc_x 93.7500 (90.6250) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/20] time 0.402 (0.420) data 0.275 (0.293) loss_x loss_x 0.4897 (0.4245) acc_x 87.5000 (90.4167) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [20/20] time 0.397 (0.414) data 0.272 (0.289) loss_x loss_x 0.5288 (0.4555) acc_x 84.3750 (89.0625) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/30] time 0.414 (0.416) data 0.282 (0.290) loss_u loss_u 0.9263 (0.9110) acc_u 9.3750 (10.6250) lr 1.7997e-03 eta 0:00:10
epoch [43/200] batch [10/30] time 0.442 (0.424) data 0.313 (0.298) loss_u loss_u 0.9604 (0.9204) acc_u 6.2500 (9.3750) lr 1.7997e-03 eta 0:00:08
epoch [43/200] batch [15/30] time 0.393 (0.425) data 0.261 (0.299) loss_u loss_u 0.9414 (0.9298) acc_u 9.3750 (8.7500) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [20/30] time 0.397 (0.421) data 0.267 (0.294) loss_u loss_u 0.9854 (0.9373) acc_u 3.1250 (7.6562) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [25/30] time 0.382 (0.416) data 0.254 (0.290) loss_u loss_u 0.9683 (0.9379) acc_u 3.1250 (7.6250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [30/30] time 0.409 (0.416) data 0.279 (0.290) loss_u loss_u 0.9077 (0.9394) acc_u 12.5000 (7.5000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 367
confident_label rate tensor(0.4099, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 669
clean true:660
clean false:9
clean_rate:0.9865470852017937
noisy true:605
noisy false:358
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 963
epoch [44/200] batch [5/20] time 0.454 (0.467) data 0.327 (0.341) loss_x loss_x 0.6333 (0.5814) acc_x 93.7500 (90.0000) lr 1.7902e-03 eta 0:00:07
epoch [44/200] batch [10/20] time 0.483 (0.458) data 0.326 (0.330) loss_x loss_x 0.4609 (0.5334) acc_x 87.5000 (89.6875) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/20] time 0.498 (0.461) data 0.368 (0.333) loss_x loss_x 0.4746 (0.4976) acc_x 90.6250 (90.2083) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [20/20] time 0.430 (0.453) data 0.302 (0.325) loss_x loss_x 0.2427 (0.4463) acc_x 90.6250 (91.0938) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/30] time 0.478 (0.459) data 0.349 (0.330) loss_u loss_u 0.8931 (0.9137) acc_u 12.5000 (10.0000) lr 1.7902e-03 eta 0:00:11
epoch [44/200] batch [10/30] time 0.433 (0.447) data 0.305 (0.318) loss_u loss_u 0.9185 (0.9279) acc_u 9.3750 (8.1250) lr 1.7902e-03 eta 0:00:08
epoch [44/200] batch [15/30] time 0.388 (0.440) data 0.260 (0.313) loss_u loss_u 0.9956 (0.9267) acc_u 0.0000 (9.1667) lr 1.7902e-03 eta 0:00:06
epoch [44/200] batch [20/30] time 0.398 (0.434) data 0.268 (0.307) loss_u loss_u 0.9380 (0.9327) acc_u 6.2500 (8.2812) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [25/30] time 0.445 (0.432) data 0.317 (0.304) loss_u loss_u 0.9409 (0.9304) acc_u 6.2500 (8.6250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [30/30] time 0.397 (0.430) data 0.271 (0.303) loss_u loss_u 0.9355 (0.9349) acc_u 6.2500 (8.0208) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 370
confident_label rate tensor(0.4130, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 674
clean true:664
clean false:10
clean_rate:0.9851632047477745
noisy true:598
noisy false:360
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 958
epoch [45/200] batch [5/21] time 0.430 (0.457) data 0.302 (0.329) loss_x loss_x 0.8140 (0.4803) acc_x 84.3750 (90.6250) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [10/21] time 0.355 (0.414) data 0.226 (0.286) loss_x loss_x 0.4353 (0.4348) acc_x 90.6250 (90.0000) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/21] time 0.383 (0.416) data 0.256 (0.285) loss_x loss_x 0.6387 (0.4484) acc_x 78.1250 (89.3750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/21] time 0.435 (0.415) data 0.308 (0.286) loss_x loss_x 0.8564 (0.4573) acc_x 71.8750 (89.0625) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/29] time 0.414 (0.421) data 0.287 (0.292) loss_u loss_u 0.8667 (0.8962) acc_u 15.6250 (12.5000) lr 1.7804e-03 eta 0:00:10
epoch [45/200] batch [10/29] time 0.395 (0.416) data 0.267 (0.287) loss_u loss_u 0.9282 (0.9182) acc_u 9.3750 (9.6875) lr 1.7804e-03 eta 0:00:07
epoch [45/200] batch [15/29] time 0.394 (0.411) data 0.263 (0.281) loss_u loss_u 1.0000 (0.9337) acc_u 0.0000 (7.9167) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [20/29] time 0.462 (0.414) data 0.333 (0.285) loss_u loss_u 0.8818 (0.9277) acc_u 15.6250 (8.5938) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [25/29] time 0.449 (0.417) data 0.320 (0.288) loss_u loss_u 0.8965 (0.9310) acc_u 15.6250 (8.2500) lr 1.7804e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 357
confident_label rate tensor(0.4124, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 673
clean true:666
clean false:7
clean_rate:0.9895988112927192
noisy true:609
noisy false:350
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 959
epoch [46/200] batch [5/21] time 0.463 (0.415) data 0.337 (0.298) loss_x loss_x 0.3394 (0.4283) acc_x 96.8750 (87.5000) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [10/21] time 0.434 (0.438) data 0.307 (0.317) loss_x loss_x 0.6362 (0.4407) acc_x 81.2500 (87.8125) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/21] time 0.444 (0.439) data 0.320 (0.316) loss_x loss_x 0.3599 (0.4463) acc_x 90.6250 (88.5417) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/21] time 0.401 (0.429) data 0.272 (0.308) loss_x loss_x 0.4265 (0.4540) acc_x 87.5000 (88.4375) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/29] time 0.394 (0.420) data 0.266 (0.298) loss_u loss_u 0.8730 (0.9353) acc_u 15.6250 (8.7500) lr 1.7705e-03 eta 0:00:10
epoch [46/200] batch [10/29] time 0.438 (0.413) data 0.308 (0.289) loss_u loss_u 0.9697 (0.9390) acc_u 6.2500 (8.4375) lr 1.7705e-03 eta 0:00:07
epoch [46/200] batch [15/29] time 0.364 (0.409) data 0.234 (0.285) loss_u loss_u 0.9219 (0.9240) acc_u 9.3750 (10.0000) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [20/29] time 0.397 (0.406) data 0.268 (0.281) loss_u loss_u 0.9307 (0.9338) acc_u 9.3750 (8.7500) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [25/29] time 0.442 (0.409) data 0.313 (0.283) loss_u loss_u 0.9409 (0.9334) acc_u 9.3750 (8.7500) lr 1.7705e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.4161, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 679
clean true:674
clean false:5
clean_rate:0.9926362297496318
noisy true:603
noisy false:350
after delete: len(clean_dataset) 679
after delete: len(noisy_dataset) 953
epoch [47/200] batch [5/21] time 0.441 (0.442) data 0.317 (0.316) loss_x loss_x 0.5127 (0.4296) acc_x 90.6250 (90.6250) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [10/21] time 0.453 (0.445) data 0.327 (0.318) loss_x loss_x 0.2917 (0.4228) acc_x 93.7500 (90.0000) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [15/21] time 0.401 (0.441) data 0.275 (0.314) loss_x loss_x 0.3425 (0.4128) acc_x 93.7500 (91.0417) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/21] time 0.357 (0.416) data 0.233 (0.295) loss_x loss_x 0.2489 (0.3893) acc_x 93.7500 (91.7188) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/29] time 0.396 (0.405) data 0.265 (0.282) loss_u loss_u 0.9390 (0.9620) acc_u 6.2500 (3.7500) lr 1.7604e-03 eta 0:00:09
epoch [47/200] batch [10/29] time 0.464 (0.408) data 0.337 (0.284) loss_u loss_u 0.9526 (0.9542) acc_u 6.2500 (5.3125) lr 1.7604e-03 eta 0:00:07
epoch [47/200] batch [15/29] time 0.500 (0.417) data 0.373 (0.292) loss_u loss_u 0.9814 (0.9479) acc_u 3.1250 (6.0417) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [20/29] time 0.412 (0.418) data 0.284 (0.293) loss_u loss_u 0.8472 (0.9423) acc_u 18.7500 (6.7188) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/29] time 0.418 (0.418) data 0.292 (0.294) loss_u loss_u 0.9443 (0.9402) acc_u 9.3750 (7.0000) lr 1.7604e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 335
confident_label rate tensor(0.4197, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 685
clean true:679
clean false:6
clean_rate:0.9912408759124087
noisy true:618
noisy false:329
after delete: len(clean_dataset) 685
after delete: len(noisy_dataset) 947
epoch [48/200] batch [5/21] time 0.361 (0.379) data 0.237 (0.248) loss_x loss_x 0.3074 (0.3834) acc_x 93.7500 (91.8750) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [10/21] time 0.452 (0.409) data 0.322 (0.280) loss_x loss_x 0.3672 (0.3578) acc_x 93.7500 (92.5000) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/21] time 0.394 (0.412) data 0.267 (0.283) loss_x loss_x 0.4961 (0.4004) acc_x 87.5000 (91.0417) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/21] time 0.335 (0.403) data 0.257 (0.278) loss_x loss_x 0.6201 (0.3951) acc_x 84.3750 (91.0938) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/29] time 0.378 (0.400) data 0.252 (0.274) loss_u loss_u 0.9785 (0.9643) acc_u 3.1250 (4.3750) lr 1.7501e-03 eta 0:00:09
epoch [48/200] batch [10/29] time 0.420 (0.408) data 0.294 (0.282) loss_u loss_u 0.9951 (0.9477) acc_u 0.0000 (6.2500) lr 1.7501e-03 eta 0:00:07
epoch [48/200] batch [15/29] time 0.432 (0.408) data 0.304 (0.284) loss_u loss_u 0.9092 (0.9453) acc_u 12.5000 (6.6667) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [20/29] time 0.409 (0.411) data 0.280 (0.286) loss_u loss_u 0.9209 (0.9440) acc_u 12.5000 (6.7188) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [25/29] time 0.385 (0.412) data 0.257 (0.286) loss_u loss_u 0.9727 (0.9459) acc_u 3.1250 (6.5000) lr 1.7501e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 375
confident_label rate tensor(0.4075, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 665
clean true:657
clean false:8
clean_rate:0.98796992481203
noisy true:600
noisy false:367
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 967
epoch [49/200] batch [5/20] time 0.385 (0.423) data 0.259 (0.296) loss_x loss_x 0.2981 (0.4574) acc_x 96.8750 (88.1250) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [10/20] time 0.421 (0.418) data 0.295 (0.295) loss_x loss_x 0.2333 (0.4571) acc_x 90.6250 (87.5000) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/20] time 0.384 (0.411) data 0.256 (0.286) loss_x loss_x 0.4722 (0.4319) acc_x 87.5000 (89.1667) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/20] time 0.353 (0.401) data 0.227 (0.276) loss_x loss_x 0.6528 (0.4347) acc_x 87.5000 (89.3750) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/30] time 0.362 (0.391) data 0.233 (0.265) loss_u loss_u 0.9258 (0.9451) acc_u 9.3750 (6.8750) lr 1.7396e-03 eta 0:00:09
epoch [49/200] batch [10/30] time 0.364 (0.385) data 0.235 (0.259) loss_u loss_u 0.9248 (0.9397) acc_u 9.3750 (7.1875) lr 1.7396e-03 eta 0:00:07
epoch [49/200] batch [15/30] time 0.407 (0.385) data 0.276 (0.258) loss_u loss_u 0.9722 (0.9349) acc_u 3.1250 (7.9167) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [20/30] time 0.438 (0.390) data 0.308 (0.264) loss_u loss_u 0.9053 (0.9323) acc_u 12.5000 (8.4375) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [25/30] time 0.397 (0.395) data 0.273 (0.269) loss_u loss_u 0.9688 (0.9294) acc_u 3.1250 (8.5000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/30] time 0.407 (0.400) data 0.280 (0.274) loss_u loss_u 0.9429 (0.9290) acc_u 6.2500 (8.3333) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 331
confident_label rate tensor(0.4259, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 695
clean true:687
clean false:8
clean_rate:0.9884892086330935
noisy true:614
noisy false:323
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 937
epoch [50/200] batch [5/21] time 0.430 (0.446) data 0.304 (0.319) loss_x loss_x 0.5591 (0.4899) acc_x 81.2500 (88.1250) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [10/21] time 0.395 (0.417) data 0.269 (0.295) loss_x loss_x 0.4771 (0.4968) acc_x 90.6250 (86.5625) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/21] time 0.361 (0.408) data 0.236 (0.284) loss_x loss_x 0.3660 (0.4927) acc_x 90.6250 (87.7083) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/21] time 0.399 (0.398) data 0.273 (0.273) loss_x loss_x 0.4048 (0.4771) acc_x 90.6250 (88.7500) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/29] time 0.471 (0.414) data 0.347 (0.289) loss_u loss_u 0.9478 (0.9459) acc_u 6.2500 (5.6250) lr 1.7290e-03 eta 0:00:09
epoch [50/200] batch [10/29] time 0.414 (0.418) data 0.282 (0.294) loss_u loss_u 0.9507 (0.9373) acc_u 6.2500 (6.8750) lr 1.7290e-03 eta 0:00:07
epoch [50/200] batch [15/29] time 0.444 (0.421) data 0.315 (0.297) loss_u loss_u 0.9175 (0.9314) acc_u 9.3750 (7.7083) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [20/29] time 0.457 (0.424) data 0.328 (0.300) loss_u loss_u 0.9722 (0.9414) acc_u 6.2500 (6.7188) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [25/29] time 0.347 (0.424) data 0.270 (0.300) loss_u loss_u 0.9492 (0.9431) acc_u 6.2500 (6.3750) lr 1.7290e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 355
confident_label rate tensor(0.4105, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 670
clean true:662
clean false:8
clean_rate:0.9880597014925373
noisy true:615
noisy false:347
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 962
epoch [51/200] batch [5/20] time 0.344 (0.402) data 0.267 (0.285) loss_x loss_x 0.5679 (0.4113) acc_x 84.3750 (91.2500) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [10/20] time 0.396 (0.400) data 0.270 (0.279) loss_x loss_x 0.5278 (0.4285) acc_x 84.3750 (89.3750) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/20] time 0.432 (0.406) data 0.304 (0.283) loss_x loss_x 0.4929 (0.4274) acc_x 93.7500 (90.0000) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [20/20] time 0.463 (0.417) data 0.336 (0.293) loss_x loss_x 0.6675 (0.4436) acc_x 78.1250 (89.5312) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/30] time 0.391 (0.420) data 0.263 (0.297) loss_u loss_u 0.8008 (0.9133) acc_u 21.8750 (10.0000) lr 1.7181e-03 eta 0:00:10
epoch [51/200] batch [10/30] time 0.390 (0.412) data 0.261 (0.288) loss_u loss_u 0.9785 (0.9229) acc_u 3.1250 (9.0625) lr 1.7181e-03 eta 0:00:08
epoch [51/200] batch [15/30] time 0.408 (0.412) data 0.279 (0.288) loss_u loss_u 0.9146 (0.9250) acc_u 9.3750 (8.9583) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [20/30] time 0.361 (0.410) data 0.229 (0.286) loss_u loss_u 0.9683 (0.9335) acc_u 3.1250 (7.9688) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [25/30] time 0.497 (0.414) data 0.372 (0.288) loss_u loss_u 0.9697 (0.9341) acc_u 3.1250 (8.0000) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [30/30] time 0.445 (0.414) data 0.313 (0.290) loss_u loss_u 0.8896 (0.9333) acc_u 12.5000 (8.0208) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 358
confident_label rate tensor(0.4093, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 668
clean true:663
clean false:5
clean_rate:0.9925149700598802
noisy true:611
noisy false:353
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 964
epoch [52/200] batch [5/20] time 0.389 (0.385) data 0.265 (0.265) loss_x loss_x 0.4490 (0.4346) acc_x 90.6250 (88.1250) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [10/20] time 0.385 (0.389) data 0.257 (0.265) loss_x loss_x 0.5010 (0.4217) acc_x 90.6250 (89.3750) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/20] time 0.454 (0.402) data 0.331 (0.278) loss_x loss_x 0.2561 (0.3997) acc_x 93.7500 (90.0000) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [20/20] time 0.471 (0.409) data 0.345 (0.287) loss_x loss_x 0.1433 (0.3778) acc_x 96.8750 (90.9375) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/30] time 0.357 (0.401) data 0.228 (0.277) loss_u loss_u 0.9917 (0.9491) acc_u 0.0000 (5.6250) lr 1.7071e-03 eta 0:00:10
epoch [52/200] batch [10/30] time 0.402 (0.403) data 0.272 (0.278) loss_u loss_u 0.9424 (0.9329) acc_u 6.2500 (8.1250) lr 1.7071e-03 eta 0:00:08
epoch [52/200] batch [15/30] time 0.458 (0.407) data 0.327 (0.282) loss_u loss_u 0.8804 (0.9279) acc_u 15.6250 (8.7500) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [20/30] time 0.430 (0.412) data 0.300 (0.287) loss_u loss_u 0.9106 (0.9340) acc_u 9.3750 (7.9688) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [25/30] time 0.428 (0.413) data 0.301 (0.288) loss_u loss_u 0.9336 (0.9293) acc_u 6.2500 (8.5000) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/30] time 0.433 (0.414) data 0.304 (0.289) loss_u loss_u 0.9121 (0.9319) acc_u 12.5000 (8.3333) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 345
confident_label rate tensor(0.4185, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 683
clean true:679
clean false:4
clean_rate:0.9941434846266471
noisy true:608
noisy false:341
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 949
epoch [53/200] batch [5/21] time 0.397 (0.396) data 0.273 (0.270) loss_x loss_x 0.8076 (0.6642) acc_x 78.1250 (85.6250) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [10/21] time 0.354 (0.379) data 0.222 (0.252) loss_x loss_x 0.1943 (0.4795) acc_x 96.8750 (89.6875) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/21] time 0.379 (0.381) data 0.253 (0.257) loss_x loss_x 0.4314 (0.4412) acc_x 87.5000 (90.0000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [20/21] time 0.408 (0.391) data 0.278 (0.266) loss_x loss_x 0.4270 (0.4309) acc_x 87.5000 (89.6875) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/29] time 0.497 (0.402) data 0.365 (0.276) loss_u loss_u 0.9424 (0.9364) acc_u 6.2500 (8.1250) lr 1.6959e-03 eta 0:00:09
epoch [53/200] batch [10/29] time 0.456 (0.408) data 0.328 (0.282) loss_u loss_u 0.9414 (0.9268) acc_u 6.2500 (9.0625) lr 1.6959e-03 eta 0:00:07
epoch [53/200] batch [15/29] time 0.403 (0.407) data 0.278 (0.282) loss_u loss_u 0.9409 (0.9324) acc_u 6.2500 (8.5417) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [20/29] time 0.430 (0.407) data 0.300 (0.282) loss_u loss_u 0.9546 (0.9325) acc_u 3.1250 (8.2812) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [25/29] time 0.439 (0.410) data 0.309 (0.285) loss_u loss_u 0.9434 (0.9349) acc_u 6.2500 (7.8750) lr 1.6959e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.4259, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 695
clean true:687
clean false:8
clean_rate:0.9884892086330935
noisy true:622
noisy false:315
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 937
epoch [54/200] batch [5/21] time 0.403 (0.402) data 0.276 (0.274) loss_x loss_x 0.2218 (0.3978) acc_x 90.6250 (90.6250) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [10/21] time 0.408 (0.403) data 0.280 (0.276) loss_x loss_x 0.1897 (0.3693) acc_x 100.0000 (93.1250) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [15/21] time 0.411 (0.410) data 0.273 (0.286) loss_x loss_x 0.3665 (0.3877) acc_x 90.6250 (91.8750) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/21] time 0.379 (0.414) data 0.253 (0.289) loss_x loss_x 0.4993 (0.3933) acc_x 90.6250 (92.3438) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/29] time 0.379 (0.411) data 0.250 (0.286) loss_u loss_u 0.9795 (0.9530) acc_u 3.1250 (5.6250) lr 1.6845e-03 eta 0:00:09
epoch [54/200] batch [10/29] time 0.454 (0.419) data 0.324 (0.293) loss_u loss_u 0.9004 (0.9469) acc_u 12.5000 (6.5625) lr 1.6845e-03 eta 0:00:07
epoch [54/200] batch [15/29] time 0.347 (0.420) data 0.267 (0.294) loss_u loss_u 0.9321 (0.9428) acc_u 6.2500 (7.0833) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [20/29] time 0.436 (0.421) data 0.307 (0.295) loss_u loss_u 0.8950 (0.9442) acc_u 12.5000 (6.7188) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [25/29] time 0.352 (0.418) data 0.223 (0.292) loss_u loss_u 0.9746 (0.9496) acc_u 3.1250 (6.1250) lr 1.6845e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 348
confident_label rate tensor(0.4105, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 670
clean true:658
clean false:12
clean_rate:0.982089552238806
noisy true:626
noisy false:336
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 962
epoch [55/200] batch [5/20] time 0.417 (0.394) data 0.293 (0.278) loss_x loss_x 0.4785 (0.3465) acc_x 87.5000 (91.2500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/20] time 0.416 (0.410) data 0.288 (0.289) loss_x loss_x 0.2432 (0.3433) acc_x 96.8750 (92.1875) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/20] time 0.415 (0.425) data 0.336 (0.305) loss_x loss_x 0.4910 (0.3565) acc_x 93.7500 (91.8750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/20] time 0.493 (0.429) data 0.365 (0.307) loss_x loss_x 0.4595 (0.4026) acc_x 93.7500 (90.9375) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/30] time 0.459 (0.431) data 0.332 (0.309) loss_u loss_u 0.9922 (0.9270) acc_u 0.0000 (8.1250) lr 1.6730e-03 eta 0:00:10
epoch [55/200] batch [10/30] time 0.317 (0.432) data 0.238 (0.310) loss_u loss_u 0.9604 (0.9392) acc_u 3.1250 (6.8750) lr 1.6730e-03 eta 0:00:08
epoch [55/200] batch [15/30] time 0.431 (0.425) data 0.303 (0.302) loss_u loss_u 0.9692 (0.9379) acc_u 3.1250 (7.2917) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [20/30] time 0.477 (0.426) data 0.348 (0.303) loss_u loss_u 0.9976 (0.9395) acc_u 0.0000 (6.8750) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [25/30] time 0.451 (0.428) data 0.322 (0.304) loss_u loss_u 0.8999 (0.9364) acc_u 12.5000 (7.6250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [30/30] time 0.344 (0.425) data 0.267 (0.302) loss_u loss_u 0.9434 (0.9348) acc_u 9.3750 (7.8125) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 350
confident_label rate tensor(0.4112, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 671
clean true:665
clean false:6
clean_rate:0.9910581222056631
noisy true:617
noisy false:344
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 961
epoch [56/200] batch [5/20] time 0.496 (0.433) data 0.369 (0.307) loss_x loss_x 0.3491 (0.4084) acc_x 93.7500 (92.5000) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [10/20] time 0.407 (0.429) data 0.296 (0.304) loss_x loss_x 0.4155 (0.4163) acc_x 87.5000 (91.8750) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/20] time 0.354 (0.414) data 0.229 (0.286) loss_x loss_x 0.6128 (0.4161) acc_x 81.2500 (90.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/20] time 0.417 (0.409) data 0.289 (0.281) loss_x loss_x 0.4612 (0.4106) acc_x 90.6250 (90.1562) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/30] time 0.400 (0.416) data 0.271 (0.288) loss_u loss_u 0.8726 (0.8979) acc_u 15.6250 (11.8750) lr 1.6613e-03 eta 0:00:10
epoch [56/200] batch [10/30] time 0.398 (0.416) data 0.270 (0.287) loss_u loss_u 0.9517 (0.9112) acc_u 6.2500 (10.3125) lr 1.6613e-03 eta 0:00:08
epoch [56/200] batch [15/30] time 0.449 (0.417) data 0.322 (0.290) loss_u loss_u 0.9404 (0.9207) acc_u 6.2500 (9.3750) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [20/30] time 0.424 (0.418) data 0.296 (0.291) loss_u loss_u 0.9424 (0.9260) acc_u 6.2500 (8.7500) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [25/30] time 0.476 (0.420) data 0.351 (0.293) loss_u loss_u 0.9658 (0.9270) acc_u 3.1250 (8.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/30] time 0.458 (0.425) data 0.328 (0.298) loss_u loss_u 0.9600 (0.9286) acc_u 6.2500 (8.5417) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.4216, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 688
clean true:682
clean false:6
clean_rate:0.9912790697674418
noisy true:627
noisy false:317
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 944
epoch [57/200] batch [5/21] time 0.416 (0.417) data 0.290 (0.291) loss_x loss_x 0.2991 (0.3455) acc_x 93.7500 (91.2500) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [10/21] time 0.400 (0.406) data 0.270 (0.280) loss_x loss_x 0.3926 (0.3407) acc_x 90.6250 (91.8750) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/21] time 0.456 (0.424) data 0.329 (0.296) loss_x loss_x 0.4824 (0.3532) acc_x 90.6250 (91.8750) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [20/21] time 0.421 (0.426) data 0.294 (0.299) loss_x loss_x 0.4187 (0.3649) acc_x 90.6250 (92.0312) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/29] time 0.453 (0.431) data 0.323 (0.304) loss_u loss_u 0.8784 (0.9151) acc_u 15.6250 (10.0000) lr 1.6494e-03 eta 0:00:10
epoch [57/200] batch [10/29] time 0.370 (0.429) data 0.293 (0.302) loss_u loss_u 0.9785 (0.9211) acc_u 3.1250 (9.0625) lr 1.6494e-03 eta 0:00:08
epoch [57/200] batch [15/29] time 0.458 (0.427) data 0.332 (0.301) loss_u loss_u 0.9180 (0.9338) acc_u 9.3750 (7.5000) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [20/29] time 0.373 (0.428) data 0.245 (0.302) loss_u loss_u 0.9478 (0.9383) acc_u 6.2500 (7.1875) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [25/29] time 0.476 (0.428) data 0.346 (0.301) loss_u loss_u 0.8906 (0.9421) acc_u 12.5000 (6.6250) lr 1.6494e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 323
confident_label rate tensor(0.4234, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 691
clean true:681
clean false:10
clean_rate:0.9855282199710564
noisy true:628
noisy false:313
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 941
epoch [58/200] batch [5/21] time 0.459 (0.444) data 0.330 (0.317) loss_x loss_x 0.4460 (0.4437) acc_x 90.6250 (89.3750) lr 1.6374e-03 eta 0:00:07
epoch [58/200] batch [10/21] time 0.497 (0.456) data 0.371 (0.329) loss_x loss_x 0.0812 (0.4336) acc_x 100.0000 (90.0000) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [15/21] time 0.460 (0.447) data 0.333 (0.322) loss_x loss_x 0.1938 (0.4178) acc_x 96.8750 (90.6250) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [20/21] time 0.493 (0.450) data 0.365 (0.325) loss_x loss_x 0.4846 (0.4302) acc_x 84.3750 (90.1562) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/29] time 0.378 (0.438) data 0.248 (0.311) loss_u loss_u 0.9326 (0.9515) acc_u 6.2500 (5.0000) lr 1.6374e-03 eta 0:00:10
epoch [58/200] batch [10/29] time 0.398 (0.436) data 0.267 (0.309) loss_u loss_u 0.9243 (0.9458) acc_u 12.5000 (6.2500) lr 1.6374e-03 eta 0:00:08
epoch [58/200] batch [15/29] time 0.409 (0.428) data 0.272 (0.302) loss_u loss_u 0.9507 (0.9413) acc_u 6.2500 (7.0833) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [20/29] time 0.424 (0.427) data 0.298 (0.301) loss_u loss_u 0.9370 (0.9411) acc_u 9.3750 (7.1875) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [25/29] time 0.394 (0.425) data 0.268 (0.299) loss_u loss_u 0.9487 (0.9429) acc_u 6.2500 (7.1250) lr 1.6374e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 351
confident_label rate tensor(0.4185, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 683
clean true:673
clean false:10
clean_rate:0.9853587115666179
noisy true:608
noisy false:341
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 949
epoch [59/200] batch [5/21] time 0.429 (0.402) data 0.304 (0.276) loss_x loss_x 0.2156 (0.4668) acc_x 96.8750 (87.5000) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [10/21] time 0.387 (0.419) data 0.259 (0.290) loss_x loss_x 0.2773 (0.4015) acc_x 93.7500 (90.0000) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/21] time 0.483 (0.422) data 0.357 (0.294) loss_x loss_x 0.5928 (0.4378) acc_x 84.3750 (88.5417) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/21] time 0.461 (0.424) data 0.332 (0.296) loss_x loss_x 0.2769 (0.4250) acc_x 87.5000 (89.5312) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/29] time 0.387 (0.419) data 0.259 (0.294) loss_u loss_u 0.9927 (0.9462) acc_u 0.0000 (6.2500) lr 1.6252e-03 eta 0:00:10
epoch [59/200] batch [10/29] time 0.408 (0.422) data 0.281 (0.296) loss_u loss_u 0.9355 (0.9287) acc_u 6.2500 (8.7500) lr 1.6252e-03 eta 0:00:08
epoch [59/200] batch [15/29] time 0.398 (0.424) data 0.263 (0.297) loss_u loss_u 0.9253 (0.9281) acc_u 9.3750 (8.7500) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [20/29] time 0.371 (0.418) data 0.240 (0.291) loss_u loss_u 0.9756 (0.9299) acc_u 3.1250 (8.2812) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [25/29] time 0.407 (0.417) data 0.274 (0.290) loss_u loss_u 0.9019 (0.9294) acc_u 9.3750 (8.1250) lr 1.6252e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 338
confident_label rate tensor(0.4203, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 686
clean true:680
clean false:6
clean_rate:0.9912536443148688
noisy true:614
noisy false:332
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 946
epoch [60/200] batch [5/21] time 0.421 (0.417) data 0.294 (0.290) loss_x loss_x 0.4636 (0.4600) acc_x 90.6250 (90.6250) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [10/21] time 0.418 (0.415) data 0.290 (0.288) loss_x loss_x 0.2458 (0.4140) acc_x 93.7500 (91.2500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/21] time 0.380 (0.408) data 0.255 (0.284) loss_x loss_x 0.4009 (0.4191) acc_x 90.6250 (90.6250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/21] time 0.410 (0.408) data 0.283 (0.283) loss_x loss_x 0.3154 (0.4122) acc_x 93.7500 (90.6250) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/29] time 0.419 (0.409) data 0.293 (0.284) loss_u loss_u 0.9419 (0.9336) acc_u 6.2500 (7.5000) lr 1.6129e-03 eta 0:00:09
epoch [60/200] batch [10/29] time 0.347 (0.403) data 0.217 (0.277) loss_u loss_u 0.9316 (0.9246) acc_u 6.2500 (8.1250) lr 1.6129e-03 eta 0:00:07
epoch [60/200] batch [15/29] time 0.397 (0.399) data 0.270 (0.275) loss_u loss_u 0.9678 (0.9388) acc_u 3.1250 (6.4583) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [20/29] time 0.398 (0.397) data 0.271 (0.271) loss_u loss_u 0.9219 (0.9422) acc_u 6.2500 (6.2500) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [25/29] time 0.415 (0.399) data 0.287 (0.273) loss_u loss_u 0.8853 (0.9386) acc_u 12.5000 (6.7500) lr 1.6129e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 316
confident_label rate tensor(0.4240, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 692
clean true:685
clean false:7
clean_rate:0.9898843930635838
noisy true:631
noisy false:309
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 940
epoch [61/200] batch [5/21] time 0.398 (0.413) data 0.271 (0.286) loss_x loss_x 0.2124 (0.3588) acc_x 93.7500 (91.2500) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [10/21] time 0.364 (0.385) data 0.238 (0.258) loss_x loss_x 0.4043 (0.4422) acc_x 90.6250 (88.7500) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [15/21] time 0.412 (0.398) data 0.285 (0.271) loss_x loss_x 0.3628 (0.4022) acc_x 93.7500 (90.0000) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/21] time 0.404 (0.399) data 0.267 (0.274) loss_x loss_x 0.3000 (0.3756) acc_x 87.5000 (90.6250) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/29] time 0.429 (0.402) data 0.302 (0.277) loss_u loss_u 0.9219 (0.9439) acc_u 9.3750 (6.2500) lr 1.6004e-03 eta 0:00:09
epoch [61/200] batch [10/29] time 0.391 (0.403) data 0.262 (0.277) loss_u loss_u 0.9277 (0.9362) acc_u 9.3750 (7.5000) lr 1.6004e-03 eta 0:00:07
epoch [61/200] batch [15/29] time 0.416 (0.404) data 0.285 (0.277) loss_u loss_u 0.8716 (0.9244) acc_u 12.5000 (8.7500) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [20/29] time 0.447 (0.404) data 0.291 (0.278) loss_u loss_u 0.9722 (0.9323) acc_u 3.1250 (7.9688) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [25/29] time 0.439 (0.405) data 0.311 (0.279) loss_u loss_u 0.9604 (0.9332) acc_u 3.1250 (8.1250) lr 1.6004e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 325
confident_label rate tensor(0.4252, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 694
clean true:684
clean false:10
clean_rate:0.9855907780979827
noisy true:623
noisy false:315
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 938
epoch [62/200] batch [5/21] time 0.448 (0.436) data 0.320 (0.308) loss_x loss_x 0.8169 (0.3979) acc_x 81.2500 (91.2500) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [10/21] time 0.483 (0.437) data 0.357 (0.309) loss_x loss_x 0.1541 (0.3599) acc_x 100.0000 (93.1250) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/21] time 0.499 (0.447) data 0.373 (0.320) loss_x loss_x 0.6973 (0.4016) acc_x 78.1250 (91.6667) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/21] time 0.453 (0.443) data 0.327 (0.315) loss_x loss_x 0.4199 (0.4013) acc_x 90.6250 (91.2500) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/29] time 0.426 (0.437) data 0.297 (0.310) loss_u loss_u 0.9868 (0.9603) acc_u 0.0000 (3.7500) lr 1.5878e-03 eta 0:00:10
epoch [62/200] batch [10/29] time 0.342 (0.431) data 0.213 (0.303) loss_u loss_u 0.9126 (0.9445) acc_u 9.3750 (5.9375) lr 1.5878e-03 eta 0:00:08
epoch [62/200] batch [15/29] time 0.421 (0.422) data 0.291 (0.294) loss_u loss_u 0.9067 (0.9479) acc_u 12.5000 (5.8333) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [20/29] time 0.400 (0.421) data 0.270 (0.293) loss_u loss_u 0.9375 (0.9425) acc_u 6.2500 (6.4062) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [25/29] time 0.409 (0.417) data 0.281 (0.290) loss_u loss_u 0.9893 (0.9447) acc_u 0.0000 (6.1250) lr 1.5878e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 328
confident_label rate tensor(0.4191, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 684
clean true:675
clean false:9
clean_rate:0.9868421052631579
noisy true:629
noisy false:319
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 948
epoch [63/200] batch [5/21] time 0.410 (0.426) data 0.287 (0.300) loss_x loss_x 0.4600 (0.3677) acc_x 78.1250 (90.6250) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [10/21] time 0.426 (0.431) data 0.299 (0.305) loss_x loss_x 0.2747 (0.4329) acc_x 96.8750 (89.6875) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/21] time 0.376 (0.414) data 0.236 (0.287) loss_x loss_x 0.4458 (0.4285) acc_x 90.6250 (90.4167) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/21] time 0.409 (0.406) data 0.286 (0.280) loss_x loss_x 0.4788 (0.4470) acc_x 90.6250 (90.4688) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/29] time 0.392 (0.406) data 0.263 (0.279) loss_u loss_u 0.8447 (0.9253) acc_u 18.7500 (8.1250) lr 1.5750e-03 eta 0:00:09
epoch [63/200] batch [10/29] time 0.355 (0.402) data 0.225 (0.275) loss_u loss_u 0.8335 (0.9102) acc_u 21.8750 (10.6250) lr 1.5750e-03 eta 0:00:07
epoch [63/200] batch [15/29] time 0.409 (0.400) data 0.282 (0.273) loss_u loss_u 0.9409 (0.9248) acc_u 6.2500 (9.3750) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [20/29] time 0.443 (0.403) data 0.314 (0.275) loss_u loss_u 0.9678 (0.9272) acc_u 3.1250 (8.5938) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [25/29] time 0.444 (0.405) data 0.314 (0.278) loss_u loss_u 0.9106 (0.9319) acc_u 6.2500 (7.8750) lr 1.5750e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 304
confident_label rate tensor(0.4357, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 711
clean true:703
clean false:8
clean_rate:0.9887482419127989
noisy true:625
noisy false:296
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 921
epoch [64/200] batch [5/22] time 0.411 (0.384) data 0.288 (0.257) loss_x loss_x 0.6050 (0.5267) acc_x 81.2500 (85.0000) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [10/22] time 0.382 (0.388) data 0.258 (0.262) loss_x loss_x 0.2137 (0.4233) acc_x 100.0000 (89.0625) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [15/22] time 0.422 (0.392) data 0.296 (0.269) loss_x loss_x 0.5151 (0.4030) acc_x 93.7500 (90.4167) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/22] time 0.413 (0.396) data 0.284 (0.273) loss_x loss_x 0.3916 (0.3993) acc_x 90.6250 (90.9375) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/28] time 0.473 (0.412) data 0.347 (0.288) loss_u loss_u 0.9692 (0.9805) acc_u 3.1250 (2.5000) lr 1.5621e-03 eta 0:00:09
epoch [64/200] batch [10/28] time 0.401 (0.417) data 0.270 (0.292) loss_u loss_u 0.9448 (0.9726) acc_u 6.2500 (3.4375) lr 1.5621e-03 eta 0:00:07
epoch [64/200] batch [15/28] time 0.464 (0.414) data 0.335 (0.289) loss_u loss_u 0.9326 (0.9576) acc_u 9.3750 (5.2083) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [20/28] time 0.447 (0.416) data 0.317 (0.291) loss_u loss_u 0.9141 (0.9547) acc_u 6.2500 (5.3125) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [25/28] time 0.467 (0.420) data 0.340 (0.295) loss_u loss_u 0.9683 (0.9542) acc_u 3.1250 (5.6250) lr 1.5621e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 336
confident_label rate tensor(0.4246, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 693
clean true:685
clean false:8
clean_rate:0.9884559884559885
noisy true:611
noisy false:328
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 939
epoch [65/200] batch [5/21] time 0.436 (0.429) data 0.310 (0.303) loss_x loss_x 0.3359 (0.3824) acc_x 93.7500 (89.3750) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [10/21] time 0.433 (0.433) data 0.306 (0.307) loss_x loss_x 0.3662 (0.3325) acc_x 90.6250 (91.8750) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/21] time 0.430 (0.435) data 0.301 (0.308) loss_x loss_x 0.2003 (0.3662) acc_x 96.8750 (90.8333) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/21] time 0.427 (0.430) data 0.302 (0.305) loss_x loss_x 0.4260 (0.3789) acc_x 93.7500 (90.7812) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/29] time 0.423 (0.430) data 0.295 (0.304) loss_u loss_u 0.8936 (0.9196) acc_u 12.5000 (10.6250) lr 1.5490e-03 eta 0:00:10
epoch [65/200] batch [10/29] time 0.355 (0.422) data 0.228 (0.296) loss_u loss_u 0.9077 (0.9230) acc_u 9.3750 (9.0625) lr 1.5490e-03 eta 0:00:08
epoch [65/200] batch [15/29] time 0.424 (0.415) data 0.297 (0.288) loss_u loss_u 0.9624 (0.9275) acc_u 6.2500 (8.9583) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [20/29] time 0.414 (0.415) data 0.285 (0.289) loss_u loss_u 0.9663 (0.9283) acc_u 3.1250 (8.7500) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [25/29] time 0.459 (0.419) data 0.331 (0.293) loss_u loss_u 0.9653 (0.9334) acc_u 3.1250 (8.0000) lr 1.5490e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 326
confident_label rate tensor(0.4277, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 698
clean true:692
clean false:6
clean_rate:0.9914040114613181
noisy true:614
noisy false:320
after delete: len(clean_dataset) 698
after delete: len(noisy_dataset) 934
epoch [66/200] batch [5/21] time 0.454 (0.447) data 0.327 (0.319) loss_x loss_x 0.6733 (0.4392) acc_x 84.3750 (91.8750) lr 1.5358e-03 eta 0:00:07
epoch [66/200] batch [10/21] time 0.465 (0.431) data 0.339 (0.304) loss_x loss_x 0.4023 (0.4326) acc_x 93.7500 (91.2500) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/21] time 0.353 (0.412) data 0.223 (0.284) loss_x loss_x 0.3123 (0.4145) acc_x 93.7500 (91.8750) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/21] time 0.403 (0.399) data 0.277 (0.274) loss_x loss_x 0.4431 (0.4378) acc_x 84.3750 (90.7812) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/29] time 0.424 (0.403) data 0.299 (0.277) loss_u loss_u 0.8369 (0.9008) acc_u 18.7500 (11.8750) lr 1.5358e-03 eta 0:00:09
epoch [66/200] batch [10/29] time 0.434 (0.404) data 0.306 (0.280) loss_u loss_u 0.9219 (0.9179) acc_u 12.5000 (10.6250) lr 1.5358e-03 eta 0:00:07
epoch [66/200] batch [15/29] time 0.448 (0.412) data 0.318 (0.288) loss_u loss_u 0.9507 (0.9233) acc_u 6.2500 (9.5833) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [20/29] time 0.497 (0.420) data 0.368 (0.295) loss_u loss_u 0.9595 (0.9304) acc_u 3.1250 (8.7500) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [25/29] time 0.463 (0.423) data 0.330 (0.298) loss_u loss_u 0.9209 (0.9329) acc_u 9.3750 (8.3750) lr 1.5358e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 328
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 702
clean true:692
clean false:10
clean_rate:0.9857549857549858
noisy true:612
noisy false:318
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 930
epoch [67/200] batch [5/21] time 0.456 (0.414) data 0.327 (0.293) loss_x loss_x 0.3811 (0.5063) acc_x 90.6250 (89.3750) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [10/21] time 0.461 (0.423) data 0.334 (0.299) loss_x loss_x 0.5049 (0.4390) acc_x 87.5000 (90.9375) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/21] time 0.409 (0.421) data 0.284 (0.297) loss_x loss_x 0.5483 (0.4402) acc_x 84.3750 (90.6250) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/21] time 0.448 (0.411) data 0.324 (0.286) loss_x loss_x 0.3787 (0.4371) acc_x 87.5000 (90.0000) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/29] time 0.378 (0.410) data 0.253 (0.287) loss_u loss_u 0.9780 (0.9374) acc_u 3.1250 (7.5000) lr 1.5225e-03 eta 0:00:09
epoch [67/200] batch [10/29] time 0.416 (0.408) data 0.292 (0.284) loss_u loss_u 0.9268 (0.9424) acc_u 9.3750 (6.8750) lr 1.5225e-03 eta 0:00:07
epoch [67/200] batch [15/29] time 0.419 (0.411) data 0.293 (0.287) loss_u loss_u 0.9390 (0.9414) acc_u 6.2500 (7.0833) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [20/29] time 0.351 (0.409) data 0.224 (0.284) loss_u loss_u 0.9673 (0.9444) acc_u 3.1250 (6.5625) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [25/29] time 0.448 (0.405) data 0.323 (0.280) loss_u loss_u 0.8369 (0.9390) acc_u 21.8750 (7.2500) lr 1.5225e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 315
confident_label rate tensor(0.4289, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 700
clean true:694
clean false:6
clean_rate:0.9914285714285714
noisy true:623
noisy false:309
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 932
epoch [68/200] batch [5/21] time 0.459 (0.438) data 0.335 (0.312) loss_x loss_x 0.4287 (0.3611) acc_x 90.6250 (93.1250) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [10/21] time 0.441 (0.438) data 0.316 (0.313) loss_x loss_x 0.2983 (0.3816) acc_x 93.7500 (92.1875) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/21] time 0.398 (0.433) data 0.273 (0.309) loss_x loss_x 0.2839 (0.3773) acc_x 93.7500 (91.2500) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/21] time 0.389 (0.423) data 0.263 (0.299) loss_x loss_x 0.3503 (0.3688) acc_x 90.6250 (91.2500) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/29] time 0.408 (0.423) data 0.279 (0.297) loss_u loss_u 0.9263 (0.9601) acc_u 6.2500 (4.3750) lr 1.5090e-03 eta 0:00:10
epoch [68/200] batch [10/29] time 0.344 (0.420) data 0.214 (0.293) loss_u loss_u 0.8809 (0.9425) acc_u 12.5000 (6.2500) lr 1.5090e-03 eta 0:00:07
epoch [68/200] batch [15/29] time 0.447 (0.415) data 0.319 (0.288) loss_u loss_u 0.9512 (0.9371) acc_u 6.2500 (7.0833) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [20/29] time 0.414 (0.416) data 0.287 (0.291) loss_u loss_u 0.9160 (0.9396) acc_u 9.3750 (7.0312) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [25/29] time 0.438 (0.421) data 0.311 (0.295) loss_u loss_u 0.9751 (0.9387) acc_u 3.1250 (7.1250) lr 1.5090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 293
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 718
clean true:711
clean false:7
clean_rate:0.9902506963788301
noisy true:628
noisy false:286
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 914
epoch [69/200] batch [5/22] time 0.401 (0.409) data 0.277 (0.292) loss_x loss_x 0.2365 (0.4577) acc_x 93.7500 (88.7500) lr 1.4955e-03 eta 0:00:06
epoch [69/200] batch [10/22] time 0.426 (0.420) data 0.299 (0.298) loss_x loss_x 0.3398 (0.4081) acc_x 90.6250 (89.6875) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [15/22] time 0.356 (0.416) data 0.231 (0.292) loss_x loss_x 0.2094 (0.3878) acc_x 100.0000 (89.7917) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/22] time 0.381 (0.403) data 0.254 (0.278) loss_x loss_x 0.4202 (0.3797) acc_x 90.6250 (90.3125) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/28] time 0.439 (0.401) data 0.314 (0.277) loss_u loss_u 0.9395 (0.9337) acc_u 6.2500 (7.5000) lr 1.4955e-03 eta 0:00:09
epoch [69/200] batch [10/28] time 0.376 (0.402) data 0.249 (0.277) loss_u loss_u 0.9805 (0.9392) acc_u 3.1250 (6.8750) lr 1.4955e-03 eta 0:00:07
epoch [69/200] batch [15/28] time 0.407 (0.404) data 0.278 (0.279) loss_u loss_u 0.9771 (0.9469) acc_u 3.1250 (6.2500) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [20/28] time 0.440 (0.406) data 0.311 (0.280) loss_u loss_u 0.8647 (0.9450) acc_u 15.6250 (6.4062) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [25/28] time 0.394 (0.404) data 0.268 (0.279) loss_u loss_u 0.9077 (0.9403) acc_u 12.5000 (6.8750) lr 1.4955e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 288
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 709
clean true:704
clean false:5
clean_rate:0.9929478138222849
noisy true:640
noisy false:283
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 923
epoch [70/200] batch [5/22] time 0.416 (0.396) data 0.289 (0.268) loss_x loss_x 0.1660 (0.1950) acc_x 96.8750 (97.5000) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [10/22] time 0.429 (0.405) data 0.300 (0.277) loss_x loss_x 0.4080 (0.2943) acc_x 90.6250 (94.6875) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/22] time 0.425 (0.416) data 0.346 (0.292) loss_x loss_x 0.2515 (0.3119) acc_x 93.7500 (93.5417) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/22] time 0.381 (0.414) data 0.255 (0.289) loss_x loss_x 0.3232 (0.3169) acc_x 90.6250 (93.2812) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/28] time 0.382 (0.412) data 0.256 (0.286) loss_u loss_u 0.9609 (0.9722) acc_u 3.1250 (3.7500) lr 1.4818e-03 eta 0:00:09
epoch [70/200] batch [10/28] time 0.405 (0.409) data 0.280 (0.285) loss_u loss_u 0.9624 (0.9673) acc_u 6.2500 (4.0625) lr 1.4818e-03 eta 0:00:07
epoch [70/200] batch [15/28] time 0.445 (0.412) data 0.317 (0.287) loss_u loss_u 0.9302 (0.9584) acc_u 9.3750 (5.2083) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [20/28] time 0.444 (0.415) data 0.314 (0.290) loss_u loss_u 0.9199 (0.9559) acc_u 15.6250 (6.0938) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [25/28] time 0.389 (0.416) data 0.260 (0.291) loss_u loss_u 0.9087 (0.9457) acc_u 12.5000 (7.2500) lr 1.4818e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 297
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 718
clean true:707
clean false:11
clean_rate:0.9846796657381616
noisy true:628
noisy false:286
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 914
epoch [71/200] batch [5/22] time 0.443 (0.429) data 0.315 (0.301) loss_x loss_x 0.3811 (0.4043) acc_x 90.6250 (91.8750) lr 1.4679e-03 eta 0:00:07
epoch [71/200] batch [10/22] time 0.415 (0.428) data 0.286 (0.301) loss_x loss_x 0.6895 (0.4348) acc_x 84.3750 (90.3125) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [15/22] time 0.402 (0.419) data 0.274 (0.295) loss_x loss_x 0.3235 (0.4060) acc_x 93.7500 (91.0417) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/22] time 0.378 (0.412) data 0.251 (0.287) loss_x loss_x 0.2961 (0.3831) acc_x 96.8750 (91.8750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/28] time 0.446 (0.412) data 0.319 (0.287) loss_u loss_u 0.9229 (0.9395) acc_u 9.3750 (7.5000) lr 1.4679e-03 eta 0:00:09
epoch [71/200] batch [10/28] time 0.354 (0.411) data 0.227 (0.286) loss_u loss_u 0.8960 (0.9375) acc_u 12.5000 (7.1875) lr 1.4679e-03 eta 0:00:07
epoch [71/200] batch [15/28] time 0.420 (0.406) data 0.293 (0.281) loss_u loss_u 0.9448 (0.9397) acc_u 6.2500 (7.0833) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [20/28] time 0.418 (0.408) data 0.288 (0.282) loss_u loss_u 0.9521 (0.9397) acc_u 6.2500 (7.0312) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [25/28] time 0.419 (0.410) data 0.290 (0.285) loss_u loss_u 0.9629 (0.9379) acc_u 3.1250 (7.3750) lr 1.4679e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 303
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 718
clean true:706
clean false:12
clean_rate:0.9832869080779945
noisy true:623
noisy false:291
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 914
epoch [72/200] batch [5/22] time 0.415 (0.407) data 0.290 (0.291) loss_x loss_x 0.1770 (0.4163) acc_x 96.8750 (90.0000) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [10/22] time 0.407 (0.416) data 0.280 (0.294) loss_x loss_x 0.2776 (0.4170) acc_x 96.8750 (90.9375) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/22] time 0.351 (0.404) data 0.223 (0.281) loss_x loss_x 0.3298 (0.4101) acc_x 90.6250 (90.6250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/22] time 0.416 (0.400) data 0.289 (0.276) loss_x loss_x 0.2365 (0.3996) acc_x 96.8750 (90.9375) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/28] time 0.414 (0.405) data 0.285 (0.282) loss_u loss_u 0.9072 (0.9457) acc_u 9.3750 (5.0000) lr 1.4540e-03 eta 0:00:09
epoch [72/200] batch [10/28] time 0.435 (0.409) data 0.309 (0.285) loss_u loss_u 0.9663 (0.9438) acc_u 3.1250 (5.9375) lr 1.4540e-03 eta 0:00:07
epoch [72/200] batch [15/28] time 0.439 (0.412) data 0.311 (0.287) loss_u loss_u 0.9580 (0.9433) acc_u 3.1250 (5.8333) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [20/28] time 0.398 (0.410) data 0.270 (0.285) loss_u loss_u 0.9541 (0.9465) acc_u 6.2500 (5.6250) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [25/28] time 0.407 (0.410) data 0.278 (0.285) loss_u loss_u 0.9785 (0.9523) acc_u 3.1250 (5.1250) lr 1.4540e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.4461, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 728
clean true:718
clean false:10
clean_rate:0.9862637362637363
noisy true:631
noisy false:273
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 904
epoch [73/200] batch [5/22] time 0.442 (0.433) data 0.319 (0.306) loss_x loss_x 0.8286 (0.6029) acc_x 81.2500 (83.1250) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [10/22] time 0.452 (0.436) data 0.321 (0.308) loss_x loss_x 0.7432 (0.5328) acc_x 84.3750 (86.8750) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [15/22] time 0.391 (0.424) data 0.266 (0.296) loss_x loss_x 0.2537 (0.4875) acc_x 93.7500 (88.3333) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/22] time 0.370 (0.416) data 0.244 (0.288) loss_x loss_x 0.4497 (0.4537) acc_x 87.5000 (88.2812) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/28] time 0.428 (0.423) data 0.300 (0.295) loss_u loss_u 0.9771 (0.9492) acc_u 3.1250 (5.6250) lr 1.4399e-03 eta 0:00:09
epoch [73/200] batch [10/28] time 0.430 (0.425) data 0.301 (0.296) loss_u loss_u 0.9824 (0.9645) acc_u 3.1250 (4.0625) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [15/28] time 0.429 (0.424) data 0.302 (0.297) loss_u loss_u 0.9375 (0.9613) acc_u 6.2500 (4.3750) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [20/28] time 0.395 (0.428) data 0.267 (0.301) loss_u loss_u 0.9961 (0.9559) acc_u 0.0000 (5.0000) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [25/28] time 0.435 (0.425) data 0.307 (0.297) loss_u loss_u 0.9971 (0.9551) acc_u 0.0000 (5.1250) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 315
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 702
clean true:695
clean false:7
clean_rate:0.99002849002849
noisy true:622
noisy false:308
after delete: len(clean_dataset) 702
after delete: len(noisy_dataset) 930
epoch [74/200] batch [5/21] time 0.499 (0.431) data 0.374 (0.305) loss_x loss_x 0.1882 (0.3499) acc_x 93.7500 (91.2500) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [10/21] time 0.419 (0.436) data 0.293 (0.309) loss_x loss_x 0.5146 (0.4052) acc_x 84.3750 (89.6875) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/21] time 0.394 (0.432) data 0.268 (0.305) loss_x loss_x 0.5752 (0.4037) acc_x 90.6250 (90.8333) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/21] time 0.396 (0.425) data 0.271 (0.300) loss_x loss_x 0.3538 (0.3969) acc_x 93.7500 (90.7812) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/29] time 0.343 (0.418) data 0.217 (0.293) loss_u loss_u 0.9009 (0.9383) acc_u 12.5000 (7.5000) lr 1.4258e-03 eta 0:00:10
epoch [74/200] batch [10/29] time 0.370 (0.407) data 0.239 (0.282) loss_u loss_u 0.9668 (0.9450) acc_u 3.1250 (6.5625) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [15/29] time 0.446 (0.410) data 0.320 (0.284) loss_u loss_u 0.9199 (0.9443) acc_u 9.3750 (6.4583) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [20/29] time 0.449 (0.415) data 0.320 (0.289) loss_u loss_u 0.8877 (0.9405) acc_u 9.3750 (6.8750) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [25/29] time 0.368 (0.417) data 0.291 (0.292) loss_u loss_u 0.8647 (0.9411) acc_u 15.6250 (6.7500) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.4387, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 716
clean true:705
clean false:11
clean_rate:0.9846368715083799
noisy true:640
noisy false:276
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 916
epoch [75/200] batch [5/22] time 0.405 (0.395) data 0.277 (0.278) loss_x loss_x 0.6030 (0.4480) acc_x 84.3750 (88.1250) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [10/22] time 0.401 (0.400) data 0.270 (0.278) loss_x loss_x 0.4980 (0.4765) acc_x 90.6250 (88.7500) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/22] time 0.362 (0.391) data 0.235 (0.268) loss_x loss_x 0.2878 (0.4202) acc_x 93.7500 (90.0000) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/22] time 0.375 (0.394) data 0.298 (0.272) loss_x loss_x 0.4880 (0.4114) acc_x 87.5000 (90.1562) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/28] time 0.406 (0.403) data 0.279 (0.278) loss_u loss_u 0.9365 (0.9449) acc_u 6.2500 (5.6250) lr 1.4115e-03 eta 0:00:09
epoch [75/200] batch [10/28] time 0.407 (0.402) data 0.280 (0.277) loss_u loss_u 0.9688 (0.9537) acc_u 3.1250 (5.0000) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [15/28] time 0.386 (0.401) data 0.259 (0.276) loss_u loss_u 0.9736 (0.9460) acc_u 3.1250 (6.0417) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [20/28] time 0.397 (0.401) data 0.269 (0.276) loss_u loss_u 0.8652 (0.9458) acc_u 15.6250 (6.2500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [25/28] time 0.409 (0.401) data 0.283 (0.277) loss_u loss_u 0.9404 (0.9433) acc_u 6.2500 (6.6250) lr 1.4115e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 315
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 712
clean true:701
clean false:11
clean_rate:0.9845505617977528
noisy true:616
noisy false:304
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 920
epoch [76/200] batch [5/22] time 0.412 (0.406) data 0.285 (0.280) loss_x loss_x 0.6118 (0.4223) acc_x 81.2500 (90.0000) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [10/22] time 0.467 (0.417) data 0.341 (0.290) loss_x loss_x 0.3198 (0.4154) acc_x 90.6250 (90.6250) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [15/22] time 0.376 (0.412) data 0.253 (0.285) loss_x loss_x 0.5029 (0.3968) acc_x 84.3750 (91.2500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/22] time 0.433 (0.409) data 0.306 (0.281) loss_x loss_x 0.1909 (0.3943) acc_x 96.8750 (90.6250) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/28] time 0.414 (0.417) data 0.287 (0.289) loss_u loss_u 0.9482 (0.9429) acc_u 6.2500 (6.8750) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [10/28] time 0.448 (0.423) data 0.321 (0.296) loss_u loss_u 0.9170 (0.9389) acc_u 9.3750 (6.8750) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [15/28] time 0.464 (0.425) data 0.338 (0.299) loss_u loss_u 0.9150 (0.9401) acc_u 9.3750 (6.8750) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [20/28] time 0.428 (0.426) data 0.297 (0.300) loss_u loss_u 0.9868 (0.9471) acc_u 3.1250 (6.4062) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [25/28] time 0.374 (0.424) data 0.243 (0.297) loss_u loss_u 0.9272 (0.9433) acc_u 9.3750 (7.0000) lr 1.3971e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 319
confident_label rate tensor(0.4314, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 704
clean true:697
clean false:7
clean_rate:0.9900568181818182
noisy true:616
noisy false:312
after delete: len(clean_dataset) 704
after delete: len(noisy_dataset) 928
epoch [77/200] batch [5/22] time 0.393 (0.410) data 0.269 (0.279) loss_x loss_x 0.4924 (0.3961) acc_x 84.3750 (90.0000) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [10/22] time 0.393 (0.407) data 0.264 (0.278) loss_x loss_x 0.2255 (0.3377) acc_x 96.8750 (93.1250) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/22] time 0.414 (0.415) data 0.287 (0.286) loss_x loss_x 0.3792 (0.3430) acc_x 90.6250 (92.2917) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/22] time 0.348 (0.414) data 0.270 (0.289) loss_x loss_x 0.3457 (0.3619) acc_x 90.6250 (92.0312) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/29] time 0.390 (0.414) data 0.261 (0.288) loss_u loss_u 0.9741 (0.9795) acc_u 3.1250 (2.5000) lr 1.3827e-03 eta 0:00:09
epoch [77/200] batch [10/29] time 0.367 (0.411) data 0.240 (0.284) loss_u loss_u 0.9082 (0.9542) acc_u 9.3750 (5.0000) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [15/29] time 0.396 (0.409) data 0.268 (0.283) loss_u loss_u 0.9868 (0.9548) acc_u 3.1250 (5.0000) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [20/29] time 0.432 (0.409) data 0.304 (0.284) loss_u loss_u 0.8540 (0.9478) acc_u 15.6250 (5.7812) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [25/29] time 0.390 (0.408) data 0.264 (0.283) loss_u loss_u 0.9097 (0.9405) acc_u 9.3750 (6.7500) lr 1.3827e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 303
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 709
clean true:701
clean false:8
clean_rate:0.9887165021156559
noisy true:628
noisy false:295
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 923
epoch [78/200] batch [5/22] time 0.400 (0.416) data 0.270 (0.289) loss_x loss_x 0.2394 (0.2926) acc_x 96.8750 (95.6250) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [10/22] time 0.409 (0.405) data 0.281 (0.278) loss_x loss_x 0.1764 (0.2713) acc_x 96.8750 (94.6875) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/22] time 0.362 (0.390) data 0.234 (0.262) loss_x loss_x 0.3386 (0.2872) acc_x 93.7500 (93.9583) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/22] time 0.429 (0.385) data 0.305 (0.260) loss_x loss_x 0.2375 (0.2993) acc_x 96.8750 (94.0625) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/28] time 0.443 (0.397) data 0.317 (0.272) loss_u loss_u 0.9614 (0.9403) acc_u 9.3750 (8.7500) lr 1.3681e-03 eta 0:00:09
epoch [78/200] batch [10/28] time 0.393 (0.398) data 0.267 (0.272) loss_u loss_u 0.9585 (0.9377) acc_u 3.1250 (8.1250) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [15/28] time 0.406 (0.397) data 0.280 (0.271) loss_u loss_u 0.9541 (0.9372) acc_u 6.2500 (8.3333) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [20/28] time 0.455 (0.400) data 0.323 (0.275) loss_u loss_u 0.9702 (0.9346) acc_u 6.2500 (8.4375) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [25/28] time 0.410 (0.400) data 0.282 (0.275) loss_u loss_u 0.9912 (0.9363) acc_u 0.0000 (8.0000) lr 1.3681e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 316
confident_label rate tensor(0.4344, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 709
clean true:703
clean false:6
clean_rate:0.9915373765867419
noisy true:613
noisy false:310
after delete: len(clean_dataset) 709
after delete: len(noisy_dataset) 923
epoch [79/200] batch [5/22] time 0.435 (0.396) data 0.307 (0.268) loss_x loss_x 0.2612 (0.5021) acc_x 90.6250 (86.8750) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [10/22] time 0.396 (0.396) data 0.268 (0.269) loss_x loss_x 0.5366 (0.4468) acc_x 87.5000 (88.1250) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/22] time 0.392 (0.399) data 0.268 (0.275) loss_x loss_x 0.4707 (0.3890) acc_x 87.5000 (90.0000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/22] time 0.413 (0.403) data 0.287 (0.278) loss_x loss_x 0.2080 (0.3750) acc_x 96.8750 (90.9375) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/28] time 0.423 (0.404) data 0.294 (0.279) loss_u loss_u 0.9150 (0.9660) acc_u 12.5000 (3.7500) lr 1.3535e-03 eta 0:00:09
epoch [79/200] batch [10/28] time 0.407 (0.407) data 0.280 (0.282) loss_u loss_u 0.9922 (0.9450) acc_u 0.0000 (6.5625) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [15/28] time 0.411 (0.405) data 0.282 (0.280) loss_u loss_u 0.8682 (0.9422) acc_u 15.6250 (6.6667) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [20/28] time 0.409 (0.407) data 0.278 (0.281) loss_u loss_u 0.9038 (0.9446) acc_u 9.3750 (6.5625) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [25/28] time 0.361 (0.406) data 0.235 (0.280) loss_u loss_u 0.9653 (0.9421) acc_u 9.3750 (7.1250) lr 1.3535e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 283
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:715
clean false:9
clean_rate:0.9875690607734806
noisy true:634
noisy false:274
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [80/200] batch [5/22] time 0.402 (0.402) data 0.275 (0.275) loss_x loss_x 0.5254 (0.4126) acc_x 90.6250 (91.2500) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [10/22] time 0.441 (0.404) data 0.313 (0.278) loss_x loss_x 0.3457 (0.4130) acc_x 90.6250 (91.5625) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/22] time 0.362 (0.407) data 0.284 (0.283) loss_x loss_x 0.5635 (0.4091) acc_x 84.3750 (90.6250) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/22] time 0.457 (0.411) data 0.329 (0.287) loss_x loss_x 0.4338 (0.4024) acc_x 90.6250 (90.3125) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/28] time 0.447 (0.421) data 0.321 (0.296) loss_u loss_u 0.9727 (0.9343) acc_u 3.1250 (7.5000) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [10/28] time 0.357 (0.420) data 0.227 (0.295) loss_u loss_u 0.9238 (0.9354) acc_u 6.2500 (7.1875) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [15/28] time 0.424 (0.412) data 0.298 (0.288) loss_u loss_u 0.9697 (0.9375) acc_u 3.1250 (6.8750) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [20/28] time 0.416 (0.415) data 0.289 (0.290) loss_u loss_u 0.9375 (0.9428) acc_u 6.2500 (6.4062) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [25/28] time 0.380 (0.416) data 0.247 (0.290) loss_u loss_u 0.9414 (0.9450) acc_u 6.2500 (6.2500) lr 1.3387e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 312
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 719
clean true:710
clean false:9
clean_rate:0.9874826147426982
noisy true:610
noisy false:303
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 913
epoch [81/200] batch [5/22] time 0.417 (0.420) data 0.292 (0.294) loss_x loss_x 0.4148 (0.3479) acc_x 90.6250 (91.8750) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [10/22] time 0.435 (0.423) data 0.304 (0.297) loss_x loss_x 0.2937 (0.3573) acc_x 96.8750 (93.7500) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [15/22] time 0.364 (0.411) data 0.237 (0.284) loss_x loss_x 0.4546 (0.3674) acc_x 93.7500 (92.2917) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/22] time 0.423 (0.403) data 0.297 (0.278) loss_x loss_x 0.2976 (0.3329) acc_x 96.8750 (93.2812) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/28] time 0.390 (0.407) data 0.263 (0.281) loss_u loss_u 0.9590 (0.9256) acc_u 3.1250 (8.7500) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [10/28] time 0.441 (0.405) data 0.309 (0.280) loss_u loss_u 0.9419 (0.9412) acc_u 6.2500 (6.5625) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [15/28] time 0.406 (0.407) data 0.277 (0.282) loss_u loss_u 0.9492 (0.9466) acc_u 6.2500 (6.0417) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [20/28] time 0.403 (0.408) data 0.277 (0.282) loss_u loss_u 0.8384 (0.9408) acc_u 18.7500 (6.8750) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [25/28] time 0.433 (0.410) data 0.303 (0.284) loss_u loss_u 0.9819 (0.9426) acc_u 3.1250 (6.6250) lr 1.3239e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 286
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 718
clean true:710
clean false:8
clean_rate:0.9888579387186629
noisy true:636
noisy false:278
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 914
epoch [82/200] batch [5/22] time 0.384 (0.380) data 0.258 (0.267) loss_x loss_x 0.7773 (0.3893) acc_x 81.2500 (91.2500) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [10/22] time 0.502 (0.417) data 0.373 (0.297) loss_x loss_x 0.1956 (0.3392) acc_x 96.8750 (91.8750) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [15/22] time 0.494 (0.427) data 0.367 (0.304) loss_x loss_x 0.4502 (0.3778) acc_x 87.5000 (91.0417) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/22] time 0.476 (0.431) data 0.349 (0.307) loss_x loss_x 0.4336 (0.3666) acc_x 87.5000 (91.4062) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/28] time 0.451 (0.439) data 0.323 (0.316) loss_u loss_u 0.9097 (0.9331) acc_u 9.3750 (9.3750) lr 1.3090e-03 eta 0:00:10
epoch [82/200] batch [10/28] time 0.462 (0.441) data 0.334 (0.318) loss_u loss_u 0.9292 (0.9313) acc_u 9.3750 (9.3750) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [15/28] time 0.398 (0.440) data 0.270 (0.316) loss_u loss_u 0.8940 (0.9309) acc_u 12.5000 (8.7500) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [20/28] time 0.311 (0.429) data 0.232 (0.305) loss_u loss_u 0.9019 (0.9399) acc_u 12.5000 (7.5000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [25/28] time 0.399 (0.428) data 0.268 (0.304) loss_u loss_u 0.9600 (0.9413) acc_u 6.2500 (7.3750) lr 1.3090e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 299
confident_label rate tensor(0.4381, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 715
clean true:706
clean false:9
clean_rate:0.9874125874125874
noisy true:627
noisy false:290
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 917
epoch [83/200] batch [5/22] time 0.411 (0.438) data 0.284 (0.310) loss_x loss_x 0.3792 (0.2699) acc_x 84.3750 (92.5000) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [10/22] time 0.414 (0.443) data 0.287 (0.316) loss_x loss_x 0.2705 (0.3358) acc_x 96.8750 (91.2500) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [15/22] time 0.470 (0.453) data 0.344 (0.326) loss_x loss_x 0.2715 (0.3539) acc_x 90.6250 (90.6250) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/22] time 0.346 (0.448) data 0.220 (0.320) loss_x loss_x 0.3186 (0.3627) acc_x 93.7500 (90.7812) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/28] time 0.391 (0.428) data 0.263 (0.300) loss_u loss_u 0.9751 (0.9124) acc_u 3.1250 (10.0000) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [10/28] time 0.429 (0.423) data 0.295 (0.297) loss_u loss_u 0.9678 (0.9351) acc_u 3.1250 (7.8125) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [15/28] time 0.405 (0.422) data 0.277 (0.296) loss_u loss_u 0.9326 (0.9385) acc_u 6.2500 (7.0833) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [20/28] time 0.402 (0.419) data 0.270 (0.293) loss_u loss_u 0.9805 (0.9434) acc_u 3.1250 (6.7188) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [25/28] time 0.400 (0.417) data 0.270 (0.290) loss_u loss_u 0.9839 (0.9469) acc_u 0.0000 (6.2500) lr 1.2940e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 285
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 720
clean true:712
clean false:8
clean_rate:0.9888888888888889
noisy true:635
noisy false:277
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 912
epoch [84/200] batch [5/22] time 0.365 (0.394) data 0.237 (0.266) loss_x loss_x 0.6509 (0.3303) acc_x 84.3750 (93.1250) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [10/22] time 0.412 (0.407) data 0.287 (0.280) loss_x loss_x 0.3333 (0.3699) acc_x 93.7500 (91.2500) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/22] time 0.442 (0.421) data 0.312 (0.295) loss_x loss_x 0.3186 (0.3505) acc_x 90.6250 (90.8333) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/22] time 0.498 (0.429) data 0.371 (0.302) loss_x loss_x 0.2297 (0.3523) acc_x 96.8750 (91.5625) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/28] time 0.434 (0.428) data 0.308 (0.303) loss_u loss_u 0.9468 (0.9213) acc_u 6.2500 (9.3750) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [10/28] time 0.495 (0.434) data 0.364 (0.309) loss_u loss_u 0.9678 (0.9260) acc_u 3.1250 (8.4375) lr 1.2790e-03 eta 0:00:07
epoch [84/200] batch [15/28] time 0.378 (0.430) data 0.229 (0.304) loss_u loss_u 0.9155 (0.9346) acc_u 9.3750 (7.5000) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [20/28] time 0.394 (0.425) data 0.264 (0.300) loss_u loss_u 0.9189 (0.9315) acc_u 9.3750 (8.1250) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [25/28] time 0.393 (0.422) data 0.263 (0.296) loss_u loss_u 0.9570 (0.9366) acc_u 3.1250 (7.3750) lr 1.2790e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 282
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 713
clean true:705
clean false:8
clean_rate:0.9887798036465638
noisy true:645
noisy false:274
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 919
epoch [85/200] batch [5/22] time 0.475 (0.465) data 0.347 (0.338) loss_x loss_x 0.4106 (0.4022) acc_x 90.6250 (90.6250) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [10/22] time 0.499 (0.468) data 0.371 (0.341) loss_x loss_x 0.4172 (0.4197) acc_x 90.6250 (89.6875) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [15/22] time 0.419 (0.456) data 0.295 (0.333) loss_x loss_x 0.4331 (0.4274) acc_x 87.5000 (89.7917) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/22] time 0.427 (0.448) data 0.302 (0.324) loss_x loss_x 0.2615 (0.3756) acc_x 96.8750 (91.2500) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/28] time 0.433 (0.447) data 0.305 (0.322) loss_u loss_u 0.9805 (0.9524) acc_u 3.1250 (5.6250) lr 1.2639e-03 eta 0:00:10
epoch [85/200] batch [10/28] time 0.340 (0.445) data 0.262 (0.321) loss_u loss_u 0.9541 (0.9557) acc_u 6.2500 (5.6250) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [15/28] time 0.360 (0.436) data 0.232 (0.311) loss_u loss_u 0.9185 (0.9449) acc_u 9.3750 (6.6667) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [20/28] time 0.401 (0.431) data 0.270 (0.306) loss_u loss_u 0.9009 (0.9399) acc_u 15.6250 (7.5000) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [25/28] time 0.384 (0.426) data 0.256 (0.300) loss_u loss_u 0.9082 (0.9410) acc_u 9.3750 (7.2500) lr 1.2639e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 727
clean true:719
clean false:8
clean_rate:0.9889958734525447
noisy true:642
noisy false:263
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 905
epoch [86/200] batch [5/22] time 0.468 (0.456) data 0.342 (0.337) loss_x loss_x 0.3994 (0.2637) acc_x 93.7500 (95.0000) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [10/22] time 0.403 (0.446) data 0.278 (0.323) loss_x loss_x 0.2075 (0.2842) acc_x 93.7500 (95.0000) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [15/22] time 0.354 (0.422) data 0.226 (0.298) loss_x loss_x 0.7466 (0.3289) acc_x 75.0000 (92.9167) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/22] time 0.396 (0.414) data 0.269 (0.289) loss_x loss_x 0.2069 (0.3236) acc_x 96.8750 (92.8125) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/28] time 0.526 (0.419) data 0.399 (0.295) loss_u loss_u 0.9316 (0.9491) acc_u 12.5000 (6.2500) lr 1.2487e-03 eta 0:00:09
epoch [86/200] batch [10/28] time 0.442 (0.422) data 0.313 (0.297) loss_u loss_u 0.9082 (0.9549) acc_u 9.3750 (5.0000) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [15/28] time 0.398 (0.421) data 0.271 (0.296) loss_u loss_u 0.9180 (0.9458) acc_u 6.2500 (5.6250) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [20/28] time 0.298 (0.415) data 0.219 (0.291) loss_u loss_u 0.9473 (0.9466) acc_u 6.2500 (5.6250) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [25/28] time 0.385 (0.411) data 0.255 (0.285) loss_u loss_u 0.8838 (0.9427) acc_u 15.6250 (6.3750) lr 1.2487e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 299
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 710
clean true:701
clean false:9
clean_rate:0.9873239436619718
noisy true:632
noisy false:290
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 922
epoch [87/200] batch [5/22] time 0.411 (0.395) data 0.285 (0.277) loss_x loss_x 0.2239 (0.2898) acc_x 96.8750 (94.3750) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [10/22] time 0.475 (0.428) data 0.345 (0.305) loss_x loss_x 0.3589 (0.3245) acc_x 84.3750 (93.1250) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [15/22] time 0.432 (0.440) data 0.305 (0.316) loss_x loss_x 0.1383 (0.2867) acc_x 100.0000 (94.5833) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/22] time 0.421 (0.445) data 0.295 (0.320) loss_x loss_x 0.5464 (0.3156) acc_x 87.5000 (93.5938) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/28] time 0.438 (0.434) data 0.311 (0.310) loss_u loss_u 0.9692 (0.9475) acc_u 3.1250 (6.2500) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [10/28] time 0.390 (0.429) data 0.260 (0.305) loss_u loss_u 0.9312 (0.9399) acc_u 9.3750 (7.8125) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [15/28] time 0.354 (0.421) data 0.225 (0.296) loss_u loss_u 0.9536 (0.9445) acc_u 6.2500 (7.0833) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [20/28] time 0.400 (0.413) data 0.270 (0.288) loss_u loss_u 0.9517 (0.9428) acc_u 6.2500 (7.5000) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [25/28] time 0.343 (0.408) data 0.216 (0.283) loss_u loss_u 0.9604 (0.9372) acc_u 3.1250 (8.0000) lr 1.2334e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 291
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 719
clean true:711
clean false:8
clean_rate:0.9888734353268428
noisy true:630
noisy false:283
after delete: len(clean_dataset) 719
after delete: len(noisy_dataset) 913
epoch [88/200] batch [5/22] time 0.427 (0.428) data 0.300 (0.301) loss_x loss_x 0.2839 (0.2887) acc_x 96.8750 (93.1250) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [10/22] time 0.492 (0.447) data 0.367 (0.321) loss_x loss_x 0.1111 (0.2613) acc_x 100.0000 (94.6875) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [15/22] time 0.354 (0.436) data 0.275 (0.313) loss_x loss_x 0.6548 (0.3009) acc_x 87.5000 (94.1667) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/22] time 0.453 (0.432) data 0.326 (0.308) loss_x loss_x 0.3552 (0.3000) acc_x 87.5000 (93.2812) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/28] time 0.403 (0.426) data 0.275 (0.302) loss_u loss_u 0.9111 (0.9428) acc_u 9.3750 (6.2500) lr 1.2181e-03 eta 0:00:09
epoch [88/200] batch [10/28] time 0.340 (0.417) data 0.210 (0.292) loss_u loss_u 0.9360 (0.9381) acc_u 9.3750 (7.5000) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [15/28] time 0.378 (0.411) data 0.253 (0.287) loss_u loss_u 0.9829 (0.9367) acc_u 3.1250 (7.9167) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [20/28] time 0.346 (0.405) data 0.219 (0.281) loss_u loss_u 0.9678 (0.9452) acc_u 6.2500 (7.0312) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [25/28] time 0.414 (0.404) data 0.284 (0.279) loss_u loss_u 0.9048 (0.9459) acc_u 9.3750 (6.6250) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 287
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 712
clean true:706
clean false:6
clean_rate:0.9915730337078652
noisy true:639
noisy false:281
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 920
epoch [89/200] batch [5/22] time 0.424 (0.419) data 0.300 (0.293) loss_x loss_x 0.5303 (0.2599) acc_x 81.2500 (93.7500) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [10/22] time 0.459 (0.421) data 0.334 (0.295) loss_x loss_x 0.4236 (0.3157) acc_x 84.3750 (91.8750) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [15/22] time 0.396 (0.414) data 0.268 (0.288) loss_x loss_x 0.4229 (0.3230) acc_x 93.7500 (92.7083) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/22] time 0.370 (0.413) data 0.244 (0.287) loss_x loss_x 0.5615 (0.3382) acc_x 90.6250 (92.9688) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/28] time 0.458 (0.417) data 0.330 (0.292) loss_u loss_u 0.9590 (0.9527) acc_u 6.2500 (6.8750) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [10/28] time 0.490 (0.424) data 0.360 (0.298) loss_u loss_u 0.9995 (0.9430) acc_u 0.0000 (8.1250) lr 1.2028e-03 eta 0:00:07
epoch [89/200] batch [15/28] time 0.423 (0.426) data 0.296 (0.300) loss_u loss_u 1.0000 (0.9451) acc_u 0.0000 (7.2917) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [20/28] time 0.336 (0.421) data 0.253 (0.296) loss_u loss_u 0.9160 (0.9403) acc_u 9.3750 (7.6562) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [25/28] time 0.401 (0.416) data 0.275 (0.291) loss_u loss_u 0.9482 (0.9409) acc_u 6.2500 (7.6250) lr 1.2028e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 282
confident_label rate tensor(0.4424, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 722
clean true:713
clean false:9
clean_rate:0.9875346260387812
noisy true:637
noisy false:273
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 910
epoch [90/200] batch [5/22] time 0.354 (0.378) data 0.225 (0.251) loss_x loss_x 0.1669 (0.3168) acc_x 100.0000 (93.1250) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [10/22] time 0.437 (0.403) data 0.312 (0.276) loss_x loss_x 0.3047 (0.3725) acc_x 93.7500 (91.5625) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/22] time 0.491 (0.418) data 0.364 (0.295) loss_x loss_x 0.3154 (0.3534) acc_x 90.6250 (92.5000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [20/22] time 0.434 (0.426) data 0.305 (0.301) loss_x loss_x 0.4124 (0.3449) acc_x 84.3750 (92.1875) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/28] time 0.411 (0.424) data 0.282 (0.299) loss_u loss_u 0.8799 (0.9132) acc_u 15.6250 (10.6250) lr 1.1874e-03 eta 0:00:09
epoch [90/200] batch [10/28] time 0.451 (0.425) data 0.323 (0.299) loss_u loss_u 0.9966 (0.9276) acc_u 0.0000 (8.7500) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [15/28] time 0.433 (0.425) data 0.304 (0.300) loss_u loss_u 0.9351 (0.9384) acc_u 6.2500 (7.2917) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [20/28] time 0.395 (0.427) data 0.267 (0.301) loss_u loss_u 0.9878 (0.9429) acc_u 0.0000 (6.5625) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [25/28] time 0.396 (0.423) data 0.269 (0.298) loss_u loss_u 0.9756 (0.9462) acc_u 3.1250 (6.1250) lr 1.1874e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 280
confident_label rate tensor(0.4424, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 722
clean true:716
clean false:6
clean_rate:0.9916897506925207
noisy true:636
noisy false:274
after delete: len(clean_dataset) 722
after delete: len(noisy_dataset) 910
epoch [91/200] batch [5/22] time 0.404 (0.407) data 0.278 (0.288) loss_x loss_x 0.2935 (0.2402) acc_x 93.7500 (95.0000) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [10/22] time 0.450 (0.420) data 0.324 (0.297) loss_x loss_x 0.2947 (0.2705) acc_x 96.8750 (95.0000) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [15/22] time 0.425 (0.418) data 0.296 (0.294) loss_x loss_x 0.4065 (0.3345) acc_x 87.5000 (92.7083) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/22] time 0.436 (0.415) data 0.312 (0.292) loss_x loss_x 0.4478 (0.3507) acc_x 93.7500 (92.5000) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/28] time 0.390 (0.412) data 0.265 (0.289) loss_u loss_u 0.8857 (0.9203) acc_u 12.5000 (8.7500) lr 1.1719e-03 eta 0:00:09
epoch [91/200] batch [10/28] time 0.356 (0.407) data 0.229 (0.283) loss_u loss_u 0.9409 (0.9298) acc_u 6.2500 (8.1250) lr 1.1719e-03 eta 0:00:07
epoch [91/200] batch [15/28] time 0.409 (0.403) data 0.251 (0.278) loss_u loss_u 0.9609 (0.9413) acc_u 6.2500 (6.6667) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [20/28] time 0.399 (0.406) data 0.270 (0.281) loss_u loss_u 0.9556 (0.9449) acc_u 3.1250 (6.0938) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [25/28] time 0.400 (0.407) data 0.270 (0.281) loss_u loss_u 0.9473 (0.9470) acc_u 6.2500 (6.0000) lr 1.1719e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 293
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:719
clean false:10
clean_rate:0.9862825788751715
noisy true:620
noisy false:283
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [92/200] batch [5/22] time 0.438 (0.443) data 0.312 (0.315) loss_x loss_x 0.3652 (0.3745) acc_x 90.6250 (90.0000) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [10/22] time 0.383 (0.422) data 0.258 (0.295) loss_x loss_x 0.3625 (0.4141) acc_x 90.6250 (90.0000) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [15/22] time 0.363 (0.409) data 0.236 (0.282) loss_x loss_x 0.2527 (0.3870) acc_x 93.7500 (90.2083) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/22] time 0.393 (0.407) data 0.266 (0.279) loss_x loss_x 0.2930 (0.3799) acc_x 93.7500 (90.6250) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/28] time 0.418 (0.405) data 0.287 (0.281) loss_u loss_u 0.9048 (0.9385) acc_u 12.5000 (7.5000) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [10/28] time 0.429 (0.410) data 0.304 (0.285) loss_u loss_u 0.9307 (0.9415) acc_u 6.2500 (6.5625) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [15/28] time 0.406 (0.413) data 0.278 (0.288) loss_u loss_u 0.8740 (0.9447) acc_u 15.6250 (6.4583) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [20/28] time 0.444 (0.416) data 0.319 (0.291) loss_u loss_u 0.9790 (0.9499) acc_u 3.1250 (6.0938) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [25/28] time 0.407 (0.419) data 0.281 (0.293) loss_u loss_u 0.9263 (0.9453) acc_u 9.3750 (6.6250) lr 1.1564e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 263
confident_label rate tensor(0.4510, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 736
clean true:725
clean false:11
clean_rate:0.9850543478260869
noisy true:644
noisy false:252
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 896
epoch [93/200] batch [5/23] time 0.368 (0.414) data 0.241 (0.287) loss_x loss_x 0.2188 (0.3233) acc_x 100.0000 (93.1250) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [10/23] time 0.475 (0.461) data 0.349 (0.333) loss_x loss_x 0.3784 (0.3193) acc_x 90.6250 (92.8125) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [15/23] time 0.439 (0.458) data 0.310 (0.334) loss_x loss_x 0.1588 (0.3187) acc_x 96.8750 (92.5000) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/23] time 0.430 (0.452) data 0.303 (0.327) loss_x loss_x 0.3716 (0.3437) acc_x 93.7500 (92.1875) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [5/28] time 0.405 (0.441) data 0.276 (0.315) loss_u loss_u 0.9604 (0.9537) acc_u 6.2500 (5.0000) lr 1.1409e-03 eta 0:00:10
epoch [93/200] batch [10/28] time 0.336 (0.438) data 0.258 (0.313) loss_u loss_u 0.9844 (0.9517) acc_u 0.0000 (5.0000) lr 1.1409e-03 eta 0:00:07
epoch [93/200] batch [15/28] time 0.409 (0.435) data 0.280 (0.309) loss_u loss_u 0.9355 (0.9504) acc_u 6.2500 (5.0000) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [20/28] time 0.402 (0.430) data 0.269 (0.304) loss_u loss_u 0.9575 (0.9513) acc_u 6.2500 (5.1562) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [25/28] time 0.417 (0.428) data 0.285 (0.301) loss_u loss_u 0.9624 (0.9508) acc_u 6.2500 (5.3750) lr 1.1409e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 273
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 727
clean true:718
clean false:9
clean_rate:0.9876203576341128
noisy true:641
noisy false:264
after delete: len(clean_dataset) 727
after delete: len(noisy_dataset) 905
epoch [94/200] batch [5/22] time 0.413 (0.415) data 0.288 (0.299) loss_x loss_x 0.7061 (0.4891) acc_x 81.2500 (89.3750) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [10/22] time 0.441 (0.417) data 0.312 (0.295) loss_x loss_x 0.1967 (0.4334) acc_x 96.8750 (90.6250) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [15/22] time 0.418 (0.420) data 0.293 (0.297) loss_x loss_x 0.3140 (0.4263) acc_x 93.7500 (90.8333) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/22] time 0.349 (0.420) data 0.271 (0.299) loss_x loss_x 0.5889 (0.4018) acc_x 84.3750 (91.4062) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/28] time 0.441 (0.417) data 0.315 (0.294) loss_u loss_u 0.9443 (0.9251) acc_u 6.2500 (8.7500) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [10/28] time 0.405 (0.422) data 0.276 (0.298) loss_u loss_u 0.9370 (0.9262) acc_u 12.5000 (8.7500) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [15/28] time 0.359 (0.413) data 0.229 (0.288) loss_u loss_u 0.9619 (0.9350) acc_u 6.2500 (7.5000) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [20/28] time 0.386 (0.412) data 0.263 (0.287) loss_u loss_u 0.9316 (0.9375) acc_u 6.2500 (7.1875) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [25/28] time 0.399 (0.409) data 0.271 (0.285) loss_u loss_u 0.9893 (0.9435) acc_u 0.0000 (6.5000) lr 1.1253e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 282
confident_label rate tensor(0.4442, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 725
clean true:708
clean false:17
clean_rate:0.976551724137931
noisy true:642
noisy false:265
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 907
epoch [95/200] batch [5/22] time 0.547 (0.485) data 0.420 (0.358) loss_x loss_x 0.4480 (0.4784) acc_x 93.7500 (90.6250) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [10/22] time 0.337 (0.432) data 0.259 (0.310) loss_x loss_x 0.2417 (0.4484) acc_x 93.7500 (91.2500) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [15/22] time 0.467 (0.428) data 0.340 (0.304) loss_x loss_x 0.1846 (0.3988) acc_x 100.0000 (92.0833) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/22] time 0.352 (0.425) data 0.222 (0.300) loss_x loss_x 0.2322 (0.3752) acc_x 93.7500 (92.1875) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/28] time 0.427 (0.422) data 0.298 (0.296) loss_u loss_u 0.9946 (0.9533) acc_u 0.0000 (5.6250) lr 1.1097e-03 eta 0:00:09
epoch [95/200] batch [10/28] time 0.397 (0.424) data 0.270 (0.297) loss_u loss_u 0.9487 (0.9386) acc_u 6.2500 (7.1875) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [15/28] time 0.457 (0.427) data 0.329 (0.301) loss_u loss_u 0.9297 (0.9393) acc_u 12.5000 (7.5000) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [20/28] time 0.434 (0.428) data 0.304 (0.302) loss_u loss_u 0.9331 (0.9398) acc_u 9.3750 (7.5000) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [25/28] time 0.393 (0.424) data 0.265 (0.298) loss_u loss_u 0.9941 (0.9424) acc_u 0.0000 (7.0000) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 282
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 726
clean true:715
clean false:11
clean_rate:0.9848484848484849
noisy true:635
noisy false:271
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 906
epoch [96/200] batch [5/22] time 0.427 (0.414) data 0.303 (0.296) loss_x loss_x 0.6807 (0.3956) acc_x 81.2500 (87.5000) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [10/22] time 0.442 (0.424) data 0.316 (0.302) loss_x loss_x 0.4050 (0.3910) acc_x 90.6250 (90.0000) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [15/22] time 0.422 (0.436) data 0.295 (0.312) loss_x loss_x 0.5034 (0.3951) acc_x 87.5000 (90.0000) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/22] time 0.424 (0.440) data 0.299 (0.315) loss_x loss_x 0.3884 (0.3755) acc_x 87.5000 (91.0938) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/28] time 0.420 (0.438) data 0.291 (0.314) loss_u loss_u 0.9976 (0.9620) acc_u 0.0000 (3.7500) lr 1.0941e-03 eta 0:00:10
epoch [96/200] batch [10/28] time 0.361 (0.428) data 0.231 (0.303) loss_u loss_u 0.9688 (0.9517) acc_u 3.1250 (5.0000) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [15/28] time 0.358 (0.423) data 0.227 (0.298) loss_u loss_u 0.9761 (0.9471) acc_u 3.1250 (6.0417) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [20/28] time 0.355 (0.415) data 0.227 (0.289) loss_u loss_u 0.9761 (0.9481) acc_u 3.1250 (5.9375) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [25/28] time 0.392 (0.410) data 0.262 (0.283) loss_u loss_u 0.9233 (0.9469) acc_u 9.3750 (6.1250) lr 1.0941e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 274
confident_label rate tensor(0.4485, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 732
clean true:725
clean false:7
clean_rate:0.9904371584699454
noisy true:633
noisy false:267
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 900
epoch [97/200] batch [5/22] time 0.385 (0.440) data 0.261 (0.313) loss_x loss_x 0.6611 (0.4529) acc_x 78.1250 (87.5000) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [10/22] time 0.442 (0.427) data 0.314 (0.300) loss_x loss_x 0.1968 (0.4080) acc_x 100.0000 (90.6250) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [15/22] time 0.403 (0.429) data 0.271 (0.301) loss_x loss_x 0.2407 (0.3598) acc_x 96.8750 (91.6667) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/22] time 0.312 (0.409) data 0.234 (0.283) loss_x loss_x 0.3196 (0.3746) acc_x 90.6250 (91.4062) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/28] time 0.431 (0.415) data 0.302 (0.287) loss_u loss_u 0.9429 (0.9397) acc_u 6.2500 (6.8750) lr 1.0785e-03 eta 0:00:09
epoch [97/200] batch [10/28] time 0.397 (0.412) data 0.267 (0.285) loss_u loss_u 0.9683 (0.9571) acc_u 3.1250 (5.0000) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [15/28] time 0.385 (0.410) data 0.253 (0.282) loss_u loss_u 0.9966 (0.9604) acc_u 0.0000 (5.2083) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [20/28] time 0.352 (0.408) data 0.274 (0.282) loss_u loss_u 0.9136 (0.9539) acc_u 9.3750 (5.7812) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [25/28] time 0.479 (0.411) data 0.349 (0.284) loss_u loss_u 0.9844 (0.9546) acc_u 3.1250 (5.7500) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 267
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:721
clean false:8
clean_rate:0.9890260631001372
noisy true:644
noisy false:259
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [98/200] batch [5/22] time 0.453 (0.466) data 0.328 (0.340) loss_x loss_x 0.3738 (0.4512) acc_x 87.5000 (90.0000) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [10/22] time 0.453 (0.458) data 0.327 (0.332) loss_x loss_x 0.3403 (0.3795) acc_x 93.7500 (91.5625) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [15/22] time 0.459 (0.457) data 0.333 (0.331) loss_x loss_x 0.3582 (0.3881) acc_x 96.8750 (91.0417) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/22] time 0.389 (0.440) data 0.265 (0.316) loss_x loss_x 0.1343 (0.3565) acc_x 100.0000 (91.5625) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/28] time 0.397 (0.430) data 0.270 (0.305) loss_u loss_u 0.9385 (0.9428) acc_u 9.3750 (7.5000) lr 1.0628e-03 eta 0:00:09
epoch [98/200] batch [10/28] time 0.389 (0.424) data 0.261 (0.299) loss_u loss_u 0.9688 (0.9389) acc_u 3.1250 (7.8125) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [15/28] time 0.343 (0.427) data 0.215 (0.302) loss_u loss_u 0.9863 (0.9355) acc_u 0.0000 (7.7083) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [20/28] time 0.475 (0.422) data 0.348 (0.296) loss_u loss_u 0.9678 (0.9375) acc_u 3.1250 (7.3438) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [25/28] time 0.467 (0.426) data 0.335 (0.300) loss_u loss_u 0.8872 (0.9371) acc_u 12.5000 (7.2500) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4479, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 731
clean true:720
clean false:11
clean_rate:0.9849521203830369
noisy true:643
noisy false:258
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 901
epoch [99/200] batch [5/22] time 0.432 (0.429) data 0.306 (0.303) loss_x loss_x 0.1882 (0.4125) acc_x 96.8750 (90.0000) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [10/22] time 0.408 (0.428) data 0.282 (0.302) loss_x loss_x 0.0964 (0.3566) acc_x 100.0000 (91.8750) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [15/22] time 0.453 (0.423) data 0.329 (0.297) loss_x loss_x 0.3164 (0.3493) acc_x 93.7500 (92.5000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/22] time 0.385 (0.421) data 0.276 (0.296) loss_x loss_x 0.1848 (0.3293) acc_x 96.8750 (93.2812) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/28] time 0.355 (0.412) data 0.226 (0.285) loss_u loss_u 0.9336 (0.9571) acc_u 6.2500 (5.0000) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [10/28] time 0.405 (0.408) data 0.276 (0.282) loss_u loss_u 0.9297 (0.9452) acc_u 9.3750 (6.2500) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [15/28] time 0.486 (0.419) data 0.359 (0.292) loss_u loss_u 0.8843 (0.9439) acc_u 12.5000 (6.4583) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [20/28] time 0.475 (0.421) data 0.350 (0.296) loss_u loss_u 0.9873 (0.9495) acc_u 3.1250 (5.9375) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [25/28] time 0.431 (0.424) data 0.304 (0.298) loss_u loss_u 0.9536 (0.9449) acc_u 6.2500 (6.5000) lr 1.0471e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 274
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 726
clean true:714
clean false:12
clean_rate:0.9834710743801653
noisy true:644
noisy false:262
all clean rate:  [0.9897435897435898, 0.9882352941176471, 0.9844444444444445, 0.9848484848484849, 0.9809322033898306, 0.9918032786885246, 0.9799599198396793, 0.9919191919191919, 0.9865900383141762, 0.9901185770750988, 0.987037037037037, 0.9963503649635036, 0.985239852398524, 0.9828571428571429, 0.9929824561403509, 0.9867549668874173, 0.9913941480206541, 0.9933444259567388, 0.9881956155143339, 0.9901800327332242, 0.9915966386554622, 0.9951219512195122, 0.9851973684210527, 0.986863711001642, 0.9917218543046358, 0.985691573926868, 0.985981308411215, 0.9872, 0.9875195007800313, 0.9874015748031496, 0.9907692307692307, 0.9828926905132193, 0.9890453834115805, 0.9909365558912386, 0.9893617021276596, 0.9862595419847329, 0.9877300613496932, 0.9881305637982196, 0.9849624060150376, 0.9890965732087228, 0.9829192546583851, 0.9907407407407407, 0.9894259818731118, 0.9865470852017937, 0.9851632047477745, 0.9895988112927192, 0.9926362297496318, 0.9912408759124087, 0.98796992481203, 0.9884892086330935, 0.9880597014925373, 0.9925149700598802, 0.9941434846266471, 0.9884892086330935, 0.982089552238806, 0.9910581222056631, 0.9912790697674418, 0.9855282199710564, 0.9853587115666179, 0.9912536443148688, 0.9898843930635838, 0.9855907780979827, 0.9868421052631579, 0.9887482419127989, 0.9884559884559885, 0.9914040114613181, 0.9857549857549858, 0.9914285714285714, 0.9902506963788301, 0.9929478138222849, 0.9846796657381616, 0.9832869080779945, 0.9862637362637363, 0.99002849002849, 0.9846368715083799, 0.9845505617977528, 0.9900568181818182, 0.9887165021156559, 0.9915373765867419, 0.9875690607734806, 0.9874826147426982, 0.9888579387186629, 0.9874125874125874, 0.9888888888888889, 0.9887798036465638, 0.9889958734525447, 0.9873239436619718, 0.9888734353268428, 0.9915730337078652, 0.9875346260387812, 0.9916897506925207, 0.9862825788751715, 0.9850543478260869, 0.9876203576341128, 0.976551724137931, 0.9848484848484849, 0.9904371584699454, 0.9890260631001372, 0.9849521203830369, 0.9834710743801653]
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 906
epoch [100/200] batch [5/22] time 0.432 (0.425) data 0.305 (0.308) loss_x loss_x 0.3586 (0.3033) acc_x 90.6250 (93.1250) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [10/22] time 0.361 (0.399) data 0.235 (0.277) loss_x loss_x 0.5474 (0.3764) acc_x 87.5000 (91.8750) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/22] time 0.409 (0.406) data 0.282 (0.283) loss_x loss_x 0.2306 (0.3458) acc_x 96.8750 (92.9167) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/22] time 0.400 (0.401) data 0.264 (0.279) loss_x loss_x 0.2739 (0.3346) acc_x 93.7500 (92.6562) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/28] time 0.433 (0.395) data 0.304 (0.272) loss_u loss_u 0.9976 (0.9557) acc_u 0.0000 (5.0000) lr 1.0314e-03 eta 0:00:09
epoch [100/200] batch [10/28] time 0.450 (0.404) data 0.320 (0.279) loss_u loss_u 0.9707 (0.9409) acc_u 3.1250 (6.8750) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [15/28] time 0.468 (0.409) data 0.341 (0.284) loss_u loss_u 0.9072 (0.9380) acc_u 9.3750 (7.2917) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [20/28] time 0.338 (0.406) data 0.260 (0.282) loss_u loss_u 0.9814 (0.9436) acc_u 3.1250 (6.5625) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [25/28] time 0.465 (0.411) data 0.338 (0.286) loss_u loss_u 0.9370 (0.9438) acc_u 6.2500 (6.5000) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 271
confident_label rate tensor(0.4449, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 726
clean true:720
clean false:6
clean_rate:0.9917355371900827
noisy true:641
noisy false:265
after delete: len(clean_dataset) 726
after delete: len(noisy_dataset) 906
epoch [101/200] batch [5/22] time 0.425 (0.455) data 0.301 (0.338) loss_x loss_x 0.2510 (0.2902) acc_x 96.8750 (93.7500) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [10/22] time 0.399 (0.431) data 0.272 (0.309) loss_x loss_x 0.3245 (0.3065) acc_x 93.7500 (93.1250) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [15/22] time 0.396 (0.421) data 0.271 (0.298) loss_x loss_x 0.3403 (0.3224) acc_x 87.5000 (92.7083) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/22] time 0.410 (0.416) data 0.284 (0.292) loss_x loss_x 0.3042 (0.3283) acc_x 90.6250 (92.1875) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/28] time 0.434 (0.426) data 0.307 (0.302) loss_u loss_u 0.9863 (0.9468) acc_u 3.1250 (6.8750) lr 1.0157e-03 eta 0:00:09
epoch [101/200] batch [10/28] time 0.425 (0.427) data 0.298 (0.302) loss_u loss_u 0.9663 (0.9483) acc_u 6.2500 (6.2500) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [15/28] time 0.444 (0.429) data 0.319 (0.303) loss_u loss_u 0.9624 (0.9478) acc_u 3.1250 (6.2500) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [20/28] time 0.365 (0.420) data 0.237 (0.295) loss_u loss_u 0.9697 (0.9488) acc_u 3.1250 (6.0938) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [25/28] time 0.468 (0.421) data 0.342 (0.296) loss_u loss_u 0.9409 (0.9480) acc_u 6.2500 (6.2500) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.4516, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 737
clean true:727
clean false:10
clean_rate:0.9864314789687924
noisy true:639
noisy false:256
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 895
epoch [102/200] batch [5/23] time 0.424 (0.412) data 0.264 (0.280) loss_x loss_x 0.4424 (0.2796) acc_x 87.5000 (93.7500) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [10/23] time 0.399 (0.407) data 0.273 (0.277) loss_x loss_x 0.1752 (0.3125) acc_x 100.0000 (93.7500) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [15/23] time 0.398 (0.406) data 0.271 (0.277) loss_x loss_x 0.3330 (0.3388) acc_x 90.6250 (92.2917) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/23] time 0.341 (0.400) data 0.215 (0.272) loss_x loss_x 0.3081 (0.3620) acc_x 93.7500 (92.0312) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [5/27] time 0.447 (0.407) data 0.316 (0.278) loss_u loss_u 0.9658 (0.9667) acc_u 3.1250 (3.7500) lr 1.0000e-03 eta 0:00:08
epoch [102/200] batch [10/27] time 0.464 (0.411) data 0.336 (0.284) loss_u loss_u 0.8662 (0.9575) acc_u 15.6250 (5.0000) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [15/27] time 0.370 (0.413) data 0.245 (0.286) loss_u loss_u 0.9756 (0.9560) acc_u 3.1250 (5.0000) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [20/27] time 0.424 (0.412) data 0.297 (0.285) loss_u loss_u 0.9966 (0.9514) acc_u 0.0000 (5.4688) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/27] time 0.415 (0.413) data 0.289 (0.286) loss_u loss_u 0.9521 (0.9561) acc_u 6.2500 (5.0000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 284
confident_label rate tensor(0.4430, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 723
clean true:712
clean false:11
clean_rate:0.9847856154910097
noisy true:636
noisy false:273
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 909
epoch [103/200] batch [5/22] time 0.363 (0.396) data 0.232 (0.268) loss_x loss_x 0.3142 (0.2840) acc_x 90.6250 (93.1250) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [10/22] time 0.379 (0.380) data 0.252 (0.252) loss_x loss_x 0.2803 (0.2937) acc_x 90.6250 (92.5000) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/22] time 0.400 (0.382) data 0.273 (0.258) loss_x loss_x 0.3896 (0.3729) acc_x 93.7500 (91.4583) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [20/22] time 0.397 (0.384) data 0.271 (0.260) loss_x loss_x 0.3455 (0.3792) acc_x 93.7500 (91.2500) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/28] time 0.428 (0.388) data 0.299 (0.262) loss_u loss_u 0.9897 (0.9784) acc_u 0.0000 (1.8750) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [10/28] time 0.406 (0.392) data 0.277 (0.266) loss_u loss_u 0.9497 (0.9633) acc_u 6.2500 (4.0625) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [15/28] time 0.419 (0.393) data 0.293 (0.268) loss_u loss_u 0.9795 (0.9575) acc_u 3.1250 (4.7917) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [20/28] time 0.425 (0.395) data 0.298 (0.270) loss_u loss_u 0.9980 (0.9514) acc_u 0.0000 (5.4688) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [25/28] time 0.472 (0.398) data 0.346 (0.274) loss_u loss_u 0.9385 (0.9504) acc_u 6.2500 (5.6250) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.4491, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 733
clean true:725
clean false:8
clean_rate:0.9890859481582538
noisy true:637
noisy false:262
after delete: len(clean_dataset) 733
after delete: len(noisy_dataset) 899
epoch [104/200] batch [5/22] time 0.386 (0.411) data 0.262 (0.283) loss_x loss_x 0.4988 (0.4745) acc_x 93.7500 (88.7500) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [10/22] time 0.404 (0.426) data 0.279 (0.299) loss_x loss_x 0.2401 (0.4325) acc_x 96.8750 (90.3125) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [15/22] time 0.354 (0.406) data 0.227 (0.279) loss_x loss_x 0.2302 (0.3883) acc_x 93.7500 (91.0417) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/22] time 0.421 (0.403) data 0.296 (0.278) loss_x loss_x 0.2477 (0.3828) acc_x 90.6250 (90.6250) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/28] time 0.381 (0.406) data 0.257 (0.281) loss_u loss_u 0.9189 (0.9446) acc_u 9.3750 (6.2500) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [10/28] time 0.417 (0.406) data 0.292 (0.281) loss_u loss_u 0.9966 (0.9411) acc_u 0.0000 (6.8750) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [15/28] time 0.442 (0.406) data 0.314 (0.282) loss_u loss_u 0.9497 (0.9437) acc_u 6.2500 (6.4583) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [20/28] time 0.352 (0.403) data 0.222 (0.278) loss_u loss_u 0.8906 (0.9438) acc_u 12.5000 (6.5625) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [25/28] time 0.403 (0.401) data 0.276 (0.276) loss_u loss_u 0.9937 (0.9458) acc_u 0.0000 (6.2500) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 256
confident_label rate tensor(0.4430, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 723
clean true:714
clean false:9
clean_rate:0.9875518672199171
noisy true:662
noisy false:247
after delete: len(clean_dataset) 723
after delete: len(noisy_dataset) 909
epoch [105/200] batch [5/22] time 0.404 (0.411) data 0.282 (0.285) loss_x loss_x 0.2693 (0.4721) acc_x 93.7500 (90.0000) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [10/22] time 0.434 (0.412) data 0.307 (0.286) loss_x loss_x 0.3328 (0.4221) acc_x 90.6250 (90.9375) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/22] time 0.395 (0.411) data 0.268 (0.288) loss_x loss_x 0.4023 (0.3642) acc_x 87.5000 (92.2917) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/22] time 0.403 (0.409) data 0.274 (0.285) loss_x loss_x 0.4424 (0.3571) acc_x 87.5000 (92.3438) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/28] time 0.372 (0.403) data 0.241 (0.278) loss_u loss_u 0.9692 (0.9482) acc_u 3.1250 (6.2500) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [10/28] time 0.437 (0.401) data 0.309 (0.275) loss_u loss_u 0.9224 (0.9387) acc_u 9.3750 (7.1875) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [15/28] time 0.435 (0.401) data 0.307 (0.276) loss_u loss_u 0.9404 (0.9417) acc_u 9.3750 (6.8750) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [20/28] time 0.396 (0.399) data 0.267 (0.274) loss_u loss_u 0.9385 (0.9400) acc_u 9.3750 (7.0312) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [25/28] time 0.396 (0.400) data 0.267 (0.274) loss_u loss_u 0.9995 (0.9405) acc_u 0.0000 (6.8750) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:737
clean false:10
clean_rate:0.9866131191432396
noisy true:636
noisy false:249
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [106/200] batch [5/23] time 0.423 (0.418) data 0.298 (0.292) loss_x loss_x 0.1274 (0.1967) acc_x 96.8750 (97.5000) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [10/23] time 0.364 (0.404) data 0.236 (0.278) loss_x loss_x 0.3928 (0.2615) acc_x 90.6250 (94.6875) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [15/23] time 0.417 (0.398) data 0.290 (0.272) loss_x loss_x 0.1838 (0.2502) acc_x 100.0000 (95.6250) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/23] time 0.414 (0.405) data 0.291 (0.278) loss_x loss_x 0.1411 (0.2278) acc_x 96.8750 (96.2500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [5/27] time 0.395 (0.403) data 0.265 (0.275) loss_u loss_u 0.9688 (0.9789) acc_u 3.1250 (2.5000) lr 9.3721e-04 eta 0:00:08
epoch [106/200] batch [10/27] time 0.375 (0.400) data 0.248 (0.272) loss_u loss_u 0.9355 (0.9632) acc_u 6.2500 (4.0625) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [15/27] time 0.447 (0.402) data 0.316 (0.274) loss_u loss_u 0.9937 (0.9628) acc_u 0.0000 (4.1667) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [20/27] time 0.436 (0.405) data 0.311 (0.278) loss_u loss_u 0.9067 (0.9596) acc_u 9.3750 (4.5312) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/27] time 0.424 (0.409) data 0.299 (0.282) loss_u loss_u 0.9575 (0.9619) acc_u 6.2500 (4.3750) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 720
clean true:712
clean false:8
clean_rate:0.9888888888888889
noisy true:650
noisy false:262
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 912
epoch [107/200] batch [5/22] time 0.404 (0.424) data 0.279 (0.297) loss_x loss_x 0.1565 (0.2074) acc_x 100.0000 (97.5000) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [10/22] time 0.467 (0.447) data 0.338 (0.320) loss_x loss_x 0.3408 (0.2814) acc_x 96.8750 (94.3750) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [15/22] time 0.415 (0.447) data 0.287 (0.319) loss_x loss_x 0.1866 (0.2670) acc_x 96.8750 (94.7917) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/22] time 0.446 (0.442) data 0.320 (0.316) loss_x loss_x 0.4973 (0.2913) acc_x 90.6250 (94.0625) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/28] time 0.395 (0.431) data 0.265 (0.305) loss_u loss_u 0.9590 (0.9368) acc_u 6.2500 (7.5000) lr 9.2154e-04 eta 0:00:09
epoch [107/200] batch [10/28] time 0.340 (0.424) data 0.222 (0.298) loss_u loss_u 0.9292 (0.9428) acc_u 9.3750 (6.8750) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [15/28] time 0.408 (0.424) data 0.280 (0.299) loss_u loss_u 0.9194 (0.9344) acc_u 9.3750 (7.7083) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [20/28] time 0.361 (0.419) data 0.235 (0.293) loss_u loss_u 0.9502 (0.9339) acc_u 6.2500 (7.9688) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [25/28] time 0.302 (0.418) data 0.224 (0.293) loss_u loss_u 0.9468 (0.9353) acc_u 6.2500 (7.7500) lr 9.2154e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 295
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 720
clean true:712
clean false:8
clean_rate:0.9888888888888889
noisy true:625
noisy false:287
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 912
epoch [108/200] batch [5/22] time 0.425 (0.454) data 0.299 (0.327) loss_x loss_x 0.3823 (0.2664) acc_x 87.5000 (93.1250) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [10/22] time 0.432 (0.458) data 0.305 (0.331) loss_x loss_x 0.5869 (0.3042) acc_x 87.5000 (93.4375) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [15/22] time 0.432 (0.458) data 0.354 (0.334) loss_x loss_x 0.2382 (0.2985) acc_x 96.8750 (93.3333) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/22] time 0.411 (0.446) data 0.283 (0.320) loss_x loss_x 0.1548 (0.2863) acc_x 100.0000 (94.0625) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/28] time 0.400 (0.432) data 0.270 (0.306) loss_u loss_u 0.9673 (0.9119) acc_u 3.1250 (9.3750) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [10/28] time 0.402 (0.427) data 0.273 (0.300) loss_u loss_u 0.9395 (0.9313) acc_u 6.2500 (7.1875) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [15/28] time 0.424 (0.428) data 0.295 (0.302) loss_u loss_u 0.9507 (0.9275) acc_u 6.2500 (8.1250) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [20/28] time 0.432 (0.430) data 0.304 (0.303) loss_u loss_u 0.9351 (0.9274) acc_u 6.2500 (8.2812) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [25/28] time 0.427 (0.431) data 0.301 (0.304) loss_u loss_u 0.9668 (0.9323) acc_u 6.2500 (7.8750) lr 9.0589e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.4467, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 729
clean true:721
clean false:8
clean_rate:0.9890260631001372
noisy true:641
noisy false:262
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 903
epoch [109/200] batch [5/22] time 0.382 (0.380) data 0.257 (0.255) loss_x loss_x 0.3840 (0.3423) acc_x 93.7500 (92.5000) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [10/22] time 0.471 (0.398) data 0.345 (0.272) loss_x loss_x 0.2869 (0.3009) acc_x 90.6250 (92.8125) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/22] time 0.398 (0.407) data 0.272 (0.281) loss_x loss_x 0.3713 (0.3199) acc_x 87.5000 (91.8750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [20/22] time 0.457 (0.423) data 0.330 (0.300) loss_x loss_x 0.1709 (0.3281) acc_x 96.8750 (92.0312) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/28] time 0.605 (0.445) data 0.476 (0.321) loss_u loss_u 0.9238 (0.9536) acc_u 9.3750 (5.6250) lr 8.9027e-04 eta 0:00:10
epoch [109/200] batch [10/28] time 0.436 (0.448) data 0.308 (0.323) loss_u loss_u 0.9766 (0.9601) acc_u 3.1250 (4.3750) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [15/28] time 0.458 (0.448) data 0.326 (0.322) loss_u loss_u 0.9717 (0.9563) acc_u 3.1250 (4.7917) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [20/28] time 0.404 (0.445) data 0.278 (0.319) loss_u loss_u 0.9009 (0.9458) acc_u 12.5000 (6.0938) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [25/28] time 0.412 (0.442) data 0.286 (0.316) loss_u loss_u 0.9492 (0.9439) acc_u 6.2500 (6.2500) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.4510, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 736
clean true:723
clean false:13
clean_rate:0.9823369565217391
noisy true:643
noisy false:253
after delete: len(clean_dataset) 736
after delete: len(noisy_dataset) 896
epoch [110/200] batch [5/23] time 0.416 (0.406) data 0.291 (0.283) loss_x loss_x 0.4214 (0.5249) acc_x 90.6250 (86.2500) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [10/23] time 0.353 (0.394) data 0.227 (0.269) loss_x loss_x 0.4343 (0.4490) acc_x 93.7500 (89.6875) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [15/23] time 0.346 (0.389) data 0.221 (0.263) loss_x loss_x 0.5615 (0.4137) acc_x 90.6250 (91.0417) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/23] time 0.442 (0.395) data 0.314 (0.269) loss_x loss_x 0.4756 (0.3997) acc_x 90.6250 (90.9375) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [5/28] time 0.411 (0.399) data 0.285 (0.274) loss_u loss_u 0.9619 (0.9540) acc_u 3.1250 (5.0000) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [10/28] time 0.367 (0.392) data 0.237 (0.267) loss_u loss_u 0.9868 (0.9591) acc_u 3.1250 (5.0000) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [15/28] time 0.414 (0.394) data 0.286 (0.268) loss_u loss_u 0.9331 (0.9592) acc_u 6.2500 (5.0000) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [20/28] time 0.422 (0.396) data 0.294 (0.270) loss_u loss_u 0.8530 (0.9462) acc_u 15.6250 (6.5625) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [25/28] time 0.377 (0.398) data 0.299 (0.272) loss_u loss_u 0.9722 (0.9482) acc_u 3.1250 (6.2500) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:731
clean false:10
clean_rate:0.9865047233468286
noisy true:639
noisy false:252
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [111/200] batch [5/23] time 0.395 (0.395) data 0.268 (0.268) loss_x loss_x 0.4443 (0.3392) acc_x 93.7500 (90.6250) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [10/23] time 0.358 (0.387) data 0.231 (0.259) loss_x loss_x 0.3647 (0.2915) acc_x 90.6250 (93.1250) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [15/23] time 0.511 (0.395) data 0.372 (0.267) loss_x loss_x 0.3113 (0.3321) acc_x 96.8750 (92.5000) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/23] time 0.450 (0.410) data 0.324 (0.282) loss_x loss_x 0.3376 (0.3372) acc_x 90.6250 (92.0312) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [5/27] time 0.399 (0.417) data 0.273 (0.289) loss_u loss_u 0.9360 (0.9714) acc_u 6.2500 (3.1250) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [10/27] time 0.415 (0.418) data 0.290 (0.290) loss_u loss_u 0.9629 (0.9686) acc_u 3.1250 (3.4375) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [15/27] time 0.433 (0.420) data 0.304 (0.292) loss_u loss_u 0.9487 (0.9663) acc_u 6.2500 (3.9583) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [20/27] time 0.426 (0.422) data 0.301 (0.294) loss_u loss_u 0.9810 (0.9566) acc_u 3.1250 (5.0000) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/27] time 0.501 (0.425) data 0.373 (0.297) loss_u loss_u 0.9448 (0.9569) acc_u 6.2500 (4.8750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:733
clean false:8
clean_rate:0.9892037786774629
noisy true:637
noisy false:254
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [112/200] batch [5/23] time 0.406 (0.394) data 0.281 (0.276) loss_x loss_x 0.3113 (0.2892) acc_x 87.5000 (90.0000) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [10/23] time 0.495 (0.429) data 0.366 (0.307) loss_x loss_x 0.1508 (0.3003) acc_x 96.8750 (91.8750) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [15/23] time 0.449 (0.444) data 0.323 (0.320) loss_x loss_x 0.3762 (0.3157) acc_x 96.8750 (92.7083) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/23] time 0.429 (0.445) data 0.303 (0.321) loss_x loss_x 0.3193 (0.3174) acc_x 90.6250 (92.9688) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [5/27] time 0.389 (0.439) data 0.261 (0.314) loss_u loss_u 0.9917 (0.9714) acc_u 0.0000 (3.1250) lr 8.4357e-04 eta 0:00:09
epoch [112/200] batch [10/27] time 0.343 (0.429) data 0.216 (0.304) loss_u loss_u 0.9692 (0.9631) acc_u 3.1250 (4.3750) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [15/27] time 0.461 (0.424) data 0.333 (0.298) loss_u loss_u 0.9990 (0.9613) acc_u 0.0000 (4.5833) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [20/27] time 0.426 (0.434) data 0.298 (0.308) loss_u loss_u 0.9302 (0.9563) acc_u 9.3750 (5.3125) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [25/27] time 0.414 (0.432) data 0.285 (0.307) loss_u loss_u 0.9287 (0.9544) acc_u 12.5000 (5.6250) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 273
confident_label rate tensor(0.4461, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 728
clean true:719
clean false:9
clean_rate:0.9876373626373627
noisy true:640
noisy false:264
after delete: len(clean_dataset) 728
after delete: len(noisy_dataset) 904
epoch [113/200] batch [5/22] time 0.420 (0.409) data 0.286 (0.281) loss_x loss_x 0.3586 (0.3802) acc_x 93.7500 (91.2500) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [10/22] time 0.397 (0.408) data 0.272 (0.281) loss_x loss_x 0.4895 (0.3311) acc_x 93.7500 (93.1250) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/22] time 0.356 (0.400) data 0.228 (0.272) loss_x loss_x 0.3303 (0.3237) acc_x 93.7500 (93.5417) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/22] time 0.379 (0.405) data 0.301 (0.279) loss_x loss_x 0.1517 (0.3036) acc_x 100.0000 (93.7500) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/28] time 0.443 (0.414) data 0.316 (0.288) loss_u loss_u 0.9951 (0.9649) acc_u 0.0000 (4.3750) lr 8.2807e-04 eta 0:00:09
epoch [113/200] batch [10/28] time 0.434 (0.415) data 0.307 (0.289) loss_u loss_u 0.9331 (0.9456) acc_u 9.3750 (6.5625) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [15/28] time 0.429 (0.417) data 0.301 (0.290) loss_u loss_u 0.9990 (0.9458) acc_u 0.0000 (6.4583) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [20/28] time 0.480 (0.419) data 0.353 (0.293) loss_u loss_u 0.9829 (0.9499) acc_u 3.1250 (6.0938) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [25/28] time 0.357 (0.418) data 0.277 (0.293) loss_u loss_u 0.8706 (0.9455) acc_u 12.5000 (6.5000) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:732
clean false:11
clean_rate:0.9851951547779273
noisy true:646
noisy false:243
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [114/200] batch [5/23] time 0.470 (0.421) data 0.346 (0.296) loss_x loss_x 0.2903 (0.3177) acc_x 93.7500 (93.7500) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [10/23] time 0.388 (0.417) data 0.262 (0.291) loss_x loss_x 0.2286 (0.3413) acc_x 93.7500 (91.8750) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [15/23] time 0.465 (0.426) data 0.339 (0.299) loss_x loss_x 0.1215 (0.3134) acc_x 100.0000 (93.1250) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/23] time 0.436 (0.433) data 0.306 (0.306) loss_x loss_x 0.2118 (0.3027) acc_x 93.7500 (93.5938) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [5/27] time 0.394 (0.428) data 0.262 (0.301) loss_u loss_u 0.9624 (0.9669) acc_u 3.1250 (3.7500) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [10/27] time 0.431 (0.429) data 0.302 (0.301) loss_u loss_u 0.9131 (0.9578) acc_u 9.3750 (4.6875) lr 8.1262e-04 eta 0:00:07
epoch [114/200] batch [15/27] time 0.385 (0.422) data 0.269 (0.296) loss_u loss_u 0.9214 (0.9474) acc_u 9.3750 (6.0417) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [20/27] time 0.401 (0.416) data 0.270 (0.289) loss_u loss_u 0.9800 (0.9474) acc_u 3.1250 (6.2500) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/27] time 0.416 (0.419) data 0.283 (0.292) loss_u loss_u 0.9922 (0.9536) acc_u 0.0000 (5.5000) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 299
confident_label rate tensor(0.4436, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 724
clean true:712
clean false:12
clean_rate:0.9834254143646409
noisy true:621
noisy false:287
after delete: len(clean_dataset) 724
after delete: len(noisy_dataset) 908
epoch [115/200] batch [5/22] time 0.459 (0.451) data 0.331 (0.324) loss_x loss_x 0.3730 (0.2470) acc_x 87.5000 (94.3750) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [10/22] time 0.398 (0.442) data 0.271 (0.315) loss_x loss_x 0.2581 (0.2290) acc_x 96.8750 (95.3125) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [15/22] time 0.359 (0.432) data 0.279 (0.308) loss_x loss_x 0.3938 (0.2531) acc_x 90.6250 (94.3750) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/22] time 0.429 (0.435) data 0.300 (0.310) loss_x loss_x 0.3914 (0.2627) acc_x 96.8750 (94.2188) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/28] time 0.451 (0.420) data 0.323 (0.294) loss_u loss_u 0.8896 (0.9163) acc_u 12.5000 (9.3750) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [10/28] time 0.390 (0.424) data 0.311 (0.300) loss_u loss_u 0.9995 (0.9431) acc_u 0.0000 (6.8750) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [15/28] time 0.464 (0.425) data 0.335 (0.301) loss_u loss_u 0.9692 (0.9499) acc_u 3.1250 (6.0417) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [20/28] time 0.467 (0.426) data 0.339 (0.301) loss_u loss_u 0.9087 (0.9397) acc_u 12.5000 (7.3438) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [25/28] time 0.428 (0.429) data 0.299 (0.304) loss_u loss_u 0.8872 (0.9373) acc_u 12.5000 (7.3750) lr 7.9721e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4485, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 732
clean true:723
clean false:9
clean_rate:0.9877049180327869
noisy true:649
noisy false:251
after delete: len(clean_dataset) 732
after delete: len(noisy_dataset) 900
epoch [116/200] batch [5/22] time 0.493 (0.408) data 0.366 (0.281) loss_x loss_x 0.1567 (0.3008) acc_x 96.8750 (92.5000) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [10/22] time 0.433 (0.430) data 0.305 (0.303) loss_x loss_x 0.4258 (0.3466) acc_x 87.5000 (90.3125) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [15/22] time 0.468 (0.441) data 0.342 (0.314) loss_x loss_x 0.2739 (0.3285) acc_x 90.6250 (91.8750) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/22] time 0.414 (0.441) data 0.287 (0.313) loss_x loss_x 0.4045 (0.3153) acc_x 87.5000 (91.8750) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/28] time 0.423 (0.442) data 0.295 (0.315) loss_u loss_u 0.9580 (0.9618) acc_u 6.2500 (4.3750) lr 7.8186e-04 eta 0:00:10
epoch [116/200] batch [10/28] time 0.392 (0.436) data 0.265 (0.307) loss_u loss_u 0.9419 (0.9568) acc_u 6.2500 (4.6875) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [15/28] time 0.440 (0.436) data 0.315 (0.307) loss_u loss_u 0.9341 (0.9545) acc_u 6.2500 (5.0000) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [20/28] time 0.561 (0.434) data 0.432 (0.306) loss_u loss_u 0.9424 (0.9434) acc_u 6.2500 (6.4062) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [25/28] time 0.351 (0.434) data 0.221 (0.305) loss_u loss_u 0.9121 (0.9431) acc_u 9.3750 (6.3750) lr 7.8186e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:732
clean false:9
clean_rate:0.9878542510121457
noisy true:647
noisy false:244
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [117/200] batch [5/23] time 0.425 (0.456) data 0.298 (0.329) loss_x loss_x 0.2432 (0.2223) acc_x 90.6250 (94.3750) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [10/23] time 0.380 (0.437) data 0.255 (0.310) loss_x loss_x 0.3301 (0.3121) acc_x 90.6250 (92.5000) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [15/23] time 0.445 (0.446) data 0.320 (0.322) loss_x loss_x 0.2808 (0.3156) acc_x 93.7500 (92.9167) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/23] time 0.478 (0.453) data 0.352 (0.329) loss_x loss_x 0.4434 (0.3074) acc_x 87.5000 (92.9688) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [5/27] time 0.365 (0.454) data 0.235 (0.331) loss_u loss_u 0.9375 (0.9382) acc_u 9.3750 (7.5000) lr 7.6655e-04 eta 0:00:09
epoch [117/200] batch [10/27] time 0.446 (0.444) data 0.317 (0.319) loss_u loss_u 0.9492 (0.9380) acc_u 6.2500 (7.5000) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [15/27] time 0.452 (0.442) data 0.320 (0.317) loss_u loss_u 0.9370 (0.9446) acc_u 6.2500 (6.6667) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [20/27] time 0.474 (0.444) data 0.340 (0.319) loss_u loss_u 0.9399 (0.9432) acc_u 6.2500 (6.8750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [25/27] time 0.421 (0.444) data 0.292 (0.318) loss_u loss_u 0.9365 (0.9475) acc_u 6.2500 (6.2500) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:731
clean false:12
clean_rate:0.9838492597577388
noisy true:647
noisy false:242
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [118/200] batch [5/23] time 0.490 (0.437) data 0.367 (0.320) loss_x loss_x 0.3203 (0.2990) acc_x 90.6250 (91.2500) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [10/23] time 0.374 (0.405) data 0.246 (0.282) loss_x loss_x 0.2913 (0.2819) acc_x 93.7500 (93.1250) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [15/23] time 0.438 (0.407) data 0.309 (0.283) loss_x loss_x 0.1865 (0.2846) acc_x 96.8750 (93.1250) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/23] time 0.431 (0.410) data 0.302 (0.285) loss_x loss_x 0.3481 (0.3124) acc_x 93.7500 (92.9688) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [5/27] time 0.450 (0.413) data 0.322 (0.286) loss_u loss_u 0.9214 (0.9311) acc_u 6.2500 (7.5000) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [10/27] time 0.440 (0.419) data 0.312 (0.292) loss_u loss_u 0.9087 (0.9320) acc_u 9.3750 (7.8125) lr 7.5131e-04 eta 0:00:07
epoch [118/200] batch [15/27] time 0.431 (0.419) data 0.305 (0.292) loss_u loss_u 0.9907 (0.9451) acc_u 0.0000 (6.2500) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [20/27] time 0.461 (0.422) data 0.335 (0.296) loss_u loss_u 0.9131 (0.9456) acc_u 9.3750 (6.0938) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/27] time 0.408 (0.424) data 0.283 (0.298) loss_u loss_u 0.9707 (0.9487) acc_u 3.1250 (5.7500) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 269
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:739
clean false:13
clean_rate:0.9827127659574468
noisy true:624
noisy false:256
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [119/200] batch [5/23] time 0.434 (0.445) data 0.308 (0.317) loss_x loss_x 0.2703 (0.2643) acc_x 96.8750 (95.6250) lr 7.3613e-04 eta 0:00:08
epoch [119/200] batch [10/23] time 0.398 (0.444) data 0.272 (0.317) loss_x loss_x 0.4368 (0.3300) acc_x 93.7500 (93.4375) lr 7.3613e-04 eta 0:00:05
epoch [119/200] batch [15/23] time 0.404 (0.426) data 0.275 (0.298) loss_x loss_x 0.3811 (0.3327) acc_x 93.7500 (93.1250) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/23] time 0.371 (0.414) data 0.244 (0.288) loss_x loss_x 0.1649 (0.3322) acc_x 96.8750 (92.6562) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [5/27] time 0.412 (0.421) data 0.284 (0.294) loss_u loss_u 0.9243 (0.9490) acc_u 12.5000 (6.8750) lr 7.3613e-04 eta 0:00:09
epoch [119/200] batch [10/27] time 0.357 (0.416) data 0.229 (0.289) loss_u loss_u 0.9688 (0.9607) acc_u 3.1250 (4.6875) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [15/27] time 0.446 (0.415) data 0.319 (0.288) loss_u loss_u 0.8838 (0.9603) acc_u 12.5000 (4.5833) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [20/27] time 0.452 (0.418) data 0.324 (0.291) loss_u loss_u 0.9985 (0.9602) acc_u 0.0000 (4.5312) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/27] time 0.437 (0.421) data 0.309 (0.293) loss_u loss_u 0.9995 (0.9618) acc_u 0.0000 (4.5000) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4596, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 750
clean true:737
clean false:13
clean_rate:0.9826666666666667
noisy true:642
noisy false:240
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 882
epoch [120/200] batch [5/23] time 0.457 (0.407) data 0.329 (0.289) loss_x loss_x 0.3320 (0.3239) acc_x 93.7500 (91.8750) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [10/23] time 0.385 (0.423) data 0.258 (0.300) loss_x loss_x 0.3843 (0.3032) acc_x 93.7500 (93.4375) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [15/23] time 0.374 (0.401) data 0.246 (0.277) loss_x loss_x 0.3840 (0.3436) acc_x 93.7500 (92.7083) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/23] time 0.477 (0.414) data 0.350 (0.289) loss_x loss_x 0.4172 (0.3523) acc_x 87.5000 (92.0312) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [5/27] time 0.421 (0.421) data 0.294 (0.297) loss_u loss_u 0.9551 (0.9473) acc_u 6.2500 (6.2500) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [10/27] time 0.354 (0.418) data 0.228 (0.293) loss_u loss_u 0.8647 (0.9455) acc_u 15.6250 (6.5625) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [15/27] time 0.422 (0.412) data 0.291 (0.289) loss_u loss_u 0.9697 (0.9546) acc_u 3.1250 (5.4167) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [20/27] time 0.448 (0.415) data 0.319 (0.290) loss_u loss_u 0.9395 (0.9567) acc_u 6.2500 (5.0000) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/27] time 0.622 (0.424) data 0.494 (0.299) loss_u loss_u 0.9614 (0.9580) acc_u 3.1250 (4.7500) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.4504, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 735
clean true:725
clean false:10
clean_rate:0.9863945578231292
noisy true:656
noisy false:241
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 897
epoch [121/200] batch [5/22] time 0.421 (0.419) data 0.296 (0.292) loss_x loss_x 0.1589 (0.1957) acc_x 96.8750 (96.8750) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [10/22] time 0.410 (0.412) data 0.280 (0.285) loss_x loss_x 0.1537 (0.2360) acc_x 96.8750 (95.3125) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/22] time 0.352 (0.411) data 0.275 (0.287) loss_x loss_x 0.2106 (0.2868) acc_x 100.0000 (94.5833) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/22] time 0.398 (0.407) data 0.272 (0.283) loss_x loss_x 0.4460 (0.3065) acc_x 87.5000 (93.9062) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/28] time 0.411 (0.408) data 0.284 (0.282) loss_u loss_u 0.9829 (0.9544) acc_u 0.0000 (4.3750) lr 7.0596e-04 eta 0:00:09
epoch [121/200] batch [10/28] time 0.375 (0.407) data 0.296 (0.283) loss_u loss_u 0.9688 (0.9581) acc_u 3.1250 (4.0625) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [15/28] time 0.408 (0.408) data 0.281 (0.283) loss_u loss_u 0.9580 (0.9606) acc_u 6.2500 (4.1667) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [20/28] time 0.349 (0.404) data 0.220 (0.278) loss_u loss_u 0.9463 (0.9590) acc_u 6.2500 (4.3750) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [25/28] time 0.418 (0.404) data 0.291 (0.278) loss_u loss_u 0.9111 (0.9525) acc_u 9.3750 (5.3750) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:735
clean false:10
clean_rate:0.9865771812080537
noisy true:631
noisy false:256
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [122/200] batch [5/23] time 0.416 (0.422) data 0.289 (0.296) loss_x loss_x 0.5479 (0.3967) acc_x 87.5000 (89.3750) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [10/23] time 0.415 (0.417) data 0.286 (0.289) loss_x loss_x 0.4653 (0.3562) acc_x 90.6250 (91.2500) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [15/23] time 0.407 (0.416) data 0.281 (0.288) loss_x loss_x 0.2954 (0.3483) acc_x 90.6250 (91.6667) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/23] time 0.385 (0.414) data 0.259 (0.286) loss_x loss_x 0.4351 (0.3325) acc_x 90.6250 (92.0312) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [5/27] time 0.402 (0.404) data 0.273 (0.278) loss_u loss_u 0.9995 (0.9705) acc_u 0.0000 (3.7500) lr 6.9098e-04 eta 0:00:08
epoch [122/200] batch [10/27] time 0.404 (0.402) data 0.278 (0.278) loss_u loss_u 0.9990 (0.9737) acc_u 0.0000 (3.1250) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [15/27] time 0.409 (0.404) data 0.279 (0.278) loss_u loss_u 0.8911 (0.9589) acc_u 12.5000 (5.0000) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [20/27] time 0.435 (0.408) data 0.294 (0.282) loss_u loss_u 0.9736 (0.9588) acc_u 3.1250 (5.1562) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/27] time 0.426 (0.412) data 0.297 (0.286) loss_u loss_u 0.8867 (0.9564) acc_u 12.5000 (5.3750) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:732
clean false:10
clean_rate:0.9865229110512129
noisy true:648
noisy false:242
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [123/200] batch [5/23] time 0.467 (0.451) data 0.343 (0.326) loss_x loss_x 0.1081 (0.3015) acc_x 100.0000 (94.3750) lr 6.7608e-04 eta 0:00:08
epoch [123/200] batch [10/23] time 0.360 (0.444) data 0.231 (0.317) loss_x loss_x 0.2815 (0.3050) acc_x 96.8750 (93.4375) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [15/23] time 0.423 (0.422) data 0.298 (0.295) loss_x loss_x 0.4370 (0.3185) acc_x 93.7500 (93.7500) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/23] time 0.411 (0.425) data 0.334 (0.300) loss_x loss_x 0.2089 (0.3250) acc_x 96.8750 (93.4375) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [5/27] time 0.415 (0.430) data 0.288 (0.305) loss_u loss_u 0.9346 (0.9186) acc_u 6.2500 (9.3750) lr 6.7608e-04 eta 0:00:09
epoch [123/200] batch [10/27] time 0.438 (0.432) data 0.309 (0.308) loss_u loss_u 1.0000 (0.9519) acc_u 0.0000 (5.6250) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [15/27] time 0.403 (0.433) data 0.275 (0.308) loss_u loss_u 1.0000 (0.9497) acc_u 0.0000 (5.8333) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [20/27] time 0.365 (0.428) data 0.238 (0.303) loss_u loss_u 0.9966 (0.9492) acc_u 0.0000 (5.7812) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/27] time 0.420 (0.427) data 0.292 (0.302) loss_u loss_u 0.9380 (0.9542) acc_u 6.2500 (5.1250) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4504, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 735
clean true:726
clean false:9
clean_rate:0.9877551020408163
noisy true:647
noisy false:250
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 897
epoch [124/200] batch [5/22] time 0.414 (0.419) data 0.288 (0.292) loss_x loss_x 0.2898 (0.3424) acc_x 90.6250 (91.2500) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [10/22] time 0.397 (0.408) data 0.271 (0.286) loss_x loss_x 0.3301 (0.3066) acc_x 90.6250 (92.8125) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/22] time 0.432 (0.407) data 0.304 (0.284) loss_x loss_x 0.1716 (0.2613) acc_x 96.8750 (93.9583) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [20/22] time 0.413 (0.410) data 0.286 (0.286) loss_x loss_x 0.4124 (0.2498) acc_x 90.6250 (94.8438) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/28] time 0.410 (0.413) data 0.282 (0.287) loss_u loss_u 0.9521 (0.9694) acc_u 6.2500 (3.1250) lr 6.6126e-04 eta 0:00:09
epoch [124/200] batch [10/28] time 0.356 (0.406) data 0.227 (0.280) loss_u loss_u 0.9287 (0.9603) acc_u 9.3750 (4.3750) lr 6.6126e-04 eta 0:00:07
epoch [124/200] batch [15/28] time 0.405 (0.405) data 0.277 (0.278) loss_u loss_u 0.9360 (0.9539) acc_u 9.3750 (5.2083) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [20/28] time 0.417 (0.406) data 0.287 (0.279) loss_u loss_u 0.8799 (0.9495) acc_u 12.5000 (5.9375) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [25/28] time 0.422 (0.409) data 0.293 (0.282) loss_u loss_u 0.9639 (0.9514) acc_u 3.1250 (5.6250) lr 6.6126e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.4479, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 731
clean true:721
clean false:10
clean_rate:0.9863201094391245
noisy true:643
noisy false:258
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 901
epoch [125/200] batch [5/22] time 0.340 (0.428) data 0.235 (0.306) loss_x loss_x 0.2230 (0.2938) acc_x 93.7500 (91.8750) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [10/22] time 0.416 (0.410) data 0.289 (0.286) loss_x loss_x 0.2164 (0.2622) acc_x 100.0000 (94.0625) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/22] time 0.376 (0.409) data 0.249 (0.284) loss_x loss_x 0.8828 (0.2982) acc_x 81.2500 (93.7500) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/22] time 0.460 (0.413) data 0.334 (0.290) loss_x loss_x 0.1863 (0.2969) acc_x 96.8750 (93.9062) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/28] time 0.419 (0.416) data 0.293 (0.292) loss_u loss_u 0.9995 (0.9529) acc_u 0.0000 (5.0000) lr 6.4653e-04 eta 0:00:09
epoch [125/200] batch [10/28] time 0.436 (0.416) data 0.306 (0.292) loss_u loss_u 0.9438 (0.9535) acc_u 6.2500 (5.0000) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [15/28] time 0.390 (0.416) data 0.261 (0.290) loss_u loss_u 0.9580 (0.9500) acc_u 3.1250 (5.4167) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [20/28] time 0.386 (0.410) data 0.256 (0.285) loss_u loss_u 0.8564 (0.9392) acc_u 15.6250 (6.7188) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [25/28] time 0.397 (0.409) data 0.271 (0.284) loss_u loss_u 0.8970 (0.9391) acc_u 12.5000 (6.8750) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:733
clean false:8
clean_rate:0.9892037786774629
noisy true:640
noisy false:251
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [126/200] batch [5/23] time 0.429 (0.427) data 0.302 (0.300) loss_x loss_x 0.1541 (0.3269) acc_x 100.0000 (95.0000) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [10/23] time 0.442 (0.429) data 0.316 (0.302) loss_x loss_x 0.2177 (0.2883) acc_x 93.7500 (94.6875) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [15/23] time 0.435 (0.425) data 0.310 (0.302) loss_x loss_x 0.1025 (0.2812) acc_x 100.0000 (94.1667) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/23] time 0.395 (0.424) data 0.268 (0.299) loss_x loss_x 0.2600 (0.2714) acc_x 90.6250 (94.2188) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [5/27] time 0.438 (0.426) data 0.308 (0.300) loss_u loss_u 0.9790 (0.9607) acc_u 3.1250 (5.0000) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [10/27] time 0.480 (0.429) data 0.349 (0.303) loss_u loss_u 0.9404 (0.9428) acc_u 6.2500 (6.8750) lr 6.3188e-04 eta 0:00:07
epoch [126/200] batch [15/27] time 0.348 (0.423) data 0.219 (0.298) loss_u loss_u 0.8403 (0.9467) acc_u 18.7500 (6.2500) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [20/27] time 0.358 (0.416) data 0.228 (0.290) loss_u loss_u 0.9741 (0.9508) acc_u 6.2500 (5.9375) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/27] time 0.391 (0.414) data 0.265 (0.288) loss_u loss_u 0.9702 (0.9528) acc_u 3.1250 (5.6250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 246
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:731
clean false:16
clean_rate:0.9785809906291834
noisy true:655
noisy false:230
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [127/200] batch [5/23] time 0.416 (0.425) data 0.285 (0.298) loss_x loss_x 0.1780 (0.2923) acc_x 96.8750 (93.7500) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [10/23] time 0.451 (0.442) data 0.327 (0.316) loss_x loss_x 0.3450 (0.3427) acc_x 93.7500 (93.4375) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [15/23] time 0.505 (0.445) data 0.377 (0.318) loss_x loss_x 0.2817 (0.2957) acc_x 90.6250 (94.3750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/23] time 0.489 (0.447) data 0.362 (0.322) loss_x loss_x 0.5415 (0.3291) acc_x 84.3750 (93.2812) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [5/27] time 0.434 (0.443) data 0.306 (0.318) loss_u loss_u 0.9673 (0.9526) acc_u 3.1250 (5.6250) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [10/27] time 0.460 (0.444) data 0.332 (0.318) loss_u loss_u 0.9321 (0.9500) acc_u 9.3750 (5.6250) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [15/27] time 0.398 (0.444) data 0.300 (0.318) loss_u loss_u 0.9985 (0.9544) acc_u 0.0000 (5.0000) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [20/27] time 0.398 (0.444) data 0.268 (0.317) loss_u loss_u 0.9126 (0.9581) acc_u 12.5000 (4.6875) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [25/27] time 0.396 (0.438) data 0.269 (0.312) loss_u loss_u 0.9375 (0.9606) acc_u 6.2500 (4.3750) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.4632, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 756
clean true:741
clean false:15
clean_rate:0.9801587301587301
noisy true:650
noisy false:226
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 876
epoch [128/200] batch [5/23] time 0.360 (0.353) data 0.232 (0.226) loss_x loss_x 0.4924 (0.4561) acc_x 93.7500 (93.1250) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [10/23] time 0.471 (0.379) data 0.342 (0.252) loss_x loss_x 0.5176 (0.4250) acc_x 93.7500 (91.8750) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/23] time 0.435 (0.404) data 0.308 (0.277) loss_x loss_x 0.2729 (0.3662) acc_x 96.8750 (92.7083) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/23] time 0.433 (0.417) data 0.309 (0.289) loss_x loss_x 0.4087 (0.3745) acc_x 93.7500 (92.6562) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [5/27] time 0.367 (0.415) data 0.239 (0.288) loss_u loss_u 0.9380 (0.9792) acc_u 6.2500 (2.5000) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [10/27] time 0.403 (0.411) data 0.322 (0.285) loss_u loss_u 0.9683 (0.9678) acc_u 3.1250 (3.4375) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [15/27] time 0.425 (0.412) data 0.299 (0.286) loss_u loss_u 0.9551 (0.9646) acc_u 3.1250 (3.5417) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [20/27] time 0.402 (0.412) data 0.273 (0.286) loss_u loss_u 0.9673 (0.9624) acc_u 3.1250 (4.0625) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/27] time 0.388 (0.409) data 0.261 (0.282) loss_u loss_u 0.9995 (0.9620) acc_u 0.0000 (4.1250) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 275
confident_label rate tensor(0.4473, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 730
clean true:720
clean false:10
clean_rate:0.9863013698630136
noisy true:637
noisy false:265
after delete: len(clean_dataset) 730
after delete: len(noisy_dataset) 902
epoch [129/200] batch [5/22] time 0.448 (0.412) data 0.319 (0.284) loss_x loss_x 0.1514 (0.2751) acc_x 96.8750 (94.3750) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [10/22] time 0.424 (0.414) data 0.295 (0.287) loss_x loss_x 0.1471 (0.2496) acc_x 96.8750 (95.3125) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/22] time 0.418 (0.409) data 0.290 (0.285) loss_x loss_x 0.2878 (0.2812) acc_x 96.8750 (94.5833) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [20/22] time 0.417 (0.412) data 0.287 (0.287) loss_x loss_x 0.2434 (0.2939) acc_x 90.6250 (94.0625) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/28] time 0.438 (0.414) data 0.307 (0.289) loss_u loss_u 0.9077 (0.9422) acc_u 9.3750 (5.6250) lr 5.8849e-04 eta 0:00:09
epoch [129/200] batch [10/28] time 0.440 (0.418) data 0.309 (0.292) loss_u loss_u 0.9639 (0.9550) acc_u 6.2500 (5.0000) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [15/28] time 0.354 (0.414) data 0.276 (0.289) loss_u loss_u 0.9380 (0.9549) acc_u 6.2500 (5.2083) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [20/28] time 0.454 (0.417) data 0.324 (0.291) loss_u loss_u 0.9424 (0.9485) acc_u 6.2500 (5.9375) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [25/28] time 0.428 (0.418) data 0.302 (0.292) loss_u loss_u 0.9463 (0.9439) acc_u 6.2500 (6.6250) lr 5.8849e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:732
clean false:13
clean_rate:0.9825503355704698
noisy true:643
noisy false:244
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [130/200] batch [5/23] time 0.414 (0.423) data 0.287 (0.285) loss_x loss_x 0.1697 (0.2290) acc_x 100.0000 (96.8750) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [10/23] time 0.415 (0.424) data 0.290 (0.292) loss_x loss_x 0.1182 (0.1862) acc_x 96.8750 (97.1875) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [15/23] time 0.360 (0.422) data 0.233 (0.291) loss_x loss_x 0.2257 (0.2054) acc_x 96.8750 (96.6667) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/23] time 0.362 (0.406) data 0.230 (0.276) loss_x loss_x 0.3274 (0.2180) acc_x 90.6250 (95.7812) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [5/27] time 0.421 (0.409) data 0.294 (0.280) loss_u loss_u 0.8350 (0.9353) acc_u 18.7500 (6.8750) lr 5.7422e-04 eta 0:00:08
epoch [130/200] batch [10/27] time 0.435 (0.412) data 0.307 (0.284) loss_u loss_u 1.0000 (0.9582) acc_u 0.0000 (4.6875) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [15/27] time 0.387 (0.410) data 0.261 (0.282) loss_u loss_u 0.9717 (0.9528) acc_u 3.1250 (5.2083) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [20/27] time 0.416 (0.408) data 0.286 (0.279) loss_u loss_u 0.9717 (0.9571) acc_u 3.1250 (4.6875) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/27] time 0.356 (0.405) data 0.225 (0.276) loss_u loss_u 0.9072 (0.9526) acc_u 12.5000 (5.2500) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:735
clean false:12
clean_rate:0.9839357429718876
noisy true:656
noisy false:229
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [131/200] batch [5/23] time 0.427 (0.424) data 0.302 (0.296) loss_x loss_x 0.5005 (0.3813) acc_x 87.5000 (91.2500) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [10/23] time 0.422 (0.420) data 0.296 (0.293) loss_x loss_x 0.4773 (0.4304) acc_x 90.6250 (89.6875) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [15/23] time 0.415 (0.422) data 0.288 (0.295) loss_x loss_x 0.1527 (0.3699) acc_x 100.0000 (91.4583) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/23] time 0.418 (0.418) data 0.290 (0.291) loss_x loss_x 0.1677 (0.3412) acc_x 96.8750 (92.5000) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [5/27] time 0.408 (0.412) data 0.281 (0.286) loss_u loss_u 0.9971 (0.9586) acc_u 0.0000 (4.3750) lr 5.6006e-04 eta 0:00:09
epoch [131/200] batch [10/27] time 0.412 (0.410) data 0.282 (0.284) loss_u loss_u 0.9731 (0.9584) acc_u 3.1250 (4.3750) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [15/27] time 0.402 (0.409) data 0.275 (0.283) loss_u loss_u 0.9238 (0.9565) acc_u 9.3750 (4.7917) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [20/27] time 0.353 (0.406) data 0.227 (0.281) loss_u loss_u 0.9492 (0.9586) acc_u 6.2500 (4.5312) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/27] time 0.355 (0.401) data 0.229 (0.276) loss_u loss_u 0.9067 (0.9541) acc_u 9.3750 (5.0000) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:730
clean false:10
clean_rate:0.9864864864864865
noisy true:652
noisy false:240
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [132/200] batch [5/23] time 0.393 (0.423) data 0.269 (0.299) loss_x loss_x 0.0990 (0.2491) acc_x 100.0000 (97.5000) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [10/23] time 0.397 (0.411) data 0.270 (0.286) loss_x loss_x 0.4258 (0.3236) acc_x 87.5000 (93.4375) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [15/23] time 0.448 (0.415) data 0.321 (0.290) loss_x loss_x 0.2876 (0.3310) acc_x 90.6250 (92.7083) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/23] time 0.403 (0.414) data 0.274 (0.288) loss_x loss_x 0.1169 (0.3062) acc_x 100.0000 (93.1250) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [5/27] time 0.379 (0.411) data 0.251 (0.286) loss_u loss_u 0.9136 (0.9369) acc_u 9.3750 (6.8750) lr 5.4601e-04 eta 0:00:09
epoch [132/200] batch [10/27] time 0.422 (0.407) data 0.295 (0.281) loss_u loss_u 0.9751 (0.9482) acc_u 3.1250 (5.9375) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [15/27] time 0.409 (0.408) data 0.281 (0.283) loss_u loss_u 0.9619 (0.9534) acc_u 3.1250 (5.2083) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [20/27] time 0.428 (0.408) data 0.300 (0.283) loss_u loss_u 0.9995 (0.9562) acc_u 0.0000 (5.1562) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/27] time 0.400 (0.409) data 0.272 (0.283) loss_u loss_u 0.9570 (0.9531) acc_u 6.2500 (5.3750) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 276
confident_label rate tensor(0.4498, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 734
clean true:724
clean false:10
clean_rate:0.9863760217983651
noisy true:632
noisy false:266
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 898
epoch [133/200] batch [5/22] time 0.397 (0.430) data 0.272 (0.304) loss_x loss_x 0.4236 (0.2898) acc_x 93.7500 (95.0000) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [10/22] time 0.420 (0.399) data 0.295 (0.278) loss_x loss_x 0.3579 (0.2517) acc_x 93.7500 (95.3125) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/22] time 0.415 (0.406) data 0.289 (0.283) loss_x loss_x 0.2805 (0.2314) acc_x 93.7500 (95.8333) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/22] time 0.418 (0.410) data 0.290 (0.286) loss_x loss_x 0.5034 (0.2642) acc_x 87.5000 (94.8438) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/28] time 0.410 (0.413) data 0.280 (0.288) loss_u loss_u 0.9360 (0.9532) acc_u 6.2500 (5.0000) lr 5.3207e-04 eta 0:00:09
epoch [133/200] batch [10/28] time 0.433 (0.411) data 0.305 (0.287) loss_u loss_u 0.8823 (0.9420) acc_u 12.5000 (6.2500) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [15/28] time 0.374 (0.410) data 0.248 (0.285) loss_u loss_u 0.9858 (0.9491) acc_u 0.0000 (5.4167) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [20/28] time 0.408 (0.421) data 0.282 (0.296) loss_u loss_u 0.9673 (0.9509) acc_u 3.1250 (5.4688) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [25/28] time 0.361 (0.415) data 0.232 (0.290) loss_u loss_u 0.9307 (0.9510) acc_u 6.2500 (5.3750) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 265
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:728
clean false:14
clean_rate:0.9811320754716981
noisy true:639
noisy false:251
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [134/200] batch [5/23] time 0.394 (0.404) data 0.266 (0.287) loss_x loss_x 0.6499 (0.3833) acc_x 87.5000 (94.3750) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [10/23] time 0.450 (0.419) data 0.324 (0.298) loss_x loss_x 0.2112 (0.3216) acc_x 93.7500 (94.6875) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [15/23] time 0.475 (0.424) data 0.345 (0.301) loss_x loss_x 0.1069 (0.2858) acc_x 100.0000 (94.7917) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/23] time 0.397 (0.420) data 0.268 (0.294) loss_x loss_x 0.1827 (0.2827) acc_x 96.8750 (94.3750) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [5/27] time 0.392 (0.412) data 0.264 (0.286) loss_u loss_u 0.9771 (0.9620) acc_u 3.1250 (4.3750) lr 5.1825e-04 eta 0:00:09
epoch [134/200] batch [10/27] time 0.439 (0.412) data 0.311 (0.285) loss_u loss_u 0.9370 (0.9472) acc_u 6.2500 (6.5625) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [15/27] time 0.434 (0.423) data 0.304 (0.298) loss_u loss_u 0.9990 (0.9577) acc_u 0.0000 (5.2083) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [20/27] time 0.429 (0.418) data 0.296 (0.293) loss_u loss_u 0.9507 (0.9556) acc_u 6.2500 (5.4688) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/27] time 0.362 (0.415) data 0.233 (0.290) loss_u loss_u 0.9878 (0.9558) acc_u 3.1250 (5.3750) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 255
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:730
clean false:9
clean_rate:0.9878213802435724
noisy true:647
noisy false:246
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [135/200] batch [5/23] time 0.397 (0.403) data 0.274 (0.277) loss_x loss_x 0.2744 (0.2484) acc_x 96.8750 (95.6250) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [10/23] time 0.414 (0.408) data 0.290 (0.283) loss_x loss_x 0.3005 (0.2323) acc_x 90.6250 (95.6250) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [15/23] time 0.414 (0.412) data 0.286 (0.286) loss_x loss_x 0.2017 (0.2470) acc_x 96.8750 (95.4167) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/23] time 0.365 (0.402) data 0.240 (0.279) loss_x loss_x 0.1852 (0.2630) acc_x 93.7500 (95.0000) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [5/27] time 0.418 (0.398) data 0.289 (0.272) loss_u loss_u 0.9761 (0.9712) acc_u 3.1250 (3.7500) lr 5.0454e-04 eta 0:00:08
epoch [135/200] batch [10/27] time 0.400 (0.400) data 0.271 (0.274) loss_u loss_u 0.9712 (0.9610) acc_u 3.1250 (5.0000) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [15/27] time 0.403 (0.400) data 0.278 (0.275) loss_u loss_u 0.8838 (0.9513) acc_u 12.5000 (5.8333) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [20/27] time 0.412 (0.402) data 0.286 (0.276) loss_u loss_u 0.9995 (0.9543) acc_u 0.0000 (5.6250) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/27] time 0.415 (0.403) data 0.289 (0.278) loss_u loss_u 0.9946 (0.9554) acc_u 0.0000 (5.2500) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 236
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:737
clean false:9
clean_rate:0.9879356568364611
noisy true:659
noisy false:227
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [136/200] batch [5/23] time 0.362 (0.367) data 0.238 (0.241) loss_x loss_x 0.4736 (0.2923) acc_x 90.6250 (94.3750) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [10/23] time 0.455 (0.412) data 0.328 (0.286) loss_x loss_x 0.3035 (0.2991) acc_x 93.7500 (94.3750) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [15/23] time 0.418 (0.419) data 0.290 (0.294) loss_x loss_x 0.1401 (0.2975) acc_x 100.0000 (93.9583) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/23] time 0.450 (0.425) data 0.323 (0.299) loss_x loss_x 0.1170 (0.2862) acc_x 100.0000 (94.5312) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [5/27] time 0.454 (0.431) data 0.325 (0.304) loss_u loss_u 0.9980 (0.9734) acc_u 0.0000 (3.1250) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [10/27] time 0.426 (0.430) data 0.296 (0.305) loss_u loss_u 0.9775 (0.9717) acc_u 3.1250 (3.4375) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [15/27] time 0.369 (0.429) data 0.238 (0.303) loss_u loss_u 0.9409 (0.9645) acc_u 6.2500 (3.7500) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [20/27] time 0.430 (0.424) data 0.300 (0.298) loss_u loss_u 0.9282 (0.9566) acc_u 9.3750 (4.8438) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/27] time 0.409 (0.423) data 0.279 (0.296) loss_u loss_u 0.9990 (0.9555) acc_u 0.0000 (5.0000) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 225
confident_label rate tensor(0.4632, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 756
clean true:746
clean false:10
clean_rate:0.9867724867724867
noisy true:661
noisy false:215
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 876
epoch [137/200] batch [5/23] time 0.398 (0.417) data 0.270 (0.289) loss_x loss_x 0.2350 (0.3340) acc_x 93.7500 (91.2500) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [10/23] time 0.395 (0.405) data 0.268 (0.277) loss_x loss_x 0.1437 (0.2758) acc_x 96.8750 (93.4375) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [15/23] time 0.411 (0.408) data 0.287 (0.284) loss_x loss_x 0.8608 (0.3246) acc_x 84.3750 (92.9167) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/23] time 0.385 (0.404) data 0.258 (0.280) loss_x loss_x 0.1840 (0.3331) acc_x 96.8750 (92.8125) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [5/27] time 0.487 (0.420) data 0.359 (0.296) loss_u loss_u 0.9468 (0.9661) acc_u 9.3750 (4.3750) lr 4.7750e-04 eta 0:00:09
epoch [137/200] batch [10/27] time 0.365 (0.417) data 0.236 (0.292) loss_u loss_u 0.9985 (0.9613) acc_u 0.0000 (4.6875) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [15/27] time 0.350 (0.410) data 0.221 (0.285) loss_u loss_u 0.9751 (0.9564) acc_u 3.1250 (5.0000) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [20/27] time 0.466 (0.411) data 0.338 (0.286) loss_u loss_u 0.9639 (0.9572) acc_u 6.2500 (5.1562) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/27] time 0.412 (0.413) data 0.283 (0.289) loss_u loss_u 0.9932 (0.9576) acc_u 0.0000 (5.1250) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:733
clean false:12
clean_rate:0.9838926174496644
noisy true:645
noisy false:242
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [138/200] batch [5/23] time 0.567 (0.467) data 0.441 (0.341) loss_x loss_x 0.3398 (0.2508) acc_x 96.8750 (95.0000) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [10/23] time 0.343 (0.473) data 0.265 (0.352) loss_x loss_x 0.3354 (0.2711) acc_x 90.6250 (94.3750) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [15/23] time 0.449 (0.453) data 0.322 (0.329) loss_x loss_x 0.3181 (0.2818) acc_x 93.7500 (94.1667) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/23] time 0.439 (0.461) data 0.314 (0.336) loss_x loss_x 0.2291 (0.2764) acc_x 93.7500 (93.7500) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [5/27] time 0.398 (0.436) data 0.261 (0.312) loss_u loss_u 0.9785 (0.9413) acc_u 3.1250 (6.2500) lr 4.6417e-04 eta 0:00:09
epoch [138/200] batch [10/27] time 0.415 (0.439) data 0.286 (0.314) loss_u loss_u 0.9702 (0.9501) acc_u 3.1250 (5.3125) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [15/27] time 0.419 (0.440) data 0.290 (0.314) loss_u loss_u 0.8496 (0.9412) acc_u 15.6250 (6.6667) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [20/27] time 0.508 (0.443) data 0.362 (0.317) loss_u loss_u 0.9502 (0.9486) acc_u 6.2500 (5.9375) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [25/27] time 0.386 (0.437) data 0.259 (0.311) loss_u loss_u 0.9971 (0.9527) acc_u 0.0000 (5.5000) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:735
clean false:9
clean_rate:0.9879032258064516
noisy true:646
noisy false:242
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [139/200] batch [5/23] time 0.357 (0.377) data 0.228 (0.248) loss_x loss_x 0.1836 (0.2765) acc_x 96.8750 (93.1250) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [10/23] time 0.391 (0.388) data 0.264 (0.260) loss_x loss_x 0.2876 (0.2673) acc_x 96.8750 (93.7500) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [15/23] time 0.435 (0.390) data 0.310 (0.263) loss_x loss_x 0.3171 (0.2842) acc_x 96.8750 (93.7500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/23] time 0.414 (0.402) data 0.286 (0.277) loss_x loss_x 0.2561 (0.2610) acc_x 96.8750 (94.6875) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [5/27] time 0.396 (0.405) data 0.268 (0.280) loss_u loss_u 0.9771 (0.9764) acc_u 3.1250 (3.1250) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [10/27] time 0.433 (0.408) data 0.304 (0.284) loss_u loss_u 0.9482 (0.9497) acc_u 6.2500 (5.9375) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [15/27] time 0.457 (0.416) data 0.329 (0.291) loss_u loss_u 0.9404 (0.9483) acc_u 6.2500 (6.2500) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [20/27] time 0.425 (0.418) data 0.298 (0.293) loss_u loss_u 0.9756 (0.9544) acc_u 3.1250 (5.4688) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/27] time 0.442 (0.420) data 0.316 (0.295) loss_u loss_u 0.9619 (0.9568) acc_u 3.1250 (5.1250) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 229
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:743
clean false:10
clean_rate:0.9867197875166003
noisy true:660
noisy false:219
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [140/200] batch [5/23] time 0.444 (0.430) data 0.297 (0.299) loss_x loss_x 0.3977 (0.2296) acc_x 84.3750 (95.0000) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [10/23] time 0.469 (0.428) data 0.342 (0.299) loss_x loss_x 0.2588 (0.2354) acc_x 96.8750 (95.3125) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [15/23] time 0.406 (0.422) data 0.279 (0.295) loss_x loss_x 0.2952 (0.2547) acc_x 96.8750 (95.2083) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/23] time 0.445 (0.423) data 0.319 (0.295) loss_x loss_x 0.2551 (0.2700) acc_x 93.7500 (94.8438) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [5/27] time 0.467 (0.428) data 0.335 (0.300) loss_u loss_u 0.9688 (0.9528) acc_u 3.1250 (5.0000) lr 4.3792e-04 eta 0:00:09
epoch [140/200] batch [10/27] time 0.351 (0.421) data 0.218 (0.293) loss_u loss_u 0.9736 (0.9500) acc_u 3.1250 (5.3125) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [15/27] time 0.470 (0.419) data 0.343 (0.291) loss_u loss_u 0.9404 (0.9497) acc_u 6.2500 (5.2083) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [20/27] time 0.459 (0.425) data 0.333 (0.297) loss_u loss_u 0.9673 (0.9560) acc_u 3.1250 (4.6875) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/27] time 0.492 (0.428) data 0.365 (0.300) loss_u loss_u 0.9707 (0.9536) acc_u 3.1250 (5.1250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 240
confident_label rate tensor(0.4540, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 741
clean true:730
clean false:11
clean_rate:0.9851551956815114
noisy true:662
noisy false:229
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 891
epoch [141/200] batch [5/23] time 0.448 (0.441) data 0.318 (0.322) loss_x loss_x 0.2460 (0.5406) acc_x 96.8750 (87.5000) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [10/23] time 0.483 (0.442) data 0.356 (0.318) loss_x loss_x 0.1935 (0.4143) acc_x 93.7500 (90.0000) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [15/23] time 0.400 (0.428) data 0.273 (0.303) loss_x loss_x 0.1244 (0.3401) acc_x 96.8750 (92.0833) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/23] time 0.444 (0.429) data 0.319 (0.303) loss_x loss_x 0.2664 (0.3316) acc_x 90.6250 (92.0312) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [5/27] time 0.436 (0.430) data 0.305 (0.305) loss_u loss_u 0.9697 (0.9558) acc_u 3.1250 (4.3750) lr 4.2499e-04 eta 0:00:09
epoch [141/200] batch [10/27] time 0.395 (0.428) data 0.267 (0.303) loss_u loss_u 0.9292 (0.9556) acc_u 9.3750 (4.6875) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [15/27] time 0.452 (0.424) data 0.306 (0.299) loss_u loss_u 0.9438 (0.9502) acc_u 6.2500 (5.2083) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [20/27] time 0.409 (0.425) data 0.277 (0.300) loss_u loss_u 0.9448 (0.9495) acc_u 6.2500 (5.4688) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/27] time 0.395 (0.423) data 0.268 (0.298) loss_u loss_u 0.9883 (0.9536) acc_u 0.0000 (5.0000) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:736
clean false:9
clean_rate:0.9879194630872483
noisy true:653
noisy false:234
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [142/200] batch [5/23] time 0.427 (0.376) data 0.301 (0.249) loss_x loss_x 0.3088 (0.2192) acc_x 93.7500 (96.2500) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [10/23] time 0.424 (0.391) data 0.296 (0.264) loss_x loss_x 0.0966 (0.2643) acc_x 100.0000 (94.6875) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [15/23] time 0.405 (0.393) data 0.279 (0.269) loss_x loss_x 0.2512 (0.2811) acc_x 93.7500 (94.3750) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/23] time 0.401 (0.394) data 0.274 (0.269) loss_x loss_x 0.1105 (0.2730) acc_x 100.0000 (94.0625) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [5/27] time 0.416 (0.395) data 0.284 (0.271) loss_u loss_u 0.9194 (0.9505) acc_u 9.3750 (5.6250) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [10/27] time 0.396 (0.397) data 0.269 (0.272) loss_u loss_u 0.9863 (0.9469) acc_u 3.1250 (6.2500) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [15/27] time 0.431 (0.399) data 0.301 (0.273) loss_u loss_u 0.9688 (0.9543) acc_u 3.1250 (5.2083) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [20/27] time 0.423 (0.402) data 0.293 (0.277) loss_u loss_u 0.9541 (0.9525) acc_u 6.2500 (5.6250) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/27] time 0.387 (0.402) data 0.258 (0.276) loss_u loss_u 0.9673 (0.9517) acc_u 3.1250 (5.6250) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:736
clean false:7
clean_rate:0.990578734858681
noisy true:630
noisy false:259
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [143/200] batch [5/23] time 0.399 (0.433) data 0.275 (0.306) loss_x loss_x 0.3357 (0.2114) acc_x 90.6250 (95.6250) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [10/23] time 0.452 (0.426) data 0.326 (0.299) loss_x loss_x 0.4832 (0.2558) acc_x 84.3750 (94.0625) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [15/23] time 0.405 (0.426) data 0.277 (0.299) loss_x loss_x 0.3835 (0.3134) acc_x 93.7500 (92.7083) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/23] time 0.472 (0.430) data 0.346 (0.303) loss_x loss_x 0.3669 (0.3460) acc_x 93.7500 (91.7188) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [5/27] time 0.425 (0.412) data 0.298 (0.286) loss_u loss_u 0.8833 (0.9390) acc_u 12.5000 (6.8750) lr 3.9958e-04 eta 0:00:09
epoch [143/200] batch [10/27] time 0.441 (0.415) data 0.311 (0.289) loss_u loss_u 0.9678 (0.9453) acc_u 3.1250 (6.2500) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [15/27] time 0.400 (0.415) data 0.271 (0.289) loss_u loss_u 0.9580 (0.9523) acc_u 6.2500 (5.4167) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [20/27] time 0.375 (0.414) data 0.297 (0.289) loss_u loss_u 0.9346 (0.9534) acc_u 6.2500 (5.1562) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/27] time 0.392 (0.414) data 0.264 (0.288) loss_u loss_u 0.9644 (0.9544) acc_u 3.1250 (5.2500) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.4516, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 737
clean true:727
clean false:10
clean_rate:0.9864314789687924
noisy true:656
noisy false:239
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 895
epoch [144/200] batch [5/23] time 0.348 (0.384) data 0.221 (0.256) loss_x loss_x 0.2632 (0.3474) acc_x 93.7500 (94.3750) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [10/23] time 0.494 (0.396) data 0.368 (0.272) loss_x loss_x 0.6113 (0.3696) acc_x 90.6250 (91.8750) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [15/23] time 0.437 (0.412) data 0.309 (0.287) loss_x loss_x 0.1586 (0.3563) acc_x 96.8750 (92.2917) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/23] time 0.396 (0.419) data 0.270 (0.294) loss_x loss_x 0.2561 (0.3250) acc_x 93.7500 (93.1250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [5/27] time 0.482 (0.424) data 0.353 (0.298) loss_u loss_u 0.9834 (0.9608) acc_u 3.1250 (3.7500) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [10/27] time 0.403 (0.425) data 0.275 (0.300) loss_u loss_u 0.9551 (0.9568) acc_u 6.2500 (4.3750) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [15/27] time 0.408 (0.422) data 0.277 (0.296) loss_u loss_u 0.9707 (0.9538) acc_u 3.1250 (4.5833) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [20/27] time 0.427 (0.421) data 0.299 (0.295) loss_u loss_u 0.8730 (0.9491) acc_u 15.6250 (5.3125) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/27] time 0.450 (0.422) data 0.319 (0.296) loss_u loss_u 0.9448 (0.9499) acc_u 9.3750 (5.3750) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 233
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:736
clean false:12
clean_rate:0.983957219251337
noisy true:663
noisy false:221
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [145/200] batch [5/23] time 0.403 (0.404) data 0.277 (0.278) loss_x loss_x 0.2886 (0.2678) acc_x 90.6250 (93.7500) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [10/23] time 0.352 (0.400) data 0.274 (0.278) loss_x loss_x 0.1359 (0.2644) acc_x 100.0000 (93.1250) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [15/23] time 0.413 (0.406) data 0.288 (0.283) loss_x loss_x 0.2539 (0.2814) acc_x 93.7500 (93.1250) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/23] time 0.411 (0.406) data 0.286 (0.282) loss_x loss_x 0.1694 (0.2849) acc_x 96.8750 (92.8125) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [5/27] time 0.463 (0.414) data 0.336 (0.290) loss_u loss_u 0.9746 (0.9881) acc_u 3.1250 (1.8750) lr 3.7476e-04 eta 0:00:09
epoch [145/200] batch [10/27] time 0.353 (0.408) data 0.221 (0.282) loss_u loss_u 0.9653 (0.9719) acc_u 3.1250 (3.7500) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [15/27] time 0.466 (0.413) data 0.337 (0.287) loss_u loss_u 0.9590 (0.9641) acc_u 6.2500 (4.5833) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [20/27] time 0.448 (0.416) data 0.322 (0.291) loss_u loss_u 0.9927 (0.9579) acc_u 0.0000 (5.0000) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/27] time 0.421 (0.420) data 0.292 (0.294) loss_u loss_u 0.9092 (0.9533) acc_u 9.3750 (5.3750) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 758
clean true:743
clean false:15
clean_rate:0.9802110817941952
noisy true:648
noisy false:226
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 874
epoch [146/200] batch [5/23] time 0.386 (0.409) data 0.258 (0.281) loss_x loss_x 0.1252 (0.2936) acc_x 96.8750 (93.1250) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [10/23] time 0.479 (0.418) data 0.352 (0.289) loss_x loss_x 0.2688 (0.2591) acc_x 100.0000 (95.3125) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [15/23] time 0.395 (0.399) data 0.240 (0.272) loss_x loss_x 0.1965 (0.2587) acc_x 96.8750 (95.6250) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/23] time 0.456 (0.416) data 0.330 (0.289) loss_x loss_x 0.6226 (0.2709) acc_x 87.5000 (94.6875) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [5/27] time 0.483 (0.424) data 0.355 (0.297) loss_u loss_u 0.9395 (0.9604) acc_u 6.2500 (4.3750) lr 3.6258e-04 eta 0:00:09
epoch [146/200] batch [10/27] time 0.430 (0.428) data 0.301 (0.301) loss_u loss_u 0.9995 (0.9639) acc_u 0.0000 (4.0625) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [15/27] time 0.408 (0.424) data 0.282 (0.297) loss_u loss_u 0.9170 (0.9554) acc_u 9.3750 (5.2083) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [20/27] time 0.414 (0.424) data 0.286 (0.298) loss_u loss_u 0.9497 (0.9593) acc_u 6.2500 (4.6875) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/27] time 0.436 (0.424) data 0.306 (0.298) loss_u loss_u 0.9692 (0.9601) acc_u 3.1250 (4.3750) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 245
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:727
clean false:13
clean_rate:0.9824324324324324
noisy true:660
noisy false:232
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [147/200] batch [5/23] time 0.428 (0.417) data 0.300 (0.289) loss_x loss_x 0.2140 (0.2248) acc_x 93.7500 (93.7500) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [10/23] time 0.408 (0.414) data 0.281 (0.287) loss_x loss_x 0.2859 (0.2370) acc_x 93.7500 (94.3750) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [15/23] time 0.403 (0.421) data 0.274 (0.293) loss_x loss_x 0.2217 (0.2601) acc_x 93.7500 (94.5833) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/23] time 0.406 (0.417) data 0.278 (0.289) loss_x loss_x 0.2952 (0.2667) acc_x 96.8750 (94.2188) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [5/27] time 0.400 (0.417) data 0.273 (0.289) loss_u loss_u 0.9287 (0.9559) acc_u 9.3750 (6.2500) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [10/27] time 0.392 (0.416) data 0.262 (0.288) loss_u loss_u 0.9014 (0.9521) acc_u 12.5000 (5.9375) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [15/27] time 0.421 (0.418) data 0.292 (0.290) loss_u loss_u 0.9863 (0.9622) acc_u 3.1250 (5.0000) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [20/27] time 0.425 (0.417) data 0.297 (0.288) loss_u loss_u 0.9209 (0.9504) acc_u 9.3750 (6.2500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/27] time 0.393 (0.415) data 0.264 (0.288) loss_u loss_u 0.9106 (0.9464) acc_u 12.5000 (6.6250) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:734
clean false:12
clean_rate:0.9839142091152815
noisy true:649
noisy false:237
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [148/200] batch [5/23] time 0.405 (0.415) data 0.281 (0.290) loss_x loss_x 0.3628 (0.2285) acc_x 90.6250 (96.8750) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [10/23] time 0.373 (0.409) data 0.246 (0.284) loss_x loss_x 0.1495 (0.2657) acc_x 96.8750 (95.0000) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [15/23] time 0.414 (0.395) data 0.285 (0.272) loss_x loss_x 0.3772 (0.2756) acc_x 96.8750 (95.2083) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/23] time 0.406 (0.398) data 0.279 (0.274) loss_x loss_x 0.1549 (0.2734) acc_x 96.8750 (94.8438) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [5/27] time 0.395 (0.401) data 0.263 (0.275) loss_u loss_u 0.9746 (0.9621) acc_u 3.1250 (4.3750) lr 3.3869e-04 eta 0:00:08
epoch [148/200] batch [10/27] time 0.413 (0.402) data 0.285 (0.276) loss_u loss_u 0.9614 (0.9634) acc_u 3.1250 (4.0625) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [15/27] time 0.389 (0.400) data 0.262 (0.276) loss_u loss_u 0.9678 (0.9680) acc_u 3.1250 (3.5417) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [20/27] time 0.382 (0.400) data 0.256 (0.276) loss_u loss_u 0.8662 (0.9549) acc_u 18.7500 (5.1562) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/27] time 0.378 (0.401) data 0.249 (0.276) loss_u loss_u 0.9717 (0.9547) acc_u 3.1250 (5.2500) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:730
clean false:10
clean_rate:0.9864864864864865
noisy true:661
noisy false:231
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [149/200] batch [5/23] time 0.346 (0.382) data 0.268 (0.265) loss_x loss_x 0.5186 (0.3293) acc_x 87.5000 (93.1250) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [10/23] time 0.427 (0.398) data 0.299 (0.276) loss_x loss_x 0.2321 (0.3428) acc_x 96.8750 (93.1250) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [15/23] time 0.427 (0.403) data 0.301 (0.279) loss_x loss_x 0.3179 (0.3396) acc_x 90.6250 (92.7083) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/23] time 0.405 (0.409) data 0.277 (0.285) loss_x loss_x 0.3833 (0.3198) acc_x 93.7500 (92.9688) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [5/27] time 0.403 (0.411) data 0.273 (0.287) loss_u loss_u 0.9341 (0.9338) acc_u 6.2500 (7.5000) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [10/27] time 0.417 (0.413) data 0.291 (0.288) loss_u loss_u 0.9639 (0.9398) acc_u 3.1250 (7.1875) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [15/27] time 0.385 (0.411) data 0.256 (0.286) loss_u loss_u 0.9653 (0.9442) acc_u 3.1250 (6.4583) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [20/27] time 0.386 (0.408) data 0.257 (0.283) loss_u loss_u 0.9849 (0.9499) acc_u 3.1250 (5.7812) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/27] time 0.474 (0.406) data 0.347 (0.280) loss_u loss_u 0.9766 (0.9493) acc_u 3.1250 (5.8750) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4596, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 750
clean true:737
clean false:13
clean_rate:0.9826666666666667
noisy true:643
noisy false:239
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 882
epoch [150/200] batch [5/23] time 0.388 (0.411) data 0.262 (0.284) loss_x loss_x 0.1948 (0.2205) acc_x 96.8750 (97.5000) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [10/23] time 0.405 (0.405) data 0.280 (0.279) loss_x loss_x 0.1324 (0.2041) acc_x 96.8750 (96.5625) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [15/23] time 0.438 (0.411) data 0.315 (0.285) loss_x loss_x 0.1116 (0.2316) acc_x 100.0000 (95.8333) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/23] time 0.434 (0.413) data 0.308 (0.289) loss_x loss_x 0.1107 (0.2549) acc_x 100.0000 (95.1562) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [5/27] time 0.385 (0.411) data 0.257 (0.286) loss_u loss_u 0.9365 (0.9680) acc_u 6.2500 (3.1250) lr 3.1545e-04 eta 0:00:09
epoch [150/200] batch [10/27] time 0.451 (0.410) data 0.320 (0.284) loss_u loss_u 0.9741 (0.9560) acc_u 3.1250 (5.0000) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [15/27] time 0.482 (0.419) data 0.347 (0.292) loss_u loss_u 0.9673 (0.9571) acc_u 3.1250 (5.0000) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [20/27] time 0.433 (0.421) data 0.304 (0.294) loss_u loss_u 0.9531 (0.9548) acc_u 9.3750 (5.4688) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/27] time 0.465 (0.424) data 0.334 (0.296) loss_u loss_u 0.9160 (0.9567) acc_u 9.3750 (5.3750) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 270
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:725
clean false:15
clean_rate:0.9797297297297297
noisy true:637
noisy false:255
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [151/200] batch [5/23] time 0.438 (0.475) data 0.310 (0.346) loss_x loss_x 0.2349 (0.2519) acc_x 96.8750 (94.3750) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [10/23] time 0.362 (0.425) data 0.233 (0.297) loss_x loss_x 0.1345 (0.2474) acc_x 100.0000 (95.0000) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [15/23] time 0.438 (0.424) data 0.312 (0.297) loss_x loss_x 0.2410 (0.2561) acc_x 96.8750 (95.0000) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/23] time 0.403 (0.421) data 0.278 (0.294) loss_x loss_x 0.5923 (0.2644) acc_x 87.5000 (95.0000) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [5/27] time 0.405 (0.419) data 0.277 (0.292) loss_u loss_u 0.9448 (0.9541) acc_u 6.2500 (5.6250) lr 3.0409e-04 eta 0:00:09
epoch [151/200] batch [10/27] time 0.394 (0.419) data 0.266 (0.291) loss_u loss_u 0.9697 (0.9489) acc_u 3.1250 (5.9375) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [15/27] time 0.397 (0.416) data 0.271 (0.290) loss_u loss_u 0.8726 (0.9423) acc_u 15.6250 (6.6667) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [20/27] time 0.403 (0.416) data 0.275 (0.289) loss_u loss_u 0.9976 (0.9506) acc_u 0.0000 (5.6250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/27] time 0.414 (0.416) data 0.285 (0.290) loss_u loss_u 0.9092 (0.9476) acc_u 9.3750 (6.0000) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.4479, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 731
clean true:718
clean false:13
clean_rate:0.9822161422708618
noisy true:648
noisy false:253
after delete: len(clean_dataset) 731
after delete: len(noisy_dataset) 901
epoch [152/200] batch [5/22] time 0.382 (0.399) data 0.254 (0.271) loss_x loss_x 0.7090 (0.3083) acc_x 81.2500 (94.3750) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [10/22] time 0.406 (0.408) data 0.278 (0.279) loss_x loss_x 0.1853 (0.2888) acc_x 96.8750 (94.6875) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/22] time 0.421 (0.412) data 0.291 (0.283) loss_x loss_x 0.5308 (0.3306) acc_x 90.6250 (92.2917) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/22] time 0.400 (0.413) data 0.277 (0.287) loss_x loss_x 0.3220 (0.3308) acc_x 93.7500 (92.5000) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/28] time 0.434 (0.414) data 0.305 (0.287) loss_u loss_u 0.9277 (0.9231) acc_u 9.3750 (9.3750) lr 2.9289e-04 eta 0:00:09
epoch [152/200] batch [10/28] time 0.417 (0.414) data 0.287 (0.287) loss_u loss_u 0.9170 (0.9308) acc_u 9.3750 (8.1250) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [15/28] time 0.399 (0.413) data 0.264 (0.286) loss_u loss_u 0.9390 (0.9333) acc_u 6.2500 (7.7083) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [20/28] time 0.371 (0.407) data 0.244 (0.280) loss_u loss_u 0.9702 (0.9372) acc_u 3.1250 (7.0312) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [25/28] time 0.406 (0.408) data 0.278 (0.280) loss_u loss_u 0.9141 (0.9354) acc_u 9.3750 (7.2500) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 274
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:729
clean false:13
clean_rate:0.9824797843665768
noisy true:629
noisy false:261
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [153/200] batch [5/23] time 0.401 (0.407) data 0.272 (0.280) loss_x loss_x 0.2404 (0.2932) acc_x 93.7500 (94.3750) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [10/23] time 0.448 (0.413) data 0.317 (0.285) loss_x loss_x 0.2913 (0.2894) acc_x 90.6250 (93.1250) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [15/23] time 0.428 (0.416) data 0.303 (0.292) loss_x loss_x 0.4607 (0.3197) acc_x 84.3750 (91.8750) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/23] time 0.352 (0.407) data 0.225 (0.283) loss_x loss_x 0.3032 (0.3035) acc_x 96.8750 (92.5000) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [5/27] time 0.395 (0.401) data 0.263 (0.275) loss_u loss_u 0.8281 (0.9312) acc_u 18.7500 (8.1250) lr 2.8187e-04 eta 0:00:08
epoch [153/200] batch [10/27] time 0.405 (0.402) data 0.279 (0.276) loss_u loss_u 0.9712 (0.9413) acc_u 6.2500 (7.1875) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [15/27] time 0.434 (0.404) data 0.284 (0.278) loss_u loss_u 0.9409 (0.9465) acc_u 6.2500 (6.4583) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [20/27] time 0.408 (0.406) data 0.280 (0.280) loss_u loss_u 0.9790 (0.9516) acc_u 3.1250 (5.7812) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/27] time 0.410 (0.407) data 0.285 (0.280) loss_u loss_u 0.9058 (0.9441) acc_u 12.5000 (6.6250) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.4675, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 763
clean true:751
clean false:12
clean_rate:0.9842726081258192
noisy true:649
noisy false:220
after delete: len(clean_dataset) 763
after delete: len(noisy_dataset) 869
epoch [154/200] batch [5/23] time 0.387 (0.403) data 0.261 (0.276) loss_x loss_x 0.3955 (0.3780) acc_x 90.6250 (89.3750) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [10/23] time 0.394 (0.393) data 0.267 (0.270) loss_x loss_x 0.4551 (0.3548) acc_x 87.5000 (90.6250) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [15/23] time 0.412 (0.400) data 0.285 (0.276) loss_x loss_x 0.3875 (0.3356) acc_x 90.6250 (91.2500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/23] time 0.412 (0.405) data 0.287 (0.280) loss_x loss_x 0.5386 (0.3213) acc_x 87.5000 (92.0312) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [5/27] time 0.413 (0.406) data 0.284 (0.282) loss_u loss_u 0.9736 (0.9781) acc_u 3.1250 (2.5000) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [10/27] time 0.404 (0.408) data 0.278 (0.283) loss_u loss_u 0.9995 (0.9703) acc_u 0.0000 (3.4375) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [15/27] time 0.409 (0.408) data 0.283 (0.283) loss_u loss_u 0.9365 (0.9707) acc_u 6.2500 (3.3333) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [20/27] time 0.414 (0.411) data 0.286 (0.285) loss_u loss_u 0.9771 (0.9692) acc_u 3.1250 (3.4375) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/27] time 0.408 (0.412) data 0.289 (0.286) loss_u loss_u 0.9702 (0.9682) acc_u 3.1250 (3.7500) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:734
clean false:9
clean_rate:0.9878869448183042
noisy true:651
noisy false:238
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [155/200] batch [5/23] time 0.399 (0.415) data 0.273 (0.288) loss_x loss_x 0.1036 (0.2033) acc_x 96.8750 (95.6250) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [10/23] time 0.432 (0.410) data 0.306 (0.288) loss_x loss_x 0.3613 (0.2655) acc_x 96.8750 (95.0000) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [15/23] time 0.417 (0.413) data 0.291 (0.290) loss_x loss_x 0.3394 (0.2709) acc_x 90.6250 (94.3750) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/23] time 0.392 (0.412) data 0.264 (0.288) loss_x loss_x 0.1870 (0.2520) acc_x 93.7500 (94.8438) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [5/27] time 0.410 (0.413) data 0.282 (0.288) loss_u loss_u 0.9102 (0.9540) acc_u 9.3750 (5.0000) lr 2.6037e-04 eta 0:00:09
epoch [155/200] batch [10/27] time 0.430 (0.413) data 0.303 (0.289) loss_u loss_u 0.8784 (0.9322) acc_u 12.5000 (7.5000) lr 2.6037e-04 eta 0:00:07
epoch [155/200] batch [15/27] time 0.396 (0.412) data 0.268 (0.288) loss_u loss_u 0.9678 (0.9456) acc_u 3.1250 (5.8333) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [20/27] time 0.448 (0.411) data 0.318 (0.285) loss_u loss_u 0.9800 (0.9448) acc_u 3.1250 (5.9375) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/27] time 0.423 (0.412) data 0.295 (0.286) loss_u loss_u 0.9746 (0.9514) acc_u 3.1250 (5.2500) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 241
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:734
clean false:11
clean_rate:0.9852348993288591
noisy true:657
noisy false:230
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [156/200] batch [5/23] time 0.405 (0.407) data 0.279 (0.281) loss_x loss_x 0.6646 (0.3277) acc_x 93.7500 (93.1250) lr 2.4989e-04 eta 0:00:07
epoch [156/200] batch [10/23] time 0.392 (0.405) data 0.265 (0.278) loss_x loss_x 0.4517 (0.2989) acc_x 84.3750 (93.4375) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [15/23] time 0.421 (0.404) data 0.295 (0.279) loss_x loss_x 0.1542 (0.2661) acc_x 100.0000 (94.5833) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/23] time 0.433 (0.411) data 0.306 (0.286) loss_x loss_x 0.5176 (0.2870) acc_x 87.5000 (93.9062) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [5/27] time 0.358 (0.406) data 0.231 (0.280) loss_u loss_u 1.0000 (0.9661) acc_u 0.0000 (3.1250) lr 2.4989e-04 eta 0:00:08
epoch [156/200] batch [10/27] time 0.351 (0.406) data 0.272 (0.281) loss_u loss_u 0.9893 (0.9649) acc_u 3.1250 (3.4375) lr 2.4989e-04 eta 0:00:06
epoch [156/200] batch [15/27] time 0.455 (0.409) data 0.329 (0.283) loss_u loss_u 0.9639 (0.9579) acc_u 6.2500 (4.5833) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [20/27] time 0.423 (0.410) data 0.295 (0.284) loss_u loss_u 0.9961 (0.9589) acc_u 0.0000 (4.5312) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/27] time 0.411 (0.412) data 0.284 (0.286) loss_u loss_u 0.9678 (0.9510) acc_u 6.2500 (5.7500) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 243
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 758
clean true:746
clean false:12
clean_rate:0.9841688654353562
noisy true:643
noisy false:231
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 874
epoch [157/200] batch [5/23] time 0.429 (0.423) data 0.303 (0.298) loss_x loss_x 0.3755 (0.2613) acc_x 93.7500 (95.0000) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [10/23] time 0.398 (0.410) data 0.270 (0.285) loss_x loss_x 0.5630 (0.2800) acc_x 87.5000 (94.3750) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [15/23] time 0.451 (0.418) data 0.324 (0.293) loss_x loss_x 0.3235 (0.2591) acc_x 90.6250 (95.2083) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/23] time 0.433 (0.420) data 0.302 (0.294) loss_x loss_x 0.2399 (0.2582) acc_x 96.8750 (95.1562) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [5/27] time 0.430 (0.424) data 0.300 (0.297) loss_u loss_u 0.9404 (0.9574) acc_u 9.3750 (5.6250) lr 2.3959e-04 eta 0:00:09
epoch [157/200] batch [10/27] time 0.420 (0.422) data 0.292 (0.296) loss_u loss_u 0.9688 (0.9605) acc_u 3.1250 (5.0000) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [15/27] time 0.409 (0.424) data 0.281 (0.298) loss_u loss_u 0.9941 (0.9604) acc_u 0.0000 (5.0000) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [20/27] time 0.404 (0.422) data 0.274 (0.295) loss_u loss_u 0.9971 (0.9626) acc_u 0.0000 (4.6875) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/27] time 0.374 (0.420) data 0.246 (0.293) loss_u loss_u 0.9292 (0.9634) acc_u 9.3750 (4.6250) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:731
clean false:13
clean_rate:0.9825268817204301
noisy true:649
noisy false:239
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [158/200] batch [5/23] time 0.442 (0.429) data 0.318 (0.313) loss_x loss_x 0.0937 (0.2187) acc_x 100.0000 (99.3750) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [10/23] time 0.370 (0.414) data 0.236 (0.292) loss_x loss_x 0.1779 (0.1920) acc_x 96.8750 (98.4375) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [15/23] time 0.408 (0.402) data 0.281 (0.278) loss_x loss_x 0.1024 (0.2058) acc_x 100.0000 (97.0833) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/23] time 0.520 (0.416) data 0.395 (0.292) loss_x loss_x 0.2749 (0.2206) acc_x 96.8750 (96.5625) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [5/27] time 0.351 (0.405) data 0.223 (0.281) loss_u loss_u 0.9634 (0.9349) acc_u 3.1250 (7.5000) lr 2.2949e-04 eta 0:00:08
epoch [158/200] batch [10/27] time 0.444 (0.409) data 0.314 (0.284) loss_u loss_u 0.9517 (0.9408) acc_u 6.2500 (6.8750) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [15/27] time 0.398 (0.408) data 0.269 (0.282) loss_u loss_u 0.9561 (0.9435) acc_u 6.2500 (6.2500) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [20/27] time 0.434 (0.408) data 0.304 (0.282) loss_u loss_u 0.9492 (0.9503) acc_u 6.2500 (5.6250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/27] time 0.429 (0.408) data 0.299 (0.283) loss_u loss_u 0.8979 (0.9497) acc_u 12.5000 (5.7500) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:735
clean false:10
clean_rate:0.9865771812080537
noisy true:648
noisy false:239
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [159/200] batch [5/23] time 0.396 (0.410) data 0.267 (0.284) loss_x loss_x 0.3042 (0.2225) acc_x 96.8750 (96.2500) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [10/23] time 0.317 (0.396) data 0.239 (0.274) loss_x loss_x 0.2472 (0.2281) acc_x 93.7500 (95.0000) lr 2.1957e-04 eta 0:00:05
epoch [159/200] batch [15/23] time 0.392 (0.392) data 0.266 (0.269) loss_x loss_x 0.3589 (0.2849) acc_x 93.7500 (94.1667) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/23] time 0.400 (0.397) data 0.275 (0.273) loss_x loss_x 0.2148 (0.2751) acc_x 93.7500 (94.5312) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [5/27] time 0.410 (0.397) data 0.283 (0.274) loss_u loss_u 0.8745 (0.9325) acc_u 15.6250 (8.1250) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [10/27] time 0.420 (0.400) data 0.293 (0.276) loss_u loss_u 0.9761 (0.9394) acc_u 3.1250 (7.1875) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [15/27] time 0.404 (0.401) data 0.274 (0.276) loss_u loss_u 0.9717 (0.9442) acc_u 6.2500 (6.8750) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [20/27] time 0.407 (0.402) data 0.279 (0.277) loss_u loss_u 0.9507 (0.9461) acc_u 9.3750 (6.5625) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/27] time 0.403 (0.403) data 0.276 (0.278) loss_u loss_u 0.9521 (0.9502) acc_u 6.2500 (6.1250) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 255
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:737
clean false:11
clean_rate:0.9852941176470589
noisy true:640
noisy false:244
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [160/200] batch [5/23] time 0.356 (0.358) data 0.225 (0.232) loss_x loss_x 0.1698 (0.3477) acc_x 93.7500 (90.0000) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [10/23] time 0.403 (0.364) data 0.275 (0.238) loss_x loss_x 0.2371 (0.3071) acc_x 93.7500 (91.5625) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/23] time 0.398 (0.382) data 0.270 (0.255) loss_x loss_x 0.1780 (0.2957) acc_x 96.8750 (92.0833) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/23] time 0.433 (0.392) data 0.305 (0.265) loss_x loss_x 0.1038 (0.2921) acc_x 100.0000 (92.9688) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [5/27] time 0.425 (0.391) data 0.296 (0.266) loss_u loss_u 0.9038 (0.9538) acc_u 12.5000 (5.6250) lr 2.0984e-04 eta 0:00:08
epoch [160/200] batch [10/27] time 0.430 (0.396) data 0.301 (0.271) loss_u loss_u 0.9248 (0.9435) acc_u 9.3750 (6.5625) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [15/27] time 0.484 (0.399) data 0.354 (0.274) loss_u loss_u 0.9297 (0.9524) acc_u 9.3750 (5.6250) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [20/27] time 0.353 (0.400) data 0.222 (0.274) loss_u loss_u 0.9014 (0.9515) acc_u 12.5000 (5.7812) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/27] time 0.622 (0.406) data 0.493 (0.280) loss_u loss_u 0.9399 (0.9508) acc_u 6.2500 (5.7500) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:727
clean false:13
clean_rate:0.9824324324324324
noisy true:648
noisy false:244
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [161/200] batch [5/23] time 0.402 (0.408) data 0.276 (0.283) loss_x loss_x 0.2096 (0.2199) acc_x 96.8750 (96.8750) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [10/23] time 0.402 (0.407) data 0.273 (0.281) loss_x loss_x 0.4275 (0.2193) acc_x 87.5000 (95.9375) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [15/23] time 0.389 (0.416) data 0.311 (0.291) loss_x loss_x 0.2050 (0.2226) acc_x 96.8750 (95.0000) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/23] time 0.422 (0.421) data 0.296 (0.295) loss_x loss_x 0.1779 (0.2310) acc_x 100.0000 (94.6875) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [5/27] time 0.388 (0.426) data 0.256 (0.299) loss_u loss_u 0.9526 (0.9496) acc_u 6.2500 (5.6250) lr 2.0032e-04 eta 0:00:09
epoch [161/200] batch [10/27] time 0.434 (0.418) data 0.303 (0.291) loss_u loss_u 0.9731 (0.9627) acc_u 3.1250 (4.0625) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [15/27] time 0.455 (0.422) data 0.329 (0.296) loss_u loss_u 0.9204 (0.9514) acc_u 9.3750 (5.4167) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [20/27] time 0.386 (0.416) data 0.258 (0.290) loss_u loss_u 0.8643 (0.9494) acc_u 18.7500 (5.7812) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/27] time 0.464 (0.419) data 0.334 (0.292) loss_u loss_u 0.8696 (0.9435) acc_u 15.6250 (6.5000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:734
clean false:14
clean_rate:0.9812834224598931
noisy true:659
noisy false:225
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [162/200] batch [5/23] time 0.419 (0.409) data 0.294 (0.282) loss_x loss_x 0.1625 (0.2693) acc_x 93.7500 (93.1250) lr 1.9098e-04 eta 0:00:07
epoch [162/200] batch [10/23] time 0.368 (0.407) data 0.242 (0.280) loss_x loss_x 0.3352 (0.3018) acc_x 93.7500 (92.8125) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [15/23] time 0.402 (0.401) data 0.324 (0.278) loss_x loss_x 0.1437 (0.3017) acc_x 100.0000 (93.1250) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/23] time 0.414 (0.406) data 0.287 (0.282) loss_x loss_x 0.4487 (0.3086) acc_x 84.3750 (92.5000) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [5/27] time 0.409 (0.408) data 0.251 (0.282) loss_u loss_u 0.9502 (0.9527) acc_u 6.2500 (5.6250) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [10/27] time 0.442 (0.410) data 0.315 (0.284) loss_u loss_u 0.9160 (0.9539) acc_u 9.3750 (5.6250) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [15/27] time 0.424 (0.412) data 0.298 (0.286) loss_u loss_u 0.9688 (0.9576) acc_u 3.1250 (5.0000) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [20/27] time 0.410 (0.414) data 0.281 (0.288) loss_u loss_u 0.8711 (0.9505) acc_u 12.5000 (5.6250) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/27] time 0.449 (0.414) data 0.319 (0.288) loss_u loss_u 0.9785 (0.9549) acc_u 3.1250 (5.1250) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 245
confident_label rate tensor(0.4589, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 749
clean true:740
clean false:9
clean_rate:0.9879839786381842
noisy true:647
noisy false:236
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 883
epoch [163/200] batch [5/23] time 0.427 (0.437) data 0.300 (0.309) loss_x loss_x 0.2119 (0.1709) acc_x 93.7500 (96.8750) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [10/23] time 0.422 (0.435) data 0.295 (0.307) loss_x loss_x 0.1311 (0.1888) acc_x 96.8750 (96.5625) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [15/23] time 0.417 (0.432) data 0.290 (0.304) loss_x loss_x 0.3135 (0.2060) acc_x 93.7500 (96.6667) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/23] time 0.427 (0.425) data 0.300 (0.301) loss_x loss_x 0.1877 (0.2183) acc_x 96.8750 (96.4062) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [5/27] time 0.438 (0.426) data 0.311 (0.302) loss_u loss_u 0.9761 (0.9408) acc_u 3.1250 (7.5000) lr 1.8185e-04 eta 0:00:09
epoch [163/200] batch [10/27] time 0.405 (0.424) data 0.277 (0.299) loss_u loss_u 0.9580 (0.9515) acc_u 6.2500 (5.9375) lr 1.8185e-04 eta 0:00:07
epoch [163/200] batch [15/27] time 0.418 (0.423) data 0.291 (0.298) loss_u loss_u 0.8818 (0.9457) acc_u 12.5000 (6.2500) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [20/27] time 0.407 (0.421) data 0.279 (0.296) loss_u loss_u 0.9438 (0.9514) acc_u 9.3750 (5.7812) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/27] time 0.359 (0.417) data 0.229 (0.292) loss_u loss_u 0.9995 (0.9575) acc_u 0.0000 (5.0000) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 224
confident_label rate tensor(0.4638, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 757
clean true:747
clean false:10
clean_rate:0.9867899603698811
noisy true:661
noisy false:214
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 875
epoch [164/200] batch [5/23] time 0.482 (0.447) data 0.354 (0.319) loss_x loss_x 0.2354 (0.2098) acc_x 96.8750 (98.1250) lr 1.7292e-04 eta 0:00:08
epoch [164/200] batch [10/23] time 0.368 (0.428) data 0.239 (0.299) loss_x loss_x 0.1320 (0.2525) acc_x 100.0000 (96.2500) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [15/23] time 0.416 (0.420) data 0.290 (0.295) loss_x loss_x 0.2352 (0.2465) acc_x 96.8750 (96.0417) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/23] time 0.399 (0.416) data 0.275 (0.291) loss_x loss_x 0.5312 (0.2538) acc_x 87.5000 (95.4688) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [5/27] time 0.415 (0.415) data 0.286 (0.289) loss_u loss_u 0.9873 (0.9523) acc_u 3.1250 (5.6250) lr 1.7292e-04 eta 0:00:09
epoch [164/200] batch [10/27] time 0.392 (0.414) data 0.298 (0.290) loss_u loss_u 0.9702 (0.9698) acc_u 3.1250 (3.4375) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [15/27] time 0.422 (0.413) data 0.296 (0.289) loss_u loss_u 0.9829 (0.9729) acc_u 3.1250 (3.1250) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [20/27] time 0.479 (0.417) data 0.351 (0.292) loss_u loss_u 0.9937 (0.9682) acc_u 0.0000 (3.5938) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/27] time 0.369 (0.418) data 0.242 (0.293) loss_u loss_u 0.9697 (0.9635) acc_u 3.1250 (4.0000) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 232
confident_label rate tensor(0.4589, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 749
clean true:736
clean false:13
clean_rate:0.9826435246995995
noisy true:664
noisy false:219
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 883
epoch [165/200] batch [5/23] time 0.450 (0.415) data 0.321 (0.288) loss_x loss_x 0.6763 (0.3687) acc_x 87.5000 (90.6250) lr 1.6419e-04 eta 0:00:07
epoch [165/200] batch [10/23] time 0.448 (0.413) data 0.318 (0.291) loss_x loss_x 0.2375 (0.3463) acc_x 90.6250 (91.8750) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [15/23] time 0.418 (0.416) data 0.290 (0.292) loss_x loss_x 0.3445 (0.3181) acc_x 93.7500 (92.9167) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/23] time 0.404 (0.414) data 0.274 (0.289) loss_x loss_x 0.1680 (0.3026) acc_x 96.8750 (93.4375) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [5/27] time 0.421 (0.410) data 0.292 (0.285) loss_u loss_u 0.9688 (0.9661) acc_u 3.1250 (3.7500) lr 1.6419e-04 eta 0:00:09
epoch [165/200] batch [10/27] time 0.418 (0.411) data 0.289 (0.285) loss_u loss_u 0.9580 (0.9714) acc_u 3.1250 (3.1250) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [15/27] time 0.355 (0.408) data 0.224 (0.282) loss_u loss_u 0.9463 (0.9566) acc_u 6.2500 (5.0000) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [20/27] time 0.417 (0.407) data 0.285 (0.281) loss_u loss_u 0.9351 (0.9581) acc_u 6.2500 (4.6875) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/27] time 0.395 (0.405) data 0.268 (0.279) loss_u loss_u 0.8604 (0.9514) acc_u 15.6250 (5.5000) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4596, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 750
clean true:735
clean false:15
clean_rate:0.98
noisy true:644
noisy false:238
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 882
epoch [166/200] batch [5/23] time 0.445 (0.420) data 0.318 (0.293) loss_x loss_x 0.0908 (0.2845) acc_x 96.8750 (94.3750) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [10/23] time 0.451 (0.416) data 0.323 (0.294) loss_x loss_x 0.2097 (0.2246) acc_x 96.8750 (96.5625) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [15/23] time 0.433 (0.419) data 0.307 (0.295) loss_x loss_x 0.2465 (0.2431) acc_x 96.8750 (95.6250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/23] time 0.362 (0.413) data 0.234 (0.289) loss_x loss_x 0.4951 (0.2607) acc_x 87.5000 (94.6875) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [5/27] time 0.364 (0.411) data 0.285 (0.288) loss_u loss_u 0.9238 (0.9542) acc_u 9.3750 (5.6250) lr 1.5567e-04 eta 0:00:09
epoch [166/200] batch [10/27] time 0.417 (0.412) data 0.290 (0.288) loss_u loss_u 0.9438 (0.9456) acc_u 6.2500 (6.2500) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [15/27] time 0.410 (0.414) data 0.282 (0.289) loss_u loss_u 0.9683 (0.9409) acc_u 3.1250 (6.6667) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [20/27] time 0.378 (0.411) data 0.249 (0.286) loss_u loss_u 0.9722 (0.9424) acc_u 3.1250 (6.5625) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/27] time 0.407 (0.412) data 0.279 (0.286) loss_u loss_u 0.9971 (0.9479) acc_u 0.0000 (5.8750) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.4577, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 747
clean true:733
clean false:14
clean_rate:0.9812583668005355
noisy true:652
noisy false:233
after delete: len(clean_dataset) 747
after delete: len(noisy_dataset) 885
epoch [167/200] batch [5/23] time 0.400 (0.393) data 0.273 (0.265) loss_x loss_x 0.4167 (0.2405) acc_x 96.8750 (97.5000) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [10/23] time 0.437 (0.403) data 0.310 (0.276) loss_x loss_x 0.3413 (0.2731) acc_x 90.6250 (95.6250) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [15/23] time 0.429 (0.403) data 0.302 (0.279) loss_x loss_x 0.2876 (0.2775) acc_x 90.6250 (93.9583) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/23] time 0.392 (0.405) data 0.268 (0.281) loss_x loss_x 0.1393 (0.2564) acc_x 96.8750 (94.2188) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [5/27] time 0.365 (0.404) data 0.235 (0.278) loss_u loss_u 0.9565 (0.9348) acc_u 6.2500 (7.5000) lr 1.4736e-04 eta 0:00:08
epoch [167/200] batch [10/27] time 0.349 (0.400) data 0.221 (0.277) loss_u loss_u 0.8936 (0.9425) acc_u 12.5000 (6.5625) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [15/27] time 0.419 (0.404) data 0.290 (0.279) loss_u loss_u 0.9707 (0.9496) acc_u 3.1250 (5.6250) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [20/27] time 0.422 (0.405) data 0.295 (0.281) loss_u loss_u 0.9912 (0.9518) acc_u 0.0000 (5.3125) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/27] time 0.430 (0.408) data 0.301 (0.282) loss_u loss_u 0.8955 (0.9479) acc_u 12.5000 (5.7500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:726
clean false:13
clean_rate:0.9824086603518268
noisy true:654
noisy false:239
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [168/200] batch [5/23] time 0.384 (0.384) data 0.256 (0.260) loss_x loss_x 0.2118 (0.2353) acc_x 96.8750 (95.6250) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [10/23] time 0.397 (0.386) data 0.270 (0.261) loss_x loss_x 0.3508 (0.2590) acc_x 93.7500 (95.0000) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [15/23] time 0.388 (0.391) data 0.263 (0.265) loss_x loss_x 0.2013 (0.2714) acc_x 100.0000 (94.7917) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/23] time 0.349 (0.390) data 0.223 (0.264) loss_x loss_x 0.2433 (0.2727) acc_x 93.7500 (94.3750) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [5/27] time 0.390 (0.394) data 0.260 (0.267) loss_u loss_u 0.9692 (0.9304) acc_u 3.1250 (8.1250) lr 1.3926e-04 eta 0:00:08
epoch [168/200] batch [10/27] time 0.367 (0.392) data 0.238 (0.264) loss_u loss_u 0.8833 (0.9414) acc_u 12.5000 (6.5625) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [15/27] time 0.389 (0.391) data 0.260 (0.263) loss_u loss_u 0.9702 (0.9451) acc_u 3.1250 (6.0417) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [20/27] time 0.350 (0.388) data 0.221 (0.260) loss_u loss_u 0.9663 (0.9480) acc_u 3.1250 (5.7812) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/27] time 0.341 (0.384) data 0.214 (0.256) loss_u loss_u 1.0000 (0.9486) acc_u 0.0000 (5.7500) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 252
confident_label rate tensor(0.4522, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 738
clean true:729
clean false:9
clean_rate:0.9878048780487805
noisy true:651
noisy false:243
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 894
epoch [169/200] batch [5/23] time 0.348 (0.351) data 0.222 (0.224) loss_x loss_x 0.1552 (0.1931) acc_x 100.0000 (97.5000) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [10/23] time 0.349 (0.348) data 0.221 (0.221) loss_x loss_x 0.1621 (0.2286) acc_x 96.8750 (95.9375) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/23] time 0.354 (0.347) data 0.226 (0.221) loss_x loss_x 0.2411 (0.2101) acc_x 100.0000 (96.6667) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/23] time 0.342 (0.346) data 0.216 (0.219) loss_x loss_x 0.2549 (0.2450) acc_x 96.8750 (95.3125) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [5/27] time 0.339 (0.346) data 0.210 (0.218) loss_u loss_u 0.9683 (0.9379) acc_u 3.1250 (6.8750) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [10/27] time 0.348 (0.345) data 0.220 (0.219) loss_u loss_u 0.9395 (0.9479) acc_u 9.3750 (5.9375) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [15/27] time 0.354 (0.346) data 0.226 (0.219) loss_u loss_u 0.9717 (0.9513) acc_u 3.1250 (5.6250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [20/27] time 0.352 (0.346) data 0.224 (0.219) loss_u loss_u 0.9307 (0.9479) acc_u 9.3750 (6.0938) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/27] time 0.349 (0.347) data 0.220 (0.220) loss_u loss_u 0.9087 (0.9442) acc_u 9.3750 (6.3750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:729
clean false:10
clean_rate:0.986468200270636
noisy true:652
noisy false:241
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [170/200] batch [5/23] time 0.344 (0.347) data 0.216 (0.219) loss_x loss_x 0.1860 (0.3033) acc_x 96.8750 (94.3750) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [10/23] time 0.345 (0.345) data 0.219 (0.217) loss_x loss_x 0.1116 (0.2551) acc_x 100.0000 (95.6250) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/23] time 0.293 (0.343) data 0.216 (0.218) loss_x loss_x 0.3774 (0.2304) acc_x 87.5000 (95.2083) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/23] time 0.351 (0.343) data 0.221 (0.218) loss_x loss_x 0.2134 (0.2319) acc_x 96.8750 (95.1562) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [5/27] time 0.342 (0.343) data 0.217 (0.218) loss_u loss_u 0.9146 (0.9491) acc_u 9.3750 (5.6250) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [10/27] time 0.341 (0.344) data 0.214 (0.218) loss_u loss_u 0.9365 (0.9503) acc_u 6.2500 (5.9375) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [15/27] time 0.354 (0.345) data 0.221 (0.218) loss_u loss_u 0.9375 (0.9479) acc_u 6.2500 (6.2500) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [20/27] time 0.342 (0.344) data 0.215 (0.217) loss_u loss_u 0.9531 (0.9481) acc_u 6.2500 (6.2500) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/27] time 0.350 (0.345) data 0.221 (0.217) loss_u loss_u 0.9756 (0.9509) acc_u 3.1250 (6.0000) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4528, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 739
clean true:730
clean false:9
clean_rate:0.9878213802435724
noisy true:642
noisy false:251
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 893
epoch [171/200] batch [5/23] time 0.354 (0.344) data 0.226 (0.223) loss_x loss_x 0.1947 (0.2575) acc_x 96.8750 (94.3750) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [10/23] time 0.351 (0.348) data 0.223 (0.223) loss_x loss_x 0.2888 (0.2521) acc_x 93.7500 (94.3750) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/23] time 0.341 (0.347) data 0.215 (0.221) loss_x loss_x 0.4536 (0.2746) acc_x 90.6250 (93.7500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/23] time 0.347 (0.346) data 0.219 (0.220) loss_x loss_x 0.1293 (0.2744) acc_x 100.0000 (94.2188) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [5/27] time 0.345 (0.346) data 0.218 (0.219) loss_u loss_u 0.9360 (0.9673) acc_u 6.2500 (3.1250) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [10/27] time 0.347 (0.345) data 0.217 (0.219) loss_u loss_u 0.9570 (0.9596) acc_u 9.3750 (4.6875) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [15/27] time 0.341 (0.345) data 0.214 (0.219) loss_u loss_u 0.9985 (0.9568) acc_u 0.0000 (4.7917) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [20/27] time 0.343 (0.344) data 0.216 (0.219) loss_u loss_u 0.9609 (0.9489) acc_u 3.1250 (5.4688) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/27] time 0.330 (0.345) data 0.247 (0.219) loss_u loss_u 0.9546 (0.9517) acc_u 6.2500 (5.3750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.4589, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 749
clean true:736
clean false:13
clean_rate:0.9826435246995995
noisy true:658
noisy false:225
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 883
epoch [172/200] batch [5/23] time 0.345 (0.351) data 0.219 (0.224) loss_x loss_x 0.6084 (0.3413) acc_x 87.5000 (91.8750) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [10/23] time 0.351 (0.350) data 0.220 (0.222) loss_x loss_x 0.3254 (0.3501) acc_x 90.6250 (92.5000) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/23] time 0.344 (0.348) data 0.218 (0.220) loss_x loss_x 0.1252 (0.3498) acc_x 100.0000 (91.8750) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/23] time 0.339 (0.345) data 0.210 (0.220) loss_x loss_x 0.2947 (0.3181) acc_x 90.6250 (92.8125) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [5/27] time 0.343 (0.345) data 0.215 (0.219) loss_u loss_u 0.9575 (0.9681) acc_u 6.2500 (3.7500) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [10/27] time 0.350 (0.345) data 0.218 (0.219) loss_u loss_u 0.9458 (0.9500) acc_u 6.2500 (5.9375) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [15/27] time 0.341 (0.345) data 0.210 (0.218) loss_u loss_u 0.9404 (0.9462) acc_u 3.1250 (6.0417) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [20/27] time 0.324 (0.344) data 0.218 (0.218) loss_u loss_u 0.9985 (0.9531) acc_u 0.0000 (5.4688) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/27] time 0.346 (0.344) data 0.221 (0.218) loss_u loss_u 0.9551 (0.9592) acc_u 6.2500 (4.7500) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 250
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:743
clean false:11
clean_rate:0.9854111405835544
noisy true:639
noisy false:239
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [173/200] batch [5/23] time 0.343 (0.344) data 0.216 (0.216) loss_x loss_x 0.2198 (0.2454) acc_x 93.7500 (94.3750) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [10/23] time 0.336 (0.338) data 0.210 (0.215) loss_x loss_x 0.2888 (0.2584) acc_x 96.8750 (95.6250) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/23] time 0.340 (0.339) data 0.214 (0.215) loss_x loss_x 0.1416 (0.2525) acc_x 96.8750 (95.4167) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/23] time 0.346 (0.340) data 0.217 (0.215) loss_x loss_x 0.2498 (0.2746) acc_x 93.7500 (94.2188) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [5/27] time 0.340 (0.341) data 0.215 (0.215) loss_u loss_u 0.9424 (0.9441) acc_u 6.2500 (7.5000) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [10/27] time 0.349 (0.340) data 0.220 (0.215) loss_u loss_u 0.9922 (0.9603) acc_u 3.1250 (5.3125) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [15/27] time 0.344 (0.340) data 0.216 (0.215) loss_u loss_u 0.9448 (0.9620) acc_u 6.2500 (4.7917) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [20/27] time 0.348 (0.340) data 0.220 (0.215) loss_u loss_u 0.9468 (0.9581) acc_u 6.2500 (5.1562) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/27] time 0.353 (0.341) data 0.226 (0.216) loss_u loss_u 0.9683 (0.9565) acc_u 3.1250 (5.1250) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:739
clean false:9
clean_rate:0.9879679144385026
noisy true:646
noisy false:238
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [174/200] batch [5/23] time 0.343 (0.344) data 0.218 (0.218) loss_x loss_x 0.1224 (0.2125) acc_x 96.8750 (95.0000) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [10/23] time 0.351 (0.344) data 0.224 (0.217) loss_x loss_x 0.1196 (0.2685) acc_x 100.0000 (94.3750) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/23] time 0.346 (0.343) data 0.215 (0.216) loss_x loss_x 0.1771 (0.2597) acc_x 96.8750 (94.1667) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/23] time 0.299 (0.341) data 0.221 (0.217) loss_x loss_x 0.1831 (0.2568) acc_x 93.7500 (94.3750) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [5/27] time 0.347 (0.342) data 0.219 (0.217) loss_u loss_u 0.9438 (0.9375) acc_u 6.2500 (6.8750) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [10/27] time 0.351 (0.343) data 0.222 (0.217) loss_u loss_u 0.9995 (0.9555) acc_u 0.0000 (4.6875) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [15/27] time 0.348 (0.343) data 0.220 (0.217) loss_u loss_u 0.9980 (0.9603) acc_u 0.0000 (4.3750) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [20/27] time 0.346 (0.343) data 0.217 (0.217) loss_u loss_u 0.9199 (0.9560) acc_u 9.3750 (5.0000) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/27] time 0.293 (0.342) data 0.215 (0.217) loss_u loss_u 0.9985 (0.9600) acc_u 0.0000 (4.6250) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 268
confident_label rate tensor(0.4547, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 742
clean true:729
clean false:13
clean_rate:0.9824797843665768
noisy true:635
noisy false:255
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 890
epoch [175/200] batch [5/23] time 0.345 (0.342) data 0.217 (0.216) loss_x loss_x 0.1874 (0.3187) acc_x 96.8750 (93.1250) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [10/23] time 0.334 (0.342) data 0.207 (0.216) loss_x loss_x 0.2427 (0.2925) acc_x 93.7500 (93.7500) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/23] time 0.339 (0.342) data 0.213 (0.215) loss_x loss_x 0.2125 (0.3124) acc_x 96.8750 (92.7083) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/23] time 0.335 (0.342) data 0.208 (0.215) loss_x loss_x 0.4761 (0.3183) acc_x 84.3750 (92.1875) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [5/27] time 0.352 (0.341) data 0.225 (0.217) loss_u loss_u 0.9658 (0.9437) acc_u 3.1250 (6.2500) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [10/27] time 0.339 (0.342) data 0.211 (0.216) loss_u loss_u 0.8887 (0.9415) acc_u 12.5000 (6.5625) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [15/27] time 0.338 (0.342) data 0.210 (0.216) loss_u loss_u 0.9424 (0.9441) acc_u 9.3750 (6.4583) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [20/27] time 0.352 (0.343) data 0.222 (0.216) loss_u loss_u 0.9722 (0.9468) acc_u 3.1250 (6.2500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/27] time 0.345 (0.343) data 0.216 (0.217) loss_u loss_u 0.9263 (0.9506) acc_u 9.3750 (5.7500) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:737
clean false:14
clean_rate:0.9813581890812251
noisy true:658
noisy false:223
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [176/200] batch [5/23] time 0.335 (0.339) data 0.209 (0.213) loss_x loss_x 0.2094 (0.2618) acc_x 96.8750 (96.2500) lr 8.2245e-05 eta 0:00:06
epoch [176/200] batch [10/23] time 0.342 (0.340) data 0.216 (0.214) loss_x loss_x 0.2915 (0.2462) acc_x 93.7500 (95.6250) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/23] time 0.349 (0.341) data 0.221 (0.214) loss_x loss_x 0.1113 (0.2400) acc_x 96.8750 (95.2083) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/23] time 0.334 (0.341) data 0.209 (0.215) loss_x loss_x 0.5044 (0.2569) acc_x 87.5000 (94.5312) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [5/27] time 0.343 (0.342) data 0.216 (0.215) loss_u loss_u 0.9966 (0.9646) acc_u 0.0000 (3.7500) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [10/27] time 0.339 (0.342) data 0.210 (0.215) loss_u loss_u 0.9111 (0.9457) acc_u 12.5000 (6.2500) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [15/27] time 0.338 (0.342) data 0.209 (0.215) loss_u loss_u 0.9697 (0.9475) acc_u 3.1250 (5.8333) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [20/27] time 0.342 (0.341) data 0.215 (0.215) loss_u loss_u 0.9697 (0.9503) acc_u 3.1250 (5.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/27] time 0.329 (0.341) data 0.202 (0.214) loss_u loss_u 0.9995 (0.9529) acc_u 0.0000 (5.3750) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:734
clean false:11
clean_rate:0.9852348993288591
noisy true:659
noisy false:228
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [177/200] batch [5/23] time 0.334 (0.340) data 0.205 (0.213) loss_x loss_x 0.3743 (0.1859) acc_x 93.7500 (96.2500) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [10/23] time 0.352 (0.343) data 0.224 (0.216) loss_x loss_x 0.1310 (0.2043) acc_x 100.0000 (95.6250) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/23] time 0.333 (0.342) data 0.206 (0.215) loss_x loss_x 0.3945 (0.2266) acc_x 90.6250 (95.0000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/23] time 0.346 (0.343) data 0.216 (0.215) loss_x loss_x 0.1812 (0.2405) acc_x 90.6250 (94.3750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [5/27] time 0.339 (0.341) data 0.210 (0.215) loss_u loss_u 0.9990 (0.9611) acc_u 0.0000 (4.3750) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [10/27] time 0.336 (0.342) data 0.208 (0.216) loss_u loss_u 0.9565 (0.9441) acc_u 3.1250 (5.9375) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [15/27] time 0.350 (0.343) data 0.219 (0.216) loss_u loss_u 0.9370 (0.9497) acc_u 6.2500 (5.2083) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [20/27] time 0.350 (0.343) data 0.220 (0.216) loss_u loss_u 0.9033 (0.9437) acc_u 12.5000 (6.0938) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/27] time 0.345 (0.344) data 0.219 (0.217) loss_u loss_u 0.9995 (0.9478) acc_u 0.0000 (5.5000) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 758
clean true:748
clean false:10
clean_rate:0.9868073878627969
noisy true:646
noisy false:228
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 874
epoch [178/200] batch [5/23] time 0.346 (0.335) data 0.220 (0.218) loss_x loss_x 0.1426 (0.2997) acc_x 96.8750 (91.2500) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [10/23] time 0.339 (0.337) data 0.213 (0.215) loss_x loss_x 0.2905 (0.3234) acc_x 93.7500 (91.5625) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/23] time 0.342 (0.338) data 0.216 (0.214) loss_x loss_x 0.1059 (0.2913) acc_x 100.0000 (93.3333) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/23] time 0.341 (0.339) data 0.216 (0.215) loss_x loss_x 0.4902 (0.2829) acc_x 96.8750 (93.7500) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [5/27] time 0.338 (0.340) data 0.208 (0.215) loss_u loss_u 0.9829 (0.9729) acc_u 3.1250 (3.1250) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [10/27] time 0.334 (0.340) data 0.206 (0.215) loss_u loss_u 0.9756 (0.9739) acc_u 3.1250 (3.1250) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [15/27] time 0.344 (0.340) data 0.217 (0.214) loss_u loss_u 0.9385 (0.9692) acc_u 6.2500 (3.9583) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [20/27] time 0.353 (0.341) data 0.223 (0.215) loss_u loss_u 0.9995 (0.9641) acc_u 0.0000 (4.3750) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/27] time 0.355 (0.340) data 0.213 (0.215) loss_u loss_u 0.9995 (0.9630) acc_u 0.0000 (4.3750) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 266
confident_label rate tensor(0.4498, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 734
clean true:719
clean false:15
clean_rate:0.9795640326975477
noisy true:647
noisy false:251
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 898
epoch [179/200] batch [5/22] time 0.341 (0.343) data 0.216 (0.216) loss_x loss_x 0.2849 (0.3160) acc_x 96.8750 (96.2500) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [10/22] time 0.374 (0.348) data 0.248 (0.221) loss_x loss_x 0.3899 (0.2800) acc_x 93.7500 (96.5625) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/22] time 0.343 (0.347) data 0.217 (0.220) loss_x loss_x 0.3594 (0.3044) acc_x 87.5000 (95.0000) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/22] time 0.339 (0.346) data 0.211 (0.218) loss_x loss_x 0.1652 (0.2946) acc_x 96.8750 (94.5312) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/28] time 0.342 (0.343) data 0.217 (0.217) loss_u loss_u 0.9502 (0.9328) acc_u 6.2500 (8.1250) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [10/28] time 0.350 (0.343) data 0.222 (0.217) loss_u loss_u 0.9648 (0.9429) acc_u 3.1250 (6.5625) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [15/28] time 0.339 (0.344) data 0.212 (0.217) loss_u loss_u 0.9219 (0.9402) acc_u 9.3750 (6.8750) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [20/28] time 0.349 (0.344) data 0.217 (0.217) loss_u loss_u 0.9692 (0.9451) acc_u 3.1250 (6.2500) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/28] time 0.343 (0.343) data 0.215 (0.217) loss_u loss_u 0.8765 (0.9384) acc_u 12.5000 (7.0000) lr 6.4556e-05 eta 0:00:01
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 254
confident_label rate tensor(0.4516, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 737
clean true:727
clean false:10
clean_rate:0.9864314789687924
noisy true:651
noisy false:244
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 895
epoch [180/200] batch [5/23] time 0.339 (0.343) data 0.212 (0.216) loss_x loss_x 0.2239 (0.1814) acc_x 93.7500 (96.2500) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [10/23] time 0.350 (0.345) data 0.222 (0.218) loss_x loss_x 0.2172 (0.2140) acc_x 93.7500 (95.0000) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/23] time 0.342 (0.343) data 0.213 (0.216) loss_x loss_x 0.3281 (0.2554) acc_x 93.7500 (93.7500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/23] time 0.335 (0.344) data 0.207 (0.216) loss_x loss_x 0.4167 (0.2656) acc_x 93.7500 (93.4375) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [5/27] time 0.352 (0.341) data 0.224 (0.216) loss_u loss_u 0.9478 (0.9526) acc_u 6.2500 (5.6250) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [10/27] time 0.356 (0.342) data 0.228 (0.217) loss_u loss_u 0.9238 (0.9474) acc_u 6.2500 (5.9375) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [15/27] time 0.348 (0.343) data 0.221 (0.217) loss_u loss_u 0.9390 (0.9494) acc_u 6.2500 (5.8333) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [20/27] time 0.346 (0.343) data 0.218 (0.217) loss_u loss_u 0.9385 (0.9482) acc_u 6.2500 (5.7812) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/27] time 0.355 (0.343) data 0.228 (0.218) loss_u loss_u 0.9810 (0.9485) acc_u 3.1250 (5.7500) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 239
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:739
clean false:13
clean_rate:0.9827127659574468
noisy true:654
noisy false:226
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [181/200] batch [5/23] time 0.351 (0.352) data 0.223 (0.225) loss_x loss_x 0.2600 (0.2766) acc_x 93.7500 (93.1250) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [10/23] time 0.341 (0.350) data 0.213 (0.222) loss_x loss_x 0.3674 (0.2640) acc_x 93.7500 (94.0625) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/23] time 0.349 (0.348) data 0.220 (0.221) loss_x loss_x 0.5156 (0.3046) acc_x 93.7500 (93.3333) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/23] time 0.340 (0.347) data 0.213 (0.219) loss_x loss_x 0.3186 (0.3037) acc_x 93.7500 (93.1250) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [5/27] time 0.350 (0.346) data 0.223 (0.220) loss_u loss_u 0.9995 (0.9600) acc_u 0.0000 (5.0000) lr 5.3915e-05 eta 0:00:07
epoch [181/200] batch [10/27] time 0.352 (0.346) data 0.219 (0.220) loss_u loss_u 0.9370 (0.9542) acc_u 9.3750 (5.3125) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [15/27] time 0.347 (0.346) data 0.221 (0.219) loss_u loss_u 0.9668 (0.9543) acc_u 3.1250 (5.2083) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [20/27] time 0.293 (0.345) data 0.214 (0.219) loss_u loss_u 0.9629 (0.9529) acc_u 6.2500 (5.4688) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/27] time 0.352 (0.345) data 0.221 (0.219) loss_u loss_u 0.9395 (0.9560) acc_u 6.2500 (5.0000) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 253
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:732
clean false:13
clean_rate:0.9825503355704698
noisy true:647
noisy false:240
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [182/200] batch [5/23] time 0.342 (0.349) data 0.215 (0.223) loss_x loss_x 0.3342 (0.2783) acc_x 90.6250 (93.1250) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [10/23] time 0.342 (0.347) data 0.215 (0.221) loss_x loss_x 0.3787 (0.2865) acc_x 90.6250 (93.7500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/23] time 0.350 (0.347) data 0.222 (0.220) loss_x loss_x 0.1597 (0.2811) acc_x 100.0000 (93.3333) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/23] time 0.298 (0.344) data 0.220 (0.219) loss_x loss_x 0.2140 (0.2601) acc_x 93.7500 (93.7500) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [5/27] time 0.348 (0.345) data 0.221 (0.218) loss_u loss_u 0.8667 (0.9303) acc_u 18.7500 (9.3750) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [10/27] time 0.337 (0.345) data 0.210 (0.218) loss_u loss_u 0.9678 (0.9404) acc_u 3.1250 (7.1875) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [15/27] time 0.344 (0.345) data 0.211 (0.218) loss_u loss_u 0.9692 (0.9482) acc_u 3.1250 (6.0417) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [20/27] time 0.350 (0.345) data 0.222 (0.218) loss_u loss_u 0.9443 (0.9495) acc_u 6.2500 (5.7812) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/27] time 0.294 (0.344) data 0.216 (0.217) loss_u loss_u 0.9287 (0.9447) acc_u 9.3750 (6.3750) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.4657, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 760
clean true:749
clean false:11
clean_rate:0.9855263157894737
noisy true:655
noisy false:217
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 872
epoch [183/200] batch [5/23] time 0.353 (0.341) data 0.228 (0.225) loss_x loss_x 0.2363 (0.3321) acc_x 96.8750 (93.1250) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [10/23] time 0.341 (0.344) data 0.214 (0.222) loss_x loss_x 0.5459 (0.3536) acc_x 87.5000 (92.8125) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/23] time 0.349 (0.344) data 0.219 (0.221) loss_x loss_x 0.2446 (0.3460) acc_x 93.7500 (92.2917) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/23] time 0.338 (0.345) data 0.213 (0.221) loss_x loss_x 0.2328 (0.3219) acc_x 96.8750 (92.5000) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [5/27] time 0.341 (0.345) data 0.215 (0.220) loss_u loss_u 0.9951 (0.9556) acc_u 0.0000 (5.0000) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [10/27] time 0.341 (0.344) data 0.213 (0.219) loss_u loss_u 0.9761 (0.9655) acc_u 3.1250 (3.7500) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [15/27] time 0.353 (0.343) data 0.221 (0.219) loss_u loss_u 0.9092 (0.9646) acc_u 9.3750 (3.9583) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [20/27] time 0.349 (0.343) data 0.221 (0.218) loss_u loss_u 0.9604 (0.9637) acc_u 3.1250 (3.9062) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/27] time 0.345 (0.344) data 0.217 (0.218) loss_u loss_u 0.9844 (0.9619) acc_u 3.1250 (4.1250) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 227
confident_label rate tensor(0.4608, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 752
clean true:741
clean false:11
clean_rate:0.9853723404255319
noisy true:664
noisy false:216
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 880
epoch [184/200] batch [5/23] time 0.349 (0.345) data 0.222 (0.218) loss_x loss_x 0.1187 (0.2245) acc_x 96.8750 (95.6250) lr 3.9706e-05 eta 0:00:06
epoch [184/200] batch [10/23] time 0.341 (0.344) data 0.216 (0.218) loss_x loss_x 0.3376 (0.2607) acc_x 90.6250 (94.3750) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/23] time 0.345 (0.340) data 0.218 (0.216) loss_x loss_x 0.2206 (0.2522) acc_x 96.8750 (94.7917) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/23] time 0.339 (0.347) data 0.212 (0.222) loss_x loss_x 0.7334 (0.2811) acc_x 75.0000 (93.2812) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [5/27] time 0.350 (0.346) data 0.223 (0.221) loss_u loss_u 0.9146 (0.9241) acc_u 9.3750 (7.5000) lr 3.9706e-05 eta 0:00:07
epoch [184/200] batch [10/27] time 0.370 (0.345) data 0.208 (0.220) loss_u loss_u 0.9297 (0.9415) acc_u 9.3750 (6.2500) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [15/27] time 0.337 (0.345) data 0.211 (0.219) loss_u loss_u 0.9707 (0.9515) acc_u 3.1250 (5.2083) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [20/27] time 0.341 (0.345) data 0.212 (0.219) loss_u loss_u 0.9644 (0.9552) acc_u 3.1250 (4.8438) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/27] time 0.342 (0.345) data 0.214 (0.219) loss_u loss_u 0.9517 (0.9536) acc_u 6.2500 (5.1250) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 257
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:734
clean false:12
clean_rate:0.9839142091152815
noisy true:641
noisy false:245
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [185/200] batch [5/23] time 0.341 (0.342) data 0.212 (0.214) loss_x loss_x 0.2517 (0.3497) acc_x 93.7500 (93.1250) lr 3.5443e-05 eta 0:00:06
epoch [185/200] batch [10/23] time 0.354 (0.341) data 0.227 (0.218) loss_x loss_x 0.1482 (0.3035) acc_x 96.8750 (94.0625) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/23] time 0.346 (0.343) data 0.220 (0.219) loss_x loss_x 0.4290 (0.3242) acc_x 87.5000 (93.3333) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/23] time 0.341 (0.343) data 0.214 (0.218) loss_x loss_x 0.2131 (0.3119) acc_x 96.8750 (93.2812) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [5/27] time 0.345 (0.346) data 0.217 (0.220) loss_u loss_u 0.9717 (0.9563) acc_u 3.1250 (4.3750) lr 3.5443e-05 eta 0:00:07
epoch [185/200] batch [10/27] time 0.375 (0.345) data 0.220 (0.220) loss_u loss_u 0.9990 (0.9607) acc_u 0.0000 (4.0625) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [15/27] time 0.344 (0.345) data 0.217 (0.220) loss_u loss_u 0.9502 (0.9546) acc_u 6.2500 (5.2083) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [20/27] time 0.344 (0.345) data 0.219 (0.219) loss_u loss_u 0.9556 (0.9525) acc_u 9.3750 (5.6250) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/27] time 0.341 (0.345) data 0.214 (0.219) loss_u loss_u 0.9551 (0.9500) acc_u 6.2500 (5.8750) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 259
confident_label rate tensor(0.4534, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 740
clean true:726
clean false:14
clean_rate:0.981081081081081
noisy true:647
noisy false:245
after delete: len(clean_dataset) 740
after delete: len(noisy_dataset) 892
epoch [186/200] batch [5/23] time 0.399 (0.381) data 0.271 (0.264) loss_x loss_x 0.1434 (0.2743) acc_x 96.8750 (92.5000) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [10/23] time 0.340 (0.372) data 0.213 (0.251) loss_x loss_x 0.2651 (0.2844) acc_x 96.8750 (93.7500) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/23] time 0.340 (0.368) data 0.214 (0.245) loss_x loss_x 0.3523 (0.2729) acc_x 93.7500 (94.3750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/23] time 0.343 (0.362) data 0.216 (0.238) loss_x loss_x 0.1021 (0.2628) acc_x 100.0000 (94.6875) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [5/27] time 0.348 (0.358) data 0.219 (0.233) loss_u loss_u 0.8945 (0.8979) acc_u 12.5000 (11.2500) lr 3.1417e-05 eta 0:00:07
epoch [186/200] batch [10/27] time 0.355 (0.355) data 0.227 (0.230) loss_u loss_u 0.9077 (0.9235) acc_u 9.3750 (8.1250) lr 3.1417e-05 eta 0:00:06
epoch [186/200] batch [15/27] time 0.339 (0.354) data 0.212 (0.230) loss_u loss_u 0.9438 (0.9404) acc_u 6.2500 (6.2500) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [20/27] time 0.356 (0.354) data 0.229 (0.229) loss_u loss_u 0.9243 (0.9469) acc_u 9.3750 (5.6250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/27] time 0.344 (0.356) data 0.217 (0.231) loss_u loss_u 0.8799 (0.9415) acc_u 12.5000 (6.3750) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 262
confident_label rate tensor(0.4553, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 743
clean true:730
clean false:13
clean_rate:0.9825033647375505
noisy true:640
noisy false:249
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 889
epoch [187/200] batch [5/23] time 0.341 (0.354) data 0.213 (0.219) loss_x loss_x 0.1218 (0.2391) acc_x 100.0000 (95.6250) lr 2.7630e-05 eta 0:00:06
epoch [187/200] batch [10/23] time 0.346 (0.346) data 0.218 (0.214) loss_x loss_x 0.1578 (0.2411) acc_x 96.8750 (95.0000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/23] time 0.346 (0.345) data 0.218 (0.214) loss_x loss_x 0.3105 (0.2464) acc_x 84.3750 (93.9583) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/23] time 0.339 (0.345) data 0.214 (0.215) loss_x loss_x 0.2305 (0.2277) acc_x 96.8750 (95.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [5/27] time 0.341 (0.344) data 0.213 (0.215) loss_u loss_u 0.9697 (0.9646) acc_u 3.1250 (5.0000) lr 2.7630e-05 eta 0:00:07
epoch [187/200] batch [10/27] time 0.313 (0.343) data 0.213 (0.215) loss_u loss_u 0.9712 (0.9638) acc_u 3.1250 (4.6875) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [15/27] time 0.354 (0.342) data 0.226 (0.215) loss_u loss_u 0.9995 (0.9610) acc_u 0.0000 (4.7917) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [20/27] time 0.348 (0.342) data 0.221 (0.215) loss_u loss_u 0.9814 (0.9577) acc_u 3.1250 (5.1562) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/27] time 0.354 (0.342) data 0.223 (0.215) loss_u loss_u 0.9683 (0.9548) acc_u 3.1250 (5.3750) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 261
confident_label rate tensor(0.4565, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 745
clean true:729
clean false:16
clean_rate:0.978523489932886
noisy true:642
noisy false:245
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 887
epoch [188/200] batch [5/23] time 0.342 (0.341) data 0.216 (0.214) loss_x loss_x 0.3191 (0.2749) acc_x 90.6250 (93.7500) lr 2.4083e-05 eta 0:00:06
epoch [188/200] batch [10/23] time 0.342 (0.341) data 0.217 (0.214) loss_x loss_x 0.2314 (0.2902) acc_x 96.8750 (93.4375) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/23] time 0.343 (0.342) data 0.215 (0.215) loss_x loss_x 0.2061 (0.2888) acc_x 100.0000 (93.7500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/23] time 0.336 (0.342) data 0.211 (0.215) loss_x loss_x 0.1381 (0.2691) acc_x 100.0000 (94.3750) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [5/27] time 0.345 (0.341) data 0.218 (0.215) loss_u loss_u 0.9990 (0.9651) acc_u 0.0000 (3.7500) lr 2.4083e-05 eta 0:00:07
epoch [188/200] batch [10/27] time 0.345 (0.342) data 0.218 (0.216) loss_u loss_u 0.9102 (0.9591) acc_u 9.3750 (4.3750) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [15/27] time 0.353 (0.342) data 0.226 (0.216) loss_u loss_u 1.0000 (0.9632) acc_u 0.0000 (3.9583) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [20/27] time 0.341 (0.342) data 0.211 (0.215) loss_u loss_u 0.9717 (0.9601) acc_u 3.1250 (4.3750) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/27] time 0.349 (0.343) data 0.219 (0.216) loss_u loss_u 0.9634 (0.9494) acc_u 3.1250 (5.6250) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 260
confident_label rate tensor(0.4571, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 746
clean true:731
clean false:15
clean_rate:0.9798927613941019
noisy true:641
noisy false:245
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 886
epoch [189/200] batch [5/23] time 0.346 (0.343) data 0.217 (0.216) loss_x loss_x 0.2917 (0.2933) acc_x 90.6250 (92.5000) lr 2.0777e-05 eta 0:00:06
epoch [189/200] batch [10/23] time 0.346 (0.342) data 0.219 (0.215) loss_x loss_x 0.7017 (0.3458) acc_x 93.7500 (92.8125) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/23] time 0.345 (0.342) data 0.217 (0.215) loss_x loss_x 0.2996 (0.3398) acc_x 90.6250 (92.5000) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/23] time 0.338 (0.340) data 0.212 (0.215) loss_x loss_x 0.5479 (0.3434) acc_x 87.5000 (92.0312) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [5/27] time 0.348 (0.341) data 0.220 (0.216) loss_u loss_u 0.9990 (0.9752) acc_u 0.0000 (2.5000) lr 2.0777e-05 eta 0:00:07
epoch [189/200] batch [10/27] time 0.348 (0.343) data 0.217 (0.217) loss_u loss_u 0.9385 (0.9587) acc_u 6.2500 (4.6875) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [15/27] time 0.346 (0.343) data 0.218 (0.216) loss_u loss_u 0.9253 (0.9512) acc_u 9.3750 (5.6250) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [20/27] time 0.342 (0.343) data 0.222 (0.217) loss_u loss_u 0.9629 (0.9475) acc_u 3.1250 (5.7812) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/27] time 0.350 (0.343) data 0.219 (0.217) loss_u loss_u 0.9136 (0.9468) acc_u 9.3750 (5.8750) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 237
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:733
clean false:15
clean_rate:0.9799465240641712
noisy true:662
noisy false:222
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [190/200] batch [5/23] time 0.358 (0.344) data 0.230 (0.216) loss_x loss_x 0.0971 (0.2145) acc_x 96.8750 (96.2500) lr 1.7713e-05 eta 0:00:06
epoch [190/200] batch [10/23] time 0.343 (0.343) data 0.218 (0.216) loss_x loss_x 0.2024 (0.2610) acc_x 96.8750 (95.0000) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/23] time 0.339 (0.343) data 0.213 (0.215) loss_x loss_x 0.3005 (0.3627) acc_x 90.6250 (92.5000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/23] time 0.340 (0.340) data 0.214 (0.216) loss_x loss_x 0.3982 (0.3430) acc_x 90.6250 (92.9688) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [5/27] time 0.349 (0.341) data 0.221 (0.216) loss_u loss_u 0.9556 (0.9583) acc_u 6.2500 (5.0000) lr 1.7713e-05 eta 0:00:07
epoch [190/200] batch [10/27] time 0.344 (0.341) data 0.216 (0.216) loss_u loss_u 0.9634 (0.9473) acc_u 3.1250 (5.9375) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [15/27] time 0.350 (0.342) data 0.221 (0.216) loss_u loss_u 0.9790 (0.9462) acc_u 3.1250 (6.2500) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [20/27] time 0.344 (0.342) data 0.218 (0.216) loss_u loss_u 0.9697 (0.9497) acc_u 3.1250 (5.6250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/27] time 0.351 (0.342) data 0.223 (0.217) loss_u loss_u 0.9399 (0.9528) acc_u 6.2500 (5.2500) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 251
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:732
clean false:12
clean_rate:0.9838709677419355
noisy true:649
noisy false:239
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [191/200] batch [5/23] time 0.324 (0.345) data 0.198 (0.217) loss_x loss_x 0.4255 (0.3015) acc_x 87.5000 (93.1250) lr 1.4891e-05 eta 0:00:06
epoch [191/200] batch [10/23] time 0.339 (0.336) data 0.213 (0.213) loss_x loss_x 0.2913 (0.3101) acc_x 96.8750 (93.4375) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/23] time 0.345 (0.338) data 0.218 (0.214) loss_x loss_x 0.4260 (0.2899) acc_x 87.5000 (93.3333) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/23] time 0.345 (0.339) data 0.219 (0.215) loss_x loss_x 0.2690 (0.2780) acc_x 90.6250 (93.2812) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [5/27] time 0.339 (0.338) data 0.211 (0.215) loss_u loss_u 0.9668 (0.9455) acc_u 3.1250 (5.6250) lr 1.4891e-05 eta 0:00:07
epoch [191/200] batch [10/27] time 0.346 (0.338) data 0.220 (0.214) loss_u loss_u 0.9531 (0.9384) acc_u 6.2500 (6.5625) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [15/27] time 0.348 (0.339) data 0.219 (0.215) loss_u loss_u 0.9780 (0.9494) acc_u 3.1250 (5.4167) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [20/27] time 0.347 (0.340) data 0.216 (0.215) loss_u loss_u 0.9434 (0.9489) acc_u 6.2500 (5.6250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/27] time 0.342 (0.341) data 0.213 (0.215) loss_u loss_u 0.9082 (0.9461) acc_u 9.3750 (6.0000) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.4620, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 754
clean true:742
clean false:12
clean_rate:0.9840848806366048
noisy true:646
noisy false:232
after delete: len(clean_dataset) 754
after delete: len(noisy_dataset) 878
epoch [192/200] batch [5/23] time 0.352 (0.343) data 0.223 (0.215) loss_x loss_x 0.1029 (0.2253) acc_x 96.8750 (95.0000) lr 1.2312e-05 eta 0:00:06
epoch [192/200] batch [10/23] time 0.349 (0.342) data 0.221 (0.214) loss_x loss_x 0.3176 (0.2755) acc_x 90.6250 (94.0625) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/23] time 0.337 (0.342) data 0.209 (0.215) loss_x loss_x 0.3076 (0.2612) acc_x 96.8750 (94.5833) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/23] time 0.329 (0.341) data 0.202 (0.214) loss_x loss_x 0.5654 (0.2721) acc_x 90.6250 (94.5312) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [5/27] time 0.348 (0.341) data 0.223 (0.214) loss_u loss_u 0.9814 (0.9718) acc_u 3.1250 (3.1250) lr 1.2312e-05 eta 0:00:07
epoch [192/200] batch [10/27] time 0.339 (0.341) data 0.212 (0.215) loss_u loss_u 0.9692 (0.9715) acc_u 3.1250 (3.4375) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [15/27] time 0.337 (0.341) data 0.208 (0.214) loss_u loss_u 0.9985 (0.9684) acc_u 0.0000 (3.9583) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [20/27] time 0.342 (0.342) data 0.214 (0.215) loss_u loss_u 0.8862 (0.9624) acc_u 12.5000 (4.3750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/27] time 0.348 (0.341) data 0.218 (0.215) loss_u loss_u 0.9810 (0.9606) acc_u 3.1250 (4.5000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 228
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:743
clean false:10
clean_rate:0.9867197875166003
noisy true:661
noisy false:218
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [193/200] batch [5/23] time 0.350 (0.346) data 0.220 (0.217) loss_x loss_x 0.1193 (0.2069) acc_x 96.8750 (94.3750) lr 9.9763e-06 eta 0:00:06
epoch [193/200] batch [10/23] time 0.341 (0.344) data 0.214 (0.216) loss_x loss_x 0.1808 (0.1993) acc_x 100.0000 (95.3125) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [15/23] time 0.343 (0.343) data 0.215 (0.215) loss_x loss_x 0.2617 (0.2415) acc_x 93.7500 (94.7917) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/23] time 0.342 (0.343) data 0.216 (0.215) loss_x loss_x 0.1212 (0.2323) acc_x 96.8750 (95.0000) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [5/27] time 0.363 (0.342) data 0.206 (0.215) loss_u loss_u 0.9546 (0.9342) acc_u 6.2500 (8.1250) lr 9.9763e-06 eta 0:00:07
epoch [193/200] batch [10/27] time 0.350 (0.342) data 0.218 (0.215) loss_u loss_u 0.9717 (0.9567) acc_u 3.1250 (5.0000) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [15/27] time 0.342 (0.343) data 0.216 (0.216) loss_u loss_u 0.9976 (0.9549) acc_u 0.0000 (5.2083) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [20/27] time 0.339 (0.343) data 0.211 (0.215) loss_u loss_u 0.8818 (0.9576) acc_u 12.5000 (4.8438) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/27] time 0.334 (0.343) data 0.211 (0.215) loss_u loss_u 0.9976 (0.9588) acc_u 0.0000 (4.6250) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 247
confident_label rate tensor(0.4602, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 751
clean true:739
clean false:12
clean_rate:0.9840213049267643
noisy true:646
noisy false:235
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 881
epoch [194/200] batch [5/23] time 0.344 (0.343) data 0.218 (0.215) loss_x loss_x 0.1619 (0.2128) acc_x 100.0000 (96.8750) lr 7.8853e-06 eta 0:00:06
epoch [194/200] batch [10/23] time 0.339 (0.342) data 0.210 (0.215) loss_x loss_x 0.1937 (0.2462) acc_x 93.7500 (95.3125) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/23] time 0.334 (0.342) data 0.208 (0.215) loss_x loss_x 0.3359 (0.2788) acc_x 93.7500 (95.0000) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/23] time 0.339 (0.342) data 0.214 (0.216) loss_x loss_x 0.2878 (0.2707) acc_x 93.7500 (94.6875) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [5/27] time 0.336 (0.340) data 0.208 (0.215) loss_u loss_u 0.9907 (0.9342) acc_u 0.0000 (7.5000) lr 7.8853e-06 eta 0:00:07
epoch [194/200] batch [10/27] time 0.351 (0.341) data 0.224 (0.215) loss_u loss_u 0.9736 (0.9433) acc_u 3.1250 (6.8750) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [15/27] time 0.344 (0.341) data 0.216 (0.215) loss_u loss_u 0.9722 (0.9526) acc_u 3.1250 (5.8333) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [20/27] time 0.297 (0.340) data 0.219 (0.215) loss_u loss_u 0.9546 (0.9560) acc_u 6.2500 (5.3125) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/27] time 0.347 (0.341) data 0.219 (0.215) loss_u loss_u 0.9961 (0.9577) acc_u 0.0000 (5.1250) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 245
confident_label rate tensor(0.4626, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 755
clean true:744
clean false:11
clean_rate:0.9854304635761589
noisy true:643
noisy false:234
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 877
epoch [195/200] batch [5/23] time 0.343 (0.348) data 0.214 (0.221) loss_x loss_x 0.1682 (0.1737) acc_x 100.0000 (97.5000) lr 6.0390e-06 eta 0:00:06
epoch [195/200] batch [10/23] time 0.352 (0.347) data 0.223 (0.220) loss_x loss_x 0.1479 (0.2011) acc_x 100.0000 (97.1875) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/23] time 0.347 (0.347) data 0.219 (0.219) loss_x loss_x 0.3726 (0.2435) acc_x 87.5000 (95.4167) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/23] time 0.350 (0.346) data 0.225 (0.218) loss_x loss_x 0.2876 (0.2647) acc_x 90.6250 (95.3125) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [5/27] time 0.347 (0.344) data 0.220 (0.218) loss_u loss_u 0.9668 (0.9626) acc_u 3.1250 (5.0000) lr 6.0390e-06 eta 0:00:07
epoch [195/200] batch [10/27] time 0.343 (0.344) data 0.214 (0.218) loss_u loss_u 0.9814 (0.9679) acc_u 3.1250 (4.0625) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [15/27] time 0.352 (0.343) data 0.223 (0.218) loss_u loss_u 0.9834 (0.9688) acc_u 3.1250 (3.9583) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [20/27] time 0.356 (0.343) data 0.229 (0.218) loss_u loss_u 0.9375 (0.9627) acc_u 6.2500 (4.3750) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/27] time 0.340 (0.343) data 0.210 (0.217) loss_u loss_u 0.9717 (0.9564) acc_u 3.1250 (5.0000) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 238
confident_label rate tensor(0.4589, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 749
clean true:739
clean false:10
clean_rate:0.986648865153538
noisy true:655
noisy false:228
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 883
epoch [196/200] batch [5/23] time 0.342 (0.339) data 0.214 (0.213) loss_x loss_x 0.3501 (0.3896) acc_x 93.7500 (92.5000) lr 4.4380e-06 eta 0:00:06
epoch [196/200] batch [10/23] time 0.338 (0.340) data 0.212 (0.213) loss_x loss_x 0.2441 (0.3357) acc_x 100.0000 (93.7500) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/23] time 0.351 (0.341) data 0.223 (0.215) loss_x loss_x 0.1305 (0.2837) acc_x 96.8750 (94.7917) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/23] time 0.335 (0.339) data 0.210 (0.214) loss_x loss_x 0.2048 (0.2688) acc_x 96.8750 (95.0000) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [5/27] time 0.352 (0.340) data 0.220 (0.214) loss_u loss_u 0.9697 (0.9509) acc_u 3.1250 (5.6250) lr 4.4380e-06 eta 0:00:07
epoch [196/200] batch [10/27] time 0.336 (0.340) data 0.206 (0.214) loss_u loss_u 0.9434 (0.9529) acc_u 6.2500 (5.3125) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [15/27] time 0.339 (0.340) data 0.212 (0.215) loss_u loss_u 0.9702 (0.9589) acc_u 3.1250 (4.5833) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [20/27] time 0.353 (0.341) data 0.225 (0.215) loss_u loss_u 0.9375 (0.9538) acc_u 6.2500 (5.1562) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/27] time 0.351 (0.341) data 0.220 (0.215) loss_u loss_u 0.9272 (0.9503) acc_u 9.3750 (5.6250) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 249
confident_label rate tensor(0.4583, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 748
clean true:737
clean false:11
clean_rate:0.9852941176470589
noisy true:646
noisy false:238
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 884
epoch [197/200] batch [5/23] time 0.345 (0.344) data 0.218 (0.217) loss_x loss_x 0.2200 (0.2334) acc_x 93.7500 (94.3750) lr 3.0827e-06 eta 0:00:06
epoch [197/200] batch [10/23] time 0.347 (0.343) data 0.220 (0.216) loss_x loss_x 0.2101 (0.2537) acc_x 93.7500 (94.0625) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/23] time 0.341 (0.342) data 0.213 (0.216) loss_x loss_x 0.1129 (0.2356) acc_x 100.0000 (94.7917) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/23] time 0.350 (0.342) data 0.219 (0.215) loss_x loss_x 0.2126 (0.2404) acc_x 96.8750 (94.8438) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [5/27] time 0.339 (0.340) data 0.210 (0.215) loss_u loss_u 0.9077 (0.9486) acc_u 9.3750 (5.0000) lr 3.0827e-06 eta 0:00:07
epoch [197/200] batch [10/27] time 0.345 (0.342) data 0.217 (0.216) loss_u loss_u 0.9976 (0.9491) acc_u 0.0000 (5.3125) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [15/27] time 0.344 (0.342) data 0.216 (0.216) loss_u loss_u 0.9399 (0.9435) acc_u 6.2500 (5.8333) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [20/27] time 0.351 (0.343) data 0.220 (0.216) loss_u loss_u 0.9487 (0.9468) acc_u 6.2500 (5.6250) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/27] time 0.342 (0.343) data 0.215 (0.216) loss_u loss_u 0.9673 (0.9501) acc_u 3.1250 (5.2500) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.4645, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 758
clean true:745
clean false:13
clean_rate:0.9828496042216359
noisy true:643
noisy false:231
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 874
epoch [198/200] batch [5/23] time 0.351 (0.331) data 0.222 (0.214) loss_x loss_x 0.1558 (0.3864) acc_x 100.0000 (91.2500) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [10/23] time 0.350 (0.338) data 0.222 (0.216) loss_x loss_x 0.3174 (0.3217) acc_x 90.6250 (92.1875) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/23] time 0.346 (0.339) data 0.218 (0.215) loss_x loss_x 0.2561 (0.3391) acc_x 93.7500 (92.7083) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/23] time 0.388 (0.343) data 0.262 (0.219) loss_x loss_x 0.0828 (0.3095) acc_x 100.0000 (93.5938) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [5/27] time 0.335 (0.345) data 0.209 (0.220) loss_u loss_u 0.9468 (0.9607) acc_u 6.2500 (5.0000) lr 1.9733e-06 eta 0:00:07
epoch [198/200] batch [10/27] time 0.340 (0.344) data 0.210 (0.219) loss_u loss_u 0.9028 (0.9609) acc_u 9.3750 (4.6875) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [15/27] time 0.339 (0.344) data 0.210 (0.218) loss_u loss_u 0.9663 (0.9645) acc_u 3.1250 (4.3750) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [20/27] time 0.340 (0.344) data 0.213 (0.218) loss_u loss_u 0.9341 (0.9591) acc_u 6.2500 (5.0000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/27] time 0.356 (0.344) data 0.227 (0.218) loss_u loss_u 0.9482 (0.9619) acc_u 6.2500 (4.6250) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 244
confident_label rate tensor(0.4559, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 744
clean true:732
clean false:12
clean_rate:0.9838709677419355
noisy true:656
noisy false:232
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 888
epoch [199/200] batch [5/23] time 0.300 (0.346) data 0.222 (0.228) loss_x loss_x 0.1511 (0.1704) acc_x 96.8750 (97.5000) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [10/23] time 0.343 (0.349) data 0.216 (0.223) loss_x loss_x 0.2959 (0.1944) acc_x 93.7500 (96.8750) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/23] time 0.345 (0.347) data 0.216 (0.220) loss_x loss_x 0.1978 (0.1910) acc_x 96.8750 (96.8750) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/23] time 0.350 (0.346) data 0.218 (0.219) loss_x loss_x 0.3691 (0.2202) acc_x 90.6250 (96.0938) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [5/27] time 0.356 (0.345) data 0.228 (0.218) loss_u loss_u 1.0000 (0.9643) acc_u 0.0000 (5.6250) lr 1.1101e-06 eta 0:00:07
epoch [199/200] batch [10/27] time 0.296 (0.344) data 0.218 (0.218) loss_u loss_u 0.9604 (0.9505) acc_u 6.2500 (6.5625) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [15/27] time 0.341 (0.343) data 0.212 (0.217) loss_u loss_u 0.9346 (0.9458) acc_u 6.2500 (6.6667) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [20/27] time 0.336 (0.343) data 0.209 (0.217) loss_u loss_u 0.9663 (0.9467) acc_u 3.1250 (6.2500) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/27] time 0.336 (0.343) data 0.210 (0.217) loss_u loss_u 0.9390 (0.9490) acc_u 6.2500 (5.8750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
[OT_PL] Loading all features and outputs... Total samples: 1632
[OT_PL] Features shape: torch.Size([1632, 1024]), Outputs shape: torch.Size([1632, 102])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1632, 102]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1632]), b.shape=torch.Size([102]), P.shape=torch.Size([1632, 102]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1632, 102])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1632
before epoch:different number: 234
confident_label rate tensor(0.4614, device='cuda:0')
before: len(self.train) 1632
before: len of confident samples 753
clean true:739
clean false:14
clean_rate:0.9814077025232404
noisy true:659
noisy false:220
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 879
epoch [200/200] batch [5/23] time 0.342 (0.344) data 0.214 (0.217) loss_x loss_x 0.2034 (0.2145) acc_x 93.7500 (95.6250) lr 4.9344e-07 eta 0:00:06
epoch [200/200] batch [10/23] time 0.346 (0.344) data 0.219 (0.216) loss_x loss_x 0.2983 (0.2224) acc_x 96.8750 (95.6250) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/23] time 0.340 (0.343) data 0.213 (0.215) loss_x loss_x 0.1278 (0.2296) acc_x 100.0000 (95.2083) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/23] time 0.341 (0.342) data 0.215 (0.215) loss_x loss_x 0.6001 (0.2816) acc_x 84.3750 (93.7500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [5/27] time 0.339 (0.340) data 0.212 (0.214) loss_u loss_u 0.9150 (0.9301) acc_u 9.3750 (7.5000) lr 4.9344e-07 eta 0:00:07
epoch [200/200] batch [10/27] time 0.339 (0.341) data 0.211 (0.214) loss_u loss_u 0.8574 (0.9291) acc_u 15.6250 (7.8125) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [15/27] time 0.344 (0.341) data 0.218 (0.215) loss_u loss_u 1.0000 (0.9408) acc_u 0.0000 (6.4583) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [20/27] time 0.347 (0.342) data 0.219 (0.215) loss_u loss_u 0.9678 (0.9482) acc_u 3.1250 (5.6250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/27] time 0.377 (0.344) data 0.247 (0.217) loss_u loss_u 0.9990 (0.9522) acc_u 0.0000 (5.2500) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/oxford_flowers/NLPrompt/rn50_16shots/noise_sym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1632
after epoch: len(noisy dataset) 1632
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 2,463
* correct: 2,142
* accuracy: 87.0%
* error: 13.0%
* macro_f1: 85.9%
Elapsed: 2:30:06
