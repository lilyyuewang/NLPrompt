***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.0786, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 127
clean true:124
clean false:3
clean_rate:0.9763779527559056
noisy true:388
noisy false:1101
after delete: len(clean_dataset) 127
after delete: len(noisy_dataset) 1489
epoch [1/200] batch [1/3] time 0.277 (0.277) data 0.113 (0.113) loss_x loss_x 3.0215 (3.0215) acc_x 40.6250 (40.6250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/3] time 0.188 (0.232) data 0.111 (0.112) loss_x loss_x 2.5137 (2.7676) acc_x 50.0000 (45.3125) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [3/3] time 0.186 (0.217) data 0.110 (0.111) loss_x loss_x 2.5566 (2.6973) acc_x 53.1250 (47.9167) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/46] time 0.189 (0.204) data 0.112 (0.114) loss_u loss_u 0.9902 (0.9837) acc_u 3.1250 (3.1250) lr 1.0000e-05 eta 0:00:08
epoch [1/200] batch [10/46] time 0.188 (0.199) data 0.110 (0.114) loss_u loss_u 0.9854 (0.9828) acc_u 3.1250 (3.1250) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [15/46] time 0.194 (0.197) data 0.117 (0.115) loss_u loss_u 0.9790 (0.9823) acc_u 3.1250 (3.3333) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [20/46] time 0.192 (0.196) data 0.116 (0.115) loss_u loss_u 0.9883 (0.9818) acc_u 3.1250 (3.7500) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [25/46] time 0.192 (0.196) data 0.116 (0.115) loss_u loss_u 0.9849 (0.9812) acc_u 3.1250 (4.0000) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [30/46] time 0.194 (0.196) data 0.118 (0.116) loss_u loss_u 0.9893 (0.9810) acc_u 3.1250 (4.0625) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [35/46] time 0.196 (0.195) data 0.119 (0.116) loss_u loss_u 0.9775 (0.9806) acc_u 3.1250 (4.0179) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [40/46] time 0.193 (0.195) data 0.117 (0.116) loss_u loss_u 0.9814 (0.9803) acc_u 9.3750 (4.1406) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [45/46] time 0.191 (0.195) data 0.114 (0.116) loss_u loss_u 0.9834 (0.9799) acc_u 3.1250 (4.2361) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1046
confident_label rate tensor(0.0897, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 145
clean true:139
clean false:6
clean_rate:0.9586206896551724
noisy true:431
noisy false:1040
after delete: len(clean_dataset) 145
after delete: len(noisy_dataset) 1471
epoch [2/200] batch [1/4] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 2.0449 (2.0449) acc_x 65.6250 (65.6250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [2/4] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 1.5977 (1.8213) acc_x 65.6250 (65.6250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [3/4] time 0.175 (0.180) data 0.099 (0.103) loss_x loss_x 1.5059 (1.7161) acc_x 68.7500 (66.6667) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [4/4] time 0.169 (0.177) data 0.093 (0.101) loss_x loss_x 0.8306 (1.4948) acc_x 81.2500 (70.3125) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/45] time 0.167 (0.170) data 0.088 (0.093) loss_u loss_u 0.9199 (0.9414) acc_u 15.6250 (10.6250) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [10/45] time 0.183 (0.173) data 0.105 (0.096) loss_u loss_u 0.9204 (0.9447) acc_u 12.5000 (8.7500) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [15/45] time 0.167 (0.173) data 0.089 (0.096) loss_u loss_u 0.9888 (0.9515) acc_u 0.0000 (7.9167) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [20/45] time 0.175 (0.172) data 0.096 (0.095) loss_u loss_u 0.9780 (0.9559) acc_u 6.2500 (7.1875) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [25/45] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.9258 (0.9473) acc_u 12.5000 (8.2500) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [30/45] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.9414 (0.9511) acc_u 9.3750 (7.5000) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [35/45] time 0.181 (0.177) data 0.105 (0.100) loss_u loss_u 0.9570 (0.9503) acc_u 3.1250 (7.5000) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [40/45] time 0.182 (0.178) data 0.105 (0.100) loss_u loss_u 0.9692 (0.9486) acc_u 3.1250 (7.5781) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [45/45] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8599 (0.9475) acc_u 21.8750 (7.7083) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 811
confident_label rate tensor(0.1250, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 202
clean true:197
clean false:5
clean_rate:0.9752475247524752
noisy true:608
noisy false:806
after delete: len(clean_dataset) 202
after delete: len(noisy_dataset) 1414
epoch [3/200] batch [5/6] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.9341 (1.2148) acc_x 81.2500 (74.3750) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/44] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9727 (0.9536) acc_u 6.2500 (6.2500) lr 1.9999e-03 eta 0:00:07
epoch [3/200] batch [10/44] time 0.166 (0.180) data 0.089 (0.103) loss_u loss_u 0.9590 (0.9601) acc_u 3.1250 (5.0000) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [15/44] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.9766 (0.9602) acc_u 3.1250 (5.2083) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [20/44] time 0.181 (0.178) data 0.104 (0.100) loss_u loss_u 0.9722 (0.9600) acc_u 3.1250 (5.1562) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [25/44] time 0.177 (0.176) data 0.100 (0.098) loss_u loss_u 0.9614 (0.9618) acc_u 3.1250 (5.0000) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [30/44] time 0.171 (0.177) data 0.094 (0.099) loss_u loss_u 0.9678 (0.9615) acc_u 3.1250 (5.0000) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [35/44] time 0.175 (0.176) data 0.097 (0.099) loss_u loss_u 0.9629 (0.9621) acc_u 3.1250 (4.7321) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [40/44] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.9795 (0.9614) acc_u 3.1250 (4.6875) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 812
confident_label rate tensor(0.1380, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 223
clean true:216
clean false:7
clean_rate:0.968609865470852
noisy true:588
noisy false:805
after delete: len(clean_dataset) 223
after delete: len(noisy_dataset) 1393
epoch [4/200] batch [5/6] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 1.2510 (1.0221) acc_x 65.6250 (75.6250) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/43] time 0.194 (0.189) data 0.117 (0.112) loss_u loss_u 0.9375 (0.9660) acc_u 9.3750 (3.1250) lr 1.9995e-03 eta 0:00:07
epoch [4/200] batch [10/43] time 0.181 (0.188) data 0.104 (0.111) loss_u loss_u 0.9897 (0.9626) acc_u 0.0000 (3.7500) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [15/43] time 0.190 (0.188) data 0.113 (0.111) loss_u loss_u 0.9717 (0.9649) acc_u 3.1250 (3.7500) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [20/43] time 0.168 (0.187) data 0.091 (0.110) loss_u loss_u 0.9634 (0.9637) acc_u 3.1250 (3.9062) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [25/43] time 0.175 (0.185) data 0.097 (0.108) loss_u loss_u 0.9834 (0.9626) acc_u 0.0000 (4.1250) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [30/43] time 0.195 (0.186) data 0.118 (0.109) loss_u loss_u 0.9600 (0.9628) acc_u 3.1250 (3.9583) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [35/43] time 0.186 (0.186) data 0.109 (0.109) loss_u loss_u 0.9424 (0.9631) acc_u 6.2500 (4.0179) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [40/43] time 0.187 (0.186) data 0.109 (0.109) loss_u loss_u 0.9819 (0.9609) acc_u 3.1250 (4.3750) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 817
confident_label rate tensor(0.1442, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 233
clean true:226
clean false:7
clean_rate:0.9699570815450643
noisy true:573
noisy false:810
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 1383
epoch [5/200] batch [5/7] time 0.170 (0.186) data 0.094 (0.109) loss_x loss_x 1.1465 (1.0619) acc_x 71.8750 (72.5000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/43] time 0.176 (0.181) data 0.099 (0.104) loss_u loss_u 0.9180 (0.9551) acc_u 9.3750 (6.8750) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [10/43] time 0.179 (0.181) data 0.102 (0.104) loss_u loss_u 0.9790 (0.9689) acc_u 3.1250 (4.6875) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [15/43] time 0.191 (0.184) data 0.114 (0.108) loss_u loss_u 0.9951 (0.9715) acc_u 0.0000 (3.9583) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [20/43] time 0.185 (0.186) data 0.109 (0.109) loss_u loss_u 0.9829 (0.9719) acc_u 3.1250 (4.2188) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [25/43] time 0.170 (0.185) data 0.093 (0.108) loss_u loss_u 0.9902 (0.9715) acc_u 0.0000 (3.8750) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [30/43] time 0.161 (0.182) data 0.084 (0.105) loss_u loss_u 0.9785 (0.9685) acc_u 3.1250 (4.2708) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [35/43] time 0.188 (0.182) data 0.111 (0.105) loss_u loss_u 0.9678 (0.9668) acc_u 3.1250 (4.2857) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [40/43] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9707 (0.9680) acc_u 3.1250 (3.9062) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 762
confident_label rate tensor(0.1473, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 238
clean true:236
clean false:2
clean_rate:0.9915966386554622
noisy true:618
noisy false:760
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 1378
epoch [6/200] batch [5/7] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 1.5186 (1.1389) acc_x 59.3750 (68.7500) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/43] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9863 (0.9425) acc_u 3.1250 (6.2500) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [10/43] time 0.178 (0.184) data 0.101 (0.107) loss_u loss_u 0.9946 (0.9580) acc_u 0.0000 (5.0000) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [15/43] time 0.159 (0.182) data 0.081 (0.105) loss_u loss_u 0.9873 (0.9675) acc_u 0.0000 (3.5417) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [20/43] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9795 (0.9673) acc_u 3.1250 (3.7500) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [25/43] time 0.164 (0.180) data 0.087 (0.103) loss_u loss_u 0.9678 (0.9679) acc_u 3.1250 (3.6250) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [30/43] time 0.187 (0.178) data 0.110 (0.101) loss_u loss_u 0.9751 (0.9692) acc_u 0.0000 (3.3333) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [35/43] time 0.200 (0.179) data 0.122 (0.102) loss_u loss_u 0.9609 (0.9660) acc_u 3.1250 (3.7500) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [40/43] time 0.176 (0.179) data 0.098 (0.102) loss_u loss_u 0.9971 (0.9654) acc_u 0.0000 (3.6719) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 802
confident_label rate tensor(0.1386, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 224
clean true:217
clean false:7
clean_rate:0.96875
noisy true:597
noisy false:795
after delete: len(clean_dataset) 224
after delete: len(noisy_dataset) 1392
epoch [7/200] batch [5/7] time 0.162 (0.182) data 0.085 (0.105) loss_x loss_x 0.8774 (0.9579) acc_x 71.8750 (75.6250) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/43] time 0.164 (0.174) data 0.087 (0.097) loss_u loss_u 0.9951 (0.9730) acc_u 0.0000 (3.7500) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [10/43] time 0.161 (0.171) data 0.084 (0.094) loss_u loss_u 0.9668 (0.9687) acc_u 3.1250 (3.7500) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [15/43] time 0.179 (0.174) data 0.101 (0.097) loss_u loss_u 0.9712 (0.9626) acc_u 3.1250 (3.9583) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [20/43] time 0.173 (0.175) data 0.096 (0.098) loss_u loss_u 0.9336 (0.9541) acc_u 9.3750 (5.3125) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [25/43] time 0.188 (0.175) data 0.111 (0.098) loss_u loss_u 0.9492 (0.9566) acc_u 9.3750 (5.3750) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [30/43] time 0.170 (0.176) data 0.092 (0.099) loss_u loss_u 0.9429 (0.9552) acc_u 6.2500 (5.4167) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [35/43] time 0.193 (0.177) data 0.115 (0.100) loss_u loss_u 0.9028 (0.9559) acc_u 12.5000 (5.2679) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [40/43] time 0.186 (0.178) data 0.108 (0.100) loss_u loss_u 0.9556 (0.9556) acc_u 6.2500 (5.3906) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 775
confident_label rate tensor(0.1442, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 233
clean true:228
clean false:5
clean_rate:0.9785407725321889
noisy true:613
noisy false:770
after delete: len(clean_dataset) 233
after delete: len(noisy_dataset) 1383
epoch [8/200] batch [5/7] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 1.7471 (1.0438) acc_x 62.5000 (75.6250) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/43] time 0.184 (0.182) data 0.106 (0.104) loss_u loss_u 0.9922 (0.9779) acc_u 0.0000 (2.5000) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [10/43] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9585 (0.9718) acc_u 3.1250 (3.1250) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [15/43] time 0.181 (0.182) data 0.105 (0.105) loss_u loss_u 0.9663 (0.9602) acc_u 3.1250 (4.3750) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [20/43] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 0.9272 (0.9585) acc_u 6.2500 (4.3750) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [25/43] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.9238 (0.9578) acc_u 9.3750 (4.6250) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [30/43] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.9980 (0.9590) acc_u 0.0000 (4.6875) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [35/43] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.9082 (0.9564) acc_u 9.3750 (4.8214) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [40/43] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9590 (0.9588) acc_u 6.2500 (4.6094) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 786
confident_label rate tensor(0.1460, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 236
clean true:230
clean false:6
clean_rate:0.9745762711864406
noisy true:600
noisy false:780
after delete: len(clean_dataset) 236
after delete: len(noisy_dataset) 1380
epoch [9/200] batch [5/7] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.4109 (0.9282) acc_x 90.6250 (78.7500) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/43] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.9648 (0.9644) acc_u 3.1250 (4.3750) lr 1.9940e-03 eta 0:00:07
epoch [9/200] batch [10/43] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9785 (0.9698) acc_u 3.1250 (3.7500) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [15/43] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.9326 (0.9687) acc_u 9.3750 (3.9583) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [20/43] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9644 (0.9703) acc_u 3.1250 (3.5938) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [25/43] time 0.157 (0.182) data 0.080 (0.105) loss_u loss_u 0.9624 (0.9693) acc_u 6.2500 (3.8750) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [30/43] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9937 (0.9650) acc_u 0.0000 (4.2708) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [35/43] time 0.233 (0.182) data 0.156 (0.105) loss_u loss_u 0.9805 (0.9674) acc_u 6.2500 (4.1071) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [40/43] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9663 (0.9637) acc_u 6.2500 (4.6094) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 826
confident_label rate tensor(0.1485, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 240
clean true:234
clean false:6
clean_rate:0.975
noisy true:556
noisy false:820
after delete: len(clean_dataset) 240
after delete: len(noisy_dataset) 1376
epoch [10/200] batch [5/7] time 0.181 (0.181) data 0.105 (0.105) loss_x loss_x 1.1602 (1.2124) acc_x 78.1250 (72.5000) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/43] time 0.165 (0.179) data 0.087 (0.102) loss_u loss_u 0.9814 (0.9691) acc_u 3.1250 (4.3750) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [10/43] time 0.164 (0.176) data 0.087 (0.099) loss_u loss_u 0.9897 (0.9628) acc_u 3.1250 (5.6250) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [15/43] time 0.206 (0.175) data 0.129 (0.098) loss_u loss_u 0.9883 (0.9569) acc_u 0.0000 (5.6250) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [20/43] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9268 (0.9531) acc_u 9.3750 (5.7812) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [25/43] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9648 (0.9531) acc_u 3.1250 (5.5000) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [30/43] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9531 (0.9547) acc_u 6.2500 (5.3125) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [35/43] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9116 (0.9543) acc_u 9.3750 (5.2679) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [40/43] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9863 (0.9558) acc_u 0.0000 (5.0000) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 789
confident_label rate tensor(0.1473, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 238
clean true:232
clean false:6
clean_rate:0.9747899159663865
noisy true:595
noisy false:783
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 1378
epoch [11/200] batch [5/7] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.5444 (0.8416) acc_x 84.3750 (78.7500) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/43] time 0.170 (0.178) data 0.094 (0.101) loss_u loss_u 0.9487 (0.9558) acc_u 9.3750 (5.6250) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [10/43] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9668 (0.9587) acc_u 6.2500 (5.6250) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [15/43] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9985 (0.9607) acc_u 0.0000 (5.0000) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [20/43] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9712 (0.9570) acc_u 3.1250 (5.4688) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [25/43] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9912 (0.9582) acc_u 0.0000 (5.2500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [30/43] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.9775 (0.9616) acc_u 3.1250 (4.8958) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [35/43] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9292 (0.9570) acc_u 6.2500 (5.2679) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [40/43] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.9702 (0.9546) acc_u 3.1250 (5.6250) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 751
confident_label rate tensor(0.1566, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 253
clean true:249
clean false:4
clean_rate:0.9841897233201581
noisy true:616
noisy false:747
after delete: len(clean_dataset) 253
after delete: len(noisy_dataset) 1363
epoch [12/200] batch [5/7] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 1.0361 (1.0025) acc_x 75.0000 (73.7500) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/42] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.9526 (0.9685) acc_u 6.2500 (2.5000) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [10/42] time 0.182 (0.184) data 0.104 (0.106) loss_u loss_u 0.9507 (0.9680) acc_u 3.1250 (3.1250) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [15/42] time 0.186 (0.184) data 0.108 (0.106) loss_u loss_u 0.9712 (0.9680) acc_u 0.0000 (3.3333) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [20/42] time 0.215 (0.185) data 0.137 (0.107) loss_u loss_u 0.9902 (0.9680) acc_u 0.0000 (3.5938) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [25/42] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9619 (0.9678) acc_u 3.1250 (3.5000) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [30/42] time 0.185 (0.185) data 0.107 (0.107) loss_u loss_u 0.9409 (0.9676) acc_u 9.3750 (3.6458) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [35/42] time 0.184 (0.185) data 0.106 (0.107) loss_u loss_u 0.9834 (0.9658) acc_u 3.1250 (3.9286) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [40/42] time 0.186 (0.185) data 0.108 (0.107) loss_u loss_u 0.9629 (0.9661) acc_u 3.1250 (3.8281) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 765
confident_label rate tensor(0.1467, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 237
clean true:230
clean false:7
clean_rate:0.9704641350210971
noisy true:621
noisy false:758
after delete: len(clean_dataset) 237
after delete: len(noisy_dataset) 1379
epoch [13/200] batch [5/7] time 0.177 (0.189) data 0.100 (0.113) loss_x loss_x 1.1143 (1.1314) acc_x 71.8750 (70.0000) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/43] time 0.181 (0.181) data 0.104 (0.105) loss_u loss_u 0.9409 (0.9514) acc_u 6.2500 (6.2500) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [10/43] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.9448 (0.9569) acc_u 6.2500 (5.0000) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [15/43] time 0.173 (0.180) data 0.096 (0.103) loss_u loss_u 0.9951 (0.9614) acc_u 0.0000 (4.1667) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [20/43] time 0.171 (0.180) data 0.095 (0.103) loss_u loss_u 0.9927 (0.9615) acc_u 0.0000 (4.0625) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [25/43] time 0.160 (0.178) data 0.082 (0.101) loss_u loss_u 0.9736 (0.9605) acc_u 3.1250 (4.6250) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [30/43] time 0.167 (0.176) data 0.091 (0.099) loss_u loss_u 0.9966 (0.9631) acc_u 0.0000 (4.2708) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [35/43] time 0.166 (0.175) data 0.088 (0.098) loss_u loss_u 0.9497 (0.9614) acc_u 6.2500 (4.6429) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [40/43] time 0.167 (0.173) data 0.089 (0.096) loss_u loss_u 0.9385 (0.9586) acc_u 9.3750 (5.0000) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 802
confident_label rate tensor(0.1528, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 247
clean true:236
clean false:11
clean_rate:0.9554655870445344
noisy true:578
noisy false:791
after delete: len(clean_dataset) 247
after delete: len(noisy_dataset) 1369
epoch [14/200] batch [5/7] time 0.201 (0.206) data 0.125 (0.129) loss_x loss_x 0.8804 (0.9923) acc_x 75.0000 (78.1250) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/42] time 0.163 (0.197) data 0.085 (0.120) loss_u loss_u 0.8994 (0.9238) acc_u 12.5000 (9.3750) lr 1.9823e-03 eta 0:00:07
epoch [14/200] batch [10/42] time 0.180 (0.194) data 0.103 (0.117) loss_u loss_u 0.9844 (0.9412) acc_u 3.1250 (7.5000) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [15/42] time 0.177 (0.187) data 0.099 (0.111) loss_u loss_u 0.9570 (0.9406) acc_u 6.2500 (7.2917) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [20/42] time 0.182 (0.186) data 0.105 (0.109) loss_u loss_u 0.9907 (0.9403) acc_u 0.0000 (7.3438) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [25/42] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9731 (0.9453) acc_u 3.1250 (6.5000) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [30/42] time 0.166 (0.183) data 0.088 (0.106) loss_u loss_u 0.9434 (0.9464) acc_u 6.2500 (6.2500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [35/42] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9668 (0.9470) acc_u 3.1250 (6.1607) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [40/42] time 0.160 (0.182) data 0.083 (0.105) loss_u loss_u 0.9834 (0.9508) acc_u 0.0000 (5.6250) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 744
confident_label rate tensor(0.1559, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 252
clean true:248
clean false:4
clean_rate:0.9841269841269841
noisy true:624
noisy false:740
after delete: len(clean_dataset) 252
after delete: len(noisy_dataset) 1364
epoch [15/200] batch [5/7] time 0.171 (0.182) data 0.094 (0.106) loss_x loss_x 0.7568 (0.8862) acc_x 75.0000 (78.1250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/42] time 0.176 (0.182) data 0.098 (0.105) loss_u loss_u 0.9844 (0.9688) acc_u 3.1250 (3.7500) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [10/42] time 0.188 (0.185) data 0.110 (0.107) loss_u loss_u 0.9736 (0.9626) acc_u 6.2500 (4.6875) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/42] time 0.186 (0.185) data 0.109 (0.107) loss_u loss_u 0.9707 (0.9660) acc_u 3.1250 (4.3750) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [20/42] time 0.189 (0.185) data 0.112 (0.107) loss_u loss_u 0.9888 (0.9651) acc_u 0.0000 (4.2188) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [25/42] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9780 (0.9663) acc_u 0.0000 (4.0000) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [30/42] time 0.160 (0.183) data 0.082 (0.106) loss_u loss_u 0.9263 (0.9653) acc_u 6.2500 (4.0625) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [35/42] time 0.168 (0.182) data 0.091 (0.105) loss_u loss_u 0.9956 (0.9681) acc_u 0.0000 (3.5714) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [40/42] time 0.173 (0.181) data 0.095 (0.104) loss_u loss_u 0.9873 (0.9660) acc_u 0.0000 (3.7500) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 802
confident_label rate tensor(0.1578, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 255
clean true:249
clean false:6
clean_rate:0.9764705882352941
noisy true:565
noisy false:796
after delete: len(clean_dataset) 255
after delete: len(noisy_dataset) 1361
epoch [16/200] batch [5/7] time 0.228 (0.196) data 0.152 (0.119) loss_x loss_x 0.5845 (0.8623) acc_x 87.5000 (79.3750) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/42] time 0.177 (0.179) data 0.101 (0.102) loss_u loss_u 0.9272 (0.9588) acc_u 9.3750 (5.0000) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [10/42] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.9663 (0.9517) acc_u 3.1250 (5.3125) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [15/42] time 0.161 (0.176) data 0.084 (0.099) loss_u loss_u 0.8594 (0.9505) acc_u 18.7500 (5.6250) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [20/42] time 0.202 (0.177) data 0.126 (0.100) loss_u loss_u 0.9307 (0.9476) acc_u 9.3750 (6.2500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [25/42] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9790 (0.9527) acc_u 0.0000 (5.5000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [30/42] time 0.185 (0.180) data 0.108 (0.102) loss_u loss_u 0.9150 (0.9560) acc_u 9.3750 (5.1042) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [35/42] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.9277 (0.9556) acc_u 9.3750 (5.0000) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [40/42] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9297 (0.9577) acc_u 6.2500 (4.7656) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 765
confident_label rate tensor(0.1547, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 250
clean true:243
clean false:7
clean_rate:0.972
noisy true:608
noisy false:758
after delete: len(clean_dataset) 250
after delete: len(noisy_dataset) 1366
epoch [17/200] batch [5/7] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.5728 (0.8688) acc_x 78.1250 (75.6250) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/42] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9727 (0.9771) acc_u 3.1250 (1.8750) lr 1.9724e-03 eta 0:00:06
epoch [17/200] batch [10/42] time 0.178 (0.182) data 0.100 (0.104) loss_u loss_u 0.9634 (0.9673) acc_u 3.1250 (3.4375) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [15/42] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.9658 (0.9585) acc_u 3.1250 (4.5833) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [20/42] time 0.182 (0.180) data 0.106 (0.103) loss_u loss_u 0.9590 (0.9601) acc_u 3.1250 (4.2188) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [25/42] time 0.183 (0.180) data 0.106 (0.102) loss_u loss_u 0.9604 (0.9598) acc_u 3.1250 (4.3750) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [30/42] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.9263 (0.9603) acc_u 9.3750 (4.3750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [35/42] time 0.160 (0.178) data 0.083 (0.101) loss_u loss_u 0.9893 (0.9615) acc_u 3.1250 (4.4643) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [40/42] time 0.180 (0.177) data 0.102 (0.100) loss_u loss_u 0.9180 (0.9584) acc_u 6.2500 (4.8438) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 718
confident_label rate tensor(0.1640, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 265
clean true:257
clean false:8
clean_rate:0.969811320754717
noisy true:641
noisy false:710
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 1351
epoch [18/200] batch [5/8] time 0.183 (0.193) data 0.106 (0.116) loss_x loss_x 1.0479 (0.9059) acc_x 78.1250 (81.2500) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/42] time 0.192 (0.181) data 0.114 (0.103) loss_u loss_u 0.9502 (0.9687) acc_u 6.2500 (4.3750) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [10/42] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9517 (0.9660) acc_u 6.2500 (4.3750) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [15/42] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.9526 (0.9664) acc_u 3.1250 (4.1667) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [20/42] time 0.188 (0.179) data 0.112 (0.102) loss_u loss_u 0.9912 (0.9605) acc_u 0.0000 (5.0000) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [25/42] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9648 (0.9602) acc_u 3.1250 (4.8750) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [30/42] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9590 (0.9594) acc_u 6.2500 (5.0000) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [35/42] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9404 (0.9605) acc_u 9.3750 (4.9107) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [40/42] time 0.185 (0.181) data 0.108 (0.103) loss_u loss_u 0.9829 (0.9630) acc_u 3.1250 (4.5312) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 732
confident_label rate tensor(0.1590, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 257
clean true:250
clean false:7
clean_rate:0.9727626459143969
noisy true:634
noisy false:725
after delete: len(clean_dataset) 257
after delete: len(noisy_dataset) 1359
epoch [19/200] batch [5/8] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 1.0879 (1.0503) acc_x 71.8750 (73.7500) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/42] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.9951 (0.9743) acc_u 0.0000 (3.1250) lr 1.9646e-03 eta 0:00:06
epoch [19/200] batch [10/42] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9150 (0.9647) acc_u 9.3750 (4.3750) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [15/42] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.9966 (0.9615) acc_u 0.0000 (4.3750) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [20/42] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.9883 (0.9646) acc_u 0.0000 (3.9062) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [25/42] time 0.182 (0.182) data 0.106 (0.106) loss_u loss_u 0.9512 (0.9657) acc_u 6.2500 (3.7500) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [30/42] time 0.182 (0.182) data 0.105 (0.106) loss_u loss_u 0.9331 (0.9598) acc_u 6.2500 (4.4792) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [35/42] time 0.181 (0.182) data 0.103 (0.106) loss_u loss_u 0.9624 (0.9589) acc_u 6.2500 (4.7321) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [40/42] time 0.186 (0.182) data 0.109 (0.106) loss_u loss_u 0.9648 (0.9581) acc_u 3.1250 (4.7656) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 750
confident_label rate tensor(0.1597, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 258
clean true:253
clean false:5
clean_rate:0.9806201550387597
noisy true:613
noisy false:745
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 1358
epoch [20/200] batch [5/8] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.5342 (0.8211) acc_x 81.2500 (80.0000) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/42] time 0.179 (0.184) data 0.101 (0.107) loss_u loss_u 0.9707 (0.9428) acc_u 3.1250 (6.8750) lr 1.9603e-03 eta 0:00:06
epoch [20/200] batch [10/42] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.9644 (0.9559) acc_u 3.1250 (5.3125) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [15/42] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9717 (0.9525) acc_u 3.1250 (6.0417) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [20/42] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9536 (0.9543) acc_u 6.2500 (5.4688) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [25/42] time 0.187 (0.183) data 0.110 (0.106) loss_u loss_u 0.9673 (0.9553) acc_u 3.1250 (5.2500) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [30/42] time 0.184 (0.183) data 0.108 (0.107) loss_u loss_u 0.9995 (0.9588) acc_u 0.0000 (4.8958) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [35/42] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.9170 (0.9589) acc_u 6.2500 (4.9107) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [40/42] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9990 (0.9603) acc_u 0.0000 (4.6875) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 720
confident_label rate tensor(0.1609, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 260
clean true:257
clean false:3
clean_rate:0.9884615384615385
noisy true:639
noisy false:717
after delete: len(clean_dataset) 260
after delete: len(noisy_dataset) 1356
epoch [21/200] batch [5/8] time 0.166 (0.179) data 0.089 (0.103) loss_x loss_x 0.7349 (0.8782) acc_x 78.1250 (78.1250) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/42] time 0.187 (0.185) data 0.109 (0.108) loss_u loss_u 0.9497 (0.9417) acc_u 6.2500 (6.8750) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [10/42] time 0.173 (0.182) data 0.096 (0.105) loss_u loss_u 0.9287 (0.9357) acc_u 6.2500 (7.8125) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [15/42] time 0.181 (0.182) data 0.103 (0.104) loss_u loss_u 0.9634 (0.9486) acc_u 3.1250 (6.2500) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [20/42] time 0.182 (0.182) data 0.106 (0.105) loss_u loss_u 0.9966 (0.9531) acc_u 0.0000 (5.9375) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [25/42] time 0.183 (0.180) data 0.107 (0.103) loss_u loss_u 0.9961 (0.9557) acc_u 0.0000 (5.5000) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [30/42] time 0.185 (0.180) data 0.109 (0.103) loss_u loss_u 0.9658 (0.9583) acc_u 6.2500 (5.5208) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [35/42] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9683 (0.9587) acc_u 3.1250 (5.5357) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [40/42] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9658 (0.9595) acc_u 3.1250 (5.3125) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 758
confident_label rate tensor(0.1597, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 258
clean true:250
clean false:8
clean_rate:0.9689922480620154
noisy true:608
noisy false:750
after delete: len(clean_dataset) 258
after delete: len(noisy_dataset) 1358
epoch [22/200] batch [5/8] time 0.178 (0.170) data 0.100 (0.093) loss_x loss_x 0.6147 (0.8164) acc_x 81.2500 (79.3750) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/42] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.8945 (0.9496) acc_u 12.5000 (5.0000) lr 1.9511e-03 eta 0:00:06
epoch [22/200] batch [10/42] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9238 (0.9483) acc_u 9.3750 (5.9375) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [15/42] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.9976 (0.9512) acc_u 0.0000 (5.8333) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [20/42] time 0.161 (0.179) data 0.084 (0.102) loss_u loss_u 0.9443 (0.9530) acc_u 3.1250 (5.4688) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [25/42] time 0.185 (0.180) data 0.109 (0.103) loss_u loss_u 0.9492 (0.9559) acc_u 9.3750 (5.3750) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [30/42] time 0.184 (0.180) data 0.108 (0.103) loss_u loss_u 0.9595 (0.9554) acc_u 6.2500 (5.3125) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [35/42] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9648 (0.9545) acc_u 3.1250 (5.4464) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [40/42] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.9580 (0.9562) acc_u 6.2500 (5.4688) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 750
confident_label rate tensor(0.1658, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 268
clean true:258
clean false:10
clean_rate:0.9626865671641791
noisy true:608
noisy false:740
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 1348
epoch [23/200] batch [5/8] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.7827 (0.9456) acc_x 84.3750 (75.6250) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/42] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9707 (0.9713) acc_u 3.1250 (3.7500) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [10/42] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9785 (0.9531) acc_u 3.1250 (5.6250) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [15/42] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9717 (0.9586) acc_u 3.1250 (4.7917) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [20/42] time 0.184 (0.185) data 0.107 (0.107) loss_u loss_u 0.9600 (0.9588) acc_u 3.1250 (4.6875) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [25/42] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.9072 (0.9571) acc_u 9.3750 (4.8750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [30/42] time 0.186 (0.186) data 0.108 (0.108) loss_u loss_u 0.9746 (0.9584) acc_u 3.1250 (4.6875) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [35/42] time 0.187 (0.185) data 0.109 (0.108) loss_u loss_u 0.9727 (0.9610) acc_u 6.2500 (4.3750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [40/42] time 0.182 (0.185) data 0.106 (0.108) loss_u loss_u 0.9678 (0.9602) acc_u 3.1250 (4.5312) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 721
confident_label rate tensor(0.1615, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 261
clean true:252
clean false:9
clean_rate:0.9655172413793104
noisy true:643
noisy false:712
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 1355
epoch [24/200] batch [5/8] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.7705 (1.0097) acc_x 78.1250 (73.7500) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/42] time 0.169 (0.178) data 0.093 (0.102) loss_u loss_u 0.9336 (0.9543) acc_u 6.2500 (5.6250) lr 1.9409e-03 eta 0:00:06
epoch [24/200] batch [10/42] time 0.185 (0.178) data 0.109 (0.101) loss_u loss_u 0.9561 (0.9485) acc_u 9.3750 (6.2500) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [15/42] time 0.193 (0.180) data 0.116 (0.103) loss_u loss_u 0.9771 (0.9562) acc_u 9.3750 (5.6250) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [20/42] time 0.159 (0.177) data 0.082 (0.100) loss_u loss_u 0.9927 (0.9557) acc_u 0.0000 (5.4688) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [25/42] time 0.183 (0.177) data 0.106 (0.101) loss_u loss_u 0.9761 (0.9575) acc_u 3.1250 (5.2500) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [30/42] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.9912 (0.9599) acc_u 3.1250 (5.1042) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [35/42] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.9360 (0.9563) acc_u 6.2500 (5.3571) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [40/42] time 0.183 (0.179) data 0.107 (0.103) loss_u loss_u 0.9565 (0.9567) acc_u 3.1250 (5.2344) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 712
confident_label rate tensor(0.1646, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 266
clean true:262
clean false:4
clean_rate:0.9849624060150376
noisy true:642
noisy false:708
after delete: len(clean_dataset) 266
after delete: len(noisy_dataset) 1350
epoch [25/200] batch [5/8] time 0.169 (0.184) data 0.092 (0.107) loss_x loss_x 0.5845 (0.7566) acc_x 87.5000 (79.3750) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/42] time 0.172 (0.173) data 0.094 (0.096) loss_u loss_u 0.9629 (0.9601) acc_u 3.1250 (3.7500) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [10/42] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.9990 (0.9694) acc_u 0.0000 (3.1250) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [15/42] time 0.161 (0.172) data 0.084 (0.095) loss_u loss_u 0.9375 (0.9643) acc_u 6.2500 (3.7500) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [20/42] time 0.186 (0.174) data 0.108 (0.097) loss_u loss_u 0.9619 (0.9613) acc_u 3.1250 (4.0625) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/42] time 0.162 (0.173) data 0.085 (0.096) loss_u loss_u 0.9971 (0.9598) acc_u 0.0000 (4.5000) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [30/42] time 0.185 (0.172) data 0.108 (0.095) loss_u loss_u 0.9717 (0.9623) acc_u 3.1250 (4.0625) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [35/42] time 0.164 (0.173) data 0.087 (0.096) loss_u loss_u 0.9507 (0.9636) acc_u 6.2500 (3.8393) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [40/42] time 0.179 (0.173) data 0.101 (0.096) loss_u loss_u 0.9653 (0.9646) acc_u 3.1250 (3.7500) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 755
confident_label rate tensor(0.1603, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 259
clean true:253
clean false:6
clean_rate:0.9768339768339769
noisy true:608
noisy false:749
after delete: len(clean_dataset) 259
after delete: len(noisy_dataset) 1357
epoch [26/200] batch [5/8] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 1.0684 (0.8379) acc_x 71.8750 (78.7500) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/42] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9790 (0.9626) acc_u 3.1250 (4.3750) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [10/42] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.8818 (0.9513) acc_u 12.5000 (6.2500) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [15/42] time 0.181 (0.179) data 0.105 (0.103) loss_u loss_u 0.9058 (0.9517) acc_u 9.3750 (5.8333) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [20/42] time 0.190 (0.179) data 0.113 (0.102) loss_u loss_u 0.9614 (0.9572) acc_u 3.1250 (5.0000) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [25/42] time 0.189 (0.180) data 0.112 (0.103) loss_u loss_u 0.9448 (0.9548) acc_u 6.2500 (5.2500) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [30/42] time 0.173 (0.180) data 0.093 (0.103) loss_u loss_u 0.9551 (0.9555) acc_u 3.1250 (5.1042) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [35/42] time 0.166 (0.179) data 0.088 (0.102) loss_u loss_u 0.8623 (0.9525) acc_u 15.6250 (5.4464) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [40/42] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9922 (0.9541) acc_u 0.0000 (5.1562) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 714
confident_label rate tensor(0.1770, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 286
clean true:275
clean false:11
clean_rate:0.9615384615384616
noisy true:627
noisy false:703
after delete: len(clean_dataset) 286
after delete: len(noisy_dataset) 1330
epoch [27/200] batch [5/8] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 1.0244 (1.0482) acc_x 78.1250 (74.3750) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/41] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9805 (0.9571) acc_u 3.1250 (6.8750) lr 1.9239e-03 eta 0:00:06
epoch [27/200] batch [10/41] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.9844 (0.9643) acc_u 3.1250 (5.3125) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [15/41] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9448 (0.9614) acc_u 6.2500 (5.2083) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [20/41] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9653 (0.9633) acc_u 6.2500 (4.8438) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/41] time 0.182 (0.185) data 0.104 (0.108) loss_u loss_u 0.9424 (0.9618) acc_u 6.2500 (4.8750) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [30/41] time 0.177 (0.184) data 0.100 (0.107) loss_u loss_u 0.9282 (0.9616) acc_u 9.3750 (5.0000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [35/41] time 0.187 (0.183) data 0.110 (0.106) loss_u loss_u 0.9531 (0.9633) acc_u 6.2500 (4.7321) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [40/41] time 0.173 (0.183) data 0.095 (0.106) loss_u loss_u 0.9868 (0.9645) acc_u 3.1250 (4.6875) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 751
confident_label rate tensor(0.1640, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 265
clean true:259
clean false:6
clean_rate:0.9773584905660377
noisy true:606
noisy false:745
after delete: len(clean_dataset) 265
after delete: len(noisy_dataset) 1351
epoch [28/200] batch [5/8] time 0.197 (0.202) data 0.120 (0.125) loss_x loss_x 0.5967 (1.0394) acc_x 87.5000 (74.3750) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/42] time 0.183 (0.191) data 0.106 (0.114) loss_u loss_u 0.9526 (0.9274) acc_u 6.2500 (8.1250) lr 1.9178e-03 eta 0:00:07
epoch [28/200] batch [10/42] time 0.184 (0.189) data 0.106 (0.112) loss_u loss_u 0.9644 (0.9570) acc_u 3.1250 (4.6875) lr 1.9178e-03 eta 0:00:06
epoch [28/200] batch [15/42] time 0.185 (0.188) data 0.107 (0.111) loss_u loss_u 0.9395 (0.9619) acc_u 6.2500 (4.1667) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [20/42] time 0.158 (0.185) data 0.080 (0.108) loss_u loss_u 0.9551 (0.9558) acc_u 6.2500 (5.3125) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [25/42] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9985 (0.9562) acc_u 0.0000 (5.2500) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [30/42] time 0.185 (0.183) data 0.109 (0.106) loss_u loss_u 0.9927 (0.9583) acc_u 0.0000 (4.8958) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [35/42] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9341 (0.9588) acc_u 12.5000 (4.8214) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [40/42] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9883 (0.9558) acc_u 0.0000 (5.1562) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.1751, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 283
clean true:276
clean false:7
clean_rate:0.9752650176678446
noisy true:650
noisy false:683
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 1333
epoch [29/200] batch [5/8] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.9692 (1.1395) acc_x 81.2500 (75.6250) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/41] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.9453 (0.9692) acc_u 6.2500 (3.1250) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [10/41] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9307 (0.9659) acc_u 6.2500 (3.4375) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [15/41] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.9932 (0.9634) acc_u 3.1250 (3.9583) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [20/41] time 0.185 (0.183) data 0.108 (0.105) loss_u loss_u 0.9448 (0.9641) acc_u 6.2500 (3.9062) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/41] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9541 (0.9610) acc_u 6.2500 (4.3750) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [30/41] time 0.184 (0.182) data 0.105 (0.105) loss_u loss_u 0.9805 (0.9584) acc_u 3.1250 (4.5833) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [35/41] time 0.220 (0.183) data 0.144 (0.106) loss_u loss_u 0.9722 (0.9589) acc_u 3.1250 (4.4643) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [40/41] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9150 (0.9607) acc_u 15.6250 (4.3750) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 714
confident_label rate tensor(0.1720, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 278
clean true:270
clean false:8
clean_rate:0.9712230215827338
noisy true:632
noisy false:706
after delete: len(clean_dataset) 278
after delete: len(noisy_dataset) 1338
epoch [30/200] batch [5/8] time 0.175 (0.177) data 0.098 (0.101) loss_x loss_x 0.6870 (0.6693) acc_x 87.5000 (82.5000) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/41] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.9478 (0.9416) acc_u 6.2500 (6.2500) lr 1.9048e-03 eta 0:00:06
epoch [30/200] batch [10/41] time 0.165 (0.175) data 0.087 (0.098) loss_u loss_u 0.9282 (0.9435) acc_u 9.3750 (6.5625) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [15/41] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.9990 (0.9542) acc_u 0.0000 (5.2083) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [20/41] time 0.165 (0.175) data 0.087 (0.097) loss_u loss_u 0.9375 (0.9543) acc_u 6.2500 (5.1562) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [25/41] time 0.186 (0.174) data 0.108 (0.097) loss_u loss_u 0.9858 (0.9550) acc_u 3.1250 (5.1250) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [30/41] time 0.167 (0.174) data 0.089 (0.096) loss_u loss_u 0.9819 (0.9556) acc_u 0.0000 (5.2083) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [35/41] time 0.176 (0.174) data 0.097 (0.096) loss_u loss_u 0.9653 (0.9577) acc_u 3.1250 (4.9107) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [40/41] time 0.235 (0.176) data 0.156 (0.098) loss_u loss_u 0.9917 (0.9588) acc_u 3.1250 (4.8438) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 697
confident_label rate tensor(0.1689, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 273
clean true:265
clean false:8
clean_rate:0.9706959706959707
noisy true:654
noisy false:689
after delete: len(clean_dataset) 273
after delete: len(noisy_dataset) 1343
epoch [31/200] batch [5/8] time 0.170 (0.176) data 0.093 (0.098) loss_x loss_x 0.7637 (0.8396) acc_x 81.2500 (80.6250) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/41] time 0.181 (0.176) data 0.104 (0.098) loss_u loss_u 0.9653 (0.9454) acc_u 3.1250 (6.2500) lr 1.8980e-03 eta 0:00:06
epoch [31/200] batch [10/41] time 0.173 (0.175) data 0.095 (0.097) loss_u loss_u 0.9883 (0.9568) acc_u 3.1250 (5.3125) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [15/41] time 0.188 (0.175) data 0.111 (0.097) loss_u loss_u 0.9653 (0.9599) acc_u 3.1250 (4.7917) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [20/41] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.8867 (0.9581) acc_u 12.5000 (4.6875) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [25/41] time 0.182 (0.177) data 0.104 (0.099) loss_u loss_u 0.8779 (0.9578) acc_u 15.6250 (4.8750) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [30/41] time 0.177 (0.177) data 0.099 (0.099) loss_u loss_u 0.8853 (0.9552) acc_u 12.5000 (5.2083) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [35/41] time 0.169 (0.175) data 0.092 (0.097) loss_u loss_u 0.9639 (0.9570) acc_u 3.1250 (5.0000) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [40/41] time 0.176 (0.175) data 0.098 (0.097) loss_u loss_u 0.9609 (0.9559) acc_u 3.1250 (5.0781) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.1751, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 283
clean true:275
clean false:8
clean_rate:0.9717314487632509
noisy true:657
noisy false:676
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 1333
epoch [32/200] batch [5/8] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.6099 (0.7644) acc_x 84.3750 (81.8750) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/41] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9927 (0.9479) acc_u 3.1250 (6.8750) lr 1.8910e-03 eta 0:00:06
epoch [32/200] batch [10/41] time 0.183 (0.185) data 0.106 (0.107) loss_u loss_u 0.9570 (0.9501) acc_u 6.2500 (6.5625) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [15/41] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9365 (0.9462) acc_u 6.2500 (6.4583) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [20/41] time 0.182 (0.185) data 0.105 (0.107) loss_u loss_u 0.9658 (0.9543) acc_u 3.1250 (5.4688) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [25/41] time 0.187 (0.185) data 0.110 (0.107) loss_u loss_u 0.9131 (0.9560) acc_u 9.3750 (5.0000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [30/41] time 0.181 (0.185) data 0.103 (0.107) loss_u loss_u 0.9609 (0.9592) acc_u 3.1250 (4.5833) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [35/41] time 0.181 (0.184) data 0.105 (0.107) loss_u loss_u 0.9922 (0.9620) acc_u 0.0000 (4.1964) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [40/41] time 0.192 (0.184) data 0.115 (0.107) loss_u loss_u 0.9624 (0.9629) acc_u 3.1250 (4.1406) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 701
confident_label rate tensor(0.1764, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 285
clean true:277
clean false:8
clean_rate:0.9719298245614035
noisy true:638
noisy false:693
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 1331
epoch [33/200] batch [5/8] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 1.0645 (0.8829) acc_x 78.1250 (76.8750) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/41] time 0.186 (0.185) data 0.109 (0.108) loss_u loss_u 0.9253 (0.9579) acc_u 9.3750 (6.2500) lr 1.8838e-03 eta 0:00:06
epoch [33/200] batch [10/41] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9683 (0.9472) acc_u 3.1250 (6.2500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [15/41] time 0.162 (0.179) data 0.084 (0.102) loss_u loss_u 0.9062 (0.9541) acc_u 9.3750 (5.2083) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [20/41] time 0.179 (0.178) data 0.101 (0.101) loss_u loss_u 0.9678 (0.9571) acc_u 6.2500 (5.0000) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/41] time 0.177 (0.178) data 0.099 (0.100) loss_u loss_u 0.9976 (0.9556) acc_u 0.0000 (5.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [30/41] time 0.183 (0.179) data 0.107 (0.101) loss_u loss_u 0.9692 (0.9548) acc_u 6.2500 (5.2083) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [35/41] time 0.177 (0.179) data 0.101 (0.101) loss_u loss_u 0.9731 (0.9577) acc_u 6.2500 (4.9107) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [40/41] time 0.185 (0.179) data 0.106 (0.102) loss_u loss_u 0.9604 (0.9586) acc_u 3.1250 (4.8438) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 704
confident_label rate tensor(0.1795, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 290
clean true:279
clean false:11
clean_rate:0.9620689655172414
noisy true:633
noisy false:693
after delete: len(clean_dataset) 290
after delete: len(noisy_dataset) 1326
epoch [34/200] batch [5/9] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6396 (0.9896) acc_x 81.2500 (77.5000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/41] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9883 (0.9729) acc_u 3.1250 (3.7500) lr 1.8763e-03 eta 0:00:06
epoch [34/200] batch [10/41] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9253 (0.9634) acc_u 9.3750 (4.6875) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [15/41] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9282 (0.9650) acc_u 6.2500 (3.9583) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [20/41] time 0.178 (0.181) data 0.100 (0.104) loss_u loss_u 0.9629 (0.9639) acc_u 3.1250 (4.0625) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [25/41] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9932 (0.9684) acc_u 0.0000 (3.5000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [30/41] time 0.159 (0.179) data 0.083 (0.102) loss_u loss_u 0.9990 (0.9671) acc_u 0.0000 (3.7500) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [35/41] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.9614 (0.9641) acc_u 3.1250 (4.1964) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [40/41] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9595 (0.9650) acc_u 6.2500 (4.0625) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 702
confident_label rate tensor(0.1757, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 284
clean true:278
clean false:6
clean_rate:0.9788732394366197
noisy true:636
noisy false:696
after delete: len(clean_dataset) 284
after delete: len(noisy_dataset) 1332
epoch [35/200] batch [5/8] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.8584 (0.7730) acc_x 75.0000 (82.5000) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/41] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9878 (0.9784) acc_u 0.0000 (3.7500) lr 1.8686e-03 eta 0:00:06
epoch [35/200] batch [10/41] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9570 (0.9797) acc_u 6.2500 (2.8125) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [15/41] time 0.161 (0.181) data 0.083 (0.104) loss_u loss_u 0.9727 (0.9710) acc_u 3.1250 (3.7500) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [20/41] time 0.164 (0.178) data 0.087 (0.101) loss_u loss_u 0.9868 (0.9693) acc_u 3.1250 (3.9062) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [25/41] time 0.161 (0.175) data 0.083 (0.098) loss_u loss_u 0.9570 (0.9663) acc_u 6.2500 (4.5000) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [30/41] time 0.162 (0.174) data 0.084 (0.096) loss_u loss_u 0.9219 (0.9657) acc_u 9.3750 (4.4792) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [35/41] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.9556 (0.9651) acc_u 3.1250 (4.4643) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [40/41] time 0.180 (0.175) data 0.103 (0.098) loss_u loss_u 0.9536 (0.9638) acc_u 3.1250 (4.5312) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 666
confident_label rate tensor(0.1751, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 283
clean true:275
clean false:8
clean_rate:0.9717314487632509
noisy true:675
noisy false:658
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 1333
epoch [36/200] batch [5/8] time 0.176 (0.182) data 0.099 (0.105) loss_x loss_x 0.5400 (0.6943) acc_x 87.5000 (84.3750) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/41] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.9746 (0.9615) acc_u 3.1250 (4.3750) lr 1.8607e-03 eta 0:00:06
epoch [36/200] batch [10/41] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9712 (0.9592) acc_u 3.1250 (4.3750) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [15/41] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.9360 (0.9535) acc_u 6.2500 (4.7917) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [20/41] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.9209 (0.9533) acc_u 6.2500 (4.8438) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [25/41] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.9707 (0.9548) acc_u 3.1250 (4.7500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [30/41] time 0.158 (0.179) data 0.081 (0.102) loss_u loss_u 0.9849 (0.9566) acc_u 0.0000 (4.4792) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [35/41] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.9941 (0.9587) acc_u 0.0000 (4.3750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [40/41] time 0.170 (0.178) data 0.093 (0.101) loss_u loss_u 0.9814 (0.9587) acc_u 3.1250 (4.6094) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 719
confident_label rate tensor(0.1696, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 274
clean true:263
clean false:11
clean_rate:0.9598540145985401
noisy true:634
noisy false:708
after delete: len(clean_dataset) 274
after delete: len(noisy_dataset) 1342
epoch [37/200] batch [5/8] time 0.171 (0.176) data 0.095 (0.100) loss_x loss_x 0.4985 (0.8072) acc_x 87.5000 (82.5000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/41] time 0.173 (0.179) data 0.096 (0.102) loss_u loss_u 0.8936 (0.9428) acc_u 9.3750 (6.8750) lr 1.8526e-03 eta 0:00:06
epoch [37/200] batch [10/41] time 0.179 (0.178) data 0.101 (0.101) loss_u loss_u 0.9414 (0.9516) acc_u 9.3750 (5.9375) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [15/41] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.9502 (0.9459) acc_u 6.2500 (6.4583) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [20/41] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9150 (0.9472) acc_u 9.3750 (6.2500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [25/41] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.9297 (0.9431) acc_u 6.2500 (6.8750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [30/41] time 0.186 (0.182) data 0.108 (0.104) loss_u loss_u 0.9268 (0.9447) acc_u 6.2500 (6.4583) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [35/41] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.9556 (0.9486) acc_u 6.2500 (5.9821) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [40/41] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8896 (0.9487) acc_u 12.5000 (5.8594) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 643
confident_label rate tensor(0.1739, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 281
clean true:271
clean false:10
clean_rate:0.9644128113879004
noisy true:702
noisy false:633
after delete: len(clean_dataset) 281
after delete: len(noisy_dataset) 1335
epoch [38/200] batch [5/8] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.9531 (0.8700) acc_x 75.0000 (77.5000) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/41] time 0.184 (0.179) data 0.107 (0.103) loss_u loss_u 0.9321 (0.9535) acc_u 6.2500 (5.0000) lr 1.8443e-03 eta 0:00:06
epoch [38/200] batch [10/41] time 0.182 (0.180) data 0.105 (0.104) loss_u loss_u 0.9761 (0.9585) acc_u 3.1250 (4.6875) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [15/41] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8857 (0.9558) acc_u 12.5000 (5.2083) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [20/41] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9639 (0.9539) acc_u 6.2500 (5.6250) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/41] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9907 (0.9546) acc_u 0.0000 (5.7500) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [30/41] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9580 (0.9554) acc_u 6.2500 (5.7292) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [35/41] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9634 (0.9565) acc_u 3.1250 (5.5357) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [40/41] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.9624 (0.9574) acc_u 3.1250 (5.4688) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 695
confident_label rate tensor(0.1764, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 285
clean true:272
clean false:13
clean_rate:0.9543859649122807
noisy true:649
noisy false:682
after delete: len(clean_dataset) 285
after delete: len(noisy_dataset) 1331
epoch [39/200] batch [5/8] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.7241 (0.8862) acc_x 78.1250 (80.6250) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/41] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.9624 (0.9607) acc_u 3.1250 (4.3750) lr 1.8358e-03 eta 0:00:06
epoch [39/200] batch [10/41] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.9180 (0.9570) acc_u 9.3750 (4.6875) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [15/41] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.9639 (0.9644) acc_u 3.1250 (3.9583) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [20/41] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9375 (0.9646) acc_u 6.2500 (3.7500) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [25/41] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.9888 (0.9629) acc_u 0.0000 (4.0000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [30/41] time 0.183 (0.183) data 0.104 (0.105) loss_u loss_u 0.9385 (0.9623) acc_u 6.2500 (4.1667) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [35/41] time 0.185 (0.183) data 0.108 (0.105) loss_u loss_u 0.9819 (0.9610) acc_u 3.1250 (4.4643) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [40/41] time 0.184 (0.183) data 0.107 (0.105) loss_u loss_u 0.9346 (0.9614) acc_u 6.2500 (4.3750) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 710
confident_label rate tensor(0.1671, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 270
clean true:259
clean false:11
clean_rate:0.9592592592592593
noisy true:647
noisy false:699
after delete: len(clean_dataset) 270
after delete: len(noisy_dataset) 1346
epoch [40/200] batch [5/8] time 0.195 (0.186) data 0.118 (0.109) loss_x loss_x 0.7207 (0.6519) acc_x 84.3750 (83.7500) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/42] time 0.158 (0.184) data 0.081 (0.107) loss_u loss_u 0.9609 (0.9557) acc_u 3.1250 (5.0000) lr 1.8271e-03 eta 0:00:06
epoch [40/200] batch [10/42] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.9512 (0.9388) acc_u 6.2500 (7.1875) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [15/42] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.9668 (0.9451) acc_u 3.1250 (6.6667) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [20/42] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9976 (0.9519) acc_u 0.0000 (5.6250) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [25/42] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.9912 (0.9546) acc_u 0.0000 (5.2500) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [30/42] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9204 (0.9538) acc_u 9.3750 (5.3125) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [35/42] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.9653 (0.9530) acc_u 6.2500 (5.4464) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [40/42] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9341 (0.9535) acc_u 6.2500 (5.3906) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.1900, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 307
clean true:297
clean false:10
clean_rate:0.9674267100977199
noisy true:641
noisy false:668
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 1309
epoch [41/200] batch [5/9] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.9810 (0.7280) acc_x 68.7500 (86.2500) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/40] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.9897 (0.9756) acc_u 0.0000 (2.5000) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [10/40] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.9341 (0.9678) acc_u 9.3750 (3.4375) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [15/40] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9429 (0.9684) acc_u 6.2500 (3.5417) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [20/40] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9980 (0.9729) acc_u 0.0000 (3.1250) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [25/40] time 0.185 (0.183) data 0.108 (0.107) loss_u loss_u 0.9966 (0.9694) acc_u 0.0000 (3.5000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [30/40] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9863 (0.9688) acc_u 0.0000 (3.4375) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [35/40] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9893 (0.9687) acc_u 0.0000 (3.6607) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [40/40] time 0.161 (0.182) data 0.084 (0.105) loss_u loss_u 0.9380 (0.9668) acc_u 6.2500 (3.9062) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 658
confident_label rate tensor(0.1807, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 292
clean true:284
clean false:8
clean_rate:0.9726027397260274
noisy true:674
noisy false:650
after delete: len(clean_dataset) 292
after delete: len(noisy_dataset) 1324
epoch [42/200] batch [5/9] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.6392 (0.6722) acc_x 90.6250 (85.6250) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/41] time 0.182 (0.186) data 0.105 (0.109) loss_u loss_u 0.9688 (0.9415) acc_u 3.1250 (6.2500) lr 1.8090e-03 eta 0:00:06
epoch [42/200] batch [10/41] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.9722 (0.9562) acc_u 3.1250 (4.6875) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [15/41] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9858 (0.9488) acc_u 3.1250 (5.4167) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [20/41] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.8931 (0.9497) acc_u 12.5000 (5.6250) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [25/41] time 0.184 (0.184) data 0.108 (0.108) loss_u loss_u 0.9629 (0.9550) acc_u 3.1250 (5.0000) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [30/41] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9297 (0.9545) acc_u 12.5000 (5.2083) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [35/41] time 0.181 (0.184) data 0.105 (0.107) loss_u loss_u 0.9448 (0.9553) acc_u 6.2500 (5.0000) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [40/41] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9731 (0.9547) acc_u 6.2500 (5.0781) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.1863, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 301
clean true:290
clean false:11
clean_rate:0.9634551495016611
noisy true:649
noisy false:666
after delete: len(clean_dataset) 301
after delete: len(noisy_dataset) 1315
epoch [43/200] batch [5/9] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.5259 (0.7606) acc_x 90.6250 (81.8750) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/41] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9878 (0.9593) acc_u 3.1250 (5.0000) lr 1.7997e-03 eta 0:00:06
epoch [43/200] batch [10/41] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9668 (0.9643) acc_u 3.1250 (4.3750) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [15/41] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9639 (0.9637) acc_u 3.1250 (4.3750) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [20/41] time 0.180 (0.184) data 0.104 (0.107) loss_u loss_u 0.9644 (0.9533) acc_u 6.2500 (5.4688) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [25/41] time 0.181 (0.184) data 0.105 (0.107) loss_u loss_u 0.9717 (0.9558) acc_u 3.1250 (5.1250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [30/41] time 0.181 (0.184) data 0.105 (0.107) loss_u loss_u 0.9395 (0.9552) acc_u 9.3750 (5.3125) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [35/41] time 0.173 (0.183) data 0.095 (0.107) loss_u loss_u 0.9785 (0.9570) acc_u 3.1250 (5.1786) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [40/41] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9580 (0.9584) acc_u 6.2500 (4.9219) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 660
confident_label rate tensor(0.1918, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 310
clean true:301
clean false:9
clean_rate:0.9709677419354839
noisy true:655
noisy false:651
after delete: len(clean_dataset) 310
after delete: len(noisy_dataset) 1306
epoch [44/200] batch [5/9] time 0.179 (0.174) data 0.103 (0.097) loss_x loss_x 0.6724 (0.9004) acc_x 84.3750 (81.2500) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/40] time 0.180 (0.169) data 0.103 (0.092) loss_u loss_u 0.9990 (0.9654) acc_u 0.0000 (6.8750) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/40] time 0.172 (0.170) data 0.095 (0.093) loss_u loss_u 0.9434 (0.9634) acc_u 6.2500 (6.2500) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [15/40] time 0.168 (0.171) data 0.091 (0.094) loss_u loss_u 0.9697 (0.9701) acc_u 3.1250 (4.7917) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [20/40] time 0.183 (0.173) data 0.107 (0.097) loss_u loss_u 0.8535 (0.9647) acc_u 15.6250 (5.1562) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [25/40] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.9170 (0.9630) acc_u 9.3750 (5.1250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [30/40] time 0.188 (0.176) data 0.112 (0.099) loss_u loss_u 0.9409 (0.9621) acc_u 6.2500 (5.0000) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [35/40] time 0.178 (0.177) data 0.100 (0.100) loss_u loss_u 0.9390 (0.9606) acc_u 6.2500 (5.0000) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [40/40] time 0.177 (0.177) data 0.101 (0.100) loss_u loss_u 0.9648 (0.9627) acc_u 3.1250 (4.6875) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 697
confident_label rate tensor(0.1788, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 289
clean true:276
clean false:13
clean_rate:0.9550173010380623
noisy true:643
noisy false:684
after delete: len(clean_dataset) 289
after delete: len(noisy_dataset) 1327
epoch [45/200] batch [5/9] time 0.229 (0.195) data 0.153 (0.118) loss_x loss_x 0.5518 (0.7113) acc_x 78.1250 (78.7500) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/41] time 0.188 (0.184) data 0.111 (0.107) loss_u loss_u 0.9844 (0.9482) acc_u 3.1250 (5.6250) lr 1.7804e-03 eta 0:00:06
epoch [45/200] batch [10/41] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9756 (0.9607) acc_u 3.1250 (4.0625) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [15/41] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9351 (0.9557) acc_u 9.3750 (4.7917) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [20/41] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9702 (0.9541) acc_u 3.1250 (5.3125) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [25/41] time 0.170 (0.184) data 0.094 (0.107) loss_u loss_u 0.9336 (0.9563) acc_u 6.2500 (4.8750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [30/41] time 0.162 (0.182) data 0.084 (0.105) loss_u loss_u 0.9268 (0.9583) acc_u 9.3750 (4.6875) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [35/41] time 0.205 (0.183) data 0.128 (0.106) loss_u loss_u 0.9062 (0.9517) acc_u 12.5000 (5.7143) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [40/41] time 0.189 (0.183) data 0.111 (0.106) loss_u loss_u 0.9316 (0.9526) acc_u 6.2500 (5.7031) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.1807, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 292
clean true:278
clean false:14
clean_rate:0.952054794520548
noisy true:645
noisy false:679
after delete: len(clean_dataset) 292
after delete: len(noisy_dataset) 1324
epoch [46/200] batch [5/9] time 0.173 (0.181) data 0.097 (0.104) loss_x loss_x 0.4551 (0.7395) acc_x 87.5000 (83.1250) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/41] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.9932 (0.9602) acc_u 0.0000 (4.3750) lr 1.7705e-03 eta 0:00:06
epoch [46/200] batch [10/41] time 0.191 (0.183) data 0.114 (0.106) loss_u loss_u 0.9990 (0.9532) acc_u 0.0000 (5.6250) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [15/41] time 0.163 (0.182) data 0.085 (0.105) loss_u loss_u 0.9258 (0.9440) acc_u 6.2500 (6.2500) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [20/41] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.9883 (0.9527) acc_u 0.0000 (5.1562) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [25/41] time 0.194 (0.181) data 0.115 (0.104) loss_u loss_u 0.9810 (0.9544) acc_u 3.1250 (4.8750) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/41] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.9858 (0.9572) acc_u 3.1250 (4.5833) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [35/41] time 0.182 (0.182) data 0.106 (0.104) loss_u loss_u 0.9707 (0.9543) acc_u 3.1250 (5.0000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [40/41] time 0.181 (0.182) data 0.105 (0.104) loss_u loss_u 0.9492 (0.9538) acc_u 6.2500 (5.2344) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 698
confident_label rate tensor(0.1856, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 300
clean true:283
clean false:17
clean_rate:0.9433333333333334
noisy true:635
noisy false:681
after delete: len(clean_dataset) 300
after delete: len(noisy_dataset) 1316
epoch [47/200] batch [5/9] time 0.186 (0.190) data 0.108 (0.113) loss_x loss_x 0.4949 (0.9062) acc_x 81.2500 (77.5000) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/41] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9614 (0.9541) acc_u 6.2500 (5.0000) lr 1.7604e-03 eta 0:00:06
epoch [47/200] batch [10/41] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9976 (0.9640) acc_u 0.0000 (3.7500) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [15/41] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9678 (0.9654) acc_u 3.1250 (3.7500) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [20/41] time 0.184 (0.183) data 0.108 (0.106) loss_u loss_u 0.9473 (0.9690) acc_u 6.2500 (3.2812) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [25/41] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9800 (0.9633) acc_u 3.1250 (4.0000) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [30/41] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9370 (0.9611) acc_u 9.3750 (4.4792) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [35/41] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9717 (0.9596) acc_u 6.2500 (4.6429) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [40/41] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9595 (0.9587) acc_u 3.1250 (4.6875) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.1825, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 295
clean true:283
clean false:12
clean_rate:0.9593220338983051
noisy true:662
noisy false:659
after delete: len(clean_dataset) 295
after delete: len(noisy_dataset) 1321
epoch [48/200] batch [5/9] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8369 (0.7676) acc_x 75.0000 (80.6250) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/41] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9946 (0.9540) acc_u 0.0000 (6.2500) lr 1.7501e-03 eta 0:00:06
epoch [48/200] batch [10/41] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9932 (0.9731) acc_u 0.0000 (3.4375) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [15/41] time 0.188 (0.183) data 0.111 (0.107) loss_u loss_u 0.9351 (0.9704) acc_u 6.2500 (3.5417) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [20/41] time 0.179 (0.183) data 0.102 (0.106) loss_u loss_u 0.9409 (0.9649) acc_u 6.2500 (4.0625) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [25/41] time 0.164 (0.181) data 0.087 (0.104) loss_u loss_u 0.9414 (0.9587) acc_u 6.2500 (5.0000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [30/41] time 0.176 (0.181) data 0.099 (0.104) loss_u loss_u 0.9941 (0.9553) acc_u 0.0000 (5.2083) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [35/41] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9985 (0.9557) acc_u 0.0000 (5.1786) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [40/41] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9507 (0.9544) acc_u 6.2500 (5.4688) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 673
confident_label rate tensor(0.1925, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 311
clean true:298
clean false:13
clean_rate:0.9581993569131833
noisy true:645
noisy false:660
after delete: len(clean_dataset) 311
after delete: len(noisy_dataset) 1305
epoch [49/200] batch [5/9] time 0.174 (0.174) data 0.097 (0.097) loss_x loss_x 0.3604 (0.5326) acc_x 93.7500 (87.5000) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/40] time 0.164 (0.172) data 0.087 (0.095) loss_u loss_u 0.9966 (0.9732) acc_u 0.0000 (3.1250) lr 1.7396e-03 eta 0:00:06
epoch [49/200] batch [10/40] time 0.176 (0.174) data 0.098 (0.097) loss_u loss_u 0.9932 (0.9574) acc_u 0.0000 (4.6875) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [15/40] time 0.172 (0.173) data 0.095 (0.096) loss_u loss_u 0.9673 (0.9567) acc_u 3.1250 (4.5833) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [20/40] time 0.180 (0.173) data 0.102 (0.095) loss_u loss_u 0.9219 (0.9608) acc_u 9.3750 (4.2188) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [25/40] time 0.171 (0.173) data 0.094 (0.096) loss_u loss_u 0.8931 (0.9596) acc_u 12.5000 (4.5000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [30/40] time 0.176 (0.173) data 0.099 (0.096) loss_u loss_u 0.9917 (0.9611) acc_u 3.1250 (4.4792) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [35/40] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.9624 (0.9622) acc_u 3.1250 (4.2857) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [40/40] time 0.172 (0.174) data 0.094 (0.097) loss_u loss_u 0.9033 (0.9605) acc_u 12.5000 (4.5312) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.1801, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 291
clean true:280
clean false:11
clean_rate:0.9621993127147767
noisy true:652
noisy false:673
after delete: len(clean_dataset) 291
after delete: len(noisy_dataset) 1325
epoch [50/200] batch [5/9] time 0.172 (0.180) data 0.095 (0.104) loss_x loss_x 0.5029 (0.6158) acc_x 93.7500 (86.2500) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/41] time 0.181 (0.171) data 0.104 (0.094) loss_u loss_u 0.9492 (0.9599) acc_u 6.2500 (5.0000) lr 1.7290e-03 eta 0:00:06
epoch [50/200] batch [10/41] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.9727 (0.9563) acc_u 3.1250 (5.3125) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [15/41] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9546 (0.9507) acc_u 6.2500 (6.0417) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [20/41] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9565 (0.9526) acc_u 6.2500 (5.7812) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [25/41] time 0.185 (0.178) data 0.109 (0.101) loss_u loss_u 0.9395 (0.9536) acc_u 6.2500 (5.6250) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [30/41] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.9604 (0.9497) acc_u 6.2500 (6.0417) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [35/41] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9604 (0.9497) acc_u 3.1250 (6.0714) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [40/41] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9980 (0.9501) acc_u 0.0000 (6.0156) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 689
confident_label rate tensor(0.1856, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 300
clean true:286
clean false:14
clean_rate:0.9533333333333334
noisy true:641
noisy false:675
after delete: len(clean_dataset) 300
after delete: len(noisy_dataset) 1316
epoch [51/200] batch [5/9] time 0.181 (0.186) data 0.105 (0.109) loss_x loss_x 1.6309 (0.9909) acc_x 68.7500 (76.8750) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/41] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9668 (0.9670) acc_u 3.1250 (1.8750) lr 1.7181e-03 eta 0:00:06
epoch [51/200] batch [10/41] time 0.186 (0.183) data 0.110 (0.107) loss_u loss_u 0.9248 (0.9616) acc_u 9.3750 (3.7500) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [15/41] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9663 (0.9584) acc_u 3.1250 (4.5833) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [20/41] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9106 (0.9570) acc_u 9.3750 (4.8438) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [25/41] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9136 (0.9561) acc_u 9.3750 (4.8750) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [30/41] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.9399 (0.9562) acc_u 6.2500 (4.8958) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [35/41] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.9980 (0.9575) acc_u 0.0000 (4.7321) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [40/41] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8989 (0.9578) acc_u 12.5000 (4.6875) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.1850, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 299
clean true:288
clean false:11
clean_rate:0.9632107023411371
noisy true:652
noisy false:665
after delete: len(clean_dataset) 299
after delete: len(noisy_dataset) 1317
epoch [52/200] batch [5/9] time 0.181 (0.187) data 0.104 (0.109) loss_x loss_x 0.5522 (0.6324) acc_x 84.3750 (84.3750) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/41] time 0.177 (0.184) data 0.100 (0.107) loss_u loss_u 0.8984 (0.9442) acc_u 12.5000 (6.2500) lr 1.7071e-03 eta 0:00:06
epoch [52/200] batch [10/41] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9629 (0.9564) acc_u 3.1250 (4.6875) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [15/41] time 0.184 (0.183) data 0.106 (0.105) loss_u loss_u 0.8867 (0.9470) acc_u 12.5000 (6.2500) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [20/41] time 0.179 (0.182) data 0.100 (0.105) loss_u loss_u 0.9385 (0.9470) acc_u 6.2500 (6.0938) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [25/41] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.9658 (0.9509) acc_u 3.1250 (5.7500) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/41] time 0.179 (0.183) data 0.102 (0.105) loss_u loss_u 0.9648 (0.9533) acc_u 3.1250 (5.5208) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [35/41] time 0.181 (0.183) data 0.105 (0.105) loss_u loss_u 0.9985 (0.9570) acc_u 0.0000 (5.0893) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [40/41] time 0.173 (0.181) data 0.094 (0.104) loss_u loss_u 0.9741 (0.9582) acc_u 6.2500 (5.0000) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 673
confident_label rate tensor(0.1887, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 305
clean true:294
clean false:11
clean_rate:0.9639344262295082
noisy true:649
noisy false:662
after delete: len(clean_dataset) 305
after delete: len(noisy_dataset) 1311
epoch [53/200] batch [5/9] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 1.1797 (0.9922) acc_x 68.7500 (75.6250) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/40] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.9287 (0.9548) acc_u 9.3750 (5.0000) lr 1.6959e-03 eta 0:00:06
epoch [53/200] batch [10/40] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9419 (0.9513) acc_u 6.2500 (5.6250) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [15/40] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9678 (0.9533) acc_u 3.1250 (5.8333) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [20/40] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9678 (0.9564) acc_u 3.1250 (5.3125) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [25/40] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9707 (0.9521) acc_u 3.1250 (5.6250) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [30/40] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9663 (0.9535) acc_u 3.1250 (5.5208) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [35/40] time 0.172 (0.182) data 0.095 (0.105) loss_u loss_u 0.9995 (0.9566) acc_u 0.0000 (5.0893) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [40/40] time 0.169 (0.182) data 0.091 (0.104) loss_u loss_u 0.9092 (0.9576) acc_u 12.5000 (5.0000) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.1887, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 305
clean true:290
clean false:15
clean_rate:0.9508196721311475
noisy true:648
noisy false:663
after delete: len(clean_dataset) 305
after delete: len(noisy_dataset) 1311
epoch [54/200] batch [5/9] time 0.182 (0.172) data 0.106 (0.095) loss_x loss_x 0.5947 (0.7077) acc_x 84.3750 (78.1250) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/40] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.9746 (0.9699) acc_u 6.2500 (3.7500) lr 1.6845e-03 eta 0:00:06
epoch [54/200] batch [10/40] time 0.191 (0.181) data 0.114 (0.104) loss_u loss_u 0.9487 (0.9719) acc_u 6.2500 (3.4375) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [15/40] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9648 (0.9702) acc_u 3.1250 (3.3333) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [20/40] time 0.180 (0.182) data 0.101 (0.105) loss_u loss_u 0.9634 (0.9651) acc_u 3.1250 (3.9062) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [25/40] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9077 (0.9590) acc_u 9.3750 (4.6250) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [30/40] time 0.166 (0.180) data 0.089 (0.103) loss_u loss_u 0.9946 (0.9604) acc_u 0.0000 (4.5833) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [35/40] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.9531 (0.9594) acc_u 6.2500 (4.6429) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [40/40] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.9736 (0.9599) acc_u 3.1250 (4.6094) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.1875, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 303
clean true:292
clean false:11
clean_rate:0.9636963696369637
noisy true:639
noisy false:674
after delete: len(clean_dataset) 303
after delete: len(noisy_dataset) 1313
epoch [55/200] batch [5/9] time 0.160 (0.162) data 0.083 (0.085) loss_x loss_x 0.5298 (0.6307) acc_x 93.7500 (88.7500) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/41] time 0.169 (0.172) data 0.092 (0.095) loss_u loss_u 0.9995 (0.9562) acc_u 0.0000 (6.2500) lr 1.6730e-03 eta 0:00:06
epoch [55/200] batch [10/41] time 0.183 (0.171) data 0.105 (0.094) loss_u loss_u 0.9834 (0.9641) acc_u 0.0000 (4.6875) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [15/41] time 0.170 (0.171) data 0.092 (0.094) loss_u loss_u 0.9365 (0.9527) acc_u 6.2500 (5.8333) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [20/41] time 0.180 (0.172) data 0.103 (0.095) loss_u loss_u 0.9707 (0.9578) acc_u 3.1250 (5.1562) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [25/41] time 0.163 (0.172) data 0.087 (0.095) loss_u loss_u 0.8940 (0.9561) acc_u 15.6250 (5.5000) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [30/41] time 0.177 (0.172) data 0.100 (0.095) loss_u loss_u 0.9600 (0.9575) acc_u 9.3750 (5.4167) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [35/41] time 0.182 (0.174) data 0.104 (0.096) loss_u loss_u 0.9326 (0.9572) acc_u 9.3750 (5.3571) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [40/41] time 0.172 (0.174) data 0.095 (0.096) loss_u loss_u 0.9316 (0.9580) acc_u 6.2500 (5.1562) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 630
confident_label rate tensor(0.1980, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 320
clean true:308
clean false:12
clean_rate:0.9625
noisy true:678
noisy false:618
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 1296
epoch [56/200] batch [5/10] time 0.200 (0.186) data 0.123 (0.110) loss_x loss_x 0.8623 (0.7948) acc_x 78.1250 (82.5000) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [10/10] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.8125 (0.7353) acc_x 71.8750 (82.5000) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/40] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9819 (0.9719) acc_u 0.0000 (2.5000) lr 1.6613e-03 eta 0:00:06
epoch [56/200] batch [10/40] time 0.182 (0.185) data 0.104 (0.108) loss_u loss_u 0.9253 (0.9744) acc_u 9.3750 (2.5000) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [15/40] time 0.197 (0.185) data 0.121 (0.108) loss_u loss_u 0.9668 (0.9666) acc_u 3.1250 (4.1667) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [20/40] time 0.173 (0.185) data 0.096 (0.108) loss_u loss_u 0.9932 (0.9674) acc_u 0.0000 (3.9062) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [25/40] time 0.172 (0.184) data 0.095 (0.106) loss_u loss_u 0.9648 (0.9669) acc_u 3.1250 (3.7500) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/40] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9897 (0.9687) acc_u 3.1250 (3.6458) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [35/40] time 0.179 (0.183) data 0.101 (0.105) loss_u loss_u 0.9707 (0.9684) acc_u 3.1250 (3.7500) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [40/40] time 0.185 (0.183) data 0.108 (0.105) loss_u loss_u 0.9673 (0.9694) acc_u 3.1250 (3.7500) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 697
confident_label rate tensor(0.1937, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 313
clean true:301
clean false:12
clean_rate:0.9616613418530351
noisy true:618
noisy false:685
after delete: len(clean_dataset) 313
after delete: len(noisy_dataset) 1303
epoch [57/200] batch [5/9] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 1.1055 (0.8860) acc_x 68.7500 (79.3750) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/40] time 0.181 (0.181) data 0.105 (0.105) loss_u loss_u 0.9819 (0.9517) acc_u 3.1250 (5.6250) lr 1.6494e-03 eta 0:00:06
epoch [57/200] batch [10/40] time 0.186 (0.181) data 0.109 (0.105) loss_u loss_u 0.9966 (0.9596) acc_u 0.0000 (4.6875) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [15/40] time 0.181 (0.180) data 0.103 (0.103) loss_u loss_u 0.9590 (0.9681) acc_u 3.1250 (3.5417) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [20/40] time 0.172 (0.179) data 0.094 (0.102) loss_u loss_u 0.9985 (0.9675) acc_u 0.0000 (3.7500) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [25/40] time 0.184 (0.180) data 0.108 (0.103) loss_u loss_u 0.9800 (0.9667) acc_u 0.0000 (3.8750) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [30/40] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9507 (0.9650) acc_u 6.2500 (4.0625) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [35/40] time 0.167 (0.180) data 0.090 (0.103) loss_u loss_u 0.9648 (0.9626) acc_u 3.1250 (4.2857) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [40/40] time 0.181 (0.180) data 0.105 (0.103) loss_u loss_u 0.9990 (0.9610) acc_u 0.0000 (4.5312) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 643
confident_label rate tensor(0.1863, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 301
clean true:291
clean false:10
clean_rate:0.9667774086378738
noisy true:682
noisy false:633
after delete: len(clean_dataset) 301
after delete: len(noisy_dataset) 1315
epoch [58/200] batch [5/9] time 0.178 (0.182) data 0.101 (0.104) loss_x loss_x 0.4219 (0.6516) acc_x 87.5000 (82.5000) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/41] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9429 (0.9638) acc_u 9.3750 (4.3750) lr 1.6374e-03 eta 0:00:06
epoch [58/200] batch [10/41] time 0.206 (0.187) data 0.128 (0.110) loss_u loss_u 0.9810 (0.9628) acc_u 3.1250 (4.3750) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [15/41] time 0.184 (0.187) data 0.106 (0.110) loss_u loss_u 0.9517 (0.9562) acc_u 6.2500 (4.7917) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [20/41] time 0.181 (0.186) data 0.104 (0.108) loss_u loss_u 0.9360 (0.9563) acc_u 6.2500 (4.6875) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [25/41] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.9932 (0.9584) acc_u 0.0000 (4.5000) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [30/41] time 0.181 (0.185) data 0.103 (0.107) loss_u loss_u 0.9790 (0.9562) acc_u 3.1250 (4.7917) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [35/41] time 0.174 (0.184) data 0.097 (0.107) loss_u loss_u 1.0000 (0.9596) acc_u 0.0000 (4.3750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [40/41] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.9233 (0.9577) acc_u 12.5000 (4.7656) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.1949, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 315
clean true:303
clean false:12
clean_rate:0.9619047619047619
noisy true:636
noisy false:665
after delete: len(clean_dataset) 315
after delete: len(noisy_dataset) 1301
epoch [59/200] batch [5/9] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 1.0312 (0.6732) acc_x 68.7500 (83.1250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/40] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9971 (0.9801) acc_u 0.0000 (3.1250) lr 1.6252e-03 eta 0:00:06
epoch [59/200] batch [10/40] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9951 (0.9783) acc_u 0.0000 (2.8125) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [15/40] time 0.180 (0.183) data 0.104 (0.106) loss_u loss_u 0.9810 (0.9666) acc_u 3.1250 (4.3750) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [20/40] time 0.187 (0.183) data 0.110 (0.106) loss_u loss_u 0.9580 (0.9674) acc_u 3.1250 (3.9062) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [25/40] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9976 (0.9669) acc_u 0.0000 (4.0000) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [30/40] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9648 (0.9668) acc_u 3.1250 (3.9583) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [35/40] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9790 (0.9672) acc_u 3.1250 (4.0179) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [40/40] time 0.168 (0.182) data 0.090 (0.105) loss_u loss_u 0.9473 (0.9651) acc_u 6.2500 (4.2188) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.1881, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 304
clean true:298
clean false:6
clean_rate:0.9802631578947368
noisy true:669
noisy false:643
after delete: len(clean_dataset) 304
after delete: len(noisy_dataset) 1312
epoch [60/200] batch [5/9] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8975 (0.7160) acc_x 75.0000 (81.2500) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/41] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.9634 (0.9400) acc_u 3.1250 (7.5000) lr 1.6129e-03 eta 0:00:06
epoch [60/200] batch [10/41] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9985 (0.9531) acc_u 0.0000 (5.9375) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [15/41] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.9736 (0.9594) acc_u 3.1250 (5.0000) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [20/41] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9854 (0.9619) acc_u 0.0000 (4.5312) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [25/41] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9980 (0.9616) acc_u 0.0000 (4.6250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [30/41] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9604 (0.9599) acc_u 3.1250 (4.6875) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [35/41] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8560 (0.9572) acc_u 18.7500 (5.0893) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [40/41] time 0.184 (0.184) data 0.106 (0.106) loss_u loss_u 0.9907 (0.9569) acc_u 3.1250 (5.3125) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.1931, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 312
clean true:298
clean false:14
clean_rate:0.9551282051282052
noisy true:669
noisy false:635
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 1304
epoch [61/200] batch [5/9] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.4797 (0.6860) acc_x 90.6250 (86.2500) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/40] time 0.184 (0.181) data 0.108 (0.104) loss_u loss_u 0.9360 (0.9603) acc_u 6.2500 (3.7500) lr 1.6004e-03 eta 0:00:06
epoch [61/200] batch [10/40] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9653 (0.9557) acc_u 6.2500 (5.0000) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [15/40] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9458 (0.9576) acc_u 6.2500 (4.7917) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [20/40] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9434 (0.9605) acc_u 6.2500 (4.6875) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [25/40] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9214 (0.9575) acc_u 12.5000 (5.1250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [30/40] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.9883 (0.9601) acc_u 0.0000 (4.8958) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [35/40] time 0.176 (0.180) data 0.099 (0.103) loss_u loss_u 0.9478 (0.9586) acc_u 6.2500 (5.0000) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [40/40] time 0.169 (0.180) data 0.092 (0.103) loss_u loss_u 0.9263 (0.9582) acc_u 6.2500 (5.0781) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 657
confident_label rate tensor(0.1968, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 318
clean true:303
clean false:15
clean_rate:0.9528301886792453
noisy true:656
noisy false:642
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1298
epoch [62/200] batch [5/9] time 0.164 (0.177) data 0.087 (0.101) loss_x loss_x 0.6484 (0.7692) acc_x 84.3750 (81.8750) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/40] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.9780 (0.9633) acc_u 3.1250 (3.7500) lr 1.5878e-03 eta 0:00:06
epoch [62/200] batch [10/40] time 0.185 (0.177) data 0.109 (0.101) loss_u loss_u 0.9995 (0.9728) acc_u 0.0000 (3.1250) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [15/40] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.9575 (0.9694) acc_u 6.2500 (3.5417) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [20/40] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9805 (0.9632) acc_u 3.1250 (4.2188) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [25/40] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9443 (0.9610) acc_u 6.2500 (4.3750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [30/40] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9346 (0.9600) acc_u 6.2500 (4.7917) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [35/40] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9849 (0.9632) acc_u 3.1250 (4.5536) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [40/40] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.9395 (0.9628) acc_u 6.2500 (4.5312) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 653
confident_label rate tensor(0.2017, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 326
clean true:311
clean false:15
clean_rate:0.9539877300613497
noisy true:652
noisy false:638
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 1290
epoch [63/200] batch [5/10] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 1.1338 (0.6177) acc_x 75.0000 (85.6250) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [10/10] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.3997 (0.6095) acc_x 90.6250 (85.3125) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/40] time 0.184 (0.181) data 0.107 (0.105) loss_u loss_u 0.9165 (0.9384) acc_u 9.3750 (7.5000) lr 1.5750e-03 eta 0:00:06
epoch [63/200] batch [10/40] time 0.185 (0.182) data 0.108 (0.106) loss_u loss_u 0.9634 (0.9552) acc_u 3.1250 (5.0000) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [15/40] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9702 (0.9581) acc_u 3.1250 (4.7917) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [20/40] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9673 (0.9612) acc_u 3.1250 (4.3750) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [25/40] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9707 (0.9594) acc_u 3.1250 (4.6250) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [30/40] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.9941 (0.9617) acc_u 0.0000 (4.2708) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [35/40] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.9492 (0.9641) acc_u 6.2500 (4.0179) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [40/40] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9727 (0.9639) acc_u 3.1250 (4.1406) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.1986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 321
clean true:303
clean false:18
clean_rate:0.9439252336448598
noisy true:664
noisy false:631
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 1295
epoch [64/200] batch [5/10] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.6274 (0.6611) acc_x 81.2500 (82.5000) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [10/10] time 0.187 (0.184) data 0.110 (0.108) loss_x loss_x 0.9521 (0.6819) acc_x 75.0000 (82.8125) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/40] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9326 (0.9487) acc_u 6.2500 (5.6250) lr 1.5621e-03 eta 0:00:06
epoch [64/200] batch [10/40] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9932 (0.9618) acc_u 0.0000 (3.7500) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [15/40] time 0.178 (0.184) data 0.101 (0.107) loss_u loss_u 0.9326 (0.9612) acc_u 9.3750 (4.3750) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [20/40] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9053 (0.9582) acc_u 12.5000 (4.8438) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [25/40] time 0.162 (0.181) data 0.084 (0.104) loss_u loss_u 0.9526 (0.9571) acc_u 6.2500 (4.8750) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [30/40] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.9717 (0.9581) acc_u 3.1250 (4.6875) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [35/40] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9590 (0.9596) acc_u 3.1250 (4.4643) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [40/40] time 0.183 (0.180) data 0.105 (0.103) loss_u loss_u 0.9834 (0.9600) acc_u 3.1250 (4.3750) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 648
confident_label rate tensor(0.1900, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 307
clean true:297
clean false:10
clean_rate:0.9674267100977199
noisy true:671
noisy false:638
after delete: len(clean_dataset) 307
after delete: len(noisy_dataset) 1309
epoch [65/200] batch [5/9] time 0.169 (0.164) data 0.093 (0.087) loss_x loss_x 0.6523 (0.6794) acc_x 81.2500 (82.5000) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/40] time 0.164 (0.167) data 0.087 (0.090) loss_u loss_u 0.9355 (0.9448) acc_u 9.3750 (6.2500) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/40] time 0.167 (0.167) data 0.090 (0.090) loss_u loss_u 0.9419 (0.9554) acc_u 6.2500 (4.6875) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [15/40] time 0.182 (0.170) data 0.105 (0.093) loss_u loss_u 0.9536 (0.9569) acc_u 6.2500 (4.5833) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [20/40] time 0.185 (0.172) data 0.108 (0.095) loss_u loss_u 0.9600 (0.9555) acc_u 6.2500 (4.8438) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [25/40] time 0.225 (0.175) data 0.148 (0.098) loss_u loss_u 0.9370 (0.9576) acc_u 6.2500 (4.6250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [30/40] time 0.159 (0.175) data 0.082 (0.099) loss_u loss_u 0.9990 (0.9614) acc_u 0.0000 (4.1667) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [35/40] time 0.212 (0.176) data 0.136 (0.100) loss_u loss_u 0.9380 (0.9590) acc_u 9.3750 (4.6429) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [40/40] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9756 (0.9587) acc_u 3.1250 (4.6094) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.1887, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 305
clean true:286
clean false:19
clean_rate:0.9377049180327869
noisy true:648
noisy false:663
after delete: len(clean_dataset) 305
after delete: len(noisy_dataset) 1311
epoch [66/200] batch [5/9] time 0.160 (0.163) data 0.084 (0.087) loss_x loss_x 0.3057 (0.7668) acc_x 93.7500 (81.2500) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/40] time 0.161 (0.163) data 0.083 (0.087) loss_u loss_u 0.9697 (0.9532) acc_u 3.1250 (5.6250) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/40] time 0.184 (0.167) data 0.106 (0.090) loss_u loss_u 0.9390 (0.9398) acc_u 9.3750 (7.5000) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [15/40] time 0.185 (0.170) data 0.107 (0.093) loss_u loss_u 0.9126 (0.9440) acc_u 12.5000 (6.8750) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [20/40] time 0.184 (0.172) data 0.108 (0.095) loss_u loss_u 0.8877 (0.9432) acc_u 9.3750 (6.7188) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [25/40] time 0.186 (0.174) data 0.109 (0.097) loss_u loss_u 0.9575 (0.9522) acc_u 6.2500 (5.6250) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [30/40] time 0.182 (0.175) data 0.105 (0.099) loss_u loss_u 0.9121 (0.9522) acc_u 9.3750 (5.6250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [35/40] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9663 (0.9546) acc_u 6.2500 (5.5357) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [40/40] time 0.185 (0.178) data 0.109 (0.101) loss_u loss_u 0.9541 (0.9565) acc_u 6.2500 (5.3906) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.1925, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 311
clean true:296
clean false:15
clean_rate:0.9517684887459807
noisy true:674
noisy false:631
after delete: len(clean_dataset) 311
after delete: len(noisy_dataset) 1305
epoch [67/200] batch [5/9] time 0.186 (0.185) data 0.109 (0.109) loss_x loss_x 0.8599 (0.7664) acc_x 71.8750 (80.0000) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/40] time 0.179 (0.183) data 0.101 (0.106) loss_u loss_u 0.9663 (0.9700) acc_u 3.1250 (3.7500) lr 1.5225e-03 eta 0:00:06
epoch [67/200] batch [10/40] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9985 (0.9731) acc_u 0.0000 (3.1250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [15/40] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9580 (0.9620) acc_u 6.2500 (4.3750) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [20/40] time 0.160 (0.180) data 0.083 (0.103) loss_u loss_u 0.9229 (0.9581) acc_u 9.3750 (5.0000) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [25/40] time 0.161 (0.178) data 0.084 (0.101) loss_u loss_u 0.9219 (0.9584) acc_u 9.3750 (4.8750) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [30/40] time 0.181 (0.178) data 0.105 (0.101) loss_u loss_u 0.9771 (0.9567) acc_u 3.1250 (5.2083) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [35/40] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9873 (0.9590) acc_u 3.1250 (5.0000) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [40/40] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.9756 (0.9599) acc_u 3.1250 (4.8438) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 679
confident_label rate tensor(0.1931, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 312
clean true:297
clean false:15
clean_rate:0.9519230769230769
noisy true:640
noisy false:664
after delete: len(clean_dataset) 312
after delete: len(noisy_dataset) 1304
epoch [68/200] batch [5/9] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.3975 (0.7728) acc_x 87.5000 (78.7500) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/40] time 0.188 (0.183) data 0.111 (0.107) loss_u loss_u 0.9341 (0.9602) acc_u 6.2500 (4.3750) lr 1.5090e-03 eta 0:00:06
epoch [68/200] batch [10/40] time 0.161 (0.182) data 0.084 (0.105) loss_u loss_u 0.9429 (0.9512) acc_u 6.2500 (5.3125) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [15/40] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9688 (0.9599) acc_u 3.1250 (4.1667) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [20/40] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.9595 (0.9634) acc_u 3.1250 (3.5938) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [25/40] time 0.174 (0.182) data 0.096 (0.104) loss_u loss_u 0.9326 (0.9595) acc_u 6.2500 (4.2500) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [30/40] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9604 (0.9565) acc_u 3.1250 (4.4792) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [35/40] time 0.187 (0.183) data 0.109 (0.106) loss_u loss_u 0.9917 (0.9585) acc_u 0.0000 (4.1964) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [40/40] time 0.193 (0.184) data 0.116 (0.106) loss_u loss_u 0.9736 (0.9593) acc_u 6.2500 (4.3750) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 662
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 316
clean true:303
clean false:13
clean_rate:0.9588607594936709
noisy true:651
noisy false:649
after delete: len(clean_dataset) 316
after delete: len(noisy_dataset) 1300
epoch [69/200] batch [5/9] time 0.166 (0.165) data 0.089 (0.088) loss_x loss_x 0.7695 (0.6789) acc_x 75.0000 (81.8750) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/40] time 0.167 (0.171) data 0.090 (0.095) loss_u loss_u 0.9438 (0.9555) acc_u 6.2500 (6.8750) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/40] time 0.161 (0.171) data 0.084 (0.094) loss_u loss_u 0.9092 (0.9554) acc_u 9.3750 (5.6250) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [15/40] time 0.189 (0.175) data 0.112 (0.098) loss_u loss_u 0.9731 (0.9637) acc_u 3.1250 (4.7917) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [20/40] time 0.162 (0.176) data 0.084 (0.099) loss_u loss_u 0.9419 (0.9604) acc_u 6.2500 (4.8438) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [25/40] time 0.191 (0.177) data 0.113 (0.100) loss_u loss_u 0.9409 (0.9614) acc_u 6.2500 (4.6250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [30/40] time 0.200 (0.178) data 0.123 (0.101) loss_u loss_u 0.9243 (0.9605) acc_u 9.3750 (4.6875) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [35/40] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.9351 (0.9615) acc_u 9.3750 (4.5536) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [40/40] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9897 (0.9609) acc_u 3.1250 (4.6875) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 653
confident_label rate tensor(0.1993, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 322
clean true:305
clean false:17
clean_rate:0.9472049689440993
noisy true:658
noisy false:636
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 1294
epoch [70/200] batch [5/10] time 0.185 (0.208) data 0.109 (0.131) loss_x loss_x 0.4111 (0.7490) acc_x 93.7500 (83.7500) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/10] time 0.185 (0.197) data 0.108 (0.119) loss_x loss_x 0.5952 (0.7337) acc_x 84.3750 (83.1250) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/40] time 0.189 (0.193) data 0.111 (0.116) loss_u loss_u 0.9966 (0.9643) acc_u 3.1250 (3.7500) lr 1.4818e-03 eta 0:00:06
epoch [70/200] batch [10/40] time 0.170 (0.187) data 0.092 (0.110) loss_u loss_u 0.9751 (0.9662) acc_u 6.2500 (3.7500) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [15/40] time 0.160 (0.182) data 0.083 (0.105) loss_u loss_u 0.9839 (0.9630) acc_u 3.1250 (4.1667) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [20/40] time 0.164 (0.179) data 0.088 (0.102) loss_u loss_u 0.9551 (0.9635) acc_u 6.2500 (4.0625) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [25/40] time 0.171 (0.178) data 0.094 (0.101) loss_u loss_u 0.9980 (0.9636) acc_u 0.0000 (4.0000) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [30/40] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.9600 (0.9612) acc_u 3.1250 (4.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [35/40] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.9980 (0.9617) acc_u 0.0000 (4.2857) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [40/40] time 0.191 (0.179) data 0.114 (0.102) loss_u loss_u 0.9570 (0.9610) acc_u 6.2500 (4.2969) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.1949, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 315
clean true:293
clean false:22
clean_rate:0.9301587301587302
noisy true:659
noisy false:642
after delete: len(clean_dataset) 315
after delete: len(noisy_dataset) 1301
epoch [71/200] batch [5/9] time 0.180 (0.186) data 0.103 (0.108) loss_x loss_x 0.7437 (0.5640) acc_x 78.1250 (84.3750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/40] time 0.168 (0.175) data 0.091 (0.097) loss_u loss_u 0.9453 (0.9649) acc_u 6.2500 (4.3750) lr 1.4679e-03 eta 0:00:06
epoch [71/200] batch [10/40] time 0.167 (0.173) data 0.090 (0.096) loss_u loss_u 0.9990 (0.9624) acc_u 0.0000 (5.0000) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [15/40] time 0.175 (0.172) data 0.098 (0.095) loss_u loss_u 0.9165 (0.9573) acc_u 9.3750 (5.2083) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [20/40] time 0.171 (0.172) data 0.093 (0.095) loss_u loss_u 0.9438 (0.9600) acc_u 6.2500 (4.8438) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [25/40] time 0.174 (0.173) data 0.097 (0.096) loss_u loss_u 0.9854 (0.9608) acc_u 3.1250 (4.8750) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [30/40] time 0.173 (0.174) data 0.093 (0.097) loss_u loss_u 0.9521 (0.9563) acc_u 3.1250 (5.3125) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [35/40] time 0.180 (0.176) data 0.101 (0.098) loss_u loss_u 0.9414 (0.9570) acc_u 6.2500 (5.3571) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [40/40] time 0.181 (0.176) data 0.101 (0.098) loss_u loss_u 0.9434 (0.9581) acc_u 9.3750 (5.2344) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.1993, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 322
clean true:304
clean false:18
clean_rate:0.9440993788819876
noisy true:673
noisy false:621
after delete: len(clean_dataset) 322
after delete: len(noisy_dataset) 1294
epoch [72/200] batch [5/10] time 0.258 (0.265) data 0.103 (0.102) loss_x loss_x 0.9429 (0.7958) acc_x 84.3750 (81.8750) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/10] time 0.269 (0.267) data 0.107 (0.104) loss_x loss_x 0.3855 (0.6890) acc_x 87.5000 (83.1250) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/40] time 0.274 (0.269) data 0.105 (0.105) loss_u loss_u 0.9971 (0.9700) acc_u 0.0000 (3.7500) lr 1.4540e-03 eta 0:00:09
epoch [72/200] batch [10/40] time 0.278 (0.270) data 0.109 (0.106) loss_u loss_u 0.9399 (0.9603) acc_u 6.2500 (4.6875) lr 1.4540e-03 eta 0:00:08
epoch [72/200] batch [15/40] time 0.189 (0.268) data 0.113 (0.107) loss_u loss_u 0.9595 (0.9532) acc_u 6.2500 (5.6250) lr 1.4540e-03 eta 0:00:06
epoch [72/200] batch [20/40] time 0.268 (0.266) data 0.106 (0.107) loss_u loss_u 0.9585 (0.9547) acc_u 3.1250 (5.3125) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [25/40] time 0.277 (0.267) data 0.106 (0.107) loss_u loss_u 0.8857 (0.9548) acc_u 12.5000 (5.2500) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [30/40] time 0.270 (0.267) data 0.106 (0.107) loss_u loss_u 0.9258 (0.9539) acc_u 12.5000 (5.4167) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [35/40] time 0.275 (0.269) data 0.106 (0.108) loss_u loss_u 0.9985 (0.9551) acc_u 0.0000 (5.3571) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [40/40] time 0.275 (0.270) data 0.106 (0.108) loss_u loss_u 0.9688 (0.9546) acc_u 3.1250 (5.3906) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 338
clean true:318
clean false:20
clean_rate:0.9408284023668639
noisy true:646
noisy false:632
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1278
epoch [73/200] batch [5/10] time 0.261 (0.264) data 0.104 (0.106) loss_x loss_x 0.7773 (0.7554) acc_x 84.3750 (81.8750) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/10] time 0.263 (0.265) data 0.108 (0.107) loss_x loss_x 0.3784 (0.7508) acc_x 87.5000 (80.9375) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/39] time 0.260 (0.265) data 0.103 (0.107) loss_u loss_u 0.9990 (0.9539) acc_u 0.0000 (5.0000) lr 1.4399e-03 eta 0:00:09
epoch [73/200] batch [10/39] time 0.263 (0.258) data 0.104 (0.107) loss_u loss_u 0.9795 (0.9668) acc_u 3.1250 (4.0625) lr 1.4399e-03 eta 0:00:07
epoch [73/200] batch [15/39] time 0.271 (0.260) data 0.104 (0.106) loss_u loss_u 0.9556 (0.9701) acc_u 3.1250 (3.3333) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [20/39] time 0.269 (0.263) data 0.105 (0.107) loss_u loss_u 0.9731 (0.9709) acc_u 6.2500 (3.2812) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [25/39] time 0.358 (0.268) data 0.189 (0.111) loss_u loss_u 0.9976 (0.9720) acc_u 0.0000 (3.3750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [30/39] time 0.297 (0.272) data 0.128 (0.113) loss_u loss_u 0.9722 (0.9721) acc_u 3.1250 (3.3333) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [35/39] time 0.312 (0.271) data 0.146 (0.114) loss_u loss_u 0.9380 (0.9686) acc_u 6.2500 (3.8393) lr 1.4399e-03 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 643
confident_label rate tensor(0.2098, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 339
clean true:316
clean false:23
clean_rate:0.9321533923303835
noisy true:657
noisy false:620
after delete: len(clean_dataset) 339
after delete: len(noisy_dataset) 1277
epoch [74/200] batch [5/10] time 0.267 (0.269) data 0.109 (0.110) loss_x loss_x 0.2812 (0.8179) acc_x 90.6250 (83.1250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/10] time 0.259 (0.266) data 0.103 (0.108) loss_x loss_x 0.8340 (0.8194) acc_x 81.2500 (80.9375) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/39] time 0.209 (0.258) data 0.107 (0.108) loss_u loss_u 0.9844 (0.9849) acc_u 0.0000 (1.2500) lr 1.4258e-03 eta 0:00:08
epoch [74/200] batch [10/39] time 0.267 (0.265) data 0.108 (0.113) loss_u loss_u 0.9556 (0.9662) acc_u 3.1250 (3.4375) lr 1.4258e-03 eta 0:00:07
epoch [74/200] batch [15/39] time 0.254 (0.266) data 0.094 (0.111) loss_u loss_u 0.9956 (0.9709) acc_u 0.0000 (3.1250) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [20/39] time 0.278 (0.269) data 0.109 (0.112) loss_u loss_u 0.9966 (0.9686) acc_u 0.0000 (3.4375) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [25/39] time 0.259 (0.272) data 0.104 (0.114) loss_u loss_u 0.9990 (0.9682) acc_u 0.0000 (3.5000) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [30/39] time 0.269 (0.267) data 0.099 (0.113) loss_u loss_u 0.9111 (0.9631) acc_u 9.3750 (4.1667) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [35/39] time 0.264 (0.267) data 0.095 (0.111) loss_u loss_u 0.9917 (0.9625) acc_u 0.0000 (4.2857) lr 1.4258e-03 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 661
confident_label rate tensor(0.1949, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 315
clean true:302
clean false:13
clean_rate:0.9587301587301588
noisy true:653
noisy false:648
after delete: len(clean_dataset) 315
after delete: len(noisy_dataset) 1301
epoch [75/200] batch [5/9] time 0.270 (0.267) data 0.105 (0.106) loss_x loss_x 0.8247 (0.7798) acc_x 78.1250 (82.5000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [5/40] time 0.181 (0.251) data 0.104 (0.101) loss_u loss_u 0.9531 (0.9726) acc_u 3.1250 (3.7500) lr 1.4115e-03 eta 0:00:08
epoch [75/200] batch [10/40] time 0.251 (0.255) data 0.084 (0.100) loss_u loss_u 0.9692 (0.9595) acc_u 3.1250 (5.3125) lr 1.4115e-03 eta 0:00:07
epoch [75/200] batch [15/40] time 0.267 (0.257) data 0.107 (0.100) loss_u loss_u 0.9307 (0.9613) acc_u 9.3750 (5.2083) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [20/40] time 0.267 (0.260) data 0.105 (0.102) loss_u loss_u 0.9829 (0.9631) acc_u 3.1250 (4.8438) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [25/40] time 0.270 (0.262) data 0.106 (0.102) loss_u loss_u 0.9829 (0.9629) acc_u 0.0000 (4.7500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [30/40] time 0.298 (0.261) data 0.130 (0.104) loss_u loss_u 0.9756 (0.9576) acc_u 3.1250 (5.4167) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [35/40] time 0.247 (0.261) data 0.089 (0.104) loss_u loss_u 0.9229 (0.9558) acc_u 6.2500 (5.4464) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [40/40] time 0.248 (0.261) data 0.082 (0.103) loss_u loss_u 0.9824 (0.9541) acc_u 3.1250 (5.6250) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.1955, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 316
clean true:302
clean false:14
clean_rate:0.9556962025316456
noisy true:662
noisy false:638
after delete: len(clean_dataset) 316
after delete: len(noisy_dataset) 1300
epoch [76/200] batch [5/9] time 0.266 (0.276) data 0.105 (0.114) loss_x loss_x 1.3262 (0.6827) acc_x 68.7500 (85.6250) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [5/40] time 0.268 (0.272) data 0.106 (0.111) loss_u loss_u 0.9824 (0.9527) acc_u 3.1250 (5.6250) lr 1.3971e-03 eta 0:00:09
epoch [76/200] batch [10/40] time 0.269 (0.270) data 0.104 (0.109) loss_u loss_u 0.9604 (0.9521) acc_u 3.1250 (5.6250) lr 1.3971e-03 eta 0:00:08
epoch [76/200] batch [15/40] time 0.258 (0.267) data 0.096 (0.106) loss_u loss_u 0.9741 (0.9483) acc_u 3.1250 (6.2500) lr 1.3971e-03 eta 0:00:06
epoch [76/200] batch [20/40] time 0.252 (0.261) data 0.095 (0.105) loss_u loss_u 0.9912 (0.9495) acc_u 0.0000 (5.9375) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [25/40] time 0.274 (0.261) data 0.106 (0.104) loss_u loss_u 0.9985 (0.9551) acc_u 0.0000 (5.2500) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [30/40] time 0.269 (0.262) data 0.101 (0.104) loss_u loss_u 0.9272 (0.9553) acc_u 9.3750 (5.4167) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [35/40] time 0.303 (0.265) data 0.136 (0.106) loss_u loss_u 0.9414 (0.9580) acc_u 6.2500 (5.0000) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [40/40] time 0.248 (0.267) data 0.107 (0.108) loss_u loss_u 0.9365 (0.9574) acc_u 9.3750 (5.0781) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 658
confident_label rate tensor(0.1986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 321
clean true:308
clean false:13
clean_rate:0.9595015576323987
noisy true:650
noisy false:645
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 1295
epoch [77/200] batch [5/10] time 0.266 (0.264) data 0.107 (0.106) loss_x loss_x 1.2090 (0.9559) acc_x 78.1250 (77.5000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/10] time 0.264 (0.265) data 0.104 (0.106) loss_x loss_x 1.0410 (0.8575) acc_x 75.0000 (78.7500) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/40] time 0.248 (0.262) data 0.082 (0.102) loss_u loss_u 0.9180 (0.9549) acc_u 9.3750 (5.0000) lr 1.3827e-03 eta 0:00:09
epoch [77/200] batch [10/40] time 0.273 (0.254) data 0.108 (0.101) loss_u loss_u 0.9653 (0.9495) acc_u 3.1250 (5.6250) lr 1.3827e-03 eta 0:00:07
epoch [77/200] batch [15/40] time 0.269 (0.257) data 0.105 (0.102) loss_u loss_u 0.9307 (0.9569) acc_u 9.3750 (4.7917) lr 1.3827e-03 eta 0:00:06
epoch [77/200] batch [20/40] time 0.253 (0.257) data 0.090 (0.102) loss_u loss_u 0.9624 (0.9582) acc_u 3.1250 (4.8438) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [25/40] time 0.264 (0.258) data 0.106 (0.101) loss_u loss_u 0.9629 (0.9613) acc_u 9.3750 (4.5000) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [30/40] time 0.276 (0.259) data 0.110 (0.102) loss_u loss_u 0.9980 (0.9617) acc_u 0.0000 (4.5833) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [35/40] time 0.264 (0.257) data 0.097 (0.102) loss_u loss_u 0.9048 (0.9585) acc_u 9.3750 (4.9107) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [40/40] time 0.276 (0.259) data 0.108 (0.103) loss_u loss_u 0.9980 (0.9585) acc_u 0.0000 (5.2344) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.2030, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 328
clean true:306
clean false:22
clean_rate:0.9329268292682927
noisy true:664
noisy false:624
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1288
epoch [78/200] batch [5/10] time 0.248 (0.259) data 0.085 (0.097) loss_x loss_x 0.4204 (0.6920) acc_x 93.7500 (83.7500) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/10] time 0.276 (0.261) data 0.112 (0.099) loss_x loss_x 0.6074 (0.7543) acc_x 84.3750 (81.2500) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/40] time 0.241 (0.255) data 0.107 (0.102) loss_u loss_u 0.9707 (0.9709) acc_u 3.1250 (2.5000) lr 1.3681e-03 eta 0:00:08
epoch [78/200] batch [10/40] time 0.254 (0.257) data 0.094 (0.102) loss_u loss_u 0.9639 (0.9529) acc_u 9.3750 (5.3125) lr 1.3681e-03 eta 0:00:07
epoch [78/200] batch [15/40] time 0.275 (0.265) data 0.111 (0.108) loss_u loss_u 0.9521 (0.9555) acc_u 6.2500 (5.4167) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [20/40] time 0.271 (0.266) data 0.109 (0.108) loss_u loss_u 0.9888 (0.9553) acc_u 0.0000 (5.4688) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [25/40] time 0.252 (0.267) data 0.090 (0.109) loss_u loss_u 0.9756 (0.9544) acc_u 3.1250 (5.5000) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [30/40] time 0.161 (0.262) data 0.083 (0.106) loss_u loss_u 0.9873 (0.9554) acc_u 0.0000 (5.4167) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [35/40] time 0.255 (0.261) data 0.096 (0.104) loss_u loss_u 0.9282 (0.9552) acc_u 9.3750 (5.3571) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [40/40] time 0.252 (0.260) data 0.092 (0.103) loss_u loss_u 0.9688 (0.9557) acc_u 3.1250 (5.3125) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 665
confident_label rate tensor(0.1986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 321
clean true:305
clean false:16
clean_rate:0.9501557632398754
noisy true:646
noisy false:649
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 1295
epoch [79/200] batch [5/10] time 0.285 (0.251) data 0.124 (0.090) loss_x loss_x 0.6758 (0.8319) acc_x 78.1250 (79.3750) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/10] time 0.267 (0.260) data 0.105 (0.098) loss_x loss_x 1.2588 (0.7870) acc_x 75.0000 (81.8750) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/40] time 0.319 (0.269) data 0.150 (0.106) loss_u loss_u 0.9839 (0.9621) acc_u 0.0000 (4.3750) lr 1.3535e-03 eta 0:00:09
epoch [79/200] batch [10/40] time 0.274 (0.262) data 0.108 (0.106) loss_u loss_u 0.9414 (0.9469) acc_u 6.2500 (6.5625) lr 1.3535e-03 eta 0:00:07
epoch [79/200] batch [15/40] time 0.237 (0.261) data 0.080 (0.103) loss_u loss_u 0.9683 (0.9535) acc_u 3.1250 (5.6250) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [20/40] time 0.281 (0.261) data 0.113 (0.101) loss_u loss_u 0.9565 (0.9586) acc_u 3.1250 (4.6875) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [25/40] time 0.278 (0.261) data 0.111 (0.101) loss_u loss_u 0.9185 (0.9531) acc_u 9.3750 (5.3750) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [30/40] time 0.269 (0.262) data 0.103 (0.101) loss_u loss_u 0.9512 (0.9523) acc_u 6.2500 (5.5208) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [35/40] time 0.259 (0.258) data 0.090 (0.100) loss_u loss_u 0.9619 (0.9534) acc_u 3.1250 (5.3571) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [40/40] time 0.258 (0.258) data 0.092 (0.099) loss_u loss_u 0.9438 (0.9532) acc_u 6.2500 (5.3906) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.2042, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 330
clean true:311
clean false:19
clean_rate:0.9424242424242424
noisy true:677
noisy false:609
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 1286
epoch [80/200] batch [5/10] time 0.271 (0.253) data 0.105 (0.107) loss_x loss_x 0.8193 (0.7557) acc_x 78.1250 (83.7500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/10] time 0.268 (0.260) data 0.103 (0.106) loss_x loss_x 1.3311 (0.8544) acc_x 71.8750 (78.7500) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/40] time 0.271 (0.260) data 0.103 (0.103) loss_u loss_u 0.9253 (0.9635) acc_u 6.2500 (3.1250) lr 1.3387e-03 eta 0:00:09
epoch [80/200] batch [10/40] time 0.212 (0.256) data 0.106 (0.103) loss_u loss_u 0.9966 (0.9598) acc_u 0.0000 (4.0625) lr 1.3387e-03 eta 0:00:07
epoch [80/200] batch [15/40] time 0.305 (0.263) data 0.135 (0.107) loss_u loss_u 0.9902 (0.9654) acc_u 3.1250 (3.7500) lr 1.3387e-03 eta 0:00:06
epoch [80/200] batch [20/40] time 0.256 (0.265) data 0.091 (0.107) loss_u loss_u 0.9639 (0.9608) acc_u 3.1250 (4.3750) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [25/40] time 0.250 (0.264) data 0.082 (0.105) loss_u loss_u 0.9941 (0.9613) acc_u 0.0000 (4.2500) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [30/40] time 0.283 (0.263) data 0.125 (0.104) loss_u loss_u 0.9668 (0.9626) acc_u 3.1250 (4.1667) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [35/40] time 0.288 (0.261) data 0.102 (0.103) loss_u loss_u 0.9541 (0.9596) acc_u 6.2500 (4.4643) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [40/40] time 0.286 (0.263) data 0.120 (0.104) loss_u loss_u 0.9824 (0.9633) acc_u 3.1250 (4.0625) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 658
confident_label rate tensor(0.1980, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 320
clean true:298
clean false:22
clean_rate:0.93125
noisy true:660
noisy false:636
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 1296
epoch [81/200] batch [5/10] time 0.296 (0.295) data 0.136 (0.131) loss_x loss_x 0.9775 (0.8772) acc_x 71.8750 (80.6250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/10] time 0.270 (0.291) data 0.107 (0.128) loss_x loss_x 0.4316 (0.7300) acc_x 93.7500 (84.0625) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/40] time 0.251 (0.281) data 0.084 (0.117) loss_u loss_u 0.9375 (0.9662) acc_u 6.2500 (3.1250) lr 1.3239e-03 eta 0:00:09
epoch [81/200] batch [10/40] time 0.277 (0.278) data 0.107 (0.113) loss_u loss_u 0.9331 (0.9664) acc_u 9.3750 (3.7500) lr 1.3239e-03 eta 0:00:08
epoch [81/200] batch [15/40] time 0.176 (0.269) data 0.098 (0.110) loss_u loss_u 0.9331 (0.9680) acc_u 9.3750 (3.5417) lr 1.3239e-03 eta 0:00:06
epoch [81/200] batch [20/40] time 0.255 (0.270) data 0.093 (0.113) loss_u loss_u 0.9277 (0.9669) acc_u 9.3750 (3.9062) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [25/40] time 0.291 (0.271) data 0.122 (0.112) loss_u loss_u 0.9565 (0.9649) acc_u 3.1250 (4.1250) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [30/40] time 0.257 (0.269) data 0.090 (0.110) loss_u loss_u 0.9653 (0.9624) acc_u 3.1250 (4.2708) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [35/40] time 0.257 (0.268) data 0.095 (0.109) loss_u loss_u 0.9106 (0.9568) acc_u 9.3750 (4.9107) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [40/40] time 0.246 (0.268) data 0.087 (0.108) loss_u loss_u 0.8516 (0.9516) acc_u 18.7500 (5.6250) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 651
confident_label rate tensor(0.2011, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 325
clean true:307
clean false:18
clean_rate:0.9446153846153846
noisy true:658
noisy false:633
after delete: len(clean_dataset) 325
after delete: len(noisy_dataset) 1291
epoch [82/200] batch [5/10] time 0.265 (0.267) data 0.106 (0.109) loss_x loss_x 0.5449 (0.6538) acc_x 87.5000 (84.3750) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/10] time 0.267 (0.271) data 0.109 (0.113) loss_x loss_x 0.4910 (0.6475) acc_x 90.6250 (84.6875) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/40] time 0.232 (0.263) data 0.102 (0.112) loss_u loss_u 0.9209 (0.9361) acc_u 9.3750 (8.1250) lr 1.3090e-03 eta 0:00:09
epoch [82/200] batch [10/40] time 0.264 (0.264) data 0.106 (0.110) loss_u loss_u 0.9888 (0.9499) acc_u 0.0000 (5.9375) lr 1.3090e-03 eta 0:00:07
epoch [82/200] batch [15/40] time 0.250 (0.264) data 0.081 (0.107) loss_u loss_u 0.9492 (0.9572) acc_u 6.2500 (5.0000) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [20/40] time 0.248 (0.262) data 0.084 (0.105) loss_u loss_u 0.9712 (0.9622) acc_u 3.1250 (4.3750) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [25/40] time 0.249 (0.261) data 0.082 (0.102) loss_u loss_u 0.9980 (0.9615) acc_u 0.0000 (4.6250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [30/40] time 0.214 (0.260) data 0.100 (0.102) loss_u loss_u 0.9072 (0.9594) acc_u 9.3750 (4.8958) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [35/40] time 0.247 (0.257) data 0.084 (0.100) loss_u loss_u 0.9395 (0.9598) acc_u 9.3750 (4.8214) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [40/40] time 0.246 (0.257) data 0.082 (0.099) loss_u loss_u 0.9058 (0.9564) acc_u 9.3750 (5.2344) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.2042, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 330
clean true:314
clean false:16
clean_rate:0.9515151515151515
noisy true:658
noisy false:628
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 1286
epoch [83/200] batch [5/10] time 0.263 (0.253) data 0.104 (0.105) loss_x loss_x 0.4900 (0.6779) acc_x 87.5000 (79.3750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/10] time 0.264 (0.259) data 0.105 (0.106) loss_x loss_x 0.7505 (0.7295) acc_x 84.3750 (81.8750) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/40] time 0.262 (0.261) data 0.105 (0.106) loss_u loss_u 0.9834 (0.9526) acc_u 3.1250 (6.2500) lr 1.2940e-03 eta 0:00:09
epoch [83/200] batch [10/40] time 0.266 (0.265) data 0.106 (0.108) loss_u loss_u 0.9873 (0.9667) acc_u 0.0000 (4.0625) lr 1.2940e-03 eta 0:00:07
epoch [83/200] batch [15/40] time 0.267 (0.266) data 0.105 (0.108) loss_u loss_u 0.9102 (0.9621) acc_u 12.5000 (4.7917) lr 1.2940e-03 eta 0:00:06
epoch [83/200] batch [20/40] time 0.266 (0.260) data 0.105 (0.107) loss_u loss_u 0.9990 (0.9647) acc_u 0.0000 (4.5312) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [25/40] time 0.275 (0.262) data 0.107 (0.107) loss_u loss_u 0.9736 (0.9659) acc_u 6.2500 (4.2500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [30/40] time 0.246 (0.262) data 0.084 (0.105) loss_u loss_u 0.9639 (0.9656) acc_u 3.1250 (4.1667) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [35/40] time 0.266 (0.263) data 0.098 (0.106) loss_u loss_u 0.9199 (0.9598) acc_u 9.3750 (4.8214) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [40/40] time 0.255 (0.263) data 0.085 (0.105) loss_u loss_u 0.9668 (0.9583) acc_u 3.1250 (5.0000) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 317
clean true:300
clean false:17
clean_rate:0.9463722397476341
noisy true:642
noisy false:657
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 1299
epoch [84/200] batch [5/9] time 0.264 (0.262) data 0.103 (0.107) loss_x loss_x 0.4192 (0.7079) acc_x 84.3750 (82.5000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [5/40] time 0.276 (0.275) data 0.111 (0.116) loss_u loss_u 0.9932 (0.9561) acc_u 0.0000 (4.3750) lr 1.2790e-03 eta 0:00:09
epoch [84/200] batch [10/40] time 0.272 (0.275) data 0.107 (0.115) loss_u loss_u 0.9697 (0.9617) acc_u 3.1250 (4.3750) lr 1.2790e-03 eta 0:00:08
epoch [84/200] batch [15/40] time 0.327 (0.279) data 0.171 (0.119) loss_u loss_u 0.9233 (0.9554) acc_u 9.3750 (5.2083) lr 1.2790e-03 eta 0:00:06
epoch [84/200] batch [20/40] time 0.245 (0.273) data 0.083 (0.118) loss_u loss_u 0.9590 (0.9497) acc_u 6.2500 (5.7812) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [25/40] time 0.271 (0.273) data 0.106 (0.117) loss_u loss_u 0.9380 (0.9500) acc_u 6.2500 (5.5000) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [30/40] time 0.265 (0.273) data 0.108 (0.116) loss_u loss_u 0.9912 (0.9533) acc_u 3.1250 (5.2083) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [35/40] time 0.275 (0.273) data 0.110 (0.115) loss_u loss_u 0.9146 (0.9492) acc_u 9.3750 (5.6250) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [40/40] time 0.267 (0.272) data 0.106 (0.114) loss_u loss_u 0.9546 (0.9501) acc_u 6.2500 (5.6250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.2036, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 329
clean true:310
clean false:19
clean_rate:0.9422492401215805
noisy true:671
noisy false:616
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1287
epoch [85/200] batch [5/10] time 0.271 (0.269) data 0.106 (0.106) loss_x loss_x 0.5479 (0.6642) acc_x 90.6250 (86.2500) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/10] time 0.272 (0.265) data 0.108 (0.103) loss_x loss_x 0.6602 (0.6253) acc_x 81.2500 (84.6875) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/40] time 0.186 (0.257) data 0.108 (0.105) loss_u loss_u 0.9756 (0.9551) acc_u 3.1250 (5.0000) lr 1.2639e-03 eta 0:00:08
epoch [85/200] batch [10/40] time 0.278 (0.259) data 0.116 (0.105) loss_u loss_u 0.9561 (0.9549) acc_u 6.2500 (5.3125) lr 1.2639e-03 eta 0:00:07
epoch [85/200] batch [15/40] time 0.273 (0.265) data 0.108 (0.108) loss_u loss_u 0.9678 (0.9576) acc_u 3.1250 (5.2083) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [20/40] time 0.248 (0.264) data 0.083 (0.106) loss_u loss_u 0.9683 (0.9619) acc_u 3.1250 (4.6875) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [25/40] time 0.241 (0.262) data 0.082 (0.104) loss_u loss_u 0.9644 (0.9595) acc_u 3.1250 (4.8750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [30/40] time 0.207 (0.262) data 0.106 (0.105) loss_u loss_u 0.8740 (0.9558) acc_u 12.5000 (5.4167) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [35/40] time 0.257 (0.261) data 0.092 (0.105) loss_u loss_u 0.9263 (0.9556) acc_u 6.2500 (5.2679) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [40/40] time 0.284 (0.265) data 0.123 (0.108) loss_u loss_u 0.9966 (0.9577) acc_u 0.0000 (5.0781) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.2079, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 336
clean true:315
clean false:21
clean_rate:0.9375
noisy true:663
noisy false:617
after delete: len(clean_dataset) 336
after delete: len(noisy_dataset) 1280
epoch [86/200] batch [5/10] time 0.267 (0.273) data 0.107 (0.111) loss_x loss_x 0.5083 (0.8027) acc_x 90.6250 (78.7500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/10] time 0.270 (0.270) data 0.106 (0.108) loss_x loss_x 0.8667 (0.8050) acc_x 90.6250 (80.9375) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/40] time 0.277 (0.258) data 0.107 (0.107) loss_u loss_u 0.9839 (0.9538) acc_u 3.1250 (5.6250) lr 1.2487e-03 eta 0:00:09
epoch [86/200] batch [10/40] time 0.247 (0.259) data 0.082 (0.105) loss_u loss_u 0.9995 (0.9601) acc_u 0.0000 (5.0000) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [15/40] time 0.301 (0.262) data 0.137 (0.106) loss_u loss_u 0.9561 (0.9552) acc_u 6.2500 (5.4167) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [20/40] time 0.247 (0.263) data 0.082 (0.106) loss_u loss_u 0.9619 (0.9583) acc_u 6.2500 (5.1562) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [25/40] time 0.242 (0.262) data 0.082 (0.103) loss_u loss_u 0.9937 (0.9575) acc_u 0.0000 (5.0000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [30/40] time 0.184 (0.258) data 0.107 (0.103) loss_u loss_u 0.9209 (0.9577) acc_u 9.3750 (5.1042) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [35/40] time 0.247 (0.258) data 0.082 (0.102) loss_u loss_u 0.9785 (0.9592) acc_u 0.0000 (4.7321) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [40/40] time 0.267 (0.257) data 0.103 (0.101) loss_u loss_u 0.9053 (0.9564) acc_u 9.3750 (5.0000) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.2042, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 330
clean true:311
clean false:19
clean_rate:0.9424242424242424
noisy true:637
noisy false:649
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 1286
epoch [87/200] batch [5/10] time 0.273 (0.269) data 0.109 (0.107) loss_x loss_x 0.7632 (0.7681) acc_x 71.8750 (79.3750) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/10] time 0.270 (0.268) data 0.106 (0.107) loss_x loss_x 0.7803 (0.7388) acc_x 84.3750 (80.9375) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/40] time 0.259 (0.268) data 0.093 (0.105) loss_u loss_u 0.9634 (0.9609) acc_u 6.2500 (5.0000) lr 1.2334e-03 eta 0:00:09
epoch [87/200] batch [10/40] time 0.281 (0.265) data 0.106 (0.107) loss_u loss_u 0.9434 (0.9497) acc_u 6.2500 (6.2500) lr 1.2334e-03 eta 0:00:07
epoch [87/200] batch [15/40] time 0.259 (0.264) data 0.098 (0.105) loss_u loss_u 0.9268 (0.9452) acc_u 9.3750 (6.6667) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [20/40] time 0.267 (0.265) data 0.105 (0.106) loss_u loss_u 0.9961 (0.9473) acc_u 0.0000 (6.0938) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [25/40] time 0.273 (0.268) data 0.108 (0.108) loss_u loss_u 0.9678 (0.9512) acc_u 3.1250 (5.6250) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [30/40] time 0.272 (0.269) data 0.108 (0.109) loss_u loss_u 0.9785 (0.9545) acc_u 3.1250 (5.2083) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [35/40] time 0.182 (0.266) data 0.104 (0.110) loss_u loss_u 0.9707 (0.9573) acc_u 3.1250 (4.8214) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [40/40] time 0.268 (0.266) data 0.106 (0.109) loss_u loss_u 0.9780 (0.9570) acc_u 3.1250 (4.8438) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 338
clean true:320
clean false:18
clean_rate:0.9467455621301775
noisy true:647
noisy false:631
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1278
epoch [88/200] batch [5/10] time 0.273 (0.269) data 0.110 (0.108) loss_x loss_x 0.5566 (0.8130) acc_x 81.2500 (79.3750) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/10] time 0.249 (0.248) data 0.085 (0.101) loss_x loss_x 0.7900 (0.8632) acc_x 87.5000 (80.0000) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/39] time 0.276 (0.253) data 0.108 (0.101) loss_u loss_u 0.9370 (0.9784) acc_u 6.2500 (1.8750) lr 1.2181e-03 eta 0:00:08
epoch [88/200] batch [10/39] time 0.305 (0.259) data 0.143 (0.104) loss_u loss_u 0.9468 (0.9636) acc_u 6.2500 (4.0625) lr 1.2181e-03 eta 0:00:07
epoch [88/200] batch [15/39] time 0.276 (0.263) data 0.106 (0.106) loss_u loss_u 0.9121 (0.9581) acc_u 12.5000 (4.7917) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [20/39] time 0.274 (0.264) data 0.109 (0.106) loss_u loss_u 0.9355 (0.9583) acc_u 6.2500 (4.5312) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [25/39] time 0.288 (0.261) data 0.107 (0.106) loss_u loss_u 0.9888 (0.9580) acc_u 0.0000 (4.5000) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [30/39] time 0.272 (0.262) data 0.108 (0.106) loss_u loss_u 0.9551 (0.9601) acc_u 3.1250 (4.1667) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [35/39] time 0.271 (0.263) data 0.106 (0.107) loss_u loss_u 0.9922 (0.9622) acc_u 0.0000 (3.9286) lr 1.2181e-03 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.2017, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 326
clean true:308
clean false:18
clean_rate:0.9447852760736196
noisy true:669
noisy false:621
after delete: len(clean_dataset) 326
after delete: len(noisy_dataset) 1290
epoch [89/200] batch [5/10] time 0.272 (0.276) data 0.108 (0.110) loss_x loss_x 0.6353 (0.7626) acc_x 87.5000 (82.5000) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/10] time 0.280 (0.274) data 0.125 (0.111) loss_x loss_x 0.4221 (0.7010) acc_x 90.6250 (83.7500) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/40] time 0.279 (0.276) data 0.111 (0.113) loss_u loss_u 0.9409 (0.9550) acc_u 6.2500 (5.6250) lr 1.2028e-03 eta 0:00:09
epoch [89/200] batch [10/40] time 0.283 (0.277) data 0.114 (0.112) loss_u loss_u 0.9834 (0.9501) acc_u 0.0000 (5.6250) lr 1.2028e-03 eta 0:00:08
epoch [89/200] batch [15/40] time 0.184 (0.271) data 0.107 (0.111) loss_u loss_u 0.9990 (0.9572) acc_u 0.0000 (4.7917) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [20/40] time 0.274 (0.269) data 0.106 (0.110) loss_u loss_u 0.9102 (0.9518) acc_u 12.5000 (5.6250) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [25/40] time 0.268 (0.269) data 0.107 (0.110) loss_u loss_u 0.9985 (0.9561) acc_u 0.0000 (5.0000) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [30/40] time 0.277 (0.270) data 0.108 (0.110) loss_u loss_u 0.8984 (0.9523) acc_u 12.5000 (5.4167) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [35/40] time 0.274 (0.270) data 0.104 (0.110) loss_u loss_u 0.9814 (0.9532) acc_u 3.1250 (5.4464) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [40/40] time 0.235 (0.270) data 0.107 (0.109) loss_u loss_u 0.9204 (0.9525) acc_u 9.3750 (5.4688) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.1962, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 317
clean true:301
clean false:16
clean_rate:0.9495268138801262
noisy true:691
noisy false:608
after delete: len(clean_dataset) 317
after delete: len(noisy_dataset) 1299
epoch [90/200] batch [5/9] time 0.270 (0.268) data 0.108 (0.106) loss_x loss_x 0.3838 (0.7410) acc_x 87.5000 (80.6250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [5/40] time 0.244 (0.254) data 0.108 (0.099) loss_u loss_u 1.0000 (0.9418) acc_u 0.0000 (6.8750) lr 1.1874e-03 eta 0:00:08
epoch [90/200] batch [10/40] time 0.274 (0.260) data 0.106 (0.103) loss_u loss_u 0.9995 (0.9553) acc_u 0.0000 (5.0000) lr 1.1874e-03 eta 0:00:07
epoch [90/200] batch [15/40] time 0.251 (0.261) data 0.082 (0.101) loss_u loss_u 0.9590 (0.9556) acc_u 9.3750 (5.4167) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [20/40] time 0.282 (0.263) data 0.118 (0.102) loss_u loss_u 0.9858 (0.9602) acc_u 6.2500 (5.1562) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [25/40] time 0.185 (0.262) data 0.103 (0.103) loss_u loss_u 0.9575 (0.9600) acc_u 6.2500 (5.3750) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [30/40] time 0.295 (0.263) data 0.136 (0.105) loss_u loss_u 0.9731 (0.9610) acc_u 3.1250 (5.3125) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [35/40] time 0.259 (0.263) data 0.096 (0.104) loss_u loss_u 0.9360 (0.9579) acc_u 12.5000 (5.6250) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [40/40] time 0.334 (0.267) data 0.175 (0.108) loss_u loss_u 0.9355 (0.9591) acc_u 12.5000 (5.6250) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.2073, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 335
clean true:322
clean false:13
clean_rate:0.9611940298507463
noisy true:677
noisy false:604
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1281
epoch [91/200] batch [5/10] time 0.271 (0.269) data 0.107 (0.106) loss_x loss_x 0.5869 (0.7487) acc_x 84.3750 (80.0000) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/10] time 0.244 (0.264) data 0.082 (0.103) loss_x loss_x 0.7896 (0.7248) acc_x 81.2500 (81.2500) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/40] time 0.271 (0.266) data 0.107 (0.103) loss_u loss_u 0.9824 (0.9400) acc_u 3.1250 (7.5000) lr 1.1719e-03 eta 0:00:09
epoch [91/200] batch [10/40] time 0.275 (0.272) data 0.108 (0.109) loss_u loss_u 0.9404 (0.9532) acc_u 6.2500 (5.9375) lr 1.1719e-03 eta 0:00:08
epoch [91/200] batch [15/40] time 0.159 (0.265) data 0.081 (0.107) loss_u loss_u 0.9575 (0.9652) acc_u 3.1250 (4.1667) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [20/40] time 0.276 (0.266) data 0.107 (0.106) loss_u loss_u 0.9185 (0.9614) acc_u 9.3750 (4.6875) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [25/40] time 0.254 (0.264) data 0.086 (0.103) loss_u loss_u 0.9043 (0.9595) acc_u 12.5000 (5.0000) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [30/40] time 0.315 (0.266) data 0.150 (0.105) loss_u loss_u 0.9414 (0.9605) acc_u 6.2500 (4.7917) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [35/40] time 0.256 (0.266) data 0.088 (0.105) loss_u loss_u 0.9595 (0.9604) acc_u 6.2500 (4.8214) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [40/40] time 0.197 (0.265) data 0.106 (0.104) loss_u loss_u 0.9756 (0.9605) acc_u 3.1250 (4.7656) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 632
confident_label rate tensor(0.2036, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 329
clean true:314
clean false:15
clean_rate:0.9544072948328267
noisy true:670
noisy false:617
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1287
epoch [92/200] batch [5/10] time 0.268 (0.267) data 0.107 (0.106) loss_x loss_x 0.4983 (0.6041) acc_x 81.2500 (81.2500) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/10] time 0.273 (0.267) data 0.113 (0.109) loss_x loss_x 1.0586 (0.6324) acc_x 75.0000 (81.5625) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/40] time 0.268 (0.268) data 0.109 (0.108) loss_u loss_u 0.9917 (0.9775) acc_u 3.1250 (3.1250) lr 1.1564e-03 eta 0:00:09
epoch [92/200] batch [10/40] time 0.251 (0.265) data 0.086 (0.105) loss_u loss_u 0.9380 (0.9663) acc_u 6.2500 (4.0625) lr 1.1564e-03 eta 0:00:07
epoch [92/200] batch [15/40] time 0.184 (0.261) data 0.106 (0.107) loss_u loss_u 0.9678 (0.9614) acc_u 3.1250 (4.3750) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [20/40] time 0.274 (0.262) data 0.110 (0.107) loss_u loss_u 0.9380 (0.9508) acc_u 6.2500 (5.7812) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [25/40] time 0.278 (0.263) data 0.109 (0.105) loss_u loss_u 1.0000 (0.9518) acc_u 0.0000 (5.7500) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [30/40] time 0.266 (0.263) data 0.109 (0.105) loss_u loss_u 0.9961 (0.9520) acc_u 0.0000 (5.6250) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [35/40] time 0.272 (0.265) data 0.107 (0.106) loss_u loss_u 0.9126 (0.9542) acc_u 9.3750 (5.2679) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [40/40] time 0.221 (0.265) data 0.110 (0.106) loss_u loss_u 0.9990 (0.9555) acc_u 0.0000 (5.0781) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 611
confident_label rate tensor(0.2054, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 332
clean true:316
clean false:16
clean_rate:0.9518072289156626
noisy true:689
noisy false:595
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1284
epoch [93/200] batch [5/10] time 0.264 (0.261) data 0.105 (0.099) loss_x loss_x 0.4954 (0.5232) acc_x 87.5000 (86.8750) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/10] time 0.264 (0.265) data 0.106 (0.105) loss_x loss_x 0.9199 (0.6377) acc_x 75.0000 (84.0625) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/40] time 0.273 (0.267) data 0.106 (0.105) loss_u loss_u 0.9502 (0.9568) acc_u 6.2500 (5.0000) lr 1.1409e-03 eta 0:00:09
epoch [93/200] batch [10/40] time 0.293 (0.268) data 0.129 (0.107) loss_u loss_u 0.8960 (0.9535) acc_u 12.5000 (5.6250) lr 1.1409e-03 eta 0:00:08
epoch [93/200] batch [15/40] time 0.181 (0.268) data 0.104 (0.110) loss_u loss_u 0.9878 (0.9662) acc_u 3.1250 (4.1667) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [20/40] time 0.286 (0.269) data 0.118 (0.110) loss_u loss_u 0.9761 (0.9678) acc_u 0.0000 (3.4375) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [25/40] time 0.271 (0.267) data 0.108 (0.107) loss_u loss_u 0.9404 (0.9603) acc_u 6.2500 (4.2500) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [30/40] time 0.264 (0.265) data 0.101 (0.106) loss_u loss_u 0.9673 (0.9611) acc_u 3.1250 (4.1667) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [35/40] time 0.270 (0.266) data 0.107 (0.105) loss_u loss_u 0.9175 (0.9601) acc_u 12.5000 (4.4643) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [40/40] time 0.255 (0.265) data 0.095 (0.104) loss_u loss_u 0.9917 (0.9604) acc_u 0.0000 (4.5312) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 633
confident_label rate tensor(0.2042, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 330
clean true:314
clean false:16
clean_rate:0.9515151515151515
noisy true:669
noisy false:617
after delete: len(clean_dataset) 330
after delete: len(noisy_dataset) 1286
epoch [94/200] batch [5/10] time 0.266 (0.260) data 0.107 (0.099) loss_x loss_x 0.6899 (0.6902) acc_x 90.6250 (85.6250) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/10] time 0.280 (0.276) data 0.117 (0.114) loss_x loss_x 0.8062 (0.6846) acc_x 81.2500 (84.3750) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/40] time 0.407 (0.272) data 0.248 (0.122) loss_u loss_u 0.9399 (0.9567) acc_u 6.2500 (4.3750) lr 1.1253e-03 eta 0:00:09
epoch [94/200] batch [10/40] time 0.245 (0.266) data 0.083 (0.112) loss_u loss_u 0.9229 (0.9429) acc_u 12.5000 (6.8750) lr 1.1253e-03 eta 0:00:07
epoch [94/200] batch [15/40] time 0.247 (0.261) data 0.082 (0.106) loss_u loss_u 0.8853 (0.9449) acc_u 12.5000 (6.4583) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [20/40] time 0.259 (0.262) data 0.103 (0.106) loss_u loss_u 0.9961 (0.9529) acc_u 0.0000 (5.4688) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [25/40] time 0.248 (0.263) data 0.085 (0.106) loss_u loss_u 0.9458 (0.9529) acc_u 6.2500 (5.5000) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [30/40] time 0.247 (0.262) data 0.083 (0.104) loss_u loss_u 0.9922 (0.9553) acc_u 0.0000 (5.2083) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [35/40] time 0.276 (0.259) data 0.110 (0.104) loss_u loss_u 0.9966 (0.9592) acc_u 0.0000 (4.8214) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [40/40] time 0.275 (0.261) data 0.116 (0.106) loss_u loss_u 0.9053 (0.9572) acc_u 9.3750 (5.0000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 631
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 338
clean true:317
clean false:21
clean_rate:0.9378698224852071
noisy true:668
noisy false:610
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1278
epoch [95/200] batch [5/10] time 0.270 (0.267) data 0.106 (0.105) loss_x loss_x 0.5317 (0.6363) acc_x 87.5000 (83.1250) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/10] time 0.247 (0.268) data 0.082 (0.106) loss_x loss_x 1.0166 (0.5975) acc_x 81.2500 (85.6250) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/39] time 0.185 (0.253) data 0.107 (0.102) loss_u loss_u 0.9971 (0.9580) acc_u 0.0000 (4.3750) lr 1.1097e-03 eta 0:00:08
epoch [95/200] batch [10/39] time 0.274 (0.259) data 0.106 (0.103) loss_u loss_u 0.8877 (0.9478) acc_u 12.5000 (5.9375) lr 1.1097e-03 eta 0:00:07
epoch [95/200] batch [15/39] time 0.268 (0.261) data 0.107 (0.104) loss_u loss_u 0.9692 (0.9536) acc_u 3.1250 (5.2083) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [20/39] time 0.270 (0.261) data 0.102 (0.102) loss_u loss_u 0.9922 (0.9552) acc_u 0.0000 (5.0000) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [25/39] time 0.265 (0.262) data 0.103 (0.102) loss_u loss_u 0.9185 (0.9545) acc_u 12.5000 (5.3750) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [30/39] time 0.242 (0.261) data 0.083 (0.100) loss_u loss_u 0.9692 (0.9584) acc_u 6.2500 (4.8958) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [35/39] time 0.269 (0.257) data 0.108 (0.100) loss_u loss_u 0.9463 (0.9610) acc_u 6.2500 (4.5536) lr 1.1097e-03 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.2036, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 329
clean true:309
clean false:20
clean_rate:0.939209726443769
noisy true:661
noisy false:626
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1287
epoch [96/200] batch [5/10] time 0.256 (0.258) data 0.092 (0.094) loss_x loss_x 0.4326 (0.6725) acc_x 93.7500 (86.2500) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/10] time 0.295 (0.264) data 0.136 (0.102) loss_x loss_x 0.7124 (0.6389) acc_x 78.1250 (85.0000) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/40] time 0.267 (0.252) data 0.103 (0.100) loss_u loss_u 0.9492 (0.9549) acc_u 6.2500 (5.0000) lr 1.0941e-03 eta 0:00:08
epoch [96/200] batch [10/40] time 0.242 (0.252) data 0.090 (0.098) loss_u loss_u 0.9756 (0.9642) acc_u 3.1250 (4.0625) lr 1.0941e-03 eta 0:00:07
epoch [96/200] batch [15/40] time 0.260 (0.254) data 0.099 (0.099) loss_u loss_u 0.9375 (0.9573) acc_u 6.2500 (5.2083) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [20/40] time 0.276 (0.257) data 0.108 (0.099) loss_u loss_u 0.9458 (0.9564) acc_u 6.2500 (5.3125) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [25/40] time 0.270 (0.258) data 0.108 (0.100) loss_u loss_u 0.9370 (0.9556) acc_u 6.2500 (5.2500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [30/40] time 0.282 (0.259) data 0.100 (0.101) loss_u loss_u 0.9966 (0.9582) acc_u 0.0000 (4.8958) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [35/40] time 0.248 (0.259) data 0.082 (0.101) loss_u loss_u 0.9922 (0.9591) acc_u 0.0000 (4.8214) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [40/40] time 0.276 (0.260) data 0.106 (0.100) loss_u loss_u 0.9282 (0.9585) acc_u 9.3750 (4.9219) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 618
confident_label rate tensor(0.2234, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 361
clean true:339
clean false:22
clean_rate:0.9390581717451524
noisy true:659
noisy false:596
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1255
epoch [97/200] batch [5/11] time 0.271 (0.270) data 0.107 (0.107) loss_x loss_x 0.5786 (0.6100) acc_x 84.3750 (84.3750) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [10/11] time 0.270 (0.268) data 0.105 (0.106) loss_x loss_x 0.7290 (0.7153) acc_x 87.5000 (83.1250) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/39] time 0.274 (0.261) data 0.107 (0.107) loss_u loss_u 0.9717 (0.9606) acc_u 3.1250 (5.0000) lr 1.0785e-03 eta 0:00:08
epoch [97/200] batch [10/39] time 0.269 (0.267) data 0.107 (0.112) loss_u loss_u 0.9346 (0.9543) acc_u 9.3750 (5.6250) lr 1.0785e-03 eta 0:00:07
epoch [97/200] batch [15/39] time 0.267 (0.269) data 0.106 (0.111) loss_u loss_u 0.9434 (0.9582) acc_u 6.2500 (5.0000) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [20/39] time 0.283 (0.269) data 0.115 (0.111) loss_u loss_u 0.9780 (0.9650) acc_u 3.1250 (4.0625) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [25/39] time 0.271 (0.270) data 0.103 (0.111) loss_u loss_u 0.9111 (0.9642) acc_u 9.3750 (4.1250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [30/39] time 0.283 (0.268) data 0.115 (0.111) loss_u loss_u 0.9854 (0.9621) acc_u 3.1250 (4.3750) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [35/39] time 0.265 (0.269) data 0.106 (0.112) loss_u loss_u 0.9971 (0.9649) acc_u 0.0000 (4.0179) lr 1.0785e-03 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 622
confident_label rate tensor(0.2129, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 344
clean true:324
clean false:20
clean_rate:0.9418604651162791
noisy true:670
noisy false:602
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1272
epoch [98/200] batch [5/10] time 0.267 (0.271) data 0.106 (0.108) loss_x loss_x 0.7207 (0.7381) acc_x 78.1250 (80.0000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/10] time 0.273 (0.270) data 0.110 (0.108) loss_x loss_x 0.2700 (0.6605) acc_x 93.7500 (82.1875) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/39] time 0.272 (0.262) data 0.105 (0.108) loss_u loss_u 0.9473 (0.9508) acc_u 3.1250 (5.0000) lr 1.0628e-03 eta 0:00:08
epoch [98/200] batch [10/39] time 0.261 (0.264) data 0.106 (0.107) loss_u loss_u 0.9863 (0.9516) acc_u 0.0000 (5.0000) lr 1.0628e-03 eta 0:00:07
epoch [98/200] batch [15/39] time 0.273 (0.265) data 0.106 (0.107) loss_u loss_u 0.9995 (0.9658) acc_u 0.0000 (3.5417) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [20/39] time 0.268 (0.265) data 0.108 (0.107) loss_u loss_u 0.9648 (0.9652) acc_u 3.1250 (3.5938) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [25/39] time 0.187 (0.261) data 0.108 (0.107) loss_u loss_u 0.9985 (0.9613) acc_u 0.0000 (4.1250) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [30/39] time 0.297 (0.263) data 0.131 (0.108) loss_u loss_u 0.9497 (0.9615) acc_u 6.2500 (4.1667) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [35/39] time 0.272 (0.263) data 0.105 (0.106) loss_u loss_u 0.9976 (0.9601) acc_u 0.0000 (4.3750) lr 1.0628e-03 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 630
confident_label rate tensor(0.2036, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 329
clean true:314
clean false:15
clean_rate:0.9544072948328267
noisy true:672
noisy false:615
after delete: len(clean_dataset) 329
after delete: len(noisy_dataset) 1287
epoch [99/200] batch [5/10] time 0.245 (0.262) data 0.082 (0.101) loss_x loss_x 0.2637 (0.4544) acc_x 93.7500 (88.1250) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/10] time 0.270 (0.266) data 0.110 (0.105) loss_x loss_x 0.6006 (0.4890) acc_x 84.3750 (86.5625) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/40] time 0.282 (0.261) data 0.126 (0.106) loss_u loss_u 0.9380 (0.9545) acc_u 6.2500 (5.0000) lr 1.0471e-03 eta 0:00:09
epoch [99/200] batch [10/40] time 0.263 (0.266) data 0.096 (0.109) loss_u loss_u 0.9673 (0.9573) acc_u 3.1250 (4.3750) lr 1.0471e-03 eta 0:00:07
epoch [99/200] batch [15/40] time 0.253 (0.264) data 0.086 (0.104) loss_u loss_u 0.9990 (0.9627) acc_u 0.0000 (3.9583) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [20/40] time 0.255 (0.262) data 0.097 (0.102) loss_u loss_u 0.9492 (0.9646) acc_u 6.2500 (3.9062) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [25/40] time 0.269 (0.261) data 0.102 (0.100) loss_u loss_u 0.9072 (0.9554) acc_u 9.3750 (4.8750) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [30/40] time 0.164 (0.257) data 0.087 (0.100) loss_u loss_u 0.9546 (0.9567) acc_u 6.2500 (4.7917) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [35/40] time 0.290 (0.259) data 0.123 (0.101) loss_u loss_u 0.9199 (0.9582) acc_u 6.2500 (4.6429) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [40/40] time 0.248 (0.258) data 0.083 (0.099) loss_u loss_u 0.9556 (0.9579) acc_u 6.2500 (4.7656) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 640
confident_label rate tensor(0.2110, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 341
clean true:320
clean false:21
clean_rate:0.9384164222873901
noisy true:656
noisy false:619
all clean rate:  [0.9763779527559056, 0.9586206896551724, 0.9752475247524752, 0.968609865470852, 0.9699570815450643, 0.9915966386554622, 0.96875, 0.9785407725321889, 0.9745762711864406, 0.975, 0.9747899159663865, 0.9841897233201581, 0.9704641350210971, 0.9554655870445344, 0.9841269841269841, 0.9764705882352941, 0.972, 0.969811320754717, 0.9727626459143969, 0.9806201550387597, 0.9884615384615385, 0.9689922480620154, 0.9626865671641791, 0.9655172413793104, 0.9849624060150376, 0.9768339768339769, 0.9615384615384616, 0.9773584905660377, 0.9752650176678446, 0.9712230215827338, 0.9706959706959707, 0.9717314487632509, 0.9719298245614035, 0.9620689655172414, 0.9788732394366197, 0.9717314487632509, 0.9598540145985401, 0.9644128113879004, 0.9543859649122807, 0.9592592592592593, 0.9674267100977199, 0.9726027397260274, 0.9634551495016611, 0.9709677419354839, 0.9550173010380623, 0.952054794520548, 0.9433333333333334, 0.9593220338983051, 0.9581993569131833, 0.9621993127147767, 0.9533333333333334, 0.9632107023411371, 0.9639344262295082, 0.9508196721311475, 0.9636963696369637, 0.9625, 0.9616613418530351, 0.9667774086378738, 0.9619047619047619, 0.9802631578947368, 0.9551282051282052, 0.9528301886792453, 0.9539877300613497, 0.9439252336448598, 0.9674267100977199, 0.9377049180327869, 0.9517684887459807, 0.9519230769230769, 0.9588607594936709, 0.9472049689440993, 0.9301587301587302, 0.9440993788819876, 0.9408284023668639, 0.9321533923303835, 0.9587301587301588, 0.9556962025316456, 0.9595015576323987, 0.9329268292682927, 0.9501557632398754, 0.9424242424242424, 0.93125, 0.9446153846153846, 0.9515151515151515, 0.9463722397476341, 0.9422492401215805, 0.9375, 0.9424242424242424, 0.9467455621301775, 0.9447852760736196, 0.9495268138801262, 0.9611940298507463, 0.9544072948328267, 0.9518072289156626, 0.9515151515151515, 0.9378698224852071, 0.939209726443769, 0.9390581717451524, 0.9418604651162791, 0.9544072948328267, 0.9384164222873901]
after delete: len(clean_dataset) 341
after delete: len(noisy_dataset) 1275
epoch [100/200] batch [5/10] time 0.266 (0.277) data 0.105 (0.116) loss_x loss_x 0.7310 (0.5663) acc_x 90.6250 (88.1250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/10] time 0.265 (0.272) data 0.106 (0.110) loss_x loss_x 0.6494 (0.6285) acc_x 84.3750 (85.9375) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/39] time 0.274 (0.261) data 0.105 (0.109) loss_u loss_u 0.9248 (0.9519) acc_u 9.3750 (5.6250) lr 1.0314e-03 eta 0:00:08
epoch [100/200] batch [10/39] time 0.269 (0.263) data 0.104 (0.108) loss_u loss_u 0.9990 (0.9570) acc_u 0.0000 (4.6875) lr 1.0314e-03 eta 0:00:07
epoch [100/200] batch [15/39] time 0.264 (0.264) data 0.105 (0.108) loss_u loss_u 0.9971 (0.9598) acc_u 0.0000 (4.3750) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [20/39] time 0.276 (0.266) data 0.108 (0.107) loss_u loss_u 0.9902 (0.9605) acc_u 3.1250 (4.3750) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [25/39] time 0.276 (0.266) data 0.113 (0.107) loss_u loss_u 0.9917 (0.9640) acc_u 3.1250 (4.0000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [30/39] time 0.273 (0.265) data 0.107 (0.108) loss_u loss_u 0.9805 (0.9617) acc_u 3.1250 (4.3750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [35/39] time 0.273 (0.266) data 0.105 (0.109) loss_u loss_u 0.9712 (0.9611) acc_u 3.1250 (4.3750) lr 1.0314e-03 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 648
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 338
clean true:323
clean false:15
clean_rate:0.9556213017751479
noisy true:645
noisy false:633
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1278
epoch [101/200] batch [5/10] time 0.263 (0.268) data 0.100 (0.105) loss_x loss_x 0.4675 (0.5945) acc_x 87.5000 (85.0000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/10] time 0.294 (0.269) data 0.129 (0.106) loss_x loss_x 0.5010 (0.6225) acc_x 93.7500 (84.6875) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/39] time 0.277 (0.259) data 0.106 (0.106) loss_u loss_u 0.9165 (0.9659) acc_u 9.3750 (3.7500) lr 1.0157e-03 eta 0:00:08
epoch [101/200] batch [10/39] time 0.296 (0.263) data 0.132 (0.107) loss_u loss_u 0.8862 (0.9645) acc_u 12.5000 (3.7500) lr 1.0157e-03 eta 0:00:07
epoch [101/200] batch [15/39] time 0.284 (0.271) data 0.115 (0.113) loss_u loss_u 0.9014 (0.9564) acc_u 12.5000 (5.0000) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [20/39] time 0.296 (0.271) data 0.135 (0.112) loss_u loss_u 0.9009 (0.9528) acc_u 9.3750 (5.3125) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [25/39] time 0.290 (0.272) data 0.122 (0.111) loss_u loss_u 0.9575 (0.9533) acc_u 6.2500 (5.3750) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [30/39] time 0.271 (0.269) data 0.112 (0.112) loss_u loss_u 0.9683 (0.9564) acc_u 3.1250 (5.1042) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [35/39] time 0.282 (0.271) data 0.112 (0.113) loss_u loss_u 0.9941 (0.9569) acc_u 0.0000 (5.0000) lr 1.0157e-03 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.2085, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 337
clean true:318
clean false:19
clean_rate:0.9436201780415431
noisy true:685
noisy false:594
after delete: len(clean_dataset) 337
after delete: len(noisy_dataset) 1279
epoch [102/200] batch [5/10] time 0.260 (0.256) data 0.101 (0.093) loss_x loss_x 0.5293 (0.5528) acc_x 81.2500 (84.3750) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/10] time 0.265 (0.254) data 0.102 (0.093) loss_x loss_x 0.7632 (0.6604) acc_x 84.3750 (81.8750) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/39] time 0.314 (0.261) data 0.146 (0.103) loss_u loss_u 0.9580 (0.9613) acc_u 6.2500 (5.0000) lr 1.0000e-03 eta 0:00:08
epoch [102/200] batch [10/39] time 0.283 (0.265) data 0.117 (0.105) loss_u loss_u 0.9609 (0.9637) acc_u 6.2500 (4.6875) lr 1.0000e-03 eta 0:00:07
epoch [102/200] batch [15/39] time 0.274 (0.266) data 0.104 (0.105) loss_u loss_u 0.9722 (0.9677) acc_u 3.1250 (4.3750) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [20/39] time 0.249 (0.265) data 0.083 (0.104) loss_u loss_u 0.9927 (0.9654) acc_u 0.0000 (4.5312) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [25/39] time 0.209 (0.264) data 0.120 (0.105) loss_u loss_u 0.9077 (0.9630) acc_u 12.5000 (4.8750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [30/39] time 0.264 (0.264) data 0.105 (0.105) loss_u loss_u 0.9678 (0.9628) acc_u 3.1250 (4.8958) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [35/39] time 0.293 (0.265) data 0.132 (0.106) loss_u loss_u 0.9712 (0.9608) acc_u 3.1250 (5.0000) lr 1.0000e-03 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 631
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 346
clean true:323
clean false:23
clean_rate:0.9335260115606936
noisy true:662
noisy false:608
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1270
epoch [103/200] batch [5/10] time 0.265 (0.264) data 0.106 (0.103) loss_x loss_x 0.7192 (0.6887) acc_x 78.1250 (83.7500) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/10] time 0.292 (0.271) data 0.131 (0.109) loss_x loss_x 0.3594 (0.6567) acc_x 90.6250 (82.8125) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/39] time 0.195 (0.254) data 0.106 (0.108) loss_u loss_u 0.9707 (0.9498) acc_u 6.2500 (6.2500) lr 9.8429e-04 eta 0:00:08
epoch [103/200] batch [10/39] time 0.274 (0.261) data 0.106 (0.109) loss_u loss_u 0.9502 (0.9495) acc_u 6.2500 (6.2500) lr 9.8429e-04 eta 0:00:07
epoch [103/200] batch [15/39] time 0.276 (0.264) data 0.108 (0.109) loss_u loss_u 0.9688 (0.9514) acc_u 3.1250 (5.8333) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [20/39] time 0.276 (0.266) data 0.108 (0.110) loss_u loss_u 0.9097 (0.9532) acc_u 12.5000 (5.6250) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [25/39] time 0.277 (0.270) data 0.108 (0.112) loss_u loss_u 0.9600 (0.9564) acc_u 3.1250 (5.1250) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [30/39] time 0.180 (0.265) data 0.103 (0.111) loss_u loss_u 0.9712 (0.9598) acc_u 3.1250 (4.6875) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [35/39] time 0.270 (0.267) data 0.107 (0.110) loss_u loss_u 0.9692 (0.9589) acc_u 3.1250 (4.7321) lr 9.8429e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 622
confident_label rate tensor(0.2141, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 346
clean true:323
clean false:23
clean_rate:0.9335260115606936
noisy true:671
noisy false:599
after delete: len(clean_dataset) 346
after delete: len(noisy_dataset) 1270
epoch [104/200] batch [5/10] time 0.264 (0.282) data 0.101 (0.121) loss_x loss_x 0.9766 (0.6388) acc_x 71.8750 (81.8750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/10] time 0.265 (0.279) data 0.107 (0.118) loss_x loss_x 0.5000 (0.5664) acc_x 87.5000 (85.6250) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/39] time 0.280 (0.268) data 0.111 (0.117) loss_u loss_u 0.9927 (0.9507) acc_u 0.0000 (6.2500) lr 9.6859e-04 eta 0:00:09
epoch [104/200] batch [10/39] time 0.276 (0.270) data 0.109 (0.115) loss_u loss_u 0.9595 (0.9553) acc_u 3.1250 (5.0000) lr 9.6859e-04 eta 0:00:07
epoch [104/200] batch [15/39] time 0.266 (0.272) data 0.106 (0.116) loss_u loss_u 0.9639 (0.9601) acc_u 3.1250 (4.1667) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [20/39] time 0.271 (0.272) data 0.108 (0.115) loss_u loss_u 0.9600 (0.9625) acc_u 6.2500 (4.2188) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [25/39] time 0.255 (0.271) data 0.093 (0.113) loss_u loss_u 0.9888 (0.9616) acc_u 0.0000 (4.3750) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [30/39] time 0.255 (0.267) data 0.094 (0.111) loss_u loss_u 0.9336 (0.9630) acc_u 6.2500 (4.2708) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [35/39] time 0.276 (0.267) data 0.113 (0.110) loss_u loss_u 0.9971 (0.9638) acc_u 0.0000 (4.1071) lr 9.6859e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.2160, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 349
clean true:327
clean false:22
clean_rate:0.9369627507163324
noisy true:663
noisy false:604
after delete: len(clean_dataset) 349
after delete: len(noisy_dataset) 1267
epoch [105/200] batch [5/10] time 0.270 (0.279) data 0.106 (0.117) loss_x loss_x 1.1396 (0.5530) acc_x 75.0000 (85.0000) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/10] time 0.273 (0.279) data 0.108 (0.117) loss_x loss_x 0.6323 (0.5532) acc_x 84.3750 (85.0000) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/39] time 0.276 (0.277) data 0.106 (0.114) loss_u loss_u 0.9463 (0.9755) acc_u 6.2500 (3.1250) lr 9.5289e-04 eta 0:00:09
epoch [105/200] batch [10/39] time 0.308 (0.268) data 0.118 (0.112) loss_u loss_u 0.9780 (0.9709) acc_u 6.2500 (3.7500) lr 9.5289e-04 eta 0:00:07
epoch [105/200] batch [15/39] time 0.275 (0.270) data 0.107 (0.112) loss_u loss_u 0.9673 (0.9651) acc_u 3.1250 (4.1667) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [20/39] time 0.273 (0.270) data 0.105 (0.111) loss_u loss_u 0.9414 (0.9633) acc_u 6.2500 (4.2188) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [25/39] time 0.274 (0.271) data 0.107 (0.111) loss_u loss_u 0.9756 (0.9650) acc_u 3.1250 (4.1250) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [30/39] time 0.269 (0.271) data 0.106 (0.111) loss_u loss_u 0.9004 (0.9648) acc_u 9.3750 (4.1667) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [35/39] time 0.264 (0.267) data 0.106 (0.110) loss_u loss_u 0.9546 (0.9649) acc_u 6.2500 (4.1964) lr 9.5289e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 651
confident_label rate tensor(0.2067, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 334
clean true:311
clean false:23
clean_rate:0.9311377245508982
noisy true:654
noisy false:628
after delete: len(clean_dataset) 334
after delete: len(noisy_dataset) 1282
epoch [106/200] batch [5/10] time 0.245 (0.279) data 0.089 (0.121) loss_x loss_x 0.4905 (0.5738) acc_x 87.5000 (85.0000) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/10] time 0.264 (0.273) data 0.106 (0.114) loss_x loss_x 0.4819 (0.5452) acc_x 90.6250 (87.1875) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/40] time 0.181 (0.260) data 0.103 (0.111) loss_u loss_u 0.9199 (0.9629) acc_u 12.5000 (5.6250) lr 9.3721e-04 eta 0:00:09
epoch [106/200] batch [10/40] time 0.274 (0.262) data 0.106 (0.110) loss_u loss_u 0.9712 (0.9616) acc_u 3.1250 (5.0000) lr 9.3721e-04 eta 0:00:07
epoch [106/200] batch [15/40] time 0.292 (0.267) data 0.125 (0.112) loss_u loss_u 0.9575 (0.9548) acc_u 6.2500 (5.8333) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [20/40] time 0.260 (0.269) data 0.092 (0.112) loss_u loss_u 0.9570 (0.9590) acc_u 6.2500 (5.4688) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [25/40] time 0.292 (0.269) data 0.125 (0.111) loss_u loss_u 0.9941 (0.9637) acc_u 0.0000 (4.7500) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [30/40] time 0.185 (0.267) data 0.107 (0.110) loss_u loss_u 0.9824 (0.9597) acc_u 0.0000 (5.0000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [35/40] time 0.297 (0.266) data 0.135 (0.110) loss_u loss_u 0.9932 (0.9607) acc_u 0.0000 (4.7321) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [40/40] time 0.276 (0.267) data 0.108 (0.111) loss_u loss_u 0.9980 (0.9604) acc_u 0.0000 (4.7656) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 656
confident_label rate tensor(0.2073, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 335
clean true:308
clean false:27
clean_rate:0.9194029850746268
noisy true:652
noisy false:629
after delete: len(clean_dataset) 335
after delete: len(noisy_dataset) 1281
epoch [107/200] batch [5/10] time 0.266 (0.234) data 0.107 (0.107) loss_x loss_x 0.5117 (0.5313) acc_x 87.5000 (87.5000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [10/10] time 0.262 (0.249) data 0.105 (0.106) loss_x loss_x 0.7612 (0.5717) acc_x 84.3750 (88.1250) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/40] time 0.269 (0.255) data 0.104 (0.105) loss_u loss_u 0.9692 (0.9697) acc_u 3.1250 (3.7500) lr 9.2154e-04 eta 0:00:08
epoch [107/200] batch [10/40] time 0.268 (0.258) data 0.104 (0.105) loss_u loss_u 0.9624 (0.9616) acc_u 3.1250 (4.3750) lr 9.2154e-04 eta 0:00:07
epoch [107/200] batch [15/40] time 0.266 (0.260) data 0.105 (0.105) loss_u loss_u 0.9531 (0.9647) acc_u 6.2500 (3.9583) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [20/40] time 0.280 (0.256) data 0.107 (0.105) loss_u loss_u 0.9653 (0.9580) acc_u 3.1250 (4.8438) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [25/40] time 0.278 (0.258) data 0.108 (0.105) loss_u loss_u 0.9922 (0.9590) acc_u 0.0000 (4.7500) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [30/40] time 0.275 (0.261) data 0.106 (0.107) loss_u loss_u 0.9385 (0.9576) acc_u 6.2500 (4.8958) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [35/40] time 0.270 (0.263) data 0.109 (0.107) loss_u loss_u 0.9893 (0.9577) acc_u 0.0000 (4.9107) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [40/40] time 0.311 (0.265) data 0.143 (0.108) loss_u loss_u 0.9673 (0.9556) acc_u 3.1250 (5.0781) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.2054, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 332
clean true:312
clean false:20
clean_rate:0.9397590361445783
noisy true:665
noisy false:619
after delete: len(clean_dataset) 332
after delete: len(noisy_dataset) 1284
epoch [108/200] batch [5/10] time 0.299 (0.277) data 0.144 (0.118) loss_x loss_x 0.7222 (0.5333) acc_x 87.5000 (85.6250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/10] time 0.248 (0.275) data 0.090 (0.116) loss_x loss_x 0.3252 (0.5210) acc_x 90.6250 (85.6250) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/40] time 0.245 (0.266) data 0.084 (0.105) loss_u loss_u 0.9478 (0.9435) acc_u 3.1250 (6.2500) lr 9.0589e-04 eta 0:00:09
epoch [108/200] batch [10/40] time 0.251 (0.255) data 0.084 (0.100) loss_u loss_u 0.9580 (0.9466) acc_u 6.2500 (6.2500) lr 9.0589e-04 eta 0:00:07
epoch [108/200] batch [15/40] time 0.247 (0.256) data 0.083 (0.099) loss_u loss_u 0.9341 (0.9438) acc_u 6.2500 (6.4583) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [20/40] time 0.270 (0.257) data 0.113 (0.099) loss_u loss_u 0.9829 (0.9432) acc_u 3.1250 (6.4062) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [25/40] time 0.271 (0.259) data 0.105 (0.101) loss_u loss_u 0.9746 (0.9447) acc_u 6.2500 (6.3750) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [30/40] time 0.274 (0.262) data 0.111 (0.102) loss_u loss_u 0.9175 (0.9466) acc_u 9.3750 (6.1458) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [35/40] time 0.284 (0.262) data 0.117 (0.104) loss_u loss_u 0.9565 (0.9457) acc_u 6.2500 (6.4286) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [40/40] time 0.276 (0.264) data 0.108 (0.105) loss_u loss_u 0.9478 (0.9470) acc_u 6.2500 (6.2500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 616
confident_label rate tensor(0.2135, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 345
clean true:324
clean false:21
clean_rate:0.9391304347826087
noisy true:676
noisy false:595
after delete: len(clean_dataset) 345
after delete: len(noisy_dataset) 1271
epoch [109/200] batch [5/10] time 0.264 (0.267) data 0.107 (0.107) loss_x loss_x 0.8276 (0.5311) acc_x 81.2500 (86.8750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/10] time 0.255 (0.265) data 0.104 (0.107) loss_x loss_x 0.9810 (0.6602) acc_x 75.0000 (84.3750) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/39] time 0.183 (0.255) data 0.107 (0.107) loss_u loss_u 0.9985 (0.9610) acc_u 0.0000 (4.3750) lr 8.9027e-04 eta 0:00:08
epoch [109/200] batch [10/39] time 0.267 (0.258) data 0.108 (0.107) loss_u loss_u 0.9888 (0.9634) acc_u 3.1250 (4.0625) lr 8.9027e-04 eta 0:00:07
epoch [109/200] batch [15/39] time 0.265 (0.258) data 0.104 (0.105) loss_u loss_u 0.9312 (0.9611) acc_u 9.3750 (4.5833) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [20/39] time 0.267 (0.261) data 0.106 (0.105) loss_u loss_u 0.8691 (0.9559) acc_u 12.5000 (5.0000) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [25/39] time 0.271 (0.262) data 0.107 (0.106) loss_u loss_u 0.9277 (0.9557) acc_u 6.2500 (5.0000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [30/39] time 0.270 (0.263) data 0.106 (0.106) loss_u loss_u 0.9780 (0.9597) acc_u 3.1250 (4.5833) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [35/39] time 0.262 (0.260) data 0.104 (0.106) loss_u loss_u 0.9683 (0.9618) acc_u 3.1250 (4.3750) lr 8.9027e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 650
confident_label rate tensor(0.2178, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 352
clean true:328
clean false:24
clean_rate:0.9318181818181818
noisy true:638
noisy false:626
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1264
epoch [110/200] batch [5/11] time 0.265 (0.280) data 0.109 (0.121) loss_x loss_x 0.5542 (0.5423) acc_x 81.2500 (83.7500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/11] time 0.269 (0.273) data 0.107 (0.115) loss_x loss_x 0.4919 (0.5828) acc_x 87.5000 (83.1250) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/39] time 0.266 (0.271) data 0.106 (0.112) loss_u loss_u 0.9941 (0.9620) acc_u 0.0000 (5.6250) lr 8.7467e-04 eta 0:00:09
epoch [110/200] batch [10/39] time 0.269 (0.271) data 0.107 (0.111) loss_u loss_u 0.9585 (0.9670) acc_u 6.2500 (4.3750) lr 8.7467e-04 eta 0:00:07
epoch [110/200] batch [15/39] time 0.184 (0.264) data 0.106 (0.110) loss_u loss_u 0.9546 (0.9603) acc_u 6.2500 (5.0000) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [20/39] time 0.268 (0.264) data 0.104 (0.109) loss_u loss_u 0.9697 (0.9600) acc_u 3.1250 (5.0000) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [25/39] time 0.250 (0.264) data 0.087 (0.108) loss_u loss_u 0.9873 (0.9624) acc_u 3.1250 (4.7500) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [30/39] time 0.268 (0.265) data 0.104 (0.108) loss_u loss_u 0.9395 (0.9628) acc_u 6.2500 (4.5833) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [35/39] time 0.268 (0.265) data 0.106 (0.108) loss_u loss_u 0.9858 (0.9619) acc_u 3.1250 (4.7321) lr 8.7467e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 614
confident_label rate tensor(0.2222, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 359
clean true:333
clean false:26
clean_rate:0.9275766016713092
noisy true:669
noisy false:588
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1257
epoch [111/200] batch [5/11] time 0.266 (0.268) data 0.106 (0.103) loss_x loss_x 0.5776 (0.5867) acc_x 87.5000 (87.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/11] time 0.269 (0.266) data 0.105 (0.102) loss_x loss_x 1.0625 (0.6323) acc_x 75.0000 (86.2500) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/39] time 0.263 (0.268) data 0.105 (0.104) loss_u loss_u 0.9990 (0.9715) acc_u 0.0000 (3.1250) lr 8.5910e-04 eta 0:00:09
epoch [111/200] batch [10/39] time 0.275 (0.269) data 0.106 (0.105) loss_u loss_u 0.9458 (0.9729) acc_u 6.2500 (3.1250) lr 8.5910e-04 eta 0:00:07
epoch [111/200] batch [15/39] time 0.184 (0.263) data 0.108 (0.105) loss_u loss_u 0.9565 (0.9643) acc_u 6.2500 (4.1667) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [20/39] time 0.268 (0.265) data 0.107 (0.105) loss_u loss_u 0.9551 (0.9660) acc_u 6.2500 (3.9062) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [25/39] time 0.269 (0.265) data 0.107 (0.106) loss_u loss_u 0.9614 (0.9648) acc_u 9.3750 (4.3750) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [30/39] time 0.271 (0.266) data 0.105 (0.106) loss_u loss_u 0.9712 (0.9628) acc_u 3.1250 (4.5833) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [35/39] time 0.275 (0.265) data 0.109 (0.104) loss_u loss_u 0.9302 (0.9631) acc_u 9.3750 (4.5536) lr 8.5910e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.2129, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 344
clean true:320
clean false:24
clean_rate:0.9302325581395349
noisy true:673
noisy false:599
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1272
epoch [112/200] batch [5/10] time 0.273 (0.279) data 0.109 (0.117) loss_x loss_x 0.5786 (0.7837) acc_x 90.6250 (82.5000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/10] time 0.216 (0.264) data 0.110 (0.117) loss_x loss_x 1.0781 (0.6776) acc_x 81.2500 (85.3125) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/39] time 0.252 (0.260) data 0.083 (0.106) loss_u loss_u 0.9194 (0.9605) acc_u 9.3750 (4.3750) lr 8.4357e-04 eta 0:00:08
epoch [112/200] batch [10/39] time 0.269 (0.258) data 0.103 (0.101) loss_u loss_u 0.9741 (0.9571) acc_u 3.1250 (4.6875) lr 8.4357e-04 eta 0:00:07
epoch [112/200] batch [15/39] time 0.266 (0.260) data 0.101 (0.101) loss_u loss_u 0.9502 (0.9530) acc_u 6.2500 (5.4167) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [20/39] time 0.276 (0.261) data 0.107 (0.101) loss_u loss_u 0.9038 (0.9512) acc_u 12.5000 (5.7812) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [25/39] time 0.187 (0.259) data 0.109 (0.101) loss_u loss_u 0.9614 (0.9524) acc_u 6.2500 (5.6250) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [30/39] time 0.270 (0.259) data 0.107 (0.102) loss_u loss_u 0.9961 (0.9527) acc_u 0.0000 (5.6250) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [35/39] time 0.257 (0.259) data 0.102 (0.102) loss_u loss_u 0.9644 (0.9542) acc_u 3.1250 (5.4464) lr 8.4357e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 612
confident_label rate tensor(0.2203, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 356
clean true:333
clean false:23
clean_rate:0.9353932584269663
noisy true:671
noisy false:589
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1260
epoch [113/200] batch [5/11] time 0.268 (0.271) data 0.105 (0.110) loss_x loss_x 0.6587 (0.6566) acc_x 84.3750 (86.8750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/11] time 0.234 (0.266) data 0.158 (0.113) loss_x loss_x 0.5957 (0.6206) acc_x 81.2500 (84.3750) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/39] time 0.279 (0.264) data 0.113 (0.112) loss_u loss_u 0.9629 (0.9686) acc_u 6.2500 (6.2500) lr 8.2807e-04 eta 0:00:08
epoch [113/200] batch [10/39] time 0.274 (0.265) data 0.107 (0.109) loss_u loss_u 0.9658 (0.9734) acc_u 3.1250 (4.3750) lr 8.2807e-04 eta 0:00:07
epoch [113/200] batch [15/39] time 0.251 (0.264) data 0.084 (0.107) loss_u loss_u 0.9824 (0.9681) acc_u 3.1250 (4.7917) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [20/39] time 0.242 (0.262) data 0.084 (0.103) loss_u loss_u 0.9307 (0.9624) acc_u 9.3750 (5.4688) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [25/39] time 0.254 (0.260) data 0.086 (0.100) loss_u loss_u 0.9985 (0.9660) acc_u 0.0000 (4.8750) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [30/39] time 0.341 (0.259) data 0.178 (0.102) loss_u loss_u 0.9297 (0.9641) acc_u 6.2500 (4.8958) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [35/39] time 0.278 (0.260) data 0.114 (0.104) loss_u loss_u 0.9976 (0.9668) acc_u 0.0000 (4.4643) lr 8.2807e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.2116, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 342
clean true:315
clean false:27
clean_rate:0.9210526315789473
noisy true:649
noisy false:625
after delete: len(clean_dataset) 342
after delete: len(noisy_dataset) 1274
epoch [114/200] batch [5/10] time 0.279 (0.286) data 0.116 (0.122) loss_x loss_x 1.1846 (0.7839) acc_x 78.1250 (80.0000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/10] time 0.268 (0.280) data 0.104 (0.116) loss_x loss_x 0.6709 (0.7318) acc_x 84.3750 (81.8750) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/39] time 0.276 (0.278) data 0.108 (0.114) loss_u loss_u 0.9360 (0.9501) acc_u 6.2500 (5.6250) lr 8.1262e-04 eta 0:00:09
epoch [114/200] batch [10/39] time 0.277 (0.278) data 0.105 (0.124) loss_u loss_u 0.9365 (0.9475) acc_u 6.2500 (5.9375) lr 8.1262e-04 eta 0:00:08
epoch [114/200] batch [15/39] time 0.273 (0.277) data 0.107 (0.121) loss_u loss_u 0.9722 (0.9487) acc_u 6.2500 (6.0417) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [20/39] time 0.275 (0.276) data 0.107 (0.118) loss_u loss_u 0.9897 (0.9498) acc_u 0.0000 (5.7812) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [25/39] time 0.272 (0.276) data 0.107 (0.117) loss_u loss_u 0.9355 (0.9489) acc_u 6.2500 (5.7500) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [30/39] time 0.277 (0.276) data 0.108 (0.116) loss_u loss_u 0.9346 (0.9489) acc_u 9.3750 (5.8333) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [35/39] time 0.162 (0.270) data 0.084 (0.113) loss_u loss_u 0.9609 (0.9535) acc_u 6.2500 (5.3571) lr 8.1262e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 660
confident_label rate tensor(0.2048, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 331
clean true:309
clean false:22
clean_rate:0.9335347432024169
noisy true:647
noisy false:638
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1285
epoch [115/200] batch [5/10] time 0.306 (0.275) data 0.144 (0.114) loss_x loss_x 0.3462 (0.5593) acc_x 90.6250 (85.6250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/10] time 0.288 (0.283) data 0.128 (0.122) loss_x loss_x 0.4736 (0.5903) acc_x 87.5000 (85.6250) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/40] time 0.274 (0.269) data 0.107 (0.117) loss_u loss_u 0.9028 (0.9351) acc_u 12.5000 (7.5000) lr 7.9721e-04 eta 0:00:09
epoch [115/200] batch [10/40] time 0.270 (0.273) data 0.111 (0.118) loss_u loss_u 0.9175 (0.9412) acc_u 9.3750 (6.5625) lr 7.9721e-04 eta 0:00:08
epoch [115/200] batch [15/40] time 0.256 (0.272) data 0.095 (0.115) loss_u loss_u 0.9414 (0.9422) acc_u 6.2500 (6.8750) lr 7.9721e-04 eta 0:00:06
epoch [115/200] batch [20/40] time 0.254 (0.271) data 0.096 (0.113) loss_u loss_u 0.9380 (0.9440) acc_u 6.2500 (7.0312) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [25/40] time 0.264 (0.271) data 0.103 (0.112) loss_u loss_u 0.9019 (0.9454) acc_u 12.5000 (6.8750) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [30/40] time 0.268 (0.266) data 0.107 (0.111) loss_u loss_u 0.9141 (0.9418) acc_u 9.3750 (6.9792) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [35/40] time 0.271 (0.266) data 0.106 (0.110) loss_u loss_u 0.9780 (0.9478) acc_u 3.1250 (6.2500) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [40/40] time 0.269 (0.267) data 0.107 (0.110) loss_u loss_u 0.9385 (0.9499) acc_u 6.2500 (6.0156) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 568
confident_label rate tensor(0.2283, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 369
clean true:346
clean false:23
clean_rate:0.9376693766937669
noisy true:702
noisy false:545
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1247
epoch [116/200] batch [5/11] time 0.253 (0.271) data 0.089 (0.105) loss_x loss_x 0.4719 (0.5623) acc_x 84.3750 (85.0000) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/11] time 0.244 (0.273) data 0.084 (0.109) loss_x loss_x 0.6826 (0.5196) acc_x 81.2500 (86.2500) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/38] time 0.255 (0.272) data 0.087 (0.107) loss_u loss_u 0.9688 (0.9720) acc_u 3.1250 (2.5000) lr 7.8186e-04 eta 0:00:08
epoch [116/200] batch [10/38] time 0.257 (0.268) data 0.091 (0.103) loss_u loss_u 0.9771 (0.9736) acc_u 3.1250 (2.8125) lr 7.8186e-04 eta 0:00:07
epoch [116/200] batch [15/38] time 0.183 (0.265) data 0.107 (0.105) loss_u loss_u 0.9390 (0.9648) acc_u 9.3750 (3.7500) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [20/38] time 0.273 (0.263) data 0.104 (0.105) loss_u loss_u 0.9980 (0.9718) acc_u 0.0000 (3.1250) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [25/38] time 0.266 (0.266) data 0.105 (0.107) loss_u loss_u 0.9932 (0.9729) acc_u 0.0000 (3.0000) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [30/38] time 0.255 (0.266) data 0.086 (0.106) loss_u loss_u 0.9478 (0.9726) acc_u 6.2500 (3.0208) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [35/38] time 0.246 (0.264) data 0.083 (0.103) loss_u loss_u 0.9995 (0.9733) acc_u 0.0000 (2.8571) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 629
confident_label rate tensor(0.2209, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 357
clean true:333
clean false:24
clean_rate:0.9327731092436975
noisy true:654
noisy false:605
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1259
epoch [117/200] batch [5/11] time 0.251 (0.264) data 0.091 (0.105) loss_x loss_x 0.9180 (0.7883) acc_x 81.2500 (82.5000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/11] time 0.250 (0.264) data 0.092 (0.106) loss_x loss_x 0.6357 (0.6715) acc_x 87.5000 (84.0625) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/39] time 0.215 (0.252) data 0.087 (0.101) loss_u loss_u 0.9771 (0.9738) acc_u 3.1250 (3.1250) lr 7.6655e-04 eta 0:00:08
epoch [117/200] batch [10/39] time 0.272 (0.256) data 0.106 (0.102) loss_u loss_u 0.9834 (0.9770) acc_u 3.1250 (2.8125) lr 7.6655e-04 eta 0:00:07
epoch [117/200] batch [15/39] time 0.269 (0.259) data 0.105 (0.103) loss_u loss_u 0.9419 (0.9759) acc_u 9.3750 (3.1250) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [20/39] time 0.282 (0.261) data 0.124 (0.104) loss_u loss_u 0.9189 (0.9754) acc_u 12.5000 (3.2812) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [25/39] time 0.273 (0.263) data 0.104 (0.104) loss_u loss_u 0.9370 (0.9723) acc_u 6.2500 (3.7500) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [30/39] time 0.182 (0.259) data 0.105 (0.105) loss_u loss_u 0.9966 (0.9723) acc_u 0.0000 (3.7500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [35/39] time 0.269 (0.260) data 0.103 (0.105) loss_u loss_u 0.8867 (0.9657) acc_u 15.6250 (4.4643) lr 7.6655e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.2209, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 357
clean true:330
clean false:27
clean_rate:0.9243697478991597
noisy true:680
noisy false:579
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1259
epoch [118/200] batch [5/11] time 0.273 (0.279) data 0.114 (0.120) loss_x loss_x 0.3064 (0.3496) acc_x 93.7500 (91.2500) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/11] time 0.259 (0.276) data 0.096 (0.116) loss_x loss_x 0.5161 (0.4176) acc_x 87.5000 (89.6875) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/39] time 0.309 (0.271) data 0.146 (0.112) loss_u loss_u 0.9614 (0.9573) acc_u 6.2500 (5.0000) lr 7.5131e-04 eta 0:00:09
epoch [118/200] batch [10/39] time 0.275 (0.277) data 0.113 (0.117) loss_u loss_u 0.9927 (0.9592) acc_u 3.1250 (4.6875) lr 7.5131e-04 eta 0:00:08
epoch [118/200] batch [15/39] time 0.268 (0.272) data 0.107 (0.116) loss_u loss_u 0.9575 (0.9590) acc_u 6.2500 (4.7917) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [20/39] time 0.259 (0.272) data 0.096 (0.115) loss_u loss_u 0.9707 (0.9620) acc_u 3.1250 (4.3750) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [25/39] time 0.249 (0.269) data 0.082 (0.111) loss_u loss_u 0.8896 (0.9576) acc_u 15.6250 (5.0000) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [30/39] time 0.247 (0.267) data 0.084 (0.108) loss_u loss_u 0.9106 (0.9544) acc_u 9.3750 (5.3125) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [35/39] time 0.245 (0.265) data 0.084 (0.105) loss_u loss_u 0.9985 (0.9586) acc_u 0.0000 (4.8214) lr 7.5131e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 633
confident_label rate tensor(0.2178, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 352
clean true:328
clean false:24
clean_rate:0.9318181818181818
noisy true:655
noisy false:609
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1264
epoch [119/200] batch [5/11] time 0.256 (0.262) data 0.095 (0.102) loss_x loss_x 1.3076 (0.7487) acc_x 68.7500 (83.1250) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/11] time 0.280 (0.263) data 0.123 (0.103) loss_x loss_x 1.1133 (0.7128) acc_x 68.7500 (84.0625) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/39] time 0.269 (0.255) data 0.108 (0.106) loss_u loss_u 0.9326 (0.9603) acc_u 6.2500 (4.3750) lr 7.3613e-04 eta 0:00:08
epoch [119/200] batch [10/39] time 0.273 (0.259) data 0.108 (0.107) loss_u loss_u 0.9985 (0.9591) acc_u 0.0000 (4.6875) lr 7.3613e-04 eta 0:00:07
epoch [119/200] batch [15/39] time 0.248 (0.261) data 0.084 (0.106) loss_u loss_u 0.9238 (0.9544) acc_u 6.2500 (5.0000) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [20/39] time 0.274 (0.261) data 0.108 (0.106) loss_u loss_u 0.9683 (0.9576) acc_u 3.1250 (4.8438) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [25/39] time 0.269 (0.261) data 0.106 (0.104) loss_u loss_u 0.9609 (0.9576) acc_u 3.1250 (4.7500) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [30/39] time 0.161 (0.257) data 0.085 (0.104) loss_u loss_u 0.9434 (0.9565) acc_u 6.2500 (4.8958) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [35/39] time 0.255 (0.256) data 0.085 (0.101) loss_u loss_u 0.8770 (0.9570) acc_u 15.6250 (4.8214) lr 7.3613e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 633
confident_label rate tensor(0.2197, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 355
clean true:328
clean false:27
clean_rate:0.923943661971831
noisy true:655
noisy false:606
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1261
epoch [120/200] batch [5/11] time 0.268 (0.285) data 0.106 (0.124) loss_x loss_x 0.7563 (0.5925) acc_x 81.2500 (86.8750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/11] time 0.294 (0.279) data 0.134 (0.119) loss_x loss_x 0.1951 (0.5577) acc_x 96.8750 (87.8125) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/39] time 0.333 (0.279) data 0.170 (0.118) loss_u loss_u 0.9204 (0.9612) acc_u 9.3750 (4.3750) lr 7.2101e-04 eta 0:00:09
epoch [120/200] batch [10/39] time 0.282 (0.272) data 0.116 (0.116) loss_u loss_u 0.9873 (0.9651) acc_u 0.0000 (3.7500) lr 7.2101e-04 eta 0:00:07
epoch [120/200] batch [15/39] time 0.273 (0.271) data 0.108 (0.114) loss_u loss_u 0.9507 (0.9578) acc_u 9.3750 (4.7917) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [20/39] time 0.271 (0.271) data 0.106 (0.113) loss_u loss_u 0.9253 (0.9593) acc_u 12.5000 (4.6875) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [25/39] time 0.269 (0.271) data 0.105 (0.112) loss_u loss_u 0.9834 (0.9610) acc_u 3.1250 (4.5000) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [30/39] time 0.268 (0.270) data 0.106 (0.111) loss_u loss_u 0.9790 (0.9604) acc_u 3.1250 (4.5833) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [35/39] time 0.267 (0.267) data 0.104 (0.111) loss_u loss_u 0.9395 (0.9598) acc_u 6.2500 (4.6429) lr 7.2101e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.2178, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 352
clean true:328
clean false:24
clean_rate:0.9318181818181818
noisy true:667
noisy false:597
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1264
epoch [121/200] batch [5/11] time 0.248 (0.253) data 0.092 (0.096) loss_x loss_x 0.2285 (0.5603) acc_x 93.7500 (82.5000) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/11] time 0.261 (0.257) data 0.101 (0.100) loss_x loss_x 0.7671 (0.5928) acc_x 75.0000 (83.4375) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/39] time 0.269 (0.262) data 0.106 (0.103) loss_u loss_u 0.9507 (0.9631) acc_u 6.2500 (4.3750) lr 7.0596e-04 eta 0:00:08
epoch [121/200] batch [10/39] time 0.271 (0.257) data 0.108 (0.104) loss_u loss_u 0.9434 (0.9601) acc_u 6.2500 (4.6875) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [15/39] time 0.267 (0.262) data 0.110 (0.107) loss_u loss_u 0.9941 (0.9567) acc_u 0.0000 (5.2083) lr 7.0596e-04 eta 0:00:06
epoch [121/200] batch [20/39] time 0.311 (0.264) data 0.148 (0.108) loss_u loss_u 0.9897 (0.9599) acc_u 0.0000 (4.6875) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [25/39] time 0.268 (0.265) data 0.106 (0.108) loss_u loss_u 0.9175 (0.9579) acc_u 9.3750 (4.8750) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [30/39] time 0.270 (0.265) data 0.110 (0.108) loss_u loss_u 0.9722 (0.9601) acc_u 3.1250 (4.5833) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [35/39] time 0.363 (0.267) data 0.199 (0.112) loss_u loss_u 0.9722 (0.9623) acc_u 3.1250 (4.2857) lr 7.0596e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 641
confident_label rate tensor(0.2178, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 352
clean true:323
clean false:29
clean_rate:0.9176136363636364
noisy true:652
noisy false:612
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1264
epoch [122/200] batch [5/11] time 0.302 (0.262) data 0.140 (0.121) loss_x loss_x 0.8545 (0.6110) acc_x 75.0000 (82.5000) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/11] time 0.262 (0.263) data 0.104 (0.113) loss_x loss_x 0.5615 (0.6635) acc_x 87.5000 (82.1875) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/39] time 0.272 (0.265) data 0.106 (0.111) loss_u loss_u 0.9180 (0.9437) acc_u 9.3750 (5.6250) lr 6.9098e-04 eta 0:00:09
epoch [122/200] batch [10/39] time 0.265 (0.266) data 0.105 (0.110) loss_u loss_u 0.9985 (0.9633) acc_u 0.0000 (3.4375) lr 6.9098e-04 eta 0:00:07
epoch [122/200] batch [15/39] time 0.193 (0.265) data 0.116 (0.111) loss_u loss_u 0.9604 (0.9608) acc_u 3.1250 (3.5417) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [20/39] time 0.267 (0.264) data 0.108 (0.110) loss_u loss_u 0.9878 (0.9668) acc_u 3.1250 (3.1250) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [25/39] time 0.271 (0.265) data 0.106 (0.110) loss_u loss_u 0.9673 (0.9661) acc_u 3.1250 (3.2500) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [30/39] time 0.268 (0.265) data 0.111 (0.109) loss_u loss_u 0.8940 (0.9629) acc_u 15.6250 (3.8542) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [35/39] time 0.269 (0.266) data 0.106 (0.110) loss_u loss_u 0.9990 (0.9620) acc_u 0.0000 (4.0179) lr 6.9098e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 642
confident_label rate tensor(0.2240, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 362
clean true:337
clean false:25
clean_rate:0.930939226519337
noisy true:637
noisy false:617
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1254
epoch [123/200] batch [5/11] time 0.265 (0.288) data 0.107 (0.127) loss_x loss_x 0.6274 (0.6178) acc_x 84.3750 (88.1250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/11] time 0.269 (0.279) data 0.108 (0.117) loss_x loss_x 0.5713 (0.6132) acc_x 84.3750 (86.5625) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/39] time 0.273 (0.264) data 0.108 (0.114) loss_u loss_u 0.9438 (0.9372) acc_u 6.2500 (7.5000) lr 6.7608e-04 eta 0:00:08
epoch [123/200] batch [10/39] time 0.274 (0.266) data 0.107 (0.112) loss_u loss_u 0.9341 (0.9499) acc_u 6.2500 (5.6250) lr 6.7608e-04 eta 0:00:07
epoch [123/200] batch [15/39] time 0.261 (0.266) data 0.107 (0.111) loss_u loss_u 0.9990 (0.9614) acc_u 0.0000 (4.1667) lr 6.7608e-04 eta 0:00:06
epoch [123/200] batch [20/39] time 0.277 (0.267) data 0.111 (0.111) loss_u loss_u 0.9717 (0.9660) acc_u 3.1250 (3.7500) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [25/39] time 0.273 (0.266) data 0.108 (0.110) loss_u loss_u 0.9995 (0.9657) acc_u 0.0000 (3.8750) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [30/39] time 0.271 (0.265) data 0.108 (0.110) loss_u loss_u 0.9717 (0.9639) acc_u 3.1250 (4.0625) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [35/39] time 0.265 (0.265) data 0.108 (0.109) loss_u loss_u 0.9966 (0.9636) acc_u 0.0000 (4.0179) lr 6.7608e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.2129, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 344
clean true:318
clean false:26
clean_rate:0.9244186046511628
noisy true:674
noisy false:598
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1272
epoch [124/200] batch [5/10] time 0.243 (0.259) data 0.083 (0.098) loss_x loss_x 0.5591 (0.6170) acc_x 84.3750 (86.2500) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/10] time 0.242 (0.251) data 0.083 (0.090) loss_x loss_x 0.7700 (0.6541) acc_x 78.1250 (84.3750) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/39] time 0.245 (0.240) data 0.083 (0.088) loss_u loss_u 0.9961 (0.9658) acc_u 0.0000 (3.7500) lr 6.6126e-04 eta 0:00:08
epoch [124/200] batch [10/39] time 0.241 (0.241) data 0.083 (0.087) loss_u loss_u 0.9375 (0.9652) acc_u 6.2500 (4.0625) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [15/39] time 0.263 (0.244) data 0.104 (0.088) loss_u loss_u 0.9775 (0.9673) acc_u 3.1250 (3.7500) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [20/39] time 0.272 (0.250) data 0.107 (0.093) loss_u loss_u 0.9624 (0.9537) acc_u 3.1250 (5.1562) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [25/39] time 0.246 (0.251) data 0.082 (0.094) loss_u loss_u 0.9697 (0.9571) acc_u 3.1250 (4.7500) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [30/39] time 0.191 (0.249) data 0.114 (0.095) loss_u loss_u 0.9429 (0.9529) acc_u 6.2500 (5.3125) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [35/39] time 0.272 (0.250) data 0.107 (0.094) loss_u loss_u 0.9697 (0.9545) acc_u 3.1250 (5.1786) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 338
clean true:312
clean false:26
clean_rate:0.9230769230769231
noisy true:683
noisy false:595
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1278
epoch [125/200] batch [5/10] time 0.270 (0.272) data 0.108 (0.109) loss_x loss_x 0.3574 (0.4667) acc_x 87.5000 (88.7500) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/10] time 0.257 (0.264) data 0.097 (0.102) loss_x loss_x 0.4111 (0.4604) acc_x 87.5000 (89.0625) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/39] time 0.176 (0.254) data 0.100 (0.103) loss_u loss_u 0.9473 (0.9710) acc_u 6.2500 (3.1250) lr 6.4653e-04 eta 0:00:08
epoch [125/200] batch [10/39] time 0.260 (0.256) data 0.102 (0.102) loss_u loss_u 0.9858 (0.9716) acc_u 0.0000 (3.1250) lr 6.4653e-04 eta 0:00:07
epoch [125/200] batch [15/39] time 0.281 (0.257) data 0.116 (0.102) loss_u loss_u 0.9985 (0.9681) acc_u 0.0000 (3.5417) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [20/39] time 0.268 (0.260) data 0.106 (0.103) loss_u loss_u 0.8750 (0.9614) acc_u 12.5000 (4.2188) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [25/39] time 0.274 (0.261) data 0.112 (0.104) loss_u loss_u 0.9443 (0.9596) acc_u 6.2500 (4.3750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [30/39] time 0.177 (0.263) data 0.100 (0.107) loss_u loss_u 0.9253 (0.9542) acc_u 6.2500 (5.0000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [35/39] time 0.270 (0.265) data 0.106 (0.109) loss_u loss_u 0.9185 (0.9550) acc_u 9.3750 (4.9107) lr 6.4653e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 615
confident_label rate tensor(0.2209, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 357
clean true:328
clean false:29
clean_rate:0.9187675070028011
noisy true:673
noisy false:586
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1259
epoch [126/200] batch [5/11] time 0.273 (0.269) data 0.108 (0.108) loss_x loss_x 0.3269 (0.3374) acc_x 93.7500 (93.1250) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/11] time 0.288 (0.271) data 0.122 (0.109) loss_x loss_x 0.5498 (0.5182) acc_x 87.5000 (88.1250) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/39] time 0.277 (0.276) data 0.108 (0.112) loss_u loss_u 0.9858 (0.9455) acc_u 3.1250 (6.2500) lr 6.3188e-04 eta 0:00:09
epoch [126/200] batch [10/39] time 0.268 (0.278) data 0.108 (0.118) loss_u loss_u 0.9731 (0.9454) acc_u 3.1250 (5.9375) lr 6.3188e-04 eta 0:00:08
epoch [126/200] batch [15/39] time 0.252 (0.276) data 0.088 (0.115) loss_u loss_u 0.9556 (0.9590) acc_u 6.2500 (4.5833) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [20/39] time 0.370 (0.278) data 0.203 (0.116) loss_u loss_u 0.9551 (0.9603) acc_u 3.1250 (4.5312) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [25/39] time 0.274 (0.277) data 0.107 (0.115) loss_u loss_u 0.9058 (0.9570) acc_u 9.3750 (4.8750) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [30/39] time 0.269 (0.276) data 0.107 (0.114) loss_u loss_u 0.9985 (0.9574) acc_u 0.0000 (4.7917) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [35/39] time 0.262 (0.271) data 0.105 (0.113) loss_u loss_u 0.9619 (0.9579) acc_u 6.2500 (4.7321) lr 6.3188e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.2191, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 354
clean true:325
clean false:29
clean_rate:0.9180790960451978
noisy true:654
noisy false:608
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1262
epoch [127/200] batch [5/11] time 0.269 (0.274) data 0.106 (0.108) loss_x loss_x 0.5493 (0.6434) acc_x 90.6250 (89.3750) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/11] time 0.271 (0.272) data 0.107 (0.108) loss_x loss_x 0.7383 (0.5847) acc_x 78.1250 (88.1250) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/39] time 0.275 (0.272) data 0.107 (0.108) loss_u loss_u 0.9854 (0.9750) acc_u 3.1250 (3.1250) lr 6.1732e-04 eta 0:00:09
epoch [127/200] batch [10/39] time 0.278 (0.273) data 0.108 (0.107) loss_u loss_u 0.9165 (0.9634) acc_u 9.3750 (4.6875) lr 6.1732e-04 eta 0:00:07
epoch [127/200] batch [15/39] time 0.312 (0.267) data 0.129 (0.108) loss_u loss_u 0.9990 (0.9657) acc_u 0.0000 (4.1667) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [20/39] time 0.268 (0.267) data 0.106 (0.107) loss_u loss_u 0.9902 (0.9652) acc_u 0.0000 (4.2188) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [25/39] time 0.273 (0.268) data 0.103 (0.107) loss_u loss_u 0.9609 (0.9690) acc_u 6.2500 (3.7500) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [30/39] time 0.270 (0.268) data 0.106 (0.106) loss_u loss_u 0.9375 (0.9664) acc_u 6.2500 (3.9583) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [35/39] time 0.252 (0.268) data 0.083 (0.105) loss_u loss_u 0.9697 (0.9631) acc_u 3.1250 (4.2857) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.2129, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 344
clean true:318
clean false:26
clean_rate:0.9244186046511628
noisy true:693
noisy false:579
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1272
epoch [128/200] batch [5/10] time 0.269 (0.293) data 0.106 (0.130) loss_x loss_x 0.2069 (0.5534) acc_x 96.8750 (83.7500) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/10] time 0.269 (0.284) data 0.105 (0.121) loss_x loss_x 0.3467 (0.5584) acc_x 87.5000 (83.4375) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/39] time 0.272 (0.279) data 0.105 (0.116) loss_u loss_u 0.9307 (0.9367) acc_u 9.3750 (7.5000) lr 6.0285e-04 eta 0:00:09
epoch [128/200] batch [10/39] time 0.274 (0.279) data 0.106 (0.114) loss_u loss_u 0.9165 (0.9343) acc_u 9.3750 (7.5000) lr 6.0285e-04 eta 0:00:08
epoch [128/200] batch [15/39] time 0.176 (0.272) data 0.099 (0.113) loss_u loss_u 0.9854 (0.9431) acc_u 3.1250 (6.8750) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [20/39] time 0.261 (0.272) data 0.091 (0.112) loss_u loss_u 0.9604 (0.9468) acc_u 9.3750 (6.7188) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [25/39] time 0.276 (0.271) data 0.107 (0.111) loss_u loss_u 0.9341 (0.9473) acc_u 9.3750 (6.7500) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [30/39] time 0.182 (0.269) data 0.105 (0.110) loss_u loss_u 0.9897 (0.9513) acc_u 0.0000 (6.1458) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [35/39] time 0.271 (0.268) data 0.105 (0.111) loss_u loss_u 0.9370 (0.9525) acc_u 6.2500 (5.8036) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.2290, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 370
clean true:336
clean false:34
clean_rate:0.9081081081081082
noisy true:691
noisy false:555
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1246
epoch [129/200] batch [5/11] time 0.270 (0.262) data 0.107 (0.107) loss_x loss_x 0.7837 (0.6161) acc_x 81.2500 (85.0000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/11] time 0.270 (0.265) data 0.107 (0.107) loss_x loss_x 0.7759 (0.6099) acc_x 84.3750 (85.6250) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/38] time 0.274 (0.268) data 0.107 (0.107) loss_u loss_u 0.9980 (0.9635) acc_u 0.0000 (3.7500) lr 5.8849e-04 eta 0:00:08
epoch [129/200] batch [10/38] time 0.313 (0.271) data 0.144 (0.110) loss_u loss_u 0.9253 (0.9671) acc_u 6.2500 (3.1250) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [15/38] time 0.185 (0.267) data 0.108 (0.111) loss_u loss_u 0.9785 (0.9634) acc_u 3.1250 (3.9583) lr 5.8849e-04 eta 0:00:06
epoch [129/200] batch [20/38] time 0.271 (0.266) data 0.103 (0.109) loss_u loss_u 0.9937 (0.9666) acc_u 0.0000 (3.5938) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [25/38] time 0.262 (0.266) data 0.096 (0.107) loss_u loss_u 0.9414 (0.9645) acc_u 9.3750 (4.0000) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [30/38] time 0.275 (0.267) data 0.107 (0.107) loss_u loss_u 0.9985 (0.9653) acc_u 0.0000 (3.8542) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [35/38] time 0.269 (0.267) data 0.104 (0.107) loss_u loss_u 0.9995 (0.9673) acc_u 0.0000 (3.6607) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 630
confident_label rate tensor(0.2215, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 358
clean true:333
clean false:25
clean_rate:0.9301675977653632
noisy true:653
noisy false:605
after delete: len(clean_dataset) 358
after delete: len(noisy_dataset) 1258
epoch [130/200] batch [5/11] time 0.251 (0.264) data 0.091 (0.104) loss_x loss_x 0.8022 (0.5203) acc_x 81.2500 (85.6250) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/11] time 0.245 (0.253) data 0.084 (0.093) loss_x loss_x 0.6108 (0.5427) acc_x 87.5000 (85.3125) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/39] time 0.269 (0.252) data 0.094 (0.095) loss_u loss_u 0.9990 (0.9604) acc_u 0.0000 (5.0000) lr 5.7422e-04 eta 0:00:08
epoch [130/200] batch [10/39] time 0.265 (0.255) data 0.105 (0.096) loss_u loss_u 0.9316 (0.9556) acc_u 6.2500 (5.0000) lr 5.7422e-04 eta 0:00:07
epoch [130/200] batch [15/39] time 0.275 (0.257) data 0.107 (0.096) loss_u loss_u 0.9644 (0.9609) acc_u 3.1250 (4.3750) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [20/39] time 0.267 (0.257) data 0.099 (0.096) loss_u loss_u 0.9961 (0.9627) acc_u 0.0000 (4.0625) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [25/39] time 0.263 (0.258) data 0.098 (0.096) loss_u loss_u 0.9956 (0.9639) acc_u 0.0000 (4.0000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [30/39] time 0.184 (0.256) data 0.106 (0.098) loss_u loss_u 0.9766 (0.9660) acc_u 3.1250 (3.8542) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [35/39] time 0.272 (0.259) data 0.104 (0.100) loss_u loss_u 0.9883 (0.9675) acc_u 3.1250 (3.8393) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.2184, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 353
clean true:322
clean false:31
clean_rate:0.9121813031161473
noisy true:655
noisy false:608
after delete: len(clean_dataset) 353
after delete: len(noisy_dataset) 1263
epoch [131/200] batch [5/11] time 0.251 (0.245) data 0.092 (0.088) loss_x loss_x 0.5371 (0.5563) acc_x 87.5000 (87.5000) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/11] time 0.266 (0.248) data 0.107 (0.091) loss_x loss_x 0.9062 (0.5515) acc_x 75.0000 (86.8750) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/39] time 0.292 (0.258) data 0.129 (0.099) loss_u loss_u 0.9492 (0.9486) acc_u 6.2500 (5.6250) lr 5.6006e-04 eta 0:00:08
epoch [131/200] batch [10/39] time 0.178 (0.257) data 0.101 (0.101) loss_u loss_u 0.9634 (0.9602) acc_u 3.1250 (4.3750) lr 5.6006e-04 eta 0:00:07
epoch [131/200] batch [15/39] time 0.265 (0.256) data 0.104 (0.102) loss_u loss_u 0.9609 (0.9600) acc_u 3.1250 (4.3750) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [20/39] time 0.257 (0.257) data 0.090 (0.101) loss_u loss_u 0.9658 (0.9606) acc_u 3.1250 (4.5312) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [25/39] time 0.257 (0.257) data 0.090 (0.100) loss_u loss_u 0.9409 (0.9600) acc_u 6.2500 (4.6250) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [30/39] time 0.274 (0.260) data 0.105 (0.101) loss_u loss_u 0.9976 (0.9604) acc_u 0.0000 (4.5833) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [35/39] time 0.252 (0.260) data 0.083 (0.101) loss_u loss_u 0.9668 (0.9605) acc_u 3.1250 (4.5536) lr 5.6006e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 675
confident_label rate tensor(0.2222, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 359
clean true:328
clean false:31
clean_rate:0.9136490250696379
noisy true:613
noisy false:644
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1257
epoch [132/200] batch [5/11] time 0.244 (0.243) data 0.089 (0.084) loss_x loss_x 0.8276 (0.4544) acc_x 84.3750 (88.7500) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [10/11] time 0.265 (0.249) data 0.104 (0.090) loss_x loss_x 0.4929 (0.5254) acc_x 87.5000 (88.7500) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/39] time 0.161 (0.246) data 0.083 (0.097) loss_u loss_u 0.9673 (0.9770) acc_u 3.1250 (2.5000) lr 5.4601e-04 eta 0:00:08
epoch [132/200] batch [10/39] time 0.270 (0.253) data 0.107 (0.099) loss_u loss_u 0.9814 (0.9801) acc_u 3.1250 (2.1875) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [15/39] time 0.276 (0.256) data 0.113 (0.100) loss_u loss_u 0.9453 (0.9681) acc_u 6.2500 (3.5417) lr 5.4601e-04 eta 0:00:06
epoch [132/200] batch [20/39] time 0.256 (0.259) data 0.092 (0.102) loss_u loss_u 0.9995 (0.9702) acc_u 0.0000 (3.2812) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [25/39] time 0.265 (0.260) data 0.107 (0.102) loss_u loss_u 0.9473 (0.9661) acc_u 6.2500 (4.0000) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [30/39] time 0.246 (0.260) data 0.106 (0.103) loss_u loss_u 0.9692 (0.9664) acc_u 3.1250 (3.9583) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [35/39] time 0.274 (0.261) data 0.107 (0.105) loss_u loss_u 0.9233 (0.9630) acc_u 9.3750 (4.3750) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 604
confident_label rate tensor(0.2209, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 357
clean true:333
clean false:24
clean_rate:0.9327731092436975
noisy true:679
noisy false:580
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1259
epoch [133/200] batch [5/11] time 0.245 (0.228) data 0.083 (0.084) loss_x loss_x 0.3701 (0.4383) acc_x 90.6250 (89.3750) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/11] time 0.256 (0.239) data 0.104 (0.088) loss_x loss_x 0.5830 (0.4817) acc_x 81.2500 (87.1875) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/39] time 0.270 (0.255) data 0.108 (0.100) loss_u loss_u 0.8540 (0.9493) acc_u 15.6250 (6.2500) lr 5.3207e-04 eta 0:00:08
epoch [133/200] batch [10/39] time 0.244 (0.256) data 0.082 (0.099) loss_u loss_u 0.9741 (0.9667) acc_u 6.2500 (4.3750) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [15/39] time 0.182 (0.256) data 0.105 (0.101) loss_u loss_u 0.9995 (0.9703) acc_u 0.0000 (3.7500) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [20/39] time 0.271 (0.256) data 0.107 (0.103) loss_u loss_u 0.9590 (0.9639) acc_u 3.1250 (4.2188) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [25/39] time 0.272 (0.258) data 0.106 (0.103) loss_u loss_u 0.9951 (0.9659) acc_u 0.0000 (3.8750) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [30/39] time 0.268 (0.260) data 0.106 (0.104) loss_u loss_u 0.9521 (0.9606) acc_u 6.2500 (4.3750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [35/39] time 0.275 (0.262) data 0.113 (0.105) loss_u loss_u 0.9072 (0.9587) acc_u 9.3750 (4.5536) lr 5.3207e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 644
confident_label rate tensor(0.2166, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 350
clean true:321
clean false:29
clean_rate:0.9171428571428571
noisy true:651
noisy false:615
after delete: len(clean_dataset) 350
after delete: len(noisy_dataset) 1266
epoch [134/200] batch [5/10] time 0.271 (0.270) data 0.108 (0.107) loss_x loss_x 0.2429 (0.3658) acc_x 96.8750 (91.2500) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/10] time 0.267 (0.269) data 0.103 (0.106) loss_x loss_x 0.9326 (0.4475) acc_x 75.0000 (87.8125) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/39] time 0.306 (0.263) data 0.141 (0.111) loss_u loss_u 0.9678 (0.9510) acc_u 3.1250 (5.6250) lr 5.1825e-04 eta 0:00:08
epoch [134/200] batch [10/39] time 0.278 (0.267) data 0.115 (0.112) loss_u loss_u 0.9365 (0.9511) acc_u 6.2500 (5.6250) lr 5.1825e-04 eta 0:00:07
epoch [134/200] batch [15/39] time 0.296 (0.269) data 0.133 (0.113) loss_u loss_u 0.9141 (0.9497) acc_u 9.3750 (5.6250) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [20/39] time 0.270 (0.269) data 0.105 (0.112) loss_u loss_u 0.9536 (0.9547) acc_u 6.2500 (5.0000) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [25/39] time 0.298 (0.272) data 0.134 (0.114) loss_u loss_u 0.9878 (0.9586) acc_u 3.1250 (4.5000) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [30/39] time 0.270 (0.269) data 0.107 (0.113) loss_u loss_u 0.9067 (0.9578) acc_u 12.5000 (4.7917) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [35/39] time 0.267 (0.269) data 0.106 (0.113) loss_u loss_u 0.9766 (0.9590) acc_u 3.1250 (4.7321) lr 5.1825e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 600
confident_label rate tensor(0.2240, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 362
clean true:332
clean false:30
clean_rate:0.9171270718232044
noisy true:684
noisy false:570
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1254
epoch [135/200] batch [5/11] time 0.270 (0.267) data 0.107 (0.106) loss_x loss_x 0.5200 (0.6563) acc_x 90.6250 (86.8750) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/11] time 0.267 (0.268) data 0.107 (0.106) loss_x loss_x 0.5620 (0.6702) acc_x 84.3750 (85.0000) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/39] time 0.268 (0.269) data 0.108 (0.106) loss_u loss_u 0.9473 (0.9804) acc_u 6.2500 (1.8750) lr 5.0454e-04 eta 0:00:09
epoch [135/200] batch [10/39] time 0.272 (0.270) data 0.109 (0.107) loss_u loss_u 0.8545 (0.9543) acc_u 18.7500 (5.3125) lr 5.0454e-04 eta 0:00:07
epoch [135/200] batch [15/39] time 0.316 (0.266) data 0.135 (0.108) loss_u loss_u 0.9971 (0.9581) acc_u 0.0000 (4.7917) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [20/39] time 0.308 (0.281) data 0.147 (0.122) loss_u loss_u 0.9893 (0.9656) acc_u 0.0000 (3.9062) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [25/39] time 0.265 (0.279) data 0.101 (0.120) loss_u loss_u 0.9409 (0.9642) acc_u 6.2500 (4.0000) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [30/39] time 0.271 (0.277) data 0.106 (0.118) loss_u loss_u 0.9946 (0.9649) acc_u 0.0000 (3.8542) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [35/39] time 0.257 (0.276) data 0.092 (0.116) loss_u loss_u 0.9985 (0.9643) acc_u 0.0000 (4.1964) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.2228, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 360
clean true:328
clean false:32
clean_rate:0.9111111111111111
noisy true:691
noisy false:565
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1256
epoch [136/200] batch [5/11] time 0.269 (0.284) data 0.106 (0.118) loss_x loss_x 1.1309 (0.7398) acc_x 78.1250 (83.1250) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/11] time 0.266 (0.277) data 0.106 (0.113) loss_x loss_x 0.7471 (0.7148) acc_x 84.3750 (81.2500) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/39] time 0.277 (0.275) data 0.109 (0.110) loss_u loss_u 0.9038 (0.9581) acc_u 12.5000 (5.0000) lr 4.9096e-04 eta 0:00:09
epoch [136/200] batch [10/39] time 0.179 (0.264) data 0.102 (0.108) loss_u loss_u 0.9653 (0.9588) acc_u 6.2500 (5.0000) lr 4.9096e-04 eta 0:00:07
epoch [136/200] batch [15/39] time 0.274 (0.264) data 0.106 (0.107) loss_u loss_u 0.9673 (0.9611) acc_u 3.1250 (4.5833) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [20/39] time 0.246 (0.264) data 0.082 (0.106) loss_u loss_u 0.9995 (0.9602) acc_u 0.0000 (4.6875) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [25/39] time 0.274 (0.267) data 0.105 (0.108) loss_u loss_u 0.9995 (0.9618) acc_u 0.0000 (4.3750) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [30/39] time 0.252 (0.267) data 0.082 (0.107) loss_u loss_u 0.9150 (0.9589) acc_u 9.3750 (4.6875) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [35/39] time 0.274 (0.267) data 0.107 (0.106) loss_u loss_u 0.9360 (0.9565) acc_u 6.2500 (5.0000) lr 4.9096e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 634
confident_label rate tensor(0.2228, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 360
clean true:331
clean false:29
clean_rate:0.9194444444444444
noisy true:651
noisy false:605
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1256
epoch [137/200] batch [5/11] time 0.267 (0.278) data 0.105 (0.116) loss_x loss_x 0.5728 (0.5788) acc_x 87.5000 (85.6250) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/11] time 0.266 (0.273) data 0.104 (0.110) loss_x loss_x 0.9302 (0.5908) acc_x 75.0000 (85.0000) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/39] time 0.266 (0.265) data 0.105 (0.109) loss_u loss_u 0.9385 (0.9211) acc_u 6.2500 (8.1250) lr 4.7750e-04 eta 0:00:09
epoch [137/200] batch [10/39] time 0.271 (0.267) data 0.105 (0.108) loss_u loss_u 0.9463 (0.9392) acc_u 6.2500 (6.2500) lr 4.7750e-04 eta 0:00:07
epoch [137/200] batch [15/39] time 0.268 (0.268) data 0.108 (0.108) loss_u loss_u 0.9692 (0.9459) acc_u 3.1250 (6.0417) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [20/39] time 0.266 (0.269) data 0.106 (0.108) loss_u loss_u 0.9468 (0.9477) acc_u 6.2500 (6.0938) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [25/39] time 0.275 (0.269) data 0.108 (0.108) loss_u loss_u 0.9692 (0.9504) acc_u 3.1250 (5.7500) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [30/39] time 0.267 (0.265) data 0.107 (0.108) loss_u loss_u 0.9609 (0.9536) acc_u 3.1250 (5.4167) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [35/39] time 0.275 (0.266) data 0.107 (0.108) loss_u loss_u 0.9980 (0.9563) acc_u 0.0000 (5.0893) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.2252, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 364
clean true:338
clean false:26
clean_rate:0.9285714285714286
noisy true:673
noisy false:579
after delete: len(clean_dataset) 364
after delete: len(noisy_dataset) 1252
epoch [138/200] batch [5/11] time 0.268 (0.274) data 0.108 (0.113) loss_x loss_x 0.3977 (0.6538) acc_x 96.8750 (86.2500) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/11] time 0.267 (0.269) data 0.108 (0.107) loss_x loss_x 0.5806 (0.5781) acc_x 84.3750 (86.2500) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/39] time 0.271 (0.259) data 0.103 (0.106) loss_u loss_u 0.9062 (0.9702) acc_u 9.3750 (3.1250) lr 4.6417e-04 eta 0:00:08
epoch [138/200] batch [10/39] time 0.271 (0.262) data 0.105 (0.106) loss_u loss_u 0.9854 (0.9633) acc_u 3.1250 (3.7500) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [15/39] time 0.274 (0.264) data 0.105 (0.106) loss_u loss_u 0.9990 (0.9686) acc_u 0.0000 (3.3333) lr 4.6417e-04 eta 0:00:06
epoch [138/200] batch [20/39] time 0.274 (0.266) data 0.105 (0.107) loss_u loss_u 0.9380 (0.9647) acc_u 9.3750 (3.9062) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [25/39] time 0.305 (0.269) data 0.137 (0.109) loss_u loss_u 0.9917 (0.9637) acc_u 0.0000 (4.0000) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [30/39] time 0.278 (0.264) data 0.106 (0.108) loss_u loss_u 0.9805 (0.9639) acc_u 3.1250 (4.0625) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [35/39] time 0.273 (0.264) data 0.107 (0.108) loss_u loss_u 0.9434 (0.9623) acc_u 6.2500 (4.2857) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.2197, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 355
clean true:322
clean false:33
clean_rate:0.9070422535211268
noisy true:668
noisy false:593
after delete: len(clean_dataset) 355
after delete: len(noisy_dataset) 1261
epoch [139/200] batch [5/11] time 0.284 (0.282) data 0.129 (0.123) loss_x loss_x 0.2729 (0.4527) acc_x 96.8750 (91.8750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/11] time 0.268 (0.275) data 0.106 (0.115) loss_x loss_x 0.6821 (0.4766) acc_x 81.2500 (89.3750) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/39] time 0.270 (0.273) data 0.107 (0.111) loss_u loss_u 1.0000 (0.9626) acc_u 0.0000 (4.3750) lr 4.5098e-04 eta 0:00:09
epoch [139/200] batch [10/39] time 0.264 (0.272) data 0.106 (0.110) loss_u loss_u 0.9824 (0.9603) acc_u 3.1250 (5.0000) lr 4.5098e-04 eta 0:00:07
epoch [139/200] batch [15/39] time 0.283 (0.265) data 0.103 (0.109) loss_u loss_u 0.9243 (0.9560) acc_u 9.3750 (5.4167) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [20/39] time 0.267 (0.267) data 0.107 (0.110) loss_u loss_u 0.9409 (0.9518) acc_u 6.2500 (5.6250) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [25/39] time 0.271 (0.266) data 0.107 (0.107) loss_u loss_u 0.9048 (0.9523) acc_u 9.3750 (5.5000) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [30/39] time 0.274 (0.267) data 0.106 (0.108) loss_u loss_u 0.9121 (0.9523) acc_u 9.3750 (5.5208) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [35/39] time 0.272 (0.267) data 0.112 (0.108) loss_u loss_u 0.9966 (0.9578) acc_u 0.0000 (4.9107) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.2240, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 362
clean true:333
clean false:29
clean_rate:0.919889502762431
noisy true:659
noisy false:595
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1254
epoch [140/200] batch [5/11] time 0.264 (0.261) data 0.108 (0.105) loss_x loss_x 0.2646 (0.4328) acc_x 96.8750 (90.0000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/11] time 0.270 (0.269) data 0.108 (0.111) loss_x loss_x 0.6250 (0.5467) acc_x 81.2500 (86.2500) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/39] time 0.265 (0.261) data 0.107 (0.111) loss_u loss_u 0.9282 (0.9433) acc_u 9.3750 (6.8750) lr 4.3792e-04 eta 0:00:08
epoch [140/200] batch [10/39] time 0.246 (0.262) data 0.082 (0.109) loss_u loss_u 0.9653 (0.9603) acc_u 3.1250 (5.0000) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [15/39] time 0.251 (0.260) data 0.083 (0.104) loss_u loss_u 0.9824 (0.9653) acc_u 3.1250 (4.1667) lr 4.3792e-04 eta 0:00:06
epoch [140/200] batch [20/39] time 0.267 (0.261) data 0.106 (0.103) loss_u loss_u 0.9336 (0.9640) acc_u 9.3750 (4.5312) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [25/39] time 0.273 (0.262) data 0.103 (0.103) loss_u loss_u 0.9668 (0.9608) acc_u 6.2500 (4.8750) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [30/39] time 0.201 (0.260) data 0.114 (0.104) loss_u loss_u 0.9873 (0.9633) acc_u 3.1250 (4.5833) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [35/39] time 0.275 (0.262) data 0.106 (0.105) loss_u loss_u 0.9351 (0.9587) acc_u 6.2500 (5.0000) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.2178, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 352
clean true:324
clean false:28
clean_rate:0.9204545454545454
noisy true:654
noisy false:610
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1264
epoch [141/200] batch [5/11] time 0.268 (0.266) data 0.106 (0.105) loss_x loss_x 0.3896 (0.6272) acc_x 90.6250 (82.5000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/11] time 0.262 (0.265) data 0.104 (0.105) loss_x loss_x 0.6870 (0.6394) acc_x 84.3750 (84.0625) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/39] time 0.276 (0.256) data 0.107 (0.106) loss_u loss_u 0.8936 (0.9382) acc_u 12.5000 (6.8750) lr 4.2499e-04 eta 0:00:08
epoch [141/200] batch [10/39] time 0.277 (0.260) data 0.111 (0.107) loss_u loss_u 0.9575 (0.9484) acc_u 6.2500 (5.9375) lr 4.2499e-04 eta 0:00:07
epoch [141/200] batch [15/39] time 0.271 (0.262) data 0.103 (0.106) loss_u loss_u 0.9600 (0.9568) acc_u 3.1250 (5.0000) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [20/39] time 0.252 (0.263) data 0.085 (0.106) loss_u loss_u 0.9707 (0.9609) acc_u 3.1250 (4.3750) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [25/39] time 0.250 (0.263) data 0.083 (0.104) loss_u loss_u 0.9126 (0.9600) acc_u 9.3750 (4.3750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [30/39] time 0.247 (0.259) data 0.088 (0.103) loss_u loss_u 0.9839 (0.9569) acc_u 0.0000 (4.6875) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [35/39] time 0.310 (0.260) data 0.142 (0.103) loss_u loss_u 0.9966 (0.9596) acc_u 0.0000 (4.3750) lr 4.2499e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 609
confident_label rate tensor(0.2234, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 361
clean true:334
clean false:27
clean_rate:0.925207756232687
noisy true:673
noisy false:582
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1255
epoch [142/200] batch [5/11] time 0.264 (0.266) data 0.106 (0.107) loss_x loss_x 0.4792 (0.5507) acc_x 84.3750 (85.6250) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/11] time 0.242 (0.261) data 0.082 (0.102) loss_x loss_x 0.7129 (0.6055) acc_x 78.1250 (84.6875) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/39] time 0.270 (0.256) data 0.103 (0.103) loss_u loss_u 0.9976 (0.9550) acc_u 0.0000 (5.6250) lr 4.1221e-04 eta 0:00:08
epoch [142/200] batch [10/39] time 0.273 (0.260) data 0.105 (0.104) loss_u loss_u 0.9517 (0.9500) acc_u 6.2500 (6.5625) lr 4.1221e-04 eta 0:00:07
epoch [142/200] batch [15/39] time 0.273 (0.263) data 0.108 (0.105) loss_u loss_u 0.9990 (0.9592) acc_u 0.0000 (5.2083) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [20/39] time 0.277 (0.263) data 0.109 (0.104) loss_u loss_u 0.9683 (0.9599) acc_u 3.1250 (4.8438) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [25/39] time 0.260 (0.264) data 0.094 (0.104) loss_u loss_u 0.9883 (0.9638) acc_u 3.1250 (4.3750) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [30/39] time 0.268 (0.259) data 0.101 (0.103) loss_u loss_u 0.9966 (0.9636) acc_u 0.0000 (4.3750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [35/39] time 0.287 (0.260) data 0.127 (0.103) loss_u loss_u 0.9487 (0.9615) acc_u 6.2500 (4.6429) lr 4.1221e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.2240, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 362
clean true:325
clean false:37
clean_rate:0.8977900552486188
noisy true:663
noisy false:591
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1254
epoch [143/200] batch [5/11] time 0.265 (0.265) data 0.106 (0.106) loss_x loss_x 0.5186 (0.6516) acc_x 84.3750 (86.2500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/11] time 0.262 (0.254) data 0.106 (0.106) loss_x loss_x 0.7202 (0.6880) acc_x 78.1250 (85.0000) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/39] time 0.275 (0.260) data 0.107 (0.106) loss_u loss_u 0.8931 (0.9499) acc_u 12.5000 (5.6250) lr 3.9958e-04 eta 0:00:08
epoch [143/200] batch [10/39] time 0.273 (0.263) data 0.106 (0.107) loss_u loss_u 0.9141 (0.9488) acc_u 12.5000 (5.9375) lr 3.9958e-04 eta 0:00:07
epoch [143/200] batch [15/39] time 0.271 (0.265) data 0.109 (0.107) loss_u loss_u 0.9971 (0.9578) acc_u 0.0000 (5.0000) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [20/39] time 0.272 (0.267) data 0.104 (0.108) loss_u loss_u 0.9937 (0.9657) acc_u 0.0000 (3.9062) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [25/39] time 0.260 (0.262) data 0.090 (0.107) loss_u loss_u 0.9746 (0.9638) acc_u 3.1250 (4.3750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [30/39] time 0.254 (0.263) data 0.088 (0.106) loss_u loss_u 0.9600 (0.9636) acc_u 6.2500 (4.4792) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [35/39] time 0.274 (0.263) data 0.106 (0.106) loss_u loss_u 0.8794 (0.9581) acc_u 12.5000 (5.0000) lr 3.9958e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.2209, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 357
clean true:333
clean false:24
clean_rate:0.9327731092436975
noisy true:681
noisy false:578
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1259
epoch [144/200] batch [5/11] time 0.268 (0.274) data 0.108 (0.115) loss_x loss_x 0.4607 (0.5220) acc_x 87.5000 (86.2500) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/11] time 0.269 (0.272) data 0.111 (0.112) loss_x loss_x 0.4973 (0.5910) acc_x 81.2500 (85.6250) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/39] time 0.269 (0.271) data 0.109 (0.111) loss_u loss_u 0.9736 (0.9604) acc_u 3.1250 (4.3750) lr 3.8709e-04 eta 0:00:09
epoch [144/200] batch [10/39] time 0.271 (0.271) data 0.109 (0.111) loss_u loss_u 0.9502 (0.9575) acc_u 6.2500 (4.6875) lr 3.8709e-04 eta 0:00:07
epoch [144/200] batch [15/39] time 0.187 (0.265) data 0.109 (0.111) loss_u loss_u 0.9507 (0.9620) acc_u 6.2500 (4.3750) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [20/39] time 0.305 (0.269) data 0.138 (0.112) loss_u loss_u 0.9492 (0.9606) acc_u 6.2500 (4.6875) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [25/39] time 0.254 (0.269) data 0.092 (0.112) loss_u loss_u 0.9780 (0.9587) acc_u 3.1250 (5.0000) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [30/39] time 0.267 (0.269) data 0.100 (0.110) loss_u loss_u 0.9468 (0.9579) acc_u 6.2500 (5.0000) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [35/39] time 0.276 (0.270) data 0.108 (0.110) loss_u loss_u 0.9976 (0.9558) acc_u 0.0000 (5.1786) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.2265, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 366
clean true:335
clean false:31
clean_rate:0.9153005464480874
noisy true:658
noisy false:592
after delete: len(clean_dataset) 366
after delete: len(noisy_dataset) 1250
epoch [145/200] batch [5/11] time 0.266 (0.248) data 0.105 (0.087) loss_x loss_x 0.8267 (0.7102) acc_x 78.1250 (83.1250) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/11] time 0.263 (0.254) data 0.105 (0.095) loss_x loss_x 0.1993 (0.5497) acc_x 93.7500 (86.2500) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/39] time 0.266 (0.247) data 0.106 (0.097) loss_u loss_u 0.9961 (0.9584) acc_u 0.0000 (4.3750) lr 3.7476e-04 eta 0:00:08
epoch [145/200] batch [10/39] time 0.286 (0.253) data 0.121 (0.099) loss_u loss_u 0.9355 (0.9528) acc_u 6.2500 (5.3125) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [15/39] time 0.290 (0.256) data 0.132 (0.100) loss_u loss_u 0.9980 (0.9632) acc_u 0.0000 (3.9583) lr 3.7476e-04 eta 0:00:06
epoch [145/200] batch [20/39] time 0.271 (0.258) data 0.106 (0.101) loss_u loss_u 0.9517 (0.9587) acc_u 6.2500 (4.5312) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [25/39] time 0.320 (0.260) data 0.156 (0.103) loss_u loss_u 0.9487 (0.9596) acc_u 6.2500 (4.5000) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [30/39] time 0.311 (0.262) data 0.143 (0.105) loss_u loss_u 0.9673 (0.9576) acc_u 3.1250 (4.7917) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [35/39] time 0.260 (0.261) data 0.092 (0.103) loss_u loss_u 0.9746 (0.9583) acc_u 3.1250 (4.6429) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.2222, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 359
clean true:330
clean false:29
clean_rate:0.9192200557103064
noisy true:673
noisy false:584
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1257
epoch [146/200] batch [5/11] time 0.266 (0.270) data 0.106 (0.110) loss_x loss_x 0.5581 (0.5094) acc_x 81.2500 (88.1250) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/11] time 0.280 (0.269) data 0.122 (0.110) loss_x loss_x 0.4170 (0.4883) acc_x 87.5000 (87.8125) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/39] time 0.288 (0.256) data 0.132 (0.109) loss_u loss_u 0.9434 (0.9558) acc_u 6.2500 (4.3750) lr 3.6258e-04 eta 0:00:08
epoch [146/200] batch [10/39] time 0.275 (0.263) data 0.119 (0.113) loss_u loss_u 0.9634 (0.9591) acc_u 3.1250 (4.3750) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [15/39] time 0.258 (0.266) data 0.098 (0.114) loss_u loss_u 0.9849 (0.9613) acc_u 3.1250 (4.1667) lr 3.6258e-04 eta 0:00:06
epoch [146/200] batch [20/39] time 0.255 (0.265) data 0.092 (0.111) loss_u loss_u 0.9702 (0.9608) acc_u 3.1250 (4.2188) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [25/39] time 0.266 (0.266) data 0.104 (0.111) loss_u loss_u 0.9688 (0.9616) acc_u 3.1250 (4.1250) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [30/39] time 0.241 (0.261) data 0.091 (0.110) loss_u loss_u 0.9541 (0.9607) acc_u 6.2500 (4.2708) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [35/39] time 0.262 (0.261) data 0.098 (0.108) loss_u loss_u 0.9678 (0.9612) acc_u 3.1250 (4.1964) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.2203, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 356
clean true:323
clean false:33
clean_rate:0.9073033707865169
noisy true:644
noisy false:616
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1260
epoch [147/200] batch [5/11] time 0.260 (0.264) data 0.105 (0.106) loss_x loss_x 0.3938 (0.6508) acc_x 90.6250 (83.1250) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/11] time 0.268 (0.265) data 0.109 (0.108) loss_x loss_x 0.6240 (0.5789) acc_x 81.2500 (84.6875) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/39] time 0.279 (0.267) data 0.114 (0.112) loss_u loss_u 0.9062 (0.9472) acc_u 12.5000 (6.2500) lr 3.5055e-04 eta 0:00:09
epoch [147/200] batch [10/39] time 0.269 (0.268) data 0.110 (0.112) loss_u loss_u 0.8882 (0.9318) acc_u 12.5000 (7.8125) lr 3.5055e-04 eta 0:00:07
epoch [147/200] batch [15/39] time 0.266 (0.267) data 0.103 (0.109) loss_u loss_u 0.9185 (0.9445) acc_u 9.3750 (6.4583) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [20/39] time 0.278 (0.268) data 0.117 (0.109) loss_u loss_u 0.9414 (0.9491) acc_u 6.2500 (5.9375) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [25/39] time 0.252 (0.269) data 0.087 (0.110) loss_u loss_u 0.9678 (0.9520) acc_u 3.1250 (5.5000) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [30/39] time 0.268 (0.265) data 0.110 (0.109) loss_u loss_u 0.9380 (0.9526) acc_u 6.2500 (5.3125) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [35/39] time 0.261 (0.264) data 0.101 (0.107) loss_u loss_u 0.9243 (0.9535) acc_u 9.3750 (5.2679) lr 3.5055e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 619
confident_label rate tensor(0.2290, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 370
clean true:338
clean false:32
clean_rate:0.9135135135135135
noisy true:659
noisy false:587
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1246
epoch [148/200] batch [5/11] time 0.266 (0.255) data 0.105 (0.095) loss_x loss_x 1.0820 (0.7528) acc_x 81.2500 (83.7500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/11] time 0.263 (0.258) data 0.105 (0.100) loss_x loss_x 0.7456 (0.7288) acc_x 75.0000 (81.2500) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/38] time 0.292 (0.257) data 0.138 (0.108) loss_u loss_u 0.9116 (0.9522) acc_u 9.3750 (4.3750) lr 3.3869e-04 eta 0:00:08
epoch [148/200] batch [10/38] time 0.273 (0.259) data 0.108 (0.107) loss_u loss_u 0.8569 (0.9468) acc_u 15.6250 (5.6250) lr 3.3869e-04 eta 0:00:07
epoch [148/200] batch [15/38] time 0.259 (0.260) data 0.094 (0.105) loss_u loss_u 0.9307 (0.9535) acc_u 6.2500 (4.7917) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [20/38] time 0.274 (0.259) data 0.108 (0.104) loss_u loss_u 0.9980 (0.9548) acc_u 0.0000 (4.6875) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [25/38] time 0.263 (0.262) data 0.105 (0.106) loss_u loss_u 0.9805 (0.9607) acc_u 3.1250 (4.1250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [30/38] time 0.239 (0.262) data 0.096 (0.105) loss_u loss_u 0.9487 (0.9599) acc_u 6.2500 (4.3750) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [35/38] time 0.286 (0.260) data 0.117 (0.105) loss_u loss_u 0.8604 (0.9557) acc_u 18.7500 (4.9107) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 627
confident_label rate tensor(0.2222, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 359
clean true:325
clean false:34
clean_rate:0.9052924791086351
noisy true:664
noisy false:593
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1257
epoch [149/200] batch [5/11] time 0.289 (0.278) data 0.127 (0.113) loss_x loss_x 0.4067 (0.6289) acc_x 90.6250 (85.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/11] time 0.271 (0.280) data 0.111 (0.118) loss_x loss_x 0.8794 (0.6445) acc_x 78.1250 (83.7500) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/39] time 0.284 (0.276) data 0.122 (0.114) loss_u loss_u 0.9648 (0.9075) acc_u 3.1250 (10.0000) lr 3.2699e-04 eta 0:00:09
epoch [149/200] batch [10/39] time 0.270 (0.274) data 0.107 (0.112) loss_u loss_u 0.9946 (0.9262) acc_u 0.0000 (8.4375) lr 3.2699e-04 eta 0:00:07
epoch [149/200] batch [15/39] time 0.212 (0.268) data 0.134 (0.112) loss_u loss_u 0.9673 (0.9375) acc_u 3.1250 (6.8750) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [20/39] time 0.271 (0.268) data 0.107 (0.111) loss_u loss_u 0.9546 (0.9439) acc_u 6.2500 (6.0938) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [25/39] time 0.277 (0.269) data 0.110 (0.111) loss_u loss_u 0.9614 (0.9497) acc_u 3.1250 (5.3750) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [30/39] time 0.260 (0.269) data 0.103 (0.111) loss_u loss_u 0.9653 (0.9498) acc_u 3.1250 (5.3125) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [35/39] time 0.293 (0.269) data 0.128 (0.110) loss_u loss_u 0.9404 (0.9484) acc_u 6.2500 (5.5357) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.2240, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 362
clean true:324
clean false:38
clean_rate:0.8950276243093923
noisy true:654
noisy false:600
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1254
epoch [150/200] batch [5/11] time 0.177 (0.243) data 0.101 (0.102) loss_x loss_x 0.3657 (0.7126) acc_x 87.5000 (80.0000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/11] time 0.255 (0.242) data 0.096 (0.099) loss_x loss_x 0.6211 (0.7024) acc_x 81.2500 (80.3125) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/39] time 0.268 (0.251) data 0.104 (0.101) loss_u loss_u 0.9302 (0.9541) acc_u 9.3750 (5.6250) lr 3.1545e-04 eta 0:00:08
epoch [150/200] batch [10/39] time 0.296 (0.258) data 0.131 (0.105) loss_u loss_u 0.9985 (0.9478) acc_u 0.0000 (5.9375) lr 3.1545e-04 eta 0:00:07
epoch [150/200] batch [15/39] time 0.270 (0.260) data 0.109 (0.105) loss_u loss_u 0.9424 (0.9539) acc_u 6.2500 (5.2083) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [20/39] time 0.196 (0.260) data 0.113 (0.106) loss_u loss_u 0.9644 (0.9566) acc_u 3.1250 (4.8438) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [25/39] time 0.271 (0.260) data 0.106 (0.107) loss_u loss_u 0.9336 (0.9556) acc_u 6.2500 (5.0000) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [30/39] time 0.268 (0.261) data 0.110 (0.107) loss_u loss_u 0.9546 (0.9555) acc_u 6.2500 (5.1042) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [35/39] time 0.270 (0.262) data 0.106 (0.107) loss_u loss_u 0.9355 (0.9549) acc_u 6.2500 (5.1786) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.2333, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 377
clean true:343
clean false:34
clean_rate:0.9098143236074271
noisy true:656
noisy false:583
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1239
epoch [151/200] batch [5/11] time 0.271 (0.261) data 0.107 (0.096) loss_x loss_x 0.8042 (0.6680) acc_x 84.3750 (83.7500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/11] time 0.270 (0.270) data 0.108 (0.106) loss_x loss_x 0.4658 (0.6108) acc_x 90.6250 (87.8125) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/38] time 0.272 (0.271) data 0.107 (0.107) loss_u loss_u 0.8657 (0.9553) acc_u 15.6250 (5.0000) lr 3.0409e-04 eta 0:00:08
epoch [151/200] batch [10/38] time 0.270 (0.271) data 0.106 (0.106) loss_u loss_u 0.9634 (0.9625) acc_u 3.1250 (5.0000) lr 3.0409e-04 eta 0:00:07
epoch [151/200] batch [15/38] time 0.181 (0.264) data 0.104 (0.106) loss_u loss_u 0.9341 (0.9595) acc_u 6.2500 (5.2083) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [20/38] time 0.272 (0.266) data 0.106 (0.107) loss_u loss_u 0.9360 (0.9611) acc_u 6.2500 (5.0000) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [25/38] time 0.267 (0.266) data 0.108 (0.107) loss_u loss_u 0.9946 (0.9640) acc_u 0.0000 (4.5000) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [30/38] time 0.269 (0.267) data 0.105 (0.107) loss_u loss_u 0.9385 (0.9649) acc_u 6.2500 (4.3750) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [35/38] time 0.275 (0.268) data 0.110 (0.107) loss_u loss_u 0.9443 (0.9648) acc_u 6.2500 (4.2857) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.2240, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 362
clean true:334
clean false:28
clean_rate:0.9226519337016574
noisy true:677
noisy false:577
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1254
epoch [152/200] batch [5/11] time 0.269 (0.268) data 0.106 (0.107) loss_x loss_x 0.5713 (0.4497) acc_x 84.3750 (88.1250) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/11] time 0.259 (0.257) data 0.083 (0.103) loss_x loss_x 0.5522 (0.4741) acc_x 90.6250 (88.4375) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/39] time 0.246 (0.254) data 0.083 (0.096) loss_u loss_u 0.9712 (0.9685) acc_u 3.1250 (3.1250) lr 2.9289e-04 eta 0:00:08
epoch [152/200] batch [10/39] time 0.251 (0.253) data 0.086 (0.093) loss_u loss_u 0.9380 (0.9668) acc_u 9.3750 (3.7500) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [15/39] time 0.251 (0.253) data 0.085 (0.092) loss_u loss_u 0.9478 (0.9648) acc_u 6.2500 (4.1667) lr 2.9289e-04 eta 0:00:06
epoch [152/200] batch [20/39] time 0.252 (0.252) data 0.086 (0.091) loss_u loss_u 0.9893 (0.9564) acc_u 3.1250 (5.1562) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [25/39] time 0.161 (0.250) data 0.083 (0.090) loss_u loss_u 0.9175 (0.9581) acc_u 9.3750 (5.0000) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [30/39] time 0.246 (0.249) data 0.085 (0.089) loss_u loss_u 0.9888 (0.9606) acc_u 0.0000 (4.6875) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [35/39] time 0.247 (0.249) data 0.083 (0.089) loss_u loss_u 0.9961 (0.9616) acc_u 0.0000 (4.6429) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.2296, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 371
clean true:340
clean false:31
clean_rate:0.9164420485175202
noisy true:677
noisy false:568
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1245
epoch [153/200] batch [5/11] time 0.181 (0.234) data 0.086 (0.084) loss_x loss_x 0.3496 (0.6219) acc_x 87.5000 (86.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/11] time 0.250 (0.233) data 0.087 (0.084) loss_x loss_x 0.4856 (0.5719) acc_x 87.5000 (86.5625) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/38] time 0.251 (0.239) data 0.085 (0.085) loss_u loss_u 0.9663 (0.9666) acc_u 3.1250 (3.1250) lr 2.8187e-04 eta 0:00:07
epoch [153/200] batch [10/38] time 0.252 (0.242) data 0.084 (0.085) loss_u loss_u 0.9590 (0.9619) acc_u 3.1250 (4.0625) lr 2.8187e-04 eta 0:00:06
epoch [153/200] batch [15/38] time 0.253 (0.244) data 0.084 (0.085) loss_u loss_u 0.9932 (0.9650) acc_u 0.0000 (3.9583) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [20/38] time 0.253 (0.245) data 0.084 (0.085) loss_u loss_u 0.9536 (0.9629) acc_u 6.2500 (4.2188) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [25/38] time 0.246 (0.242) data 0.084 (0.084) loss_u loss_u 0.9634 (0.9616) acc_u 3.1250 (4.3750) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [30/38] time 0.251 (0.243) data 0.083 (0.084) loss_u loss_u 0.9614 (0.9598) acc_u 3.1250 (4.6875) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [35/38] time 0.250 (0.244) data 0.083 (0.084) loss_u loss_u 0.9688 (0.9618) acc_u 3.1250 (4.3750) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 632
confident_label rate tensor(0.2246, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 363
clean true:329
clean false:34
clean_rate:0.90633608815427
noisy true:655
noisy false:598
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1253
epoch [154/200] batch [5/11] time 0.243 (0.245) data 0.081 (0.083) loss_x loss_x 0.4832 (0.4967) acc_x 90.6250 (88.7500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/11] time 0.242 (0.245) data 0.083 (0.083) loss_x loss_x 0.8442 (0.5483) acc_x 87.5000 (88.1250) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/39] time 0.250 (0.246) data 0.084 (0.083) loss_u loss_u 0.9712 (0.9736) acc_u 3.1250 (2.5000) lr 2.7103e-04 eta 0:00:08
epoch [154/200] batch [10/39] time 0.253 (0.248) data 0.084 (0.083) loss_u loss_u 0.9941 (0.9677) acc_u 0.0000 (3.1250) lr 2.7103e-04 eta 0:00:07
epoch [154/200] batch [15/39] time 0.264 (0.242) data 0.082 (0.083) loss_u loss_u 1.0000 (0.9664) acc_u 0.0000 (3.3333) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [20/39] time 0.251 (0.243) data 0.083 (0.083) loss_u loss_u 0.9702 (0.9639) acc_u 3.1250 (3.7500) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [25/39] time 0.252 (0.244) data 0.083 (0.083) loss_u loss_u 0.9438 (0.9569) acc_u 6.2500 (4.6250) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [30/39] time 0.251 (0.245) data 0.084 (0.083) loss_u loss_u 0.9717 (0.9599) acc_u 3.1250 (4.2708) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [35/39] time 0.251 (0.245) data 0.082 (0.083) loss_u loss_u 0.9595 (0.9597) acc_u 3.1250 (4.2857) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 615
confident_label rate tensor(0.2246, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 363
clean true:336
clean false:27
clean_rate:0.9256198347107438
noisy true:665
noisy false:588
after delete: len(clean_dataset) 363
after delete: len(noisy_dataset) 1253
epoch [155/200] batch [5/11] time 0.246 (0.242) data 0.082 (0.081) loss_x loss_x 0.4648 (0.5542) acc_x 90.6250 (85.6250) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/11] time 0.242 (0.242) data 0.082 (0.081) loss_x loss_x 0.6084 (0.6395) acc_x 84.3750 (83.4375) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/39] time 0.261 (0.238) data 0.083 (0.081) loss_u loss_u 0.9927 (0.9617) acc_u 0.0000 (3.7500) lr 2.6037e-04 eta 0:00:08
epoch [155/200] batch [10/39] time 0.250 (0.241) data 0.084 (0.082) loss_u loss_u 0.9692 (0.9751) acc_u 3.1250 (2.5000) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [15/39] time 0.250 (0.242) data 0.082 (0.082) loss_u loss_u 0.9980 (0.9733) acc_u 0.0000 (2.7083) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [20/39] time 0.253 (0.244) data 0.084 (0.082) loss_u loss_u 0.8770 (0.9671) acc_u 12.5000 (3.2812) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [25/39] time 0.248 (0.245) data 0.081 (0.082) loss_u loss_u 0.9619 (0.9639) acc_u 6.2500 (3.7500) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [30/39] time 0.249 (0.245) data 0.083 (0.082) loss_u loss_u 0.9512 (0.9618) acc_u 3.1250 (3.8542) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [35/39] time 0.248 (0.242) data 0.080 (0.082) loss_u loss_u 0.9941 (0.9616) acc_u 0.0000 (3.9286) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 368
clean true:340
clean false:28
clean_rate:0.9239130434782609
noisy true:627
noisy false:621
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1248
epoch [156/200] batch [5/11] time 0.241 (0.239) data 0.081 (0.081) loss_x loss_x 0.5542 (0.6310) acc_x 84.3750 (83.1250) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/11] time 0.240 (0.239) data 0.081 (0.081) loss_x loss_x 0.4614 (0.6082) acc_x 87.5000 (84.3750) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/39] time 0.246 (0.238) data 0.084 (0.082) loss_u loss_u 0.9985 (0.9561) acc_u 0.0000 (5.0000) lr 2.4989e-04 eta 0:00:08
epoch [156/200] batch [10/39] time 0.250 (0.241) data 0.083 (0.083) loss_u loss_u 0.9243 (0.9520) acc_u 9.3750 (5.6250) lr 2.4989e-04 eta 0:00:06
epoch [156/200] batch [15/39] time 0.247 (0.241) data 0.083 (0.082) loss_u loss_u 0.9932 (0.9606) acc_u 0.0000 (4.5833) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [20/39] time 0.242 (0.242) data 0.083 (0.083) loss_u loss_u 0.9751 (0.9654) acc_u 3.1250 (3.9062) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [25/39] time 0.248 (0.242) data 0.082 (0.083) loss_u loss_u 0.9438 (0.9605) acc_u 6.2500 (4.3750) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [30/39] time 0.253 (0.243) data 0.088 (0.083) loss_u loss_u 0.9170 (0.9602) acc_u 12.5000 (4.4792) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [35/39] time 0.254 (0.241) data 0.084 (0.083) loss_u loss_u 0.9336 (0.9598) acc_u 9.3750 (4.5536) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 368
clean true:335
clean false:33
clean_rate:0.9103260869565217
noisy true:645
noisy false:603
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1248
epoch [157/200] batch [5/11] time 0.244 (0.244) data 0.083 (0.082) loss_x loss_x 0.4683 (0.7351) acc_x 87.5000 (86.2500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/11] time 0.245 (0.243) data 0.082 (0.082) loss_x loss_x 0.4536 (0.6910) acc_x 87.5000 (84.6875) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/39] time 0.249 (0.241) data 0.084 (0.082) loss_u loss_u 0.9971 (0.9656) acc_u 0.0000 (4.3750) lr 2.3959e-04 eta 0:00:08
epoch [157/200] batch [10/39] time 0.245 (0.242) data 0.083 (0.082) loss_u loss_u 0.9458 (0.9622) acc_u 9.3750 (5.0000) lr 2.3959e-04 eta 0:00:07
epoch [157/200] batch [15/39] time 0.237 (0.242) data 0.081 (0.082) loss_u loss_u 0.9604 (0.9644) acc_u 6.2500 (4.5833) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [20/39] time 0.270 (0.245) data 0.105 (0.084) loss_u loss_u 0.9956 (0.9614) acc_u 0.0000 (5.0000) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [25/39] time 0.268 (0.248) data 0.102 (0.087) loss_u loss_u 0.9468 (0.9637) acc_u 9.3750 (4.6250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [30/39] time 0.184 (0.245) data 0.081 (0.088) loss_u loss_u 0.9946 (0.9647) acc_u 0.0000 (4.3750) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [35/39] time 0.252 (0.246) data 0.085 (0.088) loss_u loss_u 0.9795 (0.9664) acc_u 3.1250 (4.1071) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.2296, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 371
clean true:341
clean false:30
clean_rate:0.9191374663072777
noisy true:658
noisy false:587
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1245
epoch [158/200] batch [5/11] time 0.246 (0.245) data 0.083 (0.082) loss_x loss_x 0.6602 (0.4638) acc_x 81.2500 (88.1250) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/11] time 0.158 (0.237) data 0.082 (0.082) loss_x loss_x 0.6714 (0.4949) acc_x 78.1250 (88.1250) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/38] time 0.242 (0.236) data 0.081 (0.082) loss_u loss_u 0.9663 (0.9542) acc_u 3.1250 (5.0000) lr 2.2949e-04 eta 0:00:07
epoch [158/200] batch [10/38] time 0.250 (0.239) data 0.083 (0.082) loss_u loss_u 0.9814 (0.9584) acc_u 0.0000 (4.3750) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [15/38] time 0.245 (0.241) data 0.084 (0.082) loss_u loss_u 0.9971 (0.9639) acc_u 0.0000 (3.7500) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [20/38] time 0.250 (0.242) data 0.082 (0.082) loss_u loss_u 0.9834 (0.9611) acc_u 3.1250 (4.3750) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [25/38] time 0.247 (0.242) data 0.080 (0.082) loss_u loss_u 0.9937 (0.9660) acc_u 0.0000 (3.8750) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [30/38] time 0.260 (0.239) data 0.081 (0.082) loss_u loss_u 0.9551 (0.9670) acc_u 6.2500 (3.7500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [35/38] time 0.245 (0.240) data 0.082 (0.082) loss_u loss_u 0.9375 (0.9676) acc_u 9.3750 (3.6607) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 622
confident_label rate tensor(0.2259, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 365
clean true:334
clean false:31
clean_rate:0.915068493150685
noisy true:660
noisy false:591
after delete: len(clean_dataset) 365
after delete: len(noisy_dataset) 1251
epoch [159/200] batch [5/11] time 0.264 (0.265) data 0.103 (0.104) loss_x loss_x 0.6440 (0.5656) acc_x 87.5000 (85.6250) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/11] time 0.269 (0.266) data 0.106 (0.104) loss_x loss_x 0.4036 (0.5570) acc_x 90.6250 (86.2500) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/39] time 0.271 (0.257) data 0.105 (0.102) loss_u loss_u 0.9312 (0.9533) acc_u 9.3750 (5.6250) lr 2.1957e-04 eta 0:00:08
epoch [159/200] batch [10/39] time 0.248 (0.257) data 0.081 (0.098) loss_u loss_u 0.9385 (0.9502) acc_u 6.2500 (5.9375) lr 2.1957e-04 eta 0:00:07
epoch [159/200] batch [15/39] time 0.249 (0.255) data 0.082 (0.095) loss_u loss_u 0.9336 (0.9512) acc_u 9.3750 (6.0417) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [20/39] time 0.247 (0.254) data 0.081 (0.093) loss_u loss_u 0.9849 (0.9519) acc_u 3.1250 (5.9375) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [25/39] time 0.253 (0.253) data 0.085 (0.092) loss_u loss_u 0.9839 (0.9553) acc_u 0.0000 (5.3750) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [30/39] time 0.175 (0.249) data 0.082 (0.090) loss_u loss_u 0.9995 (0.9585) acc_u 0.0000 (4.8958) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [35/39] time 0.250 (0.249) data 0.083 (0.090) loss_u loss_u 0.9702 (0.9589) acc_u 3.1250 (4.7321) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 594
confident_label rate tensor(0.2308, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 373
clean true:340
clean false:33
clean_rate:0.9115281501340483
noisy true:682
noisy false:561
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1243
epoch [160/200] batch [5/11] time 0.241 (0.240) data 0.081 (0.082) loss_x loss_x 0.6558 (0.6123) acc_x 78.1250 (83.7500) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/11] time 0.242 (0.240) data 0.082 (0.082) loss_x loss_x 0.5776 (0.6252) acc_x 84.3750 (84.0625) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/38] time 0.159 (0.234) data 0.081 (0.082) loss_u loss_u 0.9902 (0.9683) acc_u 3.1250 (3.7500) lr 2.0984e-04 eta 0:00:07
epoch [160/200] batch [10/38] time 0.249 (0.237) data 0.081 (0.082) loss_u loss_u 0.9414 (0.9578) acc_u 6.2500 (5.0000) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [15/38] time 0.249 (0.239) data 0.081 (0.082) loss_u loss_u 0.9590 (0.9598) acc_u 3.1250 (4.5833) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [20/38] time 0.250 (0.241) data 0.082 (0.082) loss_u loss_u 0.9678 (0.9648) acc_u 3.1250 (3.9062) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [25/38] time 0.250 (0.242) data 0.081 (0.082) loss_u loss_u 0.9199 (0.9646) acc_u 6.2500 (4.0000) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [30/38] time 0.249 (0.243) data 0.081 (0.082) loss_u loss_u 0.9658 (0.9640) acc_u 3.1250 (4.0625) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [35/38] time 0.245 (0.241) data 0.083 (0.082) loss_u loss_u 0.9976 (0.9644) acc_u 0.0000 (4.1964) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 608
confident_label rate tensor(0.2302, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 372
clean true:342
clean false:30
clean_rate:0.9193548387096774
noisy true:666
noisy false:578
after delete: len(clean_dataset) 372
after delete: len(noisy_dataset) 1244
epoch [161/200] batch [5/11] time 0.241 (0.241) data 0.083 (0.083) loss_x loss_x 0.2549 (0.3880) acc_x 93.7500 (90.6250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [10/11] time 0.241 (0.241) data 0.083 (0.083) loss_x loss_x 0.3440 (0.4582) acc_x 93.7500 (87.5000) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/38] time 0.158 (0.236) data 0.081 (0.082) loss_u loss_u 0.9990 (0.9632) acc_u 0.0000 (3.7500) lr 2.0032e-04 eta 0:00:07
epoch [161/200] batch [10/38] time 0.249 (0.239) data 0.081 (0.082) loss_u loss_u 0.9971 (0.9720) acc_u 0.0000 (2.8125) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [15/38] time 0.241 (0.240) data 0.082 (0.082) loss_u loss_u 0.9097 (0.9738) acc_u 9.3750 (2.7083) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [20/38] time 0.246 (0.241) data 0.082 (0.082) loss_u loss_u 0.8872 (0.9669) acc_u 12.5000 (3.4375) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [25/38] time 0.246 (0.241) data 0.082 (0.082) loss_u loss_u 0.9229 (0.9657) acc_u 9.3750 (3.6250) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [30/38] time 0.244 (0.242) data 0.083 (0.082) loss_u loss_u 0.9673 (0.9641) acc_u 3.1250 (3.8542) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [35/38] time 0.262 (0.240) data 0.082 (0.082) loss_u loss_u 0.9863 (0.9642) acc_u 0.0000 (3.8393) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.2234, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 361
clean true:319
clean false:42
clean_rate:0.8836565096952909
noisy true:648
noisy false:607
after delete: len(clean_dataset) 361
after delete: len(noisy_dataset) 1255
epoch [162/200] batch [5/11] time 0.240 (0.243) data 0.081 (0.082) loss_x loss_x 0.3948 (0.6238) acc_x 90.6250 (83.7500) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/11] time 0.250 (0.244) data 0.086 (0.082) loss_x loss_x 0.2429 (0.5478) acc_x 96.8750 (85.9375) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/39] time 0.245 (0.239) data 0.082 (0.082) loss_u loss_u 0.9629 (0.9522) acc_u 3.1250 (5.6250) lr 1.9098e-04 eta 0:00:08
epoch [162/200] batch [10/39] time 0.241 (0.240) data 0.082 (0.082) loss_u loss_u 0.9355 (0.9502) acc_u 6.2500 (5.3125) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [15/39] time 0.240 (0.241) data 0.081 (0.082) loss_u loss_u 0.9033 (0.9542) acc_u 12.5000 (5.0000) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [20/39] time 0.246 (0.241) data 0.083 (0.082) loss_u loss_u 0.9458 (0.9562) acc_u 6.2500 (4.6875) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [25/39] time 0.243 (0.242) data 0.080 (0.082) loss_u loss_u 0.9331 (0.9570) acc_u 6.2500 (4.5000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [30/39] time 0.198 (0.241) data 0.081 (0.082) loss_u loss_u 0.9966 (0.9571) acc_u 0.0000 (4.4792) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [35/39] time 0.247 (0.240) data 0.082 (0.082) loss_u loss_u 0.9307 (0.9552) acc_u 6.2500 (4.7321) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:339
clean false:35
clean_rate:0.9064171122994652
noisy true:672
noisy false:570
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [163/200] batch [5/11] time 0.244 (0.255) data 0.081 (0.093) loss_x loss_x 0.5181 (0.4344) acc_x 84.3750 (90.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/11] time 0.242 (0.249) data 0.082 (0.088) loss_x loss_x 0.4951 (0.4725) acc_x 84.3750 (87.5000) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/38] time 0.248 (0.243) data 0.083 (0.087) loss_u loss_u 0.9346 (0.9541) acc_u 6.2500 (4.3750) lr 1.8185e-04 eta 0:00:08
epoch [163/200] batch [10/38] time 0.248 (0.244) data 0.082 (0.086) loss_u loss_u 0.9824 (0.9634) acc_u 3.1250 (3.7500) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [15/38] time 0.248 (0.245) data 0.082 (0.085) loss_u loss_u 0.9346 (0.9617) acc_u 6.2500 (4.1667) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [20/38] time 0.260 (0.247) data 0.094 (0.087) loss_u loss_u 0.9980 (0.9620) acc_u 0.0000 (3.9062) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [25/38] time 0.251 (0.248) data 0.083 (0.086) loss_u loss_u 0.9707 (0.9614) acc_u 3.1250 (4.1250) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [30/38] time 0.260 (0.246) data 0.096 (0.087) loss_u loss_u 0.9438 (0.9601) acc_u 6.2500 (4.2708) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [35/38] time 0.249 (0.247) data 0.083 (0.087) loss_u loss_u 0.9995 (0.9609) acc_u 0.0000 (4.2857) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 607
confident_label rate tensor(0.2308, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 373
clean true:341
clean false:32
clean_rate:0.9142091152815014
noisy true:668
noisy false:575
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1243
epoch [164/200] batch [5/11] time 0.239 (0.245) data 0.084 (0.084) loss_x loss_x 0.5400 (0.4958) acc_x 84.3750 (86.8750) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/11] time 0.243 (0.245) data 0.082 (0.084) loss_x loss_x 1.0156 (0.5731) acc_x 75.0000 (86.5625) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/38] time 0.250 (0.242) data 0.083 (0.084) loss_u loss_u 0.9946 (0.9690) acc_u 0.0000 (3.7500) lr 1.7292e-04 eta 0:00:07
epoch [164/200] batch [10/38] time 0.252 (0.244) data 0.083 (0.084) loss_u loss_u 0.9932 (0.9733) acc_u 0.0000 (3.1250) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [15/38] time 0.253 (0.246) data 0.083 (0.084) loss_u loss_u 0.9531 (0.9649) acc_u 6.2500 (4.1667) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [20/38] time 0.255 (0.247) data 0.087 (0.084) loss_u loss_u 0.9160 (0.9591) acc_u 9.3750 (4.6875) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [25/38] time 0.257 (0.248) data 0.091 (0.084) loss_u loss_u 0.9839 (0.9634) acc_u 3.1250 (4.2500) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [30/38] time 0.282 (0.249) data 0.118 (0.087) loss_u loss_u 0.9907 (0.9654) acc_u 3.1250 (4.0625) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [35/38] time 0.274 (0.251) data 0.107 (0.089) loss_u loss_u 0.9658 (0.9680) acc_u 3.1250 (3.6607) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 648
confident_label rate tensor(0.2271, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 367
clean true:334
clean false:33
clean_rate:0.9100817438692098
noisy true:634
noisy false:615
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1249
epoch [165/200] batch [5/11] time 0.246 (0.245) data 0.083 (0.083) loss_x loss_x 0.9795 (0.7014) acc_x 78.1250 (82.5000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/11] time 0.245 (0.245) data 0.083 (0.083) loss_x loss_x 0.7158 (0.6394) acc_x 75.0000 (83.1250) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/39] time 0.259 (0.238) data 0.091 (0.084) loss_u loss_u 0.8506 (0.9551) acc_u 18.7500 (6.2500) lr 1.6419e-04 eta 0:00:08
epoch [165/200] batch [10/39] time 0.250 (0.241) data 0.082 (0.084) loss_u loss_u 0.9473 (0.9598) acc_u 6.2500 (5.0000) lr 1.6419e-04 eta 0:00:06
epoch [165/200] batch [15/39] time 0.252 (0.242) data 0.085 (0.083) loss_u loss_u 0.9648 (0.9571) acc_u 3.1250 (5.0000) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [20/39] time 0.250 (0.244) data 0.083 (0.084) loss_u loss_u 0.9287 (0.9546) acc_u 6.2500 (5.0000) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [25/39] time 0.253 (0.245) data 0.085 (0.084) loss_u loss_u 0.9448 (0.9548) acc_u 6.2500 (5.1250) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [30/39] time 0.162 (0.243) data 0.084 (0.084) loss_u loss_u 0.9390 (0.9568) acc_u 6.2500 (4.8958) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [35/39] time 0.252 (0.244) data 0.085 (0.084) loss_u loss_u 0.9487 (0.9591) acc_u 6.2500 (4.6429) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 621
confident_label rate tensor(0.2296, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 371
clean true:334
clean false:37
clean_rate:0.9002695417789758
noisy true:661
noisy false:584
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1245
epoch [166/200] batch [5/11] time 0.241 (0.244) data 0.082 (0.085) loss_x loss_x 0.5254 (0.5538) acc_x 87.5000 (86.2500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/11] time 0.245 (0.244) data 0.085 (0.085) loss_x loss_x 0.7075 (0.6052) acc_x 84.3750 (84.6875) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/38] time 0.253 (0.236) data 0.085 (0.085) loss_u loss_u 0.9692 (0.9691) acc_u 3.1250 (3.7500) lr 1.5567e-04 eta 0:00:07
epoch [166/200] batch [10/38] time 0.250 (0.240) data 0.083 (0.084) loss_u loss_u 0.9971 (0.9554) acc_u 0.0000 (5.6250) lr 1.5567e-04 eta 0:00:06
epoch [166/200] batch [15/38] time 0.251 (0.242) data 0.084 (0.084) loss_u loss_u 0.9780 (0.9571) acc_u 3.1250 (5.2083) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [20/38] time 0.254 (0.243) data 0.086 (0.084) loss_u loss_u 0.9961 (0.9541) acc_u 0.0000 (5.6250) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [25/38] time 0.246 (0.244) data 0.082 (0.084) loss_u loss_u 0.9971 (0.9580) acc_u 0.0000 (5.1250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [30/38] time 0.162 (0.243) data 0.084 (0.084) loss_u loss_u 0.9785 (0.9586) acc_u 3.1250 (5.1042) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [35/38] time 0.248 (0.242) data 0.081 (0.084) loss_u loss_u 0.9727 (0.9606) acc_u 3.1250 (4.8214) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.2228, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 360
clean true:326
clean false:34
clean_rate:0.9055555555555556
noisy true:655
noisy false:601
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1256
epoch [167/200] batch [5/11] time 0.247 (0.241) data 0.084 (0.081) loss_x loss_x 0.2522 (0.4679) acc_x 96.8750 (88.7500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/11] time 0.242 (0.242) data 0.084 (0.082) loss_x loss_x 0.8057 (0.5478) acc_x 84.3750 (87.5000) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/39] time 0.156 (0.231) data 0.078 (0.082) loss_u loss_u 0.9385 (0.9531) acc_u 6.2500 (5.0000) lr 1.4736e-04 eta 0:00:07
epoch [167/200] batch [10/39] time 0.247 (0.236) data 0.087 (0.082) loss_u loss_u 0.9644 (0.9627) acc_u 3.1250 (4.3750) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [15/39] time 0.243 (0.237) data 0.081 (0.082) loss_u loss_u 0.9976 (0.9572) acc_u 0.0000 (5.2083) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [20/39] time 0.245 (0.238) data 0.081 (0.082) loss_u loss_u 0.9282 (0.9566) acc_u 6.2500 (5.1562) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [25/39] time 0.238 (0.239) data 0.082 (0.082) loss_u loss_u 0.9629 (0.9558) acc_u 6.2500 (5.2500) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [30/39] time 0.247 (0.240) data 0.083 (0.082) loss_u loss_u 0.9395 (0.9560) acc_u 6.2500 (5.2083) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [35/39] time 0.242 (0.238) data 0.082 (0.082) loss_u loss_u 0.9219 (0.9518) acc_u 9.3750 (5.5357) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.2370, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 383
clean true:345
clean false:38
clean_rate:0.9007832898172323
noisy true:651
noisy false:582
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1233
epoch [168/200] batch [5/11] time 0.245 (0.243) data 0.081 (0.081) loss_x loss_x 0.2896 (0.5483) acc_x 93.7500 (87.5000) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/11] time 0.246 (0.244) data 0.082 (0.082) loss_x loss_x 0.6948 (0.5229) acc_x 84.3750 (88.4375) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/38] time 0.254 (0.238) data 0.080 (0.082) loss_u loss_u 0.9990 (0.9639) acc_u 0.0000 (5.0000) lr 1.3926e-04 eta 0:00:07
epoch [168/200] batch [10/38] time 0.242 (0.240) data 0.079 (0.081) loss_u loss_u 0.9282 (0.9554) acc_u 6.2500 (5.0000) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [15/38] time 0.249 (0.241) data 0.082 (0.081) loss_u loss_u 0.9995 (0.9642) acc_u 0.0000 (3.9583) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [20/38] time 0.248 (0.242) data 0.080 (0.081) loss_u loss_u 0.9541 (0.9635) acc_u 6.2500 (4.0625) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [25/38] time 0.239 (0.242) data 0.081 (0.081) loss_u loss_u 0.9990 (0.9649) acc_u 0.0000 (4.0000) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [30/38] time 0.247 (0.243) data 0.081 (0.081) loss_u loss_u 0.9126 (0.9661) acc_u 9.3750 (3.7500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [35/38] time 0.247 (0.241) data 0.080 (0.081) loss_u loss_u 0.9980 (0.9668) acc_u 0.0000 (3.6607) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 629
confident_label rate tensor(0.2308, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 373
clean true:334
clean false:39
clean_rate:0.8954423592493298
noisy true:653
noisy false:590
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1243
epoch [169/200] batch [5/11] time 0.247 (0.232) data 0.082 (0.081) loss_x loss_x 0.4653 (0.5274) acc_x 87.5000 (87.5000) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/11] time 0.246 (0.239) data 0.081 (0.081) loss_x loss_x 0.7720 (0.5722) acc_x 84.3750 (86.5625) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/38] time 0.247 (0.242) data 0.080 (0.081) loss_u loss_u 0.9473 (0.9615) acc_u 6.2500 (4.3750) lr 1.3137e-04 eta 0:00:07
epoch [169/200] batch [10/38] time 0.249 (0.243) data 0.081 (0.081) loss_u loss_u 0.9180 (0.9601) acc_u 9.3750 (4.3750) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [15/38] time 0.248 (0.244) data 0.079 (0.081) loss_u loss_u 0.9507 (0.9624) acc_u 6.2500 (4.1667) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [20/38] time 0.243 (0.242) data 0.083 (0.081) loss_u loss_u 0.9688 (0.9601) acc_u 3.1250 (4.5312) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [25/38] time 0.247 (0.243) data 0.081 (0.081) loss_u loss_u 0.9072 (0.9595) acc_u 9.3750 (4.5000) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [30/38] time 0.245 (0.243) data 0.080 (0.081) loss_u loss_u 0.9648 (0.9608) acc_u 3.1250 (4.3750) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [35/38] time 0.248 (0.243) data 0.081 (0.081) loss_u loss_u 0.9502 (0.9585) acc_u 6.2500 (4.6429) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 640
confident_label rate tensor(0.2271, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 367
clean true:333
clean false:34
clean_rate:0.9073569482288828
noisy true:643
noisy false:606
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1249
epoch [170/200] batch [5/11] time 0.240 (0.242) data 0.079 (0.081) loss_x loss_x 0.3726 (0.4939) acc_x 90.6250 (88.7500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/11] time 0.241 (0.243) data 0.081 (0.081) loss_x loss_x 0.5186 (0.5263) acc_x 90.6250 (87.5000) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/39] time 0.252 (0.245) data 0.084 (0.081) loss_u loss_u 0.9346 (0.9646) acc_u 6.2500 (3.1250) lr 1.2369e-04 eta 0:00:08
epoch [170/200] batch [10/39] time 0.249 (0.246) data 0.083 (0.082) loss_u loss_u 0.9175 (0.9543) acc_u 9.3750 (4.6875) lr 1.2369e-04 eta 0:00:07
epoch [170/200] batch [15/39] time 0.158 (0.243) data 0.080 (0.082) loss_u loss_u 0.9907 (0.9479) acc_u 0.0000 (5.6250) lr 1.2369e-04 eta 0:00:05
epoch [170/200] batch [20/39] time 0.251 (0.242) data 0.083 (0.082) loss_u loss_u 0.9673 (0.9578) acc_u 3.1250 (4.5312) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [25/39] time 0.249 (0.243) data 0.081 (0.082) loss_u loss_u 0.9775 (0.9552) acc_u 3.1250 (5.0000) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [30/39] time 0.251 (0.244) data 0.081 (0.082) loss_u loss_u 0.9961 (0.9556) acc_u 0.0000 (4.8958) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [35/39] time 0.247 (0.244) data 0.082 (0.082) loss_u loss_u 0.9565 (0.9546) acc_u 6.2500 (5.0893) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 609
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:340
clean false:34
clean_rate:0.9090909090909091
noisy true:667
noisy false:575
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [171/200] batch [5/11] time 0.242 (0.245) data 0.080 (0.083) loss_x loss_x 0.4712 (0.3465) acc_x 84.3750 (90.6250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/11] time 0.241 (0.243) data 0.080 (0.081) loss_x loss_x 0.6299 (0.4562) acc_x 84.3750 (90.9375) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/38] time 0.245 (0.241) data 0.079 (0.082) loss_u loss_u 0.9756 (0.9781) acc_u 3.1250 (3.1250) lr 1.1623e-04 eta 0:00:07
epoch [171/200] batch [10/38] time 0.245 (0.242) data 0.080 (0.081) loss_u loss_u 0.9697 (0.9551) acc_u 3.1250 (5.3125) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [15/38] time 0.248 (0.243) data 0.081 (0.081) loss_u loss_u 0.9946 (0.9628) acc_u 3.1250 (4.5833) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [20/38] time 0.259 (0.244) data 0.097 (0.082) loss_u loss_u 0.9995 (0.9617) acc_u 0.0000 (4.5312) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [25/38] time 0.254 (0.245) data 0.087 (0.083) loss_u loss_u 0.8857 (0.9588) acc_u 12.5000 (4.7500) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [30/38] time 0.160 (0.243) data 0.082 (0.083) loss_u loss_u 0.9834 (0.9590) acc_u 3.1250 (4.7917) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [35/38] time 0.250 (0.244) data 0.083 (0.083) loss_u loss_u 0.9355 (0.9595) acc_u 9.3750 (4.7321) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.2333, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 377
clean true:337
clean false:40
clean_rate:0.8938992042440318
noisy true:641
noisy false:598
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1239
epoch [172/200] batch [5/11] time 0.240 (0.244) data 0.083 (0.083) loss_x loss_x 0.9443 (0.7556) acc_x 90.6250 (83.7500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/11] time 0.246 (0.244) data 0.084 (0.084) loss_x loss_x 0.3896 (0.6415) acc_x 93.7500 (85.6250) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/38] time 0.162 (0.234) data 0.084 (0.084) loss_u loss_u 0.9487 (0.9604) acc_u 6.2500 (5.0000) lr 1.0899e-04 eta 0:00:07
epoch [172/200] batch [10/38] time 0.252 (0.239) data 0.083 (0.084) loss_u loss_u 0.9570 (0.9690) acc_u 3.1250 (3.4375) lr 1.0899e-04 eta 0:00:06
epoch [172/200] batch [15/38] time 0.250 (0.241) data 0.083 (0.084) loss_u loss_u 0.9370 (0.9705) acc_u 6.2500 (3.1250) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [20/38] time 0.250 (0.243) data 0.082 (0.084) loss_u loss_u 0.9751 (0.9724) acc_u 3.1250 (2.9688) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [25/38] time 0.255 (0.244) data 0.088 (0.084) loss_u loss_u 0.9189 (0.9678) acc_u 9.3750 (3.5000) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [30/38] time 0.254 (0.245) data 0.083 (0.084) loss_u loss_u 0.9272 (0.9657) acc_u 9.3750 (3.7500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [35/38] time 0.266 (0.242) data 0.083 (0.084) loss_u loss_u 0.8677 (0.9608) acc_u 15.6250 (4.3750) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 634
confident_label rate tensor(0.2283, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 369
clean true:337
clean false:32
clean_rate:0.9132791327913279
noisy true:645
noisy false:602
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1247
epoch [173/200] batch [5/11] time 0.243 (0.242) data 0.081 (0.083) loss_x loss_x 0.2343 (0.6442) acc_x 96.8750 (83.7500) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/11] time 0.240 (0.242) data 0.081 (0.083) loss_x loss_x 0.4900 (0.5640) acc_x 90.6250 (85.6250) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/38] time 0.161 (0.238) data 0.083 (0.083) loss_u loss_u 0.9644 (0.9727) acc_u 3.1250 (3.7500) lr 1.0197e-04 eta 0:00:07
epoch [173/200] batch [10/38] time 0.247 (0.237) data 0.084 (0.083) loss_u loss_u 0.9551 (0.9767) acc_u 6.2500 (2.8125) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [15/38] time 0.246 (0.239) data 0.084 (0.083) loss_u loss_u 0.9658 (0.9680) acc_u 3.1250 (4.5833) lr 1.0197e-04 eta 0:00:05
epoch [173/200] batch [20/38] time 0.246 (0.240) data 0.084 (0.083) loss_u loss_u 0.9995 (0.9679) acc_u 0.0000 (4.3750) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [25/38] time 0.247 (0.241) data 0.082 (0.083) loss_u loss_u 0.9194 (0.9646) acc_u 9.3750 (4.5000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [30/38] time 0.245 (0.242) data 0.083 (0.083) loss_u loss_u 0.9775 (0.9644) acc_u 3.1250 (4.3750) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [35/38] time 0.161 (0.241) data 0.084 (0.083) loss_u loss_u 1.0000 (0.9635) acc_u 0.0000 (4.4643) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:337
clean false:37
clean_rate:0.9010695187165776
noisy true:669
noisy false:573
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [174/200] batch [5/11] time 0.246 (0.247) data 0.082 (0.084) loss_x loss_x 0.2620 (0.4045) acc_x 93.7500 (91.2500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/11] time 0.248 (0.247) data 0.084 (0.084) loss_x loss_x 0.3630 (0.4530) acc_x 90.6250 (91.5625) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/38] time 0.174 (0.237) data 0.081 (0.083) loss_u loss_u 0.9517 (0.9698) acc_u 6.2500 (3.7500) lr 9.5173e-05 eta 0:00:07
epoch [174/200] batch [10/38] time 0.246 (0.239) data 0.081 (0.083) loss_u loss_u 0.9775 (0.9626) acc_u 3.1250 (4.6875) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [15/38] time 0.243 (0.240) data 0.081 (0.083) loss_u loss_u 0.9683 (0.9530) acc_u 3.1250 (5.8333) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [20/38] time 0.243 (0.241) data 0.084 (0.083) loss_u loss_u 0.9810 (0.9547) acc_u 3.1250 (5.4688) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [25/38] time 0.245 (0.241) data 0.081 (0.083) loss_u loss_u 0.9990 (0.9612) acc_u 0.0000 (4.6250) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [30/38] time 0.250 (0.242) data 0.083 (0.083) loss_u loss_u 0.9966 (0.9604) acc_u 0.0000 (4.6875) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [35/38] time 0.261 (0.240) data 0.081 (0.083) loss_u loss_u 0.9243 (0.9601) acc_u 9.3750 (4.6429) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 632
confident_label rate tensor(0.2345, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 379
clean true:340
clean false:39
clean_rate:0.8970976253298153
noisy true:644
noisy false:593
after delete: len(clean_dataset) 379
after delete: len(noisy_dataset) 1237
epoch [175/200] batch [5/11] time 0.247 (0.247) data 0.085 (0.084) loss_x loss_x 0.5610 (0.6164) acc_x 84.3750 (88.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/11] time 0.245 (0.246) data 0.082 (0.084) loss_x loss_x 1.0654 (0.6617) acc_x 75.0000 (84.0625) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/38] time 0.264 (0.239) data 0.081 (0.084) loss_u loss_u 0.9409 (0.9425) acc_u 6.2500 (6.8750) lr 8.8597e-05 eta 0:00:07
epoch [175/200] batch [10/38] time 0.252 (0.241) data 0.083 (0.084) loss_u loss_u 0.9976 (0.9577) acc_u 0.0000 (4.6875) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [15/38] time 0.252 (0.243) data 0.084 (0.084) loss_u loss_u 0.9678 (0.9524) acc_u 3.1250 (5.4167) lr 8.8597e-05 eta 0:00:05
epoch [175/200] batch [20/38] time 0.249 (0.243) data 0.082 (0.083) loss_u loss_u 0.9980 (0.9581) acc_u 0.0000 (4.6875) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [25/38] time 0.249 (0.244) data 0.081 (0.083) loss_u loss_u 0.9570 (0.9589) acc_u 3.1250 (4.5000) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [30/38] time 0.253 (0.245) data 0.084 (0.083) loss_u loss_u 0.9683 (0.9614) acc_u 3.1250 (4.2708) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [35/38] time 0.249 (0.243) data 0.083 (0.083) loss_u loss_u 0.9595 (0.9622) acc_u 6.2500 (4.1964) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.2271, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 367
clean true:335
clean false:32
clean_rate:0.9128065395095368
noisy true:671
noisy false:578
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1249
epoch [176/200] batch [5/11] time 0.249 (0.249) data 0.088 (0.087) loss_x loss_x 0.3450 (0.4397) acc_x 90.6250 (88.1250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/11] time 0.246 (0.248) data 0.084 (0.086) loss_x loss_x 0.5024 (0.4800) acc_x 84.3750 (88.1250) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/39] time 0.253 (0.241) data 0.087 (0.085) loss_u loss_u 0.9312 (0.9408) acc_u 9.3750 (6.8750) lr 8.2245e-05 eta 0:00:08
epoch [176/200] batch [10/39] time 0.250 (0.243) data 0.084 (0.084) loss_u loss_u 0.9971 (0.9443) acc_u 0.0000 (5.9375) lr 8.2245e-05 eta 0:00:07
epoch [176/200] batch [15/39] time 0.251 (0.244) data 0.084 (0.084) loss_u loss_u 0.9395 (0.9493) acc_u 6.2500 (5.4167) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [20/39] time 0.252 (0.246) data 0.084 (0.084) loss_u loss_u 0.9976 (0.9562) acc_u 0.0000 (4.8438) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [25/39] time 0.252 (0.246) data 0.085 (0.084) loss_u loss_u 0.9585 (0.9569) acc_u 3.1250 (4.6250) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [30/39] time 0.254 (0.244) data 0.085 (0.084) loss_u loss_u 0.9927 (0.9617) acc_u 3.1250 (4.1667) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [35/39] time 0.250 (0.245) data 0.082 (0.084) loss_u loss_u 0.9946 (0.9625) acc_u 0.0000 (4.1071) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.2228, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 360
clean true:330
clean false:30
clean_rate:0.9166666666666666
noisy true:661
noisy false:595
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1256
epoch [177/200] batch [5/11] time 0.246 (0.231) data 0.083 (0.083) loss_x loss_x 0.5171 (0.5016) acc_x 87.5000 (85.0000) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/11] time 0.248 (0.238) data 0.083 (0.083) loss_x loss_x 0.4500 (0.5375) acc_x 90.6250 (85.6250) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/39] time 0.254 (0.243) data 0.086 (0.084) loss_u loss_u 0.9570 (0.9369) acc_u 6.2500 (7.5000) lr 7.6120e-05 eta 0:00:08
epoch [177/200] batch [10/39] time 0.254 (0.245) data 0.086 (0.084) loss_u loss_u 0.9751 (0.9473) acc_u 3.1250 (6.2500) lr 7.6120e-05 eta 0:00:07
epoch [177/200] batch [15/39] time 0.249 (0.246) data 0.085 (0.084) loss_u loss_u 0.8892 (0.9416) acc_u 12.5000 (6.6667) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [20/39] time 0.251 (0.244) data 0.084 (0.084) loss_u loss_u 0.9355 (0.9490) acc_u 9.3750 (5.7812) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [25/39] time 0.252 (0.245) data 0.084 (0.084) loss_u loss_u 0.9644 (0.9509) acc_u 3.1250 (5.5000) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [30/39] time 0.252 (0.245) data 0.085 (0.084) loss_u loss_u 0.9697 (0.9547) acc_u 3.1250 (5.0000) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [35/39] time 0.249 (0.246) data 0.082 (0.084) loss_u loss_u 0.9849 (0.9573) acc_u 0.0000 (4.6429) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:342
clean false:32
clean_rate:0.9144385026737968
noisy true:646
noisy false:596
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [178/200] batch [5/11] time 0.241 (0.243) data 0.083 (0.084) loss_x loss_x 0.8135 (0.5855) acc_x 87.5000 (85.6250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [10/11] time 0.242 (0.243) data 0.084 (0.083) loss_x loss_x 0.3979 (0.4676) acc_x 93.7500 (89.0625) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/38] time 0.262 (0.233) data 0.083 (0.083) loss_u loss_u 0.9922 (0.9583) acc_u 0.0000 (5.6250) lr 7.0224e-05 eta 0:00:07
epoch [178/200] batch [10/38] time 0.252 (0.237) data 0.084 (0.083) loss_u loss_u 0.9780 (0.9668) acc_u 3.1250 (4.3750) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [15/38] time 0.251 (0.239) data 0.083 (0.083) loss_u loss_u 0.9956 (0.9671) acc_u 0.0000 (3.9583) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [20/38] time 0.245 (0.241) data 0.084 (0.083) loss_u loss_u 0.9438 (0.9673) acc_u 6.2500 (3.9062) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [25/38] time 0.245 (0.242) data 0.085 (0.083) loss_u loss_u 1.0000 (0.9667) acc_u 0.0000 (3.8750) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [30/38] time 0.244 (0.243) data 0.081 (0.083) loss_u loss_u 0.9956 (0.9695) acc_u 0.0000 (3.4375) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [35/38] time 0.247 (0.240) data 0.082 (0.083) loss_u loss_u 0.9692 (0.9664) acc_u 3.1250 (3.7500) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 657
confident_label rate tensor(0.2321, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 375
clean true:336
clean false:39
clean_rate:0.896
noisy true:623
noisy false:618
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1241
epoch [179/200] batch [5/11] time 0.243 (0.244) data 0.081 (0.084) loss_x loss_x 1.4355 (0.6691) acc_x 65.6250 (83.7500) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/11] time 0.244 (0.244) data 0.085 (0.084) loss_x loss_x 0.5400 (0.6425) acc_x 87.5000 (84.3750) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/38] time 0.249 (0.239) data 0.083 (0.084) loss_u loss_u 0.9575 (0.9594) acc_u 3.1250 (5.0000) lr 6.4556e-05 eta 0:00:07
epoch [179/200] batch [10/38] time 0.247 (0.241) data 0.082 (0.083) loss_u loss_u 0.9648 (0.9592) acc_u 3.1250 (4.6875) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [15/38] time 0.246 (0.242) data 0.082 (0.083) loss_u loss_u 0.9976 (0.9562) acc_u 0.0000 (5.0000) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [20/38] time 0.252 (0.243) data 0.085 (0.083) loss_u loss_u 0.9375 (0.9595) acc_u 6.2500 (4.5312) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [25/38] time 0.243 (0.244) data 0.081 (0.084) loss_u loss_u 0.9165 (0.9560) acc_u 9.3750 (4.8750) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [30/38] time 0.173 (0.243) data 0.096 (0.084) loss_u loss_u 0.9985 (0.9603) acc_u 0.0000 (4.3750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [35/38] time 0.250 (0.244) data 0.086 (0.084) loss_u loss_u 0.9556 (0.9618) acc_u 6.2500 (4.2857) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 613
confident_label rate tensor(0.2376, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 384
clean true:343
clean false:41
clean_rate:0.8932291666666666
noisy true:660
noisy false:572
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1232
epoch [180/200] batch [5/12] time 0.247 (0.245) data 0.083 (0.083) loss_x loss_x 0.2117 (0.4045) acc_x 96.8750 (90.0000) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/12] time 0.240 (0.237) data 0.082 (0.082) loss_x loss_x 0.5938 (0.5138) acc_x 87.5000 (88.1250) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/38] time 0.246 (0.240) data 0.083 (0.082) loss_u loss_u 0.9951 (0.9645) acc_u 0.0000 (3.7500) lr 5.9119e-05 eta 0:00:07
epoch [180/200] batch [10/38] time 0.245 (0.241) data 0.083 (0.082) loss_u loss_u 0.9644 (0.9704) acc_u 3.1250 (3.1250) lr 5.9119e-05 eta 0:00:06
epoch [180/200] batch [15/38] time 0.243 (0.241) data 0.084 (0.082) loss_u loss_u 0.9634 (0.9679) acc_u 3.1250 (3.3333) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [20/38] time 0.243 (0.242) data 0.081 (0.082) loss_u loss_u 0.9668 (0.9711) acc_u 3.1250 (2.9688) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [25/38] time 0.157 (0.239) data 0.080 (0.082) loss_u loss_u 0.9482 (0.9661) acc_u 6.2500 (3.7500) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [30/38] time 0.238 (0.240) data 0.080 (0.082) loss_u loss_u 0.9697 (0.9680) acc_u 6.2500 (3.6458) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [35/38] time 0.246 (0.240) data 0.081 (0.082) loss_u loss_u 0.8325 (0.9650) acc_u 21.8750 (4.1071) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.2333, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 377
clean true:339
clean false:38
clean_rate:0.8992042440318302
noisy true:671
noisy false:568
after delete: len(clean_dataset) 377
after delete: len(noisy_dataset) 1239
epoch [181/200] batch [5/11] time 0.252 (0.246) data 0.090 (0.085) loss_x loss_x 0.6050 (0.6308) acc_x 87.5000 (86.2500) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [10/11] time 0.240 (0.244) data 0.081 (0.084) loss_x loss_x 0.4949 (0.5630) acc_x 84.3750 (88.4375) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/38] time 0.250 (0.243) data 0.082 (0.085) loss_u loss_u 0.9927 (0.9781) acc_u 0.0000 (1.8750) lr 5.3915e-05 eta 0:00:08
epoch [181/200] batch [10/38] time 0.244 (0.245) data 0.082 (0.085) loss_u loss_u 0.8906 (0.9633) acc_u 15.6250 (4.0625) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [15/38] time 0.248 (0.246) data 0.081 (0.084) loss_u loss_u 0.9150 (0.9591) acc_u 12.5000 (4.7917) lr 5.3915e-05 eta 0:00:05
epoch [181/200] batch [20/38] time 0.242 (0.246) data 0.083 (0.084) loss_u loss_u 0.9966 (0.9639) acc_u 0.0000 (4.2188) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [25/38] time 0.251 (0.247) data 0.083 (0.084) loss_u loss_u 0.9360 (0.9585) acc_u 6.2500 (4.8750) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [30/38] time 0.159 (0.245) data 0.081 (0.084) loss_u loss_u 0.9858 (0.9610) acc_u 3.1250 (4.5833) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [35/38] time 0.248 (0.245) data 0.084 (0.084) loss_u loss_u 0.9346 (0.9609) acc_u 9.3750 (4.6429) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.2389, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 386
clean true:350
clean false:36
clean_rate:0.9067357512953368
noisy true:631
noisy false:599
after delete: len(clean_dataset) 386
after delete: len(noisy_dataset) 1230
epoch [182/200] batch [5/12] time 0.247 (0.247) data 0.083 (0.084) loss_x loss_x 0.6143 (0.5281) acc_x 87.5000 (87.5000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/12] time 0.248 (0.247) data 0.082 (0.083) loss_x loss_x 0.3547 (0.5469) acc_x 93.7500 (87.5000) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/38] time 0.251 (0.238) data 0.083 (0.083) loss_u loss_u 0.9727 (0.9569) acc_u 3.1250 (5.0000) lr 4.8943e-05 eta 0:00:07
epoch [182/200] batch [10/38] time 0.249 (0.240) data 0.081 (0.083) loss_u loss_u 0.9648 (0.9606) acc_u 3.1250 (4.6875) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [15/38] time 0.250 (0.242) data 0.082 (0.083) loss_u loss_u 0.9487 (0.9632) acc_u 6.2500 (4.1667) lr 4.8943e-05 eta 0:00:05
epoch [182/200] batch [20/38] time 0.251 (0.243) data 0.082 (0.083) loss_u loss_u 0.9751 (0.9678) acc_u 3.1250 (3.7500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [25/38] time 0.250 (0.244) data 0.082 (0.083) loss_u loss_u 0.9663 (0.9689) acc_u 3.1250 (3.7500) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [30/38] time 0.184 (0.241) data 0.082 (0.083) loss_u loss_u 0.9531 (0.9688) acc_u 3.1250 (3.6458) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [35/38] time 0.239 (0.242) data 0.080 (0.083) loss_u loss_u 0.9727 (0.9691) acc_u 3.1250 (3.5714) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.2376, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 384
clean true:343
clean false:41
clean_rate:0.8932291666666666
noisy true:663
noisy false:569
after delete: len(clean_dataset) 384
after delete: len(noisy_dataset) 1232
epoch [183/200] batch [5/12] time 0.246 (0.242) data 0.085 (0.083) loss_x loss_x 0.3516 (0.5092) acc_x 93.7500 (89.3750) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/12] time 0.245 (0.245) data 0.085 (0.086) loss_x loss_x 0.4260 (0.5513) acc_x 90.6250 (90.0000) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/38] time 0.251 (0.236) data 0.082 (0.085) loss_u loss_u 0.9697 (0.9563) acc_u 3.1250 (4.3750) lr 4.4207e-05 eta 0:00:07
epoch [183/200] batch [10/38] time 0.259 (0.240) data 0.092 (0.085) loss_u loss_u 0.9990 (0.9567) acc_u 0.0000 (4.6875) lr 4.4207e-05 eta 0:00:06
epoch [183/200] batch [15/38] time 0.253 (0.241) data 0.090 (0.084) loss_u loss_u 0.9683 (0.9617) acc_u 3.1250 (4.1667) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [20/38] time 0.254 (0.243) data 0.086 (0.084) loss_u loss_u 0.9976 (0.9647) acc_u 0.0000 (3.7500) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [25/38] time 0.252 (0.243) data 0.085 (0.084) loss_u loss_u 0.9702 (0.9630) acc_u 3.1250 (4.0000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [30/38] time 0.248 (0.244) data 0.081 (0.084) loss_u loss_u 0.9780 (0.9639) acc_u 3.1250 (3.8542) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [35/38] time 0.248 (0.241) data 0.084 (0.084) loss_u loss_u 0.9033 (0.9632) acc_u 12.5000 (4.1071) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.2209, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 357
clean true:321
clean false:36
clean_rate:0.8991596638655462
noisy true:649
noisy false:610
after delete: len(clean_dataset) 357
after delete: len(noisy_dataset) 1259
epoch [184/200] batch [5/11] time 0.163 (0.162) data 0.082 (0.084) loss_x loss_x 0.6309 (0.6107) acc_x 87.5000 (86.8750) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [10/11] time 0.158 (0.161) data 0.082 (0.083) loss_x loss_x 0.4773 (0.5313) acc_x 90.6250 (87.5000) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/39] time 0.161 (0.161) data 0.083 (0.083) loss_u loss_u 0.9141 (0.9419) acc_u 9.3750 (6.8750) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [10/39] time 0.161 (0.160) data 0.083 (0.083) loss_u loss_u 0.9346 (0.9490) acc_u 6.2500 (5.3125) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/39] time 0.159 (0.160) data 0.081 (0.082) loss_u loss_u 0.9976 (0.9588) acc_u 0.0000 (4.1667) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/39] time 0.160 (0.160) data 0.082 (0.082) loss_u loss_u 0.9756 (0.9478) acc_u 3.1250 (5.6250) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [25/39] time 0.155 (0.160) data 0.078 (0.082) loss_u loss_u 0.9326 (0.9470) acc_u 9.3750 (5.8750) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [30/39] time 0.157 (0.159) data 0.080 (0.082) loss_u loss_u 0.9248 (0.9453) acc_u 9.3750 (6.3542) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [35/39] time 0.158 (0.160) data 0.081 (0.082) loss_u loss_u 0.9688 (0.9491) acc_u 3.1250 (5.8929) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 636
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:338
clean false:36
clean_rate:0.9037433155080213
noisy true:642
noisy false:600
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [185/200] batch [5/11] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.2129 (0.6232) acc_x 93.7500 (86.2500) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [10/11] time 0.158 (0.159) data 0.082 (0.082) loss_x loss_x 0.7798 (0.6373) acc_x 81.2500 (86.2500) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/38] time 0.161 (0.159) data 0.083 (0.082) loss_u loss_u 0.9390 (0.9734) acc_u 6.2500 (3.1250) lr 3.5443e-05 eta 0:00:05
epoch [185/200] batch [10/38] time 0.156 (0.158) data 0.080 (0.082) loss_u loss_u 0.9448 (0.9762) acc_u 6.2500 (2.5000) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/38] time 0.155 (0.158) data 0.078 (0.082) loss_u loss_u 0.9985 (0.9697) acc_u 0.0000 (3.3333) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/38] time 0.157 (0.158) data 0.081 (0.082) loss_u loss_u 0.9702 (0.9710) acc_u 3.1250 (3.2812) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/38] time 0.179 (0.160) data 0.101 (0.083) loss_u loss_u 0.9683 (0.9711) acc_u 3.1250 (3.2500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [30/38] time 0.157 (0.160) data 0.079 (0.083) loss_u loss_u 0.9370 (0.9678) acc_u 6.2500 (3.5417) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [35/38] time 0.158 (0.160) data 0.080 (0.083) loss_u loss_u 0.9360 (0.9652) acc_u 6.2500 (3.9286) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 368
clean true:334
clean false:34
clean_rate:0.907608695652174
noisy true:644
noisy false:604
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1248
epoch [186/200] batch [5/11] time 0.159 (0.158) data 0.082 (0.081) loss_x loss_x 0.2365 (0.3538) acc_x 96.8750 (92.5000) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [10/11] time 0.159 (0.159) data 0.083 (0.082) loss_x loss_x 0.5596 (0.4102) acc_x 87.5000 (91.5625) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/39] time 0.159 (0.159) data 0.082 (0.082) loss_u loss_u 0.9683 (0.9694) acc_u 3.1250 (5.0000) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [10/39] time 0.160 (0.159) data 0.082 (0.082) loss_u loss_u 0.9326 (0.9687) acc_u 6.2500 (4.0625) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/39] time 0.161 (0.159) data 0.083 (0.082) loss_u loss_u 0.9717 (0.9682) acc_u 3.1250 (4.1667) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/39] time 0.159 (0.159) data 0.082 (0.082) loss_u loss_u 0.9448 (0.9642) acc_u 6.2500 (4.5312) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [25/39] time 0.159 (0.159) data 0.081 (0.082) loss_u loss_u 0.9858 (0.9636) acc_u 3.1250 (4.6250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [30/39] time 0.158 (0.159) data 0.081 (0.082) loss_u loss_u 0.9575 (0.9585) acc_u 3.1250 (5.1042) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [35/39] time 0.158 (0.159) data 0.080 (0.082) loss_u loss_u 0.9399 (0.9574) acc_u 6.2500 (5.1786) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 630
confident_label rate tensor(0.2308, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 373
clean true:341
clean false:32
clean_rate:0.9142091152815014
noisy true:645
noisy false:598
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1243
epoch [187/200] batch [5/11] time 0.160 (0.159) data 0.083 (0.083) loss_x loss_x 0.6289 (0.4983) acc_x 87.5000 (89.3750) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [10/11] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.3916 (0.4370) acc_x 90.6250 (91.2500) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/38] time 0.159 (0.160) data 0.081 (0.083) loss_u loss_u 0.9678 (0.9592) acc_u 3.1250 (3.7500) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [10/38] time 0.160 (0.159) data 0.082 (0.082) loss_u loss_u 0.9385 (0.9568) acc_u 6.2500 (4.6875) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/38] time 0.159 (0.159) data 0.082 (0.082) loss_u loss_u 0.9478 (0.9600) acc_u 9.3750 (4.5833) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/38] time 0.157 (0.159) data 0.079 (0.082) loss_u loss_u 0.9443 (0.9577) acc_u 6.2500 (4.8438) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/38] time 0.162 (0.159) data 0.085 (0.082) loss_u loss_u 0.9922 (0.9629) acc_u 0.0000 (4.2500) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [30/38] time 0.159 (0.159) data 0.083 (0.082) loss_u loss_u 0.9419 (0.9624) acc_u 6.2500 (4.2708) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [35/38] time 0.158 (0.159) data 0.081 (0.082) loss_u loss_u 0.9727 (0.9624) acc_u 3.1250 (4.2857) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 628
confident_label rate tensor(0.2321, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 375
clean true:340
clean false:35
clean_rate:0.9066666666666666
noisy true:648
noisy false:593
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1241
epoch [188/200] batch [5/11] time 0.155 (0.158) data 0.078 (0.081) loss_x loss_x 0.3699 (0.3733) acc_x 87.5000 (92.5000) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [10/11] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.4805 (0.4644) acc_x 87.5000 (89.0625) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/38] time 0.158 (0.158) data 0.081 (0.081) loss_u loss_u 0.9648 (0.9624) acc_u 3.1250 (3.7500) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/38] time 0.157 (0.158) data 0.080 (0.081) loss_u loss_u 0.9917 (0.9699) acc_u 0.0000 (3.1250) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/38] time 0.158 (0.158) data 0.081 (0.081) loss_u loss_u 0.9604 (0.9685) acc_u 3.1250 (3.5417) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/38] time 0.160 (0.159) data 0.082 (0.082) loss_u loss_u 0.9780 (0.9691) acc_u 3.1250 (3.4375) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/38] time 0.159 (0.159) data 0.082 (0.082) loss_u loss_u 0.9409 (0.9659) acc_u 6.2500 (3.8750) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [30/38] time 0.160 (0.159) data 0.082 (0.082) loss_u loss_u 0.9438 (0.9663) acc_u 6.2500 (3.8542) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [35/38] time 0.180 (0.160) data 0.102 (0.083) loss_u loss_u 0.9507 (0.9631) acc_u 6.2500 (4.2857) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.2283, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 369
clean true:330
clean false:39
clean_rate:0.8943089430894309
noisy true:649
noisy false:598
after delete: len(clean_dataset) 369
after delete: len(noisy_dataset) 1247
epoch [189/200] batch [5/11] time 0.159 (0.160) data 0.082 (0.084) loss_x loss_x 0.6304 (0.6386) acc_x 84.3750 (84.3750) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [10/11] time 0.161 (0.161) data 0.085 (0.084) loss_x loss_x 0.2798 (0.5558) acc_x 96.8750 (87.1875) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/38] time 0.159 (0.161) data 0.082 (0.084) loss_u loss_u 0.9092 (0.9406) acc_u 9.3750 (7.5000) lr 2.0777e-05 eta 0:00:05
epoch [189/200] batch [10/38] time 0.168 (0.161) data 0.090 (0.084) loss_u loss_u 0.9287 (0.9553) acc_u 12.5000 (5.9375) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/38] time 0.162 (0.161) data 0.084 (0.084) loss_u loss_u 0.9409 (0.9537) acc_u 6.2500 (5.8333) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/38] time 0.162 (0.161) data 0.084 (0.083) loss_u loss_u 0.9995 (0.9599) acc_u 0.0000 (5.1562) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/38] time 0.160 (0.161) data 0.082 (0.084) loss_u loss_u 0.9238 (0.9580) acc_u 6.2500 (5.1250) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [30/38] time 0.159 (0.161) data 0.081 (0.083) loss_u loss_u 0.9360 (0.9602) acc_u 6.2500 (4.7917) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [35/38] time 0.160 (0.161) data 0.082 (0.083) loss_u loss_u 0.9683 (0.9594) acc_u 3.1250 (4.8214) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.2302, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 372
clean true:338
clean false:34
clean_rate:0.9086021505376344
noisy true:673
noisy false:571
after delete: len(clean_dataset) 372
after delete: len(noisy_dataset) 1244
epoch [190/200] batch [5/11] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.4622 (0.4281) acc_x 87.5000 (90.0000) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [10/11] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.1805 (0.4390) acc_x 96.8750 (90.3125) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/38] time 0.157 (0.157) data 0.080 (0.079) loss_u loss_u 0.9990 (0.9714) acc_u 0.0000 (2.5000) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [10/38] time 0.158 (0.157) data 0.080 (0.080) loss_u loss_u 0.9790 (0.9617) acc_u 3.1250 (3.7500) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/38] time 0.159 (0.158) data 0.081 (0.081) loss_u loss_u 0.9878 (0.9675) acc_u 0.0000 (3.1250) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/38] time 0.160 (0.158) data 0.082 (0.081) loss_u loss_u 0.9351 (0.9645) acc_u 6.2500 (3.4375) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/38] time 0.162 (0.158) data 0.085 (0.081) loss_u loss_u 0.9995 (0.9654) acc_u 0.0000 (3.3750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [30/38] time 0.167 (0.159) data 0.090 (0.081) loss_u loss_u 0.9492 (0.9657) acc_u 6.2500 (3.5417) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [35/38] time 0.160 (0.159) data 0.082 (0.081) loss_u loss_u 0.9365 (0.9633) acc_u 6.2500 (3.7500) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 620
confident_label rate tensor(0.2308, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 373
clean true:340
clean false:33
clean_rate:0.9115281501340483
noisy true:656
noisy false:587
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1243
epoch [191/200] batch [5/11] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.5938 (0.4708) acc_x 84.3750 (88.7500) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [10/11] time 0.155 (0.157) data 0.078 (0.080) loss_x loss_x 0.6211 (0.5980) acc_x 87.5000 (87.1875) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/38] time 0.158 (0.157) data 0.080 (0.080) loss_u loss_u 0.9985 (0.9561) acc_u 0.0000 (5.6250) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [10/38] time 0.160 (0.158) data 0.082 (0.080) loss_u loss_u 0.9429 (0.9468) acc_u 9.3750 (6.2500) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/38] time 0.161 (0.158) data 0.083 (0.080) loss_u loss_u 0.9907 (0.9525) acc_u 0.0000 (5.6250) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/38] time 0.165 (0.159) data 0.088 (0.081) loss_u loss_u 0.9565 (0.9504) acc_u 3.1250 (5.6250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/38] time 0.159 (0.159) data 0.081 (0.081) loss_u loss_u 0.9697 (0.9566) acc_u 3.1250 (4.8750) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [30/38] time 0.158 (0.159) data 0.081 (0.081) loss_u loss_u 0.9932 (0.9629) acc_u 3.1250 (4.1667) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [35/38] time 0.160 (0.159) data 0.082 (0.081) loss_u loss_u 0.9385 (0.9614) acc_u 6.2500 (4.3750) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 635
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 368
clean true:330
clean false:38
clean_rate:0.8967391304347826
noisy true:651
noisy false:597
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1248
epoch [192/200] batch [5/11] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.5972 (0.6108) acc_x 87.5000 (85.6250) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [10/11] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.8169 (0.6321) acc_x 84.3750 (85.6250) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/39] time 0.157 (0.159) data 0.079 (0.082) loss_u loss_u 0.9683 (0.9680) acc_u 3.1250 (3.1250) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [10/39] time 0.156 (0.159) data 0.079 (0.082) loss_u loss_u 0.9717 (0.9617) acc_u 6.2500 (4.6875) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/39] time 0.156 (0.159) data 0.079 (0.082) loss_u loss_u 0.9917 (0.9636) acc_u 0.0000 (3.9583) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/39] time 0.158 (0.159) data 0.080 (0.082) loss_u loss_u 0.9102 (0.9596) acc_u 9.3750 (4.3750) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [25/39] time 0.159 (0.159) data 0.082 (0.082) loss_u loss_u 0.9429 (0.9551) acc_u 6.2500 (4.8750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [30/39] time 0.160 (0.159) data 0.082 (0.082) loss_u loss_u 0.9453 (0.9531) acc_u 6.2500 (5.1042) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [35/39] time 0.160 (0.159) data 0.082 (0.082) loss_u loss_u 0.9678 (0.9539) acc_u 3.1250 (5.0000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 626
confident_label rate tensor(0.2314, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 374
clean true:344
clean false:30
clean_rate:0.9197860962566845
noisy true:646
noisy false:596
after delete: len(clean_dataset) 374
after delete: len(noisy_dataset) 1242
epoch [193/200] batch [5/11] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.5298 (0.5099) acc_x 87.5000 (88.7500) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [10/11] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.5381 (0.5047) acc_x 90.6250 (90.0000) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/38] time 0.158 (0.159) data 0.080 (0.081) loss_u loss_u 0.9102 (0.9570) acc_u 9.3750 (4.3750) lr 9.9763e-06 eta 0:00:05
epoch [193/200] batch [10/38] time 0.160 (0.158) data 0.082 (0.081) loss_u loss_u 0.8418 (0.9456) acc_u 18.7500 (6.2500) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [15/38] time 0.161 (0.159) data 0.083 (0.081) loss_u loss_u 0.9673 (0.9498) acc_u 3.1250 (5.6250) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/38] time 0.159 (0.159) data 0.081 (0.081) loss_u loss_u 0.9126 (0.9520) acc_u 9.3750 (5.3125) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/38] time 0.158 (0.159) data 0.080 (0.081) loss_u loss_u 0.9473 (0.9542) acc_u 6.2500 (5.0000) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [30/38] time 0.159 (0.159) data 0.082 (0.081) loss_u loss_u 0.9375 (0.9560) acc_u 6.2500 (4.7917) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [35/38] time 0.160 (0.159) data 0.082 (0.081) loss_u loss_u 0.9937 (0.9583) acc_u 0.0000 (4.5536) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 619
confident_label rate tensor(0.2321, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 375
clean true:343
clean false:32
clean_rate:0.9146666666666666
noisy true:654
noisy false:587
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1241
epoch [194/200] batch [5/11] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.5220 (0.5152) acc_x 78.1250 (86.2500) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [10/11] time 0.158 (0.159) data 0.081 (0.081) loss_x loss_x 0.2310 (0.5033) acc_x 96.8750 (88.7500) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/38] time 0.157 (0.158) data 0.079 (0.081) loss_u loss_u 0.9707 (0.9793) acc_u 3.1250 (2.5000) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [10/38] time 0.158 (0.158) data 0.080 (0.081) loss_u loss_u 0.9966 (0.9785) acc_u 0.0000 (2.5000) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/38] time 0.164 (0.159) data 0.086 (0.081) loss_u loss_u 0.9395 (0.9711) acc_u 6.2500 (3.5417) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [20/38] time 0.158 (0.159) data 0.081 (0.081) loss_u loss_u 0.9985 (0.9673) acc_u 0.0000 (3.9062) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/38] time 0.160 (0.159) data 0.082 (0.081) loss_u loss_u 0.9512 (0.9685) acc_u 6.2500 (3.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [30/38] time 0.157 (0.159) data 0.079 (0.081) loss_u loss_u 0.9414 (0.9667) acc_u 6.2500 (3.9583) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [35/38] time 0.159 (0.159) data 0.081 (0.081) loss_u loss_u 0.9414 (0.9641) acc_u 9.3750 (4.3750) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 647
confident_label rate tensor(0.2296, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 371
clean true:334
clean false:37
clean_rate:0.9002695417789758
noisy true:635
noisy false:610
after delete: len(clean_dataset) 371
after delete: len(noisy_dataset) 1245
epoch [195/200] batch [5/11] time 0.157 (0.157) data 0.080 (0.081) loss_x loss_x 0.4534 (0.5253) acc_x 90.6250 (88.7500) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [10/11] time 0.155 (0.159) data 0.078 (0.082) loss_x loss_x 0.5259 (0.5304) acc_x 81.2500 (87.8125) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/38] time 0.158 (0.158) data 0.080 (0.081) loss_u loss_u 0.9995 (0.9680) acc_u 0.0000 (3.7500) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/38] time 0.157 (0.157) data 0.079 (0.080) loss_u loss_u 0.9697 (0.9615) acc_u 3.1250 (4.6875) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/38] time 0.157 (0.158) data 0.079 (0.080) loss_u loss_u 0.9438 (0.9579) acc_u 6.2500 (5.0000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/38] time 0.160 (0.158) data 0.083 (0.081) loss_u loss_u 0.9443 (0.9573) acc_u 6.2500 (4.8438) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/38] time 0.160 (0.158) data 0.082 (0.081) loss_u loss_u 0.9004 (0.9563) acc_u 12.5000 (5.0000) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [30/38] time 0.162 (0.159) data 0.084 (0.081) loss_u loss_u 0.9990 (0.9580) acc_u 0.0000 (4.7917) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [35/38] time 0.160 (0.159) data 0.082 (0.081) loss_u loss_u 0.9414 (0.9573) acc_u 6.2500 (4.9107) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.2327, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 376
clean true:340
clean false:36
clean_rate:0.9042553191489362
noisy true:659
noisy false:581
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1240
epoch [196/200] batch [5/11] time 0.159 (0.158) data 0.082 (0.081) loss_x loss_x 0.6182 (0.4448) acc_x 78.1250 (86.8750) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [10/11] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.6338 (0.5304) acc_x 81.2500 (85.3125) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/38] time 0.155 (0.158) data 0.078 (0.081) loss_u loss_u 0.9932 (0.9607) acc_u 3.1250 (5.0000) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [10/38] time 0.156 (0.158) data 0.079 (0.081) loss_u loss_u 0.9663 (0.9668) acc_u 3.1250 (4.0625) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/38] time 0.157 (0.158) data 0.080 (0.080) loss_u loss_u 0.9302 (0.9687) acc_u 9.3750 (3.7500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/38] time 0.156 (0.157) data 0.079 (0.080) loss_u loss_u 0.9453 (0.9667) acc_u 6.2500 (3.7500) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/38] time 0.156 (0.157) data 0.078 (0.080) loss_u loss_u 0.9980 (0.9694) acc_u 0.0000 (3.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [30/38] time 0.155 (0.157) data 0.077 (0.080) loss_u loss_u 0.9072 (0.9677) acc_u 9.3750 (3.5417) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [35/38] time 0.154 (0.157) data 0.077 (0.079) loss_u loss_u 0.8774 (0.9639) acc_u 15.6250 (4.0179) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.2321, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 375
clean true:342
clean false:33
clean_rate:0.912
noisy true:650
noisy false:591
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1241
epoch [197/200] batch [5/11] time 0.153 (0.155) data 0.076 (0.078) loss_x loss_x 0.6577 (0.4671) acc_x 87.5000 (89.3750) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [10/11] time 0.154 (0.155) data 0.077 (0.078) loss_x loss_x 0.5737 (0.5558) acc_x 84.3750 (85.9375) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/38] time 0.154 (0.156) data 0.077 (0.078) loss_u loss_u 0.9863 (0.9404) acc_u 3.1250 (7.5000) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/38] time 0.156 (0.156) data 0.078 (0.078) loss_u loss_u 0.9707 (0.9463) acc_u 3.1250 (6.2500) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/38] time 0.156 (0.155) data 0.079 (0.078) loss_u loss_u 0.9990 (0.9606) acc_u 0.0000 (4.5833) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/38] time 0.155 (0.156) data 0.077 (0.078) loss_u loss_u 0.9863 (0.9638) acc_u 0.0000 (4.0625) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/38] time 0.154 (0.157) data 0.077 (0.080) loss_u loss_u 0.8994 (0.9575) acc_u 9.3750 (4.7500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [30/38] time 0.155 (0.157) data 0.077 (0.079) loss_u loss_u 0.9995 (0.9621) acc_u 0.0000 (4.2708) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [35/38] time 0.156 (0.157) data 0.078 (0.079) loss_u loss_u 0.9697 (0.9626) acc_u 3.1250 (4.1071) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 619
confident_label rate tensor(0.2290, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 370
clean true:340
clean false:30
clean_rate:0.918918918918919
noisy true:657
noisy false:589
after delete: len(clean_dataset) 370
after delete: len(noisy_dataset) 1246
epoch [198/200] batch [5/11] time 0.154 (0.154) data 0.077 (0.078) loss_x loss_x 0.5098 (0.4563) acc_x 90.6250 (89.3750) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [10/11] time 0.155 (0.155) data 0.078 (0.079) loss_x loss_x 0.2491 (0.4633) acc_x 90.6250 (89.3750) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/38] time 0.154 (0.155) data 0.076 (0.078) loss_u loss_u 0.9375 (0.9449) acc_u 6.2500 (5.6250) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [10/38] time 0.152 (0.155) data 0.075 (0.078) loss_u loss_u 0.9297 (0.9473) acc_u 9.3750 (5.6250) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/38] time 0.163 (0.155) data 0.085 (0.078) loss_u loss_u 0.9946 (0.9563) acc_u 0.0000 (4.5833) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/38] time 0.153 (0.155) data 0.076 (0.078) loss_u loss_u 0.9604 (0.9562) acc_u 9.3750 (4.8438) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/38] time 0.155 (0.155) data 0.077 (0.078) loss_u loss_u 0.9897 (0.9613) acc_u 3.1250 (4.3750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [30/38] time 0.155 (0.155) data 0.078 (0.078) loss_u loss_u 0.9819 (0.9596) acc_u 6.2500 (4.7917) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [35/38] time 0.156 (0.155) data 0.078 (0.078) loss_u loss_u 0.9395 (0.9620) acc_u 6.2500 (4.4643) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.2178, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 352
clean true:321
clean false:31
clean_rate:0.9119318181818182
noisy true:672
noisy false:592
after delete: len(clean_dataset) 352
after delete: len(noisy_dataset) 1264
epoch [199/200] batch [5/11] time 0.155 (0.156) data 0.079 (0.079) loss_x loss_x 0.7241 (0.5531) acc_x 75.0000 (83.1250) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [10/11] time 0.157 (0.155) data 0.080 (0.078) loss_x loss_x 0.5566 (0.5398) acc_x 87.5000 (85.6250) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/39] time 0.157 (0.155) data 0.080 (0.078) loss_u loss_u 0.9434 (0.9350) acc_u 9.3750 (8.1250) lr 1.1101e-06 eta 0:00:05
epoch [199/200] batch [10/39] time 0.156 (0.155) data 0.078 (0.078) loss_u loss_u 0.9243 (0.9354) acc_u 9.3750 (7.8125) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/39] time 0.180 (0.156) data 0.102 (0.079) loss_u loss_u 0.9570 (0.9439) acc_u 6.2500 (6.6667) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [20/39] time 0.156 (0.157) data 0.078 (0.080) loss_u loss_u 0.8896 (0.9483) acc_u 12.5000 (6.0938) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/39] time 0.168 (0.158) data 0.090 (0.080) loss_u loss_u 0.9404 (0.9480) acc_u 6.2500 (6.0000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [30/39] time 0.166 (0.159) data 0.087 (0.081) loss_u loss_u 0.9717 (0.9467) acc_u 3.1250 (6.1458) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [35/39] time 0.159 (0.159) data 0.081 (0.081) loss_u loss_u 0.9697 (0.9460) acc_u 3.1250 (6.1607) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 614
confident_label rate tensor(0.2271, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 367
clean true:330
clean false:37
clean_rate:0.8991825613079019
noisy true:672
noisy false:577
after delete: len(clean_dataset) 367
after delete: len(noisy_dataset) 1249
epoch [200/200] batch [5/11] time 0.155 (0.156) data 0.079 (0.079) loss_x loss_x 0.2939 (0.4156) acc_x 90.6250 (89.3750) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [10/11] time 0.157 (0.156) data 0.080 (0.079) loss_x loss_x 0.2003 (0.4949) acc_x 96.8750 (87.8125) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/39] time 0.155 (0.156) data 0.078 (0.079) loss_u loss_u 0.9683 (0.9671) acc_u 3.1250 (3.1250) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [10/39] time 0.155 (0.156) data 0.077 (0.079) loss_u loss_u 0.9341 (0.9649) acc_u 6.2500 (3.4375) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/39] time 0.157 (0.156) data 0.079 (0.079) loss_u loss_u 0.9521 (0.9664) acc_u 6.2500 (3.5417) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/39] time 0.155 (0.156) data 0.078 (0.079) loss_u loss_u 0.9678 (0.9662) acc_u 3.1250 (3.5938) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/39] time 0.156 (0.156) data 0.078 (0.078) loss_u loss_u 0.9912 (0.9698) acc_u 0.0000 (3.2500) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [30/39] time 0.156 (0.156) data 0.078 (0.078) loss_u loss_u 0.9629 (0.9650) acc_u 6.2500 (3.9583) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [35/39] time 0.152 (0.156) data 0.075 (0.078) loss_u loss_u 0.9863 (0.9614) acc_u 3.1250 (4.3750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,289
* accuracy: 60.5%
* error: 39.5%
* macro_f1: 58.3%
Elapsed: 1:17:59
