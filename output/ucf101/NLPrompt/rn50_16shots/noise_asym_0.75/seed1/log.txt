***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.75', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.75
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.0965, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 156
clean true:124
clean false:32
clean_rate:0.7948717948717948
noisy true:388
noisy false:1072
after delete: len(clean_dataset) 156
after delete: len(noisy_dataset) 1460
epoch [1/200] batch [1/4] time 0.304 (0.304) data 0.114 (0.114) loss_x loss_x 2.5898 (2.5898) acc_x 43.7500 (43.7500) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [2/4] time 0.189 (0.246) data 0.111 (0.113) loss_x loss_x 2.9434 (2.7666) acc_x 50.0000 (46.8750) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [3/4] time 0.169 (0.221) data 0.093 (0.106) loss_x loss_x 2.3555 (2.6296) acc_x 53.1250 (48.9583) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [4/4] time 0.169 (0.208) data 0.092 (0.102) loss_x loss_x 2.8594 (2.6870) acc_x 40.6250 (46.8750) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/45] time 0.192 (0.196) data 0.116 (0.104) loss_u loss_u 0.9795 (0.9825) acc_u 0.0000 (2.5000) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [10/45] time 0.179 (0.194) data 0.100 (0.107) loss_u loss_u 0.9800 (0.9785) acc_u 0.0000 (3.4375) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [15/45] time 0.184 (0.188) data 0.105 (0.104) loss_u loss_u 0.9604 (0.9774) acc_u 6.2500 (4.1667) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [20/45] time 0.181 (0.186) data 0.102 (0.104) loss_u loss_u 0.9746 (0.9780) acc_u 0.0000 (3.7500) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [25/45] time 0.186 (0.186) data 0.108 (0.104) loss_u loss_u 0.9648 (0.9765) acc_u 6.2500 (4.5000) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [30/45] time 0.173 (0.185) data 0.096 (0.104) loss_u loss_u 0.9561 (0.9766) acc_u 15.6250 (4.8958) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [35/45] time 0.183 (0.185) data 0.105 (0.104) loss_u loss_u 0.9795 (0.9771) acc_u 3.1250 (4.5536) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [40/45] time 0.180 (0.185) data 0.103 (0.105) loss_u loss_u 0.9829 (0.9764) acc_u 3.1250 (4.7656) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [45/45] time 0.188 (0.184) data 0.111 (0.104) loss_u loss_u 0.9731 (0.9765) acc_u 3.1250 (4.7222) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1044
confident_label rate tensor(0.1046, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 169
clean true:145
clean false:24
clean_rate:0.8579881656804734
noisy true:427
noisy false:1020
after delete: len(clean_dataset) 169
after delete: len(noisy_dataset) 1447
epoch [2/200] batch [5/5] time 0.189 (0.184) data 0.113 (0.108) loss_x loss_x 1.1025 (1.5875) acc_x 71.8750 (64.3750) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/45] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.9087 (0.9169) acc_u 12.5000 (11.8750) lr 2.0000e-03 eta 0:00:07
epoch [2/200] batch [10/45] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.9849 (0.9325) acc_u 0.0000 (9.0625) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [15/45] time 0.175 (0.180) data 0.098 (0.103) loss_u loss_u 0.9126 (0.9363) acc_u 15.6250 (8.3333) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [20/45] time 0.191 (0.180) data 0.114 (0.102) loss_u loss_u 0.9814 (0.9438) acc_u 6.2500 (7.6562) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [25/45] time 0.170 (0.180) data 0.091 (0.103) loss_u loss_u 0.9785 (0.9370) acc_u 3.1250 (8.3750) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [30/45] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8799 (0.9365) acc_u 18.7500 (8.7500) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [35/45] time 0.181 (0.183) data 0.103 (0.105) loss_u loss_u 0.9512 (0.9358) acc_u 6.2500 (8.6607) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [40/45] time 0.192 (0.184) data 0.115 (0.106) loss_u loss_u 0.8228 (0.9343) acc_u 21.8750 (9.1406) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [45/45] time 0.180 (0.184) data 0.103 (0.106) loss_u loss_u 0.9199 (0.9354) acc_u 15.6250 (8.9583) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 844
confident_label rate tensor(0.1374, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 222
clean true:195
clean false:27
clean_rate:0.8783783783783784
noisy true:577
noisy false:817
after delete: len(clean_dataset) 222
after delete: len(noisy_dataset) 1394
epoch [3/200] batch [5/6] time 0.173 (0.172) data 0.097 (0.095) loss_x loss_x 0.6597 (1.0883) acc_x 78.1250 (70.0000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/43] time 0.178 (0.175) data 0.100 (0.098) loss_u loss_u 0.9409 (0.9463) acc_u 9.3750 (6.8750) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [10/43] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.9570 (0.9482) acc_u 3.1250 (5.9375) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [15/43] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9517 (0.9472) acc_u 9.3750 (6.4583) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [20/43] time 0.180 (0.178) data 0.102 (0.101) loss_u loss_u 0.9448 (0.9498) acc_u 6.2500 (5.9375) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [25/43] time 0.184 (0.179) data 0.106 (0.101) loss_u loss_u 0.9663 (0.9480) acc_u 3.1250 (6.1250) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [30/43] time 0.180 (0.180) data 0.102 (0.103) loss_u loss_u 0.9297 (0.9482) acc_u 9.3750 (6.0417) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [35/43] time 0.186 (0.181) data 0.108 (0.103) loss_u loss_u 0.9580 (0.9473) acc_u 3.1250 (6.0714) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [40/43] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.9707 (0.9453) acc_u 3.1250 (6.2500) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 840
confident_label rate tensor(0.1658, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 268
clean true:228
clean false:40
clean_rate:0.8507462686567164
noisy true:548
noisy false:800
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 1348
epoch [4/200] batch [5/8] time 0.174 (0.168) data 0.097 (0.091) loss_x loss_x 0.8945 (1.2269) acc_x 81.2500 (65.6250) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/42] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.9858 (0.9602) acc_u 0.0000 (3.7500) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [10/42] time 0.173 (0.173) data 0.094 (0.096) loss_u loss_u 0.9634 (0.9629) acc_u 9.3750 (4.6875) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [15/42] time 0.169 (0.173) data 0.091 (0.095) loss_u loss_u 0.9927 (0.9664) acc_u 0.0000 (4.5833) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [20/42] time 0.183 (0.173) data 0.106 (0.095) loss_u loss_u 0.9160 (0.9610) acc_u 9.3750 (4.6875) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [25/42] time 0.160 (0.174) data 0.084 (0.096) loss_u loss_u 0.9067 (0.9564) acc_u 12.5000 (5.3750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [30/42] time 0.167 (0.172) data 0.088 (0.095) loss_u loss_u 0.9419 (0.9575) acc_u 9.3750 (5.2083) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [35/42] time 0.182 (0.173) data 0.104 (0.095) loss_u loss_u 0.9219 (0.9537) acc_u 9.3750 (5.4464) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [40/42] time 0.195 (0.174) data 0.118 (0.096) loss_u loss_u 0.9307 (0.9536) acc_u 9.3750 (5.4688) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 872
confident_label rate tensor(0.1473, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 238
clean true:204
clean false:34
clean_rate:0.8571428571428571
noisy true:540
noisy false:838
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 1378
epoch [5/200] batch [5/7] time 0.180 (0.186) data 0.103 (0.109) loss_x loss_x 0.9443 (0.9459) acc_x 78.1250 (78.1250) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/43] time 0.180 (0.183) data 0.100 (0.106) loss_u loss_u 0.9751 (0.9719) acc_u 0.0000 (3.1250) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [10/43] time 0.165 (0.178) data 0.088 (0.101) loss_u loss_u 0.9409 (0.9621) acc_u 6.2500 (4.3750) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [15/43] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.9692 (0.9530) acc_u 3.1250 (5.6250) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [20/43] time 0.184 (0.175) data 0.105 (0.097) loss_u loss_u 0.9639 (0.9503) acc_u 0.0000 (5.6250) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [25/43] time 0.166 (0.174) data 0.089 (0.097) loss_u loss_u 0.9478 (0.9520) acc_u 6.2500 (5.6250) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [30/43] time 0.159 (0.173) data 0.081 (0.095) loss_u loss_u 0.8848 (0.9455) acc_u 12.5000 (6.5625) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [35/43] time 0.165 (0.171) data 0.087 (0.094) loss_u loss_u 0.9453 (0.9449) acc_u 3.1250 (6.6071) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [40/43] time 0.167 (0.171) data 0.089 (0.093) loss_u loss_u 0.9546 (0.9429) acc_u 3.1250 (6.7969) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 847
confident_label rate tensor(0.1621, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 262
clean true:209
clean false:53
clean_rate:0.7977099236641222
noisy true:560
noisy false:794
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 1354
epoch [6/200] batch [5/8] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.9814 (1.1380) acc_x 75.0000 (74.3750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/42] time 0.184 (0.186) data 0.106 (0.109) loss_u loss_u 0.9219 (0.9491) acc_u 9.3750 (6.2500) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [10/42] time 0.182 (0.186) data 0.104 (0.108) loss_u loss_u 0.9663 (0.9444) acc_u 3.1250 (6.2500) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [15/42] time 0.189 (0.187) data 0.111 (0.109) loss_u loss_u 0.9907 (0.9402) acc_u 0.0000 (7.0833) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [20/42] time 0.188 (0.187) data 0.109 (0.109) loss_u loss_u 0.9126 (0.9355) acc_u 12.5000 (7.8125) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [25/42] time 0.180 (0.185) data 0.103 (0.108) loss_u loss_u 0.9512 (0.9338) acc_u 9.3750 (8.0000) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [30/42] time 0.217 (0.186) data 0.140 (0.108) loss_u loss_u 0.9443 (0.9338) acc_u 6.2500 (8.0208) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [35/42] time 0.179 (0.185) data 0.101 (0.108) loss_u loss_u 0.9390 (0.9346) acc_u 6.2500 (7.8571) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [40/42] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.9917 (0.9359) acc_u 0.0000 (7.7344) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 828
confident_label rate tensor(0.1621, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 262
clean true:212
clean false:50
clean_rate:0.8091603053435115
noisy true:576
noisy false:778
after delete: len(clean_dataset) 262
after delete: len(noisy_dataset) 1354
epoch [7/200] batch [5/8] time 0.180 (0.185) data 0.103 (0.108) loss_x loss_x 1.4668 (0.9954) acc_x 75.0000 (77.5000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/42] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9873 (0.9387) acc_u 3.1250 (8.1250) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [10/42] time 0.166 (0.183) data 0.088 (0.106) loss_u loss_u 0.9331 (0.9361) acc_u 6.2500 (7.8125) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [15/42] time 0.173 (0.180) data 0.096 (0.103) loss_u loss_u 0.9399 (0.9379) acc_u 6.2500 (7.9167) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [20/42] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9624 (0.9381) acc_u 6.2500 (7.5000) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [25/42] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.9219 (0.9386) acc_u 9.3750 (7.1250) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [30/42] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.8892 (0.9367) acc_u 18.7500 (7.5000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [35/42] time 0.168 (0.180) data 0.091 (0.102) loss_u loss_u 0.9541 (0.9383) acc_u 3.1250 (7.3214) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [40/42] time 0.180 (0.179) data 0.102 (0.101) loss_u loss_u 0.9346 (0.9376) acc_u 9.3750 (7.4219) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 828
confident_label rate tensor(0.1615, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 261
clean true:205
clean false:56
clean_rate:0.7854406130268199
noisy true:583
noisy false:772
after delete: len(clean_dataset) 261
after delete: len(noisy_dataset) 1355
epoch [8/200] batch [5/8] time 0.170 (0.172) data 0.093 (0.096) loss_x loss_x 0.6973 (1.0850) acc_x 75.0000 (71.8750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/42] time 0.166 (0.168) data 0.089 (0.091) loss_u loss_u 0.9409 (0.9283) acc_u 3.1250 (8.1250) lr 1.9956e-03 eta 0:00:06
epoch [8/200] batch [10/42] time 0.174 (0.172) data 0.096 (0.095) loss_u loss_u 0.8960 (0.9275) acc_u 15.6250 (8.7500) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [15/42] time 0.181 (0.173) data 0.104 (0.096) loss_u loss_u 0.9219 (0.9295) acc_u 9.3750 (8.7500) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [20/42] time 0.183 (0.173) data 0.105 (0.096) loss_u loss_u 0.9043 (0.9303) acc_u 12.5000 (8.5938) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [25/42] time 0.174 (0.174) data 0.097 (0.096) loss_u loss_u 0.9424 (0.9328) acc_u 3.1250 (8.3750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [30/42] time 0.172 (0.174) data 0.095 (0.097) loss_u loss_u 0.9365 (0.9310) acc_u 9.3750 (8.4375) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [35/42] time 0.201 (0.175) data 0.124 (0.098) loss_u loss_u 0.9746 (0.9337) acc_u 3.1250 (7.9464) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [40/42] time 0.161 (0.175) data 0.084 (0.098) loss_u loss_u 0.9272 (0.9336) acc_u 9.3750 (7.9688) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 843
confident_label rate tensor(0.1658, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 268
clean true:204
clean false:64
clean_rate:0.7611940298507462
noisy true:569
noisy false:779
after delete: len(clean_dataset) 268
after delete: len(noisy_dataset) 1348
epoch [9/200] batch [5/8] time 0.162 (0.170) data 0.085 (0.093) loss_x loss_x 1.6484 (1.0958) acc_x 68.7500 (74.3750) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/42] time 0.182 (0.171) data 0.104 (0.094) loss_u loss_u 0.9561 (0.9241) acc_u 6.2500 (10.0000) lr 1.9940e-03 eta 0:00:06
epoch [9/200] batch [10/42] time 0.181 (0.174) data 0.103 (0.097) loss_u loss_u 0.9233 (0.9278) acc_u 12.5000 (9.6875) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [15/42] time 0.178 (0.175) data 0.100 (0.098) loss_u loss_u 0.9224 (0.9192) acc_u 6.2500 (10.0000) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [20/42] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.9272 (0.9251) acc_u 6.2500 (9.2188) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [25/42] time 0.173 (0.176) data 0.095 (0.098) loss_u loss_u 0.8823 (0.9293) acc_u 15.6250 (8.7500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [30/42] time 0.165 (0.176) data 0.088 (0.099) loss_u loss_u 0.9673 (0.9300) acc_u 3.1250 (8.4375) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [35/42] time 0.190 (0.177) data 0.113 (0.099) loss_u loss_u 0.9639 (0.9348) acc_u 3.1250 (8.0357) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [40/42] time 0.176 (0.177) data 0.099 (0.099) loss_u loss_u 0.9326 (0.9355) acc_u 6.2500 (7.7344) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 875
confident_label rate tensor(0.1751, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 283
clean true:206
clean false:77
clean_rate:0.7279151943462897
noisy true:535
noisy false:798
after delete: len(clean_dataset) 283
after delete: len(noisy_dataset) 1333
epoch [10/200] batch [5/8] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 1.2129 (1.1091) acc_x 75.0000 (75.0000) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/41] time 0.174 (0.176) data 0.096 (0.098) loss_u loss_u 0.9282 (0.9287) acc_u 6.2500 (8.1250) lr 1.9921e-03 eta 0:00:06
epoch [10/200] batch [10/41] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9189 (0.9284) acc_u 9.3750 (8.4375) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [15/41] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.9688 (0.9264) acc_u 3.1250 (8.9583) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [20/41] time 0.181 (0.179) data 0.102 (0.102) loss_u loss_u 0.9219 (0.9313) acc_u 6.2500 (8.2812) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [25/41] time 0.172 (0.178) data 0.093 (0.101) loss_u loss_u 0.9707 (0.9373) acc_u 3.1250 (7.3750) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [30/41] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.9297 (0.9367) acc_u 6.2500 (7.1875) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [35/41] time 0.174 (0.178) data 0.097 (0.101) loss_u loss_u 0.9448 (0.9374) acc_u 9.3750 (7.3214) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [40/41] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.9556 (0.9369) acc_u 9.3750 (7.3438) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 838
confident_label rate tensor(0.1844, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 298
clean true:223
clean false:75
clean_rate:0.7483221476510067
noisy true:555
noisy false:763
after delete: len(clean_dataset) 298
after delete: len(noisy_dataset) 1318
epoch [11/200] batch [5/9] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 0.8706 (1.0821) acc_x 75.0000 (68.7500) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/41] time 0.181 (0.179) data 0.104 (0.101) loss_u loss_u 0.9844 (0.9306) acc_u 0.0000 (7.5000) lr 1.9900e-03 eta 0:00:06
epoch [11/200] batch [10/41] time 0.184 (0.180) data 0.106 (0.102) loss_u loss_u 0.9243 (0.9246) acc_u 9.3750 (8.7500) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [15/41] time 0.174 (0.180) data 0.096 (0.103) loss_u loss_u 0.9863 (0.9322) acc_u 3.1250 (7.7083) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [20/41] time 0.162 (0.178) data 0.085 (0.100) loss_u loss_u 0.9658 (0.9335) acc_u 3.1250 (7.6562) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [25/41] time 0.173 (0.177) data 0.095 (0.099) loss_u loss_u 0.9243 (0.9358) acc_u 9.3750 (7.7500) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [30/41] time 0.183 (0.178) data 0.106 (0.100) loss_u loss_u 0.9595 (0.9397) acc_u 9.3750 (7.3958) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [35/41] time 0.172 (0.178) data 0.094 (0.100) loss_u loss_u 0.8994 (0.9386) acc_u 9.3750 (7.4107) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [40/41] time 0.162 (0.176) data 0.085 (0.099) loss_u loss_u 0.9600 (0.9379) acc_u 3.1250 (7.1875) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 870
confident_label rate tensor(0.1776, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 287
clean true:204
clean false:83
clean_rate:0.710801393728223
noisy true:542
noisy false:787
after delete: len(clean_dataset) 287
after delete: len(noisy_dataset) 1329
epoch [12/200] batch [5/8] time 0.179 (0.196) data 0.102 (0.119) loss_x loss_x 0.8608 (0.9349) acc_x 84.3750 (79.3750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/41] time 0.166 (0.180) data 0.088 (0.103) loss_u loss_u 0.8994 (0.9122) acc_u 9.3750 (10.6250) lr 1.9877e-03 eta 0:00:06
epoch [12/200] batch [10/41] time 0.168 (0.177) data 0.089 (0.100) loss_u loss_u 0.9268 (0.9137) acc_u 9.3750 (10.9375) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [15/41] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9619 (0.9299) acc_u 6.2500 (8.7500) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [20/41] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.9092 (0.9209) acc_u 12.5000 (10.0000) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [25/41] time 0.204 (0.180) data 0.127 (0.103) loss_u loss_u 0.9199 (0.9246) acc_u 12.5000 (9.7500) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [30/41] time 0.182 (0.180) data 0.105 (0.102) loss_u loss_u 0.9766 (0.9276) acc_u 6.2500 (9.5833) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [35/41] time 0.168 (0.180) data 0.089 (0.103) loss_u loss_u 0.9023 (0.9242) acc_u 9.3750 (9.9107) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [40/41] time 0.176 (0.179) data 0.097 (0.102) loss_u loss_u 0.9634 (0.9271) acc_u 6.2500 (9.6094) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 828
confident_label rate tensor(0.2030, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 328
clean true:229
clean false:99
clean_rate:0.698170731707317
noisy true:559
noisy false:729
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1288
epoch [13/200] batch [5/10] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.9575 (1.2954) acc_x 75.0000 (65.6250) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [10/10] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 1.0918 (1.1927) acc_x 81.2500 (69.6875) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/40] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.8682 (0.9372) acc_u 15.6250 (8.7500) lr 1.9851e-03 eta 0:00:06
epoch [13/200] batch [10/40] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.9448 (0.9231) acc_u 6.2500 (11.2500) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [15/40] time 0.190 (0.181) data 0.112 (0.103) loss_u loss_u 0.9380 (0.9302) acc_u 6.2500 (8.9583) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/40] time 0.181 (0.181) data 0.102 (0.104) loss_u loss_u 0.9561 (0.9350) acc_u 6.2500 (8.4375) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [25/40] time 0.178 (0.181) data 0.101 (0.103) loss_u loss_u 0.9385 (0.9386) acc_u 6.2500 (7.8750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [30/40] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.9478 (0.9409) acc_u 6.2500 (7.3958) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [35/40] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.9497 (0.9414) acc_u 6.2500 (7.5000) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [40/40] time 0.183 (0.180) data 0.104 (0.102) loss_u loss_u 0.8721 (0.9347) acc_u 12.5000 (8.2812) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 860
confident_label rate tensor(0.1968, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 318
clean true:216
clean false:102
clean_rate:0.6792452830188679
noisy true:540
noisy false:758
after delete: len(clean_dataset) 318
after delete: len(noisy_dataset) 1298
epoch [14/200] batch [5/9] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 1.0010 (0.9106) acc_x 65.6250 (74.3750) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/40] time 0.180 (0.182) data 0.103 (0.104) loss_u loss_u 0.9600 (0.9504) acc_u 6.2500 (6.2500) lr 1.9823e-03 eta 0:00:06
epoch [14/200] batch [10/40] time 0.185 (0.183) data 0.107 (0.105) loss_u loss_u 0.9355 (0.9342) acc_u 6.2500 (7.8125) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [15/40] time 0.163 (0.180) data 0.086 (0.103) loss_u loss_u 0.9600 (0.9337) acc_u 6.2500 (7.9167) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [20/40] time 0.163 (0.177) data 0.084 (0.100) loss_u loss_u 0.9531 (0.9379) acc_u 6.2500 (7.5000) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [25/40] time 0.174 (0.178) data 0.097 (0.101) loss_u loss_u 0.9541 (0.9386) acc_u 3.1250 (7.3750) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [30/40] time 0.161 (0.178) data 0.084 (0.101) loss_u loss_u 0.8892 (0.9340) acc_u 12.5000 (7.7083) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [35/40] time 0.183 (0.178) data 0.106 (0.100) loss_u loss_u 0.9019 (0.9324) acc_u 12.5000 (7.8571) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [40/40] time 0.166 (0.177) data 0.088 (0.099) loss_u loss_u 0.9414 (0.9341) acc_u 6.2500 (7.7344) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 865
confident_label rate tensor(0.2048, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 331
clean true:218
clean false:113
clean_rate:0.6586102719033232
noisy true:533
noisy false:752
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1285
epoch [15/200] batch [5/10] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 1.1855 (1.1568) acc_x 75.0000 (73.1250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [10/10] time 0.174 (0.169) data 0.096 (0.092) loss_x loss_x 0.9570 (1.0903) acc_x 81.2500 (75.0000) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/40] time 0.186 (0.172) data 0.109 (0.095) loss_u loss_u 0.9355 (0.9191) acc_u 6.2500 (10.0000) lr 1.9792e-03 eta 0:00:06
epoch [15/200] batch [10/40] time 0.163 (0.171) data 0.085 (0.094) loss_u loss_u 0.8921 (0.9271) acc_u 9.3750 (8.7500) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [15/40] time 0.179 (0.170) data 0.103 (0.093) loss_u loss_u 0.9473 (0.9353) acc_u 9.3750 (8.1250) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [20/40] time 0.181 (0.171) data 0.104 (0.094) loss_u loss_u 0.9644 (0.9348) acc_u 6.2500 (7.9688) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [25/40] time 0.181 (0.172) data 0.103 (0.095) loss_u loss_u 0.9321 (0.9367) acc_u 9.3750 (7.7500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [30/40] time 0.179 (0.173) data 0.102 (0.096) loss_u loss_u 0.9521 (0.9361) acc_u 3.1250 (7.7083) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [35/40] time 0.165 (0.173) data 0.088 (0.096) loss_u loss_u 0.9717 (0.9359) acc_u 0.0000 (7.5000) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [40/40] time 0.178 (0.173) data 0.100 (0.096) loss_u loss_u 0.9829 (0.9387) acc_u 3.1250 (7.0312) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 846
confident_label rate tensor(0.1980, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 320
clean true:233
clean false:87
clean_rate:0.728125
noisy true:537
noisy false:759
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 1296
epoch [16/200] batch [5/10] time 0.180 (0.182) data 0.101 (0.104) loss_x loss_x 1.0029 (1.0567) acc_x 81.2500 (71.8750) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [10/10] time 0.189 (0.181) data 0.112 (0.103) loss_x loss_x 0.9429 (0.9903) acc_x 71.8750 (73.4375) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/40] time 0.185 (0.183) data 0.108 (0.105) loss_u loss_u 0.9185 (0.9175) acc_u 12.5000 (11.2500) lr 1.9759e-03 eta 0:00:06
epoch [16/200] batch [10/40] time 0.189 (0.184) data 0.111 (0.106) loss_u loss_u 0.9912 (0.9318) acc_u 3.1250 (9.0625) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [15/40] time 0.186 (0.184) data 0.109 (0.106) loss_u loss_u 0.9658 (0.9345) acc_u 3.1250 (8.3333) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [20/40] time 0.182 (0.184) data 0.106 (0.107) loss_u loss_u 0.9282 (0.9379) acc_u 9.3750 (7.9688) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [25/40] time 0.186 (0.185) data 0.109 (0.107) loss_u loss_u 0.9043 (0.9405) acc_u 12.5000 (7.8750) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [30/40] time 0.184 (0.185) data 0.105 (0.107) loss_u loss_u 0.9136 (0.9349) acc_u 9.3750 (8.5417) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [35/40] time 0.181 (0.185) data 0.104 (0.107) loss_u loss_u 0.8931 (0.9294) acc_u 15.6250 (9.2857) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [40/40] time 0.174 (0.184) data 0.096 (0.107) loss_u loss_u 0.9956 (0.9307) acc_u 0.0000 (9.0625) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 878
confident_label rate tensor(0.2048, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 331
clean true:217
clean false:114
clean_rate:0.6555891238670695
noisy true:521
noisy false:764
after delete: len(clean_dataset) 331
after delete: len(noisy_dataset) 1285
epoch [17/200] batch [5/10] time 0.162 (0.166) data 0.086 (0.089) loss_x loss_x 0.6914 (0.9888) acc_x 78.1250 (73.1250) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [10/10] time 0.163 (0.171) data 0.085 (0.094) loss_x loss_x 1.4912 (1.0364) acc_x 59.3750 (73.4375) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/40] time 0.174 (0.171) data 0.096 (0.094) loss_u loss_u 0.9194 (0.9403) acc_u 6.2500 (5.0000) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/40] time 0.175 (0.172) data 0.097 (0.094) loss_u loss_u 0.9297 (0.9434) acc_u 6.2500 (6.2500) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [15/40] time 0.172 (0.172) data 0.094 (0.094) loss_u loss_u 0.8774 (0.9378) acc_u 15.6250 (6.6667) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [20/40] time 0.174 (0.172) data 0.097 (0.095) loss_u loss_u 0.9062 (0.9361) acc_u 9.3750 (6.8750) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [25/40] time 0.162 (0.172) data 0.083 (0.094) loss_u loss_u 0.9224 (0.9346) acc_u 9.3750 (7.5000) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [30/40] time 0.168 (0.172) data 0.091 (0.095) loss_u loss_u 0.9346 (0.9330) acc_u 6.2500 (7.7083) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [35/40] time 0.180 (0.172) data 0.103 (0.095) loss_u loss_u 0.9404 (0.9343) acc_u 3.1250 (7.6786) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [40/40] time 0.172 (0.173) data 0.095 (0.096) loss_u loss_u 0.9595 (0.9328) acc_u 6.2500 (7.8125) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 886
confident_label rate tensor(0.2030, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 328
clean true:209
clean false:119
clean_rate:0.6371951219512195
noisy true:521
noisy false:767
after delete: len(clean_dataset) 328
after delete: len(noisy_dataset) 1288
epoch [18/200] batch [5/10] time 0.186 (0.188) data 0.110 (0.111) loss_x loss_x 0.7969 (0.8938) acc_x 78.1250 (73.7500) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [10/10] time 0.168 (0.183) data 0.091 (0.107) loss_x loss_x 0.7310 (0.8768) acc_x 75.0000 (75.3125) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/40] time 0.181 (0.184) data 0.103 (0.107) loss_u loss_u 0.8794 (0.9013) acc_u 15.6250 (13.1250) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [10/40] time 0.202 (0.188) data 0.124 (0.111) loss_u loss_u 0.9707 (0.9127) acc_u 3.1250 (11.5625) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [15/40] time 0.177 (0.189) data 0.100 (0.112) loss_u loss_u 0.9941 (0.9309) acc_u 3.1250 (9.1667) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [20/40] time 0.163 (0.186) data 0.086 (0.109) loss_u loss_u 0.9834 (0.9322) acc_u 0.0000 (8.5938) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [25/40] time 0.167 (0.183) data 0.089 (0.106) loss_u loss_u 0.9521 (0.9339) acc_u 6.2500 (8.1250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [30/40] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.9429 (0.9312) acc_u 9.3750 (8.7500) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [35/40] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.8931 (0.9270) acc_u 12.5000 (9.1071) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [40/40] time 0.166 (0.180) data 0.088 (0.103) loss_u loss_u 0.8789 (0.9252) acc_u 18.7500 (9.3750) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 889
confident_label rate tensor(0.2153, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 348
clean true:224
clean false:124
clean_rate:0.6436781609195402
noisy true:503
noisy false:765
after delete: len(clean_dataset) 348
after delete: len(noisy_dataset) 1268
epoch [19/200] batch [5/10] time 0.165 (0.170) data 0.088 (0.093) loss_x loss_x 0.5059 (0.8095) acc_x 87.5000 (78.1250) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [10/10] time 0.188 (0.173) data 0.110 (0.096) loss_x loss_x 1.0869 (0.9469) acc_x 68.7500 (75.3125) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/39] time 0.169 (0.171) data 0.090 (0.093) loss_u loss_u 0.8628 (0.9294) acc_u 18.7500 (8.1250) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/39] time 0.190 (0.173) data 0.112 (0.096) loss_u loss_u 0.9673 (0.9413) acc_u 3.1250 (6.5625) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [15/39] time 0.174 (0.174) data 0.096 (0.097) loss_u loss_u 0.8662 (0.9295) acc_u 18.7500 (8.3333) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [20/39] time 0.165 (0.173) data 0.088 (0.096) loss_u loss_u 0.9775 (0.9293) acc_u 3.1250 (8.9062) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [25/39] time 0.161 (0.173) data 0.083 (0.095) loss_u loss_u 0.9243 (0.9299) acc_u 9.3750 (8.7500) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [30/39] time 0.171 (0.172) data 0.093 (0.095) loss_u loss_u 0.9502 (0.9331) acc_u 6.2500 (8.3333) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [35/39] time 0.187 (0.172) data 0.107 (0.095) loss_u loss_u 0.9395 (0.9298) acc_u 9.3750 (8.7500) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 849
confident_label rate tensor(0.2228, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 360
clean true:241
clean false:119
clean_rate:0.6694444444444444
noisy true:526
noisy false:730
after delete: len(clean_dataset) 360
after delete: len(noisy_dataset) 1256
epoch [20/200] batch [5/11] time 0.160 (0.181) data 0.084 (0.104) loss_x loss_x 0.5635 (0.9141) acc_x 87.5000 (76.2500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/11] time 0.174 (0.173) data 0.097 (0.096) loss_x loss_x 0.8979 (0.9545) acc_x 81.2500 (75.3125) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/39] time 0.172 (0.174) data 0.095 (0.097) loss_u loss_u 0.9858 (0.9252) acc_u 3.1250 (10.6250) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [10/39] time 0.172 (0.172) data 0.094 (0.095) loss_u loss_u 0.8970 (0.9434) acc_u 9.3750 (6.5625) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/39] time 0.177 (0.174) data 0.100 (0.096) loss_u loss_u 0.8599 (0.9288) acc_u 15.6250 (8.3333) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [20/39] time 0.183 (0.175) data 0.106 (0.097) loss_u loss_u 0.9214 (0.9236) acc_u 9.3750 (9.2188) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [25/39] time 0.174 (0.175) data 0.096 (0.098) loss_u loss_u 0.9438 (0.9257) acc_u 6.2500 (8.8750) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [30/39] time 0.164 (0.175) data 0.087 (0.097) loss_u loss_u 0.9634 (0.9291) acc_u 6.2500 (8.6458) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [35/39] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.9189 (0.9299) acc_u 9.3750 (8.4821) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 887
confident_label rate tensor(0.2160, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 349
clean true:216
clean false:133
clean_rate:0.6189111747851003
noisy true:513
noisy false:754
after delete: len(clean_dataset) 349
after delete: len(noisy_dataset) 1267
epoch [21/200] batch [5/10] time 0.169 (0.181) data 0.092 (0.105) loss_x loss_x 0.6338 (1.0040) acc_x 84.3750 (76.8750) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [10/10] time 0.179 (0.178) data 0.101 (0.100) loss_x loss_x 0.8525 (0.9805) acc_x 75.0000 (75.9375) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/39] time 0.181 (0.179) data 0.105 (0.102) loss_u loss_u 0.9282 (0.9373) acc_u 6.2500 (6.8750) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [10/39] time 0.185 (0.181) data 0.109 (0.104) loss_u loss_u 0.8569 (0.9355) acc_u 18.7500 (7.5000) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [15/39] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.9082 (0.9342) acc_u 9.3750 (7.9167) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [20/39] time 0.186 (0.183) data 0.108 (0.105) loss_u loss_u 0.8843 (0.9282) acc_u 15.6250 (8.5938) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [25/39] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9277 (0.9316) acc_u 9.3750 (8.3750) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [30/39] time 0.172 (0.181) data 0.095 (0.104) loss_u loss_u 0.9526 (0.9335) acc_u 6.2500 (8.1250) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [35/39] time 0.173 (0.181) data 0.094 (0.104) loss_u loss_u 0.8682 (0.9257) acc_u 15.6250 (9.1071) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 887
confident_label rate tensor(0.2203, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 356
clean true:229
clean false:127
clean_rate:0.6432584269662921
noisy true:500
noisy false:760
after delete: len(clean_dataset) 356
after delete: len(noisy_dataset) 1260
epoch [22/200] batch [5/11] time 0.169 (0.170) data 0.092 (0.093) loss_x loss_x 0.6807 (0.9578) acc_x 75.0000 (73.7500) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/11] time 0.162 (0.171) data 0.084 (0.094) loss_x loss_x 1.3955 (1.0558) acc_x 62.5000 (75.3125) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/39] time 0.159 (0.169) data 0.082 (0.092) loss_u loss_u 0.9067 (0.9165) acc_u 12.5000 (9.3750) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [10/39] time 0.178 (0.170) data 0.101 (0.093) loss_u loss_u 0.9287 (0.9253) acc_u 6.2500 (7.8125) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [15/39] time 0.185 (0.173) data 0.107 (0.096) loss_u loss_u 0.8569 (0.9128) acc_u 15.6250 (8.9583) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [20/39] time 0.185 (0.175) data 0.108 (0.097) loss_u loss_u 0.9023 (0.9162) acc_u 12.5000 (8.9062) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [25/39] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9194 (0.9229) acc_u 15.6250 (8.7500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [30/39] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9644 (0.9235) acc_u 3.1250 (8.7500) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [35/39] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.9849 (0.9271) acc_u 3.1250 (8.3929) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 894
confident_label rate tensor(0.2191, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 354
clean true:218
clean false:136
clean_rate:0.615819209039548
noisy true:504
noisy false:758
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1262
epoch [23/200] batch [5/11] time 0.186 (0.191) data 0.108 (0.114) loss_x loss_x 0.6494 (0.7261) acc_x 87.5000 (81.2500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/11] time 0.161 (0.193) data 0.083 (0.116) loss_x loss_x 1.5469 (0.8689) acc_x 68.7500 (78.1250) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/39] time 0.175 (0.184) data 0.098 (0.107) loss_u loss_u 0.9883 (0.9406) acc_u 3.1250 (6.8750) lr 1.9461e-03 eta 0:00:06
epoch [23/200] batch [10/39] time 0.180 (0.183) data 0.102 (0.106) loss_u loss_u 0.8975 (0.9162) acc_u 12.5000 (8.7500) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [15/39] time 0.175 (0.182) data 0.098 (0.105) loss_u loss_u 0.9370 (0.9151) acc_u 9.3750 (9.3750) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [20/39] time 0.171 (0.181) data 0.094 (0.103) loss_u loss_u 0.9185 (0.9142) acc_u 6.2500 (9.6875) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [25/39] time 0.169 (0.180) data 0.093 (0.102) loss_u loss_u 0.9619 (0.9160) acc_u 3.1250 (9.6250) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [30/39] time 0.157 (0.178) data 0.079 (0.100) loss_u loss_u 0.8906 (0.9145) acc_u 9.3750 (9.5833) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [35/39] time 0.162 (0.177) data 0.083 (0.100) loss_u loss_u 0.9673 (0.9194) acc_u 0.0000 (8.9286) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 883
confident_label rate tensor(0.2222, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 359
clean true:226
clean false:133
clean_rate:0.6295264623955432
noisy true:507
noisy false:750
after delete: len(clean_dataset) 359
after delete: len(noisy_dataset) 1257
epoch [24/200] batch [5/11] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 1.2578 (1.0528) acc_x 65.6250 (73.1250) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/11] time 0.159 (0.173) data 0.081 (0.096) loss_x loss_x 0.7236 (1.0094) acc_x 81.2500 (76.2500) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/39] time 0.180 (0.176) data 0.102 (0.099) loss_u loss_u 0.8740 (0.8946) acc_u 12.5000 (13.7500) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/39] time 0.172 (0.176) data 0.093 (0.098) loss_u loss_u 0.9263 (0.9105) acc_u 12.5000 (11.5625) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [15/39] time 0.167 (0.175) data 0.090 (0.098) loss_u loss_u 0.9473 (0.9169) acc_u 6.2500 (10.8333) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [20/39] time 0.170 (0.174) data 0.093 (0.096) loss_u loss_u 0.9380 (0.9179) acc_u 6.2500 (10.6250) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [25/39] time 0.165 (0.173) data 0.088 (0.095) loss_u loss_u 0.9424 (0.9248) acc_u 6.2500 (9.6250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [30/39] time 0.178 (0.173) data 0.101 (0.095) loss_u loss_u 0.9609 (0.9262) acc_u 6.2500 (9.1667) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [35/39] time 0.179 (0.173) data 0.102 (0.095) loss_u loss_u 0.9062 (0.9247) acc_u 12.5000 (9.4643) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 854
confident_label rate tensor(0.2191, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 354
clean true:221
clean false:133
clean_rate:0.6242937853107344
noisy true:541
noisy false:721
after delete: len(clean_dataset) 354
after delete: len(noisy_dataset) 1262
epoch [25/200] batch [5/11] time 0.187 (0.190) data 0.110 (0.114) loss_x loss_x 0.8823 (1.0303) acc_x 78.1250 (76.2500) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [10/11] time 0.190 (0.186) data 0.113 (0.109) loss_x loss_x 0.8960 (0.9436) acc_x 78.1250 (78.1250) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/39] time 0.187 (0.187) data 0.109 (0.110) loss_u loss_u 0.9146 (0.9244) acc_u 9.3750 (7.5000) lr 1.9354e-03 eta 0:00:06
epoch [25/200] batch [10/39] time 0.164 (0.186) data 0.086 (0.109) loss_u loss_u 0.9009 (0.9151) acc_u 15.6250 (10.0000) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [15/39] time 0.175 (0.185) data 0.098 (0.108) loss_u loss_u 0.9360 (0.9280) acc_u 6.2500 (8.1250) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [20/39] time 0.169 (0.184) data 0.092 (0.107) loss_u loss_u 0.9385 (0.9160) acc_u 12.5000 (10.0000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [25/39] time 0.174 (0.182) data 0.097 (0.105) loss_u loss_u 0.9507 (0.9249) acc_u 3.1250 (8.7500) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [30/39] time 0.167 (0.181) data 0.090 (0.104) loss_u loss_u 0.9761 (0.9245) acc_u 3.1250 (8.8542) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [35/39] time 0.167 (0.180) data 0.088 (0.102) loss_u loss_u 0.9106 (0.9264) acc_u 12.5000 (8.6607) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 881
confident_label rate tensor(0.2240, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 362
clean true:227
clean false:135
clean_rate:0.6270718232044199
noisy true:508
noisy false:746
after delete: len(clean_dataset) 362
after delete: len(noisy_dataset) 1254
epoch [26/200] batch [5/11] time 0.186 (0.188) data 0.107 (0.111) loss_x loss_x 0.7144 (0.9389) acc_x 78.1250 (77.5000) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/11] time 0.179 (0.184) data 0.101 (0.107) loss_x loss_x 0.5933 (0.8990) acc_x 75.0000 (77.1875) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/39] time 0.164 (0.182) data 0.086 (0.105) loss_u loss_u 0.9575 (0.9346) acc_u 9.3750 (8.1250) lr 1.9298e-03 eta 0:00:06
epoch [26/200] batch [10/39] time 0.178 (0.179) data 0.101 (0.102) loss_u loss_u 0.9595 (0.9328) acc_u 3.1250 (7.8125) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [15/39] time 0.179 (0.180) data 0.103 (0.102) loss_u loss_u 0.8921 (0.9260) acc_u 12.5000 (8.9583) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [20/39] time 0.163 (0.178) data 0.086 (0.101) loss_u loss_u 0.9507 (0.9233) acc_u 6.2500 (9.3750) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [25/39] time 0.165 (0.176) data 0.088 (0.099) loss_u loss_u 0.9082 (0.9198) acc_u 9.3750 (9.8750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [30/39] time 0.168 (0.175) data 0.090 (0.098) loss_u loss_u 0.9160 (0.9214) acc_u 9.3750 (9.4792) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [35/39] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.9819 (0.9240) acc_u 3.1250 (8.9286) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 877
confident_label rate tensor(0.2277, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 368
clean true:229
clean false:139
clean_rate:0.6222826086956522
noisy true:510
noisy false:738
after delete: len(clean_dataset) 368
after delete: len(noisy_dataset) 1248
epoch [27/200] batch [5/11] time 0.165 (0.180) data 0.088 (0.103) loss_x loss_x 0.7617 (1.0561) acc_x 71.8750 (72.5000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/11] time 0.163 (0.172) data 0.085 (0.094) loss_x loss_x 1.2617 (1.0689) acc_x 78.1250 (74.3750) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/39] time 0.168 (0.169) data 0.091 (0.092) loss_u loss_u 0.9038 (0.9212) acc_u 9.3750 (8.7500) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/39] time 0.178 (0.172) data 0.101 (0.095) loss_u loss_u 0.9390 (0.9116) acc_u 6.2500 (9.6875) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/39] time 0.163 (0.174) data 0.085 (0.097) loss_u loss_u 0.9551 (0.9210) acc_u 3.1250 (8.7500) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [20/39] time 0.181 (0.173) data 0.104 (0.095) loss_u loss_u 0.8408 (0.9217) acc_u 21.8750 (8.7500) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/39] time 0.173 (0.173) data 0.096 (0.095) loss_u loss_u 0.9941 (0.9249) acc_u 0.0000 (8.5000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [30/39] time 0.180 (0.174) data 0.103 (0.097) loss_u loss_u 0.9062 (0.9212) acc_u 15.6250 (9.1667) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [35/39] time 0.175 (0.175) data 0.098 (0.097) loss_u loss_u 0.9458 (0.9183) acc_u 3.1250 (9.5536) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 875
confident_label rate tensor(0.2339, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 378
clean true:244
clean false:134
clean_rate:0.6455026455026455
noisy true:497
noisy false:741
after delete: len(clean_dataset) 378
after delete: len(noisy_dataset) 1238
epoch [28/200] batch [5/11] time 0.159 (0.174) data 0.082 (0.096) loss_x loss_x 0.7314 (0.8087) acc_x 87.5000 (82.5000) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [10/11] time 0.187 (0.176) data 0.110 (0.099) loss_x loss_x 0.6958 (0.9452) acc_x 81.2500 (78.4375) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/38] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.9297 (0.9220) acc_u 9.3750 (9.3750) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/38] time 0.164 (0.181) data 0.086 (0.104) loss_u loss_u 0.8608 (0.9104) acc_u 12.5000 (10.6250) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [15/38] time 0.205 (0.180) data 0.128 (0.103) loss_u loss_u 0.9629 (0.9160) acc_u 3.1250 (9.7917) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [20/38] time 0.206 (0.182) data 0.128 (0.104) loss_u loss_u 0.9717 (0.9185) acc_u 3.1250 (9.6875) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [25/38] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9985 (0.9237) acc_u 0.0000 (9.0000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [30/38] time 0.189 (0.183) data 0.111 (0.105) loss_u loss_u 0.9478 (0.9261) acc_u 6.2500 (8.7500) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [35/38] time 0.170 (0.182) data 0.092 (0.104) loss_u loss_u 0.8701 (0.9277) acc_u 15.6250 (8.5714) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 859
confident_label rate tensor(0.2358, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 381
clean true:237
clean false:144
clean_rate:0.6220472440944882
noisy true:520
noisy false:715
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1235
epoch [29/200] batch [5/11] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.4648 (0.7780) acc_x 90.6250 (81.2500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/11] time 0.169 (0.175) data 0.092 (0.098) loss_x loss_x 0.8022 (0.8485) acc_x 68.7500 (78.1250) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/38] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.9590 (0.9402) acc_u 3.1250 (7.5000) lr 1.9114e-03 eta 0:00:06
epoch [29/200] batch [10/38] time 0.175 (0.180) data 0.098 (0.102) loss_u loss_u 0.8896 (0.9216) acc_u 15.6250 (9.6875) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [15/38] time 0.183 (0.181) data 0.106 (0.103) loss_u loss_u 0.9346 (0.9272) acc_u 9.3750 (9.1667) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [20/38] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8857 (0.9276) acc_u 15.6250 (9.2188) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/38] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.8599 (0.9239) acc_u 18.7500 (9.3750) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [30/38] time 0.179 (0.182) data 0.101 (0.104) loss_u loss_u 0.9570 (0.9285) acc_u 3.1250 (8.8542) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [35/38] time 0.164 (0.181) data 0.084 (0.103) loss_u loss_u 0.9102 (0.9262) acc_u 12.5000 (8.9286) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 886
confident_label rate tensor(0.2327, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 376
clean true:228
clean false:148
clean_rate:0.6063829787234043
noisy true:502
noisy false:738
after delete: len(clean_dataset) 376
after delete: len(noisy_dataset) 1240
epoch [30/200] batch [5/11] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 1.2471 (0.9147) acc_x 65.6250 (73.1250) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [10/11] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 0.5601 (0.8979) acc_x 90.6250 (76.8750) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/38] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.8398 (0.9285) acc_u 18.7500 (8.7500) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/38] time 0.172 (0.176) data 0.094 (0.099) loss_u loss_u 0.8813 (0.9183) acc_u 15.6250 (9.6875) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/38] time 0.173 (0.175) data 0.095 (0.098) loss_u loss_u 0.8877 (0.9198) acc_u 12.5000 (9.3750) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [20/38] time 0.165 (0.175) data 0.086 (0.098) loss_u loss_u 0.9204 (0.9169) acc_u 9.3750 (10.0000) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [25/38] time 0.192 (0.177) data 0.114 (0.100) loss_u loss_u 0.9375 (0.9144) acc_u 6.2500 (10.1250) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [30/38] time 0.189 (0.179) data 0.111 (0.101) loss_u loss_u 0.9678 (0.9168) acc_u 6.2500 (9.8958) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [35/38] time 0.173 (0.178) data 0.096 (0.100) loss_u loss_u 0.9351 (0.9205) acc_u 6.2500 (9.3750) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 850
confident_label rate tensor(0.2370, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 383
clean true:236
clean false:147
clean_rate:0.6161879895561357
noisy true:530
noisy false:703
after delete: len(clean_dataset) 383
after delete: len(noisy_dataset) 1233
epoch [31/200] batch [5/11] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.5688 (1.1722) acc_x 87.5000 (74.3750) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/11] time 0.159 (0.170) data 0.081 (0.092) loss_x loss_x 0.8320 (1.0116) acc_x 78.1250 (76.8750) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/38] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.9219 (0.9095) acc_u 9.3750 (10.0000) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [10/38] time 0.188 (0.177) data 0.111 (0.100) loss_u loss_u 0.9229 (0.9206) acc_u 9.3750 (8.7500) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [15/38] time 0.178 (0.177) data 0.100 (0.100) loss_u loss_u 0.9424 (0.9208) acc_u 9.3750 (9.1667) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [20/38] time 0.187 (0.178) data 0.110 (0.101) loss_u loss_u 0.9473 (0.9235) acc_u 6.2500 (8.7500) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [25/38] time 0.174 (0.179) data 0.095 (0.101) loss_u loss_u 0.9272 (0.9219) acc_u 9.3750 (9.1250) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [30/38] time 0.162 (0.177) data 0.085 (0.100) loss_u loss_u 0.9399 (0.9223) acc_u 12.5000 (9.3750) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [35/38] time 0.167 (0.176) data 0.089 (0.098) loss_u loss_u 0.9482 (0.9250) acc_u 6.2500 (8.9286) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 875
confident_label rate tensor(0.2413, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 390
clean true:239
clean false:151
clean_rate:0.6128205128205129
noisy true:502
noisy false:724
after delete: len(clean_dataset) 390
after delete: len(noisy_dataset) 1226
epoch [32/200] batch [5/12] time 0.165 (0.162) data 0.088 (0.085) loss_x loss_x 1.0010 (0.9205) acc_x 71.8750 (71.8750) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/12] time 0.159 (0.163) data 0.082 (0.086) loss_x loss_x 0.8379 (0.8694) acc_x 78.1250 (75.6250) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/38] time 0.170 (0.166) data 0.093 (0.088) loss_u loss_u 0.9668 (0.9606) acc_u 3.1250 (5.0000) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [10/38] time 0.168 (0.166) data 0.091 (0.089) loss_u loss_u 0.8970 (0.9442) acc_u 12.5000 (6.8750) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/38] time 0.168 (0.166) data 0.091 (0.089) loss_u loss_u 0.9526 (0.9362) acc_u 6.2500 (7.2917) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/38] time 0.189 (0.170) data 0.112 (0.093) loss_u loss_u 0.9424 (0.9273) acc_u 9.3750 (8.1250) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [25/38] time 0.187 (0.172) data 0.108 (0.095) loss_u loss_u 0.9102 (0.9246) acc_u 12.5000 (8.6250) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [30/38] time 0.187 (0.174) data 0.110 (0.097) loss_u loss_u 0.9434 (0.9304) acc_u 6.2500 (7.9167) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [35/38] time 0.191 (0.175) data 0.114 (0.098) loss_u loss_u 0.9517 (0.9318) acc_u 6.2500 (8.0357) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 846
confident_label rate tensor(0.2382, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 385
clean true:244
clean false:141
clean_rate:0.6337662337662338
noisy true:526
noisy false:705
after delete: len(clean_dataset) 385
after delete: len(noisy_dataset) 1231
epoch [33/200] batch [5/12] time 0.179 (0.173) data 0.102 (0.096) loss_x loss_x 0.7783 (1.0292) acc_x 84.3750 (75.0000) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [10/12] time 0.157 (0.177) data 0.080 (0.100) loss_x loss_x 0.6958 (0.9129) acc_x 78.1250 (75.9375) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/38] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.8535 (0.9007) acc_u 18.7500 (11.2500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/38] time 0.187 (0.174) data 0.109 (0.097) loss_u loss_u 0.9209 (0.9182) acc_u 12.5000 (9.3750) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/38] time 0.165 (0.173) data 0.087 (0.096) loss_u loss_u 0.9453 (0.9225) acc_u 9.3750 (8.9583) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [20/38] time 0.166 (0.173) data 0.088 (0.095) loss_u loss_u 0.8955 (0.9176) acc_u 12.5000 (9.5312) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [25/38] time 0.170 (0.172) data 0.091 (0.094) loss_u loss_u 0.9375 (0.9210) acc_u 6.2500 (9.1250) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [30/38] time 0.184 (0.172) data 0.106 (0.094) loss_u loss_u 0.8711 (0.9235) acc_u 15.6250 (9.1667) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [35/38] time 0.190 (0.173) data 0.113 (0.095) loss_u loss_u 0.9014 (0.9189) acc_u 9.3750 (9.6429) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 881
confident_label rate tensor(0.2481, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 401
clean true:247
clean false:154
clean_rate:0.6159600997506235
noisy true:488
noisy false:727
after delete: len(clean_dataset) 401
after delete: len(noisy_dataset) 1215
epoch [34/200] batch [5/12] time 0.169 (0.168) data 0.092 (0.091) loss_x loss_x 1.0352 (0.9649) acc_x 71.8750 (76.2500) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/12] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 0.6089 (0.9385) acc_x 84.3750 (77.1875) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/37] time 0.168 (0.171) data 0.090 (0.094) loss_u loss_u 0.9351 (0.9258) acc_u 9.3750 (9.3750) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [10/37] time 0.164 (0.170) data 0.084 (0.092) loss_u loss_u 0.8794 (0.9250) acc_u 12.5000 (9.3750) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/37] time 0.174 (0.169) data 0.096 (0.092) loss_u loss_u 0.9316 (0.9326) acc_u 6.2500 (8.7500) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/37] time 0.183 (0.171) data 0.104 (0.094) loss_u loss_u 0.9175 (0.9353) acc_u 9.3750 (8.5938) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [25/37] time 0.185 (0.173) data 0.107 (0.095) loss_u loss_u 0.9521 (0.9300) acc_u 9.3750 (9.0000) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [30/37] time 0.182 (0.174) data 0.104 (0.097) loss_u loss_u 0.8823 (0.9259) acc_u 12.5000 (9.2708) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [35/37] time 0.181 (0.175) data 0.103 (0.098) loss_u loss_u 0.9507 (0.9292) acc_u 6.2500 (8.9286) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 830
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 405
clean true:248
clean false:157
clean_rate:0.6123456790123457
noisy true:538
noisy false:673
after delete: len(clean_dataset) 405
after delete: len(noisy_dataset) 1211
epoch [35/200] batch [5/12] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 0.8589 (0.8912) acc_x 78.1250 (74.3750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/12] time 0.186 (0.172) data 0.109 (0.095) loss_x loss_x 0.9980 (0.9001) acc_x 84.3750 (75.3125) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/37] time 0.170 (0.173) data 0.092 (0.096) loss_u loss_u 0.8882 (0.9153) acc_u 15.6250 (10.0000) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [10/37] time 0.165 (0.174) data 0.088 (0.097) loss_u loss_u 0.8584 (0.9178) acc_u 15.6250 (10.0000) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/37] time 0.194 (0.175) data 0.116 (0.097) loss_u loss_u 0.8408 (0.9097) acc_u 21.8750 (11.0417) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [20/37] time 0.186 (0.176) data 0.109 (0.098) loss_u loss_u 0.9697 (0.9163) acc_u 6.2500 (10.3125) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [25/37] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.9365 (0.9199) acc_u 6.2500 (9.7500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [30/37] time 0.187 (0.178) data 0.109 (0.100) loss_u loss_u 0.9551 (0.9253) acc_u 3.1250 (8.8542) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [35/37] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.9292 (0.9283) acc_u 9.3750 (8.6607) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 851
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 409
clean true:256
clean false:153
clean_rate:0.6259168704156479
noisy true:509
noisy false:698
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1207
epoch [36/200] batch [5/12] time 0.166 (0.170) data 0.089 (0.093) loss_x loss_x 1.4424 (0.8547) acc_x 71.8750 (80.6250) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [10/12] time 0.174 (0.172) data 0.097 (0.095) loss_x loss_x 0.7153 (0.8599) acc_x 78.1250 (79.6875) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/37] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.9658 (0.9412) acc_u 3.1250 (6.8750) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/37] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.9634 (0.9270) acc_u 6.2500 (8.7500) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/37] time 0.165 (0.174) data 0.088 (0.096) loss_u loss_u 0.8911 (0.9219) acc_u 12.5000 (9.5833) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [20/37] time 0.164 (0.173) data 0.085 (0.096) loss_u loss_u 0.9751 (0.9142) acc_u 3.1250 (10.4688) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/37] time 0.169 (0.172) data 0.091 (0.095) loss_u loss_u 0.9131 (0.9115) acc_u 9.3750 (10.7500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [30/37] time 0.174 (0.173) data 0.096 (0.095) loss_u loss_u 0.9443 (0.9140) acc_u 6.2500 (10.4167) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [35/37] time 0.172 (0.173) data 0.094 (0.095) loss_u loss_u 0.9106 (0.9155) acc_u 9.3750 (10.0893) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 823
confident_label rate tensor(0.2543, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 411
clean true:268
clean false:143
clean_rate:0.6520681265206812
noisy true:525
noisy false:680
after delete: len(clean_dataset) 411
after delete: len(noisy_dataset) 1205
epoch [37/200] batch [5/12] time 0.166 (0.161) data 0.090 (0.085) loss_x loss_x 1.1357 (0.9146) acc_x 68.7500 (75.6250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [10/12] time 0.177 (0.173) data 0.100 (0.096) loss_x loss_x 0.8340 (0.8745) acc_x 81.2500 (77.8125) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/37] time 0.174 (0.171) data 0.097 (0.094) loss_u loss_u 0.9443 (0.9550) acc_u 6.2500 (5.6250) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [10/37] time 0.167 (0.170) data 0.089 (0.093) loss_u loss_u 0.9619 (0.9460) acc_u 6.2500 (6.8750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/37] time 0.169 (0.170) data 0.091 (0.093) loss_u loss_u 0.9229 (0.9383) acc_u 6.2500 (7.0833) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [20/37] time 0.157 (0.169) data 0.080 (0.092) loss_u loss_u 0.8740 (0.9365) acc_u 12.5000 (7.0312) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [25/37] time 0.189 (0.169) data 0.112 (0.092) loss_u loss_u 0.9111 (0.9338) acc_u 12.5000 (7.3750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [30/37] time 0.187 (0.171) data 0.109 (0.094) loss_u loss_u 0.9028 (0.9312) acc_u 12.5000 (8.0208) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [35/37] time 0.188 (0.173) data 0.111 (0.096) loss_u loss_u 0.9580 (0.9266) acc_u 9.3750 (8.8393) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 817
confident_label rate tensor(0.2550, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 412
clean true:259
clean false:153
clean_rate:0.6286407766990292
noisy true:540
noisy false:664
after delete: len(clean_dataset) 412
after delete: len(noisy_dataset) 1204
epoch [38/200] batch [5/12] time 0.182 (0.191) data 0.105 (0.113) loss_x loss_x 1.0938 (0.9148) acc_x 84.3750 (80.0000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [10/12] time 0.181 (0.183) data 0.104 (0.105) loss_x loss_x 0.5752 (0.8728) acc_x 84.3750 (79.0625) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/37] time 0.191 (0.178) data 0.113 (0.101) loss_u loss_u 0.9443 (0.9302) acc_u 6.2500 (8.1250) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/37] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9238 (0.9249) acc_u 12.5000 (8.7500) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/37] time 0.207 (0.180) data 0.130 (0.103) loss_u loss_u 0.9009 (0.9226) acc_u 9.3750 (8.9583) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/37] time 0.166 (0.180) data 0.088 (0.102) loss_u loss_u 0.8467 (0.9218) acc_u 21.8750 (9.2188) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [25/37] time 0.166 (0.178) data 0.089 (0.101) loss_u loss_u 0.9058 (0.9181) acc_u 9.3750 (9.5000) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [30/37] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.9209 (0.9155) acc_u 9.3750 (10.0000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [35/37] time 0.183 (0.177) data 0.105 (0.099) loss_u loss_u 0.9287 (0.9190) acc_u 12.5000 (9.6429) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 878
confident_label rate tensor(0.2488, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 402
clean true:232
clean false:170
clean_rate:0.5771144278606966
noisy true:506
noisy false:708
after delete: len(clean_dataset) 402
after delete: len(noisy_dataset) 1214
epoch [39/200] batch [5/12] time 0.165 (0.170) data 0.089 (0.093) loss_x loss_x 0.7451 (0.6515) acc_x 78.1250 (82.5000) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/12] time 0.167 (0.168) data 0.091 (0.091) loss_x loss_x 0.5859 (0.7019) acc_x 90.6250 (82.5000) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/37] time 0.168 (0.167) data 0.090 (0.090) loss_u loss_u 0.9248 (0.8981) acc_u 12.5000 (11.2500) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/37] time 0.183 (0.169) data 0.104 (0.091) loss_u loss_u 0.9644 (0.9098) acc_u 6.2500 (10.3125) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/37] time 0.191 (0.172) data 0.112 (0.094) loss_u loss_u 0.9712 (0.9222) acc_u 0.0000 (8.5417) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/37] time 0.171 (0.173) data 0.094 (0.095) loss_u loss_u 0.9761 (0.9267) acc_u 3.1250 (8.1250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [25/37] time 0.173 (0.172) data 0.095 (0.095) loss_u loss_u 0.9326 (0.9255) acc_u 6.2500 (8.5000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [30/37] time 0.172 (0.172) data 0.094 (0.095) loss_u loss_u 0.8872 (0.9213) acc_u 9.3750 (8.9583) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [35/37] time 0.167 (0.172) data 0.090 (0.094) loss_u loss_u 0.9341 (0.9217) acc_u 9.3750 (8.9286) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 854
confident_label rate tensor(0.2500, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 404
clean true:248
clean false:156
clean_rate:0.6138613861386139
noisy true:514
noisy false:698
after delete: len(clean_dataset) 404
after delete: len(noisy_dataset) 1212
epoch [40/200] batch [5/12] time 0.193 (0.177) data 0.116 (0.100) loss_x loss_x 1.6309 (0.8179) acc_x 62.5000 (78.1250) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [10/12] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.6250 (0.8380) acc_x 81.2500 (79.0625) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/37] time 0.181 (0.175) data 0.102 (0.098) loss_u loss_u 0.9292 (0.9092) acc_u 6.2500 (8.1250) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/37] time 0.185 (0.177) data 0.108 (0.099) loss_u loss_u 0.9697 (0.9154) acc_u 3.1250 (9.0625) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/37] time 0.179 (0.177) data 0.101 (0.099) loss_u loss_u 0.8447 (0.9081) acc_u 15.6250 (10.0000) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/37] time 0.177 (0.178) data 0.099 (0.100) loss_u loss_u 0.9424 (0.9196) acc_u 6.2500 (8.9062) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [25/37] time 0.188 (0.178) data 0.110 (0.101) loss_u loss_u 0.8340 (0.9185) acc_u 15.6250 (9.0000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [30/37] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8755 (0.9155) acc_u 12.5000 (9.5833) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [35/37] time 0.184 (0.180) data 0.107 (0.102) loss_u loss_u 0.9429 (0.9159) acc_u 6.2500 (9.5536) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 864
confident_label rate tensor(0.2469, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 399
clean true:244
clean false:155
clean_rate:0.6115288220551378
noisy true:508
noisy false:709
after delete: len(clean_dataset) 399
after delete: len(noisy_dataset) 1217
epoch [41/200] batch [5/12] time 0.175 (0.191) data 0.098 (0.114) loss_x loss_x 0.8906 (0.8457) acc_x 78.1250 (79.3750) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [10/12] time 0.198 (0.184) data 0.121 (0.107) loss_x loss_x 0.4941 (0.8420) acc_x 84.3750 (78.4375) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/38] time 0.187 (0.185) data 0.108 (0.108) loss_u loss_u 0.9795 (0.9011) acc_u 3.1250 (11.8750) lr 1.8181e-03 eta 0:00:06
epoch [41/200] batch [10/38] time 0.171 (0.183) data 0.094 (0.106) loss_u loss_u 0.9058 (0.9144) acc_u 9.3750 (9.6875) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [15/38] time 0.183 (0.183) data 0.104 (0.106) loss_u loss_u 0.9937 (0.9273) acc_u 0.0000 (8.3333) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [20/38] time 0.179 (0.182) data 0.102 (0.105) loss_u loss_u 0.8359 (0.9206) acc_u 18.7500 (9.3750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [25/38] time 0.185 (0.183) data 0.107 (0.105) loss_u loss_u 0.9668 (0.9227) acc_u 3.1250 (9.0000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [30/38] time 0.173 (0.182) data 0.095 (0.105) loss_u loss_u 0.9507 (0.9172) acc_u 9.3750 (10.1042) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [35/38] time 0.174 (0.182) data 0.096 (0.105) loss_u loss_u 0.8916 (0.9139) acc_u 9.3750 (10.1786) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 856
confident_label rate tensor(0.2525, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 408
clean true:242
clean false:166
clean_rate:0.5931372549019608
noisy true:518
noisy false:690
after delete: len(clean_dataset) 408
after delete: len(noisy_dataset) 1208
epoch [42/200] batch [5/12] time 0.188 (0.176) data 0.110 (0.099) loss_x loss_x 0.5190 (0.6968) acc_x 84.3750 (83.1250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/12] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.9756 (0.7940) acc_x 65.6250 (78.7500) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/37] time 0.171 (0.176) data 0.093 (0.098) loss_u loss_u 0.8271 (0.8925) acc_u 21.8750 (13.7500) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [10/37] time 0.177 (0.175) data 0.098 (0.098) loss_u loss_u 0.9829 (0.9021) acc_u 3.1250 (13.4375) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/37] time 0.202 (0.177) data 0.125 (0.099) loss_u loss_u 0.9038 (0.9090) acc_u 12.5000 (12.0833) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [20/37] time 0.200 (0.178) data 0.123 (0.100) loss_u loss_u 0.9102 (0.9154) acc_u 6.2500 (10.6250) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [25/37] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.9326 (0.9146) acc_u 9.3750 (10.6250) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [30/37] time 0.179 (0.178) data 0.101 (0.100) loss_u loss_u 0.9517 (0.9173) acc_u 6.2500 (10.2083) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [35/37] time 0.160 (0.177) data 0.081 (0.100) loss_u loss_u 0.8223 (0.9143) acc_u 21.8750 (10.3571) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 856
confident_label rate tensor(0.2475, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 400
clean true:243
clean false:157
clean_rate:0.6075
noisy true:517
noisy false:699
after delete: len(clean_dataset) 400
after delete: len(noisy_dataset) 1216
epoch [43/200] batch [5/12] time 0.167 (0.175) data 0.090 (0.099) loss_x loss_x 0.9707 (0.7176) acc_x 71.8750 (82.5000) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/12] time 0.166 (0.172) data 0.089 (0.095) loss_x loss_x 0.6812 (0.7464) acc_x 81.2500 (82.8125) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/38] time 0.173 (0.171) data 0.095 (0.094) loss_u loss_u 0.8584 (0.9166) acc_u 15.6250 (10.6250) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/38] time 0.182 (0.171) data 0.104 (0.094) loss_u loss_u 0.8569 (0.8986) acc_u 25.0000 (12.5000) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/38] time 0.166 (0.172) data 0.086 (0.095) loss_u loss_u 0.9146 (0.9053) acc_u 15.6250 (11.8750) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/38] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.9702 (0.9083) acc_u 6.2500 (11.5625) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [25/38] time 0.165 (0.173) data 0.088 (0.096) loss_u loss_u 0.9546 (0.9129) acc_u 6.2500 (10.8750) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [30/38] time 0.172 (0.173) data 0.094 (0.096) loss_u loss_u 0.9253 (0.9094) acc_u 9.3750 (11.3542) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [35/38] time 0.172 (0.173) data 0.094 (0.096) loss_u loss_u 0.9028 (0.9136) acc_u 15.6250 (10.9821) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 866
confident_label rate tensor(0.2661, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 430
clean true:256
clean false:174
clean_rate:0.5953488372093023
noisy true:494
noisy false:692
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1186
epoch [44/200] batch [5/13] time 0.189 (0.184) data 0.111 (0.107) loss_x loss_x 0.5679 (0.8546) acc_x 84.3750 (78.1250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/13] time 0.180 (0.182) data 0.102 (0.104) loss_x loss_x 1.2920 (0.7999) acc_x 62.5000 (77.5000) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/37] time 0.188 (0.177) data 0.109 (0.099) loss_u loss_u 0.8535 (0.9006) acc_u 21.8750 (12.5000) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/37] time 0.168 (0.177) data 0.090 (0.100) loss_u loss_u 0.9233 (0.9232) acc_u 15.6250 (10.0000) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/37] time 0.188 (0.179) data 0.111 (0.102) loss_u loss_u 0.9824 (0.9337) acc_u 3.1250 (8.3333) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/37] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.9111 (0.9306) acc_u 9.3750 (8.5938) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [25/37] time 0.163 (0.180) data 0.087 (0.102) loss_u loss_u 0.9019 (0.9257) acc_u 15.6250 (9.5000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [30/37] time 0.167 (0.179) data 0.089 (0.101) loss_u loss_u 0.9141 (0.9213) acc_u 12.5000 (10.0000) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [35/37] time 0.180 (0.177) data 0.103 (0.100) loss_u loss_u 0.9092 (0.9230) acc_u 9.3750 (9.7321) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 851
confident_label rate tensor(0.2593, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 419
clean true:251
clean false:168
clean_rate:0.5990453460620525
noisy true:514
noisy false:683
after delete: len(clean_dataset) 419
after delete: len(noisy_dataset) 1197
epoch [45/200] batch [5/13] time 0.161 (0.164) data 0.083 (0.088) loss_x loss_x 0.4951 (0.6695) acc_x 87.5000 (81.2500) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/13] time 0.187 (0.173) data 0.110 (0.096) loss_x loss_x 0.8921 (0.6980) acc_x 71.8750 (80.6250) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/37] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.9556 (0.9049) acc_u 3.1250 (9.3750) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [10/37] time 0.181 (0.172) data 0.103 (0.094) loss_u loss_u 0.9058 (0.9179) acc_u 12.5000 (8.7500) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/37] time 0.173 (0.171) data 0.094 (0.094) loss_u loss_u 0.9092 (0.9197) acc_u 9.3750 (8.7500) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/37] time 0.172 (0.172) data 0.095 (0.095) loss_u loss_u 0.9248 (0.9210) acc_u 9.3750 (9.0625) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [25/37] time 0.164 (0.172) data 0.087 (0.094) loss_u loss_u 0.9678 (0.9174) acc_u 3.1250 (9.7500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [30/37] time 0.165 (0.171) data 0.088 (0.094) loss_u loss_u 0.8789 (0.9153) acc_u 12.5000 (9.7917) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [35/37] time 0.186 (0.172) data 0.108 (0.094) loss_u loss_u 0.9507 (0.9171) acc_u 6.2500 (9.6429) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 843
confident_label rate tensor(0.2611, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 422
clean true:256
clean false:166
clean_rate:0.6066350710900474
noisy true:517
noisy false:677
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1194
epoch [46/200] batch [5/13] time 0.197 (0.193) data 0.121 (0.116) loss_x loss_x 0.5234 (0.6808) acc_x 84.3750 (80.6250) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/13] time 0.170 (0.179) data 0.093 (0.102) loss_x loss_x 1.2363 (0.7753) acc_x 62.5000 (79.0625) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/37] time 0.172 (0.177) data 0.094 (0.100) loss_u loss_u 0.9087 (0.9262) acc_u 9.3750 (9.3750) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/37] time 0.160 (0.177) data 0.081 (0.100) loss_u loss_u 0.8838 (0.9180) acc_u 12.5000 (10.0000) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/37] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.8999 (0.9133) acc_u 9.3750 (10.6250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/37] time 0.175 (0.177) data 0.098 (0.100) loss_u loss_u 0.8994 (0.9200) acc_u 12.5000 (9.8438) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [25/37] time 0.173 (0.178) data 0.094 (0.101) loss_u loss_u 0.8809 (0.9194) acc_u 12.5000 (9.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [30/37] time 0.174 (0.179) data 0.097 (0.101) loss_u loss_u 0.9160 (0.9235) acc_u 6.2500 (9.0625) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [35/37] time 0.179 (0.179) data 0.102 (0.101) loss_u loss_u 0.9390 (0.9192) acc_u 6.2500 (9.4643) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 849
confident_label rate tensor(0.2661, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 430
clean true:259
clean false:171
clean_rate:0.6023255813953489
noisy true:508
noisy false:678
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1186
epoch [47/200] batch [5/13] time 0.175 (0.183) data 0.098 (0.106) loss_x loss_x 0.5601 (0.7083) acc_x 87.5000 (79.3750) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/13] time 0.186 (0.187) data 0.110 (0.110) loss_x loss_x 1.3760 (0.7722) acc_x 78.1250 (80.3125) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/37] time 0.186 (0.182) data 0.109 (0.104) loss_u loss_u 0.9561 (0.9287) acc_u 3.1250 (7.5000) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/37] time 0.187 (0.180) data 0.108 (0.103) loss_u loss_u 0.8921 (0.9146) acc_u 9.3750 (9.6875) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [15/37] time 0.159 (0.176) data 0.082 (0.099) loss_u loss_u 0.9570 (0.9130) acc_u 3.1250 (10.0000) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/37] time 0.173 (0.176) data 0.096 (0.098) loss_u loss_u 0.9624 (0.9171) acc_u 3.1250 (9.6875) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [25/37] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.9355 (0.9176) acc_u 9.3750 (9.6250) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [30/37] time 0.175 (0.176) data 0.098 (0.099) loss_u loss_u 0.9521 (0.9171) acc_u 6.2500 (9.6875) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [35/37] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.9155 (0.9190) acc_u 9.3750 (9.6429) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 873
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 405
clean true:234
clean false:171
clean_rate:0.5777777777777777
noisy true:509
noisy false:702
after delete: len(clean_dataset) 405
after delete: len(noisy_dataset) 1211
epoch [48/200] batch [5/12] time 0.173 (0.192) data 0.096 (0.114) loss_x loss_x 0.7686 (0.5780) acc_x 84.3750 (85.6250) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/12] time 0.183 (0.188) data 0.106 (0.111) loss_x loss_x 0.9243 (0.7254) acc_x 75.0000 (82.1875) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/37] time 0.188 (0.187) data 0.111 (0.110) loss_u loss_u 0.9512 (0.8979) acc_u 6.2500 (11.8750) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [10/37] time 0.177 (0.185) data 0.097 (0.108) loss_u loss_u 0.9604 (0.9153) acc_u 6.2500 (10.0000) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [15/37] time 0.161 (0.184) data 0.084 (0.107) loss_u loss_u 0.8740 (0.9196) acc_u 15.6250 (9.5833) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [20/37] time 0.163 (0.181) data 0.085 (0.104) loss_u loss_u 0.9385 (0.9139) acc_u 9.3750 (10.0000) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [25/37] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.8784 (0.9092) acc_u 12.5000 (10.5000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [30/37] time 0.188 (0.178) data 0.111 (0.101) loss_u loss_u 0.8911 (0.9057) acc_u 15.6250 (11.1458) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [35/37] time 0.168 (0.179) data 0.091 (0.101) loss_u loss_u 0.9375 (0.9081) acc_u 6.2500 (10.9821) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 829
confident_label rate tensor(0.2636, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 426
clean true:258
clean false:168
clean_rate:0.6056338028169014
noisy true:529
noisy false:661
after delete: len(clean_dataset) 426
after delete: len(noisy_dataset) 1190
epoch [49/200] batch [5/13] time 0.197 (0.187) data 0.120 (0.110) loss_x loss_x 0.5874 (0.6487) acc_x 78.1250 (83.1250) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/13] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.8848 (0.6537) acc_x 75.0000 (83.7500) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/37] time 0.177 (0.179) data 0.098 (0.102) loss_u loss_u 0.9575 (0.9433) acc_u 6.2500 (6.2500) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/37] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.9463 (0.9415) acc_u 6.2500 (7.1875) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/37] time 0.180 (0.176) data 0.103 (0.099) loss_u loss_u 0.9258 (0.9310) acc_u 9.3750 (8.3333) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/37] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.9482 (0.9259) acc_u 6.2500 (8.4375) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [25/37] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.8452 (0.9215) acc_u 12.5000 (9.0000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [30/37] time 0.173 (0.178) data 0.094 (0.100) loss_u loss_u 0.8252 (0.9242) acc_u 21.8750 (8.7500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [35/37] time 0.186 (0.179) data 0.107 (0.102) loss_u loss_u 0.8276 (0.9221) acc_u 21.8750 (9.1071) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 845
confident_label rate tensor(0.2661, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 430
clean true:266
clean false:164
clean_rate:0.6186046511627907
noisy true:505
noisy false:681
after delete: len(clean_dataset) 430
after delete: len(noisy_dataset) 1186
epoch [50/200] batch [5/13] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.5850 (0.9488) acc_x 84.3750 (77.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [10/13] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.6772 (0.8532) acc_x 84.3750 (78.1250) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/37] time 0.162 (0.183) data 0.085 (0.106) loss_u loss_u 0.9741 (0.9379) acc_u 3.1250 (6.8750) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/37] time 0.174 (0.183) data 0.096 (0.105) loss_u loss_u 0.9038 (0.9133) acc_u 9.3750 (10.0000) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/37] time 0.160 (0.179) data 0.083 (0.101) loss_u loss_u 0.9316 (0.9124) acc_u 6.2500 (10.0000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/37] time 0.194 (0.179) data 0.116 (0.102) loss_u loss_u 0.9321 (0.9117) acc_u 6.2500 (10.0000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [25/37] time 0.172 (0.178) data 0.093 (0.101) loss_u loss_u 0.9292 (0.9129) acc_u 9.3750 (9.7500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [30/37] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.9326 (0.9146) acc_u 9.3750 (9.7917) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [35/37] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9316 (0.9169) acc_u 6.2500 (9.4643) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 876
confident_label rate tensor(0.2599, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 420
clean true:237
clean false:183
clean_rate:0.5642857142857143
noisy true:503
noisy false:693
after delete: len(clean_dataset) 420
after delete: len(noisy_dataset) 1196
epoch [51/200] batch [5/13] time 0.188 (0.183) data 0.111 (0.106) loss_x loss_x 0.8042 (0.8939) acc_x 81.2500 (76.2500) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/13] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.9160 (0.9142) acc_x 84.3750 (77.5000) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/37] time 0.166 (0.179) data 0.088 (0.102) loss_u loss_u 0.8877 (0.9195) acc_u 12.5000 (8.1250) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/37] time 0.196 (0.180) data 0.118 (0.103) loss_u loss_u 0.9717 (0.9113) acc_u 3.1250 (10.3125) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/37] time 0.179 (0.180) data 0.101 (0.103) loss_u loss_u 0.9614 (0.9110) acc_u 6.2500 (10.4167) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/37] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.9009 (0.9085) acc_u 15.6250 (11.0938) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [25/37] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.8940 (0.9074) acc_u 12.5000 (11.1250) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [30/37] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9580 (0.9117) acc_u 3.1250 (10.8333) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [35/37] time 0.169 (0.178) data 0.092 (0.100) loss_u loss_u 0.9595 (0.9188) acc_u 6.2500 (9.9107) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 852
confident_label rate tensor(0.2667, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 431
clean true:263
clean false:168
clean_rate:0.6102088167053364
noisy true:501
noisy false:684
after delete: len(clean_dataset) 431
after delete: len(noisy_dataset) 1185
epoch [52/200] batch [5/13] time 0.173 (0.172) data 0.097 (0.096) loss_x loss_x 0.9155 (0.8078) acc_x 68.7500 (75.0000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/13] time 0.187 (0.175) data 0.109 (0.098) loss_x loss_x 0.7383 (0.8346) acc_x 84.3750 (76.2500) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/37] time 0.174 (0.174) data 0.097 (0.096) loss_u loss_u 0.9683 (0.9497) acc_u 6.2500 (7.5000) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [10/37] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.9326 (0.9273) acc_u 6.2500 (9.3750) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/37] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.9434 (0.9239) acc_u 6.2500 (9.1667) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/37] time 0.185 (0.175) data 0.108 (0.098) loss_u loss_u 0.9141 (0.9236) acc_u 12.5000 (9.5312) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [25/37] time 0.174 (0.176) data 0.095 (0.099) loss_u loss_u 0.9277 (0.9227) acc_u 9.3750 (9.7500) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [30/37] time 0.175 (0.176) data 0.097 (0.098) loss_u loss_u 0.9673 (0.9264) acc_u 3.1250 (9.0625) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [35/37] time 0.181 (0.176) data 0.103 (0.099) loss_u loss_u 0.9526 (0.9276) acc_u 6.2500 (8.9286) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 888
confident_label rate tensor(0.2587, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 418
clean true:247
clean false:171
clean_rate:0.5909090909090909
noisy true:481
noisy false:717
after delete: len(clean_dataset) 418
after delete: len(noisy_dataset) 1198
epoch [53/200] batch [5/13] time 0.201 (0.187) data 0.125 (0.111) loss_x loss_x 0.4729 (0.9415) acc_x 87.5000 (76.8750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/13] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.2435 (0.8244) acc_x 96.8750 (79.3750) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/37] time 0.174 (0.185) data 0.097 (0.108) loss_u loss_u 0.9619 (0.9382) acc_u 3.1250 (6.8750) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/37] time 0.174 (0.183) data 0.097 (0.106) loss_u loss_u 0.8838 (0.9218) acc_u 15.6250 (8.7500) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/37] time 0.177 (0.183) data 0.099 (0.106) loss_u loss_u 0.9258 (0.9227) acc_u 9.3750 (8.7500) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [20/37] time 0.201 (0.182) data 0.122 (0.104) loss_u loss_u 0.9824 (0.9186) acc_u 3.1250 (9.5312) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [25/37] time 0.187 (0.182) data 0.110 (0.104) loss_u loss_u 0.9053 (0.9185) acc_u 9.3750 (9.2500) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [30/37] time 0.182 (0.182) data 0.104 (0.104) loss_u loss_u 0.9185 (0.9195) acc_u 9.3750 (9.3750) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [35/37] time 0.183 (0.182) data 0.105 (0.104) loss_u loss_u 0.8877 (0.9157) acc_u 12.5000 (9.8214) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 828
confident_label rate tensor(0.2797, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 452
clean true:264
clean false:188
clean_rate:0.584070796460177
noisy true:524
noisy false:640
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 1164
epoch [54/200] batch [5/14] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.7739 (0.8775) acc_x 78.1250 (77.5000) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/14] time 0.176 (0.186) data 0.099 (0.109) loss_x loss_x 1.2754 (0.8875) acc_x 71.8750 (76.5625) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/36] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.9487 (0.9471) acc_u 6.2500 (5.6250) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [10/36] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.9067 (0.9313) acc_u 9.3750 (7.5000) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [15/36] time 0.169 (0.177) data 0.092 (0.099) loss_u loss_u 0.9790 (0.9279) acc_u 0.0000 (7.5000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/36] time 0.181 (0.176) data 0.102 (0.098) loss_u loss_u 0.8633 (0.9215) acc_u 18.7500 (8.5938) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/36] time 0.162 (0.175) data 0.085 (0.097) loss_u loss_u 0.8813 (0.9232) acc_u 15.6250 (8.3750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/36] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.9214 (0.9196) acc_u 9.3750 (8.9583) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [35/36] time 0.180 (0.175) data 0.102 (0.097) loss_u loss_u 0.9565 (0.9216) acc_u 6.2500 (8.9286) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 877
confident_label rate tensor(0.2710, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 438
clean true:260
clean false:178
clean_rate:0.593607305936073
noisy true:479
noisy false:699
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1178
epoch [55/200] batch [5/13] time 0.176 (0.177) data 0.097 (0.099) loss_x loss_x 0.7700 (0.7873) acc_x 84.3750 (80.0000) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/13] time 0.170 (0.178) data 0.093 (0.100) loss_x loss_x 0.6636 (0.8030) acc_x 78.1250 (76.8750) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/36] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.9590 (0.8699) acc_u 6.2500 (16.2500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/36] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.9722 (0.8990) acc_u 3.1250 (13.1250) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/36] time 0.168 (0.177) data 0.091 (0.099) loss_u loss_u 0.9585 (0.9158) acc_u 3.1250 (10.6250) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/36] time 0.171 (0.176) data 0.092 (0.099) loss_u loss_u 0.8657 (0.9146) acc_u 12.5000 (10.6250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/36] time 0.160 (0.175) data 0.081 (0.097) loss_u loss_u 0.9507 (0.9148) acc_u 6.2500 (10.3750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/36] time 0.182 (0.174) data 0.104 (0.097) loss_u loss_u 0.8979 (0.9111) acc_u 12.5000 (10.8333) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [35/36] time 0.196 (0.176) data 0.119 (0.098) loss_u loss_u 0.9121 (0.9111) acc_u 9.3750 (10.6250) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 839
confident_label rate tensor(0.2611, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 422
clean true:255
clean false:167
clean_rate:0.6042654028436019
noisy true:522
noisy false:672
after delete: len(clean_dataset) 422
after delete: len(noisy_dataset) 1194
epoch [56/200] batch [5/13] time 0.168 (0.170) data 0.091 (0.093) loss_x loss_x 0.7949 (0.7771) acc_x 71.8750 (80.0000) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/13] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 0.6992 (0.7941) acc_x 84.3750 (78.4375) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/37] time 0.171 (0.173) data 0.093 (0.096) loss_u loss_u 0.8638 (0.9133) acc_u 12.5000 (9.3750) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [10/37] time 0.175 (0.174) data 0.098 (0.097) loss_u loss_u 0.9199 (0.9214) acc_u 9.3750 (8.4375) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/37] time 0.163 (0.172) data 0.085 (0.094) loss_u loss_u 0.9521 (0.9219) acc_u 6.2500 (8.3333) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/37] time 0.175 (0.172) data 0.097 (0.094) loss_u loss_u 0.8652 (0.9146) acc_u 15.6250 (9.8438) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/37] time 0.171 (0.172) data 0.094 (0.095) loss_u loss_u 0.9658 (0.9202) acc_u 3.1250 (9.1250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [30/37] time 0.175 (0.173) data 0.098 (0.096) loss_u loss_u 0.9575 (0.9215) acc_u 6.2500 (8.9583) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [35/37] time 0.172 (0.172) data 0.094 (0.094) loss_u loss_u 0.9375 (0.9134) acc_u 6.2500 (10.0000) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 866
confident_label rate tensor(0.2568, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 415
clean true:241
clean false:174
clean_rate:0.5807228915662651
noisy true:509
noisy false:692
after delete: len(clean_dataset) 415
after delete: len(noisy_dataset) 1201
epoch [57/200] batch [5/12] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.5693 (0.6976) acc_x 87.5000 (80.6250) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/12] time 0.197 (0.182) data 0.118 (0.104) loss_x loss_x 0.4880 (0.7394) acc_x 93.7500 (80.6250) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/37] time 0.176 (0.179) data 0.098 (0.102) loss_u loss_u 0.8877 (0.8967) acc_u 15.6250 (12.5000) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [10/37] time 0.181 (0.180) data 0.103 (0.102) loss_u loss_u 0.9922 (0.9142) acc_u 0.0000 (10.0000) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/37] time 0.168 (0.178) data 0.090 (0.100) loss_u loss_u 0.9648 (0.9197) acc_u 3.1250 (9.1667) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/37] time 0.169 (0.178) data 0.091 (0.100) loss_u loss_u 0.9038 (0.9176) acc_u 9.3750 (9.0625) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [25/37] time 0.183 (0.178) data 0.105 (0.100) loss_u loss_u 0.9248 (0.9155) acc_u 9.3750 (9.5000) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [30/37] time 0.168 (0.178) data 0.091 (0.100) loss_u loss_u 0.9346 (0.9155) acc_u 9.3750 (9.3750) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [35/37] time 0.156 (0.177) data 0.078 (0.099) loss_u loss_u 0.9282 (0.9131) acc_u 6.2500 (9.4643) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 850
confident_label rate tensor(0.2698, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 436
clean true:256
clean false:180
clean_rate:0.5871559633027523
noisy true:510
noisy false:670
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1180
epoch [58/200] batch [5/13] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.5576 (0.5759) acc_x 81.2500 (86.2500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/13] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 1.3623 (0.6359) acc_x 59.3750 (83.7500) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/36] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.8774 (0.9182) acc_u 12.5000 (8.7500) lr 1.6374e-03 eta 0:00:05
epoch [58/200] batch [10/36] time 0.168 (0.177) data 0.091 (0.099) loss_u loss_u 0.9604 (0.9200) acc_u 3.1250 (9.0625) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/36] time 0.180 (0.176) data 0.103 (0.098) loss_u loss_u 0.8701 (0.9243) acc_u 12.5000 (8.3333) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/36] time 0.166 (0.176) data 0.088 (0.098) loss_u loss_u 0.8945 (0.9216) acc_u 12.5000 (8.7500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/36] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.8662 (0.9198) acc_u 12.5000 (8.7500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/36] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.8408 (0.9192) acc_u 25.0000 (9.1667) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [35/36] time 0.161 (0.175) data 0.083 (0.098) loss_u loss_u 0.8706 (0.9162) acc_u 15.6250 (9.8214) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 827
confident_label rate tensor(0.2710, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 438
clean true:264
clean false:174
clean_rate:0.6027397260273972
noisy true:525
noisy false:653
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1178
epoch [59/200] batch [5/13] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.4500 (0.6884) acc_x 90.6250 (83.7500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/13] time 0.220 (0.182) data 0.143 (0.105) loss_x loss_x 0.7871 (0.7184) acc_x 71.8750 (80.0000) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/36] time 0.172 (0.181) data 0.095 (0.104) loss_u loss_u 0.9419 (0.9208) acc_u 6.2500 (8.7500) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/36] time 0.174 (0.181) data 0.097 (0.103) loss_u loss_u 0.9082 (0.9152) acc_u 12.5000 (9.6875) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/36] time 0.181 (0.180) data 0.103 (0.103) loss_u loss_u 0.9165 (0.9150) acc_u 9.3750 (9.5833) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/36] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.9331 (0.9159) acc_u 6.2500 (9.3750) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/36] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.9858 (0.9181) acc_u 0.0000 (9.2500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/36] time 0.169 (0.179) data 0.091 (0.102) loss_u loss_u 0.9028 (0.9196) acc_u 9.3750 (9.0625) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [35/36] time 0.187 (0.180) data 0.110 (0.102) loss_u loss_u 0.8911 (0.9148) acc_u 9.3750 (9.5536) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 835
confident_label rate tensor(0.2717, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 439
clean true:258
clean false:181
clean_rate:0.5876993166287016
noisy true:523
noisy false:654
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1177
epoch [60/200] batch [5/13] time 0.169 (0.179) data 0.091 (0.102) loss_x loss_x 0.8984 (0.5905) acc_x 81.2500 (86.2500) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/13] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 1.0195 (0.7152) acc_x 75.0000 (82.1875) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/36] time 0.186 (0.178) data 0.108 (0.100) loss_u loss_u 0.9365 (0.9240) acc_u 6.2500 (8.7500) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/36] time 0.181 (0.179) data 0.103 (0.101) loss_u loss_u 0.9507 (0.9261) acc_u 6.2500 (8.7500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/36] time 0.173 (0.178) data 0.095 (0.101) loss_u loss_u 0.8589 (0.9116) acc_u 15.6250 (10.4167) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/36] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9429 (0.9138) acc_u 6.2500 (10.1562) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/36] time 0.189 (0.179) data 0.111 (0.102) loss_u loss_u 0.9233 (0.9112) acc_u 6.2500 (10.3750) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [30/36] time 0.183 (0.179) data 0.106 (0.101) loss_u loss_u 0.9761 (0.9104) acc_u 3.1250 (10.3125) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [35/36] time 0.171 (0.178) data 0.094 (0.100) loss_u loss_u 0.8926 (0.9105) acc_u 12.5000 (10.3571) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 829
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 471
clean true:284
clean false:187
clean_rate:0.6029723991507431
noisy true:503
noisy false:642
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1145
epoch [61/200] batch [5/14] time 0.186 (0.173) data 0.108 (0.096) loss_x loss_x 0.5117 (0.6879) acc_x 87.5000 (83.7500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/14] time 0.180 (0.174) data 0.103 (0.096) loss_x loss_x 1.0088 (0.8404) acc_x 62.5000 (80.0000) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/35] time 0.185 (0.177) data 0.107 (0.099) loss_u loss_u 0.9409 (0.9352) acc_u 6.2500 (6.8750) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [10/35] time 0.173 (0.177) data 0.094 (0.099) loss_u loss_u 0.9966 (0.9376) acc_u 0.0000 (7.1875) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [15/35] time 0.169 (0.177) data 0.092 (0.099) loss_u loss_u 0.9697 (0.9332) acc_u 3.1250 (7.9167) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/35] time 0.172 (0.177) data 0.093 (0.099) loss_u loss_u 0.8809 (0.9358) acc_u 15.6250 (7.5000) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/35] time 0.189 (0.177) data 0.111 (0.099) loss_u loss_u 0.9062 (0.9312) acc_u 9.3750 (8.0000) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/35] time 0.171 (0.176) data 0.094 (0.098) loss_u loss_u 0.7822 (0.9249) acc_u 21.8750 (8.6458) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [35/35] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9150 (0.9295) acc_u 9.3750 (8.2143) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 874
confident_label rate tensor(0.2741, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 443
clean true:255
clean false:188
clean_rate:0.5756207674943566
noisy true:487
noisy false:686
after delete: len(clean_dataset) 443
after delete: len(noisy_dataset) 1173
epoch [62/200] batch [5/13] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.5312 (0.7727) acc_x 87.5000 (79.3750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/13] time 0.164 (0.175) data 0.087 (0.097) loss_x loss_x 1.1562 (0.7735) acc_x 71.8750 (78.4375) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/36] time 0.163 (0.171) data 0.086 (0.094) loss_u loss_u 0.8809 (0.9262) acc_u 12.5000 (6.8750) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/36] time 0.170 (0.170) data 0.093 (0.093) loss_u loss_u 0.9854 (0.9248) acc_u 0.0000 (7.8125) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/36] time 0.170 (0.172) data 0.092 (0.094) loss_u loss_u 0.9810 (0.9170) acc_u 0.0000 (8.9583) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/36] time 0.178 (0.172) data 0.101 (0.095) loss_u loss_u 0.9600 (0.9183) acc_u 3.1250 (8.7500) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/36] time 0.179 (0.173) data 0.102 (0.095) loss_u loss_u 0.8833 (0.9157) acc_u 15.6250 (9.3750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/36] time 0.185 (0.173) data 0.108 (0.096) loss_u loss_u 0.8877 (0.9148) acc_u 12.5000 (9.5833) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [35/36] time 0.170 (0.174) data 0.092 (0.097) loss_u loss_u 0.8540 (0.9142) acc_u 12.5000 (9.6429) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 865
confident_label rate tensor(0.2710, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 438
clean true:257
clean false:181
clean_rate:0.58675799086758
noisy true:494
noisy false:684
after delete: len(clean_dataset) 438
after delete: len(noisy_dataset) 1178
epoch [63/200] batch [5/13] time 0.172 (0.175) data 0.096 (0.098) loss_x loss_x 0.6348 (0.6742) acc_x 84.3750 (83.1250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/13] time 0.191 (0.178) data 0.114 (0.101) loss_x loss_x 0.3096 (0.6677) acc_x 90.6250 (83.7500) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/36] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.9053 (0.9216) acc_u 9.3750 (9.3750) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/36] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.9751 (0.9353) acc_u 0.0000 (6.8750) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/36] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9058 (0.9279) acc_u 12.5000 (8.1250) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/36] time 0.183 (0.179) data 0.105 (0.101) loss_u loss_u 0.9136 (0.9177) acc_u 12.5000 (9.3750) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/36] time 0.191 (0.180) data 0.113 (0.102) loss_u loss_u 0.8994 (0.9196) acc_u 12.5000 (9.5000) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/36] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.8760 (0.9160) acc_u 12.5000 (9.7917) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [35/36] time 0.182 (0.181) data 0.105 (0.103) loss_u loss_u 0.8755 (0.9120) acc_u 15.6250 (10.1786) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 877
confident_label rate tensor(0.2865, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 463
clean true:264
clean false:199
clean_rate:0.5701943844492441
noisy true:475
noisy false:678
after delete: len(clean_dataset) 463
after delete: len(noisy_dataset) 1153
epoch [64/200] batch [5/14] time 0.174 (0.174) data 0.098 (0.097) loss_x loss_x 0.8784 (0.7944) acc_x 71.8750 (78.1250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/14] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.6670 (0.7894) acc_x 87.5000 (80.0000) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/36] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.9082 (0.8745) acc_u 12.5000 (15.0000) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/36] time 0.159 (0.173) data 0.082 (0.096) loss_u loss_u 0.8838 (0.9055) acc_u 12.5000 (11.2500) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [15/36] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.9702 (0.9130) acc_u 3.1250 (10.2083) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/36] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.9868 (0.9209) acc_u 0.0000 (9.0625) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/36] time 0.183 (0.175) data 0.106 (0.097) loss_u loss_u 0.9370 (0.9187) acc_u 9.3750 (9.3750) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/36] time 0.173 (0.175) data 0.094 (0.098) loss_u loss_u 0.8779 (0.9205) acc_u 15.6250 (9.0625) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [35/36] time 0.170 (0.174) data 0.092 (0.097) loss_u loss_u 0.9653 (0.9157) acc_u 3.1250 (9.6429) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 839
confident_label rate tensor(0.2778, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 449
clean true:270
clean false:179
clean_rate:0.6013363028953229
noisy true:507
noisy false:660
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1167
epoch [65/200] batch [5/14] time 0.171 (0.177) data 0.093 (0.100) loss_x loss_x 0.2563 (0.4646) acc_x 96.8750 (88.7500) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/14] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.6553 (0.6250) acc_x 81.2500 (83.4375) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/36] time 0.162 (0.174) data 0.085 (0.096) loss_u loss_u 0.9629 (0.9169) acc_u 0.0000 (9.3750) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/36] time 0.176 (0.175) data 0.099 (0.098) loss_u loss_u 0.9453 (0.9113) acc_u 9.3750 (11.2500) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/36] time 0.171 (0.175) data 0.093 (0.098) loss_u loss_u 0.9204 (0.9214) acc_u 9.3750 (9.7917) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/36] time 0.176 (0.176) data 0.098 (0.098) loss_u loss_u 0.9185 (0.9234) acc_u 9.3750 (9.5312) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/36] time 0.185 (0.176) data 0.108 (0.098) loss_u loss_u 0.9570 (0.9265) acc_u 9.3750 (9.1250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [30/36] time 0.176 (0.175) data 0.099 (0.098) loss_u loss_u 0.9399 (0.9256) acc_u 6.2500 (9.0625) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [35/36] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.8750 (0.9212) acc_u 15.6250 (9.6429) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 857
confident_label rate tensor(0.2698, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 436
clean true:258
clean false:178
clean_rate:0.591743119266055
noisy true:501
noisy false:679
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1180
epoch [66/200] batch [5/13] time 0.166 (0.165) data 0.089 (0.088) loss_x loss_x 0.9922 (0.7991) acc_x 84.3750 (82.5000) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/13] time 0.167 (0.165) data 0.090 (0.088) loss_x loss_x 1.2773 (0.7839) acc_x 71.8750 (81.8750) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/36] time 0.170 (0.171) data 0.092 (0.094) loss_u loss_u 0.8867 (0.9118) acc_u 15.6250 (10.6250) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/36] time 0.173 (0.173) data 0.095 (0.095) loss_u loss_u 0.8555 (0.8977) acc_u 15.6250 (11.5625) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/36] time 0.181 (0.172) data 0.103 (0.095) loss_u loss_u 0.9043 (0.9002) acc_u 12.5000 (11.4583) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/36] time 0.213 (0.174) data 0.136 (0.097) loss_u loss_u 0.8696 (0.9024) acc_u 18.7500 (11.2500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/36] time 0.170 (0.175) data 0.092 (0.097) loss_u loss_u 0.9458 (0.9027) acc_u 6.2500 (11.0000) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/36] time 0.178 (0.175) data 0.101 (0.097) loss_u loss_u 0.9297 (0.9084) acc_u 9.3750 (10.4167) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [35/36] time 0.172 (0.175) data 0.094 (0.097) loss_u loss_u 0.8770 (0.9088) acc_u 15.6250 (10.5357) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 870
confident_label rate tensor(0.2729, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 441
clean true:265
clean false:176
clean_rate:0.6009070294784581
noisy true:481
noisy false:694
after delete: len(clean_dataset) 441
after delete: len(noisy_dataset) 1175
epoch [67/200] batch [5/13] time 0.180 (0.185) data 0.104 (0.108) loss_x loss_x 0.7622 (0.8036) acc_x 71.8750 (76.8750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/13] time 0.187 (0.178) data 0.110 (0.100) loss_x loss_x 0.7104 (0.7596) acc_x 78.1250 (79.6875) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/36] time 0.195 (0.183) data 0.117 (0.105) loss_u loss_u 0.7988 (0.8803) acc_u 25.0000 (14.3750) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/36] time 0.174 (0.181) data 0.097 (0.103) loss_u loss_u 0.9116 (0.8994) acc_u 12.5000 (11.8750) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/36] time 0.170 (0.179) data 0.093 (0.101) loss_u loss_u 0.9395 (0.9056) acc_u 9.3750 (11.2500) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/36] time 0.190 (0.179) data 0.112 (0.101) loss_u loss_u 0.8750 (0.9038) acc_u 15.6250 (11.5625) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [25/36] time 0.194 (0.179) data 0.117 (0.101) loss_u loss_u 0.8926 (0.9015) acc_u 12.5000 (11.6250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/36] time 0.189 (0.179) data 0.112 (0.101) loss_u loss_u 0.8735 (0.9048) acc_u 12.5000 (11.0417) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [35/36] time 0.178 (0.178) data 0.100 (0.101) loss_u loss_u 0.9556 (0.9062) acc_u 3.1250 (10.8036) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 829
confident_label rate tensor(0.2717, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 439
clean true:266
clean false:173
clean_rate:0.6059225512528473
noisy true:521
noisy false:656
after delete: len(clean_dataset) 439
after delete: len(noisy_dataset) 1177
epoch [68/200] batch [5/13] time 0.190 (0.176) data 0.112 (0.099) loss_x loss_x 1.0332 (1.0287) acc_x 78.1250 (76.8750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/13] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.4429 (0.9269) acc_x 84.3750 (79.6875) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/36] time 0.166 (0.172) data 0.089 (0.095) loss_u loss_u 0.8843 (0.8979) acc_u 15.6250 (12.5000) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/36] time 0.162 (0.170) data 0.084 (0.093) loss_u loss_u 0.9443 (0.8983) acc_u 6.2500 (12.5000) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/36] time 0.187 (0.173) data 0.109 (0.096) loss_u loss_u 0.8945 (0.9102) acc_u 12.5000 (10.6250) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [20/36] time 0.186 (0.175) data 0.108 (0.097) loss_u loss_u 0.8315 (0.9079) acc_u 25.0000 (11.0938) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/36] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9688 (0.9098) acc_u 3.1250 (10.3750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/36] time 0.197 (0.178) data 0.120 (0.100) loss_u loss_u 0.8667 (0.9056) acc_u 18.7500 (10.8333) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [35/36] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.8721 (0.9037) acc_u 18.7500 (11.0714) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 882
confident_label rate tensor(0.2723, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 440
clean true:257
clean false:183
clean_rate:0.5840909090909091
noisy true:477
noisy false:699
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 1176
epoch [69/200] batch [5/13] time 0.172 (0.186) data 0.094 (0.109) loss_x loss_x 0.7217 (0.8690) acc_x 75.0000 (76.2500) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/13] time 0.171 (0.178) data 0.094 (0.101) loss_x loss_x 0.6606 (0.7580) acc_x 84.3750 (78.4375) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/36] time 0.203 (0.179) data 0.123 (0.101) loss_u loss_u 0.9849 (0.8925) acc_u 0.0000 (13.7500) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/36] time 0.167 (0.177) data 0.089 (0.100) loss_u loss_u 0.9580 (0.8970) acc_u 3.1250 (13.1250) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/36] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.8716 (0.8929) acc_u 15.6250 (13.5417) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/36] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.9067 (0.8991) acc_u 12.5000 (12.8125) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/36] time 0.183 (0.176) data 0.106 (0.098) loss_u loss_u 0.9609 (0.9036) acc_u 6.2500 (12.0000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [30/36] time 0.175 (0.176) data 0.098 (0.099) loss_u loss_u 0.9521 (0.9096) acc_u 6.2500 (11.2500) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [35/36] time 0.180 (0.177) data 0.103 (0.099) loss_u loss_u 0.9800 (0.9111) acc_u 3.1250 (11.1607) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 852
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 437
clean true:259
clean false:178
clean_rate:0.5926773455377574
noisy true:505
noisy false:674
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1179
epoch [70/200] batch [5/13] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.5752 (0.5585) acc_x 81.2500 (84.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/13] time 0.178 (0.177) data 0.102 (0.100) loss_x loss_x 0.9170 (0.5698) acc_x 75.0000 (84.6875) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/36] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.9136 (0.8882) acc_u 9.3750 (13.7500) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/36] time 0.186 (0.175) data 0.109 (0.098) loss_u loss_u 0.8638 (0.8828) acc_u 15.6250 (13.7500) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/36] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.8696 (0.8888) acc_u 15.6250 (12.9167) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/36] time 0.160 (0.176) data 0.082 (0.099) loss_u loss_u 0.8911 (0.8922) acc_u 12.5000 (12.9688) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/36] time 0.167 (0.175) data 0.090 (0.098) loss_u loss_u 0.9409 (0.8993) acc_u 6.2500 (12.0000) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [30/36] time 0.174 (0.175) data 0.096 (0.098) loss_u loss_u 0.8901 (0.9023) acc_u 12.5000 (11.6667) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [35/36] time 0.172 (0.175) data 0.095 (0.097) loss_u loss_u 0.8853 (0.9045) acc_u 15.6250 (11.6071) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 850
confident_label rate tensor(0.2958, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 478
clean true:275
clean false:203
clean_rate:0.5753138075313807
noisy true:491
noisy false:647
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1138
epoch [71/200] batch [5/14] time 0.173 (0.183) data 0.096 (0.106) loss_x loss_x 1.1211 (0.7949) acc_x 71.8750 (84.3750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [10/14] time 0.187 (0.180) data 0.108 (0.102) loss_x loss_x 0.7266 (0.8105) acc_x 84.3750 (82.5000) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/35] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.9355 (0.9125) acc_u 6.2500 (10.0000) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/35] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.9199 (0.9167) acc_u 12.5000 (9.6875) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/35] time 0.178 (0.178) data 0.100 (0.101) loss_u loss_u 0.9800 (0.9178) acc_u 3.1250 (9.3750) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/35] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9048 (0.9145) acc_u 9.3750 (9.8438) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/35] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.9556 (0.9150) acc_u 6.2500 (9.3750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [30/35] time 0.185 (0.178) data 0.108 (0.100) loss_u loss_u 0.9224 (0.9168) acc_u 9.3750 (9.1667) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [35/35] time 0.161 (0.177) data 0.085 (0.100) loss_u loss_u 0.8975 (0.9167) acc_u 15.6250 (9.2857) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 856
confident_label rate tensor(0.2785, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 450
clean true:261
clean false:189
clean_rate:0.58
noisy true:499
noisy false:667
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1166
epoch [72/200] batch [5/14] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 1.1172 (0.6882) acc_x 71.8750 (85.0000) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/14] time 0.187 (0.181) data 0.109 (0.104) loss_x loss_x 0.6802 (0.7135) acc_x 78.1250 (82.1875) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/36] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.8892 (0.8763) acc_u 12.5000 (13.7500) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/36] time 0.170 (0.178) data 0.091 (0.101) loss_u loss_u 0.8545 (0.8948) acc_u 21.8750 (11.8750) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/36] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.9478 (0.8980) acc_u 9.3750 (11.8750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/36] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.9092 (0.9049) acc_u 6.2500 (10.7812) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [25/36] time 0.170 (0.175) data 0.092 (0.098) loss_u loss_u 0.8955 (0.9104) acc_u 15.6250 (10.3750) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [30/36] time 0.158 (0.174) data 0.081 (0.097) loss_u loss_u 0.8696 (0.9039) acc_u 15.6250 (11.4583) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [35/36] time 0.177 (0.175) data 0.099 (0.097) loss_u loss_u 0.8896 (0.9038) acc_u 12.5000 (11.6071) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 861
confident_label rate tensor(0.2964, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 479
clean true:271
clean false:208
clean_rate:0.5657620041753654
noisy true:484
noisy false:653
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1137
epoch [73/200] batch [5/14] time 0.186 (0.173) data 0.109 (0.096) loss_x loss_x 0.5269 (0.6800) acc_x 87.5000 (81.8750) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/14] time 0.176 (0.176) data 0.098 (0.099) loss_x loss_x 0.8726 (0.8013) acc_x 78.1250 (79.6875) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/35] time 0.186 (0.176) data 0.108 (0.098) loss_u loss_u 0.8789 (0.9229) acc_u 12.5000 (10.0000) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/35] time 0.170 (0.175) data 0.092 (0.097) loss_u loss_u 0.9009 (0.9164) acc_u 12.5000 (10.0000) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [15/35] time 0.172 (0.174) data 0.094 (0.096) loss_u loss_u 0.9531 (0.9210) acc_u 3.1250 (8.9583) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/35] time 0.174 (0.175) data 0.096 (0.097) loss_u loss_u 0.9517 (0.9247) acc_u 6.2500 (8.5938) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/35] time 0.177 (0.174) data 0.099 (0.097) loss_u loss_u 0.9497 (0.9180) acc_u 6.2500 (9.6250) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [30/35] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.9424 (0.9228) acc_u 6.2500 (9.1667) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [35/35] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.9893 (0.9233) acc_u 0.0000 (8.8393) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 865
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:260
clean false:204
clean_rate:0.5603448275862069
noisy true:491
noisy false:661
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [74/200] batch [5/14] time 0.168 (0.181) data 0.091 (0.104) loss_x loss_x 0.8872 (0.8087) acc_x 75.0000 (76.8750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/14] time 0.181 (0.174) data 0.104 (0.097) loss_x loss_x 0.7310 (0.8107) acc_x 87.5000 (78.7500) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/36] time 0.188 (0.175) data 0.111 (0.098) loss_u loss_u 0.8765 (0.9069) acc_u 15.6250 (10.6250) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/36] time 0.166 (0.174) data 0.089 (0.097) loss_u loss_u 0.8501 (0.8857) acc_u 18.7500 (13.1250) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/36] time 0.167 (0.174) data 0.090 (0.096) loss_u loss_u 0.9658 (0.8984) acc_u 6.2500 (12.2917) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/36] time 0.183 (0.173) data 0.106 (0.096) loss_u loss_u 0.9229 (0.9051) acc_u 9.3750 (11.8750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/36] time 0.178 (0.173) data 0.101 (0.096) loss_u loss_u 0.9653 (0.9091) acc_u 3.1250 (11.1250) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [30/36] time 0.178 (0.174) data 0.100 (0.097) loss_u loss_u 0.9150 (0.9091) acc_u 12.5000 (11.1458) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [35/36] time 0.174 (0.173) data 0.096 (0.096) loss_u loss_u 0.8677 (0.9104) acc_u 15.6250 (11.0714) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 845
confident_label rate tensor(0.2933, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 474
clean true:279
clean false:195
clean_rate:0.5886075949367089
noisy true:492
noisy false:650
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1142
epoch [75/200] batch [5/14] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.6465 (0.6369) acc_x 87.5000 (83.1250) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/14] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.7979 (0.7662) acc_x 75.0000 (80.9375) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/35] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.8564 (0.8795) acc_u 15.6250 (13.1250) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [10/35] time 0.168 (0.178) data 0.090 (0.100) loss_u loss_u 0.9443 (0.9021) acc_u 9.3750 (11.2500) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/35] time 0.168 (0.177) data 0.089 (0.099) loss_u loss_u 0.9302 (0.9092) acc_u 9.3750 (10.8333) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/35] time 0.170 (0.175) data 0.092 (0.098) loss_u loss_u 0.9028 (0.9093) acc_u 9.3750 (10.4688) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/35] time 0.186 (0.175) data 0.109 (0.097) loss_u loss_u 0.8965 (0.9124) acc_u 12.5000 (10.0000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [30/35] time 0.178 (0.175) data 0.101 (0.098) loss_u loss_u 0.9253 (0.9120) acc_u 6.2500 (10.3125) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [35/35] time 0.191 (0.176) data 0.114 (0.099) loss_u loss_u 0.8438 (0.9128) acc_u 15.6250 (10.0000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 853
confident_label rate tensor(0.2785, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 450
clean true:260
clean false:190
clean_rate:0.5777777777777777
noisy true:503
noisy false:663
after delete: len(clean_dataset) 450
after delete: len(noisy_dataset) 1166
epoch [76/200] batch [5/14] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.6821 (0.6763) acc_x 84.3750 (84.3750) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [10/14] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.8013 (0.8005) acc_x 78.1250 (81.2500) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/36] time 0.175 (0.177) data 0.097 (0.100) loss_u loss_u 0.9126 (0.8925) acc_u 6.2500 (13.7500) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/36] time 0.194 (0.177) data 0.115 (0.100) loss_u loss_u 0.8945 (0.9046) acc_u 12.5000 (11.5625) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/36] time 0.177 (0.175) data 0.097 (0.097) loss_u loss_u 0.8867 (0.9086) acc_u 15.6250 (10.8333) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/36] time 0.221 (0.182) data 0.144 (0.104) loss_u loss_u 0.9409 (0.9167) acc_u 9.3750 (9.8438) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/36] time 0.189 (0.181) data 0.109 (0.104) loss_u loss_u 0.9263 (0.9145) acc_u 9.3750 (10.2500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/36] time 0.170 (0.182) data 0.093 (0.104) loss_u loss_u 0.9048 (0.9053) acc_u 9.3750 (11.1458) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [35/36] time 0.177 (0.181) data 0.100 (0.103) loss_u loss_u 0.8472 (0.8969) acc_u 18.7500 (12.2321) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 864
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 471
clean true:268
clean false:203
clean_rate:0.5690021231422505
noisy true:484
noisy false:661
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1145
epoch [77/200] batch [5/14] time 0.180 (0.172) data 0.103 (0.096) loss_x loss_x 0.4253 (0.9386) acc_x 90.6250 (74.3750) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/14] time 0.162 (0.170) data 0.085 (0.093) loss_x loss_x 0.6841 (0.9644) acc_x 81.2500 (75.3125) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/35] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.8433 (0.9110) acc_u 18.7500 (11.2500) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/35] time 0.169 (0.174) data 0.092 (0.097) loss_u loss_u 0.8936 (0.8947) acc_u 12.5000 (13.7500) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/35] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.8862 (0.8907) acc_u 15.6250 (13.9583) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/35] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.9072 (0.8989) acc_u 9.3750 (12.8125) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/35] time 0.160 (0.175) data 0.081 (0.098) loss_u loss_u 0.9551 (0.9067) acc_u 6.2500 (12.0000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/35] time 0.160 (0.174) data 0.083 (0.097) loss_u loss_u 0.8813 (0.9040) acc_u 12.5000 (12.1875) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [35/35] time 0.178 (0.174) data 0.101 (0.096) loss_u loss_u 0.9575 (0.9031) acc_u 3.1250 (12.2321) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 847
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:275
clean false:205
clean_rate:0.5729166666666666
noisy true:494
noisy false:642
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [78/200] batch [5/15] time 0.179 (0.181) data 0.101 (0.103) loss_x loss_x 0.7266 (0.7569) acc_x 75.0000 (78.1250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/15] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.8521 (0.7456) acc_x 75.0000 (78.1250) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [15/15] time 0.173 (0.179) data 0.097 (0.102) loss_x loss_x 0.4783 (0.7140) acc_x 78.1250 (79.1667) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/35] time 0.168 (0.178) data 0.092 (0.101) loss_u loss_u 0.8999 (0.8989) acc_u 12.5000 (12.5000) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/35] time 0.178 (0.179) data 0.101 (0.102) loss_u loss_u 0.8564 (0.9085) acc_u 15.6250 (10.6250) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/35] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.9370 (0.9170) acc_u 6.2500 (9.3750) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/35] time 0.178 (0.178) data 0.100 (0.100) loss_u loss_u 0.9419 (0.9145) acc_u 6.2500 (10.0000) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/35] time 0.182 (0.177) data 0.105 (0.099) loss_u loss_u 0.8936 (0.9115) acc_u 12.5000 (10.2500) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [30/35] time 0.167 (0.177) data 0.090 (0.099) loss_u loss_u 0.9644 (0.9134) acc_u 3.1250 (10.0000) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [35/35] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.8550 (0.9158) acc_u 18.7500 (9.9107) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 853
confident_label rate tensor(0.2890, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 467
clean true:273
clean false:194
clean_rate:0.5845824411134903
noisy true:490
noisy false:659
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 1149
epoch [79/200] batch [5/14] time 0.165 (0.181) data 0.089 (0.104) loss_x loss_x 0.4858 (0.7708) acc_x 87.5000 (78.1250) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/14] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.6377 (0.7555) acc_x 84.3750 (81.5625) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/35] time 0.179 (0.184) data 0.100 (0.106) loss_u loss_u 0.9360 (0.9361) acc_u 6.2500 (9.3750) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/35] time 0.172 (0.183) data 0.093 (0.105) loss_u loss_u 0.9717 (0.9244) acc_u 3.1250 (9.3750) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/35] time 0.177 (0.181) data 0.099 (0.103) loss_u loss_u 0.8999 (0.9176) acc_u 15.6250 (10.0000) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/35] time 0.166 (0.180) data 0.087 (0.102) loss_u loss_u 0.9170 (0.9216) acc_u 12.5000 (9.5312) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/35] time 0.186 (0.179) data 0.107 (0.101) loss_u loss_u 0.8857 (0.9139) acc_u 12.5000 (10.2500) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [30/35] time 0.174 (0.180) data 0.095 (0.102) loss_u loss_u 0.8862 (0.9123) acc_u 12.5000 (10.2083) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [35/35] time 0.177 (0.180) data 0.099 (0.102) loss_u loss_u 0.8740 (0.9116) acc_u 12.5000 (10.3571) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 860
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 453
clean true:255
clean false:198
clean_rate:0.5629139072847682
noisy true:501
noisy false:662
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1163
epoch [80/200] batch [5/14] time 0.186 (0.176) data 0.109 (0.098) loss_x loss_x 0.7749 (0.7435) acc_x 78.1250 (78.7500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [10/14] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.7441 (0.7061) acc_x 81.2500 (79.6875) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/36] time 0.182 (0.175) data 0.105 (0.097) loss_u loss_u 0.8936 (0.8861) acc_u 12.5000 (13.1250) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/36] time 0.166 (0.173) data 0.089 (0.096) loss_u loss_u 0.9321 (0.9005) acc_u 9.3750 (12.1875) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/36] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.8599 (0.8978) acc_u 18.7500 (12.0833) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/36] time 0.168 (0.174) data 0.090 (0.097) loss_u loss_u 0.8574 (0.8870) acc_u 18.7500 (13.4375) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/36] time 0.169 (0.174) data 0.091 (0.097) loss_u loss_u 0.9478 (0.8961) acc_u 9.3750 (12.3750) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/36] time 0.166 (0.173) data 0.087 (0.095) loss_u loss_u 0.8867 (0.8966) acc_u 12.5000 (12.2917) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [35/36] time 0.173 (0.173) data 0.096 (0.095) loss_u loss_u 0.8994 (0.8986) acc_u 9.3750 (11.9643) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 856
confident_label rate tensor(0.2896, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 468
clean true:260
clean false:208
clean_rate:0.5555555555555556
noisy true:500
noisy false:648
after delete: len(clean_dataset) 468
after delete: len(noisy_dataset) 1148
epoch [81/200] batch [5/14] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.7241 (0.8114) acc_x 84.3750 (80.0000) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/14] time 0.172 (0.180) data 0.096 (0.103) loss_x loss_x 0.5605 (0.6739) acc_x 84.3750 (82.8125) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/35] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9746 (0.8951) acc_u 3.1250 (12.5000) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/35] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.9502 (0.9029) acc_u 6.2500 (11.2500) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [15/35] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.8936 (0.9070) acc_u 12.5000 (10.6250) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/35] time 0.173 (0.179) data 0.095 (0.102) loss_u loss_u 0.9390 (0.9028) acc_u 6.2500 (10.9375) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/35] time 0.180 (0.178) data 0.103 (0.101) loss_u loss_u 0.9561 (0.9078) acc_u 6.2500 (10.6250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [30/35] time 0.174 (0.178) data 0.096 (0.100) loss_u loss_u 0.9917 (0.9062) acc_u 0.0000 (10.8333) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [35/35] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.8872 (0.9049) acc_u 12.5000 (11.0714) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 859
confident_label rate tensor(0.2871, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 464
clean true:268
clean false:196
clean_rate:0.5775862068965517
noisy true:489
noisy false:663
after delete: len(clean_dataset) 464
after delete: len(noisy_dataset) 1152
epoch [82/200] batch [5/14] time 0.171 (0.172) data 0.093 (0.095) loss_x loss_x 0.3203 (0.6598) acc_x 96.8750 (85.0000) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [10/14] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 0.8647 (0.7049) acc_x 84.3750 (84.0625) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/36] time 0.164 (0.173) data 0.087 (0.096) loss_u loss_u 0.8999 (0.9308) acc_u 12.5000 (9.3750) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/36] time 0.185 (0.175) data 0.107 (0.097) loss_u loss_u 0.9326 (0.8997) acc_u 6.2500 (12.1875) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/36] time 0.168 (0.174) data 0.091 (0.097) loss_u loss_u 0.9438 (0.9083) acc_u 6.2500 (11.0417) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/36] time 0.181 (0.174) data 0.102 (0.097) loss_u loss_u 0.9351 (0.9106) acc_u 9.3750 (10.9375) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/36] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.8340 (0.9031) acc_u 21.8750 (11.6250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [30/36] time 0.168 (0.175) data 0.090 (0.098) loss_u loss_u 0.9404 (0.9017) acc_u 6.2500 (11.6667) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [35/36] time 0.176 (0.175) data 0.098 (0.098) loss_u loss_u 0.8438 (0.9008) acc_u 18.7500 (11.7857) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 893
confident_label rate tensor(0.2976, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 481
clean true:263
clean false:218
clean_rate:0.5467775467775468
noisy true:460
noisy false:675
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1135
epoch [83/200] batch [5/15] time 0.170 (0.167) data 0.093 (0.090) loss_x loss_x 0.4001 (0.5996) acc_x 87.5000 (83.7500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/15] time 0.187 (0.173) data 0.109 (0.095) loss_x loss_x 0.9946 (0.7181) acc_x 81.2500 (83.1250) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [15/15] time 0.175 (0.174) data 0.097 (0.096) loss_x loss_x 1.3887 (0.7384) acc_x 59.3750 (81.8750) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/35] time 0.177 (0.176) data 0.099 (0.099) loss_u loss_u 0.9878 (0.9422) acc_u 3.1250 (7.5000) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/35] time 0.170 (0.175) data 0.092 (0.098) loss_u loss_u 0.8716 (0.9141) acc_u 15.6250 (10.3125) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/35] time 0.180 (0.175) data 0.101 (0.097) loss_u loss_u 0.9253 (0.9147) acc_u 9.3750 (10.4167) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/35] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.8501 (0.9100) acc_u 15.6250 (11.0938) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/35] time 0.187 (0.175) data 0.109 (0.098) loss_u loss_u 0.8857 (0.9124) acc_u 15.6250 (10.8750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [30/35] time 0.166 (0.176) data 0.089 (0.098) loss_u loss_u 0.9517 (0.9152) acc_u 6.2500 (10.4167) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [35/35] time 0.187 (0.176) data 0.110 (0.098) loss_u loss_u 0.9634 (0.9120) acc_u 3.1250 (10.7143) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 896
confident_label rate tensor(0.2847, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 460
clean true:251
clean false:209
clean_rate:0.5456521739130434
noisy true:469
noisy false:687
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1156
epoch [84/200] batch [5/14] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.8442 (0.7138) acc_x 71.8750 (81.2500) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/14] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.4844 (0.7534) acc_x 81.2500 (79.0625) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/36] time 0.176 (0.177) data 0.099 (0.100) loss_u loss_u 0.8740 (0.8683) acc_u 12.5000 (16.2500) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/36] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.9478 (0.9014) acc_u 3.1250 (11.8750) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/36] time 0.180 (0.178) data 0.102 (0.101) loss_u loss_u 0.9146 (0.9027) acc_u 9.3750 (11.2500) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/36] time 0.184 (0.179) data 0.107 (0.101) loss_u loss_u 0.9771 (0.9013) acc_u 6.2500 (11.5625) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/36] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.8809 (0.9018) acc_u 12.5000 (11.3750) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [30/36] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.8398 (0.9033) acc_u 18.7500 (11.0417) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [35/36] time 0.187 (0.180) data 0.110 (0.103) loss_u loss_u 0.9150 (0.9014) acc_u 15.6250 (11.4286) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 860
confident_label rate tensor(0.3051, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 493
clean true:268
clean false:225
clean_rate:0.5436105476673428
noisy true:488
noisy false:635
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1123
epoch [85/200] batch [5/15] time 0.187 (0.186) data 0.109 (0.109) loss_x loss_x 0.5918 (0.6260) acc_x 81.2500 (84.3750) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/15] time 0.190 (0.182) data 0.113 (0.105) loss_x loss_x 0.9590 (0.6854) acc_x 81.2500 (83.7500) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [15/15] time 0.189 (0.182) data 0.112 (0.105) loss_x loss_x 0.3398 (0.6899) acc_x 90.6250 (82.9167) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/35] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.9326 (0.9429) acc_u 12.5000 (7.5000) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/35] time 0.164 (0.183) data 0.087 (0.106) loss_u loss_u 0.8857 (0.9240) acc_u 12.5000 (9.0625) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/35] time 0.186 (0.183) data 0.107 (0.106) loss_u loss_u 0.9517 (0.9225) acc_u 6.2500 (9.3750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/35] time 0.171 (0.182) data 0.094 (0.105) loss_u loss_u 0.9150 (0.9197) acc_u 9.3750 (9.5312) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/35] time 0.178 (0.181) data 0.098 (0.104) loss_u loss_u 0.8853 (0.9190) acc_u 12.5000 (9.6250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [30/35] time 0.173 (0.181) data 0.096 (0.104) loss_u loss_u 0.9609 (0.9266) acc_u 3.1250 (8.7500) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [35/35] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8413 (0.9196) acc_u 18.7500 (9.6429) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 848
confident_label rate tensor(0.2921, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 472
clean true:264
clean false:208
clean_rate:0.559322033898305
noisy true:504
noisy false:640
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 1144
epoch [86/200] batch [5/14] time 0.167 (0.193) data 0.090 (0.116) loss_x loss_x 0.5840 (0.6521) acc_x 78.1250 (78.7500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [10/14] time 0.178 (0.183) data 0.102 (0.106) loss_x loss_x 0.9365 (0.6500) acc_x 81.2500 (82.1875) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/35] time 0.192 (0.181) data 0.115 (0.104) loss_u loss_u 0.9224 (0.9028) acc_u 9.3750 (10.6250) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/35] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 0.9395 (0.9068) acc_u 9.3750 (10.6250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/35] time 0.170 (0.179) data 0.092 (0.102) loss_u loss_u 0.9438 (0.9131) acc_u 9.3750 (10.2083) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [20/35] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.8027 (0.9049) acc_u 21.8750 (11.0938) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/35] time 0.179 (0.178) data 0.101 (0.101) loss_u loss_u 0.8862 (0.8950) acc_u 15.6250 (12.1250) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [30/35] time 0.211 (0.179) data 0.133 (0.101) loss_u loss_u 0.8711 (0.8958) acc_u 12.5000 (11.9792) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [35/35] time 0.172 (0.179) data 0.095 (0.101) loss_u loss_u 0.8755 (0.8986) acc_u 18.7500 (11.6964) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 851
confident_label rate tensor(0.2927, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 473
clean true:274
clean false:199
clean_rate:0.5792811839323467
noisy true:491
noisy false:652
after delete: len(clean_dataset) 473
after delete: len(noisy_dataset) 1143
epoch [87/200] batch [5/14] time 0.174 (0.174) data 0.096 (0.096) loss_x loss_x 0.4802 (0.6601) acc_x 84.3750 (80.0000) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/14] time 0.170 (0.171) data 0.094 (0.094) loss_x loss_x 1.1582 (0.7562) acc_x 68.7500 (79.6875) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/35] time 0.172 (0.173) data 0.095 (0.096) loss_u loss_u 0.8765 (0.9083) acc_u 12.5000 (10.0000) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/35] time 0.171 (0.173) data 0.094 (0.096) loss_u loss_u 0.9058 (0.8931) acc_u 12.5000 (12.8125) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/35] time 0.186 (0.173) data 0.109 (0.095) loss_u loss_u 0.8926 (0.8996) acc_u 9.3750 (11.8750) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/35] time 0.174 (0.173) data 0.096 (0.096) loss_u loss_u 0.7974 (0.8917) acc_u 21.8750 (12.1875) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/35] time 0.176 (0.174) data 0.098 (0.097) loss_u loss_u 0.9502 (0.8985) acc_u 6.2500 (11.5000) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [30/35] time 0.165 (0.174) data 0.088 (0.097) loss_u loss_u 0.9434 (0.9018) acc_u 6.2500 (11.1458) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [35/35] time 0.181 (0.175) data 0.104 (0.097) loss_u loss_u 0.9883 (0.9009) acc_u 0.0000 (11.2500) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 866
confident_label rate tensor(0.2995, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 484
clean true:262
clean false:222
clean_rate:0.5413223140495868
noisy true:488
noisy false:644
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1132
epoch [88/200] batch [5/15] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.4878 (0.7064) acc_x 84.3750 (81.2500) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [10/15] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.8281 (0.6826) acc_x 78.1250 (83.4375) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [15/15] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.4912 (0.6429) acc_x 87.5000 (84.5833) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/35] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.9536 (0.9145) acc_u 3.1250 (10.0000) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/35] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.9702 (0.9054) acc_u 3.1250 (11.2500) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/35] time 0.160 (0.178) data 0.083 (0.101) loss_u loss_u 0.9629 (0.9081) acc_u 6.2500 (10.8333) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/35] time 0.175 (0.177) data 0.097 (0.100) loss_u loss_u 0.9180 (0.9122) acc_u 9.3750 (10.4688) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/35] time 0.187 (0.177) data 0.108 (0.100) loss_u loss_u 0.8447 (0.9031) acc_u 15.6250 (11.6250) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [30/35] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.8506 (0.9050) acc_u 21.8750 (11.4583) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [35/35] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.9468 (0.9094) acc_u 6.2500 (10.8929) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 850
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 476
clean true:263
clean false:213
clean_rate:0.5525210084033614
noisy true:503
noisy false:637
after delete: len(clean_dataset) 476
after delete: len(noisy_dataset) 1140
epoch [89/200] batch [5/14] time 0.193 (0.171) data 0.116 (0.095) loss_x loss_x 0.3442 (0.6953) acc_x 93.7500 (81.2500) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [10/14] time 0.162 (0.169) data 0.085 (0.093) loss_x loss_x 1.0400 (0.7989) acc_x 75.0000 (79.3750) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/35] time 0.166 (0.173) data 0.089 (0.096) loss_u loss_u 0.9028 (0.8920) acc_u 12.5000 (12.5000) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/35] time 0.174 (0.173) data 0.098 (0.096) loss_u loss_u 0.9316 (0.8886) acc_u 6.2500 (13.1250) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/35] time 0.174 (0.174) data 0.097 (0.097) loss_u loss_u 0.9194 (0.9031) acc_u 12.5000 (11.6667) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/35] time 0.173 (0.173) data 0.096 (0.096) loss_u loss_u 0.9194 (0.9057) acc_u 9.3750 (11.5625) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/35] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.8726 (0.9038) acc_u 15.6250 (11.8750) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [30/35] time 0.180 (0.174) data 0.101 (0.097) loss_u loss_u 0.8711 (0.9030) acc_u 15.6250 (12.0833) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [35/35] time 0.177 (0.175) data 0.098 (0.098) loss_u loss_u 0.7866 (0.8992) acc_u 25.0000 (12.4107) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 873
confident_label rate tensor(0.2983, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 482
clean true:266
clean false:216
clean_rate:0.5518672199170125
noisy true:477
noisy false:657
after delete: len(clean_dataset) 482
after delete: len(noisy_dataset) 1134
epoch [90/200] batch [5/15] time 0.172 (0.180) data 0.095 (0.104) loss_x loss_x 0.8896 (0.7978) acc_x 87.5000 (83.7500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [10/15] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.7573 (0.7579) acc_x 78.1250 (83.1250) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [15/15] time 0.164 (0.176) data 0.088 (0.099) loss_x loss_x 1.0576 (0.7810) acc_x 78.1250 (81.2500) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/35] time 0.178 (0.177) data 0.101 (0.100) loss_u loss_u 0.9668 (0.9079) acc_u 3.1250 (11.2500) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/35] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9009 (0.9137) acc_u 12.5000 (10.6250) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/35] time 0.176 (0.176) data 0.099 (0.099) loss_u loss_u 0.9648 (0.9105) acc_u 3.1250 (10.8333) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/35] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.9424 (0.9079) acc_u 6.2500 (11.0938) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/35] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.9263 (0.9086) acc_u 9.3750 (11.0000) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [30/35] time 0.175 (0.178) data 0.098 (0.100) loss_u loss_u 0.9307 (0.9049) acc_u 6.2500 (11.2500) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [35/35] time 0.202 (0.178) data 0.124 (0.101) loss_u loss_u 0.8901 (0.9029) acc_u 12.5000 (11.4286) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 869
confident_label rate tensor(0.2958, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 478
clean true:260
clean false:218
clean_rate:0.5439330543933054
noisy true:487
noisy false:651
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1138
epoch [91/200] batch [5/14] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.5908 (0.9092) acc_x 81.2500 (76.8750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [10/14] time 0.187 (0.176) data 0.110 (0.099) loss_x loss_x 0.8604 (0.8468) acc_x 84.3750 (77.8125) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/35] time 0.171 (0.175) data 0.094 (0.098) loss_u loss_u 0.8247 (0.9074) acc_u 18.7500 (10.0000) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/35] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.9277 (0.8920) acc_u 9.3750 (12.1875) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/35] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.9390 (0.9003) acc_u 9.3750 (11.4583) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/35] time 0.168 (0.174) data 0.091 (0.096) loss_u loss_u 0.9600 (0.9059) acc_u 3.1250 (10.9375) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/35] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.8662 (0.9059) acc_u 12.5000 (11.2500) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [30/35] time 0.177 (0.175) data 0.099 (0.098) loss_u loss_u 0.9253 (0.9041) acc_u 9.3750 (11.4583) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [35/35] time 0.174 (0.174) data 0.097 (0.097) loss_u loss_u 0.9229 (0.9015) acc_u 9.3750 (11.8750) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 880
confident_label rate tensor(0.3038, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 491
clean true:267
clean false:224
clean_rate:0.5437881873727087
noisy true:469
noisy false:656
after delete: len(clean_dataset) 491
after delete: len(noisy_dataset) 1125
epoch [92/200] batch [5/15] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.5425 (0.6589) acc_x 84.3750 (82.5000) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/15] time 0.177 (0.163) data 0.100 (0.086) loss_x loss_x 0.9546 (0.7024) acc_x 84.3750 (83.1250) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [15/15] time 0.213 (0.171) data 0.136 (0.094) loss_x loss_x 0.6592 (0.7530) acc_x 84.3750 (81.2500) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/35] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.8247 (0.8735) acc_u 21.8750 (13.7500) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/35] time 0.184 (0.179) data 0.105 (0.102) loss_u loss_u 0.9243 (0.8956) acc_u 6.2500 (11.8750) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/35] time 0.161 (0.179) data 0.082 (0.102) loss_u loss_u 0.8589 (0.8946) acc_u 18.7500 (12.2917) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [20/35] time 0.168 (0.178) data 0.091 (0.100) loss_u loss_u 0.8848 (0.9001) acc_u 12.5000 (11.5625) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/35] time 0.178 (0.178) data 0.101 (0.100) loss_u loss_u 0.9316 (0.9085) acc_u 6.2500 (10.5000) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [30/35] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.8018 (0.9033) acc_u 21.8750 (11.1458) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [35/35] time 0.176 (0.178) data 0.098 (0.100) loss_u loss_u 0.8350 (0.9039) acc_u 18.7500 (10.9821) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 845
confident_label rate tensor(0.3026, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 489
clean true:272
clean false:217
clean_rate:0.556237218813906
noisy true:499
noisy false:628
after delete: len(clean_dataset) 489
after delete: len(noisy_dataset) 1127
epoch [93/200] batch [5/15] time 0.165 (0.181) data 0.088 (0.104) loss_x loss_x 0.3787 (0.6521) acc_x 84.3750 (80.6250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [10/15] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 0.9219 (0.6324) acc_x 81.2500 (82.1875) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [15/15] time 0.187 (0.174) data 0.110 (0.097) loss_x loss_x 0.3379 (0.6333) acc_x 87.5000 (82.7083) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/35] time 0.170 (0.175) data 0.092 (0.098) loss_u loss_u 0.9238 (0.9389) acc_u 9.3750 (6.2500) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/35] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.9316 (0.9254) acc_u 9.3750 (8.7500) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/35] time 0.161 (0.175) data 0.083 (0.098) loss_u loss_u 0.9155 (0.9167) acc_u 9.3750 (10.2083) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/35] time 0.187 (0.176) data 0.110 (0.099) loss_u loss_u 0.8403 (0.9124) acc_u 18.7500 (10.4688) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/35] time 0.189 (0.177) data 0.112 (0.100) loss_u loss_u 0.9062 (0.9085) acc_u 9.3750 (11.1250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [30/35] time 0.172 (0.178) data 0.094 (0.100) loss_u loss_u 0.8086 (0.9000) acc_u 21.8750 (11.9792) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [35/35] time 0.174 (0.178) data 0.097 (0.101) loss_u loss_u 0.9277 (0.9075) acc_u 9.3750 (11.0714) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 880
confident_label rate tensor(0.2964, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 479
clean true:261
clean false:218
clean_rate:0.5448851774530271
noisy true:475
noisy false:662
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1137
epoch [94/200] batch [5/14] time 0.164 (0.173) data 0.087 (0.095) loss_x loss_x 0.5083 (0.6759) acc_x 90.6250 (84.3750) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [10/14] time 0.174 (0.173) data 0.097 (0.096) loss_x loss_x 1.0654 (0.7094) acc_x 68.7500 (81.2500) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/35] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9224 (0.8933) acc_u 6.2500 (13.7500) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/35] time 0.173 (0.176) data 0.095 (0.099) loss_u loss_u 0.8604 (0.8943) acc_u 15.6250 (12.8125) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/35] time 0.192 (0.176) data 0.115 (0.099) loss_u loss_u 0.9399 (0.8967) acc_u 9.3750 (12.7083) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/35] time 0.180 (0.177) data 0.103 (0.100) loss_u loss_u 0.9595 (0.9009) acc_u 6.2500 (12.1875) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/35] time 0.181 (0.178) data 0.102 (0.101) loss_u loss_u 0.9292 (0.9009) acc_u 6.2500 (12.0000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/35] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.9443 (0.9017) acc_u 6.2500 (11.6667) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [35/35] time 0.173 (0.178) data 0.096 (0.100) loss_u loss_u 0.8818 (0.9005) acc_u 15.6250 (11.6071) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 862
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:269
clean false:230
clean_rate:0.5390781563126252
noisy true:485
noisy false:632
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [95/200] batch [5/15] time 0.167 (0.165) data 0.090 (0.088) loss_x loss_x 0.5400 (0.7193) acc_x 84.3750 (81.8750) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/15] time 0.181 (0.171) data 0.103 (0.094) loss_x loss_x 0.4861 (0.6166) acc_x 87.5000 (85.0000) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [15/15] time 0.183 (0.175) data 0.106 (0.097) loss_x loss_x 0.6367 (0.6697) acc_x 81.2500 (82.7083) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/34] time 0.165 (0.176) data 0.087 (0.099) loss_u loss_u 0.8164 (0.8892) acc_u 21.8750 (13.1250) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/34] time 0.167 (0.175) data 0.089 (0.097) loss_u loss_u 0.8945 (0.8817) acc_u 12.5000 (14.0625) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/34] time 0.170 (0.174) data 0.093 (0.096) loss_u loss_u 0.9941 (0.8967) acc_u 0.0000 (11.8750) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/34] time 0.169 (0.174) data 0.092 (0.096) loss_u loss_u 0.9028 (0.8932) acc_u 9.3750 (12.6562) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/34] time 0.166 (0.173) data 0.089 (0.096) loss_u loss_u 0.8945 (0.8959) acc_u 18.7500 (13.0000) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [30/34] time 0.168 (0.173) data 0.091 (0.095) loss_u loss_u 0.9561 (0.9040) acc_u 3.1250 (11.7708) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 890
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:266
clean false:233
clean_rate:0.533066132264529
noisy true:460
noisy false:657
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [96/200] batch [5/15] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.8130 (0.7169) acc_x 81.2500 (83.7500) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [10/15] time 0.184 (0.185) data 0.106 (0.107) loss_x loss_x 0.7075 (0.6790) acc_x 84.3750 (84.6875) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [15/15] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.4180 (0.7278) acc_x 84.3750 (83.1250) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/34] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9121 (0.8930) acc_u 9.3750 (12.5000) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/34] time 0.165 (0.183) data 0.086 (0.106) loss_u loss_u 0.9399 (0.9071) acc_u 6.2500 (10.9375) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/34] time 0.170 (0.182) data 0.092 (0.104) loss_u loss_u 0.9180 (0.9061) acc_u 12.5000 (11.2500) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/34] time 0.169 (0.181) data 0.091 (0.104) loss_u loss_u 0.9082 (0.9078) acc_u 9.3750 (11.0938) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/34] time 0.168 (0.180) data 0.090 (0.102) loss_u loss_u 0.9932 (0.9089) acc_u 0.0000 (10.8750) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/34] time 0.177 (0.180) data 0.099 (0.102) loss_u loss_u 0.8726 (0.9019) acc_u 15.6250 (11.5625) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 854
confident_label rate tensor(0.2958, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 478
clean true:260
clean false:218
clean_rate:0.5439330543933054
noisy true:502
noisy false:636
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1138
epoch [97/200] batch [5/14] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 1.2100 (0.7342) acc_x 65.6250 (82.5000) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [10/14] time 0.209 (0.186) data 0.132 (0.109) loss_x loss_x 0.3284 (0.6926) acc_x 93.7500 (83.1250) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/35] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9121 (0.8575) acc_u 9.3750 (16.2500) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/35] time 0.192 (0.182) data 0.111 (0.105) loss_u loss_u 0.9521 (0.8939) acc_u 6.2500 (12.1875) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/35] time 0.191 (0.183) data 0.115 (0.106) loss_u loss_u 0.8940 (0.9031) acc_u 12.5000 (11.0417) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/35] time 0.186 (0.184) data 0.108 (0.106) loss_u loss_u 0.8042 (0.9002) acc_u 25.0000 (11.5625) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/35] time 0.179 (0.183) data 0.101 (0.106) loss_u loss_u 0.8994 (0.8935) acc_u 12.5000 (12.7500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [30/35] time 0.183 (0.183) data 0.106 (0.105) loss_u loss_u 0.9233 (0.8956) acc_u 6.2500 (12.3958) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [35/35] time 0.184 (0.183) data 0.107 (0.105) loss_u loss_u 0.9282 (0.8948) acc_u 9.3750 (12.3214) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 858
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:274
clean false:234
clean_rate:0.5393700787401575
noisy true:484
noisy false:624
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [98/200] batch [5/15] time 0.176 (0.167) data 0.100 (0.090) loss_x loss_x 0.9976 (0.6287) acc_x 75.0000 (83.1250) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/15] time 0.173 (0.173) data 0.096 (0.096) loss_x loss_x 0.4612 (0.6112) acc_x 81.2500 (82.8125) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [15/15] time 0.165 (0.169) data 0.089 (0.092) loss_x loss_x 0.6646 (0.6859) acc_x 84.3750 (81.2500) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/34] time 0.176 (0.170) data 0.097 (0.093) loss_u loss_u 0.9131 (0.9079) acc_u 9.3750 (10.6250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [10/34] time 0.184 (0.172) data 0.106 (0.095) loss_u loss_u 0.8809 (0.8963) acc_u 15.6250 (12.1875) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/34] time 0.189 (0.174) data 0.111 (0.096) loss_u loss_u 0.9209 (0.9060) acc_u 6.2500 (11.0417) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/34] time 0.170 (0.174) data 0.093 (0.096) loss_u loss_u 0.9248 (0.9118) acc_u 9.3750 (10.4688) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/34] time 0.174 (0.173) data 0.097 (0.096) loss_u loss_u 0.9131 (0.9120) acc_u 9.3750 (10.3750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [30/34] time 0.190 (0.174) data 0.112 (0.096) loss_u loss_u 0.8369 (0.9097) acc_u 21.8750 (10.8333) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 887
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 471
clean true:259
clean false:212
clean_rate:0.5498938428874734
noisy true:470
noisy false:675
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1145
epoch [99/200] batch [5/14] time 0.178 (0.171) data 0.101 (0.094) loss_x loss_x 0.7969 (0.8283) acc_x 75.0000 (76.2500) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [10/14] time 0.189 (0.176) data 0.112 (0.099) loss_x loss_x 0.2815 (0.7167) acc_x 96.8750 (83.4375) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/35] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8789 (0.8851) acc_u 15.6250 (13.1250) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [10/35] time 0.180 (0.180) data 0.102 (0.102) loss_u loss_u 0.9243 (0.9079) acc_u 6.2500 (10.6250) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/35] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8799 (0.9007) acc_u 12.5000 (10.8333) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/35] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8296 (0.8980) acc_u 21.8750 (11.4062) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/35] time 0.171 (0.179) data 0.092 (0.102) loss_u loss_u 0.7905 (0.8908) acc_u 25.0000 (12.5000) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/35] time 0.170 (0.179) data 0.093 (0.101) loss_u loss_u 0.8765 (0.8889) acc_u 12.5000 (12.7083) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [35/35] time 0.167 (0.178) data 0.089 (0.101) loss_u loss_u 0.8765 (0.8903) acc_u 21.8750 (12.5893) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 884
confident_label rate tensor(0.3001, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 485
clean true:258
clean false:227
clean_rate:0.5319587628865979
noisy true:474
noisy false:657
all clean rate:  [0.7948717948717948, 0.8579881656804734, 0.8783783783783784, 0.8507462686567164, 0.8571428571428571, 0.7977099236641222, 0.8091603053435115, 0.7854406130268199, 0.7611940298507462, 0.7279151943462897, 0.7483221476510067, 0.710801393728223, 0.698170731707317, 0.6792452830188679, 0.6586102719033232, 0.728125, 0.6555891238670695, 0.6371951219512195, 0.6436781609195402, 0.6694444444444444, 0.6189111747851003, 0.6432584269662921, 0.615819209039548, 0.6295264623955432, 0.6242937853107344, 0.6270718232044199, 0.6222826086956522, 0.6455026455026455, 0.6220472440944882, 0.6063829787234043, 0.6161879895561357, 0.6128205128205129, 0.6337662337662338, 0.6159600997506235, 0.6123456790123457, 0.6259168704156479, 0.6520681265206812, 0.6286407766990292, 0.5771144278606966, 0.6138613861386139, 0.6115288220551378, 0.5931372549019608, 0.6075, 0.5953488372093023, 0.5990453460620525, 0.6066350710900474, 0.6023255813953489, 0.5777777777777777, 0.6056338028169014, 0.6186046511627907, 0.5642857142857143, 0.6102088167053364, 0.5909090909090909, 0.584070796460177, 0.593607305936073, 0.6042654028436019, 0.5807228915662651, 0.5871559633027523, 0.6027397260273972, 0.5876993166287016, 0.6029723991507431, 0.5756207674943566, 0.58675799086758, 0.5701943844492441, 0.6013363028953229, 0.591743119266055, 0.6009070294784581, 0.6059225512528473, 0.5840909090909091, 0.5926773455377574, 0.5753138075313807, 0.58, 0.5657620041753654, 0.5603448275862069, 0.5886075949367089, 0.5777777777777777, 0.5690021231422505, 0.5729166666666666, 0.5845824411134903, 0.5629139072847682, 0.5555555555555556, 0.5775862068965517, 0.5467775467775468, 0.5456521739130434, 0.5436105476673428, 0.559322033898305, 0.5792811839323467, 0.5413223140495868, 0.5525210084033614, 0.5518672199170125, 0.5439330543933054, 0.5437881873727087, 0.556237218813906, 0.5448851774530271, 0.5390781563126252, 0.533066132264529, 0.5439330543933054, 0.5393700787401575, 0.5498938428874734, 0.5319587628865979]
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1131
epoch [100/200] batch [5/15] time 0.168 (0.168) data 0.090 (0.090) loss_x loss_x 0.7402 (0.6557) acc_x 81.2500 (82.5000) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [10/15] time 0.183 (0.175) data 0.105 (0.097) loss_x loss_x 0.7314 (0.6586) acc_x 84.3750 (83.7500) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [15/15] time 0.166 (0.177) data 0.089 (0.099) loss_x loss_x 1.6787 (0.7643) acc_x 75.0000 (81.4583) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/35] time 0.165 (0.173) data 0.088 (0.096) loss_u loss_u 0.9092 (0.8888) acc_u 12.5000 (13.7500) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/35] time 0.159 (0.174) data 0.081 (0.097) loss_u loss_u 0.8540 (0.9039) acc_u 15.6250 (11.8750) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/35] time 0.177 (0.174) data 0.099 (0.097) loss_u loss_u 0.8120 (0.8962) acc_u 21.8750 (12.9167) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/35] time 0.186 (0.173) data 0.109 (0.096) loss_u loss_u 0.9131 (0.9102) acc_u 9.3750 (11.0938) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/35] time 0.158 (0.174) data 0.081 (0.096) loss_u loss_u 0.8569 (0.8977) acc_u 15.6250 (12.3750) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [30/35] time 0.187 (0.175) data 0.110 (0.097) loss_u loss_u 0.8398 (0.8977) acc_u 25.0000 (12.2917) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [35/35] time 0.172 (0.177) data 0.095 (0.099) loss_u loss_u 0.9360 (0.8972) acc_u 6.2500 (12.1429) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 883
confident_label rate tensor(0.3150, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 509
clean true:273
clean false:236
clean_rate:0.5363457760314342
noisy true:460
noisy false:647
after delete: len(clean_dataset) 509
after delete: len(noisy_dataset) 1107
epoch [101/200] batch [5/15] time 0.178 (0.173) data 0.100 (0.095) loss_x loss_x 0.5869 (0.6555) acc_x 84.3750 (84.3750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/15] time 0.176 (0.175) data 0.100 (0.098) loss_x loss_x 0.5835 (0.7108) acc_x 84.3750 (82.8125) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [15/15] time 0.164 (0.173) data 0.086 (0.095) loss_x loss_x 0.3232 (0.7203) acc_x 90.6250 (81.8750) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/34] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.9927 (0.8689) acc_u 0.0000 (15.0000) lr 1.0157e-03 eta 0:00:05
epoch [101/200] batch [10/34] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.9019 (0.8936) acc_u 15.6250 (13.4375) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/34] time 0.167 (0.177) data 0.090 (0.099) loss_u loss_u 0.9126 (0.8917) acc_u 9.3750 (13.5417) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/34] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8101 (0.8918) acc_u 18.7500 (13.4375) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/34] time 0.173 (0.179) data 0.096 (0.101) loss_u loss_u 0.9126 (0.9003) acc_u 9.3750 (12.2500) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [30/34] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.9292 (0.9041) acc_u 9.3750 (11.7708) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 883
confident_label rate tensor(0.3014, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 487
clean true:257
clean false:230
clean_rate:0.5277207392197125
noisy true:476
noisy false:653
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1129
epoch [102/200] batch [5/15] time 0.186 (0.173) data 0.109 (0.096) loss_x loss_x 0.5439 (0.5897) acc_x 81.2500 (81.2500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [10/15] time 0.181 (0.178) data 0.103 (0.101) loss_x loss_x 0.5493 (0.6640) acc_x 87.5000 (81.5625) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [15/15] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.4985 (0.6813) acc_x 93.7500 (81.8750) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/35] time 0.170 (0.176) data 0.092 (0.099) loss_u loss_u 0.9507 (0.9498) acc_u 6.2500 (6.8750) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/35] time 0.191 (0.176) data 0.113 (0.098) loss_u loss_u 0.9248 (0.9231) acc_u 9.3750 (9.6875) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/35] time 0.177 (0.175) data 0.099 (0.098) loss_u loss_u 0.9575 (0.9082) acc_u 6.2500 (11.2500) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/35] time 0.178 (0.174) data 0.100 (0.097) loss_u loss_u 0.8604 (0.9048) acc_u 15.6250 (11.4062) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/35] time 0.170 (0.175) data 0.091 (0.098) loss_u loss_u 0.8125 (0.8980) acc_u 21.8750 (12.1250) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [30/35] time 0.173 (0.175) data 0.096 (0.097) loss_u loss_u 0.9082 (0.8947) acc_u 12.5000 (12.5000) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [35/35] time 0.167 (0.174) data 0.089 (0.097) loss_u loss_u 0.9604 (0.8944) acc_u 3.1250 (12.5000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 884
confident_label rate tensor(0.3125, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 505
clean true:263
clean false:242
clean_rate:0.5207920792079208
noisy true:469
noisy false:642
after delete: len(clean_dataset) 505
after delete: len(noisy_dataset) 1111
epoch [103/200] batch [5/15] time 0.187 (0.187) data 0.109 (0.110) loss_x loss_x 0.2869 (0.5772) acc_x 96.8750 (86.8750) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [10/15] time 0.174 (0.182) data 0.096 (0.104) loss_x loss_x 0.4546 (0.6868) acc_x 93.7500 (84.3750) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [15/15] time 0.169 (0.178) data 0.092 (0.100) loss_x loss_x 0.4036 (0.6663) acc_x 90.6250 (85.4167) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/34] time 0.182 (0.178) data 0.105 (0.100) loss_u loss_u 0.9355 (0.8914) acc_u 12.5000 (15.6250) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/34] time 0.178 (0.178) data 0.101 (0.101) loss_u loss_u 0.8691 (0.8894) acc_u 15.6250 (14.3750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/34] time 0.190 (0.179) data 0.112 (0.102) loss_u loss_u 0.9058 (0.8958) acc_u 9.3750 (12.7083) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/34] time 0.168 (0.179) data 0.091 (0.101) loss_u loss_u 0.9497 (0.8948) acc_u 6.2500 (12.6562) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/34] time 0.167 (0.178) data 0.089 (0.101) loss_u loss_u 0.8584 (0.8979) acc_u 15.6250 (12.1250) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [30/34] time 0.187 (0.178) data 0.109 (0.100) loss_u loss_u 0.8760 (0.8990) acc_u 12.5000 (11.8750) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 887
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 519
clean true:277
clean false:242
clean_rate:0.5337186897880539
noisy true:452
noisy false:645
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1097
epoch [104/200] batch [5/16] time 0.162 (0.159) data 0.086 (0.082) loss_x loss_x 0.7329 (0.8773) acc_x 84.3750 (76.2500) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/16] time 0.180 (0.167) data 0.103 (0.091) loss_x loss_x 0.6035 (0.6980) acc_x 90.6250 (82.1875) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/16] time 0.179 (0.171) data 0.101 (0.095) loss_x loss_x 0.6396 (0.7239) acc_x 75.0000 (81.4583) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/34] time 0.167 (0.171) data 0.089 (0.094) loss_u loss_u 0.9116 (0.9026) acc_u 12.5000 (12.5000) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/34] time 0.167 (0.170) data 0.089 (0.093) loss_u loss_u 0.8457 (0.8976) acc_u 18.7500 (11.8750) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/34] time 0.168 (0.169) data 0.091 (0.092) loss_u loss_u 0.8730 (0.9064) acc_u 15.6250 (11.0417) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/34] time 0.170 (0.169) data 0.093 (0.092) loss_u loss_u 0.9287 (0.9006) acc_u 9.3750 (12.0312) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/34] time 0.184 (0.169) data 0.106 (0.092) loss_u loss_u 0.9746 (0.9046) acc_u 3.1250 (11.6250) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/34] time 0.173 (0.170) data 0.096 (0.093) loss_u loss_u 0.8843 (0.9043) acc_u 15.6250 (11.5625) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 879
confident_label rate tensor(0.3082, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 498
clean true:260
clean false:238
clean_rate:0.5220883534136547
noisy true:477
noisy false:641
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1118
epoch [105/200] batch [5/15] time 0.173 (0.173) data 0.096 (0.095) loss_x loss_x 0.3083 (0.4595) acc_x 90.6250 (87.5000) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [10/15] time 0.174 (0.170) data 0.097 (0.093) loss_x loss_x 0.3306 (0.5398) acc_x 90.6250 (85.9375) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [15/15] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 1.0576 (0.6155) acc_x 75.0000 (84.7917) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/34] time 0.188 (0.175) data 0.109 (0.098) loss_u loss_u 0.9028 (0.8956) acc_u 9.3750 (13.1250) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/34] time 0.181 (0.177) data 0.103 (0.100) loss_u loss_u 0.9116 (0.8927) acc_u 9.3750 (12.8125) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/34] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.9048 (0.8971) acc_u 9.3750 (12.0833) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/34] time 0.166 (0.179) data 0.087 (0.101) loss_u loss_u 0.8970 (0.8934) acc_u 9.3750 (12.0312) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/34] time 0.162 (0.177) data 0.084 (0.100) loss_u loss_u 0.9839 (0.8953) acc_u 0.0000 (11.8750) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [30/34] time 0.175 (0.176) data 0.098 (0.099) loss_u loss_u 0.9233 (0.8969) acc_u 6.2500 (11.6667) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 902
confident_label rate tensor(0.3088, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 499
clean true:259
clean false:240
clean_rate:0.5190380761523046
noisy true:455
noisy false:662
after delete: len(clean_dataset) 499
after delete: len(noisy_dataset) 1117
epoch [106/200] batch [5/15] time 0.168 (0.169) data 0.091 (0.092) loss_x loss_x 0.3157 (0.5270) acc_x 90.6250 (85.0000) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [10/15] time 0.166 (0.168) data 0.089 (0.090) loss_x loss_x 1.2061 (0.6550) acc_x 78.1250 (84.0625) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [15/15] time 0.173 (0.171) data 0.096 (0.094) loss_x loss_x 0.9922 (0.7016) acc_x 78.1250 (82.5000) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/34] time 0.217 (0.177) data 0.139 (0.100) loss_u loss_u 0.9092 (0.9350) acc_u 9.3750 (8.1250) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/34] time 0.173 (0.177) data 0.095 (0.100) loss_u loss_u 0.7905 (0.9077) acc_u 21.8750 (11.2500) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/34] time 0.183 (0.179) data 0.106 (0.101) loss_u loss_u 0.9365 (0.9089) acc_u 9.3750 (11.2500) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/34] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.8486 (0.9013) acc_u 15.6250 (12.0312) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/34] time 0.169 (0.179) data 0.091 (0.102) loss_u loss_u 0.9502 (0.8989) acc_u 6.2500 (12.1250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/34] time 0.178 (0.179) data 0.100 (0.101) loss_u loss_u 0.8647 (0.8990) acc_u 15.6250 (12.1875) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 885
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 503
clean true:260
clean false:243
clean_rate:0.5168986083499006
noisy true:471
noisy false:642
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1113
epoch [107/200] batch [5/15] time 0.170 (0.165) data 0.093 (0.088) loss_x loss_x 0.3572 (0.4688) acc_x 87.5000 (86.8750) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [10/15] time 0.186 (0.169) data 0.109 (0.092) loss_x loss_x 0.4229 (0.5743) acc_x 90.6250 (83.1250) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [15/15] time 0.183 (0.174) data 0.105 (0.097) loss_x loss_x 0.9912 (0.6446) acc_x 75.0000 (81.8750) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/34] time 0.174 (0.174) data 0.094 (0.097) loss_u loss_u 0.9048 (0.8960) acc_u 12.5000 (12.5000) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/34] time 0.165 (0.173) data 0.087 (0.095) loss_u loss_u 0.8418 (0.8699) acc_u 18.7500 (15.3125) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/34] time 0.163 (0.171) data 0.085 (0.094) loss_u loss_u 0.9727 (0.8877) acc_u 6.2500 (13.1250) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/34] time 0.184 (0.173) data 0.106 (0.095) loss_u loss_u 0.9502 (0.8903) acc_u 3.1250 (12.6562) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/34] time 0.174 (0.172) data 0.096 (0.095) loss_u loss_u 0.9878 (0.8985) acc_u 0.0000 (12.0000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/34] time 0.180 (0.173) data 0.103 (0.095) loss_u loss_u 0.9097 (0.8977) acc_u 9.3750 (11.9792) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 862
confident_label rate tensor(0.2995, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 484
clean true:268
clean false:216
clean_rate:0.5537190082644629
noisy true:486
noisy false:646
after delete: len(clean_dataset) 484
after delete: len(noisy_dataset) 1132
epoch [108/200] batch [5/15] time 0.170 (0.166) data 0.093 (0.089) loss_x loss_x 0.2727 (0.5705) acc_x 96.8750 (83.7500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/15] time 0.192 (0.173) data 0.115 (0.096) loss_x loss_x 0.7100 (0.5985) acc_x 81.2500 (81.8750) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [15/15] time 0.180 (0.175) data 0.103 (0.098) loss_x loss_x 0.2888 (0.5366) acc_x 90.6250 (83.7500) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/35] time 0.176 (0.175) data 0.099 (0.098) loss_u loss_u 0.9102 (0.8952) acc_u 12.5000 (13.1250) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/35] time 0.179 (0.176) data 0.101 (0.098) loss_u loss_u 0.8418 (0.8799) acc_u 18.7500 (14.3750) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/35] time 0.188 (0.176) data 0.110 (0.099) loss_u loss_u 0.9429 (0.8853) acc_u 6.2500 (13.9583) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/35] time 0.175 (0.178) data 0.097 (0.100) loss_u loss_u 0.8735 (0.8877) acc_u 15.6250 (13.5938) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/35] time 0.178 (0.177) data 0.099 (0.100) loss_u loss_u 0.8901 (0.8854) acc_u 12.5000 (13.7500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [30/35] time 0.173 (0.177) data 0.095 (0.100) loss_u loss_u 0.9214 (0.8914) acc_u 9.3750 (13.1250) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [35/35] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.9468 (0.8955) acc_u 6.2500 (12.2321) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 860
confident_label rate tensor(0.3255, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 526
clean true:287
clean false:239
clean_rate:0.5456273764258555
noisy true:469
noisy false:621
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1090
epoch [109/200] batch [5/16] time 0.176 (0.169) data 0.098 (0.091) loss_x loss_x 0.7847 (0.5173) acc_x 75.0000 (85.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/16] time 0.172 (0.174) data 0.095 (0.096) loss_x loss_x 0.4741 (0.6417) acc_x 87.5000 (84.0625) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/16] time 0.167 (0.172) data 0.090 (0.095) loss_x loss_x 0.6470 (0.6655) acc_x 84.3750 (83.5417) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/34] time 0.181 (0.174) data 0.103 (0.096) loss_u loss_u 0.9189 (0.9010) acc_u 12.5000 (11.8750) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/34] time 0.168 (0.174) data 0.091 (0.096) loss_u loss_u 0.9033 (0.9183) acc_u 12.5000 (9.3750) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/34] time 0.186 (0.175) data 0.109 (0.097) loss_u loss_u 0.9717 (0.9187) acc_u 3.1250 (9.5833) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/34] time 0.184 (0.176) data 0.107 (0.098) loss_u loss_u 0.9438 (0.9073) acc_u 6.2500 (10.9375) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/34] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9102 (0.9015) acc_u 9.3750 (11.5000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [30/34] time 0.168 (0.177) data 0.091 (0.099) loss_u loss_u 0.8906 (0.8991) acc_u 12.5000 (11.8750) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 903
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:266
clean false:256
clean_rate:0.5095785440613027
noisy true:447
noisy false:647
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [110/200] batch [5/16] time 0.175 (0.167) data 0.098 (0.090) loss_x loss_x 0.4844 (0.5975) acc_x 84.3750 (81.2500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/16] time 0.172 (0.169) data 0.095 (0.092) loss_x loss_x 0.3945 (0.5619) acc_x 90.6250 (84.3750) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/16] time 0.171 (0.169) data 0.093 (0.092) loss_x loss_x 1.0000 (0.6211) acc_x 75.0000 (82.9167) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/34] time 0.166 (0.169) data 0.089 (0.092) loss_u loss_u 0.8848 (0.8774) acc_u 12.5000 (12.5000) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/34] time 0.167 (0.169) data 0.089 (0.091) loss_u loss_u 0.9185 (0.9086) acc_u 9.3750 (9.3750) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/34] time 0.175 (0.168) data 0.096 (0.091) loss_u loss_u 0.9116 (0.9055) acc_u 9.3750 (10.0000) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/34] time 0.186 (0.170) data 0.109 (0.093) loss_u loss_u 0.9590 (0.9059) acc_u 3.1250 (10.1562) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/34] time 0.167 (0.172) data 0.089 (0.094) loss_u loss_u 0.9355 (0.9042) acc_u 6.2500 (10.3750) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/34] time 0.188 (0.171) data 0.109 (0.094) loss_u loss_u 0.8188 (0.8998) acc_u 25.0000 (11.0417) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 885
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:259
clean false:252
clean_rate:0.5068493150684932
noisy true:472
noisy false:633
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [111/200] batch [5/15] time 0.186 (0.188) data 0.108 (0.111) loss_x loss_x 0.8750 (0.7416) acc_x 78.1250 (83.7500) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/15] time 0.161 (0.181) data 0.083 (0.104) loss_x loss_x 0.9258 (0.7128) acc_x 81.2500 (84.0625) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [15/15] time 0.176 (0.176) data 0.100 (0.099) loss_x loss_x 0.3579 (0.7148) acc_x 87.5000 (83.3333) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/34] time 0.169 (0.176) data 0.091 (0.098) loss_u loss_u 0.8452 (0.8902) acc_u 25.0000 (14.3750) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/34] time 0.167 (0.174) data 0.090 (0.097) loss_u loss_u 0.9268 (0.8978) acc_u 9.3750 (12.5000) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/34] time 0.223 (0.179) data 0.145 (0.101) loss_u loss_u 0.9165 (0.8987) acc_u 9.3750 (12.0833) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/34] time 0.163 (0.179) data 0.085 (0.101) loss_u loss_u 0.9370 (0.8999) acc_u 6.2500 (12.0312) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/34] time 0.182 (0.178) data 0.103 (0.101) loss_u loss_u 0.9595 (0.9071) acc_u 6.2500 (11.3750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [30/34] time 0.181 (0.178) data 0.102 (0.100) loss_u loss_u 0.9087 (0.9048) acc_u 15.6250 (11.9792) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 858
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 497
clean true:267
clean false:230
clean_rate:0.5372233400402414
noisy true:491
noisy false:628
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1119
epoch [112/200] batch [5/15] time 0.173 (0.167) data 0.096 (0.089) loss_x loss_x 0.6118 (0.6836) acc_x 81.2500 (80.6250) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/15] time 0.180 (0.172) data 0.103 (0.095) loss_x loss_x 0.8467 (0.6330) acc_x 78.1250 (82.8125) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [15/15] time 0.187 (0.176) data 0.110 (0.098) loss_x loss_x 0.3240 (0.5808) acc_x 96.8750 (84.7917) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/34] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.8574 (0.8859) acc_u 12.5000 (11.8750) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/34] time 0.176 (0.179) data 0.099 (0.101) loss_u loss_u 0.9297 (0.8931) acc_u 9.3750 (11.8750) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/34] time 0.188 (0.180) data 0.110 (0.102) loss_u loss_u 0.8477 (0.8979) acc_u 15.6250 (11.6667) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/34] time 0.180 (0.180) data 0.102 (0.103) loss_u loss_u 0.8647 (0.8945) acc_u 12.5000 (12.0312) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/34] time 0.185 (0.180) data 0.107 (0.102) loss_u loss_u 0.9302 (0.8953) acc_u 9.3750 (12.2500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/34] time 0.185 (0.181) data 0.107 (0.103) loss_u loss_u 0.8945 (0.8931) acc_u 12.5000 (12.5000) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 880
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:259
clean false:248
clean_rate:0.5108481262327417
noisy true:477
noisy false:632
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [113/200] batch [5/15] time 0.181 (0.174) data 0.103 (0.097) loss_x loss_x 0.7446 (0.6706) acc_x 75.0000 (79.3750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/15] time 0.183 (0.179) data 0.107 (0.102) loss_x loss_x 0.5132 (0.6430) acc_x 87.5000 (80.9375) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [15/15] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.5459 (0.6736) acc_x 87.5000 (81.8750) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/34] time 0.175 (0.180) data 0.097 (0.103) loss_u loss_u 0.9053 (0.8644) acc_u 12.5000 (15.6250) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [10/34] time 0.166 (0.178) data 0.087 (0.101) loss_u loss_u 0.8643 (0.8801) acc_u 12.5000 (13.7500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/34] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.8018 (0.8808) acc_u 21.8750 (13.9583) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/34] time 0.162 (0.175) data 0.085 (0.098) loss_u loss_u 0.9414 (0.8901) acc_u 9.3750 (12.9688) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/34] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.9141 (0.8930) acc_u 12.5000 (12.6250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [30/34] time 0.158 (0.174) data 0.081 (0.096) loss_u loss_u 0.8721 (0.8905) acc_u 15.6250 (12.9167) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 868
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 518
clean true:263
clean false:255
clean_rate:0.5077220077220077
noisy true:485
noisy false:613
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1098
epoch [114/200] batch [5/16] time 0.158 (0.165) data 0.081 (0.088) loss_x loss_x 0.6621 (0.6438) acc_x 81.2500 (81.8750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [10/16] time 0.172 (0.174) data 0.094 (0.097) loss_x loss_x 0.8643 (0.7047) acc_x 78.1250 (81.5625) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [15/16] time 0.164 (0.175) data 0.087 (0.097) loss_x loss_x 0.7344 (0.7322) acc_x 87.5000 (80.0000) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/34] time 0.166 (0.173) data 0.089 (0.095) loss_u loss_u 0.8516 (0.8955) acc_u 15.6250 (12.5000) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [10/34] time 0.168 (0.171) data 0.091 (0.094) loss_u loss_u 0.9614 (0.8986) acc_u 3.1250 (12.1875) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/34] time 0.173 (0.172) data 0.096 (0.094) loss_u loss_u 0.9722 (0.9026) acc_u 6.2500 (11.6667) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/34] time 0.178 (0.172) data 0.101 (0.095) loss_u loss_u 0.8560 (0.8992) acc_u 18.7500 (12.0312) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/34] time 0.182 (0.173) data 0.106 (0.096) loss_u loss_u 0.9707 (0.9006) acc_u 3.1250 (11.7500) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [30/34] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.9551 (0.9015) acc_u 6.2500 (11.7708) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 873
confident_label rate tensor(0.3162, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 511
clean true:266
clean false:245
clean_rate:0.5205479452054794
noisy true:477
noisy false:628
after delete: len(clean_dataset) 511
after delete: len(noisy_dataset) 1105
epoch [115/200] batch [5/15] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.6216 (0.5309) acc_x 84.3750 (83.7500) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/15] time 0.180 (0.172) data 0.102 (0.095) loss_x loss_x 0.4417 (0.5838) acc_x 84.3750 (83.7500) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [15/15] time 0.164 (0.170) data 0.087 (0.093) loss_x loss_x 1.1367 (0.6821) acc_x 65.6250 (81.4583) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/34] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.7686 (0.8594) acc_u 28.1250 (17.5000) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [10/34] time 0.174 (0.176) data 0.095 (0.098) loss_u loss_u 0.8569 (0.8847) acc_u 15.6250 (14.0625) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [15/34] time 0.165 (0.174) data 0.088 (0.097) loss_u loss_u 0.9404 (0.8904) acc_u 3.1250 (12.9167) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/34] time 0.166 (0.173) data 0.088 (0.096) loss_u loss_u 0.9009 (0.8923) acc_u 9.3750 (12.5000) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/34] time 0.175 (0.173) data 0.097 (0.096) loss_u loss_u 0.8735 (0.8995) acc_u 15.6250 (11.8750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/34] time 0.174 (0.173) data 0.096 (0.095) loss_u loss_u 0.8140 (0.8909) acc_u 21.8750 (12.9167) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 861
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:277
clean false:254
clean_rate:0.5216572504708098
noisy true:478
noisy false:607
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [116/200] batch [5/16] time 0.186 (0.170) data 0.108 (0.093) loss_x loss_x 0.6987 (0.6327) acc_x 75.0000 (80.6250) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [10/16] time 0.161 (0.168) data 0.084 (0.091) loss_x loss_x 0.4958 (0.6350) acc_x 84.3750 (84.0625) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/16] time 0.168 (0.171) data 0.091 (0.094) loss_x loss_x 0.6226 (0.6894) acc_x 87.5000 (82.5000) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/33] time 0.179 (0.170) data 0.101 (0.093) loss_u loss_u 0.9448 (0.9325) acc_u 9.3750 (9.3750) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [10/33] time 0.161 (0.170) data 0.084 (0.092) loss_u loss_u 0.8564 (0.9320) acc_u 15.6250 (9.6875) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [15/33] time 0.187 (0.172) data 0.110 (0.094) loss_u loss_u 0.7896 (0.9232) acc_u 21.8750 (10.0000) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/33] time 0.187 (0.174) data 0.109 (0.096) loss_u loss_u 0.8599 (0.9134) acc_u 12.5000 (10.9375) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/33] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.8145 (0.9039) acc_u 21.8750 (12.0000) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [30/33] time 0.187 (0.177) data 0.110 (0.099) loss_u loss_u 0.8472 (0.9024) acc_u 15.6250 (12.0833) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 867
confident_label rate tensor(0.3274, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 529
clean true:267
clean false:262
clean_rate:0.504725897920605
noisy true:482
noisy false:605
after delete: len(clean_dataset) 529
after delete: len(noisy_dataset) 1087
epoch [117/200] batch [5/16] time 0.185 (0.186) data 0.108 (0.110) loss_x loss_x 0.4524 (0.6785) acc_x 84.3750 (83.1250) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/16] time 0.187 (0.193) data 0.110 (0.116) loss_x loss_x 0.7817 (0.7521) acc_x 81.2500 (83.1250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [15/16] time 0.164 (0.188) data 0.086 (0.111) loss_x loss_x 0.4741 (0.7567) acc_x 87.5000 (81.0417) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/33] time 0.164 (0.182) data 0.086 (0.105) loss_u loss_u 0.9429 (0.8816) acc_u 9.3750 (14.3750) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/33] time 0.164 (0.180) data 0.087 (0.103) loss_u loss_u 0.9126 (0.8931) acc_u 12.5000 (13.7500) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/33] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9082 (0.8980) acc_u 9.3750 (12.9167) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/33] time 0.186 (0.181) data 0.110 (0.104) loss_u loss_u 0.9316 (0.8998) acc_u 9.3750 (12.8125) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/33] time 0.178 (0.181) data 0.101 (0.104) loss_u loss_u 0.9341 (0.9002) acc_u 6.2500 (12.5000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [30/33] time 0.174 (0.180) data 0.096 (0.103) loss_u loss_u 0.9775 (0.9083) acc_u 3.1250 (11.1458) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 881
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:262
clean false:252
clean_rate:0.5097276264591439
noisy true:473
noisy false:629
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [118/200] batch [5/16] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.5381 (0.7065) acc_x 78.1250 (79.3750) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/16] time 0.163 (0.170) data 0.086 (0.093) loss_x loss_x 0.4788 (0.6514) acc_x 90.6250 (82.5000) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/16] time 0.175 (0.171) data 0.097 (0.093) loss_x loss_x 0.5566 (0.6262) acc_x 84.3750 (83.5417) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/34] time 0.186 (0.175) data 0.109 (0.097) loss_u loss_u 0.8491 (0.9198) acc_u 15.6250 (8.1250) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/34] time 0.177 (0.175) data 0.100 (0.097) loss_u loss_u 0.7231 (0.8894) acc_u 31.2500 (12.5000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/34] time 0.187 (0.176) data 0.110 (0.099) loss_u loss_u 0.8608 (0.8871) acc_u 15.6250 (13.1250) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/34] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9390 (0.8886) acc_u 6.2500 (12.8125) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/34] time 0.182 (0.178) data 0.105 (0.100) loss_u loss_u 0.8687 (0.8840) acc_u 15.6250 (13.3750) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [30/34] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.9141 (0.8808) acc_u 9.3750 (13.7500) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 882
confident_label rate tensor(0.3261, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 527
clean true:275
clean false:252
clean_rate:0.5218216318785579
noisy true:459
noisy false:630
after delete: len(clean_dataset) 527
after delete: len(noisy_dataset) 1089
epoch [119/200] batch [5/16] time 0.166 (0.180) data 0.088 (0.102) loss_x loss_x 0.6997 (0.6896) acc_x 84.3750 (84.3750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [10/16] time 0.171 (0.178) data 0.094 (0.100) loss_x loss_x 0.5454 (0.6143) acc_x 84.3750 (85.3125) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [15/16] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.6504 (0.7124) acc_x 84.3750 (82.0833) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/34] time 0.168 (0.172) data 0.090 (0.095) loss_u loss_u 0.8594 (0.8749) acc_u 18.7500 (14.3750) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/34] time 0.161 (0.171) data 0.084 (0.094) loss_u loss_u 0.9927 (0.9088) acc_u 0.0000 (11.2500) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/34] time 0.174 (0.171) data 0.097 (0.094) loss_u loss_u 0.8403 (0.9099) acc_u 18.7500 (10.8333) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/34] time 0.177 (0.172) data 0.100 (0.094) loss_u loss_u 0.8921 (0.9015) acc_u 12.5000 (12.0312) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/34] time 0.167 (0.172) data 0.090 (0.094) loss_u loss_u 0.9536 (0.9055) acc_u 6.2500 (11.3750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [30/34] time 0.164 (0.171) data 0.087 (0.093) loss_u loss_u 0.8145 (0.9051) acc_u 18.7500 (11.1458) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 896
confident_label rate tensor(0.3156, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 510
clean true:255
clean false:255
clean_rate:0.5
noisy true:465
noisy false:641
after delete: len(clean_dataset) 510
after delete: len(noisy_dataset) 1106
epoch [120/200] batch [5/15] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.5684 (0.5946) acc_x 87.5000 (84.3750) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [10/15] time 0.167 (0.175) data 0.089 (0.097) loss_x loss_x 0.7803 (0.6680) acc_x 81.2500 (83.1250) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [15/15] time 0.158 (0.170) data 0.081 (0.093) loss_x loss_x 0.6621 (0.6262) acc_x 75.0000 (83.1250) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/34] time 0.162 (0.168) data 0.084 (0.090) loss_u loss_u 0.8521 (0.8832) acc_u 18.7500 (13.1250) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/34] time 0.198 (0.168) data 0.121 (0.091) loss_u loss_u 0.9155 (0.8994) acc_u 9.3750 (10.9375) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/34] time 0.176 (0.170) data 0.098 (0.092) loss_u loss_u 0.8291 (0.8876) acc_u 21.8750 (12.7083) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/34] time 0.180 (0.172) data 0.103 (0.094) loss_u loss_u 0.9214 (0.8954) acc_u 9.3750 (11.5625) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/34] time 0.176 (0.172) data 0.098 (0.095) loss_u loss_u 0.8789 (0.8943) acc_u 12.5000 (11.7500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [30/34] time 0.176 (0.172) data 0.099 (0.095) loss_u loss_u 0.8687 (0.8950) acc_u 15.6250 (11.5625) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 885
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:263
clean false:268
clean_rate:0.4952919020715631
noisy true:468
noisy false:617
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [121/200] batch [5/16] time 0.159 (0.181) data 0.082 (0.104) loss_x loss_x 0.6694 (0.7800) acc_x 87.5000 (83.7500) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/16] time 0.166 (0.174) data 0.090 (0.097) loss_x loss_x 0.4583 (0.7042) acc_x 84.3750 (83.1250) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/16] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.5864 (0.6831) acc_x 87.5000 (84.1667) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/33] time 0.158 (0.172) data 0.081 (0.095) loss_u loss_u 0.8921 (0.8899) acc_u 12.5000 (13.1250) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/33] time 0.177 (0.170) data 0.098 (0.093) loss_u loss_u 0.9517 (0.8898) acc_u 6.2500 (13.1250) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [15/33] time 0.176 (0.170) data 0.095 (0.093) loss_u loss_u 0.9473 (0.8986) acc_u 3.1250 (11.6667) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/33] time 0.180 (0.172) data 0.102 (0.095) loss_u loss_u 0.9009 (0.8930) acc_u 12.5000 (12.1875) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/33] time 0.161 (0.172) data 0.084 (0.094) loss_u loss_u 0.9692 (0.9009) acc_u 6.2500 (11.1250) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/33] time 0.183 (0.172) data 0.106 (0.095) loss_u loss_u 0.8569 (0.8969) acc_u 12.5000 (11.3542) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 897
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 503
clean true:260
clean false:243
clean_rate:0.5168986083499006
noisy true:459
noisy false:654
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1113
epoch [122/200] batch [5/15] time 0.157 (0.167) data 0.080 (0.090) loss_x loss_x 0.8550 (0.5412) acc_x 78.1250 (86.2500) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/15] time 0.185 (0.172) data 0.108 (0.095) loss_x loss_x 0.8584 (0.6183) acc_x 78.1250 (83.4375) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [15/15] time 0.164 (0.170) data 0.087 (0.093) loss_x loss_x 0.8091 (0.6265) acc_x 71.8750 (82.7083) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/34] time 0.179 (0.172) data 0.102 (0.094) loss_u loss_u 0.8506 (0.9124) acc_u 15.6250 (10.6250) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/34] time 0.176 (0.174) data 0.099 (0.096) loss_u loss_u 0.7568 (0.8748) acc_u 28.1250 (14.3750) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/34] time 0.165 (0.172) data 0.088 (0.095) loss_u loss_u 0.9165 (0.8843) acc_u 9.3750 (13.1250) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/34] time 0.176 (0.172) data 0.099 (0.095) loss_u loss_u 0.8550 (0.8834) acc_u 15.6250 (13.2812) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/34] time 0.182 (0.173) data 0.104 (0.096) loss_u loss_u 0.9028 (0.8878) acc_u 12.5000 (13.0000) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [30/34] time 0.183 (0.174) data 0.105 (0.097) loss_u loss_u 0.9111 (0.8864) acc_u 9.3750 (13.3333) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 891
confident_label rate tensor(0.3175, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 513
clean true:261
clean false:252
clean_rate:0.5087719298245614
noisy true:464
noisy false:639
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1103
epoch [123/200] batch [5/16] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.5303 (0.7120) acc_x 81.2500 (78.1250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/16] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.5659 (0.6286) acc_x 87.5000 (82.5000) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/16] time 0.178 (0.172) data 0.100 (0.095) loss_x loss_x 0.8252 (0.6708) acc_x 78.1250 (81.0417) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/34] time 0.180 (0.176) data 0.101 (0.099) loss_u loss_u 0.9165 (0.9167) acc_u 9.3750 (9.3750) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/34] time 0.170 (0.177) data 0.092 (0.099) loss_u loss_u 0.9214 (0.9103) acc_u 6.2500 (10.0000) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/34] time 0.176 (0.176) data 0.098 (0.099) loss_u loss_u 0.9233 (0.9016) acc_u 6.2500 (11.0417) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/34] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.9292 (0.9024) acc_u 9.3750 (11.4062) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/34] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.8809 (0.9040) acc_u 12.5000 (11.1250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/34] time 0.217 (0.179) data 0.139 (0.101) loss_u loss_u 0.8354 (0.9022) acc_u 18.7500 (11.3542) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 891
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 525
clean true:264
clean false:261
clean_rate:0.5028571428571429
noisy true:461
noisy false:630
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1091
epoch [124/200] batch [5/16] time 0.170 (0.181) data 0.092 (0.103) loss_x loss_x 0.2986 (0.6216) acc_x 90.6250 (86.2500) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/16] time 0.177 (0.180) data 0.101 (0.103) loss_x loss_x 0.6650 (0.6165) acc_x 78.1250 (84.6875) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [15/16] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.5640 (0.6249) acc_x 81.2500 (83.7500) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/34] time 0.165 (0.176) data 0.086 (0.099) loss_u loss_u 0.9321 (0.9108) acc_u 6.2500 (10.0000) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/34] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.8794 (0.9004) acc_u 15.6250 (11.5625) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/34] time 0.189 (0.177) data 0.111 (0.100) loss_u loss_u 0.9370 (0.9095) acc_u 9.3750 (10.6250) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/34] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.8984 (0.9096) acc_u 12.5000 (10.6250) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/34] time 0.187 (0.179) data 0.109 (0.101) loss_u loss_u 0.8442 (0.9091) acc_u 18.7500 (10.6250) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [30/34] time 0.186 (0.180) data 0.109 (0.102) loss_u loss_u 0.8774 (0.9057) acc_u 12.5000 (10.6250) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 883
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 537
clean true:275
clean false:262
clean_rate:0.5121042830540037
noisy true:458
noisy false:621
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1079
epoch [125/200] batch [5/16] time 0.197 (0.190) data 0.121 (0.113) loss_x loss_x 1.4414 (0.6937) acc_x 71.8750 (83.7500) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/16] time 0.163 (0.180) data 0.086 (0.103) loss_x loss_x 0.2717 (0.6372) acc_x 93.7500 (83.1250) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [15/16] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.5298 (0.6301) acc_x 81.2500 (83.1250) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/33] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.9268 (0.9191) acc_u 12.5000 (11.8750) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/33] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9355 (0.9154) acc_u 6.2500 (11.2500) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/33] time 0.185 (0.183) data 0.107 (0.105) loss_u loss_u 0.9272 (0.9049) acc_u 6.2500 (11.8750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/33] time 0.188 (0.183) data 0.108 (0.105) loss_u loss_u 0.8979 (0.9029) acc_u 12.5000 (11.7188) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/33] time 0.184 (0.183) data 0.106 (0.105) loss_u loss_u 0.8789 (0.9112) acc_u 15.6250 (10.8750) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [30/33] time 0.186 (0.183) data 0.108 (0.105) loss_u loss_u 0.9678 (0.9127) acc_u 3.1250 (10.6250) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 889
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 541
clean true:267
clean false:274
clean_rate:0.49353049907578556
noisy true:460
noisy false:615
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1075
epoch [126/200] batch [5/16] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.8472 (0.7637) acc_x 68.7500 (78.1250) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [10/16] time 0.186 (0.186) data 0.110 (0.109) loss_x loss_x 0.5254 (0.6763) acc_x 81.2500 (80.3125) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [15/16] time 0.184 (0.185) data 0.107 (0.109) loss_x loss_x 0.6885 (0.5967) acc_x 87.5000 (83.1250) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/33] time 0.174 (0.181) data 0.096 (0.104) loss_u loss_u 0.8887 (0.8712) acc_u 15.6250 (14.3750) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/33] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8931 (0.8970) acc_u 12.5000 (11.5625) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/33] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.9248 (0.9034) acc_u 9.3750 (11.0417) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/33] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.9136 (0.9036) acc_u 12.5000 (11.0938) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/33] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9287 (0.9030) acc_u 6.2500 (11.2500) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [30/33] time 0.184 (0.183) data 0.107 (0.105) loss_u loss_u 1.0000 (0.9073) acc_u 0.0000 (10.8333) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 877
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:270
clean false:261
clean_rate:0.5084745762711864
noisy true:469
noisy false:616
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [127/200] batch [5/16] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.7881 (0.6969) acc_x 84.3750 (81.2500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [10/16] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.6348 (0.5865) acc_x 84.3750 (85.0000) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [15/16] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.5117 (0.5254) acc_x 87.5000 (86.4583) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/33] time 0.174 (0.182) data 0.096 (0.105) loss_u loss_u 0.8652 (0.9053) acc_u 12.5000 (10.6250) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [10/33] time 0.163 (0.179) data 0.086 (0.102) loss_u loss_u 0.9468 (0.9236) acc_u 6.2500 (9.0625) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/33] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.9609 (0.9259) acc_u 6.2500 (8.9583) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/33] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.8892 (0.9121) acc_u 12.5000 (10.4688) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/33] time 0.164 (0.178) data 0.086 (0.101) loss_u loss_u 0.8682 (0.9114) acc_u 15.6250 (10.6250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [30/33] time 0.171 (0.178) data 0.094 (0.100) loss_u loss_u 0.9375 (0.9108) acc_u 9.3750 (10.6250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 866
confident_label rate tensor(0.3292, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 532
clean true:272
clean false:260
clean_rate:0.5112781954887218
noisy true:478
noisy false:606
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 1084
epoch [128/200] batch [5/16] time 0.170 (0.181) data 0.093 (0.104) loss_x loss_x 0.5742 (0.7016) acc_x 84.3750 (80.6250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/16] time 0.177 (0.177) data 0.099 (0.100) loss_x loss_x 0.6973 (0.6707) acc_x 81.2500 (80.9375) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [15/16] time 0.158 (0.177) data 0.081 (0.100) loss_x loss_x 0.8413 (0.6728) acc_x 81.2500 (81.0417) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/33] time 0.169 (0.174) data 0.091 (0.097) loss_u loss_u 0.8936 (0.8712) acc_u 12.5000 (15.0000) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/33] time 0.179 (0.173) data 0.101 (0.096) loss_u loss_u 0.9248 (0.8844) acc_u 6.2500 (12.8125) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [15/33] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.9478 (0.8957) acc_u 9.3750 (11.8750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/33] time 0.184 (0.176) data 0.106 (0.099) loss_u loss_u 0.8999 (0.8892) acc_u 12.5000 (12.8125) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/33] time 0.182 (0.177) data 0.104 (0.099) loss_u loss_u 0.9141 (0.8945) acc_u 12.5000 (12.1250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/33] time 0.184 (0.178) data 0.105 (0.100) loss_u loss_u 0.9131 (0.8933) acc_u 9.3750 (12.2917) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 901
confident_label rate tensor(0.3255, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 526
clean true:268
clean false:258
clean_rate:0.5095057034220533
noisy true:447
noisy false:643
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1090
epoch [129/200] batch [5/16] time 0.178 (0.175) data 0.102 (0.098) loss_x loss_x 0.8716 (0.8030) acc_x 78.1250 (76.8750) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/16] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.7368 (0.8286) acc_x 84.3750 (78.7500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [15/16] time 0.189 (0.174) data 0.111 (0.097) loss_x loss_x 0.4707 (0.7548) acc_x 93.7500 (81.6667) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/34] time 0.160 (0.173) data 0.083 (0.095) loss_u loss_u 0.9399 (0.9244) acc_u 9.3750 (10.0000) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/34] time 0.178 (0.173) data 0.100 (0.096) loss_u loss_u 0.8760 (0.9031) acc_u 15.6250 (12.1875) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/34] time 0.179 (0.174) data 0.100 (0.097) loss_u loss_u 0.9150 (0.8958) acc_u 9.3750 (12.2917) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/34] time 0.188 (0.176) data 0.111 (0.098) loss_u loss_u 0.8359 (0.8893) acc_u 18.7500 (13.1250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/34] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9126 (0.8944) acc_u 9.3750 (12.5000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/34] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.8999 (0.8980) acc_u 12.5000 (11.9792) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 875
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 535
clean true:271
clean false:264
clean_rate:0.5065420560747663
noisy true:470
noisy false:611
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1081
epoch [130/200] batch [5/16] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.4717 (0.5161) acc_x 87.5000 (86.2500) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/16] time 0.179 (0.176) data 0.101 (0.100) loss_x loss_x 1.2236 (0.6601) acc_x 65.6250 (81.8750) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/16] time 0.190 (0.178) data 0.113 (0.101) loss_x loss_x 0.9971 (0.7234) acc_x 71.8750 (81.4583) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/33] time 0.177 (0.177) data 0.100 (0.099) loss_u loss_u 0.8340 (0.9064) acc_u 18.7500 (9.3750) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/33] time 0.179 (0.175) data 0.101 (0.098) loss_u loss_u 0.9102 (0.9021) acc_u 9.3750 (10.6250) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/33] time 0.166 (0.174) data 0.088 (0.097) loss_u loss_u 0.8687 (0.8993) acc_u 18.7500 (11.6667) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/33] time 0.182 (0.174) data 0.104 (0.097) loss_u loss_u 0.9155 (0.8978) acc_u 9.3750 (11.7188) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/33] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.9321 (0.9005) acc_u 9.3750 (11.7500) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/33] time 0.186 (0.177) data 0.108 (0.099) loss_u loss_u 0.7432 (0.8912) acc_u 28.1250 (13.0208) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 878
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 517
clean true:268
clean false:249
clean_rate:0.5183752417794971
noisy true:470
noisy false:629
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1099
epoch [131/200] batch [5/16] time 0.177 (0.189) data 0.100 (0.112) loss_x loss_x 0.3899 (0.5305) acc_x 90.6250 (86.2500) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/16] time 0.168 (0.180) data 0.091 (0.102) loss_x loss_x 0.4795 (0.5836) acc_x 90.6250 (84.6875) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/16] time 0.186 (0.176) data 0.108 (0.099) loss_x loss_x 0.3623 (0.5807) acc_x 90.6250 (85.4167) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/34] time 0.171 (0.180) data 0.093 (0.102) loss_u loss_u 0.9507 (0.8579) acc_u 6.2500 (16.2500) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [10/34] time 0.168 (0.179) data 0.090 (0.101) loss_u loss_u 0.8960 (0.8757) acc_u 15.6250 (14.6875) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [15/34] time 0.163 (0.177) data 0.085 (0.100) loss_u loss_u 0.8535 (0.8790) acc_u 15.6250 (14.3750) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/34] time 0.160 (0.175) data 0.082 (0.097) loss_u loss_u 0.8604 (0.8794) acc_u 18.7500 (14.5312) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/34] time 0.167 (0.174) data 0.090 (0.096) loss_u loss_u 0.8105 (0.8826) acc_u 21.8750 (14.2500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/34] time 0.171 (0.175) data 0.094 (0.097) loss_u loss_u 0.8779 (0.8852) acc_u 12.5000 (13.6458) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 904
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 541
clean true:278
clean false:263
clean_rate:0.5138632162661737
noisy true:434
noisy false:641
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1075
epoch [132/200] batch [5/16] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.8457 (0.7032) acc_x 75.0000 (80.6250) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/16] time 0.168 (0.181) data 0.091 (0.104) loss_x loss_x 0.6997 (0.6266) acc_x 90.6250 (85.0000) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/16] time 0.187 (0.179) data 0.108 (0.102) loss_x loss_x 0.5176 (0.6498) acc_x 87.5000 (85.0000) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/33] time 0.181 (0.179) data 0.104 (0.101) loss_u loss_u 0.9116 (0.8848) acc_u 12.5000 (13.7500) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/33] time 0.186 (0.179) data 0.106 (0.102) loss_u loss_u 0.8755 (0.9098) acc_u 12.5000 (10.6250) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/33] time 0.164 (0.177) data 0.087 (0.099) loss_u loss_u 0.9702 (0.9121) acc_u 3.1250 (10.8333) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/33] time 0.165 (0.176) data 0.088 (0.098) loss_u loss_u 0.8809 (0.9127) acc_u 15.6250 (10.7812) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/33] time 0.163 (0.174) data 0.084 (0.097) loss_u loss_u 0.8647 (0.9027) acc_u 18.7500 (11.8750) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [30/33] time 0.170 (0.173) data 0.093 (0.096) loss_u loss_u 0.8560 (0.8970) acc_u 15.6250 (12.2917) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 907
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:262
clean false:269
clean_rate:0.4934086629001883
noisy true:447
noisy false:638
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [133/200] batch [5/16] time 0.179 (0.186) data 0.102 (0.109) loss_x loss_x 0.9927 (0.8625) acc_x 75.0000 (78.1250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/16] time 0.184 (0.181) data 0.107 (0.103) loss_x loss_x 0.5254 (0.7564) acc_x 87.5000 (81.2500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [15/16] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.4888 (0.6786) acc_x 87.5000 (82.5000) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/33] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.8916 (0.8926) acc_u 9.3750 (11.8750) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/33] time 0.176 (0.177) data 0.099 (0.100) loss_u loss_u 0.8633 (0.8710) acc_u 15.6250 (15.3125) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/33] time 0.162 (0.177) data 0.082 (0.099) loss_u loss_u 0.9199 (0.8725) acc_u 9.3750 (15.0000) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [20/33] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9282 (0.8755) acc_u 9.3750 (14.8438) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/33] time 0.187 (0.179) data 0.109 (0.101) loss_u loss_u 0.8794 (0.8787) acc_u 18.7500 (14.3750) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [30/33] time 0.205 (0.180) data 0.127 (0.102) loss_u loss_u 0.9536 (0.8849) acc_u 6.2500 (13.6458) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 873
confident_label rate tensor(0.3255, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 526
clean true:276
clean false:250
clean_rate:0.5247148288973384
noisy true:467
noisy false:623
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1090
epoch [134/200] batch [5/16] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 1.1289 (0.6912) acc_x 84.3750 (84.3750) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/16] time 0.173 (0.179) data 0.096 (0.101) loss_x loss_x 1.0625 (0.7997) acc_x 71.8750 (81.8750) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [15/16] time 0.178 (0.176) data 0.101 (0.099) loss_x loss_x 0.4065 (0.7613) acc_x 90.6250 (82.5000) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/34] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9019 (0.9057) acc_u 12.5000 (11.2500) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/34] time 0.178 (0.179) data 0.101 (0.102) loss_u loss_u 0.9624 (0.9042) acc_u 3.1250 (11.2500) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/34] time 0.163 (0.177) data 0.084 (0.100) loss_u loss_u 0.8794 (0.8936) acc_u 15.6250 (12.7083) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/34] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8511 (0.8883) acc_u 15.6250 (13.5938) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/34] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9214 (0.8903) acc_u 9.3750 (13.5000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/34] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.8916 (0.8930) acc_u 9.3750 (12.9167) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 921
confident_label rate tensor(0.3243, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 524
clean true:265
clean false:259
clean_rate:0.5057251908396947
noisy true:430
noisy false:662
after delete: len(clean_dataset) 524
after delete: len(noisy_dataset) 1092
epoch [135/200] batch [5/16] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.3835 (0.5607) acc_x 93.7500 (85.6250) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/16] time 0.176 (0.174) data 0.099 (0.097) loss_x loss_x 0.6592 (0.5562) acc_x 84.3750 (85.9375) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [15/16] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.3489 (0.5474) acc_x 93.7500 (87.0833) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/34] time 0.172 (0.174) data 0.094 (0.097) loss_u loss_u 0.8936 (0.8814) acc_u 15.6250 (15.6250) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/34] time 0.178 (0.176) data 0.099 (0.099) loss_u loss_u 0.8857 (0.8807) acc_u 12.5000 (15.0000) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/34] time 0.165 (0.175) data 0.087 (0.098) loss_u loss_u 0.8823 (0.8848) acc_u 12.5000 (13.9583) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/34] time 0.180 (0.175) data 0.102 (0.097) loss_u loss_u 0.9336 (0.8928) acc_u 6.2500 (12.9688) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/34] time 0.172 (0.174) data 0.094 (0.096) loss_u loss_u 0.8555 (0.8929) acc_u 18.7500 (12.8750) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/34] time 0.182 (0.174) data 0.104 (0.097) loss_u loss_u 0.8911 (0.8927) acc_u 12.5000 (12.9167) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 891
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 538
clean true:273
clean false:265
clean_rate:0.5074349442379182
noisy true:452
noisy false:626
after delete: len(clean_dataset) 538
after delete: len(noisy_dataset) 1078
epoch [136/200] batch [5/16] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.7056 (0.7557) acc_x 84.3750 (83.7500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/16] time 0.187 (0.176) data 0.110 (0.099) loss_x loss_x 0.8228 (0.6784) acc_x 75.0000 (84.0625) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [15/16] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.4055 (0.6411) acc_x 90.6250 (85.0000) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/33] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.8950 (0.8674) acc_u 9.3750 (16.2500) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/33] time 0.168 (0.174) data 0.090 (0.097) loss_u loss_u 0.9365 (0.8974) acc_u 6.2500 (13.1250) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/33] time 0.186 (0.174) data 0.109 (0.096) loss_u loss_u 0.9116 (0.9051) acc_u 9.3750 (11.6667) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/33] time 0.182 (0.173) data 0.104 (0.096) loss_u loss_u 0.9097 (0.9067) acc_u 9.3750 (11.2500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/33] time 0.179 (0.174) data 0.101 (0.097) loss_u loss_u 0.9072 (0.9086) acc_u 12.5000 (11.0000) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [30/33] time 0.174 (0.174) data 0.096 (0.096) loss_u loss_u 0.9341 (0.9040) acc_u 6.2500 (11.5625) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 881
confident_label rate tensor(0.3317, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 536
clean true:273
clean false:263
clean_rate:0.5093283582089553
noisy true:462
noisy false:618
after delete: len(clean_dataset) 536
after delete: len(noisy_dataset) 1080
epoch [137/200] batch [5/16] time 0.170 (0.181) data 0.093 (0.103) loss_x loss_x 1.1133 (0.7953) acc_x 68.7500 (75.6250) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/16] time 0.160 (0.175) data 0.084 (0.098) loss_x loss_x 0.6255 (0.6724) acc_x 84.3750 (80.0000) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [15/16] time 0.168 (0.176) data 0.092 (0.099) loss_x loss_x 0.4592 (0.6973) acc_x 84.3750 (79.7917) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/33] time 0.173 (0.174) data 0.095 (0.097) loss_u loss_u 0.8833 (0.9088) acc_u 15.6250 (11.2500) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/33] time 0.168 (0.175) data 0.091 (0.097) loss_u loss_u 0.8545 (0.8864) acc_u 18.7500 (13.4375) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/33] time 0.173 (0.175) data 0.094 (0.098) loss_u loss_u 0.8931 (0.8953) acc_u 12.5000 (12.0833) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/33] time 0.173 (0.176) data 0.096 (0.098) loss_u loss_u 0.8169 (0.8916) acc_u 21.8750 (12.6562) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/33] time 0.158 (0.175) data 0.080 (0.098) loss_u loss_u 0.8335 (0.8912) acc_u 18.7500 (12.6250) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/33] time 0.167 (0.174) data 0.089 (0.096) loss_u loss_u 0.9404 (0.8958) acc_u 9.3750 (12.1875) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 891
confident_label rate tensor(0.3379, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 546
clean true:287
clean false:259
clean_rate:0.5256410256410257
noisy true:438
noisy false:632
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 1070
epoch [138/200] batch [5/17] time 0.170 (0.177) data 0.093 (0.099) loss_x loss_x 0.7388 (0.6558) acc_x 78.1250 (82.5000) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/17] time 0.180 (0.179) data 0.103 (0.101) loss_x loss_x 0.3396 (0.6002) acc_x 90.6250 (83.4375) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/17] time 0.169 (0.176) data 0.093 (0.099) loss_x loss_x 0.5908 (0.5636) acc_x 81.2500 (84.3750) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/33] time 0.170 (0.173) data 0.092 (0.096) loss_u loss_u 0.8936 (0.8942) acc_u 12.5000 (12.5000) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/33] time 0.199 (0.176) data 0.122 (0.098) loss_u loss_u 0.9399 (0.9095) acc_u 6.2500 (10.6250) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/33] time 0.181 (0.176) data 0.102 (0.099) loss_u loss_u 0.8525 (0.9072) acc_u 15.6250 (11.2500) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/33] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.8516 (0.9069) acc_u 15.6250 (10.9375) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/33] time 0.172 (0.177) data 0.094 (0.099) loss_u loss_u 0.8379 (0.9040) acc_u 18.7500 (11.0000) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/33] time 0.161 (0.175) data 0.084 (0.098) loss_u loss_u 0.9302 (0.9045) acc_u 9.3750 (11.2500) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 862
confident_label rate tensor(0.3366, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 544
clean true:282
clean false:262
clean_rate:0.5183823529411765
noisy true:472
noisy false:600
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 1072
epoch [139/200] batch [5/17] time 0.182 (0.176) data 0.105 (0.098) loss_x loss_x 0.8027 (0.6573) acc_x 81.2500 (85.6250) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [10/17] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.4102 (0.6638) acc_x 87.5000 (83.7500) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [15/17] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.5396 (0.6006) acc_x 84.3750 (85.2083) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/33] time 0.171 (0.175) data 0.094 (0.098) loss_u loss_u 0.8853 (0.9172) acc_u 12.5000 (10.6250) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/33] time 0.220 (0.178) data 0.143 (0.101) loss_u loss_u 0.8623 (0.9124) acc_u 12.5000 (10.6250) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/33] time 0.179 (0.179) data 0.102 (0.102) loss_u loss_u 0.9209 (0.9149) acc_u 9.3750 (9.7917) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/33] time 0.187 (0.180) data 0.109 (0.103) loss_u loss_u 0.8354 (0.9079) acc_u 18.7500 (11.0938) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/33] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.8857 (0.9029) acc_u 12.5000 (11.6250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/33] time 0.162 (0.178) data 0.083 (0.100) loss_u loss_u 0.8633 (0.9017) acc_u 15.6250 (11.7708) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 853
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 553
clean true:294
clean false:259
clean_rate:0.5316455696202531
noisy true:469
noisy false:594
after delete: len(clean_dataset) 553
after delete: len(noisy_dataset) 1063
epoch [140/200] batch [5/17] time 0.186 (0.187) data 0.110 (0.110) loss_x loss_x 0.5327 (0.7137) acc_x 75.0000 (81.2500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/17] time 0.169 (0.179) data 0.093 (0.102) loss_x loss_x 0.4619 (0.6344) acc_x 90.6250 (83.7500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/17] time 0.167 (0.175) data 0.090 (0.098) loss_x loss_x 0.4219 (0.6199) acc_x 90.6250 (83.5417) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/33] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.8999 (0.9160) acc_u 12.5000 (9.3750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/33] time 0.165 (0.174) data 0.088 (0.097) loss_u loss_u 0.9473 (0.9199) acc_u 9.3750 (9.6875) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/33] time 0.167 (0.173) data 0.090 (0.096) loss_u loss_u 0.8975 (0.9183) acc_u 9.3750 (9.7917) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/33] time 0.165 (0.172) data 0.088 (0.095) loss_u loss_u 0.9458 (0.9169) acc_u 6.2500 (10.0000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/33] time 0.177 (0.172) data 0.099 (0.095) loss_u loss_u 0.8633 (0.9149) acc_u 12.5000 (10.0000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/33] time 0.162 (0.172) data 0.084 (0.095) loss_u loss_u 0.8779 (0.9080) acc_u 12.5000 (10.9375) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 846
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:281
clean false:267
clean_rate:0.5127737226277372
noisy true:489
noisy false:579
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [141/200] batch [5/17] time 0.165 (0.171) data 0.088 (0.093) loss_x loss_x 0.6543 (0.6090) acc_x 75.0000 (81.2500) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/17] time 0.176 (0.171) data 0.099 (0.093) loss_x loss_x 0.6299 (0.6160) acc_x 87.5000 (81.5625) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [15/17] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.5723 (0.6094) acc_x 84.3750 (82.0833) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/33] time 0.172 (0.175) data 0.094 (0.097) loss_u loss_u 0.8677 (0.9193) acc_u 18.7500 (9.3750) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/33] time 0.171 (0.174) data 0.093 (0.097) loss_u loss_u 0.8960 (0.9141) acc_u 12.5000 (10.3125) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/33] time 0.186 (0.175) data 0.108 (0.098) loss_u loss_u 0.9072 (0.9010) acc_u 9.3750 (11.8750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/33] time 0.167 (0.175) data 0.090 (0.097) loss_u loss_u 0.8706 (0.8954) acc_u 15.6250 (12.8125) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/33] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.8555 (0.8939) acc_u 15.6250 (12.7500) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/33] time 0.180 (0.174) data 0.102 (0.096) loss_u loss_u 0.8696 (0.8966) acc_u 15.6250 (12.3958) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 864
confident_label rate tensor(0.3267, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 528
clean true:280
clean false:248
clean_rate:0.5303030303030303
noisy true:472
noisy false:616
after delete: len(clean_dataset) 528
after delete: len(noisy_dataset) 1088
epoch [142/200] batch [5/16] time 0.175 (0.171) data 0.098 (0.094) loss_x loss_x 0.6411 (0.6329) acc_x 78.1250 (81.2500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/16] time 0.164 (0.169) data 0.086 (0.092) loss_x loss_x 0.2761 (0.6396) acc_x 93.7500 (81.5625) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [15/16] time 0.158 (0.171) data 0.082 (0.094) loss_x loss_x 0.5532 (0.5758) acc_x 90.6250 (83.7500) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/34] time 0.186 (0.173) data 0.108 (0.095) loss_u loss_u 0.8315 (0.8750) acc_u 21.8750 (15.6250) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/34] time 0.166 (0.172) data 0.088 (0.095) loss_u loss_u 0.8706 (0.8830) acc_u 15.6250 (13.7500) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/34] time 0.169 (0.172) data 0.091 (0.094) loss_u loss_u 0.9224 (0.8795) acc_u 6.2500 (14.1667) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/34] time 0.183 (0.173) data 0.105 (0.095) loss_u loss_u 0.9121 (0.8792) acc_u 12.5000 (14.2188) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/34] time 0.169 (0.172) data 0.090 (0.095) loss_u loss_u 0.9458 (0.8891) acc_u 6.2500 (13.0000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/34] time 0.172 (0.173) data 0.093 (0.095) loss_u loss_u 0.9028 (0.8927) acc_u 9.3750 (12.7083) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 875
confident_label rate tensor(0.3280, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 530
clean true:271
clean false:259
clean_rate:0.5113207547169811
noisy true:470
noisy false:616
after delete: len(clean_dataset) 530
after delete: len(noisy_dataset) 1086
epoch [143/200] batch [5/16] time 0.211 (0.188) data 0.134 (0.111) loss_x loss_x 0.3220 (0.5894) acc_x 84.3750 (82.5000) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/16] time 0.170 (0.178) data 0.092 (0.101) loss_x loss_x 0.6567 (0.5693) acc_x 84.3750 (84.3750) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [15/16] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.6030 (0.5828) acc_x 78.1250 (85.0000) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/33] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.9482 (0.8875) acc_u 6.2500 (12.5000) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/33] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.8047 (0.8858) acc_u 21.8750 (12.8125) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/33] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.8945 (0.8938) acc_u 12.5000 (12.0833) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/33] time 0.192 (0.175) data 0.114 (0.098) loss_u loss_u 0.9302 (0.9035) acc_u 9.3750 (11.0938) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/33] time 0.172 (0.175) data 0.093 (0.098) loss_u loss_u 0.8721 (0.9026) acc_u 15.6250 (11.2500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/33] time 0.186 (0.176) data 0.109 (0.098) loss_u loss_u 0.8276 (0.8964) acc_u 21.8750 (12.1875) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 865
confident_label rate tensor(0.3410, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 551
clean true:287
clean false:264
clean_rate:0.5208711433756806
noisy true:464
noisy false:601
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1065
epoch [144/200] batch [5/17] time 0.187 (0.179) data 0.109 (0.102) loss_x loss_x 0.8477 (0.6492) acc_x 78.1250 (83.7500) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/17] time 0.193 (0.181) data 0.115 (0.104) loss_x loss_x 0.4211 (0.6724) acc_x 87.5000 (83.1250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [15/17] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.7422 (0.7119) acc_x 71.8750 (82.7083) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/33] time 0.172 (0.178) data 0.095 (0.100) loss_u loss_u 0.9351 (0.8959) acc_u 6.2500 (10.6250) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/33] time 0.175 (0.178) data 0.096 (0.100) loss_u loss_u 0.8862 (0.9066) acc_u 12.5000 (10.0000) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/33] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.8276 (0.8897) acc_u 18.7500 (12.2917) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/33] time 0.165 (0.175) data 0.088 (0.098) loss_u loss_u 0.9370 (0.8981) acc_u 6.2500 (11.4062) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/33] time 0.168 (0.174) data 0.091 (0.097) loss_u loss_u 0.9800 (0.9021) acc_u 0.0000 (11.0000) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/33] time 0.188 (0.175) data 0.108 (0.097) loss_u loss_u 0.8721 (0.8988) acc_u 15.6250 (11.4583) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 886
confident_label rate tensor(0.3373, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 545
clean true:275
clean false:270
clean_rate:0.5045871559633027
noisy true:455
noisy false:616
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1071
epoch [145/200] batch [5/17] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.7544 (0.6277) acc_x 81.2500 (85.6250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/17] time 0.216 (0.193) data 0.138 (0.117) loss_x loss_x 0.2986 (0.5718) acc_x 90.6250 (86.2500) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [15/17] time 0.171 (0.187) data 0.094 (0.110) loss_x loss_x 0.4365 (0.6019) acc_x 87.5000 (84.3750) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/33] time 0.177 (0.184) data 0.100 (0.107) loss_u loss_u 0.9570 (0.9111) acc_u 3.1250 (9.3750) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [10/33] time 0.169 (0.181) data 0.092 (0.104) loss_u loss_u 0.8457 (0.9066) acc_u 15.6250 (10.0000) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/33] time 0.178 (0.181) data 0.100 (0.103) loss_u loss_u 0.8750 (0.8999) acc_u 18.7500 (11.6667) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/33] time 0.178 (0.180) data 0.099 (0.102) loss_u loss_u 0.8291 (0.9017) acc_u 18.7500 (11.4062) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/33] time 0.169 (0.180) data 0.092 (0.103) loss_u loss_u 0.8711 (0.8996) acc_u 12.5000 (11.3750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [30/33] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.9077 (0.9007) acc_u 12.5000 (11.3542) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 885
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 539
clean true:275
clean false:264
clean_rate:0.5102040816326531
noisy true:456
noisy false:621
after delete: len(clean_dataset) 539
after delete: len(noisy_dataset) 1077
epoch [146/200] batch [5/16] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.2017 (0.5215) acc_x 96.8750 (85.0000) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/16] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.9829 (0.6131) acc_x 75.0000 (83.7500) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [15/16] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.8506 (0.6626) acc_x 78.1250 (82.2917) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/33] time 0.208 (0.184) data 0.131 (0.107) loss_u loss_u 0.9429 (0.8995) acc_u 6.2500 (11.8750) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [10/33] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.8896 (0.8978) acc_u 9.3750 (11.8750) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/33] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.8169 (0.8771) acc_u 21.8750 (14.1667) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/33] time 0.171 (0.180) data 0.094 (0.102) loss_u loss_u 0.9604 (0.8826) acc_u 0.0000 (13.4375) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/33] time 0.189 (0.180) data 0.111 (0.102) loss_u loss_u 0.9204 (0.8946) acc_u 9.3750 (12.1250) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/33] time 0.166 (0.179) data 0.089 (0.101) loss_u loss_u 0.9448 (0.8922) acc_u 6.2500 (12.2917) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 872
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 533
clean true:276
clean false:257
clean_rate:0.5178236397748592
noisy true:468
noisy false:615
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1083
epoch [147/200] batch [5/16] time 0.173 (0.165) data 0.095 (0.089) loss_x loss_x 0.7935 (0.6188) acc_x 81.2500 (85.6250) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/16] time 0.184 (0.173) data 0.106 (0.096) loss_x loss_x 0.7930 (0.5893) acc_x 75.0000 (85.0000) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [15/16] time 0.185 (0.176) data 0.108 (0.098) loss_x loss_x 0.4146 (0.5444) acc_x 87.5000 (86.0417) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/33] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.8994 (0.8783) acc_u 12.5000 (15.0000) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/33] time 0.187 (0.175) data 0.109 (0.098) loss_u loss_u 0.8623 (0.8926) acc_u 15.6250 (12.8125) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/33] time 0.162 (0.174) data 0.085 (0.096) loss_u loss_u 0.8955 (0.8909) acc_u 12.5000 (13.3333) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/33] time 0.182 (0.174) data 0.104 (0.096) loss_u loss_u 0.8623 (0.8879) acc_u 15.6250 (13.4375) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/33] time 0.175 (0.173) data 0.097 (0.096) loss_u loss_u 0.8701 (0.8873) acc_u 12.5000 (13.6250) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/33] time 0.185 (0.175) data 0.108 (0.097) loss_u loss_u 0.8706 (0.8889) acc_u 12.5000 (13.1250) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 873
confident_label rate tensor(0.3373, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 545
clean true:279
clean false:266
clean_rate:0.5119266055045871
noisy true:464
noisy false:607
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1071
epoch [148/200] batch [5/17] time 0.186 (0.186) data 0.110 (0.110) loss_x loss_x 0.4756 (0.6934) acc_x 90.6250 (86.8750) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/17] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.7373 (0.6345) acc_x 78.1250 (86.5625) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [15/17] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.3765 (0.5942) acc_x 87.5000 (87.2917) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/33] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.9253 (0.9182) acc_u 12.5000 (9.3750) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [10/33] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.9316 (0.9066) acc_u 9.3750 (10.9375) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/33] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.7852 (0.8995) acc_u 28.1250 (12.2917) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/33] time 0.168 (0.183) data 0.090 (0.106) loss_u loss_u 0.8506 (0.9009) acc_u 15.6250 (11.7188) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/33] time 0.188 (0.183) data 0.111 (0.106) loss_u loss_u 0.9248 (0.8975) acc_u 9.3750 (11.7500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/33] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.9395 (0.9024) acc_u 9.3750 (11.1458) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 859
confident_label rate tensor(0.3403, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 550
clean true:280
clean false:270
clean_rate:0.509090909090909
noisy true:477
noisy false:589
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1066
epoch [149/200] batch [5/17] time 0.176 (0.171) data 0.100 (0.094) loss_x loss_x 0.3640 (0.6089) acc_x 90.6250 (83.7500) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [10/17] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.5840 (0.6065) acc_x 81.2500 (84.6875) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [15/17] time 0.184 (0.177) data 0.107 (0.101) loss_x loss_x 0.3250 (0.6147) acc_x 90.6250 (83.7500) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/33] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.9580 (0.9187) acc_u 3.1250 (10.0000) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [10/33] time 0.175 (0.179) data 0.097 (0.102) loss_u loss_u 0.8354 (0.9142) acc_u 18.7500 (10.0000) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/33] time 0.170 (0.178) data 0.091 (0.101) loss_u loss_u 0.8672 (0.9055) acc_u 15.6250 (11.2500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/33] time 0.193 (0.178) data 0.114 (0.101) loss_u loss_u 0.9189 (0.9020) acc_u 6.2500 (11.4062) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/33] time 0.169 (0.178) data 0.091 (0.100) loss_u loss_u 0.7896 (0.8965) acc_u 21.8750 (11.8750) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/33] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.8760 (0.8884) acc_u 12.5000 (12.8125) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 862
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:287
clean false:267
clean_rate:0.5180505415162455
noisy true:467
noisy false:595
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [150/200] batch [5/17] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.6431 (0.5017) acc_x 81.2500 (86.2500) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/17] time 0.177 (0.176) data 0.099 (0.099) loss_x loss_x 0.3372 (0.5298) acc_x 90.6250 (85.0000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/17] time 0.189 (0.178) data 0.110 (0.100) loss_x loss_x 0.5483 (0.5263) acc_x 93.7500 (85.6250) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/33] time 0.172 (0.177) data 0.093 (0.099) loss_u loss_u 0.8545 (0.8744) acc_u 12.5000 (13.7500) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/33] time 0.174 (0.176) data 0.096 (0.098) loss_u loss_u 0.8179 (0.8886) acc_u 18.7500 (12.1875) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/33] time 0.165 (0.175) data 0.086 (0.097) loss_u loss_u 0.9580 (0.9044) acc_u 3.1250 (10.8333) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/33] time 0.181 (0.175) data 0.104 (0.097) loss_u loss_u 0.9771 (0.9159) acc_u 0.0000 (9.5312) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/33] time 0.169 (0.175) data 0.091 (0.097) loss_u loss_u 0.9238 (0.9113) acc_u 6.2500 (10.1250) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/33] time 0.172 (0.174) data 0.093 (0.096) loss_u loss_u 0.8081 (0.9026) acc_u 21.8750 (11.1458) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 873
confident_label rate tensor(0.3496, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 565
clean true:284
clean false:281
clean_rate:0.5026548672566372
noisy true:459
noisy false:592
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1051
epoch [151/200] batch [5/17] time 0.160 (0.179) data 0.084 (0.102) loss_x loss_x 0.7925 (0.7736) acc_x 81.2500 (78.1250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/17] time 0.179 (0.179) data 0.103 (0.102) loss_x loss_x 0.2250 (0.6919) acc_x 93.7500 (80.3125) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [15/17] time 0.170 (0.176) data 0.092 (0.099) loss_x loss_x 1.1318 (0.7133) acc_x 78.1250 (80.4167) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/32] time 0.175 (0.178) data 0.097 (0.101) loss_u loss_u 0.9512 (0.9303) acc_u 6.2500 (8.7500) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/32] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.9136 (0.9207) acc_u 9.3750 (10.3125) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [15/32] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.9624 (0.9049) acc_u 3.1250 (12.0833) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/32] time 0.172 (0.178) data 0.094 (0.101) loss_u loss_u 0.8765 (0.9030) acc_u 18.7500 (12.3438) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/32] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9185 (0.9032) acc_u 9.3750 (12.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/32] time 0.187 (0.178) data 0.107 (0.101) loss_u loss_u 0.9058 (0.9052) acc_u 12.5000 (11.9792) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 893
confident_label rate tensor(0.3286, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 531
clean true:261
clean false:270
clean_rate:0.4915254237288136
noisy true:462
noisy false:623
after delete: len(clean_dataset) 531
after delete: len(noisy_dataset) 1085
epoch [152/200] batch [5/16] time 0.175 (0.169) data 0.099 (0.092) loss_x loss_x 0.4246 (0.5513) acc_x 78.1250 (82.5000) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/16] time 0.182 (0.175) data 0.105 (0.099) loss_x loss_x 0.6055 (0.7222) acc_x 87.5000 (80.6250) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/16] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.7046 (0.7236) acc_x 90.6250 (82.0833) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/33] time 0.165 (0.176) data 0.086 (0.099) loss_u loss_u 0.9180 (0.8761) acc_u 6.2500 (12.5000) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/33] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.9072 (0.8854) acc_u 12.5000 (12.1875) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/33] time 0.167 (0.175) data 0.090 (0.098) loss_u loss_u 0.9380 (0.8861) acc_u 6.2500 (12.7083) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [20/33] time 0.166 (0.174) data 0.089 (0.097) loss_u loss_u 0.8882 (0.8847) acc_u 12.5000 (13.4375) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/33] time 0.178 (0.176) data 0.099 (0.098) loss_u loss_u 0.9038 (0.8881) acc_u 9.3750 (12.8750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/33] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.8936 (0.8905) acc_u 12.5000 (12.6042) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 885
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 535
clean true:268
clean false:267
clean_rate:0.5009345794392523
noisy true:463
noisy false:618
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1081
epoch [153/200] batch [5/16] time 0.191 (0.185) data 0.114 (0.109) loss_x loss_x 0.5181 (0.6474) acc_x 87.5000 (85.0000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/16] time 0.165 (0.182) data 0.087 (0.105) loss_x loss_x 0.4607 (0.6380) acc_x 87.5000 (83.4375) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [15/16] time 0.164 (0.177) data 0.087 (0.100) loss_x loss_x 0.6567 (0.6244) acc_x 78.1250 (82.7083) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/33] time 0.161 (0.175) data 0.084 (0.098) loss_u loss_u 0.9321 (0.8925) acc_u 6.2500 (13.1250) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/33] time 0.184 (0.174) data 0.107 (0.097) loss_u loss_u 0.8643 (0.8959) acc_u 15.6250 (11.8750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/33] time 0.188 (0.176) data 0.111 (0.098) loss_u loss_u 0.8037 (0.8891) acc_u 21.8750 (12.7083) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/33] time 0.179 (0.176) data 0.101 (0.098) loss_u loss_u 0.8579 (0.8738) acc_u 15.6250 (14.2188) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/33] time 0.169 (0.176) data 0.091 (0.099) loss_u loss_u 0.8857 (0.8756) acc_u 12.5000 (14.1250) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/33] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.9272 (0.8784) acc_u 9.3750 (13.8542) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 860
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:282
clean false:266
clean_rate:0.5145985401459854
noisy true:474
noisy false:594
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [154/200] batch [5/17] time 0.203 (0.180) data 0.126 (0.104) loss_x loss_x 0.2422 (0.6733) acc_x 93.7500 (83.7500) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/17] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 1.0156 (0.6685) acc_x 81.2500 (82.8125) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [15/17] time 0.164 (0.174) data 0.087 (0.097) loss_x loss_x 0.6299 (0.6691) acc_x 90.6250 (83.9583) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/33] time 0.162 (0.175) data 0.083 (0.098) loss_u loss_u 0.9194 (0.8688) acc_u 9.3750 (16.8750) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/33] time 0.187 (0.177) data 0.108 (0.100) loss_u loss_u 0.8037 (0.8779) acc_u 21.8750 (15.3125) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/33] time 0.187 (0.179) data 0.109 (0.101) loss_u loss_u 0.9194 (0.8923) acc_u 9.3750 (13.3333) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/33] time 0.184 (0.180) data 0.106 (0.102) loss_u loss_u 0.9243 (0.8898) acc_u 9.3750 (13.4375) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/33] time 0.170 (0.179) data 0.093 (0.101) loss_u loss_u 0.8750 (0.8844) acc_u 15.6250 (14.1250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/33] time 0.188 (0.179) data 0.109 (0.101) loss_u loss_u 0.9390 (0.8874) acc_u 6.2500 (13.5417) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 867
confident_label rate tensor(0.3373, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 545
clean true:278
clean false:267
clean_rate:0.5100917431192661
noisy true:471
noisy false:600
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1071
epoch [155/200] batch [5/17] time 0.173 (0.166) data 0.097 (0.090) loss_x loss_x 0.5825 (0.5895) acc_x 87.5000 (84.3750) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/17] time 0.181 (0.173) data 0.104 (0.096) loss_x loss_x 1.0977 (0.6858) acc_x 81.2500 (82.8125) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [15/17] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 0.7856 (0.6924) acc_x 71.8750 (82.5000) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/33] time 0.181 (0.180) data 0.103 (0.102) loss_u loss_u 0.9092 (0.8771) acc_u 9.3750 (15.6250) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [10/33] time 0.182 (0.180) data 0.104 (0.102) loss_u loss_u 0.8853 (0.8727) acc_u 15.6250 (15.9375) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/33] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.9097 (0.8905) acc_u 12.5000 (13.7500) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/33] time 0.178 (0.180) data 0.099 (0.103) loss_u loss_u 0.9272 (0.8945) acc_u 9.3750 (12.9688) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/33] time 0.168 (0.180) data 0.090 (0.102) loss_u loss_u 0.8340 (0.8873) acc_u 18.7500 (13.5000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/33] time 0.169 (0.179) data 0.091 (0.101) loss_u loss_u 0.8647 (0.8863) acc_u 12.5000 (13.4375) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 885
confident_label rate tensor(0.3410, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 551
clean true:275
clean false:276
clean_rate:0.49909255898366606
noisy true:456
noisy false:609
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1065
epoch [156/200] batch [5/17] time 0.187 (0.184) data 0.110 (0.108) loss_x loss_x 0.5708 (0.7485) acc_x 87.5000 (77.5000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/17] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 1.0479 (0.7135) acc_x 75.0000 (81.2500) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [15/17] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.4312 (0.6704) acc_x 93.7500 (82.7083) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/33] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.8027 (0.8683) acc_u 21.8750 (15.6250) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/33] time 0.183 (0.185) data 0.105 (0.108) loss_u loss_u 0.9189 (0.8742) acc_u 9.3750 (15.0000) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/33] time 0.175 (0.184) data 0.097 (0.108) loss_u loss_u 0.8892 (0.8818) acc_u 12.5000 (13.7500) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/33] time 0.170 (0.183) data 0.093 (0.106) loss_u loss_u 0.9487 (0.8849) acc_u 6.2500 (13.7500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/33] time 0.169 (0.182) data 0.092 (0.104) loss_u loss_u 0.8691 (0.8884) acc_u 21.8750 (13.6250) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/33] time 0.175 (0.180) data 0.096 (0.103) loss_u loss_u 0.8931 (0.8881) acc_u 12.5000 (13.4375) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 871
confident_label rate tensor(0.3379, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 546
clean true:283
clean false:263
clean_rate:0.5183150183150184
noisy true:462
noisy false:608
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 1070
epoch [157/200] batch [5/17] time 0.181 (0.176) data 0.105 (0.099) loss_x loss_x 0.5742 (0.3952) acc_x 84.3750 (87.5000) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/17] time 0.187 (0.179) data 0.110 (0.103) loss_x loss_x 0.3276 (0.5167) acc_x 87.5000 (84.6875) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/17] time 0.188 (0.181) data 0.111 (0.104) loss_x loss_x 0.5322 (0.5190) acc_x 87.5000 (85.0000) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/33] time 0.183 (0.182) data 0.106 (0.104) loss_u loss_u 0.8770 (0.8999) acc_u 15.6250 (12.5000) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/33] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.8882 (0.8867) acc_u 12.5000 (13.1250) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/33] time 0.170 (0.180) data 0.092 (0.103) loss_u loss_u 0.8330 (0.8911) acc_u 21.8750 (12.7083) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/33] time 0.168 (0.180) data 0.091 (0.102) loss_u loss_u 0.8657 (0.8910) acc_u 15.6250 (12.8125) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/33] time 0.178 (0.178) data 0.100 (0.101) loss_u loss_u 0.9595 (0.8919) acc_u 3.1250 (13.0000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/33] time 0.184 (0.179) data 0.107 (0.101) loss_u loss_u 0.9546 (0.8956) acc_u 6.2500 (12.6042) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 883
confident_label rate tensor(0.3373, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 545
clean true:276
clean false:269
clean_rate:0.5064220183486239
noisy true:457
noisy false:614
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1071
epoch [158/200] batch [5/17] time 0.186 (0.180) data 0.107 (0.102) loss_x loss_x 0.6172 (0.7201) acc_x 84.3750 (80.6250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/17] time 0.181 (0.181) data 0.104 (0.103) loss_x loss_x 0.4707 (0.6446) acc_x 84.3750 (82.1875) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [15/17] time 0.186 (0.182) data 0.110 (0.104) loss_x loss_x 0.5562 (0.5874) acc_x 87.5000 (83.5417) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/33] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.8789 (0.9049) acc_u 12.5000 (11.2500) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/33] time 0.191 (0.183) data 0.113 (0.106) loss_u loss_u 0.8125 (0.8946) acc_u 21.8750 (11.8750) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/33] time 0.177 (0.182) data 0.097 (0.104) loss_u loss_u 0.7607 (0.8873) acc_u 28.1250 (12.5000) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/33] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9688 (0.8938) acc_u 3.1250 (11.5625) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/33] time 0.184 (0.181) data 0.107 (0.103) loss_u loss_u 0.8530 (0.8899) acc_u 18.7500 (12.3750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/33] time 0.183 (0.182) data 0.106 (0.104) loss_u loss_u 0.7964 (0.8852) acc_u 25.0000 (13.0208) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 873
confident_label rate tensor(0.3410, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 551
clean true:271
clean false:280
clean_rate:0.49183303085299457
noisy true:472
noisy false:593
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1065
epoch [159/200] batch [5/17] time 0.175 (0.182) data 0.099 (0.105) loss_x loss_x 0.5801 (0.5089) acc_x 81.2500 (85.6250) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/17] time 0.166 (0.176) data 0.089 (0.100) loss_x loss_x 0.7754 (0.6250) acc_x 81.2500 (84.3750) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [15/17] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.6851 (0.6946) acc_x 84.3750 (82.9167) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/33] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.8413 (0.8580) acc_u 21.8750 (16.2500) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/33] time 0.176 (0.175) data 0.096 (0.098) loss_u loss_u 0.9473 (0.8896) acc_u 6.2500 (12.8125) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/33] time 0.180 (0.174) data 0.103 (0.097) loss_u loss_u 0.8047 (0.8974) acc_u 25.0000 (11.8750) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/33] time 0.180 (0.174) data 0.102 (0.097) loss_u loss_u 0.9175 (0.9013) acc_u 9.3750 (11.4062) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/33] time 0.161 (0.174) data 0.083 (0.097) loss_u loss_u 0.8213 (0.8979) acc_u 18.7500 (11.6250) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/33] time 0.169 (0.175) data 0.092 (0.097) loss_u loss_u 0.9668 (0.8974) acc_u 3.1250 (11.6667) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 867
confident_label rate tensor(0.3360, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 543
clean true:276
clean false:267
clean_rate:0.5082872928176796
noisy true:473
noisy false:600
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 1073
epoch [160/200] batch [5/16] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.6631 (0.5514) acc_x 87.5000 (84.3750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/16] time 0.159 (0.169) data 0.082 (0.092) loss_x loss_x 0.4929 (0.5662) acc_x 90.6250 (86.2500) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/16] time 0.177 (0.174) data 0.100 (0.097) loss_x loss_x 0.2808 (0.5314) acc_x 93.7500 (87.5000) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/33] time 0.195 (0.177) data 0.118 (0.100) loss_u loss_u 0.9380 (0.8763) acc_u 6.2500 (13.7500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/33] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.9746 (0.8967) acc_u 3.1250 (11.2500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/33] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.9014 (0.8980) acc_u 12.5000 (11.2500) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/33] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9365 (0.8936) acc_u 6.2500 (11.8750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/33] time 0.167 (0.179) data 0.087 (0.101) loss_u loss_u 0.7607 (0.8944) acc_u 25.0000 (11.7500) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [30/33] time 0.170 (0.179) data 0.092 (0.101) loss_u loss_u 0.8813 (0.8961) acc_u 12.5000 (11.6667) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 882
confident_label rate tensor(0.3403, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 550
clean true:277
clean false:273
clean_rate:0.5036363636363637
noisy true:457
noisy false:609
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1066
epoch [161/200] batch [5/17] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 1.0576 (0.6518) acc_x 78.1250 (84.3750) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/17] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.3381 (0.5765) acc_x 87.5000 (84.3750) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/17] time 0.167 (0.174) data 0.091 (0.097) loss_x loss_x 0.4775 (0.5547) acc_x 87.5000 (84.7917) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/33] time 0.167 (0.172) data 0.089 (0.095) loss_u loss_u 0.8540 (0.8494) acc_u 18.7500 (17.5000) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/33] time 0.190 (0.173) data 0.111 (0.096) loss_u loss_u 0.9517 (0.9056) acc_u 6.2500 (10.6250) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [15/33] time 0.183 (0.174) data 0.105 (0.097) loss_u loss_u 0.8403 (0.8959) acc_u 18.7500 (11.6667) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/33] time 0.187 (0.175) data 0.110 (0.098) loss_u loss_u 0.8237 (0.8828) acc_u 18.7500 (12.9688) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/33] time 0.182 (0.177) data 0.106 (0.099) loss_u loss_u 0.8999 (0.8891) acc_u 15.6250 (12.5000) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/33] time 0.174 (0.177) data 0.096 (0.099) loss_u loss_u 0.8291 (0.8896) acc_u 21.8750 (12.7083) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 877
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 555
clean true:281
clean false:274
clean_rate:0.5063063063063064
noisy true:458
noisy false:603
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1061
epoch [162/200] batch [5/17] time 0.175 (0.181) data 0.098 (0.104) loss_x loss_x 0.5513 (0.6000) acc_x 84.3750 (85.6250) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/17] time 0.178 (0.178) data 0.100 (0.101) loss_x loss_x 0.8184 (0.5875) acc_x 81.2500 (85.9375) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/17] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.3184 (0.5503) acc_x 87.5000 (86.4583) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/33] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.9761 (0.8407) acc_u 3.1250 (18.1250) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/33] time 0.166 (0.173) data 0.089 (0.096) loss_u loss_u 0.9653 (0.8620) acc_u 3.1250 (15.6250) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [15/33] time 0.193 (0.173) data 0.115 (0.096) loss_u loss_u 0.8057 (0.8658) acc_u 18.7500 (14.7917) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/33] time 0.180 (0.174) data 0.102 (0.097) loss_u loss_u 0.9507 (0.8762) acc_u 6.2500 (13.7500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/33] time 0.170 (0.174) data 0.093 (0.097) loss_u loss_u 0.9023 (0.8866) acc_u 12.5000 (12.8750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [30/33] time 0.185 (0.175) data 0.107 (0.097) loss_u loss_u 0.9048 (0.8879) acc_u 12.5000 (12.8125) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 873
confident_label rate tensor(0.3441, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 556
clean true:285
clean false:271
clean_rate:0.512589928057554
noisy true:458
noisy false:602
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1060
epoch [163/200] batch [5/17] time 0.169 (0.169) data 0.093 (0.093) loss_x loss_x 0.8281 (0.5457) acc_x 84.3750 (88.7500) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/17] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.9102 (0.6235) acc_x 75.0000 (84.6875) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/17] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.8213 (0.6663) acc_x 78.1250 (82.9167) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/33] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.9492 (0.9033) acc_u 3.1250 (10.6250) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [10/33] time 0.160 (0.177) data 0.083 (0.099) loss_u loss_u 0.9170 (0.9033) acc_u 12.5000 (11.2500) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/33] time 0.163 (0.175) data 0.084 (0.098) loss_u loss_u 0.9395 (0.9118) acc_u 9.3750 (10.2083) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/33] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.8892 (0.9056) acc_u 15.6250 (10.9375) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/33] time 0.177 (0.176) data 0.100 (0.098) loss_u loss_u 0.9429 (0.9022) acc_u 9.3750 (11.3750) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/33] time 0.172 (0.175) data 0.095 (0.097) loss_u loss_u 0.9126 (0.8997) acc_u 9.3750 (11.7708) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 877
confident_label rate tensor(0.3441, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 556
clean true:282
clean false:274
clean_rate:0.5071942446043165
noisy true:457
noisy false:603
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1060
epoch [164/200] batch [5/17] time 0.176 (0.185) data 0.098 (0.107) loss_x loss_x 0.5186 (0.6349) acc_x 87.5000 (84.3750) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [10/17] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.4275 (0.5436) acc_x 84.3750 (86.2500) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [15/17] time 0.158 (0.175) data 0.082 (0.098) loss_x loss_x 0.3804 (0.5675) acc_x 93.7500 (86.0417) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/33] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.8306 (0.8802) acc_u 18.7500 (14.3750) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/33] time 0.164 (0.173) data 0.087 (0.096) loss_u loss_u 0.9092 (0.8913) acc_u 9.3750 (12.8125) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/33] time 0.182 (0.173) data 0.104 (0.096) loss_u loss_u 0.9375 (0.8854) acc_u 6.2500 (13.3333) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/33] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.9458 (0.8890) acc_u 6.2500 (12.9688) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/33] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.8901 (0.8906) acc_u 12.5000 (12.6250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/33] time 0.185 (0.175) data 0.108 (0.098) loss_u loss_u 0.8867 (0.8908) acc_u 12.5000 (12.7083) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 875
confident_label rate tensor(0.3317, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 536
clean true:274
clean false:262
clean_rate:0.5111940298507462
noisy true:467
noisy false:613
after delete: len(clean_dataset) 536
after delete: len(noisy_dataset) 1080
epoch [165/200] batch [5/16] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.6523 (0.7361) acc_x 81.2500 (84.3750) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/16] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.4866 (0.6766) acc_x 81.2500 (82.8125) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/16] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.7607 (0.6463) acc_x 71.8750 (83.1250) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/33] time 0.182 (0.183) data 0.103 (0.106) loss_u loss_u 0.9062 (0.8975) acc_u 12.5000 (11.8750) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [10/33] time 0.188 (0.182) data 0.109 (0.105) loss_u loss_u 0.8169 (0.8901) acc_u 18.7500 (12.1875) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/33] time 0.177 (0.182) data 0.098 (0.105) loss_u loss_u 0.9102 (0.8913) acc_u 9.3750 (11.8750) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/33] time 0.178 (0.181) data 0.101 (0.104) loss_u loss_u 0.9106 (0.8824) acc_u 12.5000 (13.4375) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/33] time 0.170 (0.182) data 0.093 (0.104) loss_u loss_u 0.9111 (0.8779) acc_u 9.3750 (13.7500) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/33] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.9561 (0.8832) acc_u 6.2500 (13.1250) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 877
confident_label rate tensor(0.3447, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 557
clean true:278
clean false:279
clean_rate:0.4991023339317774
noisy true:461
noisy false:598
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1059
epoch [166/200] batch [5/17] time 0.183 (0.170) data 0.107 (0.093) loss_x loss_x 0.3413 (0.4902) acc_x 90.6250 (88.7500) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [10/17] time 0.176 (0.177) data 0.100 (0.101) loss_x loss_x 0.7896 (0.5565) acc_x 78.1250 (84.6875) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [15/17] time 0.164 (0.178) data 0.087 (0.102) loss_x loss_x 0.9609 (0.5966) acc_x 71.8750 (84.1667) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/33] time 0.183 (0.180) data 0.105 (0.103) loss_u loss_u 0.9302 (0.9068) acc_u 9.3750 (10.6250) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/33] time 0.177 (0.180) data 0.099 (0.103) loss_u loss_u 0.9639 (0.9198) acc_u 6.2500 (9.3750) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/33] time 0.159 (0.178) data 0.082 (0.101) loss_u loss_u 0.7910 (0.9028) acc_u 25.0000 (11.6667) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/33] time 0.165 (0.176) data 0.087 (0.099) loss_u loss_u 0.9360 (0.8917) acc_u 6.2500 (12.6562) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/33] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.9229 (0.8874) acc_u 12.5000 (13.3750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/33] time 0.178 (0.175) data 0.100 (0.098) loss_u loss_u 0.9824 (0.8893) acc_u 3.1250 (13.1250) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 866
confident_label rate tensor(0.3441, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 556
clean true:285
clean false:271
clean_rate:0.512589928057554
noisy true:465
noisy false:595
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1060
epoch [167/200] batch [5/17] time 0.164 (0.163) data 0.085 (0.085) loss_x loss_x 0.7119 (0.5171) acc_x 81.2500 (86.2500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/17] time 0.172 (0.163) data 0.094 (0.086) loss_x loss_x 0.4810 (0.5250) acc_x 87.5000 (85.9375) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [15/17] time 0.184 (0.166) data 0.108 (0.089) loss_x loss_x 0.4290 (0.5251) acc_x 87.5000 (86.8750) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/33] time 0.159 (0.169) data 0.082 (0.092) loss_u loss_u 0.9473 (0.9262) acc_u 6.2500 (8.1250) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/33] time 0.160 (0.168) data 0.083 (0.090) loss_u loss_u 0.9043 (0.8861) acc_u 9.3750 (13.4375) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/33] time 0.173 (0.167) data 0.095 (0.090) loss_u loss_u 0.8926 (0.8907) acc_u 9.3750 (12.2917) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/33] time 0.171 (0.167) data 0.094 (0.090) loss_u loss_u 0.8809 (0.8928) acc_u 15.6250 (12.5000) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/33] time 0.170 (0.168) data 0.093 (0.091) loss_u loss_u 0.9292 (0.8962) acc_u 9.3750 (12.2500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/33] time 0.178 (0.169) data 0.101 (0.092) loss_u loss_u 0.8618 (0.8956) acc_u 15.6250 (12.0833) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 886
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:288
clean false:283
clean_rate:0.5043782837127846
noisy true:442
noisy false:603
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [168/200] batch [5/17] time 0.188 (0.182) data 0.110 (0.105) loss_x loss_x 1.0117 (0.6471) acc_x 65.6250 (79.3750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/17] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.5469 (0.6179) acc_x 84.3750 (81.5625) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/17] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.4084 (0.6358) acc_x 90.6250 (81.6667) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/32] time 0.197 (0.184) data 0.120 (0.106) loss_u loss_u 0.9282 (0.9195) acc_u 6.2500 (8.7500) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/32] time 0.175 (0.184) data 0.098 (0.107) loss_u loss_u 0.9058 (0.9083) acc_u 9.3750 (10.3125) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [15/32] time 0.180 (0.183) data 0.103 (0.106) loss_u loss_u 0.8823 (0.9172) acc_u 12.5000 (9.1667) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/32] time 0.186 (0.184) data 0.109 (0.106) loss_u loss_u 0.7920 (0.9080) acc_u 28.1250 (10.7812) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/32] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.8403 (0.9079) acc_u 21.8750 (10.7500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/32] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8853 (0.9063) acc_u 15.6250 (11.1458) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 887
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 541
clean true:271
clean false:270
clean_rate:0.5009242144177449
noisy true:458
noisy false:617
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1075
epoch [169/200] batch [5/16] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.5576 (0.5200) acc_x 87.5000 (84.3750) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/16] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.3899 (0.6106) acc_x 90.6250 (83.7500) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/16] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.4900 (0.5585) acc_x 87.5000 (85.6250) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/33] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.8315 (0.9048) acc_u 18.7500 (10.6250) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [10/33] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.9521 (0.9027) acc_u 6.2500 (11.5625) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/33] time 0.167 (0.178) data 0.090 (0.101) loss_u loss_u 0.8447 (0.8925) acc_u 15.6250 (12.7083) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/33] time 0.176 (0.177) data 0.097 (0.100) loss_u loss_u 0.9375 (0.8995) acc_u 6.2500 (11.7188) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/33] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.8550 (0.8910) acc_u 12.5000 (12.6250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/33] time 0.178 (0.178) data 0.099 (0.100) loss_u loss_u 0.8174 (0.8891) acc_u 21.8750 (12.9167) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 880
confident_label rate tensor(0.3502, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 566
clean true:282
clean false:284
clean_rate:0.49823321554770317
noisy true:454
noisy false:596
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1050
epoch [170/200] batch [5/17] time 0.164 (0.170) data 0.087 (0.093) loss_x loss_x 0.4680 (0.4366) acc_x 87.5000 (88.7500) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/17] time 0.182 (0.169) data 0.105 (0.092) loss_x loss_x 0.3108 (0.4076) acc_x 90.6250 (88.7500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/17] time 0.180 (0.172) data 0.103 (0.095) loss_x loss_x 0.2886 (0.4961) acc_x 90.6250 (86.2500) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/32] time 0.186 (0.175) data 0.108 (0.098) loss_u loss_u 0.8975 (0.8870) acc_u 12.5000 (13.7500) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/32] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.9268 (0.9147) acc_u 9.3750 (10.3125) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/32] time 0.168 (0.177) data 0.091 (0.099) loss_u loss_u 0.9233 (0.9033) acc_u 9.3750 (11.4583) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/32] time 0.191 (0.177) data 0.113 (0.099) loss_u loss_u 0.9487 (0.9080) acc_u 3.1250 (10.7812) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/32] time 0.175 (0.177) data 0.098 (0.099) loss_u loss_u 0.9468 (0.9092) acc_u 6.2500 (10.8750) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/32] time 0.190 (0.177) data 0.113 (0.100) loss_u loss_u 0.9141 (0.9083) acc_u 9.3750 (11.1458) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 885
confident_label rate tensor(0.3416, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 552
clean true:283
clean false:269
clean_rate:0.5126811594202898
noisy true:448
noisy false:616
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 1064
epoch [171/200] batch [5/17] time 0.196 (0.185) data 0.119 (0.108) loss_x loss_x 0.3203 (0.4530) acc_x 87.5000 (86.2500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/17] time 0.169 (0.184) data 0.092 (0.107) loss_x loss_x 0.5879 (0.4828) acc_x 84.3750 (85.9375) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [15/17] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.7798 (0.4916) acc_x 81.2500 (86.6667) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/33] time 0.190 (0.179) data 0.110 (0.102) loss_u loss_u 0.9409 (0.8891) acc_u 6.2500 (14.3750) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [10/33] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.9482 (0.9150) acc_u 6.2500 (10.9375) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/33] time 0.180 (0.180) data 0.101 (0.103) loss_u loss_u 0.9146 (0.9158) acc_u 9.3750 (10.4167) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [20/33] time 0.214 (0.182) data 0.137 (0.105) loss_u loss_u 0.9570 (0.9067) acc_u 3.1250 (11.2500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/33] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8613 (0.9002) acc_u 15.6250 (11.8750) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/33] time 0.166 (0.180) data 0.089 (0.103) loss_u loss_u 0.8975 (0.9002) acc_u 12.5000 (11.8750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 879
confident_label rate tensor(0.3373, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 545
clean true:274
clean false:271
clean_rate:0.5027522935779817
noisy true:463
noisy false:608
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1071
epoch [172/200] batch [5/17] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.6191 (0.5639) acc_x 87.5000 (87.5000) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/17] time 0.182 (0.181) data 0.105 (0.103) loss_x loss_x 0.7954 (0.5737) acc_x 75.0000 (86.8750) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/17] time 0.183 (0.182) data 0.106 (0.104) loss_x loss_x 0.5142 (0.5557) acc_x 84.3750 (87.5000) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/33] time 0.166 (0.180) data 0.088 (0.103) loss_u loss_u 0.8960 (0.8587) acc_u 12.5000 (17.5000) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [10/33] time 0.177 (0.180) data 0.100 (0.103) loss_u loss_u 0.9082 (0.8761) acc_u 9.3750 (14.6875) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/33] time 0.170 (0.179) data 0.094 (0.101) loss_u loss_u 0.8823 (0.8932) acc_u 12.5000 (12.2917) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [20/33] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.8369 (0.8812) acc_u 18.7500 (13.7500) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/33] time 0.185 (0.180) data 0.108 (0.102) loss_u loss_u 0.8818 (0.8843) acc_u 9.3750 (13.0000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/33] time 0.178 (0.181) data 0.099 (0.103) loss_u loss_u 0.9238 (0.8839) acc_u 9.3750 (13.1250) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 888
confident_label rate tensor(0.3453, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 558
clean true:271
clean false:287
clean_rate:0.48566308243727596
noisy true:457
noisy false:601
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1058
epoch [173/200] batch [5/17] time 0.179 (0.173) data 0.102 (0.096) loss_x loss_x 0.5581 (0.5740) acc_x 78.1250 (83.7500) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/17] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.4680 (0.6167) acc_x 87.5000 (83.4375) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/17] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 1.0391 (0.6545) acc_x 78.1250 (83.5417) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/33] time 0.168 (0.175) data 0.090 (0.098) loss_u loss_u 0.9165 (0.8919) acc_u 9.3750 (11.8750) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/33] time 0.170 (0.174) data 0.092 (0.097) loss_u loss_u 0.9966 (0.9067) acc_u 0.0000 (10.3125) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/33] time 0.176 (0.174) data 0.099 (0.096) loss_u loss_u 0.9780 (0.8955) acc_u 0.0000 (11.8750) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/33] time 0.178 (0.174) data 0.101 (0.096) loss_u loss_u 0.8350 (0.8952) acc_u 18.7500 (11.8750) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/33] time 0.177 (0.174) data 0.099 (0.097) loss_u loss_u 0.9326 (0.9014) acc_u 6.2500 (11.5000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/33] time 0.181 (0.175) data 0.104 (0.097) loss_u loss_u 0.9102 (0.9057) acc_u 12.5000 (11.2500) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 903
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:279
clean false:268
clean_rate:0.5100548446069469
noisy true:434
noisy false:635
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [174/200] batch [5/17] time 0.186 (0.186) data 0.109 (0.110) loss_x loss_x 0.5933 (0.5005) acc_x 81.2500 (86.2500) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/17] time 0.164 (0.182) data 0.086 (0.104) loss_x loss_x 0.8604 (0.5951) acc_x 78.1250 (84.3750) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [15/17] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.5488 (0.6188) acc_x 87.5000 (84.3750) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/33] time 0.169 (0.178) data 0.092 (0.101) loss_u loss_u 0.8237 (0.8760) acc_u 18.7500 (13.7500) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/33] time 0.179 (0.177) data 0.102 (0.099) loss_u loss_u 0.9209 (0.8670) acc_u 12.5000 (15.9375) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/33] time 0.185 (0.178) data 0.107 (0.100) loss_u loss_u 0.8550 (0.8591) acc_u 18.7500 (16.4583) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/33] time 0.160 (0.176) data 0.083 (0.099) loss_u loss_u 0.8584 (0.8675) acc_u 18.7500 (15.6250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/33] time 0.179 (0.176) data 0.101 (0.099) loss_u loss_u 0.8799 (0.8748) acc_u 12.5000 (14.7500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/33] time 0.173 (0.176) data 0.095 (0.099) loss_u loss_u 0.9351 (0.8740) acc_u 6.2500 (14.7917) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 893
confident_label rate tensor(0.3465, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 560
clean true:277
clean false:283
clean_rate:0.49464285714285716
noisy true:446
noisy false:610
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1056
epoch [175/200] batch [5/17] time 0.180 (0.180) data 0.104 (0.103) loss_x loss_x 0.2021 (0.4367) acc_x 100.0000 (90.0000) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/17] time 0.163 (0.173) data 0.086 (0.096) loss_x loss_x 0.7393 (0.4860) acc_x 84.3750 (88.4375) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [15/17] time 0.172 (0.170) data 0.095 (0.093) loss_x loss_x 0.3584 (0.5115) acc_x 90.6250 (86.6667) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/33] time 0.178 (0.173) data 0.100 (0.096) loss_u loss_u 0.9297 (0.9104) acc_u 6.2500 (9.3750) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/33] time 0.180 (0.175) data 0.103 (0.098) loss_u loss_u 0.9414 (0.9118) acc_u 6.2500 (10.0000) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/33] time 0.163 (0.175) data 0.083 (0.098) loss_u loss_u 0.8892 (0.9070) acc_u 12.5000 (11.0417) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/33] time 0.170 (0.176) data 0.092 (0.098) loss_u loss_u 0.9404 (0.9059) acc_u 6.2500 (11.0938) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/33] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.9409 (0.9066) acc_u 9.3750 (11.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/33] time 0.176 (0.175) data 0.098 (0.098) loss_u loss_u 0.8774 (0.8978) acc_u 12.5000 (11.9792) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 876
confident_label rate tensor(0.3410, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 551
clean true:276
clean false:275
clean_rate:0.5009074410163339
noisy true:464
noisy false:601
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1065
epoch [176/200] batch [5/17] time 0.182 (0.169) data 0.106 (0.093) loss_x loss_x 0.2808 (0.3987) acc_x 93.7500 (89.3750) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/17] time 0.183 (0.176) data 0.105 (0.099) loss_x loss_x 0.3350 (0.5233) acc_x 90.6250 (87.1875) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [15/17] time 0.165 (0.173) data 0.089 (0.096) loss_x loss_x 0.6216 (0.5340) acc_x 84.3750 (86.4583) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/33] time 0.168 (0.172) data 0.090 (0.095) loss_u loss_u 0.9053 (0.9288) acc_u 9.3750 (9.3750) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/33] time 0.191 (0.175) data 0.114 (0.098) loss_u loss_u 0.8691 (0.8981) acc_u 15.6250 (12.5000) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/33] time 0.170 (0.173) data 0.092 (0.096) loss_u loss_u 0.8154 (0.8996) acc_u 21.8750 (12.0833) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/33] time 0.187 (0.175) data 0.109 (0.098) loss_u loss_u 0.8760 (0.8919) acc_u 15.6250 (12.9688) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/33] time 0.186 (0.177) data 0.109 (0.099) loss_u loss_u 0.9243 (0.8895) acc_u 6.2500 (12.8750) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/33] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9116 (0.8839) acc_u 9.3750 (13.3333) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 883
confident_label rate tensor(0.3577, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 578
clean true:291
clean false:287
clean_rate:0.5034602076124568
noisy true:442
noisy false:596
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 1038
epoch [177/200] batch [5/18] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.7246 (0.6160) acc_x 78.1250 (83.1250) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/18] time 0.174 (0.176) data 0.096 (0.099) loss_x loss_x 0.4639 (0.5868) acc_x 87.5000 (84.6875) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/18] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.4851 (0.5924) acc_x 87.5000 (85.4167) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/32] time 0.158 (0.178) data 0.081 (0.101) loss_u loss_u 0.9399 (0.9019) acc_u 6.2500 (11.2500) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/32] time 0.170 (0.176) data 0.092 (0.099) loss_u loss_u 0.9370 (0.9178) acc_u 6.2500 (9.3750) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/32] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.9087 (0.9034) acc_u 12.5000 (11.2500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/32] time 0.166 (0.175) data 0.088 (0.098) loss_u loss_u 0.8281 (0.8996) acc_u 18.7500 (11.7188) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/32] time 0.161 (0.173) data 0.084 (0.096) loss_u loss_u 0.9497 (0.9023) acc_u 6.2500 (11.2500) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [30/32] time 0.185 (0.173) data 0.106 (0.096) loss_u loss_u 0.9702 (0.9016) acc_u 3.1250 (11.2500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 875
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 555
clean true:278
clean false:277
clean_rate:0.5009009009009009
noisy true:463
noisy false:598
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1061
epoch [178/200] batch [5/17] time 0.171 (0.169) data 0.094 (0.092) loss_x loss_x 0.6333 (0.7513) acc_x 81.2500 (80.6250) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/17] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.4800 (0.6607) acc_x 84.3750 (83.1250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/17] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.4575 (0.5975) acc_x 87.5000 (85.2083) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/33] time 0.179 (0.181) data 0.101 (0.103) loss_u loss_u 0.9653 (0.9047) acc_u 3.1250 (10.0000) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [10/33] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.8853 (0.9039) acc_u 18.7500 (11.8750) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/33] time 0.182 (0.180) data 0.104 (0.102) loss_u loss_u 0.8652 (0.8992) acc_u 15.6250 (12.2917) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/33] time 0.182 (0.180) data 0.106 (0.103) loss_u loss_u 0.9380 (0.8961) acc_u 6.2500 (12.3438) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/33] time 0.185 (0.181) data 0.106 (0.103) loss_u loss_u 0.9399 (0.8927) acc_u 6.2500 (12.5000) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/33] time 0.188 (0.181) data 0.111 (0.104) loss_u loss_u 0.8687 (0.8901) acc_u 15.6250 (13.0208) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 859
confident_label rate tensor(0.3366, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 544
clean true:278
clean false:266
clean_rate:0.5110294117647058
noisy true:479
noisy false:593
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 1072
epoch [179/200] batch [5/17] time 0.162 (0.168) data 0.085 (0.092) loss_x loss_x 0.8257 (0.6900) acc_x 81.2500 (85.6250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/17] time 0.176 (0.168) data 0.099 (0.091) loss_x loss_x 0.3738 (0.6165) acc_x 87.5000 (86.8750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/17] time 0.184 (0.171) data 0.107 (0.094) loss_x loss_x 0.5820 (0.6640) acc_x 90.6250 (85.0000) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/33] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.9282 (0.8630) acc_u 9.3750 (16.2500) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/33] time 0.190 (0.177) data 0.112 (0.100) loss_u loss_u 0.8940 (0.8864) acc_u 12.5000 (13.4375) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/33] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.8555 (0.8938) acc_u 18.7500 (12.2917) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/33] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9004 (0.8916) acc_u 12.5000 (12.5000) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/33] time 0.214 (0.182) data 0.136 (0.105) loss_u loss_u 0.9170 (0.8915) acc_u 9.3750 (12.3750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/33] time 0.162 (0.181) data 0.085 (0.103) loss_u loss_u 0.8110 (0.8887) acc_u 21.8750 (12.8125) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 866
confident_label rate tensor(0.3465, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 560
clean true:292
clean false:268
clean_rate:0.5214285714285715
noisy true:458
noisy false:598
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1056
epoch [180/200] batch [5/17] time 0.179 (0.180) data 0.101 (0.103) loss_x loss_x 0.7637 (0.6854) acc_x 81.2500 (86.2500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/17] time 0.191 (0.184) data 0.114 (0.107) loss_x loss_x 0.4656 (0.6616) acc_x 87.5000 (84.6875) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [15/17] time 0.175 (0.184) data 0.098 (0.107) loss_x loss_x 0.6997 (0.6343) acc_x 75.0000 (83.3333) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/33] time 0.166 (0.180) data 0.088 (0.103) loss_u loss_u 0.9316 (0.8995) acc_u 6.2500 (10.6250) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [10/33] time 0.177 (0.180) data 0.100 (0.102) loss_u loss_u 0.9595 (0.8982) acc_u 3.1250 (11.8750) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/33] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.9927 (0.9045) acc_u 0.0000 (11.2500) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/33] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.8926 (0.9029) acc_u 9.3750 (11.0938) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/33] time 0.177 (0.179) data 0.099 (0.101) loss_u loss_u 0.8628 (0.9009) acc_u 15.6250 (11.0000) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [30/33] time 0.165 (0.178) data 0.087 (0.101) loss_u loss_u 0.8257 (0.8925) acc_u 21.8750 (12.0833) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 869
confident_label rate tensor(0.3577, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 578
clean true:293
clean false:285
clean_rate:0.5069204152249135
noisy true:454
noisy false:584
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 1038
epoch [181/200] batch [5/18] time 0.181 (0.180) data 0.104 (0.104) loss_x loss_x 0.3586 (0.5829) acc_x 90.6250 (83.7500) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/18] time 0.176 (0.181) data 0.098 (0.103) loss_x loss_x 0.5366 (0.5889) acc_x 87.5000 (84.6875) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/18] time 0.189 (0.181) data 0.112 (0.104) loss_x loss_x 0.7720 (0.5597) acc_x 87.5000 (86.4583) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/32] time 0.188 (0.178) data 0.110 (0.101) loss_u loss_u 0.9316 (0.8998) acc_u 6.2500 (10.0000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/32] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.9175 (0.9060) acc_u 9.3750 (10.6250) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/32] time 0.188 (0.180) data 0.110 (0.103) loss_u loss_u 0.8989 (0.9084) acc_u 9.3750 (10.2083) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/32] time 0.190 (0.180) data 0.113 (0.103) loss_u loss_u 0.9663 (0.9139) acc_u 0.0000 (9.2188) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/32] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.9365 (0.9131) acc_u 6.2500 (9.3750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [30/32] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.9707 (0.9085) acc_u 3.1250 (10.0000) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 872
confident_label rate tensor(0.3502, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 566
clean true:282
clean false:284
clean_rate:0.49823321554770317
noisy true:462
noisy false:588
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1050
epoch [182/200] batch [5/17] time 0.171 (0.172) data 0.094 (0.095) loss_x loss_x 0.5225 (0.5797) acc_x 90.6250 (87.5000) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/17] time 0.168 (0.168) data 0.091 (0.091) loss_x loss_x 0.6826 (0.5481) acc_x 87.5000 (88.1250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/17] time 0.177 (0.170) data 0.100 (0.093) loss_x loss_x 0.5669 (0.6043) acc_x 87.5000 (87.2917) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/32] time 0.173 (0.175) data 0.094 (0.097) loss_u loss_u 0.9277 (0.8827) acc_u 9.3750 (14.3750) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/32] time 0.179 (0.176) data 0.102 (0.098) loss_u loss_u 0.9487 (0.8948) acc_u 9.3750 (12.8125) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/32] time 0.186 (0.177) data 0.108 (0.099) loss_u loss_u 0.8408 (0.8937) acc_u 18.7500 (12.5000) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/32] time 0.172 (0.177) data 0.094 (0.099) loss_u loss_u 0.8711 (0.8955) acc_u 15.6250 (12.3438) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/32] time 0.161 (0.176) data 0.084 (0.098) loss_u loss_u 0.7749 (0.8900) acc_u 28.1250 (13.1250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [30/32] time 0.186 (0.177) data 0.109 (0.099) loss_u loss_u 0.8706 (0.8946) acc_u 12.5000 (12.5000) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 881
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:277
clean false:277
clean_rate:0.5
noisy true:458
noisy false:604
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [183/200] batch [5/17] time 0.172 (0.178) data 0.093 (0.100) loss_x loss_x 0.8540 (0.4994) acc_x 75.0000 (84.3750) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/17] time 0.174 (0.172) data 0.096 (0.095) loss_x loss_x 0.8052 (0.4880) acc_x 81.2500 (85.0000) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [15/17] time 0.187 (0.176) data 0.110 (0.099) loss_x loss_x 0.4282 (0.4987) acc_x 87.5000 (85.2083) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/33] time 0.172 (0.177) data 0.094 (0.100) loss_u loss_u 0.9082 (0.9009) acc_u 12.5000 (11.8750) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/33] time 0.178 (0.177) data 0.100 (0.099) loss_u loss_u 0.9077 (0.8898) acc_u 9.3750 (13.7500) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/33] time 0.171 (0.175) data 0.094 (0.098) loss_u loss_u 0.8892 (0.8902) acc_u 12.5000 (13.5417) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/33] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.8804 (0.8917) acc_u 12.5000 (13.1250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/33] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8901 (0.8904) acc_u 12.5000 (13.1250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [30/33] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.9307 (0.8912) acc_u 6.2500 (12.8125) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 880
confident_label rate tensor(0.3496, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 565
clean true:286
clean false:279
clean_rate:0.5061946902654867
noisy true:450
noisy false:601
after delete: len(clean_dataset) 565
after delete: len(noisy_dataset) 1051
epoch [184/200] batch [5/17] time 0.178 (0.175) data 0.101 (0.098) loss_x loss_x 0.7397 (0.6566) acc_x 84.3750 (83.1250) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/17] time 0.166 (0.170) data 0.089 (0.093) loss_x loss_x 0.3711 (0.5835) acc_x 90.6250 (84.3750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/17] time 0.165 (0.168) data 0.088 (0.091) loss_x loss_x 0.6724 (0.5969) acc_x 84.3750 (84.3750) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/32] time 0.165 (0.170) data 0.088 (0.093) loss_u loss_u 0.8105 (0.8871) acc_u 21.8750 (13.1250) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/32] time 0.192 (0.172) data 0.113 (0.095) loss_u loss_u 0.9541 (0.8957) acc_u 6.2500 (12.5000) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/32] time 0.170 (0.173) data 0.092 (0.095) loss_u loss_u 0.9233 (0.9019) acc_u 9.3750 (11.4583) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/32] time 0.188 (0.175) data 0.110 (0.097) loss_u loss_u 0.8535 (0.9016) acc_u 15.6250 (11.7188) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/32] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.9268 (0.9024) acc_u 9.3750 (11.5000) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [30/32] time 0.189 (0.178) data 0.113 (0.100) loss_u loss_u 0.9287 (0.9062) acc_u 9.3750 (11.0417) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 886
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 538
clean true:276
clean false:262
clean_rate:0.5130111524163569
noisy true:454
noisy false:624
after delete: len(clean_dataset) 538
after delete: len(noisy_dataset) 1078
epoch [185/200] batch [5/16] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.4058 (0.6302) acc_x 87.5000 (85.0000) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/16] time 0.209 (0.180) data 0.132 (0.103) loss_x loss_x 0.2986 (0.5700) acc_x 90.6250 (85.0000) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/16] time 0.167 (0.178) data 0.091 (0.101) loss_x loss_x 0.6475 (0.5756) acc_x 93.7500 (85.8333) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/33] time 0.187 (0.178) data 0.108 (0.101) loss_u loss_u 0.9102 (0.9007) acc_u 12.5000 (11.8750) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/33] time 0.189 (0.178) data 0.111 (0.101) loss_u loss_u 0.9683 (0.8839) acc_u 3.1250 (14.3750) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/33] time 0.185 (0.179) data 0.106 (0.102) loss_u loss_u 0.9443 (0.8835) acc_u 6.2500 (14.1667) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/33] time 0.177 (0.180) data 0.098 (0.102) loss_u loss_u 0.9478 (0.8862) acc_u 6.2500 (13.7500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/33] time 0.169 (0.179) data 0.090 (0.101) loss_u loss_u 0.8555 (0.8851) acc_u 18.7500 (13.7500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [30/33] time 0.172 (0.178) data 0.094 (0.100) loss_u loss_u 0.8398 (0.8831) acc_u 18.7500 (13.7500) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 906
confident_label rate tensor(0.3527, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 570
clean true:285
clean false:285
clean_rate:0.5
noisy true:425
noisy false:621
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1046
epoch [186/200] batch [5/17] time 0.197 (0.188) data 0.118 (0.110) loss_x loss_x 0.5210 (0.7439) acc_x 90.6250 (84.3750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/17] time 0.184 (0.185) data 0.105 (0.107) loss_x loss_x 0.5664 (0.6308) acc_x 90.6250 (85.3125) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/17] time 0.174 (0.184) data 0.096 (0.106) loss_x loss_x 0.3772 (0.6219) acc_x 93.7500 (85.4167) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/32] time 0.163 (0.182) data 0.086 (0.104) loss_u loss_u 0.8613 (0.8781) acc_u 15.6250 (13.7500) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/32] time 0.184 (0.182) data 0.106 (0.104) loss_u loss_u 0.8984 (0.8797) acc_u 15.6250 (14.0625) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/32] time 0.186 (0.182) data 0.107 (0.104) loss_u loss_u 0.9473 (0.8903) acc_u 6.2500 (12.2917) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/32] time 0.181 (0.182) data 0.103 (0.104) loss_u loss_u 0.8525 (0.8970) acc_u 15.6250 (11.5625) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/32] time 0.181 (0.182) data 0.103 (0.104) loss_u loss_u 0.8257 (0.8908) acc_u 18.7500 (12.3750) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [30/32] time 0.179 (0.182) data 0.101 (0.104) loss_u loss_u 0.8828 (0.8923) acc_u 15.6250 (11.9792) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 876
confident_label rate tensor(0.3416, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 552
clean true:274
clean false:278
clean_rate:0.4963768115942029
noisy true:466
noisy false:598
after delete: len(clean_dataset) 552
after delete: len(noisy_dataset) 1064
epoch [187/200] batch [5/17] time 0.200 (0.182) data 0.123 (0.105) loss_x loss_x 0.7954 (0.5356) acc_x 78.1250 (86.8750) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/17] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.6118 (0.6050) acc_x 81.2500 (84.3750) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/17] time 0.175 (0.179) data 0.098 (0.101) loss_x loss_x 0.4587 (0.6219) acc_x 84.3750 (83.3333) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/33] time 0.191 (0.180) data 0.113 (0.102) loss_u loss_u 0.8823 (0.8697) acc_u 12.5000 (15.6250) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [10/33] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.8228 (0.8708) acc_u 21.8750 (15.9375) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/33] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.9126 (0.8741) acc_u 9.3750 (15.2083) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/33] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.8364 (0.8741) acc_u 18.7500 (15.0000) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/33] time 0.182 (0.182) data 0.104 (0.104) loss_u loss_u 0.9272 (0.8812) acc_u 9.3750 (14.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [30/33] time 0.183 (0.182) data 0.106 (0.104) loss_u loss_u 0.8960 (0.8833) acc_u 12.5000 (13.6458) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 902
confident_label rate tensor(0.3465, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 560
clean true:279
clean false:281
clean_rate:0.4982142857142857
noisy true:435
noisy false:621
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1056
epoch [188/200] batch [5/17] time 0.189 (0.185) data 0.111 (0.108) loss_x loss_x 0.5083 (0.5996) acc_x 84.3750 (84.3750) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/17] time 0.187 (0.186) data 0.109 (0.108) loss_x loss_x 0.4297 (0.5380) acc_x 87.5000 (85.6250) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/17] time 0.171 (0.181) data 0.094 (0.104) loss_x loss_x 0.4873 (0.5150) acc_x 87.5000 (86.6667) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/33] time 0.181 (0.180) data 0.102 (0.103) loss_u loss_u 0.9092 (0.9533) acc_u 9.3750 (4.3750) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/33] time 0.168 (0.178) data 0.090 (0.100) loss_u loss_u 0.9390 (0.9307) acc_u 9.3750 (7.5000) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/33] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.8677 (0.9176) acc_u 15.6250 (9.3750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/33] time 0.176 (0.177) data 0.099 (0.099) loss_u loss_u 0.8779 (0.9134) acc_u 12.5000 (9.8438) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/33] time 0.175 (0.177) data 0.097 (0.099) loss_u loss_u 0.8047 (0.9141) acc_u 25.0000 (10.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [30/33] time 0.175 (0.177) data 0.096 (0.099) loss_u loss_u 0.8286 (0.9002) acc_u 18.7500 (11.8750) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 855
confident_label rate tensor(0.3608, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 583
clean true:295
clean false:288
clean_rate:0.5060034305317325
noisy true:466
noisy false:567
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1033
epoch [189/200] batch [5/18] time 0.173 (0.169) data 0.096 (0.092) loss_x loss_x 0.3215 (0.4989) acc_x 90.6250 (88.1250) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/18] time 0.170 (0.169) data 0.091 (0.092) loss_x loss_x 0.5977 (0.5866) acc_x 78.1250 (85.0000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/18] time 0.169 (0.169) data 0.092 (0.091) loss_x loss_x 0.7109 (0.6183) acc_x 87.5000 (85.0000) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/32] time 0.190 (0.171) data 0.112 (0.093) loss_u loss_u 0.8315 (0.9228) acc_u 21.8750 (8.7500) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/32] time 0.185 (0.172) data 0.109 (0.094) loss_u loss_u 0.9136 (0.9071) acc_u 9.3750 (10.3125) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/32] time 0.179 (0.172) data 0.102 (0.094) loss_u loss_u 0.9946 (0.9095) acc_u 0.0000 (9.7917) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/32] time 0.175 (0.173) data 0.098 (0.095) loss_u loss_u 0.8999 (0.9113) acc_u 12.5000 (9.6875) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/32] time 0.172 (0.174) data 0.095 (0.096) loss_u loss_u 0.8916 (0.9055) acc_u 12.5000 (10.3750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [30/32] time 0.162 (0.173) data 0.084 (0.096) loss_u loss_u 0.9282 (0.9083) acc_u 9.3750 (10.1042) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 897
confident_label rate tensor(0.3490, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 564
clean true:286
clean false:278
clean_rate:0.5070921985815603
noisy true:433
noisy false:619
after delete: len(clean_dataset) 564
after delete: len(noisy_dataset) 1052
epoch [190/200] batch [5/17] time 0.161 (0.183) data 0.084 (0.107) loss_x loss_x 0.4583 (0.7489) acc_x 87.5000 (81.2500) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/17] time 0.184 (0.181) data 0.108 (0.104) loss_x loss_x 0.5869 (0.6375) acc_x 90.6250 (84.0625) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/17] time 0.190 (0.183) data 0.113 (0.106) loss_x loss_x 0.2659 (0.5708) acc_x 93.7500 (85.8333) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/32] time 0.187 (0.184) data 0.109 (0.107) loss_u loss_u 0.8853 (0.8971) acc_u 12.5000 (13.1250) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/32] time 0.191 (0.185) data 0.113 (0.108) loss_u loss_u 0.9678 (0.9160) acc_u 3.1250 (10.6250) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/32] time 0.169 (0.187) data 0.091 (0.109) loss_u loss_u 0.9663 (0.9206) acc_u 3.1250 (9.7917) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/32] time 0.187 (0.186) data 0.109 (0.109) loss_u loss_u 0.9170 (0.9154) acc_u 9.3750 (10.1562) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/32] time 0.213 (0.187) data 0.135 (0.109) loss_u loss_u 0.8286 (0.9085) acc_u 18.7500 (10.6250) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [30/32] time 0.170 (0.186) data 0.092 (0.108) loss_u loss_u 0.8799 (0.9062) acc_u 12.5000 (11.0417) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 880
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:275
clean false:272
clean_rate:0.5027422303473492
noisy true:461
noisy false:608
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [191/200] batch [5/17] time 0.173 (0.170) data 0.096 (0.093) loss_x loss_x 0.4578 (0.5609) acc_x 90.6250 (86.2500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/17] time 0.190 (0.176) data 0.114 (0.098) loss_x loss_x 0.6992 (0.6101) acc_x 84.3750 (84.0625) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/17] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.8174 (0.5968) acc_x 84.3750 (84.5833) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/33] time 0.169 (0.174) data 0.092 (0.097) loss_u loss_u 0.8706 (0.8806) acc_u 15.6250 (15.0000) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/33] time 0.185 (0.176) data 0.107 (0.099) loss_u loss_u 0.9224 (0.8773) acc_u 9.3750 (15.6250) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/33] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.8530 (0.8822) acc_u 15.6250 (14.3750) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/33] time 0.186 (0.179) data 0.109 (0.101) loss_u loss_u 0.9155 (0.8840) acc_u 12.5000 (13.9062) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/33] time 0.182 (0.179) data 0.106 (0.102) loss_u loss_u 0.8389 (0.8884) acc_u 18.7500 (13.5000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [30/33] time 0.171 (0.179) data 0.092 (0.101) loss_u loss_u 0.8799 (0.8877) acc_u 12.5000 (13.5417) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 882
confident_label rate tensor(0.3366, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 544
clean true:275
clean false:269
clean_rate:0.5055147058823529
noisy true:459
noisy false:613
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 1072
epoch [192/200] batch [5/17] time 0.164 (0.174) data 0.086 (0.097) loss_x loss_x 0.6152 (0.6307) acc_x 78.1250 (79.3750) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/17] time 0.203 (0.175) data 0.127 (0.098) loss_x loss_x 0.5312 (0.5264) acc_x 87.5000 (84.0625) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/17] time 0.167 (0.174) data 0.088 (0.097) loss_x loss_x 0.3811 (0.5062) acc_x 87.5000 (85.2083) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/33] time 0.177 (0.172) data 0.099 (0.095) loss_u loss_u 0.9282 (0.8984) acc_u 9.3750 (13.1250) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/33] time 0.216 (0.176) data 0.138 (0.098) loss_u loss_u 0.8921 (0.8992) acc_u 12.5000 (12.5000) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/33] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.8945 (0.8961) acc_u 12.5000 (12.9167) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/33] time 0.169 (0.178) data 0.092 (0.101) loss_u loss_u 0.8105 (0.8931) acc_u 21.8750 (12.8125) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/33] time 0.158 (0.177) data 0.081 (0.100) loss_u loss_u 0.8296 (0.8929) acc_u 18.7500 (12.8750) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [30/33] time 0.165 (0.176) data 0.088 (0.099) loss_u loss_u 0.8765 (0.8934) acc_u 15.6250 (12.7083) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 867
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:288
clean false:283
clean_rate:0.5043782837127846
noisy true:461
noisy false:584
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [193/200] batch [5/17] time 0.173 (0.169) data 0.096 (0.091) loss_x loss_x 0.5044 (0.5954) acc_x 87.5000 (85.6250) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/17] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.2876 (0.5514) acc_x 93.7500 (86.5625) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/17] time 0.177 (0.175) data 0.100 (0.098) loss_x loss_x 0.5537 (0.5736) acc_x 90.6250 (86.8750) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/32] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.9800 (0.9094) acc_u 3.1250 (9.3750) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/32] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8901 (0.9021) acc_u 12.5000 (10.9375) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/32] time 0.206 (0.179) data 0.129 (0.102) loss_u loss_u 0.9678 (0.9118) acc_u 3.1250 (9.3750) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/32] time 0.230 (0.180) data 0.153 (0.103) loss_u loss_u 0.8379 (0.9123) acc_u 21.8750 (9.8438) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/32] time 0.179 (0.180) data 0.100 (0.102) loss_u loss_u 0.9175 (0.9088) acc_u 12.5000 (10.3750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [30/32] time 0.189 (0.180) data 0.112 (0.103) loss_u loss_u 0.8960 (0.9037) acc_u 12.5000 (10.9375) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 863
confident_label rate tensor(0.3478, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 562
clean true:281
clean false:281
clean_rate:0.5
noisy true:472
noisy false:582
after delete: len(clean_dataset) 562
after delete: len(noisy_dataset) 1054
epoch [194/200] batch [5/17] time 0.185 (0.188) data 0.107 (0.111) loss_x loss_x 0.4500 (0.5086) acc_x 90.6250 (86.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/17] time 0.173 (0.179) data 0.096 (0.102) loss_x loss_x 1.2061 (0.5842) acc_x 78.1250 (84.3750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/17] time 0.159 (0.174) data 0.082 (0.097) loss_x loss_x 0.3752 (0.6447) acc_x 90.6250 (83.7500) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/32] time 0.167 (0.175) data 0.090 (0.098) loss_u loss_u 0.9697 (0.8924) acc_u 3.1250 (11.8750) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/32] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9082 (0.8929) acc_u 9.3750 (12.1875) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/32] time 0.169 (0.174) data 0.091 (0.097) loss_u loss_u 0.9219 (0.9008) acc_u 12.5000 (11.4583) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/32] time 0.180 (0.175) data 0.102 (0.098) loss_u loss_u 0.9102 (0.8991) acc_u 9.3750 (11.5625) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/32] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.9214 (0.9018) acc_u 9.3750 (11.5000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [30/32] time 0.173 (0.175) data 0.096 (0.098) loss_u loss_u 0.8711 (0.9019) acc_u 18.7500 (11.7708) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 889
confident_label rate tensor(0.3403, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 550
clean true:275
clean false:275
clean_rate:0.5
noisy true:452
noisy false:614
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1066
epoch [195/200] batch [5/17] time 0.175 (0.177) data 0.098 (0.099) loss_x loss_x 0.6489 (0.3849) acc_x 81.2500 (88.1250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/17] time 0.194 (0.175) data 0.117 (0.098) loss_x loss_x 0.1882 (0.4641) acc_x 93.7500 (87.8125) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/17] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.3186 (0.4890) acc_x 90.6250 (87.5000) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/33] time 0.174 (0.181) data 0.097 (0.103) loss_u loss_u 0.8120 (0.8670) acc_u 21.8750 (15.0000) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/33] time 0.183 (0.181) data 0.106 (0.103) loss_u loss_u 0.9336 (0.8739) acc_u 9.3750 (14.0625) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/33] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8892 (0.8800) acc_u 12.5000 (13.5417) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/33] time 0.182 (0.182) data 0.104 (0.104) loss_u loss_u 0.7769 (0.8849) acc_u 21.8750 (13.1250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/33] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9429 (0.8875) acc_u 6.2500 (12.6250) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [30/33] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.9219 (0.8894) acc_u 12.5000 (12.6042) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 874
confident_label rate tensor(0.3459, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 559
clean true:285
clean false:274
clean_rate:0.5098389982110912
noisy true:457
noisy false:600
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1057
epoch [196/200] batch [5/17] time 0.178 (0.175) data 0.101 (0.098) loss_x loss_x 0.5610 (0.4363) acc_x 87.5000 (89.3750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/17] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 0.6909 (0.5724) acc_x 78.1250 (84.0625) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/17] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.2615 (0.5165) acc_x 93.7500 (85.2083) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/33] time 0.180 (0.176) data 0.101 (0.099) loss_u loss_u 0.8628 (0.8996) acc_u 15.6250 (11.2500) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/33] time 0.184 (0.178) data 0.107 (0.100) loss_u loss_u 0.8325 (0.8973) acc_u 21.8750 (11.5625) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/33] time 0.187 (0.178) data 0.108 (0.100) loss_u loss_u 0.8003 (0.8797) acc_u 25.0000 (13.5417) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/33] time 0.184 (0.178) data 0.104 (0.101) loss_u loss_u 0.9653 (0.8897) acc_u 3.1250 (12.5000) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/33] time 0.183 (0.179) data 0.105 (0.101) loss_u loss_u 0.8608 (0.8841) acc_u 15.6250 (13.0000) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/33] time 0.183 (0.179) data 0.103 (0.102) loss_u loss_u 0.9663 (0.8888) acc_u 3.1250 (12.8125) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 875
confident_label rate tensor(0.3502, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 566
clean true:285
clean false:281
clean_rate:0.5035335689045937
noisy true:456
noisy false:594
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1050
epoch [197/200] batch [5/17] time 0.180 (0.178) data 0.103 (0.101) loss_x loss_x 0.3909 (0.3530) acc_x 90.6250 (91.2500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/17] time 0.180 (0.176) data 0.102 (0.098) loss_x loss_x 1.1807 (0.5320) acc_x 71.8750 (87.5000) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/17] time 0.176 (0.178) data 0.098 (0.101) loss_x loss_x 0.5566 (0.5775) acc_x 90.6250 (85.2083) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/32] time 0.178 (0.179) data 0.099 (0.101) loss_u loss_u 0.9282 (0.8954) acc_u 6.2500 (11.8750) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/32] time 0.177 (0.178) data 0.099 (0.100) loss_u loss_u 0.9263 (0.8997) acc_u 6.2500 (11.8750) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/32] time 0.178 (0.178) data 0.100 (0.100) loss_u loss_u 0.9424 (0.9109) acc_u 6.2500 (10.4167) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/32] time 0.172 (0.179) data 0.093 (0.101) loss_u loss_u 0.8579 (0.8990) acc_u 15.6250 (11.7188) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/32] time 0.167 (0.177) data 0.089 (0.099) loss_u loss_u 0.9209 (0.9057) acc_u 9.3750 (11.1250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [30/32] time 0.179 (0.177) data 0.095 (0.098) loss_u loss_u 0.8608 (0.9042) acc_u 15.6250 (11.2500) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 898
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 533
clean true:259
clean false:274
clean_rate:0.48592870544090055
noisy true:459
noisy false:624
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1083
epoch [198/200] batch [5/16] time 0.167 (0.180) data 0.090 (0.102) loss_x loss_x 0.7676 (0.6919) acc_x 81.2500 (82.5000) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/16] time 0.179 (0.177) data 0.101 (0.099) loss_x loss_x 0.5781 (0.6198) acc_x 87.5000 (84.3750) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/16] time 0.184 (0.179) data 0.107 (0.101) loss_x loss_x 0.6831 (0.5915) acc_x 84.3750 (84.5833) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/33] time 0.186 (0.181) data 0.109 (0.103) loss_u loss_u 0.9658 (0.8753) acc_u 3.1250 (14.3750) lr 1.9733e-06 eta 0:00:05
epoch [198/200] batch [10/33] time 0.178 (0.182) data 0.099 (0.105) loss_u loss_u 0.9160 (0.8885) acc_u 6.2500 (12.5000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/33] time 0.171 (0.181) data 0.093 (0.103) loss_u loss_u 0.9106 (0.8839) acc_u 9.3750 (13.7500) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/33] time 0.193 (0.181) data 0.116 (0.103) loss_u loss_u 0.8813 (0.8883) acc_u 12.5000 (13.2812) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/33] time 0.165 (0.180) data 0.087 (0.102) loss_u loss_u 0.8833 (0.8914) acc_u 12.5000 (12.7500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/33] time 0.166 (0.178) data 0.088 (0.100) loss_u loss_u 0.8809 (0.8868) acc_u 12.5000 (13.0208) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 901
confident_label rate tensor(0.3447, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 557
clean true:273
clean false:284
clean_rate:0.49012567324955114
noisy true:442
noisy false:617
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1059
epoch [199/200] batch [5/17] time 0.165 (0.187) data 0.088 (0.110) loss_x loss_x 0.7510 (0.5334) acc_x 78.1250 (86.2500) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/17] time 0.183 (0.182) data 0.106 (0.104) loss_x loss_x 0.8042 (0.5652) acc_x 81.2500 (85.9375) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/17] time 0.166 (0.179) data 0.089 (0.102) loss_x loss_x 0.7656 (0.5866) acc_x 75.0000 (85.0000) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/33] time 0.169 (0.178) data 0.092 (0.100) loss_u loss_u 0.8716 (0.9137) acc_u 15.6250 (10.0000) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/33] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.9409 (0.9243) acc_u 6.2500 (8.1250) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/33] time 0.169 (0.176) data 0.091 (0.099) loss_u loss_u 0.7681 (0.9016) acc_u 25.0000 (11.2500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [20/33] time 0.166 (0.176) data 0.088 (0.099) loss_u loss_u 0.9912 (0.9075) acc_u 0.0000 (10.6250) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/33] time 0.169 (0.175) data 0.091 (0.097) loss_u loss_u 0.9053 (0.9068) acc_u 12.5000 (10.8750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [30/33] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.8726 (0.9019) acc_u 15.6250 (11.4583) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 909
confident_label rate tensor(0.3403, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 550
clean true:266
clean false:284
clean_rate:0.48363636363636364
noisy true:441
noisy false:625
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1066
epoch [200/200] batch [5/17] time 0.168 (0.175) data 0.090 (0.098) loss_x loss_x 0.2002 (0.4134) acc_x 100.0000 (89.3750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/17] time 0.192 (0.181) data 0.114 (0.103) loss_x loss_x 0.4312 (0.4771) acc_x 90.6250 (87.5000) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/17] time 0.189 (0.183) data 0.111 (0.106) loss_x loss_x 0.4431 (0.4666) acc_x 87.5000 (87.9167) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/33] time 0.190 (0.185) data 0.112 (0.108) loss_u loss_u 0.7705 (0.9017) acc_u 25.0000 (11.2500) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [10/33] time 0.183 (0.185) data 0.105 (0.107) loss_u loss_u 0.8271 (0.8875) acc_u 21.8750 (12.8125) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/33] time 0.184 (0.184) data 0.105 (0.107) loss_u loss_u 0.9648 (0.8902) acc_u 3.1250 (11.6667) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/33] time 0.180 (0.184) data 0.102 (0.106) loss_u loss_u 0.9331 (0.8857) acc_u 6.2500 (12.1875) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/33] time 0.183 (0.184) data 0.105 (0.106) loss_u loss_u 0.9082 (0.8848) acc_u 12.5000 (12.6250) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [30/33] time 0.159 (0.183) data 0.082 (0.105) loss_u loss_u 0.7769 (0.8856) acc_u 25.0000 (12.6042) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.75/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 1,722
* accuracy: 45.5%
* error: 54.5%
* macro_f1: 42.6%
Elapsed: 0:58:24
