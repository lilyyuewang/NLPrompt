***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.125', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.125
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.2754, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 445
clean true:439
clean false:6
clean_rate:0.9865168539325843
noisy true:73
noisy false:1098
after delete: len(clean_dataset) 445
after delete: len(noisy_dataset) 1171
epoch [1/200] batch [5/13] time 0.183 (0.214) data 0.106 (0.118) loss_x loss_x 2.1621 (2.4680) acc_x 53.1250 (53.1250) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/13] time 0.181 (0.198) data 0.104 (0.112) loss_x loss_x 2.5137 (2.4967) acc_x 50.0000 (51.8750) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/36] time 0.183 (0.195) data 0.104 (0.111) loss_u loss_u 0.9399 (0.9319) acc_u 9.3750 (15.6250) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [10/36] time 0.176 (0.192) data 0.099 (0.110) loss_u loss_u 0.8774 (0.9202) acc_u 21.8750 (16.5625) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [15/36] time 0.194 (0.192) data 0.116 (0.110) loss_u loss_u 0.8833 (0.9160) acc_u 21.8750 (16.8750) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [20/36] time 0.200 (0.192) data 0.121 (0.111) loss_u loss_u 0.9199 (0.9152) acc_u 15.6250 (17.1875) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [25/36] time 0.195 (0.192) data 0.118 (0.112) loss_u loss_u 0.8716 (0.9140) acc_u 28.1250 (17.2500) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [30/36] time 0.179 (0.192) data 0.101 (0.112) loss_u loss_u 0.9077 (0.9115) acc_u 12.5000 (17.1875) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [35/36] time 0.198 (0.191) data 0.120 (0.111) loss_u loss_u 0.8950 (0.9106) acc_u 25.0000 (18.0357) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 983
confident_label rate tensor(0.3410, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 551
clean true:542
clean false:9
clean_rate:0.9836660617059891
noisy true:91
noisy false:974
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1065
epoch [2/200] batch [5/17] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 1.2686 (1.3518) acc_x 71.8750 (68.1250) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [10/17] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 1.4414 (1.3693) acc_x 59.3750 (67.1875) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [15/17] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 1.0527 (1.2779) acc_x 78.1250 (69.5833) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/33] time 0.189 (0.175) data 0.111 (0.098) loss_u loss_u 0.8896 (0.8074) acc_u 15.6250 (26.8750) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [10/33] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.7939 (0.7868) acc_u 31.2500 (28.7500) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [15/33] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.8218 (0.7894) acc_u 25.0000 (28.5417) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [20/33] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8193 (0.7880) acc_u 18.7500 (28.4375) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [25/33] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.7036 (0.7920) acc_u 34.3750 (27.2500) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [30/33] time 0.189 (0.179) data 0.111 (0.102) loss_u loss_u 0.7329 (0.7931) acc_u 40.6250 (27.5000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 818
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 695
clean true:691
clean false:4
clean_rate:0.9942446043165467
noisy true:107
noisy false:814
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 921
epoch [3/200] batch [5/21] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.8350 (1.1529) acc_x 81.2500 (71.2500) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/21] time 0.164 (0.177) data 0.087 (0.099) loss_x loss_x 1.2764 (1.1689) acc_x 65.6250 (70.3125) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/21] time 0.163 (0.173) data 0.087 (0.096) loss_x loss_x 1.0166 (1.1018) acc_x 71.8750 (71.6667) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [20/21] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 1.2822 (1.1307) acc_x 71.8750 (71.4062) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/28] time 0.175 (0.173) data 0.099 (0.096) loss_u loss_u 0.7935 (0.8111) acc_u 21.8750 (25.0000) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [10/28] time 0.175 (0.173) data 0.097 (0.096) loss_u loss_u 0.8604 (0.8232) acc_u 15.6250 (21.8750) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/28] time 0.192 (0.174) data 0.115 (0.097) loss_u loss_u 0.8550 (0.8202) acc_u 18.7500 (21.8750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/28] time 0.186 (0.175) data 0.109 (0.098) loss_u loss_u 0.8296 (0.8200) acc_u 15.6250 (22.0312) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [25/28] time 0.185 (0.176) data 0.107 (0.099) loss_u loss_u 0.8853 (0.8185) acc_u 12.5000 (22.7500) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 722
confident_label rate tensor(0.4821, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 779
clean true:778
clean false:1
clean_rate:0.9987163029525032
noisy true:116
noisy false:721
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 837
epoch [4/200] batch [5/24] time 0.188 (0.194) data 0.111 (0.117) loss_x loss_x 0.9043 (0.9905) acc_x 75.0000 (75.0000) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/24] time 0.187 (0.192) data 0.109 (0.115) loss_x loss_x 1.0127 (0.9641) acc_x 71.8750 (76.2500) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/24] time 0.185 (0.190) data 0.107 (0.113) loss_x loss_x 1.0146 (0.9786) acc_x 68.7500 (75.4167) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [20/24] time 0.175 (0.186) data 0.098 (0.109) loss_x loss_x 1.4795 (1.0312) acc_x 71.8750 (74.6875) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/26] time 0.190 (0.185) data 0.112 (0.108) loss_u loss_u 0.7866 (0.7916) acc_u 21.8750 (25.6250) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [10/26] time 0.198 (0.186) data 0.121 (0.109) loss_u loss_u 0.8701 (0.8084) acc_u 15.6250 (23.4375) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [15/26] time 0.183 (0.185) data 0.105 (0.108) loss_u loss_u 0.7891 (0.8087) acc_u 28.1250 (23.5417) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/26] time 0.192 (0.184) data 0.115 (0.106) loss_u loss_u 0.8174 (0.8147) acc_u 18.7500 (22.3438) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [25/26] time 0.186 (0.185) data 0.109 (0.107) loss_u loss_u 0.7495 (0.8115) acc_u 34.3750 (22.8750) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 742
confident_label rate tensor(0.4604, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 744
clean true:740
clean false:4
clean_rate:0.9946236559139785
noisy true:134
noisy false:738
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 872
epoch [5/200] batch [5/23] time 0.185 (0.189) data 0.108 (0.113) loss_x loss_x 1.1787 (0.8874) acc_x 65.6250 (75.6250) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [10/23] time 0.186 (0.189) data 0.108 (0.112) loss_x loss_x 1.3027 (0.9686) acc_x 75.0000 (75.3125) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [15/23] time 0.187 (0.191) data 0.110 (0.114) loss_x loss_x 0.5752 (0.9253) acc_x 90.6250 (76.8750) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [20/23] time 0.185 (0.190) data 0.109 (0.112) loss_x loss_x 0.6523 (0.9129) acc_x 78.1250 (77.0312) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/27] time 0.208 (0.189) data 0.130 (0.112) loss_u loss_u 0.7998 (0.7728) acc_u 18.7500 (26.8750) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/27] time 0.181 (0.188) data 0.105 (0.111) loss_u loss_u 0.7998 (0.7788) acc_u 18.7500 (25.6250) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/27] time 0.178 (0.188) data 0.100 (0.110) loss_u loss_u 0.7412 (0.7839) acc_u 31.2500 (25.0000) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/27] time 0.187 (0.185) data 0.109 (0.108) loss_u loss_u 0.8477 (0.7993) acc_u 15.6250 (23.2812) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [25/27] time 0.177 (0.184) data 0.099 (0.106) loss_u loss_u 0.7402 (0.8012) acc_u 31.2500 (22.8750) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 731
confident_label rate tensor(0.4728, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 764
clean true:759
clean false:5
clean_rate:0.993455497382199
noisy true:126
noisy false:726
after delete: len(clean_dataset) 764
after delete: len(noisy_dataset) 852
epoch [6/200] batch [5/23] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6191 (0.9045) acc_x 90.6250 (76.8750) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/23] time 0.192 (0.186) data 0.115 (0.110) loss_x loss_x 1.0273 (0.9131) acc_x 71.8750 (77.1875) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/23] time 0.167 (0.186) data 0.090 (0.109) loss_x loss_x 0.8179 (0.8822) acc_x 84.3750 (77.0833) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/23] time 0.164 (0.180) data 0.086 (0.103) loss_x loss_x 0.7144 (0.8892) acc_x 87.5000 (76.8750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/26] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.7598 (0.7982) acc_u 21.8750 (23.7500) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [10/26] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.6914 (0.7860) acc_u 34.3750 (26.2500) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [15/26] time 0.175 (0.180) data 0.096 (0.103) loss_u loss_u 0.7759 (0.7835) acc_u 28.1250 (26.0417) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [20/26] time 0.163 (0.178) data 0.085 (0.101) loss_u loss_u 0.7554 (0.7888) acc_u 25.0000 (25.3125) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/26] time 0.185 (0.179) data 0.108 (0.101) loss_u loss_u 0.8687 (0.7884) acc_u 12.5000 (25.1250) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 719
confident_label rate tensor(0.4777, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 772
clean true:770
clean false:2
clean_rate:0.9974093264248705
noisy true:127
noisy false:717
after delete: len(clean_dataset) 772
after delete: len(noisy_dataset) 844
epoch [7/200] batch [5/24] time 0.186 (0.185) data 0.108 (0.107) loss_x loss_x 1.0479 (0.7277) acc_x 71.8750 (80.6250) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/24] time 0.160 (0.182) data 0.083 (0.105) loss_x loss_x 0.5596 (0.7672) acc_x 84.3750 (80.9375) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/24] time 0.187 (0.178) data 0.109 (0.101) loss_x loss_x 0.7104 (0.8320) acc_x 78.1250 (78.3333) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/24] time 0.180 (0.180) data 0.104 (0.103) loss_x loss_x 1.5039 (0.8766) acc_x 53.1250 (77.3438) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/26] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8027 (0.7691) acc_u 28.1250 (24.3750) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [10/26] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.7085 (0.7936) acc_u 28.1250 (21.5625) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/26] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.6904 (0.7841) acc_u 37.5000 (23.7500) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [20/26] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8491 (0.7901) acc_u 21.8750 (23.2812) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [25/26] time 0.184 (0.184) data 0.108 (0.107) loss_u loss_u 0.7559 (0.7924) acc_u 34.3750 (23.5000) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 703
confident_label rate tensor(0.4895, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 791
clean true:790
clean false:1
clean_rate:0.9987357774968394
noisy true:123
noisy false:702
after delete: len(clean_dataset) 791
after delete: len(noisy_dataset) 825
epoch [8/200] batch [5/24] time 0.184 (0.176) data 0.108 (0.099) loss_x loss_x 1.5879 (1.2119) acc_x 65.6250 (67.5000) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/24] time 0.172 (0.175) data 0.094 (0.099) loss_x loss_x 0.8320 (1.1210) acc_x 75.0000 (69.6875) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/24] time 0.197 (0.177) data 0.119 (0.100) loss_x loss_x 1.2441 (1.1062) acc_x 78.1250 (70.6250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/24] time 0.182 (0.174) data 0.105 (0.097) loss_x loss_x 0.7612 (1.0775) acc_x 81.2500 (71.2500) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/25] time 0.189 (0.176) data 0.110 (0.099) loss_u loss_u 0.8101 (0.8111) acc_u 21.8750 (23.7500) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/25] time 0.196 (0.178) data 0.119 (0.101) loss_u loss_u 0.8730 (0.7861) acc_u 18.7500 (25.6250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/25] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8384 (0.8002) acc_u 21.8750 (23.1250) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/25] time 0.190 (0.180) data 0.112 (0.103) loss_u loss_u 0.7983 (0.7931) acc_u 28.1250 (24.5312) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [25/25] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.7300 (0.7895) acc_u 28.1250 (25.0000) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 817
clean true:815
clean false:2
clean_rate:0.9975520195838433
noisy true:127
noisy false:672
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 799
epoch [9/200] batch [5/25] time 0.182 (0.186) data 0.106 (0.109) loss_x loss_x 0.8779 (0.8750) acc_x 78.1250 (77.5000) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/25] time 0.186 (0.183) data 0.110 (0.106) loss_x loss_x 0.3840 (0.9849) acc_x 93.7500 (74.6875) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/25] time 0.183 (0.183) data 0.105 (0.106) loss_x loss_x 1.5703 (0.9779) acc_x 65.6250 (75.6250) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/25] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.6636 (1.0077) acc_x 81.2500 (74.6875) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [25/25] time 0.186 (0.183) data 0.108 (0.106) loss_x loss_x 0.8569 (1.0050) acc_x 75.0000 (73.8750) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/24] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.7632 (0.7884) acc_u 25.0000 (25.6250) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [10/24] time 0.173 (0.183) data 0.096 (0.105) loss_u loss_u 0.7886 (0.8010) acc_u 21.8750 (23.1250) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [15/24] time 0.172 (0.181) data 0.094 (0.104) loss_u loss_u 0.6694 (0.7802) acc_u 31.2500 (25.8333) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/24] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.7505 (0.7867) acc_u 31.2500 (24.6875) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 680
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 807
clean true:804
clean false:3
clean_rate:0.9962825278810409
noisy true:132
noisy false:677
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 809
epoch [10/200] batch [5/25] time 0.202 (0.185) data 0.124 (0.107) loss_x loss_x 0.6724 (0.9310) acc_x 71.8750 (74.3750) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/25] time 0.172 (0.186) data 0.094 (0.108) loss_x loss_x 0.7524 (0.9406) acc_x 75.0000 (74.3750) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/25] time 0.188 (0.185) data 0.112 (0.107) loss_x loss_x 0.8110 (0.9132) acc_x 81.2500 (75.6250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/25] time 0.184 (0.184) data 0.108 (0.106) loss_x loss_x 0.5352 (0.8763) acc_x 84.3750 (76.2500) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [25/25] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.6841 (0.8580) acc_x 75.0000 (76.6250) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/25] time 0.187 (0.185) data 0.110 (0.107) loss_u loss_u 0.8169 (0.7956) acc_u 21.8750 (26.8750) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/25] time 0.194 (0.185) data 0.117 (0.108) loss_u loss_u 0.8398 (0.8003) acc_u 12.5000 (24.6875) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/25] time 0.184 (0.186) data 0.107 (0.108) loss_u loss_u 0.7588 (0.7942) acc_u 28.1250 (24.3750) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/25] time 0.186 (0.186) data 0.109 (0.108) loss_u loss_u 0.7295 (0.7954) acc_u 31.2500 (24.3750) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [25/25] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.7979 (0.7984) acc_u 21.8750 (24.1250) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 663
confident_label rate tensor(0.5068, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 819
clean true:818
clean false:1
clean_rate:0.9987789987789988
noisy true:135
noisy false:662
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 797
epoch [11/200] batch [5/25] time 0.207 (0.190) data 0.130 (0.113) loss_x loss_x 0.8745 (0.8870) acc_x 75.0000 (76.8750) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/25] time 0.174 (0.186) data 0.097 (0.109) loss_x loss_x 0.5552 (0.8843) acc_x 84.3750 (76.2500) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/25] time 0.184 (0.182) data 0.107 (0.104) loss_x loss_x 1.4482 (0.8955) acc_x 59.3750 (76.0417) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/25] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.8159 (0.9261) acc_x 75.0000 (75.1562) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [25/25] time 0.188 (0.178) data 0.112 (0.101) loss_x loss_x 0.9570 (0.9420) acc_x 78.1250 (75.0000) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/24] time 0.191 (0.180) data 0.113 (0.103) loss_u loss_u 0.8101 (0.7729) acc_u 18.7500 (23.7500) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/24] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.7480 (0.7957) acc_u 34.3750 (23.4375) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/24] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8047 (0.7828) acc_u 21.8750 (25.4167) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/24] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8145 (0.7842) acc_u 21.8750 (24.8438) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 811
clean true:810
clean false:1
clean_rate:0.998766954377312
noisy true:132
noisy false:673
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 805
epoch [12/200] batch [5/25] time 0.174 (0.170) data 0.096 (0.092) loss_x loss_x 1.0986 (0.8493) acc_x 68.7500 (75.6250) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/25] time 0.170 (0.173) data 0.091 (0.096) loss_x loss_x 1.2471 (0.9008) acc_x 65.6250 (74.3750) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/25] time 0.159 (0.169) data 0.082 (0.092) loss_x loss_x 1.3633 (0.9526) acc_x 75.0000 (74.5833) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/25] time 0.159 (0.167) data 0.082 (0.090) loss_x loss_x 0.6606 (0.9206) acc_x 81.2500 (74.8438) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [25/25] time 0.184 (0.170) data 0.107 (0.093) loss_x loss_x 0.7236 (0.8778) acc_x 84.3750 (76.7500) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/25] time 0.184 (0.172) data 0.106 (0.095) loss_u loss_u 0.8140 (0.7693) acc_u 21.8750 (29.3750) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [10/25] time 0.184 (0.174) data 0.107 (0.096) loss_u loss_u 0.7510 (0.7776) acc_u 28.1250 (26.5625) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/25] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.6831 (0.7706) acc_u 34.3750 (27.9167) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/25] time 0.182 (0.176) data 0.103 (0.098) loss_u loss_u 0.8130 (0.7736) acc_u 21.8750 (27.6562) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [25/25] time 0.180 (0.177) data 0.103 (0.099) loss_u loss_u 0.7305 (0.7726) acc_u 37.5000 (27.3750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.5068, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 819
clean true:815
clean false:4
clean_rate:0.9951159951159951
noisy true:127
noisy false:670
after delete: len(clean_dataset) 819
after delete: len(noisy_dataset) 797
epoch [13/200] batch [5/25] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.6943 (0.9103) acc_x 81.2500 (75.6250) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/25] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.9292 (0.9378) acc_x 68.7500 (73.7500) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/25] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.9829 (0.9054) acc_x 75.0000 (75.2083) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/25] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 1.0479 (0.9270) acc_x 62.5000 (75.0000) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [25/25] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.7686 (0.9352) acc_x 84.3750 (75.1250) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/24] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8271 (0.7738) acc_u 15.6250 (25.6250) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/24] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.7778 (0.7768) acc_u 21.8750 (25.6250) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/24] time 0.170 (0.182) data 0.093 (0.105) loss_u loss_u 0.7090 (0.7651) acc_u 37.5000 (27.5000) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/24] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.7271 (0.7725) acc_u 28.1250 (26.4062) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.5309, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 858
clean true:857
clean false:1
clean_rate:0.9988344988344988
noisy true:136
noisy false:622
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 758
epoch [14/200] batch [5/26] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 1.2588 (0.8995) acc_x 75.0000 (77.5000) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/26] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 0.5142 (0.9005) acc_x 87.5000 (77.8125) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/26] time 0.162 (0.174) data 0.086 (0.097) loss_x loss_x 0.6768 (0.8797) acc_x 78.1250 (76.8750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/26] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 0.6733 (0.8917) acc_x 87.5000 (77.0312) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [25/26] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.8481 (0.9113) acc_x 71.8750 (76.2500) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/23] time 0.186 (0.176) data 0.107 (0.098) loss_u loss_u 0.8936 (0.7694) acc_u 15.6250 (28.1250) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [10/23] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.7500 (0.7709) acc_u 28.1250 (27.1875) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/23] time 0.186 (0.179) data 0.109 (0.101) loss_u loss_u 0.7686 (0.7729) acc_u 21.8750 (26.6667) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/23] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8281 (0.7782) acc_u 25.0000 (26.4062) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.5309, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 858
clean true:854
clean false:4
clean_rate:0.9953379953379954
noisy true:138
noisy false:620
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 758
epoch [15/200] batch [5/26] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 1.2842 (0.9477) acc_x 68.7500 (73.1250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/26] time 0.180 (0.184) data 0.103 (0.107) loss_x loss_x 0.5298 (0.9509) acc_x 90.6250 (75.0000) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/26] time 0.196 (0.180) data 0.119 (0.103) loss_x loss_x 0.6597 (0.9271) acc_x 75.0000 (75.6250) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/26] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 1.0928 (0.8988) acc_x 68.7500 (75.9375) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [25/26] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.9263 (0.8711) acc_x 81.2500 (76.8750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/23] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.8145 (0.8013) acc_u 21.8750 (25.6250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/23] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8462 (0.7969) acc_u 18.7500 (25.3125) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/23] time 0.167 (0.178) data 0.089 (0.100) loss_u loss_u 0.7783 (0.7987) acc_u 21.8750 (23.9583) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/23] time 0.164 (0.180) data 0.085 (0.102) loss_u loss_u 0.8555 (0.7952) acc_u 18.7500 (24.3750) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.5229, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 845
clean true:845
clean false:0
clean_rate:1.0
noisy true:132
noisy false:639
after delete: len(clean_dataset) 845
after delete: len(noisy_dataset) 771
epoch [16/200] batch [5/26] time 0.158 (0.162) data 0.082 (0.085) loss_x loss_x 0.5015 (0.8323) acc_x 81.2500 (77.5000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/26] time 0.206 (0.167) data 0.128 (0.090) loss_x loss_x 1.3174 (0.8671) acc_x 65.6250 (76.5625) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/26] time 0.187 (0.168) data 0.109 (0.091) loss_x loss_x 0.5659 (0.8935) acc_x 84.3750 (76.6667) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/26] time 0.187 (0.174) data 0.111 (0.097) loss_x loss_x 1.0303 (0.8614) acc_x 75.0000 (77.5000) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [25/26] time 0.159 (0.172) data 0.083 (0.095) loss_x loss_x 0.8784 (0.8773) acc_x 71.8750 (76.3750) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/24] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.7944 (0.7689) acc_u 18.7500 (26.2500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/24] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.8350 (0.7854) acc_u 21.8750 (24.6875) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/24] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.8086 (0.7936) acc_u 21.8750 (24.3750) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/24] time 0.178 (0.176) data 0.100 (0.099) loss_u loss_u 0.7598 (0.7790) acc_u 31.2500 (26.5625) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 607
confident_label rate tensor(0.5421, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 876
clean true:876
clean false:0
clean_rate:1.0
noisy true:133
noisy false:607
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 740
epoch [17/200] batch [5/27] time 0.185 (0.177) data 0.108 (0.099) loss_x loss_x 0.6699 (0.8080) acc_x 81.2500 (78.7500) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/27] time 0.184 (0.181) data 0.105 (0.103) loss_x loss_x 0.9990 (0.9065) acc_x 68.7500 (76.2500) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/27] time 0.173 (0.179) data 0.094 (0.102) loss_x loss_x 0.9790 (0.9078) acc_x 78.1250 (75.8333) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/27] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 0.9722 (0.8792) acc_x 75.0000 (77.0312) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [25/27] time 0.170 (0.175) data 0.092 (0.097) loss_x loss_x 0.5205 (0.8807) acc_x 81.2500 (76.3750) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/23] time 0.176 (0.175) data 0.099 (0.097) loss_u loss_u 0.8267 (0.7750) acc_u 21.8750 (25.6250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/23] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.7510 (0.7486) acc_u 28.1250 (29.6875) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/23] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.7798 (0.7665) acc_u 25.0000 (27.7083) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/23] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.8242 (0.7700) acc_u 21.8750 (27.5000) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.5446, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 880
clean true:877
clean false:3
clean_rate:0.9965909090909091
noisy true:141
noisy false:595
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 736
epoch [18/200] batch [5/27] time 0.172 (0.176) data 0.094 (0.099) loss_x loss_x 0.5093 (0.8822) acc_x 87.5000 (78.7500) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/27] time 0.192 (0.177) data 0.115 (0.100) loss_x loss_x 0.7402 (0.8536) acc_x 84.3750 (77.8125) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/27] time 0.177 (0.176) data 0.100 (0.098) loss_x loss_x 0.3638 (0.8281) acc_x 90.6250 (78.3333) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/27] time 0.161 (0.175) data 0.084 (0.098) loss_x loss_x 0.5615 (0.8157) acc_x 78.1250 (77.8125) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [25/27] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.5625 (0.8158) acc_x 81.2500 (78.1250) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/23] time 0.183 (0.175) data 0.105 (0.097) loss_u loss_u 0.7520 (0.7994) acc_u 34.3750 (25.0000) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/23] time 0.169 (0.176) data 0.090 (0.098) loss_u loss_u 0.8491 (0.7965) acc_u 21.8750 (25.9375) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/23] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.8198 (0.7768) acc_u 21.8750 (27.0833) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/23] time 0.178 (0.176) data 0.101 (0.098) loss_u loss_u 0.7432 (0.7695) acc_u 28.1250 (27.5000) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 579
confident_label rate tensor(0.5538, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 895
clean true:894
clean false:1
clean_rate:0.9988826815642458
noisy true:143
noisy false:578
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 721
epoch [19/200] batch [5/27] time 0.177 (0.185) data 0.099 (0.108) loss_x loss_x 0.7412 (0.6510) acc_x 78.1250 (79.3750) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [10/27] time 0.175 (0.181) data 0.098 (0.104) loss_x loss_x 0.9204 (0.7226) acc_x 81.2500 (79.6875) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/27] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.8335 (0.7697) acc_x 81.2500 (79.3750) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/27] time 0.187 (0.179) data 0.108 (0.102) loss_x loss_x 0.5400 (0.7498) acc_x 84.3750 (79.8438) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/27] time 0.175 (0.180) data 0.098 (0.103) loss_x loss_x 1.0605 (0.8317) acc_x 75.0000 (78.2500) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/22] time 0.161 (0.179) data 0.083 (0.102) loss_u loss_u 0.7808 (0.7768) acc_u 28.1250 (24.3750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/22] time 0.169 (0.177) data 0.091 (0.100) loss_u loss_u 0.6709 (0.7727) acc_u 34.3750 (25.6250) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/22] time 0.188 (0.177) data 0.111 (0.100) loss_u loss_u 0.7656 (0.7716) acc_u 21.8750 (25.6250) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/22] time 0.183 (0.178) data 0.106 (0.100) loss_u loss_u 0.7515 (0.7812) acc_u 21.8750 (23.9062) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 574
confident_label rate tensor(0.5575, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 901
clean true:899
clean false:2
clean_rate:0.9977802441731409
noisy true:143
noisy false:572
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 715
epoch [20/200] batch [5/28] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.4451 (0.7082) acc_x 84.3750 (81.8750) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/28] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 0.7129 (0.7130) acc_x 78.1250 (81.8750) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/28] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.8325 (0.7734) acc_x 65.6250 (78.3333) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/28] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 1.1973 (0.8113) acc_x 71.8750 (77.3438) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [25/28] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.9414 (0.8200) acc_x 62.5000 (77.0000) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/22] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.7051 (0.7719) acc_u 31.2500 (27.5000) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/22] time 0.197 (0.185) data 0.119 (0.108) loss_u loss_u 0.7822 (0.7795) acc_u 31.2500 (27.8125) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/22] time 0.253 (0.186) data 0.176 (0.109) loss_u loss_u 0.8413 (0.7965) acc_u 21.8750 (25.0000) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/22] time 0.185 (0.187) data 0.108 (0.109) loss_u loss_u 0.7729 (0.7781) acc_u 25.0000 (26.7188) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.5538, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 895
clean true:890
clean false:5
clean_rate:0.994413407821229
noisy true:129
noisy false:592
after delete: len(clean_dataset) 895
after delete: len(noisy_dataset) 721
epoch [21/200] batch [5/27] time 0.171 (0.181) data 0.094 (0.104) loss_x loss_x 0.7930 (0.9886) acc_x 78.1250 (73.1250) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/27] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.6948 (0.9218) acc_x 78.1250 (76.5625) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [15/27] time 0.184 (0.182) data 0.106 (0.105) loss_x loss_x 0.7026 (0.9025) acc_x 84.3750 (75.8333) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/27] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4746 (0.8455) acc_x 87.5000 (77.3438) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [25/27] time 0.160 (0.180) data 0.083 (0.103) loss_x loss_x 0.8423 (0.8459) acc_x 78.1250 (77.5000) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/22] time 0.189 (0.179) data 0.110 (0.102) loss_u loss_u 0.6836 (0.7340) acc_u 43.7500 (31.8750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/22] time 0.184 (0.180) data 0.108 (0.103) loss_u loss_u 0.7495 (0.7657) acc_u 31.2500 (27.1875) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/22] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.7739 (0.7627) acc_u 25.0000 (27.9167) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/22] time 0.182 (0.180) data 0.104 (0.103) loss_u loss_u 0.8042 (0.7650) acc_u 21.8750 (28.2812) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 584
confident_label rate tensor(0.5619, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 908
clean true:905
clean false:3
clean_rate:0.9966960352422908
noisy true:127
noisy false:581
after delete: len(clean_dataset) 908
after delete: len(noisy_dataset) 708
epoch [22/200] batch [5/28] time 0.185 (0.185) data 0.107 (0.108) loss_x loss_x 1.0176 (0.9151) acc_x 71.8750 (72.5000) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/28] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.5322 (0.7639) acc_x 87.5000 (79.6875) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/28] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.8296 (0.7996) acc_x 84.3750 (78.7500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/28] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 0.8887 (0.7940) acc_x 81.2500 (79.3750) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [25/28] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 1.5137 (0.8352) acc_x 62.5000 (77.8750) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/22] time 0.163 (0.173) data 0.087 (0.096) loss_u loss_u 0.8521 (0.7724) acc_u 21.8750 (31.2500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/22] time 0.169 (0.173) data 0.090 (0.096) loss_u loss_u 0.8198 (0.7750) acc_u 18.7500 (28.1250) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/22] time 0.181 (0.174) data 0.103 (0.097) loss_u loss_u 0.7251 (0.7638) acc_u 37.5000 (29.5833) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/22] time 0.181 (0.174) data 0.103 (0.097) loss_u loss_u 0.8120 (0.7648) acc_u 15.6250 (28.9062) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 570
confident_label rate tensor(0.5625, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 909
clean true:907
clean false:2
clean_rate:0.9977997799779978
noisy true:139
noisy false:568
after delete: len(clean_dataset) 909
after delete: len(noisy_dataset) 707
epoch [23/200] batch [5/28] time 0.190 (0.191) data 0.110 (0.113) loss_x loss_x 0.4680 (0.6558) acc_x 87.5000 (80.0000) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [10/28] time 0.176 (0.186) data 0.098 (0.108) loss_x loss_x 0.6758 (0.6541) acc_x 78.1250 (81.8750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/28] time 0.168 (0.181) data 0.091 (0.103) loss_x loss_x 0.7749 (0.6839) acc_x 78.1250 (81.8750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/28] time 0.165 (0.178) data 0.088 (0.101) loss_x loss_x 0.6826 (0.7045) acc_x 78.1250 (81.2500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [25/28] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 1.2510 (0.7503) acc_x 65.6250 (80.0000) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/22] time 0.168 (0.177) data 0.090 (0.100) loss_u loss_u 0.6963 (0.7361) acc_u 34.3750 (28.7500) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/22] time 0.177 (0.178) data 0.099 (0.100) loss_u loss_u 0.7598 (0.7410) acc_u 28.1250 (29.6875) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/22] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.7524 (0.7636) acc_u 25.0000 (26.6667) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/22] time 0.167 (0.178) data 0.090 (0.100) loss_u loss_u 0.7754 (0.7571) acc_u 25.0000 (27.9688) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 585
confident_label rate tensor(0.5569, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 900
clean true:897
clean false:3
clean_rate:0.9966666666666667
noisy true:134
noisy false:582
after delete: len(clean_dataset) 900
after delete: len(noisy_dataset) 716
epoch [24/200] batch [5/28] time 0.162 (0.168) data 0.084 (0.091) loss_x loss_x 0.4526 (0.8231) acc_x 87.5000 (80.0000) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/28] time 0.188 (0.169) data 0.110 (0.092) loss_x loss_x 0.3899 (0.7582) acc_x 87.5000 (79.6875) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/28] time 0.187 (0.176) data 0.110 (0.099) loss_x loss_x 0.8882 (0.7845) acc_x 75.0000 (79.7917) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/28] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.9468 (0.7846) acc_x 71.8750 (79.5312) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [25/28] time 0.185 (0.180) data 0.108 (0.102) loss_x loss_x 0.7979 (0.7741) acc_x 78.1250 (80.0000) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/22] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.7598 (0.6927) acc_u 28.1250 (34.3750) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/22] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.8257 (0.7435) acc_u 18.7500 (29.3750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/22] time 0.171 (0.180) data 0.093 (0.102) loss_u loss_u 0.6450 (0.7443) acc_u 34.3750 (28.9583) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [20/22] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.6748 (0.7422) acc_u 40.6250 (30.1562) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.5699, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 921
clean true:919
clean false:2
clean_rate:0.997828447339848
noisy true:134
noisy false:561
after delete: len(clean_dataset) 921
after delete: len(noisy_dataset) 695
epoch [25/200] batch [5/28] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.5464 (0.6510) acc_x 81.2500 (83.7500) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/28] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.9761 (0.8457) acc_x 71.8750 (78.4375) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/28] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.6367 (0.8026) acc_x 81.2500 (79.3750) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/28] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6777 (0.8098) acc_x 81.2500 (78.2812) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [25/28] time 0.186 (0.183) data 0.109 (0.107) loss_x loss_x 1.2666 (0.8157) acc_x 68.7500 (78.2500) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/21] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.7363 (0.7436) acc_u 31.2500 (30.0000) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/21] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8662 (0.7613) acc_u 15.6250 (27.8125) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/21] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.7339 (0.7690) acc_u 34.3750 (26.8750) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/21] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.7642 (0.7672) acc_u 28.1250 (27.5000) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.5705, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 922
clean true:921
clean false:1
clean_rate:0.9989154013015185
noisy true:138
noisy false:556
after delete: len(clean_dataset) 922
after delete: len(noisy_dataset) 694
epoch [26/200] batch [5/28] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6040 (0.7713) acc_x 87.5000 (79.3750) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/28] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5303 (0.7506) acc_x 87.5000 (80.9375) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/28] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.9106 (0.7897) acc_x 75.0000 (79.5833) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/28] time 0.172 (0.181) data 0.094 (0.104) loss_x loss_x 1.1377 (0.8072) acc_x 81.2500 (79.5312) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [25/28] time 0.171 (0.179) data 0.093 (0.102) loss_x loss_x 0.8584 (0.7731) acc_x 78.1250 (80.1250) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/21] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.6987 (0.7439) acc_u 34.3750 (28.7500) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/21] time 0.172 (0.180) data 0.094 (0.102) loss_u loss_u 0.6948 (0.7712) acc_u 37.5000 (25.3125) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/21] time 0.161 (0.177) data 0.084 (0.100) loss_u loss_u 0.6909 (0.7661) acc_u 34.3750 (25.8333) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/21] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.7139 (0.7614) acc_u 28.1250 (26.2500) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 549
confident_label rate tensor(0.5755, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 930
clean true:927
clean false:3
clean_rate:0.9967741935483871
noisy true:140
noisy false:546
after delete: len(clean_dataset) 930
after delete: len(noisy_dataset) 686
epoch [27/200] batch [5/29] time 0.171 (0.178) data 0.094 (0.102) loss_x loss_x 0.8013 (0.8352) acc_x 87.5000 (82.5000) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/29] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 1.2285 (0.8469) acc_x 71.8750 (81.2500) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [15/29] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 1.2549 (0.8337) acc_x 75.0000 (81.2500) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/29] time 0.166 (0.173) data 0.090 (0.096) loss_x loss_x 1.1973 (0.8571) acc_x 71.8750 (80.0000) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [25/29] time 0.163 (0.171) data 0.086 (0.094) loss_x loss_x 0.8096 (0.8446) acc_x 78.1250 (80.0000) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/21] time 0.163 (0.169) data 0.085 (0.092) loss_u loss_u 0.6826 (0.7308) acc_u 37.5000 (31.8750) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/21] time 0.184 (0.169) data 0.106 (0.092) loss_u loss_u 0.6973 (0.7336) acc_u 43.7500 (31.8750) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/21] time 0.185 (0.171) data 0.108 (0.094) loss_u loss_u 0.8496 (0.7458) acc_u 18.7500 (30.4167) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/21] time 0.184 (0.172) data 0.106 (0.095) loss_u loss_u 0.7378 (0.7474) acc_u 31.2500 (30.1562) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.5786, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 935
clean true:931
clean false:4
clean_rate:0.9957219251336898
noisy true:137
noisy false:544
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 681
epoch [28/200] batch [5/29] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6021 (0.7258) acc_x 81.2500 (80.0000) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/29] time 0.184 (0.184) data 0.106 (0.107) loss_x loss_x 0.9795 (0.8845) acc_x 78.1250 (78.7500) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/29] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.5552 (0.8604) acc_x 84.3750 (78.3333) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/29] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 1.2158 (0.8759) acc_x 65.6250 (77.3438) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [25/29] time 0.160 (0.183) data 0.083 (0.106) loss_x loss_x 0.6685 (0.8391) acc_x 84.3750 (77.7500) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/21] time 0.165 (0.181) data 0.088 (0.104) loss_u loss_u 0.7012 (0.7806) acc_u 31.2500 (23.7500) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/21] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.6670 (0.7577) acc_u 46.8750 (28.1250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/21] time 0.162 (0.177) data 0.084 (0.100) loss_u loss_u 0.7700 (0.7660) acc_u 31.2500 (27.5000) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/21] time 0.193 (0.178) data 0.115 (0.101) loss_u loss_u 0.7495 (0.7647) acc_u 28.1250 (27.9688) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.5687, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 919
clean true:916
clean false:3
clean_rate:0.9967355821545157
noisy true:131
noisy false:566
after delete: len(clean_dataset) 919
after delete: len(noisy_dataset) 697
epoch [29/200] batch [5/28] time 0.186 (0.188) data 0.110 (0.111) loss_x loss_x 0.8423 (0.8578) acc_x 81.2500 (76.2500) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/28] time 0.203 (0.189) data 0.125 (0.112) loss_x loss_x 0.7798 (0.8848) acc_x 81.2500 (76.8750) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/28] time 0.184 (0.189) data 0.107 (0.111) loss_x loss_x 0.9312 (0.9033) acc_x 75.0000 (77.2917) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/28] time 0.176 (0.187) data 0.100 (0.110) loss_x loss_x 0.6499 (0.8602) acc_x 78.1250 (77.6562) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [25/28] time 0.160 (0.185) data 0.082 (0.108) loss_x loss_x 1.0039 (0.8107) acc_x 71.8750 (78.8750) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/21] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8105 (0.7938) acc_u 18.7500 (23.7500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/21] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.6533 (0.7587) acc_u 40.6250 (29.6875) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/21] time 0.162 (0.182) data 0.085 (0.105) loss_u loss_u 0.8398 (0.7589) acc_u 25.0000 (29.7917) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/21] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.6714 (0.7542) acc_u 31.2500 (30.3125) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.5829, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 942
clean true:940
clean false:2
clean_rate:0.9978768577494692
noisy true:148
noisy false:526
after delete: len(clean_dataset) 942
after delete: len(noisy_dataset) 674
epoch [30/200] batch [5/29] time 0.171 (0.176) data 0.094 (0.098) loss_x loss_x 1.2031 (0.9822) acc_x 65.6250 (72.5000) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/29] time 0.171 (0.171) data 0.092 (0.093) loss_x loss_x 0.5483 (0.8069) acc_x 81.2500 (76.5625) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/29] time 0.164 (0.170) data 0.086 (0.092) loss_x loss_x 0.8462 (0.7895) acc_x 78.1250 (77.7083) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/29] time 0.188 (0.169) data 0.111 (0.092) loss_x loss_x 0.5913 (0.7953) acc_x 87.5000 (77.6562) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [25/29] time 0.171 (0.170) data 0.094 (0.093) loss_x loss_x 0.8696 (0.8247) acc_x 75.0000 (76.6250) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/21] time 0.161 (0.170) data 0.084 (0.092) loss_u loss_u 0.8623 (0.7402) acc_u 12.5000 (29.3750) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/21] time 0.179 (0.171) data 0.101 (0.094) loss_u loss_u 0.7622 (0.7559) acc_u 28.1250 (27.8125) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/21] time 0.185 (0.171) data 0.107 (0.094) loss_u loss_u 0.8042 (0.7655) acc_u 25.0000 (27.2917) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/21] time 0.183 (0.172) data 0.105 (0.095) loss_u loss_u 0.7295 (0.7496) acc_u 34.3750 (29.2188) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 515
confident_label rate tensor(0.5996, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 969
clean true:964
clean false:5
clean_rate:0.9948400412796697
noisy true:137
noisy false:510
after delete: len(clean_dataset) 969
after delete: len(noisy_dataset) 647
epoch [31/200] batch [5/30] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.3506 (0.6187) acc_x 93.7500 (83.7500) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/30] time 0.185 (0.186) data 0.107 (0.109) loss_x loss_x 1.1328 (0.8030) acc_x 71.8750 (79.6875) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/30] time 0.161 (0.182) data 0.085 (0.105) loss_x loss_x 0.9404 (0.8079) acc_x 81.2500 (80.2083) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/30] time 0.163 (0.177) data 0.087 (0.100) loss_x loss_x 0.8262 (0.8555) acc_x 78.1250 (79.2188) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [25/30] time 0.160 (0.173) data 0.083 (0.097) loss_x loss_x 1.0469 (0.8712) acc_x 78.1250 (78.2500) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [30/30] time 0.161 (0.172) data 0.084 (0.095) loss_x loss_x 0.6313 (0.8305) acc_x 84.3750 (78.9583) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/20] time 0.166 (0.172) data 0.089 (0.095) loss_u loss_u 0.7461 (0.7570) acc_u 31.2500 (28.7500) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/20] time 0.167 (0.173) data 0.090 (0.096) loss_u loss_u 0.7373 (0.7763) acc_u 28.1250 (25.9375) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/20] time 0.186 (0.173) data 0.107 (0.096) loss_u loss_u 0.6768 (0.7533) acc_u 37.5000 (29.5833) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [20/20] time 0.179 (0.173) data 0.102 (0.096) loss_u loss_u 0.6885 (0.7582) acc_u 31.2500 (28.4375) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 499
confident_label rate tensor(0.6040, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 976
clean true:974
clean false:2
clean_rate:0.9979508196721312
noisy true:143
noisy false:497
after delete: len(clean_dataset) 976
after delete: len(noisy_dataset) 640
epoch [32/200] batch [5/30] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.4773 (0.7079) acc_x 87.5000 (76.8750) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/30] time 0.175 (0.173) data 0.097 (0.096) loss_x loss_x 0.8550 (0.7487) acc_x 84.3750 (78.4375) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [15/30] time 0.168 (0.172) data 0.092 (0.095) loss_x loss_x 0.7778 (0.7241) acc_x 78.1250 (78.9583) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/30] time 0.166 (0.171) data 0.090 (0.094) loss_x loss_x 0.6377 (0.7161) acc_x 81.2500 (79.0625) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [25/30] time 0.167 (0.170) data 0.090 (0.093) loss_x loss_x 0.8735 (0.7457) acc_x 84.3750 (79.0000) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [30/30] time 0.186 (0.172) data 0.108 (0.095) loss_x loss_x 0.5503 (0.7425) acc_x 87.5000 (79.6875) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/20] time 0.170 (0.172) data 0.093 (0.095) loss_u loss_u 0.8325 (0.7795) acc_u 15.6250 (27.5000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/20] time 0.179 (0.173) data 0.102 (0.096) loss_u loss_u 0.7935 (0.7903) acc_u 28.1250 (25.6250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/20] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.8413 (0.7734) acc_u 15.6250 (26.4583) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [20/20] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.7437 (0.7748) acc_u 28.1250 (26.4062) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.5941, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 960
clean true:956
clean false:4
clean_rate:0.9958333333333333
noisy true:149
noisy false:507
after delete: len(clean_dataset) 960
after delete: len(noisy_dataset) 656
epoch [33/200] batch [5/30] time 0.186 (0.187) data 0.108 (0.110) loss_x loss_x 0.9111 (0.9088) acc_x 81.2500 (80.0000) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/30] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.8794 (0.7577) acc_x 87.5000 (81.2500) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/30] time 0.164 (0.184) data 0.087 (0.107) loss_x loss_x 0.5869 (0.7684) acc_x 87.5000 (81.4583) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/30] time 0.163 (0.180) data 0.086 (0.103) loss_x loss_x 0.9204 (0.7651) acc_x 84.3750 (81.8750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [25/30] time 0.191 (0.182) data 0.114 (0.105) loss_x loss_x 1.2871 (0.7833) acc_x 81.2500 (81.5000) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [30/30] time 0.201 (0.183) data 0.122 (0.106) loss_x loss_x 1.1582 (0.8048) acc_x 71.8750 (80.3125) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/20] time 0.186 (0.184) data 0.108 (0.106) loss_u loss_u 0.7822 (0.7766) acc_u 25.0000 (28.7500) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/20] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.7114 (0.7483) acc_u 31.2500 (31.5625) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/20] time 0.170 (0.184) data 0.092 (0.106) loss_u loss_u 0.6548 (0.7538) acc_u 43.7500 (30.6250) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [20/20] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.7134 (0.7527) acc_u 34.3750 (30.6250) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.5953, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 962
clean true:956
clean false:6
clean_rate:0.9937629937629938
noisy true:141
noisy false:513
after delete: len(clean_dataset) 962
after delete: len(noisy_dataset) 654
epoch [34/200] batch [5/30] time 0.185 (0.185) data 0.108 (0.107) loss_x loss_x 0.6104 (0.7092) acc_x 81.2500 (81.2500) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/30] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.7178 (0.6757) acc_x 81.2500 (81.8750) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [15/30] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.6943 (0.7509) acc_x 78.1250 (80.6250) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/30] time 0.170 (0.181) data 0.094 (0.104) loss_x loss_x 0.7856 (0.7792) acc_x 75.0000 (80.1562) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [25/30] time 0.160 (0.180) data 0.083 (0.103) loss_x loss_x 1.0947 (0.7933) acc_x 71.8750 (79.8750) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [30/30] time 0.166 (0.178) data 0.089 (0.101) loss_x loss_x 0.8857 (0.7965) acc_x 78.1250 (79.3750) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/20] time 0.169 (0.177) data 0.091 (0.099) loss_u loss_u 0.7300 (0.8046) acc_u 28.1250 (21.8750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/20] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.6943 (0.7693) acc_u 37.5000 (27.5000) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/20] time 0.162 (0.175) data 0.085 (0.098) loss_u loss_u 0.7964 (0.7643) acc_u 25.0000 (28.1250) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [20/20] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.7075 (0.7529) acc_u 31.2500 (29.2188) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.5953, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 962
clean true:960
clean false:2
clean_rate:0.997920997920998
noisy true:137
noisy false:517
after delete: len(clean_dataset) 962
after delete: len(noisy_dataset) 654
epoch [35/200] batch [5/30] time 0.186 (0.186) data 0.108 (0.108) loss_x loss_x 0.3435 (0.6795) acc_x 90.6250 (78.7500) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/30] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.9438 (0.7492) acc_x 75.0000 (79.3750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/30] time 0.189 (0.186) data 0.112 (0.109) loss_x loss_x 1.2979 (0.8051) acc_x 71.8750 (79.3750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/30] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 1.0830 (0.7860) acc_x 65.6250 (79.5312) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [25/30] time 0.211 (0.186) data 0.133 (0.109) loss_x loss_x 1.2070 (0.7969) acc_x 59.3750 (78.6250) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [30/30] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.7705 (0.7896) acc_x 78.1250 (79.1667) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/20] time 0.189 (0.187) data 0.111 (0.110) loss_u loss_u 0.6606 (0.7334) acc_u 37.5000 (31.2500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/20] time 0.183 (0.187) data 0.105 (0.110) loss_u loss_u 0.7915 (0.7228) acc_u 21.8750 (31.8750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/20] time 0.184 (0.187) data 0.107 (0.110) loss_u loss_u 0.7427 (0.7404) acc_u 28.1250 (29.5833) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [20/20] time 0.187 (0.187) data 0.109 (0.110) loss_u loss_u 0.6504 (0.7369) acc_u 40.6250 (29.8438) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.6021, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 973
clean true:971
clean false:2
clean_rate:0.9979445015416238
noisy true:139
noisy false:504
after delete: len(clean_dataset) 973
after delete: len(noisy_dataset) 643
epoch [36/200] batch [5/30] time 0.166 (0.175) data 0.090 (0.098) loss_x loss_x 1.1230 (0.8779) acc_x 68.7500 (74.3750) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [10/30] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 1.2490 (0.8094) acc_x 68.7500 (76.5625) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [15/30] time 0.185 (0.173) data 0.109 (0.096) loss_x loss_x 0.4407 (0.7661) acc_x 84.3750 (78.5417) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/30] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 0.8550 (0.7788) acc_x 78.1250 (78.7500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [25/30] time 0.186 (0.172) data 0.109 (0.095) loss_x loss_x 1.0234 (0.8116) acc_x 78.1250 (78.0000) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [30/30] time 0.182 (0.174) data 0.105 (0.097) loss_x loss_x 0.9644 (0.7938) acc_x 78.1250 (78.8542) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/20] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.7021 (0.7113) acc_u 34.3750 (32.5000) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/20] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.7324 (0.7382) acc_u 28.1250 (30.6250) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/20] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.8608 (0.7553) acc_u 18.7500 (28.5417) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [20/20] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8799 (0.7594) acc_u 6.2500 (27.9688) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.5916, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 956
clean true:954
clean false:2
clean_rate:0.997907949790795
noisy true:136
noisy false:524
after delete: len(clean_dataset) 956
after delete: len(noisy_dataset) 660
epoch [37/200] batch [5/29] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.8247 (0.7959) acc_x 81.2500 (79.3750) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/29] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.7212 (0.7429) acc_x 78.1250 (80.3125) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/29] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.5308 (0.7501) acc_x 81.2500 (80.8333) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/29] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.8262 (0.7655) acc_x 78.1250 (79.6875) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [25/29] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.3799 (0.7846) acc_x 90.6250 (79.5000) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/20] time 0.184 (0.185) data 0.106 (0.109) loss_u loss_u 0.7720 (0.7833) acc_u 18.7500 (23.7500) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/20] time 0.183 (0.186) data 0.107 (0.109) loss_u loss_u 0.7817 (0.7459) acc_u 28.1250 (28.7500) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/20] time 0.186 (0.186) data 0.109 (0.109) loss_u loss_u 0.6021 (0.7296) acc_u 50.0000 (31.0417) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [20/20] time 0.183 (0.186) data 0.106 (0.109) loss_u loss_u 0.7446 (0.7287) acc_u 31.2500 (31.2500) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.6157, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 995
clean true:993
clean false:2
clean_rate:0.9979899497487437
noisy true:142
noisy false:479
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 621
epoch [38/200] batch [5/31] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.7339 (0.6374) acc_x 78.1250 (84.3750) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/31] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.5107 (0.7636) acc_x 84.3750 (81.2500) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/31] time 0.171 (0.183) data 0.094 (0.105) loss_x loss_x 0.6323 (0.7301) acc_x 84.3750 (82.5000) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/31] time 0.174 (0.181) data 0.097 (0.104) loss_x loss_x 0.9839 (0.7117) acc_x 75.0000 (82.3438) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [25/31] time 0.161 (0.178) data 0.083 (0.101) loss_x loss_x 0.8203 (0.7509) acc_x 71.8750 (81.0000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [30/31] time 0.188 (0.180) data 0.111 (0.103) loss_x loss_x 0.6650 (0.7475) acc_x 78.1250 (80.7292) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/19] time 0.189 (0.181) data 0.111 (0.104) loss_u loss_u 0.8140 (0.7816) acc_u 18.7500 (24.3750) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/19] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8286 (0.7809) acc_u 21.8750 (25.9375) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/19] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.7051 (0.7577) acc_u 31.2500 (27.7083) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.6033, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 975
clean true:972
clean false:3
clean_rate:0.9969230769230769
noisy true:146
noisy false:495
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 641
epoch [39/200] batch [5/30] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.3350 (0.5694) acc_x 90.6250 (83.7500) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [10/30] time 0.186 (0.187) data 0.110 (0.110) loss_x loss_x 0.4128 (0.6212) acc_x 87.5000 (83.4375) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [15/30] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.5293 (0.6665) acc_x 87.5000 (81.4583) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [20/30] time 0.185 (0.188) data 0.107 (0.111) loss_x loss_x 0.5879 (0.6613) acc_x 90.6250 (82.3438) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [25/30] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 1.0635 (0.6770) acc_x 75.0000 (82.0000) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [30/30] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.9795 (0.6789) acc_x 78.1250 (81.8750) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/20] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.8003 (0.7521) acc_u 18.7500 (30.0000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/20] time 0.161 (0.184) data 0.084 (0.107) loss_u loss_u 0.7754 (0.7439) acc_u 28.1250 (32.1875) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/20] time 0.161 (0.182) data 0.084 (0.104) loss_u loss_u 0.7705 (0.7466) acc_u 31.2500 (31.6667) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [20/20] time 0.163 (0.180) data 0.085 (0.102) loss_u loss_u 0.8662 (0.7557) acc_u 18.7500 (30.4688) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 539
confident_label rate tensor(0.5804, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 938
clean true:935
clean false:3
clean_rate:0.9968017057569296
noisy true:142
noisy false:536
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 678
epoch [40/200] batch [5/29] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.8501 (0.8021) acc_x 71.8750 (77.5000) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/29] time 0.188 (0.180) data 0.111 (0.103) loss_x loss_x 0.7842 (0.8666) acc_x 81.2500 (76.2500) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [15/29] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.6582 (0.8089) acc_x 84.3750 (77.7083) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [20/29] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.7915 (0.7783) acc_x 78.1250 (77.9688) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [25/29] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 1.1064 (0.7745) acc_x 78.1250 (78.6250) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/21] time 0.173 (0.182) data 0.095 (0.105) loss_u loss_u 0.7656 (0.6784) acc_u 34.3750 (38.1250) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/21] time 0.173 (0.182) data 0.094 (0.104) loss_u loss_u 0.8442 (0.7074) acc_u 12.5000 (33.7500) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/21] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.7573 (0.7095) acc_u 28.1250 (33.9583) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/21] time 0.184 (0.183) data 0.107 (0.105) loss_u loss_u 0.7861 (0.7167) acc_u 25.0000 (33.2812) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.6027, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 974
clean true:969
clean false:5
clean_rate:0.9948665297741273
noisy true:146
noisy false:496
after delete: len(clean_dataset) 974
after delete: len(noisy_dataset) 642
epoch [41/200] batch [5/30] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.6602 (0.7029) acc_x 81.2500 (84.3750) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [10/30] time 0.190 (0.173) data 0.113 (0.096) loss_x loss_x 0.4490 (0.6443) acc_x 87.5000 (84.0625) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/30] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 0.8198 (0.6723) acc_x 68.7500 (81.8750) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/30] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 1.1865 (0.7451) acc_x 68.7500 (80.3125) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [25/30] time 0.184 (0.176) data 0.108 (0.099) loss_x loss_x 0.3894 (0.7071) acc_x 87.5000 (80.8750) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [30/30] time 0.169 (0.176) data 0.091 (0.099) loss_x loss_x 0.6128 (0.7060) acc_x 87.5000 (81.2500) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/20] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.6943 (0.7233) acc_u 37.5000 (32.5000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/20] time 0.193 (0.177) data 0.115 (0.100) loss_u loss_u 0.6694 (0.7248) acc_u 43.7500 (32.5000) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/20] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.7188 (0.7199) acc_u 34.3750 (33.5417) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [20/20] time 0.186 (0.178) data 0.109 (0.100) loss_u loss_u 0.6919 (0.7284) acc_u 37.5000 (32.1875) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.6046, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 977
clean true:975
clean false:2
clean_rate:0.9979529170931423
noisy true:147
noisy false:492
after delete: len(clean_dataset) 977
after delete: len(noisy_dataset) 639
epoch [42/200] batch [5/30] time 0.161 (0.176) data 0.083 (0.099) loss_x loss_x 0.9165 (0.7533) acc_x 68.7500 (80.6250) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/30] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.6411 (0.7233) acc_x 84.3750 (82.1875) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/30] time 0.161 (0.173) data 0.085 (0.096) loss_x loss_x 0.6050 (0.6670) acc_x 78.1250 (82.7083) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/30] time 0.161 (0.173) data 0.084 (0.096) loss_x loss_x 1.2734 (0.7099) acc_x 71.8750 (81.4062) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [25/30] time 0.185 (0.173) data 0.108 (0.096) loss_x loss_x 0.5664 (0.7067) acc_x 84.3750 (81.5000) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [30/30] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 1.0107 (0.7021) acc_x 71.8750 (81.2500) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/19] time 0.188 (0.177) data 0.111 (0.100) loss_u loss_u 0.8008 (0.7370) acc_u 18.7500 (29.3750) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/19] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.7354 (0.7289) acc_u 40.6250 (32.1875) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/19] time 0.173 (0.179) data 0.094 (0.102) loss_u loss_u 0.7959 (0.7219) acc_u 25.0000 (32.7083) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 474
confident_label rate tensor(0.6219, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1005
clean true:1003
clean false:2
clean_rate:0.9980099502487563
noisy true:139
noisy false:472
after delete: len(clean_dataset) 1005
after delete: len(noisy_dataset) 611
epoch [43/200] batch [5/31] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.7861 (0.6607) acc_x 84.3750 (84.3750) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/31] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.5376 (0.7249) acc_x 87.5000 (81.5625) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/31] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.5166 (0.7232) acc_x 84.3750 (81.2500) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [20/31] time 0.180 (0.186) data 0.104 (0.109) loss_x loss_x 0.8975 (0.7799) acc_x 78.1250 (80.6250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [25/31] time 0.219 (0.188) data 0.141 (0.111) loss_x loss_x 0.6514 (0.7732) acc_x 84.3750 (81.2500) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/31] time 0.175 (0.187) data 0.098 (0.110) loss_x loss_x 0.7676 (0.7597) acc_x 78.1250 (80.8333) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/19] time 0.162 (0.185) data 0.084 (0.108) loss_u loss_u 0.8101 (0.7485) acc_u 28.1250 (31.8750) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/19] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.7544 (0.7441) acc_u 28.1250 (31.2500) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/19] time 0.191 (0.184) data 0.113 (0.107) loss_u loss_u 0.7539 (0.7565) acc_u 28.1250 (29.3750) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.6095, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 985
clean true:981
clean false:4
clean_rate:0.9959390862944163
noisy true:147
noisy false:484
after delete: len(clean_dataset) 985
after delete: len(noisy_dataset) 631
epoch [44/200] batch [5/30] time 0.178 (0.171) data 0.101 (0.094) loss_x loss_x 1.0859 (0.7344) acc_x 78.1250 (82.5000) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/30] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.7310 (0.7300) acc_x 81.2500 (81.8750) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/30] time 0.172 (0.179) data 0.094 (0.101) loss_x loss_x 0.7178 (0.7994) acc_x 84.3750 (79.7917) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [20/30] time 0.164 (0.177) data 0.086 (0.099) loss_x loss_x 0.7622 (0.7550) acc_x 81.2500 (80.1562) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [25/30] time 0.185 (0.179) data 0.109 (0.101) loss_x loss_x 0.4429 (0.7226) acc_x 87.5000 (80.7500) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [30/30] time 0.187 (0.180) data 0.110 (0.103) loss_x loss_x 0.3523 (0.7111) acc_x 90.6250 (80.9375) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/19] time 0.216 (0.182) data 0.138 (0.105) loss_u loss_u 0.6870 (0.6930) acc_u 34.3750 (35.6250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/19] time 0.189 (0.183) data 0.111 (0.106) loss_u loss_u 0.7417 (0.7113) acc_u 31.2500 (33.7500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/19] time 0.190 (0.184) data 0.112 (0.106) loss_u loss_u 0.7466 (0.7268) acc_u 25.0000 (31.8750) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.6101, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 986
clean true:984
clean false:2
clean_rate:0.9979716024340771
noisy true:145
noisy false:485
after delete: len(clean_dataset) 986
after delete: len(noisy_dataset) 630
epoch [45/200] batch [5/30] time 0.170 (0.170) data 0.094 (0.092) loss_x loss_x 0.3679 (0.6028) acc_x 87.5000 (81.8750) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/30] time 0.201 (0.177) data 0.124 (0.100) loss_x loss_x 0.8584 (0.6671) acc_x 75.0000 (81.2500) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/30] time 0.187 (0.177) data 0.110 (0.100) loss_x loss_x 0.6172 (0.6368) acc_x 75.0000 (82.5000) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/30] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.5479 (0.6569) acc_x 81.2500 (81.8750) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/30] time 0.178 (0.180) data 0.101 (0.103) loss_x loss_x 0.4395 (0.6502) acc_x 90.6250 (82.1250) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [30/30] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.4851 (0.6535) acc_x 90.6250 (82.7083) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/19] time 0.178 (0.179) data 0.100 (0.102) loss_u loss_u 0.6558 (0.7182) acc_u 34.3750 (31.8750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/19] time 0.171 (0.178) data 0.093 (0.101) loss_u loss_u 0.7646 (0.7323) acc_u 31.2500 (31.8750) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/19] time 0.173 (0.178) data 0.094 (0.101) loss_u loss_u 0.7778 (0.7263) acc_u 25.0000 (32.2917) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 470
confident_label rate tensor(0.6250, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1010
clean true:1005
clean false:5
clean_rate:0.995049504950495
noisy true:141
noisy false:465
after delete: len(clean_dataset) 1010
after delete: len(noisy_dataset) 606
epoch [46/200] batch [5/31] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.9971 (0.7952) acc_x 71.8750 (79.3750) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [10/31] time 0.175 (0.182) data 0.096 (0.105) loss_x loss_x 0.8398 (0.7756) acc_x 81.2500 (78.1250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/31] time 0.173 (0.179) data 0.095 (0.101) loss_x loss_x 0.8599 (0.7154) acc_x 71.8750 (79.3750) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/31] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.8530 (0.7378) acc_x 75.0000 (79.5312) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [25/31] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.4805 (0.6955) acc_x 84.3750 (81.0000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [30/31] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.7427 (0.7115) acc_x 84.3750 (81.0417) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/18] time 0.211 (0.183) data 0.133 (0.106) loss_u loss_u 0.7695 (0.7534) acc_u 25.0000 (28.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/18] time 0.174 (0.183) data 0.096 (0.106) loss_u loss_u 0.6572 (0.7540) acc_u 40.6250 (30.3125) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/18] time 0.167 (0.181) data 0.090 (0.104) loss_u loss_u 0.7256 (0.7622) acc_u 31.2500 (29.1667) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.6275, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1014
clean true:1011
clean false:3
clean_rate:0.9970414201183432
noisy true:141
noisy false:461
after delete: len(clean_dataset) 1014
after delete: len(noisy_dataset) 602
epoch [47/200] batch [5/31] time 0.186 (0.186) data 0.108 (0.109) loss_x loss_x 0.6245 (0.7501) acc_x 87.5000 (81.8750) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/31] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.4849 (0.6403) acc_x 84.3750 (83.7500) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/31] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.8472 (0.6507) acc_x 84.3750 (84.3750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/31] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 1.0771 (0.6806) acc_x 71.8750 (82.9688) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [25/31] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.7139 (0.6619) acc_x 78.1250 (83.1250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/31] time 0.194 (0.186) data 0.116 (0.109) loss_x loss_x 0.8677 (0.6726) acc_x 75.0000 (82.2917) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/18] time 0.185 (0.187) data 0.107 (0.109) loss_u loss_u 0.7935 (0.7508) acc_u 21.8750 (27.5000) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/18] time 0.189 (0.187) data 0.110 (0.109) loss_u loss_u 0.7456 (0.7542) acc_u 31.2500 (28.7500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/18] time 0.188 (0.187) data 0.111 (0.109) loss_u loss_u 0.6675 (0.7494) acc_u 50.0000 (29.3750) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.6182, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 999
clean true:997
clean false:2
clean_rate:0.997997997997998
noisy true:143
noisy false:474
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 617
epoch [48/200] batch [5/31] time 0.183 (0.186) data 0.107 (0.109) loss_x loss_x 0.4482 (0.4567) acc_x 93.7500 (88.7500) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/31] time 0.190 (0.185) data 0.113 (0.107) loss_x loss_x 0.5977 (0.5634) acc_x 87.5000 (85.6250) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/31] time 0.169 (0.181) data 0.092 (0.104) loss_x loss_x 0.6465 (0.6150) acc_x 84.3750 (85.2083) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/31] time 0.183 (0.180) data 0.105 (0.103) loss_x loss_x 0.8413 (0.6389) acc_x 71.8750 (83.5938) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [25/31] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 1.0361 (0.6960) acc_x 75.0000 (81.6250) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [30/31] time 0.198 (0.182) data 0.121 (0.105) loss_x loss_x 0.4976 (0.6709) acc_x 84.3750 (82.2917) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/19] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.7007 (0.7217) acc_u 37.5000 (32.5000) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/19] time 0.223 (0.183) data 0.145 (0.106) loss_u loss_u 0.8018 (0.7162) acc_u 18.7500 (32.1875) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/19] time 0.175 (0.182) data 0.097 (0.105) loss_u loss_u 0.7930 (0.7170) acc_u 21.8750 (32.2917) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.6200, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1002
clean true:997
clean false:5
clean_rate:0.9950099800399201
noisy true:135
noisy false:479
after delete: len(clean_dataset) 1002
after delete: len(noisy_dataset) 614
epoch [49/200] batch [5/31] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.6362 (0.5432) acc_x 84.3750 (85.6250) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [10/31] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.9868 (0.5551) acc_x 71.8750 (85.0000) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/31] time 0.163 (0.181) data 0.086 (0.104) loss_x loss_x 1.0537 (0.6172) acc_x 75.0000 (83.7500) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/31] time 0.199 (0.181) data 0.123 (0.104) loss_x loss_x 1.0312 (0.6237) acc_x 84.3750 (84.0625) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [25/31] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 1.1025 (0.6243) acc_x 75.0000 (84.2500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/31] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.7896 (0.6498) acc_x 75.0000 (83.0208) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/19] time 0.187 (0.184) data 0.108 (0.106) loss_u loss_u 0.8076 (0.7397) acc_u 21.8750 (30.0000) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/19] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.6177 (0.7215) acc_u 40.6250 (31.2500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/19] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.6558 (0.7347) acc_u 40.6250 (30.2083) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.6269, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1013
clean true:1009
clean false:4
clean_rate:0.9960513326752222
noisy true:148
noisy false:455
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 603
epoch [50/200] batch [5/31] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.9189 (0.7378) acc_x 78.1250 (79.3750) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/31] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.8110 (0.7314) acc_x 78.1250 (80.0000) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/31] time 0.162 (0.177) data 0.084 (0.100) loss_x loss_x 0.6143 (0.7462) acc_x 84.3750 (80.4167) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/31] time 0.162 (0.173) data 0.085 (0.097) loss_x loss_x 0.4387 (0.7129) acc_x 84.3750 (81.0938) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [25/31] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.9565 (0.7208) acc_x 71.8750 (80.3750) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/31] time 0.175 (0.174) data 0.099 (0.097) loss_x loss_x 0.8047 (0.7567) acc_x 78.1250 (79.6875) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/18] time 0.162 (0.175) data 0.085 (0.098) loss_u loss_u 0.7393 (0.7396) acc_u 34.3750 (31.8750) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/18] time 0.168 (0.173) data 0.090 (0.096) loss_u loss_u 0.7925 (0.7430) acc_u 21.8750 (31.2500) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/18] time 0.244 (0.174) data 0.167 (0.097) loss_u loss_u 0.7759 (0.7549) acc_u 25.0000 (29.1667) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.6120, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 989
clean true:984
clean false:5
clean_rate:0.9949443882709808
noisy true:139
noisy false:488
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 627
epoch [51/200] batch [5/30] time 0.183 (0.184) data 0.105 (0.106) loss_x loss_x 0.9619 (0.7344) acc_x 71.8750 (77.5000) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/30] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8501 (0.7465) acc_x 84.3750 (79.0625) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/30] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.6226 (0.7247) acc_x 87.5000 (80.2083) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [20/30] time 0.179 (0.185) data 0.102 (0.108) loss_x loss_x 0.8594 (0.7060) acc_x 75.0000 (80.3125) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [25/30] time 0.187 (0.183) data 0.109 (0.107) loss_x loss_x 0.9126 (0.7445) acc_x 62.5000 (79.1250) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [30/30] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.5566 (0.7444) acc_x 84.3750 (78.4375) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/19] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.7827 (0.7242) acc_u 28.1250 (32.5000) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/19] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.6948 (0.6974) acc_u 34.3750 (36.2500) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/19] time 0.180 (0.184) data 0.102 (0.107) loss_u loss_u 0.6958 (0.7161) acc_u 40.6250 (34.5833) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 460
confident_label rate tensor(0.6293, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1017
clean true:1010
clean false:7
clean_rate:0.9931170108161259
noisy true:146
noisy false:453
after delete: len(clean_dataset) 1017
after delete: len(noisy_dataset) 599
epoch [52/200] batch [5/31] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.7603 (0.8031) acc_x 78.1250 (80.6250) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/31] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 1.1328 (0.7929) acc_x 71.8750 (78.7500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/31] time 0.178 (0.176) data 0.100 (0.099) loss_x loss_x 0.3674 (0.7286) acc_x 90.6250 (80.4167) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [20/31] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.8589 (0.7210) acc_x 84.3750 (81.4062) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [25/31] time 0.181 (0.177) data 0.104 (0.099) loss_x loss_x 0.5864 (0.7546) acc_x 81.2500 (80.0000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/31] time 0.185 (0.177) data 0.109 (0.100) loss_x loss_x 0.3875 (0.7429) acc_x 87.5000 (80.5208) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/18] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.7021 (0.7115) acc_u 43.7500 (36.8750) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/18] time 0.188 (0.180) data 0.111 (0.103) loss_u loss_u 0.7495 (0.7213) acc_u 31.2500 (34.6875) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/18] time 0.173 (0.180) data 0.095 (0.103) loss_u loss_u 0.7749 (0.7212) acc_u 18.7500 (33.7500) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.6337, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1024
clean true:1019
clean false:5
clean_rate:0.9951171875
noisy true:138
noisy false:454
after delete: len(clean_dataset) 1024
after delete: len(noisy_dataset) 592
epoch [53/200] batch [5/32] time 0.189 (0.185) data 0.110 (0.108) loss_x loss_x 0.6357 (0.7963) acc_x 81.2500 (79.3750) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/32] time 0.178 (0.184) data 0.100 (0.107) loss_x loss_x 0.4150 (0.6889) acc_x 84.3750 (82.1875) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/32] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.9829 (0.6986) acc_x 71.8750 (81.6667) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/32] time 0.179 (0.181) data 0.102 (0.103) loss_x loss_x 0.6006 (0.6790) acc_x 87.5000 (82.5000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/32] time 0.172 (0.179) data 0.093 (0.102) loss_x loss_x 0.6460 (0.6804) acc_x 68.7500 (82.5000) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/32] time 0.163 (0.178) data 0.086 (0.100) loss_x loss_x 0.5894 (0.6939) acc_x 84.3750 (81.5625) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/18] time 0.164 (0.177) data 0.086 (0.100) loss_u loss_u 0.7363 (0.7399) acc_u 31.2500 (31.8750) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/18] time 0.176 (0.176) data 0.098 (0.099) loss_u loss_u 0.7500 (0.7387) acc_u 34.3750 (30.9375) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/18] time 0.172 (0.177) data 0.093 (0.100) loss_u loss_u 0.7339 (0.7421) acc_u 31.2500 (31.6667) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 468
confident_label rate tensor(0.6200, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1002
clean true:998
clean false:4
clean_rate:0.9960079840319361
noisy true:150
noisy false:464
after delete: len(clean_dataset) 1002
after delete: len(noisy_dataset) 614
epoch [54/200] batch [5/31] time 0.168 (0.166) data 0.090 (0.089) loss_x loss_x 0.3965 (0.9064) acc_x 87.5000 (76.8750) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/31] time 0.196 (0.168) data 0.119 (0.091) loss_x loss_x 0.7710 (0.8273) acc_x 78.1250 (79.3750) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/31] time 0.184 (0.173) data 0.108 (0.096) loss_x loss_x 0.5210 (0.7596) acc_x 84.3750 (81.0417) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/31] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.8408 (0.8160) acc_x 81.2500 (79.3750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [25/31] time 0.188 (0.175) data 0.109 (0.098) loss_x loss_x 0.4102 (0.7629) acc_x 87.5000 (80.3750) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/31] time 0.165 (0.176) data 0.088 (0.099) loss_x loss_x 0.8374 (0.7417) acc_x 81.2500 (80.8333) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/19] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.6895 (0.6926) acc_u 40.6250 (38.1250) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/19] time 0.198 (0.179) data 0.120 (0.102) loss_u loss_u 0.7969 (0.7333) acc_u 21.8750 (31.5625) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/19] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.7354 (0.7269) acc_u 34.3750 (32.5000) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.6355, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1027
clean true:1022
clean false:5
clean_rate:0.9951314508276533
noisy true:151
noisy false:438
after delete: len(clean_dataset) 1027
after delete: len(noisy_dataset) 589
epoch [55/200] batch [5/32] time 0.171 (0.180) data 0.093 (0.103) loss_x loss_x 0.8184 (0.6965) acc_x 75.0000 (81.2500) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [10/32] time 0.170 (0.180) data 0.093 (0.103) loss_x loss_x 0.7544 (0.6900) acc_x 78.1250 (81.2500) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/32] time 0.187 (0.178) data 0.109 (0.101) loss_x loss_x 0.6543 (0.7294) acc_x 84.3750 (81.4583) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/32] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.6470 (0.7101) acc_x 87.5000 (81.2500) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/32] time 0.186 (0.178) data 0.108 (0.101) loss_x loss_x 0.9810 (0.6916) acc_x 71.8750 (81.7500) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/32] time 0.187 (0.179) data 0.111 (0.102) loss_x loss_x 0.2339 (0.6559) acc_x 90.6250 (82.6042) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/18] time 0.185 (0.181) data 0.107 (0.103) loss_u loss_u 0.7388 (0.7244) acc_u 28.1250 (31.2500) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/18] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.7051 (0.7501) acc_u 31.2500 (29.6875) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/18] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.7241 (0.7459) acc_u 37.5000 (30.0000) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 447
confident_label rate tensor(0.6380, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1031
clean true:1025
clean false:6
clean_rate:0.9941804073714839
noisy true:144
noisy false:441
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 585
epoch [56/200] batch [5/32] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.5464 (0.5020) acc_x 87.5000 (85.6250) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [10/32] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.7212 (0.5665) acc_x 84.3750 (85.0000) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/32] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.8506 (0.6326) acc_x 78.1250 (83.3333) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/32] time 0.190 (0.184) data 0.111 (0.107) loss_x loss_x 0.4431 (0.6283) acc_x 87.5000 (84.0625) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/32] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.5142 (0.6484) acc_x 84.3750 (83.1250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [30/32] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.6660 (0.6638) acc_x 84.3750 (82.8125) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/18] time 0.171 (0.184) data 0.093 (0.107) loss_u loss_u 0.7925 (0.7327) acc_u 25.0000 (30.6250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/18] time 0.175 (0.183) data 0.098 (0.106) loss_u loss_u 0.7241 (0.7490) acc_u 37.5000 (28.4375) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/18] time 0.172 (0.183) data 0.093 (0.105) loss_u loss_u 0.7495 (0.7457) acc_u 34.3750 (28.9583) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.6219, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1005
clean true:997
clean false:8
clean_rate:0.9920398009950249
noisy true:143
noisy false:468
after delete: len(clean_dataset) 1005
after delete: len(noisy_dataset) 611
epoch [57/200] batch [5/31] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5649 (0.7084) acc_x 84.3750 (83.1250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/31] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 1.4570 (0.7741) acc_x 71.8750 (80.9375) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/31] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 1.1934 (0.7545) acc_x 65.6250 (79.3750) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [20/31] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.6875 (0.7261) acc_x 81.2500 (80.4688) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/31] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6455 (0.7122) acc_x 78.1250 (80.8750) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/31] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.9902 (0.7306) acc_x 71.8750 (79.7917) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/19] time 0.193 (0.185) data 0.115 (0.108) loss_u loss_u 0.6836 (0.6901) acc_u 34.3750 (35.6250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/19] time 0.189 (0.186) data 0.112 (0.109) loss_u loss_u 0.6738 (0.6854) acc_u 37.5000 (37.5000) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/19] time 0.186 (0.186) data 0.107 (0.109) loss_u loss_u 0.7812 (0.7055) acc_u 28.1250 (35.4167) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 448
confident_label rate tensor(0.6361, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1028
clean true:1023
clean false:5
clean_rate:0.995136186770428
noisy true:145
noisy false:443
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 588
epoch [58/200] batch [5/32] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.4282 (0.4894) acc_x 81.2500 (88.1250) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/32] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 1.0850 (0.6047) acc_x 75.0000 (84.3750) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/32] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.5122 (0.6406) acc_x 81.2500 (82.9167) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/32] time 0.176 (0.178) data 0.099 (0.100) loss_x loss_x 0.5830 (0.6290) acc_x 93.7500 (83.7500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/32] time 0.193 (0.178) data 0.115 (0.101) loss_x loss_x 1.0527 (0.6562) acc_x 68.7500 (82.8750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/32] time 0.169 (0.178) data 0.093 (0.101) loss_x loss_x 0.5986 (0.6516) acc_x 84.3750 (82.2917) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/18] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.8691 (0.7668) acc_u 15.6250 (26.2500) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/18] time 0.174 (0.177) data 0.096 (0.099) loss_u loss_u 0.6323 (0.7127) acc_u 40.6250 (32.1875) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/18] time 0.173 (0.177) data 0.096 (0.099) loss_u loss_u 0.7573 (0.7193) acc_u 28.1250 (32.2917) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.6399, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1034
clean true:1032
clean false:2
clean_rate:0.9980657640232108
noisy true:152
noisy false:430
after delete: len(clean_dataset) 1034
after delete: len(noisy_dataset) 582
epoch [59/200] batch [5/32] time 0.188 (0.194) data 0.110 (0.116) loss_x loss_x 0.6211 (0.5631) acc_x 81.2500 (84.3750) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/32] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.8091 (0.7222) acc_x 87.5000 (81.5625) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/32] time 0.183 (0.184) data 0.107 (0.106) loss_x loss_x 1.0732 (0.7713) acc_x 68.7500 (80.2083) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/32] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.5215 (0.7185) acc_x 84.3750 (81.0938) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/32] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.4585 (0.7394) acc_x 90.6250 (80.5000) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/32] time 0.186 (0.180) data 0.108 (0.103) loss_x loss_x 0.6235 (0.7429) acc_x 87.5000 (80.6250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/18] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8022 (0.7028) acc_u 21.8750 (35.6250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/18] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.7393 (0.7146) acc_u 37.5000 (34.0625) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/18] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.7778 (0.7308) acc_u 28.1250 (32.2917) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 462
confident_label rate tensor(0.6231, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1007
clean true:1001
clean false:6
clean_rate:0.9940417080436942
noisy true:153
noisy false:456
after delete: len(clean_dataset) 1007
after delete: len(noisy_dataset) 609
epoch [60/200] batch [5/31] time 0.159 (0.168) data 0.082 (0.091) loss_x loss_x 0.7300 (0.6892) acc_x 87.5000 (81.2500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/31] time 0.177 (0.169) data 0.100 (0.092) loss_x loss_x 0.8813 (0.6875) acc_x 78.1250 (82.1875) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/31] time 0.172 (0.172) data 0.095 (0.095) loss_x loss_x 0.9683 (0.7161) acc_x 78.1250 (82.0833) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/31] time 0.187 (0.174) data 0.108 (0.097) loss_x loss_x 0.7090 (0.6787) acc_x 78.1250 (82.5000) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [25/31] time 0.188 (0.176) data 0.111 (0.099) loss_x loss_x 0.6138 (0.6868) acc_x 84.3750 (82.6250) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [30/31] time 0.184 (0.178) data 0.107 (0.100) loss_x loss_x 0.4597 (0.6669) acc_x 90.6250 (82.7083) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/19] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.7183 (0.7101) acc_u 34.3750 (34.3750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/19] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.6646 (0.7204) acc_u 37.5000 (32.8125) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/19] time 0.173 (0.180) data 0.095 (0.102) loss_u loss_u 0.7500 (0.6977) acc_u 28.1250 (35.0000) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 436
confident_label rate tensor(0.6361, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1028
clean true:1025
clean false:3
clean_rate:0.9970817120622568
noisy true:155
noisy false:433
after delete: len(clean_dataset) 1028
after delete: len(noisy_dataset) 588
epoch [61/200] batch [5/32] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.9429 (0.7124) acc_x 78.1250 (80.6250) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/32] time 0.186 (0.187) data 0.108 (0.111) loss_x loss_x 0.5083 (0.6720) acc_x 87.5000 (80.6250) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [15/32] time 0.190 (0.187) data 0.112 (0.110) loss_x loss_x 0.4556 (0.6552) acc_x 90.6250 (81.0417) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/32] time 0.188 (0.187) data 0.110 (0.110) loss_x loss_x 0.5156 (0.6457) acc_x 90.6250 (82.0312) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/32] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 0.3594 (0.6411) acc_x 90.6250 (82.3750) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/32] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 0.5581 (0.6690) acc_x 84.3750 (81.9792) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/18] time 0.161 (0.184) data 0.084 (0.107) loss_u loss_u 0.6943 (0.7001) acc_u 37.5000 (37.5000) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/18] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.7173 (0.7131) acc_u 31.2500 (35.9375) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/18] time 0.185 (0.183) data 0.108 (0.105) loss_u loss_u 0.6191 (0.7128) acc_u 43.7500 (35.0000) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 433
confident_label rate tensor(0.6374, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1030
clean true:1029
clean false:1
clean_rate:0.9990291262135922
noisy true:154
noisy false:432
after delete: len(clean_dataset) 1030
after delete: len(noisy_dataset) 586
epoch [62/200] batch [5/32] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.5645 (0.5200) acc_x 84.3750 (86.8750) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/32] time 0.191 (0.178) data 0.115 (0.102) loss_x loss_x 0.6680 (0.6356) acc_x 84.3750 (82.8125) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/32] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.7905 (0.6385) acc_x 78.1250 (82.7083) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/32] time 0.186 (0.180) data 0.107 (0.103) loss_x loss_x 0.5410 (0.6727) acc_x 81.2500 (80.9375) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/32] time 0.185 (0.181) data 0.109 (0.104) loss_x loss_x 0.5747 (0.7053) acc_x 87.5000 (81.0000) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/32] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.3506 (0.6938) acc_x 90.6250 (80.9375) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/18] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.6821 (0.6956) acc_u 43.7500 (35.0000) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/18] time 0.187 (0.183) data 0.110 (0.106) loss_u loss_u 0.6904 (0.7080) acc_u 34.3750 (33.7500) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/18] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.8047 (0.7060) acc_u 25.0000 (34.5833) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.6553, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1059
clean true:1056
clean false:3
clean_rate:0.9971671388101983
noisy true:138
noisy false:419
after delete: len(clean_dataset) 1059
after delete: len(noisy_dataset) 557
epoch [63/200] batch [5/33] time 0.187 (0.181) data 0.110 (0.104) loss_x loss_x 0.5098 (0.5532) acc_x 84.3750 (83.7500) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/33] time 0.191 (0.177) data 0.114 (0.100) loss_x loss_x 0.7920 (0.6281) acc_x 81.2500 (83.4375) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/33] time 0.194 (0.181) data 0.117 (0.104) loss_x loss_x 0.3337 (0.5961) acc_x 90.6250 (84.1667) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/33] time 0.206 (0.182) data 0.129 (0.105) loss_x loss_x 0.5298 (0.6130) acc_x 81.2500 (83.9062) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/33] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 0.3245 (0.5854) acc_x 87.5000 (84.7500) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/33] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.9365 (0.6051) acc_x 68.7500 (83.7500) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/17] time 0.189 (0.185) data 0.112 (0.108) loss_u loss_u 0.6602 (0.7254) acc_u 40.6250 (33.7500) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/17] time 0.181 (0.185) data 0.103 (0.107) loss_u loss_u 0.7871 (0.7411) acc_u 25.0000 (30.9375) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/17] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.8472 (0.7368) acc_u 21.8750 (30.8333) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.6479, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1047
clean true:1045
clean false:2
clean_rate:0.9980897803247374
noisy true:149
noisy false:420
after delete: len(clean_dataset) 1047
after delete: len(noisy_dataset) 569
epoch [64/200] batch [5/32] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 1.4873 (0.8615) acc_x 68.7500 (79.3750) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/32] time 0.163 (0.176) data 0.086 (0.099) loss_x loss_x 0.3303 (0.7702) acc_x 93.7500 (82.5000) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/32] time 0.161 (0.173) data 0.084 (0.096) loss_x loss_x 0.8452 (0.7508) acc_x 81.2500 (82.7083) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/32] time 0.162 (0.171) data 0.085 (0.094) loss_x loss_x 0.2544 (0.7586) acc_x 96.8750 (82.6562) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/32] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.4358 (0.7461) acc_x 81.2500 (82.1250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/32] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.4219 (0.7134) acc_x 84.3750 (82.5000) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/17] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.7769 (0.7427) acc_u 21.8750 (30.6250) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/17] time 0.208 (0.179) data 0.131 (0.102) loss_u loss_u 0.8296 (0.7587) acc_u 18.7500 (28.7500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/17] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.6958 (0.7524) acc_u 37.5000 (29.5833) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 409
confident_label rate tensor(0.6541, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1057
clean true:1055
clean false:2
clean_rate:0.9981078524124882
noisy true:152
noisy false:407
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 559
epoch [65/200] batch [5/33] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.8228 (0.7280) acc_x 75.0000 (79.3750) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/33] time 0.186 (0.186) data 0.110 (0.109) loss_x loss_x 0.6562 (0.7680) acc_x 81.2500 (77.8125) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/33] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.8169 (0.7382) acc_x 78.1250 (79.3750) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/33] time 0.186 (0.185) data 0.109 (0.109) loss_x loss_x 0.5498 (0.6916) acc_x 81.2500 (80.1562) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/33] time 0.186 (0.185) data 0.109 (0.109) loss_x loss_x 0.4412 (0.6811) acc_x 87.5000 (81.1250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [30/33] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.6797 (0.6793) acc_x 84.3750 (81.6667) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/17] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.7041 (0.7438) acc_u 31.2500 (30.0000) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/17] time 0.186 (0.186) data 0.109 (0.109) loss_u loss_u 0.7188 (0.7347) acc_u 31.2500 (30.6250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/17] time 0.161 (0.183) data 0.084 (0.106) loss_u loss_u 0.6680 (0.7304) acc_u 43.7500 (32.5000) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.6343, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1025
clean true:1022
clean false:3
clean_rate:0.9970731707317073
noisy true:141
noisy false:450
after delete: len(clean_dataset) 1025
after delete: len(noisy_dataset) 591
epoch [66/200] batch [5/32] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.8750 (0.8525) acc_x 75.0000 (79.3750) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/32] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.9126 (0.7263) acc_x 78.1250 (80.0000) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/32] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 0.3457 (0.7372) acc_x 87.5000 (80.2083) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/32] time 0.172 (0.174) data 0.095 (0.096) loss_x loss_x 0.7090 (0.7315) acc_x 81.2500 (80.1562) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/32] time 0.184 (0.174) data 0.108 (0.097) loss_x loss_x 0.6523 (0.7170) acc_x 84.3750 (81.0000) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/32] time 0.164 (0.174) data 0.087 (0.097) loss_x loss_x 0.8594 (0.7042) acc_x 78.1250 (81.0417) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/18] time 0.162 (0.172) data 0.085 (0.095) loss_u loss_u 0.7134 (0.6896) acc_u 34.3750 (36.8750) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/18] time 0.184 (0.173) data 0.106 (0.096) loss_u loss_u 0.6519 (0.7088) acc_u 43.7500 (35.9375) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/18] time 0.169 (0.173) data 0.091 (0.096) loss_u loss_u 0.8101 (0.7152) acc_u 25.0000 (33.9583) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 416
confident_label rate tensor(0.6491, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1049
clean true:1047
clean false:2
clean_rate:0.998093422306959
noisy true:153
noisy false:414
after delete: len(clean_dataset) 1049
after delete: len(noisy_dataset) 567
epoch [67/200] batch [5/32] time 0.184 (0.186) data 0.106 (0.109) loss_x loss_x 1.0234 (0.8566) acc_x 75.0000 (78.1250) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/32] time 0.185 (0.183) data 0.109 (0.106) loss_x loss_x 0.8477 (0.8412) acc_x 71.8750 (77.8125) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/32] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6274 (0.7811) acc_x 81.2500 (79.7917) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/32] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.6519 (0.7945) acc_x 78.1250 (79.2188) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [25/32] time 0.186 (0.183) data 0.108 (0.106) loss_x loss_x 0.9268 (0.7882) acc_x 75.0000 (79.0000) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/32] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.9805 (0.7771) acc_x 71.8750 (78.7500) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/17] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.7666 (0.7001) acc_u 28.1250 (35.6250) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/17] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.7515 (0.7272) acc_u 37.5000 (33.1250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/17] time 0.190 (0.184) data 0.113 (0.107) loss_u loss_u 0.6943 (0.7247) acc_u 37.5000 (33.1250) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 447
confident_label rate tensor(0.6380, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1031
clean true:1028
clean false:3
clean_rate:0.997090203685742
noisy true:141
noisy false:444
after delete: len(clean_dataset) 1031
after delete: len(noisy_dataset) 585
epoch [68/200] batch [5/32] time 0.184 (0.188) data 0.106 (0.110) loss_x loss_x 0.8672 (0.7436) acc_x 78.1250 (80.0000) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/32] time 0.187 (0.188) data 0.110 (0.110) loss_x loss_x 0.5454 (0.6746) acc_x 87.5000 (81.2500) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/32] time 0.187 (0.188) data 0.109 (0.111) loss_x loss_x 0.2183 (0.6664) acc_x 100.0000 (82.7083) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [20/32] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.4478 (0.6338) acc_x 84.3750 (83.5938) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/32] time 0.182 (0.188) data 0.106 (0.110) loss_x loss_x 0.7183 (0.6525) acc_x 84.3750 (83.0000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/32] time 0.186 (0.187) data 0.108 (0.110) loss_x loss_x 0.6533 (0.6859) acc_x 84.3750 (82.6042) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/18] time 0.163 (0.184) data 0.086 (0.107) loss_u loss_u 0.8149 (0.7517) acc_u 18.7500 (27.5000) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/18] time 0.186 (0.183) data 0.109 (0.105) loss_u loss_u 0.7373 (0.7319) acc_u 31.2500 (29.6875) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/18] time 0.183 (0.183) data 0.106 (0.105) loss_u loss_u 0.4746 (0.7057) acc_u 62.5000 (34.1667) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.6535, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1056
clean true:1054
clean false:2
clean_rate:0.9981060606060606
noisy true:142
noisy false:418
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 560
epoch [69/200] batch [5/33] time 0.186 (0.189) data 0.108 (0.112) loss_x loss_x 0.3176 (0.5628) acc_x 93.7500 (83.1250) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/33] time 0.176 (0.187) data 0.097 (0.109) loss_x loss_x 0.9902 (0.6949) acc_x 68.7500 (79.0625) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/33] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 0.4551 (0.7120) acc_x 90.6250 (79.7917) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/33] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.6914 (0.7099) acc_x 87.5000 (79.8438) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/33] time 0.178 (0.183) data 0.101 (0.105) loss_x loss_x 0.8418 (0.7006) acc_x 75.0000 (80.1250) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [30/33] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5557 (0.6957) acc_x 90.6250 (80.9375) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/17] time 0.186 (0.186) data 0.109 (0.109) loss_u loss_u 0.7896 (0.6929) acc_u 28.1250 (36.8750) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/17] time 0.187 (0.186) data 0.110 (0.109) loss_u loss_u 0.6729 (0.6995) acc_u 37.5000 (36.8750) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/17] time 0.186 (0.186) data 0.109 (0.109) loss_u loss_u 0.6865 (0.7104) acc_u 37.5000 (35.0000) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 410
confident_label rate tensor(0.6535, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1056
clean true:1053
clean false:3
clean_rate:0.9971590909090909
noisy true:153
noisy false:407
after delete: len(clean_dataset) 1056
after delete: len(noisy_dataset) 560
epoch [70/200] batch [5/33] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.4866 (0.6056) acc_x 90.6250 (83.7500) lr 1.4818e-03 eta 0:00:05
epoch [70/200] batch [10/33] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.6621 (0.7043) acc_x 81.2500 (81.5625) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/33] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.4419 (0.6759) acc_x 87.5000 (81.4583) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/33] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.5747 (0.6812) acc_x 87.5000 (82.3438) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/33] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.8149 (0.6696) acc_x 75.0000 (82.5000) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [30/33] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6562 (0.7188) acc_x 84.3750 (81.0417) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/17] time 0.165 (0.179) data 0.088 (0.102) loss_u loss_u 0.6362 (0.6983) acc_u 43.7500 (35.6250) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/17] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.7202 (0.7026) acc_u 31.2500 (34.6875) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/17] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.8018 (0.7082) acc_u 21.8750 (33.1250) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 399
confident_label rate tensor(0.6603, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1067
clean true:1065
clean false:2
clean_rate:0.9981255857544518
noisy true:152
noisy false:397
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 549
epoch [71/200] batch [5/33] time 0.186 (0.194) data 0.109 (0.118) loss_x loss_x 0.2754 (0.5759) acc_x 93.7500 (84.3750) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/33] time 0.215 (0.193) data 0.138 (0.116) loss_x loss_x 0.4895 (0.5075) acc_x 81.2500 (86.2500) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/33] time 0.202 (0.191) data 0.125 (0.114) loss_x loss_x 0.6323 (0.4990) acc_x 78.1250 (86.4583) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/33] time 0.185 (0.190) data 0.107 (0.112) loss_x loss_x 0.5107 (0.5516) acc_x 90.6250 (85.6250) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/33] time 0.185 (0.189) data 0.106 (0.112) loss_x loss_x 0.5249 (0.5552) acc_x 90.6250 (85.7500) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [30/33] time 0.173 (0.188) data 0.093 (0.110) loss_x loss_x 0.5137 (0.5838) acc_x 93.7500 (85.0000) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/17] time 0.204 (0.197) data 0.126 (0.119) loss_u loss_u 0.6504 (0.7415) acc_u 40.6250 (29.3750) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/17] time 0.163 (0.194) data 0.085 (0.116) loss_u loss_u 0.7358 (0.7244) acc_u 28.1250 (30.3125) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/17] time 0.169 (0.191) data 0.092 (0.114) loss_u loss_u 0.6841 (0.7237) acc_u 31.2500 (30.4167) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 419
confident_label rate tensor(0.6541, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1057
clean true:1053
clean false:4
clean_rate:0.9962157048249763
noisy true:144
noisy false:415
after delete: len(clean_dataset) 1057
after delete: len(noisy_dataset) 559
epoch [72/200] batch [5/33] time 0.184 (0.191) data 0.107 (0.114) loss_x loss_x 0.7246 (0.6171) acc_x 78.1250 (82.5000) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/33] time 0.292 (0.201) data 0.105 (0.112) loss_x loss_x 0.5161 (0.6355) acc_x 87.5000 (83.4375) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/33] time 0.188 (0.198) data 0.111 (0.113) loss_x loss_x 0.4590 (0.6088) acc_x 84.3750 (83.7500) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/33] time 0.185 (0.195) data 0.107 (0.112) loss_x loss_x 0.9053 (0.6109) acc_x 81.2500 (84.0625) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [25/33] time 0.181 (0.194) data 0.104 (0.112) loss_x loss_x 0.4058 (0.6169) acc_x 87.5000 (84.1250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [30/33] time 0.204 (0.193) data 0.127 (0.112) loss_x loss_x 0.4678 (0.6296) acc_x 87.5000 (83.8542) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/17] time 0.183 (0.192) data 0.107 (0.112) loss_u loss_u 0.7271 (0.6922) acc_u 34.3750 (37.5000) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/17] time 0.190 (0.192) data 0.113 (0.112) loss_u loss_u 0.7974 (0.7089) acc_u 31.2500 (35.6250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/17] time 0.160 (0.193) data 0.084 (0.110) loss_u loss_u 0.8457 (0.7262) acc_u 18.7500 (32.9167) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 415
confident_label rate tensor(0.6528, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1055
clean true:1052
clean false:3
clean_rate:0.9971563981042654
noisy true:149
noisy false:412
after delete: len(clean_dataset) 1055
after delete: len(noisy_dataset) 561
epoch [73/200] batch [5/32] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.5771 (0.6183) acc_x 81.2500 (83.1250) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [10/32] time 0.181 (0.181) data 0.104 (0.105) loss_x loss_x 0.6113 (0.6135) acc_x 81.2500 (84.0625) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/32] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 1.0781 (0.6527) acc_x 81.2500 (83.3333) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/32] time 0.190 (0.190) data 0.114 (0.106) loss_x loss_x 0.3455 (0.6279) acc_x 96.8750 (83.7500) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/32] time 0.183 (0.189) data 0.107 (0.106) loss_x loss_x 0.4331 (0.6282) acc_x 90.6250 (83.5000) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [30/32] time 0.170 (0.186) data 0.094 (0.104) loss_x loss_x 0.7671 (0.6520) acc_x 71.8750 (82.2917) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/17] time 0.182 (0.183) data 0.105 (0.102) loss_u loss_u 0.5239 (0.6858) acc_u 50.0000 (36.2500) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/17] time 0.186 (0.182) data 0.109 (0.102) loss_u loss_u 0.6909 (0.7215) acc_u 37.5000 (31.8750) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/17] time 0.193 (0.182) data 0.114 (0.102) loss_u loss_u 0.5400 (0.7082) acc_u 53.1250 (34.3750) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 413
confident_label rate tensor(0.6547, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1058
clean true:1056
clean false:2
clean_rate:0.998109640831758
noisy true:147
noisy false:411
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 558
epoch [74/200] batch [5/33] time 0.163 (0.160) data 0.087 (0.083) loss_x loss_x 0.7554 (0.5944) acc_x 78.1250 (82.5000) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/33] time 0.160 (0.160) data 0.083 (0.083) loss_x loss_x 0.4885 (0.5879) acc_x 87.5000 (83.7500) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/33] time 0.201 (0.170) data 0.083 (0.083) loss_x loss_x 0.6562 (0.6114) acc_x 84.3750 (83.5417) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/33] time 0.161 (0.167) data 0.085 (0.083) loss_x loss_x 0.5508 (0.6236) acc_x 90.6250 (83.2812) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/33] time 0.161 (0.165) data 0.084 (0.083) loss_x loss_x 0.2455 (0.6092) acc_x 96.8750 (83.7500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [30/33] time 0.162 (0.164) data 0.084 (0.083) loss_x loss_x 0.4192 (0.6112) acc_x 90.6250 (83.7500) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/17] time 0.189 (0.166) data 0.112 (0.085) loss_u loss_u 0.6772 (0.7373) acc_u 34.3750 (29.3750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/17] time 0.209 (0.169) data 0.132 (0.087) loss_u loss_u 0.6982 (0.7358) acc_u 31.2500 (30.0000) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/17] time 0.168 (0.170) data 0.091 (0.088) loss_u loss_u 0.7080 (0.7379) acc_u 34.3750 (29.7917) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 431
confident_label rate tensor(0.6442, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1041
clean true:1038
clean false:3
clean_rate:0.9971181556195965
noisy true:147
noisy false:428
after delete: len(clean_dataset) 1041
after delete: len(noisy_dataset) 575
epoch [75/200] batch [5/32] time 0.165 (0.181) data 0.087 (0.104) loss_x loss_x 0.3770 (0.6264) acc_x 90.6250 (83.7500) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/32] time 0.181 (0.179) data 0.105 (0.102) loss_x loss_x 0.7646 (0.6271) acc_x 81.2500 (83.4375) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/32] time 0.219 (0.194) data 0.141 (0.109) loss_x loss_x 0.5386 (0.6160) acc_x 78.1250 (83.7500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/32] time 0.186 (0.190) data 0.109 (0.107) loss_x loss_x 0.8799 (0.6874) acc_x 78.1250 (82.3438) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/32] time 0.188 (0.189) data 0.109 (0.107) loss_x loss_x 0.5884 (0.6711) acc_x 84.3750 (82.6250) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [30/32] time 0.186 (0.189) data 0.110 (0.107) loss_x loss_x 0.8306 (0.6624) acc_x 81.2500 (83.0208) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/17] time 0.184 (0.188) data 0.107 (0.107) loss_u loss_u 0.7617 (0.7299) acc_u 28.1250 (31.8750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/17] time 0.185 (0.188) data 0.109 (0.107) loss_u loss_u 0.7832 (0.7257) acc_u 28.1250 (32.5000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/17] time 0.293 (0.190) data 0.109 (0.108) loss_u loss_u 0.7090 (0.7279) acc_u 34.3750 (31.6667) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 413
confident_label rate tensor(0.6522, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1054
clean true:1053
clean false:1
clean_rate:0.9990512333965844
noisy true:150
noisy false:412
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 562
epoch [76/200] batch [5/32] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.5376 (0.5413) acc_x 87.5000 (88.7500) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/32] time 0.199 (0.186) data 0.097 (0.107) loss_x loss_x 0.5815 (0.5969) acc_x 84.3750 (86.5625) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/32] time 0.176 (0.187) data 0.099 (0.101) loss_x loss_x 0.9072 (0.6369) acc_x 75.0000 (84.7917) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/32] time 0.169 (0.182) data 0.092 (0.098) loss_x loss_x 0.7466 (0.6182) acc_x 68.7500 (83.9062) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/32] time 0.184 (0.183) data 0.107 (0.100) loss_x loss_x 0.7002 (0.6188) acc_x 84.3750 (83.7500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/32] time 0.162 (0.180) data 0.084 (0.098) loss_x loss_x 0.8345 (0.6368) acc_x 81.2500 (83.5417) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/17] time 0.161 (0.177) data 0.083 (0.096) loss_u loss_u 0.7261 (0.6909) acc_u 31.2500 (36.2500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/17] time 0.160 (0.175) data 0.083 (0.095) loss_u loss_u 0.8076 (0.6981) acc_u 21.8750 (35.9375) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/17] time 0.183 (0.178) data 0.105 (0.096) loss_u loss_u 0.6367 (0.7051) acc_u 46.8750 (35.8333) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 406
confident_label rate tensor(0.6566, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1061
clean true:1059
clean false:2
clean_rate:0.998114985862394
noisy true:151
noisy false:404
after delete: len(clean_dataset) 1061
after delete: len(noisy_dataset) 555
epoch [77/200] batch [5/33] time 0.227 (0.188) data 0.119 (0.105) loss_x loss_x 0.3911 (0.7283) acc_x 90.6250 (79.3750) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/33] time 0.186 (0.196) data 0.108 (0.109) loss_x loss_x 0.8057 (0.6967) acc_x 71.8750 (80.3125) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/33] time 0.184 (0.195) data 0.107 (0.111) loss_x loss_x 0.3020 (0.6335) acc_x 93.7500 (82.2917) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/33] time 0.178 (0.192) data 0.100 (0.110) loss_x loss_x 0.7520 (0.6547) acc_x 84.3750 (81.7188) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/33] time 0.168 (0.188) data 0.090 (0.107) loss_x loss_x 0.3391 (0.6558) acc_x 90.6250 (82.2500) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/33] time 0.158 (0.184) data 0.082 (0.103) loss_x loss_x 0.6509 (0.6874) acc_x 81.2500 (81.5625) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/17] time 0.162 (0.182) data 0.084 (0.099) loss_u loss_u 0.6206 (0.6590) acc_u 46.8750 (40.0000) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/17] time 0.161 (0.180) data 0.085 (0.097) loss_u loss_u 0.8047 (0.7074) acc_u 21.8750 (34.0625) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/17] time 0.162 (0.178) data 0.084 (0.096) loss_u loss_u 0.7310 (0.7073) acc_u 31.2500 (34.3750) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.6522, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1054
clean true:1049
clean false:5
clean_rate:0.9952561669829222
noisy true:145
noisy false:417
after delete: len(clean_dataset) 1054
after delete: len(noisy_dataset) 562
epoch [78/200] batch [5/32] time 0.175 (0.168) data 0.098 (0.091) loss_x loss_x 0.7129 (0.6103) acc_x 81.2500 (83.7500) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [10/32] time 0.168 (0.181) data 0.090 (0.093) loss_x loss_x 0.8438 (0.7048) acc_x 81.2500 (82.1875) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/32] time 0.175 (0.178) data 0.098 (0.094) loss_x loss_x 0.4158 (0.6708) acc_x 84.3750 (81.8750) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/32] time 0.184 (0.178) data 0.107 (0.095) loss_x loss_x 0.7017 (0.6444) acc_x 84.3750 (83.7500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/32] time 0.170 (0.176) data 0.092 (0.095) loss_x loss_x 0.7046 (0.6538) acc_x 81.2500 (83.2500) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [30/32] time 0.184 (0.178) data 0.105 (0.097) loss_x loss_x 0.5400 (0.6420) acc_x 90.6250 (83.4375) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/17] time 0.172 (0.178) data 0.094 (0.098) loss_u loss_u 0.7051 (0.6636) acc_u 34.3750 (40.6250) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/17] time 0.213 (0.178) data 0.134 (0.099) loss_u loss_u 0.7314 (0.6981) acc_u 25.0000 (34.3750) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/17] time 0.170 (0.182) data 0.092 (0.100) loss_u loss_u 0.7476 (0.7169) acc_u 37.5000 (33.1250) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 423
confident_label rate tensor(0.6467, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1045
clean true:1041
clean false:4
clean_rate:0.9961722488038277
noisy true:152
noisy false:419
after delete: len(clean_dataset) 1045
after delete: len(noisy_dataset) 571
epoch [79/200] batch [5/32] time 0.160 (0.158) data 0.083 (0.081) loss_x loss_x 0.7783 (0.5642) acc_x 81.2500 (85.6250) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/32] time 0.260 (0.173) data 0.082 (0.081) loss_x loss_x 0.8306 (0.6665) acc_x 81.2500 (82.8125) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/32] time 0.159 (0.169) data 0.082 (0.082) loss_x loss_x 0.4834 (0.6091) acc_x 90.6250 (85.0000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/32] time 0.158 (0.166) data 0.081 (0.082) loss_x loss_x 0.8354 (0.6676) acc_x 81.2500 (83.1250) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [25/32] time 0.161 (0.165) data 0.084 (0.082) loss_x loss_x 1.2070 (0.7114) acc_x 75.0000 (81.8750) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [30/32] time 0.191 (0.167) data 0.114 (0.085) loss_x loss_x 0.4373 (0.7010) acc_x 87.5000 (81.5625) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/17] time 0.161 (0.171) data 0.084 (0.088) loss_u loss_u 0.6191 (0.6740) acc_u 43.7500 (35.6250) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/17] time 0.185 (0.173) data 0.106 (0.090) loss_u loss_u 0.8145 (0.6935) acc_u 18.7500 (34.0625) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/17] time 0.202 (0.175) data 0.124 (0.093) loss_u loss_u 0.7441 (0.7052) acc_u 31.2500 (33.7500) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.6516, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1053
clean true:1050
clean false:3
clean_rate:0.9971509971509972
noisy true:141
noisy false:422
after delete: len(clean_dataset) 1053
after delete: len(noisy_dataset) 563
epoch [80/200] batch [5/32] time 0.252 (0.184) data 0.094 (0.091) loss_x loss_x 0.3198 (0.6082) acc_x 90.6250 (82.5000) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/32] time 0.157 (0.186) data 0.080 (0.094) loss_x loss_x 0.4807 (0.5847) acc_x 93.7500 (84.6875) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/32] time 0.184 (0.185) data 0.108 (0.098) loss_x loss_x 0.5293 (0.6194) acc_x 90.6250 (84.1667) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/32] time 0.172 (0.184) data 0.094 (0.099) loss_x loss_x 0.4856 (0.6329) acc_x 90.6250 (83.9062) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/32] time 0.185 (0.183) data 0.108 (0.100) loss_x loss_x 0.6255 (0.6129) acc_x 87.5000 (84.6250) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/32] time 0.183 (0.183) data 0.107 (0.101) loss_x loss_x 0.8735 (0.6330) acc_x 75.0000 (83.5417) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/17] time 0.186 (0.183) data 0.108 (0.102) loss_u loss_u 0.7100 (0.6828) acc_u 34.3750 (40.0000) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/17] time 0.298 (0.186) data 0.105 (0.103) loss_u loss_u 0.6934 (0.7178) acc_u 34.3750 (34.6875) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/17] time 0.206 (0.186) data 0.129 (0.104) loss_u loss_u 0.6768 (0.7217) acc_u 37.5000 (33.3333) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 385
confident_label rate tensor(0.6689, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1081
clean true:1076
clean false:5
clean_rate:0.9953746530989824
noisy true:155
noisy false:380
after delete: len(clean_dataset) 1081
after delete: len(noisy_dataset) 535
epoch [81/200] batch [5/33] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.5347 (0.6572) acc_x 84.3750 (83.7500) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/33] time 0.193 (0.192) data 0.116 (0.104) loss_x loss_x 0.5967 (0.6425) acc_x 87.5000 (85.0000) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [15/33] time 0.186 (0.186) data 0.110 (0.102) loss_x loss_x 1.1416 (0.6784) acc_x 71.8750 (84.3750) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/33] time 0.177 (0.182) data 0.099 (0.099) loss_x loss_x 0.9004 (0.6731) acc_x 71.8750 (82.9688) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/33] time 0.164 (0.179) data 0.087 (0.098) loss_x loss_x 0.9058 (0.6552) acc_x 75.0000 (83.3750) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [30/33] time 0.164 (0.178) data 0.086 (0.098) loss_x loss_x 0.4937 (0.6453) acc_x 87.5000 (83.7500) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/16] time 0.170 (0.178) data 0.093 (0.098) loss_u loss_u 0.7764 (0.7624) acc_u 31.2500 (29.3750) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [10/16] time 0.181 (0.177) data 0.104 (0.098) loss_u loss_u 0.6655 (0.7208) acc_u 34.3750 (32.8125) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/16] time 0.161 (0.180) data 0.082 (0.097) loss_u loss_u 0.5552 (0.7011) acc_u 56.2500 (35.2083) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 407
confident_label rate tensor(0.6547, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1058
clean true:1055
clean false:3
clean_rate:0.997164461247637
noisy true:154
noisy false:404
after delete: len(clean_dataset) 1058
after delete: len(noisy_dataset) 558
epoch [82/200] batch [5/33] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.6987 (0.5873) acc_x 81.2500 (85.0000) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [10/33] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 0.7949 (0.6021) acc_x 81.2500 (85.0000) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/33] time 0.183 (0.180) data 0.106 (0.104) loss_x loss_x 0.4268 (0.6477) acc_x 90.6250 (84.1667) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/33] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.5767 (0.6500) acc_x 81.2500 (84.2188) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/33] time 0.292 (0.186) data 0.106 (0.105) loss_x loss_x 0.6743 (0.6729) acc_x 78.1250 (83.7500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [30/33] time 0.205 (0.187) data 0.128 (0.106) loss_x loss_x 0.9043 (0.6888) acc_x 78.1250 (83.2292) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/17] time 0.163 (0.184) data 0.085 (0.104) loss_u loss_u 0.6787 (0.6921) acc_u 37.5000 (34.3750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/17] time 0.161 (0.181) data 0.083 (0.101) loss_u loss_u 0.7720 (0.6995) acc_u 25.0000 (34.6875) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/17] time 0.185 (0.180) data 0.108 (0.101) loss_u loss_u 0.7256 (0.6978) acc_u 34.3750 (35.0000) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 409
confident_label rate tensor(0.6590, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1065
clean true:1064
clean false:1
clean_rate:0.9990610328638497
noisy true:143
noisy false:408
after delete: len(clean_dataset) 1065
after delete: len(noisy_dataset) 551
epoch [83/200] batch [5/33] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7856 (0.6973) acc_x 71.8750 (78.1250) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/33] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.3491 (0.6582) acc_x 93.7500 (81.5625) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/33] time 0.190 (0.186) data 0.114 (0.109) loss_x loss_x 0.7471 (0.6884) acc_x 84.3750 (81.4583) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/33] time 0.159 (0.183) data 0.082 (0.106) loss_x loss_x 0.4773 (0.6862) acc_x 87.5000 (81.5625) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/33] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.2739 (0.6311) acc_x 93.7500 (83.2500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [30/33] time 0.185 (0.180) data 0.108 (0.104) loss_x loss_x 0.9160 (0.6366) acc_x 78.1250 (83.0208) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/17] time 0.185 (0.184) data 0.108 (0.104) loss_u loss_u 0.7515 (0.7232) acc_u 28.1250 (32.5000) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/17] time 0.183 (0.184) data 0.104 (0.105) loss_u loss_u 0.7568 (0.7050) acc_u 31.2500 (34.3750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/17] time 0.183 (0.185) data 0.105 (0.106) loss_u loss_u 0.6494 (0.7082) acc_u 37.5000 (33.3333) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 408
confident_label rate tensor(0.6584, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1064
clean true:1063
clean false:1
clean_rate:0.9990601503759399
noisy true:145
noisy false:407
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 552
epoch [84/200] batch [5/33] time 0.185 (0.191) data 0.107 (0.114) loss_x loss_x 0.6709 (0.5667) acc_x 81.2500 (82.5000) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/33] time 0.184 (0.192) data 0.107 (0.110) loss_x loss_x 1.2764 (0.5990) acc_x 68.7500 (85.0000) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/33] time 0.181 (0.189) data 0.104 (0.109) loss_x loss_x 0.9585 (0.5683) acc_x 75.0000 (84.7917) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/33] time 0.161 (0.184) data 0.084 (0.105) loss_x loss_x 0.6587 (0.5884) acc_x 84.3750 (84.5312) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/33] time 0.173 (0.184) data 0.095 (0.101) loss_x loss_x 0.2421 (0.5705) acc_x 90.6250 (85.0000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [30/33] time 0.182 (0.187) data 0.105 (0.105) loss_x loss_x 0.4465 (0.6098) acc_x 87.5000 (84.6875) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/17] time 0.190 (0.186) data 0.111 (0.105) loss_u loss_u 0.7725 (0.7522) acc_u 25.0000 (28.1250) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [10/17] time 0.176 (0.186) data 0.099 (0.105) loss_u loss_u 0.6709 (0.7556) acc_u 34.3750 (26.8750) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/17] time 0.171 (0.187) data 0.094 (0.104) loss_u loss_u 0.6309 (0.7112) acc_u 50.0000 (33.1250) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 390
confident_label rate tensor(0.6621, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1070
clean true:1070
clean false:0
clean_rate:1.0
noisy true:156
noisy false:390
after delete: len(clean_dataset) 1070
after delete: len(noisy_dataset) 546
epoch [85/200] batch [5/33] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.7407 (0.6806) acc_x 78.1250 (80.6250) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/33] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.6060 (0.6406) acc_x 81.2500 (81.8750) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/33] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.3818 (0.6431) acc_x 84.3750 (81.8750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/33] time 0.202 (0.183) data 0.125 (0.106) loss_x loss_x 0.8335 (0.6700) acc_x 78.1250 (80.9375) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/33] time 0.163 (0.190) data 0.086 (0.105) loss_x loss_x 0.5737 (0.6559) acc_x 84.3750 (81.3750) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [30/33] time 0.165 (0.186) data 0.088 (0.102) loss_x loss_x 0.8525 (0.6363) acc_x 75.0000 (81.9792) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/17] time 0.194 (0.185) data 0.117 (0.102) loss_u loss_u 0.6826 (0.6853) acc_u 37.5000 (36.8750) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/17] time 0.183 (0.185) data 0.106 (0.103) loss_u loss_u 0.7310 (0.6739) acc_u 28.1250 (37.5000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/17] time 0.186 (0.186) data 0.108 (0.104) loss_u loss_u 0.8135 (0.6965) acc_u 18.7500 (34.1667) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 390
confident_label rate tensor(0.6603, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1067
clean true:1064
clean false:3
clean_rate:0.9971883786316776
noisy true:162
noisy false:387
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 549
epoch [86/200] batch [5/33] time 0.234 (0.216) data 0.157 (0.105) loss_x loss_x 0.4812 (0.4902) acc_x 87.5000 (88.1250) lr 1.2487e-03 eta 0:00:06
epoch [86/200] batch [10/33] time 0.183 (0.200) data 0.106 (0.106) loss_x loss_x 0.7822 (0.5789) acc_x 87.5000 (86.2500) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/33] time 0.183 (0.194) data 0.107 (0.106) loss_x loss_x 0.2988 (0.5471) acc_x 93.7500 (86.4583) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [20/33] time 0.181 (0.191) data 0.104 (0.106) loss_x loss_x 0.7476 (0.5884) acc_x 81.2500 (85.1562) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/33] time 0.186 (0.190) data 0.109 (0.106) loss_x loss_x 0.2542 (0.5808) acc_x 93.7500 (85.2500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [30/33] time 0.182 (0.189) data 0.105 (0.106) loss_x loss_x 0.9185 (0.5868) acc_x 78.1250 (85.4167) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/17] time 0.183 (0.187) data 0.105 (0.106) loss_u loss_u 0.6812 (0.7002) acc_u 40.6250 (36.8750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/17] time 0.186 (0.191) data 0.109 (0.106) loss_u loss_u 0.6099 (0.7048) acc_u 50.0000 (36.5625) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/17] time 0.206 (0.191) data 0.128 (0.107) loss_u loss_u 0.7085 (0.7107) acc_u 31.2500 (35.0000) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.6627, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1071
clean true:1066
clean false:5
clean_rate:0.9953314659197012
noisy true:146
noisy false:399
after delete: len(clean_dataset) 1071
after delete: len(noisy_dataset) 545
epoch [87/200] batch [5/33] time 0.160 (0.183) data 0.083 (0.084) loss_x loss_x 0.6748 (0.6350) acc_x 78.1250 (82.5000) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/33] time 0.157 (0.171) data 0.080 (0.083) loss_x loss_x 0.3848 (0.5709) acc_x 87.5000 (85.6250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [15/33] time 0.156 (0.166) data 0.080 (0.082) loss_x loss_x 0.2700 (0.5792) acc_x 93.7500 (85.2083) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/33] time 0.185 (0.168) data 0.108 (0.086) loss_x loss_x 0.4824 (0.5760) acc_x 84.3750 (84.8438) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/33] time 0.186 (0.172) data 0.108 (0.090) loss_x loss_x 0.7188 (0.5943) acc_x 84.3750 (84.6250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [30/33] time 0.173 (0.173) data 0.096 (0.093) loss_x loss_x 0.3931 (0.5708) acc_x 93.7500 (85.0000) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/17] time 0.179 (0.178) data 0.102 (0.096) loss_u loss_u 0.7549 (0.7242) acc_u 28.1250 (34.3750) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/17] time 0.193 (0.179) data 0.115 (0.097) loss_u loss_u 0.5576 (0.7038) acc_u 50.0000 (36.2500) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/17] time 0.164 (0.178) data 0.088 (0.096) loss_u loss_u 0.6592 (0.7124) acc_u 34.3750 (33.9583) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 374
confident_label rate tensor(0.6726, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1087
clean true:1085
clean false:2
clean_rate:0.9981600735970562
noisy true:157
noisy false:372
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 529
epoch [88/200] batch [5/33] time 0.174 (0.191) data 0.096 (0.113) loss_x loss_x 0.3628 (0.4660) acc_x 87.5000 (86.8750) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/33] time 0.177 (0.183) data 0.100 (0.106) loss_x loss_x 0.5703 (0.4964) acc_x 84.3750 (86.5625) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/33] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.5317 (0.5366) acc_x 81.2500 (84.7917) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/33] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.6787 (0.5845) acc_x 87.5000 (83.9062) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/33] time 0.163 (0.175) data 0.086 (0.098) loss_x loss_x 0.5430 (0.6169) acc_x 81.2500 (82.6250) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [30/33] time 0.184 (0.176) data 0.106 (0.099) loss_x loss_x 0.4043 (0.6175) acc_x 93.7500 (83.2292) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/16] time 0.187 (0.182) data 0.110 (0.101) loss_u loss_u 0.7026 (0.6928) acc_u 34.3750 (36.8750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/16] time 0.185 (0.184) data 0.107 (0.102) loss_u loss_u 0.8306 (0.7304) acc_u 12.5000 (32.8125) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/16] time 0.185 (0.184) data 0.108 (0.103) loss_u loss_u 0.7544 (0.7063) acc_u 25.0000 (34.3750) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 402
confident_label rate tensor(0.6584, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1064
clean true:1060
clean false:4
clean_rate:0.9962406015037594
noisy true:154
noisy false:398
after delete: len(clean_dataset) 1064
after delete: len(noisy_dataset) 552
epoch [89/200] batch [5/33] time 0.176 (0.168) data 0.099 (0.091) loss_x loss_x 0.4407 (0.7163) acc_x 84.3750 (78.1250) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [10/33] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 0.6938 (0.6245) acc_x 87.5000 (82.8125) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/33] time 0.200 (0.188) data 0.124 (0.103) loss_x loss_x 1.0225 (0.6491) acc_x 65.6250 (81.8750) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/33] time 0.160 (0.182) data 0.084 (0.099) loss_x loss_x 0.6006 (0.6098) acc_x 84.3750 (82.8125) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/33] time 0.181 (0.181) data 0.105 (0.099) loss_x loss_x 0.5811 (0.5975) acc_x 81.2500 (83.1250) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [30/33] time 0.199 (0.182) data 0.122 (0.101) loss_x loss_x 0.8062 (0.6135) acc_x 81.2500 (82.7083) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/17] time 0.181 (0.183) data 0.105 (0.102) loss_u loss_u 0.7236 (0.7570) acc_u 31.2500 (27.5000) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/17] time 0.185 (0.183) data 0.106 (0.103) loss_u loss_u 0.7241 (0.7062) acc_u 31.2500 (32.8125) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/17] time 0.171 (0.181) data 0.093 (0.102) loss_u loss_u 0.6694 (0.7032) acc_u 37.5000 (33.5417) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 381
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1098
clean true:1092
clean false:6
clean_rate:0.994535519125683
noisy true:143
noisy false:375
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 518
epoch [90/200] batch [5/34] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.6738 (0.8251) acc_x 78.1250 (79.3750) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/34] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.9775 (0.8933) acc_x 75.0000 (75.9375) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/34] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.5566 (0.7896) acc_x 84.3750 (78.7500) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/34] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.9087 (0.7463) acc_x 87.5000 (80.6250) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/34] time 0.207 (0.194) data 0.131 (0.109) loss_x loss_x 0.5469 (0.7066) acc_x 90.6250 (81.3750) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [30/34] time 0.182 (0.192) data 0.105 (0.109) loss_x loss_x 0.3047 (0.7038) acc_x 93.7500 (81.7708) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/16] time 0.183 (0.190) data 0.106 (0.108) loss_u loss_u 0.7339 (0.7222) acc_u 25.0000 (30.6250) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/16] time 0.196 (0.190) data 0.119 (0.109) loss_u loss_u 0.7319 (0.7304) acc_u 31.2500 (30.3125) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/16] time 0.217 (0.191) data 0.140 (0.110) loss_u loss_u 0.6377 (0.7176) acc_u 43.7500 (32.2917) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 406
confident_label rate tensor(0.6603, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1067
clean true:1063
clean false:4
clean_rate:0.9962511715089035
noisy true:147
noisy false:402
after delete: len(clean_dataset) 1067
after delete: len(noisy_dataset) 549
epoch [91/200] batch [5/33] time 0.184 (0.190) data 0.108 (0.113) loss_x loss_x 1.1738 (0.6826) acc_x 71.8750 (84.3750) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/33] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 0.4575 (0.7634) acc_x 90.6250 (82.1875) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/33] time 0.185 (0.188) data 0.109 (0.111) loss_x loss_x 0.4114 (0.7102) acc_x 84.3750 (83.5417) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/33] time 0.168 (0.185) data 0.091 (0.108) loss_x loss_x 0.6675 (0.7091) acc_x 87.5000 (83.2812) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/33] time 0.160 (0.181) data 0.082 (0.104) loss_x loss_x 0.5220 (0.6555) acc_x 84.3750 (84.6250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [30/33] time 0.159 (0.178) data 0.082 (0.101) loss_x loss_x 0.8467 (0.6429) acc_x 78.1250 (84.7917) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/17] time 0.167 (0.182) data 0.089 (0.100) loss_u loss_u 0.7798 (0.7358) acc_u 21.8750 (29.3750) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/17] time 0.162 (0.180) data 0.085 (0.098) loss_u loss_u 0.5342 (0.6861) acc_u 56.2500 (35.9375) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/17] time 0.169 (0.179) data 0.091 (0.097) loss_u loss_u 0.7212 (0.7056) acc_u 34.3750 (34.3750) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 393
confident_label rate tensor(0.6665, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1077
clean true:1073
clean false:4
clean_rate:0.9962859795728877
noisy true:150
noisy false:389
after delete: len(clean_dataset) 1077
after delete: len(noisy_dataset) 539
epoch [92/200] batch [5/33] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.6440 (0.7279) acc_x 84.3750 (81.8750) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/33] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.5806 (0.6558) acc_x 81.2500 (82.1875) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/33] time 0.183 (0.193) data 0.106 (0.107) loss_x loss_x 0.7656 (0.6222) acc_x 84.3750 (83.5417) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [20/33] time 0.184 (0.192) data 0.107 (0.107) loss_x loss_x 0.4734 (0.5971) acc_x 87.5000 (84.0625) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/33] time 0.186 (0.190) data 0.109 (0.107) loss_x loss_x 0.6406 (0.5848) acc_x 78.1250 (84.3750) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [30/33] time 0.182 (0.189) data 0.106 (0.107) loss_x loss_x 0.8691 (0.5771) acc_x 78.1250 (84.2708) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/16] time 0.185 (0.188) data 0.107 (0.107) loss_u loss_u 0.6733 (0.7577) acc_u 40.6250 (27.5000) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/16] time 0.195 (0.188) data 0.116 (0.108) loss_u loss_u 0.6714 (0.7057) acc_u 37.5000 (33.1250) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [15/16] time 0.185 (0.189) data 0.107 (0.108) loss_u loss_u 0.6562 (0.7065) acc_u 46.8750 (33.7500) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 396
confident_label rate tensor(0.6652, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1075
clean true:1071
clean false:4
clean_rate:0.9962790697674418
noisy true:149
noisy false:392
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 541
epoch [93/200] batch [5/33] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.4695 (0.6469) acc_x 87.5000 (81.8750) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/33] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.8081 (0.6412) acc_x 78.1250 (81.8750) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/33] time 0.181 (0.184) data 0.105 (0.106) loss_x loss_x 0.6162 (0.6171) acc_x 84.3750 (82.7083) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/33] time 0.295 (0.191) data 0.110 (0.107) loss_x loss_x 0.3269 (0.5721) acc_x 93.7500 (83.5938) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/33] time 0.276 (0.196) data 0.199 (0.112) loss_x loss_x 0.4785 (0.5979) acc_x 87.5000 (83.5000) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [30/33] time 0.181 (0.196) data 0.104 (0.114) loss_x loss_x 0.7388 (0.6135) acc_x 84.3750 (83.2292) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/16] time 0.163 (0.194) data 0.084 (0.113) loss_u loss_u 0.7563 (0.6957) acc_u 31.2500 (35.6250) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/16] time 0.192 (0.193) data 0.114 (0.112) loss_u loss_u 0.7231 (0.6966) acc_u 28.1250 (35.0000) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/16] time 0.171 (0.192) data 0.093 (0.111) loss_u loss_u 0.6973 (0.6984) acc_u 28.1250 (35.4167) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 388
confident_label rate tensor(0.6708, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1084
clean true:1081
clean false:3
clean_rate:0.9972324723247232
noisy true:147
noisy false:385
after delete: len(clean_dataset) 1084
after delete: len(noisy_dataset) 532
epoch [94/200] batch [5/33] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.3613 (0.6269) acc_x 90.6250 (86.8750) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/33] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.3621 (0.4897) acc_x 87.5000 (89.0625) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/33] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.3538 (0.4609) acc_x 90.6250 (89.1667) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/33] time 0.181 (0.194) data 0.104 (0.112) loss_x loss_x 0.5742 (0.5433) acc_x 84.3750 (86.7188) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/33] time 0.186 (0.192) data 0.109 (0.111) loss_x loss_x 0.3279 (0.5474) acc_x 93.7500 (86.5000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/33] time 0.184 (0.191) data 0.108 (0.110) loss_x loss_x 0.8320 (0.5419) acc_x 78.1250 (86.3542) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/16] time 0.200 (0.189) data 0.123 (0.109) loss_u loss_u 0.6514 (0.6962) acc_u 40.6250 (36.2500) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/16] time 0.187 (0.188) data 0.109 (0.109) loss_u loss_u 0.7090 (0.7027) acc_u 31.2500 (33.7500) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [15/16] time 0.160 (0.188) data 0.083 (0.109) loss_u loss_u 0.7207 (0.7114) acc_u 28.1250 (32.7083) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 386
confident_label rate tensor(0.6696, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1082
clean true:1078
clean false:4
clean_rate:0.9963031423290203
noisy true:152
noisy false:382
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 534
epoch [95/200] batch [5/33] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.9146 (0.5260) acc_x 71.8750 (85.6250) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/33] time 0.186 (0.195) data 0.110 (0.108) loss_x loss_x 0.5381 (0.4967) acc_x 78.1250 (85.3125) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/33] time 0.184 (0.191) data 0.107 (0.107) loss_x loss_x 0.4099 (0.5367) acc_x 87.5000 (84.5833) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/33] time 0.187 (0.188) data 0.110 (0.106) loss_x loss_x 0.7783 (0.5337) acc_x 75.0000 (84.3750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/33] time 0.185 (0.184) data 0.109 (0.103) loss_x loss_x 0.3914 (0.5456) acc_x 90.6250 (84.6250) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [30/33] time 0.183 (0.182) data 0.106 (0.102) loss_x loss_x 0.4470 (0.5674) acc_x 87.5000 (83.9583) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/16] time 0.164 (0.180) data 0.088 (0.100) loss_u loss_u 0.7529 (0.7591) acc_u 34.3750 (30.0000) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [10/16] time 0.158 (0.179) data 0.081 (0.099) loss_u loss_u 0.6182 (0.7448) acc_u 46.8750 (31.8750) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/16] time 0.197 (0.183) data 0.120 (0.100) loss_u loss_u 0.7212 (0.7258) acc_u 28.1250 (33.5417) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 395
confident_label rate tensor(0.6702, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1083
clean true:1079
clean false:4
clean_rate:0.9963065558633426
noisy true:142
noisy false:391
after delete: len(clean_dataset) 1083
after delete: len(noisy_dataset) 533
epoch [96/200] batch [5/33] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 1.2910 (0.8155) acc_x 65.6250 (76.8750) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/33] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6689 (0.7715) acc_x 78.1250 (78.4375) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/33] time 0.201 (0.186) data 0.124 (0.109) loss_x loss_x 0.9663 (0.7259) acc_x 81.2500 (81.4583) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/33] time 0.159 (0.183) data 0.082 (0.107) loss_x loss_x 0.6992 (0.6792) acc_x 78.1250 (82.8125) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/33] time 0.185 (0.188) data 0.108 (0.107) loss_x loss_x 1.0430 (0.7143) acc_x 81.2500 (81.6250) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/33] time 0.184 (0.187) data 0.107 (0.107) loss_x loss_x 0.2708 (0.6661) acc_x 96.8750 (82.9167) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/16] time 0.187 (0.187) data 0.109 (0.107) loss_u loss_u 0.6108 (0.6685) acc_u 50.0000 (40.6250) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/16] time 0.160 (0.185) data 0.081 (0.105) loss_u loss_u 0.5835 (0.6797) acc_u 53.1250 (37.8125) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/16] time 0.161 (0.182) data 0.083 (0.103) loss_u loss_u 0.6943 (0.6981) acc_u 31.2500 (35.2083) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 389
confident_label rate tensor(0.6652, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1075
clean true:1071
clean false:4
clean_rate:0.9962790697674418
noisy true:156
noisy false:385
after delete: len(clean_dataset) 1075
after delete: len(noisy_dataset) 541
epoch [97/200] batch [5/33] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.4636 (0.6564) acc_x 87.5000 (83.1250) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/33] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.8550 (0.6621) acc_x 84.3750 (83.7500) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/33] time 0.168 (0.178) data 0.090 (0.101) loss_x loss_x 0.8145 (0.6511) acc_x 81.2500 (83.7500) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/33] time 0.180 (0.177) data 0.104 (0.100) loss_x loss_x 0.2690 (0.6343) acc_x 96.8750 (84.0625) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/33] time 0.170 (0.178) data 0.092 (0.101) loss_x loss_x 0.3904 (0.6195) acc_x 84.3750 (84.1250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [30/33] time 0.244 (0.181) data 0.105 (0.102) loss_x loss_x 0.5552 (0.5830) acc_x 84.3750 (85.3125) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/16] time 0.188 (0.185) data 0.110 (0.103) loss_u loss_u 0.5933 (0.7268) acc_u 50.0000 (32.5000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/16] time 0.187 (0.185) data 0.110 (0.104) loss_u loss_u 0.6626 (0.7227) acc_u 46.8750 (33.1250) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/16] time 0.185 (0.186) data 0.108 (0.105) loss_u loss_u 0.7222 (0.7218) acc_u 34.3750 (33.1250) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 382
confident_label rate tensor(0.6714, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1085
clean true:1081
clean false:4
clean_rate:0.9963133640552996
noisy true:153
noisy false:378
after delete: len(clean_dataset) 1085
after delete: len(noisy_dataset) 531
epoch [98/200] batch [5/33] time 0.162 (0.186) data 0.085 (0.085) loss_x loss_x 0.6123 (0.8027) acc_x 84.3750 (79.3750) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/33] time 0.187 (0.188) data 0.110 (0.099) loss_x loss_x 0.8784 (0.7354) acc_x 81.2500 (80.6250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/33] time 0.179 (0.185) data 0.101 (0.100) loss_x loss_x 0.5220 (0.6950) acc_x 81.2500 (81.4583) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/33] time 0.160 (0.178) data 0.083 (0.095) loss_x loss_x 0.5186 (0.6799) acc_x 84.3750 (82.3438) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/33] time 0.159 (0.174) data 0.082 (0.093) loss_x loss_x 0.5591 (0.6729) acc_x 84.3750 (82.3750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [30/33] time 0.163 (0.172) data 0.086 (0.091) loss_x loss_x 0.3423 (0.6396) acc_x 90.6250 (83.2292) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/16] time 0.159 (0.172) data 0.082 (0.092) loss_u loss_u 0.7437 (0.6800) acc_u 28.1250 (34.3750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [10/16] time 0.288 (0.174) data 0.097 (0.092) loss_u loss_u 0.6631 (0.6817) acc_u 43.7500 (35.3125) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/16] time 0.183 (0.175) data 0.106 (0.093) loss_u loss_u 0.8394 (0.6949) acc_u 15.6250 (34.1667) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 423
confident_label rate tensor(0.6498, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1050
clean true:1046
clean false:4
clean_rate:0.9961904761904762
noisy true:147
noisy false:419
after delete: len(clean_dataset) 1050
after delete: len(noisy_dataset) 566
epoch [99/200] batch [5/32] time 0.183 (0.172) data 0.106 (0.096) loss_x loss_x 0.6060 (0.5833) acc_x 93.7500 (86.2500) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/32] time 0.208 (0.178) data 0.132 (0.101) loss_x loss_x 0.6050 (0.6611) acc_x 84.3750 (84.0625) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [15/32] time 0.205 (0.192) data 0.128 (0.108) loss_x loss_x 0.2942 (0.6323) acc_x 90.6250 (84.5833) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/32] time 0.163 (0.187) data 0.086 (0.105) loss_x loss_x 0.5166 (0.6302) acc_x 84.3750 (84.6875) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/32] time 0.190 (0.187) data 0.114 (0.105) loss_x loss_x 0.5410 (0.6407) acc_x 87.5000 (84.3750) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/32] time 0.177 (0.185) data 0.100 (0.104) loss_x loss_x 0.3989 (0.6637) acc_x 90.6250 (83.5417) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/17] time 0.186 (0.185) data 0.107 (0.105) loss_u loss_u 0.6509 (0.6283) acc_u 40.6250 (45.0000) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/17] time 0.183 (0.185) data 0.104 (0.106) loss_u loss_u 0.6421 (0.6667) acc_u 40.6250 (39.3750) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/17] time 0.184 (0.188) data 0.107 (0.106) loss_u loss_u 0.6685 (0.6830) acc_u 34.3750 (37.2917) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 371
confident_label rate tensor(0.6788, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1097
clean true:1094
clean false:3
clean_rate:0.9972652689152234
noisy true:151
noisy false:368
all clean rate:  [0.9865168539325843, 0.9836660617059891, 0.9942446043165467, 0.9987163029525032, 0.9946236559139785, 0.993455497382199, 0.9974093264248705, 0.9987357774968394, 0.9975520195838433, 0.9962825278810409, 0.9987789987789988, 0.998766954377312, 0.9951159951159951, 0.9988344988344988, 0.9953379953379954, 1.0, 1.0, 0.9965909090909091, 0.9988826815642458, 0.9977802441731409, 0.994413407821229, 0.9966960352422908, 0.9977997799779978, 0.9966666666666667, 0.997828447339848, 0.9989154013015185, 0.9967741935483871, 0.9957219251336898, 0.9967355821545157, 0.9978768577494692, 0.9948400412796697, 0.9979508196721312, 0.9958333333333333, 0.9937629937629938, 0.997920997920998, 0.9979445015416238, 0.997907949790795, 0.9979899497487437, 0.9969230769230769, 0.9968017057569296, 0.9948665297741273, 0.9979529170931423, 0.9980099502487563, 0.9959390862944163, 0.9979716024340771, 0.995049504950495, 0.9970414201183432, 0.997997997997998, 0.9950099800399201, 0.9960513326752222, 0.9949443882709808, 0.9931170108161259, 0.9951171875, 0.9960079840319361, 0.9951314508276533, 0.9941804073714839, 0.9920398009950249, 0.995136186770428, 0.9980657640232108, 0.9940417080436942, 0.9970817120622568, 0.9990291262135922, 0.9971671388101983, 0.9980897803247374, 0.9981078524124882, 0.9970731707317073, 0.998093422306959, 0.997090203685742, 0.9981060606060606, 0.9971590909090909, 0.9981255857544518, 0.9962157048249763, 0.9971563981042654, 0.998109640831758, 0.9971181556195965, 0.9990512333965844, 0.998114985862394, 0.9952561669829222, 0.9961722488038277, 0.9971509971509972, 0.9953746530989824, 0.997164461247637, 0.9990610328638497, 0.9990601503759399, 1.0, 0.9971883786316776, 0.9953314659197012, 0.9981600735970562, 0.9962406015037594, 0.994535519125683, 0.9962511715089035, 0.9962859795728877, 0.9962790697674418, 0.9972324723247232, 0.9963031423290203, 0.9963065558633426, 0.9962790697674418, 0.9963133640552996, 0.9961904761904762, 0.9972652689152234]
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 519
epoch [100/200] batch [5/34] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.4329 (0.5817) acc_x 90.6250 (83.7500) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/34] time 0.179 (0.185) data 0.103 (0.108) loss_x loss_x 0.7031 (0.6440) acc_x 81.2500 (82.8125) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/34] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.7266 (0.6729) acc_x 75.0000 (81.6667) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/34] time 0.199 (0.189) data 0.122 (0.108) loss_x loss_x 0.6431 (0.7000) acc_x 78.1250 (81.4062) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/34] time 0.181 (0.191) data 0.105 (0.111) loss_x loss_x 0.6606 (0.6675) acc_x 87.5000 (82.5000) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [30/34] time 0.187 (0.190) data 0.110 (0.111) loss_x loss_x 0.5396 (0.6533) acc_x 93.7500 (82.7083) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/16] time 0.189 (0.189) data 0.112 (0.110) loss_u loss_u 0.7412 (0.7277) acc_u 34.3750 (31.8750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/16] time 0.186 (0.189) data 0.108 (0.110) loss_u loss_u 0.7153 (0.7436) acc_u 31.2500 (30.3125) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/16] time 0.251 (0.193) data 0.175 (0.112) loss_u loss_u 0.7471 (0.7344) acc_u 31.2500 (31.0417) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 363
confident_label rate tensor(0.6856, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1108
clean true:1102
clean false:6
clean_rate:0.9945848375451264
noisy true:151
noisy false:357
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 508
epoch [101/200] batch [5/34] time 0.164 (0.160) data 0.087 (0.083) loss_x loss_x 0.7051 (0.5844) acc_x 81.2500 (85.6250) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/34] time 0.226 (0.170) data 0.149 (0.093) loss_x loss_x 0.6997 (0.6331) acc_x 84.3750 (83.7500) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/34] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.6289 (0.5745) acc_x 81.2500 (85.2083) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/34] time 0.159 (0.173) data 0.082 (0.096) loss_x loss_x 0.4238 (0.5737) acc_x 87.5000 (84.6875) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/34] time 0.158 (0.178) data 0.081 (0.097) loss_x loss_x 0.2900 (0.5822) acc_x 87.5000 (84.3750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [30/34] time 0.177 (0.177) data 0.100 (0.097) loss_x loss_x 0.4365 (0.5695) acc_x 87.5000 (84.4792) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/15] time 0.169 (0.176) data 0.091 (0.096) loss_u loss_u 0.6714 (0.6927) acc_u 37.5000 (36.8750) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [10/15] time 0.182 (0.175) data 0.106 (0.096) loss_u loss_u 0.8071 (0.7281) acc_u 25.0000 (33.7500) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [15/15] time 0.184 (0.177) data 0.106 (0.095) loss_u loss_u 0.7646 (0.7263) acc_u 25.0000 (33.1250) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 374
confident_label rate tensor(0.6720, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1086
clean true:1084
clean false:2
clean_rate:0.998158379373849
noisy true:158
noisy false:372
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 530
epoch [102/200] batch [5/33] time 0.198 (0.210) data 0.120 (0.133) loss_x loss_x 0.7666 (0.7884) acc_x 81.2500 (80.6250) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/33] time 0.183 (0.199) data 0.106 (0.122) loss_x loss_x 0.3857 (0.6754) acc_x 87.5000 (83.7500) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/33] time 0.183 (0.194) data 0.106 (0.117) loss_x loss_x 0.5059 (0.6669) acc_x 84.3750 (83.3333) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/33] time 0.216 (0.193) data 0.139 (0.115) loss_x loss_x 0.3857 (0.6367) acc_x 90.6250 (83.7500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/33] time 0.214 (0.194) data 0.135 (0.113) loss_x loss_x 0.7935 (0.6496) acc_x 84.3750 (83.5000) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [30/33] time 0.166 (0.193) data 0.088 (0.112) loss_x loss_x 0.3760 (0.6488) acc_x 90.6250 (83.4375) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/16] time 0.215 (0.194) data 0.138 (0.114) loss_u loss_u 0.6836 (0.7151) acc_u 37.5000 (31.2500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/16] time 0.187 (0.192) data 0.110 (0.112) loss_u loss_u 0.5874 (0.6960) acc_u 50.0000 (35.0000) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/16] time 0.160 (0.189) data 0.082 (0.110) loss_u loss_u 0.7529 (0.7034) acc_u 28.1250 (35.0000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 380
confident_label rate tensor(0.6776, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1095
clean true:1091
clean false:4
clean_rate:0.9963470319634703
noisy true:145
noisy false:376
after delete: len(clean_dataset) 1095
after delete: len(noisy_dataset) 521
epoch [103/200] batch [5/34] time 0.185 (0.201) data 0.108 (0.123) loss_x loss_x 0.5674 (0.4822) acc_x 87.5000 (88.1250) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [10/34] time 0.168 (0.192) data 0.091 (0.115) loss_x loss_x 0.6187 (0.5275) acc_x 78.1250 (85.9375) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [15/34] time 0.190 (0.192) data 0.114 (0.115) loss_x loss_x 0.6465 (0.5626) acc_x 84.3750 (86.0417) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/34] time 0.194 (0.191) data 0.117 (0.114) loss_x loss_x 0.4390 (0.5657) acc_x 84.3750 (85.3125) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/34] time 0.184 (0.190) data 0.108 (0.113) loss_x loss_x 0.4792 (0.5605) acc_x 84.3750 (85.5000) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [30/34] time 0.182 (0.192) data 0.105 (0.115) loss_x loss_x 0.7417 (0.5748) acc_x 81.2500 (84.6875) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/16] time 0.193 (0.195) data 0.116 (0.114) loss_u loss_u 0.6270 (0.6886) acc_u 46.8750 (39.3750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/16] time 0.181 (0.194) data 0.104 (0.114) loss_u loss_u 0.7148 (0.6860) acc_u 34.3750 (37.1875) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [15/16] time 0.186 (0.193) data 0.109 (0.113) loss_u loss_u 0.6001 (0.6983) acc_u 46.8750 (35.8333) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 366
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1109
clean true:1106
clean false:3
clean_rate:0.9972948602344455
noisy true:144
noisy false:363
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 507
epoch [104/200] batch [5/34] time 0.198 (0.167) data 0.122 (0.091) loss_x loss_x 0.4680 (0.4240) acc_x 84.3750 (89.3750) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/34] time 0.169 (0.169) data 0.092 (0.093) loss_x loss_x 0.3679 (0.5038) acc_x 90.6250 (87.8125) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/34] time 0.166 (0.169) data 0.087 (0.092) loss_x loss_x 0.9419 (0.5878) acc_x 75.0000 (84.5833) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/34] time 0.193 (0.171) data 0.115 (0.094) loss_x loss_x 0.4846 (0.6234) acc_x 90.6250 (84.0625) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/34] time 0.269 (0.175) data 0.094 (0.094) loss_x loss_x 0.4465 (0.6025) acc_x 90.6250 (84.3750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/34] time 0.181 (0.176) data 0.105 (0.095) loss_x loss_x 0.5894 (0.6255) acc_x 84.3750 (83.9583) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/15] time 0.185 (0.176) data 0.107 (0.095) loss_u loss_u 0.6611 (0.6949) acc_u 40.6250 (33.7500) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [10/15] time 0.214 (0.177) data 0.136 (0.097) loss_u loss_u 0.7900 (0.7281) acc_u 25.0000 (31.8750) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [15/15] time 0.183 (0.180) data 0.105 (0.100) loss_u loss_u 0.7817 (0.7299) acc_u 25.0000 (31.0417) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 374
confident_label rate tensor(0.6696, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1082
clean true:1079
clean false:3
clean_rate:0.9972273567467652
noisy true:163
noisy false:371
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 534
epoch [105/200] batch [5/33] time 0.185 (0.196) data 0.108 (0.119) loss_x loss_x 0.4846 (0.5023) acc_x 90.6250 (87.5000) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/33] time 0.184 (0.192) data 0.108 (0.115) loss_x loss_x 0.2874 (0.5116) acc_x 93.7500 (87.1875) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/33] time 0.196 (0.191) data 0.119 (0.114) loss_x loss_x 0.8652 (0.5784) acc_x 84.3750 (85.2083) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/33] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.5483 (0.5745) acc_x 87.5000 (84.8438) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/33] time 0.187 (0.191) data 0.109 (0.109) loss_x loss_x 0.2073 (0.5393) acc_x 93.7500 (85.3750) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [30/33] time 0.196 (0.191) data 0.119 (0.111) loss_x loss_x 0.3928 (0.5378) acc_x 84.3750 (85.1042) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/16] time 0.184 (0.190) data 0.106 (0.110) loss_u loss_u 0.6870 (0.7036) acc_u 40.6250 (36.2500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/16] time 0.181 (0.189) data 0.104 (0.110) loss_u loss_u 0.7559 (0.7034) acc_u 28.1250 (35.3125) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [15/16] time 0.183 (0.189) data 0.106 (0.109) loss_u loss_u 0.7979 (0.7011) acc_u 21.8750 (35.4167) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 363
confident_label rate tensor(0.6770, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1094
clean true:1092
clean false:2
clean_rate:0.9981718464351006
noisy true:161
noisy false:361
after delete: len(clean_dataset) 1094
after delete: len(noisy_dataset) 522
epoch [106/200] batch [5/34] time 0.194 (0.205) data 0.118 (0.128) loss_x loss_x 0.5786 (0.4892) acc_x 84.3750 (86.8750) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/34] time 0.179 (0.202) data 0.103 (0.125) loss_x loss_x 0.5093 (0.5692) acc_x 90.6250 (85.9375) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/34] time 0.207 (0.198) data 0.130 (0.121) loss_x loss_x 0.8032 (0.6341) acc_x 87.5000 (85.0000) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/34] time 0.185 (0.194) data 0.109 (0.117) loss_x loss_x 0.3740 (0.5995) acc_x 93.7500 (85.0000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/34] time 0.170 (0.192) data 0.094 (0.116) loss_x loss_x 1.2227 (0.6148) acc_x 68.7500 (84.3750) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/34] time 0.169 (0.193) data 0.091 (0.112) loss_x loss_x 0.3621 (0.5934) acc_x 93.7500 (84.7917) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/16] time 0.185 (0.192) data 0.108 (0.112) loss_u loss_u 0.6821 (0.7110) acc_u 37.5000 (33.1250) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/16] time 0.181 (0.191) data 0.104 (0.111) loss_u loss_u 0.6582 (0.7118) acc_u 40.6250 (34.0625) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/16] time 0.195 (0.191) data 0.117 (0.111) loss_u loss_u 0.7290 (0.6997) acc_u 34.3750 (35.6250) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 380
confident_label rate tensor(0.6782, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1096
clean true:1092
clean false:4
clean_rate:0.9963503649635036
noisy true:144
noisy false:376
after delete: len(clean_dataset) 1096
after delete: len(noisy_dataset) 520
epoch [107/200] batch [5/34] time 0.161 (0.188) data 0.085 (0.085) loss_x loss_x 0.6021 (0.6920) acc_x 78.1250 (80.0000) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [10/34] time 0.159 (0.174) data 0.082 (0.084) loss_x loss_x 0.9692 (0.7073) acc_x 75.0000 (80.6250) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/34] time 0.161 (0.175) data 0.084 (0.089) loss_x loss_x 0.4319 (0.6786) acc_x 90.6250 (81.8750) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/34] time 0.159 (0.175) data 0.083 (0.091) loss_x loss_x 0.5840 (0.6720) acc_x 84.3750 (82.3438) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/34] time 0.182 (0.175) data 0.106 (0.092) loss_x loss_x 0.5791 (0.6835) acc_x 81.2500 (82.0000) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/34] time 0.180 (0.181) data 0.103 (0.099) loss_x loss_x 0.8887 (0.6787) acc_x 78.1250 (82.3958) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/16] time 0.198 (0.185) data 0.121 (0.104) loss_u loss_u 0.8076 (0.7671) acc_u 31.2500 (30.0000) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/16] time 0.160 (0.186) data 0.083 (0.105) loss_u loss_u 0.5522 (0.7264) acc_u 53.1250 (34.0625) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/16] time 0.194 (0.187) data 0.116 (0.107) loss_u loss_u 0.7651 (0.7234) acc_u 28.1250 (33.1250) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 346
confident_label rate tensor(0.6918, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1118
clean true:1116
clean false:2
clean_rate:0.998211091234347
noisy true:154
noisy false:344
after delete: len(clean_dataset) 1118
after delete: len(noisy_dataset) 498
epoch [108/200] batch [5/34] time 0.182 (0.192) data 0.104 (0.115) loss_x loss_x 0.3337 (0.5363) acc_x 96.8750 (85.0000) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/34] time 0.180 (0.186) data 0.103 (0.109) loss_x loss_x 0.5737 (0.5833) acc_x 84.3750 (85.3125) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/34] time 0.164 (0.181) data 0.087 (0.104) loss_x loss_x 0.6377 (0.5804) acc_x 84.3750 (86.0417) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/34] time 0.167 (0.184) data 0.090 (0.107) loss_x loss_x 0.7148 (0.6133) acc_x 78.1250 (83.9062) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/34] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 0.4031 (0.5961) acc_x 84.3750 (84.1250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [30/34] time 0.178 (0.181) data 0.102 (0.104) loss_x loss_x 0.4761 (0.5824) acc_x 78.1250 (84.2708) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/15] time 0.183 (0.183) data 0.105 (0.103) loss_u loss_u 0.7998 (0.7257) acc_u 18.7500 (30.6250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [10/15] time 0.162 (0.181) data 0.084 (0.101) loss_u loss_u 0.7759 (0.7186) acc_u 25.0000 (31.5625) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [15/15] time 0.159 (0.179) data 0.082 (0.100) loss_u loss_u 0.7847 (0.7258) acc_u 21.8750 (30.4167) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 396
confident_label rate tensor(0.6696, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1082
clean true:1080
clean false:2
clean_rate:0.9981515711645101
noisy true:140
noisy false:394
after delete: len(clean_dataset) 1082
after delete: len(noisy_dataset) 534
epoch [109/200] batch [5/33] time 0.162 (0.200) data 0.085 (0.100) loss_x loss_x 0.7529 (0.5003) acc_x 78.1250 (86.2500) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/33] time 0.160 (0.191) data 0.084 (0.102) loss_x loss_x 0.7666 (0.6470) acc_x 84.3750 (82.5000) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/33] time 0.173 (0.185) data 0.096 (0.100) loss_x loss_x 0.7871 (0.6294) acc_x 75.0000 (82.0833) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/33] time 0.166 (0.181) data 0.090 (0.099) loss_x loss_x 0.5483 (0.5942) acc_x 90.6250 (84.5312) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/33] time 0.172 (0.181) data 0.095 (0.099) loss_x loss_x 0.4714 (0.6128) acc_x 87.5000 (84.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [30/33] time 0.199 (0.180) data 0.123 (0.099) loss_x loss_x 0.5029 (0.6130) acc_x 87.5000 (84.0625) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/16] time 0.183 (0.181) data 0.106 (0.101) loss_u loss_u 0.6665 (0.6303) acc_u 40.6250 (43.1250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [10/16] time 0.200 (0.184) data 0.123 (0.101) loss_u loss_u 0.7349 (0.6705) acc_u 34.3750 (40.6250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/16] time 0.184 (0.183) data 0.107 (0.101) loss_u loss_u 0.7554 (0.6866) acc_u 25.0000 (37.7083) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 386
confident_label rate tensor(0.6751, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1091
clean true:1088
clean false:3
clean_rate:0.997250229147571
noisy true:142
noisy false:383
after delete: len(clean_dataset) 1091
after delete: len(noisy_dataset) 525
epoch [110/200] batch [5/34] time 0.177 (0.190) data 0.082 (0.088) loss_x loss_x 0.5278 (0.6547) acc_x 81.2500 (80.6250) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/34] time 0.182 (0.187) data 0.105 (0.097) loss_x loss_x 0.5732 (0.6093) acc_x 87.5000 (81.8750) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/34] time 0.160 (0.178) data 0.084 (0.092) loss_x loss_x 0.7754 (0.5869) acc_x 84.3750 (83.9583) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/34] time 0.158 (0.173) data 0.080 (0.090) loss_x loss_x 0.7021 (0.5673) acc_x 75.0000 (84.3750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/34] time 0.185 (0.171) data 0.107 (0.089) loss_x loss_x 0.6572 (0.5684) acc_x 87.5000 (84.0000) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/34] time 0.183 (0.171) data 0.106 (0.090) loss_x loss_x 0.6445 (0.5652) acc_x 81.2500 (83.9583) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/16] time 0.161 (0.171) data 0.083 (0.091) loss_u loss_u 0.7305 (0.7585) acc_u 28.1250 (28.7500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [10/16] time 0.184 (0.175) data 0.108 (0.093) loss_u loss_u 0.7847 (0.7303) acc_u 28.1250 (33.1250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/16] time 0.181 (0.176) data 0.103 (0.094) loss_u loss_u 0.7583 (0.7232) acc_u 28.1250 (33.3333) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 352
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1111
clean true:1108
clean false:3
clean_rate:0.9972997299729973
noisy true:156
noisy false:349
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 505
epoch [111/200] batch [5/34] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.6187 (0.5178) acc_x 87.5000 (86.8750) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/34] time 0.175 (0.175) data 0.097 (0.098) loss_x loss_x 0.2812 (0.5646) acc_x 90.6250 (85.9375) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/34] time 0.187 (0.186) data 0.109 (0.101) loss_x loss_x 0.4600 (0.5490) acc_x 78.1250 (86.2500) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/34] time 0.247 (0.188) data 0.170 (0.105) loss_x loss_x 0.5596 (0.5565) acc_x 78.1250 (85.1562) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/34] time 0.178 (0.186) data 0.101 (0.104) loss_x loss_x 0.7500 (0.6089) acc_x 81.2500 (83.6250) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [30/34] time 0.172 (0.183) data 0.095 (0.102) loss_x loss_x 0.9497 (0.6277) acc_x 81.2500 (83.4375) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/15] time 0.190 (0.187) data 0.113 (0.107) loss_u loss_u 0.7734 (0.7290) acc_u 25.0000 (31.2500) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/15] time 0.188 (0.187) data 0.111 (0.107) loss_u loss_u 0.7983 (0.7460) acc_u 25.0000 (31.2500) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [15/15] time 0.167 (0.188) data 0.090 (0.106) loss_u loss_u 0.7070 (0.7280) acc_u 31.2500 (32.7083) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 359
confident_label rate tensor(0.6832, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1104
clean true:1101
clean false:3
clean_rate:0.9972826086956522
noisy true:156
noisy false:356
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 512
epoch [112/200] batch [5/34] time 0.159 (0.166) data 0.083 (0.090) loss_x loss_x 0.5420 (0.6100) acc_x 81.2500 (82.5000) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/34] time 0.177 (0.171) data 0.100 (0.094) loss_x loss_x 1.1504 (0.6988) acc_x 71.8750 (80.3125) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/34] time 0.175 (0.181) data 0.098 (0.097) loss_x loss_x 0.8237 (0.7209) acc_x 71.8750 (80.4167) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/34] time 0.173 (0.178) data 0.096 (0.095) loss_x loss_x 0.9497 (0.7035) acc_x 75.0000 (80.7812) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/34] time 0.188 (0.180) data 0.111 (0.099) loss_x loss_x 0.3503 (0.6609) acc_x 93.7500 (82.3750) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/34] time 0.183 (0.181) data 0.106 (0.100) loss_x loss_x 0.8867 (0.6425) acc_x 75.0000 (82.8125) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/16] time 0.166 (0.179) data 0.090 (0.099) loss_u loss_u 0.6333 (0.7343) acc_u 40.6250 (32.5000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [10/16] time 0.159 (0.181) data 0.082 (0.099) loss_u loss_u 0.6240 (0.7105) acc_u 50.0000 (35.0000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [15/16] time 0.161 (0.180) data 0.084 (0.099) loss_u loss_u 0.7056 (0.7139) acc_u 31.2500 (33.9583) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 380
confident_label rate tensor(0.6745, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1090
clean true:1086
clean false:4
clean_rate:0.9963302752293578
noisy true:150
noisy false:376
after delete: len(clean_dataset) 1090
after delete: len(noisy_dataset) 526
epoch [113/200] batch [5/34] time 0.174 (0.171) data 0.097 (0.094) loss_x loss_x 0.8159 (0.7594) acc_x 78.1250 (81.8750) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/34] time 0.184 (0.182) data 0.106 (0.105) loss_x loss_x 0.6001 (0.6615) acc_x 87.5000 (83.7500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [15/34] time 0.186 (0.190) data 0.108 (0.104) loss_x loss_x 0.6401 (0.6059) acc_x 90.6250 (85.6250) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/34] time 0.184 (0.190) data 0.108 (0.106) loss_x loss_x 1.0889 (0.6524) acc_x 71.8750 (83.5938) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/34] time 0.167 (0.186) data 0.090 (0.104) loss_x loss_x 0.4375 (0.6331) acc_x 93.7500 (83.6250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [30/34] time 0.161 (0.185) data 0.084 (0.103) loss_x loss_x 0.3628 (0.6403) acc_x 87.5000 (83.3333) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/16] time 0.160 (0.180) data 0.082 (0.099) loss_u loss_u 0.7549 (0.6483) acc_u 28.1250 (38.1250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [10/16] time 0.159 (0.178) data 0.081 (0.098) loss_u loss_u 0.7314 (0.6620) acc_u 31.2500 (38.1250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [15/16] time 0.162 (0.178) data 0.084 (0.096) loss_u loss_u 0.7109 (0.6767) acc_u 31.2500 (36.2500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 365
confident_label rate tensor(0.6832, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1104
clean true:1099
clean false:5
clean_rate:0.9954710144927537
noisy true:152
noisy false:360
after delete: len(clean_dataset) 1104
after delete: len(noisy_dataset) 512
epoch [114/200] batch [5/34] time 0.183 (0.190) data 0.106 (0.113) loss_x loss_x 0.6050 (0.5651) acc_x 87.5000 (85.6250) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [10/34] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.5405 (0.4886) acc_x 90.6250 (87.1875) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [15/34] time 0.182 (0.188) data 0.106 (0.111) loss_x loss_x 0.4041 (0.4866) acc_x 90.6250 (87.9167) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/34] time 0.186 (0.189) data 0.109 (0.112) loss_x loss_x 0.7832 (0.5468) acc_x 84.3750 (86.0938) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/34] time 0.184 (0.195) data 0.107 (0.114) loss_x loss_x 0.4268 (0.5546) acc_x 87.5000 (85.8750) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [30/34] time 0.174 (0.193) data 0.096 (0.113) loss_x loss_x 0.5991 (0.5874) acc_x 87.5000 (85.2083) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/16] time 0.174 (0.188) data 0.097 (0.108) loss_u loss_u 0.7178 (0.6930) acc_u 31.2500 (33.1250) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/16] time 0.175 (0.187) data 0.096 (0.108) loss_u loss_u 0.7695 (0.7354) acc_u 25.0000 (29.6875) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [15/16] time 0.169 (0.186) data 0.091 (0.107) loss_u loss_u 0.6309 (0.7188) acc_u 40.6250 (31.6667) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 383
confident_label rate tensor(0.6720, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1086
clean true:1082
clean false:4
clean_rate:0.996316758747698
noisy true:151
noisy false:379
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 530
epoch [115/200] batch [5/33] time 0.165 (0.162) data 0.088 (0.085) loss_x loss_x 0.4346 (0.7023) acc_x 90.6250 (81.2500) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/33] time 0.168 (0.164) data 0.091 (0.087) loss_x loss_x 0.2207 (0.6247) acc_x 93.7500 (83.7500) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [15/33] time 0.161 (0.163) data 0.084 (0.086) loss_x loss_x 0.4248 (0.6313) acc_x 87.5000 (83.3333) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [20/33] time 0.184 (0.164) data 0.106 (0.087) loss_x loss_x 0.4912 (0.6021) acc_x 87.5000 (84.2188) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/33] time 0.174 (0.170) data 0.098 (0.088) loss_x loss_x 0.4104 (0.6019) acc_x 84.3750 (83.7500) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/33] time 0.165 (0.170) data 0.088 (0.089) loss_x loss_x 0.3777 (0.6043) acc_x 87.5000 (83.7500) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/16] time 0.174 (0.171) data 0.097 (0.091) loss_u loss_u 0.6621 (0.6446) acc_u 37.5000 (39.3750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/16] time 0.171 (0.171) data 0.092 (0.091) loss_u loss_u 0.6675 (0.6792) acc_u 46.8750 (37.1875) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/16] time 0.174 (0.171) data 0.096 (0.092) loss_u loss_u 0.7158 (0.6823) acc_u 34.3750 (37.7083) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 363
confident_label rate tensor(0.6788, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1097
clean true:1097
clean false:0
clean_rate:1.0
noisy true:156
noisy false:363
after delete: len(clean_dataset) 1097
after delete: len(noisy_dataset) 519
epoch [116/200] batch [5/34] time 0.213 (0.191) data 0.137 (0.114) loss_x loss_x 0.3069 (0.5166) acc_x 96.8750 (87.5000) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/34] time 0.190 (0.194) data 0.112 (0.117) loss_x loss_x 0.8525 (0.5824) acc_x 71.8750 (84.6875) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/34] time 0.168 (0.188) data 0.091 (0.111) loss_x loss_x 0.4009 (0.5998) acc_x 81.2500 (83.7500) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/34] time 0.157 (0.184) data 0.080 (0.107) loss_x loss_x 0.5303 (0.6020) acc_x 87.5000 (84.3750) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/34] time 0.159 (0.183) data 0.082 (0.106) loss_x loss_x 0.6650 (0.6004) acc_x 78.1250 (84.7500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [30/34] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.2214 (0.5943) acc_x 96.8750 (85.2083) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/16] time 0.209 (0.188) data 0.129 (0.106) loss_u loss_u 0.6060 (0.6541) acc_u 40.6250 (39.3750) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/16] time 0.227 (0.188) data 0.147 (0.107) loss_u loss_u 0.7246 (0.6857) acc_u 34.3750 (36.2500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/16] time 0.184 (0.188) data 0.106 (0.107) loss_u loss_u 0.6992 (0.6824) acc_u 40.6250 (37.2917) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 385
confident_label rate tensor(0.6726, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1087
clean true:1084
clean false:3
clean_rate:0.9972401103955841
noisy true:147
noisy false:382
after delete: len(clean_dataset) 1087
after delete: len(noisy_dataset) 529
epoch [117/200] batch [5/33] time 0.273 (0.188) data 0.087 (0.089) loss_x loss_x 0.5781 (0.6126) acc_x 84.3750 (83.7500) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/33] time 0.213 (0.186) data 0.136 (0.096) loss_x loss_x 0.5093 (0.5434) acc_x 90.6250 (86.5625) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/33] time 0.178 (0.188) data 0.101 (0.102) loss_x loss_x 0.5903 (0.5325) acc_x 81.2500 (86.0417) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/33] time 0.174 (0.183) data 0.097 (0.099) loss_x loss_x 0.7759 (0.5870) acc_x 81.2500 (84.8438) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/33] time 0.158 (0.180) data 0.080 (0.097) loss_x loss_x 0.9927 (0.6098) acc_x 78.1250 (84.3750) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [30/33] time 0.167 (0.182) data 0.090 (0.097) loss_x loss_x 0.7783 (0.6185) acc_x 78.1250 (84.1667) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/16] time 0.191 (0.181) data 0.113 (0.098) loss_u loss_u 0.5366 (0.6677) acc_u 59.3750 (40.6250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [10/16] time 0.163 (0.180) data 0.085 (0.097) loss_u loss_u 0.6875 (0.6786) acc_u 34.3750 (38.4375) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [15/16] time 0.165 (0.181) data 0.087 (0.098) loss_u loss_u 0.8789 (0.6957) acc_u 12.5000 (36.6667) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 365
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1106
clean true:1102
clean false:4
clean_rate:0.9963833634719711
noisy true:149
noisy false:361
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 510
epoch [118/200] batch [5/34] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.5854 (0.4833) acc_x 87.5000 (90.0000) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [10/34] time 0.180 (0.188) data 0.103 (0.101) loss_x loss_x 0.5225 (0.4456) acc_x 84.3750 (90.0000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [15/34] time 0.169 (0.182) data 0.092 (0.098) loss_x loss_x 0.6216 (0.5160) acc_x 78.1250 (87.5000) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/34] time 0.207 (0.181) data 0.130 (0.098) loss_x loss_x 0.8818 (0.5487) acc_x 84.3750 (85.9375) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/34] time 0.158 (0.176) data 0.082 (0.095) loss_x loss_x 0.3811 (0.5302) acc_x 93.7500 (86.7500) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [30/34] time 0.162 (0.176) data 0.085 (0.093) loss_x loss_x 0.6294 (0.5468) acc_x 81.2500 (85.9375) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/15] time 0.160 (0.172) data 0.082 (0.090) loss_u loss_u 0.6318 (0.7213) acc_u 43.7500 (34.3750) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [10/15] time 0.193 (0.171) data 0.115 (0.090) loss_u loss_u 0.8281 (0.7222) acc_u 25.0000 (33.4375) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [15/15] time 0.166 (0.172) data 0.088 (0.091) loss_u loss_u 0.6118 (0.7066) acc_u 46.8750 (35.0000) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 365
confident_label rate tensor(0.6825, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1103
clean true:1099
clean false:4
clean_rate:0.9963735267452403
noisy true:152
noisy false:361
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 513
epoch [119/200] batch [5/34] time 0.160 (0.168) data 0.083 (0.091) loss_x loss_x 0.3933 (0.7539) acc_x 84.3750 (78.7500) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/34] time 0.280 (0.192) data 0.094 (0.093) loss_x loss_x 0.6978 (0.6536) acc_x 75.0000 (82.1875) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/34] time 0.170 (0.182) data 0.093 (0.091) loss_x loss_x 0.4937 (0.6211) acc_x 93.7500 (83.5417) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/34] time 0.158 (0.176) data 0.081 (0.089) loss_x loss_x 0.8989 (0.6246) acc_x 78.1250 (82.9688) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/34] time 0.180 (0.178) data 0.104 (0.092) loss_x loss_x 0.7188 (0.6427) acc_x 71.8750 (82.6250) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [30/34] time 0.187 (0.179) data 0.110 (0.095) loss_x loss_x 0.3669 (0.6183) acc_x 93.7500 (83.5417) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/16] time 0.186 (0.182) data 0.109 (0.099) loss_u loss_u 0.7622 (0.7269) acc_u 25.0000 (33.7500) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/16] time 0.177 (0.181) data 0.099 (0.099) loss_u loss_u 0.6431 (0.7184) acc_u 40.6250 (33.4375) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [15/16] time 0.171 (0.184) data 0.094 (0.100) loss_u loss_u 0.7598 (0.7134) acc_u 28.1250 (33.1250) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 373
confident_label rate tensor(0.6795, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1098
clean true:1093
clean false:5
clean_rate:0.9954462659380692
noisy true:150
noisy false:368
after delete: len(clean_dataset) 1098
after delete: len(noisy_dataset) 518
epoch [120/200] batch [5/34] time 0.190 (0.185) data 0.113 (0.108) loss_x loss_x 0.3064 (0.5109) acc_x 93.7500 (88.1250) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [10/34] time 0.159 (0.183) data 0.083 (0.106) loss_x loss_x 0.5020 (0.5385) acc_x 90.6250 (87.1875) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [15/34] time 0.230 (0.189) data 0.153 (0.112) loss_x loss_x 0.6797 (0.5748) acc_x 84.3750 (86.4583) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/34] time 0.257 (0.194) data 0.103 (0.108) loss_x loss_x 0.4521 (0.5225) acc_x 87.5000 (87.9688) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/34] time 0.187 (0.190) data 0.110 (0.106) loss_x loss_x 0.4424 (0.5166) acc_x 90.6250 (87.7500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [30/34] time 0.169 (0.187) data 0.092 (0.104) loss_x loss_x 0.9326 (0.5348) acc_x 75.0000 (87.2917) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/16] time 0.226 (0.189) data 0.149 (0.107) loss_u loss_u 0.6050 (0.6321) acc_u 46.8750 (43.1250) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/16] time 0.163 (0.187) data 0.085 (0.105) loss_u loss_u 0.6602 (0.6747) acc_u 40.6250 (37.8125) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [15/16] time 0.166 (0.185) data 0.088 (0.104) loss_u loss_u 0.7490 (0.6953) acc_u 28.1250 (35.2083) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 352
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1106
clean true:1103
clean false:3
clean_rate:0.9972875226039783
noisy true:161
noisy false:349
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 510
epoch [121/200] batch [5/34] time 0.213 (0.189) data 0.136 (0.112) loss_x loss_x 0.6841 (0.5300) acc_x 84.3750 (86.2500) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [10/34] time 0.182 (0.188) data 0.106 (0.111) loss_x loss_x 0.7183 (0.5361) acc_x 78.1250 (85.3125) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/34] time 0.167 (0.187) data 0.090 (0.110) loss_x loss_x 0.4592 (0.5219) acc_x 90.6250 (86.0417) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/34] time 0.291 (0.189) data 0.105 (0.107) loss_x loss_x 0.7202 (0.5508) acc_x 87.5000 (85.7812) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/34] time 0.160 (0.187) data 0.083 (0.105) loss_x loss_x 0.3669 (0.5486) acc_x 93.7500 (85.1250) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/34] time 0.180 (0.185) data 0.103 (0.104) loss_x loss_x 1.1631 (0.6005) acc_x 68.7500 (83.9583) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/15] time 0.162 (0.182) data 0.085 (0.102) loss_u loss_u 0.6558 (0.7066) acc_u 37.5000 (34.3750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [10/15] time 0.157 (0.179) data 0.080 (0.100) loss_u loss_u 0.7197 (0.6935) acc_u 34.3750 (36.2500) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [15/15] time 0.272 (0.179) data 0.082 (0.098) loss_u loss_u 0.7695 (0.7003) acc_u 34.3750 (36.4583) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 385
confident_label rate tensor(0.6720, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1086
clean true:1081
clean false:5
clean_rate:0.9953959484346224
noisy true:150
noisy false:380
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 530
epoch [122/200] batch [5/33] time 0.210 (0.179) data 0.133 (0.102) loss_x loss_x 0.8154 (0.5888) acc_x 84.3750 (87.5000) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [10/33] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.3430 (0.6341) acc_x 93.7500 (85.0000) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/33] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.6548 (0.6261) acc_x 78.1250 (84.7917) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/33] time 0.177 (0.184) data 0.100 (0.096) loss_x loss_x 0.8315 (0.6306) acc_x 75.0000 (84.6875) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/33] time 0.182 (0.181) data 0.105 (0.095) loss_x loss_x 0.5244 (0.6002) acc_x 87.5000 (85.3750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [30/33] time 0.162 (0.178) data 0.085 (0.094) loss_x loss_x 0.5068 (0.5801) acc_x 90.6250 (85.4167) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/16] time 0.182 (0.177) data 0.105 (0.094) loss_u loss_u 0.7095 (0.7142) acc_u 34.3750 (33.7500) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [10/16] time 0.170 (0.176) data 0.092 (0.093) loss_u loss_u 0.7295 (0.6801) acc_u 34.3750 (37.8125) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [15/16] time 0.162 (0.175) data 0.084 (0.094) loss_u loss_u 0.5972 (0.6763) acc_u 40.6250 (38.9583) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 387
confident_label rate tensor(0.6720, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1086
clean true:1081
clean false:5
clean_rate:0.9953959484346224
noisy true:148
noisy false:382
after delete: len(clean_dataset) 1086
after delete: len(noisy_dataset) 530
epoch [123/200] batch [5/33] time 0.157 (0.172) data 0.081 (0.095) loss_x loss_x 0.3374 (0.5123) acc_x 93.7500 (86.8750) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/33] time 0.166 (0.165) data 0.088 (0.089) loss_x loss_x 1.2646 (0.5846) acc_x 65.6250 (85.0000) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/33] time 0.166 (0.164) data 0.088 (0.087) loss_x loss_x 0.3777 (0.5687) acc_x 90.6250 (85.6250) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/33] time 0.174 (0.165) data 0.097 (0.088) loss_x loss_x 0.5020 (0.5500) acc_x 87.5000 (85.6250) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/33] time 0.179 (0.166) data 0.102 (0.089) loss_x loss_x 0.3926 (0.5616) acc_x 87.5000 (85.2500) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/33] time 0.167 (0.167) data 0.090 (0.090) loss_x loss_x 0.4392 (0.5610) acc_x 81.2500 (84.8958) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/16] time 0.170 (0.172) data 0.092 (0.091) loss_u loss_u 0.6157 (0.6530) acc_u 43.7500 (38.1250) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [10/16] time 0.180 (0.173) data 0.103 (0.092) loss_u loss_u 0.7051 (0.6703) acc_u 37.5000 (37.1875) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/16] time 0.164 (0.173) data 0.086 (0.092) loss_u loss_u 0.7173 (0.6708) acc_u 31.2500 (36.8750) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 343
confident_label rate tensor(0.6993, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1130
clean true:1126
clean false:4
clean_rate:0.9964601769911504
noisy true:147
noisy false:339
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 486
epoch [124/200] batch [5/35] time 0.191 (0.178) data 0.114 (0.101) loss_x loss_x 1.1475 (0.7401) acc_x 71.8750 (81.2500) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/35] time 0.197 (0.178) data 0.120 (0.101) loss_x loss_x 0.4380 (0.6783) acc_x 93.7500 (84.3750) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/35] time 0.184 (0.177) data 0.107 (0.101) loss_x loss_x 1.0840 (0.7109) acc_x 78.1250 (83.3333) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/35] time 0.181 (0.189) data 0.105 (0.102) loss_x loss_x 0.5156 (0.6956) acc_x 81.2500 (83.9062) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/35] time 0.185 (0.187) data 0.108 (0.101) loss_x loss_x 0.8267 (0.6946) acc_x 81.2500 (83.2500) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [30/35] time 0.175 (0.184) data 0.098 (0.100) loss_x loss_x 0.7744 (0.6704) acc_x 75.0000 (83.3333) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [35/35] time 0.168 (0.183) data 0.091 (0.100) loss_x loss_x 0.5024 (0.6429) acc_x 90.6250 (84.1071) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/15] time 0.178 (0.183) data 0.101 (0.100) loss_u loss_u 0.6611 (0.7583) acc_u 37.5000 (30.0000) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [10/15] time 0.166 (0.182) data 0.088 (0.100) loss_u loss_u 0.7539 (0.7322) acc_u 28.1250 (32.1875) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [15/15] time 0.160 (0.181) data 0.083 (0.100) loss_u loss_u 0.7422 (0.7336) acc_u 40.6250 (33.3333) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 348
confident_label rate tensor(0.6980, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1128
clean true:1124
clean false:4
clean_rate:0.9964539007092199
noisy true:144
noisy false:344
after delete: len(clean_dataset) 1128
after delete: len(noisy_dataset) 488
epoch [125/200] batch [5/35] time 0.176 (0.185) data 0.100 (0.108) loss_x loss_x 0.4248 (0.4790) acc_x 87.5000 (87.5000) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/35] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.4060 (0.5278) acc_x 87.5000 (85.0000) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/35] time 0.161 (0.177) data 0.084 (0.101) loss_x loss_x 0.5112 (0.5752) acc_x 84.3750 (84.1667) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/35] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.5737 (0.5916) acc_x 75.0000 (83.2812) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/35] time 0.195 (0.178) data 0.119 (0.101) loss_x loss_x 0.4666 (0.5705) acc_x 90.6250 (83.8750) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [30/35] time 0.166 (0.177) data 0.090 (0.100) loss_x loss_x 0.6670 (0.5812) acc_x 84.3750 (84.2708) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [35/35] time 0.176 (0.183) data 0.100 (0.101) loss_x loss_x 1.0381 (0.5941) acc_x 78.1250 (83.9286) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/15] time 0.175 (0.182) data 0.098 (0.100) loss_u loss_u 0.7593 (0.7487) acc_u 28.1250 (29.3750) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [10/15] time 0.163 (0.180) data 0.084 (0.099) loss_u loss_u 0.6841 (0.7402) acc_u 37.5000 (30.9375) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [15/15] time 0.201 (0.180) data 0.123 (0.099) loss_u loss_u 0.6797 (0.7424) acc_u 37.5000 (30.2083) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 356
confident_label rate tensor(0.6850, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1107
clean true:1101
clean false:6
clean_rate:0.994579945799458
noisy true:159
noisy false:350
after delete: len(clean_dataset) 1107
after delete: len(noisy_dataset) 509
epoch [126/200] batch [5/34] time 0.186 (0.173) data 0.108 (0.096) loss_x loss_x 0.7534 (0.5163) acc_x 81.2500 (87.5000) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [10/34] time 0.157 (0.188) data 0.080 (0.094) loss_x loss_x 0.8018 (0.5426) acc_x 78.1250 (86.2500) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [15/34] time 0.159 (0.178) data 0.082 (0.090) loss_x loss_x 0.3223 (0.5526) acc_x 93.7500 (86.0417) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/34] time 0.160 (0.173) data 0.083 (0.087) loss_x loss_x 0.6089 (0.5702) acc_x 84.3750 (85.9375) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/34] time 0.180 (0.171) data 0.103 (0.087) loss_x loss_x 0.6284 (0.5948) acc_x 81.2500 (85.0000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [30/34] time 0.170 (0.170) data 0.093 (0.088) loss_x loss_x 0.2404 (0.5732) acc_x 93.7500 (85.3125) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/15] time 0.180 (0.171) data 0.102 (0.090) loss_u loss_u 0.6714 (0.7118) acc_u 40.6250 (33.1250) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [10/15] time 0.171 (0.171) data 0.092 (0.090) loss_u loss_u 0.6870 (0.7058) acc_u 34.3750 (33.7500) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [15/15] time 0.211 (0.178) data 0.134 (0.095) loss_u loss_u 0.6973 (0.7128) acc_u 31.2500 (33.1250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 367
confident_label rate tensor(0.6856, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1108
clean true:1099
clean false:9
clean_rate:0.9918772563176895
noisy true:150
noisy false:358
after delete: len(clean_dataset) 1108
after delete: len(noisy_dataset) 508
epoch [127/200] batch [5/34] time 0.177 (0.179) data 0.099 (0.102) loss_x loss_x 0.6851 (0.4964) acc_x 87.5000 (89.3750) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [10/34] time 0.180 (0.191) data 0.104 (0.114) loss_x loss_x 0.8037 (0.5537) acc_x 78.1250 (86.8750) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/34] time 0.161 (0.186) data 0.084 (0.109) loss_x loss_x 0.3396 (0.5589) acc_x 87.5000 (86.6667) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/34] time 0.201 (0.186) data 0.123 (0.109) loss_x loss_x 0.5205 (0.5919) acc_x 87.5000 (86.2500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/34] time 0.221 (0.195) data 0.145 (0.113) loss_x loss_x 0.4604 (0.5860) acc_x 87.5000 (86.6250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [30/34] time 0.187 (0.194) data 0.110 (0.112) loss_x loss_x 0.5532 (0.6109) acc_x 84.3750 (85.8333) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/15] time 0.173 (0.190) data 0.094 (0.109) loss_u loss_u 0.6572 (0.6593) acc_u 43.7500 (38.7500) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [10/15] time 0.177 (0.188) data 0.100 (0.108) loss_u loss_u 0.8203 (0.6874) acc_u 21.8750 (35.9375) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [15/15] time 0.184 (0.186) data 0.105 (0.106) loss_u loss_u 0.6475 (0.6916) acc_u 43.7500 (35.6250) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 344
confident_label rate tensor(0.7079, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1144
clean true:1136
clean false:8
clean_rate:0.993006993006993
noisy true:136
noisy false:336
after delete: len(clean_dataset) 1144
after delete: len(noisy_dataset) 472
epoch [128/200] batch [5/35] time 0.213 (0.173) data 0.136 (0.096) loss_x loss_x 0.2571 (0.5128) acc_x 90.6250 (86.8750) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [10/35] time 0.194 (0.174) data 0.118 (0.097) loss_x loss_x 0.5542 (0.5027) acc_x 84.3750 (86.2500) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/35] time 0.289 (0.182) data 0.104 (0.098) loss_x loss_x 0.4482 (0.5091) acc_x 90.6250 (86.4583) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/35] time 0.176 (0.179) data 0.099 (0.097) loss_x loss_x 0.8467 (0.5464) acc_x 75.0000 (85.7812) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/35] time 0.177 (0.178) data 0.100 (0.097) loss_x loss_x 0.7158 (0.5898) acc_x 81.2500 (84.8750) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/35] time 0.163 (0.177) data 0.087 (0.096) loss_x loss_x 0.4775 (0.6008) acc_x 84.3750 (84.5833) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [35/35] time 0.167 (0.176) data 0.090 (0.096) loss_x loss_x 0.4011 (0.6053) acc_x 87.5000 (84.5536) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/14] time 0.158 (0.176) data 0.081 (0.096) loss_u loss_u 0.5972 (0.7107) acc_u 50.0000 (32.5000) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [10/14] time 0.183 (0.177) data 0.106 (0.097) loss_u loss_u 0.6992 (0.7231) acc_u 40.6250 (32.8125) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 365
confident_label rate tensor(0.6894, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1114
clean true:1105
clean false:9
clean_rate:0.9919210053859964
noisy true:146
noisy false:356
after delete: len(clean_dataset) 1114
after delete: len(noisy_dataset) 502
epoch [129/200] batch [5/34] time 0.188 (0.178) data 0.112 (0.101) loss_x loss_x 0.6616 (0.5783) acc_x 87.5000 (88.7500) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/34] time 0.187 (0.192) data 0.110 (0.103) loss_x loss_x 0.1364 (0.6571) acc_x 96.8750 (84.6875) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/34] time 0.176 (0.185) data 0.099 (0.100) loss_x loss_x 0.7485 (0.6140) acc_x 84.3750 (85.6250) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/34] time 0.177 (0.182) data 0.100 (0.099) loss_x loss_x 0.3787 (0.5593) acc_x 87.5000 (86.7188) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/34] time 0.184 (0.182) data 0.108 (0.101) loss_x loss_x 0.6440 (0.5587) acc_x 87.5000 (86.7500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/34] time 0.181 (0.183) data 0.105 (0.102) loss_x loss_x 0.5376 (0.5789) acc_x 84.3750 (86.3542) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/15] time 0.171 (0.182) data 0.093 (0.102) loss_u loss_u 0.6440 (0.6874) acc_u 40.6250 (35.0000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [10/15] time 0.163 (0.185) data 0.085 (0.101) loss_u loss_u 0.5508 (0.6988) acc_u 50.0000 (35.0000) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [15/15] time 0.162 (0.182) data 0.084 (0.099) loss_u loss_u 0.6826 (0.7043) acc_u 40.6250 (34.1667) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 346
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1125
clean true:1120
clean false:5
clean_rate:0.9955555555555555
noisy true:150
noisy false:341
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 491
epoch [130/200] batch [5/35] time 0.170 (0.171) data 0.094 (0.095) loss_x loss_x 0.4143 (0.6203) acc_x 87.5000 (86.8750) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [10/35] time 0.157 (0.174) data 0.081 (0.097) loss_x loss_x 0.5073 (0.6024) acc_x 87.5000 (85.9375) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [15/35] time 0.158 (0.173) data 0.081 (0.097) loss_x loss_x 0.4055 (0.5353) acc_x 90.6250 (87.5000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/35] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 0.4570 (0.5579) acc_x 81.2500 (86.2500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/35] time 0.199 (0.179) data 0.123 (0.097) loss_x loss_x 0.6382 (0.5635) acc_x 78.1250 (85.8750) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/35] time 0.158 (0.178) data 0.082 (0.097) loss_x loss_x 0.5186 (0.5555) acc_x 81.2500 (85.8333) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [35/35] time 0.162 (0.177) data 0.086 (0.096) loss_x loss_x 0.4641 (0.5669) acc_x 87.5000 (85.3571) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/15] time 0.161 (0.175) data 0.083 (0.096) loss_u loss_u 0.5361 (0.6795) acc_u 46.8750 (36.2500) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [10/15] time 0.172 (0.177) data 0.094 (0.097) loss_u loss_u 0.6235 (0.7186) acc_u 40.6250 (32.1875) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [15/15] time 0.193 (0.177) data 0.115 (0.098) loss_u loss_u 0.6860 (0.7072) acc_u 34.3750 (33.1250) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 351
confident_label rate tensor(0.6906, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1116
clean true:1115
clean false:1
clean_rate:0.9991039426523297
noisy true:150
noisy false:350
after delete: len(clean_dataset) 1116
after delete: len(noisy_dataset) 500
epoch [131/200] batch [5/34] time 0.160 (0.158) data 0.084 (0.082) loss_x loss_x 0.2417 (0.4599) acc_x 93.7500 (86.8750) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/34] time 0.161 (0.159) data 0.084 (0.083) loss_x loss_x 0.4146 (0.4936) acc_x 90.6250 (87.1875) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [15/34] time 0.160 (0.159) data 0.084 (0.083) loss_x loss_x 0.7725 (0.6248) acc_x 78.1250 (84.1667) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/34] time 0.162 (0.160) data 0.085 (0.083) loss_x loss_x 0.6377 (0.5837) acc_x 87.5000 (85.3125) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/34] time 0.159 (0.160) data 0.083 (0.083) loss_x loss_x 0.5669 (0.5892) acc_x 84.3750 (85.1250) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/34] time 0.268 (0.163) data 0.082 (0.083) loss_x loss_x 0.3337 (0.5932) acc_x 87.5000 (84.6875) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/15] time 0.160 (0.167) data 0.083 (0.086) loss_u loss_u 0.7017 (0.6682) acc_u 37.5000 (37.5000) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [10/15] time 0.204 (0.168) data 0.126 (0.087) loss_u loss_u 0.7207 (0.7145) acc_u 31.2500 (33.4375) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [15/15] time 0.184 (0.169) data 0.105 (0.089) loss_u loss_u 0.6904 (0.7147) acc_u 37.5000 (33.3333) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 361
confident_label rate tensor(0.6825, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1103
clean true:1099
clean false:4
clean_rate:0.9963735267452403
noisy true:156
noisy false:357
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 513
epoch [132/200] batch [5/34] time 0.183 (0.173) data 0.107 (0.096) loss_x loss_x 0.3054 (0.4293) acc_x 93.7500 (89.3750) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [10/34] time 0.295 (0.189) data 0.111 (0.101) loss_x loss_x 0.4778 (0.4717) acc_x 84.3750 (87.8125) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/34] time 0.185 (0.192) data 0.108 (0.106) loss_x loss_x 0.3938 (0.4987) acc_x 90.6250 (87.5000) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/34] time 0.185 (0.189) data 0.108 (0.105) loss_x loss_x 0.9966 (0.5484) acc_x 75.0000 (86.0938) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/34] time 0.166 (0.185) data 0.089 (0.103) loss_x loss_x 0.4929 (0.5767) acc_x 90.6250 (85.8750) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [30/34] time 0.191 (0.184) data 0.114 (0.102) loss_x loss_x 0.5361 (0.5640) acc_x 78.1250 (85.8333) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/16] time 0.181 (0.185) data 0.104 (0.104) loss_u loss_u 0.6035 (0.6643) acc_u 50.0000 (40.6250) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/16] time 0.161 (0.183) data 0.083 (0.103) loss_u loss_u 0.6587 (0.6863) acc_u 40.6250 (37.1875) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/16] time 0.172 (0.185) data 0.095 (0.102) loss_u loss_u 0.6680 (0.6843) acc_u 34.3750 (36.4583) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 356
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1121
clean true:1115
clean false:6
clean_rate:0.9946476360392507
noisy true:145
noisy false:350
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 495
epoch [133/200] batch [5/35] time 0.167 (0.172) data 0.090 (0.094) loss_x loss_x 0.6343 (0.4299) acc_x 81.2500 (86.8750) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [10/35] time 0.181 (0.182) data 0.105 (0.104) loss_x loss_x 0.7246 (0.4767) acc_x 78.1250 (85.9375) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/35] time 0.158 (0.184) data 0.081 (0.099) loss_x loss_x 0.6074 (0.5096) acc_x 87.5000 (86.0417) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [20/35] time 0.200 (0.183) data 0.123 (0.101) loss_x loss_x 0.4165 (0.4925) acc_x 87.5000 (87.0312) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/35] time 0.171 (0.182) data 0.094 (0.101) loss_x loss_x 0.7480 (0.5320) acc_x 78.1250 (86.2500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [30/35] time 0.201 (0.185) data 0.124 (0.104) loss_x loss_x 0.7783 (0.5311) acc_x 78.1250 (85.9375) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [35/35] time 0.158 (0.183) data 0.081 (0.103) loss_x loss_x 0.3677 (0.5353) acc_x 90.6250 (85.8036) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/15] time 0.230 (0.184) data 0.113 (0.104) loss_u loss_u 0.6934 (0.6794) acc_u 37.5000 (36.8750) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [10/15] time 0.169 (0.184) data 0.091 (0.102) loss_u loss_u 0.6348 (0.7068) acc_u 40.6250 (33.7500) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [15/15] time 0.168 (0.183) data 0.091 (0.102) loss_u loss_u 0.8477 (0.6965) acc_u 18.7500 (35.2083) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 373
confident_label rate tensor(0.6801, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1099
clean true:1094
clean false:5
clean_rate:0.9954504094631483
noisy true:149
noisy false:368
after delete: len(clean_dataset) 1099
after delete: len(noisy_dataset) 517
epoch [134/200] batch [5/34] time 0.169 (0.182) data 0.093 (0.105) loss_x loss_x 0.6465 (0.5289) acc_x 81.2500 (83.1250) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/34] time 0.160 (0.175) data 0.083 (0.098) loss_x loss_x 0.6938 (0.5122) acc_x 84.3750 (85.3125) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/34] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.5381 (0.5303) acc_x 84.3750 (84.7917) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/34] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.3572 (0.5100) acc_x 87.5000 (86.2500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/34] time 0.185 (0.176) data 0.108 (0.096) loss_x loss_x 0.6562 (0.5028) acc_x 71.8750 (86.6250) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/34] time 0.161 (0.175) data 0.084 (0.095) loss_x loss_x 0.6899 (0.5232) acc_x 84.3750 (86.1458) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/16] time 0.157 (0.175) data 0.079 (0.096) loss_u loss_u 0.7827 (0.7311) acc_u 25.0000 (31.2500) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [10/16] time 0.157 (0.173) data 0.079 (0.094) loss_u loss_u 0.7832 (0.7234) acc_u 31.2500 (32.5000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [15/16] time 0.159 (0.171) data 0.081 (0.093) loss_u loss_u 0.7500 (0.7276) acc_u 21.8750 (31.6667) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 349
confident_label rate tensor(0.6968, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1126
clean true:1120
clean false:6
clean_rate:0.9946714031971581
noisy true:147
noisy false:343
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 490
epoch [135/200] batch [5/35] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.3647 (0.5421) acc_x 93.7500 (87.5000) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [10/35] time 0.233 (0.181) data 0.101 (0.098) loss_x loss_x 0.5796 (0.6161) acc_x 90.6250 (85.6250) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [15/35] time 0.172 (0.190) data 0.095 (0.104) loss_x loss_x 0.7324 (0.6159) acc_x 75.0000 (85.0000) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/35] time 0.173 (0.185) data 0.096 (0.102) loss_x loss_x 0.5205 (0.5979) acc_x 93.7500 (85.0000) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/35] time 0.156 (0.182) data 0.079 (0.100) loss_x loss_x 0.3838 (0.5720) acc_x 93.7500 (85.2500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/35] time 0.163 (0.180) data 0.085 (0.099) loss_x loss_x 0.2271 (0.5496) acc_x 96.8750 (85.8333) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [35/35] time 0.155 (0.178) data 0.078 (0.097) loss_x loss_x 0.7847 (0.5785) acc_x 84.3750 (85.1786) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/15] time 0.287 (0.181) data 0.097 (0.098) loss_u loss_u 0.6826 (0.7317) acc_u 40.6250 (32.5000) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [10/15] time 0.173 (0.181) data 0.096 (0.098) loss_u loss_u 0.7104 (0.7195) acc_u 34.3750 (32.5000) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [15/15] time 0.161 (0.179) data 0.083 (0.097) loss_u loss_u 0.7910 (0.7205) acc_u 25.0000 (32.7083) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 349
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1120
clean true:1118
clean false:2
clean_rate:0.9982142857142857
noisy true:149
noisy false:347
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 496
epoch [136/200] batch [5/35] time 0.202 (0.184) data 0.126 (0.107) loss_x loss_x 0.8423 (0.5169) acc_x 81.2500 (85.0000) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [10/35] time 0.160 (0.179) data 0.083 (0.102) loss_x loss_x 0.6821 (0.5769) acc_x 81.2500 (84.6875) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [15/35] time 0.157 (0.172) data 0.080 (0.095) loss_x loss_x 0.2133 (0.5846) acc_x 100.0000 (85.6250) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [20/35] time 0.158 (0.168) data 0.081 (0.091) loss_x loss_x 0.4893 (0.5762) acc_x 81.2500 (84.8438) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/35] time 0.158 (0.166) data 0.081 (0.089) loss_x loss_x 0.6558 (0.5600) acc_x 81.2500 (84.7500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [30/35] time 0.156 (0.164) data 0.079 (0.087) loss_x loss_x 0.2305 (0.5701) acc_x 93.7500 (84.2708) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [35/35] time 0.184 (0.169) data 0.106 (0.087) loss_x loss_x 0.9487 (0.5899) acc_x 81.2500 (83.8393) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/15] time 0.201 (0.170) data 0.124 (0.089) loss_u loss_u 0.6001 (0.7083) acc_u 43.7500 (35.0000) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [10/15] time 0.181 (0.171) data 0.104 (0.090) loss_u loss_u 0.6655 (0.7138) acc_u 37.5000 (33.4375) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [15/15] time 0.167 (0.171) data 0.090 (0.091) loss_u loss_u 0.6167 (0.7052) acc_u 43.7500 (34.5833) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 346
confident_label rate tensor(0.6993, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1130
clean true:1123
clean false:7
clean_rate:0.9938053097345133
noisy true:147
noisy false:339
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 486
epoch [137/200] batch [5/35] time 0.205 (0.175) data 0.128 (0.098) loss_x loss_x 0.6294 (0.5070) acc_x 78.1250 (89.3750) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [10/35] time 0.193 (0.174) data 0.116 (0.097) loss_x loss_x 0.6924 (0.5227) acc_x 81.2500 (88.1250) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [15/35] time 0.184 (0.186) data 0.107 (0.101) loss_x loss_x 0.5381 (0.5518) acc_x 87.5000 (88.1250) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/35] time 0.186 (0.185) data 0.110 (0.102) loss_x loss_x 0.5332 (0.5507) acc_x 90.6250 (88.2812) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/35] time 0.160 (0.183) data 0.084 (0.102) loss_x loss_x 0.6855 (0.5389) acc_x 81.2500 (88.2500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/35] time 0.181 (0.181) data 0.105 (0.100) loss_x loss_x 0.5659 (0.5511) acc_x 90.6250 (87.3958) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [35/35] time 0.176 (0.180) data 0.100 (0.100) loss_x loss_x 0.7603 (0.5601) acc_x 75.0000 (86.6071) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/15] time 0.186 (0.179) data 0.109 (0.100) loss_u loss_u 0.7183 (0.6789) acc_u 37.5000 (38.1250) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [10/15] time 0.168 (0.179) data 0.091 (0.099) loss_u loss_u 0.7349 (0.6817) acc_u 31.2500 (37.5000) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [15/15] time 0.274 (0.179) data 0.083 (0.098) loss_u loss_u 0.6626 (0.6843) acc_u 37.5000 (36.0417) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 363
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1109
clean true:1104
clean false:5
clean_rate:0.9954914337240758
noisy true:149
noisy false:358
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 507
epoch [138/200] batch [5/34] time 0.177 (0.170) data 0.100 (0.093) loss_x loss_x 0.5176 (0.5633) acc_x 90.6250 (88.7500) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/34] time 0.165 (0.171) data 0.088 (0.094) loss_x loss_x 0.4954 (0.5693) acc_x 90.6250 (87.8125) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [15/34] time 0.157 (0.172) data 0.080 (0.095) loss_x loss_x 0.4116 (0.5959) acc_x 90.6250 (87.7083) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/34] time 0.176 (0.180) data 0.098 (0.097) loss_x loss_x 0.6050 (0.5816) acc_x 84.3750 (86.8750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/34] time 0.189 (0.181) data 0.112 (0.100) loss_x loss_x 0.3164 (0.5565) acc_x 90.6250 (87.0000) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/34] time 0.156 (0.180) data 0.080 (0.099) loss_x loss_x 0.4697 (0.5489) acc_x 90.6250 (86.5625) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/15] time 0.195 (0.178) data 0.118 (0.098) loss_u loss_u 0.6880 (0.7118) acc_u 37.5000 (33.1250) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [10/15] time 0.172 (0.177) data 0.095 (0.098) loss_u loss_u 0.6880 (0.7026) acc_u 34.3750 (34.3750) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [15/15] time 0.170 (0.177) data 0.093 (0.097) loss_u loss_u 0.7407 (0.7007) acc_u 34.3750 (35.2083) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 348
confident_label rate tensor(0.6900, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1115
clean true:1110
clean false:5
clean_rate:0.9955156950672646
noisy true:158
noisy false:343
after delete: len(clean_dataset) 1115
after delete: len(noisy_dataset) 501
epoch [139/200] batch [5/34] time 0.188 (0.180) data 0.111 (0.103) loss_x loss_x 0.3152 (0.4341) acc_x 93.7500 (88.7500) lr 4.5098e-04 eta 0:00:05
epoch [139/200] batch [10/34] time 0.189 (0.179) data 0.112 (0.102) loss_x loss_x 0.4062 (0.5095) acc_x 90.6250 (86.8750) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [15/34] time 0.169 (0.185) data 0.093 (0.108) loss_x loss_x 0.6074 (0.5760) acc_x 78.1250 (84.7917) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [20/34] time 0.168 (0.184) data 0.091 (0.107) loss_x loss_x 0.6196 (0.5421) acc_x 81.2500 (85.9375) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/34] time 0.164 (0.182) data 0.087 (0.105) loss_x loss_x 0.5386 (0.5390) acc_x 84.3750 (86.1250) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/34] time 0.399 (0.192) data 0.322 (0.111) loss_x loss_x 0.3933 (0.5499) acc_x 87.5000 (85.8333) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/15] time 0.170 (0.191) data 0.092 (0.111) loss_u loss_u 0.6978 (0.6877) acc_u 31.2500 (35.0000) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [10/15] time 0.160 (0.188) data 0.082 (0.108) loss_u loss_u 0.6138 (0.6810) acc_u 43.7500 (36.2500) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [15/15] time 0.160 (0.185) data 0.082 (0.106) loss_u loss_u 0.7114 (0.6838) acc_u 37.5000 (36.6667) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 364
confident_label rate tensor(0.6838, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1105
clean true:1100
clean false:5
clean_rate:0.995475113122172
noisy true:152
noisy false:359
after delete: len(clean_dataset) 1105
after delete: len(noisy_dataset) 511
epoch [140/200] batch [5/34] time 0.213 (0.196) data 0.136 (0.118) loss_x loss_x 0.6138 (0.4962) acc_x 84.3750 (88.1250) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [10/34] time 0.162 (0.181) data 0.084 (0.104) loss_x loss_x 0.5864 (0.5181) acc_x 81.2500 (86.8750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/34] time 0.158 (0.178) data 0.081 (0.101) loss_x loss_x 1.1533 (0.5684) acc_x 65.6250 (85.0000) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/34] time 0.170 (0.177) data 0.092 (0.099) loss_x loss_x 0.4944 (0.5558) acc_x 84.3750 (85.3125) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/34] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.6001 (0.5676) acc_x 84.3750 (85.0000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/34] time 0.172 (0.176) data 0.096 (0.099) loss_x loss_x 0.5459 (0.5957) acc_x 87.5000 (83.7500) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/15] time 0.285 (0.181) data 0.094 (0.100) loss_u loss_u 0.6011 (0.6526) acc_u 43.7500 (41.2500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [10/15] time 0.162 (0.180) data 0.084 (0.099) loss_u loss_u 0.7715 (0.6912) acc_u 25.0000 (35.6250) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [15/15] time 0.159 (0.179) data 0.081 (0.098) loss_u loss_u 0.6016 (0.6935) acc_u 43.7500 (36.2500) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 358
confident_label rate tensor(0.6881, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1112
clean true:1106
clean false:6
clean_rate:0.9946043165467626
noisy true:152
noisy false:352
after delete: len(clean_dataset) 1112
after delete: len(noisy_dataset) 504
epoch [141/200] batch [5/34] time 0.188 (0.206) data 0.111 (0.130) loss_x loss_x 0.2477 (0.4881) acc_x 93.7500 (88.1250) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [10/34] time 0.169 (0.197) data 0.092 (0.120) loss_x loss_x 0.3101 (0.4771) acc_x 90.6250 (87.8125) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/34] time 0.189 (0.197) data 0.110 (0.113) loss_x loss_x 0.7632 (0.5525) acc_x 81.2500 (85.8333) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/34] time 0.182 (0.194) data 0.105 (0.111) loss_x loss_x 0.4067 (0.5436) acc_x 90.6250 (85.9375) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/34] time 0.183 (0.192) data 0.106 (0.110) loss_x loss_x 0.6914 (0.5412) acc_x 78.1250 (85.8750) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/34] time 0.157 (0.187) data 0.080 (0.106) loss_x loss_x 0.5747 (0.5346) acc_x 78.1250 (85.6250) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/15] time 0.161 (0.181) data 0.084 (0.101) loss_u loss_u 0.7617 (0.7211) acc_u 28.1250 (34.3750) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [10/15] time 0.275 (0.181) data 0.084 (0.099) loss_u loss_u 0.6802 (0.7157) acc_u 37.5000 (32.8125) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [15/15] time 0.182 (0.180) data 0.104 (0.098) loss_u loss_u 0.7690 (0.7191) acc_u 28.1250 (31.8750) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 342
confident_label rate tensor(0.6968, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1126
clean true:1122
clean false:4
clean_rate:0.9964476021314387
noisy true:152
noisy false:338
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 490
epoch [142/200] batch [5/35] time 0.158 (0.164) data 0.081 (0.087) loss_x loss_x 0.5845 (0.4431) acc_x 78.1250 (86.8750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/35] time 0.189 (0.167) data 0.113 (0.090) loss_x loss_x 0.6924 (0.5224) acc_x 81.2500 (85.3125) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/35] time 0.172 (0.175) data 0.094 (0.091) loss_x loss_x 0.4636 (0.5675) acc_x 87.5000 (83.9583) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/35] time 0.164 (0.174) data 0.088 (0.091) loss_x loss_x 0.5986 (0.5717) acc_x 84.3750 (83.9062) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/35] time 0.174 (0.174) data 0.097 (0.092) loss_x loss_x 0.6787 (0.5500) acc_x 78.1250 (85.0000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/35] time 0.187 (0.176) data 0.111 (0.096) loss_x loss_x 0.4399 (0.5585) acc_x 90.6250 (84.7917) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [35/35] time 0.214 (0.179) data 0.136 (0.099) loss_x loss_x 0.4182 (0.5506) acc_x 90.6250 (85.0000) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/15] time 0.180 (0.181) data 0.102 (0.101) loss_u loss_u 0.6753 (0.6744) acc_u 37.5000 (35.6250) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [10/15] time 0.186 (0.182) data 0.108 (0.103) loss_u loss_u 0.6870 (0.6937) acc_u 37.5000 (34.6875) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [15/15] time 0.178 (0.187) data 0.100 (0.105) loss_u loss_u 0.7051 (0.6842) acc_u 37.5000 (36.4583) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 357
confident_label rate tensor(0.6937, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1121
clean true:1115
clean false:6
clean_rate:0.9946476360392507
noisy true:144
noisy false:351
after delete: len(clean_dataset) 1121
after delete: len(noisy_dataset) 495
epoch [143/200] batch [5/35] time 0.156 (0.166) data 0.079 (0.089) loss_x loss_x 0.7578 (0.7276) acc_x 81.2500 (83.1250) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/35] time 0.190 (0.178) data 0.113 (0.101) loss_x loss_x 0.4580 (0.6938) acc_x 81.2500 (80.9375) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [15/35] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 0.4954 (0.6432) acc_x 87.5000 (82.7083) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/35] time 0.168 (0.173) data 0.092 (0.096) loss_x loss_x 0.6753 (0.6277) acc_x 87.5000 (84.0625) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/35] time 0.178 (0.179) data 0.100 (0.098) loss_x loss_x 0.4563 (0.5920) acc_x 87.5000 (84.5000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/35] time 0.183 (0.178) data 0.107 (0.097) loss_x loss_x 0.7329 (0.5949) acc_x 78.1250 (83.8542) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [35/35] time 0.185 (0.181) data 0.107 (0.101) loss_x loss_x 0.6841 (0.5949) acc_x 81.2500 (83.9286) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/15] time 0.165 (0.181) data 0.088 (0.101) loss_u loss_u 0.7056 (0.7098) acc_u 34.3750 (35.0000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [10/15] time 0.164 (0.179) data 0.087 (0.100) loss_u loss_u 0.8149 (0.7099) acc_u 18.7500 (34.3750) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [15/15] time 0.161 (0.182) data 0.084 (0.103) loss_u loss_u 0.7100 (0.6855) acc_u 34.3750 (37.0833) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 331
confident_label rate tensor(0.7030, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1136
clean true:1131
clean false:5
clean_rate:0.9955985915492958
noisy true:154
noisy false:326
after delete: len(clean_dataset) 1136
after delete: len(noisy_dataset) 480
epoch [144/200] batch [5/35] time 0.189 (0.197) data 0.111 (0.120) loss_x loss_x 0.5571 (0.7042) acc_x 87.5000 (82.5000) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [10/35] time 0.168 (0.181) data 0.091 (0.104) loss_x loss_x 0.4619 (0.6114) acc_x 87.5000 (85.0000) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [15/35] time 0.204 (0.181) data 0.127 (0.104) loss_x loss_x 0.2769 (0.5693) acc_x 90.6250 (85.4167) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/35] time 0.212 (0.185) data 0.135 (0.103) loss_x loss_x 0.6089 (0.5729) acc_x 78.1250 (84.6875) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/35] time 0.169 (0.184) data 0.092 (0.102) loss_x loss_x 0.2189 (0.5480) acc_x 90.6250 (85.0000) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/35] time 0.168 (0.182) data 0.092 (0.102) loss_x loss_x 0.4443 (0.5433) acc_x 90.6250 (85.4167) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [35/35] time 0.164 (0.180) data 0.087 (0.100) loss_x loss_x 0.4888 (0.5367) acc_x 87.5000 (85.8036) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/15] time 0.163 (0.178) data 0.086 (0.098) loss_u loss_u 0.7544 (0.7070) acc_u 37.5000 (35.6250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [10/15] time 0.164 (0.177) data 0.087 (0.097) loss_u loss_u 0.7021 (0.7131) acc_u 34.3750 (33.7500) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [15/15] time 0.254 (0.178) data 0.084 (0.096) loss_u loss_u 0.7632 (0.7140) acc_u 25.0000 (32.7083) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 368
confident_label rate tensor(0.6844, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1106
clean true:1100
clean false:6
clean_rate:0.9945750452079566
noisy true:148
noisy false:362
after delete: len(clean_dataset) 1106
after delete: len(noisy_dataset) 510
epoch [145/200] batch [5/34] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 0.5513 (0.7914) acc_x 81.2500 (80.6250) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [10/34] time 0.209 (0.180) data 0.132 (0.103) loss_x loss_x 0.3999 (0.6101) acc_x 87.5000 (84.0625) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [15/34] time 0.196 (0.182) data 0.118 (0.105) loss_x loss_x 0.4553 (0.5566) acc_x 90.6250 (86.6667) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [20/34] time 0.211 (0.187) data 0.097 (0.108) loss_x loss_x 0.5796 (0.5598) acc_x 81.2500 (85.9375) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/34] time 0.178 (0.189) data 0.101 (0.107) loss_x loss_x 0.3816 (0.5480) acc_x 90.6250 (86.5000) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [30/34] time 0.176 (0.188) data 0.099 (0.107) loss_x loss_x 0.4512 (0.5390) acc_x 90.6250 (86.8750) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/15] time 0.184 (0.186) data 0.107 (0.106) loss_u loss_u 0.5874 (0.6136) acc_u 46.8750 (45.0000) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [10/15] time 0.187 (0.186) data 0.109 (0.106) loss_u loss_u 0.6348 (0.6445) acc_u 40.6250 (41.5625) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [15/15] time 0.182 (0.186) data 0.105 (0.106) loss_u loss_u 0.6587 (0.6699) acc_u 40.6250 (39.3750) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 329
confident_label rate tensor(0.7036, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1137
clean true:1132
clean false:5
clean_rate:0.9956024626209323
noisy true:155
noisy false:324
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 479
epoch [146/200] batch [5/35] time 0.166 (0.163) data 0.089 (0.086) loss_x loss_x 0.7061 (0.6520) acc_x 84.3750 (86.8750) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/35] time 0.158 (0.162) data 0.081 (0.085) loss_x loss_x 0.2208 (0.5468) acc_x 96.8750 (87.8125) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [15/35] time 0.156 (0.160) data 0.080 (0.083) loss_x loss_x 0.6411 (0.5515) acc_x 81.2500 (86.6667) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/35] time 0.162 (0.160) data 0.085 (0.083) loss_x loss_x 0.1864 (0.5361) acc_x 100.0000 (87.0312) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/35] time 0.168 (0.168) data 0.092 (0.086) loss_x loss_x 0.7227 (0.5455) acc_x 81.2500 (86.6250) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/35] time 0.193 (0.168) data 0.117 (0.087) loss_x loss_x 0.6855 (0.5410) acc_x 78.1250 (86.6667) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [35/35] time 0.170 (0.168) data 0.094 (0.087) loss_x loss_x 0.5273 (0.5336) acc_x 87.5000 (86.6071) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/14] time 0.161 (0.169) data 0.084 (0.089) loss_u loss_u 0.7603 (0.7175) acc_u 31.2500 (35.6250) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [10/14] time 0.170 (0.170) data 0.093 (0.090) loss_u loss_u 0.8076 (0.7021) acc_u 18.7500 (35.0000) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 340
confident_label rate tensor(0.7017, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1134
clean true:1127
clean false:7
clean_rate:0.9938271604938271
noisy true:149
noisy false:333
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 482
epoch [147/200] batch [5/35] time 0.161 (0.170) data 0.082 (0.093) loss_x loss_x 0.1892 (0.4400) acc_x 96.8750 (89.3750) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [10/35] time 0.183 (0.173) data 0.107 (0.097) loss_x loss_x 0.4841 (0.5106) acc_x 87.5000 (88.4375) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [15/35] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.7485 (0.5205) acc_x 71.8750 (86.8750) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/35] time 0.198 (0.174) data 0.121 (0.097) loss_x loss_x 0.5786 (0.5186) acc_x 75.0000 (86.0938) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/35] time 0.177 (0.175) data 0.100 (0.099) loss_x loss_x 0.3044 (0.5307) acc_x 90.6250 (86.7500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/35] time 0.202 (0.181) data 0.125 (0.101) loss_x loss_x 0.8687 (0.5260) acc_x 75.0000 (86.5625) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [35/35] time 0.209 (0.183) data 0.132 (0.102) loss_x loss_x 0.5371 (0.5232) acc_x 84.3750 (86.2500) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/15] time 0.187 (0.184) data 0.109 (0.105) loss_u loss_u 0.7607 (0.7133) acc_u 25.0000 (33.1250) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [10/15] time 0.159 (0.184) data 0.082 (0.104) loss_u loss_u 0.6582 (0.7099) acc_u 37.5000 (32.8125) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [15/15] time 0.167 (0.183) data 0.089 (0.104) loss_u loss_u 0.7578 (0.6997) acc_u 28.1250 (34.1667) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 343
confident_label rate tensor(0.6955, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1124
clean true:1118
clean false:6
clean_rate:0.994661921708185
noisy true:155
noisy false:337
after delete: len(clean_dataset) 1124
after delete: len(noisy_dataset) 492
epoch [148/200] batch [5/35] time 0.158 (0.166) data 0.081 (0.088) loss_x loss_x 0.1616 (0.4461) acc_x 96.8750 (90.6250) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/35] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.6538 (0.4874) acc_x 81.2500 (87.8125) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [15/35] time 0.178 (0.180) data 0.102 (0.103) loss_x loss_x 0.3811 (0.5155) acc_x 90.6250 (86.8750) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/35] time 0.171 (0.179) data 0.094 (0.103) loss_x loss_x 0.4224 (0.5271) acc_x 87.5000 (86.0938) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/35] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.7197 (0.5463) acc_x 81.2500 (85.5000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/35] time 0.170 (0.181) data 0.093 (0.104) loss_x loss_x 0.2649 (0.5449) acc_x 93.7500 (85.3125) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [35/35] time 0.287 (0.184) data 0.103 (0.104) loss_x loss_x 0.4880 (0.5329) acc_x 87.5000 (85.8929) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/15] time 0.188 (0.185) data 0.111 (0.104) loss_u loss_u 0.6963 (0.6967) acc_u 34.3750 (33.7500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [10/15] time 0.176 (0.185) data 0.098 (0.105) loss_u loss_u 0.7085 (0.6979) acc_u 34.3750 (34.6875) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [15/15] time 0.185 (0.184) data 0.107 (0.105) loss_u loss_u 0.6689 (0.7007) acc_u 37.5000 (33.7500) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 344
confident_label rate tensor(0.7005, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1132
clean true:1126
clean false:6
clean_rate:0.9946996466431095
noisy true:146
noisy false:338
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 484
epoch [149/200] batch [5/35] time 0.178 (0.185) data 0.100 (0.108) loss_x loss_x 0.5322 (0.5020) acc_x 84.3750 (86.8750) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [10/35] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.4697 (0.5984) acc_x 90.6250 (85.9375) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [15/35] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.3035 (0.5268) acc_x 93.7500 (87.2917) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/35] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.9526 (0.5436) acc_x 75.0000 (86.4062) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/35] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.5103 (0.5337) acc_x 84.3750 (86.2500) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/35] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.5845 (0.5337) acc_x 84.3750 (86.3542) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [35/35] time 0.180 (0.183) data 0.103 (0.103) loss_x loss_x 0.5327 (0.5304) acc_x 87.5000 (86.7857) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/15] time 0.189 (0.183) data 0.111 (0.103) loss_u loss_u 0.6221 (0.6944) acc_u 40.6250 (33.7500) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [10/15] time 0.173 (0.183) data 0.095 (0.103) loss_u loss_u 0.7715 (0.6873) acc_u 28.1250 (35.0000) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [15/15] time 0.170 (0.183) data 0.092 (0.104) loss_u loss_u 0.7368 (0.7143) acc_u 31.2500 (32.7083) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 365
confident_label rate tensor(0.6875, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1111
clean true:1107
clean false:4
clean_rate:0.9963996399639964
noisy true:144
noisy false:361
after delete: len(clean_dataset) 1111
after delete: len(noisy_dataset) 505
epoch [150/200] batch [5/34] time 0.177 (0.172) data 0.100 (0.095) loss_x loss_x 0.4612 (0.3708) acc_x 90.6250 (91.2500) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/34] time 0.262 (0.185) data 0.109 (0.091) loss_x loss_x 0.5034 (0.4831) acc_x 81.2500 (86.8750) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/34] time 0.182 (0.181) data 0.106 (0.092) loss_x loss_x 0.4131 (0.4802) acc_x 84.3750 (85.6250) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/34] time 0.174 (0.177) data 0.097 (0.092) loss_x loss_x 0.9502 (0.5027) acc_x 78.1250 (85.0000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/34] time 0.173 (0.176) data 0.096 (0.092) loss_x loss_x 0.5073 (0.4903) acc_x 90.6250 (85.8750) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/34] time 0.162 (0.175) data 0.085 (0.092) loss_x loss_x 0.5420 (0.5019) acc_x 93.7500 (86.2500) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/15] time 0.161 (0.173) data 0.083 (0.091) loss_u loss_u 0.7056 (0.6622) acc_u 37.5000 (40.6250) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [10/15] time 0.162 (0.172) data 0.085 (0.090) loss_u loss_u 0.6670 (0.6792) acc_u 37.5000 (38.4375) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [15/15] time 0.255 (0.173) data 0.121 (0.090) loss_u loss_u 0.7734 (0.7033) acc_u 31.2500 (35.6250) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 313
confident_label rate tensor(0.7123, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1151
clean true:1146
clean false:5
clean_rate:0.9956559513466551
noisy true:157
noisy false:308
after delete: len(clean_dataset) 1151
after delete: len(noisy_dataset) 465
epoch [151/200] batch [5/35] time 0.178 (0.171) data 0.100 (0.094) loss_x loss_x 0.4988 (0.4664) acc_x 87.5000 (86.2500) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [10/35] time 0.158 (0.170) data 0.081 (0.093) loss_x loss_x 0.6631 (0.5801) acc_x 84.3750 (84.3750) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [15/35] time 0.191 (0.175) data 0.114 (0.098) loss_x loss_x 0.9648 (0.5763) acc_x 75.0000 (84.7917) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [20/35] time 0.282 (0.187) data 0.096 (0.104) loss_x loss_x 0.5479 (0.5941) acc_x 84.3750 (84.3750) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/35] time 0.200 (0.187) data 0.123 (0.105) loss_x loss_x 0.3933 (0.5932) acc_x 93.7500 (84.5000) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/35] time 0.162 (0.187) data 0.086 (0.106) loss_x loss_x 0.7544 (0.6034) acc_x 81.2500 (84.0625) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [35/35] time 0.160 (0.185) data 0.082 (0.104) loss_x loss_x 0.5801 (0.5960) acc_x 78.1250 (84.2857) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/14] time 0.172 (0.185) data 0.095 (0.105) loss_u loss_u 0.7314 (0.7260) acc_u 31.2500 (33.1250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [10/14] time 0.188 (0.184) data 0.111 (0.105) loss_u loss_u 0.7407 (0.7247) acc_u 31.2500 (32.8125) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 332
confident_label rate tensor(0.6993, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1130
clean true:1125
clean false:5
clean_rate:0.995575221238938
noisy true:159
noisy false:327
after delete: len(clean_dataset) 1130
after delete: len(noisy_dataset) 486
epoch [152/200] batch [5/35] time 0.162 (0.195) data 0.085 (0.097) loss_x loss_x 0.8564 (0.7072) acc_x 81.2500 (84.3750) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [10/35] time 0.163 (0.181) data 0.087 (0.093) loss_x loss_x 0.5054 (0.6473) acc_x 90.6250 (85.3125) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [15/35] time 0.216 (0.179) data 0.138 (0.095) loss_x loss_x 0.6084 (0.6233) acc_x 84.3750 (84.7917) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [20/35] time 0.165 (0.175) data 0.088 (0.093) loss_x loss_x 0.3047 (0.5803) acc_x 93.7500 (85.1562) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/35] time 0.166 (0.173) data 0.089 (0.091) loss_x loss_x 0.8501 (0.6073) acc_x 78.1250 (84.6250) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/35] time 0.159 (0.175) data 0.081 (0.091) loss_x loss_x 0.7319 (0.5833) acc_x 78.1250 (85.1042) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [35/35] time 0.158 (0.172) data 0.081 (0.090) loss_x loss_x 0.4951 (0.5721) acc_x 90.6250 (85.2679) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/15] time 0.172 (0.172) data 0.093 (0.089) loss_u loss_u 0.7476 (0.7448) acc_u 28.1250 (28.1250) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [10/15] time 0.185 (0.172) data 0.107 (0.091) loss_u loss_u 0.6040 (0.7107) acc_u 46.8750 (33.1250) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [15/15] time 0.185 (0.174) data 0.109 (0.092) loss_u loss_u 0.7969 (0.7006) acc_u 21.8750 (34.7917) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 338
confident_label rate tensor(0.7011, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1133
clean true:1127
clean false:6
clean_rate:0.9947043248014121
noisy true:151
noisy false:332
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 483
epoch [153/200] batch [5/35] time 0.156 (0.164) data 0.079 (0.087) loss_x loss_x 0.2922 (0.4821) acc_x 93.7500 (86.8750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/35] time 0.280 (0.181) data 0.095 (0.094) loss_x loss_x 1.1230 (0.5493) acc_x 75.0000 (86.8750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/35] time 0.164 (0.186) data 0.088 (0.095) loss_x loss_x 0.5356 (0.5321) acc_x 93.7500 (87.5000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/35] time 0.173 (0.184) data 0.096 (0.096) loss_x loss_x 0.4792 (0.5136) acc_x 93.7500 (87.9688) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/35] time 0.165 (0.182) data 0.089 (0.096) loss_x loss_x 0.4819 (0.4946) acc_x 87.5000 (88.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/35] time 0.176 (0.181) data 0.099 (0.097) loss_x loss_x 0.4368 (0.5300) acc_x 90.6250 (87.0833) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [35/35] time 0.193 (0.182) data 0.116 (0.099) loss_x loss_x 0.5342 (0.5370) acc_x 84.3750 (86.5179) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/15] time 0.180 (0.181) data 0.103 (0.099) loss_u loss_u 0.7578 (0.6922) acc_u 28.1250 (33.7500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [10/15] time 0.187 (0.182) data 0.109 (0.100) loss_u loss_u 0.6753 (0.6885) acc_u 37.5000 (34.3750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [15/15] time 0.175 (0.184) data 0.098 (0.100) loss_u loss_u 0.6440 (0.7050) acc_u 43.7500 (33.1250) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 347
confident_label rate tensor(0.6912, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1117
clean true:1113
clean false:4
clean_rate:0.9964189794091316
noisy true:156
noisy false:343
after delete: len(clean_dataset) 1117
after delete: len(noisy_dataset) 499
epoch [154/200] batch [5/34] time 0.164 (0.179) data 0.087 (0.102) loss_x loss_x 0.5024 (0.6685) acc_x 87.5000 (84.3750) lr 2.7103e-04 eta 0:00:05
epoch [154/200] batch [10/34] time 0.178 (0.177) data 0.100 (0.100) loss_x loss_x 0.5088 (0.6437) acc_x 84.3750 (81.8750) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/34] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 1.0068 (0.6679) acc_x 75.0000 (81.8750) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/34] time 0.175 (0.178) data 0.085 (0.100) loss_x loss_x 0.4919 (0.6138) acc_x 84.3750 (83.9062) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/34] time 0.172 (0.181) data 0.094 (0.099) loss_x loss_x 0.5020 (0.5836) acc_x 87.5000 (84.7500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/34] time 0.196 (0.179) data 0.119 (0.098) loss_x loss_x 0.4075 (0.5542) acc_x 87.5000 (85.8333) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/15] time 0.168 (0.179) data 0.091 (0.099) loss_u loss_u 0.6436 (0.6631) acc_u 34.3750 (39.3750) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [10/15] time 0.163 (0.179) data 0.086 (0.099) loss_u loss_u 0.8291 (0.6876) acc_u 18.7500 (35.9375) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [15/15] time 0.204 (0.179) data 0.127 (0.099) loss_u loss_u 0.7305 (0.6981) acc_u 31.2500 (35.6250) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 351
confident_label rate tensor(0.6968, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1126
clean true:1121
clean false:5
clean_rate:0.9955595026642984
noisy true:144
noisy false:346
after delete: len(clean_dataset) 1126
after delete: len(noisy_dataset) 490
epoch [155/200] batch [5/35] time 0.192 (0.179) data 0.116 (0.102) loss_x loss_x 0.3086 (0.5043) acc_x 90.6250 (85.6250) lr 2.6037e-04 eta 0:00:05
epoch [155/200] batch [10/35] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.3843 (0.5476) acc_x 90.6250 (85.6250) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/35] time 0.177 (0.174) data 0.101 (0.098) loss_x loss_x 0.7393 (0.5848) acc_x 81.2500 (85.2083) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/35] time 0.158 (0.175) data 0.080 (0.098) loss_x loss_x 0.7285 (0.5653) acc_x 84.3750 (85.7812) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/35] time 0.160 (0.175) data 0.083 (0.098) loss_x loss_x 0.7124 (0.5440) acc_x 78.1250 (85.8750) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/35] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.4343 (0.5524) acc_x 87.5000 (85.4167) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [35/35] time 0.172 (0.173) data 0.094 (0.096) loss_x loss_x 0.5713 (0.5588) acc_x 84.3750 (85.2679) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/15] time 0.158 (0.177) data 0.080 (0.097) loss_u loss_u 0.8281 (0.7019) acc_u 25.0000 (35.0000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [10/15] time 0.162 (0.175) data 0.084 (0.095) loss_u loss_u 0.7134 (0.6915) acc_u 31.2500 (36.2500) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [15/15] time 0.164 (0.174) data 0.085 (0.094) loss_u loss_u 0.7310 (0.7099) acc_u 34.3750 (34.1667) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 333
confident_label rate tensor(0.6980, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1128
clean true:1125
clean false:3
clean_rate:0.9973404255319149
noisy true:158
noisy false:330
after delete: len(clean_dataset) 1128
after delete: len(noisy_dataset) 488
epoch [156/200] batch [5/35] time 0.159 (0.169) data 0.082 (0.093) loss_x loss_x 0.5146 (0.4741) acc_x 87.5000 (86.2500) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/35] time 0.178 (0.182) data 0.101 (0.094) loss_x loss_x 0.7661 (0.5613) acc_x 78.1250 (84.3750) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/35] time 0.184 (0.177) data 0.107 (0.093) loss_x loss_x 0.6040 (0.6354) acc_x 84.3750 (83.1250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/35] time 0.173 (0.174) data 0.096 (0.092) loss_x loss_x 0.6143 (0.5945) acc_x 81.2500 (83.7500) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/35] time 0.159 (0.176) data 0.082 (0.095) loss_x loss_x 0.7368 (0.5736) acc_x 84.3750 (84.1250) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/35] time 0.180 (0.178) data 0.104 (0.097) loss_x loss_x 0.3384 (0.5521) acc_x 90.6250 (84.8958) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [35/35] time 0.174 (0.177) data 0.096 (0.097) loss_x loss_x 0.2073 (0.5406) acc_x 93.7500 (85.1786) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/15] time 0.169 (0.181) data 0.092 (0.098) loss_u loss_u 0.7832 (0.7219) acc_u 28.1250 (34.3750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [10/15] time 0.161 (0.179) data 0.082 (0.097) loss_u loss_u 0.6758 (0.7004) acc_u 43.7500 (36.5625) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [15/15] time 0.187 (0.178) data 0.109 (0.097) loss_u loss_u 0.6465 (0.6997) acc_u 37.5000 (35.8333) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 350
confident_label rate tensor(0.6863, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1109
clean true:1105
clean false:4
clean_rate:0.9963931469792606
noisy true:161
noisy false:346
after delete: len(clean_dataset) 1109
after delete: len(noisy_dataset) 507
epoch [157/200] batch [5/34] time 0.177 (0.175) data 0.099 (0.098) loss_x loss_x 0.5122 (0.5979) acc_x 93.7500 (86.8750) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/34] time 0.163 (0.176) data 0.087 (0.099) loss_x loss_x 0.5244 (0.6073) acc_x 84.3750 (84.0625) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/34] time 0.158 (0.185) data 0.080 (0.094) loss_x loss_x 0.6064 (0.6156) acc_x 84.3750 (84.3750) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/34] time 0.156 (0.179) data 0.079 (0.091) loss_x loss_x 0.8091 (0.6437) acc_x 81.2500 (83.7500) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/34] time 0.165 (0.176) data 0.088 (0.090) loss_x loss_x 0.5679 (0.6051) acc_x 84.3750 (84.6250) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/34] time 0.162 (0.174) data 0.085 (0.090) loss_x loss_x 0.5986 (0.5872) acc_x 87.5000 (85.2083) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/15] time 0.158 (0.174) data 0.082 (0.091) loss_u loss_u 0.7192 (0.6740) acc_u 40.6250 (39.3750) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [10/15] time 0.183 (0.175) data 0.105 (0.093) loss_u loss_u 0.6445 (0.6747) acc_u 43.7500 (38.1250) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [15/15] time 0.250 (0.177) data 0.111 (0.094) loss_u loss_u 0.6270 (0.6725) acc_u 40.6250 (38.3333) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 315
confident_label rate tensor(0.7085, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1145
clean true:1143
clean false:2
clean_rate:0.9982532751091703
noisy true:158
noisy false:313
after delete: len(clean_dataset) 1145
after delete: len(noisy_dataset) 471
epoch [158/200] batch [5/35] time 0.198 (0.183) data 0.121 (0.106) loss_x loss_x 0.6147 (0.5062) acc_x 84.3750 (88.1250) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [10/35] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 1.0020 (0.5466) acc_x 78.1250 (87.5000) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [15/35] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.4553 (0.5250) acc_x 90.6250 (88.1250) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/35] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.4126 (0.5342) acc_x 90.6250 (87.3438) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/35] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.5024 (0.5123) acc_x 78.1250 (87.1250) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/35] time 0.171 (0.185) data 0.093 (0.102) loss_x loss_x 0.5454 (0.5416) acc_x 78.1250 (86.4583) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [35/35] time 0.177 (0.184) data 0.100 (0.102) loss_x loss_x 0.2231 (0.5406) acc_x 96.8750 (86.6071) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/14] time 0.207 (0.185) data 0.129 (0.103) loss_u loss_u 0.6997 (0.6572) acc_u 34.3750 (38.7500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [10/14] time 0.185 (0.184) data 0.107 (0.103) loss_u loss_u 0.7012 (0.6865) acc_u 37.5000 (35.6250) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 322
confident_label rate tensor(0.7116, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1150
clean true:1146
clean false:4
clean_rate:0.9965217391304347
noisy true:148
noisy false:318
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 466
epoch [159/200] batch [5/35] time 0.183 (0.223) data 0.106 (0.105) loss_x loss_x 0.1927 (0.4892) acc_x 100.0000 (88.7500) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [10/35] time 0.166 (0.200) data 0.090 (0.102) loss_x loss_x 0.5371 (0.5231) acc_x 87.5000 (86.2500) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/35] time 0.159 (0.189) data 0.082 (0.099) loss_x loss_x 0.7246 (0.5254) acc_x 87.5000 (86.2500) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/35] time 0.159 (0.186) data 0.083 (0.099) loss_x loss_x 0.4553 (0.5327) acc_x 84.3750 (86.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/35] time 0.174 (0.184) data 0.097 (0.099) loss_x loss_x 0.5625 (0.5284) acc_x 78.1250 (86.1250) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/35] time 0.181 (0.182) data 0.104 (0.098) loss_x loss_x 0.4346 (0.5374) acc_x 84.3750 (85.8333) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [35/35] time 0.167 (0.183) data 0.090 (0.100) loss_x loss_x 0.4343 (0.5401) acc_x 87.5000 (85.3571) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/14] time 0.161 (0.183) data 0.084 (0.101) loss_u loss_u 0.8027 (0.7366) acc_u 21.8750 (27.5000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [10/14] time 0.186 (0.187) data 0.108 (0.103) loss_u loss_u 0.7207 (0.6889) acc_u 28.1250 (33.7500) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 297
confident_label rate tensor(0.7160, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1157
clean true:1154
clean false:3
clean_rate:0.9974070872947277
noisy true:165
noisy false:294
after delete: len(clean_dataset) 1157
after delete: len(noisy_dataset) 459
epoch [160/200] batch [5/36] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.5005 (0.5965) acc_x 90.6250 (85.0000) lr 2.0984e-04 eta 0:00:05
epoch [160/200] batch [10/36] time 0.166 (0.172) data 0.089 (0.095) loss_x loss_x 0.6182 (0.5590) acc_x 84.3750 (87.1875) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/36] time 0.187 (0.177) data 0.109 (0.100) loss_x loss_x 0.5391 (0.5891) acc_x 87.5000 (86.0417) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/36] time 0.183 (0.191) data 0.106 (0.108) loss_x loss_x 0.5718 (0.5623) acc_x 81.2500 (86.2500) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [25/36] time 0.167 (0.188) data 0.090 (0.107) loss_x loss_x 0.5186 (0.5389) acc_x 81.2500 (86.6250) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [30/36] time 0.162 (0.187) data 0.085 (0.106) loss_x loss_x 1.0225 (0.5422) acc_x 65.6250 (85.8333) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [35/36] time 0.159 (0.185) data 0.083 (0.105) loss_x loss_x 0.4434 (0.5255) acc_x 87.5000 (86.2500) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/14] time 0.160 (0.182) data 0.083 (0.102) loss_u loss_u 0.6460 (0.7187) acc_u 43.7500 (34.3750) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [10/14] time 0.160 (0.180) data 0.084 (0.100) loss_u loss_u 0.7104 (0.7059) acc_u 31.2500 (33.7500) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 338
confident_label rate tensor(0.6986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1129
clean true:1125
clean false:4
clean_rate:0.9964570416297609
noisy true:153
noisy false:334
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 487
epoch [161/200] batch [5/35] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.3501 (0.4599) acc_x 93.7500 (88.7500) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [10/35] time 0.176 (0.185) data 0.100 (0.109) loss_x loss_x 0.1992 (0.4749) acc_x 90.6250 (87.1875) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/35] time 0.172 (0.189) data 0.095 (0.112) loss_x loss_x 0.7080 (0.4434) acc_x 84.3750 (87.9167) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/35] time 0.188 (0.186) data 0.110 (0.109) loss_x loss_x 0.5605 (0.4709) acc_x 84.3750 (87.3438) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/35] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.4341 (0.4828) acc_x 87.5000 (87.1250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/35] time 0.159 (0.189) data 0.081 (0.109) loss_x loss_x 0.4136 (0.4934) acc_x 90.6250 (86.8750) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [35/35] time 0.183 (0.188) data 0.106 (0.108) loss_x loss_x 0.7520 (0.5139) acc_x 78.1250 (86.1607) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/15] time 0.212 (0.190) data 0.134 (0.110) loss_u loss_u 0.7729 (0.7169) acc_u 31.2500 (31.8750) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [10/15] time 0.185 (0.189) data 0.107 (0.109) loss_u loss_u 0.7183 (0.6948) acc_u 37.5000 (34.6875) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [15/15] time 0.189 (0.189) data 0.111 (0.109) loss_u loss_u 0.5249 (0.6977) acc_u 50.0000 (34.3750) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 339
confident_label rate tensor(0.6986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1129
clean true:1124
clean false:5
clean_rate:0.995571302037201
noisy true:153
noisy false:334
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 487
epoch [162/200] batch [5/35] time 0.159 (0.192) data 0.082 (0.083) loss_x loss_x 0.2744 (0.5600) acc_x 96.8750 (86.8750) lr 1.9098e-04 eta 0:00:05
epoch [162/200] batch [10/35] time 0.228 (0.190) data 0.151 (0.097) loss_x loss_x 0.1816 (0.5648) acc_x 96.8750 (85.9375) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/35] time 0.183 (0.193) data 0.106 (0.105) loss_x loss_x 0.2455 (0.5085) acc_x 93.7500 (87.5000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/35] time 0.188 (0.191) data 0.111 (0.105) loss_x loss_x 0.4861 (0.4892) acc_x 87.5000 (87.3438) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/35] time 0.184 (0.197) data 0.107 (0.109) loss_x loss_x 0.2939 (0.4700) acc_x 93.7500 (87.8750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [30/35] time 0.165 (0.194) data 0.088 (0.108) loss_x loss_x 0.9033 (0.5028) acc_x 81.2500 (87.2917) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [35/35] time 0.177 (0.194) data 0.100 (0.109) loss_x loss_x 0.4077 (0.5198) acc_x 84.3750 (87.2321) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/15] time 0.195 (0.192) data 0.117 (0.108) loss_u loss_u 0.6812 (0.6713) acc_u 37.5000 (36.8750) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [10/15] time 0.186 (0.191) data 0.108 (0.108) loss_u loss_u 0.6294 (0.6885) acc_u 43.7500 (36.2500) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [15/15] time 0.179 (0.193) data 0.099 (0.108) loss_u loss_u 0.7163 (0.6914) acc_u 34.3750 (36.0417) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 349
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1120
clean true:1114
clean false:6
clean_rate:0.9946428571428572
noisy true:153
noisy false:343
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 496
epoch [163/200] batch [5/35] time 0.181 (0.195) data 0.104 (0.107) loss_x loss_x 0.4456 (0.5447) acc_x 90.6250 (86.2500) lr 1.8185e-04 eta 0:00:05
epoch [163/200] batch [10/35] time 0.186 (0.196) data 0.109 (0.113) loss_x loss_x 0.2607 (0.5031) acc_x 93.7500 (86.8750) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/35] time 0.170 (0.187) data 0.093 (0.106) loss_x loss_x 0.5894 (0.5318) acc_x 84.3750 (85.6250) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/35] time 0.171 (0.183) data 0.094 (0.103) loss_x loss_x 0.3977 (0.5412) acc_x 90.6250 (85.6250) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/35] time 0.184 (0.182) data 0.107 (0.103) loss_x loss_x 0.4819 (0.5395) acc_x 87.5000 (86.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/35] time 0.160 (0.180) data 0.082 (0.101) loss_x loss_x 0.5288 (0.5544) acc_x 90.6250 (86.1458) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [35/35] time 0.281 (0.181) data 0.094 (0.099) loss_x loss_x 0.7944 (0.5538) acc_x 75.0000 (85.7143) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/15] time 0.173 (0.180) data 0.095 (0.098) loss_u loss_u 0.7256 (0.7414) acc_u 28.1250 (30.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [10/15] time 0.161 (0.178) data 0.084 (0.097) loss_u loss_u 0.7178 (0.7164) acc_u 34.3750 (31.5625) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [15/15] time 0.162 (0.176) data 0.085 (0.096) loss_u loss_u 0.5864 (0.7053) acc_u 46.8750 (33.5417) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 312
confident_label rate tensor(0.7092, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1146
clean true:1140
clean false:6
clean_rate:0.9947643979057592
noisy true:164
noisy false:306
after delete: len(clean_dataset) 1146
after delete: len(noisy_dataset) 470
epoch [164/200] batch [5/35] time 0.177 (0.199) data 0.100 (0.100) loss_x loss_x 0.4695 (0.3811) acc_x 84.3750 (90.6250) lr 1.7292e-04 eta 0:00:05
epoch [164/200] batch [10/35] time 0.181 (0.186) data 0.103 (0.098) loss_x loss_x 0.8906 (0.4716) acc_x 81.2500 (89.3750) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/35] time 0.172 (0.181) data 0.095 (0.097) loss_x loss_x 0.5117 (0.4671) acc_x 84.3750 (88.7500) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/35] time 0.186 (0.182) data 0.109 (0.100) loss_x loss_x 0.4099 (0.4813) acc_x 87.5000 (88.1250) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/35] time 0.248 (0.184) data 0.170 (0.102) loss_x loss_x 0.4478 (0.4859) acc_x 87.5000 (87.7500) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/35] time 0.186 (0.181) data 0.109 (0.100) loss_x loss_x 0.3428 (0.4820) acc_x 90.6250 (87.8125) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [35/35] time 0.153 (0.179) data 0.076 (0.099) loss_x loss_x 0.7734 (0.5138) acc_x 87.5000 (87.2321) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/14] time 0.161 (0.179) data 0.084 (0.099) loss_u loss_u 0.7715 (0.7077) acc_u 28.1250 (33.1250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [10/14] time 0.164 (0.180) data 0.086 (0.098) loss_u loss_u 0.6938 (0.7013) acc_u 37.5000 (34.6875) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 353
confident_label rate tensor(0.6943, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1122
clean true:1119
clean false:3
clean_rate:0.9973262032085561
noisy true:144
noisy false:350
after delete: len(clean_dataset) 1122
after delete: len(noisy_dataset) 494
epoch [165/200] batch [5/35] time 0.160 (0.162) data 0.083 (0.085) loss_x loss_x 0.5645 (0.6616) acc_x 84.3750 (81.8750) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/35] time 0.159 (0.161) data 0.082 (0.084) loss_x loss_x 0.2854 (0.5673) acc_x 93.7500 (85.3125) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/35] time 0.157 (0.160) data 0.080 (0.083) loss_x loss_x 0.7617 (0.5399) acc_x 78.1250 (86.8750) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/35] time 0.157 (0.167) data 0.081 (0.083) loss_x loss_x 0.6777 (0.5655) acc_x 81.2500 (86.2500) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/35] time 0.185 (0.167) data 0.108 (0.084) loss_x loss_x 0.6479 (0.5507) acc_x 87.5000 (86.0000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/35] time 0.185 (0.171) data 0.108 (0.089) loss_x loss_x 0.5327 (0.5447) acc_x 84.3750 (86.0417) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [35/35] time 0.179 (0.176) data 0.103 (0.094) loss_x loss_x 0.6895 (0.5552) acc_x 78.1250 (85.5357) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/15] time 0.221 (0.179) data 0.144 (0.098) loss_u loss_u 0.7783 (0.7094) acc_u 28.1250 (33.1250) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [10/15] time 0.167 (0.179) data 0.090 (0.099) loss_u loss_u 0.6616 (0.7008) acc_u 37.5000 (33.7500) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [15/15] time 0.191 (0.179) data 0.114 (0.099) loss_u loss_u 0.6909 (0.6981) acc_u 43.7500 (35.4167) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 326
confident_label rate tensor(0.7005, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1132
clean true:1129
clean false:3
clean_rate:0.9973498233215548
noisy true:161
noisy false:323
after delete: len(clean_dataset) 1132
after delete: len(noisy_dataset) 484
epoch [166/200] batch [5/35] time 0.171 (0.185) data 0.094 (0.108) loss_x loss_x 0.2827 (0.6487) acc_x 93.7500 (81.8750) lr 1.5567e-04 eta 0:00:05
epoch [166/200] batch [10/35] time 0.175 (0.180) data 0.098 (0.104) loss_x loss_x 0.2686 (0.5230) acc_x 93.7500 (85.6250) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/35] time 0.156 (0.179) data 0.079 (0.102) loss_x loss_x 0.8267 (0.5696) acc_x 78.1250 (84.7917) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/35] time 0.190 (0.178) data 0.113 (0.101) loss_x loss_x 0.5356 (0.5745) acc_x 84.3750 (85.0000) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/35] time 0.177 (0.184) data 0.100 (0.100) loss_x loss_x 0.6128 (0.5773) acc_x 84.3750 (85.1250) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/35] time 0.175 (0.182) data 0.098 (0.099) loss_x loss_x 0.2352 (0.5561) acc_x 93.7500 (85.4167) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [35/35] time 0.178 (0.181) data 0.101 (0.099) loss_x loss_x 0.4473 (0.5629) acc_x 90.6250 (84.8214) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/15] time 0.190 (0.182) data 0.113 (0.101) loss_u loss_u 0.6318 (0.7112) acc_u 37.5000 (31.8750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [10/15] time 0.168 (0.181) data 0.090 (0.100) loss_u loss_u 0.7329 (0.7019) acc_u 25.0000 (33.4375) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [15/15] time 0.179 (0.180) data 0.102 (0.100) loss_u loss_u 0.6426 (0.6997) acc_u 37.5000 (32.9167) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 321
confident_label rate tensor(0.7011, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1133
clean true:1130
clean false:3
clean_rate:0.9973521624007061
noisy true:165
noisy false:318
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 483
epoch [167/200] batch [5/35] time 0.240 (0.183) data 0.163 (0.106) loss_x loss_x 0.4438 (0.4515) acc_x 87.5000 (87.5000) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [10/35] time 0.174 (0.182) data 0.095 (0.105) loss_x loss_x 0.3337 (0.4968) acc_x 90.6250 (87.5000) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [15/35] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.3506 (0.4787) acc_x 93.7500 (87.2917) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/35] time 0.162 (0.175) data 0.084 (0.098) loss_x loss_x 0.3057 (0.5197) acc_x 90.6250 (86.2500) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/35] time 0.164 (0.174) data 0.087 (0.096) loss_x loss_x 0.2659 (0.5187) acc_x 93.7500 (86.1250) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/35] time 0.165 (0.177) data 0.088 (0.096) loss_x loss_x 0.8530 (0.5350) acc_x 75.0000 (85.9375) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [35/35] time 0.155 (0.175) data 0.078 (0.095) loss_x loss_x 0.3652 (0.5379) acc_x 90.6250 (85.8929) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/15] time 0.183 (0.175) data 0.106 (0.095) loss_u loss_u 0.6958 (0.6715) acc_u 40.6250 (38.7500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [10/15] time 0.171 (0.176) data 0.095 (0.096) loss_u loss_u 0.8267 (0.7082) acc_u 18.7500 (34.0625) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [15/15] time 0.180 (0.176) data 0.103 (0.097) loss_u loss_u 0.8096 (0.7185) acc_u 21.8750 (33.3333) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 336
confident_label rate tensor(0.7011, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1133
clean true:1129
clean false:4
clean_rate:0.9964695498676082
noisy true:151
noisy false:332
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 483
epoch [168/200] batch [5/35] time 0.179 (0.199) data 0.102 (0.122) loss_x loss_x 0.4229 (0.5528) acc_x 90.6250 (86.2500) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [10/35] time 0.198 (0.202) data 0.121 (0.116) loss_x loss_x 0.4880 (0.5131) acc_x 87.5000 (86.8750) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [15/35] time 0.156 (0.189) data 0.079 (0.106) loss_x loss_x 0.8481 (0.5250) acc_x 78.1250 (86.8750) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/35] time 0.156 (0.181) data 0.080 (0.100) loss_x loss_x 0.6040 (0.5185) acc_x 81.2500 (87.1875) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/35] time 0.158 (0.176) data 0.082 (0.096) loss_x loss_x 0.6509 (0.5137) acc_x 87.5000 (87.2500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/35] time 0.157 (0.173) data 0.081 (0.094) loss_x loss_x 0.2825 (0.5345) acc_x 93.7500 (86.5625) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [35/35] time 0.159 (0.174) data 0.083 (0.092) loss_x loss_x 0.1199 (0.5330) acc_x 96.8750 (86.7857) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/15] time 0.156 (0.172) data 0.079 (0.090) loss_u loss_u 0.6226 (0.7190) acc_u 40.6250 (31.8750) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [10/15] time 0.157 (0.170) data 0.081 (0.089) loss_u loss_u 0.6562 (0.7009) acc_u 40.6250 (34.6875) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [15/15] time 0.161 (0.171) data 0.083 (0.090) loss_u loss_u 0.6655 (0.7149) acc_u 40.6250 (33.1250) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 334
confident_label rate tensor(0.7036, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1137
clean true:1132
clean false:5
clean_rate:0.9956024626209323
noisy true:150
noisy false:329
after delete: len(clean_dataset) 1137
after delete: len(noisy_dataset) 479
epoch [169/200] batch [5/35] time 0.185 (0.185) data 0.107 (0.109) loss_x loss_x 0.4146 (0.3521) acc_x 90.6250 (91.2500) lr 1.3137e-04 eta 0:00:05
epoch [169/200] batch [10/35] time 0.178 (0.183) data 0.102 (0.107) loss_x loss_x 0.2178 (0.4101) acc_x 84.3750 (87.5000) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/35] time 0.173 (0.183) data 0.096 (0.106) loss_x loss_x 0.3555 (0.4571) acc_x 84.3750 (86.0417) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/35] time 0.174 (0.180) data 0.097 (0.103) loss_x loss_x 0.8770 (0.5046) acc_x 84.3750 (85.9375) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/35] time 0.168 (0.179) data 0.091 (0.102) loss_x loss_x 0.4341 (0.4871) acc_x 87.5000 (86.1250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/35] time 0.215 (0.180) data 0.122 (0.103) loss_x loss_x 0.4353 (0.5051) acc_x 84.3750 (85.8333) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [35/35] time 0.164 (0.182) data 0.088 (0.102) loss_x loss_x 0.4619 (0.4918) acc_x 84.3750 (86.1607) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/14] time 0.235 (0.185) data 0.157 (0.105) loss_u loss_u 0.6284 (0.6652) acc_u 40.6250 (38.7500) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [10/14] time 0.165 (0.185) data 0.087 (0.105) loss_u loss_u 0.8096 (0.6870) acc_u 25.0000 (36.2500) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 344
confident_label rate tensor(0.6962, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1125
clean true:1119
clean false:6
clean_rate:0.9946666666666667
noisy true:153
noisy false:338
after delete: len(clean_dataset) 1125
after delete: len(noisy_dataset) 491
epoch [170/200] batch [5/35] time 0.170 (0.162) data 0.093 (0.086) loss_x loss_x 0.6909 (0.5254) acc_x 84.3750 (86.2500) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/35] time 0.181 (0.166) data 0.104 (0.089) loss_x loss_x 0.9131 (0.5841) acc_x 78.1250 (85.3125) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/35] time 0.178 (0.177) data 0.101 (0.100) loss_x loss_x 0.9521 (0.5746) acc_x 81.2500 (86.2500) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/35] time 0.157 (0.176) data 0.081 (0.099) loss_x loss_x 0.2988 (0.5324) acc_x 93.7500 (87.0312) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/35] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.2705 (0.5341) acc_x 96.8750 (87.1250) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/35] time 0.188 (0.174) data 0.111 (0.097) loss_x loss_x 0.3186 (0.5445) acc_x 93.7500 (86.6667) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [35/35] time 0.233 (0.181) data 0.156 (0.099) loss_x loss_x 0.3010 (0.5626) acc_x 90.6250 (86.2500) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/15] time 0.176 (0.180) data 0.099 (0.098) loss_u loss_u 0.7939 (0.6371) acc_u 25.0000 (43.7500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [10/15] time 0.157 (0.179) data 0.080 (0.097) loss_u loss_u 0.7324 (0.6818) acc_u 31.2500 (37.8125) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [15/15] time 0.169 (0.178) data 0.091 (0.097) loss_u loss_u 0.8018 (0.6904) acc_u 28.1250 (36.6667) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 335
confident_label rate tensor(0.7017, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1134
clean true:1129
clean false:5
clean_rate:0.9955908289241623
noisy true:152
noisy false:330
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 482
epoch [171/200] batch [5/35] time 0.193 (0.212) data 0.116 (0.096) loss_x loss_x 0.4478 (0.4652) acc_x 90.6250 (88.1250) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [10/35] time 0.195 (0.194) data 0.118 (0.097) loss_x loss_x 0.6304 (0.5787) acc_x 84.3750 (85.0000) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [15/35] time 0.175 (0.188) data 0.098 (0.097) loss_x loss_x 0.3035 (0.5847) acc_x 93.7500 (85.6250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [20/35] time 0.163 (0.187) data 0.086 (0.100) loss_x loss_x 0.6992 (0.5842) acc_x 84.3750 (85.3125) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/35] time 0.178 (0.185) data 0.101 (0.100) loss_x loss_x 0.7188 (0.5879) acc_x 81.2500 (84.8750) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/35] time 0.186 (0.184) data 0.108 (0.100) loss_x loss_x 0.5601 (0.5760) acc_x 81.2500 (85.2083) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [35/35] time 0.188 (0.184) data 0.110 (0.101) loss_x loss_x 0.6274 (0.5697) acc_x 81.2500 (85.7143) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/15] time 0.169 (0.183) data 0.093 (0.101) loss_u loss_u 0.6987 (0.6897) acc_u 37.5000 (35.6250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [10/15] time 0.160 (0.185) data 0.084 (0.100) loss_u loss_u 0.7109 (0.6983) acc_u 34.3750 (34.0625) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [15/15] time 0.159 (0.182) data 0.082 (0.098) loss_u loss_u 0.7451 (0.6965) acc_u 25.0000 (34.3750) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 342
confident_label rate tensor(0.6986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1129
clean true:1124
clean false:5
clean_rate:0.995571302037201
noisy true:150
noisy false:337
after delete: len(clean_dataset) 1129
after delete: len(noisy_dataset) 487
epoch [172/200] batch [5/35] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.4404 (0.5783) acc_x 87.5000 (85.0000) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [10/35] time 0.187 (0.177) data 0.110 (0.100) loss_x loss_x 0.6396 (0.5290) acc_x 87.5000 (87.1875) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/35] time 0.189 (0.183) data 0.113 (0.106) loss_x loss_x 0.6528 (0.4966) acc_x 71.8750 (87.0833) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [20/35] time 0.182 (0.188) data 0.104 (0.106) loss_x loss_x 0.5674 (0.4914) acc_x 93.7500 (87.5000) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/35] time 0.174 (0.188) data 0.096 (0.106) loss_x loss_x 1.2441 (0.5142) acc_x 75.0000 (87.1250) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/35] time 0.183 (0.185) data 0.107 (0.104) loss_x loss_x 0.7373 (0.5420) acc_x 78.1250 (86.6667) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [35/35] time 0.242 (0.185) data 0.165 (0.105) loss_x loss_x 0.2466 (0.5298) acc_x 96.8750 (86.7857) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/15] time 0.175 (0.184) data 0.098 (0.104) loss_u loss_u 0.7173 (0.6906) acc_u 31.2500 (33.7500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [10/15] time 0.162 (0.181) data 0.084 (0.102) loss_u loss_u 0.7393 (0.7004) acc_u 28.1250 (34.6875) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [15/15] time 0.157 (0.180) data 0.080 (0.101) loss_u loss_u 0.6978 (0.7014) acc_u 37.5000 (34.7917) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 326
confident_label rate tensor(0.7073, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1143
clean true:1139
clean false:4
clean_rate:0.9965004374453194
noisy true:151
noisy false:322
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 473
epoch [173/200] batch [5/35] time 0.158 (0.160) data 0.082 (0.084) loss_x loss_x 0.6558 (0.7194) acc_x 87.5000 (84.3750) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/35] time 0.159 (0.160) data 0.083 (0.084) loss_x loss_x 0.3623 (0.6326) acc_x 87.5000 (85.6250) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/35] time 0.163 (0.160) data 0.087 (0.084) loss_x loss_x 0.4722 (0.5779) acc_x 90.6250 (85.4167) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/35] time 0.234 (0.164) data 0.081 (0.083) loss_x loss_x 0.5996 (0.5899) acc_x 84.3750 (84.8438) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/35] time 0.157 (0.166) data 0.081 (0.083) loss_x loss_x 0.4043 (0.6010) acc_x 90.6250 (84.0000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/35] time 0.158 (0.165) data 0.082 (0.083) loss_x loss_x 0.5942 (0.5992) acc_x 84.3750 (84.3750) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [35/35] time 0.161 (0.164) data 0.084 (0.083) loss_x loss_x 0.3735 (0.5794) acc_x 84.3750 (84.7321) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/14] time 0.171 (0.165) data 0.094 (0.084) loss_u loss_u 0.7212 (0.7691) acc_u 34.3750 (25.6250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [10/14] time 0.188 (0.166) data 0.111 (0.085) loss_u loss_u 0.5933 (0.7189) acc_u 46.8750 (31.8750) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 338
confident_label rate tensor(0.7024, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1135
clean true:1128
clean false:7
clean_rate:0.9938325991189427
noisy true:150
noisy false:331
after delete: len(clean_dataset) 1135
after delete: len(noisy_dataset) 481
epoch [174/200] batch [5/35] time 0.159 (0.172) data 0.082 (0.096) loss_x loss_x 0.3337 (0.4298) acc_x 87.5000 (89.3750) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [10/35] time 0.170 (0.176) data 0.094 (0.099) loss_x loss_x 0.3733 (0.4646) acc_x 93.7500 (88.1250) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [15/35] time 0.159 (0.175) data 0.082 (0.098) loss_x loss_x 0.8525 (0.5033) acc_x 84.3750 (87.5000) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/35] time 0.170 (0.174) data 0.091 (0.097) loss_x loss_x 0.4885 (0.4956) acc_x 84.3750 (87.3438) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/35] time 0.164 (0.176) data 0.087 (0.098) loss_x loss_x 0.6016 (0.5222) acc_x 81.2500 (86.3750) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/35] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.7090 (0.5304) acc_x 78.1250 (86.0417) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [35/35] time 0.177 (0.178) data 0.099 (0.100) loss_x loss_x 0.3484 (0.5134) acc_x 87.5000 (86.6071) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/15] time 0.193 (0.181) data 0.115 (0.101) loss_u loss_u 0.6455 (0.7103) acc_u 40.6250 (33.7500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [10/15] time 0.166 (0.181) data 0.088 (0.100) loss_u loss_u 0.6680 (0.6804) acc_u 37.5000 (37.1875) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [15/15] time 0.162 (0.180) data 0.084 (0.100) loss_u loss_u 0.7808 (0.6906) acc_u 25.0000 (35.0000) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 347
confident_label rate tensor(0.6925, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1119
clean true:1113
clean false:6
clean_rate:0.9946380697050938
noisy true:156
noisy false:341
after delete: len(clean_dataset) 1119
after delete: len(noisy_dataset) 497
epoch [175/200] batch [5/34] time 0.167 (0.170) data 0.090 (0.093) loss_x loss_x 0.2742 (0.5192) acc_x 93.7500 (86.8750) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/34] time 0.178 (0.169) data 0.100 (0.093) loss_x loss_x 0.6167 (0.5124) acc_x 81.2500 (87.1875) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/34] time 0.286 (0.180) data 0.099 (0.096) loss_x loss_x 0.5776 (0.4929) acc_x 78.1250 (87.2917) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/34] time 0.167 (0.182) data 0.090 (0.100) loss_x loss_x 0.6104 (0.5403) acc_x 84.3750 (86.2500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/34] time 0.186 (0.180) data 0.109 (0.099) loss_x loss_x 0.5098 (0.5331) acc_x 81.2500 (86.3750) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/34] time 0.166 (0.178) data 0.090 (0.097) loss_x loss_x 0.5864 (0.5558) acc_x 78.1250 (85.6250) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/15] time 0.181 (0.176) data 0.104 (0.096) loss_u loss_u 0.7031 (0.6580) acc_u 31.2500 (39.3750) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [10/15] time 0.192 (0.175) data 0.114 (0.096) loss_u loss_u 0.6338 (0.6708) acc_u 43.7500 (37.8125) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [15/15] time 0.176 (0.177) data 0.098 (0.098) loss_u loss_u 0.7759 (0.6915) acc_u 28.1250 (35.6250) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 333
confident_label rate tensor(0.7017, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1134
clean true:1128
clean false:6
clean_rate:0.9947089947089947
noisy true:155
noisy false:327
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 482
epoch [176/200] batch [5/35] time 0.161 (0.165) data 0.084 (0.088) loss_x loss_x 0.4280 (0.5821) acc_x 84.3750 (83.7500) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/35] time 0.167 (0.168) data 0.091 (0.091) loss_x loss_x 0.6885 (0.6206) acc_x 81.2500 (83.1250) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/35] time 0.168 (0.168) data 0.091 (0.091) loss_x loss_x 0.5562 (0.5971) acc_x 81.2500 (83.9583) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/35] time 0.204 (0.169) data 0.127 (0.092) loss_x loss_x 0.6177 (0.5923) acc_x 84.3750 (84.6875) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/35] time 0.188 (0.171) data 0.112 (0.093) loss_x loss_x 0.5020 (0.5914) acc_x 81.2500 (84.1250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/35] time 0.187 (0.172) data 0.110 (0.095) loss_x loss_x 0.7773 (0.5740) acc_x 81.2500 (84.7917) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [35/35] time 0.182 (0.177) data 0.104 (0.096) loss_x loss_x 0.4282 (0.5479) acc_x 87.5000 (85.6250) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/15] time 0.156 (0.175) data 0.078 (0.095) loss_u loss_u 0.6538 (0.6649) acc_u 40.6250 (40.6250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [10/15] time 0.158 (0.173) data 0.081 (0.093) loss_u loss_u 0.6860 (0.6751) acc_u 34.3750 (38.7500) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [15/15] time 0.156 (0.171) data 0.079 (0.092) loss_u loss_u 0.8652 (0.6995) acc_u 15.6250 (36.2500) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 356
confident_label rate tensor(0.6931, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1120
clean true:1112
clean false:8
clean_rate:0.9928571428571429
noisy true:148
noisy false:348
after delete: len(clean_dataset) 1120
after delete: len(noisy_dataset) 496
epoch [177/200] batch [5/35] time 0.172 (0.178) data 0.094 (0.101) loss_x loss_x 0.7974 (0.6881) acc_x 78.1250 (83.1250) lr 7.6120e-05 eta 0:00:05
epoch [177/200] batch [10/35] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.8037 (0.7130) acc_x 75.0000 (81.5625) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/35] time 0.157 (0.180) data 0.081 (0.103) loss_x loss_x 0.5068 (0.6295) acc_x 84.3750 (83.5417) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/35] time 0.157 (0.176) data 0.079 (0.099) loss_x loss_x 0.6221 (0.5773) acc_x 84.3750 (85.6250) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/35] time 0.378 (0.185) data 0.300 (0.108) loss_x loss_x 0.3704 (0.5444) acc_x 90.6250 (86.5000) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [30/35] time 0.169 (0.184) data 0.091 (0.107) loss_x loss_x 0.5498 (0.5454) acc_x 84.3750 (86.2500) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [35/35] time 0.216 (0.188) data 0.139 (0.108) loss_x loss_x 0.4160 (0.5297) acc_x 87.5000 (86.7857) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/15] time 0.226 (0.188) data 0.147 (0.108) loss_u loss_u 0.6758 (0.6827) acc_u 37.5000 (36.8750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [10/15] time 0.201 (0.186) data 0.123 (0.107) loss_u loss_u 0.7441 (0.7000) acc_u 28.1250 (35.3125) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [15/15] time 0.178 (0.185) data 0.101 (0.106) loss_u loss_u 0.5332 (0.6893) acc_u 53.1250 (36.4583) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 334
confident_label rate tensor(0.7054, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1140
clean true:1137
clean false:3
clean_rate:0.9973684210526316
noisy true:145
noisy false:331
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 476
epoch [178/200] batch [5/35] time 0.186 (0.185) data 0.110 (0.107) loss_x loss_x 0.3027 (0.5283) acc_x 96.8750 (86.8750) lr 7.0224e-05 eta 0:00:05
epoch [178/200] batch [10/35] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.1848 (0.4335) acc_x 100.0000 (89.0625) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/35] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 0.9268 (0.4873) acc_x 81.2500 (87.9167) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/35] time 0.161 (0.176) data 0.085 (0.099) loss_x loss_x 0.6416 (0.5375) acc_x 84.3750 (86.2500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/35] time 0.268 (0.178) data 0.081 (0.096) loss_x loss_x 0.4514 (0.5257) acc_x 90.6250 (86.2500) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/35] time 0.159 (0.176) data 0.082 (0.095) loss_x loss_x 0.3508 (0.5224) acc_x 93.7500 (86.7708) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [35/35] time 0.159 (0.174) data 0.082 (0.093) loss_x loss_x 0.5898 (0.5136) acc_x 84.3750 (86.8750) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/14] time 0.185 (0.173) data 0.107 (0.092) loss_u loss_u 0.7412 (0.7218) acc_u 28.1250 (30.0000) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [10/14] time 0.217 (0.176) data 0.140 (0.096) loss_u loss_u 0.8726 (0.7390) acc_u 15.6250 (29.0625) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 345
confident_label rate tensor(0.6999, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1131
clean true:1125
clean false:6
clean_rate:0.9946949602122016
noisy true:146
noisy false:339
after delete: len(clean_dataset) 1131
after delete: len(noisy_dataset) 485
epoch [179/200] batch [5/35] time 0.188 (0.168) data 0.111 (0.091) loss_x loss_x 0.5894 (0.5596) acc_x 84.3750 (85.6250) lr 6.4556e-05 eta 0:00:05
epoch [179/200] batch [10/35] time 0.164 (0.168) data 0.086 (0.091) loss_x loss_x 0.5596 (0.6292) acc_x 81.2500 (81.2500) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/35] time 0.159 (0.170) data 0.083 (0.092) loss_x loss_x 0.6553 (0.5749) acc_x 78.1250 (83.5417) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/35] time 0.169 (0.168) data 0.092 (0.091) loss_x loss_x 0.8525 (0.5800) acc_x 81.2500 (84.0625) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/35] time 0.168 (0.167) data 0.091 (0.090) loss_x loss_x 0.4951 (0.5544) acc_x 84.3750 (85.2500) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/35] time 0.296 (0.172) data 0.111 (0.092) loss_x loss_x 0.7461 (0.5558) acc_x 87.5000 (85.5208) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [35/35] time 0.205 (0.175) data 0.128 (0.095) loss_x loss_x 0.6929 (0.5563) acc_x 78.1250 (85.2679) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/15] time 0.197 (0.176) data 0.121 (0.096) loss_u loss_u 0.6172 (0.6624) acc_u 40.6250 (39.3750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [10/15] time 0.236 (0.177) data 0.157 (0.097) loss_u loss_u 0.7808 (0.6904) acc_u 25.0000 (35.3125) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [15/15] time 0.195 (0.177) data 0.118 (0.098) loss_u loss_u 0.7671 (0.6834) acc_u 28.1250 (36.2500) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 314
confident_label rate tensor(0.7166, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1158
clean true:1153
clean false:5
clean_rate:0.9956822107081175
noisy true:149
noisy false:309
after delete: len(clean_dataset) 1158
after delete: len(noisy_dataset) 458
epoch [180/200] batch [5/36] time 0.192 (0.181) data 0.116 (0.104) loss_x loss_x 0.2615 (0.3587) acc_x 93.7500 (90.0000) lr 5.9119e-05 eta 0:00:05
epoch [180/200] batch [10/36] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.5366 (0.4420) acc_x 90.6250 (88.4375) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [15/36] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.4946 (0.4726) acc_x 87.5000 (87.7083) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [20/36] time 0.187 (0.186) data 0.109 (0.109) loss_x loss_x 0.2644 (0.4437) acc_x 90.6250 (88.1250) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [25/36] time 0.182 (0.194) data 0.105 (0.113) loss_x loss_x 0.6953 (0.4437) acc_x 81.2500 (88.0000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [30/36] time 0.186 (0.192) data 0.109 (0.112) loss_x loss_x 0.4624 (0.4639) acc_x 84.3750 (87.8125) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [35/36] time 0.190 (0.192) data 0.113 (0.112) loss_x loss_x 0.3911 (0.4732) acc_x 87.5000 (87.3214) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/14] time 0.175 (0.191) data 0.096 (0.111) loss_u loss_u 0.6577 (0.7454) acc_u 40.6250 (27.5000) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [10/14] time 0.242 (0.191) data 0.165 (0.111) loss_u loss_u 0.7368 (0.7392) acc_u 28.1250 (28.7500) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 305
confident_label rate tensor(0.7123, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1151
clean true:1148
clean false:3
clean_rate:0.9973935708079931
noisy true:163
noisy false:302
after delete: len(clean_dataset) 1151
after delete: len(noisy_dataset) 465
epoch [181/200] batch [5/35] time 0.179 (0.205) data 0.102 (0.106) loss_x loss_x 0.4460 (0.5306) acc_x 87.5000 (86.2500) lr 5.3915e-05 eta 0:00:06
epoch [181/200] batch [10/35] time 0.157 (0.191) data 0.080 (0.103) loss_x loss_x 1.1006 (0.6249) acc_x 75.0000 (85.0000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [15/35] time 0.165 (0.187) data 0.087 (0.103) loss_x loss_x 0.5386 (0.5948) acc_x 87.5000 (85.8333) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [20/35] time 0.183 (0.183) data 0.107 (0.100) loss_x loss_x 0.1604 (0.5424) acc_x 100.0000 (87.3438) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [25/35] time 0.174 (0.181) data 0.097 (0.100) loss_x loss_x 0.5894 (0.5439) acc_x 84.3750 (87.0000) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [30/35] time 0.188 (0.184) data 0.111 (0.103) loss_x loss_x 0.2996 (0.5375) acc_x 87.5000 (86.5625) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [35/35] time 0.252 (0.186) data 0.175 (0.106) loss_x loss_x 0.2920 (0.5313) acc_x 96.8750 (86.5179) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/14] time 0.182 (0.190) data 0.105 (0.108) loss_u loss_u 0.7007 (0.6858) acc_u 34.3750 (35.6250) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [10/14] time 0.163 (0.189) data 0.086 (0.107) loss_u loss_u 0.8071 (0.7398) acc_u 28.1250 (30.6250) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 337
confident_label rate tensor(0.7048, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1139
clean true:1134
clean false:5
clean_rate:0.9956101843722563
noisy true:145
noisy false:332
after delete: len(clean_dataset) 1139
after delete: len(noisy_dataset) 477
epoch [182/200] batch [5/35] time 0.177 (0.203) data 0.100 (0.104) loss_x loss_x 0.5674 (0.4913) acc_x 84.3750 (87.5000) lr 4.8943e-05 eta 0:00:06
epoch [182/200] batch [10/35] time 0.161 (0.185) data 0.084 (0.097) loss_x loss_x 0.3484 (0.5195) acc_x 90.6250 (86.8750) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [15/35] time 0.176 (0.180) data 0.099 (0.095) loss_x loss_x 0.7466 (0.5485) acc_x 84.3750 (86.4583) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [20/35] time 0.241 (0.184) data 0.164 (0.101) loss_x loss_x 0.7046 (0.5565) acc_x 84.3750 (86.4062) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [25/35] time 0.163 (0.182) data 0.085 (0.100) loss_x loss_x 0.3149 (0.5431) acc_x 93.7500 (86.6250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [30/35] time 0.171 (0.181) data 0.093 (0.100) loss_x loss_x 0.4546 (0.5309) acc_x 84.3750 (86.7708) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [35/35] time 0.177 (0.181) data 0.099 (0.101) loss_x loss_x 0.7485 (0.5502) acc_x 75.0000 (86.0714) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/14] time 0.175 (0.180) data 0.098 (0.100) loss_u loss_u 0.7593 (0.7404) acc_u 28.1250 (28.7500) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [10/14] time 0.173 (0.184) data 0.096 (0.101) loss_u loss_u 0.7280 (0.7191) acc_u 34.3750 (31.5625) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 323
confident_label rate tensor(0.7073, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1143
clean true:1137
clean false:6
clean_rate:0.994750656167979
noisy true:156
noisy false:317
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 473
epoch [183/200] batch [5/35] time 0.177 (0.170) data 0.100 (0.093) loss_x loss_x 0.7817 (0.4859) acc_x 81.2500 (88.7500) lr 4.4207e-05 eta 0:00:05
epoch [183/200] batch [10/35] time 0.160 (0.184) data 0.083 (0.096) loss_x loss_x 0.3218 (0.4298) acc_x 87.5000 (90.0000) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [15/35] time 0.167 (0.179) data 0.089 (0.094) loss_x loss_x 0.4263 (0.4820) acc_x 87.5000 (88.1250) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [20/35] time 0.180 (0.177) data 0.103 (0.095) loss_x loss_x 0.3240 (0.4957) acc_x 93.7500 (88.1250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [25/35] time 0.192 (0.177) data 0.115 (0.096) loss_x loss_x 0.3928 (0.4972) acc_x 87.5000 (87.7500) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [30/35] time 0.198 (0.178) data 0.121 (0.097) loss_x loss_x 0.6836 (0.5041) acc_x 87.5000 (87.2917) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [35/35] time 0.169 (0.177) data 0.093 (0.097) loss_x loss_x 0.5063 (0.5061) acc_x 90.6250 (87.2321) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/14] time 0.162 (0.176) data 0.085 (0.096) loss_u loss_u 0.6611 (0.7450) acc_u 40.6250 (29.3750) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [10/14] time 0.167 (0.179) data 0.090 (0.096) loss_u loss_u 0.7158 (0.6995) acc_u 34.3750 (35.0000) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 311
confident_label rate tensor(0.7172, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1159
clean true:1153
clean false:6
clean_rate:0.994823123382226
noisy true:152
noisy false:305
after delete: len(clean_dataset) 1159
after delete: len(noisy_dataset) 457
epoch [184/200] batch [5/36] time 0.175 (0.190) data 0.099 (0.113) loss_x loss_x 0.6440 (0.4773) acc_x 87.5000 (89.3750) lr 3.9706e-05 eta 0:00:05
epoch [184/200] batch [10/36] time 0.198 (0.191) data 0.122 (0.114) loss_x loss_x 0.7725 (0.5357) acc_x 81.2500 (86.5625) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/36] time 0.175 (0.187) data 0.098 (0.109) loss_x loss_x 0.6709 (0.5264) acc_x 84.3750 (86.8750) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/36] time 0.174 (0.184) data 0.097 (0.107) loss_x loss_x 0.5186 (0.5842) acc_x 84.3750 (85.3125) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/36] time 0.172 (0.190) data 0.095 (0.109) loss_x loss_x 0.5640 (0.5575) acc_x 81.2500 (85.7500) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [30/36] time 0.202 (0.188) data 0.125 (0.107) loss_x loss_x 0.4053 (0.5568) acc_x 90.6250 (85.4167) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [35/36] time 0.162 (0.187) data 0.085 (0.106) loss_x loss_x 0.1154 (0.5329) acc_x 96.8750 (86.1607) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/14] time 0.170 (0.185) data 0.092 (0.105) loss_u loss_u 0.7695 (0.7173) acc_u 28.1250 (34.3750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [10/14] time 0.169 (0.183) data 0.091 (0.104) loss_u loss_u 0.7827 (0.7353) acc_u 25.0000 (32.8125) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 337
confident_label rate tensor(0.6980, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1128
clean true:1123
clean false:5
clean_rate:0.9955673758865248
noisy true:156
noisy false:332
after delete: len(clean_dataset) 1128
after delete: len(noisy_dataset) 488
epoch [185/200] batch [5/35] time 0.160 (0.162) data 0.083 (0.085) loss_x loss_x 1.0098 (0.6089) acc_x 75.0000 (83.1250) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/35] time 0.161 (0.161) data 0.084 (0.085) loss_x loss_x 0.7642 (0.5864) acc_x 81.2500 (85.3125) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [15/35] time 0.186 (0.166) data 0.109 (0.089) loss_x loss_x 0.2827 (0.5813) acc_x 90.6250 (84.7917) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [20/35] time 0.160 (0.166) data 0.083 (0.089) loss_x loss_x 0.7085 (0.5714) acc_x 81.2500 (85.3125) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/35] time 0.160 (0.167) data 0.083 (0.090) loss_x loss_x 0.4937 (0.5740) acc_x 81.2500 (85.2500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [30/35] time 0.182 (0.168) data 0.105 (0.091) loss_x loss_x 0.3369 (0.5755) acc_x 93.7500 (85.1042) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [35/35] time 0.186 (0.176) data 0.109 (0.095) loss_x loss_x 0.2079 (0.5380) acc_x 96.8750 (86.2500) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/15] time 0.186 (0.177) data 0.109 (0.096) loss_u loss_u 0.7290 (0.7014) acc_u 31.2500 (33.7500) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [10/15] time 0.171 (0.177) data 0.094 (0.097) loss_u loss_u 0.6743 (0.6882) acc_u 37.5000 (36.2500) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [15/15] time 0.174 (0.178) data 0.097 (0.098) loss_u loss_u 0.6328 (0.7002) acc_u 40.6250 (34.7917) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 332
confident_label rate tensor(0.7061, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1141
clean true:1137
clean false:4
clean_rate:0.9964943032427696
noisy true:147
noisy false:328
after delete: len(clean_dataset) 1141
after delete: len(noisy_dataset) 475
epoch [186/200] batch [5/35] time 0.228 (0.185) data 0.150 (0.107) loss_x loss_x 0.4824 (0.5650) acc_x 93.7500 (84.3750) lr 3.1417e-05 eta 0:00:05
epoch [186/200] batch [10/35] time 0.166 (0.182) data 0.089 (0.105) loss_x loss_x 0.4863 (0.5090) acc_x 84.3750 (86.5625) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [15/35] time 0.186 (0.182) data 0.110 (0.105) loss_x loss_x 0.5488 (0.5233) acc_x 87.5000 (86.6667) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [20/35] time 0.158 (0.183) data 0.081 (0.103) loss_x loss_x 0.3877 (0.5122) acc_x 87.5000 (86.7188) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/35] time 0.173 (0.182) data 0.096 (0.103) loss_x loss_x 0.3140 (0.5275) acc_x 96.8750 (86.2500) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [30/35] time 0.161 (0.179) data 0.084 (0.100) loss_x loss_x 0.6074 (0.5413) acc_x 81.2500 (85.9375) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [35/35] time 0.159 (0.176) data 0.082 (0.098) loss_x loss_x 0.7534 (0.5346) acc_x 78.1250 (86.1607) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/14] time 0.166 (0.175) data 0.087 (0.096) loss_u loss_u 0.7266 (0.6817) acc_u 31.2500 (35.6250) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [10/14] time 0.166 (0.175) data 0.089 (0.095) loss_u loss_u 0.6978 (0.6917) acc_u 40.6250 (35.0000) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 310
confident_label rate tensor(0.7184, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1161
clean true:1154
clean false:7
clean_rate:0.9939707149009475
noisy true:152
noisy false:303
after delete: len(clean_dataset) 1161
after delete: len(noisy_dataset) 455
epoch [187/200] batch [5/36] time 0.170 (0.179) data 0.093 (0.102) loss_x loss_x 0.7578 (0.6458) acc_x 75.0000 (80.0000) lr 2.7630e-05 eta 0:00:05
epoch [187/200] batch [10/36] time 0.182 (0.179) data 0.105 (0.102) loss_x loss_x 0.1584 (0.5244) acc_x 96.8750 (85.0000) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [15/36] time 0.168 (0.177) data 0.091 (0.101) loss_x loss_x 0.3386 (0.5482) acc_x 90.6250 (84.5833) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [20/36] time 0.192 (0.181) data 0.115 (0.104) loss_x loss_x 0.5986 (0.5229) acc_x 81.2500 (85.1562) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [25/36] time 0.163 (0.180) data 0.085 (0.103) loss_x loss_x 0.1589 (0.5158) acc_x 100.0000 (86.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [30/36] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.3188 (0.5147) acc_x 90.6250 (86.2500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [35/36] time 0.167 (0.186) data 0.091 (0.103) loss_x loss_x 0.4126 (0.5206) acc_x 84.3750 (85.8929) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/14] time 0.165 (0.184) data 0.088 (0.102) loss_u loss_u 0.7354 (0.7173) acc_u 34.3750 (33.1250) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [10/14] time 0.193 (0.184) data 0.114 (0.102) loss_u loss_u 0.5718 (0.7273) acc_u 50.0000 (31.2500) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 335
confident_label rate tensor(0.7017, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1134
clean true:1129
clean false:5
clean_rate:0.9955908289241623
noisy true:152
noisy false:330
after delete: len(clean_dataset) 1134
after delete: len(noisy_dataset) 482
epoch [188/200] batch [5/35] time 0.175 (0.178) data 0.096 (0.100) loss_x loss_x 0.4937 (0.4159) acc_x 90.6250 (90.0000) lr 2.4083e-05 eta 0:00:05
epoch [188/200] batch [10/35] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.4094 (0.4614) acc_x 93.7500 (89.0625) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/35] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.4504 (0.4803) acc_x 90.6250 (89.1667) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/35] time 0.177 (0.174) data 0.100 (0.097) loss_x loss_x 0.2244 (0.4801) acc_x 96.8750 (88.7500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/35] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.3975 (0.5081) acc_x 87.5000 (87.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [30/35] time 0.288 (0.176) data 0.103 (0.095) loss_x loss_x 0.4751 (0.5089) acc_x 93.7500 (87.0833) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [35/35] time 0.182 (0.181) data 0.105 (0.098) loss_x loss_x 0.5269 (0.5182) acc_x 84.3750 (86.4286) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/15] time 0.158 (0.179) data 0.082 (0.097) loss_u loss_u 0.7129 (0.7463) acc_u 40.6250 (32.5000) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [10/15] time 0.162 (0.179) data 0.084 (0.097) loss_u loss_u 0.5200 (0.6979) acc_u 56.2500 (35.9375) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [15/15] time 0.166 (0.178) data 0.089 (0.097) loss_u loss_u 0.7412 (0.6886) acc_u 28.1250 (36.0417) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 366
confident_label rate tensor(0.6825, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1103
clean true:1099
clean false:4
clean_rate:0.9963735267452403
noisy true:151
noisy false:362
after delete: len(clean_dataset) 1103
after delete: len(noisy_dataset) 513
epoch [189/200] batch [5/34] time 0.164 (0.170) data 0.087 (0.094) loss_x loss_x 0.6328 (0.5504) acc_x 87.5000 (84.3750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/34] time 0.161 (0.170) data 0.084 (0.094) loss_x loss_x 0.3923 (0.5392) acc_x 84.3750 (84.6875) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [15/34] time 0.193 (0.181) data 0.116 (0.096) loss_x loss_x 0.3726 (0.5163) acc_x 90.6250 (85.8333) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [20/34] time 0.173 (0.180) data 0.096 (0.097) loss_x loss_x 0.4414 (0.5093) acc_x 87.5000 (86.0938) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [25/34] time 0.170 (0.179) data 0.093 (0.098) loss_x loss_x 0.3301 (0.5081) acc_x 93.7500 (86.0000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [30/34] time 0.185 (0.179) data 0.108 (0.098) loss_x loss_x 0.5151 (0.5026) acc_x 84.3750 (86.1458) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/16] time 0.180 (0.179) data 0.103 (0.099) loss_u loss_u 0.6499 (0.6571) acc_u 37.5000 (36.2500) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [10/16] time 0.170 (0.182) data 0.092 (0.100) loss_u loss_u 0.6880 (0.6665) acc_u 40.6250 (37.1875) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/16] time 0.169 (0.181) data 0.092 (0.100) loss_u loss_u 0.6279 (0.6715) acc_u 43.7500 (37.2917) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 320
confident_label rate tensor(0.7073, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1143
clean true:1138
clean false:5
clean_rate:0.9956255468066492
noisy true:158
noisy false:315
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 473
epoch [190/200] batch [5/35] time 0.187 (0.198) data 0.108 (0.099) loss_x loss_x 0.6191 (0.6515) acc_x 84.3750 (84.3750) lr 1.7713e-05 eta 0:00:05
epoch [190/200] batch [10/35] time 0.159 (0.184) data 0.082 (0.096) loss_x loss_x 0.8848 (0.6215) acc_x 78.1250 (84.3750) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [15/35] time 0.161 (0.181) data 0.085 (0.097) loss_x loss_x 0.5010 (0.5830) acc_x 84.3750 (84.1667) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [20/35] time 0.190 (0.181) data 0.113 (0.099) loss_x loss_x 0.5986 (0.5807) acc_x 84.3750 (84.3750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [25/35] time 0.183 (0.181) data 0.106 (0.100) loss_x loss_x 0.3816 (0.5620) acc_x 90.6250 (85.2500) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [30/35] time 0.163 (0.180) data 0.086 (0.099) loss_x loss_x 0.2482 (0.5513) acc_x 93.7500 (85.5208) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [35/35] time 0.166 (0.180) data 0.089 (0.100) loss_x loss_x 0.2886 (0.5258) acc_x 90.6250 (86.1607) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/14] time 0.163 (0.179) data 0.085 (0.100) loss_u loss_u 0.7432 (0.7059) acc_u 31.2500 (36.8750) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [10/14] time 0.188 (0.182) data 0.110 (0.100) loss_u loss_u 0.7207 (0.6975) acc_u 31.2500 (36.5625) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 322
confident_label rate tensor(0.7073, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1143
clean true:1138
clean false:5
clean_rate:0.9956255468066492
noisy true:156
noisy false:317
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 473
epoch [191/200] batch [5/35] time 0.169 (0.175) data 0.091 (0.098) loss_x loss_x 0.4463 (0.5391) acc_x 87.5000 (88.7500) lr 1.4891e-05 eta 0:00:05
epoch [191/200] batch [10/35] time 0.209 (0.180) data 0.132 (0.103) loss_x loss_x 0.8003 (0.6273) acc_x 78.1250 (83.7500) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [15/35] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.7026 (0.6051) acc_x 81.2500 (84.1667) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [20/35] time 0.314 (0.186) data 0.127 (0.104) loss_x loss_x 0.3975 (0.5961) acc_x 90.6250 (84.3750) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [25/35] time 0.185 (0.187) data 0.109 (0.106) loss_x loss_x 0.5947 (0.5692) acc_x 81.2500 (85.0000) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [30/35] time 0.163 (0.186) data 0.086 (0.106) loss_x loss_x 0.3555 (0.5485) acc_x 93.7500 (85.4167) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [35/35] time 0.159 (0.182) data 0.082 (0.102) loss_x loss_x 0.3662 (0.5470) acc_x 90.6250 (85.8036) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/14] time 0.162 (0.180) data 0.084 (0.100) loss_u loss_u 0.7041 (0.7174) acc_u 31.2500 (30.6250) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [10/14] time 0.168 (0.178) data 0.090 (0.098) loss_u loss_u 0.6387 (0.7120) acc_u 37.5000 (32.1875) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 327
confident_label rate tensor(0.7073, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1143
clean true:1138
clean false:5
clean_rate:0.9956255468066492
noisy true:151
noisy false:322
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 473
epoch [192/200] batch [5/35] time 0.187 (0.191) data 0.109 (0.114) loss_x loss_x 0.3003 (0.4220) acc_x 93.7500 (89.3750) lr 1.2312e-05 eta 0:00:05
epoch [192/200] batch [10/35] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.8794 (0.5545) acc_x 68.7500 (85.3125) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [15/35] time 0.171 (0.185) data 0.094 (0.108) loss_x loss_x 0.2469 (0.4808) acc_x 100.0000 (88.1250) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [20/35] time 0.178 (0.182) data 0.100 (0.105) loss_x loss_x 0.3293 (0.4700) acc_x 90.6250 (88.2812) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [25/35] time 0.174 (0.180) data 0.098 (0.103) loss_x loss_x 0.5010 (0.5047) acc_x 81.2500 (87.2500) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [30/35] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.7085 (0.5009) acc_x 81.2500 (87.3958) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [35/35] time 0.162 (0.177) data 0.085 (0.100) loss_x loss_x 0.5459 (0.5334) acc_x 87.5000 (86.6071) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/14] time 0.164 (0.182) data 0.087 (0.100) loss_u loss_u 0.5732 (0.6702) acc_u 50.0000 (37.5000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [10/14] time 0.194 (0.181) data 0.116 (0.100) loss_u loss_u 0.7495 (0.6687) acc_u 28.1250 (38.7500) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 333
confident_label rate tensor(0.7011, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1133
clean true:1131
clean false:2
clean_rate:0.9982347749338041
noisy true:152
noisy false:331
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 483
epoch [193/200] batch [5/35] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.4412 (0.4302) acc_x 87.5000 (90.0000) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/35] time 0.237 (0.165) data 0.080 (0.080) loss_x loss_x 0.4248 (0.5301) acc_x 90.6250 (87.5000) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [15/35] time 0.156 (0.171) data 0.079 (0.081) loss_x loss_x 0.8452 (0.5791) acc_x 78.1250 (86.0417) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [20/35] time 0.156 (0.168) data 0.079 (0.081) loss_x loss_x 0.6621 (0.5628) acc_x 78.1250 (85.9375) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/35] time 0.157 (0.166) data 0.081 (0.081) loss_x loss_x 0.6230 (0.5302) acc_x 84.3750 (87.1250) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [30/35] time 0.161 (0.168) data 0.084 (0.085) loss_x loss_x 0.3350 (0.5349) acc_x 84.3750 (86.6667) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [35/35] time 0.167 (0.170) data 0.089 (0.087) loss_x loss_x 0.5073 (0.5180) acc_x 84.3750 (86.9643) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/15] time 0.175 (0.170) data 0.098 (0.088) loss_u loss_u 0.8359 (0.7705) acc_u 18.7500 (25.6250) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [10/15] time 0.182 (0.170) data 0.105 (0.089) loss_u loss_u 0.6123 (0.7187) acc_u 46.8750 (32.5000) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [15/15] time 0.173 (0.174) data 0.095 (0.090) loss_u loss_u 0.5952 (0.6996) acc_u 46.8750 (34.7917) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 321
confident_label rate tensor(0.7054, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1140
clean true:1136
clean false:4
clean_rate:0.9964912280701754
noisy true:159
noisy false:317
after delete: len(clean_dataset) 1140
after delete: len(noisy_dataset) 476
epoch [194/200] batch [5/35] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.5786 (0.6750) acc_x 84.3750 (82.5000) lr 7.8853e-06 eta 0:00:05
epoch [194/200] batch [10/35] time 0.178 (0.175) data 0.102 (0.098) loss_x loss_x 0.2715 (0.5517) acc_x 93.7500 (85.9375) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [15/35] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.3418 (0.5020) acc_x 87.5000 (86.2500) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [20/35] time 0.183 (0.174) data 0.106 (0.098) loss_x loss_x 0.7544 (0.5107) acc_x 75.0000 (86.4062) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/35] time 0.164 (0.175) data 0.086 (0.098) loss_x loss_x 1.0361 (0.5462) acc_x 78.1250 (85.5000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [30/35] time 0.258 (0.183) data 0.096 (0.099) loss_x loss_x 0.4871 (0.5458) acc_x 84.3750 (85.8333) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [35/35] time 0.175 (0.182) data 0.098 (0.099) loss_x loss_x 0.5806 (0.5301) acc_x 87.5000 (86.4286) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/14] time 0.157 (0.181) data 0.079 (0.099) loss_u loss_u 0.6885 (0.6652) acc_u 34.3750 (39.3750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [10/14] time 0.162 (0.181) data 0.085 (0.099) loss_u loss_u 0.7373 (0.6797) acc_u 34.3750 (37.1875) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 334
confident_label rate tensor(0.7011, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1133
clean true:1127
clean false:6
clean_rate:0.9947043248014121
noisy true:155
noisy false:328
after delete: len(clean_dataset) 1133
after delete: len(noisy_dataset) 483
epoch [195/200] batch [5/35] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.9111 (0.4980) acc_x 81.2500 (89.3750) lr 6.0390e-06 eta 0:00:05
epoch [195/200] batch [10/35] time 0.163 (0.176) data 0.086 (0.099) loss_x loss_x 0.4128 (0.5027) acc_x 84.3750 (88.1250) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [15/35] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.1979 (0.5413) acc_x 90.6250 (86.8750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [20/35] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.6006 (0.5351) acc_x 84.3750 (87.3438) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/35] time 0.162 (0.174) data 0.085 (0.097) loss_x loss_x 0.3350 (0.5361) acc_x 90.6250 (87.5000) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [30/35] time 0.181 (0.180) data 0.104 (0.097) loss_x loss_x 0.3647 (0.5543) acc_x 93.7500 (86.6667) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [35/35] time 0.170 (0.180) data 0.093 (0.098) loss_x loss_x 0.4587 (0.5629) acc_x 93.7500 (86.3393) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/15] time 0.185 (0.179) data 0.109 (0.097) loss_u loss_u 0.6333 (0.6825) acc_u 43.7500 (36.8750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [10/15] time 0.165 (0.178) data 0.088 (0.097) loss_u loss_u 0.6484 (0.6676) acc_u 43.7500 (39.0625) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [15/15] time 0.157 (0.177) data 0.079 (0.096) loss_u loss_u 0.6636 (0.6852) acc_u 40.6250 (37.9167) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 329
confident_label rate tensor(0.7098, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1147
clean true:1139
clean false:8
clean_rate:0.993025283347864
noisy true:148
noisy false:321
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 469
epoch [196/200] batch [5/35] time 0.282 (0.194) data 0.096 (0.091) loss_x loss_x 0.2805 (0.5246) acc_x 93.7500 (86.8750) lr 4.4380e-06 eta 0:00:05
epoch [196/200] batch [10/35] time 0.182 (0.188) data 0.105 (0.098) loss_x loss_x 0.5918 (0.5432) acc_x 81.2500 (84.0625) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/35] time 0.161 (0.183) data 0.085 (0.098) loss_x loss_x 0.4080 (0.5458) acc_x 90.6250 (83.9583) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/35] time 0.159 (0.179) data 0.082 (0.095) loss_x loss_x 0.5093 (0.5300) acc_x 78.1250 (84.5312) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/35] time 0.178 (0.177) data 0.101 (0.095) loss_x loss_x 0.1868 (0.5167) acc_x 93.7500 (85.1250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/35] time 0.172 (0.176) data 0.094 (0.095) loss_x loss_x 0.5679 (0.4933) acc_x 87.5000 (86.3542) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [35/35] time 0.163 (0.178) data 0.086 (0.094) loss_x loss_x 0.4712 (0.5101) acc_x 87.5000 (86.3393) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/14] time 0.159 (0.175) data 0.081 (0.092) loss_u loss_u 0.6084 (0.6845) acc_u 40.6250 (36.8750) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [10/14] time 0.160 (0.174) data 0.082 (0.091) loss_u loss_u 0.6440 (0.6942) acc_u 37.5000 (35.0000) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 312
confident_label rate tensor(0.7116, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1150
clean true:1146
clean false:4
clean_rate:0.9965217391304347
noisy true:158
noisy false:308
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 466
epoch [197/200] batch [5/35] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.4414 (0.5625) acc_x 87.5000 (83.1250) lr 3.0827e-06 eta 0:00:05
epoch [197/200] batch [10/35] time 0.170 (0.170) data 0.093 (0.093) loss_x loss_x 0.5103 (0.5190) acc_x 87.5000 (85.6250) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [15/35] time 0.169 (0.170) data 0.092 (0.093) loss_x loss_x 0.7109 (0.5075) acc_x 81.2500 (86.4583) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [20/35] time 0.168 (0.170) data 0.092 (0.093) loss_x loss_x 0.6479 (0.5114) acc_x 84.3750 (86.5625) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/35] time 0.164 (0.174) data 0.087 (0.093) loss_x loss_x 0.6001 (0.5310) acc_x 84.3750 (86.3750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [30/35] time 0.172 (0.174) data 0.095 (0.094) loss_x loss_x 0.5649 (0.5365) acc_x 81.2500 (85.7292) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [35/35] time 0.184 (0.175) data 0.107 (0.094) loss_x loss_x 0.6934 (0.5325) acc_x 84.3750 (86.0714) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/14] time 0.161 (0.174) data 0.083 (0.094) loss_u loss_u 0.7173 (0.7162) acc_u 31.2500 (33.7500) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [10/14] time 0.187 (0.176) data 0.110 (0.096) loss_u loss_u 0.6079 (0.7025) acc_u 40.6250 (34.6875) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 316
confident_label rate tensor(0.7073, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1143
clean true:1137
clean false:6
clean_rate:0.994750656167979
noisy true:163
noisy false:310
after delete: len(clean_dataset) 1143
after delete: len(noisy_dataset) 473
epoch [198/200] batch [5/35] time 0.160 (0.158) data 0.083 (0.081) loss_x loss_x 0.3621 (0.6498) acc_x 90.6250 (82.5000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/35] time 0.206 (0.166) data 0.129 (0.089) loss_x loss_x 0.5278 (0.6115) acc_x 87.5000 (85.0000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [15/35] time 0.184 (0.169) data 0.106 (0.092) loss_x loss_x 0.3730 (0.5961) acc_x 90.6250 (85.4167) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [20/35] time 0.181 (0.171) data 0.104 (0.094) loss_x loss_x 0.3906 (0.5966) acc_x 90.6250 (85.1562) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/35] time 0.176 (0.171) data 0.099 (0.094) loss_x loss_x 0.9155 (0.6150) acc_x 78.1250 (84.8750) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/35] time 0.189 (0.177) data 0.112 (0.096) loss_x loss_x 0.6123 (0.5893) acc_x 81.2500 (85.1042) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [35/35] time 0.175 (0.177) data 0.098 (0.097) loss_x loss_x 0.4402 (0.5719) acc_x 90.6250 (85.4464) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/14] time 0.173 (0.176) data 0.096 (0.097) loss_u loss_u 0.7075 (0.6827) acc_u 34.3750 (36.2500) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [10/14] time 0.167 (0.176) data 0.089 (0.096) loss_u loss_u 0.7852 (0.7008) acc_u 25.0000 (34.0625) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 323
confident_label rate tensor(0.7116, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1150
clean true:1145
clean false:5
clean_rate:0.9956521739130435
noisy true:148
noisy false:318
after delete: len(clean_dataset) 1150
after delete: len(noisy_dataset) 466
epoch [199/200] batch [5/35] time 0.237 (0.201) data 0.095 (0.111) loss_x loss_x 0.7100 (0.5618) acc_x 81.2500 (86.2500) lr 1.1101e-06 eta 0:00:06
epoch [199/200] batch [10/35] time 0.168 (0.199) data 0.092 (0.108) loss_x loss_x 0.2041 (0.5703) acc_x 93.7500 (86.2500) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [15/35] time 0.158 (0.189) data 0.082 (0.103) loss_x loss_x 0.6914 (0.6128) acc_x 78.1250 (84.1667) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [20/35] time 0.165 (0.183) data 0.089 (0.099) loss_x loss_x 0.4995 (0.5868) acc_x 87.5000 (84.6875) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [25/35] time 0.164 (0.183) data 0.088 (0.100) loss_x loss_x 0.2458 (0.5783) acc_x 96.8750 (85.2500) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [30/35] time 0.198 (0.180) data 0.121 (0.099) loss_x loss_x 0.4758 (0.5816) acc_x 84.3750 (85.1042) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [35/35] time 0.189 (0.181) data 0.111 (0.100) loss_x loss_x 0.8618 (0.5976) acc_x 81.2500 (84.9107) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/14] time 0.190 (0.181) data 0.112 (0.101) loss_u loss_u 0.8467 (0.7737) acc_u 18.7500 (24.3750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [10/14] time 0.173 (0.184) data 0.097 (0.100) loss_u loss_u 0.7095 (0.7275) acc_u 31.2500 (30.6250) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 313
confident_label rate tensor(0.7098, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1147
clean true:1142
clean false:5
clean_rate:0.995640802092415
noisy true:161
noisy false:308
after delete: len(clean_dataset) 1147
after delete: len(noisy_dataset) 469
epoch [200/200] batch [5/35] time 0.160 (0.169) data 0.083 (0.091) loss_x loss_x 0.5474 (0.4801) acc_x 84.3750 (88.1250) lr 4.9344e-07 eta 0:00:05
epoch [200/200] batch [10/35] time 0.188 (0.173) data 0.111 (0.095) loss_x loss_x 0.1792 (0.4493) acc_x 96.8750 (88.7500) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [15/35] time 0.271 (0.183) data 0.086 (0.098) loss_x loss_x 0.4783 (0.4586) acc_x 87.5000 (88.3333) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [20/35] time 0.162 (0.182) data 0.084 (0.098) loss_x loss_x 1.0391 (0.5014) acc_x 81.2500 (87.3438) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/35] time 0.187 (0.181) data 0.110 (0.098) loss_x loss_x 0.6289 (0.5183) acc_x 81.2500 (86.7500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [30/35] time 0.173 (0.178) data 0.096 (0.097) loss_x loss_x 0.8584 (0.5431) acc_x 75.0000 (85.9375) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [35/35] time 0.159 (0.177) data 0.082 (0.096) loss_x loss_x 0.4602 (0.5285) acc_x 90.6250 (86.4286) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/14] time 0.171 (0.176) data 0.093 (0.096) loss_u loss_u 0.5474 (0.6793) acc_u 50.0000 (36.8750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [10/14] time 0.183 (0.176) data 0.106 (0.096) loss_u loss_u 0.6758 (0.7055) acc_u 37.5000 (34.0625) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.125/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,863
* accuracy: 75.7%
* error: 24.3%
* macro_f1: 74.2%
Elapsed: 0:59:32
