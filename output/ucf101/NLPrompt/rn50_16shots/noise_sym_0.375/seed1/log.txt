***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.375', 'DATASET.NOISE_TYPE', 'sym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.375
  NOISE_TYPE: sym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.1986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 321
clean true:313
clean false:8
clean_rate:0.9750778816199377
noisy true:199
noisy false:1096
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 1295
epoch [1/200] batch [5/10] time 0.172 (0.202) data 0.095 (0.102) loss_x loss_x 2.4707 (2.7695) acc_x 56.2500 (40.6250) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/10] time 0.179 (0.191) data 0.103 (0.102) loss_x loss_x 2.1387 (2.5539) acc_x 68.7500 (51.2500) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/40] time 0.188 (0.191) data 0.111 (0.105) loss_u loss_u 0.9673 (0.9643) acc_u 9.3750 (10.0000) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [10/40] time 0.195 (0.191) data 0.117 (0.107) loss_u loss_u 0.9497 (0.9572) acc_u 6.2500 (10.6250) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [15/40] time 0.177 (0.190) data 0.099 (0.107) loss_u loss_u 0.9434 (0.9493) acc_u 12.5000 (12.0833) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [20/40] time 0.181 (0.188) data 0.105 (0.106) loss_u loss_u 0.9663 (0.9511) acc_u 3.1250 (10.9375) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [25/40] time 0.199 (0.188) data 0.122 (0.107) loss_u loss_u 0.9277 (0.9492) acc_u 15.6250 (11.5000) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [30/40] time 0.195 (0.188) data 0.116 (0.107) loss_u loss_u 0.9678 (0.9491) acc_u 9.3750 (11.5625) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [35/40] time 0.184 (0.188) data 0.105 (0.108) loss_u loss_u 0.9639 (0.9482) acc_u 9.3750 (11.6071) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [40/40] time 0.208 (0.188) data 0.130 (0.108) loss_u loss_u 0.9683 (0.9478) acc_u 0.0000 (11.4062) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 981
confident_label rate tensor(0.2450, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 396
clean true:390
clean false:6
clean_rate:0.9848484848484849
noisy true:245
noisy false:975
after delete: len(clean_dataset) 396
after delete: len(noisy_dataset) 1220
epoch [2/200] batch [5/12] time 0.202 (0.187) data 0.125 (0.110) loss_x loss_x 1.4629 (1.5887) acc_x 56.2500 (60.6250) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/12] time 0.161 (0.177) data 0.085 (0.100) loss_x loss_x 0.8721 (1.3279) acc_x 75.0000 (68.1250) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/38] time 0.178 (0.177) data 0.101 (0.100) loss_u loss_u 0.8550 (0.8864) acc_u 18.7500 (13.7500) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [10/38] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.9297 (0.8822) acc_u 12.5000 (15.0000) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [15/38] time 0.166 (0.178) data 0.087 (0.100) loss_u loss_u 0.8701 (0.8800) acc_u 12.5000 (15.0000) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [20/38] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.8564 (0.8724) acc_u 18.7500 (15.9375) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [25/38] time 0.183 (0.178) data 0.106 (0.100) loss_u loss_u 0.9067 (0.8678) acc_u 18.7500 (17.0000) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [30/38] time 0.176 (0.178) data 0.098 (0.100) loss_u loss_u 0.9341 (0.8691) acc_u 9.3750 (16.6667) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [35/38] time 0.188 (0.178) data 0.112 (0.101) loss_u loss_u 0.8867 (0.8614) acc_u 12.5000 (17.5893) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 797
confident_label rate tensor(0.3255, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 526
clean true:522
clean false:4
clean_rate:0.9923954372623575
noisy true:297
noisy false:793
after delete: len(clean_dataset) 526
after delete: len(noisy_dataset) 1090
epoch [3/200] batch [5/16] time 0.171 (0.182) data 0.094 (0.105) loss_x loss_x 1.5391 (1.0984) acc_x 59.3750 (70.0000) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/16] time 0.168 (0.174) data 0.092 (0.097) loss_x loss_x 1.2500 (1.1094) acc_x 68.7500 (70.0000) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/16] time 0.180 (0.175) data 0.101 (0.098) loss_x loss_x 1.2539 (1.1923) acc_x 75.0000 (68.1250) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/34] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.8574 (0.8930) acc_u 18.7500 (15.0000) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [10/34] time 0.184 (0.178) data 0.108 (0.100) loss_u loss_u 0.9116 (0.8914) acc_u 15.6250 (15.3125) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [15/34] time 0.190 (0.179) data 0.113 (0.102) loss_u loss_u 0.9146 (0.8994) acc_u 15.6250 (14.5833) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [20/34] time 0.191 (0.181) data 0.113 (0.104) loss_u loss_u 0.9082 (0.9031) acc_u 9.3750 (13.5938) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [25/34] time 0.190 (0.181) data 0.109 (0.103) loss_u loss_u 0.9009 (0.9055) acc_u 9.3750 (13.0000) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [30/34] time 0.184 (0.181) data 0.107 (0.103) loss_u loss_u 0.8345 (0.9035) acc_u 21.8750 (13.0208) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 773
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 533
clean true:530
clean false:3
clean_rate:0.9943714821763602
noisy true:313
noisy false:770
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1083
epoch [4/200] batch [5/16] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.8457 (1.1316) acc_x 81.2500 (72.5000) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/16] time 0.177 (0.181) data 0.100 (0.104) loss_x loss_x 1.4756 (1.1469) acc_x 62.5000 (72.1875) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [15/16] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 1.1992 (1.1469) acc_x 75.0000 (70.8333) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/33] time 0.169 (0.174) data 0.091 (0.097) loss_u loss_u 0.8945 (0.8858) acc_u 12.5000 (12.5000) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/33] time 0.189 (0.176) data 0.111 (0.099) loss_u loss_u 0.9395 (0.8765) acc_u 12.5000 (14.6875) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [15/33] time 0.164 (0.176) data 0.086 (0.099) loss_u loss_u 0.9536 (0.8753) acc_u 3.1250 (14.7917) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [20/33] time 0.181 (0.176) data 0.103 (0.099) loss_u loss_u 0.8760 (0.8797) acc_u 15.6250 (14.5312) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [25/33] time 0.173 (0.176) data 0.095 (0.099) loss_u loss_u 0.9224 (0.8826) acc_u 9.3750 (14.5000) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [30/33] time 0.189 (0.178) data 0.110 (0.100) loss_u loss_u 0.8086 (0.8798) acc_u 25.0000 (14.5833) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 760
confident_label rate tensor(0.3267, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 528
clean true:524
clean false:4
clean_rate:0.9924242424242424
noisy true:332
noisy false:756
after delete: len(clean_dataset) 528
after delete: len(noisy_dataset) 1088
epoch [5/200] batch [5/16] time 0.181 (0.174) data 0.104 (0.097) loss_x loss_x 0.9023 (1.0026) acc_x 75.0000 (71.8750) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/16] time 0.159 (0.173) data 0.082 (0.095) loss_x loss_x 1.0869 (0.9855) acc_x 75.0000 (74.0625) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/16] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 1.1377 (1.0330) acc_x 68.7500 (72.5000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/34] time 0.178 (0.176) data 0.099 (0.098) loss_u loss_u 0.9092 (0.9011) acc_u 9.3750 (12.5000) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [10/34] time 0.164 (0.175) data 0.086 (0.097) loss_u loss_u 0.8828 (0.9043) acc_u 12.5000 (11.2500) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [15/34] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.8594 (0.9003) acc_u 18.7500 (12.2917) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [20/34] time 0.179 (0.176) data 0.102 (0.098) loss_u loss_u 0.8579 (0.8967) acc_u 12.5000 (12.5000) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [25/34] time 0.219 (0.177) data 0.139 (0.100) loss_u loss_u 0.8384 (0.8932) acc_u 21.8750 (13.0000) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [30/34] time 0.180 (0.178) data 0.103 (0.100) loss_u loss_u 0.8862 (0.8901) acc_u 12.5000 (13.3333) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 739
confident_label rate tensor(0.3360, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 543
clean true:538
clean false:5
clean_rate:0.990791896869245
noisy true:339
noisy false:734
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 1073
epoch [6/200] batch [5/16] time 0.200 (0.176) data 0.123 (0.100) loss_x loss_x 0.7554 (0.8206) acc_x 78.1250 (77.5000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/16] time 0.178 (0.177) data 0.101 (0.100) loss_x loss_x 0.7666 (0.8830) acc_x 71.8750 (75.6250) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/16] time 0.183 (0.178) data 0.107 (0.102) loss_x loss_x 0.9058 (0.8329) acc_x 81.2500 (77.9167) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/33] time 0.183 (0.180) data 0.105 (0.103) loss_u loss_u 0.8076 (0.8690) acc_u 21.8750 (15.6250) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [10/33] time 0.185 (0.181) data 0.108 (0.103) loss_u loss_u 0.8984 (0.8726) acc_u 12.5000 (15.0000) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [15/33] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.8936 (0.8701) acc_u 9.3750 (15.2083) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [20/33] time 0.174 (0.180) data 0.097 (0.103) loss_u loss_u 0.8906 (0.8737) acc_u 15.6250 (14.6875) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [25/33] time 0.172 (0.180) data 0.095 (0.103) loss_u loss_u 0.9067 (0.8770) acc_u 12.5000 (14.6250) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [30/33] time 0.177 (0.180) data 0.100 (0.102) loss_u loss_u 0.8545 (0.8779) acc_u 15.6250 (14.2708) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 733
confident_label rate tensor(0.3410, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 551
clean true:548
clean false:3
clean_rate:0.9945553539019963
noisy true:335
noisy false:730
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1065
epoch [7/200] batch [5/17] time 0.175 (0.170) data 0.097 (0.093) loss_x loss_x 0.7988 (0.8711) acc_x 65.6250 (75.0000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/17] time 0.183 (0.172) data 0.106 (0.094) loss_x loss_x 0.5806 (0.8775) acc_x 81.2500 (75.9375) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [15/17] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.7173 (0.8820) acc_x 71.8750 (75.0000) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/33] time 0.164 (0.170) data 0.086 (0.093) loss_u loss_u 0.8589 (0.8914) acc_u 15.6250 (13.1250) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/33] time 0.185 (0.171) data 0.107 (0.094) loss_u loss_u 0.8755 (0.8825) acc_u 9.3750 (12.5000) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [15/33] time 0.191 (0.174) data 0.113 (0.096) loss_u loss_u 0.8711 (0.8792) acc_u 18.7500 (13.5417) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/33] time 0.173 (0.175) data 0.096 (0.098) loss_u loss_u 0.8970 (0.8856) acc_u 9.3750 (12.8125) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [25/33] time 0.171 (0.175) data 0.093 (0.097) loss_u loss_u 0.8379 (0.8776) acc_u 18.7500 (13.8750) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [30/33] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.9033 (0.8741) acc_u 9.3750 (14.5833) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 715
confident_label rate tensor(0.3441, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 556
clean true:553
clean false:3
clean_rate:0.9946043165467626
noisy true:348
noisy false:712
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1060
epoch [8/200] batch [5/17] time 0.174 (0.170) data 0.097 (0.092) loss_x loss_x 1.0430 (1.0158) acc_x 65.6250 (74.3750) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/17] time 0.172 (0.172) data 0.095 (0.094) loss_x loss_x 0.6816 (1.0001) acc_x 84.3750 (74.6875) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [15/17] time 0.168 (0.171) data 0.091 (0.093) loss_x loss_x 0.9858 (0.9717) acc_x 78.1250 (75.2083) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/33] time 0.173 (0.171) data 0.096 (0.094) loss_u loss_u 0.8589 (0.8715) acc_u 18.7500 (14.3750) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [10/33] time 0.195 (0.174) data 0.118 (0.096) loss_u loss_u 0.7837 (0.8619) acc_u 25.0000 (15.6250) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/33] time 0.180 (0.174) data 0.102 (0.097) loss_u loss_u 0.8975 (0.8772) acc_u 9.3750 (13.3333) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [20/33] time 0.179 (0.175) data 0.103 (0.098) loss_u loss_u 0.8726 (0.8667) acc_u 18.7500 (15.0000) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [25/33] time 0.187 (0.176) data 0.108 (0.099) loss_u loss_u 0.8320 (0.8748) acc_u 15.6250 (13.8750) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [30/33] time 0.173 (0.177) data 0.095 (0.099) loss_u loss_u 0.8071 (0.8719) acc_u 21.8750 (14.2708) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 708
confident_label rate tensor(0.3601, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 582
clean true:577
clean false:5
clean_rate:0.9914089347079038
noisy true:331
noisy false:703
after delete: len(clean_dataset) 582
after delete: len(noisy_dataset) 1034
epoch [9/200] batch [5/18] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 1.5078 (0.8701) acc_x 62.5000 (78.1250) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/18] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.6768 (0.9079) acc_x 81.2500 (77.8125) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/18] time 0.162 (0.171) data 0.085 (0.094) loss_x loss_x 0.7891 (0.9851) acc_x 87.5000 (77.0833) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/32] time 0.165 (0.168) data 0.088 (0.091) loss_u loss_u 0.8442 (0.8721) acc_u 21.8750 (16.2500) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/32] time 0.166 (0.168) data 0.089 (0.091) loss_u loss_u 0.8560 (0.8784) acc_u 12.5000 (15.0000) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/32] time 0.188 (0.169) data 0.111 (0.092) loss_u loss_u 0.9668 (0.8872) acc_u 6.2500 (13.7500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/32] time 0.159 (0.169) data 0.082 (0.092) loss_u loss_u 0.9058 (0.8891) acc_u 9.3750 (13.2812) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [25/32] time 0.198 (0.170) data 0.120 (0.093) loss_u loss_u 0.8491 (0.8828) acc_u 15.6250 (13.8750) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [30/32] time 0.210 (0.171) data 0.133 (0.094) loss_u loss_u 0.9155 (0.8856) acc_u 9.3750 (13.4375) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 700
confident_label rate tensor(0.3645, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 589
clean true:579
clean false:10
clean_rate:0.9830220713073005
noisy true:337
noisy false:690
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 1027
epoch [10/200] batch [5/18] time 0.186 (0.187) data 0.110 (0.111) loss_x loss_x 1.1631 (0.9499) acc_x 59.3750 (74.3750) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [10/18] time 0.177 (0.185) data 0.101 (0.108) loss_x loss_x 0.5864 (0.9753) acc_x 93.7500 (75.6250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [15/18] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 1.4443 (0.9635) acc_x 71.8750 (76.2500) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/32] time 0.187 (0.183) data 0.109 (0.106) loss_u loss_u 0.8110 (0.8764) acc_u 25.0000 (13.7500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/32] time 0.188 (0.184) data 0.110 (0.106) loss_u loss_u 0.8813 (0.8790) acc_u 12.5000 (14.0625) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [15/32] time 0.178 (0.183) data 0.101 (0.106) loss_u loss_u 0.8257 (0.8802) acc_u 25.0000 (14.7917) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [20/32] time 0.162 (0.181) data 0.085 (0.104) loss_u loss_u 0.8843 (0.8775) acc_u 12.5000 (15.4688) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [25/32] time 0.170 (0.181) data 0.093 (0.103) loss_u loss_u 0.9502 (0.8796) acc_u 6.2500 (14.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [30/32] time 0.191 (0.181) data 0.112 (0.103) loss_u loss_u 0.8403 (0.8729) acc_u 18.7500 (15.4167) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 683
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 610
clean true:606
clean false:4
clean_rate:0.9934426229508196
noisy true:327
noisy false:679
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1006
epoch [11/200] batch [5/19] time 0.182 (0.190) data 0.105 (0.113) loss_x loss_x 1.3193 (1.1971) acc_x 71.8750 (73.7500) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [10/19] time 0.188 (0.184) data 0.110 (0.106) loss_x loss_x 0.5903 (0.9380) acc_x 84.3750 (77.1875) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [15/19] time 0.183 (0.182) data 0.106 (0.104) loss_x loss_x 1.2100 (0.9629) acc_x 68.7500 (76.6667) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/31] time 0.160 (0.182) data 0.083 (0.105) loss_u loss_u 0.8926 (0.9023) acc_u 12.5000 (12.5000) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/31] time 0.187 (0.183) data 0.110 (0.106) loss_u loss_u 0.8794 (0.8884) acc_u 9.3750 (13.1250) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/31] time 0.188 (0.184) data 0.110 (0.106) loss_u loss_u 0.8931 (0.8926) acc_u 15.6250 (13.1250) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/31] time 0.191 (0.184) data 0.112 (0.107) loss_u loss_u 0.8564 (0.8966) acc_u 18.7500 (12.3438) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [25/31] time 0.246 (0.186) data 0.169 (0.109) loss_u loss_u 0.9058 (0.8934) acc_u 6.2500 (12.5000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [30/31] time 0.180 (0.186) data 0.102 (0.108) loss_u loss_u 0.8345 (0.8902) acc_u 15.6250 (12.6042) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 656
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:611
clean false:2
clean_rate:0.9967373572593801
noisy true:349
noisy false:654
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [12/200] batch [5/19] time 0.177 (0.178) data 0.100 (0.101) loss_x loss_x 0.7886 (0.9532) acc_x 81.2500 (75.6250) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/19] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.9048 (0.9931) acc_x 78.1250 (76.5625) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [15/19] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 0.6377 (0.9482) acc_x 84.3750 (76.8750) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/31] time 0.177 (0.172) data 0.099 (0.094) loss_u loss_u 0.9502 (0.8916) acc_u 3.1250 (10.6250) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/31] time 0.169 (0.172) data 0.090 (0.095) loss_u loss_u 0.7212 (0.8652) acc_u 28.1250 (14.3750) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/31] time 0.169 (0.175) data 0.092 (0.097) loss_u loss_u 0.9341 (0.8790) acc_u 6.2500 (13.1250) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/31] time 0.175 (0.175) data 0.096 (0.098) loss_u loss_u 0.8672 (0.8826) acc_u 18.7500 (12.8125) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [25/31] time 0.183 (0.176) data 0.105 (0.098) loss_u loss_u 0.8770 (0.8878) acc_u 12.5000 (12.2500) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [30/31] time 0.184 (0.176) data 0.107 (0.098) loss_u loss_u 0.8838 (0.8847) acc_u 15.6250 (12.7083) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.3855, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 623
clean true:616
clean false:7
clean_rate:0.9887640449438202
noisy true:355
noisy false:638
after delete: len(clean_dataset) 623
after delete: len(noisy_dataset) 993
epoch [13/200] batch [5/19] time 0.175 (0.181) data 0.097 (0.104) loss_x loss_x 0.5464 (0.9229) acc_x 84.3750 (78.1250) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/19] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.6816 (0.8986) acc_x 81.2500 (79.0625) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [15/19] time 0.179 (0.184) data 0.102 (0.107) loss_x loss_x 1.3242 (0.9479) acc_x 65.6250 (76.2500) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/31] time 0.162 (0.180) data 0.085 (0.103) loss_u loss_u 0.8789 (0.8692) acc_u 18.7500 (17.5000) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [10/31] time 0.169 (0.180) data 0.092 (0.103) loss_u loss_u 0.8218 (0.8602) acc_u 18.7500 (17.1875) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [15/31] time 0.187 (0.180) data 0.109 (0.103) loss_u loss_u 0.8350 (0.8646) acc_u 21.8750 (16.4583) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/31] time 0.184 (0.181) data 0.104 (0.103) loss_u loss_u 0.8892 (0.8713) acc_u 9.3750 (15.7812) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [25/31] time 0.165 (0.180) data 0.088 (0.103) loss_u loss_u 0.8608 (0.8763) acc_u 21.8750 (15.7500) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [30/31] time 0.188 (0.180) data 0.111 (0.103) loss_u loss_u 0.9702 (0.8784) acc_u 3.1250 (15.2083) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.3707, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 599
clean true:598
clean false:1
clean_rate:0.998330550918197
noisy true:341
noisy false:676
after delete: len(clean_dataset) 599
after delete: len(noisy_dataset) 1017
epoch [14/200] batch [5/18] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 1.1211 (0.9272) acc_x 71.8750 (76.2500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/18] time 0.175 (0.179) data 0.097 (0.101) loss_x loss_x 1.2246 (0.9917) acc_x 59.3750 (73.1250) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [15/18] time 0.166 (0.175) data 0.088 (0.098) loss_x loss_x 0.7930 (0.9536) acc_x 71.8750 (73.5417) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/31] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.8770 (0.8853) acc_u 12.5000 (14.3750) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/31] time 0.170 (0.177) data 0.092 (0.100) loss_u loss_u 0.9180 (0.8860) acc_u 12.5000 (14.0625) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/31] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.7993 (0.8639) acc_u 25.0000 (16.2500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/31] time 0.178 (0.179) data 0.100 (0.101) loss_u loss_u 0.7900 (0.8643) acc_u 21.8750 (15.7812) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [25/31] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8784 (0.8706) acc_u 15.6250 (15.3750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [30/31] time 0.186 (0.180) data 0.109 (0.102) loss_u loss_u 0.9282 (0.8755) acc_u 21.8750 (15.2083) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 631
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 626
clean true:623
clean false:3
clean_rate:0.9952076677316294
noisy true:362
noisy false:628
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 990
epoch [15/200] batch [5/19] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.4309 (0.8546) acc_x 87.5000 (75.0000) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [10/19] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.8325 (0.8260) acc_x 78.1250 (75.9375) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [15/19] time 0.189 (0.178) data 0.112 (0.101) loss_x loss_x 0.9170 (0.8805) acc_x 78.1250 (75.4167) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/30] time 0.185 (0.182) data 0.108 (0.104) loss_u loss_u 0.8940 (0.8947) acc_u 12.5000 (12.5000) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [10/30] time 0.164 (0.182) data 0.085 (0.104) loss_u loss_u 0.8916 (0.8924) acc_u 12.5000 (13.4375) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [15/30] time 0.190 (0.182) data 0.113 (0.104) loss_u loss_u 0.9434 (0.8910) acc_u 9.3750 (13.9583) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/30] time 0.196 (0.181) data 0.117 (0.104) loss_u loss_u 0.8862 (0.8894) acc_u 9.3750 (13.7500) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [25/30] time 0.171 (0.181) data 0.094 (0.103) loss_u loss_u 0.7954 (0.8851) acc_u 25.0000 (14.3750) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [30/30] time 0.182 (0.180) data 0.104 (0.103) loss_u loss_u 0.9136 (0.8857) acc_u 9.3750 (14.1667) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 662
confident_label rate tensor(0.3843, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 621
clean true:616
clean false:5
clean_rate:0.9919484702093397
noisy true:338
noisy false:657
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 995
epoch [16/200] batch [5/19] time 0.173 (0.187) data 0.096 (0.110) loss_x loss_x 0.6973 (0.7608) acc_x 78.1250 (76.2500) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [10/19] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 1.0508 (0.8396) acc_x 71.8750 (76.8750) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [15/19] time 0.168 (0.181) data 0.092 (0.104) loss_x loss_x 0.9609 (0.8466) acc_x 68.7500 (76.2500) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/31] time 0.162 (0.175) data 0.085 (0.098) loss_u loss_u 0.8643 (0.8754) acc_u 15.6250 (14.3750) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [10/31] time 0.171 (0.173) data 0.094 (0.096) loss_u loss_u 0.8906 (0.8747) acc_u 18.7500 (15.9375) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [15/31] time 0.188 (0.174) data 0.109 (0.097) loss_u loss_u 0.8384 (0.8796) acc_u 21.8750 (14.7917) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/31] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.8735 (0.8756) acc_u 15.6250 (15.3125) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [25/31] time 0.173 (0.175) data 0.096 (0.098) loss_u loss_u 0.9072 (0.8800) acc_u 6.2500 (14.3750) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [30/31] time 0.192 (0.177) data 0.114 (0.100) loss_u loss_u 0.8550 (0.8769) acc_u 21.8750 (15.0000) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:625
clean false:3
clean_rate:0.9952229299363057
noisy true:354
noisy false:634
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [17/200] batch [5/19] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.5889 (1.0493) acc_x 81.2500 (74.3750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/19] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.5894 (0.9185) acc_x 87.5000 (77.8125) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [15/19] time 0.190 (0.184) data 0.113 (0.107) loss_x loss_x 0.6504 (0.8598) acc_x 71.8750 (77.9167) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/30] time 0.191 (0.185) data 0.112 (0.108) loss_u loss_u 0.8477 (0.8945) acc_u 18.7500 (15.0000) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [10/30] time 0.188 (0.185) data 0.108 (0.108) loss_u loss_u 0.8901 (0.8837) acc_u 9.3750 (14.6875) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/30] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.8271 (0.8737) acc_u 28.1250 (16.6667) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/30] time 0.185 (0.186) data 0.108 (0.108) loss_u loss_u 0.9014 (0.8766) acc_u 12.5000 (16.0938) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [25/30] time 0.220 (0.188) data 0.143 (0.110) loss_u loss_u 0.7871 (0.8804) acc_u 18.7500 (15.0000) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [30/30] time 0.184 (0.190) data 0.107 (0.112) loss_u loss_u 0.9282 (0.8802) acc_u 6.2500 (14.7917) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.3880, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 627
clean true:624
clean false:3
clean_rate:0.9952153110047847
noisy true:368
noisy false:621
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 989
epoch [18/200] batch [5/19] time 0.187 (0.187) data 0.111 (0.110) loss_x loss_x 0.8013 (0.8180) acc_x 84.3750 (77.5000) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [10/19] time 0.162 (0.183) data 0.085 (0.106) loss_x loss_x 0.2864 (0.7506) acc_x 96.8750 (81.5625) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [15/19] time 0.177 (0.179) data 0.099 (0.102) loss_x loss_x 0.7173 (0.7765) acc_x 75.0000 (80.0000) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/30] time 0.170 (0.180) data 0.092 (0.103) loss_u loss_u 0.8481 (0.8714) acc_u 12.5000 (13.1250) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [10/30] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.9272 (0.8645) acc_u 9.3750 (15.0000) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [15/30] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.8818 (0.8645) acc_u 15.6250 (15.2083) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [20/30] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.8296 (0.8663) acc_u 25.0000 (15.1562) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [25/30] time 0.200 (0.180) data 0.123 (0.103) loss_u loss_u 0.8525 (0.8632) acc_u 15.6250 (15.7500) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [30/30] time 0.185 (0.179) data 0.106 (0.102) loss_u loss_u 0.9365 (0.8608) acc_u 6.2500 (16.1458) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 610
confident_label rate tensor(0.4072, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 658
clean true:654
clean false:4
clean_rate:0.993920972644377
noisy true:352
noisy false:606
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 958
epoch [19/200] batch [5/20] time 0.161 (0.175) data 0.084 (0.097) loss_x loss_x 0.7847 (0.8278) acc_x 81.2500 (77.5000) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [10/20] time 0.161 (0.173) data 0.085 (0.095) loss_x loss_x 0.9077 (0.7909) acc_x 75.0000 (79.3750) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [15/20] time 0.178 (0.171) data 0.101 (0.094) loss_x loss_x 0.6797 (0.7959) acc_x 81.2500 (79.1667) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [20/20] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 1.2695 (0.8645) acc_x 68.7500 (77.3438) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/29] time 0.183 (0.174) data 0.105 (0.097) loss_u loss_u 0.9395 (0.9143) acc_u 9.3750 (10.0000) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [10/29] time 0.185 (0.175) data 0.106 (0.098) loss_u loss_u 0.8262 (0.8864) acc_u 25.0000 (12.8125) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [15/29] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.7944 (0.8753) acc_u 21.8750 (13.9583) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [20/29] time 0.184 (0.176) data 0.106 (0.099) loss_u loss_u 0.8447 (0.8781) acc_u 18.7500 (14.2188) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/29] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.8770 (0.8743) acc_u 18.7500 (14.8750) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 633
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:611
clean false:6
clean_rate:0.9902755267423015
noisy true:372
noisy false:627
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [20/200] batch [5/19] time 0.185 (0.192) data 0.109 (0.114) loss_x loss_x 1.0752 (0.8404) acc_x 78.1250 (78.7500) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/19] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.4910 (0.7840) acc_x 84.3750 (80.0000) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [15/19] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.9263 (0.8163) acc_x 75.0000 (79.3750) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/31] time 0.229 (0.180) data 0.151 (0.103) loss_u loss_u 0.9180 (0.9044) acc_u 6.2500 (10.6250) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/31] time 0.174 (0.184) data 0.097 (0.106) loss_u loss_u 0.9624 (0.8957) acc_u 6.2500 (11.2500) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/31] time 0.184 (0.184) data 0.106 (0.106) loss_u loss_u 0.8506 (0.8828) acc_u 15.6250 (12.5000) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/31] time 0.186 (0.184) data 0.107 (0.106) loss_u loss_u 0.8350 (0.8741) acc_u 21.8750 (13.5938) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [25/31] time 0.178 (0.183) data 0.100 (0.106) loss_u loss_u 0.8721 (0.8836) acc_u 15.6250 (12.3750) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [30/31] time 0.171 (0.183) data 0.094 (0.106) loss_u loss_u 0.8345 (0.8785) acc_u 18.7500 (13.3333) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 601
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 657
clean true:654
clean false:3
clean_rate:0.9954337899543378
noisy true:361
noisy false:598
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 959
epoch [21/200] batch [5/20] time 0.184 (0.184) data 0.107 (0.106) loss_x loss_x 0.8550 (0.7501) acc_x 75.0000 (79.3750) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [10/20] time 0.172 (0.184) data 0.095 (0.106) loss_x loss_x 0.7212 (0.7226) acc_x 81.2500 (80.6250) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [15/20] time 0.188 (0.183) data 0.111 (0.106) loss_x loss_x 0.7861 (0.7585) acc_x 84.3750 (80.2083) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [20/20] time 0.183 (0.184) data 0.106 (0.106) loss_x loss_x 1.0889 (0.8122) acc_x 75.0000 (78.9062) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/29] time 0.183 (0.184) data 0.106 (0.106) loss_u loss_u 0.8999 (0.9010) acc_u 9.3750 (11.8750) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [10/29] time 0.174 (0.183) data 0.095 (0.105) loss_u loss_u 0.9121 (0.8917) acc_u 9.3750 (13.1250) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [15/29] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.7900 (0.8786) acc_u 25.0000 (14.7917) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [20/29] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.9321 (0.8854) acc_u 6.2500 (13.7500) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [25/29] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.7773 (0.8826) acc_u 31.2500 (14.5000) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 623
confident_label rate tensor(0.3954, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 639
clean true:635
clean false:4
clean_rate:0.9937402190923318
noisy true:358
noisy false:619
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 977
epoch [22/200] batch [5/19] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 1.0410 (0.7512) acc_x 78.1250 (79.3750) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/19] time 0.199 (0.183) data 0.122 (0.106) loss_x loss_x 1.2100 (0.7911) acc_x 75.0000 (80.6250) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [15/19] time 0.168 (0.179) data 0.091 (0.103) loss_x loss_x 0.5708 (0.8292) acc_x 87.5000 (80.0000) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/30] time 0.188 (0.179) data 0.110 (0.102) loss_u loss_u 0.9346 (0.8703) acc_u 9.3750 (15.6250) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/30] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.8521 (0.8703) acc_u 18.7500 (15.3125) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/30] time 0.172 (0.178) data 0.094 (0.101) loss_u loss_u 0.7988 (0.8623) acc_u 21.8750 (16.2500) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [20/30] time 0.177 (0.176) data 0.098 (0.099) loss_u loss_u 0.8872 (0.8727) acc_u 12.5000 (15.1562) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [25/30] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.8389 (0.8656) acc_u 15.6250 (15.7500) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [30/30] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.9053 (0.8643) acc_u 9.3750 (15.8333) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 638
confident_label rate tensor(0.3868, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 625
clean true:624
clean false:1
clean_rate:0.9984
noisy true:354
noisy false:637
after delete: len(clean_dataset) 625
after delete: len(noisy_dataset) 991
epoch [23/200] batch [5/19] time 0.173 (0.177) data 0.096 (0.100) loss_x loss_x 0.7852 (0.7822) acc_x 75.0000 (77.5000) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [10/19] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.7451 (0.7529) acc_x 81.2500 (79.6875) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [15/19] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.7725 (0.7827) acc_x 78.1250 (78.7500) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/30] time 0.189 (0.178) data 0.110 (0.101) loss_u loss_u 0.7690 (0.8704) acc_u 28.1250 (16.8750) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [10/30] time 0.185 (0.179) data 0.108 (0.101) loss_u loss_u 0.9014 (0.8601) acc_u 6.2500 (17.5000) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [15/30] time 0.170 (0.179) data 0.093 (0.101) loss_u loss_u 0.7905 (0.8693) acc_u 25.0000 (16.0417) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [20/30] time 0.173 (0.179) data 0.096 (0.102) loss_u loss_u 0.9141 (0.8677) acc_u 9.3750 (16.0938) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [25/30] time 0.183 (0.180) data 0.105 (0.102) loss_u loss_u 0.8672 (0.8634) acc_u 15.6250 (16.6250) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [30/30] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9067 (0.8658) acc_u 12.5000 (16.1458) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 614
confident_label rate tensor(0.3998, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 646
clean true:642
clean false:4
clean_rate:0.9938080495356038
noisy true:360
noisy false:610
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 970
epoch [24/200] batch [5/20] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.8555 (0.8646) acc_x 75.0000 (77.5000) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/20] time 0.165 (0.177) data 0.088 (0.100) loss_x loss_x 0.9082 (0.8743) acc_x 78.1250 (78.4375) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [15/20] time 0.182 (0.175) data 0.104 (0.098) loss_x loss_x 1.2520 (0.9210) acc_x 71.8750 (77.2917) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [20/20] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.8364 (0.8915) acc_x 81.2500 (78.4375) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/30] time 0.192 (0.175) data 0.115 (0.097) loss_u loss_u 0.9004 (0.8936) acc_u 12.5000 (11.2500) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [10/30] time 0.172 (0.175) data 0.095 (0.097) loss_u loss_u 0.8843 (0.8927) acc_u 12.5000 (11.5625) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [15/30] time 0.187 (0.176) data 0.110 (0.099) loss_u loss_u 0.9307 (0.8911) acc_u 9.3750 (12.2917) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/30] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.8330 (0.8752) acc_u 21.8750 (14.2188) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [25/30] time 0.191 (0.176) data 0.113 (0.099) loss_u loss_u 0.8076 (0.8742) acc_u 18.7500 (14.3750) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [30/30] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.8540 (0.8719) acc_u 21.8750 (14.8958) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 596
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 657
clean true:653
clean false:4
clean_rate:0.9939117199391172
noisy true:367
noisy false:592
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 959
epoch [25/200] batch [5/20] time 0.163 (0.166) data 0.086 (0.089) loss_x loss_x 1.0273 (0.8277) acc_x 71.8750 (78.1250) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/20] time 0.173 (0.167) data 0.096 (0.090) loss_x loss_x 0.7598 (0.8092) acc_x 84.3750 (79.0625) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [15/20] time 0.170 (0.171) data 0.093 (0.094) loss_x loss_x 0.7158 (0.8076) acc_x 78.1250 (77.7083) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [20/20] time 0.190 (0.172) data 0.113 (0.095) loss_x loss_x 0.6006 (0.7802) acc_x 81.2500 (79.0625) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/29] time 0.175 (0.173) data 0.098 (0.095) loss_u loss_u 0.8872 (0.8929) acc_u 9.3750 (11.8750) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [10/29] time 0.189 (0.174) data 0.110 (0.096) loss_u loss_u 0.8965 (0.9004) acc_u 12.5000 (10.9375) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [15/29] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.9385 (0.8882) acc_u 6.2500 (12.5000) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [20/29] time 0.194 (0.175) data 0.116 (0.098) loss_u loss_u 0.8774 (0.8860) acc_u 12.5000 (12.8125) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [25/29] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.8125 (0.8804) acc_u 31.2500 (14.0000) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 616
confident_label rate tensor(0.3967, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 641
clean true:638
clean false:3
clean_rate:0.9953198127925117
noisy true:362
noisy false:613
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 975
epoch [26/200] batch [5/20] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.7188 (0.8424) acc_x 78.1250 (81.8750) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/20] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.8052 (0.8357) acc_x 81.2500 (81.5625) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/20] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7368 (0.8330) acc_x 75.0000 (78.7500) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [20/20] time 0.173 (0.181) data 0.095 (0.104) loss_x loss_x 1.1162 (0.8296) acc_x 81.2500 (78.9062) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/30] time 0.179 (0.181) data 0.100 (0.104) loss_u loss_u 0.8643 (0.8533) acc_u 12.5000 (18.1250) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/30] time 0.178 (0.180) data 0.100 (0.103) loss_u loss_u 0.8789 (0.8773) acc_u 18.7500 (15.3125) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [15/30] time 0.170 (0.180) data 0.092 (0.103) loss_u loss_u 0.9482 (0.8803) acc_u 6.2500 (14.7917) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [20/30] time 0.173 (0.180) data 0.094 (0.102) loss_u loss_u 0.7974 (0.8703) acc_u 21.8750 (15.9375) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [25/30] time 0.188 (0.180) data 0.111 (0.103) loss_u loss_u 0.9272 (0.8725) acc_u 9.3750 (15.6250) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [30/30] time 0.186 (0.181) data 0.110 (0.104) loss_u loss_u 0.8838 (0.8684) acc_u 12.5000 (15.8333) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.4059, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 656
clean true:651
clean false:5
clean_rate:0.9923780487804879
noisy true:363
noisy false:597
after delete: len(clean_dataset) 656
after delete: len(noisy_dataset) 960
epoch [27/200] batch [5/20] time 0.166 (0.165) data 0.089 (0.088) loss_x loss_x 1.0156 (0.9033) acc_x 78.1250 (79.3750) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/20] time 0.178 (0.168) data 0.101 (0.091) loss_x loss_x 0.3953 (0.8181) acc_x 93.7500 (80.9375) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/20] time 0.164 (0.170) data 0.087 (0.093) loss_x loss_x 0.8184 (0.8183) acc_x 71.8750 (80.6250) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [20/20] time 0.186 (0.172) data 0.109 (0.095) loss_x loss_x 0.9683 (0.7994) acc_x 75.0000 (80.4688) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/30] time 0.191 (0.176) data 0.114 (0.099) loss_u loss_u 0.8828 (0.8750) acc_u 9.3750 (15.0000) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [10/30] time 0.193 (0.176) data 0.114 (0.099) loss_u loss_u 0.8374 (0.8700) acc_u 15.6250 (14.3750) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [15/30] time 0.176 (0.176) data 0.099 (0.098) loss_u loss_u 0.9272 (0.8745) acc_u 6.2500 (13.9583) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [20/30] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.8657 (0.8804) acc_u 12.5000 (13.5938) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [25/30] time 0.172 (0.176) data 0.093 (0.099) loss_u loss_u 0.8647 (0.8793) acc_u 15.6250 (13.8750) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [30/30] time 0.172 (0.177) data 0.093 (0.099) loss_u loss_u 0.8218 (0.8787) acc_u 25.0000 (14.0625) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 587
confident_label rate tensor(0.4152, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 671
clean true:667
clean false:4
clean_rate:0.9940387481371088
noisy true:362
noisy false:583
after delete: len(clean_dataset) 671
after delete: len(noisy_dataset) 945
epoch [28/200] batch [5/20] time 0.186 (0.184) data 0.109 (0.107) loss_x loss_x 0.8774 (0.9777) acc_x 68.7500 (73.1250) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [10/20] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.8540 (0.8929) acc_x 75.0000 (74.3750) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/20] time 0.172 (0.182) data 0.095 (0.105) loss_x loss_x 0.7046 (0.9366) acc_x 81.2500 (73.7500) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [20/20] time 0.185 (0.181) data 0.109 (0.105) loss_x loss_x 0.7104 (0.8656) acc_x 84.3750 (75.4688) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/29] time 0.189 (0.184) data 0.111 (0.107) loss_u loss_u 0.8872 (0.8688) acc_u 9.3750 (15.0000) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/29] time 0.171 (0.184) data 0.091 (0.106) loss_u loss_u 0.8970 (0.8607) acc_u 12.5000 (16.5625) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/29] time 0.183 (0.184) data 0.106 (0.106) loss_u loss_u 0.8589 (0.8661) acc_u 15.6250 (16.0417) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [20/29] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.7949 (0.8685) acc_u 21.8750 (15.6250) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [25/29] time 0.174 (0.184) data 0.096 (0.107) loss_u loss_u 0.8530 (0.8701) acc_u 15.6250 (15.3750) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.4090, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 661
clean true:659
clean false:2
clean_rate:0.9969742813918305
noisy true:359
noisy false:596
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 955
epoch [29/200] batch [5/20] time 0.183 (0.185) data 0.105 (0.108) loss_x loss_x 1.2812 (0.9281) acc_x 68.7500 (73.1250) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [10/20] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.8647 (0.8139) acc_x 71.8750 (77.1875) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/20] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.8872 (0.8358) acc_x 75.0000 (76.8750) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [20/20] time 0.183 (0.184) data 0.105 (0.107) loss_x loss_x 0.7544 (0.8333) acc_x 84.3750 (77.5000) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/29] time 0.168 (0.181) data 0.091 (0.104) loss_u loss_u 0.9707 (0.8692) acc_u 3.1250 (16.2500) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [10/29] time 0.189 (0.181) data 0.111 (0.104) loss_u loss_u 0.8862 (0.8640) acc_u 18.7500 (15.9375) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [15/29] time 0.189 (0.181) data 0.111 (0.104) loss_u loss_u 0.9165 (0.8699) acc_u 9.3750 (15.6250) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [20/29] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.8931 (0.8667) acc_u 12.5000 (15.7812) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [25/29] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.8276 (0.8603) acc_u 18.7500 (16.2500) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.4270, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 690
clean true:687
clean false:3
clean_rate:0.9956521739130435
noisy true:366
noisy false:560
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 926
epoch [30/200] batch [5/21] time 0.168 (0.169) data 0.091 (0.092) loss_x loss_x 0.6011 (0.7941) acc_x 81.2500 (77.5000) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/21] time 0.159 (0.169) data 0.082 (0.093) loss_x loss_x 0.9800 (0.7854) acc_x 68.7500 (78.4375) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/21] time 0.185 (0.172) data 0.107 (0.095) loss_x loss_x 0.9204 (0.8024) acc_x 78.1250 (78.3333) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/21] time 0.235 (0.177) data 0.157 (0.101) loss_x loss_x 1.2578 (0.8198) acc_x 65.6250 (77.5000) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/28] time 0.189 (0.180) data 0.110 (0.103) loss_u loss_u 0.8428 (0.8411) acc_u 18.7500 (17.5000) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [10/28] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.8833 (0.8556) acc_u 12.5000 (16.5625) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [15/28] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.8545 (0.8660) acc_u 15.6250 (15.2083) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [20/28] time 0.208 (0.184) data 0.130 (0.106) loss_u loss_u 0.9702 (0.8704) acc_u 3.1250 (15.0000) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [25/28] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.9424 (0.8813) acc_u 6.2500 (13.5000) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 577
confident_label rate tensor(0.4146, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 670
clean true:665
clean false:5
clean_rate:0.9925373134328358
noisy true:374
noisy false:572
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 946
epoch [31/200] batch [5/20] time 0.179 (0.186) data 0.102 (0.109) loss_x loss_x 0.8486 (0.6535) acc_x 75.0000 (80.6250) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [10/20] time 0.166 (0.177) data 0.089 (0.100) loss_x loss_x 0.8535 (0.6910) acc_x 84.3750 (81.2500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/20] time 0.191 (0.178) data 0.113 (0.101) loss_x loss_x 0.7412 (0.7051) acc_x 71.8750 (79.1667) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [20/20] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.6367 (0.7811) acc_x 87.5000 (77.9688) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/29] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9033 (0.8831) acc_u 12.5000 (15.0000) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/29] time 0.187 (0.185) data 0.110 (0.107) loss_u loss_u 0.9116 (0.8623) acc_u 15.6250 (17.5000) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/29] time 0.189 (0.185) data 0.112 (0.108) loss_u loss_u 0.8843 (0.8688) acc_u 12.5000 (17.0833) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/29] time 0.174 (0.184) data 0.096 (0.107) loss_u loss_u 0.9209 (0.8767) acc_u 9.3750 (15.6250) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [25/29] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8672 (0.8776) acc_u 18.7500 (15.3750) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 604
confident_label rate tensor(0.4103, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 663
clean true:658
clean false:5
clean_rate:0.9924585218702866
noisy true:354
noisy false:599
after delete: len(clean_dataset) 663
after delete: len(noisy_dataset) 953
epoch [32/200] batch [5/20] time 0.180 (0.185) data 0.103 (0.107) loss_x loss_x 0.8672 (0.8203) acc_x 78.1250 (79.3750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/20] time 0.193 (0.185) data 0.116 (0.108) loss_x loss_x 0.7051 (0.8225) acc_x 81.2500 (79.6875) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/20] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.7651 (0.8081) acc_x 84.3750 (78.9583) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [20/20] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.8174 (0.8149) acc_x 75.0000 (78.9062) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/29] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8184 (0.8729) acc_u 18.7500 (15.6250) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/29] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.9478 (0.8738) acc_u 6.2500 (15.3125) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [15/29] time 0.183 (0.183) data 0.106 (0.105) loss_u loss_u 0.8247 (0.8726) acc_u 12.5000 (15.0000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [20/29] time 0.184 (0.183) data 0.108 (0.106) loss_u loss_u 0.8452 (0.8752) acc_u 15.6250 (14.2188) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [25/29] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8672 (0.8691) acc_u 12.5000 (14.7500) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.4115, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 665
clean true:661
clean false:4
clean_rate:0.9939849624060151
noisy true:373
noisy false:578
after delete: len(clean_dataset) 665
after delete: len(noisy_dataset) 951
epoch [33/200] batch [5/20] time 0.178 (0.176) data 0.102 (0.098) loss_x loss_x 0.8345 (0.8324) acc_x 78.1250 (80.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/20] time 0.173 (0.179) data 0.095 (0.102) loss_x loss_x 0.8467 (0.7493) acc_x 75.0000 (80.6250) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/20] time 0.170 (0.178) data 0.092 (0.100) loss_x loss_x 0.6396 (0.7799) acc_x 84.3750 (80.8333) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [20/20] time 0.188 (0.180) data 0.111 (0.103) loss_x loss_x 0.7456 (0.7953) acc_x 75.0000 (80.0000) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/29] time 0.185 (0.182) data 0.108 (0.104) loss_u loss_u 0.8838 (0.8693) acc_u 9.3750 (14.3750) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/29] time 0.173 (0.182) data 0.093 (0.104) loss_u loss_u 0.9180 (0.8675) acc_u 9.3750 (14.6875) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [15/29] time 0.192 (0.182) data 0.114 (0.104) loss_u loss_u 0.8594 (0.8600) acc_u 18.7500 (16.0417) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [20/29] time 0.180 (0.182) data 0.101 (0.104) loss_u loss_u 0.8613 (0.8556) acc_u 15.6250 (16.2500) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [25/29] time 0.181 (0.180) data 0.103 (0.103) loss_u loss_u 0.8501 (0.8617) acc_u 21.8750 (15.6250) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.4158, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 672
clean true:668
clean false:4
clean_rate:0.9940476190476191
noisy true:366
noisy false:578
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 944
epoch [34/200] batch [5/21] time 0.169 (0.186) data 0.093 (0.109) loss_x loss_x 0.5474 (0.7750) acc_x 84.3750 (81.8750) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [10/21] time 0.168 (0.177) data 0.091 (0.101) loss_x loss_x 0.7222 (0.8185) acc_x 78.1250 (78.4375) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/21] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.6680 (0.7841) acc_x 87.5000 (79.7917) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/21] time 0.177 (0.176) data 0.100 (0.099) loss_x loss_x 0.7837 (0.7571) acc_x 81.2500 (80.6250) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/29] time 0.176 (0.177) data 0.097 (0.100) loss_u loss_u 0.9126 (0.8897) acc_u 9.3750 (12.5000) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [10/29] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.7324 (0.8862) acc_u 28.1250 (13.4375) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [15/29] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.8828 (0.8759) acc_u 12.5000 (14.7917) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [20/29] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.9526 (0.8776) acc_u 3.1250 (14.6875) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [25/29] time 0.160 (0.178) data 0.083 (0.101) loss_u loss_u 0.8398 (0.8765) acc_u 25.0000 (15.1250) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 579
confident_label rate tensor(0.4226, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 683
clean true:678
clean false:5
clean_rate:0.9926793557833089
noisy true:359
noisy false:574
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 933
epoch [35/200] batch [5/21] time 0.172 (0.168) data 0.094 (0.091) loss_x loss_x 0.7373 (0.8802) acc_x 81.2500 (78.7500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/21] time 0.172 (0.168) data 0.095 (0.091) loss_x loss_x 0.4128 (0.8347) acc_x 84.3750 (76.2500) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/21] time 0.171 (0.171) data 0.093 (0.094) loss_x loss_x 0.6182 (0.8628) acc_x 87.5000 (75.6250) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/21] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 0.8896 (0.8834) acc_x 81.2500 (75.6250) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/29] time 0.172 (0.174) data 0.095 (0.096) loss_u loss_u 0.9282 (0.8827) acc_u 9.3750 (13.7500) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/29] time 0.203 (0.175) data 0.125 (0.098) loss_u loss_u 0.8047 (0.8765) acc_u 18.7500 (14.3750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [15/29] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9146 (0.8738) acc_u 6.2500 (14.1667) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/29] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.8149 (0.8767) acc_u 21.8750 (13.9062) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [25/29] time 0.168 (0.178) data 0.090 (0.101) loss_u loss_u 0.8276 (0.8722) acc_u 25.0000 (14.6250) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.4319, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 698
clean true:691
clean false:7
clean_rate:0.9899713467048711
noisy true:362
noisy false:556
after delete: len(clean_dataset) 698
after delete: len(noisy_dataset) 918
epoch [36/200] batch [5/21] time 0.186 (0.191) data 0.109 (0.114) loss_x loss_x 0.7163 (0.7127) acc_x 81.2500 (78.1250) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/21] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.8135 (0.7259) acc_x 78.1250 (78.7500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/21] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 1.1641 (0.8264) acc_x 68.7500 (76.4583) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/21] time 0.183 (0.187) data 0.105 (0.110) loss_x loss_x 0.4019 (0.7668) acc_x 81.2500 (78.4375) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/28] time 0.180 (0.185) data 0.103 (0.108) loss_u loss_u 0.9062 (0.8624) acc_u 12.5000 (16.8750) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [10/28] time 0.170 (0.183) data 0.091 (0.106) loss_u loss_u 0.8433 (0.8576) acc_u 18.7500 (18.7500) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [15/28] time 0.172 (0.182) data 0.094 (0.104) loss_u loss_u 0.8672 (0.8593) acc_u 12.5000 (18.1250) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/28] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.9248 (0.8651) acc_u 9.3750 (16.8750) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [25/28] time 0.180 (0.181) data 0.101 (0.103) loss_u loss_u 0.9043 (0.8741) acc_u 9.3750 (15.2500) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 587
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 673
clean true:665
clean false:8
clean_rate:0.9881129271916791
noisy true:364
noisy false:579
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 943
epoch [37/200] batch [5/21] time 0.220 (0.187) data 0.143 (0.110) loss_x loss_x 0.5420 (0.8744) acc_x 87.5000 (77.5000) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/21] time 0.212 (0.191) data 0.135 (0.114) loss_x loss_x 0.8809 (0.8016) acc_x 81.2500 (78.7500) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/21] time 0.188 (0.188) data 0.111 (0.111) loss_x loss_x 0.8735 (0.8208) acc_x 71.8750 (78.3333) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/21] time 0.178 (0.184) data 0.101 (0.108) loss_x loss_x 1.1201 (0.8355) acc_x 71.8750 (78.1250) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/29] time 0.170 (0.183) data 0.093 (0.106) loss_u loss_u 0.9043 (0.8901) acc_u 12.5000 (13.1250) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/29] time 0.192 (0.182) data 0.114 (0.104) loss_u loss_u 0.8711 (0.8861) acc_u 12.5000 (13.7500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [15/29] time 0.180 (0.181) data 0.098 (0.104) loss_u loss_u 0.7339 (0.8702) acc_u 28.1250 (15.0000) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/29] time 0.184 (0.181) data 0.105 (0.104) loss_u loss_u 0.8481 (0.8704) acc_u 18.7500 (15.6250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [25/29] time 0.190 (0.182) data 0.112 (0.105) loss_u loss_u 0.8208 (0.8683) acc_u 18.7500 (15.5000) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 694
clean true:691
clean false:3
clean_rate:0.9956772334293948
noisy true:368
noisy false:554
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 922
epoch [38/200] batch [5/21] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.7983 (0.8728) acc_x 81.2500 (76.2500) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/21] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 1.1055 (0.8425) acc_x 78.1250 (78.4375) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/21] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.6406 (0.8090) acc_x 78.1250 (79.3750) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/21] time 0.187 (0.183) data 0.111 (0.106) loss_x loss_x 0.8042 (0.7682) acc_x 84.3750 (80.1562) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/28] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8721 (0.8702) acc_u 15.6250 (14.3750) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/28] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9106 (0.8757) acc_u 9.3750 (13.1250) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/28] time 0.188 (0.182) data 0.111 (0.104) loss_u loss_u 0.7393 (0.8691) acc_u 34.3750 (14.7917) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [20/28] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.8735 (0.8784) acc_u 12.5000 (13.7500) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [25/28] time 0.188 (0.181) data 0.111 (0.104) loss_u loss_u 0.9204 (0.8760) acc_u 6.2500 (13.8750) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 538
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:704
clean false:3
clean_rate:0.9957567185289957
noisy true:374
noisy false:535
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [39/200] batch [5/22] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.7051 (0.7868) acc_x 81.2500 (80.0000) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/22] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.7402 (0.8214) acc_x 87.5000 (79.3750) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/22] time 0.174 (0.183) data 0.098 (0.106) loss_x loss_x 0.6060 (0.7701) acc_x 84.3750 (79.5833) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/22] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 1.0186 (0.8009) acc_x 75.0000 (78.5938) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/28] time 0.187 (0.181) data 0.110 (0.104) loss_u loss_u 0.9028 (0.8962) acc_u 9.3750 (11.2500) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [10/28] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.9038 (0.8904) acc_u 12.5000 (12.8125) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [15/28] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8569 (0.8933) acc_u 15.6250 (12.0833) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [20/28] time 0.174 (0.183) data 0.095 (0.106) loss_u loss_u 0.8770 (0.8906) acc_u 12.5000 (12.3438) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [25/28] time 0.161 (0.181) data 0.083 (0.104) loss_u loss_u 0.9238 (0.8886) acc_u 9.3750 (12.7500) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.4214, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 681
clean true:674
clean false:7
clean_rate:0.9897209985315712
noisy true:360
noisy false:575
after delete: len(clean_dataset) 681
after delete: len(noisy_dataset) 935
epoch [40/200] batch [5/21] time 0.167 (0.175) data 0.090 (0.097) loss_x loss_x 0.6152 (0.7235) acc_x 78.1250 (80.6250) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/21] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.7021 (0.7828) acc_x 75.0000 (80.9375) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/21] time 0.165 (0.174) data 0.087 (0.097) loss_x loss_x 1.1230 (0.8141) acc_x 68.7500 (78.5417) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/21] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 0.7788 (0.8261) acc_x 81.2500 (77.9688) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/29] time 0.190 (0.176) data 0.113 (0.099) loss_u loss_u 0.8530 (0.8807) acc_u 15.6250 (11.8750) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/29] time 0.189 (0.178) data 0.111 (0.100) loss_u loss_u 0.8975 (0.8768) acc_u 12.5000 (13.1250) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [15/29] time 0.191 (0.179) data 0.114 (0.102) loss_u loss_u 0.8823 (0.8753) acc_u 12.5000 (12.9167) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [20/29] time 0.189 (0.180) data 0.112 (0.103) loss_u loss_u 0.9502 (0.8717) acc_u 3.1250 (13.9062) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [25/29] time 0.191 (0.181) data 0.113 (0.104) loss_u loss_u 0.8706 (0.8706) acc_u 18.7500 (14.7500) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 558
confident_label rate tensor(0.4264, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 689
clean true:685
clean false:4
clean_rate:0.9941944847605225
noisy true:373
noisy false:554
after delete: len(clean_dataset) 689
after delete: len(noisy_dataset) 927
epoch [41/200] batch [5/21] time 0.171 (0.168) data 0.094 (0.091) loss_x loss_x 0.8257 (0.6899) acc_x 87.5000 (85.0000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/21] time 0.187 (0.174) data 0.110 (0.096) loss_x loss_x 0.5908 (0.7620) acc_x 87.5000 (83.4375) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/21] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.3357 (0.7160) acc_x 87.5000 (83.3333) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/21] time 0.190 (0.177) data 0.113 (0.100) loss_x loss_x 0.6382 (0.7484) acc_x 81.2500 (81.5625) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/28] time 0.190 (0.179) data 0.111 (0.102) loss_u loss_u 0.7812 (0.8635) acc_u 28.1250 (16.8750) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [10/28] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8496 (0.8696) acc_u 18.7500 (16.2500) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [15/28] time 0.224 (0.184) data 0.146 (0.107) loss_u loss_u 0.9209 (0.8716) acc_u 9.3750 (15.4167) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [20/28] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.7349 (0.8670) acc_u 31.2500 (15.9375) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [25/28] time 0.186 (0.186) data 0.108 (0.108) loss_u loss_u 0.9668 (0.8735) acc_u 0.0000 (15.0000) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 561
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 699
clean true:695
clean false:4
clean_rate:0.994277539341917
noisy true:360
noisy false:557
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 917
epoch [42/200] batch [5/21] time 0.169 (0.177) data 0.091 (0.100) loss_x loss_x 0.7593 (0.6227) acc_x 78.1250 (83.7500) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/21] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.6479 (0.6536) acc_x 87.5000 (83.1250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/21] time 0.187 (0.176) data 0.110 (0.099) loss_x loss_x 0.5762 (0.7053) acc_x 84.3750 (81.8750) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/21] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.7700 (0.7179) acc_x 78.1250 (81.4062) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/28] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.8193 (0.8633) acc_u 18.7500 (15.6250) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/28] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.7754 (0.8456) acc_u 21.8750 (17.5000) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/28] time 0.163 (0.177) data 0.086 (0.100) loss_u loss_u 0.9033 (0.8743) acc_u 9.3750 (14.1667) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/28] time 0.162 (0.176) data 0.082 (0.099) loss_u loss_u 0.9155 (0.8718) acc_u 9.3750 (14.8438) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [25/28] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8960 (0.8634) acc_u 12.5000 (15.7500) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.4319, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 698
clean true:692
clean false:6
clean_rate:0.9914040114613181
noisy true:387
noisy false:531
after delete: len(clean_dataset) 698
after delete: len(noisy_dataset) 918
epoch [43/200] batch [5/21] time 0.184 (0.186) data 0.106 (0.108) loss_x loss_x 0.6675 (0.8930) acc_x 75.0000 (76.8750) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/21] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 1.0068 (0.8646) acc_x 71.8750 (77.5000) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/21] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.7715 (0.8178) acc_x 81.2500 (79.1667) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/21] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.6948 (0.7699) acc_x 78.1250 (80.1562) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/28] time 0.191 (0.186) data 0.113 (0.109) loss_u loss_u 0.8389 (0.9214) acc_u 18.7500 (9.3750) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/28] time 0.186 (0.185) data 0.109 (0.108) loss_u loss_u 0.8481 (0.8988) acc_u 18.7500 (12.1875) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/28] time 0.187 (0.186) data 0.110 (0.108) loss_u loss_u 0.8784 (0.8938) acc_u 15.6250 (12.5000) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [20/28] time 0.184 (0.186) data 0.107 (0.108) loss_u loss_u 0.8472 (0.8772) acc_u 18.7500 (14.3750) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [25/28] time 0.188 (0.186) data 0.112 (0.108) loss_u loss_u 0.8320 (0.8682) acc_u 21.8750 (15.6250) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 718
clean true:711
clean false:7
clean_rate:0.9902506963788301
noisy true:363
noisy false:535
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 898
epoch [44/200] batch [5/22] time 0.170 (0.184) data 0.093 (0.107) loss_x loss_x 1.0547 (0.8737) acc_x 68.7500 (75.6250) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/22] time 0.176 (0.180) data 0.100 (0.103) loss_x loss_x 0.8057 (0.7005) acc_x 84.3750 (80.6250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/22] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 1.1807 (0.7885) acc_x 62.5000 (78.3333) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/22] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.6284 (0.8142) acc_x 81.2500 (78.4375) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/28] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.8848 (0.8665) acc_u 15.6250 (16.8750) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/28] time 0.177 (0.178) data 0.101 (0.101) loss_u loss_u 0.8535 (0.8694) acc_u 15.6250 (15.3125) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [15/28] time 0.174 (0.177) data 0.096 (0.099) loss_u loss_u 0.8975 (0.8657) acc_u 15.6250 (16.0417) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [20/28] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.8691 (0.8720) acc_u 12.5000 (14.8438) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [25/28] time 0.160 (0.176) data 0.083 (0.099) loss_u loss_u 0.9497 (0.8756) acc_u 6.2500 (14.6250) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 721
clean true:713
clean false:8
clean_rate:0.9889042995839112
noisy true:366
noisy false:529
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 895
epoch [45/200] batch [5/22] time 0.191 (0.185) data 0.113 (0.108) loss_x loss_x 1.4072 (0.8626) acc_x 71.8750 (80.6250) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/22] time 0.176 (0.183) data 0.099 (0.106) loss_x loss_x 0.3169 (0.7091) acc_x 87.5000 (84.0625) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/22] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5376 (0.6780) acc_x 81.2500 (84.1667) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/22] time 0.222 (0.185) data 0.145 (0.108) loss_x loss_x 0.7144 (0.6855) acc_x 78.1250 (83.5938) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/27] time 0.171 (0.184) data 0.093 (0.107) loss_u loss_u 0.7705 (0.8267) acc_u 25.0000 (20.6250) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/27] time 0.180 (0.184) data 0.104 (0.107) loss_u loss_u 0.8364 (0.8289) acc_u 21.8750 (20.9375) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/27] time 0.182 (0.183) data 0.105 (0.105) loss_u loss_u 0.9141 (0.8379) acc_u 9.3750 (19.7917) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/27] time 0.175 (0.182) data 0.096 (0.105) loss_u loss_u 0.9341 (0.8556) acc_u 9.3750 (17.5000) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/27] time 0.184 (0.183) data 0.107 (0.105) loss_u loss_u 0.8984 (0.8629) acc_u 12.5000 (16.7500) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 703
clean true:699
clean false:4
clean_rate:0.9943100995732574
noisy true:387
noisy false:526
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 913
epoch [46/200] batch [5/21] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.4990 (0.7484) acc_x 84.3750 (78.1250) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/21] time 0.190 (0.184) data 0.113 (0.107) loss_x loss_x 0.7896 (0.7306) acc_x 78.1250 (78.7500) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/21] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.6094 (0.7488) acc_x 84.3750 (79.1667) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/21] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.7690 (0.7660) acc_x 84.3750 (78.2812) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/28] time 0.171 (0.178) data 0.094 (0.101) loss_u loss_u 0.9111 (0.8420) acc_u 9.3750 (18.7500) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [10/28] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8398 (0.8540) acc_u 25.0000 (18.7500) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/28] time 0.163 (0.178) data 0.086 (0.101) loss_u loss_u 0.8413 (0.8639) acc_u 18.7500 (17.2917) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/28] time 0.171 (0.177) data 0.094 (0.099) loss_u loss_u 0.8535 (0.8686) acc_u 15.6250 (16.0938) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [25/28] time 0.162 (0.176) data 0.084 (0.099) loss_u loss_u 0.8633 (0.8697) acc_u 15.6250 (15.7500) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.4220, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 682
clean true:675
clean false:7
clean_rate:0.9897360703812317
noisy true:366
noisy false:568
after delete: len(clean_dataset) 682
after delete: len(noisy_dataset) 934
epoch [47/200] batch [5/21] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 1.3799 (0.9178) acc_x 71.8750 (78.7500) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/21] time 0.180 (0.189) data 0.103 (0.112) loss_x loss_x 0.7725 (0.8511) acc_x 78.1250 (78.7500) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/21] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 0.7759 (0.7881) acc_x 71.8750 (79.5833) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/21] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.8828 (0.7641) acc_x 81.2500 (80.1562) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/29] time 0.174 (0.186) data 0.097 (0.109) loss_u loss_u 0.8633 (0.8696) acc_u 15.6250 (15.0000) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/29] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.7793 (0.8480) acc_u 31.2500 (18.1250) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/29] time 0.188 (0.183) data 0.110 (0.106) loss_u loss_u 0.8062 (0.8490) acc_u 25.0000 (18.3333) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/29] time 0.176 (0.182) data 0.099 (0.105) loss_u loss_u 0.8174 (0.8486) acc_u 21.8750 (18.1250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [25/29] time 0.180 (0.182) data 0.100 (0.104) loss_u loss_u 0.9082 (0.8508) acc_u 12.5000 (18.0000) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 550
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 712
clean true:707
clean false:5
clean_rate:0.9929775280898876
noisy true:359
noisy false:545
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 904
epoch [48/200] batch [5/22] time 0.177 (0.183) data 0.100 (0.106) loss_x loss_x 0.4961 (0.6687) acc_x 84.3750 (79.3750) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/22] time 0.186 (0.180) data 0.109 (0.103) loss_x loss_x 0.8359 (0.5870) acc_x 75.0000 (83.4375) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/22] time 0.188 (0.181) data 0.111 (0.104) loss_x loss_x 0.6191 (0.6582) acc_x 81.2500 (81.8750) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/22] time 0.171 (0.180) data 0.095 (0.103) loss_x loss_x 0.9180 (0.6873) acc_x 84.3750 (81.5625) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/28] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8501 (0.8325) acc_u 15.6250 (19.3750) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/28] time 0.167 (0.178) data 0.090 (0.101) loss_u loss_u 0.7983 (0.8342) acc_u 21.8750 (18.4375) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/28] time 0.189 (0.179) data 0.112 (0.102) loss_u loss_u 0.9268 (0.8492) acc_u 9.3750 (17.7083) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/28] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.8433 (0.8409) acc_u 21.8750 (18.7500) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [25/28] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.8999 (0.8521) acc_u 9.3750 (17.3750) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 711
clean true:709
clean false:2
clean_rate:0.9971870604781997
noisy true:375
noisy false:530
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 905
epoch [49/200] batch [5/22] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.5503 (0.5835) acc_x 81.2500 (83.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/22] time 0.177 (0.184) data 0.100 (0.107) loss_x loss_x 0.6216 (0.5804) acc_x 84.3750 (84.0625) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/22] time 0.167 (0.179) data 0.090 (0.102) loss_x loss_x 0.8833 (0.6241) acc_x 75.0000 (82.0833) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/22] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.8691 (0.6435) acc_x 81.2500 (82.1875) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/28] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.8818 (0.8745) acc_u 15.6250 (14.3750) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [10/28] time 0.176 (0.178) data 0.099 (0.101) loss_u loss_u 0.9604 (0.8811) acc_u 6.2500 (14.6875) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/28] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.8208 (0.8728) acc_u 28.1250 (15.8333) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [20/28] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.8804 (0.8681) acc_u 12.5000 (16.2500) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [25/28] time 0.181 (0.179) data 0.103 (0.101) loss_u loss_u 0.8950 (0.8724) acc_u 9.3750 (15.5000) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 716
clean true:710
clean false:6
clean_rate:0.9916201117318436
noisy true:379
noisy false:521
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 900
epoch [50/200] batch [5/22] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.6172 (0.5652) acc_x 81.2500 (86.2500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/22] time 0.172 (0.169) data 0.094 (0.092) loss_x loss_x 1.0488 (0.6988) acc_x 78.1250 (81.8750) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/22] time 0.186 (0.172) data 0.109 (0.095) loss_x loss_x 0.7349 (0.7413) acc_x 81.2500 (81.8750) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/22] time 0.190 (0.175) data 0.113 (0.097) loss_x loss_x 0.6411 (0.7449) acc_x 87.5000 (81.8750) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/28] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.9766 (0.9066) acc_u 6.2500 (11.2500) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/28] time 0.182 (0.177) data 0.105 (0.099) loss_u loss_u 0.8066 (0.8710) acc_u 21.8750 (16.2500) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/28] time 0.192 (0.177) data 0.114 (0.100) loss_u loss_u 0.8608 (0.8687) acc_u 18.7500 (16.2500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/28] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.8784 (0.8689) acc_u 12.5000 (16.2500) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [25/28] time 0.180 (0.177) data 0.102 (0.099) loss_u loss_u 0.7310 (0.8649) acc_u 31.2500 (16.3750) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:697
clean false:3
clean_rate:0.9957142857142857
noisy true:374
noisy false:542
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [51/200] batch [5/21] time 0.185 (0.171) data 0.108 (0.093) loss_x loss_x 0.7246 (0.8583) acc_x 78.1250 (75.0000) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/21] time 0.162 (0.174) data 0.084 (0.097) loss_x loss_x 0.5825 (0.7821) acc_x 84.3750 (79.0625) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/21] time 0.165 (0.173) data 0.088 (0.096) loss_x loss_x 1.0029 (0.7748) acc_x 71.8750 (78.9583) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/21] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.7466 (0.7568) acc_x 87.5000 (80.7812) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/28] time 0.172 (0.174) data 0.095 (0.097) loss_u loss_u 0.8394 (0.8517) acc_u 18.7500 (16.8750) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/28] time 0.165 (0.174) data 0.087 (0.097) loss_u loss_u 0.9521 (0.8524) acc_u 3.1250 (16.5625) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/28] time 0.174 (0.174) data 0.097 (0.097) loss_u loss_u 0.8638 (0.8525) acc_u 15.6250 (17.2917) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [20/28] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.8203 (0.8562) acc_u 25.0000 (17.1875) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [25/28] time 0.167 (0.175) data 0.090 (0.097) loss_u loss_u 0.9199 (0.8661) acc_u 9.3750 (16.2500) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 566
confident_label rate tensor(0.4233, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 684
clean true:680
clean false:4
clean_rate:0.9941520467836257
noisy true:370
noisy false:562
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 932
epoch [52/200] batch [5/21] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.3606 (0.6188) acc_x 87.5000 (81.2500) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/21] time 0.186 (0.184) data 0.108 (0.108) loss_x loss_x 0.4651 (0.5978) acc_x 90.6250 (81.8750) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/21] time 0.175 (0.184) data 0.097 (0.107) loss_x loss_x 0.5176 (0.6530) acc_x 90.6250 (81.8750) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/21] time 0.188 (0.183) data 0.111 (0.107) loss_x loss_x 0.7485 (0.6692) acc_x 81.2500 (81.4062) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/29] time 0.187 (0.185) data 0.110 (0.108) loss_u loss_u 0.8149 (0.8455) acc_u 21.8750 (18.1250) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/29] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.8560 (0.8399) acc_u 18.7500 (19.0625) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/29] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9473 (0.8355) acc_u 6.2500 (19.5833) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [20/29] time 0.192 (0.185) data 0.115 (0.108) loss_u loss_u 0.8809 (0.8330) acc_u 9.3750 (19.3750) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [25/29] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.9282 (0.8429) acc_u 9.3750 (18.5000) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 541
confident_label rate tensor(0.4437, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 717
clean true:710
clean false:7
clean_rate:0.9902370990237099
noisy true:365
noisy false:534
after delete: len(clean_dataset) 717
after delete: len(noisy_dataset) 899
epoch [53/200] batch [5/22] time 0.177 (0.174) data 0.100 (0.097) loss_x loss_x 0.6782 (0.5951) acc_x 84.3750 (86.2500) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/22] time 0.172 (0.172) data 0.095 (0.095) loss_x loss_x 0.4929 (0.6352) acc_x 87.5000 (83.4375) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/22] time 0.185 (0.175) data 0.109 (0.098) loss_x loss_x 0.4133 (0.6256) acc_x 90.6250 (83.5417) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/22] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 1.2441 (0.7127) acc_x 68.7500 (81.2500) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/28] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.8516 (0.8608) acc_u 18.7500 (15.6250) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/28] time 0.198 (0.181) data 0.121 (0.104) loss_u loss_u 0.9292 (0.8612) acc_u 9.3750 (16.2500) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/28] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.7505 (0.8545) acc_u 28.1250 (16.8750) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [20/28] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8765 (0.8611) acc_u 12.5000 (16.0938) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [25/28] time 0.188 (0.183) data 0.112 (0.106) loss_u loss_u 0.8481 (0.8625) acc_u 15.6250 (15.5000) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 541
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 691
clean true:688
clean false:3
clean_rate:0.9956584659913169
noisy true:387
noisy false:538
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 925
epoch [54/200] batch [5/21] time 0.184 (0.190) data 0.106 (0.113) loss_x loss_x 1.2451 (0.7917) acc_x 75.0000 (81.8750) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/21] time 0.167 (0.182) data 0.090 (0.105) loss_x loss_x 0.6899 (0.7332) acc_x 87.5000 (82.1875) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/21] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 1.2715 (0.7974) acc_x 75.0000 (81.4583) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/21] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.7451 (0.7853) acc_x 81.2500 (80.7812) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/28] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.9116 (0.8333) acc_u 9.3750 (18.1250) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/28] time 0.187 (0.186) data 0.108 (0.109) loss_u loss_u 0.7725 (0.8483) acc_u 28.1250 (17.5000) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/28] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.8457 (0.8565) acc_u 15.6250 (16.4583) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/28] time 0.186 (0.186) data 0.108 (0.109) loss_u loss_u 0.8955 (0.8576) acc_u 9.3750 (16.2500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [25/28] time 0.183 (0.186) data 0.105 (0.109) loss_u loss_u 0.8501 (0.8545) acc_u 15.6250 (16.5000) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 711
clean true:706
clean false:5
clean_rate:0.9929676511954993
noisy true:368
noisy false:537
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 905
epoch [55/200] batch [5/22] time 0.189 (0.176) data 0.111 (0.098) loss_x loss_x 0.4702 (0.6146) acc_x 90.6250 (84.3750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/22] time 0.168 (0.172) data 0.091 (0.095) loss_x loss_x 0.7617 (0.6659) acc_x 87.5000 (83.7500) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/22] time 0.179 (0.171) data 0.102 (0.094) loss_x loss_x 0.7314 (0.6957) acc_x 75.0000 (81.8750) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/22] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.6836 (0.7190) acc_x 81.2500 (81.0938) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/28] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.8027 (0.8513) acc_u 21.8750 (17.5000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/28] time 0.189 (0.176) data 0.111 (0.099) loss_u loss_u 0.7979 (0.8562) acc_u 25.0000 (17.5000) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [15/28] time 0.186 (0.176) data 0.109 (0.099) loss_u loss_u 0.8711 (0.8643) acc_u 15.6250 (16.8750) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/28] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8032 (0.8591) acc_u 21.8750 (17.1875) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [25/28] time 0.187 (0.180) data 0.110 (0.103) loss_u loss_u 0.8647 (0.8645) acc_u 18.7500 (16.3750) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 502
confident_label rate tensor(0.4561, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 737
clean true:731
clean false:6
clean_rate:0.9918588873812755
noisy true:383
noisy false:496
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 879
epoch [56/200] batch [5/23] time 0.178 (0.170) data 0.101 (0.093) loss_x loss_x 0.3926 (0.6237) acc_x 93.7500 (83.7500) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/23] time 0.168 (0.172) data 0.091 (0.094) loss_x loss_x 1.2217 (0.7445) acc_x 62.5000 (80.0000) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/23] time 0.168 (0.171) data 0.091 (0.093) loss_x loss_x 0.6221 (0.7707) acc_x 84.3750 (79.3750) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/23] time 0.185 (0.171) data 0.106 (0.094) loss_x loss_x 0.5322 (0.7496) acc_x 90.6250 (80.7812) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/27] time 0.212 (0.179) data 0.135 (0.101) loss_u loss_u 0.8203 (0.8565) acc_u 21.8750 (17.5000) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/27] time 0.193 (0.178) data 0.115 (0.101) loss_u loss_u 0.9043 (0.8737) acc_u 9.3750 (15.0000) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [15/27] time 0.186 (0.181) data 0.109 (0.103) loss_u loss_u 0.7988 (0.8559) acc_u 21.8750 (17.9167) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/27] time 0.185 (0.183) data 0.107 (0.105) loss_u loss_u 0.8511 (0.8534) acc_u 21.8750 (18.4375) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [25/27] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8481 (0.8618) acc_u 18.7500 (17.0000) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 526
confident_label rate tensor(0.4425, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 715
clean true:711
clean false:4
clean_rate:0.9944055944055944
noisy true:379
noisy false:522
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 901
epoch [57/200] batch [5/22] time 0.160 (0.172) data 0.084 (0.095) loss_x loss_x 0.5752 (0.8295) acc_x 84.3750 (80.6250) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/22] time 0.190 (0.181) data 0.113 (0.104) loss_x loss_x 0.6172 (0.7457) acc_x 81.2500 (81.8750) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/22] time 0.193 (0.182) data 0.115 (0.105) loss_x loss_x 0.8145 (0.7681) acc_x 78.1250 (81.0417) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/22] time 0.197 (0.182) data 0.121 (0.105) loss_x loss_x 0.5615 (0.7147) acc_x 87.5000 (82.6562) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/28] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8311 (0.8695) acc_u 21.8750 (16.8750) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/28] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.8486 (0.8888) acc_u 21.8750 (14.3750) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [15/28] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.8638 (0.8819) acc_u 15.6250 (14.7917) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [20/28] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.9253 (0.8780) acc_u 6.2500 (15.0000) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [25/28] time 0.186 (0.181) data 0.110 (0.104) loss_u loss_u 0.8223 (0.8749) acc_u 21.8750 (15.5000) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 706
clean true:699
clean false:7
clean_rate:0.990084985835694
noisy true:369
noisy false:541
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 910
epoch [58/200] batch [5/22] time 0.185 (0.189) data 0.108 (0.112) loss_x loss_x 0.1870 (0.7719) acc_x 96.8750 (80.6250) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/22] time 0.185 (0.192) data 0.108 (0.115) loss_x loss_x 0.5444 (0.6509) acc_x 81.2500 (83.1250) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/22] time 0.208 (0.192) data 0.130 (0.115) loss_x loss_x 1.1133 (0.7046) acc_x 68.7500 (82.0833) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/22] time 0.173 (0.190) data 0.096 (0.113) loss_x loss_x 0.5996 (0.7387) acc_x 87.5000 (80.4688) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/28] time 0.167 (0.185) data 0.090 (0.108) loss_u loss_u 0.9058 (0.8639) acc_u 12.5000 (14.3750) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/28] time 0.187 (0.185) data 0.108 (0.108) loss_u loss_u 0.8091 (0.8627) acc_u 21.8750 (15.6250) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/28] time 0.212 (0.184) data 0.134 (0.107) loss_u loss_u 0.8369 (0.8711) acc_u 18.7500 (14.5833) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [20/28] time 0.186 (0.184) data 0.107 (0.107) loss_u loss_u 0.8633 (0.8650) acc_u 15.6250 (15.6250) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [25/28] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.8501 (0.8646) acc_u 15.6250 (15.8750) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 721
clean true:718
clean false:3
clean_rate:0.9958391123439667
noisy true:382
noisy false:513
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 895
epoch [59/200] batch [5/22] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 0.3647 (0.5970) acc_x 87.5000 (83.7500) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/22] time 0.175 (0.177) data 0.096 (0.100) loss_x loss_x 0.4456 (0.6581) acc_x 87.5000 (83.1250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/22] time 0.164 (0.177) data 0.087 (0.100) loss_x loss_x 0.6299 (0.6868) acc_x 81.2500 (82.0833) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/22] time 0.170 (0.175) data 0.094 (0.098) loss_x loss_x 0.6689 (0.6812) acc_x 84.3750 (82.1875) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/27] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.9048 (0.8804) acc_u 9.3750 (14.3750) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [10/27] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.9697 (0.8703) acc_u 0.0000 (15.6250) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/27] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8706 (0.8677) acc_u 15.6250 (15.6250) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/27] time 0.196 (0.180) data 0.119 (0.102) loss_u loss_u 0.8594 (0.8708) acc_u 15.6250 (15.1562) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [25/27] time 0.158 (0.178) data 0.081 (0.101) loss_u loss_u 0.8940 (0.8754) acc_u 12.5000 (15.0000) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 523
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 718
clean true:710
clean false:8
clean_rate:0.9888579387186629
noisy true:383
noisy false:515
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 898
epoch [60/200] batch [5/22] time 0.183 (0.166) data 0.107 (0.089) loss_x loss_x 0.6807 (0.6740) acc_x 78.1250 (82.5000) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/22] time 0.177 (0.170) data 0.100 (0.093) loss_x loss_x 0.4666 (0.6486) acc_x 87.5000 (83.1250) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/22] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.8989 (0.6629) acc_x 78.1250 (82.2917) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/22] time 0.168 (0.174) data 0.092 (0.097) loss_x loss_x 0.6108 (0.6858) acc_x 78.1250 (81.7188) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/28] time 0.167 (0.174) data 0.090 (0.097) loss_u loss_u 0.9009 (0.8481) acc_u 15.6250 (18.1250) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/28] time 0.169 (0.175) data 0.090 (0.098) loss_u loss_u 0.9121 (0.8680) acc_u 12.5000 (16.2500) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/28] time 0.159 (0.174) data 0.081 (0.097) loss_u loss_u 0.8130 (0.8605) acc_u 21.8750 (16.8750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/28] time 0.170 (0.174) data 0.092 (0.096) loss_u loss_u 0.9482 (0.8677) acc_u 3.1250 (15.7812) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [25/28] time 0.170 (0.173) data 0.093 (0.096) loss_u loss_u 0.8105 (0.8633) acc_u 25.0000 (16.1250) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 720
clean true:713
clean false:7
clean_rate:0.9902777777777778
noisy true:379
noisy false:517
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 896
epoch [61/200] batch [5/22] time 0.168 (0.170) data 0.090 (0.093) loss_x loss_x 0.4277 (0.5932) acc_x 87.5000 (85.6250) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/22] time 0.173 (0.169) data 0.097 (0.092) loss_x loss_x 0.8252 (0.6893) acc_x 81.2500 (82.5000) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/22] time 0.176 (0.172) data 0.100 (0.095) loss_x loss_x 0.4907 (0.7529) acc_x 84.3750 (81.2500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/22] time 0.196 (0.176) data 0.119 (0.099) loss_x loss_x 0.8662 (0.7850) acc_x 78.1250 (80.7812) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/28] time 0.175 (0.177) data 0.097 (0.100) loss_u loss_u 0.9243 (0.8913) acc_u 9.3750 (13.1250) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/28] time 0.191 (0.179) data 0.113 (0.101) loss_u loss_u 0.8604 (0.8620) acc_u 15.6250 (16.2500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/28] time 0.193 (0.178) data 0.114 (0.101) loss_u loss_u 0.8682 (0.8446) acc_u 15.6250 (18.3333) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/28] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.9141 (0.8438) acc_u 12.5000 (18.5938) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/28] time 0.166 (0.178) data 0.089 (0.101) loss_u loss_u 0.8584 (0.8474) acc_u 12.5000 (17.8750) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 521
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 718
clean true:714
clean false:4
clean_rate:0.9944289693593314
noisy true:381
noisy false:517
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 898
epoch [62/200] batch [5/22] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.7974 (0.7799) acc_x 78.1250 (81.8750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/22] time 0.188 (0.182) data 0.110 (0.105) loss_x loss_x 0.6191 (0.6946) acc_x 84.3750 (83.7500) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/22] time 0.202 (0.184) data 0.126 (0.107) loss_x loss_x 0.8472 (0.7562) acc_x 78.1250 (81.8750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/22] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5127 (0.7340) acc_x 87.5000 (81.8750) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/28] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.8652 (0.8504) acc_u 18.7500 (17.5000) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/28] time 0.176 (0.183) data 0.099 (0.106) loss_u loss_u 0.8379 (0.8568) acc_u 15.6250 (16.2500) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/28] time 0.174 (0.182) data 0.098 (0.105) loss_u loss_u 0.9126 (0.8607) acc_u 9.3750 (15.4167) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/28] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.8604 (0.8658) acc_u 18.7500 (14.8438) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [25/28] time 0.188 (0.182) data 0.112 (0.105) loss_u loss_u 0.8394 (0.8657) acc_u 21.8750 (15.3750) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 711
clean true:705
clean false:6
clean_rate:0.9915611814345991
noisy true:369
noisy false:536
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 905
epoch [63/200] batch [5/22] time 0.182 (0.175) data 0.105 (0.099) loss_x loss_x 0.9170 (0.7287) acc_x 75.0000 (82.5000) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/22] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.5005 (0.6324) acc_x 81.2500 (84.0625) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/22] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 0.4810 (0.5800) acc_x 93.7500 (86.2500) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/22] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.7842 (0.6382) acc_x 87.5000 (85.1562) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/28] time 0.206 (0.183) data 0.129 (0.106) loss_u loss_u 0.8647 (0.8418) acc_u 15.6250 (18.7500) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/28] time 0.213 (0.185) data 0.136 (0.108) loss_u loss_u 0.8608 (0.8668) acc_u 18.7500 (16.5625) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/28] time 0.164 (0.185) data 0.086 (0.108) loss_u loss_u 0.9292 (0.8687) acc_u 9.3750 (16.0417) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/28] time 0.176 (0.184) data 0.098 (0.107) loss_u loss_u 0.8330 (0.8640) acc_u 18.7500 (16.5625) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/28] time 0.169 (0.183) data 0.092 (0.106) loss_u loss_u 0.8545 (0.8624) acc_u 18.7500 (16.5000) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.4567, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 738
clean true:729
clean false:9
clean_rate:0.9878048780487805
noisy true:360
noisy false:518
after delete: len(clean_dataset) 738
after delete: len(noisy_dataset) 878
epoch [64/200] batch [5/23] time 0.177 (0.179) data 0.101 (0.101) loss_x loss_x 0.5664 (0.6611) acc_x 87.5000 (82.5000) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/23] time 0.161 (0.173) data 0.084 (0.096) loss_x loss_x 1.1133 (0.8330) acc_x 68.7500 (80.0000) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/23] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 0.7725 (0.8406) acc_x 75.0000 (78.9583) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/23] time 0.176 (0.175) data 0.099 (0.097) loss_x loss_x 0.5776 (0.7881) acc_x 84.3750 (80.1562) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/27] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.8970 (0.9058) acc_u 9.3750 (10.0000) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/27] time 0.176 (0.176) data 0.097 (0.098) loss_u loss_u 0.8394 (0.8948) acc_u 15.6250 (11.5625) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/27] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.8779 (0.8727) acc_u 15.6250 (14.5833) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/27] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.8931 (0.8730) acc_u 15.6250 (14.8438) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [25/27] time 0.161 (0.179) data 0.084 (0.101) loss_u loss_u 0.8555 (0.8738) acc_u 21.8750 (15.0000) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.4604, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 744
clean true:738
clean false:6
clean_rate:0.9919354838709677
noisy true:385
noisy false:487
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 872
epoch [65/200] batch [5/23] time 0.187 (0.348) data 0.110 (0.271) loss_x loss_x 0.2017 (0.5525) acc_x 96.8750 (86.2500) lr 1.5490e-03 eta 0:00:06
epoch [65/200] batch [10/23] time 0.219 (0.270) data 0.142 (0.193) loss_x loss_x 0.1658 (0.5918) acc_x 96.8750 (83.7500) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/23] time 0.172 (0.241) data 0.096 (0.164) loss_x loss_x 0.3391 (0.6023) acc_x 93.7500 (83.1250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/23] time 0.187 (0.228) data 0.110 (0.150) loss_x loss_x 0.3770 (0.6357) acc_x 90.6250 (82.1875) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/27] time 0.186 (0.216) data 0.109 (0.139) loss_u loss_u 0.7881 (0.8659) acc_u 25.0000 (17.5000) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/27] time 0.207 (0.212) data 0.130 (0.135) loss_u loss_u 0.8730 (0.8688) acc_u 15.6250 (16.2500) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/27] time 0.179 (0.209) data 0.102 (0.132) loss_u loss_u 0.8223 (0.8701) acc_u 18.7500 (15.8333) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/27] time 0.252 (0.207) data 0.174 (0.129) loss_u loss_u 0.8965 (0.8790) acc_u 15.6250 (14.6875) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [25/27] time 0.169 (0.204) data 0.092 (0.126) loss_u loss_u 0.8779 (0.8796) acc_u 18.7500 (14.5000) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 519
confident_label rate tensor(0.4511, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 729
clean true:724
clean false:5
clean_rate:0.9931412894375857
noisy true:373
noisy false:514
after delete: len(clean_dataset) 729
after delete: len(noisy_dataset) 887
epoch [66/200] batch [5/22] time 0.178 (0.192) data 0.101 (0.115) loss_x loss_x 0.9546 (0.7147) acc_x 78.1250 (82.5000) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [10/22] time 0.175 (0.184) data 0.098 (0.107) loss_x loss_x 0.8267 (0.7277) acc_x 81.2500 (82.5000) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [15/22] time 0.193 (0.183) data 0.115 (0.106) loss_x loss_x 0.8853 (0.7554) acc_x 78.1250 (81.4583) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/22] time 0.169 (0.181) data 0.092 (0.103) loss_x loss_x 0.5493 (0.7538) acc_x 87.5000 (81.4062) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/27] time 0.188 (0.182) data 0.111 (0.105) loss_u loss_u 0.8418 (0.9105) acc_u 18.7500 (10.6250) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/27] time 0.190 (0.182) data 0.113 (0.105) loss_u loss_u 0.9443 (0.8802) acc_u 6.2500 (13.7500) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/27] time 0.159 (0.181) data 0.081 (0.104) loss_u loss_u 0.9663 (0.8804) acc_u 3.1250 (13.5417) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/27] time 0.169 (0.180) data 0.090 (0.103) loss_u loss_u 0.9297 (0.8825) acc_u 6.2500 (13.2812) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [25/27] time 0.182 (0.181) data 0.105 (0.103) loss_u loss_u 0.7769 (0.8812) acc_u 21.8750 (13.5000) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 521
confident_label rate tensor(0.4486, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 725
clean true:721
clean false:4
clean_rate:0.9944827586206897
noisy true:374
noisy false:517
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 891
epoch [67/200] batch [5/22] time 0.170 (0.183) data 0.093 (0.106) loss_x loss_x 0.7988 (0.8919) acc_x 81.2500 (78.7500) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/22] time 0.165 (0.177) data 0.088 (0.100) loss_x loss_x 0.9604 (0.8171) acc_x 78.1250 (79.0625) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/22] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.5044 (0.7678) acc_x 90.6250 (80.6250) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [20/22] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.9399 (0.7582) acc_x 71.8750 (80.1562) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/27] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.8594 (0.8646) acc_u 15.6250 (15.6250) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/27] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.8867 (0.8642) acc_u 12.5000 (16.5625) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/27] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9067 (0.8601) acc_u 6.2500 (16.4583) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/27] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.8862 (0.8701) acc_u 15.6250 (15.1562) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/27] time 0.200 (0.178) data 0.123 (0.101) loss_u loss_u 0.8892 (0.8685) acc_u 15.6250 (15.2500) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.4585, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 741
clean true:734
clean false:7
clean_rate:0.99055330634278
noisy true:382
noisy false:493
after delete: len(clean_dataset) 741
after delete: len(noisy_dataset) 875
epoch [68/200] batch [5/23] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.7773 (0.7784) acc_x 78.1250 (78.1250) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/23] time 0.174 (0.181) data 0.097 (0.104) loss_x loss_x 1.1719 (0.8281) acc_x 68.7500 (78.4375) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/23] time 0.170 (0.179) data 0.093 (0.102) loss_x loss_x 0.5942 (0.7641) acc_x 87.5000 (80.2083) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/23] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 1.0781 (0.7745) acc_x 71.8750 (80.1562) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/27] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.9360 (0.8679) acc_u 9.3750 (16.2500) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/27] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.8994 (0.8875) acc_u 15.6250 (14.6875) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/27] time 0.198 (0.180) data 0.119 (0.103) loss_u loss_u 0.8896 (0.8771) acc_u 12.5000 (15.2083) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/27] time 0.186 (0.180) data 0.110 (0.103) loss_u loss_u 0.8813 (0.8842) acc_u 18.7500 (14.5312) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [25/27] time 0.257 (0.183) data 0.179 (0.105) loss_u loss_u 0.9082 (0.8814) acc_u 12.5000 (14.7500) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.4629, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 748
clean true:743
clean false:5
clean_rate:0.9933155080213903
noisy true:382
noisy false:486
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 868
epoch [69/200] batch [5/23] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 1.1270 (0.8508) acc_x 65.6250 (80.6250) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [10/23] time 0.166 (0.183) data 0.090 (0.105) loss_x loss_x 0.8066 (0.7937) acc_x 71.8750 (80.3125) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [15/23] time 0.212 (0.184) data 0.135 (0.106) loss_x loss_x 0.9580 (0.7952) acc_x 71.8750 (79.1667) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/23] time 0.169 (0.182) data 0.093 (0.105) loss_x loss_x 0.3840 (0.7636) acc_x 90.6250 (79.5312) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/27] time 0.201 (0.183) data 0.123 (0.105) loss_u loss_u 0.8096 (0.8694) acc_u 21.8750 (15.0000) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/27] time 0.261 (0.185) data 0.183 (0.108) loss_u loss_u 0.8569 (0.8622) acc_u 15.6250 (15.9375) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/27] time 0.195 (0.184) data 0.118 (0.107) loss_u loss_u 0.8716 (0.8664) acc_u 15.6250 (16.0417) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/27] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9062 (0.8765) acc_u 9.3750 (15.0000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/27] time 0.187 (0.183) data 0.110 (0.106) loss_u loss_u 0.7900 (0.8725) acc_u 28.1250 (15.1250) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4443, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 718
clean true:715
clean false:3
clean_rate:0.9958217270194986
noisy true:376
noisy false:522
after delete: len(clean_dataset) 718
after delete: len(noisy_dataset) 898
epoch [70/200] batch [5/22] time 0.186 (0.170) data 0.110 (0.093) loss_x loss_x 0.4673 (0.6979) acc_x 87.5000 (80.0000) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/22] time 0.184 (0.173) data 0.106 (0.096) loss_x loss_x 0.4741 (0.6875) acc_x 84.3750 (82.1875) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/22] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.4119 (0.7254) acc_x 93.7500 (81.2500) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/22] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.9795 (0.7064) acc_x 84.3750 (82.3438) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/28] time 0.188 (0.177) data 0.111 (0.100) loss_u loss_u 0.8623 (0.8499) acc_u 15.6250 (18.1250) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [10/28] time 0.159 (0.176) data 0.082 (0.099) loss_u loss_u 0.8794 (0.8526) acc_u 12.5000 (16.8750) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/28] time 0.162 (0.174) data 0.086 (0.097) loss_u loss_u 0.8105 (0.8475) acc_u 21.8750 (17.7083) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/28] time 0.186 (0.174) data 0.107 (0.097) loss_u loss_u 0.8970 (0.8660) acc_u 15.6250 (16.0938) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [25/28] time 0.168 (0.174) data 0.090 (0.096) loss_u loss_u 0.8184 (0.8643) acc_u 25.0000 (16.6250) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4641, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 750
clean true:745
clean false:5
clean_rate:0.9933333333333333
noisy true:365
noisy false:501
after delete: len(clean_dataset) 750
after delete: len(noisy_dataset) 866
epoch [71/200] batch [5/23] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.8486 (0.8047) acc_x 78.1250 (78.1250) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/23] time 0.204 (0.179) data 0.127 (0.101) loss_x loss_x 0.5942 (0.7075) acc_x 81.2500 (80.3125) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/23] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.7417 (0.6473) acc_x 78.1250 (82.0833) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/23] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.6758 (0.6338) acc_x 84.3750 (82.9688) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/27] time 0.171 (0.179) data 0.094 (0.102) loss_u loss_u 0.9521 (0.8783) acc_u 6.2500 (15.6250) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [10/27] time 0.184 (0.178) data 0.105 (0.101) loss_u loss_u 0.8491 (0.8716) acc_u 15.6250 (15.6250) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/27] time 0.170 (0.178) data 0.093 (0.101) loss_u loss_u 0.9219 (0.8735) acc_u 9.3750 (15.2083) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/27] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8999 (0.8731) acc_u 9.3750 (15.1562) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/27] time 0.188 (0.178) data 0.111 (0.100) loss_u loss_u 0.9473 (0.8639) acc_u 3.1250 (16.1250) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.4709, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 761
clean true:753
clean false:8
clean_rate:0.9894875164257556
noisy true:373
noisy false:482
after delete: len(clean_dataset) 761
after delete: len(noisy_dataset) 855
epoch [72/200] batch [5/23] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.7305 (0.7821) acc_x 84.3750 (81.2500) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/23] time 0.165 (0.170) data 0.088 (0.093) loss_x loss_x 0.5249 (0.6748) acc_x 84.3750 (82.8125) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/23] time 0.184 (0.170) data 0.107 (0.093) loss_x loss_x 0.5396 (0.6690) acc_x 87.5000 (82.9167) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/23] time 0.169 (0.171) data 0.092 (0.094) loss_x loss_x 0.7334 (0.6877) acc_x 87.5000 (82.9688) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/26] time 0.170 (0.174) data 0.093 (0.097) loss_u loss_u 0.7534 (0.8489) acc_u 25.0000 (17.5000) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/26] time 0.178 (0.174) data 0.099 (0.097) loss_u loss_u 0.8623 (0.8505) acc_u 12.5000 (16.5625) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/26] time 0.186 (0.175) data 0.108 (0.098) loss_u loss_u 0.8628 (0.8674) acc_u 18.7500 (14.7917) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/26] time 0.187 (0.176) data 0.110 (0.099) loss_u loss_u 0.9385 (0.8758) acc_u 6.2500 (13.5938) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/26] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9150 (0.8780) acc_u 6.2500 (13.3750) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4561, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 737
clean true:732
clean false:5
clean_rate:0.9932157394843962
noisy true:390
noisy false:489
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 879
epoch [73/200] batch [5/23] time 0.170 (0.177) data 0.094 (0.101) loss_x loss_x 0.4993 (0.6081) acc_x 90.6250 (85.6250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/23] time 0.176 (0.177) data 0.097 (0.100) loss_x loss_x 0.6396 (0.5854) acc_x 84.3750 (84.3750) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [15/23] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.5728 (0.6229) acc_x 81.2500 (83.9583) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/23] time 0.207 (0.176) data 0.130 (0.099) loss_x loss_x 0.6875 (0.6786) acc_x 78.1250 (82.3438) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/27] time 0.191 (0.177) data 0.115 (0.100) loss_u loss_u 0.8311 (0.8950) acc_u 18.7500 (11.8750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [10/27] time 0.190 (0.178) data 0.113 (0.101) loss_u loss_u 0.9189 (0.8929) acc_u 6.2500 (12.8125) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/27] time 0.197 (0.180) data 0.120 (0.102) loss_u loss_u 0.7515 (0.8782) acc_u 25.0000 (14.5833) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/27] time 0.179 (0.180) data 0.100 (0.103) loss_u loss_u 0.8540 (0.8743) acc_u 18.7500 (15.3125) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [25/27] time 0.174 (0.180) data 0.096 (0.103) loss_u loss_u 0.8477 (0.8739) acc_u 18.7500 (15.6250) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.4486, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 725
clean true:722
clean false:3
clean_rate:0.9958620689655172
noisy true:376
noisy false:515
after delete: len(clean_dataset) 725
after delete: len(noisy_dataset) 891
epoch [74/200] batch [5/22] time 0.161 (0.174) data 0.085 (0.097) loss_x loss_x 0.6587 (0.6010) acc_x 71.8750 (80.0000) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/22] time 0.163 (0.169) data 0.086 (0.092) loss_x loss_x 0.6992 (0.6235) acc_x 81.2500 (81.8750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/22] time 0.162 (0.170) data 0.086 (0.093) loss_x loss_x 0.3765 (0.6094) acc_x 93.7500 (83.3333) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [20/22] time 0.220 (0.179) data 0.143 (0.102) loss_x loss_x 1.1221 (0.6671) acc_x 68.7500 (81.8750) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/27] time 0.168 (0.186) data 0.091 (0.108) loss_u loss_u 0.7915 (0.8688) acc_u 28.1250 (17.5000) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/27] time 0.172 (0.184) data 0.095 (0.107) loss_u loss_u 0.8154 (0.8284) acc_u 18.7500 (20.3125) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/27] time 0.171 (0.184) data 0.092 (0.106) loss_u loss_u 0.8789 (0.8453) acc_u 15.6250 (18.5417) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/27] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9609 (0.8600) acc_u 3.1250 (16.7188) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [25/27] time 0.163 (0.181) data 0.085 (0.104) loss_u loss_u 0.8916 (0.8563) acc_u 12.5000 (16.7500) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.4771, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 771
clean true:765
clean false:6
clean_rate:0.9922178988326849
noisy true:380
noisy false:465
after delete: len(clean_dataset) 771
after delete: len(noisy_dataset) 845
epoch [75/200] batch [5/24] time 0.170 (0.173) data 0.093 (0.096) loss_x loss_x 0.7744 (0.7415) acc_x 81.2500 (80.6250) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/24] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.5386 (0.6947) acc_x 81.2500 (81.5625) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/24] time 0.173 (0.179) data 0.096 (0.103) loss_x loss_x 1.0586 (0.6909) acc_x 78.1250 (82.7083) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/24] time 0.188 (0.181) data 0.111 (0.105) loss_x loss_x 0.4507 (0.6817) acc_x 81.2500 (82.1875) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/26] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.8384 (0.8647) acc_u 15.6250 (15.0000) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [10/26] time 0.195 (0.182) data 0.118 (0.105) loss_u loss_u 0.8799 (0.8712) acc_u 15.6250 (14.3750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [15/26] time 0.183 (0.181) data 0.104 (0.103) loss_u loss_u 0.9141 (0.8754) acc_u 15.6250 (14.1667) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/26] time 0.177 (0.180) data 0.100 (0.103) loss_u loss_u 0.9233 (0.8819) acc_u 6.2500 (13.2812) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [25/26] time 0.182 (0.180) data 0.104 (0.103) loss_u loss_u 0.8403 (0.8798) acc_u 18.7500 (13.5000) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4629, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 748
clean true:740
clean false:8
clean_rate:0.9893048128342246
noisy true:370
noisy false:498
after delete: len(clean_dataset) 748
after delete: len(noisy_dataset) 868
epoch [76/200] batch [5/23] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 1.1768 (1.0465) acc_x 65.6250 (70.6250) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/23] time 0.162 (0.180) data 0.084 (0.103) loss_x loss_x 0.5601 (0.7758) acc_x 87.5000 (78.7500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [15/23] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.7134 (0.7232) acc_x 78.1250 (80.4167) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/23] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.7578 (0.7127) acc_x 81.2500 (80.9375) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/27] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.8672 (0.8564) acc_u 15.6250 (17.5000) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [10/27] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.8438 (0.8412) acc_u 18.7500 (19.0625) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/27] time 0.171 (0.176) data 0.093 (0.099) loss_u loss_u 0.8730 (0.8616) acc_u 12.5000 (15.8333) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/27] time 0.188 (0.177) data 0.111 (0.099) loss_u loss_u 0.8989 (0.8663) acc_u 12.5000 (15.3125) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [25/27] time 0.185 (0.178) data 0.108 (0.100) loss_u loss_u 0.8525 (0.8648) acc_u 18.7500 (15.2500) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 721
clean true:715
clean false:6
clean_rate:0.9916782246879334
noisy true:397
noisy false:498
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 895
epoch [77/200] batch [5/22] time 0.196 (0.194) data 0.120 (0.118) loss_x loss_x 0.5269 (0.6810) acc_x 90.6250 (83.7500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [10/22] time 0.176 (0.189) data 0.099 (0.113) loss_x loss_x 0.7471 (0.7590) acc_x 84.3750 (81.2500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [15/22] time 0.172 (0.186) data 0.094 (0.109) loss_x loss_x 0.9375 (0.7442) acc_x 81.2500 (82.2917) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [20/22] time 0.192 (0.184) data 0.115 (0.107) loss_x loss_x 0.4126 (0.7502) acc_x 90.6250 (82.0312) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/27] time 0.189 (0.188) data 0.113 (0.111) loss_u loss_u 0.9282 (0.8739) acc_u 6.2500 (15.6250) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [10/27] time 0.186 (0.187) data 0.109 (0.110) loss_u loss_u 0.9111 (0.8729) acc_u 9.3750 (15.0000) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/27] time 0.190 (0.187) data 0.113 (0.110) loss_u loss_u 0.7192 (0.8589) acc_u 31.2500 (16.4583) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/27] time 0.185 (0.187) data 0.107 (0.110) loss_u loss_u 0.7822 (0.8464) acc_u 28.1250 (17.9688) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [25/27] time 0.185 (0.187) data 0.107 (0.110) loss_u loss_u 0.8149 (0.8518) acc_u 25.0000 (17.6250) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 463
confident_label rate tensor(0.4746, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 767
clean true:757
clean false:10
clean_rate:0.9869621903520208
noisy true:396
noisy false:453
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 849
epoch [78/200] batch [5/23] time 0.162 (0.161) data 0.086 (0.085) loss_x loss_x 0.8164 (0.7687) acc_x 84.3750 (79.3750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/23] time 0.175 (0.170) data 0.097 (0.093) loss_x loss_x 0.4956 (0.7241) acc_x 90.6250 (81.2500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/23] time 0.172 (0.170) data 0.096 (0.093) loss_x loss_x 0.8716 (0.7768) acc_x 78.1250 (80.0000) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/23] time 0.174 (0.173) data 0.098 (0.096) loss_x loss_x 0.4485 (0.7281) acc_x 87.5000 (80.4688) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/26] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.9658 (0.8874) acc_u 3.1250 (12.5000) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [10/26] time 0.176 (0.175) data 0.098 (0.098) loss_u loss_u 0.9126 (0.8750) acc_u 12.5000 (14.6875) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/26] time 0.187 (0.175) data 0.109 (0.098) loss_u loss_u 0.8789 (0.8708) acc_u 12.5000 (15.2083) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/26] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.9341 (0.8753) acc_u 9.3750 (14.6875) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [25/26] time 0.185 (0.177) data 0.109 (0.099) loss_u loss_u 0.8076 (0.8759) acc_u 18.7500 (14.5000) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.4592, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 742
clean true:735
clean false:7
clean_rate:0.9905660377358491
noisy true:385
noisy false:489
after delete: len(clean_dataset) 742
after delete: len(noisy_dataset) 874
epoch [79/200] batch [5/23] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.5518 (0.4854) acc_x 78.1250 (85.6250) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/23] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.8169 (0.6108) acc_x 81.2500 (84.6875) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/23] time 0.181 (0.173) data 0.104 (0.096) loss_x loss_x 1.1211 (0.6585) acc_x 78.1250 (83.5417) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/23] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.6401 (0.6398) acc_x 87.5000 (83.5938) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/27] time 0.168 (0.172) data 0.091 (0.095) loss_u loss_u 0.9194 (0.9121) acc_u 9.3750 (11.2500) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [10/27] time 0.197 (0.174) data 0.120 (0.097) loss_u loss_u 0.9131 (0.8853) acc_u 9.3750 (14.0625) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/27] time 0.172 (0.174) data 0.095 (0.097) loss_u loss_u 0.7490 (0.8861) acc_u 28.1250 (13.7500) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/27] time 0.176 (0.174) data 0.098 (0.096) loss_u loss_u 0.8867 (0.8739) acc_u 15.6250 (15.1562) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [25/27] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.7739 (0.8713) acc_u 28.1250 (15.1250) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4660, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 753
clean true:744
clean false:9
clean_rate:0.9880478087649402
noisy true:378
noisy false:485
after delete: len(clean_dataset) 753
after delete: len(noisy_dataset) 863
epoch [80/200] batch [5/23] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.8027 (0.6068) acc_x 81.2500 (85.6250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/23] time 0.179 (0.187) data 0.103 (0.110) loss_x loss_x 0.2917 (0.6762) acc_x 90.6250 (82.5000) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/23] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.5366 (0.6592) acc_x 81.2500 (82.9167) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/23] time 0.161 (0.182) data 0.084 (0.105) loss_x loss_x 1.1357 (0.6987) acc_x 78.1250 (82.0312) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/26] time 0.188 (0.180) data 0.110 (0.103) loss_u loss_u 0.8745 (0.8697) acc_u 12.5000 (15.6250) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [10/26] time 0.178 (0.179) data 0.100 (0.102) loss_u loss_u 0.8589 (0.8648) acc_u 12.5000 (15.3125) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/26] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.9150 (0.8609) acc_u 12.5000 (16.0417) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/26] time 0.170 (0.180) data 0.092 (0.102) loss_u loss_u 0.8315 (0.8566) acc_u 18.7500 (16.5625) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/26] time 0.188 (0.180) data 0.111 (0.103) loss_u loss_u 0.8633 (0.8601) acc_u 12.5000 (16.0000) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.4598, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 743
clean true:733
clean false:10
clean_rate:0.9865410497981157
noisy true:383
noisy false:490
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 873
epoch [81/200] batch [5/23] time 0.188 (0.180) data 0.109 (0.102) loss_x loss_x 0.8350 (0.7456) acc_x 78.1250 (81.2500) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [10/23] time 0.189 (0.183) data 0.111 (0.106) loss_x loss_x 0.6880 (0.7208) acc_x 81.2500 (82.8125) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/23] time 0.179 (0.180) data 0.102 (0.102) loss_x loss_x 0.5952 (0.7652) acc_x 81.2500 (80.4167) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/23] time 0.189 (0.180) data 0.112 (0.103) loss_x loss_x 0.7012 (0.7437) acc_x 84.3750 (81.4062) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/27] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9722 (0.8686) acc_u 3.1250 (15.0000) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/27] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9385 (0.8797) acc_u 6.2500 (13.4375) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/27] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.8154 (0.8726) acc_u 21.8750 (13.9583) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/27] time 0.193 (0.184) data 0.116 (0.106) loss_u loss_u 0.8657 (0.8679) acc_u 18.7500 (15.0000) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [25/27] time 0.183 (0.184) data 0.106 (0.106) loss_u loss_u 0.8325 (0.8667) acc_u 18.7500 (15.2500) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 477
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 760
clean true:754
clean false:6
clean_rate:0.9921052631578947
noisy true:385
noisy false:471
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 856
epoch [82/200] batch [5/23] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 1.1064 (0.7757) acc_x 78.1250 (80.6250) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/23] time 0.171 (0.172) data 0.094 (0.095) loss_x loss_x 0.6650 (0.6639) acc_x 81.2500 (83.1250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/23] time 0.167 (0.173) data 0.091 (0.095) loss_x loss_x 0.7256 (0.7018) acc_x 87.5000 (82.5000) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/23] time 0.187 (0.176) data 0.111 (0.098) loss_x loss_x 0.4736 (0.6900) acc_x 93.7500 (82.0312) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/26] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.9214 (0.8971) acc_u 6.2500 (11.8750) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [10/26] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.7671 (0.8711) acc_u 21.8750 (14.3750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/26] time 0.187 (0.176) data 0.111 (0.098) loss_u loss_u 0.8628 (0.8729) acc_u 18.7500 (14.7917) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/26] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.9419 (0.8778) acc_u 9.3750 (14.2188) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [25/26] time 0.187 (0.177) data 0.110 (0.099) loss_u loss_u 0.8818 (0.8815) acc_u 15.6250 (13.8750) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 478
confident_label rate tensor(0.4752, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 768
clean true:758
clean false:10
clean_rate:0.9869791666666666
noisy true:380
noisy false:468
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 848
epoch [83/200] batch [5/24] time 0.182 (0.179) data 0.104 (0.102) loss_x loss_x 0.6748 (0.7884) acc_x 84.3750 (81.2500) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/24] time 0.172 (0.176) data 0.096 (0.098) loss_x loss_x 0.7778 (0.7716) acc_x 84.3750 (81.2500) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/24] time 0.178 (0.175) data 0.102 (0.097) loss_x loss_x 0.4500 (0.7195) acc_x 96.8750 (82.7083) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/24] time 0.174 (0.176) data 0.098 (0.099) loss_x loss_x 0.4172 (0.7002) acc_x 84.3750 (82.5000) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/26] time 0.187 (0.176) data 0.109 (0.099) loss_u loss_u 0.8931 (0.8682) acc_u 12.5000 (15.6250) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [10/26] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.8574 (0.8701) acc_u 15.6250 (14.6875) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [15/26] time 0.173 (0.175) data 0.096 (0.098) loss_u loss_u 0.7812 (0.8620) acc_u 21.8750 (15.2083) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/26] time 0.174 (0.175) data 0.096 (0.097) loss_u loss_u 0.8145 (0.8723) acc_u 25.0000 (14.5312) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/26] time 0.165 (0.174) data 0.087 (0.096) loss_u loss_u 0.9043 (0.8743) acc_u 9.3750 (14.5000) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 513
confident_label rate tensor(0.4610, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 745
clean true:735
clean false:10
clean_rate:0.9865771812080537
noisy true:368
noisy false:503
after delete: len(clean_dataset) 745
after delete: len(noisy_dataset) 871
epoch [84/200] batch [5/23] time 0.172 (0.182) data 0.096 (0.105) loss_x loss_x 0.5630 (0.7648) acc_x 81.2500 (81.2500) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [10/23] time 0.188 (0.184) data 0.110 (0.107) loss_x loss_x 0.8813 (0.7369) acc_x 71.8750 (81.5625) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/23] time 0.189 (0.185) data 0.112 (0.108) loss_x loss_x 0.5889 (0.7065) acc_x 90.6250 (83.3333) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/23] time 0.189 (0.185) data 0.111 (0.108) loss_x loss_x 0.5078 (0.7251) acc_x 87.5000 (82.0312) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/27] time 0.197 (0.186) data 0.120 (0.109) loss_u loss_u 0.8506 (0.8475) acc_u 15.6250 (18.1250) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/27] time 0.161 (0.185) data 0.084 (0.108) loss_u loss_u 0.8071 (0.8663) acc_u 25.0000 (17.1875) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/27] time 0.160 (0.182) data 0.083 (0.105) loss_u loss_u 0.9360 (0.8869) acc_u 9.3750 (14.5833) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/27] time 0.171 (0.181) data 0.092 (0.104) loss_u loss_u 0.7505 (0.8735) acc_u 34.3750 (15.9375) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [25/27] time 0.173 (0.180) data 0.096 (0.103) loss_u loss_u 0.7451 (0.8582) acc_u 28.1250 (17.3750) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4684, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 757
clean true:752
clean false:5
clean_rate:0.9933949801849405
noisy true:378
noisy false:481
after delete: len(clean_dataset) 757
after delete: len(noisy_dataset) 859
epoch [85/200] batch [5/23] time 0.169 (0.175) data 0.092 (0.098) loss_x loss_x 0.6519 (0.7339) acc_x 81.2500 (79.3750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/23] time 0.177 (0.177) data 0.101 (0.100) loss_x loss_x 0.6108 (0.6896) acc_x 84.3750 (81.2500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/23] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.4148 (0.6750) acc_x 87.5000 (82.0833) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/23] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.6104 (0.6787) acc_x 81.2500 (81.7188) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/26] time 0.185 (0.177) data 0.109 (0.100) loss_u loss_u 0.8936 (0.8763) acc_u 12.5000 (14.3750) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [10/26] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.8809 (0.8767) acc_u 15.6250 (14.6875) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/26] time 0.188 (0.180) data 0.111 (0.103) loss_u loss_u 0.9507 (0.8822) acc_u 9.3750 (14.1667) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/26] time 0.186 (0.181) data 0.109 (0.103) loss_u loss_u 0.8301 (0.8770) acc_u 21.8750 (14.6875) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [25/26] time 0.169 (0.180) data 0.092 (0.103) loss_u loss_u 0.8379 (0.8697) acc_u 21.8750 (16.0000) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4573, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 739
clean true:734
clean false:5
clean_rate:0.993234100135318
noisy true:388
noisy false:489
after delete: len(clean_dataset) 739
after delete: len(noisy_dataset) 877
epoch [86/200] batch [5/23] time 0.208 (0.202) data 0.131 (0.124) loss_x loss_x 0.4397 (0.7295) acc_x 87.5000 (84.3750) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [10/23] time 0.187 (0.196) data 0.110 (0.119) loss_x loss_x 0.5605 (0.6571) acc_x 84.3750 (84.3750) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/23] time 0.174 (0.193) data 0.097 (0.116) loss_x loss_x 0.6113 (0.6204) acc_x 87.5000 (85.6250) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/23] time 0.187 (0.191) data 0.110 (0.114) loss_x loss_x 0.5688 (0.6243) acc_x 75.0000 (83.9062) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/27] time 0.170 (0.192) data 0.092 (0.115) loss_u loss_u 0.8389 (0.8411) acc_u 18.7500 (20.6250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [10/27] time 0.186 (0.193) data 0.110 (0.115) loss_u loss_u 0.9336 (0.8546) acc_u 6.2500 (17.5000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [15/27] time 0.190 (0.193) data 0.113 (0.116) loss_u loss_u 0.8442 (0.8661) acc_u 21.8750 (16.2500) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/27] time 0.185 (0.193) data 0.108 (0.115) loss_u loss_u 0.8677 (0.8686) acc_u 18.7500 (16.2500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [25/27] time 0.188 (0.192) data 0.107 (0.115) loss_u loss_u 0.8604 (0.8607) acc_u 18.7500 (17.1250) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 499
confident_label rate tensor(0.4542, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 734
clean true:728
clean false:6
clean_rate:0.9918256130790191
noisy true:389
noisy false:493
after delete: len(clean_dataset) 734
after delete: len(noisy_dataset) 882
epoch [87/200] batch [5/22] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.4836 (0.6328) acc_x 90.6250 (86.2500) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/22] time 0.190 (0.180) data 0.112 (0.103) loss_x loss_x 0.9863 (0.7229) acc_x 81.2500 (83.1250) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/22] time 0.171 (0.178) data 0.093 (0.101) loss_x loss_x 0.8115 (0.7034) acc_x 75.0000 (83.1250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/22] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.2153 (0.6821) acc_x 96.8750 (83.7500) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/27] time 0.188 (0.179) data 0.111 (0.102) loss_u loss_u 0.8198 (0.8464) acc_u 28.1250 (20.0000) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [10/27] time 0.190 (0.182) data 0.112 (0.105) loss_u loss_u 0.8213 (0.8530) acc_u 25.0000 (18.1250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [15/27] time 0.173 (0.182) data 0.096 (0.105) loss_u loss_u 0.8140 (0.8503) acc_u 18.7500 (17.7083) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/27] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9478 (0.8576) acc_u 3.1250 (16.5625) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [25/27] time 0.166 (0.182) data 0.087 (0.105) loss_u loss_u 0.7051 (0.8526) acc_u 34.3750 (17.0000) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.4561, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 737
clean true:732
clean false:5
clean_rate:0.9932157394843962
noisy true:370
noisy false:509
after delete: len(clean_dataset) 737
after delete: len(noisy_dataset) 879
epoch [88/200] batch [5/23] time 0.176 (0.173) data 0.099 (0.095) loss_x loss_x 0.6499 (0.6259) acc_x 81.2500 (83.7500) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [10/23] time 0.206 (0.178) data 0.127 (0.101) loss_x loss_x 0.3586 (0.6180) acc_x 87.5000 (84.6875) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/23] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.3396 (0.5504) acc_x 90.6250 (85.6250) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/23] time 0.194 (0.183) data 0.117 (0.106) loss_x loss_x 0.7998 (0.5789) acc_x 84.3750 (84.6875) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/27] time 0.174 (0.182) data 0.097 (0.105) loss_u loss_u 0.8081 (0.8395) acc_u 21.8750 (20.0000) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/27] time 0.174 (0.182) data 0.096 (0.105) loss_u loss_u 0.9121 (0.8622) acc_u 9.3750 (16.5625) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [15/27] time 0.200 (0.182) data 0.123 (0.105) loss_u loss_u 0.8569 (0.8661) acc_u 18.7500 (15.8333) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/27] time 0.183 (0.182) data 0.106 (0.104) loss_u loss_u 0.8696 (0.8606) acc_u 12.5000 (16.2500) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [25/27] time 0.163 (0.180) data 0.084 (0.103) loss_u loss_u 0.7485 (0.8598) acc_u 31.2500 (16.2500) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.4616, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 746
clean true:739
clean false:7
clean_rate:0.9906166219839142
noisy true:365
noisy false:505
after delete: len(clean_dataset) 746
after delete: len(noisy_dataset) 870
epoch [89/200] batch [5/23] time 0.174 (0.170) data 0.097 (0.093) loss_x loss_x 0.5234 (0.7158) acc_x 93.7500 (82.5000) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/23] time 0.174 (0.175) data 0.098 (0.098) loss_x loss_x 0.5117 (0.6746) acc_x 90.6250 (83.7500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/23] time 0.170 (0.174) data 0.093 (0.097) loss_x loss_x 0.7524 (0.6657) acc_x 84.3750 (83.9583) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/23] time 0.187 (0.174) data 0.109 (0.097) loss_x loss_x 0.7798 (0.6600) acc_x 78.1250 (84.0625) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/27] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.9077 (0.8475) acc_u 12.5000 (18.1250) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [10/27] time 0.160 (0.175) data 0.083 (0.098) loss_u loss_u 0.8335 (0.8629) acc_u 18.7500 (15.6250) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/27] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.8506 (0.8531) acc_u 18.7500 (16.4583) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/27] time 0.170 (0.174) data 0.093 (0.097) loss_u loss_u 0.9272 (0.8651) acc_u 9.3750 (15.1562) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [25/27] time 0.174 (0.175) data 0.096 (0.098) loss_u loss_u 0.8647 (0.8584) acc_u 15.6250 (16.0000) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 428
confident_label rate tensor(0.4833, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 781
clean true:776
clean false:5
clean_rate:0.9935979513444302
noisy true:412
noisy false:423
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 835
epoch [90/200] batch [5/24] time 0.179 (0.176) data 0.102 (0.098) loss_x loss_x 0.9038 (0.6935) acc_x 75.0000 (83.1250) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/24] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.9878 (0.7855) acc_x 78.1250 (81.2500) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/24] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 1.1006 (0.8610) acc_x 68.7500 (78.3333) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/24] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.5850 (0.7836) acc_x 84.3750 (80.7812) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/26] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.7739 (0.8680) acc_u 28.1250 (15.0000) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [10/26] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.8945 (0.8762) acc_u 15.6250 (14.3750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/26] time 0.173 (0.178) data 0.095 (0.100) loss_u loss_u 0.8799 (0.8844) acc_u 15.6250 (13.3333) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/26] time 0.166 (0.177) data 0.088 (0.100) loss_u loss_u 0.9102 (0.8825) acc_u 15.6250 (13.5938) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [25/26] time 0.172 (0.177) data 0.095 (0.099) loss_u loss_u 0.9121 (0.8808) acc_u 12.5000 (14.1250) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 515
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 716
clean true:710
clean false:6
clean_rate:0.9916201117318436
noisy true:391
noisy false:509
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 900
epoch [91/200] batch [5/22] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.5830 (0.5830) acc_x 81.2500 (83.7500) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [10/22] time 0.185 (0.187) data 0.109 (0.110) loss_x loss_x 0.4353 (0.4867) acc_x 87.5000 (87.5000) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/22] time 0.190 (0.187) data 0.113 (0.110) loss_x loss_x 0.5913 (0.6038) acc_x 87.5000 (85.2083) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/22] time 0.194 (0.187) data 0.118 (0.110) loss_x loss_x 0.2698 (0.5808) acc_x 93.7500 (85.1562) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/28] time 0.171 (0.187) data 0.093 (0.110) loss_u loss_u 0.8335 (0.8011) acc_u 18.7500 (22.5000) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [10/28] time 0.177 (0.186) data 0.100 (0.109) loss_u loss_u 0.8413 (0.8405) acc_u 21.8750 (17.8125) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/28] time 0.170 (0.184) data 0.092 (0.107) loss_u loss_u 0.6836 (0.8169) acc_u 34.3750 (21.2500) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/28] time 0.162 (0.182) data 0.084 (0.105) loss_u loss_u 0.8779 (0.8229) acc_u 15.6250 (20.1562) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [25/28] time 0.165 (0.181) data 0.086 (0.103) loss_u loss_u 0.8828 (0.8333) acc_u 15.6250 (19.2500) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 773
clean true:765
clean false:8
clean_rate:0.9896507115135834
noisy true:371
noisy false:472
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 843
epoch [92/200] batch [5/24] time 0.183 (0.188) data 0.106 (0.112) loss_x loss_x 0.6592 (0.5838) acc_x 84.3750 (85.6250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/24] time 0.171 (0.182) data 0.093 (0.106) loss_x loss_x 0.8096 (0.6618) acc_x 78.1250 (83.1250) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/24] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.5396 (0.6781) acc_x 81.2500 (82.2917) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/24] time 0.187 (0.180) data 0.109 (0.103) loss_x loss_x 0.6982 (0.6652) acc_x 87.5000 (82.9688) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/26] time 0.173 (0.182) data 0.095 (0.105) loss_u loss_u 0.9224 (0.8882) acc_u 9.3750 (13.1250) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [10/26] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.9438 (0.8877) acc_u 6.2500 (13.7500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/26] time 0.190 (0.182) data 0.112 (0.105) loss_u loss_u 0.8955 (0.8858) acc_u 15.6250 (13.7500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/26] time 0.190 (0.183) data 0.113 (0.106) loss_u loss_u 0.8535 (0.8782) acc_u 18.7500 (15.1562) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [25/26] time 0.188 (0.184) data 0.109 (0.107) loss_u loss_u 0.8579 (0.8831) acc_u 15.6250 (14.3750) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.4746, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 767
clean true:761
clean false:6
clean_rate:0.9921773142112125
noisy true:391
noisy false:458
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 849
epoch [93/200] batch [5/23] time 0.168 (0.174) data 0.090 (0.096) loss_x loss_x 0.7231 (0.7480) acc_x 84.3750 (81.2500) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/23] time 0.196 (0.178) data 0.119 (0.100) loss_x loss_x 0.6025 (0.6739) acc_x 87.5000 (81.5625) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/23] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.6060 (0.6968) acc_x 75.0000 (82.2917) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/23] time 0.170 (0.173) data 0.094 (0.095) loss_x loss_x 0.3660 (0.6700) acc_x 87.5000 (82.8125) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/26] time 0.189 (0.176) data 0.110 (0.098) loss_u loss_u 0.9219 (0.8658) acc_u 9.3750 (16.2500) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [10/26] time 0.195 (0.176) data 0.117 (0.099) loss_u loss_u 0.9375 (0.8841) acc_u 6.2500 (13.4375) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/26] time 0.163 (0.176) data 0.085 (0.098) loss_u loss_u 0.9028 (0.8744) acc_u 9.3750 (14.3750) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/26] time 0.158 (0.174) data 0.081 (0.097) loss_u loss_u 0.8398 (0.8711) acc_u 21.8750 (14.8438) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [25/26] time 0.161 (0.173) data 0.082 (0.095) loss_u loss_u 0.7495 (0.8652) acc_u 28.1250 (15.6250) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 508
confident_label rate tensor(0.4635, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 749
clean true:740
clean false:9
clean_rate:0.9879839786381842
noisy true:368
noisy false:499
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 867
epoch [94/200] batch [5/23] time 0.183 (0.181) data 0.107 (0.104) loss_x loss_x 0.8457 (0.6810) acc_x 78.1250 (83.1250) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/23] time 0.172 (0.177) data 0.093 (0.100) loss_x loss_x 0.3945 (0.6333) acc_x 96.8750 (85.3125) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [15/23] time 0.188 (0.179) data 0.111 (0.101) loss_x loss_x 0.6577 (0.6660) acc_x 78.1250 (84.5833) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/23] time 0.176 (0.178) data 0.100 (0.101) loss_x loss_x 0.4944 (0.6144) acc_x 84.3750 (85.6250) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/27] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.9604 (0.9065) acc_u 6.2500 (11.8750) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [10/27] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.8970 (0.8863) acc_u 12.5000 (13.4375) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [15/27] time 0.178 (0.178) data 0.098 (0.101) loss_u loss_u 0.7866 (0.8670) acc_u 25.0000 (16.0417) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/27] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.7822 (0.8588) acc_u 28.1250 (16.8750) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [25/27] time 0.174 (0.178) data 0.096 (0.100) loss_u loss_u 0.9575 (0.8657) acc_u 3.1250 (16.0000) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.4672, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 755
clean true:748
clean false:7
clean_rate:0.990728476821192
noisy true:409
noisy false:452
after delete: len(clean_dataset) 755
after delete: len(noisy_dataset) 861
epoch [95/200] batch [5/23] time 0.160 (0.163) data 0.084 (0.086) loss_x loss_x 0.4324 (0.5214) acc_x 90.6250 (84.3750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/23] time 0.162 (0.162) data 0.085 (0.086) loss_x loss_x 0.8550 (0.5405) acc_x 78.1250 (85.6250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/23] time 0.175 (0.168) data 0.098 (0.091) loss_x loss_x 1.0254 (0.6049) acc_x 68.7500 (83.7500) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/23] time 0.176 (0.168) data 0.097 (0.091) loss_x loss_x 0.8398 (0.5837) acc_x 81.2500 (84.3750) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/26] time 0.192 (0.172) data 0.115 (0.095) loss_u loss_u 0.8013 (0.8341) acc_u 21.8750 (18.7500) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [10/26] time 0.182 (0.172) data 0.105 (0.095) loss_u loss_u 0.7803 (0.8512) acc_u 21.8750 (16.5625) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/26] time 0.174 (0.173) data 0.096 (0.096) loss_u loss_u 0.8647 (0.8628) acc_u 15.6250 (15.4167) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/26] time 0.170 (0.174) data 0.092 (0.096) loss_u loss_u 0.8027 (0.8666) acc_u 21.8750 (15.1562) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [25/26] time 0.157 (0.174) data 0.079 (0.096) loss_u loss_u 0.8574 (0.8628) acc_u 15.6250 (15.7500) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 446
confident_label rate tensor(0.4734, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 765
clean true:758
clean false:7
clean_rate:0.9908496732026144
noisy true:412
noisy false:439
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 851
epoch [96/200] batch [5/23] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.6040 (0.4777) acc_x 84.3750 (86.8750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/23] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.7358 (0.6797) acc_x 87.5000 (85.0000) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/23] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.8970 (0.6868) acc_x 81.2500 (84.1667) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/23] time 0.192 (0.186) data 0.115 (0.109) loss_x loss_x 0.6982 (0.6444) acc_x 84.3750 (84.6875) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/26] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.8730 (0.8752) acc_u 15.6250 (14.3750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [10/26] time 0.166 (0.184) data 0.090 (0.107) loss_u loss_u 0.8926 (0.8688) acc_u 9.3750 (15.0000) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/26] time 0.173 (0.182) data 0.096 (0.105) loss_u loss_u 0.8613 (0.8664) acc_u 15.6250 (15.0000) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/26] time 0.179 (0.181) data 0.102 (0.104) loss_u loss_u 0.8950 (0.8622) acc_u 12.5000 (15.4688) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [25/26] time 0.169 (0.181) data 0.092 (0.104) loss_u loss_u 0.9814 (0.8674) acc_u 0.0000 (15.0000) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 775
clean true:762
clean false:13
clean_rate:0.983225806451613
noisy true:374
noisy false:467
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 841
epoch [97/200] batch [5/24] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.7812 (0.7489) acc_x 78.1250 (80.0000) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/24] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.9019 (0.7005) acc_x 75.0000 (81.2500) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/24] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.5518 (0.6704) acc_x 81.2500 (80.8333) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/24] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.8564 (0.6834) acc_x 81.2500 (81.7188) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/26] time 0.176 (0.184) data 0.097 (0.108) loss_u loss_u 0.9058 (0.9126) acc_u 9.3750 (10.6250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/26] time 0.171 (0.184) data 0.093 (0.107) loss_u loss_u 0.9038 (0.9041) acc_u 9.3750 (10.9375) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/26] time 0.176 (0.183) data 0.099 (0.106) loss_u loss_u 0.8076 (0.8805) acc_u 18.7500 (14.1667) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/26] time 0.189 (0.183) data 0.112 (0.105) loss_u loss_u 0.9067 (0.8823) acc_u 9.3750 (13.5938) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [25/26] time 0.162 (0.182) data 0.084 (0.105) loss_u loss_u 0.8691 (0.8842) acc_u 15.6250 (13.7500) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 456
confident_label rate tensor(0.4839, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 782
clean true:774
clean false:8
clean_rate:0.989769820971867
noisy true:386
noisy false:448
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 834
epoch [98/200] batch [5/24] time 0.175 (0.182) data 0.098 (0.105) loss_x loss_x 0.8467 (0.9098) acc_x 81.2500 (76.8750) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/24] time 0.173 (0.176) data 0.095 (0.099) loss_x loss_x 0.8750 (0.8276) acc_x 75.0000 (78.7500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/24] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.4771 (0.7396) acc_x 81.2500 (80.8333) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/24] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 0.9727 (0.7269) acc_x 71.8750 (81.0938) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/26] time 0.170 (0.175) data 0.092 (0.098) loss_u loss_u 0.8213 (0.8550) acc_u 18.7500 (17.5000) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/26] time 0.194 (0.175) data 0.116 (0.098) loss_u loss_u 0.8618 (0.8613) acc_u 15.6250 (16.8750) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/26] time 0.162 (0.176) data 0.085 (0.099) loss_u loss_u 0.9541 (0.8711) acc_u 3.1250 (15.0000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/26] time 0.161 (0.174) data 0.084 (0.097) loss_u loss_u 0.8955 (0.8745) acc_u 9.3750 (14.6875) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [25/26] time 0.171 (0.174) data 0.092 (0.097) loss_u loss_u 0.9131 (0.8744) acc_u 9.3750 (14.8750) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:730
clean false:5
clean_rate:0.9931972789115646
noisy true:380
noisy false:501
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [99/200] batch [5/22] time 0.187 (0.178) data 0.109 (0.101) loss_x loss_x 0.6636 (0.4295) acc_x 81.2500 (88.1250) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/22] time 0.165 (0.176) data 0.089 (0.099) loss_x loss_x 0.6309 (0.5367) acc_x 84.3750 (84.6875) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/22] time 0.187 (0.176) data 0.110 (0.099) loss_x loss_x 0.5630 (0.5829) acc_x 90.6250 (85.2083) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/22] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.7300 (0.6040) acc_x 81.2500 (84.8438) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/27] time 0.179 (0.175) data 0.102 (0.098) loss_u loss_u 0.8530 (0.8394) acc_u 18.7500 (20.0000) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [10/27] time 0.186 (0.176) data 0.109 (0.099) loss_u loss_u 0.9155 (0.8541) acc_u 9.3750 (18.4375) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/27] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.8130 (0.8538) acc_u 18.7500 (18.3333) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/27] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.8784 (0.8523) acc_u 12.5000 (18.1250) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [25/27] time 0.177 (0.175) data 0.099 (0.098) loss_u loss_u 0.8789 (0.8467) acc_u 12.5000 (18.5000) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 452
confident_label rate tensor(0.4845, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 783
clean true:775
clean false:8
clean_rate:0.9897828863346104
noisy true:389
noisy false:444
all clean rate:  [0.9750778816199377, 0.9848484848484849, 0.9923954372623575, 0.9943714821763602, 0.9924242424242424, 0.990791896869245, 0.9945553539019963, 0.9946043165467626, 0.9914089347079038, 0.9830220713073005, 0.9934426229508196, 0.9967373572593801, 0.9887640449438202, 0.998330550918197, 0.9952076677316294, 0.9919484702093397, 0.9952229299363057, 0.9952153110047847, 0.993920972644377, 0.9902755267423015, 0.9954337899543378, 0.9937402190923318, 0.9984, 0.9938080495356038, 0.9939117199391172, 0.9953198127925117, 0.9923780487804879, 0.9940387481371088, 0.9969742813918305, 0.9956521739130435, 0.9925373134328358, 0.9924585218702866, 0.9939849624060151, 0.9940476190476191, 0.9926793557833089, 0.9899713467048711, 0.9881129271916791, 0.9956772334293948, 0.9957567185289957, 0.9897209985315712, 0.9941944847605225, 0.994277539341917, 0.9914040114613181, 0.9902506963788301, 0.9889042995839112, 0.9943100995732574, 0.9897360703812317, 0.9929775280898876, 0.9971870604781997, 0.9916201117318436, 0.9957142857142857, 0.9941520467836257, 0.9902370990237099, 0.9956584659913169, 0.9929676511954993, 0.9918588873812755, 0.9944055944055944, 0.990084985835694, 0.9958391123439667, 0.9888579387186629, 0.9902777777777778, 0.9944289693593314, 0.9915611814345991, 0.9878048780487805, 0.9919354838709677, 0.9931412894375857, 0.9944827586206897, 0.99055330634278, 0.9933155080213903, 0.9958217270194986, 0.9933333333333333, 0.9894875164257556, 0.9932157394843962, 0.9958620689655172, 0.9922178988326849, 0.9893048128342246, 0.9916782246879334, 0.9869621903520208, 0.9905660377358491, 0.9880478087649402, 0.9865410497981157, 0.9921052631578947, 0.9869791666666666, 0.9865771812080537, 0.9933949801849405, 0.993234100135318, 0.9918256130790191, 0.9932157394843962, 0.9906166219839142, 0.9935979513444302, 0.9916201117318436, 0.9896507115135834, 0.9921773142112125, 0.9879839786381842, 0.990728476821192, 0.9908496732026144, 0.983225806451613, 0.989769820971867, 0.9931972789115646, 0.9897828863346104]
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 833
epoch [100/200] batch [5/24] time 0.169 (0.180) data 0.092 (0.103) loss_x loss_x 0.7432 (0.6550) acc_x 81.2500 (82.5000) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/24] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.9736 (0.7282) acc_x 78.1250 (81.2500) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/24] time 0.173 (0.176) data 0.097 (0.099) loss_x loss_x 0.5542 (0.7614) acc_x 81.2500 (80.4167) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/24] time 0.187 (0.178) data 0.110 (0.101) loss_x loss_x 0.5098 (0.7675) acc_x 84.3750 (79.6875) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/26] time 0.192 (0.181) data 0.115 (0.104) loss_u loss_u 0.8560 (0.8820) acc_u 15.6250 (13.1250) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [10/26] time 0.188 (0.182) data 0.111 (0.105) loss_u loss_u 0.8809 (0.8845) acc_u 12.5000 (13.1250) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/26] time 0.194 (0.183) data 0.117 (0.106) loss_u loss_u 0.9448 (0.8900) acc_u 3.1250 (12.0833) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/26] time 0.160 (0.182) data 0.082 (0.105) loss_u loss_u 0.8252 (0.8802) acc_u 21.8750 (14.0625) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [25/26] time 0.175 (0.181) data 0.097 (0.104) loss_u loss_u 0.8345 (0.8807) acc_u 18.7500 (14.1250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4635, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 749
clean true:744
clean false:5
clean_rate:0.9933244325767691
noisy true:378
noisy false:489
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 867
epoch [101/200] batch [5/23] time 0.186 (0.172) data 0.109 (0.096) loss_x loss_x 0.6772 (0.6425) acc_x 81.2500 (81.2500) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/23] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.6431 (0.6789) acc_x 87.5000 (81.5625) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/23] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.1737 (0.5870) acc_x 100.0000 (83.9583) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/23] time 0.179 (0.178) data 0.101 (0.101) loss_x loss_x 0.6499 (0.5840) acc_x 81.2500 (83.5938) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/27] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.8711 (0.8653) acc_u 15.6250 (15.6250) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/27] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.8335 (0.8548) acc_u 21.8750 (16.8750) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [15/27] time 0.175 (0.179) data 0.099 (0.102) loss_u loss_u 0.8735 (0.8649) acc_u 18.7500 (15.6250) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/27] time 0.169 (0.179) data 0.092 (0.101) loss_u loss_u 0.8555 (0.8655) acc_u 15.6250 (15.9375) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [25/27] time 0.172 (0.179) data 0.095 (0.101) loss_u loss_u 0.8892 (0.8663) acc_u 15.6250 (16.3750) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 477
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 756
clean true:749
clean false:7
clean_rate:0.9907407407407407
noisy true:390
noisy false:470
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 860
epoch [102/200] batch [5/23] time 0.185 (0.175) data 0.109 (0.098) loss_x loss_x 0.2321 (0.6977) acc_x 100.0000 (82.5000) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/23] time 0.187 (0.179) data 0.110 (0.103) loss_x loss_x 0.2397 (0.6026) acc_x 100.0000 (83.7500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/23] time 0.187 (0.182) data 0.111 (0.105) loss_x loss_x 0.5137 (0.6517) acc_x 87.5000 (83.3333) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/23] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.8979 (0.6701) acc_x 62.5000 (82.0312) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/26] time 0.174 (0.180) data 0.096 (0.103) loss_u loss_u 0.8115 (0.8144) acc_u 18.7500 (21.8750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/26] time 0.187 (0.180) data 0.109 (0.103) loss_u loss_u 0.8379 (0.8404) acc_u 21.8750 (18.7500) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/26] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.7891 (0.8569) acc_u 25.0000 (16.8750) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/26] time 0.178 (0.179) data 0.100 (0.102) loss_u loss_u 0.8545 (0.8636) acc_u 18.7500 (16.0938) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [25/26] time 0.183 (0.179) data 0.106 (0.101) loss_u loss_u 0.8184 (0.8604) acc_u 25.0000 (16.6250) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.4740, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 766
clean true:759
clean false:7
clean_rate:0.9908616187989556
noisy true:385
noisy false:465
after delete: len(clean_dataset) 766
after delete: len(noisy_dataset) 850
epoch [103/200] batch [5/23] time 0.162 (0.167) data 0.085 (0.090) loss_x loss_x 0.8213 (0.5809) acc_x 75.0000 (84.3750) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/23] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 0.6514 (0.5838) acc_x 78.1250 (84.0625) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/23] time 0.177 (0.173) data 0.101 (0.096) loss_x loss_x 1.1094 (0.5701) acc_x 75.0000 (85.0000) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/23] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.4185 (0.5875) acc_x 87.5000 (84.0625) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/26] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.8335 (0.8550) acc_u 18.7500 (16.8750) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [10/26] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8662 (0.8598) acc_u 18.7500 (17.1875) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/26] time 0.172 (0.180) data 0.094 (0.103) loss_u loss_u 0.8677 (0.8569) acc_u 15.6250 (17.7083) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/26] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.9302 (0.8595) acc_u 6.2500 (17.5000) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [25/26] time 0.159 (0.179) data 0.082 (0.101) loss_u loss_u 0.8403 (0.8615) acc_u 18.7500 (17.0000) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 457
confident_label rate tensor(0.4858, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 785
clean true:778
clean false:7
clean_rate:0.9910828025477707
noisy true:381
noisy false:450
after delete: len(clean_dataset) 785
after delete: len(noisy_dataset) 831
epoch [104/200] batch [5/24] time 0.160 (0.164) data 0.083 (0.087) loss_x loss_x 1.0137 (0.7667) acc_x 78.1250 (77.5000) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/24] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 0.5288 (0.8090) acc_x 90.6250 (78.4375) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/24] time 0.158 (0.163) data 0.082 (0.086) loss_x loss_x 0.3938 (0.7780) acc_x 93.7500 (80.4167) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/24] time 0.178 (0.165) data 0.102 (0.088) loss_x loss_x 0.8237 (0.7447) acc_x 78.1250 (80.9375) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/25] time 0.173 (0.171) data 0.096 (0.094) loss_u loss_u 0.8560 (0.8933) acc_u 18.7500 (12.5000) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/25] time 0.184 (0.172) data 0.106 (0.094) loss_u loss_u 0.9487 (0.9023) acc_u 9.3750 (10.9375) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/25] time 0.177 (0.172) data 0.100 (0.095) loss_u loss_u 0.8242 (0.8874) acc_u 25.0000 (13.1250) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/25] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.8779 (0.8866) acc_u 12.5000 (12.8125) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [25/25] time 0.170 (0.172) data 0.093 (0.095) loss_u loss_u 0.9131 (0.8839) acc_u 12.5000 (13.7500) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 469
confident_label rate tensor(0.4752, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 768
clean true:763
clean false:5
clean_rate:0.9934895833333334
noisy true:384
noisy false:464
after delete: len(clean_dataset) 768
after delete: len(noisy_dataset) 848
epoch [105/200] batch [5/24] time 0.165 (0.166) data 0.088 (0.089) loss_x loss_x 0.6392 (0.6805) acc_x 81.2500 (81.8750) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/24] time 0.174 (0.170) data 0.097 (0.093) loss_x loss_x 0.7378 (0.6813) acc_x 75.0000 (82.5000) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/24] time 0.180 (0.169) data 0.102 (0.092) loss_x loss_x 0.3994 (0.6483) acc_x 93.7500 (82.2917) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/24] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 0.6616 (0.6943) acc_x 81.2500 (81.2500) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/26] time 0.177 (0.173) data 0.099 (0.096) loss_u loss_u 0.8398 (0.8407) acc_u 21.8750 (20.0000) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [10/26] time 0.171 (0.173) data 0.094 (0.096) loss_u loss_u 0.8672 (0.8597) acc_u 18.7500 (17.8125) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/26] time 0.188 (0.174) data 0.111 (0.097) loss_u loss_u 0.8350 (0.8609) acc_u 21.8750 (17.2917) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/26] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.8857 (0.8666) acc_u 12.5000 (16.0938) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [25/26] time 0.198 (0.177) data 0.121 (0.100) loss_u loss_u 0.8848 (0.8671) acc_u 12.5000 (15.8750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 446
confident_label rate tensor(0.4851, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 784
clean true:780
clean false:4
clean_rate:0.9948979591836735
noisy true:390
noisy false:442
after delete: len(clean_dataset) 784
after delete: len(noisy_dataset) 832
epoch [106/200] batch [5/24] time 0.185 (0.170) data 0.108 (0.093) loss_x loss_x 0.5498 (0.5947) acc_x 90.6250 (86.2500) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/24] time 0.163 (0.168) data 0.085 (0.091) loss_x loss_x 0.7803 (0.6877) acc_x 75.0000 (83.4375) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/24] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 0.3789 (0.7071) acc_x 90.6250 (82.7083) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/24] time 0.163 (0.167) data 0.086 (0.090) loss_x loss_x 0.6279 (0.6808) acc_x 84.3750 (82.5000) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/26] time 0.182 (0.170) data 0.105 (0.093) loss_u loss_u 0.8613 (0.8785) acc_u 15.6250 (14.3750) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [10/26] time 0.188 (0.173) data 0.110 (0.095) loss_u loss_u 0.9629 (0.8877) acc_u 9.3750 (13.7500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/26] time 0.198 (0.175) data 0.121 (0.098) loss_u loss_u 0.9023 (0.8785) acc_u 15.6250 (14.5833) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/26] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.8867 (0.8823) acc_u 12.5000 (14.2188) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [25/26] time 0.218 (0.177) data 0.140 (0.099) loss_u loss_u 0.8970 (0.8816) acc_u 12.5000 (14.2500) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 469
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 775
clean true:767
clean false:8
clean_rate:0.9896774193548387
noisy true:380
noisy false:461
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 841
epoch [107/200] batch [5/24] time 0.182 (0.189) data 0.105 (0.112) loss_x loss_x 0.5669 (0.5747) acc_x 90.6250 (87.5000) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/24] time 0.183 (0.187) data 0.106 (0.111) loss_x loss_x 1.1572 (0.6902) acc_x 68.7500 (83.7500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/24] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.6714 (0.7339) acc_x 81.2500 (82.0833) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/24] time 0.164 (0.181) data 0.087 (0.104) loss_x loss_x 0.5605 (0.7073) acc_x 87.5000 (82.0312) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/26] time 0.161 (0.181) data 0.085 (0.104) loss_u loss_u 0.7510 (0.8719) acc_u 31.2500 (15.0000) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [10/26] time 0.194 (0.182) data 0.117 (0.105) loss_u loss_u 0.9775 (0.8707) acc_u 3.1250 (14.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/26] time 0.218 (0.183) data 0.141 (0.106) loss_u loss_u 0.8262 (0.8750) acc_u 21.8750 (13.7500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/26] time 0.192 (0.184) data 0.116 (0.106) loss_u loss_u 0.8965 (0.8753) acc_u 12.5000 (13.9062) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [25/26] time 0.190 (0.184) data 0.112 (0.107) loss_u loss_u 0.8159 (0.8737) acc_u 21.8750 (14.3750) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 448
confident_label rate tensor(0.4765, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 770
clean true:763
clean false:7
clean_rate:0.990909090909091
noisy true:405
noisy false:441
after delete: len(clean_dataset) 770
after delete: len(noisy_dataset) 846
epoch [108/200] batch [5/24] time 0.176 (0.173) data 0.100 (0.096) loss_x loss_x 0.6011 (0.5446) acc_x 84.3750 (87.5000) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/24] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.5903 (0.5396) acc_x 84.3750 (87.8125) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/24] time 0.176 (0.172) data 0.098 (0.095) loss_x loss_x 0.5132 (0.5970) acc_x 87.5000 (86.2500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/24] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.9487 (0.6398) acc_x 75.0000 (85.3125) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/26] time 0.198 (0.178) data 0.121 (0.101) loss_u loss_u 0.7578 (0.8374) acc_u 31.2500 (20.6250) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [10/26] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8784 (0.8605) acc_u 15.6250 (16.8750) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/26] time 0.183 (0.180) data 0.103 (0.102) loss_u loss_u 0.8750 (0.8624) acc_u 12.5000 (16.4583) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/26] time 0.173 (0.179) data 0.096 (0.102) loss_u loss_u 0.8052 (0.8580) acc_u 21.8750 (16.5625) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [25/26] time 0.169 (0.178) data 0.092 (0.101) loss_u loss_u 0.9785 (0.8654) acc_u 0.0000 (15.7500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 467
confident_label rate tensor(0.4734, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 765
clean true:757
clean false:8
clean_rate:0.9895424836601308
noisy true:392
noisy false:459
after delete: len(clean_dataset) 765
after delete: len(noisy_dataset) 851
epoch [109/200] batch [5/23] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.9438 (0.6748) acc_x 78.1250 (82.5000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/23] time 0.160 (0.173) data 0.083 (0.095) loss_x loss_x 1.0127 (0.7071) acc_x 78.1250 (82.1875) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/23] time 0.234 (0.178) data 0.156 (0.101) loss_x loss_x 0.6895 (0.7100) acc_x 84.3750 (81.6667) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/23] time 0.169 (0.175) data 0.092 (0.098) loss_x loss_x 0.7090 (0.6655) acc_x 81.2500 (82.9688) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/26] time 0.162 (0.176) data 0.084 (0.099) loss_u loss_u 0.7905 (0.8417) acc_u 25.0000 (19.3750) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [10/26] time 0.186 (0.176) data 0.109 (0.099) loss_u loss_u 0.8242 (0.8372) acc_u 21.8750 (19.3750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/26] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.7573 (0.8439) acc_u 25.0000 (18.1250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/26] time 0.168 (0.175) data 0.090 (0.098) loss_u loss_u 0.8862 (0.8572) acc_u 15.6250 (16.7188) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [25/26] time 0.181 (0.175) data 0.103 (0.098) loss_u loss_u 0.8784 (0.8620) acc_u 21.8750 (16.6250) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 462
confident_label rate tensor(0.4802, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 776
clean true:770
clean false:6
clean_rate:0.9922680412371134
noisy true:384
noisy false:456
after delete: len(clean_dataset) 776
after delete: len(noisy_dataset) 840
epoch [110/200] batch [5/24] time 0.175 (0.182) data 0.099 (0.105) loss_x loss_x 0.4700 (0.6502) acc_x 81.2500 (81.8750) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/24] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.2729 (0.6513) acc_x 90.6250 (83.1250) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/24] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.8862 (0.6073) acc_x 84.3750 (85.2083) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/24] time 0.164 (0.176) data 0.086 (0.099) loss_x loss_x 0.7725 (0.6006) acc_x 81.2500 (85.4688) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/26] time 0.164 (0.174) data 0.086 (0.097) loss_u loss_u 0.8169 (0.8566) acc_u 18.7500 (15.6250) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [10/26] time 0.195 (0.176) data 0.117 (0.099) loss_u loss_u 0.8555 (0.8804) acc_u 21.8750 (13.7500) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/26] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.8765 (0.8826) acc_u 12.5000 (13.1250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/26] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.8599 (0.8840) acc_u 15.6250 (12.9688) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [25/26] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.9028 (0.8839) acc_u 9.3750 (13.0000) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 467
confident_label rate tensor(0.4715, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 762
clean true:754
clean false:8
clean_rate:0.989501312335958
noisy true:395
noisy false:459
after delete: len(clean_dataset) 762
after delete: len(noisy_dataset) 854
epoch [111/200] batch [5/23] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.6777 (0.6092) acc_x 87.5000 (85.6250) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/23] time 0.189 (0.183) data 0.112 (0.107) loss_x loss_x 0.5005 (0.5753) acc_x 84.3750 (84.6875) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/23] time 0.183 (0.189) data 0.107 (0.112) loss_x loss_x 0.4973 (0.5793) acc_x 87.5000 (84.3750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/23] time 0.170 (0.186) data 0.093 (0.108) loss_x loss_x 0.6226 (0.5953) acc_x 81.2500 (84.0625) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/26] time 0.186 (0.182) data 0.110 (0.105) loss_u loss_u 0.8633 (0.8621) acc_u 12.5000 (16.2500) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [10/26] time 0.166 (0.182) data 0.089 (0.105) loss_u loss_u 0.8091 (0.8526) acc_u 21.8750 (17.1875) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/26] time 0.163 (0.180) data 0.085 (0.103) loss_u loss_u 0.8691 (0.8606) acc_u 18.7500 (16.6667) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/26] time 0.171 (0.180) data 0.094 (0.102) loss_u loss_u 0.8364 (0.8661) acc_u 21.8750 (16.2500) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [25/26] time 0.186 (0.180) data 0.108 (0.102) loss_u loss_u 0.9297 (0.8652) acc_u 6.2500 (16.1250) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 457
confident_label rate tensor(0.4783, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 773
clean true:765
clean false:8
clean_rate:0.9896507115135834
noisy true:394
noisy false:449
after delete: len(clean_dataset) 773
after delete: len(noisy_dataset) 843
epoch [112/200] batch [5/24] time 0.162 (0.161) data 0.085 (0.084) loss_x loss_x 0.9077 (0.6553) acc_x 75.0000 (83.7500) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/24] time 0.183 (0.165) data 0.106 (0.088) loss_x loss_x 0.5615 (0.6966) acc_x 90.6250 (82.1875) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/24] time 0.168 (0.167) data 0.092 (0.090) loss_x loss_x 0.5303 (0.6827) acc_x 81.2500 (81.6667) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/24] time 0.160 (0.166) data 0.083 (0.089) loss_x loss_x 0.4717 (0.6701) acc_x 90.6250 (83.2812) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/26] time 0.189 (0.167) data 0.112 (0.090) loss_u loss_u 0.8770 (0.8726) acc_u 12.5000 (13.7500) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [10/26] time 0.192 (0.170) data 0.114 (0.093) loss_u loss_u 0.8257 (0.8864) acc_u 21.8750 (11.8750) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/26] time 0.185 (0.172) data 0.108 (0.095) loss_u loss_u 0.9087 (0.8811) acc_u 12.5000 (13.3333) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/26] time 0.189 (0.175) data 0.110 (0.097) loss_u loss_u 0.8682 (0.8734) acc_u 18.7500 (14.6875) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [25/26] time 0.196 (0.176) data 0.118 (0.099) loss_u loss_u 0.9482 (0.8668) acc_u 3.1250 (15.2500) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 471
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 775
clean true:765
clean false:10
clean_rate:0.9870967741935484
noisy true:380
noisy false:461
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 841
epoch [113/200] batch [5/24] time 0.159 (0.169) data 0.082 (0.092) loss_x loss_x 0.6484 (0.7286) acc_x 78.1250 (81.2500) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/24] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.3921 (0.7018) acc_x 93.7500 (81.8750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/24] time 0.172 (0.175) data 0.096 (0.098) loss_x loss_x 0.6880 (0.7388) acc_x 71.8750 (81.4583) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/24] time 0.182 (0.176) data 0.104 (0.099) loss_x loss_x 0.7944 (0.7296) acc_x 78.1250 (81.7188) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/26] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9023 (0.8956) acc_u 12.5000 (11.8750) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [10/26] time 0.186 (0.178) data 0.109 (0.100) loss_u loss_u 0.7231 (0.8742) acc_u 34.3750 (14.6875) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/26] time 0.181 (0.177) data 0.103 (0.100) loss_u loss_u 0.8716 (0.8760) acc_u 18.7500 (14.3750) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/26] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.8901 (0.8824) acc_u 15.6250 (13.5938) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [25/26] time 0.178 (0.180) data 0.100 (0.102) loss_u loss_u 0.8911 (0.8744) acc_u 12.5000 (14.3750) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 467
confident_label rate tensor(0.4790, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 774
clean true:764
clean false:10
clean_rate:0.9870801033591732
noisy true:385
noisy false:457
after delete: len(clean_dataset) 774
after delete: len(noisy_dataset) 842
epoch [114/200] batch [5/24] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.7236 (0.6947) acc_x 81.2500 (81.2500) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/24] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.5220 (0.6105) acc_x 84.3750 (84.0625) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/24] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.5732 (0.5902) acc_x 81.2500 (84.1667) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/24] time 0.166 (0.182) data 0.089 (0.105) loss_x loss_x 1.1504 (0.6571) acc_x 71.8750 (82.8125) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/26] time 0.168 (0.179) data 0.089 (0.102) loss_u loss_u 0.8994 (0.8804) acc_u 15.6250 (15.6250) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [10/26] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.8608 (0.8804) acc_u 15.6250 (14.3750) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/26] time 0.227 (0.184) data 0.150 (0.107) loss_u loss_u 0.7915 (0.8677) acc_u 25.0000 (15.8333) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/26] time 0.222 (0.188) data 0.144 (0.111) loss_u loss_u 0.8882 (0.8615) acc_u 12.5000 (16.4062) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [25/26] time 0.185 (0.188) data 0.108 (0.111) loss_u loss_u 0.8550 (0.8566) acc_u 15.6250 (17.2500) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.4703, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 760
clean true:755
clean false:5
clean_rate:0.993421052631579
noisy true:389
noisy false:467
after delete: len(clean_dataset) 760
after delete: len(noisy_dataset) 856
epoch [115/200] batch [5/23] time 0.164 (0.179) data 0.087 (0.102) loss_x loss_x 0.4880 (0.5739) acc_x 87.5000 (85.6250) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/23] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.5820 (0.5457) acc_x 84.3750 (86.8750) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/23] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.5229 (0.5792) acc_x 84.3750 (85.8333) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/23] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.7339 (0.5778) acc_x 84.3750 (85.4688) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/26] time 0.166 (0.175) data 0.088 (0.097) loss_u loss_u 0.8721 (0.9126) acc_u 15.6250 (12.5000) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [10/26] time 0.189 (0.175) data 0.111 (0.098) loss_u loss_u 0.8555 (0.8786) acc_u 15.6250 (15.3125) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/26] time 0.193 (0.176) data 0.115 (0.099) loss_u loss_u 0.8418 (0.8522) acc_u 18.7500 (18.1250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/26] time 0.187 (0.177) data 0.109 (0.099) loss_u loss_u 0.7476 (0.8474) acc_u 28.1250 (18.1250) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [25/26] time 0.177 (0.177) data 0.099 (0.100) loss_u loss_u 0.8936 (0.8587) acc_u 15.6250 (16.7500) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.4864, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 786
clean true:781
clean false:5
clean_rate:0.9936386768447837
noisy true:392
noisy false:438
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 830
epoch [116/200] batch [5/24] time 0.195 (0.190) data 0.117 (0.113) loss_x loss_x 0.7397 (0.5864) acc_x 84.3750 (86.8750) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/24] time 0.184 (0.188) data 0.107 (0.110) loss_x loss_x 0.4902 (0.6600) acc_x 81.2500 (84.6875) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/24] time 0.184 (0.186) data 0.107 (0.108) loss_x loss_x 0.5894 (0.6666) acc_x 90.6250 (84.5833) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/24] time 0.175 (0.183) data 0.097 (0.106) loss_x loss_x 0.3633 (0.6452) acc_x 87.5000 (84.5312) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/25] time 0.169 (0.181) data 0.092 (0.103) loss_u loss_u 0.8901 (0.8562) acc_u 12.5000 (16.8750) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/25] time 0.187 (0.182) data 0.110 (0.104) loss_u loss_u 0.8579 (0.8648) acc_u 15.6250 (15.6250) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/25] time 0.190 (0.182) data 0.111 (0.105) loss_u loss_u 0.8433 (0.8693) acc_u 18.7500 (15.2083) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/25] time 0.189 (0.183) data 0.111 (0.106) loss_u loss_u 0.8223 (0.8732) acc_u 21.8750 (15.0000) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [25/25] time 0.161 (0.182) data 0.083 (0.105) loss_u loss_u 0.8999 (0.8745) acc_u 12.5000 (15.0000) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 468
confident_label rate tensor(0.4746, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 767
clean true:757
clean false:10
clean_rate:0.9869621903520208
noisy true:391
noisy false:458
after delete: len(clean_dataset) 767
after delete: len(noisy_dataset) 849
epoch [117/200] batch [5/23] time 0.186 (0.189) data 0.109 (0.112) loss_x loss_x 0.3806 (0.4206) acc_x 90.6250 (90.0000) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/23] time 0.184 (0.189) data 0.107 (0.112) loss_x loss_x 0.4585 (0.4425) acc_x 84.3750 (88.4375) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/23] time 0.185 (0.189) data 0.109 (0.112) loss_x loss_x 0.5356 (0.4840) acc_x 81.2500 (87.0833) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/23] time 0.165 (0.186) data 0.088 (0.109) loss_x loss_x 0.7446 (0.5514) acc_x 75.0000 (85.1562) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/26] time 0.178 (0.183) data 0.101 (0.105) loss_u loss_u 0.7598 (0.8623) acc_u 28.1250 (16.8750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/26] time 0.174 (0.182) data 0.096 (0.105) loss_u loss_u 0.8994 (0.8815) acc_u 9.3750 (14.3750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/26] time 0.186 (0.182) data 0.107 (0.105) loss_u loss_u 0.8501 (0.8640) acc_u 15.6250 (15.6250) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/26] time 0.185 (0.183) data 0.108 (0.105) loss_u loss_u 0.8921 (0.8658) acc_u 12.5000 (15.6250) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [25/26] time 0.175 (0.183) data 0.098 (0.106) loss_u loss_u 0.9624 (0.8645) acc_u 6.2500 (16.1250) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.4635, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 749
clean true:740
clean false:9
clean_rate:0.9879839786381842
noisy true:380
noisy false:487
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 867
epoch [118/200] batch [5/23] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.7476 (0.5651) acc_x 87.5000 (86.8750) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [10/23] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.9775 (0.5762) acc_x 81.2500 (87.1875) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/23] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.5083 (0.5742) acc_x 87.5000 (86.4583) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/23] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6763 (0.5710) acc_x 84.3750 (85.7812) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/27] time 0.172 (0.185) data 0.094 (0.108) loss_u loss_u 0.8818 (0.8387) acc_u 18.7500 (20.0000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/27] time 0.191 (0.183) data 0.113 (0.106) loss_u loss_u 0.8730 (0.8399) acc_u 12.5000 (19.0625) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [15/27] time 0.179 (0.183) data 0.101 (0.106) loss_u loss_u 0.8716 (0.8418) acc_u 18.7500 (18.7500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/27] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8853 (0.8468) acc_u 15.6250 (18.1250) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [25/27] time 0.171 (0.184) data 0.094 (0.106) loss_u loss_u 0.8569 (0.8498) acc_u 12.5000 (17.3750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.4827, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 780
clean true:772
clean false:8
clean_rate:0.9897435897435898
noisy true:391
noisy false:445
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 836
epoch [119/200] batch [5/24] time 0.169 (0.166) data 0.093 (0.089) loss_x loss_x 0.5039 (0.6952) acc_x 90.6250 (85.6250) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/24] time 0.175 (0.172) data 0.098 (0.095) loss_x loss_x 0.4893 (0.6243) acc_x 87.5000 (85.6250) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/24] time 0.160 (0.170) data 0.082 (0.092) loss_x loss_x 0.7422 (0.6718) acc_x 87.5000 (84.1667) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/24] time 0.167 (0.168) data 0.091 (0.091) loss_x loss_x 0.4656 (0.6698) acc_x 87.5000 (83.4375) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/26] time 0.171 (0.172) data 0.094 (0.094) loss_u loss_u 0.9380 (0.8837) acc_u 6.2500 (13.1250) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [10/26] time 0.170 (0.172) data 0.092 (0.095) loss_u loss_u 0.9365 (0.8758) acc_u 6.2500 (14.3750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/26] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.8950 (0.8675) acc_u 15.6250 (15.6250) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/26] time 0.185 (0.173) data 0.106 (0.096) loss_u loss_u 0.7720 (0.8637) acc_u 25.0000 (15.9375) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [25/26] time 0.181 (0.174) data 0.103 (0.096) loss_u loss_u 0.9473 (0.8708) acc_u 6.2500 (15.1250) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 440
confident_label rate tensor(0.4821, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 779
clean true:773
clean false:6
clean_rate:0.9922978177150192
noisy true:403
noisy false:434
after delete: len(clean_dataset) 779
after delete: len(noisy_dataset) 837
epoch [120/200] batch [5/24] time 0.175 (0.169) data 0.098 (0.092) loss_x loss_x 0.6372 (0.6376) acc_x 84.3750 (82.5000) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/24] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 0.5103 (0.6554) acc_x 90.6250 (82.8125) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/24] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.2627 (0.6727) acc_x 93.7500 (83.1250) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/24] time 0.185 (0.180) data 0.108 (0.103) loss_x loss_x 0.6450 (0.6460) acc_x 84.3750 (84.0625) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/26] time 0.161 (0.181) data 0.084 (0.104) loss_u loss_u 0.8770 (0.8824) acc_u 12.5000 (14.3750) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [10/26] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.8701 (0.8844) acc_u 18.7500 (13.7500) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/26] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.9482 (0.8749) acc_u 6.2500 (14.7917) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/26] time 0.166 (0.178) data 0.089 (0.101) loss_u loss_u 0.8994 (0.8693) acc_u 12.5000 (15.9375) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [25/26] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.8340 (0.8642) acc_u 21.8750 (16.5000) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 451
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 775
clean true:770
clean false:5
clean_rate:0.9935483870967742
noisy true:395
noisy false:446
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 841
epoch [121/200] batch [5/24] time 0.185 (0.185) data 0.109 (0.109) loss_x loss_x 0.4509 (0.5178) acc_x 84.3750 (88.7500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/24] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.4817 (0.5110) acc_x 87.5000 (88.1250) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/24] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.6699 (0.5168) acc_x 81.2500 (87.5000) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/24] time 0.161 (0.181) data 0.083 (0.104) loss_x loss_x 0.7339 (0.5406) acc_x 78.1250 (86.5625) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/26] time 0.183 (0.178) data 0.104 (0.101) loss_u loss_u 0.9224 (0.8747) acc_u 9.3750 (15.6250) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [10/26] time 0.190 (0.179) data 0.113 (0.102) loss_u loss_u 0.9150 (0.8707) acc_u 9.3750 (15.6250) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/26] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8906 (0.8779) acc_u 9.3750 (14.3750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/26] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.7998 (0.8726) acc_u 28.1250 (15.3125) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [25/26] time 0.161 (0.181) data 0.084 (0.104) loss_u loss_u 0.7729 (0.8664) acc_u 25.0000 (16.0000) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 469
confident_label rate tensor(0.4802, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 776
clean true:768
clean false:8
clean_rate:0.9896907216494846
noisy true:379
noisy false:461
after delete: len(clean_dataset) 776
after delete: len(noisy_dataset) 840
epoch [122/200] batch [5/24] time 0.170 (0.163) data 0.093 (0.087) loss_x loss_x 0.7207 (0.6631) acc_x 78.1250 (81.8750) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/24] time 0.181 (0.167) data 0.103 (0.090) loss_x loss_x 0.4556 (0.6143) acc_x 84.3750 (83.7500) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/24] time 0.165 (0.166) data 0.088 (0.089) loss_x loss_x 0.3936 (0.6115) acc_x 93.7500 (84.1667) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/24] time 0.185 (0.167) data 0.108 (0.090) loss_x loss_x 0.5835 (0.6289) acc_x 84.3750 (83.4375) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/26] time 0.190 (0.171) data 0.112 (0.094) loss_u loss_u 0.8345 (0.8606) acc_u 18.7500 (15.6250) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [10/26] time 0.169 (0.171) data 0.092 (0.094) loss_u loss_u 0.8721 (0.8706) acc_u 15.6250 (14.6875) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/26] time 0.184 (0.170) data 0.107 (0.093) loss_u loss_u 0.8364 (0.8703) acc_u 18.7500 (14.3750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/26] time 0.166 (0.170) data 0.088 (0.093) loss_u loss_u 0.8125 (0.8607) acc_u 18.7500 (16.0938) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [25/26] time 0.181 (0.171) data 0.104 (0.093) loss_u loss_u 0.7349 (0.8614) acc_u 31.2500 (15.8750) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.4876, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 788
clean true:777
clean false:11
clean_rate:0.9860406091370558
noisy true:397
noisy false:431
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 828
epoch [123/200] batch [5/24] time 0.178 (0.183) data 0.101 (0.106) loss_x loss_x 0.5327 (0.6264) acc_x 84.3750 (86.8750) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/24] time 0.178 (0.180) data 0.101 (0.102) loss_x loss_x 0.3516 (0.5805) acc_x 93.7500 (86.2500) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/24] time 0.162 (0.180) data 0.085 (0.103) loss_x loss_x 1.0703 (0.6299) acc_x 75.0000 (85.2083) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/24] time 0.187 (0.182) data 0.110 (0.105) loss_x loss_x 0.5107 (0.6469) acc_x 87.5000 (84.0625) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/25] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.8149 (0.8726) acc_u 21.8750 (16.2500) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/25] time 0.174 (0.182) data 0.096 (0.105) loss_u loss_u 0.8887 (0.8848) acc_u 12.5000 (13.4375) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/25] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.8794 (0.8607) acc_u 12.5000 (16.0417) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/25] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9268 (0.8672) acc_u 6.2500 (14.6875) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [25/25] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8086 (0.8590) acc_u 21.8750 (15.8750) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 431
confident_label rate tensor(0.4864, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 786
clean true:778
clean false:8
clean_rate:0.989821882951654
noisy true:407
noisy false:423
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 830
epoch [124/200] batch [5/24] time 0.173 (0.178) data 0.096 (0.101) loss_x loss_x 0.5518 (0.6674) acc_x 81.2500 (83.7500) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/24] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.8369 (0.6768) acc_x 75.0000 (82.8125) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/24] time 0.170 (0.173) data 0.092 (0.095) loss_x loss_x 0.8950 (0.7074) acc_x 81.2500 (82.0833) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/24] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.8140 (0.7111) acc_x 87.5000 (82.3438) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/25] time 0.188 (0.177) data 0.109 (0.100) loss_u loss_u 0.8047 (0.8799) acc_u 21.8750 (13.1250) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/25] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.8838 (0.8732) acc_u 15.6250 (14.3750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/25] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.8481 (0.8680) acc_u 15.6250 (15.2083) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/25] time 0.173 (0.178) data 0.095 (0.100) loss_u loss_u 0.8726 (0.8586) acc_u 12.5000 (16.5625) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [25/25] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.9458 (0.8719) acc_u 9.3750 (15.0000) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.4808, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 777
clean true:769
clean false:8
clean_rate:0.9897039897039897
noisy true:404
noisy false:435
after delete: len(clean_dataset) 777
after delete: len(noisy_dataset) 839
epoch [125/200] batch [5/24] time 0.177 (0.176) data 0.101 (0.099) loss_x loss_x 0.9263 (0.7191) acc_x 78.1250 (82.5000) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/24] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.5518 (0.6191) acc_x 84.3750 (83.7500) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/24] time 0.162 (0.176) data 0.085 (0.098) loss_x loss_x 0.8486 (0.6584) acc_x 81.2500 (82.9167) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/24] time 0.186 (0.177) data 0.109 (0.100) loss_x loss_x 0.8945 (0.6619) acc_x 78.1250 (82.9688) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/26] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.8330 (0.8774) acc_u 18.7500 (14.3750) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [10/26] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.8813 (0.8604) acc_u 18.7500 (17.5000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/26] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.8945 (0.8730) acc_u 12.5000 (15.6250) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/26] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.8804 (0.8688) acc_u 12.5000 (16.2500) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [25/26] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.7705 (0.8580) acc_u 28.1250 (17.0000) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 415
confident_label rate tensor(0.5043, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 815
clean true:810
clean false:5
clean_rate:0.9938650306748467
noisy true:391
noisy false:410
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 801
epoch [126/200] batch [5/25] time 0.184 (0.186) data 0.108 (0.108) loss_x loss_x 0.8726 (0.6392) acc_x 84.3750 (84.3750) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/25] time 0.177 (0.184) data 0.100 (0.107) loss_x loss_x 0.6206 (0.5883) acc_x 84.3750 (85.0000) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/25] time 0.193 (0.182) data 0.116 (0.105) loss_x loss_x 0.2903 (0.5721) acc_x 93.7500 (85.8333) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/25] time 0.184 (0.181) data 0.106 (0.104) loss_x loss_x 0.8911 (0.6422) acc_x 78.1250 (83.5938) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [25/25] time 0.179 (0.180) data 0.103 (0.102) loss_x loss_x 0.7739 (0.6467) acc_x 78.1250 (83.6250) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/25] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.9053 (0.8940) acc_u 9.3750 (12.5000) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [10/25] time 0.171 (0.178) data 0.094 (0.101) loss_u loss_u 0.8286 (0.8797) acc_u 18.7500 (14.0625) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/25] time 0.189 (0.178) data 0.110 (0.101) loss_u loss_u 0.9126 (0.8892) acc_u 9.3750 (12.7083) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/25] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.9087 (0.8898) acc_u 9.3750 (12.6562) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [25/25] time 0.194 (0.178) data 0.113 (0.101) loss_u loss_u 0.9531 (0.8880) acc_u 3.1250 (12.6250) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.4851, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 784
clean true:775
clean false:9
clean_rate:0.9885204081632653
noisy true:403
noisy false:429
after delete: len(clean_dataset) 784
after delete: len(noisy_dataset) 832
epoch [127/200] batch [5/24] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.5312 (0.6040) acc_x 84.3750 (84.3750) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/24] time 0.161 (0.172) data 0.084 (0.095) loss_x loss_x 0.6553 (0.6075) acc_x 81.2500 (83.4375) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/24] time 0.198 (0.174) data 0.121 (0.097) loss_x loss_x 0.5000 (0.5890) acc_x 84.3750 (83.7500) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/24] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.3738 (0.5908) acc_x 87.5000 (84.3750) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/26] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.8770 (0.8917) acc_u 12.5000 (13.1250) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/26] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.7856 (0.8627) acc_u 21.8750 (16.2500) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/26] time 0.188 (0.177) data 0.110 (0.100) loss_u loss_u 0.8574 (0.8724) acc_u 15.6250 (15.2083) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/26] time 0.185 (0.178) data 0.107 (0.100) loss_u loss_u 0.7700 (0.8643) acc_u 25.0000 (15.6250) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [25/26] time 0.171 (0.178) data 0.093 (0.101) loss_u loss_u 0.8848 (0.8648) acc_u 15.6250 (15.7500) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 430
confident_label rate tensor(0.4926, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 796
clean true:788
clean false:8
clean_rate:0.9899497487437185
noisy true:398
noisy false:422
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 820
epoch [128/200] batch [5/24] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.8066 (0.6045) acc_x 75.0000 (84.3750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/24] time 0.187 (0.173) data 0.110 (0.096) loss_x loss_x 0.4070 (0.6059) acc_x 87.5000 (84.6875) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/24] time 0.178 (0.175) data 0.101 (0.097) loss_x loss_x 0.8403 (0.6335) acc_x 81.2500 (84.3750) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/24] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.7173 (0.6394) acc_x 84.3750 (84.2188) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/25] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.8853 (0.8751) acc_u 15.6250 (14.3750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/25] time 0.177 (0.175) data 0.100 (0.098) loss_u loss_u 0.8794 (0.8808) acc_u 15.6250 (14.0625) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/25] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.7349 (0.8646) acc_u 31.2500 (15.6250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/25] time 0.189 (0.178) data 0.110 (0.101) loss_u loss_u 0.8008 (0.8698) acc_u 25.0000 (15.4688) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [25/25] time 0.193 (0.179) data 0.115 (0.102) loss_u loss_u 0.8716 (0.8738) acc_u 15.6250 (14.8750) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 455
confident_label rate tensor(0.4839, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 782
clean true:775
clean false:7
clean_rate:0.9910485933503836
noisy true:386
noisy false:448
after delete: len(clean_dataset) 782
after delete: len(noisy_dataset) 834
epoch [129/200] batch [5/24] time 0.186 (0.174) data 0.109 (0.097) loss_x loss_x 0.6343 (0.6623) acc_x 84.3750 (85.0000) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/24] time 0.168 (0.176) data 0.091 (0.098) loss_x loss_x 0.4551 (0.5865) acc_x 87.5000 (86.2500) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/24] time 0.192 (0.177) data 0.115 (0.100) loss_x loss_x 0.5347 (0.5558) acc_x 84.3750 (86.6667) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/24] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.5747 (0.5836) acc_x 78.1250 (85.7812) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/26] time 0.193 (0.175) data 0.115 (0.098) loss_u loss_u 0.8696 (0.8435) acc_u 18.7500 (19.3750) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/26] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9316 (0.8726) acc_u 9.3750 (15.3125) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/26] time 0.177 (0.175) data 0.100 (0.098) loss_u loss_u 0.8672 (0.8659) acc_u 15.6250 (15.8333) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/26] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.8662 (0.8605) acc_u 12.5000 (16.5625) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [25/26] time 0.188 (0.176) data 0.110 (0.099) loss_u loss_u 0.8213 (0.8606) acc_u 21.8750 (16.7500) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 802
clean true:793
clean false:9
clean_rate:0.9887780548628429
noisy true:391
noisy false:423
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 814
epoch [130/200] batch [5/25] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.4358 (0.5480) acc_x 84.3750 (85.0000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/25] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.5762 (0.6223) acc_x 87.5000 (84.6875) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/25] time 0.174 (0.184) data 0.096 (0.107) loss_x loss_x 0.5737 (0.6594) acc_x 90.6250 (83.5417) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/25] time 0.188 (0.183) data 0.111 (0.105) loss_x loss_x 0.4543 (0.6411) acc_x 90.6250 (83.1250) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [25/25] time 0.185 (0.182) data 0.107 (0.104) loss_x loss_x 0.3386 (0.6122) acc_x 93.7500 (84.0000) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/25] time 0.180 (0.180) data 0.101 (0.103) loss_u loss_u 0.9048 (0.8825) acc_u 9.3750 (12.5000) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/25] time 0.170 (0.180) data 0.093 (0.103) loss_u loss_u 0.8823 (0.8813) acc_u 12.5000 (12.8125) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/25] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.9087 (0.8908) acc_u 12.5000 (12.2917) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [20/25] time 0.166 (0.178) data 0.089 (0.100) loss_u loss_u 0.9214 (0.8825) acc_u 9.3750 (13.2812) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [25/25] time 0.189 (0.177) data 0.111 (0.100) loss_u loss_u 0.8896 (0.8771) acc_u 12.5000 (13.6250) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 437
confident_label rate tensor(0.4950, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 800
clean true:792
clean false:8
clean_rate:0.99
noisy true:387
noisy false:429
after delete: len(clean_dataset) 800
after delete: len(noisy_dataset) 816
epoch [131/200] batch [5/25] time 0.180 (0.173) data 0.102 (0.096) loss_x loss_x 0.9595 (0.6999) acc_x 71.8750 (82.5000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/25] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.4458 (0.6908) acc_x 87.5000 (82.8125) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/25] time 0.172 (0.178) data 0.094 (0.101) loss_x loss_x 0.8413 (0.6895) acc_x 71.8750 (82.0833) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/25] time 0.181 (0.176) data 0.102 (0.099) loss_x loss_x 0.8262 (0.6844) acc_x 81.2500 (82.1875) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [25/25] time 0.164 (0.174) data 0.087 (0.097) loss_x loss_x 0.3069 (0.6396) acc_x 90.6250 (83.3750) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/25] time 0.200 (0.180) data 0.123 (0.103) loss_u loss_u 0.8916 (0.8754) acc_u 12.5000 (15.0000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/25] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.8667 (0.8695) acc_u 18.7500 (16.5625) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/25] time 0.164 (0.178) data 0.087 (0.100) loss_u loss_u 0.9019 (0.8737) acc_u 12.5000 (15.8333) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/25] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.7681 (0.8758) acc_u 28.1250 (15.0000) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [25/25] time 0.171 (0.177) data 0.094 (0.099) loss_u loss_u 0.7832 (0.8681) acc_u 28.1250 (16.0000) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 452
confident_label rate tensor(0.4833, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 781
clean true:768
clean false:13
clean_rate:0.9833546734955185
noisy true:396
noisy false:439
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 835
epoch [132/200] batch [5/24] time 0.211 (0.186) data 0.134 (0.109) loss_x loss_x 0.4404 (0.5709) acc_x 87.5000 (84.3750) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/24] time 0.177 (0.180) data 0.100 (0.103) loss_x loss_x 0.5884 (0.5726) acc_x 84.3750 (86.2500) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/24] time 0.181 (0.180) data 0.103 (0.103) loss_x loss_x 0.3743 (0.5701) acc_x 93.7500 (86.6667) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/24] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.8838 (0.5917) acc_x 90.6250 (86.5625) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/26] time 0.180 (0.181) data 0.102 (0.103) loss_u loss_u 0.8696 (0.8306) acc_u 12.5000 (18.7500) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/26] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9082 (0.8390) acc_u 9.3750 (17.5000) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/26] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.8989 (0.8535) acc_u 15.6250 (16.4583) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/26] time 0.165 (0.179) data 0.087 (0.101) loss_u loss_u 0.7812 (0.8516) acc_u 25.0000 (16.5625) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [25/26] time 0.169 (0.178) data 0.092 (0.101) loss_u loss_u 0.8408 (0.8480) acc_u 21.8750 (17.6250) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 439
confident_label rate tensor(0.4932, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 797
clean true:784
clean false:13
clean_rate:0.9836888331242158
noisy true:393
noisy false:426
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 819
epoch [133/200] batch [5/24] time 0.163 (0.173) data 0.085 (0.096) loss_x loss_x 0.3928 (0.5457) acc_x 90.6250 (85.6250) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/24] time 0.172 (0.171) data 0.095 (0.094) loss_x loss_x 0.4299 (0.5641) acc_x 90.6250 (85.9375) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/24] time 0.175 (0.173) data 0.098 (0.096) loss_x loss_x 1.0596 (0.5951) acc_x 71.8750 (85.4167) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/24] time 0.174 (0.173) data 0.096 (0.096) loss_x loss_x 0.4766 (0.6295) acc_x 87.5000 (84.6875) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/25] time 0.175 (0.174) data 0.098 (0.097) loss_u loss_u 0.8950 (0.8934) acc_u 12.5000 (13.1250) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [10/25] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.8154 (0.8855) acc_u 25.0000 (14.0625) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/25] time 0.167 (0.175) data 0.089 (0.097) loss_u loss_u 0.9355 (0.8918) acc_u 6.2500 (13.1250) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/25] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.8911 (0.8879) acc_u 12.5000 (13.5938) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [25/25] time 0.174 (0.174) data 0.096 (0.096) loss_u loss_u 0.8877 (0.8845) acc_u 12.5000 (14.0000) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 464
confident_label rate tensor(0.4802, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 776
clean true:764
clean false:12
clean_rate:0.9845360824742269
noisy true:388
noisy false:452
after delete: len(clean_dataset) 776
after delete: len(noisy_dataset) 840
epoch [134/200] batch [5/24] time 0.168 (0.171) data 0.092 (0.094) loss_x loss_x 0.4734 (0.5515) acc_x 90.6250 (88.1250) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/24] time 0.171 (0.174) data 0.095 (0.097) loss_x loss_x 0.7461 (0.6605) acc_x 81.2500 (83.4375) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/24] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.4978 (0.6088) acc_x 90.6250 (85.4167) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/24] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 0.4170 (0.5987) acc_x 90.6250 (85.3125) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/26] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.8921 (0.8421) acc_u 18.7500 (21.2500) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/26] time 0.164 (0.181) data 0.085 (0.103) loss_u loss_u 0.8794 (0.8480) acc_u 9.3750 (18.4375) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/26] time 0.174 (0.179) data 0.097 (0.102) loss_u loss_u 0.9302 (0.8494) acc_u 9.3750 (17.5000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/26] time 0.188 (0.178) data 0.110 (0.100) loss_u loss_u 0.8247 (0.8477) acc_u 18.7500 (17.6562) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [25/26] time 0.167 (0.177) data 0.089 (0.100) loss_u loss_u 0.8789 (0.8564) acc_u 12.5000 (16.5000) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 416
confident_label rate tensor(0.4913, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 794
clean true:786
clean false:8
clean_rate:0.9899244332493703
noisy true:414
noisy false:408
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 822
epoch [135/200] batch [5/24] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.8115 (0.6703) acc_x 81.2500 (81.8750) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/24] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.5693 (0.6168) acc_x 78.1250 (82.1875) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/24] time 0.190 (0.178) data 0.112 (0.100) loss_x loss_x 0.8789 (0.5923) acc_x 81.2500 (83.7500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/24] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.4160 (0.5769) acc_x 90.6250 (84.3750) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/25] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9502 (0.8576) acc_u 6.2500 (15.6250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/25] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.8828 (0.8685) acc_u 12.5000 (14.6875) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/25] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9092 (0.8659) acc_u 9.3750 (15.0000) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/25] time 0.169 (0.182) data 0.092 (0.104) loss_u loss_u 0.9131 (0.8696) acc_u 6.2500 (14.6875) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [25/25] time 0.188 (0.182) data 0.109 (0.105) loss_u loss_u 0.8467 (0.8696) acc_u 18.7500 (15.1250) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 427
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 795
clean true:784
clean false:11
clean_rate:0.9861635220125786
noisy true:405
noisy false:416
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 821
epoch [136/200] batch [5/24] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.6333 (0.6401) acc_x 87.5000 (85.0000) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/24] time 0.174 (0.181) data 0.098 (0.104) loss_x loss_x 0.8159 (0.7346) acc_x 81.2500 (82.5000) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/24] time 0.191 (0.185) data 0.113 (0.108) loss_x loss_x 0.2766 (0.6604) acc_x 90.6250 (83.3333) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/24] time 0.166 (0.182) data 0.089 (0.105) loss_x loss_x 0.6089 (0.6437) acc_x 81.2500 (83.5938) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/25] time 0.163 (0.179) data 0.087 (0.102) loss_u loss_u 0.8799 (0.8758) acc_u 12.5000 (13.7500) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [10/25] time 0.174 (0.178) data 0.096 (0.101) loss_u loss_u 0.9072 (0.8725) acc_u 9.3750 (14.3750) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/25] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.7949 (0.8570) acc_u 25.0000 (16.0417) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/25] time 0.175 (0.178) data 0.097 (0.100) loss_u loss_u 0.8105 (0.8585) acc_u 18.7500 (16.0938) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [25/25] time 0.177 (0.177) data 0.098 (0.100) loss_u loss_u 0.8457 (0.8622) acc_u 25.0000 (15.8750) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.4907, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 793
clean true:786
clean false:7
clean_rate:0.9911727616645649
noisy true:388
noisy false:435
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 823
epoch [137/200] batch [5/24] time 0.174 (0.176) data 0.096 (0.099) loss_x loss_x 0.5000 (0.6471) acc_x 90.6250 (81.8750) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/24] time 0.171 (0.176) data 0.093 (0.098) loss_x loss_x 0.9170 (0.6581) acc_x 78.1250 (80.9375) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/24] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.6548 (0.6444) acc_x 84.3750 (82.2917) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/24] time 0.170 (0.175) data 0.093 (0.098) loss_x loss_x 0.4766 (0.6314) acc_x 78.1250 (82.5000) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/25] time 0.181 (0.173) data 0.102 (0.095) loss_u loss_u 0.8657 (0.8725) acc_u 15.6250 (14.3750) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/25] time 0.182 (0.174) data 0.104 (0.096) loss_u loss_u 0.8862 (0.8781) acc_u 12.5000 (13.7500) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/25] time 0.174 (0.174) data 0.095 (0.097) loss_u loss_u 0.9404 (0.8826) acc_u 6.2500 (12.9167) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [20/25] time 0.168 (0.174) data 0.091 (0.096) loss_u loss_u 0.9077 (0.8781) acc_u 12.5000 (13.4375) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [25/25] time 0.212 (0.176) data 0.134 (0.099) loss_u loss_u 0.8574 (0.8747) acc_u 15.6250 (14.2500) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 429
confident_label rate tensor(0.4870, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 787
clean true:778
clean false:9
clean_rate:0.98856416772554
noisy true:409
noisy false:420
after delete: len(clean_dataset) 787
after delete: len(noisy_dataset) 829
epoch [138/200] batch [5/24] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.3691 (0.4846) acc_x 84.3750 (86.2500) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/24] time 0.168 (0.171) data 0.092 (0.094) loss_x loss_x 0.7051 (0.5111) acc_x 87.5000 (86.8750) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/24] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.5117 (0.5769) acc_x 87.5000 (85.4167) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/24] time 0.177 (0.172) data 0.100 (0.095) loss_x loss_x 0.6147 (0.5927) acc_x 81.2500 (84.2188) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/25] time 0.167 (0.173) data 0.089 (0.096) loss_u loss_u 0.8921 (0.8688) acc_u 9.3750 (14.3750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/25] time 0.164 (0.172) data 0.086 (0.095) loss_u loss_u 0.8452 (0.8676) acc_u 18.7500 (14.6875) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/25] time 0.185 (0.172) data 0.108 (0.095) loss_u loss_u 0.8481 (0.8654) acc_u 15.6250 (15.2083) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/25] time 0.187 (0.172) data 0.110 (0.095) loss_u loss_u 0.8228 (0.8596) acc_u 21.8750 (16.0938) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [25/25] time 0.178 (0.172) data 0.101 (0.095) loss_u loss_u 0.8604 (0.8638) acc_u 21.8750 (15.8750) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 433
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 795
clean true:788
clean false:7
clean_rate:0.9911949685534591
noisy true:395
noisy false:426
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 821
epoch [139/200] batch [5/24] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.9185 (0.6398) acc_x 84.3750 (85.6250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/24] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.3440 (0.5702) acc_x 87.5000 (86.2500) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/24] time 0.178 (0.176) data 0.101 (0.099) loss_x loss_x 0.6919 (0.5665) acc_x 78.1250 (84.7917) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/24] time 0.177 (0.176) data 0.099 (0.099) loss_x loss_x 0.6797 (0.5616) acc_x 81.2500 (84.3750) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/25] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.8535 (0.8674) acc_u 18.7500 (16.2500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/25] time 0.161 (0.175) data 0.083 (0.098) loss_u loss_u 0.9219 (0.8656) acc_u 9.3750 (15.9375) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/25] time 0.169 (0.174) data 0.092 (0.097) loss_u loss_u 0.9136 (0.8750) acc_u 12.5000 (14.7917) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/25] time 0.170 (0.174) data 0.093 (0.097) loss_u loss_u 0.9199 (0.8728) acc_u 12.5000 (15.3125) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [25/25] time 0.176 (0.174) data 0.098 (0.097) loss_u loss_u 0.8154 (0.8709) acc_u 25.0000 (15.5000) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 430
confident_label rate tensor(0.4907, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 793
clean true:785
clean false:8
clean_rate:0.9899117276166457
noisy true:401
noisy false:422
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 823
epoch [140/200] batch [5/24] time 0.164 (0.176) data 0.087 (0.099) loss_x loss_x 0.2020 (0.6246) acc_x 100.0000 (85.6250) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/24] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.5112 (0.6304) acc_x 84.3750 (85.0000) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/24] time 0.172 (0.178) data 0.095 (0.101) loss_x loss_x 0.5420 (0.6496) acc_x 87.5000 (84.3750) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/24] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.3247 (0.6328) acc_x 90.6250 (84.6875) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/25] time 0.185 (0.180) data 0.108 (0.104) loss_u loss_u 0.8013 (0.8709) acc_u 25.0000 (16.2500) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/25] time 0.185 (0.181) data 0.109 (0.104) loss_u loss_u 0.6787 (0.8529) acc_u 37.5000 (18.4375) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/25] time 0.163 (0.180) data 0.085 (0.103) loss_u loss_u 0.8906 (0.8507) acc_u 12.5000 (18.1250) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/25] time 0.188 (0.180) data 0.108 (0.103) loss_u loss_u 0.7842 (0.8506) acc_u 25.0000 (17.8125) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [25/25] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.8677 (0.8571) acc_u 15.6250 (16.8750) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 811
clean true:801
clean false:10
clean_rate:0.9876695437731196
noisy true:393
noisy false:412
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 805
epoch [141/200] batch [5/25] time 0.164 (0.174) data 0.087 (0.097) loss_x loss_x 0.6470 (0.6036) acc_x 87.5000 (84.3750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/25] time 0.189 (0.176) data 0.112 (0.099) loss_x loss_x 0.5225 (0.5747) acc_x 87.5000 (86.8750) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/25] time 0.172 (0.174) data 0.095 (0.097) loss_x loss_x 0.5967 (0.5396) acc_x 78.1250 (86.4583) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/25] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.7988 (0.5750) acc_x 78.1250 (85.9375) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [25/25] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.7388 (0.6217) acc_x 84.3750 (84.6250) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/25] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.7485 (0.8250) acc_u 28.1250 (20.0000) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/25] time 0.172 (0.177) data 0.093 (0.100) loss_u loss_u 0.9072 (0.8674) acc_u 12.5000 (15.3125) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/25] time 0.163 (0.175) data 0.085 (0.098) loss_u loss_u 0.8984 (0.8784) acc_u 12.5000 (14.3750) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/25] time 0.188 (0.175) data 0.111 (0.097) loss_u loss_u 0.9170 (0.8766) acc_u 9.3750 (14.8438) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [25/25] time 0.171 (0.175) data 0.094 (0.098) loss_u loss_u 0.7900 (0.8728) acc_u 25.0000 (15.0000) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 795
clean true:786
clean false:9
clean_rate:0.9886792452830189
noisy true:398
noisy false:423
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 821
epoch [142/200] batch [5/24] time 0.163 (0.177) data 0.086 (0.100) loss_x loss_x 0.3872 (0.6078) acc_x 87.5000 (84.3750) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/24] time 0.171 (0.172) data 0.094 (0.095) loss_x loss_x 0.8008 (0.6382) acc_x 78.1250 (84.3750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/24] time 0.165 (0.171) data 0.088 (0.094) loss_x loss_x 0.7983 (0.6442) acc_x 78.1250 (83.7500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/24] time 0.187 (0.171) data 0.110 (0.094) loss_x loss_x 0.7251 (0.6439) acc_x 81.2500 (83.7500) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/25] time 0.177 (0.172) data 0.100 (0.095) loss_u loss_u 0.8477 (0.8478) acc_u 15.6250 (18.1250) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [10/25] time 0.173 (0.173) data 0.095 (0.096) loss_u loss_u 0.8550 (0.8705) acc_u 15.6250 (15.9375) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/25] time 0.158 (0.172) data 0.080 (0.095) loss_u loss_u 0.9512 (0.8808) acc_u 6.2500 (15.0000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/25] time 0.168 (0.172) data 0.090 (0.095) loss_u loss_u 0.8335 (0.8765) acc_u 18.7500 (15.0000) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [25/25] time 0.171 (0.172) data 0.093 (0.095) loss_u loss_u 0.8506 (0.8736) acc_u 21.8750 (15.6250) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 405
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 813
clean true:804
clean false:9
clean_rate:0.988929889298893
noisy true:407
noisy false:396
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 803
epoch [143/200] batch [5/25] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.7705 (0.6404) acc_x 87.5000 (85.0000) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/25] time 0.187 (0.175) data 0.110 (0.099) loss_x loss_x 0.4917 (0.5816) acc_x 90.6250 (85.3125) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/25] time 0.201 (0.175) data 0.123 (0.098) loss_x loss_x 0.6089 (0.5820) acc_x 78.1250 (85.0000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/25] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.2578 (0.5821) acc_x 93.7500 (85.3125) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [25/25] time 0.177 (0.177) data 0.100 (0.100) loss_x loss_x 0.4993 (0.5881) acc_x 90.6250 (85.1250) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/25] time 0.169 (0.176) data 0.091 (0.099) loss_u loss_u 0.9565 (0.8748) acc_u 3.1250 (14.3750) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [10/25] time 0.167 (0.176) data 0.090 (0.099) loss_u loss_u 0.8545 (0.8784) acc_u 18.7500 (14.0625) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/25] time 0.186 (0.176) data 0.106 (0.099) loss_u loss_u 0.8843 (0.8813) acc_u 12.5000 (13.3333) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/25] time 0.161 (0.174) data 0.082 (0.097) loss_u loss_u 0.8535 (0.8879) acc_u 15.6250 (12.5000) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [25/25] time 0.167 (0.173) data 0.090 (0.096) loss_u loss_u 0.8726 (0.8830) acc_u 12.5000 (13.1250) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.4950, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 800
clean true:790
clean false:10
clean_rate:0.9875
noisy true:404
noisy false:412
after delete: len(clean_dataset) 800
after delete: len(noisy_dataset) 816
epoch [144/200] batch [5/25] time 0.177 (0.180) data 0.099 (0.102) loss_x loss_x 0.4001 (0.6109) acc_x 84.3750 (80.6250) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/25] time 0.175 (0.179) data 0.098 (0.101) loss_x loss_x 0.4263 (0.5765) acc_x 81.2500 (82.1875) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/25] time 0.175 (0.177) data 0.097 (0.100) loss_x loss_x 0.8149 (0.5880) acc_x 84.3750 (82.7083) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/25] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.6484 (0.5751) acc_x 81.2500 (83.4375) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [25/25] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.3547 (0.5925) acc_x 90.6250 (83.2500) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/25] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.8770 (0.8836) acc_u 15.6250 (14.3750) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/25] time 0.175 (0.177) data 0.098 (0.100) loss_u loss_u 0.8862 (0.8815) acc_u 12.5000 (14.6875) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/25] time 0.187 (0.178) data 0.108 (0.100) loss_u loss_u 0.8882 (0.8697) acc_u 12.5000 (15.6250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/25] time 0.168 (0.177) data 0.091 (0.099) loss_u loss_u 0.8369 (0.8603) acc_u 18.7500 (16.4062) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [25/25] time 0.165 (0.176) data 0.088 (0.099) loss_u loss_u 0.9517 (0.8651) acc_u 6.2500 (15.7500) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 427
confident_label rate tensor(0.5025, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 812
clean true:800
clean false:12
clean_rate:0.9852216748768473
noisy true:389
noisy false:415
after delete: len(clean_dataset) 812
after delete: len(noisy_dataset) 804
epoch [145/200] batch [5/25] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.4846 (0.5480) acc_x 87.5000 (87.5000) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/25] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.4575 (0.5037) acc_x 90.6250 (88.4375) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/25] time 0.162 (0.176) data 0.084 (0.099) loss_x loss_x 0.3909 (0.5511) acc_x 93.7500 (87.5000) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/25] time 0.177 (0.175) data 0.099 (0.098) loss_x loss_x 1.2764 (0.6018) acc_x 71.8750 (86.2500) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [25/25] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.3618 (0.5808) acc_x 90.6250 (86.5000) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/25] time 0.186 (0.178) data 0.108 (0.100) loss_u loss_u 0.9023 (0.8762) acc_u 12.5000 (13.7500) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/25] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.8838 (0.8885) acc_u 12.5000 (12.1875) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/25] time 0.163 (0.175) data 0.085 (0.098) loss_u loss_u 0.7803 (0.8778) acc_u 21.8750 (13.1250) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/25] time 0.181 (0.175) data 0.103 (0.098) loss_u loss_u 0.9146 (0.8793) acc_u 9.3750 (13.4375) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [25/25] time 0.184 (0.176) data 0.107 (0.098) loss_u loss_u 0.8262 (0.8693) acc_u 18.7500 (14.6250) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 811
clean true:804
clean false:7
clean_rate:0.9913686806411838
noisy true:392
noisy false:413
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 805
epoch [146/200] batch [5/25] time 0.165 (0.170) data 0.088 (0.093) loss_x loss_x 0.5200 (0.6570) acc_x 84.3750 (83.7500) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/25] time 0.181 (0.173) data 0.105 (0.096) loss_x loss_x 0.8188 (0.6660) acc_x 78.1250 (82.8125) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/25] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.4031 (0.6148) acc_x 90.6250 (84.7917) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/25] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.5210 (0.6146) acc_x 87.5000 (85.1562) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [25/25] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 0.7412 (0.6187) acc_x 81.2500 (84.6250) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/25] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.7607 (0.8411) acc_u 28.1250 (18.1250) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/25] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9390 (0.8537) acc_u 6.2500 (16.5625) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/25] time 0.159 (0.175) data 0.082 (0.098) loss_u loss_u 0.8589 (0.8542) acc_u 15.6250 (16.4583) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/25] time 0.164 (0.174) data 0.087 (0.097) loss_u loss_u 0.8545 (0.8640) acc_u 15.6250 (15.6250) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [25/25] time 0.168 (0.174) data 0.090 (0.097) loss_u loss_u 0.9141 (0.8757) acc_u 9.3750 (14.3750) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 411
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 807
clean true:796
clean false:11
clean_rate:0.9863692688971499
noisy true:409
noisy false:400
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 809
epoch [147/200] batch [5/25] time 0.175 (0.170) data 0.098 (0.093) loss_x loss_x 0.4722 (0.6202) acc_x 84.3750 (86.2500) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/25] time 0.171 (0.169) data 0.095 (0.093) loss_x loss_x 0.5557 (0.6091) acc_x 87.5000 (85.0000) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/25] time 0.181 (0.173) data 0.104 (0.096) loss_x loss_x 0.4221 (0.6107) acc_x 87.5000 (84.5833) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/25] time 0.173 (0.173) data 0.096 (0.096) loss_x loss_x 1.0684 (0.6380) acc_x 78.1250 (83.7500) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [25/25] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.5439 (0.6280) acc_x 90.6250 (84.5000) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/25] time 0.187 (0.175) data 0.110 (0.098) loss_u loss_u 0.8755 (0.8964) acc_u 12.5000 (10.6250) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/25] time 0.184 (0.176) data 0.106 (0.099) loss_u loss_u 0.8726 (0.8590) acc_u 12.5000 (15.9375) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/25] time 0.186 (0.177) data 0.108 (0.100) loss_u loss_u 0.8486 (0.8682) acc_u 18.7500 (15.2083) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/25] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.8721 (0.8710) acc_u 15.6250 (14.8438) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [25/25] time 0.184 (0.179) data 0.107 (0.101) loss_u loss_u 0.8604 (0.8671) acc_u 12.5000 (15.0000) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.4876, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 788
clean true:779
clean false:9
clean_rate:0.9885786802030457
noisy true:395
noisy false:433
after delete: len(clean_dataset) 788
after delete: len(noisy_dataset) 828
epoch [148/200] batch [5/24] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.4253 (0.6747) acc_x 90.6250 (81.8750) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/24] time 0.186 (0.183) data 0.110 (0.106) loss_x loss_x 0.4443 (0.6837) acc_x 81.2500 (80.3125) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/24] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.6567 (0.6132) acc_x 84.3750 (82.9167) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/24] time 0.186 (0.183) data 0.109 (0.107) loss_x loss_x 0.5361 (0.6167) acc_x 81.2500 (81.8750) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/25] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.8091 (0.8549) acc_u 21.8750 (16.8750) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/25] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9087 (0.8598) acc_u 9.3750 (15.9375) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/25] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.8325 (0.8562) acc_u 18.7500 (16.4583) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/25] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9048 (0.8494) acc_u 9.3750 (17.5000) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [25/25] time 0.186 (0.185) data 0.109 (0.107) loss_u loss_u 0.8667 (0.8517) acc_u 15.6250 (17.5000) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 389
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 813
clean true:807
clean false:6
clean_rate:0.992619926199262
noisy true:420
noisy false:383
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 803
epoch [149/200] batch [5/25] time 0.168 (0.183) data 0.091 (0.106) loss_x loss_x 0.3789 (0.5138) acc_x 87.5000 (86.2500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/25] time 0.176 (0.177) data 0.100 (0.100) loss_x loss_x 0.7124 (0.5402) acc_x 81.2500 (86.2500) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/25] time 0.160 (0.176) data 0.083 (0.100) loss_x loss_x 0.4744 (0.5882) acc_x 84.3750 (85.6250) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/25] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.2810 (0.5439) acc_x 93.7500 (86.2500) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [25/25] time 0.172 (0.176) data 0.095 (0.099) loss_x loss_x 0.6699 (0.5825) acc_x 81.2500 (84.2500) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/25] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.9600 (0.9157) acc_u 6.2500 (10.0000) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/25] time 0.172 (0.176) data 0.094 (0.099) loss_u loss_u 0.8813 (0.8957) acc_u 15.6250 (13.4375) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/25] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.7915 (0.8782) acc_u 25.0000 (15.0000) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/25] time 0.218 (0.175) data 0.141 (0.098) loss_u loss_u 0.8608 (0.8771) acc_u 15.6250 (14.8438) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [25/25] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.9570 (0.8861) acc_u 6.2500 (13.6250) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 436
confident_label rate tensor(0.4913, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 794
clean true:786
clean false:8
clean_rate:0.9899244332493703
noisy true:394
noisy false:428
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 822
epoch [150/200] batch [5/24] time 0.181 (0.174) data 0.104 (0.097) loss_x loss_x 0.7407 (0.6067) acc_x 81.2500 (84.3750) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/24] time 0.182 (0.175) data 0.104 (0.098) loss_x loss_x 0.7876 (0.6000) acc_x 75.0000 (83.7500) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/24] time 0.174 (0.174) data 0.097 (0.097) loss_x loss_x 0.3657 (0.5629) acc_x 93.7500 (85.6250) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/24] time 0.194 (0.175) data 0.118 (0.098) loss_x loss_x 0.7739 (0.5979) acc_x 81.2500 (85.3125) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/25] time 0.165 (0.173) data 0.088 (0.096) loss_u loss_u 0.8892 (0.8525) acc_u 15.6250 (16.8750) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/25] time 0.178 (0.173) data 0.101 (0.096) loss_u loss_u 0.8315 (0.8451) acc_u 18.7500 (17.1875) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/25] time 0.187 (0.174) data 0.108 (0.097) loss_u loss_u 0.8364 (0.8508) acc_u 18.7500 (16.8750) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/25] time 0.166 (0.175) data 0.087 (0.097) loss_u loss_u 0.8989 (0.8499) acc_u 18.7500 (17.6562) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [25/25] time 0.179 (0.176) data 0.101 (0.098) loss_u loss_u 0.8481 (0.8486) acc_u 18.7500 (17.6250) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 406
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:801
clean false:7
clean_rate:0.9913366336633663
noisy true:409
noisy false:399
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [151/200] batch [5/25] time 0.170 (0.172) data 0.093 (0.094) loss_x loss_x 0.6938 (0.7816) acc_x 81.2500 (78.1250) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/25] time 0.187 (0.178) data 0.110 (0.100) loss_x loss_x 0.2502 (0.6487) acc_x 93.7500 (83.1250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/25] time 0.188 (0.180) data 0.111 (0.103) loss_x loss_x 0.5103 (0.6385) acc_x 87.5000 (83.1250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/25] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.5366 (0.6146) acc_x 87.5000 (83.2812) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [25/25] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 1.1035 (0.6658) acc_x 84.3750 (82.7500) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/25] time 0.188 (0.183) data 0.110 (0.106) loss_u loss_u 0.8667 (0.8855) acc_u 15.6250 (13.7500) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/25] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9204 (0.8627) acc_u 12.5000 (16.5625) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/25] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9521 (0.8788) acc_u 6.2500 (14.5833) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/25] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.8223 (0.8727) acc_u 21.8750 (15.1562) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [25/25] time 0.177 (0.183) data 0.100 (0.106) loss_u loss_u 0.8379 (0.8673) acc_u 18.7500 (15.6250) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 445
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 806
clean true:796
clean false:10
clean_rate:0.9875930521091811
noisy true:375
noisy false:435
after delete: len(clean_dataset) 806
after delete: len(noisy_dataset) 810
epoch [152/200] batch [5/25] time 0.185 (0.175) data 0.109 (0.099) loss_x loss_x 0.4351 (0.4982) acc_x 87.5000 (87.5000) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/25] time 0.183 (0.179) data 0.107 (0.102) loss_x loss_x 0.3733 (0.5613) acc_x 90.6250 (86.2500) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/25] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 1.0703 (0.5878) acc_x 71.8750 (85.4167) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/25] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.8354 (0.6015) acc_x 78.1250 (85.3125) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [25/25] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.7612 (0.6135) acc_x 81.2500 (84.8750) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/25] time 0.163 (0.176) data 0.086 (0.100) loss_u loss_u 0.8931 (0.8710) acc_u 12.5000 (15.6250) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/25] time 0.163 (0.175) data 0.086 (0.098) loss_u loss_u 0.8125 (0.8715) acc_u 21.8750 (15.6250) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/25] time 0.180 (0.174) data 0.101 (0.097) loss_u loss_u 0.8511 (0.8658) acc_u 15.6250 (16.2500) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/25] time 0.180 (0.175) data 0.103 (0.098) loss_u loss_u 0.8965 (0.8667) acc_u 12.5000 (15.6250) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [25/25] time 0.181 (0.175) data 0.103 (0.098) loss_u loss_u 0.9316 (0.8669) acc_u 9.3750 (15.6250) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.4882, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 789
clean true:782
clean false:7
clean_rate:0.991128010139417
noisy true:396
noisy false:431
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 827
epoch [153/200] batch [5/24] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 0.8945 (0.6118) acc_x 78.1250 (86.8750) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/24] time 0.166 (0.179) data 0.089 (0.102) loss_x loss_x 0.4817 (0.5578) acc_x 81.2500 (85.9375) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/24] time 0.167 (0.175) data 0.090 (0.098) loss_x loss_x 0.2952 (0.5215) acc_x 96.8750 (87.5000) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/24] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.4075 (0.5066) acc_x 90.6250 (88.2812) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/25] time 0.160 (0.171) data 0.082 (0.094) loss_u loss_u 0.8765 (0.8463) acc_u 15.6250 (18.1250) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/25] time 0.167 (0.170) data 0.089 (0.092) loss_u loss_u 0.8394 (0.8647) acc_u 18.7500 (15.9375) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/25] time 0.158 (0.169) data 0.081 (0.092) loss_u loss_u 0.8354 (0.8634) acc_u 21.8750 (16.0417) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/25] time 0.166 (0.169) data 0.089 (0.092) loss_u loss_u 0.9136 (0.8657) acc_u 9.3750 (15.7812) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [25/25] time 0.186 (0.170) data 0.107 (0.092) loss_u loss_u 0.8589 (0.8655) acc_u 15.6250 (15.7500) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.5099, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 824
clean true:814
clean false:10
clean_rate:0.9878640776699029
noisy true:377
noisy false:415
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 792
epoch [154/200] batch [5/25] time 0.174 (0.179) data 0.097 (0.102) loss_x loss_x 0.7710 (0.6881) acc_x 81.2500 (83.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/25] time 0.191 (0.175) data 0.114 (0.098) loss_x loss_x 0.3455 (0.5912) acc_x 93.7500 (85.3125) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/25] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.8037 (0.6159) acc_x 71.8750 (83.7500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/25] time 0.180 (0.177) data 0.104 (0.100) loss_x loss_x 0.8740 (0.6163) acc_x 68.7500 (83.5938) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [25/25] time 0.186 (0.177) data 0.110 (0.100) loss_x loss_x 0.5093 (0.5828) acc_x 78.1250 (84.5000) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/24] time 0.183 (0.178) data 0.106 (0.102) loss_u loss_u 0.7979 (0.8793) acc_u 25.0000 (13.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/24] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8760 (0.8589) acc_u 12.5000 (17.1875) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/24] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.8857 (0.8702) acc_u 12.5000 (15.2083) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/24] time 0.163 (0.180) data 0.084 (0.103) loss_u loss_u 0.8091 (0.8717) acc_u 21.8750 (15.0000) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 401
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 813
clean true:803
clean false:10
clean_rate:0.9876998769987699
noisy true:412
noisy false:391
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 803
epoch [155/200] batch [5/25] time 0.173 (0.176) data 0.096 (0.100) loss_x loss_x 0.6826 (0.8524) acc_x 81.2500 (75.0000) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/25] time 0.167 (0.174) data 0.090 (0.097) loss_x loss_x 0.9805 (0.7604) acc_x 81.2500 (80.6250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/25] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.2732 (0.6949) acc_x 96.8750 (82.2917) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/25] time 0.187 (0.176) data 0.109 (0.099) loss_x loss_x 0.3513 (0.6654) acc_x 90.6250 (82.6562) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [25/25] time 0.196 (0.179) data 0.119 (0.101) loss_x loss_x 0.3301 (0.6437) acc_x 93.7500 (83.2500) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/25] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.9229 (0.8754) acc_u 9.3750 (15.0000) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/25] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.8892 (0.8773) acc_u 12.5000 (14.3750) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/25] time 0.161 (0.178) data 0.083 (0.101) loss_u loss_u 0.9277 (0.8680) acc_u 9.3750 (15.4167) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/25] time 0.164 (0.177) data 0.087 (0.100) loss_u loss_u 0.8418 (0.8681) acc_u 15.6250 (15.1562) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [25/25] time 0.165 (0.177) data 0.086 (0.100) loss_u loss_u 0.9062 (0.8706) acc_u 12.5000 (14.8750) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 424
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 806
clean true:796
clean false:10
clean_rate:0.9875930521091811
noisy true:396
noisy false:414
after delete: len(clean_dataset) 806
after delete: len(noisy_dataset) 810
epoch [156/200] batch [5/25] time 0.160 (0.181) data 0.083 (0.104) loss_x loss_x 0.7466 (0.6131) acc_x 81.2500 (85.6250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/25] time 0.177 (0.177) data 0.099 (0.100) loss_x loss_x 0.6069 (0.6636) acc_x 87.5000 (83.1250) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/25] time 0.190 (0.177) data 0.112 (0.100) loss_x loss_x 0.4111 (0.6431) acc_x 90.6250 (83.7500) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/25] time 0.187 (0.179) data 0.109 (0.102) loss_x loss_x 0.7212 (0.6085) acc_x 84.3750 (84.6875) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [25/25] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.8403 (0.6008) acc_x 78.1250 (84.5000) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/25] time 0.171 (0.181) data 0.094 (0.104) loss_u loss_u 0.7310 (0.8196) acc_u 31.2500 (21.8750) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/25] time 0.172 (0.180) data 0.095 (0.103) loss_u loss_u 0.8286 (0.8497) acc_u 18.7500 (17.5000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/25] time 0.188 (0.180) data 0.110 (0.103) loss_u loss_u 0.9141 (0.8599) acc_u 6.2500 (15.8333) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/25] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.8892 (0.8588) acc_u 12.5000 (15.9375) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [25/25] time 0.172 (0.178) data 0.094 (0.100) loss_u loss_u 0.8506 (0.8631) acc_u 18.7500 (15.6250) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 804
clean true:797
clean false:7
clean_rate:0.9912935323383084
noisy true:401
noisy false:411
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 812
epoch [157/200] batch [5/25] time 0.160 (0.174) data 0.083 (0.097) loss_x loss_x 0.4463 (0.6076) acc_x 90.6250 (86.2500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/25] time 0.167 (0.170) data 0.089 (0.092) loss_x loss_x 0.3508 (0.5970) acc_x 96.8750 (85.6250) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/25] time 0.169 (0.168) data 0.092 (0.090) loss_x loss_x 0.5176 (0.5943) acc_x 87.5000 (86.2500) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/25] time 0.196 (0.171) data 0.120 (0.093) loss_x loss_x 0.5259 (0.5683) acc_x 84.3750 (86.4062) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [25/25] time 0.185 (0.172) data 0.108 (0.095) loss_x loss_x 0.5693 (0.5887) acc_x 90.6250 (86.3750) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/25] time 0.178 (0.173) data 0.101 (0.096) loss_u loss_u 0.8433 (0.8787) acc_u 15.6250 (13.1250) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/25] time 0.175 (0.173) data 0.097 (0.096) loss_u loss_u 0.8550 (0.8417) acc_u 15.6250 (18.4375) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/25] time 0.161 (0.172) data 0.083 (0.095) loss_u loss_u 0.8101 (0.8450) acc_u 21.8750 (18.1250) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/25] time 0.179 (0.172) data 0.102 (0.095) loss_u loss_u 0.9072 (0.8569) acc_u 12.5000 (16.7188) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [25/25] time 0.172 (0.173) data 0.095 (0.095) loss_u loss_u 0.8618 (0.8645) acc_u 18.7500 (15.8750) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 402
confident_label rate tensor(0.5056, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 817
clean true:807
clean false:10
clean_rate:0.9877600979192166
noisy true:407
noisy false:392
after delete: len(clean_dataset) 817
after delete: len(noisy_dataset) 799
epoch [158/200] batch [5/25] time 0.185 (0.186) data 0.109 (0.110) loss_x loss_x 0.6147 (0.5857) acc_x 81.2500 (85.0000) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/25] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.3760 (0.5348) acc_x 93.7500 (87.5000) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/25] time 0.162 (0.183) data 0.085 (0.106) loss_x loss_x 0.6504 (0.5347) acc_x 81.2500 (86.8750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/25] time 0.197 (0.181) data 0.121 (0.105) loss_x loss_x 0.3433 (0.4994) acc_x 90.6250 (87.5000) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [25/25] time 0.185 (0.182) data 0.109 (0.105) loss_x loss_x 0.3098 (0.5229) acc_x 96.8750 (87.3750) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/24] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9009 (0.8562) acc_u 12.5000 (15.0000) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/24] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.7749 (0.8583) acc_u 25.0000 (15.6250) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/24] time 0.191 (0.183) data 0.115 (0.106) loss_u loss_u 0.9185 (0.8767) acc_u 9.3750 (14.3750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/24] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.7969 (0.8701) acc_u 21.8750 (15.0000) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.4913, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 794
clean true:784
clean false:10
clean_rate:0.9874055415617129
noisy true:390
noisy false:432
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 822
epoch [159/200] batch [5/24] time 0.174 (0.174) data 0.097 (0.097) loss_x loss_x 0.7012 (0.5400) acc_x 78.1250 (86.8750) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/24] time 0.172 (0.173) data 0.095 (0.096) loss_x loss_x 0.4792 (0.5720) acc_x 87.5000 (86.8750) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/24] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.9302 (0.5852) acc_x 75.0000 (85.4167) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/24] time 0.171 (0.174) data 0.094 (0.097) loss_x loss_x 0.6968 (0.5567) acc_x 84.3750 (86.8750) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/25] time 0.174 (0.173) data 0.097 (0.096) loss_u loss_u 0.7983 (0.8324) acc_u 28.1250 (21.2500) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/25] time 0.175 (0.174) data 0.097 (0.097) loss_u loss_u 0.8291 (0.8447) acc_u 18.7500 (19.0625) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/25] time 0.164 (0.174) data 0.087 (0.097) loss_u loss_u 0.8496 (0.8580) acc_u 15.6250 (17.0833) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/25] time 0.167 (0.174) data 0.090 (0.097) loss_u loss_u 0.8101 (0.8618) acc_u 21.8750 (16.4062) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [25/25] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.8003 (0.8604) acc_u 25.0000 (16.5000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 430
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 811
clean true:801
clean false:10
clean_rate:0.9876695437731196
noisy true:385
noisy false:420
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 805
epoch [160/200] batch [5/25] time 0.177 (0.172) data 0.099 (0.094) loss_x loss_x 0.8564 (0.5029) acc_x 78.1250 (87.5000) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/25] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.5542 (0.5655) acc_x 81.2500 (84.3750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/25] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.4849 (0.5355) acc_x 84.3750 (85.2083) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/25] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.5894 (0.5340) acc_x 87.5000 (86.2500) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [25/25] time 0.208 (0.182) data 0.131 (0.105) loss_x loss_x 0.8901 (0.5506) acc_x 78.1250 (86.1250) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/25] time 0.165 (0.181) data 0.088 (0.103) loss_u loss_u 0.9316 (0.8682) acc_u 6.2500 (13.7500) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/25] time 0.162 (0.178) data 0.085 (0.101) loss_u loss_u 0.8604 (0.8640) acc_u 18.7500 (15.0000) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/25] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.8428 (0.8604) acc_u 18.7500 (15.8333) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/25] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.9312 (0.8709) acc_u 9.3750 (14.8438) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [25/25] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.8760 (0.8713) acc_u 15.6250 (15.1250) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 405
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:798
clean false:10
clean_rate:0.9876237623762376
noisy true:413
noisy false:395
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [161/200] batch [5/25] time 0.191 (0.170) data 0.112 (0.093) loss_x loss_x 0.3423 (0.4080) acc_x 90.6250 (89.3750) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/25] time 0.173 (0.173) data 0.095 (0.096) loss_x loss_x 0.5220 (0.4697) acc_x 84.3750 (85.9375) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/25] time 0.169 (0.171) data 0.092 (0.094) loss_x loss_x 0.6450 (0.5020) acc_x 84.3750 (86.4583) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/25] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.4941 (0.5064) acc_x 78.1250 (85.9375) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [25/25] time 0.179 (0.173) data 0.103 (0.096) loss_x loss_x 1.1221 (0.5205) acc_x 71.8750 (85.7500) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/25] time 0.163 (0.174) data 0.085 (0.097) loss_u loss_u 0.8477 (0.8818) acc_u 18.7500 (14.3750) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/25] time 0.172 (0.173) data 0.094 (0.096) loss_u loss_u 0.7520 (0.8738) acc_u 28.1250 (14.6875) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/25] time 0.161 (0.173) data 0.084 (0.095) loss_u loss_u 0.8931 (0.8721) acc_u 12.5000 (15.4167) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/25] time 0.165 (0.172) data 0.088 (0.094) loss_u loss_u 0.8765 (0.8633) acc_u 15.6250 (16.5625) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [25/25] time 0.173 (0.171) data 0.094 (0.094) loss_u loss_u 0.8174 (0.8649) acc_u 21.8750 (16.6250) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 435
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 799
clean true:790
clean false:9
clean_rate:0.9887359198998749
noisy true:391
noisy false:426
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 817
epoch [162/200] batch [5/24] time 0.163 (0.174) data 0.086 (0.097) loss_x loss_x 0.3694 (0.5482) acc_x 87.5000 (85.6250) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/24] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.3689 (0.4850) acc_x 90.6250 (88.7500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/24] time 0.183 (0.176) data 0.105 (0.099) loss_x loss_x 0.5449 (0.5102) acc_x 87.5000 (87.7083) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/24] time 0.181 (0.177) data 0.103 (0.100) loss_x loss_x 0.3896 (0.5152) acc_x 84.3750 (87.1875) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/25] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.8076 (0.8566) acc_u 21.8750 (16.2500) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/25] time 0.182 (0.181) data 0.104 (0.103) loss_u loss_u 0.8418 (0.8608) acc_u 18.7500 (16.2500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/25] time 0.187 (0.181) data 0.109 (0.104) loss_u loss_u 0.8955 (0.8670) acc_u 15.6250 (15.6250) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/25] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.8550 (0.8636) acc_u 18.7500 (16.0938) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [25/25] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8291 (0.8643) acc_u 21.8750 (15.8750) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 799
clean true:790
clean false:9
clean_rate:0.9887359198998749
noisy true:423
noisy false:394
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 817
epoch [163/200] batch [5/24] time 0.182 (0.187) data 0.105 (0.110) loss_x loss_x 0.4783 (0.4655) acc_x 81.2500 (86.8750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/24] time 0.170 (0.181) data 0.094 (0.104) loss_x loss_x 0.4717 (0.5547) acc_x 84.3750 (84.3750) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/24] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.5776 (0.5253) acc_x 81.2500 (86.0417) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/24] time 0.187 (0.180) data 0.110 (0.103) loss_x loss_x 0.3218 (0.5312) acc_x 93.7500 (86.0938) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/25] time 0.187 (0.182) data 0.110 (0.104) loss_u loss_u 0.8730 (0.8729) acc_u 12.5000 (15.6250) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/25] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.7383 (0.8750) acc_u 31.2500 (15.0000) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/25] time 0.188 (0.183) data 0.111 (0.106) loss_u loss_u 0.7656 (0.8651) acc_u 25.0000 (15.8333) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/25] time 0.190 (0.183) data 0.112 (0.106) loss_u loss_u 0.8579 (0.8698) acc_u 18.7500 (15.4688) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [25/25] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8042 (0.8675) acc_u 21.8750 (15.6250) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 401
confident_label rate tensor(0.5074, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 820
clean true:812
clean false:8
clean_rate:0.9902439024390244
noisy true:403
noisy false:393
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 796
epoch [164/200] batch [5/25] time 0.185 (0.180) data 0.108 (0.102) loss_x loss_x 0.3000 (0.4165) acc_x 87.5000 (87.5000) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/25] time 0.188 (0.184) data 0.109 (0.106) loss_x loss_x 0.3074 (0.4391) acc_x 96.8750 (87.8125) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/25] time 0.187 (0.185) data 0.109 (0.107) loss_x loss_x 0.3550 (0.4840) acc_x 87.5000 (86.4583) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/25] time 0.190 (0.185) data 0.112 (0.107) loss_x loss_x 0.6802 (0.5280) acc_x 81.2500 (85.4688) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [25/25] time 0.175 (0.184) data 0.097 (0.106) loss_x loss_x 0.5933 (0.5454) acc_x 81.2500 (85.0000) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/24] time 0.192 (0.183) data 0.114 (0.105) loss_u loss_u 0.8926 (0.8623) acc_u 12.5000 (16.2500) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/24] time 0.178 (0.182) data 0.100 (0.104) loss_u loss_u 0.8887 (0.8647) acc_u 12.5000 (15.3125) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/24] time 0.171 (0.182) data 0.093 (0.104) loss_u loss_u 0.9648 (0.8718) acc_u 9.3750 (15.2083) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/24] time 0.185 (0.181) data 0.106 (0.103) loss_u loss_u 0.8228 (0.8799) acc_u 18.7500 (14.2188) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 456
confident_label rate tensor(0.4913, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 794
clean true:784
clean false:10
clean_rate:0.9874055415617129
noisy true:376
noisy false:446
after delete: len(clean_dataset) 794
after delete: len(noisy_dataset) 822
epoch [165/200] batch [5/24] time 0.214 (0.180) data 0.137 (0.102) loss_x loss_x 0.6846 (0.6064) acc_x 87.5000 (85.0000) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/24] time 0.164 (0.178) data 0.086 (0.100) loss_x loss_x 0.5254 (0.5643) acc_x 87.5000 (85.3125) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/24] time 0.171 (0.178) data 0.093 (0.101) loss_x loss_x 0.4631 (0.5762) acc_x 93.7500 (85.6250) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/24] time 0.161 (0.177) data 0.083 (0.100) loss_x loss_x 0.5840 (0.5576) acc_x 84.3750 (85.9375) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/25] time 0.187 (0.178) data 0.108 (0.101) loss_u loss_u 0.9326 (0.8806) acc_u 6.2500 (15.0000) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/25] time 0.186 (0.180) data 0.109 (0.102) loss_u loss_u 0.9009 (0.8754) acc_u 9.3750 (14.6875) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/25] time 0.190 (0.181) data 0.110 (0.103) loss_u loss_u 0.8848 (0.8810) acc_u 15.6250 (14.1667) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/25] time 0.176 (0.181) data 0.099 (0.104) loss_u loss_u 0.7734 (0.8676) acc_u 31.2500 (15.7812) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [25/25] time 0.167 (0.180) data 0.088 (0.103) loss_u loss_u 0.8652 (0.8612) acc_u 15.6250 (16.5000) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 445
confident_label rate tensor(0.4907, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 793
clean true:783
clean false:10
clean_rate:0.987389659520807
noisy true:388
noisy false:435
after delete: len(clean_dataset) 793
after delete: len(noisy_dataset) 823
epoch [166/200] batch [5/24] time 0.162 (0.169) data 0.085 (0.092) loss_x loss_x 0.3503 (0.4984) acc_x 90.6250 (85.6250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/24] time 0.182 (0.171) data 0.105 (0.094) loss_x loss_x 0.9419 (0.5339) acc_x 75.0000 (85.9375) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/24] time 0.177 (0.170) data 0.100 (0.093) loss_x loss_x 0.3008 (0.4986) acc_x 96.8750 (86.8750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/24] time 0.158 (0.168) data 0.081 (0.091) loss_x loss_x 0.6748 (0.5248) acc_x 78.1250 (85.7812) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/25] time 0.170 (0.171) data 0.093 (0.094) loss_u loss_u 0.7793 (0.8280) acc_u 25.0000 (20.0000) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/25] time 0.176 (0.172) data 0.099 (0.095) loss_u loss_u 0.7627 (0.8468) acc_u 28.1250 (17.8125) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/25] time 0.168 (0.171) data 0.091 (0.094) loss_u loss_u 0.8291 (0.8510) acc_u 21.8750 (17.0833) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/25] time 0.173 (0.172) data 0.096 (0.095) loss_u loss_u 0.7930 (0.8553) acc_u 21.8750 (16.5625) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [25/25] time 0.189 (0.173) data 0.112 (0.096) loss_u loss_u 0.7900 (0.8533) acc_u 25.0000 (16.6250) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.5093, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 823
clean true:815
clean false:8
clean_rate:0.9902794653705954
noisy true:398
noisy false:395
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 793
epoch [167/200] batch [5/25] time 0.188 (0.192) data 0.109 (0.115) loss_x loss_x 0.5747 (0.3827) acc_x 84.3750 (90.6250) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/25] time 0.160 (0.181) data 0.084 (0.104) loss_x loss_x 0.6260 (0.5082) acc_x 87.5000 (86.5625) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/25] time 0.185 (0.177) data 0.109 (0.100) loss_x loss_x 0.2979 (0.5028) acc_x 96.8750 (87.2917) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/25] time 0.171 (0.179) data 0.093 (0.102) loss_x loss_x 0.5591 (0.5180) acc_x 87.5000 (86.8750) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [25/25] time 0.190 (0.178) data 0.114 (0.101) loss_x loss_x 0.4546 (0.5268) acc_x 87.5000 (86.8750) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/24] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.8340 (0.8646) acc_u 18.7500 (15.0000) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/24] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.9243 (0.8748) acc_u 9.3750 (14.3750) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/24] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.9297 (0.8797) acc_u 9.3750 (13.7500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/24] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.7925 (0.8767) acc_u 25.0000 (14.5312) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.4994, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 807
clean true:800
clean false:7
clean_rate:0.9913258983890955
noisy true:384
noisy false:425
after delete: len(clean_dataset) 807
after delete: len(noisy_dataset) 809
epoch [168/200] batch [5/25] time 0.177 (0.170) data 0.099 (0.093) loss_x loss_x 0.5215 (0.5006) acc_x 81.2500 (86.8750) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/25] time 0.171 (0.175) data 0.093 (0.098) loss_x loss_x 0.7739 (0.6532) acc_x 78.1250 (82.8125) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/25] time 0.177 (0.172) data 0.098 (0.095) loss_x loss_x 0.7080 (0.6122) acc_x 84.3750 (84.1667) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/25] time 0.175 (0.174) data 0.098 (0.097) loss_x loss_x 0.7539 (0.6145) acc_x 84.3750 (84.5312) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [25/25] time 0.164 (0.174) data 0.086 (0.097) loss_x loss_x 0.3167 (0.5846) acc_x 90.6250 (85.0000) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/25] time 0.176 (0.175) data 0.098 (0.098) loss_u loss_u 0.8623 (0.8313) acc_u 15.6250 (18.1250) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/25] time 0.179 (0.175) data 0.101 (0.098) loss_u loss_u 0.9185 (0.8641) acc_u 9.3750 (14.3750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/25] time 0.173 (0.175) data 0.094 (0.098) loss_u loss_u 0.8091 (0.8601) acc_u 21.8750 (15.6250) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/25] time 0.168 (0.174) data 0.090 (0.097) loss_u loss_u 0.9243 (0.8765) acc_u 12.5000 (14.2188) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [25/25] time 0.174 (0.175) data 0.095 (0.098) loss_u loss_u 0.9062 (0.8774) acc_u 12.5000 (14.2500) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 438
confident_label rate tensor(0.4932, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 797
clean true:788
clean false:9
clean_rate:0.9887076537013801
noisy true:390
noisy false:429
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 819
epoch [169/200] batch [5/24] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.7715 (0.5337) acc_x 75.0000 (86.2500) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/24] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.5527 (0.4980) acc_x 93.7500 (88.1250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/24] time 0.160 (0.178) data 0.084 (0.101) loss_x loss_x 0.3909 (0.4908) acc_x 93.7500 (88.5417) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/24] time 0.178 (0.179) data 0.102 (0.102) loss_x loss_x 0.7637 (0.5292) acc_x 81.2500 (86.5625) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/25] time 0.179 (0.180) data 0.101 (0.103) loss_u loss_u 0.8037 (0.8334) acc_u 21.8750 (19.3750) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/25] time 0.177 (0.181) data 0.100 (0.104) loss_u loss_u 0.8979 (0.8565) acc_u 12.5000 (16.5625) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/25] time 0.191 (0.180) data 0.114 (0.103) loss_u loss_u 0.7070 (0.8531) acc_u 34.3750 (16.8750) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/25] time 0.168 (0.179) data 0.090 (0.101) loss_u loss_u 0.8511 (0.8533) acc_u 18.7500 (17.3438) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [25/25] time 0.173 (0.178) data 0.095 (0.101) loss_u loss_u 0.8589 (0.8548) acc_u 18.7500 (17.2500) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 415
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:800
clean false:8
clean_rate:0.9900990099009901
noisy true:401
noisy false:407
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [170/200] batch [5/25] time 0.166 (0.166) data 0.089 (0.089) loss_x loss_x 1.2988 (0.6714) acc_x 68.7500 (82.5000) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/25] time 0.168 (0.167) data 0.091 (0.090) loss_x loss_x 0.5771 (0.6061) acc_x 90.6250 (85.6250) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/25] time 0.166 (0.167) data 0.088 (0.090) loss_x loss_x 0.9282 (0.6281) acc_x 87.5000 (85.6250) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/25] time 0.170 (0.169) data 0.093 (0.092) loss_x loss_x 0.6670 (0.6004) acc_x 84.3750 (85.9375) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [25/25] time 0.185 (0.171) data 0.108 (0.094) loss_x loss_x 0.3445 (0.5917) acc_x 90.6250 (86.3750) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/25] time 0.169 (0.171) data 0.092 (0.094) loss_u loss_u 0.8955 (0.8292) acc_u 9.3750 (19.3750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/25] time 0.187 (0.170) data 0.109 (0.093) loss_u loss_u 0.8721 (0.8596) acc_u 15.6250 (15.9375) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/25] time 0.183 (0.172) data 0.105 (0.095) loss_u loss_u 0.7881 (0.8675) acc_u 25.0000 (15.0000) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/25] time 0.192 (0.174) data 0.114 (0.096) loss_u loss_u 0.8833 (0.8677) acc_u 12.5000 (14.8438) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [25/25] time 0.174 (0.175) data 0.096 (0.098) loss_u loss_u 0.8833 (0.8743) acc_u 12.5000 (14.0000) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 400
confident_label rate tensor(0.5099, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 824
clean true:817
clean false:7
clean_rate:0.991504854368932
noisy true:399
noisy false:393
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 792
epoch [171/200] batch [5/25] time 0.184 (0.194) data 0.108 (0.118) loss_x loss_x 0.7104 (0.5775) acc_x 87.5000 (88.1250) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/25] time 0.208 (0.192) data 0.132 (0.115) loss_x loss_x 0.4468 (0.5489) acc_x 93.7500 (88.7500) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/25] time 0.189 (0.190) data 0.112 (0.113) loss_x loss_x 0.4651 (0.5677) acc_x 90.6250 (87.2917) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/25] time 0.161 (0.186) data 0.085 (0.109) loss_x loss_x 1.0117 (0.5639) acc_x 81.2500 (87.5000) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [25/25] time 0.182 (0.186) data 0.105 (0.110) loss_x loss_x 0.7969 (0.5797) acc_x 84.3750 (86.7500) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/24] time 0.170 (0.187) data 0.093 (0.110) loss_u loss_u 0.8672 (0.8582) acc_u 12.5000 (16.8750) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/24] time 0.179 (0.185) data 0.103 (0.108) loss_u loss_u 0.8223 (0.8674) acc_u 21.8750 (15.3125) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/24] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.8467 (0.8732) acc_u 18.7500 (14.7917) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/24] time 0.176 (0.184) data 0.098 (0.107) loss_u loss_u 0.8394 (0.8876) acc_u 15.6250 (12.9688) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.4932, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 797
clean true:792
clean false:5
clean_rate:0.9937264742785445
noisy true:404
noisy false:415
after delete: len(clean_dataset) 797
after delete: len(noisy_dataset) 819
epoch [172/200] batch [5/24] time 0.169 (0.178) data 0.092 (0.100) loss_x loss_x 0.4089 (0.5347) acc_x 87.5000 (85.6250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/24] time 0.164 (0.172) data 0.088 (0.095) loss_x loss_x 0.8081 (0.5562) acc_x 78.1250 (85.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/24] time 0.172 (0.171) data 0.095 (0.094) loss_x loss_x 0.6958 (0.5230) acc_x 81.2500 (86.4583) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/24] time 0.182 (0.173) data 0.105 (0.096) loss_x loss_x 0.5254 (0.5339) acc_x 81.2500 (86.5625) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/25] time 0.189 (0.173) data 0.112 (0.096) loss_u loss_u 0.8237 (0.8569) acc_u 21.8750 (15.6250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/25] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.7954 (0.8589) acc_u 21.8750 (15.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/25] time 0.187 (0.176) data 0.108 (0.099) loss_u loss_u 0.8599 (0.8546) acc_u 18.7500 (16.2500) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/25] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.8701 (0.8553) acc_u 15.6250 (15.7812) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [25/25] time 0.183 (0.179) data 0.106 (0.101) loss_u loss_u 0.7744 (0.8522) acc_u 28.1250 (16.5000) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 437
confident_label rate tensor(0.4901, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 792
clean true:782
clean false:10
clean_rate:0.9873737373737373
noisy true:397
noisy false:427
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 824
epoch [173/200] batch [5/24] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.4602 (0.6149) acc_x 84.3750 (82.5000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/24] time 0.176 (0.178) data 0.099 (0.101) loss_x loss_x 0.6118 (0.6637) acc_x 87.5000 (82.8125) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/24] time 0.184 (0.179) data 0.108 (0.102) loss_x loss_x 0.5513 (0.6540) acc_x 81.2500 (83.3333) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/24] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.9575 (0.6506) acc_x 71.8750 (83.4375) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/25] time 0.184 (0.183) data 0.107 (0.105) loss_u loss_u 0.8452 (0.8474) acc_u 21.8750 (17.5000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/25] time 0.166 (0.181) data 0.088 (0.104) loss_u loss_u 0.8945 (0.8561) acc_u 12.5000 (16.5625) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/25] time 0.163 (0.179) data 0.085 (0.101) loss_u loss_u 0.8457 (0.8616) acc_u 18.7500 (16.0417) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/25] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.8052 (0.8591) acc_u 21.8750 (16.2500) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [25/25] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.8364 (0.8557) acc_u 21.8750 (16.7500) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 436
confident_label rate tensor(0.4901, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 792
clean true:787
clean false:5
clean_rate:0.9936868686868687
noisy true:393
noisy false:431
after delete: len(clean_dataset) 792
after delete: len(noisy_dataset) 824
epoch [174/200] batch [5/24] time 0.175 (0.169) data 0.096 (0.092) loss_x loss_x 0.4312 (0.5802) acc_x 81.2500 (84.3750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/24] time 0.171 (0.174) data 0.094 (0.097) loss_x loss_x 0.5386 (0.5477) acc_x 84.3750 (85.0000) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/24] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 1.0908 (0.5683) acc_x 81.2500 (85.8333) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/24] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 0.4302 (0.5528) acc_x 87.5000 (86.4062) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/25] time 0.176 (0.178) data 0.099 (0.100) loss_u loss_u 0.7764 (0.8378) acc_u 25.0000 (18.7500) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/25] time 0.167 (0.176) data 0.090 (0.099) loss_u loss_u 0.8960 (0.8439) acc_u 12.5000 (17.1875) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/25] time 0.175 (0.177) data 0.098 (0.099) loss_u loss_u 0.7891 (0.8391) acc_u 18.7500 (18.3333) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/25] time 0.176 (0.177) data 0.097 (0.100) loss_u loss_u 0.7646 (0.8431) acc_u 28.1250 (17.6562) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [25/25] time 0.177 (0.178) data 0.100 (0.100) loss_u loss_u 0.8916 (0.8469) acc_u 12.5000 (17.6250) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 802
clean true:794
clean false:8
clean_rate:0.9900249376558603
noisy true:400
noisy false:414
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 814
epoch [175/200] batch [5/25] time 0.169 (0.178) data 0.092 (0.102) loss_x loss_x 0.1956 (0.5363) acc_x 93.7500 (86.8750) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/25] time 0.160 (0.174) data 0.083 (0.098) loss_x loss_x 0.3699 (0.5291) acc_x 87.5000 (86.8750) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/25] time 0.170 (0.171) data 0.093 (0.094) loss_x loss_x 0.3181 (0.5266) acc_x 90.6250 (86.2500) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/25] time 0.170 (0.171) data 0.093 (0.094) loss_x loss_x 0.9341 (0.5615) acc_x 75.0000 (85.6250) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [25/25] time 0.166 (0.171) data 0.089 (0.095) loss_x loss_x 0.6733 (0.6102) acc_x 84.3750 (84.7500) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/25] time 0.160 (0.172) data 0.082 (0.095) loss_u loss_u 0.8623 (0.8846) acc_u 15.6250 (13.1250) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/25] time 0.178 (0.172) data 0.101 (0.095) loss_u loss_u 0.7666 (0.8552) acc_u 28.1250 (17.1875) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/25] time 0.162 (0.172) data 0.085 (0.095) loss_u loss_u 0.8804 (0.8705) acc_u 12.5000 (15.4167) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/25] time 0.169 (0.171) data 0.091 (0.094) loss_u loss_u 0.8823 (0.8702) acc_u 12.5000 (15.9375) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [25/25] time 0.176 (0.171) data 0.099 (0.094) loss_u loss_u 0.8374 (0.8661) acc_u 18.7500 (16.1250) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 806
clean true:798
clean false:8
clean_rate:0.9900744416873449
noisy true:415
noisy false:395
after delete: len(clean_dataset) 806
after delete: len(noisy_dataset) 810
epoch [176/200] batch [5/25] time 0.181 (0.176) data 0.105 (0.099) loss_x loss_x 0.3477 (0.5713) acc_x 90.6250 (84.3750) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/25] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.6821 (0.5426) acc_x 84.3750 (86.5625) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/25] time 0.181 (0.181) data 0.102 (0.103) loss_x loss_x 0.8267 (0.6028) acc_x 78.1250 (85.0000) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/25] time 0.173 (0.178) data 0.095 (0.101) loss_x loss_x 0.8125 (0.6079) acc_x 81.2500 (85.4688) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [25/25] time 0.160 (0.175) data 0.083 (0.098) loss_x loss_x 0.8115 (0.6216) acc_x 81.2500 (85.1250) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/25] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.8125 (0.8249) acc_u 18.7500 (20.0000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/25] time 0.179 (0.175) data 0.101 (0.098) loss_u loss_u 0.8223 (0.8537) acc_u 18.7500 (17.5000) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/25] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.9517 (0.8725) acc_u 6.2500 (15.6250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/25] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.8325 (0.8642) acc_u 18.7500 (16.8750) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [25/25] time 0.184 (0.178) data 0.106 (0.100) loss_u loss_u 0.8872 (0.8681) acc_u 12.5000 (16.3750) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:798
clean false:10
clean_rate:0.9876237623762376
noisy true:400
noisy false:408
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [177/200] batch [5/25] time 0.161 (0.172) data 0.084 (0.096) loss_x loss_x 0.6025 (0.6911) acc_x 87.5000 (83.7500) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/25] time 0.161 (0.166) data 0.084 (0.090) loss_x loss_x 1.1650 (0.6846) acc_x 75.0000 (84.0625) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/25] time 0.187 (0.168) data 0.110 (0.091) loss_x loss_x 0.7197 (0.6355) acc_x 84.3750 (85.4167) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/25] time 0.184 (0.172) data 0.107 (0.095) loss_x loss_x 0.5752 (0.6049) acc_x 81.2500 (85.7812) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [25/25] time 0.181 (0.173) data 0.104 (0.096) loss_x loss_x 0.8047 (0.5872) acc_x 75.0000 (85.5000) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/25] time 0.162 (0.173) data 0.083 (0.096) loss_u loss_u 0.8682 (0.8331) acc_u 18.7500 (20.0000) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/25] time 0.192 (0.174) data 0.114 (0.097) loss_u loss_u 0.9263 (0.8664) acc_u 9.3750 (15.3125) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/25] time 0.186 (0.175) data 0.108 (0.098) loss_u loss_u 0.8799 (0.8603) acc_u 12.5000 (16.2500) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/25] time 0.187 (0.176) data 0.110 (0.099) loss_u loss_u 0.8984 (0.8625) acc_u 9.3750 (15.4688) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [25/25] time 0.181 (0.176) data 0.103 (0.099) loss_u loss_u 0.9316 (0.8640) acc_u 6.2500 (15.3750) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 417
confident_label rate tensor(0.5043, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 815
clean true:806
clean false:9
clean_rate:0.9889570552147239
noisy true:393
noisy false:408
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 801
epoch [178/200] batch [5/25] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.6069 (0.6729) acc_x 84.3750 (85.0000) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/25] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.5396 (0.5836) acc_x 87.5000 (86.8750) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/25] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.2969 (0.5057) acc_x 90.6250 (88.1250) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/25] time 0.170 (0.181) data 0.093 (0.104) loss_x loss_x 0.5132 (0.5187) acc_x 87.5000 (87.9688) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [25/25] time 0.166 (0.179) data 0.090 (0.102) loss_x loss_x 0.3997 (0.5189) acc_x 90.6250 (87.5000) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/25] time 0.164 (0.177) data 0.087 (0.100) loss_u loss_u 0.8389 (0.8739) acc_u 15.6250 (14.3750) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/25] time 0.160 (0.175) data 0.082 (0.098) loss_u loss_u 0.9385 (0.8950) acc_u 6.2500 (12.1875) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/25] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9058 (0.8820) acc_u 12.5000 (13.9583) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/25] time 0.171 (0.175) data 0.094 (0.098) loss_u loss_u 0.8447 (0.8799) acc_u 18.7500 (14.0625) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [25/25] time 0.173 (0.175) data 0.096 (0.098) loss_u loss_u 0.8320 (0.8742) acc_u 18.7500 (15.0000) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 436
confident_label rate tensor(0.4981, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 805
clean true:797
clean false:8
clean_rate:0.9900621118012423
noisy true:383
noisy false:428
after delete: len(clean_dataset) 805
after delete: len(noisy_dataset) 811
epoch [179/200] batch [5/25] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8193 (0.6957) acc_x 71.8750 (80.0000) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/25] time 0.193 (0.184) data 0.116 (0.107) loss_x loss_x 0.3975 (0.6288) acc_x 90.6250 (83.7500) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/25] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.2134 (0.5500) acc_x 93.7500 (85.4167) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/25] time 0.170 (0.182) data 0.094 (0.105) loss_x loss_x 0.3015 (0.5766) acc_x 96.8750 (85.6250) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [25/25] time 0.191 (0.182) data 0.114 (0.105) loss_x loss_x 1.0918 (0.6044) acc_x 81.2500 (85.2500) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/25] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.9434 (0.8736) acc_u 6.2500 (13.7500) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/25] time 0.178 (0.181) data 0.099 (0.104) loss_u loss_u 0.8447 (0.8586) acc_u 18.7500 (15.6250) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/25] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.8677 (0.8676) acc_u 18.7500 (15.4167) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/25] time 0.196 (0.178) data 0.119 (0.101) loss_u loss_u 0.9312 (0.8765) acc_u 9.3750 (14.3750) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [25/25] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.7607 (0.8682) acc_u 28.1250 (15.3750) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 413
confident_label rate tensor(0.4963, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 802
clean true:795
clean false:7
clean_rate:0.9912718204488778
noisy true:408
noisy false:406
after delete: len(clean_dataset) 802
after delete: len(noisy_dataset) 814
epoch [180/200] batch [5/25] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.4551 (0.3802) acc_x 93.7500 (91.8750) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/25] time 0.171 (0.177) data 0.093 (0.100) loss_x loss_x 0.4355 (0.4573) acc_x 90.6250 (88.7500) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/25] time 0.167 (0.175) data 0.090 (0.098) loss_x loss_x 0.6738 (0.5000) acc_x 84.3750 (87.9167) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/25] time 0.182 (0.176) data 0.103 (0.099) loss_x loss_x 0.1445 (0.5267) acc_x 96.8750 (87.6562) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [25/25] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.7041 (0.5239) acc_x 78.1250 (87.6250) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/25] time 0.171 (0.174) data 0.094 (0.097) loss_u loss_u 0.9482 (0.9147) acc_u 6.2500 (10.6250) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/25] time 0.163 (0.174) data 0.085 (0.096) loss_u loss_u 0.8770 (0.8920) acc_u 15.6250 (12.5000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/25] time 0.163 (0.173) data 0.087 (0.095) loss_u loss_u 0.9102 (0.8706) acc_u 9.3750 (15.2083) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/25] time 0.181 (0.173) data 0.103 (0.096) loss_u loss_u 0.8667 (0.8717) acc_u 15.6250 (15.0000) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [25/25] time 0.186 (0.174) data 0.109 (0.097) loss_u loss_u 0.8999 (0.8659) acc_u 15.6250 (16.0000) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 394
confident_label rate tensor(0.5130, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 829
clean true:817
clean false:12
clean_rate:0.985524728588661
noisy true:405
noisy false:382
after delete: len(clean_dataset) 829
after delete: len(noisy_dataset) 787
epoch [181/200] batch [5/25] time 0.167 (0.180) data 0.090 (0.102) loss_x loss_x 0.4805 (0.6095) acc_x 87.5000 (86.2500) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/25] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.3149 (0.4785) acc_x 93.7500 (88.4375) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/25] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.6270 (0.5401) acc_x 81.2500 (86.6667) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/25] time 0.174 (0.174) data 0.098 (0.096) loss_x loss_x 0.5312 (0.5376) acc_x 87.5000 (86.8750) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [25/25] time 0.176 (0.176) data 0.099 (0.098) loss_x loss_x 0.6733 (0.5113) acc_x 87.5000 (87.7500) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/24] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.8926 (0.8667) acc_u 12.5000 (14.3750) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [10/24] time 0.175 (0.177) data 0.098 (0.100) loss_u loss_u 0.8887 (0.8800) acc_u 15.6250 (14.6875) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [15/24] time 0.164 (0.176) data 0.087 (0.099) loss_u loss_u 0.9028 (0.8793) acc_u 12.5000 (14.3750) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/24] time 0.171 (0.175) data 0.094 (0.097) loss_u loss_u 0.8867 (0.8842) acc_u 12.5000 (13.4375) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 406
confident_label rate tensor(0.5074, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 820
clean true:812
clean false:8
clean_rate:0.9902439024390244
noisy true:398
noisy false:398
after delete: len(clean_dataset) 820
after delete: len(noisy_dataset) 796
epoch [182/200] batch [5/25] time 0.167 (0.175) data 0.090 (0.099) loss_x loss_x 0.5264 (0.5890) acc_x 84.3750 (83.7500) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/25] time 0.180 (0.174) data 0.103 (0.098) loss_x loss_x 0.5493 (0.5589) acc_x 84.3750 (85.3125) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/25] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.3323 (0.5532) acc_x 90.6250 (85.0000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/25] time 0.189 (0.175) data 0.111 (0.099) loss_x loss_x 0.6406 (0.5511) acc_x 81.2500 (85.1562) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [25/25] time 0.176 (0.174) data 0.099 (0.098) loss_x loss_x 0.3662 (0.5442) acc_x 90.6250 (85.8750) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/24] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.8496 (0.8643) acc_u 21.8750 (16.8750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [10/24] time 0.180 (0.176) data 0.102 (0.099) loss_u loss_u 0.9561 (0.8773) acc_u 9.3750 (15.3125) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [15/24] time 0.189 (0.177) data 0.112 (0.100) loss_u loss_u 0.8486 (0.8732) acc_u 18.7500 (15.4167) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/24] time 0.180 (0.176) data 0.102 (0.099) loss_u loss_u 0.9058 (0.8797) acc_u 9.3750 (14.0625) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 408
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:801
clean false:7
clean_rate:0.9913366336633663
noisy true:407
noisy false:401
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [183/200] batch [5/25] time 0.188 (0.176) data 0.110 (0.099) loss_x loss_x 0.5400 (0.3883) acc_x 81.2500 (89.3750) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/25] time 0.168 (0.175) data 0.091 (0.098) loss_x loss_x 0.5542 (0.3772) acc_x 87.5000 (90.0000) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/25] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.4343 (0.3918) acc_x 87.5000 (90.2083) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/25] time 0.175 (0.175) data 0.098 (0.098) loss_x loss_x 0.3672 (0.4528) acc_x 90.6250 (88.7500) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [25/25] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.8711 (0.4830) acc_x 81.2500 (88.3750) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/25] time 0.181 (0.175) data 0.103 (0.098) loss_u loss_u 0.9526 (0.8535) acc_u 3.1250 (16.8750) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [10/25] time 0.187 (0.176) data 0.110 (0.099) loss_u loss_u 0.8657 (0.8562) acc_u 15.6250 (16.5625) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/25] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.8643 (0.8599) acc_u 15.6250 (16.4583) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/25] time 0.165 (0.175) data 0.087 (0.098) loss_u loss_u 0.8286 (0.8657) acc_u 21.8750 (15.7812) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [25/25] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.9023 (0.8694) acc_u 12.5000 (15.5000) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.4988, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 806
clean true:797
clean false:9
clean_rate:0.988833746898263
noisy true:394
noisy false:416
after delete: len(clean_dataset) 806
after delete: len(noisy_dataset) 810
epoch [184/200] batch [5/25] time 0.181 (0.177) data 0.103 (0.099) loss_x loss_x 0.6641 (0.6419) acc_x 81.2500 (83.7500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/25] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.1649 (0.5177) acc_x 96.8750 (87.5000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/25] time 0.190 (0.180) data 0.112 (0.103) loss_x loss_x 0.7358 (0.5123) acc_x 87.5000 (87.7083) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/25] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.5908 (0.5511) acc_x 81.2500 (86.4062) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [25/25] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 1.1377 (0.5660) acc_x 81.2500 (86.8750) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/25] time 0.192 (0.182) data 0.114 (0.105) loss_u loss_u 0.8569 (0.8923) acc_u 15.6250 (11.8750) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/25] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8877 (0.8715) acc_u 9.3750 (14.0625) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/25] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8525 (0.8706) acc_u 15.6250 (14.5833) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/25] time 0.191 (0.183) data 0.114 (0.105) loss_u loss_u 0.9077 (0.8708) acc_u 12.5000 (14.6875) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [25/25] time 0.162 (0.181) data 0.083 (0.104) loss_u loss_u 0.8950 (0.8674) acc_u 12.5000 (15.0000) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 415
confident_label rate tensor(0.4938, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 798
clean true:790
clean false:8
clean_rate:0.9899749373433584
noisy true:411
noisy false:407
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 818
epoch [185/200] batch [5/24] time 0.193 (0.169) data 0.117 (0.092) loss_x loss_x 0.5195 (0.5565) acc_x 84.3750 (86.2500) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/24] time 0.160 (0.168) data 0.083 (0.091) loss_x loss_x 0.5776 (0.6214) acc_x 87.5000 (83.7500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/24] time 0.186 (0.168) data 0.108 (0.091) loss_x loss_x 0.5371 (0.5838) acc_x 87.5000 (85.4167) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/24] time 0.172 (0.170) data 0.095 (0.094) loss_x loss_x 0.8203 (0.5945) acc_x 84.3750 (85.7812) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/25] time 0.167 (0.170) data 0.089 (0.093) loss_u loss_u 0.9302 (0.8476) acc_u 9.3750 (18.1250) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/25] time 0.161 (0.170) data 0.083 (0.093) loss_u loss_u 0.8306 (0.8428) acc_u 21.8750 (18.7500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/25] time 0.162 (0.169) data 0.085 (0.092) loss_u loss_u 0.8765 (0.8455) acc_u 18.7500 (18.3333) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/25] time 0.188 (0.169) data 0.110 (0.092) loss_u loss_u 0.8813 (0.8498) acc_u 12.5000 (17.9688) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [25/25] time 0.163 (0.168) data 0.085 (0.091) loss_u loss_u 0.8647 (0.8544) acc_u 18.7500 (17.5000) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 429
confident_label rate tensor(0.4938, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 798
clean true:792
clean false:6
clean_rate:0.9924812030075187
noisy true:395
noisy false:423
after delete: len(clean_dataset) 798
after delete: len(noisy_dataset) 818
epoch [186/200] batch [5/24] time 0.178 (0.181) data 0.101 (0.104) loss_x loss_x 0.8345 (0.6474) acc_x 78.1250 (84.3750) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/24] time 0.182 (0.182) data 0.105 (0.104) loss_x loss_x 0.7661 (0.5997) acc_x 78.1250 (85.0000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/24] time 0.171 (0.179) data 0.094 (0.102) loss_x loss_x 0.2261 (0.5790) acc_x 93.7500 (85.6250) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/24] time 0.167 (0.177) data 0.091 (0.100) loss_x loss_x 0.5474 (0.5801) acc_x 84.3750 (85.4688) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/25] time 0.183 (0.178) data 0.105 (0.100) loss_u loss_u 0.9380 (0.8730) acc_u 6.2500 (14.3750) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/25] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9185 (0.8768) acc_u 9.3750 (14.3750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/25] time 0.174 (0.177) data 0.095 (0.100) loss_u loss_u 0.8706 (0.8551) acc_u 15.6250 (16.6667) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/25] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.7402 (0.8529) acc_u 28.1250 (16.8750) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [25/25] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.8389 (0.8452) acc_u 18.7500 (17.7500) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 407
confident_label rate tensor(0.5093, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 823
clean true:811
clean false:12
clean_rate:0.9854191980558931
noisy true:398
noisy false:395
after delete: len(clean_dataset) 823
after delete: len(noisy_dataset) 793
epoch [187/200] batch [5/25] time 0.217 (0.186) data 0.140 (0.110) loss_x loss_x 0.4343 (0.5631) acc_x 78.1250 (83.7500) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/25] time 0.190 (0.192) data 0.111 (0.115) loss_x loss_x 0.2015 (0.5515) acc_x 96.8750 (85.9375) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/25] time 0.184 (0.190) data 0.107 (0.113) loss_x loss_x 0.3618 (0.5271) acc_x 87.5000 (86.6667) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/25] time 0.185 (0.189) data 0.108 (0.112) loss_x loss_x 0.3040 (0.5365) acc_x 90.6250 (86.8750) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [25/25] time 0.168 (0.186) data 0.092 (0.109) loss_x loss_x 0.6973 (0.5746) acc_x 81.2500 (86.0000) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/24] time 0.176 (0.184) data 0.098 (0.106) loss_u loss_u 0.9761 (0.9111) acc_u 3.1250 (9.3750) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/24] time 0.178 (0.183) data 0.100 (0.106) loss_u loss_u 0.8247 (0.8900) acc_u 18.7500 (12.1875) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [15/24] time 0.172 (0.182) data 0.094 (0.105) loss_u loss_u 0.7681 (0.8723) acc_u 25.0000 (14.1667) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/24] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.8389 (0.8749) acc_u 18.7500 (14.0625) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 408
confident_label rate tensor(0.4882, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 789
clean true:785
clean false:4
clean_rate:0.9949302915082383
noisy true:423
noisy false:404
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 827
epoch [188/200] batch [5/24] time 0.167 (0.169) data 0.091 (0.091) loss_x loss_x 0.4946 (0.5399) acc_x 87.5000 (85.0000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/24] time 0.187 (0.172) data 0.111 (0.095) loss_x loss_x 0.2153 (0.4646) acc_x 90.6250 (87.8125) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/24] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.5020 (0.4985) acc_x 90.6250 (87.5000) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/24] time 0.184 (0.171) data 0.106 (0.094) loss_x loss_x 0.5146 (0.5181) acc_x 78.1250 (87.0312) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/25] time 0.170 (0.173) data 0.093 (0.096) loss_u loss_u 0.9287 (0.8671) acc_u 9.3750 (14.3750) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/25] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9038 (0.8465) acc_u 12.5000 (17.1875) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/25] time 0.184 (0.175) data 0.106 (0.098) loss_u loss_u 0.9175 (0.8660) acc_u 6.2500 (14.7917) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/25] time 0.175 (0.176) data 0.096 (0.098) loss_u loss_u 0.8550 (0.8522) acc_u 18.7500 (16.4062) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [25/25] time 0.185 (0.176) data 0.108 (0.098) loss_u loss_u 0.8574 (0.8437) acc_u 15.6250 (17.3750) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 425
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 804
clean true:795
clean false:9
clean_rate:0.9888059701492538
noisy true:396
noisy false:416
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 812
epoch [189/200] batch [5/25] time 0.171 (0.183) data 0.095 (0.106) loss_x loss_x 0.5181 (0.5435) acc_x 87.5000 (85.0000) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/25] time 0.209 (0.189) data 0.132 (0.112) loss_x loss_x 0.4341 (0.4590) acc_x 93.7500 (89.0625) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/25] time 0.162 (0.180) data 0.085 (0.103) loss_x loss_x 0.6982 (0.5105) acc_x 78.1250 (86.8750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/25] time 0.189 (0.178) data 0.112 (0.101) loss_x loss_x 0.2664 (0.4921) acc_x 93.7500 (87.3438) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [25/25] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.6265 (0.5229) acc_x 87.5000 (87.0000) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/25] time 0.174 (0.178) data 0.097 (0.101) loss_u loss_u 0.9048 (0.8613) acc_u 9.3750 (15.0000) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/25] time 0.175 (0.177) data 0.097 (0.100) loss_u loss_u 0.8687 (0.8654) acc_u 15.6250 (15.3125) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [15/25] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.8569 (0.8618) acc_u 15.6250 (15.6250) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/25] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.8379 (0.8622) acc_u 18.7500 (15.7812) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [25/25] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8472 (0.8614) acc_u 18.7500 (15.7500) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 397
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 818
clean true:808
clean false:10
clean_rate:0.9877750611246944
noisy true:411
noisy false:387
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 798
epoch [190/200] batch [5/25] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.3538 (0.4503) acc_x 96.8750 (90.6250) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/25] time 0.186 (0.187) data 0.109 (0.109) loss_x loss_x 0.4695 (0.4802) acc_x 87.5000 (89.0625) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/25] time 0.188 (0.185) data 0.110 (0.108) loss_x loss_x 0.2842 (0.5138) acc_x 93.7500 (87.7083) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/25] time 0.179 (0.184) data 0.101 (0.106) loss_x loss_x 0.7080 (0.5109) acc_x 78.1250 (87.8125) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [25/25] time 0.190 (0.184) data 0.113 (0.107) loss_x loss_x 0.6006 (0.5512) acc_x 87.5000 (86.8750) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/24] time 0.180 (0.183) data 0.101 (0.106) loss_u loss_u 0.9077 (0.8611) acc_u 9.3750 (16.8750) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/24] time 0.188 (0.184) data 0.111 (0.106) loss_u loss_u 0.8813 (0.8545) acc_u 15.6250 (17.5000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/24] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.8892 (0.8581) acc_u 15.6250 (17.0833) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/24] time 0.172 (0.184) data 0.095 (0.106) loss_u loss_u 0.9116 (0.8595) acc_u 9.3750 (16.5625) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.5105, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 825
clean true:817
clean false:8
clean_rate:0.9903030303030304
noisy true:396
noisy false:395
after delete: len(clean_dataset) 825
after delete: len(noisy_dataset) 791
epoch [191/200] batch [5/25] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.8696 (0.5970) acc_x 71.8750 (82.5000) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/25] time 0.171 (0.177) data 0.095 (0.101) loss_x loss_x 0.5137 (0.6168) acc_x 87.5000 (82.8125) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/25] time 0.171 (0.173) data 0.094 (0.096) loss_x loss_x 0.9292 (0.6522) acc_x 71.8750 (81.8750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/25] time 0.166 (0.172) data 0.090 (0.095) loss_x loss_x 0.6680 (0.6141) acc_x 84.3750 (83.5938) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [25/25] time 0.166 (0.171) data 0.089 (0.095) loss_x loss_x 0.5142 (0.5945) acc_x 84.3750 (84.3750) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/24] time 0.172 (0.171) data 0.095 (0.094) loss_u loss_u 0.7681 (0.8654) acc_u 25.0000 (16.2500) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/24] time 0.186 (0.173) data 0.108 (0.096) loss_u loss_u 0.9414 (0.8867) acc_u 6.2500 (13.1250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/24] time 0.170 (0.173) data 0.092 (0.096) loss_u loss_u 0.8203 (0.8891) acc_u 18.7500 (12.2917) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/24] time 0.172 (0.173) data 0.094 (0.096) loss_u loss_u 0.8438 (0.8901) acc_u 18.7500 (12.3438) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 400
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:803
clean false:5
clean_rate:0.9938118811881188
noisy true:413
noisy false:395
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [192/200] batch [5/25] time 0.161 (0.169) data 0.084 (0.092) loss_x loss_x 0.4053 (0.4643) acc_x 90.6250 (90.6250) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/25] time 0.185 (0.173) data 0.107 (0.096) loss_x loss_x 0.6123 (0.4959) acc_x 81.2500 (89.0625) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/25] time 0.186 (0.177) data 0.109 (0.100) loss_x loss_x 0.3667 (0.5287) acc_x 90.6250 (87.0833) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/25] time 0.182 (0.178) data 0.104 (0.101) loss_x loss_x 0.6318 (0.5513) acc_x 84.3750 (86.7188) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [25/25] time 0.173 (0.177) data 0.096 (0.100) loss_x loss_x 0.4414 (0.5415) acc_x 90.6250 (86.8750) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/25] time 0.188 (0.177) data 0.109 (0.100) loss_u loss_u 0.8877 (0.9036) acc_u 12.5000 (11.8750) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/25] time 0.168 (0.177) data 0.090 (0.100) loss_u loss_u 0.9409 (0.9024) acc_u 6.2500 (10.9375) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/25] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.8540 (0.8821) acc_u 15.6250 (13.3333) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/25] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.8945 (0.8753) acc_u 12.5000 (13.7500) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [25/25] time 0.172 (0.176) data 0.094 (0.099) loss_u loss_u 0.9019 (0.8679) acc_u 12.5000 (15.0000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 424
confident_label rate tensor(0.5031, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 813
clean true:802
clean false:11
clean_rate:0.986469864698647
noisy true:390
noisy false:413
after delete: len(clean_dataset) 813
after delete: len(noisy_dataset) 803
epoch [193/200] batch [5/25] time 0.179 (0.180) data 0.102 (0.104) loss_x loss_x 0.3530 (0.4897) acc_x 90.6250 (86.2500) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/25] time 0.223 (0.185) data 0.146 (0.108) loss_x loss_x 0.5137 (0.4932) acc_x 87.5000 (85.9375) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/25] time 0.171 (0.182) data 0.094 (0.105) loss_x loss_x 0.2910 (0.4878) acc_x 90.6250 (86.4583) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/25] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.4973 (0.5221) acc_x 87.5000 (86.2500) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [25/25] time 0.184 (0.181) data 0.107 (0.105) loss_x loss_x 0.5210 (0.5307) acc_x 87.5000 (86.1250) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/25] time 0.159 (0.180) data 0.082 (0.103) loss_u loss_u 0.8926 (0.8354) acc_u 15.6250 (19.3750) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/25] time 0.167 (0.179) data 0.089 (0.102) loss_u loss_u 0.9028 (0.8542) acc_u 9.3750 (16.5625) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/25] time 0.171 (0.178) data 0.092 (0.101) loss_u loss_u 0.9292 (0.8602) acc_u 9.3750 (16.2500) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/25] time 0.190 (0.178) data 0.110 (0.101) loss_u loss_u 0.9385 (0.8640) acc_u 6.2500 (15.6250) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [25/25] time 0.173 (0.178) data 0.095 (0.101) loss_u loss_u 0.8540 (0.8626) acc_u 18.7500 (15.8750) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 419
confident_label rate tensor(0.5099, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 824
clean true:809
clean false:15
clean_rate:0.9817961165048543
noisy true:388
noisy false:404
after delete: len(clean_dataset) 824
after delete: len(noisy_dataset) 792
epoch [194/200] batch [5/25] time 0.186 (0.186) data 0.106 (0.107) loss_x loss_x 0.8867 (0.6304) acc_x 81.2500 (84.3750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/25] time 0.188 (0.187) data 0.111 (0.109) loss_x loss_x 0.3909 (0.5685) acc_x 93.7500 (85.6250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/25] time 0.188 (0.187) data 0.110 (0.109) loss_x loss_x 0.5601 (0.5969) acc_x 78.1250 (84.5833) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/25] time 0.181 (0.187) data 0.104 (0.109) loss_x loss_x 0.6816 (0.5752) acc_x 84.3750 (85.3125) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [25/25] time 0.186 (0.186) data 0.108 (0.109) loss_x loss_x 0.5850 (0.5829) acc_x 81.2500 (85.0000) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/24] time 0.183 (0.186) data 0.105 (0.109) loss_u loss_u 0.8970 (0.8714) acc_u 12.5000 (14.3750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/24] time 0.173 (0.184) data 0.096 (0.106) loss_u loss_u 0.8848 (0.8658) acc_u 15.6250 (15.3125) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [15/24] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.9297 (0.8715) acc_u 9.3750 (15.2083) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/24] time 0.176 (0.183) data 0.099 (0.106) loss_u loss_u 0.8311 (0.8684) acc_u 21.8750 (15.7812) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 412
confident_label rate tensor(0.5019, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 811
clean true:803
clean false:8
clean_rate:0.9901356350184957
noisy true:401
noisy false:404
after delete: len(clean_dataset) 811
after delete: len(noisy_dataset) 805
epoch [195/200] batch [5/25] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.8252 (0.6961) acc_x 78.1250 (81.8750) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/25] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.2830 (0.6495) acc_x 90.6250 (84.0625) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/25] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.3818 (0.6646) acc_x 90.6250 (83.1250) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/25] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8955 (0.6339) acc_x 84.3750 (84.2188) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [25/25] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5596 (0.6375) acc_x 90.6250 (84.8750) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/25] time 0.184 (0.184) data 0.108 (0.107) loss_u loss_u 0.8887 (0.8706) acc_u 12.5000 (15.0000) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [10/25] time 0.180 (0.184) data 0.103 (0.107) loss_u loss_u 0.8135 (0.8605) acc_u 21.8750 (16.2500) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/25] time 0.171 (0.182) data 0.094 (0.105) loss_u loss_u 0.8789 (0.8597) acc_u 15.6250 (16.2500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/25] time 0.176 (0.181) data 0.098 (0.104) loss_u loss_u 0.8623 (0.8610) acc_u 18.7500 (15.7812) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [25/25] time 0.174 (0.180) data 0.096 (0.103) loss_u loss_u 0.7744 (0.8643) acc_u 25.0000 (15.6250) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 412
confident_label rate tensor(0.4957, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 801
clean true:795
clean false:6
clean_rate:0.9925093632958801
noisy true:409
noisy false:406
after delete: len(clean_dataset) 801
after delete: len(noisy_dataset) 815
epoch [196/200] batch [5/25] time 0.162 (0.165) data 0.085 (0.089) loss_x loss_x 0.5264 (0.5102) acc_x 84.3750 (88.1250) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/25] time 0.176 (0.168) data 0.099 (0.091) loss_x loss_x 0.4607 (0.5656) acc_x 93.7500 (86.5625) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/25] time 0.163 (0.170) data 0.086 (0.093) loss_x loss_x 0.3794 (0.5478) acc_x 90.6250 (86.0417) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/25] time 0.164 (0.169) data 0.087 (0.092) loss_x loss_x 0.6357 (0.5389) acc_x 78.1250 (86.0938) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [25/25] time 0.169 (0.169) data 0.092 (0.092) loss_x loss_x 0.7705 (0.5486) acc_x 75.0000 (85.1250) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/25] time 0.175 (0.169) data 0.097 (0.092) loss_u loss_u 0.9019 (0.8968) acc_u 9.3750 (11.2500) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [10/25] time 0.177 (0.171) data 0.100 (0.094) loss_u loss_u 0.9170 (0.9007) acc_u 12.5000 (12.1875) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/25] time 0.188 (0.171) data 0.110 (0.094) loss_u loss_u 0.7915 (0.8824) acc_u 28.1250 (13.9583) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/25] time 0.172 (0.171) data 0.095 (0.094) loss_u loss_u 0.7764 (0.8729) acc_u 28.1250 (15.0000) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [25/25] time 0.193 (0.173) data 0.115 (0.095) loss_u loss_u 0.8257 (0.8653) acc_u 21.8750 (15.8750) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 445
confident_label rate tensor(0.4944, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 799
clean true:786
clean false:13
clean_rate:0.983729662077597
noisy true:385
noisy false:432
after delete: len(clean_dataset) 799
after delete: len(noisy_dataset) 817
epoch [197/200] batch [5/24] time 0.165 (0.166) data 0.086 (0.089) loss_x loss_x 0.6167 (0.5771) acc_x 87.5000 (86.8750) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/24] time 0.182 (0.168) data 0.105 (0.091) loss_x loss_x 0.4202 (0.5944) acc_x 84.3750 (85.3125) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/24] time 0.183 (0.173) data 0.106 (0.096) loss_x loss_x 0.2900 (0.5193) acc_x 93.7500 (87.2917) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/24] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.9658 (0.5909) acc_x 68.7500 (84.8438) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/25] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.7842 (0.8315) acc_u 25.0000 (18.7500) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [10/25] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9688 (0.8339) acc_u 3.1250 (18.7500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [15/25] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.8306 (0.8501) acc_u 18.7500 (16.6667) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/25] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.8794 (0.8472) acc_u 15.6250 (17.3438) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [25/25] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.9268 (0.8519) acc_u 9.3750 (17.2500) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 427
confident_label rate tensor(0.4975, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 804
clean true:794
clean false:10
clean_rate:0.9875621890547264
noisy true:395
noisy false:417
after delete: len(clean_dataset) 804
after delete: len(noisy_dataset) 812
epoch [198/200] batch [5/25] time 0.188 (0.186) data 0.112 (0.110) loss_x loss_x 0.5225 (0.5682) acc_x 87.5000 (87.5000) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/25] time 0.188 (0.187) data 0.109 (0.110) loss_x loss_x 0.6763 (0.6026) acc_x 87.5000 (85.6250) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/25] time 0.184 (0.187) data 0.108 (0.110) loss_x loss_x 0.5718 (0.6097) acc_x 87.5000 (85.2083) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/25] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.6987 (0.5723) acc_x 78.1250 (85.3125) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [25/25] time 0.185 (0.187) data 0.107 (0.109) loss_x loss_x 0.3862 (0.5573) acc_x 90.6250 (85.6250) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/25] time 0.184 (0.186) data 0.107 (0.108) loss_u loss_u 0.7852 (0.8534) acc_u 25.0000 (16.8750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [10/25] time 0.191 (0.185) data 0.114 (0.108) loss_u loss_u 0.9009 (0.8720) acc_u 12.5000 (14.6875) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [15/25] time 0.170 (0.184) data 0.092 (0.107) loss_u loss_u 0.8428 (0.8651) acc_u 15.6250 (15.2083) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/25] time 0.169 (0.182) data 0.092 (0.105) loss_u loss_u 0.7603 (0.8602) acc_u 28.1250 (15.9375) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [25/25] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.9067 (0.8649) acc_u 9.3750 (15.3750) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 407
confident_label rate tensor(0.5087, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 822
clean true:812
clean false:10
clean_rate:0.9878345498783455
noisy true:397
noisy false:397
after delete: len(clean_dataset) 822
after delete: len(noisy_dataset) 794
epoch [199/200] batch [5/25] time 0.174 (0.181) data 0.097 (0.104) loss_x loss_x 0.4502 (0.4985) acc_x 87.5000 (86.2500) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/25] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.5117 (0.6078) acc_x 90.6250 (85.0000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/25] time 0.173 (0.180) data 0.096 (0.103) loss_x loss_x 0.8389 (0.6493) acc_x 78.1250 (84.1667) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/25] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.2422 (0.6366) acc_x 93.7500 (84.3750) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [25/25] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.6060 (0.6302) acc_x 87.5000 (84.5000) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/24] time 0.181 (0.177) data 0.103 (0.099) loss_u loss_u 0.8672 (0.8586) acc_u 18.7500 (16.8750) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [10/24] time 0.178 (0.177) data 0.100 (0.100) loss_u loss_u 0.8262 (0.8614) acc_u 18.7500 (15.6250) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/24] time 0.178 (0.177) data 0.100 (0.099) loss_u loss_u 0.8140 (0.8658) acc_u 21.8750 (15.4167) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/24] time 0.175 (0.177) data 0.098 (0.099) loss_u loss_u 0.8726 (0.8624) acc_u 12.5000 (15.4688) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 398
confident_label rate tensor(0.5037, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 814
clean true:805
clean false:9
clean_rate:0.9889434889434889
noisy true:413
noisy false:389
after delete: len(clean_dataset) 814
after delete: len(noisy_dataset) 802
epoch [200/200] batch [5/25] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.3162 (0.4844) acc_x 90.6250 (89.3750) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/25] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.1704 (0.4031) acc_x 96.8750 (90.3125) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/25] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.5718 (0.4562) acc_x 87.5000 (89.3750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/25] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.5820 (0.4836) acc_x 87.5000 (88.5938) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [25/25] time 0.183 (0.182) data 0.105 (0.105) loss_x loss_x 0.3936 (0.5064) acc_x 93.7500 (87.7500) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/25] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.9155 (0.8392) acc_u 9.3750 (16.8750) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/25] time 0.175 (0.181) data 0.098 (0.104) loss_u loss_u 0.8306 (0.8424) acc_u 18.7500 (17.5000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/25] time 0.175 (0.181) data 0.098 (0.103) loss_u loss_u 0.9614 (0.8583) acc_u 3.1250 (15.6250) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/25] time 0.171 (0.180) data 0.092 (0.103) loss_u loss_u 0.8921 (0.8679) acc_u 15.6250 (14.8438) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [25/25] time 0.173 (0.180) data 0.093 (0.102) loss_u loss_u 0.8623 (0.8693) acc_u 15.6250 (14.7500) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_sym_0.375/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,748
* accuracy: 72.6%
* error: 27.4%
* macro_f1: 70.8%
Elapsed: 0:58:45
