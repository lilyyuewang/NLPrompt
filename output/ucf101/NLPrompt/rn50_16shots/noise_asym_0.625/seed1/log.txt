***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.625', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.625
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.1343, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 217
clean true:189
clean false:28
clean_rate:0.8709677419354839
noisy true:323
noisy false:1076
after delete: len(clean_dataset) 217
after delete: len(noisy_dataset) 1399
epoch [1/200] batch [5/6] time 0.184 (0.203) data 0.106 (0.107) loss_x loss_x 2.6152 (2.5594) acc_x 56.2500 (50.6250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/43] time 0.193 (0.197) data 0.116 (0.109) loss_u loss_u 0.9707 (0.9749) acc_u 6.2500 (5.6250) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [10/43] time 0.188 (0.194) data 0.110 (0.109) loss_u loss_u 0.9722 (0.9723) acc_u 3.1250 (6.8750) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [15/43] time 0.177 (0.191) data 0.100 (0.108) loss_u loss_u 0.9785 (0.9716) acc_u 6.2500 (6.2500) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [20/43] time 0.174 (0.189) data 0.096 (0.107) loss_u loss_u 0.9487 (0.9699) acc_u 15.6250 (6.7188) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [25/43] time 0.186 (0.187) data 0.109 (0.106) loss_u loss_u 0.9819 (0.9694) acc_u 6.2500 (7.0000) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [30/43] time 0.180 (0.187) data 0.103 (0.106) loss_u loss_u 0.9883 (0.9697) acc_u 0.0000 (6.5625) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [35/43] time 0.197 (0.186) data 0.120 (0.106) loss_u loss_u 0.9766 (0.9694) acc_u 6.2500 (6.8750) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [40/43] time 0.175 (0.185) data 0.096 (0.106) loss_u loss_u 0.9658 (0.9689) acc_u 9.3750 (7.1094) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1024
confident_label rate tensor(0.1473, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 238
clean true:218
clean false:20
clean_rate:0.9159663865546218
noisy true:374
noisy false:1004
after delete: len(clean_dataset) 238
after delete: len(noisy_dataset) 1378
epoch [2/200] batch [5/7] time 0.175 (0.181) data 0.097 (0.103) loss_x loss_x 1.0791 (1.4651) acc_x 75.0000 (67.5000) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/43] time 0.178 (0.178) data 0.101 (0.100) loss_u loss_u 0.9248 (0.9285) acc_u 12.5000 (11.8750) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [10/43] time 0.178 (0.177) data 0.101 (0.100) loss_u loss_u 0.9058 (0.9261) acc_u 12.5000 (11.2500) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [15/43] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.9292 (0.9206) acc_u 6.2500 (10.6250) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [20/43] time 0.197 (0.180) data 0.117 (0.102) loss_u loss_u 0.9419 (0.9152) acc_u 6.2500 (11.4062) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [25/43] time 0.197 (0.181) data 0.118 (0.103) loss_u loss_u 0.8613 (0.9068) acc_u 15.6250 (12.0000) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [30/43] time 0.194 (0.182) data 0.116 (0.105) loss_u loss_u 0.8657 (0.9097) acc_u 15.6250 (11.4583) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [35/43] time 0.209 (0.184) data 0.132 (0.106) loss_u loss_u 0.8916 (0.9058) acc_u 12.5000 (11.8750) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [40/43] time 0.192 (0.185) data 0.115 (0.107) loss_u loss_u 0.8936 (0.9058) acc_u 9.3750 (11.9531) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 788
confident_label rate tensor(0.2129, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 344
clean true:325
clean false:19
clean_rate:0.9447674418604651
noisy true:503
noisy false:769
after delete: len(clean_dataset) 344
after delete: len(noisy_dataset) 1272
epoch [3/200] batch [5/10] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 1.1230 (1.0680) acc_x 75.0000 (71.8750) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [10/10] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 1.3545 (1.1756) acc_x 59.3750 (67.5000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/39] time 0.190 (0.186) data 0.113 (0.109) loss_u loss_u 0.9297 (0.9421) acc_u 3.1250 (5.0000) lr 1.9999e-03 eta 0:00:06
epoch [3/200] batch [10/39] time 0.187 (0.187) data 0.109 (0.110) loss_u loss_u 0.8525 (0.9345) acc_u 15.6250 (6.8750) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [15/39] time 0.186 (0.190) data 0.109 (0.113) loss_u loss_u 0.9766 (0.9330) acc_u 3.1250 (7.7083) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [20/39] time 0.184 (0.189) data 0.107 (0.112) loss_u loss_u 0.9043 (0.9273) acc_u 12.5000 (8.4375) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [25/39] time 0.184 (0.189) data 0.106 (0.111) loss_u loss_u 0.9067 (0.9264) acc_u 9.3750 (8.3750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [30/39] time 0.185 (0.189) data 0.107 (0.111) loss_u loss_u 0.9375 (0.9274) acc_u 9.3750 (8.3333) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [35/39] time 0.183 (0.188) data 0.106 (0.111) loss_u loss_u 0.9819 (0.9313) acc_u 0.0000 (7.6786) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 839
confident_label rate tensor(0.1986, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 321
clean true:299
clean false:22
clean_rate:0.9314641744548287
noisy true:478
noisy false:817
after delete: len(clean_dataset) 321
after delete: len(noisy_dataset) 1295
epoch [4/200] batch [5/10] time 0.177 (0.175) data 0.101 (0.099) loss_x loss_x 0.7051 (0.9912) acc_x 84.3750 (75.0000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [10/10] time 0.174 (0.176) data 0.096 (0.099) loss_x loss_x 0.9111 (0.9688) acc_x 75.0000 (75.0000) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/40] time 0.183 (0.176) data 0.106 (0.098) loss_u loss_u 0.8755 (0.8952) acc_u 15.6250 (11.8750) lr 1.9995e-03 eta 0:00:06
epoch [4/200] batch [10/40] time 0.165 (0.174) data 0.088 (0.096) loss_u loss_u 0.9551 (0.9121) acc_u 6.2500 (10.0000) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [15/40] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.8823 (0.9149) acc_u 15.6250 (9.3750) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [20/40] time 0.184 (0.176) data 0.107 (0.098) loss_u loss_u 0.8877 (0.9207) acc_u 15.6250 (8.7500) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [25/40] time 0.187 (0.177) data 0.110 (0.100) loss_u loss_u 0.9731 (0.9204) acc_u 3.1250 (8.6250) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [30/40] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9751 (0.9223) acc_u 0.0000 (8.2292) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [35/40] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8599 (0.9208) acc_u 18.7500 (8.6607) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [40/40] time 0.185 (0.180) data 0.107 (0.102) loss_u loss_u 0.9336 (0.9203) acc_u 9.3750 (8.7500) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 816
confident_label rate tensor(0.2092, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 338
clean true:314
clean false:24
clean_rate:0.9289940828402367
noisy true:486
noisy false:792
after delete: len(clean_dataset) 338
after delete: len(noisy_dataset) 1278
epoch [5/200] batch [5/10] time 0.177 (0.187) data 0.100 (0.110) loss_x loss_x 1.0811 (0.9970) acc_x 81.2500 (73.7500) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [10/10] time 0.177 (0.184) data 0.100 (0.107) loss_x loss_x 1.5957 (1.0570) acc_x 59.3750 (73.4375) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/39] time 0.167 (0.182) data 0.091 (0.105) loss_u loss_u 0.9487 (0.9370) acc_u 6.2500 (6.8750) lr 1.9989e-03 eta 0:00:06
epoch [5/200] batch [10/39] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.9414 (0.9240) acc_u 9.3750 (9.6875) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [15/39] time 0.175 (0.181) data 0.096 (0.103) loss_u loss_u 0.9854 (0.9175) acc_u 0.0000 (10.2083) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [20/39] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.9336 (0.9173) acc_u 9.3750 (10.6250) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [25/39] time 0.170 (0.178) data 0.092 (0.101) loss_u loss_u 0.9536 (0.9264) acc_u 3.1250 (9.3750) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [30/39] time 0.165 (0.176) data 0.087 (0.099) loss_u loss_u 0.9351 (0.9232) acc_u 9.3750 (9.6875) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [35/39] time 0.165 (0.175) data 0.088 (0.097) loss_u loss_u 0.9771 (0.9258) acc_u 3.1250 (9.1964) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 766
confident_label rate tensor(0.2358, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 381
clean true:350
clean false:31
clean_rate:0.9186351706036745
noisy true:500
noisy false:735
after delete: len(clean_dataset) 381
after delete: len(noisy_dataset) 1235
epoch [6/200] batch [5/11] time 0.185 (0.185) data 0.107 (0.107) loss_x loss_x 1.1182 (1.1578) acc_x 59.3750 (72.5000) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/11] time 0.183 (0.185) data 0.107 (0.107) loss_x loss_x 1.0410 (1.0170) acc_x 78.1250 (72.8125) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/38] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9360 (0.9317) acc_u 12.5000 (9.3750) lr 1.9980e-03 eta 0:00:06
epoch [6/200] batch [10/38] time 0.183 (0.184) data 0.106 (0.106) loss_u loss_u 0.8960 (0.9362) acc_u 12.5000 (8.1250) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [15/38] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9551 (0.9365) acc_u 3.1250 (8.1250) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [20/38] time 0.181 (0.184) data 0.104 (0.106) loss_u loss_u 0.9126 (0.9376) acc_u 15.6250 (7.8125) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [25/38] time 0.185 (0.184) data 0.108 (0.106) loss_u loss_u 0.9116 (0.9317) acc_u 9.3750 (8.3750) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [30/38] time 0.170 (0.184) data 0.093 (0.107) loss_u loss_u 0.9707 (0.9345) acc_u 3.1250 (7.9167) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [35/38] time 0.173 (0.184) data 0.095 (0.107) loss_u loss_u 0.9312 (0.9348) acc_u 15.6250 (7.9464) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 783
confident_label rate tensor(0.2308, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 373
clean true:345
clean false:28
clean_rate:0.9249329758713136
noisy true:488
noisy false:755
after delete: len(clean_dataset) 373
after delete: len(noisy_dataset) 1243
epoch [7/200] batch [5/11] time 0.182 (0.187) data 0.106 (0.109) loss_x loss_x 1.2422 (1.1061) acc_x 62.5000 (72.5000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/11] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 1.0117 (1.2201) acc_x 78.1250 (70.9375) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/38] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9863 (0.9532) acc_u 0.0000 (2.5000) lr 1.9969e-03 eta 0:00:06
epoch [7/200] batch [10/38] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.9229 (0.9419) acc_u 9.3750 (4.6875) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [15/38] time 0.171 (0.180) data 0.094 (0.103) loss_u loss_u 0.9399 (0.9383) acc_u 6.2500 (5.6250) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [20/38] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.9326 (0.9365) acc_u 12.5000 (6.5625) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [25/38] time 0.202 (0.179) data 0.125 (0.102) loss_u loss_u 0.9634 (0.9384) acc_u 3.1250 (6.3750) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [30/38] time 0.169 (0.179) data 0.092 (0.101) loss_u loss_u 0.9746 (0.9356) acc_u 3.1250 (6.9792) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [35/38] time 0.177 (0.178) data 0.100 (0.101) loss_u loss_u 0.9336 (0.9395) acc_u 6.2500 (6.5179) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 760
confident_label rate tensor(0.2364, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 382
clean true:350
clean false:32
clean_rate:0.9162303664921466
noisy true:506
noisy false:728
after delete: len(clean_dataset) 382
after delete: len(noisy_dataset) 1234
epoch [8/200] batch [5/11] time 0.170 (0.168) data 0.092 (0.091) loss_x loss_x 1.0107 (1.0509) acc_x 71.8750 (71.2500) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/11] time 0.159 (0.167) data 0.082 (0.089) loss_x loss_x 1.2646 (0.9961) acc_x 75.0000 (74.3750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/38] time 0.181 (0.173) data 0.104 (0.095) loss_u loss_u 0.9424 (0.8945) acc_u 6.2500 (11.2500) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [10/38] time 0.180 (0.176) data 0.100 (0.098) loss_u loss_u 0.9795 (0.9126) acc_u 0.0000 (10.0000) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [15/38] time 0.186 (0.176) data 0.109 (0.099) loss_u loss_u 0.9058 (0.9193) acc_u 9.3750 (9.1667) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [20/38] time 0.171 (0.177) data 0.094 (0.099) loss_u loss_u 0.9058 (0.9172) acc_u 6.2500 (9.6875) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [25/38] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9390 (0.9209) acc_u 9.3750 (9.1250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [30/38] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.9219 (0.9237) acc_u 9.3750 (8.9583) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [35/38] time 0.174 (0.177) data 0.095 (0.100) loss_u loss_u 0.9351 (0.9245) acc_u 6.2500 (8.8393) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 784
confident_label rate tensor(0.2321, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 375
clean true:344
clean false:31
clean_rate:0.9173333333333333
noisy true:488
noisy false:753
after delete: len(clean_dataset) 375
after delete: len(noisy_dataset) 1241
epoch [9/200] batch [5/11] time 0.164 (0.165) data 0.086 (0.088) loss_x loss_x 1.0332 (0.7856) acc_x 78.1250 (80.6250) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [10/11] time 0.167 (0.167) data 0.090 (0.090) loss_x loss_x 1.0205 (0.8411) acc_x 71.8750 (77.5000) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/38] time 0.186 (0.173) data 0.109 (0.096) loss_u loss_u 0.9028 (0.9334) acc_u 9.3750 (6.8750) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [10/38] time 0.183 (0.176) data 0.107 (0.099) loss_u loss_u 0.8857 (0.9234) acc_u 12.5000 (8.1250) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [15/38] time 0.192 (0.178) data 0.115 (0.101) loss_u loss_u 0.9326 (0.9265) acc_u 3.1250 (7.0833) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [20/38] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9629 (0.9240) acc_u 6.2500 (7.6562) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [25/38] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9727 (0.9248) acc_u 3.1250 (7.7500) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [30/38] time 0.175 (0.180) data 0.098 (0.102) loss_u loss_u 0.9941 (0.9282) acc_u 0.0000 (7.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [35/38] time 0.172 (0.180) data 0.094 (0.102) loss_u loss_u 0.9189 (0.9290) acc_u 12.5000 (7.6786) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 795
confident_label rate tensor(0.2395, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 387
clean true:346
clean false:41
clean_rate:0.8940568475452196
noisy true:475
noisy false:754
after delete: len(clean_dataset) 387
after delete: len(noisy_dataset) 1229
epoch [10/200] batch [5/12] time 0.162 (0.170) data 0.086 (0.093) loss_x loss_x 0.7988 (0.8922) acc_x 78.1250 (79.3750) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/12] time 0.178 (0.171) data 0.101 (0.095) loss_x loss_x 1.2139 (1.0772) acc_x 62.5000 (73.1250) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/38] time 0.185 (0.176) data 0.107 (0.099) loss_u loss_u 0.9546 (0.9604) acc_u 6.2500 (5.0000) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [10/38] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9844 (0.9593) acc_u 0.0000 (4.6875) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [15/38] time 0.186 (0.179) data 0.107 (0.102) loss_u loss_u 0.9399 (0.9528) acc_u 9.3750 (5.8333) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [20/38] time 0.170 (0.179) data 0.092 (0.101) loss_u loss_u 0.9268 (0.9476) acc_u 12.5000 (6.8750) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [25/38] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.9487 (0.9397) acc_u 3.1250 (7.2500) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [30/38] time 0.172 (0.176) data 0.094 (0.099) loss_u loss_u 0.9551 (0.9370) acc_u 3.1250 (7.3958) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [35/38] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.8853 (0.9341) acc_u 18.7500 (7.8571) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 749
confident_label rate tensor(0.2382, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 385
clean true:345
clean false:40
clean_rate:0.8961038961038961
noisy true:522
noisy false:709
after delete: len(clean_dataset) 385
after delete: len(noisy_dataset) 1231
epoch [11/200] batch [5/12] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 1.2188 (0.9548) acc_x 65.6250 (77.5000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/12] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 1.1797 (1.0398) acc_x 68.7500 (73.1250) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/38] time 0.166 (0.174) data 0.089 (0.097) loss_u loss_u 0.9233 (0.9232) acc_u 9.3750 (8.1250) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [10/38] time 0.178 (0.174) data 0.101 (0.097) loss_u loss_u 0.9189 (0.9228) acc_u 6.2500 (8.1250) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [15/38] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.8994 (0.9223) acc_u 12.5000 (8.7500) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [20/38] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.9082 (0.9239) acc_u 9.3750 (8.5938) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [25/38] time 0.178 (0.176) data 0.100 (0.099) loss_u loss_u 0.9326 (0.9281) acc_u 12.5000 (8.5000) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [30/38] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.8784 (0.9263) acc_u 15.6250 (8.7500) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [35/38] time 0.167 (0.177) data 0.090 (0.099) loss_u loss_u 0.9287 (0.9208) acc_u 6.2500 (9.1964) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 744
confident_label rate tensor(0.2525, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 408
clean true:370
clean false:38
clean_rate:0.9068627450980392
noisy true:502
noisy false:706
after delete: len(clean_dataset) 408
after delete: len(noisy_dataset) 1208
epoch [12/200] batch [5/12] time 0.183 (0.192) data 0.107 (0.115) loss_x loss_x 1.1641 (1.0460) acc_x 75.0000 (73.7500) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [10/12] time 0.166 (0.183) data 0.090 (0.106) loss_x loss_x 0.7607 (0.9721) acc_x 78.1250 (74.0625) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/37] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.9087 (0.9295) acc_u 12.5000 (8.7500) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [10/37] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9346 (0.9386) acc_u 6.2500 (7.5000) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [15/37] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.9058 (0.9349) acc_u 9.3750 (7.5000) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [20/37] time 0.200 (0.177) data 0.123 (0.100) loss_u loss_u 0.9683 (0.9417) acc_u 3.1250 (6.2500) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [25/37] time 0.194 (0.178) data 0.116 (0.101) loss_u loss_u 0.9614 (0.9388) acc_u 6.2500 (6.7500) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [30/37] time 0.188 (0.179) data 0.111 (0.101) loss_u loss_u 0.9922 (0.9399) acc_u 0.0000 (6.6667) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [35/37] time 0.179 (0.179) data 0.102 (0.102) loss_u loss_u 0.8950 (0.9369) acc_u 15.6250 (7.1429) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 743
confident_label rate tensor(0.2463, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 398
clean true:360
clean false:38
clean_rate:0.9045226130653267
noisy true:513
noisy false:705
after delete: len(clean_dataset) 398
after delete: len(noisy_dataset) 1218
epoch [13/200] batch [5/12] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 1.1309 (0.9769) acc_x 68.7500 (73.7500) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [10/12] time 0.162 (0.179) data 0.085 (0.102) loss_x loss_x 1.4795 (1.0213) acc_x 68.7500 (73.7500) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/38] time 0.186 (0.181) data 0.108 (0.103) loss_u loss_u 0.9463 (0.9286) acc_u 9.3750 (11.2500) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [10/38] time 0.187 (0.182) data 0.109 (0.104) loss_u loss_u 0.8530 (0.9158) acc_u 21.8750 (11.8750) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [15/38] time 0.185 (0.183) data 0.108 (0.105) loss_u loss_u 0.9263 (0.9259) acc_u 6.2500 (9.5833) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [20/38] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.9849 (0.9247) acc_u 3.1250 (9.8438) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [25/38] time 0.185 (0.184) data 0.109 (0.106) loss_u loss_u 0.9214 (0.9205) acc_u 12.5000 (10.5000) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [30/38] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9575 (0.9204) acc_u 6.2500 (10.2083) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [35/38] time 0.189 (0.184) data 0.112 (0.107) loss_u loss_u 0.9082 (0.9230) acc_u 9.3750 (9.9107) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 761
confident_label rate tensor(0.2531, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 409
clean true:364
clean false:45
clean_rate:0.8899755501222494
noisy true:491
noisy false:716
after delete: len(clean_dataset) 409
after delete: len(noisy_dataset) 1207
epoch [14/200] batch [5/12] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.6855 (0.7559) acc_x 75.0000 (76.2500) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/12] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.9966 (0.8619) acc_x 75.0000 (75.6250) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/37] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8862 (0.9290) acc_u 9.3750 (8.7500) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [10/37] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.9434 (0.9279) acc_u 6.2500 (8.7500) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [15/37] time 0.184 (0.183) data 0.105 (0.106) loss_u loss_u 0.9219 (0.9318) acc_u 9.3750 (7.9167) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [20/37] time 0.182 (0.184) data 0.106 (0.106) loss_u loss_u 0.9614 (0.9294) acc_u 6.2500 (8.9062) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [25/37] time 0.168 (0.182) data 0.090 (0.105) loss_u loss_u 0.9585 (0.9336) acc_u 3.1250 (8.2500) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [30/37] time 0.160 (0.180) data 0.083 (0.103) loss_u loss_u 0.9419 (0.9330) acc_u 9.3750 (8.5417) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [35/37] time 0.164 (0.180) data 0.085 (0.103) loss_u loss_u 0.9570 (0.9305) acc_u 0.0000 (8.4821) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 733
confident_label rate tensor(0.2450, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 396
clean true:353
clean false:43
clean_rate:0.8914141414141414
noisy true:530
noisy false:690
after delete: len(clean_dataset) 396
after delete: len(noisy_dataset) 1220
epoch [15/200] batch [5/12] time 0.180 (0.170) data 0.103 (0.093) loss_x loss_x 0.8218 (0.8938) acc_x 81.2500 (77.5000) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [10/12] time 0.162 (0.169) data 0.085 (0.092) loss_x loss_x 0.9414 (0.9514) acc_x 71.8750 (75.6250) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/38] time 0.163 (0.168) data 0.085 (0.091) loss_u loss_u 0.9570 (0.9234) acc_u 6.2500 (9.3750) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/38] time 0.182 (0.168) data 0.105 (0.091) loss_u loss_u 0.9414 (0.9128) acc_u 3.1250 (10.3125) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [15/38] time 0.188 (0.171) data 0.110 (0.094) loss_u loss_u 0.9297 (0.9130) acc_u 6.2500 (10.0000) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [20/38] time 0.189 (0.174) data 0.112 (0.096) loss_u loss_u 0.9082 (0.9185) acc_u 9.3750 (9.3750) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [25/38] time 0.186 (0.175) data 0.109 (0.098) loss_u loss_u 0.9624 (0.9185) acc_u 6.2500 (9.2500) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [30/38] time 0.187 (0.177) data 0.110 (0.099) loss_u loss_u 0.9194 (0.9161) acc_u 12.5000 (9.5833) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [35/38] time 0.181 (0.177) data 0.102 (0.100) loss_u loss_u 0.9067 (0.9138) acc_u 12.5000 (10.0000) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 700
confident_label rate tensor(0.2772, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 448
clean true:403
clean false:45
clean_rate:0.8995535714285714
noisy true:513
noisy false:655
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1168
epoch [16/200] batch [5/14] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 1.0605 (0.9004) acc_x 71.8750 (73.7500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [10/14] time 0.178 (0.183) data 0.100 (0.105) loss_x loss_x 0.6309 (0.8865) acc_x 81.2500 (75.3125) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/36] time 0.173 (0.177) data 0.095 (0.099) loss_u loss_u 0.9873 (0.9168) acc_u 0.0000 (8.1250) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/36] time 0.179 (0.177) data 0.101 (0.100) loss_u loss_u 0.9282 (0.9184) acc_u 9.3750 (9.3750) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [15/36] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.9766 (0.9287) acc_u 0.0000 (7.7083) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [20/36] time 0.186 (0.180) data 0.109 (0.102) loss_u loss_u 0.9590 (0.9213) acc_u 9.3750 (9.2188) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/36] time 0.187 (0.181) data 0.111 (0.103) loss_u loss_u 0.9966 (0.9301) acc_u 0.0000 (8.3750) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [30/36] time 0.185 (0.182) data 0.107 (0.104) loss_u loss_u 0.9741 (0.9298) acc_u 0.0000 (8.4375) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [35/36] time 0.181 (0.182) data 0.103 (0.104) loss_u loss_u 0.9351 (0.9318) acc_u 6.2500 (8.1250) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 757
confident_label rate tensor(0.2568, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 415
clean true:363
clean false:52
clean_rate:0.8746987951807229
noisy true:496
noisy false:705
after delete: len(clean_dataset) 415
after delete: len(noisy_dataset) 1201
epoch [17/200] batch [5/12] time 0.187 (0.174) data 0.110 (0.097) loss_x loss_x 0.8394 (0.8046) acc_x 71.8750 (76.8750) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [10/12] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 1.3936 (0.9583) acc_x 71.8750 (74.6875) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/37] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.9351 (0.9222) acc_u 12.5000 (10.6250) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/37] time 0.173 (0.176) data 0.096 (0.098) loss_u loss_u 0.9390 (0.9242) acc_u 6.2500 (9.0625) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [15/37] time 0.167 (0.176) data 0.090 (0.099) loss_u loss_u 0.9644 (0.9291) acc_u 3.1250 (9.1667) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [20/37] time 0.182 (0.174) data 0.104 (0.097) loss_u loss_u 0.8770 (0.9258) acc_u 15.6250 (9.6875) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/37] time 0.182 (0.175) data 0.105 (0.097) loss_u loss_u 0.9722 (0.9283) acc_u 0.0000 (9.3750) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [30/37] time 0.186 (0.176) data 0.108 (0.098) loss_u loss_u 0.8647 (0.9273) acc_u 18.7500 (9.1667) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [35/37] time 0.184 (0.177) data 0.107 (0.099) loss_u loss_u 0.8862 (0.9265) acc_u 15.6250 (9.2857) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 735
confident_label rate tensor(0.2506, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 405
clean true:362
clean false:43
clean_rate:0.8938271604938272
noisy true:519
noisy false:692
after delete: len(clean_dataset) 405
after delete: len(noisy_dataset) 1211
epoch [18/200] batch [5/12] time 0.185 (0.196) data 0.108 (0.119) loss_x loss_x 1.0098 (1.0641) acc_x 59.3750 (67.5000) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/12] time 0.177 (0.187) data 0.100 (0.111) loss_x loss_x 0.4932 (0.9707) acc_x 84.3750 (71.8750) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/37] time 0.213 (0.192) data 0.135 (0.115) loss_u loss_u 0.8979 (0.9100) acc_u 18.7500 (11.2500) lr 1.9686e-03 eta 0:00:06
epoch [18/200] batch [10/37] time 0.166 (0.192) data 0.089 (0.115) loss_u loss_u 0.9712 (0.9302) acc_u 3.1250 (8.4375) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [15/37] time 0.167 (0.188) data 0.089 (0.110) loss_u loss_u 0.9238 (0.9223) acc_u 6.2500 (9.3750) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [20/37] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9150 (0.9242) acc_u 9.3750 (8.9062) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [25/37] time 0.169 (0.184) data 0.092 (0.106) loss_u loss_u 0.9824 (0.9272) acc_u 3.1250 (8.6250) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [30/37] time 0.171 (0.182) data 0.094 (0.104) loss_u loss_u 0.8730 (0.9250) acc_u 18.7500 (8.8542) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [35/37] time 0.185 (0.182) data 0.106 (0.104) loss_u loss_u 0.8511 (0.9184) acc_u 15.6250 (9.6429) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 704
confident_label rate tensor(0.2593, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 419
clean true:375
clean false:44
clean_rate:0.8949880668257757
noisy true:537
noisy false:660
after delete: len(clean_dataset) 419
after delete: len(noisy_dataset) 1197
epoch [19/200] batch [5/13] time 0.168 (0.165) data 0.092 (0.088) loss_x loss_x 1.5303 (1.0004) acc_x 59.3750 (71.2500) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/13] time 0.178 (0.168) data 0.101 (0.092) loss_x loss_x 0.6631 (0.9187) acc_x 84.3750 (74.6875) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/37] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.9341 (0.9352) acc_u 6.2500 (6.2500) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/37] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.8643 (0.9114) acc_u 15.6250 (9.6875) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [15/37] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9033 (0.9174) acc_u 9.3750 (9.1667) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [20/37] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.9209 (0.9206) acc_u 9.3750 (9.0625) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [25/37] time 0.190 (0.179) data 0.113 (0.102) loss_u loss_u 0.9062 (0.9213) acc_u 12.5000 (9.1250) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [30/37] time 0.198 (0.180) data 0.120 (0.103) loss_u loss_u 0.9126 (0.9249) acc_u 9.3750 (8.6458) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [35/37] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.8740 (0.9232) acc_u 18.7500 (9.1071) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 724
confident_label rate tensor(0.2618, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 423
clean true:369
clean false:54
clean_rate:0.8723404255319149
noisy true:523
noisy false:670
after delete: len(clean_dataset) 423
after delete: len(noisy_dataset) 1193
epoch [20/200] batch [5/13] time 0.173 (0.168) data 0.096 (0.091) loss_x loss_x 0.9829 (0.8478) acc_x 68.7500 (76.8750) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [10/13] time 0.184 (0.174) data 0.107 (0.097) loss_x loss_x 0.7373 (0.8675) acc_x 81.2500 (77.5000) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/37] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.8975 (0.9276) acc_u 9.3750 (7.5000) lr 1.9603e-03 eta 0:00:05
epoch [20/200] batch [10/37] time 0.177 (0.179) data 0.099 (0.102) loss_u loss_u 0.9600 (0.9292) acc_u 3.1250 (7.1875) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/37] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.9668 (0.9299) acc_u 6.2500 (8.3333) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [20/37] time 0.160 (0.177) data 0.082 (0.099) loss_u loss_u 0.8506 (0.9217) acc_u 18.7500 (9.8438) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [25/37] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.8843 (0.9223) acc_u 9.3750 (9.3750) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [30/37] time 0.160 (0.175) data 0.083 (0.098) loss_u loss_u 0.9507 (0.9216) acc_u 6.2500 (9.6875) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [35/37] time 0.185 (0.175) data 0.108 (0.097) loss_u loss_u 0.8936 (0.9215) acc_u 15.6250 (9.8214) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 729
confident_label rate tensor(0.2587, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 418
clean true:364
clean false:54
clean_rate:0.8708133971291866
noisy true:523
noisy false:675
after delete: len(clean_dataset) 418
after delete: len(noisy_dataset) 1198
epoch [21/200] batch [5/13] time 0.209 (0.189) data 0.133 (0.112) loss_x loss_x 0.7988 (0.9064) acc_x 78.1250 (75.6250) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [10/13] time 0.206 (0.197) data 0.129 (0.120) loss_x loss_x 1.0664 (0.8739) acc_x 78.1250 (78.4375) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/37] time 0.210 (0.196) data 0.132 (0.119) loss_u loss_u 0.9233 (0.9131) acc_u 9.3750 (10.0000) lr 1.9558e-03 eta 0:00:06
epoch [21/200] batch [10/37] time 0.170 (0.196) data 0.093 (0.119) loss_u loss_u 0.9429 (0.9223) acc_u 6.2500 (9.0625) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [15/37] time 0.172 (0.192) data 0.094 (0.115) loss_u loss_u 0.8989 (0.9205) acc_u 9.3750 (10.0000) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [20/37] time 0.185 (0.191) data 0.106 (0.114) loss_u loss_u 0.9141 (0.9114) acc_u 9.3750 (10.7812) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [25/37] time 0.164 (0.188) data 0.087 (0.110) loss_u loss_u 0.9126 (0.9148) acc_u 9.3750 (10.2500) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [30/37] time 0.202 (0.186) data 0.125 (0.109) loss_u loss_u 0.9448 (0.9126) acc_u 9.3750 (10.6250) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [35/37] time 0.177 (0.185) data 0.100 (0.108) loss_u loss_u 0.9209 (0.9161) acc_u 6.2500 (10.0893) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 728
confident_label rate tensor(0.2630, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 425
clean true:376
clean false:49
clean_rate:0.8847058823529412
noisy true:512
noisy false:679
after delete: len(clean_dataset) 425
after delete: len(noisy_dataset) 1191
epoch [22/200] batch [5/13] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.8413 (0.9325) acc_x 71.8750 (76.2500) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [10/13] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.3301 (0.7644) acc_x 90.6250 (79.6875) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/37] time 0.187 (0.185) data 0.110 (0.109) loss_u loss_u 0.9077 (0.9333) acc_u 9.3750 (9.3750) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [10/37] time 0.186 (0.185) data 0.109 (0.109) loss_u loss_u 0.9614 (0.9229) acc_u 3.1250 (10.3125) lr 1.9511e-03 eta 0:00:05
epoch [22/200] batch [15/37] time 0.186 (0.185) data 0.109 (0.109) loss_u loss_u 0.8569 (0.9171) acc_u 18.7500 (10.2083) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [20/37] time 0.186 (0.185) data 0.109 (0.109) loss_u loss_u 0.8989 (0.9151) acc_u 12.5000 (10.4688) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [25/37] time 0.184 (0.185) data 0.107 (0.109) loss_u loss_u 0.8867 (0.9159) acc_u 12.5000 (10.1250) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [30/37] time 0.186 (0.185) data 0.109 (0.109) loss_u loss_u 0.9282 (0.9207) acc_u 6.2500 (9.1667) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [35/37] time 0.185 (0.185) data 0.108 (0.109) loss_u loss_u 0.8677 (0.9195) acc_u 18.7500 (9.4643) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 716
confident_label rate tensor(0.2698, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 436
clean true:385
clean false:51
clean_rate:0.8830275229357798
noisy true:515
noisy false:665
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1180
epoch [23/200] batch [5/13] time 0.187 (0.186) data 0.111 (0.110) loss_x loss_x 0.8398 (0.8538) acc_x 81.2500 (78.1250) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/13] time 0.187 (0.185) data 0.109 (0.109) loss_x loss_x 0.8096 (0.8274) acc_x 84.3750 (79.3750) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/36] time 0.174 (0.184) data 0.096 (0.107) loss_u loss_u 0.9253 (0.9315) acc_u 9.3750 (8.1250) lr 1.9461e-03 eta 0:00:05
epoch [23/200] batch [10/36] time 0.173 (0.181) data 0.096 (0.104) loss_u loss_u 0.9087 (0.9242) acc_u 6.2500 (8.1250) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [15/36] time 0.168 (0.180) data 0.090 (0.102) loss_u loss_u 0.9600 (0.9224) acc_u 3.1250 (8.9583) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/36] time 0.175 (0.178) data 0.096 (0.101) loss_u loss_u 0.9009 (0.9208) acc_u 6.2500 (8.9062) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [25/36] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.9092 (0.9163) acc_u 12.5000 (9.8750) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [30/36] time 0.184 (0.177) data 0.107 (0.099) loss_u loss_u 0.9526 (0.9188) acc_u 3.1250 (9.6875) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [35/36] time 0.229 (0.179) data 0.151 (0.101) loss_u loss_u 0.9023 (0.9193) acc_u 12.5000 (9.2857) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 729
confident_label rate tensor(0.2630, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 425
clean true:375
clean false:50
clean_rate:0.8823529411764706
noisy true:512
noisy false:679
after delete: len(clean_dataset) 425
after delete: len(noisy_dataset) 1191
epoch [24/200] batch [5/13] time 0.174 (0.178) data 0.097 (0.101) loss_x loss_x 1.1152 (1.0717) acc_x 78.1250 (75.0000) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [10/13] time 0.163 (0.173) data 0.086 (0.096) loss_x loss_x 1.0322 (0.9129) acc_x 68.7500 (75.0000) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/37] time 0.165 (0.171) data 0.087 (0.093) loss_u loss_u 0.9424 (0.8880) acc_u 6.2500 (13.7500) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/37] time 0.170 (0.170) data 0.090 (0.093) loss_u loss_u 0.9209 (0.9082) acc_u 9.3750 (10.9375) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [15/37] time 0.165 (0.169) data 0.087 (0.092) loss_u loss_u 0.8247 (0.9077) acc_u 15.6250 (10.4167) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [20/37] time 0.180 (0.170) data 0.102 (0.093) loss_u loss_u 0.9263 (0.9126) acc_u 9.3750 (9.8438) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [25/37] time 0.177 (0.171) data 0.100 (0.094) loss_u loss_u 0.9375 (0.9138) acc_u 9.3750 (9.8750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [30/37] time 0.183 (0.172) data 0.105 (0.094) loss_u loss_u 0.9380 (0.9163) acc_u 9.3750 (9.7917) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [35/37] time 0.177 (0.172) data 0.100 (0.094) loss_u loss_u 0.9429 (0.9203) acc_u 6.2500 (9.1964) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 718
confident_label rate tensor(0.2692, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 435
clean true:379
clean false:56
clean_rate:0.871264367816092
noisy true:519
noisy false:662
after delete: len(clean_dataset) 435
after delete: len(noisy_dataset) 1181
epoch [25/200] batch [5/13] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 1.0293 (0.9048) acc_x 75.0000 (78.1250) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [10/13] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 1.2080 (0.9860) acc_x 62.5000 (75.0000) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/36] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9790 (0.9141) acc_u 0.0000 (8.7500) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [10/36] time 0.194 (0.185) data 0.116 (0.108) loss_u loss_u 0.9570 (0.9163) acc_u 6.2500 (8.7500) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [15/36] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9253 (0.9270) acc_u 9.3750 (7.9167) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [20/36] time 0.187 (0.181) data 0.111 (0.103) loss_u loss_u 0.9194 (0.9243) acc_u 12.5000 (8.4375) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [25/36] time 0.180 (0.179) data 0.102 (0.102) loss_u loss_u 0.8965 (0.9204) acc_u 15.6250 (9.2500) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [30/36] time 0.167 (0.179) data 0.090 (0.102) loss_u loss_u 0.8818 (0.9207) acc_u 15.6250 (9.3750) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [35/36] time 0.190 (0.180) data 0.112 (0.102) loss_u loss_u 0.9492 (0.9236) acc_u 9.3750 (8.9286) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 735
confident_label rate tensor(0.2698, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 436
clean true:376
clean false:60
clean_rate:0.8623853211009175
noisy true:505
noisy false:675
after delete: len(clean_dataset) 436
after delete: len(noisy_dataset) 1180
epoch [26/200] batch [5/13] time 0.184 (0.168) data 0.108 (0.091) loss_x loss_x 1.1367 (1.0156) acc_x 75.0000 (72.5000) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [10/13] time 0.161 (0.167) data 0.084 (0.090) loss_x loss_x 1.3398 (0.9712) acc_x 68.7500 (74.3750) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/36] time 0.169 (0.165) data 0.091 (0.088) loss_u loss_u 0.9380 (0.9343) acc_u 6.2500 (9.3750) lr 1.9298e-03 eta 0:00:05
epoch [26/200] batch [10/36] time 0.186 (0.170) data 0.108 (0.092) loss_u loss_u 0.9746 (0.9356) acc_u 3.1250 (8.1250) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [15/36] time 0.164 (0.169) data 0.087 (0.092) loss_u loss_u 0.9194 (0.9227) acc_u 6.2500 (8.9583) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [20/36] time 0.172 (0.169) data 0.095 (0.092) loss_u loss_u 0.8999 (0.9203) acc_u 12.5000 (9.0625) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/36] time 0.174 (0.169) data 0.097 (0.091) loss_u loss_u 0.9551 (0.9176) acc_u 3.1250 (9.3750) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [30/36] time 0.187 (0.170) data 0.108 (0.092) loss_u loss_u 0.9150 (0.9176) acc_u 6.2500 (9.2708) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [35/36] time 0.170 (0.170) data 0.091 (0.093) loss_u loss_u 0.9229 (0.9165) acc_u 9.3750 (9.3750) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 736
confident_label rate tensor(0.2605, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 421
clean true:369
clean false:52
clean_rate:0.8764845605700713
noisy true:511
noisy false:684
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1195
epoch [27/200] batch [5/13] time 0.185 (0.173) data 0.109 (0.097) loss_x loss_x 0.6196 (0.9719) acc_x 78.1250 (75.6250) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [10/13] time 0.192 (0.179) data 0.114 (0.102) loss_x loss_x 1.4912 (0.9588) acc_x 71.8750 (76.8750) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/37] time 0.176 (0.180) data 0.099 (0.103) loss_u loss_u 0.9409 (0.9280) acc_u 3.1250 (9.3750) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/37] time 0.159 (0.180) data 0.083 (0.103) loss_u loss_u 0.9092 (0.9177) acc_u 9.3750 (9.3750) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/37] time 0.160 (0.177) data 0.083 (0.100) loss_u loss_u 0.9048 (0.9153) acc_u 9.3750 (9.7917) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [20/37] time 0.217 (0.178) data 0.140 (0.101) loss_u loss_u 0.9370 (0.9094) acc_u 9.3750 (11.4062) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [25/37] time 0.165 (0.177) data 0.088 (0.100) loss_u loss_u 0.9180 (0.9064) acc_u 12.5000 (11.5000) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [30/37] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.9277 (0.9113) acc_u 6.2500 (10.6250) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [35/37] time 0.182 (0.177) data 0.104 (0.100) loss_u loss_u 0.9282 (0.9128) acc_u 9.3750 (10.5357) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 715
confident_label rate tensor(0.2822, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 456
clean true:386
clean false:70
clean_rate:0.8464912280701754
noisy true:515
noisy false:645
after delete: len(clean_dataset) 456
after delete: len(noisy_dataset) 1160
epoch [28/200] batch [5/14] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.9463 (1.0971) acc_x 75.0000 (71.2500) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [10/14] time 0.177 (0.177) data 0.099 (0.100) loss_x loss_x 0.8042 (0.9804) acc_x 75.0000 (73.4375) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/36] time 0.175 (0.178) data 0.098 (0.101) loss_u loss_u 0.8560 (0.9135) acc_u 18.7500 (10.6250) lr 1.9178e-03 eta 0:00:05
epoch [28/200] batch [10/36] time 0.169 (0.177) data 0.091 (0.100) loss_u loss_u 0.9053 (0.9176) acc_u 12.5000 (10.0000) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [15/36] time 0.191 (0.180) data 0.114 (0.102) loss_u loss_u 0.8906 (0.9139) acc_u 15.6250 (10.4167) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [20/36] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.9292 (0.9214) acc_u 6.2500 (9.2188) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [25/36] time 0.166 (0.179) data 0.087 (0.101) loss_u loss_u 0.9307 (0.9266) acc_u 12.5000 (8.7500) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [30/36] time 0.185 (0.179) data 0.106 (0.102) loss_u loss_u 0.9404 (0.9241) acc_u 9.3750 (9.1667) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [35/36] time 0.168 (0.179) data 0.091 (0.101) loss_u loss_u 0.9214 (0.9225) acc_u 9.3750 (9.2857) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 754
confident_label rate tensor(0.2618, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 423
clean true:364
clean false:59
clean_rate:0.8605200945626478
noisy true:498
noisy false:695
after delete: len(clean_dataset) 423
after delete: len(noisy_dataset) 1193
epoch [29/200] batch [5/13] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.9009 (0.8825) acc_x 81.2500 (75.0000) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/13] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.7681 (0.9083) acc_x 78.1250 (74.6875) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/37] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9531 (0.8905) acc_u 6.2500 (13.7500) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [10/37] time 0.186 (0.186) data 0.109 (0.108) loss_u loss_u 0.8652 (0.8902) acc_u 15.6250 (14.0625) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [15/37] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9678 (0.8999) acc_u 6.2500 (12.7083) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [20/37] time 0.162 (0.184) data 0.085 (0.107) loss_u loss_u 0.8174 (0.9033) acc_u 25.0000 (12.1875) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [25/37] time 0.163 (0.181) data 0.086 (0.104) loss_u loss_u 0.8950 (0.9066) acc_u 15.6250 (11.7500) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [30/37] time 0.177 (0.180) data 0.098 (0.103) loss_u loss_u 0.8096 (0.9059) acc_u 21.8750 (11.9792) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [35/37] time 0.170 (0.180) data 0.093 (0.103) loss_u loss_u 0.9561 (0.9088) acc_u 6.2500 (11.5179) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 715
confident_label rate tensor(0.2772, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 448
clean true:381
clean false:67
clean_rate:0.8504464285714286
noisy true:520
noisy false:648
after delete: len(clean_dataset) 448
after delete: len(noisy_dataset) 1168
epoch [30/200] batch [5/14] time 0.172 (0.175) data 0.096 (0.098) loss_x loss_x 0.9048 (0.7269) acc_x 68.7500 (79.3750) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [10/14] time 0.167 (0.172) data 0.090 (0.095) loss_x loss_x 0.9824 (0.8167) acc_x 75.0000 (77.8125) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/36] time 0.186 (0.173) data 0.108 (0.096) loss_u loss_u 0.9634 (0.9437) acc_u 3.1250 (7.5000) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/36] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.9590 (0.9276) acc_u 6.2500 (9.0625) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/36] time 0.204 (0.175) data 0.126 (0.098) loss_u loss_u 0.8262 (0.9143) acc_u 18.7500 (10.2083) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [20/36] time 0.189 (0.177) data 0.111 (0.099) loss_u loss_u 0.8730 (0.9158) acc_u 15.6250 (10.3125) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/36] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.8994 (0.9187) acc_u 12.5000 (10.1250) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [30/36] time 0.165 (0.176) data 0.087 (0.098) loss_u loss_u 0.9824 (0.9192) acc_u 3.1250 (10.0000) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [35/36] time 0.161 (0.174) data 0.084 (0.097) loss_u loss_u 0.9033 (0.9179) acc_u 9.3750 (10.1786) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 734
confident_label rate tensor(0.2723, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 440
clean true:384
clean false:56
clean_rate:0.8727272727272727
noisy true:498
noisy false:678
after delete: len(clean_dataset) 440
after delete: len(noisy_dataset) 1176
epoch [31/200] batch [5/13] time 0.183 (0.186) data 0.105 (0.109) loss_x loss_x 0.9023 (0.9541) acc_x 84.3750 (78.1250) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/13] time 0.190 (0.185) data 0.112 (0.107) loss_x loss_x 0.9170 (0.8646) acc_x 78.1250 (79.0625) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/36] time 0.172 (0.183) data 0.095 (0.106) loss_u loss_u 0.9702 (0.9003) acc_u 3.1250 (11.2500) lr 1.8980e-03 eta 0:00:05
epoch [31/200] batch [10/36] time 0.174 (0.182) data 0.097 (0.104) loss_u loss_u 0.9541 (0.9044) acc_u 9.3750 (11.5625) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [15/36] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.9165 (0.9125) acc_u 6.2500 (10.2083) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [20/36] time 0.175 (0.180) data 0.098 (0.103) loss_u loss_u 0.9424 (0.9124) acc_u 9.3750 (10.1562) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [25/36] time 0.174 (0.179) data 0.097 (0.101) loss_u loss_u 0.9683 (0.9182) acc_u 3.1250 (9.2500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [30/36] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.9751 (0.9237) acc_u 3.1250 (8.8542) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [35/36] time 0.175 (0.178) data 0.097 (0.100) loss_u loss_u 0.9341 (0.9225) acc_u 6.2500 (8.9286) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 706
confident_label rate tensor(0.2803, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 453
clean true:391
clean false:62
clean_rate:0.8631346578366446
noisy true:519
noisy false:644
after delete: len(clean_dataset) 453
after delete: len(noisy_dataset) 1163
epoch [32/200] batch [5/14] time 0.169 (0.166) data 0.092 (0.089) loss_x loss_x 1.4209 (0.9952) acc_x 56.2500 (74.3750) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [10/14] time 0.164 (0.166) data 0.088 (0.089) loss_x loss_x 1.1162 (0.8572) acc_x 78.1250 (77.5000) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/36] time 0.187 (0.168) data 0.110 (0.091) loss_u loss_u 0.9272 (0.9338) acc_u 9.3750 (6.8750) lr 1.8910e-03 eta 0:00:05
epoch [32/200] batch [10/36] time 0.184 (0.172) data 0.107 (0.095) loss_u loss_u 0.8911 (0.9206) acc_u 15.6250 (8.4375) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/36] time 0.187 (0.174) data 0.110 (0.097) loss_u loss_u 0.9033 (0.9150) acc_u 12.5000 (9.1667) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/36] time 0.190 (0.176) data 0.112 (0.099) loss_u loss_u 0.9238 (0.9175) acc_u 6.2500 (8.9062) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [25/36] time 0.160 (0.176) data 0.083 (0.099) loss_u loss_u 0.8735 (0.9153) acc_u 15.6250 (9.2500) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [30/36] time 0.171 (0.176) data 0.093 (0.098) loss_u loss_u 0.9355 (0.9172) acc_u 6.2500 (9.4792) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [35/36] time 0.176 (0.176) data 0.097 (0.098) loss_u loss_u 0.9619 (0.9148) acc_u 3.1250 (9.6429) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:408
clean false:72
clean_rate:0.85
noisy true:515
noisy false:621
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [33/200] batch [5/15] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 1.2549 (0.8462) acc_x 71.8750 (76.8750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [10/15] time 0.188 (0.182) data 0.111 (0.105) loss_x loss_x 1.1729 (0.8333) acc_x 71.8750 (78.4375) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [15/15] time 0.161 (0.178) data 0.084 (0.101) loss_x loss_x 1.0908 (0.9267) acc_x 68.7500 (76.2500) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/35] time 0.167 (0.176) data 0.089 (0.098) loss_u loss_u 0.9648 (0.9012) acc_u 3.1250 (11.2500) lr 1.8838e-03 eta 0:00:05
epoch [33/200] batch [10/35] time 0.175 (0.174) data 0.097 (0.097) loss_u loss_u 0.9268 (0.9152) acc_u 6.2500 (9.0625) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/35] time 0.183 (0.174) data 0.105 (0.097) loss_u loss_u 0.9404 (0.9218) acc_u 9.3750 (8.9583) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [20/35] time 0.198 (0.176) data 0.120 (0.098) loss_u loss_u 0.9282 (0.9216) acc_u 9.3750 (9.0625) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [25/35] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.8926 (0.9259) acc_u 9.3750 (8.3750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [30/35] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9409 (0.9267) acc_u 6.2500 (8.3333) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [35/35] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.9561 (0.9243) acc_u 3.1250 (8.6607) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.2877, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 465
clean true:395
clean false:70
clean_rate:0.8494623655913979
noisy true:531
noisy false:620
after delete: len(clean_dataset) 465
after delete: len(noisy_dataset) 1151
epoch [34/200] batch [5/14] time 0.186 (0.181) data 0.109 (0.105) loss_x loss_x 0.6494 (0.7552) acc_x 81.2500 (82.5000) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/14] time 0.179 (0.177) data 0.102 (0.101) loss_x loss_x 0.7607 (0.7946) acc_x 75.0000 (80.3125) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/35] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.9292 (0.9174) acc_u 9.3750 (9.3750) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [10/35] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8599 (0.8981) acc_u 18.7500 (12.1875) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/35] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9585 (0.8972) acc_u 3.1250 (12.0833) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/35] time 0.179 (0.181) data 0.101 (0.104) loss_u loss_u 0.8994 (0.9052) acc_u 9.3750 (10.7812) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [25/35] time 0.171 (0.181) data 0.094 (0.103) loss_u loss_u 0.9277 (0.9086) acc_u 9.3750 (10.3750) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [30/35] time 0.179 (0.180) data 0.101 (0.103) loss_u loss_u 0.9307 (0.9122) acc_u 9.3750 (10.0000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [35/35] time 0.175 (0.180) data 0.098 (0.103) loss_u loss_u 0.8574 (0.9136) acc_u 15.6250 (10.0000) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 709
confident_label rate tensor(0.2847, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 460
clean true:401
clean false:59
clean_rate:0.8717391304347826
noisy true:506
noisy false:650
after delete: len(clean_dataset) 460
after delete: len(noisy_dataset) 1156
epoch [35/200] batch [5/14] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 1.0254 (0.7721) acc_x 78.1250 (80.6250) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [10/14] time 0.182 (0.179) data 0.106 (0.102) loss_x loss_x 0.7910 (0.8315) acc_x 81.2500 (80.0000) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/36] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9292 (0.9285) acc_u 9.3750 (9.3750) lr 1.8686e-03 eta 0:00:05
epoch [35/200] batch [10/36] time 0.182 (0.181) data 0.105 (0.105) loss_u loss_u 0.8672 (0.9106) acc_u 15.6250 (10.6250) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/36] time 0.159 (0.181) data 0.082 (0.105) loss_u loss_u 0.9502 (0.9215) acc_u 3.1250 (9.3750) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [20/36] time 0.168 (0.180) data 0.090 (0.103) loss_u loss_u 0.8979 (0.9191) acc_u 9.3750 (9.6875) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [25/36] time 0.170 (0.180) data 0.092 (0.102) loss_u loss_u 0.9834 (0.9249) acc_u 0.0000 (8.8750) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [30/36] time 0.189 (0.179) data 0.111 (0.102) loss_u loss_u 0.9326 (0.9249) acc_u 6.2500 (8.6458) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [35/36] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.9175 (0.9229) acc_u 9.3750 (9.1071) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.2853, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 461
clean true:401
clean false:60
clean_rate:0.8698481561822126
noisy true:525
noisy false:630
after delete: len(clean_dataset) 461
after delete: len(noisy_dataset) 1155
epoch [36/200] batch [5/14] time 0.164 (0.162) data 0.087 (0.085) loss_x loss_x 0.7251 (0.9205) acc_x 84.3750 (78.7500) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [10/14] time 0.165 (0.162) data 0.088 (0.086) loss_x loss_x 0.6357 (0.8791) acc_x 75.0000 (77.8125) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/36] time 0.176 (0.168) data 0.099 (0.091) loss_u loss_u 0.9453 (0.9091) acc_u 9.3750 (11.2500) lr 1.8607e-03 eta 0:00:05
epoch [36/200] batch [10/36] time 0.172 (0.168) data 0.095 (0.091) loss_u loss_u 0.9390 (0.9101) acc_u 9.3750 (10.9375) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [15/36] time 0.172 (0.169) data 0.095 (0.092) loss_u loss_u 0.8535 (0.8977) acc_u 15.6250 (12.2917) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [20/36] time 0.172 (0.170) data 0.095 (0.093) loss_u loss_u 0.9321 (0.9124) acc_u 9.3750 (10.4688) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/36] time 0.169 (0.170) data 0.091 (0.092) loss_u loss_u 0.9380 (0.9176) acc_u 6.2500 (9.5000) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [30/36] time 0.180 (0.171) data 0.103 (0.094) loss_u loss_u 0.8823 (0.9153) acc_u 12.5000 (9.7917) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [35/36] time 0.169 (0.171) data 0.092 (0.094) loss_u loss_u 0.9419 (0.9166) acc_u 9.3750 (9.9107) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 709
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 455
clean true:388
clean false:67
clean_rate:0.8527472527472527
noisy true:519
noisy false:642
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1161
epoch [37/200] batch [5/14] time 0.169 (0.178) data 0.092 (0.102) loss_x loss_x 1.1377 (1.0463) acc_x 62.5000 (75.6250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [10/14] time 0.169 (0.172) data 0.092 (0.095) loss_x loss_x 0.5723 (0.8619) acc_x 90.6250 (78.4375) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/36] time 0.163 (0.170) data 0.086 (0.093) loss_u loss_u 0.8447 (0.8970) acc_u 18.7500 (13.1250) lr 1.8526e-03 eta 0:00:05
epoch [37/200] batch [10/36] time 0.177 (0.170) data 0.100 (0.093) loss_u loss_u 0.9575 (0.9141) acc_u 6.2500 (10.6250) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/36] time 0.201 (0.173) data 0.124 (0.096) loss_u loss_u 0.9565 (0.9219) acc_u 6.2500 (9.5833) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [20/36] time 0.186 (0.175) data 0.109 (0.098) loss_u loss_u 0.8350 (0.9184) acc_u 18.7500 (9.8438) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [25/36] time 0.161 (0.174) data 0.084 (0.097) loss_u loss_u 0.9111 (0.9169) acc_u 9.3750 (10.1250) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [30/36] time 0.186 (0.175) data 0.108 (0.098) loss_u loss_u 0.9810 (0.9222) acc_u 3.1250 (9.4792) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [35/36] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.9438 (0.9206) acc_u 6.2500 (9.5536) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.2884, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 466
clean true:401
clean false:65
clean_rate:0.8605150214592274
noisy true:539
noisy false:611
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 1150
epoch [38/200] batch [5/14] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 1.1680 (1.0245) acc_x 71.8750 (75.0000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [10/14] time 0.179 (0.180) data 0.102 (0.103) loss_x loss_x 0.4607 (0.8843) acc_x 87.5000 (78.1250) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/35] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.9482 (0.8991) acc_u 6.2500 (11.2500) lr 1.8443e-03 eta 0:00:05
epoch [38/200] batch [10/35] time 0.164 (0.174) data 0.088 (0.096) loss_u loss_u 0.8843 (0.9093) acc_u 12.5000 (10.3125) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [15/35] time 0.186 (0.175) data 0.109 (0.098) loss_u loss_u 0.9102 (0.9115) acc_u 9.3750 (10.2083) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/35] time 0.189 (0.177) data 0.110 (0.100) loss_u loss_u 0.9551 (0.9111) acc_u 6.2500 (10.1562) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [25/35] time 0.175 (0.177) data 0.098 (0.099) loss_u loss_u 0.9253 (0.9086) acc_u 9.3750 (10.5000) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [30/35] time 0.161 (0.176) data 0.083 (0.099) loss_u loss_u 0.9731 (0.9133) acc_u 3.1250 (9.8958) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [35/35] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.9087 (0.9133) acc_u 9.3750 (9.7321) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 696
confident_label rate tensor(0.2890, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 467
clean true:404
clean false:63
clean_rate:0.8650963597430407
noisy true:516
noisy false:633
after delete: len(clean_dataset) 467
after delete: len(noisy_dataset) 1149
epoch [39/200] batch [5/14] time 0.166 (0.169) data 0.089 (0.093) loss_x loss_x 0.4995 (0.7846) acc_x 87.5000 (78.1250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [10/14] time 0.162 (0.167) data 0.085 (0.090) loss_x loss_x 1.0020 (0.8333) acc_x 75.0000 (77.5000) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/35] time 0.177 (0.169) data 0.099 (0.092) loss_u loss_u 0.9126 (0.8834) acc_u 9.3750 (13.1250) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/35] time 0.170 (0.170) data 0.093 (0.093) loss_u loss_u 0.9839 (0.8894) acc_u 3.1250 (12.8125) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/35] time 0.167 (0.170) data 0.090 (0.093) loss_u loss_u 0.9443 (0.8938) acc_u 6.2500 (12.2917) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/35] time 0.185 (0.170) data 0.109 (0.093) loss_u loss_u 0.9692 (0.9079) acc_u 3.1250 (10.6250) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [25/35] time 0.189 (0.173) data 0.112 (0.095) loss_u loss_u 0.9609 (0.9157) acc_u 3.1250 (9.8750) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [30/35] time 0.183 (0.174) data 0.105 (0.096) loss_u loss_u 0.9272 (0.9184) acc_u 3.1250 (9.4792) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [35/35] time 0.172 (0.173) data 0.094 (0.096) loss_u loss_u 0.9473 (0.9216) acc_u 6.2500 (9.1071) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 714
confident_label rate tensor(0.2809, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 454
clean true:387
clean false:67
clean_rate:0.8524229074889867
noisy true:515
noisy false:647
after delete: len(clean_dataset) 454
after delete: len(noisy_dataset) 1162
epoch [40/200] batch [5/14] time 0.176 (0.175) data 0.099 (0.099) loss_x loss_x 0.9170 (0.8775) acc_x 78.1250 (76.8750) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [10/14] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.6616 (0.8764) acc_x 81.2500 (76.8750) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/36] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.8774 (0.9229) acc_u 12.5000 (8.1250) lr 1.8271e-03 eta 0:00:05
epoch [40/200] batch [10/36] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.9277 (0.9296) acc_u 12.5000 (7.5000) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [15/36] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.9316 (0.9208) acc_u 6.2500 (8.5417) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/36] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8477 (0.9127) acc_u 15.6250 (9.5312) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [25/36] time 0.183 (0.182) data 0.106 (0.106) loss_u loss_u 0.9038 (0.9086) acc_u 12.5000 (10.1250) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [30/36] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9312 (0.9119) acc_u 6.2500 (9.5833) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [35/36] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9102 (0.9152) acc_u 9.3750 (9.3750) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 710
confident_label rate tensor(0.2853, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 461
clean true:397
clean false:64
clean_rate:0.8611713665943601
noisy true:509
noisy false:646
after delete: len(clean_dataset) 461
after delete: len(noisy_dataset) 1155
epoch [41/200] batch [5/14] time 0.165 (0.170) data 0.089 (0.094) loss_x loss_x 0.9370 (0.9873) acc_x 78.1250 (78.7500) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [10/14] time 0.190 (0.170) data 0.113 (0.094) loss_x loss_x 0.6953 (0.9085) acc_x 81.2500 (78.7500) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/36] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.9536 (0.9017) acc_u 3.1250 (10.0000) lr 1.8181e-03 eta 0:00:05
epoch [41/200] batch [10/36] time 0.180 (0.176) data 0.104 (0.099) loss_u loss_u 0.9351 (0.9103) acc_u 6.2500 (9.3750) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/36] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.9727 (0.9072) acc_u 3.1250 (9.7917) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [20/36] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.8984 (0.9126) acc_u 12.5000 (9.5312) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [25/36] time 0.188 (0.180) data 0.110 (0.103) loss_u loss_u 0.9272 (0.9100) acc_u 9.3750 (10.2500) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [30/36] time 0.194 (0.181) data 0.118 (0.104) loss_u loss_u 0.9243 (0.9058) acc_u 9.3750 (11.0417) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [35/36] time 0.181 (0.181) data 0.103 (0.103) loss_u loss_u 0.9297 (0.9071) acc_u 6.2500 (10.8036) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.2902, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 469
clean true:405
clean false:64
clean_rate:0.8635394456289979
noisy true:521
noisy false:626
after delete: len(clean_dataset) 469
after delete: len(noisy_dataset) 1147
epoch [42/200] batch [5/14] time 0.184 (0.189) data 0.108 (0.112) loss_x loss_x 0.4636 (0.6344) acc_x 84.3750 (83.1250) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [10/14] time 0.182 (0.186) data 0.106 (0.109) loss_x loss_x 0.6802 (0.7404) acc_x 81.2500 (80.0000) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/35] time 0.173 (0.182) data 0.096 (0.105) loss_u loss_u 0.9561 (0.9486) acc_u 3.1250 (5.0000) lr 1.8090e-03 eta 0:00:05
epoch [42/200] batch [10/35] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.8979 (0.9184) acc_u 18.7500 (9.3750) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [15/35] time 0.175 (0.181) data 0.097 (0.104) loss_u loss_u 0.9775 (0.9214) acc_u 3.1250 (9.1667) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [20/35] time 0.177 (0.181) data 0.098 (0.104) loss_u loss_u 0.9595 (0.9199) acc_u 3.1250 (9.6875) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [25/35] time 0.175 (0.181) data 0.097 (0.103) loss_u loss_u 0.9219 (0.9152) acc_u 9.3750 (10.0000) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [30/35] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.9395 (0.9197) acc_u 6.2500 (9.5833) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [35/35] time 0.179 (0.179) data 0.102 (0.102) loss_u loss_u 0.9360 (0.9195) acc_u 6.2500 (9.2857) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 681
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 471
clean true:399
clean false:72
clean_rate:0.8471337579617835
noisy true:536
noisy false:609
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1145
epoch [43/200] batch [5/14] time 0.170 (0.182) data 0.093 (0.106) loss_x loss_x 0.4026 (0.8441) acc_x 84.3750 (78.1250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [10/14] time 0.171 (0.175) data 0.092 (0.098) loss_x loss_x 0.4998 (0.8229) acc_x 87.5000 (79.3750) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/35] time 0.177 (0.174) data 0.100 (0.097) loss_u loss_u 0.9834 (0.9208) acc_u 0.0000 (10.6250) lr 1.7997e-03 eta 0:00:05
epoch [43/200] batch [10/35] time 0.171 (0.173) data 0.094 (0.096) loss_u loss_u 0.9126 (0.9247) acc_u 12.5000 (10.0000) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [15/35] time 0.179 (0.173) data 0.101 (0.096) loss_u loss_u 0.9531 (0.9218) acc_u 9.3750 (9.5833) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/35] time 0.177 (0.174) data 0.100 (0.097) loss_u loss_u 0.9663 (0.9211) acc_u 3.1250 (9.3750) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [25/35] time 0.170 (0.174) data 0.093 (0.096) loss_u loss_u 0.9185 (0.9186) acc_u 12.5000 (10.0000) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/35] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.9473 (0.9173) acc_u 3.1250 (10.0000) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [35/35] time 0.171 (0.177) data 0.094 (0.099) loss_u loss_u 0.9683 (0.9182) acc_u 3.1250 (9.6429) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 697
confident_label rate tensor(0.2853, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 461
clean true:397
clean false:64
clean_rate:0.8611713665943601
noisy true:522
noisy false:633
after delete: len(clean_dataset) 461
after delete: len(noisy_dataset) 1155
epoch [44/200] batch [5/14] time 0.174 (0.172) data 0.097 (0.095) loss_x loss_x 0.8765 (0.8697) acc_x 75.0000 (78.7500) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [10/14] time 0.178 (0.178) data 0.101 (0.101) loss_x loss_x 0.6279 (0.8670) acc_x 75.0000 (77.8125) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/36] time 0.163 (0.180) data 0.086 (0.103) loss_u loss_u 0.9434 (0.9205) acc_u 6.2500 (8.7500) lr 1.7902e-03 eta 0:00:05
epoch [44/200] batch [10/36] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8628 (0.9132) acc_u 18.7500 (10.0000) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/36] time 0.162 (0.177) data 0.085 (0.100) loss_u loss_u 0.8213 (0.9129) acc_u 21.8750 (9.7917) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/36] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.9375 (0.9129) acc_u 6.2500 (9.6875) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [25/36] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.8130 (0.9069) acc_u 21.8750 (10.3750) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [30/36] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.8789 (0.9054) acc_u 12.5000 (10.6250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [35/36] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.8716 (0.9097) acc_u 15.6250 (10.2679) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 711
confident_label rate tensor(0.2778, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 449
clean true:393
clean false:56
clean_rate:0.8752783964365256
noisy true:512
noisy false:655
after delete: len(clean_dataset) 449
after delete: len(noisy_dataset) 1167
epoch [45/200] batch [5/14] time 0.163 (0.165) data 0.086 (0.088) loss_x loss_x 0.5488 (0.6361) acc_x 84.3750 (85.6250) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [10/14] time 0.164 (0.164) data 0.087 (0.087) loss_x loss_x 1.0264 (0.6575) acc_x 75.0000 (84.3750) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/36] time 0.187 (0.166) data 0.110 (0.089) loss_u loss_u 0.9077 (0.8713) acc_u 9.3750 (15.6250) lr 1.7804e-03 eta 0:00:05
epoch [45/200] batch [10/36] time 0.181 (0.169) data 0.102 (0.092) loss_u loss_u 0.9238 (0.8909) acc_u 12.5000 (13.4375) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/36] time 0.181 (0.172) data 0.103 (0.095) loss_u loss_u 0.8423 (0.8924) acc_u 15.6250 (12.9167) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/36] time 0.187 (0.174) data 0.110 (0.096) loss_u loss_u 0.9624 (0.9006) acc_u 6.2500 (11.7188) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [25/36] time 0.179 (0.175) data 0.101 (0.098) loss_u loss_u 0.8770 (0.8996) acc_u 12.5000 (11.6250) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [30/36] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.8398 (0.9011) acc_u 18.7500 (11.3542) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [35/36] time 0.165 (0.177) data 0.087 (0.099) loss_u loss_u 0.8774 (0.9043) acc_u 15.6250 (10.8929) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 700
confident_label rate tensor(0.2927, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 473
clean true:407
clean false:66
clean_rate:0.8604651162790697
noisy true:509
noisy false:634
after delete: len(clean_dataset) 473
after delete: len(noisy_dataset) 1143
epoch [46/200] batch [5/14] time 0.177 (0.177) data 0.099 (0.100) loss_x loss_x 0.7480 (0.8745) acc_x 71.8750 (77.5000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [10/14] time 0.186 (0.180) data 0.109 (0.102) loss_x loss_x 0.9102 (0.8366) acc_x 68.7500 (76.5625) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/35] time 0.189 (0.183) data 0.111 (0.105) loss_u loss_u 0.8804 (0.8879) acc_u 12.5000 (13.1250) lr 1.7705e-03 eta 0:00:05
epoch [46/200] batch [10/35] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.8657 (0.8935) acc_u 15.6250 (12.8125) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [15/35] time 0.188 (0.183) data 0.111 (0.105) loss_u loss_u 0.9570 (0.8958) acc_u 6.2500 (12.5000) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [20/35] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8262 (0.8983) acc_u 25.0000 (12.3438) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [25/35] time 0.187 (0.184) data 0.110 (0.106) loss_u loss_u 0.9321 (0.9024) acc_u 6.2500 (11.5000) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [30/35] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.8965 (0.9044) acc_u 9.3750 (11.0417) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [35/35] time 0.182 (0.184) data 0.105 (0.106) loss_u loss_u 0.9336 (0.9071) acc_u 9.3750 (10.9821) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.2958, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 478
clean true:406
clean false:72
clean_rate:0.8493723849372385
noisy true:546
noisy false:592
after delete: len(clean_dataset) 478
after delete: len(noisy_dataset) 1138
epoch [47/200] batch [5/14] time 0.180 (0.163) data 0.103 (0.086) loss_x loss_x 0.7852 (0.8736) acc_x 81.2500 (78.7500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [10/14] time 0.177 (0.171) data 0.100 (0.094) loss_x loss_x 0.8408 (0.8994) acc_x 71.8750 (77.1875) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/35] time 0.164 (0.172) data 0.087 (0.094) loss_u loss_u 0.9604 (0.9119) acc_u 3.1250 (10.0000) lr 1.7604e-03 eta 0:00:05
epoch [47/200] batch [10/35] time 0.163 (0.170) data 0.085 (0.092) loss_u loss_u 0.8989 (0.9139) acc_u 15.6250 (10.3125) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [15/35] time 0.166 (0.169) data 0.089 (0.091) loss_u loss_u 0.8589 (0.9087) acc_u 15.6250 (10.6250) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [20/35] time 0.160 (0.168) data 0.083 (0.091) loss_u loss_u 0.8989 (0.9116) acc_u 12.5000 (10.1562) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [25/35] time 0.187 (0.169) data 0.109 (0.092) loss_u loss_u 0.8955 (0.9112) acc_u 15.6250 (10.2500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/35] time 0.182 (0.170) data 0.104 (0.093) loss_u loss_u 0.8955 (0.9070) acc_u 12.5000 (10.7292) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [35/35] time 0.186 (0.172) data 0.109 (0.094) loss_u loss_u 0.8755 (0.9092) acc_u 12.5000 (10.7143) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 729
confident_label rate tensor(0.2884, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 466
clean true:392
clean false:74
clean_rate:0.8412017167381974
noisy true:495
noisy false:655
after delete: len(clean_dataset) 466
after delete: len(noisy_dataset) 1150
epoch [48/200] batch [5/14] time 0.172 (0.178) data 0.094 (0.100) loss_x loss_x 0.3086 (0.4859) acc_x 90.6250 (86.2500) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [10/14] time 0.165 (0.170) data 0.088 (0.092) loss_x loss_x 1.2148 (0.6617) acc_x 68.7500 (81.5625) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/35] time 0.171 (0.169) data 0.094 (0.092) loss_u loss_u 0.8647 (0.8924) acc_u 15.6250 (11.8750) lr 1.7501e-03 eta 0:00:05
epoch [48/200] batch [10/35] time 0.172 (0.170) data 0.095 (0.092) loss_u loss_u 0.9253 (0.9168) acc_u 6.2500 (9.3750) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [15/35] time 0.191 (0.171) data 0.112 (0.094) loss_u loss_u 0.9082 (0.9108) acc_u 9.3750 (10.0000) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [20/35] time 0.178 (0.172) data 0.099 (0.095) loss_u loss_u 0.8970 (0.9101) acc_u 12.5000 (10.1562) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [25/35] time 0.165 (0.173) data 0.088 (0.095) loss_u loss_u 0.8779 (0.9090) acc_u 18.7500 (10.2500) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [30/35] time 0.184 (0.172) data 0.105 (0.095) loss_u loss_u 0.8960 (0.9068) acc_u 9.3750 (10.3125) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [35/35] time 0.163 (0.173) data 0.085 (0.095) loss_u loss_u 0.9126 (0.9081) acc_u 6.2500 (10.2679) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 646
confident_label rate tensor(0.3051, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 493
clean true:429
clean false:64
clean_rate:0.8701825557809331
noisy true:541
noisy false:582
after delete: len(clean_dataset) 493
after delete: len(noisy_dataset) 1123
epoch [49/200] batch [5/15] time 0.162 (0.179) data 0.085 (0.102) loss_x loss_x 0.9263 (0.7071) acc_x 71.8750 (80.6250) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [10/15] time 0.176 (0.175) data 0.099 (0.098) loss_x loss_x 0.6772 (0.6492) acc_x 93.7500 (82.5000) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [15/15] time 0.166 (0.173) data 0.090 (0.096) loss_x loss_x 1.1641 (0.7010) acc_x 75.0000 (81.2500) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/35] time 0.163 (0.172) data 0.085 (0.095) loss_u loss_u 0.9888 (0.9111) acc_u 3.1250 (10.0000) lr 1.7396e-03 eta 0:00:05
epoch [49/200] batch [10/35] time 0.166 (0.172) data 0.089 (0.094) loss_u loss_u 0.9263 (0.9160) acc_u 12.5000 (10.3125) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [15/35] time 0.171 (0.172) data 0.094 (0.095) loss_u loss_u 0.9204 (0.9080) acc_u 12.5000 (11.0417) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/35] time 0.186 (0.173) data 0.108 (0.095) loss_u loss_u 0.9199 (0.9162) acc_u 6.2500 (9.8438) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [25/35] time 0.181 (0.173) data 0.103 (0.096) loss_u loss_u 0.9897 (0.9179) acc_u 0.0000 (9.5000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/35] time 0.172 (0.174) data 0.095 (0.096) loss_u loss_u 0.9106 (0.9156) acc_u 12.5000 (9.7917) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [35/35] time 0.171 (0.174) data 0.094 (0.096) loss_u loss_u 0.9546 (0.9156) acc_u 6.2500 (9.9107) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 700
confident_label rate tensor(0.2915, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 471
clean true:403
clean false:68
clean_rate:0.8556263269639066
noisy true:513
noisy false:632
after delete: len(clean_dataset) 471
after delete: len(noisy_dataset) 1145
epoch [50/200] batch [5/14] time 0.175 (0.166) data 0.099 (0.089) loss_x loss_x 0.8584 (0.7106) acc_x 78.1250 (82.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [10/14] time 0.158 (0.168) data 0.080 (0.091) loss_x loss_x 0.8926 (0.7894) acc_x 78.1250 (81.5625) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/35] time 0.171 (0.174) data 0.094 (0.097) loss_u loss_u 0.8979 (0.8851) acc_u 9.3750 (13.1250) lr 1.7290e-03 eta 0:00:05
epoch [50/200] batch [10/35] time 0.168 (0.172) data 0.091 (0.095) loss_u loss_u 0.8936 (0.8923) acc_u 12.5000 (12.5000) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [15/35] time 0.172 (0.172) data 0.093 (0.095) loss_u loss_u 0.9150 (0.8973) acc_u 9.3750 (11.8750) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [20/35] time 0.181 (0.173) data 0.102 (0.095) loss_u loss_u 0.9800 (0.9043) acc_u 3.1250 (11.2500) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [25/35] time 0.181 (0.174) data 0.103 (0.097) loss_u loss_u 0.8843 (0.9065) acc_u 12.5000 (11.0000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/35] time 0.183 (0.175) data 0.105 (0.098) loss_u loss_u 0.9321 (0.9111) acc_u 6.2500 (10.3125) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [35/35] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.8960 (0.9108) acc_u 9.3750 (10.2679) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 681
confident_label rate tensor(0.2976, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 481
clean true:407
clean false:74
clean_rate:0.8461538461538461
noisy true:528
noisy false:607
after delete: len(clean_dataset) 481
after delete: len(noisy_dataset) 1135
epoch [51/200] batch [5/15] time 0.181 (0.195) data 0.105 (0.118) loss_x loss_x 0.8789 (0.7495) acc_x 75.0000 (77.5000) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [10/15] time 0.173 (0.183) data 0.097 (0.106) loss_x loss_x 0.9785 (0.8160) acc_x 75.0000 (77.5000) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [15/15] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.9160 (0.7878) acc_x 84.3750 (79.7917) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/35] time 0.171 (0.179) data 0.094 (0.102) loss_u loss_u 0.9126 (0.9145) acc_u 9.3750 (8.1250) lr 1.7181e-03 eta 0:00:05
epoch [51/200] batch [10/35] time 0.164 (0.176) data 0.087 (0.099) loss_u loss_u 0.9258 (0.9213) acc_u 9.3750 (8.4375) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [15/35] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.9565 (0.9207) acc_u 3.1250 (8.5417) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/35] time 0.187 (0.175) data 0.110 (0.098) loss_u loss_u 0.9170 (0.9139) acc_u 9.3750 (9.6875) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [25/35] time 0.185 (0.176) data 0.109 (0.099) loss_u loss_u 0.9717 (0.9141) acc_u 6.2500 (9.8750) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [30/35] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.9360 (0.9086) acc_u 6.2500 (10.4167) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [35/35] time 0.182 (0.177) data 0.106 (0.100) loss_u loss_u 0.8667 (0.9117) acc_u 15.6250 (10.0893) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 711
confident_label rate tensor(0.2921, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 472
clean true:394
clean false:78
clean_rate:0.8347457627118644
noisy true:511
noisy false:633
after delete: len(clean_dataset) 472
after delete: len(noisy_dataset) 1144
epoch [52/200] batch [5/14] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.8682 (0.9900) acc_x 93.7500 (80.0000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [10/14] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.5771 (0.8589) acc_x 87.5000 (81.2500) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/35] time 0.183 (0.185) data 0.105 (0.108) loss_u loss_u 0.9951 (0.8735) acc_u 0.0000 (14.3750) lr 1.7071e-03 eta 0:00:05
epoch [52/200] batch [10/35] time 0.180 (0.185) data 0.104 (0.108) loss_u loss_u 0.9258 (0.8979) acc_u 9.3750 (11.5625) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/35] time 0.164 (0.185) data 0.087 (0.108) loss_u loss_u 0.7793 (0.8943) acc_u 25.0000 (12.2917) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/35] time 0.162 (0.184) data 0.085 (0.107) loss_u loss_u 0.9409 (0.8996) acc_u 6.2500 (11.8750) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [25/35] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8799 (0.9047) acc_u 15.6250 (11.5000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/35] time 0.201 (0.183) data 0.123 (0.106) loss_u loss_u 0.8994 (0.9028) acc_u 12.5000 (11.6667) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [35/35] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9492 (0.9044) acc_u 3.1250 (11.2500) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 691
confident_label rate tensor(0.3069, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 496
clean true:420
clean false:76
clean_rate:0.8467741935483871
noisy true:505
noisy false:615
after delete: len(clean_dataset) 496
after delete: len(noisy_dataset) 1120
epoch [53/200] batch [5/15] time 0.191 (0.186) data 0.114 (0.109) loss_x loss_x 0.7378 (0.7122) acc_x 78.1250 (78.7500) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [10/15] time 0.170 (0.181) data 0.092 (0.104) loss_x loss_x 0.4407 (0.7247) acc_x 84.3750 (77.5000) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [15/15] time 0.158 (0.177) data 0.081 (0.100) loss_x loss_x 0.8799 (0.7649) acc_x 78.1250 (77.2917) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/35] time 0.175 (0.175) data 0.098 (0.097) loss_u loss_u 0.8735 (0.9026) acc_u 12.5000 (11.2500) lr 1.6959e-03 eta 0:00:05
epoch [53/200] batch [10/35] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.8667 (0.8889) acc_u 15.6250 (12.8125) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [15/35] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.9692 (0.9071) acc_u 3.1250 (10.8333) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/35] time 0.182 (0.177) data 0.105 (0.099) loss_u loss_u 0.9346 (0.9110) acc_u 6.2500 (10.4688) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/35] time 0.185 (0.178) data 0.107 (0.100) loss_u loss_u 0.9385 (0.9165) acc_u 6.2500 (9.7500) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/35] time 0.184 (0.178) data 0.105 (0.101) loss_u loss_u 0.9634 (0.9177) acc_u 3.1250 (9.4792) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [35/35] time 0.185 (0.179) data 0.107 (0.101) loss_u loss_u 0.9780 (0.9189) acc_u 3.1250 (9.3750) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.2933, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 474
clean true:410
clean false:64
clean_rate:0.8649789029535865
noisy true:513
noisy false:629
after delete: len(clean_dataset) 474
after delete: len(noisy_dataset) 1142
epoch [54/200] batch [5/14] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 1.0391 (0.7719) acc_x 71.8750 (78.1250) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [10/14] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.9380 (0.8309) acc_x 71.8750 (77.1875) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/35] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8125 (0.9173) acc_u 21.8750 (10.6250) lr 1.6845e-03 eta 0:00:05
epoch [54/200] batch [10/35] time 0.163 (0.181) data 0.085 (0.104) loss_u loss_u 0.8726 (0.9332) acc_u 15.6250 (8.4375) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [15/35] time 0.170 (0.178) data 0.092 (0.101) loss_u loss_u 0.8906 (0.9087) acc_u 15.6250 (11.2500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [20/35] time 0.176 (0.178) data 0.098 (0.100) loss_u loss_u 0.8901 (0.9059) acc_u 15.6250 (11.5625) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [25/35] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9375 (0.9035) acc_u 6.2500 (11.7500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/35] time 0.166 (0.176) data 0.089 (0.099) loss_u loss_u 0.9829 (0.9096) acc_u 3.1250 (11.0417) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [35/35] time 0.179 (0.176) data 0.101 (0.098) loss_u loss_u 0.8613 (0.9083) acc_u 15.6250 (11.0714) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3007, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 486
clean true:417
clean false:69
clean_rate:0.8580246913580247
noisy true:521
noisy false:609
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1130
epoch [55/200] batch [5/15] time 0.187 (0.177) data 0.110 (0.101) loss_x loss_x 0.5093 (0.7712) acc_x 87.5000 (78.7500) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [10/15] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.3904 (0.8400) acc_x 90.6250 (78.7500) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [15/15] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.7783 (0.8556) acc_x 78.1250 (77.5000) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/35] time 0.189 (0.182) data 0.112 (0.105) loss_u loss_u 0.9131 (0.9242) acc_u 9.3750 (8.7500) lr 1.6730e-03 eta 0:00:05
epoch [55/200] batch [10/35] time 0.163 (0.181) data 0.086 (0.104) loss_u loss_u 0.9263 (0.9139) acc_u 9.3750 (10.9375) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/35] time 0.187 (0.180) data 0.110 (0.102) loss_u loss_u 0.8911 (0.9137) acc_u 12.5000 (11.4583) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/35] time 0.177 (0.179) data 0.100 (0.102) loss_u loss_u 0.8843 (0.9143) acc_u 12.5000 (10.7812) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/35] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9062 (0.9129) acc_u 15.6250 (11.1250) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/35] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9219 (0.9153) acc_u 6.2500 (10.5208) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [35/35] time 0.187 (0.180) data 0.109 (0.102) loss_u loss_u 0.9146 (0.9166) acc_u 9.3750 (10.4464) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 699
confident_label rate tensor(0.2964, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 479
clean true:409
clean false:70
clean_rate:0.8538622129436325
noisy true:508
noisy false:629
after delete: len(clean_dataset) 479
after delete: len(noisy_dataset) 1137
epoch [56/200] batch [5/14] time 0.204 (0.185) data 0.127 (0.108) loss_x loss_x 0.8096 (0.7287) acc_x 78.1250 (81.8750) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [10/14] time 0.162 (0.178) data 0.083 (0.100) loss_x loss_x 0.9663 (0.7413) acc_x 68.7500 (79.6875) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/35] time 0.167 (0.177) data 0.090 (0.099) loss_u loss_u 0.9424 (0.9125) acc_u 6.2500 (11.8750) lr 1.6613e-03 eta 0:00:05
epoch [56/200] batch [10/35] time 0.170 (0.175) data 0.093 (0.097) loss_u loss_u 0.9263 (0.9139) acc_u 9.3750 (10.0000) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [15/35] time 0.160 (0.173) data 0.082 (0.095) loss_u loss_u 0.9224 (0.9062) acc_u 9.3750 (11.2500) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [20/35] time 0.191 (0.175) data 0.113 (0.097) loss_u loss_u 0.9155 (0.9053) acc_u 12.5000 (11.0938) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [25/35] time 0.176 (0.175) data 0.099 (0.097) loss_u loss_u 0.9106 (0.9074) acc_u 9.3750 (10.6250) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [30/35] time 0.171 (0.176) data 0.093 (0.098) loss_u loss_u 0.9170 (0.9063) acc_u 12.5000 (10.8333) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [35/35] time 0.165 (0.175) data 0.088 (0.097) loss_u loss_u 0.9092 (0.9105) acc_u 12.5000 (10.3571) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.2952, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 477
clean true:411
clean false:66
clean_rate:0.8616352201257862
noisy true:527
noisy false:612
after delete: len(clean_dataset) 477
after delete: len(noisy_dataset) 1139
epoch [57/200] batch [5/14] time 0.164 (0.175) data 0.087 (0.098) loss_x loss_x 1.0537 (0.8382) acc_x 78.1250 (80.0000) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [10/14] time 0.172 (0.171) data 0.095 (0.094) loss_x loss_x 1.3359 (0.9043) acc_x 62.5000 (76.2500) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/35] time 0.166 (0.176) data 0.088 (0.099) loss_u loss_u 0.9526 (0.8866) acc_u 9.3750 (13.7500) lr 1.6494e-03 eta 0:00:05
epoch [57/200] batch [10/35] time 0.168 (0.174) data 0.091 (0.097) loss_u loss_u 0.9580 (0.8863) acc_u 3.1250 (13.1250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/35] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.9307 (0.9051) acc_u 6.2500 (11.0417) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/35] time 0.173 (0.174) data 0.094 (0.097) loss_u loss_u 0.9185 (0.9127) acc_u 9.3750 (9.8438) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/35] time 0.168 (0.173) data 0.090 (0.095) loss_u loss_u 0.8647 (0.9111) acc_u 9.3750 (9.7500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/35] time 0.171 (0.172) data 0.093 (0.095) loss_u loss_u 0.8872 (0.9099) acc_u 9.3750 (9.8958) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [35/35] time 0.163 (0.172) data 0.086 (0.095) loss_u loss_u 0.9336 (0.9122) acc_u 12.5000 (10.2679) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 692
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 504
clean true:430
clean false:74
clean_rate:0.8531746031746031
noisy true:494
noisy false:618
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1112
epoch [58/200] batch [5/15] time 0.161 (0.164) data 0.084 (0.088) loss_x loss_x 0.3853 (0.7371) acc_x 90.6250 (80.0000) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [10/15] time 0.176 (0.164) data 0.098 (0.087) loss_x loss_x 0.4268 (0.6734) acc_x 90.6250 (81.8750) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [15/15] time 0.175 (0.171) data 0.098 (0.094) loss_x loss_x 1.0107 (0.7381) acc_x 71.8750 (79.7917) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/34] time 0.183 (0.172) data 0.106 (0.095) loss_u loss_u 0.9087 (0.9157) acc_u 12.5000 (8.1250) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/34] time 0.184 (0.172) data 0.105 (0.095) loss_u loss_u 0.9575 (0.9228) acc_u 3.1250 (7.5000) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [15/34] time 0.173 (0.172) data 0.097 (0.095) loss_u loss_u 0.9131 (0.9160) acc_u 15.6250 (8.5417) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [20/34] time 0.188 (0.172) data 0.110 (0.094) loss_u loss_u 0.8774 (0.9155) acc_u 12.5000 (9.2188) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/34] time 0.183 (0.172) data 0.103 (0.094) loss_u loss_u 0.9170 (0.9171) acc_u 9.3750 (9.2500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/34] time 0.186 (0.173) data 0.108 (0.096) loss_u loss_u 0.8901 (0.9120) acc_u 12.5000 (9.8958) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 687
confident_label rate tensor(0.3001, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 485
clean true:411
clean false:74
clean_rate:0.8474226804123711
noisy true:518
noisy false:613
after delete: len(clean_dataset) 485
after delete: len(noisy_dataset) 1131
epoch [59/200] batch [5/15] time 0.176 (0.185) data 0.099 (0.109) loss_x loss_x 0.8740 (0.8533) acc_x 71.8750 (78.1250) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [10/15] time 0.170 (0.182) data 0.094 (0.105) loss_x loss_x 0.5732 (0.7490) acc_x 84.3750 (80.6250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [15/15] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.5840 (0.7162) acc_x 81.2500 (80.8333) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/35] time 0.181 (0.179) data 0.103 (0.102) loss_u loss_u 0.8789 (0.9248) acc_u 15.6250 (9.3750) lr 1.6252e-03 eta 0:00:05
epoch [59/200] batch [10/35] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.8848 (0.9064) acc_u 15.6250 (11.5625) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [15/35] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.9546 (0.9117) acc_u 6.2500 (11.2500) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [20/35] time 0.184 (0.178) data 0.105 (0.101) loss_u loss_u 0.8560 (0.9054) acc_u 15.6250 (11.5625) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [25/35] time 0.163 (0.176) data 0.086 (0.099) loss_u loss_u 0.9116 (0.9038) acc_u 12.5000 (11.7500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/35] time 0.176 (0.176) data 0.098 (0.099) loss_u loss_u 0.9219 (0.9076) acc_u 6.2500 (10.9375) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [35/35] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.9492 (0.9086) acc_u 3.1250 (10.8036) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 683
confident_label rate tensor(0.2946, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 476
clean true:408
clean false:68
clean_rate:0.8571428571428571
noisy true:525
noisy false:615
after delete: len(clean_dataset) 476
after delete: len(noisy_dataset) 1140
epoch [60/200] batch [5/14] time 0.187 (0.177) data 0.110 (0.100) loss_x loss_x 0.6113 (0.7101) acc_x 87.5000 (84.3750) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [10/14] time 0.173 (0.174) data 0.095 (0.097) loss_x loss_x 1.0225 (0.7178) acc_x 68.7500 (80.9375) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/35] time 0.184 (0.176) data 0.106 (0.098) loss_u loss_u 0.9268 (0.8742) acc_u 9.3750 (13.7500) lr 1.6129e-03 eta 0:00:05
epoch [60/200] batch [10/35] time 0.172 (0.176) data 0.093 (0.098) loss_u loss_u 0.9014 (0.8922) acc_u 9.3750 (11.2500) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [15/35] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.8765 (0.8976) acc_u 15.6250 (11.2500) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [20/35] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.9009 (0.8989) acc_u 15.6250 (11.8750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/35] time 0.167 (0.175) data 0.089 (0.098) loss_u loss_u 0.8872 (0.9036) acc_u 15.6250 (11.5000) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [30/35] time 0.187 (0.177) data 0.109 (0.099) loss_u loss_u 0.8242 (0.9050) acc_u 25.0000 (11.4583) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [35/35] time 0.175 (0.178) data 0.096 (0.100) loss_u loss_u 0.8418 (0.9041) acc_u 15.6250 (11.1607) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.3131, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 506
clean true:418
clean false:88
clean_rate:0.8260869565217391
noisy true:508
noisy false:602
after delete: len(clean_dataset) 506
after delete: len(noisy_dataset) 1110
epoch [61/200] batch [5/15] time 0.179 (0.170) data 0.103 (0.093) loss_x loss_x 1.0703 (0.7777) acc_x 78.1250 (82.5000) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [10/15] time 0.168 (0.173) data 0.092 (0.096) loss_x loss_x 0.6846 (0.7287) acc_x 87.5000 (83.1250) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [15/15] time 0.178 (0.175) data 0.101 (0.097) loss_x loss_x 1.0898 (0.7606) acc_x 68.7500 (81.2500) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/34] time 0.176 (0.175) data 0.098 (0.097) loss_u loss_u 0.9492 (0.9352) acc_u 6.2500 (8.7500) lr 1.6004e-03 eta 0:00:05
epoch [61/200] batch [10/34] time 0.188 (0.176) data 0.109 (0.099) loss_u loss_u 0.9507 (0.9254) acc_u 3.1250 (9.3750) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [15/34] time 0.167 (0.176) data 0.090 (0.098) loss_u loss_u 0.8940 (0.9225) acc_u 12.5000 (9.7917) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [20/34] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.9360 (0.9237) acc_u 6.2500 (9.5312) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [25/34] time 0.161 (0.175) data 0.083 (0.098) loss_u loss_u 0.9004 (0.9156) acc_u 9.3750 (10.3750) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [30/34] time 0.165 (0.176) data 0.088 (0.099) loss_u loss_u 0.9150 (0.9136) acc_u 9.3750 (10.3125) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 667
confident_label rate tensor(0.3106, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 502
clean true:431
clean false:71
clean_rate:0.8585657370517928
noisy true:518
noisy false:596
after delete: len(clean_dataset) 502
after delete: len(noisy_dataset) 1114
epoch [62/200] batch [5/15] time 0.168 (0.172) data 0.092 (0.095) loss_x loss_x 1.1533 (0.8934) acc_x 65.6250 (75.6250) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [10/15] time 0.185 (0.176) data 0.108 (0.099) loss_x loss_x 0.9229 (0.8331) acc_x 78.1250 (76.5625) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [15/15] time 0.192 (0.175) data 0.115 (0.098) loss_x loss_x 0.7954 (0.8550) acc_x 81.2500 (76.6667) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/34] time 0.193 (0.176) data 0.116 (0.099) loss_u loss_u 0.8862 (0.9045) acc_u 12.5000 (10.6250) lr 1.5878e-03 eta 0:00:05
epoch [62/200] batch [10/34] time 0.179 (0.177) data 0.100 (0.100) loss_u loss_u 0.7896 (0.9078) acc_u 21.8750 (10.3125) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [15/34] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.8398 (0.9096) acc_u 21.8750 (10.4167) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [20/34] time 0.171 (0.177) data 0.094 (0.099) loss_u loss_u 0.9468 (0.9182) acc_u 9.3750 (9.2188) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/34] time 0.185 (0.176) data 0.107 (0.098) loss_u loss_u 0.9546 (0.9228) acc_u 6.2500 (8.8750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/34] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.9482 (0.9196) acc_u 6.2500 (9.3750) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.3038, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 491
clean true:422
clean false:69
clean_rate:0.8594704684317719
noisy true:545
noisy false:580
after delete: len(clean_dataset) 491
after delete: len(noisy_dataset) 1125
epoch [63/200] batch [5/15] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.2788 (0.6662) acc_x 90.6250 (85.0000) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [10/15] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5835 (0.7226) acc_x 84.3750 (81.8750) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [15/15] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.4597 (0.7400) acc_x 90.6250 (82.5000) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/35] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9048 (0.9228) acc_u 9.3750 (8.7500) lr 1.5750e-03 eta 0:00:05
epoch [63/200] batch [10/35] time 0.186 (0.186) data 0.107 (0.108) loss_u loss_u 0.8618 (0.9220) acc_u 18.7500 (9.3750) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [15/35] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9570 (0.9133) acc_u 6.2500 (11.0417) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [20/35] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9482 (0.9190) acc_u 6.2500 (9.8438) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/35] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9429 (0.9143) acc_u 6.2500 (10.3750) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/35] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9424 (0.9144) acc_u 6.2500 (10.5208) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [35/35] time 0.188 (0.184) data 0.109 (0.106) loss_u loss_u 0.9434 (0.9122) acc_u 6.2500 (10.7143) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.3014, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 487
clean true:416
clean false:71
clean_rate:0.8542094455852156
noisy true:514
noisy false:615
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1129
epoch [64/200] batch [5/15] time 0.173 (0.174) data 0.096 (0.098) loss_x loss_x 0.9561 (0.8308) acc_x 75.0000 (79.3750) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [10/15] time 0.169 (0.170) data 0.092 (0.093) loss_x loss_x 0.6768 (0.7248) acc_x 90.6250 (82.8125) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [15/15] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 1.0430 (0.7776) acc_x 78.1250 (81.0417) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/35] time 0.170 (0.168) data 0.093 (0.091) loss_u loss_u 0.9619 (0.9003) acc_u 3.1250 (10.6250) lr 1.5621e-03 eta 0:00:05
epoch [64/200] batch [10/35] time 0.184 (0.171) data 0.106 (0.094) loss_u loss_u 0.9312 (0.9141) acc_u 9.3750 (9.6875) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [15/35] time 0.184 (0.172) data 0.107 (0.095) loss_u loss_u 0.9136 (0.9183) acc_u 12.5000 (9.3750) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [20/35] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.9141 (0.9093) acc_u 12.5000 (10.3125) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/35] time 0.164 (0.174) data 0.087 (0.097) loss_u loss_u 0.8438 (0.9034) acc_u 15.6250 (11.2500) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/35] time 0.182 (0.174) data 0.104 (0.097) loss_u loss_u 0.9077 (0.9031) acc_u 9.3750 (11.0417) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [35/35] time 0.167 (0.174) data 0.091 (0.097) loss_u loss_u 0.9180 (0.9023) acc_u 6.2500 (11.1607) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 680
confident_label rate tensor(0.3032, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 490
clean true:419
clean false:71
clean_rate:0.8551020408163266
noisy true:517
noisy false:609
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1126
epoch [65/200] batch [5/15] time 0.188 (0.185) data 0.111 (0.108) loss_x loss_x 0.3220 (0.6982) acc_x 93.7500 (80.6250) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [10/15] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.7017 (0.6605) acc_x 75.0000 (81.2500) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [15/15] time 0.188 (0.185) data 0.109 (0.108) loss_x loss_x 0.5083 (0.6668) acc_x 78.1250 (80.8333) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/35] time 0.185 (0.185) data 0.109 (0.108) loss_u loss_u 0.9424 (0.9127) acc_u 9.3750 (10.6250) lr 1.5490e-03 eta 0:00:05
epoch [65/200] batch [10/35] time 0.186 (0.185) data 0.109 (0.108) loss_u loss_u 0.9136 (0.8901) acc_u 9.3750 (12.5000) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [15/35] time 0.178 (0.183) data 0.100 (0.106) loss_u loss_u 0.9043 (0.9019) acc_u 12.5000 (11.0417) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [20/35] time 0.163 (0.182) data 0.086 (0.105) loss_u loss_u 0.9507 (0.9025) acc_u 6.2500 (11.0938) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [25/35] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.8984 (0.9040) acc_u 12.5000 (11.0000) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [30/35] time 0.160 (0.179) data 0.083 (0.102) loss_u loss_u 0.8301 (0.9058) acc_u 18.7500 (10.6250) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [35/35] time 0.163 (0.177) data 0.086 (0.100) loss_u loss_u 0.9546 (0.9076) acc_u 6.2500 (10.3571) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 666
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:429
clean false:79
clean_rate:0.844488188976378
noisy true:521
noisy false:587
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [66/200] batch [5/15] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.6924 (0.8146) acc_x 87.5000 (78.1250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [10/15] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.7969 (0.7549) acc_x 75.0000 (80.3125) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [15/15] time 0.186 (0.184) data 0.108 (0.107) loss_x loss_x 0.4871 (0.7482) acc_x 87.5000 (80.0000) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/34] time 0.169 (0.181) data 0.092 (0.104) loss_u loss_u 0.9844 (0.9309) acc_u 6.2500 (8.1250) lr 1.5358e-03 eta 0:00:05
epoch [66/200] batch [10/34] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.9229 (0.9164) acc_u 9.3750 (9.6875) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [15/34] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9316 (0.9243) acc_u 9.3750 (8.7500) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [20/34] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.8740 (0.9219) acc_u 9.3750 (8.9062) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/34] time 0.165 (0.182) data 0.088 (0.105) loss_u loss_u 0.9263 (0.9246) acc_u 6.2500 (8.2500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/34] time 0.172 (0.182) data 0.095 (0.104) loss_u loss_u 0.8569 (0.9192) acc_u 15.6250 (9.0625) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3014, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 487
clean true:415
clean false:72
clean_rate:0.8521560574948666
noisy true:523
noisy false:606
after delete: len(clean_dataset) 487
after delete: len(noisy_dataset) 1129
epoch [67/200] batch [5/15] time 0.167 (0.165) data 0.090 (0.088) loss_x loss_x 0.9985 (0.9284) acc_x 71.8750 (76.2500) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [10/15] time 0.186 (0.176) data 0.108 (0.099) loss_x loss_x 0.8311 (0.8171) acc_x 81.2500 (78.4375) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [15/15] time 0.162 (0.175) data 0.085 (0.098) loss_x loss_x 0.5000 (0.8342) acc_x 90.6250 (77.5000) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/35] time 0.190 (0.175) data 0.112 (0.098) loss_u loss_u 0.9639 (0.8990) acc_u 6.2500 (11.2500) lr 1.5225e-03 eta 0:00:05
epoch [67/200] batch [10/35] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9219 (0.8840) acc_u 9.3750 (12.8125) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [15/35] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.8638 (0.8864) acc_u 15.6250 (12.5000) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [20/35] time 0.166 (0.181) data 0.089 (0.103) loss_u loss_u 0.9277 (0.8947) acc_u 9.3750 (11.5625) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [25/35] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9336 (0.9016) acc_u 6.2500 (10.8750) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/35] time 0.177 (0.181) data 0.099 (0.103) loss_u loss_u 0.9434 (0.9049) acc_u 3.1250 (10.5208) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [35/35] time 0.169 (0.180) data 0.092 (0.103) loss_u loss_u 0.9048 (0.9065) acc_u 9.3750 (10.3571) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.3032, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 490
clean true:418
clean false:72
clean_rate:0.8530612244897959
noisy true:524
noisy false:602
after delete: len(clean_dataset) 490
after delete: len(noisy_dataset) 1126
epoch [68/200] batch [5/15] time 0.186 (0.185) data 0.108 (0.107) loss_x loss_x 0.4548 (0.6253) acc_x 90.6250 (83.1250) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [10/15] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.8418 (0.6599) acc_x 68.7500 (82.1875) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [15/15] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.5542 (0.6846) acc_x 87.5000 (81.4583) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/35] time 0.188 (0.185) data 0.110 (0.108) loss_u loss_u 0.8965 (0.8800) acc_u 9.3750 (13.1250) lr 1.5090e-03 eta 0:00:05
epoch [68/200] batch [10/35] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.8857 (0.8995) acc_u 12.5000 (11.8750) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [15/35] time 0.187 (0.186) data 0.109 (0.108) loss_u loss_u 0.9048 (0.8927) acc_u 9.3750 (12.5000) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [20/35] time 0.189 (0.185) data 0.111 (0.108) loss_u loss_u 0.8706 (0.8921) acc_u 12.5000 (12.8125) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/35] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9038 (0.8994) acc_u 12.5000 (12.0000) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/35] time 0.179 (0.185) data 0.102 (0.108) loss_u loss_u 0.8955 (0.9031) acc_u 12.5000 (11.6667) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [35/35] time 0.182 (0.185) data 0.104 (0.107) loss_u loss_u 0.9644 (0.9047) acc_u 6.2500 (11.4286) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.3075, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 497
clean true:415
clean false:82
clean_rate:0.8350100603621731
noisy true:519
noisy false:600
after delete: len(clean_dataset) 497
after delete: len(noisy_dataset) 1119
epoch [69/200] batch [5/15] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.8013 (0.6069) acc_x 75.0000 (82.5000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [10/15] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.3789 (0.7025) acc_x 93.7500 (80.9375) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [15/15] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.9985 (0.7522) acc_x 78.1250 (80.0000) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/34] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.8745 (0.8887) acc_u 15.6250 (12.5000) lr 1.4955e-03 eta 0:00:05
epoch [69/200] batch [10/34] time 0.178 (0.183) data 0.101 (0.106) loss_u loss_u 0.9019 (0.9092) acc_u 9.3750 (10.6250) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [15/34] time 0.180 (0.183) data 0.102 (0.106) loss_u loss_u 0.9219 (0.9076) acc_u 9.3750 (10.6250) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [20/34] time 0.175 (0.183) data 0.095 (0.105) loss_u loss_u 0.8906 (0.9119) acc_u 15.6250 (10.3125) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [25/34] time 0.181 (0.183) data 0.103 (0.105) loss_u loss_u 0.9546 (0.9126) acc_u 6.2500 (10.5000) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [30/34] time 0.174 (0.182) data 0.096 (0.104) loss_u loss_u 0.9756 (0.9113) acc_u 3.1250 (10.6250) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 504
clean true:429
clean false:75
clean_rate:0.8511904761904762
noisy true:511
noisy false:601
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1112
epoch [70/200] batch [5/15] time 0.164 (0.165) data 0.086 (0.088) loss_x loss_x 0.5991 (0.7534) acc_x 81.2500 (79.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [10/15] time 0.186 (0.169) data 0.109 (0.092) loss_x loss_x 0.3254 (0.6691) acc_x 90.6250 (82.5000) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [15/15] time 0.171 (0.170) data 0.093 (0.093) loss_x loss_x 0.6558 (0.6277) acc_x 81.2500 (83.3333) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/34] time 0.163 (0.171) data 0.084 (0.094) loss_u loss_u 0.8228 (0.9236) acc_u 18.7500 (7.5000) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [10/34] time 0.181 (0.170) data 0.103 (0.093) loss_u loss_u 0.9131 (0.9188) acc_u 9.3750 (8.7500) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [15/34] time 0.177 (0.172) data 0.099 (0.095) loss_u loss_u 0.9097 (0.9156) acc_u 12.5000 (9.1667) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [20/34] time 0.160 (0.171) data 0.082 (0.093) loss_u loss_u 0.8691 (0.9108) acc_u 12.5000 (9.3750) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [25/34] time 0.182 (0.172) data 0.102 (0.094) loss_u loss_u 0.9009 (0.9048) acc_u 12.5000 (10.2500) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [30/34] time 0.173 (0.172) data 0.096 (0.094) loss_u loss_u 0.9146 (0.9090) acc_u 9.3750 (10.0000) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.3193, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 516
clean true:441
clean false:75
clean_rate:0.8546511627906976
noisy true:523
noisy false:577
after delete: len(clean_dataset) 516
after delete: len(noisy_dataset) 1100
epoch [71/200] batch [5/16] time 0.225 (0.193) data 0.149 (0.116) loss_x loss_x 0.5010 (0.6421) acc_x 90.6250 (82.5000) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/16] time 0.181 (0.189) data 0.105 (0.112) loss_x loss_x 0.8477 (0.7696) acc_x 78.1250 (80.6250) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/16] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.7007 (0.7251) acc_x 81.2500 (81.0417) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/34] time 0.185 (0.187) data 0.109 (0.110) loss_u loss_u 0.8906 (0.9081) acc_u 12.5000 (11.2500) lr 1.4679e-03 eta 0:00:05
epoch [71/200] batch [10/34] time 0.184 (0.186) data 0.107 (0.110) loss_u loss_u 0.8442 (0.9005) acc_u 15.6250 (11.8750) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [15/34] time 0.183 (0.186) data 0.106 (0.109) loss_u loss_u 0.9565 (0.9041) acc_u 3.1250 (10.8333) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [20/34] time 0.207 (0.187) data 0.129 (0.110) loss_u loss_u 0.8936 (0.9103) acc_u 9.3750 (9.8438) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [25/34] time 0.161 (0.185) data 0.084 (0.108) loss_u loss_u 0.9043 (0.9125) acc_u 9.3750 (9.5000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [30/34] time 0.167 (0.184) data 0.090 (0.107) loss_u loss_u 0.8384 (0.9096) acc_u 21.8750 (10.0000) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.3261, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 527
clean true:436
clean false:91
clean_rate:0.8273244781783681
noisy true:531
noisy false:558
after delete: len(clean_dataset) 527
after delete: len(noisy_dataset) 1089
epoch [72/200] batch [5/16] time 0.172 (0.179) data 0.094 (0.102) loss_x loss_x 0.8770 (0.8210) acc_x 87.5000 (80.6250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [10/16] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.8379 (0.7734) acc_x 71.8750 (79.6875) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/16] time 0.182 (0.180) data 0.105 (0.103) loss_x loss_x 0.5103 (0.7201) acc_x 90.6250 (81.8750) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/34] time 0.174 (0.179) data 0.096 (0.102) loss_u loss_u 0.8232 (0.9035) acc_u 21.8750 (11.2500) lr 1.4540e-03 eta 0:00:05
epoch [72/200] batch [10/34] time 0.188 (0.180) data 0.110 (0.102) loss_u loss_u 0.9463 (0.9210) acc_u 9.3750 (9.3750) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [15/34] time 0.170 (0.178) data 0.092 (0.101) loss_u loss_u 0.9624 (0.9265) acc_u 6.2500 (8.9583) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [20/34] time 0.160 (0.176) data 0.083 (0.099) loss_u loss_u 0.9468 (0.9279) acc_u 6.2500 (8.5938) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [25/34] time 0.172 (0.177) data 0.095 (0.099) loss_u loss_u 0.8013 (0.9216) acc_u 21.8750 (9.2500) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [30/34] time 0.178 (0.177) data 0.101 (0.100) loss_u loss_u 0.9038 (0.9213) acc_u 9.3750 (9.0625) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 662
confident_label rate tensor(0.3224, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 521
clean true:447
clean false:74
clean_rate:0.8579654510556622
noisy true:507
noisy false:588
after delete: len(clean_dataset) 521
after delete: len(noisy_dataset) 1095
epoch [73/200] batch [5/16] time 0.175 (0.170) data 0.098 (0.093) loss_x loss_x 0.3284 (0.6895) acc_x 96.8750 (85.6250) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [10/16] time 0.170 (0.173) data 0.094 (0.096) loss_x loss_x 0.8682 (0.7015) acc_x 75.0000 (83.4375) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/16] time 0.184 (0.173) data 0.106 (0.096) loss_x loss_x 0.6084 (0.6911) acc_x 81.2500 (82.5000) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/34] time 0.174 (0.175) data 0.096 (0.098) loss_u loss_u 0.9058 (0.9541) acc_u 9.3750 (5.0000) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [10/34] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9438 (0.9473) acc_u 9.3750 (6.2500) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [15/34] time 0.198 (0.179) data 0.120 (0.102) loss_u loss_u 0.8496 (0.9324) acc_u 18.7500 (8.5417) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/34] time 0.189 (0.181) data 0.111 (0.104) loss_u loss_u 0.9238 (0.9315) acc_u 9.3750 (8.4375) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/34] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9292 (0.9297) acc_u 9.3750 (9.0000) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [30/34] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.8516 (0.9220) acc_u 15.6250 (9.4792) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 655
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:435
clean false:72
clean_rate:0.8579881656804734
noisy true:526
noisy false:583
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [74/200] batch [5/15] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6743 (0.6257) acc_x 87.5000 (87.5000) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [10/15] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.7847 (0.7294) acc_x 75.0000 (81.5625) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [15/15] time 0.172 (0.183) data 0.095 (0.106) loss_x loss_x 0.8950 (0.7316) acc_x 81.2500 (81.0417) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/34] time 0.189 (0.183) data 0.111 (0.106) loss_u loss_u 0.8652 (0.8966) acc_u 15.6250 (12.5000) lr 1.4258e-03 eta 0:00:05
epoch [74/200] batch [10/34] time 0.185 (0.183) data 0.109 (0.106) loss_u loss_u 0.9053 (0.9172) acc_u 12.5000 (10.3125) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/34] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.8384 (0.9082) acc_u 18.7500 (11.0417) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/34] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9355 (0.9049) acc_u 6.2500 (11.4062) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/34] time 0.213 (0.184) data 0.136 (0.107) loss_u loss_u 0.8911 (0.9113) acc_u 9.3750 (10.5000) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [30/34] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8862 (0.9125) acc_u 12.5000 (10.5208) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 651
confident_label rate tensor(0.3218, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 520
clean true:439
clean false:81
clean_rate:0.8442307692307692
noisy true:526
noisy false:570
after delete: len(clean_dataset) 520
after delete: len(noisy_dataset) 1096
epoch [75/200] batch [5/16] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 1.4219 (0.9608) acc_x 65.6250 (74.3750) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [10/16] time 0.173 (0.175) data 0.096 (0.098) loss_x loss_x 0.6787 (0.9161) acc_x 81.2500 (75.3125) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/16] time 0.163 (0.172) data 0.086 (0.095) loss_x loss_x 0.5991 (0.8667) acc_x 84.3750 (77.0833) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/34] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.9155 (0.8992) acc_u 9.3750 (11.2500) lr 1.4115e-03 eta 0:00:05
epoch [75/200] batch [10/34] time 0.186 (0.173) data 0.109 (0.096) loss_u loss_u 0.8901 (0.8868) acc_u 15.6250 (13.1250) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/34] time 0.167 (0.172) data 0.090 (0.095) loss_u loss_u 0.9160 (0.9021) acc_u 12.5000 (11.2500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/34] time 0.162 (0.172) data 0.084 (0.094) loss_u loss_u 0.8511 (0.9001) acc_u 18.7500 (11.4062) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/34] time 0.161 (0.171) data 0.084 (0.093) loss_u loss_u 0.9312 (0.9066) acc_u 9.3750 (11.0000) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [30/34] time 0.170 (0.171) data 0.093 (0.093) loss_u loss_u 0.9619 (0.9065) acc_u 6.2500 (11.2500) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 504
clean true:427
clean false:77
clean_rate:0.8472222222222222
noisy true:499
noisy false:613
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1112
epoch [76/200] batch [5/15] time 0.193 (0.200) data 0.116 (0.123) loss_x loss_x 0.7344 (0.7524) acc_x 81.2500 (78.7500) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/15] time 0.184 (0.192) data 0.107 (0.115) loss_x loss_x 0.7598 (0.8055) acc_x 81.2500 (78.1250) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [15/15] time 0.201 (0.191) data 0.124 (0.113) loss_x loss_x 0.7041 (0.7208) acc_x 84.3750 (80.8333) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/34] time 0.185 (0.190) data 0.107 (0.113) loss_u loss_u 0.9116 (0.9129) acc_u 12.5000 (10.6250) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [10/34] time 0.216 (0.194) data 0.139 (0.117) loss_u loss_u 0.9023 (0.8889) acc_u 12.5000 (13.4375) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [15/34] time 0.174 (0.192) data 0.095 (0.114) loss_u loss_u 0.9150 (0.8869) acc_u 9.3750 (13.5417) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/34] time 0.180 (0.189) data 0.103 (0.112) loss_u loss_u 0.9175 (0.8962) acc_u 6.2500 (11.8750) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/34] time 0.203 (0.188) data 0.126 (0.110) loss_u loss_u 0.8623 (0.9032) acc_u 18.7500 (11.1250) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/34] time 0.178 (0.187) data 0.101 (0.109) loss_u loss_u 0.9595 (0.9019) acc_u 3.1250 (11.1458) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.3205, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 518
clean true:425
clean false:93
clean_rate:0.8204633204633205
noisy true:515
noisy false:583
after delete: len(clean_dataset) 518
after delete: len(noisy_dataset) 1098
epoch [77/200] batch [5/16] time 0.162 (0.163) data 0.085 (0.085) loss_x loss_x 0.7070 (0.7686) acc_x 78.1250 (80.6250) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [10/16] time 0.177 (0.171) data 0.099 (0.093) loss_x loss_x 0.8667 (0.7680) acc_x 71.8750 (80.0000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/16] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.7837 (0.7359) acc_x 78.1250 (80.4167) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/34] time 0.169 (0.175) data 0.092 (0.097) loss_u loss_u 0.9131 (0.9197) acc_u 12.5000 (9.3750) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/34] time 0.187 (0.175) data 0.110 (0.098) loss_u loss_u 0.9585 (0.9215) acc_u 6.2500 (9.6875) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [15/34] time 0.172 (0.176) data 0.094 (0.098) loss_u loss_u 0.9727 (0.9283) acc_u 3.1250 (8.7500) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/34] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.9546 (0.9259) acc_u 3.1250 (8.7500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/34] time 0.183 (0.175) data 0.105 (0.098) loss_u loss_u 0.8818 (0.9123) acc_u 15.6250 (10.3750) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/34] time 0.163 (0.175) data 0.085 (0.097) loss_u loss_u 0.9277 (0.9124) acc_u 12.5000 (10.7292) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 689
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 517
clean true:421
clean false:96
clean_rate:0.8143133462282398
noisy true:506
noisy false:593
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1099
epoch [78/200] batch [5/16] time 0.165 (0.163) data 0.088 (0.087) loss_x loss_x 0.5508 (0.7039) acc_x 87.5000 (79.3750) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [10/16] time 0.179 (0.170) data 0.102 (0.093) loss_x loss_x 0.5508 (0.7423) acc_x 87.5000 (80.6250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/16] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.8447 (0.7884) acc_x 71.8750 (79.3750) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/34] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.9106 (0.9275) acc_u 9.3750 (7.5000) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [10/34] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.9121 (0.9293) acc_u 9.3750 (7.8125) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [15/34] time 0.171 (0.178) data 0.093 (0.101) loss_u loss_u 0.8408 (0.9193) acc_u 18.7500 (8.7500) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/34] time 0.170 (0.179) data 0.092 (0.102) loss_u loss_u 0.9170 (0.9175) acc_u 9.3750 (9.2188) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/34] time 0.188 (0.180) data 0.109 (0.102) loss_u loss_u 0.9170 (0.9118) acc_u 6.2500 (9.6250) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [30/34] time 0.161 (0.180) data 0.083 (0.103) loss_u loss_u 0.9043 (0.9095) acc_u 6.2500 (9.8958) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 701
confident_label rate tensor(0.3137, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 507
clean true:415
clean false:92
clean_rate:0.8185404339250493
noisy true:500
noisy false:609
after delete: len(clean_dataset) 507
after delete: len(noisy_dataset) 1109
epoch [79/200] batch [5/15] time 0.165 (0.174) data 0.087 (0.097) loss_x loss_x 0.3870 (0.5990) acc_x 96.8750 (85.0000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [10/15] time 0.179 (0.176) data 0.103 (0.099) loss_x loss_x 0.8496 (0.6196) acc_x 71.8750 (84.0625) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [15/15] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 1.1826 (0.6851) acc_x 65.6250 (82.2917) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/34] time 0.185 (0.180) data 0.108 (0.102) loss_u loss_u 0.9409 (0.9527) acc_u 3.1250 (3.7500) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [10/34] time 0.193 (0.182) data 0.116 (0.105) loss_u loss_u 0.7891 (0.9208) acc_u 21.8750 (7.5000) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [15/34] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.9141 (0.9086) acc_u 9.3750 (10.0000) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/34] time 0.185 (0.185) data 0.109 (0.108) loss_u loss_u 0.9858 (0.9133) acc_u 3.1250 (9.5312) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/34] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.9702 (0.9182) acc_u 3.1250 (9.0000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [30/34] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9004 (0.9163) acc_u 15.6250 (9.3750) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.3181, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 514
clean true:426
clean false:88
clean_rate:0.8287937743190662
noisy true:508
noisy false:594
after delete: len(clean_dataset) 514
after delete: len(noisy_dataset) 1102
epoch [80/200] batch [5/16] time 0.186 (0.196) data 0.110 (0.119) loss_x loss_x 1.3096 (1.0478) acc_x 78.1250 (76.8750) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/16] time 0.183 (0.192) data 0.107 (0.115) loss_x loss_x 0.8804 (0.8906) acc_x 78.1250 (80.0000) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/16] time 0.186 (0.190) data 0.108 (0.113) loss_x loss_x 0.7788 (0.8645) acc_x 84.3750 (80.2083) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/34] time 0.185 (0.189) data 0.108 (0.111) loss_u loss_u 0.8740 (0.9068) acc_u 15.6250 (10.6250) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/34] time 0.183 (0.187) data 0.106 (0.110) loss_u loss_u 0.9019 (0.9028) acc_u 12.5000 (11.5625) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/34] time 0.187 (0.187) data 0.109 (0.110) loss_u loss_u 0.9111 (0.8990) acc_u 9.3750 (12.5000) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/34] time 0.161 (0.185) data 0.083 (0.108) loss_u loss_u 0.9077 (0.8968) acc_u 12.5000 (12.5000) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [25/34] time 0.180 (0.184) data 0.102 (0.107) loss_u loss_u 0.9507 (0.9003) acc_u 6.2500 (12.2500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/34] time 0.176 (0.184) data 0.098 (0.106) loss_u loss_u 0.8745 (0.9028) acc_u 15.6250 (11.8750) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.3212, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 519
clean true:430
clean false:89
clean_rate:0.8285163776493256
noisy true:502
noisy false:595
after delete: len(clean_dataset) 519
after delete: len(noisy_dataset) 1097
epoch [81/200] batch [5/16] time 0.196 (0.193) data 0.120 (0.115) loss_x loss_x 0.8159 (0.6637) acc_x 84.3750 (86.2500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/16] time 0.185 (0.190) data 0.108 (0.113) loss_x loss_x 1.0137 (0.7289) acc_x 71.8750 (83.1250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/16] time 0.186 (0.189) data 0.108 (0.112) loss_x loss_x 0.6802 (0.7024) acc_x 84.3750 (84.1667) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/34] time 0.186 (0.188) data 0.108 (0.111) loss_u loss_u 0.9116 (0.9124) acc_u 9.3750 (10.6250) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [10/34] time 0.189 (0.188) data 0.112 (0.111) loss_u loss_u 0.9824 (0.9164) acc_u 3.1250 (10.6250) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [15/34] time 0.187 (0.188) data 0.110 (0.110) loss_u loss_u 0.9331 (0.9210) acc_u 6.2500 (9.3750) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/34] time 0.186 (0.187) data 0.109 (0.110) loss_u loss_u 0.9351 (0.9137) acc_u 6.2500 (10.3125) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/34] time 0.187 (0.188) data 0.110 (0.111) loss_u loss_u 0.8926 (0.9089) acc_u 9.3750 (10.6250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [30/34] time 0.184 (0.187) data 0.105 (0.110) loss_u loss_u 0.9346 (0.9110) acc_u 6.2500 (10.3125) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 700
confident_label rate tensor(0.3373, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 545
clean true:444
clean false:101
clean_rate:0.8146788990825689
noisy true:472
noisy false:599
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1071
epoch [82/200] batch [5/17] time 0.159 (0.178) data 0.081 (0.101) loss_x loss_x 0.4673 (0.7321) acc_x 87.5000 (82.5000) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/17] time 0.177 (0.178) data 0.100 (0.101) loss_x loss_x 0.6636 (0.6154) acc_x 78.1250 (84.6875) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/17] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 1.1221 (0.6159) acc_x 75.0000 (84.5833) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/33] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.9941 (0.9410) acc_u 0.0000 (5.0000) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [10/33] time 0.239 (0.180) data 0.162 (0.103) loss_u loss_u 0.8862 (0.9155) acc_u 12.5000 (8.7500) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [15/33] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8809 (0.9067) acc_u 12.5000 (10.0000) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/33] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9316 (0.9084) acc_u 6.2500 (10.0000) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/33] time 0.185 (0.184) data 0.108 (0.106) loss_u loss_u 0.9014 (0.9115) acc_u 12.5000 (9.7500) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [30/33] time 0.158 (0.181) data 0.081 (0.104) loss_u loss_u 0.9492 (0.9152) acc_u 9.3750 (9.3750) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 665
confident_label rate tensor(0.3261, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 527
clean true:441
clean false:86
clean_rate:0.8368121442125237
noisy true:510
noisy false:579
after delete: len(clean_dataset) 527
after delete: len(noisy_dataset) 1089
epoch [83/200] batch [5/16] time 0.177 (0.181) data 0.099 (0.104) loss_x loss_x 0.8091 (0.7948) acc_x 81.2500 (78.7500) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [10/16] time 0.170 (0.179) data 0.093 (0.102) loss_x loss_x 0.7554 (0.7821) acc_x 84.3750 (78.1250) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/16] time 0.184 (0.176) data 0.108 (0.099) loss_x loss_x 1.5225 (0.8333) acc_x 53.1250 (76.2500) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/34] time 0.172 (0.177) data 0.094 (0.100) loss_u loss_u 0.9072 (0.9449) acc_u 12.5000 (7.5000) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/34] time 0.191 (0.179) data 0.115 (0.102) loss_u loss_u 0.9551 (0.9320) acc_u 6.2500 (8.1250) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/34] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.9268 (0.9304) acc_u 6.2500 (8.5417) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/34] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.8916 (0.9225) acc_u 12.5000 (9.5312) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/34] time 0.206 (0.181) data 0.127 (0.104) loss_u loss_u 0.9248 (0.9220) acc_u 6.2500 (9.3750) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [30/34] time 0.180 (0.182) data 0.103 (0.104) loss_u loss_u 0.8872 (0.9183) acc_u 18.7500 (10.0000) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 650
confident_label rate tensor(0.3230, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 522
clean true:440
clean false:82
clean_rate:0.842911877394636
noisy true:526
noisy false:568
after delete: len(clean_dataset) 522
after delete: len(noisy_dataset) 1094
epoch [84/200] batch [5/16] time 0.176 (0.170) data 0.097 (0.092) loss_x loss_x 0.8760 (0.7518) acc_x 78.1250 (81.8750) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [10/16] time 0.177 (0.176) data 0.101 (0.099) loss_x loss_x 0.5229 (0.7171) acc_x 87.5000 (83.1250) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/16] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.5225 (0.7419) acc_x 84.3750 (81.8750) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/34] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.8271 (0.9100) acc_u 25.0000 (10.6250) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/34] time 0.174 (0.176) data 0.094 (0.098) loss_u loss_u 0.9546 (0.9085) acc_u 6.2500 (10.9375) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/34] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.9136 (0.9120) acc_u 9.3750 (10.2083) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/34] time 0.184 (0.177) data 0.106 (0.099) loss_u loss_u 0.9229 (0.9131) acc_u 9.3750 (10.1562) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/34] time 0.188 (0.178) data 0.110 (0.100) loss_u loss_u 0.9321 (0.9204) acc_u 6.2500 (9.0000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [30/34] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9580 (0.9206) acc_u 3.1250 (8.8542) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 683
confident_label rate tensor(0.3175, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 513
clean true:426
clean false:87
clean_rate:0.8304093567251462
noisy true:507
noisy false:596
after delete: len(clean_dataset) 513
after delete: len(noisy_dataset) 1103
epoch [85/200] batch [5/16] time 0.169 (0.177) data 0.092 (0.100) loss_x loss_x 0.5308 (0.6787) acc_x 90.6250 (83.1250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [10/16] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.5244 (0.6630) acc_x 84.3750 (82.5000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/16] time 0.195 (0.181) data 0.118 (0.104) loss_x loss_x 1.0234 (0.7201) acc_x 78.1250 (82.2917) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/34] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8896 (0.9131) acc_u 18.7500 (11.2500) lr 1.2639e-03 eta 0:00:05
epoch [85/200] batch [10/34] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9482 (0.9056) acc_u 6.2500 (12.1875) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/34] time 0.184 (0.184) data 0.105 (0.106) loss_u loss_u 0.9033 (0.9005) acc_u 15.6250 (12.2917) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/34] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8770 (0.8991) acc_u 12.5000 (12.1875) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/34] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9653 (0.8991) acc_u 3.1250 (11.7500) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [30/34] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.8853 (0.9015) acc_u 12.5000 (11.1458) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.3373, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 545
clean true:453
clean false:92
clean_rate:0.8311926605504587
noisy true:524
noisy false:547
after delete: len(clean_dataset) 545
after delete: len(noisy_dataset) 1071
epoch [86/200] batch [5/17] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.5054 (0.7307) acc_x 84.3750 (80.6250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/17] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.8501 (0.7274) acc_x 78.1250 (82.1875) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/17] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.8477 (0.6971) acc_x 71.8750 (81.8750) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/33] time 0.187 (0.185) data 0.109 (0.108) loss_u loss_u 0.9443 (0.9192) acc_u 6.2500 (8.7500) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [10/33] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9292 (0.9191) acc_u 6.2500 (8.7500) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [15/33] time 0.187 (0.185) data 0.111 (0.108) loss_u loss_u 0.9312 (0.9117) acc_u 9.3750 (10.0000) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [20/33] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8794 (0.9129) acc_u 15.6250 (10.1562) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/33] time 0.163 (0.184) data 0.086 (0.107) loss_u loss_u 0.9473 (0.9123) acc_u 6.2500 (10.2500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [30/33] time 0.168 (0.182) data 0.091 (0.105) loss_u loss_u 0.9834 (0.9168) acc_u 3.1250 (9.5833) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.3267, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 528
clean true:434
clean false:94
clean_rate:0.821969696969697
noisy true:506
noisy false:582
after delete: len(clean_dataset) 528
after delete: len(noisy_dataset) 1088
epoch [87/200] batch [5/16] time 0.174 (0.179) data 0.097 (0.102) loss_x loss_x 0.7393 (0.6173) acc_x 90.6250 (86.2500) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [10/16] time 0.169 (0.178) data 0.092 (0.101) loss_x loss_x 0.2917 (0.7222) acc_x 96.8750 (83.4375) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/16] time 0.174 (0.179) data 0.095 (0.102) loss_x loss_x 1.1855 (0.7544) acc_x 68.7500 (81.6667) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/34] time 0.190 (0.179) data 0.111 (0.102) loss_u loss_u 0.8682 (0.8947) acc_u 15.6250 (11.2500) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [10/34] time 0.167 (0.176) data 0.089 (0.099) loss_u loss_u 0.9263 (0.8979) acc_u 6.2500 (10.9375) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [15/34] time 0.183 (0.175) data 0.106 (0.097) loss_u loss_u 0.9146 (0.8996) acc_u 9.3750 (10.6250) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/34] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.8369 (0.8943) acc_u 15.6250 (11.4062) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/34] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.9521 (0.9018) acc_u 6.2500 (10.6250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [30/34] time 0.185 (0.178) data 0.107 (0.100) loss_u loss_u 0.8794 (0.9014) acc_u 12.5000 (10.8333) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 675
confident_label rate tensor(0.3335, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 539
clean true:448
clean false:91
clean_rate:0.8311688311688312
noisy true:493
noisy false:584
after delete: len(clean_dataset) 539
after delete: len(noisy_dataset) 1077
epoch [88/200] batch [5/16] time 0.182 (0.186) data 0.106 (0.109) loss_x loss_x 0.6797 (0.7411) acc_x 78.1250 (81.8750) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/16] time 0.192 (0.188) data 0.114 (0.111) loss_x loss_x 0.4150 (0.6817) acc_x 84.3750 (83.1250) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/16] time 0.186 (0.187) data 0.108 (0.110) loss_x loss_x 0.6768 (0.6782) acc_x 81.2500 (83.1250) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/33] time 0.185 (0.187) data 0.108 (0.109) loss_u loss_u 0.8403 (0.8698) acc_u 15.6250 (14.3750) lr 1.2181e-03 eta 0:00:05
epoch [88/200] batch [10/33] time 0.185 (0.187) data 0.108 (0.109) loss_u loss_u 0.9648 (0.8967) acc_u 3.1250 (11.2500) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/33] time 0.161 (0.184) data 0.084 (0.107) loss_u loss_u 0.9600 (0.9030) acc_u 3.1250 (10.8333) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/33] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.8657 (0.9101) acc_u 18.7500 (10.6250) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/33] time 0.185 (0.182) data 0.106 (0.105) loss_u loss_u 0.9658 (0.9123) acc_u 6.2500 (10.2500) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [30/33] time 0.187 (0.182) data 0.108 (0.104) loss_u loss_u 0.8647 (0.9133) acc_u 18.7500 (10.1042) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 660
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 535
clean true:441
clean false:94
clean_rate:0.8242990654205608
noisy true:515
noisy false:566
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1081
epoch [89/200] batch [5/16] time 0.187 (0.192) data 0.110 (0.115) loss_x loss_x 0.6929 (0.7557) acc_x 81.2500 (78.1250) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/16] time 0.183 (0.189) data 0.107 (0.112) loss_x loss_x 0.5293 (0.6983) acc_x 84.3750 (80.3125) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/16] time 0.185 (0.188) data 0.109 (0.111) loss_x loss_x 0.8096 (0.6666) acc_x 78.1250 (81.6667) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/33] time 0.159 (0.185) data 0.082 (0.108) loss_u loss_u 0.8667 (0.9091) acc_u 21.8750 (12.5000) lr 1.2028e-03 eta 0:00:05
epoch [89/200] batch [10/33] time 0.187 (0.183) data 0.108 (0.105) loss_u loss_u 0.8936 (0.9080) acc_u 12.5000 (10.6250) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/33] time 0.170 (0.181) data 0.092 (0.104) loss_u loss_u 0.9717 (0.9137) acc_u 3.1250 (9.5833) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/33] time 0.183 (0.180) data 0.106 (0.102) loss_u loss_u 0.8989 (0.9096) acc_u 9.3750 (9.8438) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/33] time 0.160 (0.178) data 0.082 (0.100) loss_u loss_u 0.9570 (0.9136) acc_u 3.1250 (9.3750) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [30/33] time 0.173 (0.177) data 0.095 (0.099) loss_u loss_u 0.9058 (0.9153) acc_u 9.3750 (9.2708) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 632
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 538
clean true:443
clean false:95
clean_rate:0.8234200743494424
noisy true:541
noisy false:537
after delete: len(clean_dataset) 538
after delete: len(noisy_dataset) 1078
epoch [90/200] batch [5/16] time 0.185 (0.187) data 0.109 (0.111) loss_x loss_x 0.5405 (0.8237) acc_x 90.6250 (80.0000) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/16] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.7095 (0.7360) acc_x 84.3750 (81.2500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/16] time 0.185 (0.186) data 0.108 (0.110) loss_x loss_x 0.7822 (0.8104) acc_x 78.1250 (78.9583) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/33] time 0.187 (0.186) data 0.109 (0.109) loss_u loss_u 0.9033 (0.9484) acc_u 9.3750 (5.6250) lr 1.1874e-03 eta 0:00:05
epoch [90/200] batch [10/33] time 0.186 (0.186) data 0.109 (0.108) loss_u loss_u 0.8799 (0.9228) acc_u 12.5000 (9.0625) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/33] time 0.167 (0.184) data 0.090 (0.107) loss_u loss_u 0.8716 (0.9190) acc_u 15.6250 (9.5833) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/33] time 0.161 (0.181) data 0.083 (0.104) loss_u loss_u 0.8638 (0.9094) acc_u 15.6250 (10.4688) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/33] time 0.161 (0.180) data 0.083 (0.103) loss_u loss_u 0.9014 (0.9123) acc_u 15.6250 (10.3750) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [30/33] time 0.187 (0.179) data 0.110 (0.101) loss_u loss_u 0.9053 (0.9104) acc_u 9.3750 (10.8333) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.3366, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 544
clean true:444
clean false:100
clean_rate:0.8161764705882353
noisy true:486
noisy false:586
after delete: len(clean_dataset) 544
after delete: len(noisy_dataset) 1072
epoch [91/200] batch [5/17] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 1.0801 (0.8378) acc_x 84.3750 (80.6250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/17] time 0.188 (0.178) data 0.111 (0.101) loss_x loss_x 0.6323 (0.7194) acc_x 81.2500 (81.2500) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/17] time 0.190 (0.178) data 0.111 (0.101) loss_x loss_x 0.4285 (0.6687) acc_x 87.5000 (83.7500) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/33] time 0.177 (0.179) data 0.099 (0.101) loss_u loss_u 0.9395 (0.9180) acc_u 6.2500 (10.0000) lr 1.1719e-03 eta 0:00:05
epoch [91/200] batch [10/33] time 0.174 (0.179) data 0.097 (0.101) loss_u loss_u 0.8735 (0.9091) acc_u 15.6250 (10.9375) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/33] time 0.195 (0.179) data 0.117 (0.101) loss_u loss_u 0.9268 (0.9145) acc_u 9.3750 (10.0000) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/33] time 0.190 (0.179) data 0.111 (0.101) loss_u loss_u 0.8564 (0.9125) acc_u 18.7500 (10.3125) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/33] time 0.164 (0.178) data 0.086 (0.100) loss_u loss_u 0.8804 (0.9154) acc_u 12.5000 (9.8750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [30/33] time 0.163 (0.176) data 0.085 (0.099) loss_u loss_u 0.9390 (0.9070) acc_u 9.3750 (10.9375) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 689
confident_label rate tensor(0.3144, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 508
clean true:419
clean false:89
clean_rate:0.8248031496062992
noisy true:508
noisy false:600
after delete: len(clean_dataset) 508
after delete: len(noisy_dataset) 1108
epoch [92/200] batch [5/15] time 0.180 (0.188) data 0.103 (0.111) loss_x loss_x 0.5933 (0.6481) acc_x 84.3750 (85.0000) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [10/15] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.7852 (0.6560) acc_x 84.3750 (85.0000) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [15/15] time 0.197 (0.184) data 0.120 (0.107) loss_x loss_x 0.5024 (0.6304) acc_x 87.5000 (84.7917) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/34] time 0.182 (0.183) data 0.104 (0.105) loss_u loss_u 0.8906 (0.8866) acc_u 9.3750 (13.7500) lr 1.1564e-03 eta 0:00:05
epoch [92/200] batch [10/34] time 0.186 (0.184) data 0.109 (0.106) loss_u loss_u 0.8311 (0.8766) acc_u 21.8750 (14.0625) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/34] time 0.175 (0.183) data 0.098 (0.106) loss_u loss_u 0.9277 (0.8857) acc_u 6.2500 (13.3333) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [20/34] time 0.189 (0.182) data 0.111 (0.105) loss_u loss_u 0.9644 (0.8927) acc_u 3.1250 (12.3438) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/34] time 0.170 (0.181) data 0.091 (0.103) loss_u loss_u 0.8579 (0.8980) acc_u 15.6250 (11.6250) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [30/34] time 0.171 (0.180) data 0.093 (0.102) loss_u loss_u 0.9146 (0.8959) acc_u 9.3750 (11.9792) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.3292, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 532
clean true:434
clean false:98
clean_rate:0.8157894736842105
noisy true:500
noisy false:584
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 1084
epoch [93/200] batch [5/16] time 0.188 (0.187) data 0.109 (0.109) loss_x loss_x 0.4023 (0.8345) acc_x 93.7500 (81.8750) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/16] time 0.203 (0.187) data 0.126 (0.110) loss_x loss_x 1.0830 (0.8114) acc_x 71.8750 (80.0000) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/16] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.6191 (0.7424) acc_x 87.5000 (82.0833) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/33] time 0.183 (0.186) data 0.105 (0.108) loss_u loss_u 0.9248 (0.9162) acc_u 9.3750 (10.6250) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [10/33] time 0.167 (0.184) data 0.090 (0.107) loss_u loss_u 0.8994 (0.9143) acc_u 15.6250 (10.6250) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [15/33] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.9546 (0.9220) acc_u 6.2500 (9.3750) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/33] time 0.183 (0.184) data 0.105 (0.106) loss_u loss_u 0.8325 (0.9132) acc_u 18.7500 (10.0000) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/33] time 0.187 (0.184) data 0.109 (0.107) loss_u loss_u 0.8931 (0.9138) acc_u 9.3750 (9.7500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [30/33] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.8140 (0.9073) acc_u 28.1250 (10.6250) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 701
confident_label rate tensor(0.3261, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 527
clean true:430
clean false:97
clean_rate:0.8159392789373814
noisy true:485
noisy false:604
after delete: len(clean_dataset) 527
after delete: len(noisy_dataset) 1089
epoch [94/200] batch [5/16] time 0.189 (0.187) data 0.111 (0.110) loss_x loss_x 0.6919 (0.6396) acc_x 87.5000 (85.0000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/16] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.4927 (0.5913) acc_x 81.2500 (85.3125) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [15/16] time 0.180 (0.186) data 0.103 (0.109) loss_x loss_x 0.5093 (0.6405) acc_x 90.6250 (84.5833) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/34] time 0.185 (0.186) data 0.107 (0.109) loss_u loss_u 0.9351 (0.8908) acc_u 3.1250 (11.2500) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [10/34] time 0.175 (0.185) data 0.097 (0.108) loss_u loss_u 0.8936 (0.8971) acc_u 12.5000 (10.9375) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [15/34] time 0.169 (0.183) data 0.091 (0.105) loss_u loss_u 0.8569 (0.8988) acc_u 21.8750 (11.6667) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/34] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9243 (0.9059) acc_u 9.3750 (11.2500) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/34] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8833 (0.9007) acc_u 12.5000 (11.8750) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [30/34] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8843 (0.8986) acc_u 12.5000 (11.9792) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.3403, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 550
clean true:444
clean false:106
clean_rate:0.8072727272727273
noisy true:508
noisy false:558
after delete: len(clean_dataset) 550
after delete: len(noisy_dataset) 1066
epoch [95/200] batch [5/17] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.5264 (0.5371) acc_x 78.1250 (85.6250) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/17] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.5195 (0.5682) acc_x 90.6250 (85.3125) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/17] time 0.168 (0.181) data 0.091 (0.104) loss_x loss_x 0.2695 (0.6332) acc_x 93.7500 (85.2083) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/33] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8945 (0.8983) acc_u 12.5000 (11.8750) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [10/33] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8926 (0.9051) acc_u 12.5000 (11.2500) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [15/33] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9087 (0.9105) acc_u 12.5000 (10.4167) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/33] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.8662 (0.9106) acc_u 15.6250 (10.4688) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/33] time 0.187 (0.183) data 0.110 (0.106) loss_u loss_u 0.8789 (0.9129) acc_u 15.6250 (10.1250) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [30/33] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9038 (0.9141) acc_u 9.3750 (10.1042) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 694
confident_label rate tensor(0.3447, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 557
clean true:449
clean false:108
clean_rate:0.8061041292639138
noisy true:473
noisy false:586
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1059
epoch [96/200] batch [5/17] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.7036 (0.5837) acc_x 75.0000 (83.7500) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/17] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.7246 (0.5743) acc_x 84.3750 (82.8125) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/17] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.8423 (0.6392) acc_x 75.0000 (81.6667) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/33] time 0.189 (0.187) data 0.111 (0.110) loss_u loss_u 0.9048 (0.9208) acc_u 9.3750 (8.1250) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [10/33] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.8516 (0.9069) acc_u 15.6250 (10.3125) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [15/33] time 0.168 (0.185) data 0.089 (0.108) loss_u loss_u 0.8330 (0.9087) acc_u 15.6250 (10.4167) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/33] time 0.188 (0.184) data 0.111 (0.107) loss_u loss_u 0.9453 (0.9072) acc_u 6.2500 (10.3125) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/33] time 0.168 (0.184) data 0.090 (0.106) loss_u loss_u 0.7983 (0.9035) acc_u 25.0000 (10.6250) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [30/33] time 0.166 (0.182) data 0.088 (0.105) loss_u loss_u 0.8926 (0.9067) acc_u 15.6250 (10.4167) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 538
clean true:439
clean false:99
clean_rate:0.8159851301115242
noisy true:491
noisy false:587
after delete: len(clean_dataset) 538
after delete: len(noisy_dataset) 1078
epoch [97/200] batch [5/16] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.5415 (0.5719) acc_x 90.6250 (86.8750) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/16] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.6279 (0.6032) acc_x 81.2500 (85.0000) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/16] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5068 (0.6829) acc_x 90.6250 (82.9167) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/33] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9395 (0.8935) acc_u 6.2500 (12.5000) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [10/33] time 0.178 (0.184) data 0.100 (0.106) loss_u loss_u 0.8877 (0.8916) acc_u 15.6250 (12.5000) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [15/33] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.9800 (0.9069) acc_u 0.0000 (10.4167) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/33] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9136 (0.9086) acc_u 9.3750 (10.3125) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/33] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9170 (0.9084) acc_u 9.3750 (10.2500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [30/33] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9097 (0.9078) acc_u 9.3750 (10.1042) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 669
confident_label rate tensor(0.3397, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 549
clean true:447
clean false:102
clean_rate:0.8142076502732241
noisy true:500
noisy false:567
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1067
epoch [98/200] batch [5/17] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.7031 (0.6401) acc_x 84.3750 (83.7500) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/17] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6479 (0.6598) acc_x 78.1250 (81.8750) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/17] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.4878 (0.6473) acc_x 81.2500 (80.8333) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/33] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9683 (0.9233) acc_u 3.1250 (9.3750) lr 1.0628e-03 eta 0:00:05
epoch [98/200] batch [10/33] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8853 (0.9158) acc_u 12.5000 (10.6250) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/33] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8135 (0.8936) acc_u 25.0000 (12.7083) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/33] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9443 (0.8953) acc_u 3.1250 (12.0312) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/33] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8892 (0.9006) acc_u 15.6250 (11.7500) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [30/33] time 0.183 (0.184) data 0.105 (0.106) loss_u loss_u 0.9541 (0.9012) acc_u 6.2500 (11.6667) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.3354, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 542
clean true:438
clean false:104
clean_rate:0.8081180811808119
noisy true:501
noisy false:573
after delete: len(clean_dataset) 542
after delete: len(noisy_dataset) 1074
epoch [99/200] batch [5/16] time 0.174 (0.185) data 0.097 (0.108) loss_x loss_x 0.5205 (0.5001) acc_x 78.1250 (84.3750) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/16] time 0.159 (0.175) data 0.082 (0.098) loss_x loss_x 0.6187 (0.5150) acc_x 84.3750 (85.3125) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/16] time 0.181 (0.177) data 0.105 (0.099) loss_x loss_x 1.2832 (0.6798) acc_x 65.6250 (80.8333) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/33] time 0.170 (0.178) data 0.093 (0.101) loss_u loss_u 0.9321 (0.9095) acc_u 6.2500 (10.0000) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/33] time 0.169 (0.177) data 0.091 (0.099) loss_u loss_u 0.9526 (0.9177) acc_u 3.1250 (8.7500) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [15/33] time 0.169 (0.175) data 0.090 (0.098) loss_u loss_u 0.9243 (0.9180) acc_u 9.3750 (9.3750) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/33] time 0.167 (0.174) data 0.090 (0.097) loss_u loss_u 0.8975 (0.9157) acc_u 12.5000 (9.3750) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/33] time 0.170 (0.174) data 0.092 (0.096) loss_u loss_u 0.8955 (0.9116) acc_u 12.5000 (10.1250) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [30/33] time 0.173 (0.173) data 0.095 (0.096) loss_u loss_u 0.9434 (0.9103) acc_u 9.3750 (10.5208) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 675
confident_label rate tensor(0.3249, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 525
clean true:427
clean false:98
clean_rate:0.8133333333333334
noisy true:514
noisy false:577
all clean rate:  [0.8709677419354839, 0.9159663865546218, 0.9447674418604651, 0.9314641744548287, 0.9289940828402367, 0.9186351706036745, 0.9249329758713136, 0.9162303664921466, 0.9173333333333333, 0.8940568475452196, 0.8961038961038961, 0.9068627450980392, 0.9045226130653267, 0.8899755501222494, 0.8914141414141414, 0.8995535714285714, 0.8746987951807229, 0.8938271604938272, 0.8949880668257757, 0.8723404255319149, 0.8708133971291866, 0.8847058823529412, 0.8830275229357798, 0.8823529411764706, 0.871264367816092, 0.8623853211009175, 0.8764845605700713, 0.8464912280701754, 0.8605200945626478, 0.8504464285714286, 0.8727272727272727, 0.8631346578366446, 0.85, 0.8494623655913979, 0.8717391304347826, 0.8698481561822126, 0.8527472527472527, 0.8605150214592274, 0.8650963597430407, 0.8524229074889867, 0.8611713665943601, 0.8635394456289979, 0.8471337579617835, 0.8611713665943601, 0.8752783964365256, 0.8604651162790697, 0.8493723849372385, 0.8412017167381974, 0.8701825557809331, 0.8556263269639066, 0.8461538461538461, 0.8347457627118644, 0.8467741935483871, 0.8649789029535865, 0.8580246913580247, 0.8538622129436325, 0.8616352201257862, 0.8531746031746031, 0.8474226804123711, 0.8571428571428571, 0.8260869565217391, 0.8585657370517928, 0.8594704684317719, 0.8542094455852156, 0.8551020408163266, 0.844488188976378, 0.8521560574948666, 0.8530612244897959, 0.8350100603621731, 0.8511904761904762, 0.8546511627906976, 0.8273244781783681, 0.8579654510556622, 0.8579881656804734, 0.8442307692307692, 0.8472222222222222, 0.8204633204633205, 0.8143133462282398, 0.8185404339250493, 0.8287937743190662, 0.8285163776493256, 0.8146788990825689, 0.8368121442125237, 0.842911877394636, 0.8304093567251462, 0.8311926605504587, 0.821969696969697, 0.8311688311688312, 0.8242990654205608, 0.8234200743494424, 0.8161764705882353, 0.8248031496062992, 0.8157894736842105, 0.8159392789373814, 0.8072727272727273, 0.8061041292639138, 0.8159851301115242, 0.8142076502732241, 0.8081180811808119, 0.8133333333333334]
after delete: len(clean_dataset) 525
after delete: len(noisy_dataset) 1091
epoch [100/200] batch [5/16] time 0.184 (0.191) data 0.107 (0.113) loss_x loss_x 1.0303 (0.6220) acc_x 75.0000 (84.3750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/16] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 0.4302 (0.6656) acc_x 93.7500 (82.5000) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/16] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.2438 (0.6875) acc_x 96.8750 (82.0833) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/34] time 0.186 (0.186) data 0.109 (0.109) loss_u loss_u 0.9043 (0.8826) acc_u 12.5000 (14.3750) lr 1.0314e-03 eta 0:00:05
epoch [100/200] batch [10/34] time 0.168 (0.184) data 0.091 (0.107) loss_u loss_u 0.8623 (0.8938) acc_u 15.6250 (12.8125) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/34] time 0.168 (0.181) data 0.090 (0.104) loss_u loss_u 0.9438 (0.8934) acc_u 6.2500 (12.7083) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/34] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9404 (0.8991) acc_u 9.3750 (12.0312) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/34] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.9282 (0.8950) acc_u 9.3750 (12.6250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [30/34] time 0.162 (0.180) data 0.084 (0.102) loss_u loss_u 0.9404 (0.8978) acc_u 9.3750 (12.3958) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.3360, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 543
clean true:427
clean false:116
clean_rate:0.7863720073664825
noisy true:504
noisy false:569
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 1073
epoch [101/200] batch [5/16] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.6299 (0.8175) acc_x 81.2500 (80.6250) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/16] time 0.167 (0.182) data 0.091 (0.105) loss_x loss_x 1.1885 (0.8347) acc_x 68.7500 (79.0625) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [15/16] time 0.163 (0.177) data 0.085 (0.100) loss_x loss_x 0.5044 (0.7959) acc_x 84.3750 (78.9583) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/33] time 0.170 (0.175) data 0.092 (0.097) loss_u loss_u 0.8740 (0.8509) acc_u 15.6250 (18.7500) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/33] time 0.170 (0.174) data 0.093 (0.097) loss_u loss_u 0.8716 (0.8717) acc_u 12.5000 (15.6250) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/33] time 0.168 (0.174) data 0.089 (0.096) loss_u loss_u 0.9619 (0.8865) acc_u 3.1250 (13.5417) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/33] time 0.171 (0.172) data 0.094 (0.095) loss_u loss_u 0.9824 (0.8920) acc_u 3.1250 (12.8125) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/33] time 0.174 (0.172) data 0.097 (0.095) loss_u loss_u 0.9160 (0.8944) acc_u 9.3750 (12.5000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [30/33] time 0.178 (0.172) data 0.100 (0.095) loss_u loss_u 0.8354 (0.8913) acc_u 21.8750 (13.2292) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 669
confident_label rate tensor(0.3292, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 532
clean true:436
clean false:96
clean_rate:0.8195488721804511
noisy true:511
noisy false:573
after delete: len(clean_dataset) 532
after delete: len(noisy_dataset) 1084
epoch [102/200] batch [5/16] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.9019 (0.9126) acc_x 81.2500 (80.0000) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/16] time 0.185 (0.184) data 0.107 (0.108) loss_x loss_x 0.2114 (0.8201) acc_x 96.8750 (80.3125) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/16] time 0.174 (0.184) data 0.097 (0.107) loss_x loss_x 0.5728 (0.7742) acc_x 81.2500 (80.6250) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/33] time 0.171 (0.180) data 0.094 (0.104) loss_u loss_u 0.9277 (0.9335) acc_u 9.3750 (8.1250) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [10/33] time 0.165 (0.178) data 0.088 (0.101) loss_u loss_u 0.8940 (0.9186) acc_u 12.5000 (9.6875) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [15/33] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.9785 (0.9125) acc_u 0.0000 (9.7917) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/33] time 0.191 (0.178) data 0.115 (0.101) loss_u loss_u 0.8926 (0.9076) acc_u 9.3750 (10.4688) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/33] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.8501 (0.9065) acc_u 18.7500 (11.0000) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [30/33] time 0.187 (0.179) data 0.109 (0.102) loss_u loss_u 0.9077 (0.9041) acc_u 12.5000 (11.4583) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:447
clean false:100
clean_rate:0.8171846435100548
noisy true:492
noisy false:577
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [103/200] batch [5/17] time 0.159 (0.173) data 0.083 (0.097) loss_x loss_x 0.6177 (0.5597) acc_x 87.5000 (86.8750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/17] time 0.184 (0.178) data 0.108 (0.102) loss_x loss_x 0.2661 (0.5743) acc_x 96.8750 (86.5625) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [15/17] time 0.160 (0.175) data 0.082 (0.098) loss_x loss_x 0.7202 (0.6163) acc_x 84.3750 (85.0000) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/33] time 0.160 (0.173) data 0.084 (0.096) loss_u loss_u 0.8779 (0.8821) acc_u 18.7500 (16.2500) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [10/33] time 0.171 (0.171) data 0.093 (0.094) loss_u loss_u 0.9648 (0.9031) acc_u 0.0000 (12.1875) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [15/33] time 0.164 (0.170) data 0.087 (0.093) loss_u loss_u 0.8750 (0.9055) acc_u 15.6250 (11.4583) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/33] time 0.166 (0.169) data 0.089 (0.092) loss_u loss_u 0.8516 (0.9059) acc_u 21.8750 (11.7188) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/33] time 0.166 (0.169) data 0.089 (0.092) loss_u loss_u 0.9375 (0.9055) acc_u 6.2500 (11.2500) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [30/33] time 0.171 (0.169) data 0.093 (0.092) loss_u loss_u 0.9209 (0.9025) acc_u 6.2500 (11.4583) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.3502, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 566
clean true:453
clean false:113
clean_rate:0.8003533568904594
noisy true:487
noisy false:563
after delete: len(clean_dataset) 566
after delete: len(noisy_dataset) 1050
epoch [104/200] batch [5/17] time 0.180 (0.184) data 0.104 (0.107) loss_x loss_x 0.7520 (0.6687) acc_x 84.3750 (82.5000) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/17] time 0.181 (0.184) data 0.104 (0.107) loss_x loss_x 0.4270 (0.6774) acc_x 90.6250 (81.8750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/17] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.7793 (0.6822) acc_x 81.2500 (81.4583) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/32] time 0.183 (0.185) data 0.107 (0.109) loss_u loss_u 0.8657 (0.9094) acc_u 15.6250 (10.0000) lr 9.6859e-04 eta 0:00:05
epoch [104/200] batch [10/32] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8960 (0.9002) acc_u 9.3750 (10.9375) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/32] time 0.167 (0.185) data 0.089 (0.108) loss_u loss_u 0.9736 (0.9032) acc_u 3.1250 (10.6250) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/32] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9331 (0.9028) acc_u 6.2500 (10.7812) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/32] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9297 (0.9082) acc_u 9.3750 (10.3750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [30/32] time 0.171 (0.183) data 0.094 (0.106) loss_u loss_u 0.9341 (0.9099) acc_u 6.2500 (10.2083) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 692
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:444
clean false:104
clean_rate:0.8102189781021898
noisy true:480
noisy false:588
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [105/200] batch [5/17] time 0.183 (0.188) data 0.107 (0.111) loss_x loss_x 0.6001 (0.7672) acc_x 78.1250 (78.7500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/17] time 0.186 (0.187) data 0.108 (0.110) loss_x loss_x 0.8057 (0.6694) acc_x 78.1250 (80.9375) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [15/17] time 0.163 (0.184) data 0.086 (0.107) loss_x loss_x 1.0508 (0.6631) acc_x 71.8750 (81.6667) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/33] time 0.189 (0.180) data 0.111 (0.103) loss_u loss_u 0.9834 (0.9214) acc_u 0.0000 (8.7500) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [10/33] time 0.206 (0.182) data 0.128 (0.105) loss_u loss_u 0.9453 (0.9205) acc_u 9.3750 (9.0625) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [15/33] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.8940 (0.9046) acc_u 9.3750 (10.8333) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/33] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9268 (0.8997) acc_u 6.2500 (11.2500) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/33] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.7705 (0.8925) acc_u 21.8750 (12.0000) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [30/33] time 0.171 (0.182) data 0.094 (0.105) loss_u loss_u 0.9731 (0.8955) acc_u 3.1250 (11.8750) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.3304, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 534
clean true:431
clean false:103
clean_rate:0.8071161048689138
noisy true:503
noisy false:579
after delete: len(clean_dataset) 534
after delete: len(noisy_dataset) 1082
epoch [106/200] batch [5/16] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.5508 (0.5630) acc_x 84.3750 (87.5000) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/16] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.9805 (0.6285) acc_x 75.0000 (85.9375) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/16] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.8027 (0.6681) acc_x 75.0000 (84.5833) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/33] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8735 (0.8831) acc_u 18.7500 (13.7500) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [10/33] time 0.178 (0.184) data 0.100 (0.107) loss_u loss_u 0.8813 (0.8911) acc_u 12.5000 (12.8125) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [15/33] time 0.172 (0.183) data 0.094 (0.105) loss_u loss_u 0.9165 (0.8933) acc_u 6.2500 (12.2917) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/33] time 0.167 (0.180) data 0.089 (0.103) loss_u loss_u 0.9512 (0.8949) acc_u 6.2500 (12.3438) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/33] time 0.182 (0.180) data 0.105 (0.102) loss_u loss_u 0.9155 (0.8937) acc_u 9.3750 (12.5000) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [30/33] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8901 (0.8929) acc_u 12.5000 (12.5000) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:432
clean false:115
clean_rate:0.7897623400365631
noisy true:494
noisy false:575
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [107/200] batch [5/17] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.8071 (0.7371) acc_x 81.2500 (83.7500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/17] time 0.187 (0.170) data 0.110 (0.092) loss_x loss_x 0.9077 (0.7765) acc_x 75.0000 (79.6875) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/17] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 0.7124 (0.7772) acc_x 87.5000 (81.0417) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/33] time 0.177 (0.176) data 0.099 (0.099) loss_u loss_u 0.9502 (0.9418) acc_u 6.2500 (6.2500) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [10/33] time 0.163 (0.175) data 0.086 (0.097) loss_u loss_u 0.9004 (0.9283) acc_u 12.5000 (7.8125) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [15/33] time 0.166 (0.173) data 0.088 (0.096) loss_u loss_u 0.9092 (0.9181) acc_u 12.5000 (9.5833) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/33] time 0.164 (0.172) data 0.086 (0.094) loss_u loss_u 0.8994 (0.9112) acc_u 12.5000 (10.6250) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/33] time 0.163 (0.171) data 0.086 (0.094) loss_u loss_u 0.9277 (0.9095) acc_u 9.3750 (10.7500) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/33] time 0.171 (0.171) data 0.094 (0.093) loss_u loss_u 0.9287 (0.9058) acc_u 9.3750 (11.1458) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:445
clean false:109
clean_rate:0.8032490974729242
noisy true:503
noisy false:559
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [108/200] batch [5/17] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5278 (0.6002) acc_x 81.2500 (85.6250) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/17] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.8242 (0.5831) acc_x 84.3750 (85.0000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/17] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.4390 (0.5889) acc_x 87.5000 (83.9583) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/33] time 0.166 (0.180) data 0.089 (0.103) loss_u loss_u 0.9795 (0.9174) acc_u 0.0000 (8.7500) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [10/33] time 0.185 (0.180) data 0.106 (0.103) loss_u loss_u 0.8589 (0.9038) acc_u 15.6250 (10.9375) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [15/33] time 0.166 (0.179) data 0.087 (0.101) loss_u loss_u 0.8965 (0.9048) acc_u 12.5000 (11.0417) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/33] time 0.168 (0.177) data 0.090 (0.100) loss_u loss_u 0.8994 (0.8987) acc_u 9.3750 (11.7188) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/33] time 0.187 (0.178) data 0.110 (0.100) loss_u loss_u 0.9351 (0.9015) acc_u 6.2500 (11.2500) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [30/33] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.9341 (0.9023) acc_u 6.2500 (11.1458) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 667
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 541
clean true:435
clean false:106
clean_rate:0.8040665434380776
noisy true:514
noisy false:561
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1075
epoch [109/200] batch [5/16] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.5400 (0.5659) acc_x 84.3750 (86.8750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/16] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 1.0430 (0.6691) acc_x 71.8750 (85.0000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/16] time 0.172 (0.182) data 0.095 (0.105) loss_x loss_x 0.8970 (0.6438) acc_x 78.1250 (85.0000) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/33] time 0.171 (0.179) data 0.093 (0.101) loss_u loss_u 0.9395 (0.8596) acc_u 6.2500 (15.6250) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [10/33] time 0.166 (0.177) data 0.088 (0.099) loss_u loss_u 0.9507 (0.8733) acc_u 3.1250 (14.3750) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [15/33] time 0.162 (0.174) data 0.084 (0.097) loss_u loss_u 0.8970 (0.8707) acc_u 15.6250 (15.0000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/33] time 0.170 (0.173) data 0.093 (0.096) loss_u loss_u 0.8496 (0.8810) acc_u 18.7500 (13.7500) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/33] time 0.189 (0.175) data 0.112 (0.097) loss_u loss_u 0.8247 (0.8840) acc_u 18.7500 (13.5000) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [30/33] time 0.187 (0.176) data 0.110 (0.099) loss_u loss_u 0.7549 (0.8822) acc_u 31.2500 (13.7500) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 555
clean true:442
clean false:113
clean_rate:0.7963963963963964
noisy true:496
noisy false:565
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1061
epoch [110/200] batch [5/17] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.6025 (0.6937) acc_x 84.3750 (81.8750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/17] time 0.189 (0.188) data 0.112 (0.110) loss_x loss_x 0.6318 (0.7546) acc_x 81.2500 (81.8750) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/17] time 0.185 (0.187) data 0.108 (0.110) loss_x loss_x 0.4443 (0.7076) acc_x 87.5000 (82.9167) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/33] time 0.178 (0.185) data 0.099 (0.108) loss_u loss_u 0.9355 (0.9260) acc_u 6.2500 (9.3750) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [10/33] time 0.165 (0.182) data 0.088 (0.104) loss_u loss_u 0.8071 (0.9126) acc_u 25.0000 (10.6250) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [15/33] time 0.184 (0.180) data 0.107 (0.102) loss_u loss_u 0.8486 (0.9136) acc_u 18.7500 (11.0417) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/33] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.8999 (0.9067) acc_u 9.3750 (11.2500) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/33] time 0.180 (0.182) data 0.103 (0.104) loss_u loss_u 0.9033 (0.9086) acc_u 15.6250 (11.0000) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [30/33] time 0.182 (0.182) data 0.105 (0.104) loss_u loss_u 0.9653 (0.9087) acc_u 6.2500 (11.0417) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 541
clean true:434
clean false:107
clean_rate:0.8022181146025879
noisy true:496
noisy false:579
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1075
epoch [111/200] batch [5/16] time 0.182 (0.181) data 0.104 (0.104) loss_x loss_x 0.5161 (0.7151) acc_x 90.6250 (82.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [10/16] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.9429 (0.7180) acc_x 75.0000 (82.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/16] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.6992 (0.6892) acc_x 84.3750 (83.1250) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/33] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9443 (0.9211) acc_u 6.2500 (9.3750) lr 8.5910e-04 eta 0:00:05
epoch [111/200] batch [10/33] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.9497 (0.8963) acc_u 6.2500 (12.5000) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/33] time 0.191 (0.183) data 0.114 (0.106) loss_u loss_u 0.9746 (0.9049) acc_u 3.1250 (11.4583) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/33] time 0.173 (0.183) data 0.094 (0.105) loss_u loss_u 0.8813 (0.9027) acc_u 18.7500 (11.7188) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/33] time 0.160 (0.180) data 0.083 (0.103) loss_u loss_u 0.8799 (0.8998) acc_u 12.5000 (12.0000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [30/33] time 0.179 (0.180) data 0.102 (0.103) loss_u loss_u 0.9717 (0.9001) acc_u 3.1250 (11.8750) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 657
confident_label rate tensor(0.3360, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 543
clean true:446
clean false:97
clean_rate:0.8213627992633518
noisy true:513
noisy false:560
after delete: len(clean_dataset) 543
after delete: len(noisy_dataset) 1073
epoch [112/200] batch [5/16] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.8237 (0.7886) acc_x 78.1250 (76.8750) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/16] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6392 (0.7500) acc_x 71.8750 (78.7500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [15/16] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8735 (0.7344) acc_x 84.3750 (80.4167) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/33] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8140 (0.8939) acc_u 18.7500 (11.2500) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [10/33] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9614 (0.9132) acc_u 3.1250 (8.7500) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [15/33] time 0.188 (0.185) data 0.110 (0.107) loss_u loss_u 0.9263 (0.9060) acc_u 9.3750 (10.0000) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/33] time 0.192 (0.185) data 0.114 (0.108) loss_u loss_u 0.8706 (0.9029) acc_u 15.6250 (10.9375) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/33] time 0.187 (0.186) data 0.109 (0.108) loss_u loss_u 0.8110 (0.9006) acc_u 21.8750 (11.2500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [30/33] time 0.173 (0.185) data 0.094 (0.108) loss_u loss_u 0.9009 (0.9010) acc_u 12.5000 (11.3542) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 553
clean true:439
clean false:114
clean_rate:0.7938517179023508
noisy true:499
noisy false:564
after delete: len(clean_dataset) 553
after delete: len(noisy_dataset) 1063
epoch [113/200] batch [5/17] time 0.170 (0.181) data 0.092 (0.104) loss_x loss_x 0.3469 (0.5928) acc_x 90.6250 (81.8750) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/17] time 0.162 (0.173) data 0.085 (0.096) loss_x loss_x 0.5200 (0.6394) acc_x 90.6250 (82.1875) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [15/17] time 0.171 (0.171) data 0.094 (0.094) loss_x loss_x 0.3765 (0.6372) acc_x 93.7500 (83.1250) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/33] time 0.174 (0.172) data 0.098 (0.095) loss_u loss_u 0.9897 (0.9507) acc_u 0.0000 (6.2500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/33] time 0.179 (0.173) data 0.102 (0.096) loss_u loss_u 0.8911 (0.9371) acc_u 9.3750 (7.8125) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [15/33] time 0.180 (0.174) data 0.101 (0.097) loss_u loss_u 0.9961 (0.9280) acc_u 0.0000 (8.7500) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/33] time 0.163 (0.174) data 0.085 (0.097) loss_u loss_u 0.8516 (0.9171) acc_u 21.8750 (10.3125) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/33] time 0.174 (0.173) data 0.096 (0.096) loss_u loss_u 0.8916 (0.9139) acc_u 12.5000 (10.6250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [30/33] time 0.169 (0.173) data 0.091 (0.096) loss_u loss_u 0.8276 (0.9069) acc_u 15.6250 (11.1458) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 709
confident_label rate tensor(0.3558, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 575
clean true:454
clean false:121
clean_rate:0.7895652173913044
noisy true:453
noisy false:588
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1041
epoch [114/200] batch [5/17] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 0.6064 (0.6223) acc_x 81.2500 (83.1250) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/17] time 0.165 (0.182) data 0.087 (0.105) loss_x loss_x 0.6899 (0.6067) acc_x 78.1250 (83.4375) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [15/17] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.8384 (0.6190) acc_x 78.1250 (83.1250) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/32] time 0.161 (0.178) data 0.084 (0.101) loss_u loss_u 0.8906 (0.8804) acc_u 12.5000 (12.5000) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/32] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.9399 (0.8971) acc_u 6.2500 (11.2500) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [15/32] time 0.187 (0.180) data 0.109 (0.103) loss_u loss_u 0.9028 (0.9087) acc_u 9.3750 (10.2083) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/32] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.8687 (0.9039) acc_u 15.6250 (10.7812) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/32] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9497 (0.9029) acc_u 6.2500 (11.1250) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [30/32] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.9766 (0.9085) acc_u 3.1250 (10.6250) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 728
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 533
clean true:429
clean false:104
clean_rate:0.8048780487804879
noisy true:459
noisy false:624
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1083
epoch [115/200] batch [5/16] time 0.165 (0.177) data 0.089 (0.100) loss_x loss_x 0.5981 (0.7094) acc_x 84.3750 (80.0000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [10/16] time 0.162 (0.170) data 0.085 (0.093) loss_x loss_x 0.7036 (0.6981) acc_x 78.1250 (79.3750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/16] time 0.162 (0.170) data 0.085 (0.092) loss_x loss_x 0.3354 (0.6403) acc_x 87.5000 (81.6667) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/33] time 0.163 (0.169) data 0.085 (0.091) loss_u loss_u 0.8296 (0.8773) acc_u 18.7500 (15.0000) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/33] time 0.163 (0.168) data 0.085 (0.090) loss_u loss_u 0.8569 (0.8843) acc_u 15.6250 (13.4375) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [15/33] time 0.185 (0.169) data 0.107 (0.091) loss_u loss_u 0.9561 (0.9029) acc_u 3.1250 (10.8333) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/33] time 0.174 (0.169) data 0.097 (0.092) loss_u loss_u 0.8770 (0.9030) acc_u 15.6250 (10.6250) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/33] time 0.175 (0.169) data 0.098 (0.092) loss_u loss_u 0.8799 (0.8955) acc_u 15.6250 (11.7500) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [30/33] time 0.186 (0.171) data 0.108 (0.094) loss_u loss_u 0.9492 (0.8905) acc_u 3.1250 (12.2917) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 673
confident_label rate tensor(0.3422, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 553
clean true:449
clean false:104
clean_rate:0.8119349005424955
noisy true:494
noisy false:569
after delete: len(clean_dataset) 553
after delete: len(noisy_dataset) 1063
epoch [116/200] batch [5/17] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.8633 (0.6904) acc_x 84.3750 (83.1250) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/17] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.8188 (0.7302) acc_x 90.6250 (83.4375) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/17] time 0.171 (0.184) data 0.094 (0.107) loss_x loss_x 0.6694 (0.7202) acc_x 87.5000 (83.3333) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/33] time 0.211 (0.182) data 0.134 (0.105) loss_u loss_u 0.8750 (0.8982) acc_u 15.6250 (11.2500) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [10/33] time 0.178 (0.182) data 0.101 (0.105) loss_u loss_u 0.9214 (0.9159) acc_u 9.3750 (10.0000) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [15/33] time 0.180 (0.181) data 0.102 (0.104) loss_u loss_u 0.8413 (0.9062) acc_u 18.7500 (11.4583) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [20/33] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9043 (0.9093) acc_u 9.3750 (10.9375) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/33] time 0.173 (0.180) data 0.096 (0.103) loss_u loss_u 0.8418 (0.9045) acc_u 15.6250 (11.3750) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [30/33] time 0.167 (0.180) data 0.090 (0.103) loss_u loss_u 0.9502 (0.9049) acc_u 6.2500 (11.4583) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.3379, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 546
clean true:440
clean false:106
clean_rate:0.8058608058608059
noisy true:491
noisy false:579
after delete: len(clean_dataset) 546
after delete: len(noisy_dataset) 1070
epoch [117/200] batch [5/17] time 0.173 (0.181) data 0.096 (0.104) loss_x loss_x 0.3784 (0.6649) acc_x 93.7500 (81.2500) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/17] time 0.184 (0.177) data 0.106 (0.100) loss_x loss_x 0.5244 (0.6689) acc_x 81.2500 (81.2500) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [15/17] time 0.185 (0.180) data 0.109 (0.103) loss_x loss_x 0.3826 (0.6328) acc_x 84.3750 (82.5000) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/33] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8535 (0.9257) acc_u 18.7500 (9.3750) lr 7.6655e-04 eta 0:00:05
epoch [117/200] batch [10/33] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.9209 (0.9239) acc_u 6.2500 (8.7500) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/33] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9590 (0.9198) acc_u 3.1250 (9.3750) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/33] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8721 (0.9161) acc_u 18.7500 (10.0000) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/33] time 0.166 (0.181) data 0.089 (0.103) loss_u loss_u 0.9292 (0.9125) acc_u 6.2500 (10.2500) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [30/33] time 0.168 (0.179) data 0.090 (0.102) loss_u loss_u 0.7881 (0.9095) acc_u 28.1250 (10.5208) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 650
confident_label rate tensor(0.3515, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 568
clean true:451
clean false:117
clean_rate:0.7940140845070423
noisy true:515
noisy false:533
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1048
epoch [118/200] batch [5/17] time 0.164 (0.176) data 0.087 (0.098) loss_x loss_x 0.3110 (0.6769) acc_x 90.6250 (86.2500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/17] time 0.178 (0.174) data 0.100 (0.097) loss_x loss_x 0.5747 (0.5775) acc_x 84.3750 (86.8750) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [15/17] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 1.0332 (0.6125) acc_x 71.8750 (85.2083) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/32] time 0.182 (0.173) data 0.105 (0.096) loss_u loss_u 0.9126 (0.9139) acc_u 9.3750 (10.0000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/32] time 0.178 (0.174) data 0.100 (0.097) loss_u loss_u 0.9438 (0.8897) acc_u 6.2500 (12.8125) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [15/32] time 0.168 (0.173) data 0.090 (0.096) loss_u loss_u 0.9248 (0.8957) acc_u 9.3750 (12.2917) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/32] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.9170 (0.9036) acc_u 9.3750 (11.4062) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/32] time 0.178 (0.173) data 0.101 (0.096) loss_u loss_u 0.9185 (0.9015) acc_u 9.3750 (11.7500) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [30/32] time 0.189 (0.174) data 0.111 (0.097) loss_u loss_u 0.8481 (0.9009) acc_u 18.7500 (11.8750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:437
clean false:111
clean_rate:0.7974452554744526
noisy true:495
noisy false:573
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [119/200] batch [5/17] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.6685 (0.5804) acc_x 84.3750 (85.6250) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/17] time 0.160 (0.174) data 0.084 (0.097) loss_x loss_x 0.7236 (0.7577) acc_x 81.2500 (81.5625) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [15/17] time 0.161 (0.174) data 0.084 (0.097) loss_x loss_x 0.5259 (0.7141) acc_x 90.6250 (82.5000) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/33] time 0.159 (0.170) data 0.081 (0.093) loss_u loss_u 0.8389 (0.8968) acc_u 21.8750 (11.8750) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/33] time 0.163 (0.169) data 0.086 (0.092) loss_u loss_u 0.8960 (0.8863) acc_u 12.5000 (13.7500) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [15/33] time 0.160 (0.167) data 0.083 (0.090) loss_u loss_u 0.8940 (0.8844) acc_u 9.3750 (13.3333) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/33] time 0.160 (0.166) data 0.084 (0.089) loss_u loss_u 0.8726 (0.8831) acc_u 18.7500 (13.9062) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/33] time 0.158 (0.166) data 0.081 (0.088) loss_u loss_u 0.9116 (0.8892) acc_u 9.3750 (13.2500) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [30/33] time 0.179 (0.166) data 0.101 (0.089) loss_u loss_u 0.9438 (0.8952) acc_u 12.5000 (12.7083) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.3391, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 548
clean true:439
clean false:109
clean_rate:0.801094890510949
noisy true:493
noisy false:575
after delete: len(clean_dataset) 548
after delete: len(noisy_dataset) 1068
epoch [120/200] batch [5/17] time 0.183 (0.177) data 0.106 (0.099) loss_x loss_x 0.2566 (0.3877) acc_x 93.7500 (90.6250) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/17] time 0.164 (0.178) data 0.087 (0.100) loss_x loss_x 1.2598 (0.5623) acc_x 75.0000 (86.2500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [15/17] time 0.161 (0.172) data 0.084 (0.095) loss_x loss_x 0.6021 (0.6136) acc_x 87.5000 (84.5833) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/33] time 0.165 (0.171) data 0.087 (0.093) loss_u loss_u 0.9360 (0.9006) acc_u 6.2500 (12.5000) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/33] time 0.187 (0.172) data 0.110 (0.094) loss_u loss_u 0.8877 (0.9030) acc_u 12.5000 (12.1875) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [15/33] time 0.186 (0.173) data 0.109 (0.096) loss_u loss_u 0.8784 (0.8937) acc_u 15.6250 (12.9167) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/33] time 0.185 (0.175) data 0.108 (0.098) loss_u loss_u 0.9199 (0.8924) acc_u 9.3750 (12.6562) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/33] time 0.185 (0.177) data 0.107 (0.099) loss_u loss_u 0.9771 (0.9006) acc_u 3.1250 (12.0000) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [30/33] time 0.187 (0.178) data 0.111 (0.100) loss_u loss_u 0.8389 (0.9001) acc_u 15.6250 (11.7708) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.3509, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 567
clean true:451
clean false:116
clean_rate:0.7954144620811288
noisy true:494
noisy false:555
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1049
epoch [121/200] batch [5/17] time 0.197 (0.189) data 0.119 (0.112) loss_x loss_x 0.5991 (0.6547) acc_x 90.6250 (83.7500) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [10/17] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.5977 (0.7061) acc_x 87.5000 (82.1875) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/17] time 0.185 (0.186) data 0.109 (0.109) loss_x loss_x 0.2474 (0.6249) acc_x 90.6250 (83.7500) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/32] time 0.186 (0.185) data 0.109 (0.109) loss_u loss_u 0.9678 (0.9251) acc_u 3.1250 (8.7500) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [10/32] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.8320 (0.9089) acc_u 18.7500 (10.3125) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [15/32] time 0.181 (0.185) data 0.104 (0.108) loss_u loss_u 0.9019 (0.9166) acc_u 9.3750 (9.3750) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [20/32] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.9385 (0.9102) acc_u 9.3750 (10.1562) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/32] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8955 (0.9075) acc_u 12.5000 (10.5000) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/32] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9316 (0.9087) acc_u 6.2500 (10.2083) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 670
confident_label rate tensor(0.3459, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 559
clean true:445
clean false:114
clean_rate:0.7960644007155635
noisy true:501
noisy false:556
after delete: len(clean_dataset) 559
after delete: len(noisy_dataset) 1057
epoch [122/200] batch [5/17] time 0.186 (0.187) data 0.110 (0.110) loss_x loss_x 0.7002 (0.7065) acc_x 75.0000 (79.3750) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/17] time 0.185 (0.186) data 0.107 (0.109) loss_x loss_x 0.5630 (0.7153) acc_x 87.5000 (80.9375) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [15/17] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.3601 (0.6498) acc_x 93.7500 (82.7083) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/33] time 0.178 (0.185) data 0.100 (0.108) loss_u loss_u 0.8672 (0.9088) acc_u 12.5000 (9.3750) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [10/33] time 0.180 (0.184) data 0.102 (0.107) loss_u loss_u 0.9087 (0.9081) acc_u 9.3750 (10.0000) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [15/33] time 0.182 (0.184) data 0.104 (0.106) loss_u loss_u 0.8315 (0.9073) acc_u 18.7500 (9.7917) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/33] time 0.187 (0.184) data 0.108 (0.106) loss_u loss_u 0.9121 (0.9067) acc_u 9.3750 (10.1562) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/33] time 0.164 (0.185) data 0.085 (0.107) loss_u loss_u 0.8896 (0.9023) acc_u 12.5000 (10.8750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [30/33] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9009 (0.9036) acc_u 9.3750 (10.5208) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 672
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:445
clean false:102
clean_rate:0.8135283363802559
noisy true:499
noisy false:570
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [123/200] batch [5/17] time 0.186 (0.175) data 0.108 (0.097) loss_x loss_x 0.4778 (0.7869) acc_x 90.6250 (81.8750) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/17] time 0.161 (0.173) data 0.084 (0.096) loss_x loss_x 0.6509 (0.7895) acc_x 84.3750 (81.8750) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/17] time 0.188 (0.173) data 0.111 (0.096) loss_x loss_x 0.7212 (0.7290) acc_x 84.3750 (82.7083) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/33] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.9678 (0.8804) acc_u 3.1250 (13.7500) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/33] time 0.187 (0.179) data 0.108 (0.102) loss_u loss_u 0.9028 (0.8930) acc_u 12.5000 (11.8750) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/33] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.9697 (0.9012) acc_u 3.1250 (11.0417) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/33] time 0.172 (0.180) data 0.094 (0.103) loss_u loss_u 0.9624 (0.9059) acc_u 3.1250 (10.6250) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/33] time 0.163 (0.178) data 0.085 (0.101) loss_u loss_u 0.8921 (0.8981) acc_u 15.6250 (11.8750) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [30/33] time 0.161 (0.176) data 0.084 (0.099) loss_u loss_u 0.8105 (0.8955) acc_u 18.7500 (11.9792) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 666
confident_label rate tensor(0.3397, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 549
clean true:440
clean false:109
clean_rate:0.8014571948998178
noisy true:510
noisy false:557
after delete: len(clean_dataset) 549
after delete: len(noisy_dataset) 1067
epoch [124/200] batch [5/17] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.5547 (0.7692) acc_x 84.3750 (80.0000) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/17] time 0.182 (0.186) data 0.105 (0.108) loss_x loss_x 0.6260 (0.8170) acc_x 87.5000 (79.3750) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [15/17] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.6636 (0.7768) acc_x 84.3750 (80.6250) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/33] time 0.187 (0.185) data 0.110 (0.108) loss_u loss_u 0.9126 (0.9121) acc_u 12.5000 (10.6250) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [10/33] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.9233 (0.9238) acc_u 9.3750 (9.0625) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [15/33] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.8608 (0.9165) acc_u 18.7500 (10.4167) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/33] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.8872 (0.9090) acc_u 12.5000 (11.0938) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/33] time 0.189 (0.185) data 0.111 (0.108) loss_u loss_u 0.9062 (0.9035) acc_u 9.3750 (11.6250) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [30/33] time 0.186 (0.185) data 0.110 (0.108) loss_u loss_u 0.9658 (0.9060) acc_u 3.1250 (11.1458) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 670
confident_label rate tensor(0.3515, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 568
clean true:458
clean false:110
clean_rate:0.8063380281690141
noisy true:488
noisy false:560
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1048
epoch [125/200] batch [5/17] time 0.188 (0.191) data 0.111 (0.114) loss_x loss_x 0.8096 (0.6108) acc_x 81.2500 (85.6250) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/17] time 0.185 (0.188) data 0.109 (0.111) loss_x loss_x 0.2571 (0.5217) acc_x 96.8750 (86.5625) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [15/17] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.7271 (0.5934) acc_x 78.1250 (84.3750) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/32] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.9639 (0.9444) acc_u 3.1250 (5.6250) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [10/32] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.8569 (0.9155) acc_u 15.6250 (9.3750) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [15/32] time 0.184 (0.186) data 0.107 (0.108) loss_u loss_u 0.7822 (0.9062) acc_u 28.1250 (10.8333) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/32] time 0.187 (0.186) data 0.109 (0.108) loss_u loss_u 0.8730 (0.9017) acc_u 15.6250 (11.4062) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/32] time 0.184 (0.186) data 0.107 (0.108) loss_u loss_u 0.9209 (0.9034) acc_u 9.3750 (11.1250) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [30/32] time 0.184 (0.186) data 0.106 (0.108) loss_u loss_u 0.9731 (0.9085) acc_u 3.1250 (10.3125) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.3515, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 568
clean true:455
clean false:113
clean_rate:0.801056338028169
noisy true:490
noisy false:558
after delete: len(clean_dataset) 568
after delete: len(noisy_dataset) 1048
epoch [126/200] batch [5/17] time 0.178 (0.187) data 0.101 (0.110) loss_x loss_x 0.4653 (0.4889) acc_x 84.3750 (87.5000) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [10/17] time 0.161 (0.177) data 0.084 (0.100) loss_x loss_x 0.6924 (0.5078) acc_x 84.3750 (87.8125) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [15/17] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.8799 (0.5515) acc_x 81.2500 (86.8750) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/32] time 0.176 (0.179) data 0.098 (0.102) loss_u loss_u 0.8735 (0.8967) acc_u 18.7500 (13.7500) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/32] time 0.164 (0.177) data 0.087 (0.100) loss_u loss_u 0.9009 (0.9118) acc_u 12.5000 (10.6250) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [15/32] time 0.169 (0.176) data 0.091 (0.099) loss_u loss_u 0.9160 (0.9084) acc_u 9.3750 (11.0417) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/32] time 0.186 (0.177) data 0.108 (0.100) loss_u loss_u 0.8555 (0.9039) acc_u 15.6250 (11.4062) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/32] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.9531 (0.9012) acc_u 3.1250 (11.5000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [30/32] time 0.187 (0.179) data 0.110 (0.101) loss_u loss_u 0.9316 (0.9057) acc_u 3.1250 (10.7292) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3509, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 567
clean true:448
clean false:119
clean_rate:0.7901234567901234
noisy true:490
noisy false:559
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1049
epoch [127/200] batch [5/17] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.5859 (0.6786) acc_x 87.5000 (82.5000) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [10/17] time 0.186 (0.180) data 0.108 (0.102) loss_x loss_x 1.0664 (0.7004) acc_x 71.8750 (81.5625) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [15/17] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.5513 (0.6632) acc_x 93.7500 (83.1250) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/32] time 0.181 (0.182) data 0.104 (0.104) loss_u loss_u 0.9004 (0.8892) acc_u 12.5000 (13.7500) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/32] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8906 (0.8937) acc_u 12.5000 (13.1250) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [15/32] time 0.181 (0.182) data 0.103 (0.104) loss_u loss_u 0.8740 (0.8970) acc_u 15.6250 (12.9167) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [20/32] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9629 (0.9059) acc_u 3.1250 (11.5625) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/32] time 0.176 (0.182) data 0.096 (0.105) loss_u loss_u 0.8750 (0.9067) acc_u 12.5000 (11.2500) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [30/32] time 0.170 (0.182) data 0.092 (0.104) loss_u loss_u 0.9697 (0.9049) acc_u 0.0000 (11.3542) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 657
confident_label rate tensor(0.3546, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 573
clean true:456
clean false:117
clean_rate:0.7958115183246073
noisy true:503
noisy false:540
after delete: len(clean_dataset) 573
after delete: len(noisy_dataset) 1043
epoch [128/200] batch [5/17] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 1.1172 (0.6377) acc_x 75.0000 (85.6250) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [10/17] time 0.185 (0.184) data 0.107 (0.107) loss_x loss_x 0.5801 (0.7558) acc_x 87.5000 (80.6250) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [15/17] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.4216 (0.7518) acc_x 84.3750 (79.1667) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/32] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9731 (0.8805) acc_u 3.1250 (13.1250) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/32] time 0.189 (0.184) data 0.112 (0.107) loss_u loss_u 0.9272 (0.8830) acc_u 9.3750 (13.1250) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [15/32] time 0.189 (0.185) data 0.111 (0.107) loss_u loss_u 0.9429 (0.8923) acc_u 6.2500 (11.8750) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [20/32] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.9111 (0.9005) acc_u 15.6250 (11.4062) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/32] time 0.189 (0.185) data 0.111 (0.108) loss_u loss_u 0.9111 (0.8974) acc_u 9.3750 (11.3750) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/32] time 0.186 (0.186) data 0.108 (0.108) loss_u loss_u 0.9238 (0.8992) acc_u 9.3750 (11.0417) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 694
confident_label rate tensor(0.3441, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 556
clean true:436
clean false:120
clean_rate:0.7841726618705036
noisy true:486
noisy false:574
after delete: len(clean_dataset) 556
after delete: len(noisy_dataset) 1060
epoch [129/200] batch [5/17] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.9307 (0.8165) acc_x 68.7500 (78.7500) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/17] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.7261 (0.6920) acc_x 78.1250 (80.9375) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [15/17] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.8643 (0.6859) acc_x 78.1250 (81.6667) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/33] time 0.185 (0.185) data 0.106 (0.108) loss_u loss_u 0.9219 (0.9129) acc_u 12.5000 (9.3750) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [10/33] time 0.187 (0.186) data 0.109 (0.108) loss_u loss_u 0.9331 (0.9070) acc_u 9.3750 (10.6250) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [15/33] time 0.172 (0.183) data 0.094 (0.106) loss_u loss_u 0.8960 (0.9052) acc_u 9.3750 (10.4167) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [20/33] time 0.161 (0.182) data 0.084 (0.105) loss_u loss_u 0.8882 (0.9036) acc_u 12.5000 (10.6250) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/33] time 0.186 (0.183) data 0.107 (0.106) loss_u loss_u 0.8755 (0.9007) acc_u 15.6250 (11.2500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/33] time 0.174 (0.184) data 0.094 (0.106) loss_u loss_u 0.8906 (0.8987) acc_u 12.5000 (11.7708) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 650
confident_label rate tensor(0.3527, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 570
clean true:460
clean false:110
clean_rate:0.8070175438596491
noisy true:506
noisy false:540
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1046
epoch [130/200] batch [5/17] time 0.158 (0.174) data 0.081 (0.097) loss_x loss_x 1.0645 (0.8970) acc_x 75.0000 (78.1250) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [10/17] time 0.178 (0.169) data 0.101 (0.092) loss_x loss_x 0.5005 (0.7861) acc_x 90.6250 (80.6250) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/17] time 0.182 (0.172) data 0.106 (0.095) loss_x loss_x 0.6113 (0.6784) acc_x 81.2500 (82.5000) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/32] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9014 (0.8940) acc_u 15.6250 (13.7500) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/32] time 0.178 (0.176) data 0.099 (0.099) loss_u loss_u 0.9194 (0.9032) acc_u 9.3750 (11.8750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [15/32] time 0.187 (0.178) data 0.110 (0.100) loss_u loss_u 0.9287 (0.9004) acc_u 9.3750 (12.0833) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [20/32] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9434 (0.9042) acc_u 6.2500 (11.5625) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/32] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.9009 (0.9008) acc_u 9.3750 (11.8750) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/32] time 0.185 (0.180) data 0.108 (0.102) loss_u loss_u 0.9238 (0.9056) acc_u 9.3750 (11.1458) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 657
confident_label rate tensor(0.3521, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 569
clean true:455
clean false:114
clean_rate:0.7996485061511424
noisy true:504
noisy false:543
after delete: len(clean_dataset) 569
after delete: len(noisy_dataset) 1047
epoch [131/200] batch [5/17] time 0.158 (0.178) data 0.081 (0.100) loss_x loss_x 0.9067 (0.6417) acc_x 81.2500 (81.8750) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/17] time 0.159 (0.169) data 0.082 (0.091) loss_x loss_x 0.5103 (0.5453) acc_x 87.5000 (86.2500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/17] time 0.171 (0.168) data 0.095 (0.091) loss_x loss_x 1.1572 (0.6185) acc_x 71.8750 (83.7500) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/32] time 0.168 (0.167) data 0.091 (0.089) loss_u loss_u 0.8589 (0.8911) acc_u 18.7500 (12.5000) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/32] time 0.162 (0.167) data 0.085 (0.089) loss_u loss_u 0.9482 (0.8982) acc_u 6.2500 (11.8750) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [15/32] time 0.171 (0.168) data 0.094 (0.091) loss_u loss_u 0.9619 (0.9084) acc_u 3.1250 (10.4167) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/32] time 0.174 (0.170) data 0.097 (0.092) loss_u loss_u 0.8462 (0.9040) acc_u 18.7500 (11.0938) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/32] time 0.184 (0.169) data 0.107 (0.092) loss_u loss_u 0.8770 (0.9050) acc_u 15.6250 (11.1250) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/32] time 0.183 (0.171) data 0.106 (0.094) loss_u loss_u 0.9302 (0.9042) acc_u 9.3750 (11.2500) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.3465, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 560
clean true:437
clean false:123
clean_rate:0.7803571428571429
noisy true:486
noisy false:570
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1056
epoch [132/200] batch [5/17] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.2061 (0.6806) acc_x 96.8750 (84.3750) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/17] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.3962 (0.5668) acc_x 87.5000 (86.2500) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [15/17] time 0.168 (0.184) data 0.091 (0.107) loss_x loss_x 1.1621 (0.6241) acc_x 71.8750 (83.7500) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/33] time 0.162 (0.178) data 0.083 (0.101) loss_u loss_u 0.9404 (0.9257) acc_u 6.2500 (8.7500) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/33] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9443 (0.9140) acc_u 3.1250 (9.3750) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [15/33] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.9307 (0.9005) acc_u 9.3750 (11.4583) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [20/33] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8018 (0.8932) acc_u 21.8750 (12.0312) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/33] time 0.187 (0.180) data 0.110 (0.103) loss_u loss_u 0.8838 (0.8918) acc_u 12.5000 (12.1250) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [30/33] time 0.183 (0.181) data 0.106 (0.103) loss_u loss_u 0.9043 (0.8956) acc_u 12.5000 (11.6667) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 665
confident_label rate tensor(0.3614, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 584
clean true:467
clean false:117
clean_rate:0.7996575342465754
noisy true:484
noisy false:548
after delete: len(clean_dataset) 584
after delete: len(noisy_dataset) 1032
epoch [133/200] batch [5/18] time 0.188 (0.191) data 0.111 (0.113) loss_x loss_x 0.4329 (0.5548) acc_x 93.7500 (87.5000) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/18] time 0.187 (0.189) data 0.110 (0.111) loss_x loss_x 0.2468 (0.5655) acc_x 96.8750 (87.5000) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [15/18] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.6553 (0.5450) acc_x 81.2500 (87.2917) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/32] time 0.187 (0.186) data 0.109 (0.109) loss_u loss_u 0.9004 (0.8878) acc_u 12.5000 (12.5000) lr 5.3207e-04 eta 0:00:05
epoch [133/200] batch [10/32] time 0.186 (0.186) data 0.109 (0.109) loss_u loss_u 0.9229 (0.9000) acc_u 9.3750 (11.2500) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [15/32] time 0.179 (0.187) data 0.102 (0.109) loss_u loss_u 0.9365 (0.9094) acc_u 9.3750 (10.4167) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [20/32] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.8677 (0.9049) acc_u 12.5000 (10.7812) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/32] time 0.174 (0.186) data 0.095 (0.108) loss_u loss_u 0.9331 (0.9086) acc_u 6.2500 (10.2500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [30/32] time 0.184 (0.186) data 0.106 (0.108) loss_u loss_u 0.9014 (0.9109) acc_u 9.3750 (10.2083) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.3527, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 570
clean true:457
clean false:113
clean_rate:0.8017543859649123
noisy true:500
noisy false:546
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1046
epoch [134/200] batch [5/17] time 0.185 (0.192) data 0.108 (0.115) loss_x loss_x 0.9248 (0.7268) acc_x 75.0000 (81.2500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/17] time 0.187 (0.188) data 0.110 (0.111) loss_x loss_x 0.4368 (0.6645) acc_x 90.6250 (83.1250) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [15/17] time 0.182 (0.187) data 0.106 (0.110) loss_x loss_x 0.9185 (0.6603) acc_x 75.0000 (82.2917) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/32] time 0.184 (0.187) data 0.107 (0.110) loss_u loss_u 0.9307 (0.8921) acc_u 6.2500 (11.8750) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [10/32] time 0.177 (0.185) data 0.096 (0.108) loss_u loss_u 0.8765 (0.8946) acc_u 12.5000 (11.5625) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [15/32] time 0.169 (0.183) data 0.091 (0.105) loss_u loss_u 0.8789 (0.8984) acc_u 18.7500 (11.6667) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/32] time 0.167 (0.182) data 0.090 (0.104) loss_u loss_u 0.8652 (0.8891) acc_u 15.6250 (12.5000) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/32] time 0.166 (0.183) data 0.089 (0.105) loss_u loss_u 0.9419 (0.8870) acc_u 6.2500 (13.0000) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/32] time 0.170 (0.182) data 0.092 (0.105) loss_u loss_u 0.8940 (0.8937) acc_u 9.3750 (12.1875) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 661
confident_label rate tensor(0.3620, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 585
clean true:460
clean false:125
clean_rate:0.7863247863247863
noisy true:495
noisy false:536
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1031
epoch [135/200] batch [5/18] time 0.188 (0.188) data 0.110 (0.111) loss_x loss_x 0.2666 (0.4803) acc_x 87.5000 (87.5000) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/18] time 0.170 (0.181) data 0.091 (0.104) loss_x loss_x 0.2499 (0.5548) acc_x 93.7500 (84.3750) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [15/18] time 0.191 (0.182) data 0.115 (0.105) loss_x loss_x 0.6724 (0.6310) acc_x 78.1250 (82.9167) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/32] time 0.185 (0.181) data 0.107 (0.103) loss_u loss_u 0.9912 (0.9313) acc_u 0.0000 (6.2500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/32] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8984 (0.9257) acc_u 12.5000 (7.5000) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [15/32] time 0.168 (0.180) data 0.090 (0.102) loss_u loss_u 0.9253 (0.9194) acc_u 12.5000 (8.1250) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/32] time 0.172 (0.180) data 0.095 (0.102) loss_u loss_u 0.9155 (0.9179) acc_u 12.5000 (8.9062) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/32] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.9336 (0.9117) acc_u 6.2500 (9.6250) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/32] time 0.184 (0.179) data 0.107 (0.101) loss_u loss_u 0.9526 (0.9117) acc_u 3.1250 (9.8958) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 648
confident_label rate tensor(0.3552, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 574
clean true:453
clean false:121
clean_rate:0.789198606271777
noisy true:515
noisy false:527
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1042
epoch [136/200] batch [5/17] time 0.164 (0.173) data 0.088 (0.096) loss_x loss_x 0.3066 (0.5579) acc_x 93.7500 (86.8750) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/17] time 0.163 (0.169) data 0.086 (0.092) loss_x loss_x 1.0488 (0.6795) acc_x 71.8750 (83.1250) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [15/17] time 0.167 (0.168) data 0.090 (0.091) loss_x loss_x 0.6270 (0.6797) acc_x 78.1250 (82.2917) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/32] time 0.161 (0.168) data 0.083 (0.090) loss_u loss_u 0.8604 (0.8922) acc_u 18.7500 (13.1250) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/32] time 0.167 (0.168) data 0.090 (0.090) loss_u loss_u 0.8970 (0.8935) acc_u 12.5000 (13.4375) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/32] time 0.185 (0.172) data 0.107 (0.095) loss_u loss_u 0.9341 (0.8967) acc_u 9.3750 (12.5000) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/32] time 0.187 (0.174) data 0.110 (0.097) loss_u loss_u 0.8477 (0.8954) acc_u 15.6250 (12.1875) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/32] time 0.177 (0.175) data 0.100 (0.098) loss_u loss_u 0.9014 (0.8994) acc_u 12.5000 (11.7500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [30/32] time 0.173 (0.175) data 0.095 (0.098) loss_u loss_u 0.8984 (0.8985) acc_u 12.5000 (11.7708) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 667
confident_label rate tensor(0.3595, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 581
clean true:462
clean false:119
clean_rate:0.7951807228915663
noisy true:487
noisy false:548
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1035
epoch [137/200] batch [5/18] time 0.164 (0.163) data 0.087 (0.086) loss_x loss_x 0.3113 (0.5039) acc_x 93.7500 (87.5000) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/18] time 0.184 (0.170) data 0.106 (0.093) loss_x loss_x 0.7168 (0.5150) acc_x 78.1250 (86.2500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [15/18] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 0.4570 (0.5369) acc_x 90.6250 (85.6250) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/32] time 0.169 (0.172) data 0.092 (0.095) loss_u loss_u 0.8770 (0.9245) acc_u 15.6250 (8.7500) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/32] time 0.169 (0.173) data 0.092 (0.096) loss_u loss_u 0.9209 (0.9083) acc_u 9.3750 (10.3125) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [15/32] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.8979 (0.9011) acc_u 12.5000 (11.4583) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/32] time 0.184 (0.174) data 0.107 (0.097) loss_u loss_u 0.9194 (0.9006) acc_u 9.3750 (11.8750) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/32] time 0.180 (0.175) data 0.102 (0.097) loss_u loss_u 0.8931 (0.8964) acc_u 9.3750 (12.2500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/32] time 0.179 (0.175) data 0.100 (0.098) loss_u loss_u 0.9585 (0.8994) acc_u 6.2500 (11.6667) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.3472, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 561
clean true:441
clean false:120
clean_rate:0.786096256684492
noisy true:491
noisy false:564
after delete: len(clean_dataset) 561
after delete: len(noisy_dataset) 1055
epoch [138/200] batch [5/17] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.5947 (0.4868) acc_x 81.2500 (88.1250) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/17] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.1610 (0.5584) acc_x 96.8750 (86.5625) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [15/17] time 0.174 (0.183) data 0.098 (0.105) loss_x loss_x 0.4097 (0.5677) acc_x 87.5000 (85.6250) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/32] time 0.170 (0.180) data 0.091 (0.102) loss_u loss_u 0.9194 (0.8805) acc_u 6.2500 (14.3750) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/32] time 0.172 (0.178) data 0.093 (0.101) loss_u loss_u 0.8906 (0.8905) acc_u 12.5000 (13.4375) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [15/32] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.8105 (0.8826) acc_u 21.8750 (14.3750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/32] time 0.171 (0.176) data 0.092 (0.099) loss_u loss_u 0.9380 (0.8885) acc_u 6.2500 (13.2812) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/32] time 0.172 (0.176) data 0.092 (0.098) loss_u loss_u 0.8276 (0.8905) acc_u 18.7500 (12.8750) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/32] time 0.186 (0.177) data 0.108 (0.099) loss_u loss_u 0.9292 (0.8949) acc_u 9.3750 (12.3958) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 680
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:455
clean false:131
clean_rate:0.7764505119453925
noisy true:481
noisy false:549
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [139/200] batch [5/18] time 0.166 (0.173) data 0.088 (0.096) loss_x loss_x 0.2394 (0.3906) acc_x 93.7500 (90.0000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [10/18] time 0.166 (0.168) data 0.088 (0.091) loss_x loss_x 0.7378 (0.5020) acc_x 84.3750 (85.9375) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [15/18] time 0.162 (0.167) data 0.085 (0.089) loss_x loss_x 0.4790 (0.4998) acc_x 84.3750 (86.2500) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/32] time 0.173 (0.169) data 0.096 (0.092) loss_u loss_u 0.9346 (0.9171) acc_u 6.2500 (10.0000) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/32] time 0.187 (0.170) data 0.108 (0.092) loss_u loss_u 0.9351 (0.9191) acc_u 9.3750 (9.6875) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [15/32] time 0.186 (0.172) data 0.107 (0.095) loss_u loss_u 0.9678 (0.9208) acc_u 3.1250 (9.1667) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/32] time 0.160 (0.171) data 0.083 (0.094) loss_u loss_u 0.9321 (0.9217) acc_u 9.3750 (9.0625) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [25/32] time 0.169 (0.171) data 0.088 (0.093) loss_u loss_u 0.8789 (0.9072) acc_u 12.5000 (10.8750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/32] time 0.193 (0.171) data 0.116 (0.093) loss_u loss_u 0.8340 (0.9059) acc_u 15.6250 (10.9375) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.3527, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 570
clean true:453
clean false:117
clean_rate:0.7947368421052632
noisy true:511
noisy false:535
after delete: len(clean_dataset) 570
after delete: len(noisy_dataset) 1046
epoch [140/200] batch [5/17] time 0.183 (0.186) data 0.106 (0.108) loss_x loss_x 1.9580 (0.9331) acc_x 68.7500 (78.7500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/17] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.6377 (0.6797) acc_x 84.3750 (83.4375) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/17] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.5913 (0.6106) acc_x 78.1250 (84.1667) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/32] time 0.184 (0.185) data 0.108 (0.108) loss_u loss_u 0.9375 (0.8956) acc_u 6.2500 (11.2500) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/32] time 0.183 (0.186) data 0.106 (0.109) loss_u loss_u 0.9409 (0.9108) acc_u 6.2500 (9.3750) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [15/32] time 0.176 (0.185) data 0.097 (0.108) loss_u loss_u 0.8745 (0.8922) acc_u 12.5000 (11.6667) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [20/32] time 0.170 (0.184) data 0.092 (0.107) loss_u loss_u 0.9375 (0.8958) acc_u 6.2500 (11.2500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/32] time 0.185 (0.184) data 0.106 (0.107) loss_u loss_u 0.8784 (0.8945) acc_u 12.5000 (11.5000) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/32] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9800 (0.8993) acc_u 3.1250 (11.2500) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 670
confident_label rate tensor(0.3564, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 576
clean true:453
clean false:123
clean_rate:0.7864583333333334
noisy true:493
noisy false:547
after delete: len(clean_dataset) 576
after delete: len(noisy_dataset) 1040
epoch [141/200] batch [5/18] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.7363 (0.7408) acc_x 81.2500 (81.2500) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/18] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 0.5576 (0.6594) acc_x 81.2500 (81.8750) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [15/18] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.8516 (0.6807) acc_x 75.0000 (80.6250) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/32] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9219 (0.8701) acc_u 9.3750 (13.7500) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/32] time 0.180 (0.185) data 0.102 (0.108) loss_u loss_u 0.9590 (0.8977) acc_u 3.1250 (10.9375) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [15/32] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.9482 (0.9011) acc_u 9.3750 (11.0417) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/32] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.8237 (0.9010) acc_u 18.7500 (11.0938) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/32] time 0.179 (0.185) data 0.102 (0.108) loss_u loss_u 0.8892 (0.9000) acc_u 12.5000 (11.5000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/32] time 0.187 (0.184) data 0.109 (0.107) loss_u loss_u 0.9268 (0.8974) acc_u 6.2500 (11.7708) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 648
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:467
clean false:119
clean_rate:0.7969283276450512
noisy true:501
noisy false:529
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [142/200] batch [5/18] time 0.186 (0.187) data 0.109 (0.110) loss_x loss_x 0.3123 (0.5619) acc_x 90.6250 (85.0000) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/18] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 1.2275 (0.6817) acc_x 62.5000 (81.8750) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [15/18] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.6504 (0.6552) acc_x 84.3750 (82.7083) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/32] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.9121 (0.9039) acc_u 9.3750 (10.6250) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [10/32] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.8481 (0.8957) acc_u 15.6250 (11.2500) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [15/32] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9805 (0.9075) acc_u 3.1250 (9.7917) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/32] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.9297 (0.9053) acc_u 9.3750 (10.3125) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/32] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.7710 (0.9061) acc_u 28.1250 (10.3750) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/32] time 0.180 (0.185) data 0.102 (0.108) loss_u loss_u 0.8555 (0.9046) acc_u 15.6250 (10.6250) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 675
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:463
clean false:127
clean_rate:0.7847457627118644
noisy true:478
noisy false:548
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [143/200] batch [5/18] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.4158 (0.6536) acc_x 87.5000 (85.6250) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/18] time 0.185 (0.175) data 0.108 (0.098) loss_x loss_x 0.3176 (0.6197) acc_x 93.7500 (85.6250) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [15/18] time 0.187 (0.178) data 0.109 (0.101) loss_x loss_x 0.8496 (0.6251) acc_x 75.0000 (84.5833) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/32] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8975 (0.8870) acc_u 12.5000 (13.1250) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/32] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9307 (0.9142) acc_u 6.2500 (10.0000) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [15/32] time 0.193 (0.182) data 0.114 (0.105) loss_u loss_u 0.8896 (0.9116) acc_u 12.5000 (10.4167) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/32] time 0.187 (0.183) data 0.110 (0.105) loss_u loss_u 0.8945 (0.9118) acc_u 12.5000 (10.4688) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/32] time 0.185 (0.183) data 0.108 (0.105) loss_u loss_u 0.9502 (0.9071) acc_u 6.2500 (11.1250) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/32] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.9678 (0.9063) acc_u 3.1250 (11.2500) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.3670, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 593
clean true:466
clean false:127
clean_rate:0.7858347386172007
noisy true:479
noisy false:544
after delete: len(clean_dataset) 593
after delete: len(noisy_dataset) 1023
epoch [144/200] batch [5/18] time 0.164 (0.183) data 0.087 (0.106) loss_x loss_x 0.5366 (0.6857) acc_x 81.2500 (79.3750) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/18] time 0.185 (0.183) data 0.109 (0.107) loss_x loss_x 0.8594 (0.6811) acc_x 84.3750 (81.5625) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [15/18] time 0.168 (0.183) data 0.091 (0.106) loss_x loss_x 0.3708 (0.6813) acc_x 90.6250 (82.7083) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/31] time 0.164 (0.181) data 0.087 (0.104) loss_u loss_u 0.8857 (0.9167) acc_u 12.5000 (8.1250) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/31] time 0.191 (0.181) data 0.113 (0.104) loss_u loss_u 0.8115 (0.9021) acc_u 21.8750 (10.0000) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/31] time 0.190 (0.182) data 0.112 (0.105) loss_u loss_u 0.9346 (0.9004) acc_u 9.3750 (10.8333) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/31] time 0.189 (0.182) data 0.111 (0.105) loss_u loss_u 0.9580 (0.9061) acc_u 3.1250 (10.0000) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/31] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9321 (0.9062) acc_u 9.3750 (10.1250) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/31] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.9043 (0.9020) acc_u 9.3750 (10.6250) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.3676, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 594
clean true:469
clean false:125
clean_rate:0.7895622895622896
noisy true:488
noisy false:534
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1022
epoch [145/200] batch [5/18] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.6924 (0.6049) acc_x 90.6250 (87.5000) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/18] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.4822 (0.6227) acc_x 93.7500 (87.5000) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [15/18] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6938 (0.6397) acc_x 81.2500 (86.0417) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/31] time 0.185 (0.185) data 0.108 (0.107) loss_u loss_u 0.8760 (0.9054) acc_u 15.6250 (10.6250) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/31] time 0.186 (0.185) data 0.107 (0.107) loss_u loss_u 0.8550 (0.8991) acc_u 15.6250 (11.8750) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [15/31] time 0.176 (0.184) data 0.097 (0.107) loss_u loss_u 0.9307 (0.9122) acc_u 6.2500 (9.3750) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/31] time 0.159 (0.182) data 0.081 (0.105) loss_u loss_u 0.9668 (0.9137) acc_u 3.1250 (9.3750) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/31] time 0.185 (0.182) data 0.108 (0.104) loss_u loss_u 0.8770 (0.9145) acc_u 15.6250 (9.3750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [30/31] time 0.187 (0.182) data 0.109 (0.104) loss_u loss_u 0.9385 (0.9080) acc_u 6.2500 (10.2083) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.3620, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 585
clean true:462
clean false:123
clean_rate:0.7897435897435897
noisy true:490
noisy false:541
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1031
epoch [146/200] batch [5/18] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.7314 (0.6024) acc_x 78.1250 (84.3750) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/18] time 0.172 (0.183) data 0.095 (0.106) loss_x loss_x 0.4895 (0.5357) acc_x 84.3750 (85.3125) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [15/18] time 0.187 (0.178) data 0.107 (0.101) loss_x loss_x 0.8506 (0.5509) acc_x 71.8750 (85.0000) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/32] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8774 (0.9140) acc_u 12.5000 (10.0000) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/32] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9272 (0.9180) acc_u 6.2500 (9.3750) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/32] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9644 (0.9070) acc_u 6.2500 (10.6250) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [20/32] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8086 (0.9058) acc_u 18.7500 (10.7812) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/32] time 0.186 (0.182) data 0.107 (0.105) loss_u loss_u 0.8193 (0.9026) acc_u 21.8750 (11.6250) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/32] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8906 (0.9042) acc_u 9.3750 (11.1458) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 692
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 577
clean true:453
clean false:124
clean_rate:0.7850953206239168
noisy true:471
noisy false:568
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1039
epoch [147/200] batch [5/18] time 0.185 (0.186) data 0.108 (0.108) loss_x loss_x 0.3057 (0.3786) acc_x 100.0000 (91.2500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/18] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.9233 (0.5428) acc_x 75.0000 (85.9375) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [15/18] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.9297 (0.5981) acc_x 81.2500 (85.0000) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/32] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9268 (0.9171) acc_u 9.3750 (8.7500) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/32] time 0.183 (0.182) data 0.106 (0.104) loss_u loss_u 0.8018 (0.9010) acc_u 25.0000 (11.5625) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/32] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9121 (0.8935) acc_u 12.5000 (12.0833) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [20/32] time 0.191 (0.182) data 0.112 (0.105) loss_u loss_u 0.8027 (0.8901) acc_u 25.0000 (12.8125) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/32] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8545 (0.8884) acc_u 18.7500 (13.2500) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/32] time 0.172 (0.181) data 0.093 (0.104) loss_u loss_u 0.9946 (0.8944) acc_u 0.0000 (12.7083) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.3614, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 584
clean true:445
clean false:139
clean_rate:0.761986301369863
noisy true:500
noisy false:532
after delete: len(clean_dataset) 584
after delete: len(noisy_dataset) 1032
epoch [148/200] batch [5/18] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6167 (0.6008) acc_x 81.2500 (86.8750) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/18] time 0.178 (0.183) data 0.099 (0.106) loss_x loss_x 0.7485 (0.5625) acc_x 81.2500 (85.3125) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [15/18] time 0.170 (0.180) data 0.092 (0.103) loss_x loss_x 0.9937 (0.6614) acc_x 81.2500 (83.3333) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/32] time 0.161 (0.174) data 0.084 (0.097) loss_u loss_u 0.8921 (0.8914) acc_u 12.5000 (13.1250) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/32] time 0.186 (0.176) data 0.110 (0.099) loss_u loss_u 0.8584 (0.9091) acc_u 15.6250 (10.6250) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [15/32] time 0.165 (0.174) data 0.087 (0.097) loss_u loss_u 0.7500 (0.8869) acc_u 31.2500 (13.3333) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/32] time 0.159 (0.173) data 0.082 (0.096) loss_u loss_u 0.8252 (0.8919) acc_u 21.8750 (12.6562) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/32] time 0.171 (0.173) data 0.094 (0.095) loss_u loss_u 0.9023 (0.8962) acc_u 12.5000 (12.0000) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/32] time 0.176 (0.172) data 0.099 (0.095) loss_u loss_u 0.8105 (0.8924) acc_u 25.0000 (12.6042) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:463
clean false:140
clean_rate:0.7678275290215588
noisy true:475
noisy false:538
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [149/200] batch [5/18] time 0.177 (0.170) data 0.101 (0.093) loss_x loss_x 0.7759 (0.6446) acc_x 78.1250 (83.7500) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [10/18] time 0.186 (0.175) data 0.109 (0.098) loss_x loss_x 0.7788 (0.6704) acc_x 71.8750 (82.1875) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [15/18] time 0.186 (0.178) data 0.109 (0.102) loss_x loss_x 0.5898 (0.6229) acc_x 84.3750 (83.9583) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/31] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9282 (0.8637) acc_u 6.2500 (15.6250) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/31] time 0.173 (0.178) data 0.096 (0.101) loss_u loss_u 0.8657 (0.8776) acc_u 12.5000 (13.7500) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/31] time 0.177 (0.178) data 0.100 (0.102) loss_u loss_u 0.8291 (0.8868) acc_u 18.7500 (12.9167) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/31] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.9399 (0.8978) acc_u 6.2500 (11.5625) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [25/31] time 0.185 (0.179) data 0.109 (0.102) loss_u loss_u 0.9429 (0.8966) acc_u 6.2500 (11.6250) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/31] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.9160 (0.8962) acc_u 9.3750 (11.6667) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 702
confident_label rate tensor(0.3614, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 584
clean true:453
clean false:131
clean_rate:0.7756849315068494
noisy true:461
noisy false:571
after delete: len(clean_dataset) 584
after delete: len(noisy_dataset) 1032
epoch [150/200] batch [5/18] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.3076 (0.4973) acc_x 90.6250 (85.6250) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/18] time 0.188 (0.185) data 0.112 (0.108) loss_x loss_x 0.7158 (0.4816) acc_x 81.2500 (86.2500) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/18] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.6812 (0.5567) acc_x 81.2500 (84.5833) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/32] time 0.191 (0.185) data 0.113 (0.108) loss_u loss_u 0.8613 (0.8886) acc_u 15.6250 (12.5000) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/32] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.8818 (0.8889) acc_u 12.5000 (12.8125) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [15/32] time 0.183 (0.184) data 0.105 (0.108) loss_u loss_u 0.9385 (0.8931) acc_u 9.3750 (12.5000) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [20/32] time 0.161 (0.183) data 0.083 (0.106) loss_u loss_u 0.8901 (0.8951) acc_u 12.5000 (12.1875) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/32] time 0.163 (0.181) data 0.084 (0.104) loss_u loss_u 0.9102 (0.8905) acc_u 9.3750 (12.6250) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/32] time 0.173 (0.180) data 0.096 (0.103) loss_u loss_u 0.9712 (0.8919) acc_u 6.2500 (12.5000) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:463
clean false:139
clean_rate:0.7691029900332226
noisy true:471
noisy false:543
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [151/200] batch [5/18] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.7563 (0.6824) acc_x 75.0000 (81.8750) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/18] time 0.189 (0.186) data 0.111 (0.109) loss_x loss_x 1.3145 (0.7604) acc_x 71.8750 (79.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [15/18] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.5771 (0.6853) acc_x 84.3750 (82.0833) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/31] time 0.190 (0.186) data 0.113 (0.109) loss_u loss_u 0.9653 (0.9036) acc_u 6.2500 (10.0000) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/31] time 0.184 (0.186) data 0.107 (0.109) loss_u loss_u 0.8335 (0.8968) acc_u 18.7500 (11.5625) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [15/31] time 0.187 (0.186) data 0.108 (0.108) loss_u loss_u 0.8901 (0.9072) acc_u 12.5000 (10.6250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/31] time 0.190 (0.186) data 0.113 (0.109) loss_u loss_u 0.9238 (0.9084) acc_u 6.2500 (10.4688) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/31] time 0.169 (0.185) data 0.091 (0.107) loss_u loss_u 0.9165 (0.9074) acc_u 9.3750 (10.7500) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/31] time 0.179 (0.183) data 0.101 (0.106) loss_u loss_u 0.9756 (0.9078) acc_u 3.1250 (10.6250) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 698
confident_label rate tensor(0.3583, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 579
clean true:447
clean false:132
clean_rate:0.772020725388601
noisy true:471
noisy false:566
after delete: len(clean_dataset) 579
after delete: len(noisy_dataset) 1037
epoch [152/200] batch [5/18] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 0.7568 (0.7130) acc_x 75.0000 (76.8750) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/18] time 0.187 (0.179) data 0.110 (0.102) loss_x loss_x 1.0029 (0.7116) acc_x 78.1250 (79.0625) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [15/18] time 0.198 (0.182) data 0.122 (0.105) loss_x loss_x 0.8774 (0.6378) acc_x 75.0000 (81.8750) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/32] time 0.189 (0.182) data 0.111 (0.104) loss_u loss_u 0.9287 (0.8865) acc_u 6.2500 (11.8750) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/32] time 0.164 (0.180) data 0.086 (0.102) loss_u loss_u 0.9507 (0.8934) acc_u 3.1250 (11.2500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [15/32] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.8955 (0.8858) acc_u 12.5000 (11.8750) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [20/32] time 0.186 (0.182) data 0.108 (0.104) loss_u loss_u 0.8853 (0.8929) acc_u 12.5000 (11.4062) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/32] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8813 (0.8961) acc_u 12.5000 (11.3750) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/32] time 0.182 (0.182) data 0.106 (0.105) loss_u loss_u 0.8457 (0.8945) acc_u 18.7500 (11.9792) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 681
confident_label rate tensor(0.3676, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 594
clean true:464
clean false:130
clean_rate:0.7811447811447811
noisy true:471
noisy false:551
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1022
epoch [153/200] batch [5/18] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.2524 (0.4914) acc_x 93.7500 (86.2500) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/18] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.4189 (0.5321) acc_x 87.5000 (85.6250) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [15/18] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.4490 (0.5014) acc_x 90.6250 (87.0833) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/31] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8579 (0.8937) acc_u 15.6250 (13.1250) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/31] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9351 (0.9151) acc_u 6.2500 (10.0000) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/31] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9976 (0.9246) acc_u 0.0000 (8.7500) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/31] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9019 (0.9139) acc_u 15.6250 (10.1562) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/31] time 0.175 (0.184) data 0.096 (0.106) loss_u loss_u 0.9629 (0.9121) acc_u 6.2500 (10.6250) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/31] time 0.171 (0.183) data 0.092 (0.106) loss_u loss_u 0.9053 (0.9065) acc_u 9.3750 (11.1458) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:458
clean false:143
clean_rate:0.762063227953411
noisy true:484
noisy false:531
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [154/200] batch [5/18] time 0.187 (0.186) data 0.111 (0.109) loss_x loss_x 0.6260 (0.7247) acc_x 81.2500 (83.7500) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/18] time 0.172 (0.183) data 0.094 (0.106) loss_x loss_x 0.3562 (0.6550) acc_x 93.7500 (85.9375) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [15/18] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.5649 (0.6309) acc_x 81.2500 (85.2083) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/31] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9282 (0.8730) acc_u 6.2500 (15.0000) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/31] time 0.183 (0.184) data 0.106 (0.106) loss_u loss_u 0.9170 (0.8785) acc_u 9.3750 (13.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [15/31] time 0.183 (0.184) data 0.105 (0.106) loss_u loss_u 0.9551 (0.8889) acc_u 6.2500 (12.7083) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/31] time 0.180 (0.184) data 0.102 (0.106) loss_u loss_u 0.8481 (0.8958) acc_u 18.7500 (11.7188) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/31] time 0.177 (0.183) data 0.099 (0.106) loss_u loss_u 0.8965 (0.8981) acc_u 9.3750 (11.2500) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/31] time 0.166 (0.182) data 0.089 (0.105) loss_u loss_u 0.9736 (0.9020) acc_u 3.1250 (10.9375) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 672
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:444
clean false:127
clean_rate:0.7775831873905429
noisy true:500
noisy false:545
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [155/200] batch [5/17] time 0.195 (0.187) data 0.118 (0.110) loss_x loss_x 1.0420 (0.7040) acc_x 78.1250 (80.6250) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/17] time 0.186 (0.186) data 0.108 (0.109) loss_x loss_x 0.3904 (0.6350) acc_x 93.7500 (84.6875) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [15/17] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.7744 (0.6172) acc_x 81.2500 (84.5833) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/32] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8916 (0.8945) acc_u 12.5000 (12.5000) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/32] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.8994 (0.8762) acc_u 9.3750 (14.3750) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/32] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9409 (0.8807) acc_u 6.2500 (13.9583) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/32] time 0.164 (0.184) data 0.087 (0.106) loss_u loss_u 0.9526 (0.8804) acc_u 3.1250 (13.9062) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/32] time 0.170 (0.182) data 0.092 (0.105) loss_u loss_u 0.9175 (0.8892) acc_u 9.3750 (12.6250) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/32] time 0.161 (0.181) data 0.082 (0.103) loss_u loss_u 0.8857 (0.8906) acc_u 15.6250 (12.5000) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 681
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:461
clean false:141
clean_rate:0.7657807308970099
noisy true:474
noisy false:540
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [156/200] batch [5/18] time 0.170 (0.179) data 0.094 (0.102) loss_x loss_x 0.5181 (0.4855) acc_x 90.6250 (89.3750) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [10/18] time 0.215 (0.184) data 0.138 (0.107) loss_x loss_x 0.3955 (0.4830) acc_x 93.7500 (89.6875) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [15/18] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.7783 (0.5557) acc_x 78.1250 (86.8750) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/31] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.8691 (0.9008) acc_u 15.6250 (11.2500) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/31] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8535 (0.9123) acc_u 15.6250 (9.6875) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/31] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8188 (0.9127) acc_u 18.7500 (9.7917) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/31] time 0.187 (0.184) data 0.109 (0.107) loss_u loss_u 0.8979 (0.9038) acc_u 9.3750 (10.4688) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/31] time 0.187 (0.185) data 0.109 (0.108) loss_u loss_u 0.8394 (0.9027) acc_u 15.6250 (10.5000) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/31] time 0.193 (0.185) data 0.115 (0.108) loss_u loss_u 0.8398 (0.8972) acc_u 18.7500 (11.2500) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 714
confident_label rate tensor(0.3620, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 585
clean true:444
clean false:141
clean_rate:0.7589743589743589
noisy true:458
noisy false:573
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1031
epoch [157/200] batch [5/18] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.4097 (0.5828) acc_x 90.6250 (86.8750) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/18] time 0.163 (0.167) data 0.086 (0.090) loss_x loss_x 0.5938 (0.5665) acc_x 87.5000 (86.5625) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/18] time 0.174 (0.168) data 0.097 (0.091) loss_x loss_x 0.7217 (0.6014) acc_x 78.1250 (85.4167) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/32] time 0.186 (0.170) data 0.109 (0.093) loss_u loss_u 0.9185 (0.9085) acc_u 12.5000 (10.6250) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/32] time 0.185 (0.172) data 0.107 (0.095) loss_u loss_u 0.9678 (0.9041) acc_u 3.1250 (11.2500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/32] time 0.185 (0.175) data 0.107 (0.097) loss_u loss_u 0.9590 (0.9110) acc_u 3.1250 (10.2083) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/32] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.9316 (0.9027) acc_u 6.2500 (11.0938) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/32] time 0.186 (0.176) data 0.109 (0.099) loss_u loss_u 0.9238 (0.9012) acc_u 6.2500 (10.8750) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/32] time 0.186 (0.177) data 0.108 (0.100) loss_u loss_u 0.9141 (0.8964) acc_u 9.3750 (11.6667) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:460
clean false:145
clean_rate:0.7603305785123967
noisy true:497
noisy false:514
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [158/200] batch [5/18] time 0.167 (0.178) data 0.089 (0.100) loss_x loss_x 0.5879 (0.5813) acc_x 87.5000 (86.8750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/18] time 0.171 (0.175) data 0.092 (0.097) loss_x loss_x 0.5098 (0.5519) acc_x 81.2500 (86.2500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [15/18] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 1.0303 (0.5381) acc_x 68.7500 (86.4583) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/31] time 0.183 (0.180) data 0.107 (0.103) loss_u loss_u 0.9233 (0.9252) acc_u 6.2500 (8.7500) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/31] time 0.184 (0.181) data 0.108 (0.104) loss_u loss_u 0.9194 (0.9216) acc_u 9.3750 (9.0625) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [15/31] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9565 (0.9197) acc_u 6.2500 (9.5833) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/31] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9707 (0.9151) acc_u 3.1250 (10.4688) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/31] time 0.185 (0.182) data 0.106 (0.105) loss_u loss_u 0.9341 (0.9152) acc_u 6.2500 (10.2500) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/31] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.7725 (0.9061) acc_u 21.8750 (10.9375) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 685
confident_label rate tensor(0.3577, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 578
clean true:446
clean false:132
clean_rate:0.7716262975778547
noisy true:485
noisy false:553
after delete: len(clean_dataset) 578
after delete: len(noisy_dataset) 1038
epoch [159/200] batch [5/18] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.9229 (0.6421) acc_x 75.0000 (85.0000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/18] time 0.182 (0.187) data 0.106 (0.110) loss_x loss_x 0.7251 (0.6647) acc_x 81.2500 (83.4375) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [15/18] time 0.169 (0.182) data 0.092 (0.105) loss_x loss_x 0.5015 (0.6290) acc_x 84.3750 (83.9583) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/32] time 0.165 (0.176) data 0.087 (0.099) loss_u loss_u 0.8555 (0.8596) acc_u 15.6250 (15.0000) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/32] time 0.170 (0.175) data 0.092 (0.097) loss_u loss_u 0.9194 (0.8786) acc_u 9.3750 (13.1250) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [15/32] time 0.186 (0.175) data 0.108 (0.098) loss_u loss_u 0.8828 (0.8905) acc_u 15.6250 (12.2917) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/32] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.9468 (0.8983) acc_u 3.1250 (11.5625) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/32] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9624 (0.8945) acc_u 3.1250 (11.8750) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/32] time 0.185 (0.178) data 0.109 (0.101) loss_u loss_u 0.9741 (0.8954) acc_u 0.0000 (11.9792) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 672
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 595
clean true:461
clean false:134
clean_rate:0.7747899159663866
noisy true:483
noisy false:538
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1021
epoch [160/200] batch [5/18] time 0.160 (0.172) data 0.083 (0.095) loss_x loss_x 0.5752 (0.6394) acc_x 84.3750 (81.8750) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [10/18] time 0.180 (0.170) data 0.103 (0.093) loss_x loss_x 0.3235 (0.5604) acc_x 93.7500 (83.7500) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/18] time 0.176 (0.172) data 0.099 (0.095) loss_x loss_x 0.6367 (0.5789) acc_x 78.1250 (83.5417) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/31] time 0.165 (0.170) data 0.087 (0.093) loss_u loss_u 0.8140 (0.9040) acc_u 25.0000 (10.6250) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/31] time 0.162 (0.169) data 0.084 (0.091) loss_u loss_u 0.8921 (0.8806) acc_u 9.3750 (13.4375) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [15/31] time 0.163 (0.168) data 0.086 (0.091) loss_u loss_u 0.8545 (0.8831) acc_u 15.6250 (13.5417) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/31] time 0.166 (0.168) data 0.088 (0.090) loss_u loss_u 0.9229 (0.8872) acc_u 6.2500 (12.9688) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [25/31] time 0.180 (0.169) data 0.102 (0.091) loss_u loss_u 0.9731 (0.8903) acc_u 3.1250 (12.7500) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [30/31] time 0.170 (0.169) data 0.093 (0.091) loss_u loss_u 0.9419 (0.8968) acc_u 9.3750 (11.9792) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 695
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 577
clean true:446
clean false:131
clean_rate:0.7729636048526863
noisy true:475
noisy false:564
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1039
epoch [161/200] batch [5/18] time 0.184 (0.184) data 0.108 (0.108) loss_x loss_x 0.6411 (0.4728) acc_x 84.3750 (90.0000) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/18] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 0.7529 (0.5375) acc_x 81.2500 (88.1250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/18] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.4402 (0.5474) acc_x 90.6250 (86.2500) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/32] time 0.186 (0.185) data 0.109 (0.108) loss_u loss_u 0.8125 (0.8956) acc_u 21.8750 (11.8750) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/32] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9565 (0.8738) acc_u 3.1250 (13.7500) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [15/32] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8760 (0.8837) acc_u 21.8750 (13.3333) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/32] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8843 (0.8855) acc_u 12.5000 (13.2812) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/32] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8906 (0.8857) acc_u 12.5000 (13.1250) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/32] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9229 (0.8918) acc_u 9.3750 (12.7083) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:456
clean false:130
clean_rate:0.7781569965870307
noisy true:474
noisy false:556
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [162/200] batch [5/18] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.6895 (0.7147) acc_x 84.3750 (83.7500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/18] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.5654 (0.7023) acc_x 81.2500 (82.8125) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/18] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.4822 (0.6757) acc_x 87.5000 (83.1250) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/32] time 0.186 (0.184) data 0.109 (0.108) loss_u loss_u 0.9131 (0.8910) acc_u 9.3750 (11.8750) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/32] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.8862 (0.8968) acc_u 12.5000 (10.9375) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/32] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.8350 (0.8900) acc_u 21.8750 (12.0833) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/32] time 0.185 (0.185) data 0.106 (0.108) loss_u loss_u 0.9463 (0.8933) acc_u 6.2500 (11.8750) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/32] time 0.184 (0.185) data 0.108 (0.107) loss_u loss_u 0.8755 (0.8857) acc_u 12.5000 (13.0000) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [30/32] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.7803 (0.8871) acc_u 28.1250 (13.0208) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.3793, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 613
clean true:463
clean false:150
clean_rate:0.7553017944535073
noisy true:479
noisy false:524
after delete: len(clean_dataset) 613
after delete: len(noisy_dataset) 1003
epoch [163/200] batch [5/19] time 0.187 (0.186) data 0.109 (0.109) loss_x loss_x 0.6860 (0.6600) acc_x 78.1250 (85.0000) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/19] time 0.183 (0.186) data 0.106 (0.109) loss_x loss_x 0.7808 (0.6460) acc_x 81.2500 (84.3750) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/19] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.5078 (0.6216) acc_x 87.5000 (84.1667) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/31] time 0.177 (0.187) data 0.099 (0.110) loss_u loss_u 0.9917 (0.9398) acc_u 0.0000 (6.2500) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/31] time 0.166 (0.184) data 0.088 (0.107) loss_u loss_u 0.9478 (0.9355) acc_u 6.2500 (7.5000) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [15/31] time 0.188 (0.184) data 0.110 (0.107) loss_u loss_u 0.8926 (0.9253) acc_u 15.6250 (8.7500) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/31] time 0.214 (0.185) data 0.137 (0.108) loss_u loss_u 0.8853 (0.9134) acc_u 15.6250 (10.3125) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/31] time 0.191 (0.185) data 0.112 (0.108) loss_u loss_u 0.9229 (0.9178) acc_u 6.2500 (9.7500) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/31] time 0.185 (0.186) data 0.108 (0.108) loss_u loss_u 0.8862 (0.9139) acc_u 9.3750 (10.0000) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:463
clean false:142
clean_rate:0.7652892561983471
noisy true:482
noisy false:529
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [164/200] batch [5/18] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.3884 (0.4662) acc_x 87.5000 (89.3750) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [10/18] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.5952 (0.4866) acc_x 87.5000 (88.4375) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [15/18] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.5884 (0.5426) acc_x 84.3750 (86.4583) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/31] time 0.184 (0.184) data 0.107 (0.106) loss_u loss_u 0.8794 (0.8914) acc_u 15.6250 (12.5000) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/31] time 0.185 (0.184) data 0.107 (0.106) loss_u loss_u 0.7979 (0.8942) acc_u 21.8750 (12.1875) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/31] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9497 (0.8875) acc_u 6.2500 (12.9167) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/31] time 0.168 (0.182) data 0.091 (0.105) loss_u loss_u 0.8428 (0.8909) acc_u 18.7500 (12.6562) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/31] time 0.185 (0.181) data 0.106 (0.104) loss_u loss_u 0.9277 (0.8943) acc_u 6.2500 (12.1250) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/31] time 0.182 (0.181) data 0.104 (0.103) loss_u loss_u 0.7734 (0.8940) acc_u 28.1250 (12.1875) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 701
confident_label rate tensor(0.3620, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 585
clean true:445
clean false:140
clean_rate:0.7606837606837606
noisy true:470
noisy false:561
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1031
epoch [165/200] batch [5/18] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.8638 (0.6248) acc_x 78.1250 (84.3750) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/18] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.6562 (0.6453) acc_x 90.6250 (83.1250) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/18] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7100 (0.6471) acc_x 84.3750 (82.0833) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/32] time 0.168 (0.182) data 0.092 (0.105) loss_u loss_u 0.9185 (0.9309) acc_u 9.3750 (7.5000) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/32] time 0.160 (0.178) data 0.082 (0.102) loss_u loss_u 0.8926 (0.9283) acc_u 12.5000 (7.8125) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [15/32] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.9692 (0.9221) acc_u 3.1250 (8.9583) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/32] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.8643 (0.9151) acc_u 15.6250 (9.8438) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/32] time 0.178 (0.177) data 0.100 (0.100) loss_u loss_u 0.8975 (0.9011) acc_u 12.5000 (11.3750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/32] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.9111 (0.8956) acc_u 9.3750 (12.1875) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.3756, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 607
clean true:465
clean false:142
clean_rate:0.7660626029654036
noisy true:474
noisy false:535
after delete: len(clean_dataset) 607
after delete: len(noisy_dataset) 1009
epoch [166/200] batch [5/18] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.6646 (0.6380) acc_x 84.3750 (83.7500) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [10/18] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.7671 (0.6532) acc_x 84.3750 (83.7500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [15/18] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.6309 (0.6655) acc_x 84.3750 (83.9583) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/31] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9067 (0.8554) acc_u 12.5000 (16.8750) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/31] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.8286 (0.8812) acc_u 18.7500 (13.7500) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [15/31] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9478 (0.9026) acc_u 6.2500 (11.2500) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/31] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9360 (0.9056) acc_u 6.2500 (10.4688) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/31] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.8877 (0.9039) acc_u 12.5000 (10.7500) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/31] time 0.182 (0.184) data 0.106 (0.107) loss_u loss_u 0.9536 (0.9040) acc_u 6.2500 (10.7292) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:458
clean false:143
clean_rate:0.762063227953411
noisy true:472
noisy false:543
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [167/200] batch [5/18] time 0.180 (0.180) data 0.102 (0.103) loss_x loss_x 0.4675 (0.4580) acc_x 87.5000 (88.7500) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [10/18] time 0.170 (0.177) data 0.094 (0.100) loss_x loss_x 0.3638 (0.5174) acc_x 93.7500 (87.5000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [15/18] time 0.161 (0.172) data 0.083 (0.095) loss_x loss_x 0.3525 (0.5363) acc_x 93.7500 (87.9167) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/31] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.8433 (0.8848) acc_u 18.7500 (13.1250) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/31] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9365 (0.8892) acc_u 6.2500 (12.8125) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/31] time 0.184 (0.179) data 0.106 (0.101) loss_u loss_u 0.8569 (0.8886) acc_u 15.6250 (12.9167) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/31] time 0.209 (0.180) data 0.132 (0.103) loss_u loss_u 0.8779 (0.8959) acc_u 12.5000 (11.8750) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [25/31] time 0.185 (0.180) data 0.106 (0.103) loss_u loss_u 0.8940 (0.8955) acc_u 15.6250 (12.0000) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/31] time 0.183 (0.181) data 0.106 (0.103) loss_u loss_u 0.8853 (0.8955) acc_u 12.5000 (12.0833) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 591
clean true:448
clean false:143
clean_rate:0.7580372250423012
noisy true:484
noisy false:541
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1025
epoch [168/200] batch [5/18] time 0.163 (0.179) data 0.084 (0.102) loss_x loss_x 0.7715 (0.6455) acc_x 84.3750 (83.1250) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/18] time 0.163 (0.172) data 0.085 (0.094) loss_x loss_x 0.5322 (0.6742) acc_x 84.3750 (80.9375) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/18] time 0.181 (0.175) data 0.105 (0.098) loss_x loss_x 0.8975 (0.6519) acc_x 81.2500 (82.5000) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/32] time 0.187 (0.178) data 0.109 (0.101) loss_u loss_u 0.9927 (0.9297) acc_u 0.0000 (8.1250) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/32] time 0.184 (0.179) data 0.104 (0.102) loss_u loss_u 0.9380 (0.9083) acc_u 6.2500 (10.9375) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/32] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.9014 (0.9055) acc_u 12.5000 (11.0417) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/32] time 0.188 (0.177) data 0.111 (0.100) loss_u loss_u 0.8652 (0.8997) acc_u 15.6250 (11.8750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/32] time 0.176 (0.178) data 0.099 (0.100) loss_u loss_u 0.9268 (0.8982) acc_u 9.3750 (11.7500) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/32] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.7793 (0.8957) acc_u 28.1250 (12.2917) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3626, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 586
clean true:460
clean false:126
clean_rate:0.7849829351535836
noisy true:478
noisy false:552
after delete: len(clean_dataset) 586
after delete: len(noisy_dataset) 1030
epoch [169/200] batch [5/18] time 0.164 (0.166) data 0.088 (0.089) loss_x loss_x 0.6108 (0.4863) acc_x 84.3750 (86.2500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/18] time 0.160 (0.167) data 0.083 (0.090) loss_x loss_x 0.3398 (0.5086) acc_x 90.6250 (87.1875) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/18] time 0.181 (0.170) data 0.105 (0.093) loss_x loss_x 0.6426 (0.5719) acc_x 81.2500 (85.0000) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/32] time 0.164 (0.170) data 0.086 (0.093) loss_u loss_u 0.9077 (0.8962) acc_u 9.3750 (11.2500) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [10/32] time 0.170 (0.170) data 0.092 (0.093) loss_u loss_u 0.8271 (0.8882) acc_u 18.7500 (12.5000) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/32] time 0.175 (0.172) data 0.097 (0.095) loss_u loss_u 0.9429 (0.9022) acc_u 6.2500 (11.4583) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/32] time 0.185 (0.172) data 0.107 (0.095) loss_u loss_u 0.9521 (0.9042) acc_u 3.1250 (11.2500) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/32] time 0.168 (0.172) data 0.091 (0.095) loss_u loss_u 0.9004 (0.8978) acc_u 9.3750 (11.7500) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/32] time 0.176 (0.172) data 0.099 (0.095) loss_u loss_u 0.8877 (0.8923) acc_u 12.5000 (12.3958) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.3750, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 606
clean true:470
clean false:136
clean_rate:0.7755775577557755
noisy true:482
noisy false:528
after delete: len(clean_dataset) 606
after delete: len(noisy_dataset) 1010
epoch [170/200] batch [5/18] time 0.187 (0.172) data 0.110 (0.094) loss_x loss_x 0.9985 (0.6542) acc_x 78.1250 (85.6250) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/18] time 0.176 (0.182) data 0.099 (0.104) loss_x loss_x 0.7778 (0.6382) acc_x 78.1250 (85.6250) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/18] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4233 (0.6292) acc_x 90.6250 (84.7917) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/31] time 0.159 (0.180) data 0.080 (0.103) loss_u loss_u 0.9434 (0.9196) acc_u 6.2500 (9.3750) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/31] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.9727 (0.9140) acc_u 3.1250 (10.3125) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/31] time 0.170 (0.178) data 0.092 (0.101) loss_u loss_u 0.9580 (0.9133) acc_u 3.1250 (10.6250) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/31] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9204 (0.9062) acc_u 9.3750 (11.5625) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [25/31] time 0.182 (0.180) data 0.105 (0.102) loss_u loss_u 0.8643 (0.9053) acc_u 12.5000 (11.2500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/31] time 0.187 (0.180) data 0.111 (0.103) loss_u loss_u 0.9067 (0.9071) acc_u 9.3750 (10.9375) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.3694, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 597
clean true:463
clean false:134
clean_rate:0.7755443886097152
noisy true:479
noisy false:540
after delete: len(clean_dataset) 597
after delete: len(noisy_dataset) 1019
epoch [171/200] batch [5/18] time 0.184 (0.190) data 0.108 (0.113) loss_x loss_x 0.7002 (0.5706) acc_x 78.1250 (85.0000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/18] time 0.183 (0.188) data 0.107 (0.112) loss_x loss_x 0.6055 (0.5619) acc_x 84.3750 (86.5625) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [15/18] time 0.185 (0.184) data 0.107 (0.108) loss_x loss_x 0.3459 (0.5349) acc_x 93.7500 (87.2917) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/31] time 0.165 (0.179) data 0.087 (0.102) loss_u loss_u 0.9614 (0.9459) acc_u 3.1250 (6.2500) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [10/31] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.9585 (0.9328) acc_u 6.2500 (7.8125) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [15/31] time 0.179 (0.177) data 0.102 (0.100) loss_u loss_u 0.9062 (0.9242) acc_u 9.3750 (8.3333) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/31] time 0.185 (0.176) data 0.107 (0.099) loss_u loss_u 0.8950 (0.9126) acc_u 15.6250 (9.8438) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [25/31] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.9014 (0.9101) acc_u 9.3750 (10.1250) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/31] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8843 (0.9014) acc_u 12.5000 (11.0417) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 704
confident_label rate tensor(0.3595, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 581
clean true:441
clean false:140
clean_rate:0.7590361445783133
noisy true:471
noisy false:564
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1035
epoch [172/200] batch [5/18] time 0.187 (0.192) data 0.110 (0.114) loss_x loss_x 0.6108 (0.6744) acc_x 78.1250 (80.0000) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [10/18] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 0.4868 (0.5996) acc_x 87.5000 (82.5000) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [15/18] time 0.184 (0.187) data 0.107 (0.110) loss_x loss_x 0.2905 (0.6076) acc_x 96.8750 (83.9583) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/32] time 0.168 (0.183) data 0.091 (0.105) loss_u loss_u 0.8892 (0.8790) acc_u 12.5000 (13.7500) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/32] time 0.183 (0.183) data 0.105 (0.105) loss_u loss_u 0.8970 (0.8892) acc_u 15.6250 (12.5000) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/32] time 0.187 (0.183) data 0.109 (0.106) loss_u loss_u 0.9463 (0.8952) acc_u 6.2500 (12.2917) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [20/32] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.9951 (0.8974) acc_u 0.0000 (11.7188) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/32] time 0.191 (0.184) data 0.114 (0.106) loss_u loss_u 0.8589 (0.8988) acc_u 18.7500 (11.6250) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/32] time 0.161 (0.182) data 0.084 (0.104) loss_u loss_u 0.9053 (0.8928) acc_u 9.3750 (12.6042) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 674
confident_label rate tensor(0.3744, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 605
clean true:458
clean false:147
clean_rate:0.7570247933884298
noisy true:484
noisy false:527
after delete: len(clean_dataset) 605
after delete: len(noisy_dataset) 1011
epoch [173/200] batch [5/18] time 0.165 (0.179) data 0.087 (0.102) loss_x loss_x 0.8516 (0.6241) acc_x 87.5000 (85.0000) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/18] time 0.165 (0.171) data 0.088 (0.094) loss_x loss_x 0.3792 (0.6067) acc_x 93.7500 (85.0000) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/18] time 0.187 (0.174) data 0.110 (0.097) loss_x loss_x 0.9517 (0.7022) acc_x 81.2500 (83.3333) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/31] time 0.161 (0.174) data 0.083 (0.097) loss_u loss_u 0.9854 (0.9672) acc_u 3.1250 (3.7500) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/31] time 0.179 (0.175) data 0.100 (0.097) loss_u loss_u 0.9321 (0.9392) acc_u 6.2500 (7.1875) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/31] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.8638 (0.9129) acc_u 15.6250 (10.2083) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/31] time 0.167 (0.177) data 0.090 (0.099) loss_u loss_u 0.9072 (0.9093) acc_u 9.3750 (10.4688) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [25/31] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.8564 (0.8998) acc_u 15.6250 (11.6250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/31] time 0.185 (0.176) data 0.106 (0.099) loss_u loss_u 0.9116 (0.9020) acc_u 6.2500 (11.3542) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:472
clean false:137
clean_rate:0.7750410509031199
noisy true:485
noisy false:522
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [174/200] batch [5/19] time 0.185 (0.184) data 0.108 (0.106) loss_x loss_x 0.6616 (0.5957) acc_x 90.6250 (87.5000) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/19] time 0.173 (0.182) data 0.097 (0.105) loss_x loss_x 0.4033 (0.6517) acc_x 87.5000 (85.9375) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [15/19] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.7642 (0.6568) acc_x 78.1250 (83.9583) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/31] time 0.188 (0.179) data 0.109 (0.101) loss_u loss_u 0.8682 (0.8950) acc_u 15.6250 (12.5000) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/31] time 0.184 (0.180) data 0.107 (0.102) loss_u loss_u 0.9248 (0.8996) acc_u 9.3750 (11.8750) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [15/31] time 0.172 (0.178) data 0.094 (0.101) loss_u loss_u 0.8599 (0.8903) acc_u 15.6250 (12.9167) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/31] time 0.181 (0.178) data 0.104 (0.100) loss_u loss_u 0.9502 (0.8947) acc_u 6.2500 (12.3438) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [25/31] time 0.177 (0.178) data 0.100 (0.100) loss_u loss_u 0.9268 (0.8964) acc_u 6.2500 (11.7500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/31] time 0.172 (0.177) data 0.093 (0.100) loss_u loss_u 0.8398 (0.8969) acc_u 18.7500 (11.6667) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 683
confident_label rate tensor(0.3688, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 596
clean true:459
clean false:137
clean_rate:0.7701342281879194
noisy true:474
noisy false:546
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1020
epoch [175/200] batch [5/18] time 0.168 (0.175) data 0.090 (0.097) loss_x loss_x 0.7593 (0.5712) acc_x 75.0000 (82.5000) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/18] time 0.178 (0.173) data 0.101 (0.096) loss_x loss_x 0.3884 (0.5495) acc_x 93.7500 (84.0625) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [15/18] time 0.183 (0.174) data 0.107 (0.097) loss_x loss_x 1.0137 (0.5557) acc_x 71.8750 (83.5417) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/31] time 0.177 (0.175) data 0.099 (0.098) loss_u loss_u 0.9424 (0.8982) acc_u 6.2500 (13.1250) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/31] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.8872 (0.9066) acc_u 12.5000 (12.1875) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [15/31] time 0.163 (0.174) data 0.086 (0.096) loss_u loss_u 0.9507 (0.9118) acc_u 3.1250 (10.8333) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/31] time 0.165 (0.172) data 0.088 (0.095) loss_u loss_u 0.9648 (0.9082) acc_u 3.1250 (11.2500) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [25/31] time 0.186 (0.173) data 0.109 (0.095) loss_u loss_u 0.8853 (0.9070) acc_u 12.5000 (11.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/31] time 0.188 (0.174) data 0.110 (0.097) loss_u loss_u 0.9434 (0.8979) acc_u 9.3750 (12.2917) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 687
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 591
clean true:454
clean false:137
clean_rate:0.7681895093062606
noisy true:475
noisy false:550
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1025
epoch [176/200] batch [5/18] time 0.172 (0.180) data 0.095 (0.103) loss_x loss_x 0.2467 (0.4258) acc_x 96.8750 (90.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/18] time 0.180 (0.181) data 0.104 (0.104) loss_x loss_x 0.8242 (0.5539) acc_x 81.2500 (87.1875) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [15/18] time 0.177 (0.181) data 0.101 (0.105) loss_x loss_x 0.5503 (0.5722) acc_x 84.3750 (86.4583) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/32] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.9604 (0.9179) acc_u 6.2500 (10.0000) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [10/32] time 0.183 (0.180) data 0.105 (0.103) loss_u loss_u 0.9697 (0.9223) acc_u 3.1250 (9.3750) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/32] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8325 (0.9109) acc_u 21.8750 (11.4583) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/32] time 0.188 (0.181) data 0.110 (0.104) loss_u loss_u 0.9468 (0.9064) acc_u 6.2500 (11.7188) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/32] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.9326 (0.8973) acc_u 12.5000 (12.6250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/32] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.8940 (0.8962) acc_u 12.5000 (12.6042) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 664
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 608
clean true:466
clean false:142
clean_rate:0.7664473684210527
noisy true:486
noisy false:522
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1008
epoch [177/200] batch [5/19] time 0.180 (0.176) data 0.103 (0.099) loss_x loss_x 0.5386 (0.8213) acc_x 81.2500 (76.2500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/19] time 0.180 (0.179) data 0.103 (0.102) loss_x loss_x 0.5952 (0.6635) acc_x 87.5000 (81.5625) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/19] time 0.181 (0.181) data 0.104 (0.104) loss_x loss_x 1.1162 (0.6462) acc_x 75.0000 (83.1250) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/31] time 0.186 (0.183) data 0.109 (0.105) loss_u loss_u 0.8135 (0.8855) acc_u 21.8750 (12.5000) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/31] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9033 (0.8812) acc_u 9.3750 (13.1250) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/31] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.7759 (0.8747) acc_u 21.8750 (13.5417) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/31] time 0.182 (0.186) data 0.105 (0.108) loss_u loss_u 0.8696 (0.8826) acc_u 15.6250 (12.9688) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/31] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.9434 (0.8883) acc_u 6.2500 (12.5000) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [30/31] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.9189 (0.8939) acc_u 12.5000 (12.0833) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 687
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 610
clean true:462
clean false:148
clean_rate:0.7573770491803279
noisy true:467
noisy false:539
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1006
epoch [178/200] batch [5/19] time 0.189 (0.191) data 0.111 (0.114) loss_x loss_x 0.4624 (0.6477) acc_x 90.6250 (82.5000) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/19] time 0.187 (0.189) data 0.110 (0.112) loss_x loss_x 0.6309 (0.6325) acc_x 84.3750 (82.8125) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [15/19] time 0.173 (0.185) data 0.095 (0.108) loss_x loss_x 0.5806 (0.6124) acc_x 84.3750 (83.5417) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/31] time 0.185 (0.186) data 0.107 (0.108) loss_u loss_u 0.9639 (0.8896) acc_u 3.1250 (13.7500) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/31] time 0.189 (0.186) data 0.111 (0.108) loss_u loss_u 0.8950 (0.8958) acc_u 12.5000 (12.5000) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/31] time 0.177 (0.184) data 0.097 (0.106) loss_u loss_u 0.9590 (0.9055) acc_u 6.2500 (11.2500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/31] time 0.163 (0.182) data 0.085 (0.104) loss_u loss_u 0.8970 (0.8943) acc_u 12.5000 (12.6562) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/31] time 0.170 (0.182) data 0.092 (0.104) loss_u loss_u 0.8804 (0.8960) acc_u 15.6250 (12.3750) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/31] time 0.186 (0.182) data 0.108 (0.104) loss_u loss_u 0.8770 (0.8966) acc_u 18.7500 (12.3958) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 673
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 598
clean true:463
clean false:135
clean_rate:0.774247491638796
noisy true:480
noisy false:538
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1018
epoch [179/200] batch [5/18] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.5781 (0.6209) acc_x 81.2500 (81.8750) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/18] time 0.160 (0.184) data 0.081 (0.107) loss_x loss_x 0.8979 (0.7019) acc_x 78.1250 (79.6875) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/18] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.6323 (0.6689) acc_x 84.3750 (80.8333) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/31] time 0.187 (0.183) data 0.110 (0.105) loss_u loss_u 0.8320 (0.8889) acc_u 18.7500 (13.7500) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/31] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.8130 (0.8762) acc_u 18.7500 (14.3750) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/31] time 0.185 (0.182) data 0.108 (0.104) loss_u loss_u 0.8569 (0.8820) acc_u 15.6250 (13.7500) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/31] time 0.167 (0.182) data 0.090 (0.104) loss_u loss_u 0.9419 (0.8953) acc_u 6.2500 (12.0312) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [25/31] time 0.184 (0.182) data 0.107 (0.104) loss_u loss_u 0.9409 (0.8952) acc_u 3.1250 (12.0000) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/31] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8433 (0.8907) acc_u 18.7500 (12.5000) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 658
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:473
clean false:144
clean_rate:0.766612641815235
noisy true:485
noisy false:514
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [180/200] batch [5/19] time 0.186 (0.191) data 0.109 (0.114) loss_x loss_x 1.1582 (0.7373) acc_x 75.0000 (85.0000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/19] time 0.185 (0.189) data 0.109 (0.112) loss_x loss_x 0.2301 (0.6558) acc_x 96.8750 (85.3125) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [15/19] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.2087 (0.5897) acc_x 96.8750 (86.2500) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/31] time 0.184 (0.187) data 0.107 (0.110) loss_u loss_u 0.8340 (0.8528) acc_u 15.6250 (15.6250) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/31] time 0.168 (0.184) data 0.090 (0.107) loss_u loss_u 0.9478 (0.8886) acc_u 6.2500 (12.5000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/31] time 0.172 (0.182) data 0.095 (0.105) loss_u loss_u 0.8965 (0.9015) acc_u 12.5000 (11.0417) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/31] time 0.173 (0.182) data 0.096 (0.104) loss_u loss_u 0.9922 (0.9064) acc_u 0.0000 (10.3125) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [25/31] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.9043 (0.9043) acc_u 9.3750 (10.7500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [30/31] time 0.177 (0.181) data 0.100 (0.103) loss_u loss_u 0.9521 (0.9064) acc_u 6.2500 (10.6250) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 690
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 612
clean true:457
clean false:155
clean_rate:0.7467320261437909
noisy true:469
noisy false:535
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1004
epoch [181/200] batch [5/19] time 0.185 (0.173) data 0.108 (0.095) loss_x loss_x 0.3442 (0.4992) acc_x 93.7500 (90.6250) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/19] time 0.171 (0.175) data 0.094 (0.098) loss_x loss_x 0.7788 (0.5635) acc_x 81.2500 (86.5625) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/19] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 1.2148 (0.5999) acc_x 62.5000 (84.7917) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/31] time 0.187 (0.174) data 0.110 (0.096) loss_u loss_u 0.9092 (0.9265) acc_u 9.3750 (7.5000) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/31] time 0.187 (0.176) data 0.109 (0.099) loss_u loss_u 0.9331 (0.9081) acc_u 6.2500 (9.6875) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/31] time 0.185 (0.177) data 0.107 (0.100) loss_u loss_u 0.9438 (0.9081) acc_u 6.2500 (9.7917) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/31] time 0.186 (0.179) data 0.108 (0.101) loss_u loss_u 0.8882 (0.9125) acc_u 15.6250 (9.6875) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/31] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.9199 (0.9105) acc_u 9.3750 (10.1250) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [30/31] time 0.200 (0.180) data 0.123 (0.103) loss_u loss_u 0.8516 (0.9104) acc_u 18.7500 (10.3125) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.3700, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 598
clean true:457
clean false:141
clean_rate:0.7642140468227425
noisy true:477
noisy false:541
after delete: len(clean_dataset) 598
after delete: len(noisy_dataset) 1018
epoch [182/200] batch [5/18] time 0.159 (0.164) data 0.081 (0.086) loss_x loss_x 0.5894 (0.6821) acc_x 84.3750 (82.5000) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/18] time 0.162 (0.164) data 0.085 (0.086) loss_x loss_x 0.9546 (0.6541) acc_x 78.1250 (82.5000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/18] time 0.185 (0.167) data 0.108 (0.090) loss_x loss_x 0.7461 (0.6102) acc_x 75.0000 (83.3333) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/31] time 0.186 (0.175) data 0.108 (0.097) loss_u loss_u 0.8677 (0.8816) acc_u 12.5000 (13.1250) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/31] time 0.192 (0.177) data 0.115 (0.100) loss_u loss_u 0.9111 (0.8960) acc_u 9.3750 (11.2500) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/31] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8428 (0.8892) acc_u 21.8750 (12.5000) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/31] time 0.186 (0.179) data 0.106 (0.102) loss_u loss_u 0.8203 (0.8841) acc_u 21.8750 (13.1250) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/31] time 0.181 (0.180) data 0.103 (0.102) loss_u loss_u 0.8779 (0.8818) acc_u 15.6250 (13.5000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [30/31] time 0.173 (0.180) data 0.096 (0.102) loss_u loss_u 0.9136 (0.8828) acc_u 9.3750 (13.2292) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 670
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:456
clean false:147
clean_rate:0.7562189054726368
noisy true:490
noisy false:523
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [183/200] batch [5/18] time 0.174 (0.170) data 0.095 (0.091) loss_x loss_x 0.5913 (0.5606) acc_x 84.3750 (85.6250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/18] time 0.181 (0.172) data 0.103 (0.095) loss_x loss_x 0.6021 (0.5066) acc_x 87.5000 (86.2500) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [15/18] time 0.165 (0.170) data 0.089 (0.092) loss_x loss_x 0.4302 (0.4717) acc_x 90.6250 (86.6667) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/31] time 0.180 (0.171) data 0.101 (0.093) loss_u loss_u 0.9546 (0.9258) acc_u 3.1250 (8.1250) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/31] time 0.174 (0.173) data 0.095 (0.095) loss_u loss_u 0.9175 (0.9133) acc_u 9.3750 (10.0000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/31] time 0.172 (0.174) data 0.094 (0.096) loss_u loss_u 0.9385 (0.9067) acc_u 6.2500 (11.0417) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/31] time 0.178 (0.174) data 0.100 (0.096) loss_u loss_u 0.9399 (0.9033) acc_u 6.2500 (11.0938) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/31] time 0.182 (0.175) data 0.103 (0.098) loss_u loss_u 0.9355 (0.9046) acc_u 6.2500 (10.8750) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [30/31] time 0.176 (0.175) data 0.098 (0.098) loss_u loss_u 0.8823 (0.9032) acc_u 12.5000 (10.9375) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3595, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 581
clean true:448
clean false:133
clean_rate:0.7710843373493976
noisy true:490
noisy false:545
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1035
epoch [184/200] batch [5/18] time 0.187 (0.185) data 0.111 (0.108) loss_x loss_x 0.6021 (0.6808) acc_x 87.5000 (87.5000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/18] time 0.182 (0.185) data 0.106 (0.108) loss_x loss_x 0.4998 (0.5645) acc_x 93.7500 (89.0625) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/18] time 0.184 (0.185) data 0.106 (0.108) loss_x loss_x 0.5234 (0.5252) acc_x 84.3750 (88.7500) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/32] time 0.185 (0.185) data 0.108 (0.107) loss_u loss_u 0.8530 (0.8946) acc_u 15.6250 (11.8750) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/32] time 0.188 (0.185) data 0.110 (0.107) loss_u loss_u 0.9287 (0.8888) acc_u 6.2500 (11.8750) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [15/32] time 0.174 (0.183) data 0.097 (0.106) loss_u loss_u 0.9062 (0.8941) acc_u 12.5000 (11.4583) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [20/32] time 0.189 (0.184) data 0.112 (0.106) loss_u loss_u 0.8169 (0.8928) acc_u 18.7500 (11.5625) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [25/32] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.8848 (0.8933) acc_u 12.5000 (11.8750) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [30/32] time 0.167 (0.183) data 0.090 (0.106) loss_u loss_u 0.8716 (0.8912) acc_u 12.5000 (12.1875) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:468
clean false:149
clean_rate:0.7585089141004863
noisy true:477
noisy false:522
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [185/200] batch [5/19] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.6802 (0.7234) acc_x 84.3750 (82.5000) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [10/19] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.5044 (0.6070) acc_x 90.6250 (85.6250) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/19] time 0.185 (0.183) data 0.107 (0.106) loss_x loss_x 0.6362 (0.6408) acc_x 81.2500 (84.3750) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/31] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8457 (0.9233) acc_u 18.7500 (9.3750) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/31] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8696 (0.9180) acc_u 12.5000 (9.0625) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/31] time 0.184 (0.184) data 0.105 (0.107) loss_u loss_u 0.9419 (0.9206) acc_u 9.3750 (8.7500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/31] time 0.185 (0.184) data 0.106 (0.107) loss_u loss_u 0.9365 (0.9133) acc_u 9.3750 (9.6875) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [25/31] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9141 (0.9087) acc_u 6.2500 (10.3750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [30/31] time 0.182 (0.184) data 0.104 (0.107) loss_u loss_u 0.8838 (0.9045) acc_u 9.3750 (10.7292) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:455
clean false:135
clean_rate:0.7711864406779662
noisy true:485
noisy false:541
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [186/200] batch [5/18] time 0.187 (0.184) data 0.110 (0.108) loss_x loss_x 0.3557 (0.6192) acc_x 90.6250 (84.3750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/18] time 0.176 (0.178) data 0.099 (0.102) loss_x loss_x 0.5630 (0.5936) acc_x 81.2500 (84.6875) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/18] time 0.165 (0.178) data 0.087 (0.101) loss_x loss_x 0.9585 (0.5860) acc_x 78.1250 (84.3750) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/32] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.9434 (0.9097) acc_u 6.2500 (10.6250) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/32] time 0.182 (0.177) data 0.103 (0.100) loss_u loss_u 0.8765 (0.9022) acc_u 15.6250 (11.5625) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/32] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.8940 (0.8995) acc_u 15.6250 (11.8750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/32] time 0.165 (0.176) data 0.088 (0.099) loss_u loss_u 0.8931 (0.9013) acc_u 12.5000 (11.8750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [25/32] time 0.188 (0.177) data 0.110 (0.100) loss_u loss_u 0.9170 (0.8998) acc_u 9.3750 (12.1250) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [30/32] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8755 (0.9002) acc_u 12.5000 (11.8750) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 695
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 608
clean true:463
clean false:145
clean_rate:0.7615131578947368
noisy true:458
noisy false:550
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1008
epoch [187/200] batch [5/19] time 0.180 (0.177) data 0.101 (0.100) loss_x loss_x 0.4678 (0.4297) acc_x 87.5000 (90.6250) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/19] time 0.180 (0.175) data 0.104 (0.098) loss_x loss_x 0.5234 (0.5421) acc_x 87.5000 (87.1875) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/19] time 0.177 (0.175) data 0.101 (0.098) loss_x loss_x 0.5259 (0.5302) acc_x 87.5000 (87.0833) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/31] time 0.170 (0.174) data 0.093 (0.097) loss_u loss_u 0.8911 (0.8931) acc_u 12.5000 (11.8750) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/31] time 0.189 (0.176) data 0.111 (0.099) loss_u loss_u 0.8960 (0.8928) acc_u 12.5000 (13.1250) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/31] time 0.168 (0.175) data 0.091 (0.098) loss_u loss_u 0.9287 (0.9005) acc_u 9.3750 (11.6667) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/31] time 0.162 (0.175) data 0.086 (0.098) loss_u loss_u 0.9590 (0.9057) acc_u 6.2500 (10.9375) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [25/31] time 0.161 (0.173) data 0.083 (0.096) loss_u loss_u 0.9087 (0.9023) acc_u 9.3750 (11.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [30/31] time 0.187 (0.174) data 0.110 (0.097) loss_u loss_u 0.8735 (0.9006) acc_u 12.5000 (11.1458) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 695
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:450
clean false:140
clean_rate:0.7627118644067796
noisy true:471
noisy false:555
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [188/200] batch [5/18] time 0.188 (0.184) data 0.110 (0.107) loss_x loss_x 0.4578 (0.6433) acc_x 87.5000 (87.5000) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/18] time 0.187 (0.185) data 0.110 (0.107) loss_x loss_x 0.6982 (0.5707) acc_x 81.2500 (87.1875) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/18] time 0.184 (0.185) data 0.107 (0.107) loss_x loss_x 0.5522 (0.5844) acc_x 81.2500 (85.2083) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/32] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.9141 (0.8846) acc_u 9.3750 (13.1250) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/32] time 0.170 (0.184) data 0.092 (0.106) loss_u loss_u 0.8735 (0.8871) acc_u 15.6250 (12.8125) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [15/32] time 0.180 (0.183) data 0.102 (0.106) loss_u loss_u 0.8550 (0.8839) acc_u 15.6250 (13.3333) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [20/32] time 0.185 (0.185) data 0.108 (0.107) loss_u loss_u 0.9346 (0.8838) acc_u 6.2500 (13.1250) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [25/32] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9722 (0.8844) acc_u 3.1250 (13.2500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [30/32] time 0.175 (0.183) data 0.096 (0.105) loss_u loss_u 0.9199 (0.8914) acc_u 9.3750 (12.3958) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 667
confident_label rate tensor(0.3738, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 604
clean true:459
clean false:145
clean_rate:0.7599337748344371
noisy true:490
noisy false:522
after delete: len(clean_dataset) 604
after delete: len(noisy_dataset) 1012
epoch [189/200] batch [5/18] time 0.184 (0.186) data 0.107 (0.110) loss_x loss_x 0.6787 (0.6190) acc_x 84.3750 (83.7500) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/18] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 1.0664 (0.6025) acc_x 75.0000 (84.0625) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/18] time 0.170 (0.179) data 0.093 (0.102) loss_x loss_x 1.3262 (0.6220) acc_x 78.1250 (84.5833) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/31] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.8999 (0.8883) acc_u 9.3750 (11.8750) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/31] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.9292 (0.8978) acc_u 6.2500 (11.2500) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/31] time 0.173 (0.179) data 0.094 (0.102) loss_u loss_u 0.9365 (0.9006) acc_u 6.2500 (10.8333) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/31] time 0.159 (0.179) data 0.081 (0.101) loss_u loss_u 0.9150 (0.8902) acc_u 9.3750 (12.0312) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [25/31] time 0.173 (0.178) data 0.096 (0.100) loss_u loss_u 0.8794 (0.8885) acc_u 18.7500 (12.3750) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [30/31] time 0.180 (0.176) data 0.102 (0.099) loss_u loss_u 0.9038 (0.8929) acc_u 12.5000 (11.8750) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 662
confident_label rate tensor(0.3713, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 600
clean true:469
clean false:131
clean_rate:0.7816666666666666
noisy true:485
noisy false:531
after delete: len(clean_dataset) 600
after delete: len(noisy_dataset) 1016
epoch [190/200] batch [5/18] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.5923 (0.6253) acc_x 84.3750 (82.5000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/18] time 0.174 (0.180) data 0.097 (0.103) loss_x loss_x 0.5474 (0.6073) acc_x 81.2500 (83.4375) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/18] time 0.165 (0.175) data 0.087 (0.097) loss_x loss_x 0.6851 (0.5747) acc_x 87.5000 (85.0000) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/31] time 0.202 (0.177) data 0.124 (0.100) loss_u loss_u 0.8892 (0.8881) acc_u 12.5000 (13.1250) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/31] time 0.176 (0.179) data 0.099 (0.102) loss_u loss_u 0.8882 (0.8871) acc_u 15.6250 (13.7500) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/31] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.9399 (0.8869) acc_u 9.3750 (13.7500) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/31] time 0.158 (0.179) data 0.080 (0.101) loss_u loss_u 0.8926 (0.8902) acc_u 9.3750 (13.2812) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/31] time 0.174 (0.178) data 0.098 (0.100) loss_u loss_u 0.9180 (0.8865) acc_u 9.3750 (13.7500) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [30/31] time 0.185 (0.178) data 0.108 (0.100) loss_u loss_u 0.8833 (0.8908) acc_u 18.7500 (13.2292) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 665
confident_label rate tensor(0.3676, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 594
clean true:459
clean false:135
clean_rate:0.7727272727272727
noisy true:492
noisy false:530
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1022
epoch [191/200] batch [5/18] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.3096 (0.6349) acc_x 93.7500 (88.1250) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/18] time 0.165 (0.178) data 0.089 (0.101) loss_x loss_x 0.5449 (0.5765) acc_x 87.5000 (88.7500) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/18] time 0.182 (0.178) data 0.106 (0.101) loss_x loss_x 0.9326 (0.6212) acc_x 78.1250 (86.0417) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/31] time 0.190 (0.181) data 0.113 (0.103) loss_u loss_u 0.8613 (0.8566) acc_u 18.7500 (17.5000) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/31] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.9043 (0.8756) acc_u 9.3750 (15.0000) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/31] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8335 (0.8853) acc_u 18.7500 (13.3333) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/31] time 0.182 (0.182) data 0.104 (0.104) loss_u loss_u 0.9058 (0.8938) acc_u 9.3750 (12.3438) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/31] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.9629 (0.8981) acc_u 6.2500 (11.8750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [30/31] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.9473 (0.8998) acc_u 6.2500 (11.5625) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 689
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:463
clean false:140
clean_rate:0.7678275290215588
noisy true:464
noisy false:549
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [192/200] batch [5/18] time 0.168 (0.169) data 0.091 (0.091) loss_x loss_x 0.4741 (0.5715) acc_x 78.1250 (82.5000) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/18] time 0.165 (0.168) data 0.088 (0.091) loss_x loss_x 0.7671 (0.6026) acc_x 75.0000 (84.0625) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/18] time 0.158 (0.169) data 0.082 (0.092) loss_x loss_x 0.6104 (0.5542) acc_x 78.1250 (85.0000) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/31] time 0.185 (0.173) data 0.107 (0.096) loss_u loss_u 0.8901 (0.8706) acc_u 15.6250 (16.2500) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/31] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.9346 (0.8825) acc_u 9.3750 (14.0625) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/31] time 0.186 (0.177) data 0.108 (0.099) loss_u loss_u 0.8662 (0.8919) acc_u 15.6250 (12.9167) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/31] time 0.183 (0.179) data 0.105 (0.101) loss_u loss_u 0.9814 (0.8967) acc_u 3.1250 (12.5000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [25/31] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9224 (0.8970) acc_u 12.5000 (12.5000) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [30/31] time 0.181 (0.180) data 0.104 (0.102) loss_u loss_u 0.9404 (0.8963) acc_u 6.2500 (12.5000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.3731, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 603
clean true:459
clean false:144
clean_rate:0.7611940298507462
noisy true:489
noisy false:524
after delete: len(clean_dataset) 603
after delete: len(noisy_dataset) 1013
epoch [193/200] batch [5/18] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6030 (0.7092) acc_x 87.5000 (83.1250) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/18] time 0.171 (0.182) data 0.094 (0.105) loss_x loss_x 0.5981 (0.6541) acc_x 87.5000 (84.3750) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/18] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.4824 (0.5722) acc_x 87.5000 (86.2500) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/31] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.8960 (0.8820) acc_u 9.3750 (13.1250) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/31] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.9243 (0.8865) acc_u 9.3750 (12.1875) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/31] time 0.187 (0.184) data 0.109 (0.107) loss_u loss_u 0.8804 (0.8887) acc_u 12.5000 (12.0833) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/31] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9106 (0.8832) acc_u 9.3750 (12.5000) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [25/31] time 0.187 (0.184) data 0.108 (0.107) loss_u loss_u 0.8857 (0.8827) acc_u 12.5000 (12.6250) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [30/31] time 0.189 (0.184) data 0.110 (0.107) loss_u loss_u 0.9346 (0.8863) acc_u 6.2500 (12.2917) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3663, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 592
clean true:452
clean false:140
clean_rate:0.7635135135135135
noisy true:486
noisy false:538
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1024
epoch [194/200] batch [5/18] time 0.162 (0.174) data 0.084 (0.098) loss_x loss_x 0.2318 (0.5348) acc_x 93.7500 (86.8750) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/18] time 0.159 (0.169) data 0.082 (0.092) loss_x loss_x 0.5762 (0.5915) acc_x 84.3750 (84.3750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/18] time 0.162 (0.167) data 0.085 (0.090) loss_x loss_x 0.5278 (0.5889) acc_x 90.6250 (84.7917) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/32] time 0.193 (0.169) data 0.115 (0.092) loss_u loss_u 0.8906 (0.8930) acc_u 9.3750 (12.5000) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/32] time 0.182 (0.172) data 0.105 (0.095) loss_u loss_u 0.8979 (0.9010) acc_u 12.5000 (11.5625) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/32] time 0.194 (0.175) data 0.116 (0.098) loss_u loss_u 0.8867 (0.9050) acc_u 12.5000 (11.0417) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/32] time 0.187 (0.177) data 0.109 (0.099) loss_u loss_u 0.9102 (0.9124) acc_u 9.3750 (10.1562) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [25/32] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.7769 (0.9040) acc_u 25.0000 (11.0000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [30/32] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8794 (0.9028) acc_u 12.5000 (11.2500) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 684
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 614
clean true:469
clean false:145
clean_rate:0.7638436482084691
noisy true:463
noisy false:539
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1002
epoch [195/200] batch [5/19] time 0.183 (0.176) data 0.105 (0.099) loss_x loss_x 0.6138 (0.5744) acc_x 87.5000 (86.8750) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/19] time 0.186 (0.181) data 0.109 (0.104) loss_x loss_x 0.6768 (0.5977) acc_x 81.2500 (86.2500) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/19] time 0.185 (0.182) data 0.109 (0.105) loss_x loss_x 0.8442 (0.5937) acc_x 84.3750 (86.4583) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/31] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8901 (0.9109) acc_u 12.5000 (10.6250) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/31] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.9028 (0.9080) acc_u 15.6250 (10.9375) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/31] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.8823 (0.9047) acc_u 9.3750 (10.6250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/31] time 0.187 (0.185) data 0.109 (0.108) loss_u loss_u 0.7832 (0.8956) acc_u 25.0000 (11.8750) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [25/31] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9248 (0.9026) acc_u 6.2500 (11.1250) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [30/31] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9214 (0.9032) acc_u 9.3750 (11.2500) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.3657, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 591
clean true:446
clean false:145
clean_rate:0.754653130287648
noisy true:493
noisy false:532
after delete: len(clean_dataset) 591
after delete: len(noisy_dataset) 1025
epoch [196/200] batch [5/18] time 0.182 (0.188) data 0.105 (0.111) loss_x loss_x 0.6357 (0.4617) acc_x 78.1250 (88.1250) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/18] time 0.181 (0.185) data 0.105 (0.108) loss_x loss_x 0.6152 (0.5211) acc_x 87.5000 (86.8750) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/18] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.8296 (0.5776) acc_x 90.6250 (86.0417) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/32] time 0.189 (0.184) data 0.110 (0.108) loss_u loss_u 0.9912 (0.9050) acc_u 3.1250 (11.2500) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/32] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9277 (0.8984) acc_u 12.5000 (12.1875) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [15/32] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.9233 (0.8993) acc_u 9.3750 (11.8750) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [20/32] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9395 (0.8929) acc_u 6.2500 (12.6562) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [25/32] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8936 (0.8843) acc_u 12.5000 (13.6250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [30/32] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.9102 (0.8886) acc_u 9.3750 (13.1250) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 686
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 595
clean true:454
clean false:141
clean_rate:0.7630252100840336
noisy true:476
noisy false:545
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1021
epoch [197/200] batch [5/18] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.3667 (0.4894) acc_x 87.5000 (86.8750) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/18] time 0.164 (0.182) data 0.087 (0.105) loss_x loss_x 0.6357 (0.5478) acc_x 84.3750 (86.2500) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/18] time 0.186 (0.179) data 0.109 (0.102) loss_x loss_x 0.3701 (0.5351) acc_x 87.5000 (86.2500) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/31] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.8892 (0.9012) acc_u 9.3750 (10.6250) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/31] time 0.185 (0.183) data 0.109 (0.106) loss_u loss_u 0.9741 (0.9298) acc_u 0.0000 (7.8125) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/31] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8472 (0.9198) acc_u 18.7500 (8.9583) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/31] time 0.176 (0.183) data 0.098 (0.106) loss_u loss_u 0.8535 (0.9052) acc_u 18.7500 (10.6250) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [25/31] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.8730 (0.9098) acc_u 12.5000 (10.2500) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [30/31] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8882 (0.9100) acc_u 12.5000 (10.1042) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 666
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 610
clean true:463
clean false:147
clean_rate:0.759016393442623
noisy true:487
noisy false:519
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1006
epoch [198/200] batch [5/19] time 0.183 (0.186) data 0.106 (0.110) loss_x loss_x 0.6167 (0.5060) acc_x 84.3750 (86.8750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/19] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.9268 (0.5879) acc_x 81.2500 (84.6875) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/19] time 0.167 (0.185) data 0.090 (0.108) loss_x loss_x 1.1016 (0.5726) acc_x 65.6250 (84.3750) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/31] time 0.186 (0.183) data 0.108 (0.107) loss_u loss_u 0.9424 (0.9204) acc_u 6.2500 (10.0000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/31] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8135 (0.9014) acc_u 21.8750 (11.8750) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/31] time 0.186 (0.184) data 0.109 (0.107) loss_u loss_u 0.9033 (0.9062) acc_u 9.3750 (11.2500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/31] time 0.221 (0.185) data 0.142 (0.108) loss_u loss_u 0.9077 (0.9024) acc_u 9.3750 (11.2500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [25/31] time 0.218 (0.188) data 0.140 (0.111) loss_u loss_u 0.9941 (0.9054) acc_u 0.0000 (10.8750) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [30/31] time 0.163 (0.187) data 0.086 (0.110) loss_u loss_u 0.8506 (0.9036) acc_u 15.6250 (11.0417) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 691
confident_label rate tensor(0.3719, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 601
clean true:454
clean false:147
clean_rate:0.7554076539101497
noisy true:471
noisy false:544
after delete: len(clean_dataset) 601
after delete: len(noisy_dataset) 1015
epoch [199/200] batch [5/18] time 0.178 (0.181) data 0.101 (0.103) loss_x loss_x 0.4104 (0.5514) acc_x 90.6250 (85.0000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/18] time 0.169 (0.179) data 0.092 (0.102) loss_x loss_x 0.5649 (0.6051) acc_x 87.5000 (84.6875) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/18] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.2881 (0.5751) acc_x 93.7500 (85.4167) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/31] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.9150 (0.9210) acc_u 9.3750 (9.3750) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/31] time 0.158 (0.173) data 0.082 (0.096) loss_u loss_u 0.8530 (0.8870) acc_u 18.7500 (13.1250) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/31] time 0.161 (0.171) data 0.084 (0.094) loss_u loss_u 0.8232 (0.8942) acc_u 18.7500 (12.2917) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/31] time 0.159 (0.169) data 0.082 (0.092) loss_u loss_u 0.8755 (0.8881) acc_u 12.5000 (12.8125) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/31] time 0.159 (0.168) data 0.082 (0.091) loss_u loss_u 0.9023 (0.8909) acc_u 12.5000 (12.3750) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [30/31] time 0.157 (0.167) data 0.080 (0.090) loss_u loss_u 0.8970 (0.8939) acc_u 12.5000 (12.0833) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 668
confident_label rate tensor(0.3645, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 589
clean true:449
clean false:140
clean_rate:0.7623089983022071
noisy true:499
noisy false:528
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 1027
epoch [200/200] batch [5/18] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5757 (0.6433) acc_x 81.2500 (85.0000) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/18] time 0.185 (0.184) data 0.108 (0.108) loss_x loss_x 0.5767 (0.5747) acc_x 84.3750 (86.2500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/18] time 0.157 (0.181) data 0.081 (0.105) loss_x loss_x 0.3540 (0.5669) acc_x 93.7500 (85.8333) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/32] time 0.159 (0.175) data 0.082 (0.099) loss_u loss_u 0.9697 (0.9030) acc_u 3.1250 (11.2500) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/32] time 0.158 (0.172) data 0.081 (0.096) loss_u loss_u 0.8867 (0.8902) acc_u 15.6250 (13.1250) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/32] time 0.159 (0.171) data 0.082 (0.094) loss_u loss_u 0.9277 (0.8813) acc_u 6.2500 (13.7500) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/32] time 0.161 (0.169) data 0.082 (0.092) loss_u loss_u 0.8872 (0.8877) acc_u 12.5000 (12.8125) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [25/32] time 0.163 (0.168) data 0.086 (0.091) loss_u loss_u 0.8911 (0.8952) acc_u 12.5000 (11.8750) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [30/32] time 0.158 (0.167) data 0.081 (0.090) loss_u loss_u 0.9116 (0.8908) acc_u 12.5000 (12.5000) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.625/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,210
* accuracy: 58.4%
* error: 41.6%
* macro_f1: 56.8%
Elapsed: 0:58:59
