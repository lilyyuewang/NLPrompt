***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.5', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.5
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1104
confident_label rate tensor(0.1665, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 269
clean true:249
clean false:20
clean_rate:0.9256505576208178
noisy true:263
noisy false:1084
after delete: len(clean_dataset) 269
after delete: len(noisy_dataset) 1347
epoch [1/200] batch [5/8] time 0.192 (0.215) data 0.115 (0.121) loss_x loss_x 2.4238 (2.6551) acc_x 50.0000 (45.6250) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/42] time 0.188 (0.199) data 0.112 (0.114) loss_u loss_u 0.9727 (0.9686) acc_u 6.2500 (6.8750) lr 1.0000e-05 eta 0:00:07
epoch [1/200] batch [10/42] time 0.186 (0.197) data 0.109 (0.114) loss_u loss_u 0.9619 (0.9675) acc_u 6.2500 (8.1250) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [15/42] time 0.165 (0.193) data 0.088 (0.112) loss_u loss_u 0.9463 (0.9626) acc_u 12.5000 (9.5833) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [20/42] time 0.191 (0.191) data 0.114 (0.110) loss_u loss_u 0.9365 (0.9598) acc_u 12.5000 (10.0000) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [25/42] time 0.195 (0.192) data 0.118 (0.112) loss_u loss_u 0.9404 (0.9590) acc_u 9.3750 (10.0000) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [30/42] time 0.197 (0.192) data 0.120 (0.113) loss_u loss_u 0.9365 (0.9585) acc_u 12.5000 (10.1042) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [35/42] time 0.190 (0.192) data 0.113 (0.113) loss_u loss_u 0.9541 (0.9601) acc_u 12.5000 (9.6429) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [40/42] time 0.177 (0.191) data 0.098 (0.112) loss_u loss_u 0.9268 (0.9596) acc_u 25.0000 (9.7656) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1007
confident_label rate tensor(0.1980, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 320
clean true:302
clean false:18
clean_rate:0.94375
noisy true:307
noisy false:989
after delete: len(clean_dataset) 320
after delete: len(noisy_dataset) 1296
epoch [2/200] batch [5/10] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 1.2158 (1.3004) acc_x 68.7500 (69.3750) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [10/10] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.9321 (1.2992) acc_x 78.1250 (68.4375) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/40] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9395 (0.9423) acc_u 6.2500 (8.7500) lr 2.0000e-03 eta 0:00:06
epoch [2/200] batch [10/40] time 0.189 (0.185) data 0.112 (0.108) loss_u loss_u 0.8091 (0.9194) acc_u 25.0000 (10.9375) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [15/40] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9009 (0.9070) acc_u 15.6250 (12.9167) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [20/40] time 0.165 (0.182) data 0.088 (0.105) loss_u loss_u 0.9805 (0.8960) acc_u 0.0000 (14.5312) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [25/40] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.8052 (0.8891) acc_u 25.0000 (15.1250) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [30/40] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8799 (0.8921) acc_u 15.6250 (14.6875) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [35/40] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9272 (0.8856) acc_u 12.5000 (15.2679) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [40/40] time 0.187 (0.182) data 0.110 (0.104) loss_u loss_u 0.9307 (0.8862) acc_u 9.3750 (15.0000) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 813
confident_label rate tensor(0.2686, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 434
clean true:411
clean false:23
clean_rate:0.9470046082949308
noisy true:392
noisy false:790
after delete: len(clean_dataset) 434
after delete: len(noisy_dataset) 1182
epoch [3/200] batch [5/13] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 1.3779 (1.2541) acc_x 68.7500 (70.0000) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [10/13] time 0.165 (0.180) data 0.088 (0.104) loss_x loss_x 1.3955 (1.1329) acc_x 65.6250 (72.1875) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/36] time 0.182 (0.179) data 0.105 (0.103) loss_u loss_u 0.8662 (0.9256) acc_u 18.7500 (9.3750) lr 1.9999e-03 eta 0:00:05
epoch [3/200] batch [10/36] time 0.189 (0.180) data 0.112 (0.104) loss_u loss_u 0.9058 (0.9206) acc_u 9.3750 (9.6875) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [15/36] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9004 (0.9135) acc_u 9.3750 (10.4167) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [20/36] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9565 (0.9179) acc_u 9.3750 (10.1562) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [25/36] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.9658 (0.9181) acc_u 3.1250 (9.8750) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [30/36] time 0.170 (0.181) data 0.092 (0.104) loss_u loss_u 0.9722 (0.9162) acc_u 3.1250 (10.1042) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [35/36] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9282 (0.9127) acc_u 9.3750 (10.2679) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 782
confident_label rate tensor(0.2605, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 421
clean true:407
clean false:14
clean_rate:0.9667458432304038
noisy true:427
noisy false:768
after delete: len(clean_dataset) 421
after delete: len(noisy_dataset) 1195
epoch [4/200] batch [5/13] time 0.191 (0.186) data 0.114 (0.109) loss_x loss_x 1.2373 (1.2607) acc_x 56.2500 (65.0000) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [10/13] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 1.1758 (1.2004) acc_x 78.1250 (68.7500) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/37] time 0.183 (0.185) data 0.105 (0.108) loss_u loss_u 0.9028 (0.8948) acc_u 12.5000 (11.8750) lr 1.9995e-03 eta 0:00:05
epoch [4/200] batch [10/37] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.8896 (0.8892) acc_u 12.5000 (13.7500) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [15/37] time 0.183 (0.185) data 0.107 (0.108) loss_u loss_u 0.8696 (0.8958) acc_u 18.7500 (12.7083) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [20/37] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.9312 (0.8977) acc_u 12.5000 (12.0312) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [25/37] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9180 (0.9022) acc_u 15.6250 (11.8750) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [30/37] time 0.161 (0.183) data 0.084 (0.106) loss_u loss_u 0.9302 (0.9035) acc_u 6.2500 (11.3542) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [35/37] time 0.170 (0.182) data 0.093 (0.105) loss_u loss_u 0.9258 (0.8981) acc_u 9.3750 (11.7857) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 789
confident_label rate tensor(0.2599, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 420
clean true:407
clean false:13
clean_rate:0.969047619047619
noisy true:420
noisy false:776
after delete: len(clean_dataset) 420
after delete: len(noisy_dataset) 1196
epoch [5/200] batch [5/13] time 0.177 (0.181) data 0.101 (0.104) loss_x loss_x 1.1396 (0.9639) acc_x 68.7500 (70.6250) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [10/13] time 0.175 (0.178) data 0.099 (0.101) loss_x loss_x 0.7720 (0.9466) acc_x 78.1250 (72.5000) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/37] time 0.178 (0.180) data 0.100 (0.103) loss_u loss_u 0.8706 (0.8679) acc_u 18.7500 (18.1250) lr 1.9989e-03 eta 0:00:05
epoch [5/200] batch [10/37] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9341 (0.8834) acc_u 6.2500 (15.0000) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [15/37] time 0.186 (0.182) data 0.108 (0.104) loss_u loss_u 0.8560 (0.8783) acc_u 21.8750 (15.4167) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [20/37] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9116 (0.8861) acc_u 12.5000 (14.6875) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [25/37] time 0.159 (0.180) data 0.081 (0.102) loss_u loss_u 0.8604 (0.8838) acc_u 18.7500 (14.7500) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [30/37] time 0.162 (0.178) data 0.085 (0.101) loss_u loss_u 0.9478 (0.8928) acc_u 9.3750 (13.7500) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [35/37] time 0.172 (0.178) data 0.095 (0.101) loss_u loss_u 0.8882 (0.8970) acc_u 15.6250 (13.0357) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 741
confident_label rate tensor(0.2797, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 452
clean true:432
clean false:20
clean_rate:0.9557522123893806
noisy true:443
noisy false:721
after delete: len(clean_dataset) 452
after delete: len(noisy_dataset) 1164
epoch [6/200] batch [5/14] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.6733 (1.1690) acc_x 84.3750 (74.3750) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [10/14] time 0.183 (0.184) data 0.107 (0.108) loss_x loss_x 0.8354 (1.0298) acc_x 81.2500 (74.3750) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/36] time 0.182 (0.183) data 0.105 (0.107) loss_u loss_u 0.9507 (0.9122) acc_u 3.1250 (8.7500) lr 1.9980e-03 eta 0:00:05
epoch [6/200] batch [10/36] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8989 (0.9095) acc_u 15.6250 (10.3125) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [15/36] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9644 (0.9127) acc_u 6.2500 (9.7917) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [20/36] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.9058 (0.9115) acc_u 15.6250 (10.3125) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [25/36] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.8442 (0.9092) acc_u 21.8750 (10.5000) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [30/36] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8911 (0.9064) acc_u 18.7500 (11.3542) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [35/36] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9009 (0.9085) acc_u 12.5000 (11.0714) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 752
confident_label rate tensor(0.2865, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 463
clean true:444
clean false:19
clean_rate:0.958963282937365
noisy true:420
noisy false:733
after delete: len(clean_dataset) 463
after delete: len(noisy_dataset) 1153
epoch [7/200] batch [5/14] time 0.183 (0.178) data 0.107 (0.102) loss_x loss_x 1.3604 (0.9179) acc_x 62.5000 (72.5000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [10/14] time 0.185 (0.180) data 0.109 (0.104) loss_x loss_x 0.7329 (1.0399) acc_x 71.8750 (70.3125) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/36] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.9697 (0.9132) acc_u 3.1250 (10.0000) lr 1.9969e-03 eta 0:00:05
epoch [7/200] batch [10/36] time 0.159 (0.177) data 0.082 (0.100) loss_u loss_u 0.9414 (0.9061) acc_u 6.2500 (9.6875) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [15/36] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.8955 (0.9031) acc_u 12.5000 (10.6250) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [20/36] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.9629 (0.9117) acc_u 6.2500 (9.5312) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [25/36] time 0.188 (0.180) data 0.110 (0.103) loss_u loss_u 0.9155 (0.9112) acc_u 9.3750 (10.0000) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [30/36] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8999 (0.9089) acc_u 15.6250 (10.8333) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [35/36] time 0.185 (0.181) data 0.108 (0.103) loss_u loss_u 0.9121 (0.9104) acc_u 12.5000 (11.0714) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 766
confident_label rate tensor(0.2704, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 437
clean true:422
clean false:15
clean_rate:0.965675057208238
noisy true:428
noisy false:751
after delete: len(clean_dataset) 437
after delete: len(noisy_dataset) 1179
epoch [8/200] batch [5/13] time 0.170 (0.180) data 0.093 (0.104) loss_x loss_x 1.3076 (1.0719) acc_x 81.2500 (76.2500) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [10/13] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 1.5596 (1.0567) acc_x 56.2500 (75.9375) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/36] time 0.185 (0.183) data 0.107 (0.107) loss_u loss_u 0.9541 (0.9140) acc_u 6.2500 (10.0000) lr 1.9956e-03 eta 0:00:05
epoch [8/200] batch [10/36] time 0.179 (0.182) data 0.103 (0.105) loss_u loss_u 0.8755 (0.8894) acc_u 15.6250 (13.4375) lr 1.9956e-03 eta 0:00:04
epoch [8/200] batch [15/36] time 0.160 (0.181) data 0.083 (0.104) loss_u loss_u 0.9014 (0.8885) acc_u 9.3750 (13.7500) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [20/36] time 0.174 (0.180) data 0.096 (0.103) loss_u loss_u 0.9028 (0.8909) acc_u 9.3750 (13.1250) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [25/36] time 0.180 (0.180) data 0.102 (0.103) loss_u loss_u 0.9082 (0.8953) acc_u 12.5000 (12.7500) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [30/36] time 0.178 (0.179) data 0.100 (0.102) loss_u loss_u 0.9033 (0.8923) acc_u 12.5000 (13.0208) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [35/36] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.8550 (0.8927) acc_u 12.5000 (12.7679) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 734
confident_label rate tensor(0.3007, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 486
clean true:463
clean false:23
clean_rate:0.9526748971193416
noisy true:419
noisy false:711
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1130
epoch [9/200] batch [5/15] time 0.180 (0.184) data 0.104 (0.108) loss_x loss_x 0.8550 (0.8638) acc_x 75.0000 (77.5000) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [10/15] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.7148 (0.8619) acc_x 81.2500 (78.4375) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [15/15] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 1.2178 (0.9604) acc_x 65.6250 (75.2083) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/35] time 0.159 (0.177) data 0.082 (0.101) loss_u loss_u 0.7910 (0.8780) acc_u 25.0000 (13.7500) lr 1.9940e-03 eta 0:00:05
epoch [9/200] batch [10/35] time 0.181 (0.177) data 0.103 (0.100) loss_u loss_u 0.8843 (0.8913) acc_u 12.5000 (12.1875) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [15/35] time 0.169 (0.175) data 0.093 (0.098) loss_u loss_u 0.9370 (0.9033) acc_u 3.1250 (10.6250) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [20/35] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.9375 (0.9119) acc_u 9.3750 (9.6875) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [25/35] time 0.183 (0.175) data 0.105 (0.098) loss_u loss_u 0.8574 (0.9046) acc_u 18.7500 (10.7500) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [30/35] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.8838 (0.9021) acc_u 12.5000 (11.1458) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [35/35] time 0.180 (0.176) data 0.103 (0.099) loss_u loss_u 0.9209 (0.9020) acc_u 6.2500 (10.8929) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 770
confident_label rate tensor(0.2816, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 455
clean true:435
clean false:20
clean_rate:0.9560439560439561
noisy true:411
noisy false:750
after delete: len(clean_dataset) 455
after delete: len(noisy_dataset) 1161
epoch [10/200] batch [5/14] time 0.163 (0.178) data 0.086 (0.101) loss_x loss_x 0.4663 (0.9205) acc_x 87.5000 (74.3750) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [10/14] time 0.184 (0.178) data 0.107 (0.102) loss_x loss_x 0.8848 (0.9097) acc_x 75.0000 (73.7500) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/36] time 0.158 (0.175) data 0.080 (0.098) loss_u loss_u 0.9097 (0.8890) acc_u 9.3750 (13.1250) lr 1.9921e-03 eta 0:00:05
epoch [10/200] batch [10/36] time 0.159 (0.171) data 0.082 (0.095) loss_u loss_u 0.8892 (0.8881) acc_u 12.5000 (13.7500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [15/36] time 0.184 (0.173) data 0.108 (0.096) loss_u loss_u 0.9204 (0.8947) acc_u 9.3750 (12.2917) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [20/36] time 0.184 (0.174) data 0.107 (0.097) loss_u loss_u 0.9253 (0.8941) acc_u 9.3750 (12.0312) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [25/36] time 0.183 (0.176) data 0.106 (0.099) loss_u loss_u 0.8892 (0.8937) acc_u 6.2500 (11.7500) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [30/36] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.9180 (0.8898) acc_u 9.3750 (12.2917) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [35/36] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.8960 (0.8897) acc_u 9.3750 (12.4107) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 699
confident_label rate tensor(0.3020, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 488
clean true:467
clean false:21
clean_rate:0.9569672131147541
noisy true:450
noisy false:678
after delete: len(clean_dataset) 488
after delete: len(noisy_dataset) 1128
epoch [11/200] batch [5/15] time 0.166 (0.180) data 0.090 (0.103) loss_x loss_x 0.7881 (1.1146) acc_x 78.1250 (70.6250) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [10/15] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.7632 (1.0189) acc_x 78.1250 (72.1875) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [15/15] time 0.186 (0.179) data 0.108 (0.103) loss_x loss_x 1.1816 (1.0842) acc_x 68.7500 (71.4583) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/35] time 0.169 (0.177) data 0.091 (0.100) loss_u loss_u 0.8804 (0.8832) acc_u 15.6250 (13.7500) lr 1.9900e-03 eta 0:00:05
epoch [11/200] batch [10/35] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.9180 (0.8876) acc_u 9.3750 (13.4375) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [15/35] time 0.160 (0.174) data 0.083 (0.097) loss_u loss_u 0.9688 (0.8992) acc_u 3.1250 (11.8750) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [20/35] time 0.163 (0.173) data 0.085 (0.096) loss_u loss_u 0.8579 (0.9022) acc_u 18.7500 (11.7188) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [25/35] time 0.184 (0.173) data 0.106 (0.096) loss_u loss_u 0.9531 (0.9075) acc_u 3.1250 (11.0000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [30/35] time 0.191 (0.175) data 0.113 (0.097) loss_u loss_u 0.9570 (0.9067) acc_u 6.2500 (11.3542) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [35/35] time 0.186 (0.176) data 0.109 (0.098) loss_u loss_u 0.9507 (0.9077) acc_u 6.2500 (11.1607) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 710
confident_label rate tensor(0.3007, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 486
clean true:465
clean false:21
clean_rate:0.9567901234567902
noisy true:441
noisy false:689
after delete: len(clean_dataset) 486
after delete: len(noisy_dataset) 1130
epoch [12/200] batch [5/15] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.6294 (0.8716) acc_x 81.2500 (80.6250) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [10/15] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.5396 (0.9189) acc_x 90.6250 (75.6250) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [15/15] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 1.0791 (0.9192) acc_x 71.8750 (76.0417) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/35] time 0.179 (0.184) data 0.101 (0.107) loss_u loss_u 0.9346 (0.9091) acc_u 6.2500 (10.0000) lr 1.9877e-03 eta 0:00:05
epoch [12/200] batch [10/35] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9390 (0.9110) acc_u 6.2500 (9.3750) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [15/35] time 0.159 (0.182) data 0.082 (0.105) loss_u loss_u 0.9780 (0.9156) acc_u 0.0000 (8.9583) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [20/35] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.8652 (0.9043) acc_u 12.5000 (10.4688) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [25/35] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.8711 (0.9050) acc_u 12.5000 (10.0000) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [30/35] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.7471 (0.8981) acc_u 34.3750 (11.0417) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [35/35] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.8818 (0.8976) acc_u 12.5000 (11.0714) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 707
confident_label rate tensor(0.3026, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 489
clean true:465
clean false:24
clean_rate:0.950920245398773
noisy true:444
noisy false:683
after delete: len(clean_dataset) 489
after delete: len(noisy_dataset) 1127
epoch [13/200] batch [5/15] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.8374 (0.9748) acc_x 75.0000 (74.3750) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [10/15] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 1.2568 (0.9327) acc_x 65.6250 (75.6250) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [15/15] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 1.0215 (0.9415) acc_x 65.6250 (73.1250) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/35] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9443 (0.8966) acc_u 6.2500 (11.2500) lr 1.9851e-03 eta 0:00:05
epoch [13/200] batch [10/35] time 0.181 (0.183) data 0.103 (0.106) loss_u loss_u 0.9077 (0.8921) acc_u 12.5000 (11.8750) lr 1.9851e-03 eta 0:00:04
epoch [13/200] batch [15/35] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9404 (0.9051) acc_u 6.2500 (10.4167) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [20/35] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9272 (0.9078) acc_u 9.3750 (10.3125) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [25/35] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8442 (0.9083) acc_u 18.7500 (10.2500) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [30/35] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.8970 (0.9098) acc_u 18.7500 (10.4167) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [35/35] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.8540 (0.8988) acc_u 18.7500 (11.8750) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 707
confident_label rate tensor(0.3057, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 494
clean true:469
clean false:25
clean_rate:0.9493927125506073
noisy true:440
noisy false:682
after delete: len(clean_dataset) 494
after delete: len(noisy_dataset) 1122
epoch [14/200] batch [5/15] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7217 (1.0967) acc_x 81.2500 (71.8750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [10/15] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.5801 (0.8859) acc_x 87.5000 (76.5625) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [15/15] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.6714 (0.9887) acc_x 81.2500 (74.7917) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/35] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.8296 (0.8821) acc_u 18.7500 (15.0000) lr 1.9823e-03 eta 0:00:05
epoch [14/200] batch [10/35] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8638 (0.8753) acc_u 15.6250 (15.6250) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [15/35] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8955 (0.8815) acc_u 12.5000 (14.3750) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [20/35] time 0.168 (0.181) data 0.091 (0.104) loss_u loss_u 0.8398 (0.8846) acc_u 21.8750 (14.2188) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [25/35] time 0.174 (0.181) data 0.098 (0.104) loss_u loss_u 0.9062 (0.8894) acc_u 15.6250 (13.8750) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [30/35] time 0.192 (0.181) data 0.114 (0.103) loss_u loss_u 0.9185 (0.8920) acc_u 9.3750 (13.3333) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [35/35] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.8750 (0.8898) acc_u 9.3750 (13.3929) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 696
confident_label rate tensor(0.3082, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 498
clean true:476
clean false:22
clean_rate:0.9558232931726908
noisy true:444
noisy false:674
after delete: len(clean_dataset) 498
after delete: len(noisy_dataset) 1118
epoch [15/200] batch [5/15] time 0.184 (0.186) data 0.108 (0.110) loss_x loss_x 0.5781 (1.0034) acc_x 81.2500 (73.1250) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [10/15] time 0.184 (0.188) data 0.107 (0.111) loss_x loss_x 1.1094 (1.0415) acc_x 75.0000 (73.7500) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [15/15] time 0.199 (0.181) data 0.122 (0.104) loss_x loss_x 1.0557 (1.0384) acc_x 65.6250 (73.7500) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/34] time 0.187 (0.182) data 0.110 (0.105) loss_u loss_u 0.9565 (0.9211) acc_u 6.2500 (8.1250) lr 1.9792e-03 eta 0:00:05
epoch [15/200] batch [10/34] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9043 (0.9127) acc_u 12.5000 (10.0000) lr 1.9792e-03 eta 0:00:04
epoch [15/200] batch [15/34] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9341 (0.9182) acc_u 9.3750 (9.7917) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [20/34] time 0.181 (0.182) data 0.105 (0.105) loss_u loss_u 0.9463 (0.9150) acc_u 6.2500 (10.4688) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [25/34] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9312 (0.9170) acc_u 9.3750 (10.3750) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [30/34] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8589 (0.9071) acc_u 18.7500 (11.5625) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 694
confident_label rate tensor(0.3100, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 501
clean true:479
clean false:22
clean_rate:0.9560878243512974
noisy true:443
noisy false:672
after delete: len(clean_dataset) 501
after delete: len(noisy_dataset) 1115
epoch [16/200] batch [5/15] time 0.183 (0.187) data 0.107 (0.111) loss_x loss_x 0.5117 (0.5555) acc_x 93.7500 (86.2500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [10/15] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.9961 (0.7122) acc_x 75.0000 (80.6250) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [15/15] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 1.0410 (0.8012) acc_x 65.6250 (78.7500) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/34] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9082 (0.9074) acc_u 9.3750 (10.0000) lr 1.9759e-03 eta 0:00:05
epoch [16/200] batch [10/34] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.8940 (0.8999) acc_u 12.5000 (10.9375) lr 1.9759e-03 eta 0:00:04
epoch [16/200] batch [15/34] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.9180 (0.8991) acc_u 6.2500 (11.2500) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [20/34] time 0.175 (0.182) data 0.098 (0.105) loss_u loss_u 0.8975 (0.9020) acc_u 9.3750 (10.7812) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [25/34] time 0.181 (0.181) data 0.103 (0.104) loss_u loss_u 0.9165 (0.9042) acc_u 6.2500 (10.2500) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [30/34] time 0.186 (0.182) data 0.108 (0.104) loss_u loss_u 0.9458 (0.9032) acc_u 6.2500 (10.7292) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 671
confident_label rate tensor(0.3236, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 523
clean true:506
clean false:17
clean_rate:0.9674952198852772
noisy true:439
noisy false:654
after delete: len(clean_dataset) 523
after delete: len(noisy_dataset) 1093
epoch [17/200] batch [5/16] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.7222 (0.9519) acc_x 84.3750 (76.2500) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/16] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.6689 (0.9675) acc_x 78.1250 (75.3125) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [15/16] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.3984 (0.8654) acc_x 87.5000 (77.9167) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/34] time 0.181 (0.177) data 0.104 (0.100) loss_u loss_u 0.9419 (0.8935) acc_u 9.3750 (12.5000) lr 1.9724e-03 eta 0:00:05
epoch [17/200] batch [10/34] time 0.177 (0.176) data 0.100 (0.100) loss_u loss_u 0.8818 (0.8873) acc_u 12.5000 (12.8125) lr 1.9724e-03 eta 0:00:04
epoch [17/200] batch [15/34] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.9180 (0.8913) acc_u 9.3750 (12.5000) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [20/34] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9268 (0.8962) acc_u 6.2500 (11.7188) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [25/34] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9580 (0.9011) acc_u 6.2500 (11.2500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [30/34] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.9351 (0.9029) acc_u 9.3750 (11.3542) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 698
confident_label rate tensor(0.3119, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 504
clean true:474
clean false:30
clean_rate:0.9404761904761905
noisy true:444
noisy false:668
after delete: len(clean_dataset) 504
after delete: len(noisy_dataset) 1112
epoch [18/200] batch [5/15] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.7686 (0.9576) acc_x 75.0000 (74.3750) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [10/15] time 0.171 (0.181) data 0.094 (0.105) loss_x loss_x 0.7959 (0.8997) acc_x 75.0000 (75.6250) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [15/15] time 0.183 (0.182) data 0.107 (0.106) loss_x loss_x 0.9995 (0.9123) acc_x 59.3750 (73.7500) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/34] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8457 (0.8883) acc_u 18.7500 (12.5000) lr 1.9686e-03 eta 0:00:05
epoch [18/200] batch [10/34] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9111 (0.9106) acc_u 9.3750 (9.6875) lr 1.9686e-03 eta 0:00:04
epoch [18/200] batch [15/34] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.8872 (0.9060) acc_u 12.5000 (10.4167) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [20/34] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8423 (0.8956) acc_u 18.7500 (11.8750) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [25/34] time 0.183 (0.184) data 0.105 (0.107) loss_u loss_u 0.8931 (0.8957) acc_u 9.3750 (11.7500) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [30/34] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9482 (0.8943) acc_u 3.1250 (11.9792) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 666
confident_label rate tensor(0.3113, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 503
clean true:479
clean false:24
clean_rate:0.952286282306163
noisy true:471
noisy false:642
after delete: len(clean_dataset) 503
after delete: len(noisy_dataset) 1113
epoch [19/200] batch [5/15] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.7847 (0.6798) acc_x 75.0000 (80.0000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [10/15] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.9404 (0.8053) acc_x 84.3750 (80.0000) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [15/15] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 1.1064 (0.8096) acc_x 68.7500 (79.7917) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/34] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8760 (0.9196) acc_u 18.7500 (10.0000) lr 1.9646e-03 eta 0:00:05
epoch [19/200] batch [10/34] time 0.179 (0.182) data 0.102 (0.105) loss_u loss_u 0.9453 (0.8964) acc_u 9.3750 (12.5000) lr 1.9646e-03 eta 0:00:04
epoch [19/200] batch [15/34] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.9380 (0.8992) acc_u 6.2500 (12.2917) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [20/34] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8184 (0.8871) acc_u 18.7500 (13.2812) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [25/34] time 0.184 (0.183) data 0.106 (0.105) loss_u loss_u 0.9097 (0.8863) acc_u 12.5000 (13.5000) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [30/34] time 0.178 (0.182) data 0.100 (0.105) loss_u loss_u 0.8838 (0.8908) acc_u 12.5000 (12.7083) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 661
confident_label rate tensor(0.3298, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 533
clean true:507
clean false:26
clean_rate:0.9512195121951219
noisy true:448
noisy false:635
after delete: len(clean_dataset) 533
after delete: len(noisy_dataset) 1083
epoch [20/200] batch [5/16] time 0.172 (0.184) data 0.095 (0.107) loss_x loss_x 1.0400 (0.8223) acc_x 68.7500 (80.0000) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [10/16] time 0.167 (0.177) data 0.090 (0.100) loss_x loss_x 0.4543 (0.8259) acc_x 87.5000 (78.7500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [15/16] time 0.172 (0.176) data 0.095 (0.099) loss_x loss_x 0.9927 (0.8767) acc_x 75.0000 (76.4583) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/33] time 0.186 (0.175) data 0.110 (0.098) loss_u loss_u 0.9727 (0.8848) acc_u 3.1250 (13.1250) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/33] time 0.167 (0.175) data 0.089 (0.098) loss_u loss_u 0.9336 (0.9100) acc_u 6.2500 (10.6250) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [15/33] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.8804 (0.9094) acc_u 12.5000 (9.7917) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [20/33] time 0.161 (0.174) data 0.084 (0.097) loss_u loss_u 0.8975 (0.9093) acc_u 12.5000 (9.5312) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [25/33] time 0.182 (0.175) data 0.106 (0.098) loss_u loss_u 0.9307 (0.9117) acc_u 6.2500 (9.7500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [30/33] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.8911 (0.9087) acc_u 15.6250 (10.4167) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 657
confident_label rate tensor(0.3304, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 534
clean true:510
clean false:24
clean_rate:0.9550561797752809
noisy true:449
noisy false:633
after delete: len(clean_dataset) 534
after delete: len(noisy_dataset) 1082
epoch [21/200] batch [5/16] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.8398 (0.9002) acc_x 75.0000 (73.7500) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [10/16] time 0.182 (0.189) data 0.105 (0.113) loss_x loss_x 0.5693 (0.7333) acc_x 84.3750 (79.3750) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [15/16] time 0.186 (0.188) data 0.110 (0.111) loss_x loss_x 0.6846 (0.6952) acc_x 81.2500 (80.4167) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/33] time 0.182 (0.187) data 0.105 (0.110) loss_u loss_u 0.8623 (0.8881) acc_u 15.6250 (12.5000) lr 1.9558e-03 eta 0:00:05
epoch [21/200] batch [10/33] time 0.185 (0.186) data 0.109 (0.109) loss_u loss_u 0.8525 (0.8880) acc_u 15.6250 (12.5000) lr 1.9558e-03 eta 0:00:04
epoch [21/200] batch [15/33] time 0.182 (0.186) data 0.106 (0.109) loss_u loss_u 0.8955 (0.8778) acc_u 12.5000 (14.1667) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [20/33] time 0.182 (0.185) data 0.106 (0.108) loss_u loss_u 0.8672 (0.8897) acc_u 15.6250 (12.5000) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [25/33] time 0.170 (0.184) data 0.093 (0.107) loss_u loss_u 0.8979 (0.8966) acc_u 9.3750 (11.8750) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [30/33] time 0.158 (0.181) data 0.081 (0.104) loss_u loss_u 0.9458 (0.8977) acc_u 6.2500 (12.0833) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 678
confident_label rate tensor(0.3329, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 538
clean true:506
clean false:32
clean_rate:0.9405204460966543
noisy true:432
noisy false:646
after delete: len(clean_dataset) 538
after delete: len(noisy_dataset) 1078
epoch [22/200] batch [5/16] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.8413 (0.9611) acc_x 78.1250 (75.6250) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [10/16] time 0.158 (0.171) data 0.082 (0.095) loss_x loss_x 0.7773 (0.9513) acc_x 78.1250 (73.7500) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [15/16] time 0.159 (0.167) data 0.082 (0.091) loss_x loss_x 0.8164 (0.9512) acc_x 71.8750 (74.1667) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/33] time 0.187 (0.167) data 0.111 (0.091) loss_u loss_u 0.8071 (0.8459) acc_u 21.8750 (17.5000) lr 1.9511e-03 eta 0:00:04
epoch [22/200] batch [10/33] time 0.176 (0.170) data 0.098 (0.093) loss_u loss_u 0.9409 (0.8870) acc_u 3.1250 (12.5000) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [15/33] time 0.165 (0.170) data 0.088 (0.093) loss_u loss_u 0.8662 (0.8932) acc_u 12.5000 (11.8750) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [20/33] time 0.184 (0.171) data 0.107 (0.094) loss_u loss_u 0.8716 (0.8897) acc_u 15.6250 (12.3438) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [25/33] time 0.184 (0.172) data 0.106 (0.095) loss_u loss_u 0.8848 (0.8968) acc_u 15.6250 (11.5000) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [30/33] time 0.184 (0.174) data 0.106 (0.096) loss_u loss_u 0.9316 (0.8974) acc_u 6.2500 (11.7708) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.3311, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 535
clean true:508
clean false:27
clean_rate:0.9495327102803738
noisy true:431
noisy false:650
after delete: len(clean_dataset) 535
after delete: len(noisy_dataset) 1081
epoch [23/200] batch [5/16] time 0.169 (0.177) data 0.093 (0.101) loss_x loss_x 0.8965 (0.7912) acc_x 78.1250 (78.7500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [10/16] time 0.170 (0.170) data 0.093 (0.093) loss_x loss_x 0.6230 (0.8740) acc_x 84.3750 (77.1875) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [15/16] time 0.178 (0.170) data 0.101 (0.094) loss_x loss_x 0.9253 (0.8632) acc_x 71.8750 (76.8750) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/33] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.8970 (0.9077) acc_u 12.5000 (10.0000) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [10/33] time 0.182 (0.175) data 0.106 (0.098) loss_u loss_u 0.9487 (0.9181) acc_u 6.2500 (9.6875) lr 1.9461e-03 eta 0:00:04
epoch [23/200] batch [15/33] time 0.181 (0.176) data 0.104 (0.100) loss_u loss_u 0.8140 (0.9123) acc_u 25.0000 (10.8333) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [20/33] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9702 (0.9045) acc_u 3.1250 (11.8750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [25/33] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.9775 (0.9012) acc_u 0.0000 (12.2500) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [30/33] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.9189 (0.8964) acc_u 9.3750 (12.6042) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.3434, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 555
clean true:523
clean false:32
clean_rate:0.9423423423423424
noisy true:448
noisy false:613
after delete: len(clean_dataset) 555
after delete: len(noisy_dataset) 1061
epoch [24/200] batch [5/17] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6172 (1.0604) acc_x 81.2500 (73.1250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [10/17] time 0.161 (0.183) data 0.084 (0.106) loss_x loss_x 1.1914 (1.0003) acc_x 68.7500 (74.0625) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [15/17] time 0.185 (0.181) data 0.108 (0.105) loss_x loss_x 1.0820 (0.9183) acc_x 78.1250 (77.0833) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/33] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8608 (0.8977) acc_u 15.6250 (11.2500) lr 1.9409e-03 eta 0:00:05
epoch [24/200] batch [10/33] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8311 (0.8833) acc_u 18.7500 (12.8125) lr 1.9409e-03 eta 0:00:04
epoch [24/200] batch [15/33] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.8218 (0.8888) acc_u 18.7500 (11.8750) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [20/33] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9067 (0.8955) acc_u 12.5000 (11.7188) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [25/33] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9565 (0.8984) acc_u 6.2500 (11.3750) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [30/33] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.9082 (0.8975) acc_u 9.3750 (11.4583) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.3199, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 517
clean true:495
clean false:22
clean_rate:0.9574468085106383
noisy true:469
noisy false:630
after delete: len(clean_dataset) 517
after delete: len(noisy_dataset) 1099
epoch [25/200] batch [5/16] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.9268 (0.9710) acc_x 71.8750 (76.8750) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [10/16] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.7510 (0.9955) acc_x 78.1250 (76.5625) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [15/16] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 1.0820 (0.9529) acc_x 62.5000 (75.6250) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/34] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9126 (0.9041) acc_u 12.5000 (11.8750) lr 1.9354e-03 eta 0:00:05
epoch [25/200] batch [10/34] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9341 (0.8947) acc_u 9.3750 (12.8125) lr 1.9354e-03 eta 0:00:04
epoch [25/200] batch [15/34] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8691 (0.8780) acc_u 15.6250 (15.6250) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [20/34] time 0.167 (0.182) data 0.090 (0.106) loss_u loss_u 0.8569 (0.8862) acc_u 15.6250 (14.5312) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [25/34] time 0.174 (0.181) data 0.098 (0.105) loss_u loss_u 0.8721 (0.8850) acc_u 18.7500 (14.7500) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [30/34] time 0.172 (0.180) data 0.095 (0.104) loss_u loss_u 0.9263 (0.8878) acc_u 6.2500 (13.9583) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 670
confident_label rate tensor(0.3280, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 530
clean true:503
clean false:27
clean_rate:0.9490566037735849
noisy true:443
noisy false:643
after delete: len(clean_dataset) 530
after delete: len(noisy_dataset) 1086
epoch [26/200] batch [5/16] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.9277 (0.8740) acc_x 87.5000 (80.6250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [10/16] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.7412 (0.8073) acc_x 68.7500 (79.3750) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [15/16] time 0.167 (0.176) data 0.089 (0.099) loss_x loss_x 0.5137 (0.8034) acc_x 84.3750 (79.7917) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/33] time 0.162 (0.176) data 0.084 (0.099) loss_u loss_u 0.9399 (0.9121) acc_u 9.3750 (11.2500) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [10/33] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8682 (0.8911) acc_u 12.5000 (12.1875) lr 1.9298e-03 eta 0:00:04
epoch [26/200] batch [15/33] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.8745 (0.8839) acc_u 18.7500 (13.5417) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [20/33] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.9429 (0.8876) acc_u 6.2500 (13.1250) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [25/33] time 0.185 (0.180) data 0.107 (0.102) loss_u loss_u 0.9272 (0.8865) acc_u 6.2500 (13.2500) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [30/33] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8647 (0.8852) acc_u 18.7500 (13.3333) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 676
confident_label rate tensor(0.3267, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 528
clean true:499
clean false:29
clean_rate:0.9450757575757576
noisy true:441
noisy false:647
after delete: len(clean_dataset) 528
after delete: len(noisy_dataset) 1088
epoch [27/200] batch [5/16] time 0.180 (0.186) data 0.104 (0.109) loss_x loss_x 0.8418 (1.0055) acc_x 68.7500 (74.3750) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [10/16] time 0.175 (0.181) data 0.098 (0.104) loss_x loss_x 0.6709 (0.9897) acc_x 81.2500 (73.1250) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [15/16] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.9956 (0.9772) acc_x 78.1250 (73.7500) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/34] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9595 (0.8862) acc_u 0.0000 (13.1250) lr 1.9239e-03 eta 0:00:05
epoch [27/200] batch [10/34] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9180 (0.8912) acc_u 9.3750 (12.8125) lr 1.9239e-03 eta 0:00:04
epoch [27/200] batch [15/34] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8677 (0.8900) acc_u 12.5000 (13.3333) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [20/34] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.9199 (0.8825) acc_u 9.3750 (14.5312) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [25/34] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9541 (0.8906) acc_u 6.2500 (13.7500) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [30/34] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9258 (0.8962) acc_u 9.3750 (12.9167) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 639
confident_label rate tensor(0.3453, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 558
clean true:525
clean false:33
clean_rate:0.9408602150537635
noisy true:452
noisy false:606
after delete: len(clean_dataset) 558
after delete: len(noisy_dataset) 1058
epoch [28/200] batch [5/17] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.6387 (0.8823) acc_x 81.2500 (77.5000) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [10/17] time 0.161 (0.161) data 0.084 (0.085) loss_x loss_x 0.4836 (0.8325) acc_x 90.6250 (78.7500) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [15/17] time 0.171 (0.165) data 0.095 (0.088) loss_x loss_x 0.8936 (0.9487) acc_x 62.5000 (75.6250) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/33] time 0.182 (0.169) data 0.104 (0.092) loss_u loss_u 0.8843 (0.8927) acc_u 12.5000 (12.5000) lr 1.9178e-03 eta 0:00:04
epoch [28/200] batch [10/33] time 0.181 (0.171) data 0.104 (0.094) loss_u loss_u 0.8926 (0.8930) acc_u 15.6250 (11.5625) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [15/33] time 0.182 (0.173) data 0.105 (0.096) loss_u loss_u 0.9292 (0.8938) acc_u 9.3750 (12.5000) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [20/33] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.8740 (0.8941) acc_u 15.6250 (12.5000) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [25/33] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.8076 (0.8931) acc_u 25.0000 (12.5000) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [30/33] time 0.179 (0.176) data 0.102 (0.099) loss_u loss_u 0.8340 (0.8908) acc_u 18.7500 (12.7083) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 682
confident_label rate tensor(0.3348, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 541
clean true:502
clean false:39
clean_rate:0.9279112754158965
noisy true:432
noisy false:643
after delete: len(clean_dataset) 541
after delete: len(noisy_dataset) 1075
epoch [29/200] batch [5/16] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 1.3125 (1.2635) acc_x 71.8750 (73.7500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [10/16] time 0.178 (0.181) data 0.101 (0.105) loss_x loss_x 1.0889 (1.0459) acc_x 71.8750 (75.6250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [15/16] time 0.179 (0.181) data 0.103 (0.105) loss_x loss_x 1.2178 (1.0010) acc_x 62.5000 (75.6250) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/33] time 0.178 (0.180) data 0.101 (0.104) loss_u loss_u 0.8052 (0.8423) acc_u 25.0000 (19.3750) lr 1.9114e-03 eta 0:00:05
epoch [29/200] batch [10/33] time 0.182 (0.180) data 0.105 (0.104) loss_u loss_u 0.8369 (0.8545) acc_u 18.7500 (17.1875) lr 1.9114e-03 eta 0:00:04
epoch [29/200] batch [15/33] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.8691 (0.8676) acc_u 12.5000 (15.6250) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [20/33] time 0.168 (0.180) data 0.091 (0.103) loss_u loss_u 0.9102 (0.8787) acc_u 6.2500 (13.9062) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [25/33] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.9199 (0.8813) acc_u 9.3750 (13.7500) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [30/33] time 0.176 (0.180) data 0.099 (0.104) loss_u loss_u 0.9766 (0.8913) acc_u 0.0000 (12.6042) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 642
confident_label rate tensor(0.3410, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 551
clean true:528
clean false:23
clean_rate:0.9582577132486388
noisy true:446
noisy false:619
after delete: len(clean_dataset) 551
after delete: len(noisy_dataset) 1065
epoch [30/200] batch [5/17] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7134 (0.8522) acc_x 81.2500 (80.6250) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [10/17] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8467 (0.8596) acc_x 71.8750 (78.1250) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [15/17] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.6880 (0.8727) acc_x 81.2500 (77.7083) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/33] time 0.164 (0.180) data 0.088 (0.103) loss_u loss_u 0.9614 (0.8951) acc_u 3.1250 (11.8750) lr 1.9048e-03 eta 0:00:05
epoch [30/200] batch [10/33] time 0.167 (0.177) data 0.089 (0.100) loss_u loss_u 0.9517 (0.9075) acc_u 3.1250 (10.9375) lr 1.9048e-03 eta 0:00:04
epoch [30/200] batch [15/33] time 0.162 (0.175) data 0.084 (0.098) loss_u loss_u 0.8960 (0.9007) acc_u 12.5000 (11.2500) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [20/33] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.8354 (0.8950) acc_u 15.6250 (12.0312) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [25/33] time 0.184 (0.177) data 0.108 (0.100) loss_u loss_u 0.9380 (0.8952) acc_u 9.3750 (12.2500) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [30/33] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.9058 (0.8946) acc_u 15.6250 (12.6042) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.3558, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 575
clean true:544
clean false:31
clean_rate:0.9460869565217391
noisy true:466
noisy false:575
after delete: len(clean_dataset) 575
after delete: len(noisy_dataset) 1041
epoch [31/200] batch [5/17] time 0.169 (0.167) data 0.092 (0.090) loss_x loss_x 1.1338 (0.9913) acc_x 68.7500 (77.5000) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [10/17] time 0.179 (0.169) data 0.103 (0.092) loss_x loss_x 0.7661 (0.9444) acc_x 81.2500 (78.7500) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [15/17] time 0.171 (0.172) data 0.095 (0.095) loss_x loss_x 1.1611 (0.9524) acc_x 59.3750 (77.2917) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/32] time 0.168 (0.172) data 0.090 (0.095) loss_u loss_u 0.9160 (0.9045) acc_u 9.3750 (11.8750) lr 1.8980e-03 eta 0:00:04
epoch [31/200] batch [10/32] time 0.184 (0.173) data 0.106 (0.095) loss_u loss_u 0.8989 (0.9068) acc_u 9.3750 (11.2500) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [15/32] time 0.181 (0.174) data 0.104 (0.097) loss_u loss_u 0.9180 (0.9060) acc_u 6.2500 (11.2500) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [20/32] time 0.181 (0.176) data 0.104 (0.098) loss_u loss_u 0.8838 (0.9059) acc_u 12.5000 (11.2500) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [25/32] time 0.163 (0.175) data 0.087 (0.098) loss_u loss_u 0.8408 (0.9018) acc_u 15.6250 (11.5000) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [30/32] time 0.166 (0.174) data 0.089 (0.097) loss_u loss_u 0.8438 (0.9009) acc_u 18.7500 (11.5625) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 634
confident_label rate tensor(0.3447, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 557
clean true:531
clean false:26
clean_rate:0.9533213644524237
noisy true:451
noisy false:608
after delete: len(clean_dataset) 557
after delete: len(noisy_dataset) 1059
epoch [32/200] batch [5/17] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.4526 (0.8768) acc_x 81.2500 (76.8750) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [10/17] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.7026 (0.8799) acc_x 84.3750 (77.5000) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [15/17] time 0.184 (0.177) data 0.107 (0.100) loss_x loss_x 1.0273 (0.8519) acc_x 84.3750 (79.7917) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/33] time 0.183 (0.178) data 0.106 (0.102) loss_u loss_u 0.8901 (0.8935) acc_u 12.5000 (12.5000) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [10/33] time 0.186 (0.180) data 0.109 (0.103) loss_u loss_u 0.9521 (0.9182) acc_u 3.1250 (9.3750) lr 1.8910e-03 eta 0:00:04
epoch [32/200] batch [15/33] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9150 (0.9161) acc_u 9.3750 (9.3750) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [20/33] time 0.164 (0.179) data 0.087 (0.102) loss_u loss_u 0.8550 (0.9096) acc_u 12.5000 (10.0000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [25/33] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.8770 (0.9067) acc_u 12.5000 (10.6250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [30/33] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.9316 (0.9097) acc_u 6.2500 (10.0000) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 660
confident_label rate tensor(0.3385, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 547
clean true:514
clean false:33
clean_rate:0.9396709323583181
noisy true:442
noisy false:627
after delete: len(clean_dataset) 547
after delete: len(noisy_dataset) 1069
epoch [33/200] batch [5/17] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.7246 (0.7992) acc_x 78.1250 (75.0000) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [10/17] time 0.159 (0.176) data 0.082 (0.100) loss_x loss_x 1.0625 (0.7833) acc_x 62.5000 (75.9375) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [15/17] time 0.183 (0.173) data 0.106 (0.097) loss_x loss_x 0.8667 (0.7630) acc_x 78.1250 (76.4583) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/33] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.8931 (0.9100) acc_u 12.5000 (10.0000) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [10/33] time 0.184 (0.177) data 0.108 (0.101) loss_u loss_u 0.8550 (0.8717) acc_u 15.6250 (14.0625) lr 1.8838e-03 eta 0:00:04
epoch [33/200] batch [15/33] time 0.159 (0.177) data 0.082 (0.100) loss_u loss_u 0.9062 (0.8898) acc_u 15.6250 (13.1250) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [20/33] time 0.186 (0.176) data 0.108 (0.099) loss_u loss_u 0.9775 (0.8950) acc_u 3.1250 (12.6562) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [25/33] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8003 (0.8936) acc_u 21.8750 (12.7500) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [30/33] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.9404 (0.8942) acc_u 9.3750 (12.8125) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 653
confident_label rate tensor(0.3323, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 537
clean true:513
clean false:24
clean_rate:0.9553072625698324
noisy true:450
noisy false:629
after delete: len(clean_dataset) 537
after delete: len(noisy_dataset) 1079
epoch [34/200] batch [5/16] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.7246 (0.5875) acc_x 78.1250 (86.2500) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [10/16] time 0.182 (0.179) data 0.105 (0.103) loss_x loss_x 0.8252 (0.7151) acc_x 75.0000 (82.1875) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [15/16] time 0.169 (0.178) data 0.092 (0.101) loss_x loss_x 0.7705 (0.7401) acc_x 81.2500 (82.5000) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/33] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.9170 (0.8897) acc_u 9.3750 (12.5000) lr 1.8763e-03 eta 0:00:05
epoch [34/200] batch [10/33] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.8359 (0.8913) acc_u 21.8750 (12.8125) lr 1.8763e-03 eta 0:00:04
epoch [34/200] batch [15/33] time 0.163 (0.179) data 0.085 (0.102) loss_u loss_u 0.8857 (0.8882) acc_u 12.5000 (13.3333) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [20/33] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.8906 (0.8951) acc_u 9.3750 (11.7188) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [25/33] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.8296 (0.8991) acc_u 18.7500 (11.2500) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [30/33] time 0.182 (0.180) data 0.104 (0.103) loss_u loss_u 0.8633 (0.8974) acc_u 18.7500 (11.7708) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 605
confident_label rate tensor(0.3428, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 554
clean true:528
clean false:26
clean_rate:0.9530685920577617
noisy true:483
noisy false:579
after delete: len(clean_dataset) 554
after delete: len(noisy_dataset) 1062
epoch [35/200] batch [5/17] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 1.2168 (0.9853) acc_x 71.8750 (74.3750) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [10/17] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.5234 (0.9071) acc_x 87.5000 (75.6250) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [15/17] time 0.177 (0.179) data 0.100 (0.102) loss_x loss_x 1.2412 (0.9234) acc_x 62.5000 (75.0000) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/33] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.8936 (0.8722) acc_u 9.3750 (12.5000) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [10/33] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.8325 (0.8661) acc_u 18.7500 (13.4375) lr 1.8686e-03 eta 0:00:04
epoch [35/200] batch [15/33] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.9287 (0.8817) acc_u 9.3750 (12.5000) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [20/33] time 0.181 (0.179) data 0.103 (0.101) loss_u loss_u 0.8584 (0.8785) acc_u 18.7500 (13.1250) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [25/33] time 0.182 (0.179) data 0.104 (0.102) loss_u loss_u 0.8569 (0.8857) acc_u 18.7500 (12.7500) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [30/33] time 0.183 (0.180) data 0.105 (0.102) loss_u loss_u 0.8896 (0.8849) acc_u 12.5000 (12.9167) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 616
confident_label rate tensor(0.3552, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 574
clean true:547
clean false:27
clean_rate:0.9529616724738676
noisy true:453
noisy false:589
after delete: len(clean_dataset) 574
after delete: len(noisy_dataset) 1042
epoch [36/200] batch [5/17] time 0.189 (0.170) data 0.112 (0.093) loss_x loss_x 0.9175 (0.7104) acc_x 68.7500 (76.8750) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [10/17] time 0.163 (0.170) data 0.086 (0.093) loss_x loss_x 1.5117 (0.7744) acc_x 65.6250 (75.6250) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [15/17] time 0.182 (0.172) data 0.105 (0.095) loss_x loss_x 0.7798 (0.7624) acc_x 68.7500 (76.6667) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/32] time 0.161 (0.173) data 0.083 (0.096) loss_u loss_u 0.8872 (0.8945) acc_u 18.7500 (12.5000) lr 1.8607e-03 eta 0:00:04
epoch [36/200] batch [10/32] time 0.183 (0.172) data 0.106 (0.095) loss_u loss_u 0.9180 (0.8961) acc_u 6.2500 (11.8750) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [15/32] time 0.186 (0.174) data 0.108 (0.097) loss_u loss_u 0.9453 (0.9021) acc_u 3.1250 (10.4167) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [20/32] time 0.183 (0.174) data 0.105 (0.097) loss_u loss_u 0.9058 (0.8984) acc_u 9.3750 (11.2500) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [25/32] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.9365 (0.8979) acc_u 6.2500 (11.5000) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [30/32] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9536 (0.9004) acc_u 9.3750 (11.3542) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 645
confident_label rate tensor(0.3472, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 561
clean true:525
clean false:36
clean_rate:0.9358288770053476
noisy true:446
noisy false:609
after delete: len(clean_dataset) 561
after delete: len(noisy_dataset) 1055
epoch [37/200] batch [5/17] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.1826 (0.8951) acc_x 96.8750 (76.8750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [10/17] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.8301 (0.9040) acc_x 71.8750 (76.5625) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [15/17] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.8613 (0.8866) acc_x 71.8750 (76.6667) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/32] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8613 (0.8851) acc_u 18.7500 (15.0000) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/32] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.8804 (0.8937) acc_u 18.7500 (13.7500) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [15/32] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9331 (0.8885) acc_u 6.2500 (14.1667) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [20/32] time 0.187 (0.183) data 0.109 (0.106) loss_u loss_u 0.8169 (0.8884) acc_u 25.0000 (14.0625) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [25/32] time 0.187 (0.183) data 0.110 (0.106) loss_u loss_u 0.8760 (0.8897) acc_u 12.5000 (14.0000) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [30/32] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9097 (0.8891) acc_u 9.3750 (13.8542) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 603
confident_label rate tensor(0.3589, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 580
clean true:544
clean false:36
clean_rate:0.9379310344827586
noisy true:469
noisy false:567
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1036
epoch [38/200] batch [5/18] time 0.182 (0.186) data 0.106 (0.109) loss_x loss_x 0.7471 (0.8644) acc_x 84.3750 (78.7500) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [10/18] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.9263 (0.8432) acc_x 75.0000 (77.8125) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [15/18] time 0.182 (0.185) data 0.104 (0.108) loss_x loss_x 0.7578 (0.8295) acc_x 78.1250 (77.5000) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/32] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9204 (0.8906) acc_u 6.2500 (12.5000) lr 1.8443e-03 eta 0:00:04
epoch [38/200] batch [10/32] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9238 (0.8880) acc_u 12.5000 (12.8125) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [15/32] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9727 (0.8881) acc_u 3.1250 (12.7083) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [20/32] time 0.188 (0.183) data 0.112 (0.106) loss_u loss_u 0.8843 (0.8899) acc_u 12.5000 (12.6562) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [25/32] time 0.185 (0.183) data 0.106 (0.106) loss_u loss_u 0.9497 (0.8967) acc_u 6.2500 (11.7500) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [30/32] time 0.219 (0.184) data 0.143 (0.107) loss_u loss_u 0.9814 (0.8969) acc_u 3.1250 (11.7708) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.3465, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 560
clean true:530
clean false:30
clean_rate:0.9464285714285714
noisy true:484
noisy false:572
after delete: len(clean_dataset) 560
after delete: len(noisy_dataset) 1056
epoch [39/200] batch [5/17] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.5254 (0.7947) acc_x 87.5000 (82.5000) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [10/17] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.6860 (0.7788) acc_x 78.1250 (81.5625) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [15/17] time 0.179 (0.181) data 0.103 (0.105) loss_x loss_x 1.0000 (0.8290) acc_x 68.7500 (79.5833) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/33] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.9072 (0.9026) acc_u 12.5000 (11.2500) lr 1.8358e-03 eta 0:00:05
epoch [39/200] batch [10/33] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8413 (0.8881) acc_u 15.6250 (13.1250) lr 1.8358e-03 eta 0:00:04
epoch [39/200] batch [15/33] time 0.183 (0.181) data 0.105 (0.105) loss_u loss_u 0.9351 (0.8960) acc_u 6.2500 (11.6667) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [20/33] time 0.181 (0.181) data 0.105 (0.105) loss_u loss_u 0.9185 (0.9000) acc_u 9.3750 (11.4062) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [25/33] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8394 (0.8974) acc_u 21.8750 (11.7500) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [30/33] time 0.160 (0.180) data 0.082 (0.103) loss_u loss_u 0.8779 (0.8913) acc_u 15.6250 (12.2917) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 611
confident_label rate tensor(0.3509, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 567
clean true:537
clean false:30
clean_rate:0.9470899470899471
noisy true:468
noisy false:581
after delete: len(clean_dataset) 567
after delete: len(noisy_dataset) 1049
epoch [40/200] batch [5/17] time 0.181 (0.181) data 0.105 (0.104) loss_x loss_x 0.5542 (0.7699) acc_x 84.3750 (81.2500) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [10/17] time 0.179 (0.181) data 0.103 (0.104) loss_x loss_x 0.5869 (0.8612) acc_x 84.3750 (78.7500) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [15/17] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.4905 (0.8299) acc_x 84.3750 (78.7500) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/32] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9160 (0.9010) acc_u 9.3750 (11.2500) lr 1.8271e-03 eta 0:00:04
epoch [40/200] batch [10/32] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8296 (0.8928) acc_u 21.8750 (12.5000) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [15/32] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.8213 (0.8914) acc_u 18.7500 (12.5000) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [20/32] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9312 (0.8948) acc_u 12.5000 (12.3438) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [25/32] time 0.180 (0.182) data 0.104 (0.105) loss_u loss_u 0.9038 (0.8904) acc_u 9.3750 (13.1250) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [30/32] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8823 (0.8852) acc_u 12.5000 (13.5417) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 617
confident_label rate tensor(0.3571, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 577
clean true:545
clean false:32
clean_rate:0.9445407279029463
noisy true:454
noisy false:585
after delete: len(clean_dataset) 577
after delete: len(noisy_dataset) 1039
epoch [41/200] batch [5/18] time 0.181 (0.182) data 0.105 (0.106) loss_x loss_x 1.0117 (0.6534) acc_x 78.1250 (83.7500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [10/18] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.7905 (0.6795) acc_x 81.2500 (85.3125) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [15/18] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4929 (0.6571) acc_x 87.5000 (85.4167) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/32] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.8423 (0.8770) acc_u 18.7500 (13.7500) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [10/32] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.9185 (0.8824) acc_u 9.3750 (13.7500) lr 1.8181e-03 eta 0:00:04
epoch [41/200] batch [15/32] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9209 (0.8938) acc_u 6.2500 (12.2917) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [20/32] time 0.183 (0.184) data 0.105 (0.106) loss_u loss_u 0.9307 (0.8943) acc_u 9.3750 (12.1875) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [25/32] time 0.182 (0.183) data 0.104 (0.106) loss_u loss_u 0.9629 (0.8967) acc_u 3.1250 (11.6250) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [30/32] time 0.193 (0.184) data 0.116 (0.106) loss_u loss_u 0.9097 (0.8977) acc_u 9.3750 (11.4583) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 624
confident_label rate tensor(0.3589, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 580
clean true:543
clean false:37
clean_rate:0.9362068965517242
noisy true:449
noisy false:587
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1036
epoch [42/200] batch [5/18] time 0.160 (0.165) data 0.084 (0.088) loss_x loss_x 0.9214 (0.9951) acc_x 75.0000 (76.8750) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [10/18] time 0.183 (0.174) data 0.107 (0.097) loss_x loss_x 0.8442 (0.9655) acc_x 78.1250 (75.0000) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [15/18] time 0.179 (0.174) data 0.103 (0.097) loss_x loss_x 0.7051 (0.9508) acc_x 81.2500 (76.4583) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/32] time 0.165 (0.170) data 0.089 (0.093) loss_u loss_u 0.8643 (0.8821) acc_u 15.6250 (13.7500) lr 1.8090e-03 eta 0:00:04
epoch [42/200] batch [10/32] time 0.170 (0.169) data 0.093 (0.092) loss_u loss_u 0.8979 (0.8827) acc_u 12.5000 (15.0000) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [15/32] time 0.189 (0.170) data 0.112 (0.093) loss_u loss_u 0.9497 (0.8853) acc_u 9.3750 (14.1667) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [20/32] time 0.182 (0.172) data 0.105 (0.095) loss_u loss_u 0.8887 (0.8988) acc_u 15.6250 (12.3438) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [25/32] time 0.183 (0.173) data 0.106 (0.096) loss_u loss_u 0.8374 (0.8935) acc_u 25.0000 (13.2500) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [30/32] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.8984 (0.8936) acc_u 12.5000 (13.2292) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.3589, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 580
clean true:549
clean false:31
clean_rate:0.946551724137931
noisy true:481
noisy false:555
after delete: len(clean_dataset) 580
after delete: len(noisy_dataset) 1036
epoch [43/200] batch [5/18] time 0.191 (0.184) data 0.114 (0.107) loss_x loss_x 0.9224 (0.7167) acc_x 81.2500 (80.6250) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [10/18] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 1.0693 (0.7617) acc_x 78.1250 (80.6250) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [15/18] time 0.180 (0.179) data 0.104 (0.103) loss_x loss_x 0.6997 (0.7751) acc_x 87.5000 (81.0417) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/32] time 0.183 (0.180) data 0.106 (0.104) loss_u loss_u 0.9204 (0.8778) acc_u 9.3750 (14.3750) lr 1.7997e-03 eta 0:00:04
epoch [43/200] batch [10/32] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8911 (0.8733) acc_u 12.5000 (14.3750) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [15/32] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.8252 (0.8808) acc_u 21.8750 (13.9583) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [20/32] time 0.183 (0.181) data 0.107 (0.104) loss_u loss_u 0.8672 (0.8848) acc_u 15.6250 (13.5938) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [25/32] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9082 (0.8888) acc_u 9.3750 (12.8750) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [30/32] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.8428 (0.8879) acc_u 15.6250 (12.8125) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 597
confident_label rate tensor(0.3595, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 581
clean true:552
clean false:29
clean_rate:0.9500860585197934
noisy true:467
noisy false:568
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1035
epoch [44/200] batch [5/18] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.9956 (0.7820) acc_x 84.3750 (85.0000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [10/18] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.3975 (0.7733) acc_x 87.5000 (82.5000) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [15/18] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 1.1182 (0.8140) acc_x 75.0000 (80.8333) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/32] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.8735 (0.8858) acc_u 12.5000 (11.8750) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [10/32] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.8892 (0.8827) acc_u 12.5000 (12.8125) lr 1.7902e-03 eta 0:00:04
epoch [44/200] batch [15/32] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.8203 (0.8608) acc_u 18.7500 (15.4167) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [20/32] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9473 (0.8758) acc_u 6.2500 (13.9062) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [25/32] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9106 (0.8771) acc_u 6.2500 (13.6250) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [30/32] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.9639 (0.8876) acc_u 6.2500 (12.5000) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.3533, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 571
clean true:539
clean false:32
clean_rate:0.9439579684763573
noisy true:471
noisy false:574
after delete: len(clean_dataset) 571
after delete: len(noisy_dataset) 1045
epoch [45/200] batch [5/17] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.6875 (0.6966) acc_x 87.5000 (86.8750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [10/17] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.6704 (0.6732) acc_x 81.2500 (85.6250) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [15/17] time 0.186 (0.183) data 0.109 (0.107) loss_x loss_x 0.9658 (0.6994) acc_x 71.8750 (83.9583) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/32] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8813 (0.8835) acc_u 15.6250 (14.3750) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/32] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.8193 (0.8875) acc_u 25.0000 (13.4375) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [15/32] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.7866 (0.8829) acc_u 25.0000 (14.1667) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [20/32] time 0.166 (0.182) data 0.089 (0.105) loss_u loss_u 0.8916 (0.8851) acc_u 12.5000 (13.2812) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [25/32] time 0.191 (0.182) data 0.114 (0.105) loss_u loss_u 0.9312 (0.8904) acc_u 6.2500 (12.6250) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [30/32] time 0.206 (0.182) data 0.129 (0.105) loss_u loss_u 0.9053 (0.8889) acc_u 9.3750 (12.8125) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 569
confident_label rate tensor(0.3725, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 602
clean true:570
clean false:32
clean_rate:0.946843853820598
noisy true:477
noisy false:537
after delete: len(clean_dataset) 602
after delete: len(noisy_dataset) 1014
epoch [46/200] batch [5/18] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.6294 (0.6865) acc_x 84.3750 (81.8750) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [10/18] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.7568 (0.8145) acc_x 81.2500 (79.0625) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [15/18] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7568 (0.8124) acc_x 81.2500 (78.9583) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/31] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8496 (0.8587) acc_u 15.6250 (16.8750) lr 1.7705e-03 eta 0:00:04
epoch [46/200] batch [10/31] time 0.175 (0.183) data 0.098 (0.106) loss_u loss_u 0.9268 (0.8775) acc_u 12.5000 (14.6875) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [15/31] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.9326 (0.8907) acc_u 6.2500 (12.5000) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/31] time 0.170 (0.180) data 0.093 (0.103) loss_u loss_u 0.8726 (0.8937) acc_u 12.5000 (12.0312) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [25/31] time 0.184 (0.180) data 0.105 (0.103) loss_u loss_u 0.8672 (0.8922) acc_u 15.6250 (12.3750) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [30/31] time 0.163 (0.178) data 0.086 (0.101) loss_u loss_u 0.8618 (0.8944) acc_u 15.6250 (12.1875) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 593
confident_label rate tensor(0.3682, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 595
clean true:561
clean false:34
clean_rate:0.9428571428571428
noisy true:462
noisy false:559
after delete: len(clean_dataset) 595
after delete: len(noisy_dataset) 1021
epoch [47/200] batch [5/18] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.9048 (0.7896) acc_x 62.5000 (74.3750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/18] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.7900 (0.7952) acc_x 71.8750 (75.6250) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [15/18] time 0.161 (0.180) data 0.084 (0.103) loss_x loss_x 1.0361 (0.7484) acc_x 68.7500 (77.2917) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/31] time 0.172 (0.181) data 0.096 (0.104) loss_u loss_u 0.9253 (0.9116) acc_u 6.2500 (10.0000) lr 1.7604e-03 eta 0:00:04
epoch [47/200] batch [10/31] time 0.176 (0.180) data 0.099 (0.103) loss_u loss_u 0.8906 (0.9050) acc_u 9.3750 (9.6875) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [15/31] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.8945 (0.9041) acc_u 9.3750 (10.2083) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/31] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8804 (0.8983) acc_u 15.6250 (11.2500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [25/31] time 0.180 (0.180) data 0.104 (0.103) loss_u loss_u 0.9077 (0.8989) acc_u 12.5000 (11.2500) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [30/31] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.9561 (0.8988) acc_u 6.2500 (11.3542) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3645, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 589
clean true:561
clean false:28
clean_rate:0.9524617996604414
noisy true:483
noisy false:544
after delete: len(clean_dataset) 589
after delete: len(noisy_dataset) 1027
epoch [48/200] batch [5/18] time 0.186 (0.185) data 0.109 (0.108) loss_x loss_x 0.8589 (0.6174) acc_x 68.7500 (81.2500) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [10/18] time 0.173 (0.176) data 0.096 (0.100) loss_x loss_x 0.6816 (0.6756) acc_x 81.2500 (81.5625) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [15/18] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.7241 (0.7722) acc_x 78.1250 (78.9583) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/32] time 0.162 (0.170) data 0.084 (0.094) loss_u loss_u 0.9292 (0.8833) acc_u 12.5000 (13.1250) lr 1.7501e-03 eta 0:00:04
epoch [48/200] batch [10/32] time 0.185 (0.170) data 0.107 (0.093) loss_u loss_u 0.9351 (0.8913) acc_u 6.2500 (11.8750) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [15/32] time 0.185 (0.172) data 0.107 (0.095) loss_u loss_u 0.9097 (0.9026) acc_u 12.5000 (10.6250) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [20/32] time 0.182 (0.173) data 0.106 (0.096) loss_u loss_u 0.8965 (0.8918) acc_u 15.6250 (12.0312) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [25/32] time 0.160 (0.173) data 0.084 (0.096) loss_u loss_u 0.9224 (0.8969) acc_u 9.3750 (11.5000) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [30/32] time 0.160 (0.172) data 0.083 (0.095) loss_u loss_u 0.9136 (0.8961) acc_u 9.3750 (11.3542) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 572
confident_label rate tensor(0.3639, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 588
clean true:562
clean false:26
clean_rate:0.95578231292517
noisy true:482
noisy false:546
after delete: len(clean_dataset) 588
after delete: len(noisy_dataset) 1028
epoch [49/200] batch [5/18] time 0.191 (0.174) data 0.114 (0.096) loss_x loss_x 0.1975 (0.5654) acc_x 100.0000 (85.6250) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [10/18] time 0.173 (0.173) data 0.095 (0.096) loss_x loss_x 0.8066 (0.6693) acc_x 71.8750 (82.8125) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [15/18] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.6455 (0.6871) acc_x 87.5000 (82.2917) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/32] time 0.174 (0.178) data 0.096 (0.101) loss_u loss_u 0.8667 (0.8875) acc_u 15.6250 (11.8750) lr 1.7396e-03 eta 0:00:04
epoch [49/200] batch [10/32] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.8970 (0.8971) acc_u 12.5000 (11.2500) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [15/32] time 0.161 (0.179) data 0.084 (0.102) loss_u loss_u 0.9062 (0.8883) acc_u 9.3750 (13.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [20/32] time 0.188 (0.180) data 0.110 (0.103) loss_u loss_u 0.8838 (0.8865) acc_u 18.7500 (13.7500) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [25/32] time 0.183 (0.181) data 0.105 (0.103) loss_u loss_u 0.9160 (0.8850) acc_u 9.3750 (13.8750) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [30/32] time 0.170 (0.180) data 0.093 (0.102) loss_u loss_u 0.9531 (0.8939) acc_u 6.2500 (12.7083) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 585
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:570
clean false:39
clean_rate:0.9359605911330049
noisy true:461
noisy false:546
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [50/200] batch [5/19] time 0.181 (0.183) data 0.104 (0.107) loss_x loss_x 0.6714 (0.6948) acc_x 81.2500 (83.1250) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [10/19] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.8921 (0.7775) acc_x 81.2500 (80.9375) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [15/19] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.6230 (0.7613) acc_x 81.2500 (81.0417) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/31] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.7910 (0.9070) acc_u 25.0000 (10.6250) lr 1.7290e-03 eta 0:00:04
epoch [50/200] batch [10/31] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.8467 (0.8951) acc_u 18.7500 (12.8125) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [15/31] time 0.184 (0.184) data 0.107 (0.106) loss_u loss_u 0.9395 (0.8998) acc_u 9.3750 (12.5000) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [20/31] time 0.189 (0.184) data 0.112 (0.107) loss_u loss_u 0.9507 (0.8967) acc_u 3.1250 (12.1875) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [25/31] time 0.205 (0.185) data 0.128 (0.107) loss_u loss_u 0.8569 (0.8948) acc_u 15.6250 (12.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [30/31] time 0.183 (0.186) data 0.106 (0.108) loss_u loss_u 0.9248 (0.8965) acc_u 6.2500 (12.1875) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 611
confident_label rate tensor(0.3620, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 585
clean true:547
clean false:38
clean_rate:0.935042735042735
noisy true:458
noisy false:573
after delete: len(clean_dataset) 585
after delete: len(noisy_dataset) 1031
epoch [51/200] batch [5/18] time 0.184 (0.168) data 0.107 (0.091) loss_x loss_x 0.5527 (0.7389) acc_x 84.3750 (80.6250) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [10/18] time 0.161 (0.168) data 0.084 (0.092) loss_x loss_x 0.9419 (0.7763) acc_x 68.7500 (80.9375) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [15/18] time 0.184 (0.171) data 0.108 (0.095) loss_x loss_x 0.5972 (0.7232) acc_x 87.5000 (81.6667) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/32] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.8730 (0.8604) acc_u 12.5000 (16.2500) lr 1.7181e-03 eta 0:00:04
epoch [51/200] batch [10/32] time 0.184 (0.176) data 0.107 (0.100) loss_u loss_u 0.9126 (0.8750) acc_u 6.2500 (14.3750) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [15/32] time 0.183 (0.177) data 0.106 (0.101) loss_u loss_u 0.9077 (0.8788) acc_u 12.5000 (14.7917) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [20/32] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9546 (0.8877) acc_u 6.2500 (13.5938) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [25/32] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.8560 (0.8873) acc_u 18.7500 (13.6250) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [30/32] time 0.181 (0.179) data 0.105 (0.102) loss_u loss_u 0.8691 (0.8864) acc_u 18.7500 (13.8542) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.3651, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 590
clean true:558
clean false:32
clean_rate:0.9457627118644067
noisy true:460
noisy false:566
after delete: len(clean_dataset) 590
after delete: len(noisy_dataset) 1026
epoch [52/200] batch [5/18] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7886 (0.7887) acc_x 87.5000 (83.1250) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [10/18] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 0.8340 (0.8383) acc_x 87.5000 (81.5625) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [15/18] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 0.6919 (0.8076) acc_x 71.8750 (79.7917) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/32] time 0.207 (0.184) data 0.130 (0.107) loss_u loss_u 0.9395 (0.9097) acc_u 3.1250 (9.3750) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [10/32] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9165 (0.9076) acc_u 6.2500 (9.6875) lr 1.7071e-03 eta 0:00:04
epoch [52/200] batch [15/32] time 0.187 (0.183) data 0.110 (0.106) loss_u loss_u 0.8525 (0.8973) acc_u 18.7500 (11.4583) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [20/32] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9014 (0.8843) acc_u 9.3750 (12.9688) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [25/32] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.9580 (0.8905) acc_u 3.1250 (12.0000) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [30/32] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8682 (0.8897) acc_u 12.5000 (11.9792) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 599
confident_label rate tensor(0.3595, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 581
clean true:551
clean false:30
clean_rate:0.9483648881239243
noisy true:466
noisy false:569
after delete: len(clean_dataset) 581
after delete: len(noisy_dataset) 1035
epoch [53/200] batch [5/18] time 0.161 (0.162) data 0.084 (0.085) loss_x loss_x 0.5615 (0.7472) acc_x 87.5000 (80.6250) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/18] time 0.184 (0.168) data 0.107 (0.091) loss_x loss_x 0.8906 (0.7694) acc_x 78.1250 (80.3125) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [15/18] time 0.171 (0.172) data 0.095 (0.095) loss_x loss_x 0.9551 (0.7628) acc_x 78.1250 (81.0417) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/32] time 0.194 (0.177) data 0.117 (0.100) loss_u loss_u 0.9316 (0.8661) acc_u 3.1250 (14.3750) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/32] time 0.184 (0.178) data 0.107 (0.102) loss_u loss_u 0.9023 (0.8885) acc_u 12.5000 (12.8125) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/32] time 0.171 (0.178) data 0.094 (0.101) loss_u loss_u 0.8589 (0.8841) acc_u 18.7500 (13.7500) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [20/32] time 0.183 (0.177) data 0.107 (0.101) loss_u loss_u 0.9053 (0.8829) acc_u 12.5000 (13.7500) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [25/32] time 0.181 (0.178) data 0.104 (0.102) loss_u loss_u 0.8970 (0.8804) acc_u 12.5000 (14.0000) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [30/32] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.9263 (0.8766) acc_u 6.2500 (14.5833) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 603
confident_label rate tensor(0.3688, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 596
clean true:556
clean false:40
clean_rate:0.9328859060402684
noisy true:457
noisy false:563
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1020
epoch [54/200] batch [5/18] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.9131 (0.7382) acc_x 81.2500 (80.0000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [10/18] time 0.181 (0.182) data 0.104 (0.106) loss_x loss_x 1.4512 (0.8577) acc_x 68.7500 (80.0000) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [15/18] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 1.1494 (0.8818) acc_x 71.8750 (78.7500) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/31] time 0.169 (0.181) data 0.092 (0.105) loss_u loss_u 0.8857 (0.8708) acc_u 12.5000 (17.5000) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/31] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.9106 (0.8865) acc_u 12.5000 (14.3750) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/31] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9019 (0.8906) acc_u 9.3750 (13.9583) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/31] time 0.184 (0.180) data 0.108 (0.103) loss_u loss_u 0.9155 (0.8891) acc_u 9.3750 (13.7500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [25/31] time 0.185 (0.180) data 0.108 (0.104) loss_u loss_u 0.8135 (0.8845) acc_u 18.7500 (14.0000) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [30/31] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.9512 (0.8859) acc_u 6.2500 (13.6458) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 589
confident_label rate tensor(0.3663, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 592
clean true:557
clean false:35
clean_rate:0.9408783783783784
noisy true:470
noisy false:554
after delete: len(clean_dataset) 592
after delete: len(noisy_dataset) 1024
epoch [55/200] batch [5/18] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.7725 (0.6702) acc_x 78.1250 (78.1250) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/18] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.6748 (0.7456) acc_x 81.2500 (78.4375) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [15/18] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.7471 (0.7669) acc_x 78.1250 (78.5417) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/32] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9033 (0.8813) acc_u 9.3750 (14.3750) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [10/32] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.8838 (0.8775) acc_u 15.6250 (14.3750) lr 1.6730e-03 eta 0:00:04
epoch [55/200] batch [15/32] time 0.192 (0.184) data 0.114 (0.107) loss_u loss_u 0.9072 (0.8829) acc_u 12.5000 (14.3750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [20/32] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.8950 (0.8814) acc_u 15.6250 (14.6875) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [25/32] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.7935 (0.8764) acc_u 21.8750 (15.0000) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [30/32] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9087 (0.8782) acc_u 12.5000 (14.8958) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 575
confident_label rate tensor(0.3886, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 628
clean true:582
clean false:46
clean_rate:0.9267515923566879
noisy true:459
noisy false:529
after delete: len(clean_dataset) 628
after delete: len(noisy_dataset) 988
epoch [56/200] batch [5/19] time 0.200 (0.185) data 0.123 (0.109) loss_x loss_x 0.7979 (0.5928) acc_x 71.8750 (83.1250) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [10/19] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5640 (0.6730) acc_x 90.6250 (82.8125) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [15/19] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.4309 (0.7442) acc_x 87.5000 (80.8333) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/30] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9038 (0.8992) acc_u 15.6250 (12.5000) lr 1.6613e-03 eta 0:00:04
epoch [56/200] batch [10/30] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8677 (0.8867) acc_u 15.6250 (12.8125) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [15/30] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.9116 (0.9015) acc_u 12.5000 (11.0417) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/30] time 0.169 (0.181) data 0.092 (0.105) loss_u loss_u 0.8813 (0.8995) acc_u 15.6250 (11.2500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [25/30] time 0.177 (0.181) data 0.099 (0.104) loss_u loss_u 0.9590 (0.8991) acc_u 6.2500 (11.3750) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [30/30] time 0.189 (0.181) data 0.112 (0.104) loss_u loss_u 0.9365 (0.9049) acc_u 6.2500 (10.6250) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.3608, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 583
clean true:552
clean false:31
clean_rate:0.9468267581475128
noisy true:462
noisy false:571
after delete: len(clean_dataset) 583
after delete: len(noisy_dataset) 1033
epoch [57/200] batch [5/18] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.5928 (0.6541) acc_x 84.3750 (81.2500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [10/18] time 0.166 (0.182) data 0.089 (0.105) loss_x loss_x 0.4856 (0.7378) acc_x 93.7500 (81.2500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [15/18] time 0.184 (0.181) data 0.107 (0.104) loss_x loss_x 0.7827 (0.8102) acc_x 81.2500 (79.7917) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/32] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.9155 (0.8695) acc_u 9.3750 (15.6250) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [10/32] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8643 (0.8808) acc_u 15.6250 (14.0625) lr 1.6494e-03 eta 0:00:04
epoch [57/200] batch [15/32] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.8818 (0.8764) acc_u 18.7500 (14.5833) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [20/32] time 0.174 (0.181) data 0.097 (0.104) loss_u loss_u 0.8560 (0.8699) acc_u 15.6250 (15.1562) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [25/32] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.9448 (0.8806) acc_u 6.2500 (14.1250) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [30/32] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8774 (0.8795) acc_u 15.6250 (14.3750) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 574
confident_label rate tensor(0.3676, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 594
clean true:567
clean false:27
clean_rate:0.9545454545454546
noisy true:475
noisy false:547
after delete: len(clean_dataset) 594
after delete: len(noisy_dataset) 1022
epoch [58/200] batch [5/18] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.5991 (0.5511) acc_x 87.5000 (88.1250) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [10/18] time 0.180 (0.183) data 0.104 (0.106) loss_x loss_x 0.8257 (0.6595) acc_x 81.2500 (85.0000) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [15/18] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.7461 (0.6781) acc_x 78.1250 (83.3333) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/31] time 0.177 (0.185) data 0.100 (0.108) loss_u loss_u 0.9604 (0.9097) acc_u 6.2500 (11.2500) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/31] time 0.176 (0.184) data 0.098 (0.107) loss_u loss_u 0.8818 (0.8972) acc_u 18.7500 (13.1250) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/31] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8579 (0.8935) acc_u 15.6250 (13.1250) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [20/31] time 0.186 (0.183) data 0.109 (0.105) loss_u loss_u 0.9722 (0.8917) acc_u 6.2500 (13.5938) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [25/31] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.9336 (0.8870) acc_u 9.3750 (14.2500) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [30/31] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9277 (0.8863) acc_u 9.3750 (14.2708) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 578
confident_label rate tensor(0.3781, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 611
clean true:567
clean false:44
clean_rate:0.9279869067103109
noisy true:471
noisy false:534
after delete: len(clean_dataset) 611
after delete: len(noisy_dataset) 1005
epoch [59/200] batch [5/19] time 0.159 (0.171) data 0.083 (0.095) loss_x loss_x 1.1943 (0.8905) acc_x 71.8750 (77.5000) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/19] time 0.161 (0.165) data 0.085 (0.089) loss_x loss_x 1.0703 (0.8027) acc_x 75.0000 (79.6875) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [15/19] time 0.175 (0.170) data 0.098 (0.093) loss_x loss_x 0.8296 (0.8547) acc_x 78.1250 (78.5417) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/31] time 0.190 (0.175) data 0.113 (0.099) loss_u loss_u 0.9062 (0.8903) acc_u 15.6250 (14.3750) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [10/31] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.8403 (0.8923) acc_u 18.7500 (13.4375) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/31] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.9380 (0.8880) acc_u 3.1250 (13.7500) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/31] time 0.190 (0.179) data 0.113 (0.102) loss_u loss_u 0.8936 (0.8880) acc_u 9.3750 (13.7500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [25/31] time 0.183 (0.179) data 0.106 (0.103) loss_u loss_u 0.8115 (0.8852) acc_u 18.7500 (13.7500) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [30/31] time 0.188 (0.180) data 0.110 (0.103) loss_u loss_u 0.9131 (0.8870) acc_u 9.3750 (13.5417) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 565
confident_label rate tensor(0.3762, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 608
clean true:572
clean false:36
clean_rate:0.9407894736842105
noisy true:479
noisy false:529
after delete: len(clean_dataset) 608
after delete: len(noisy_dataset) 1008
epoch [60/200] batch [5/19] time 0.180 (0.193) data 0.103 (0.116) loss_x loss_x 0.9961 (0.8563) acc_x 71.8750 (76.8750) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [10/19] time 0.176 (0.184) data 0.099 (0.107) loss_x loss_x 0.6621 (0.7955) acc_x 87.5000 (79.0625) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [15/19] time 0.197 (0.184) data 0.121 (0.108) loss_x loss_x 0.5151 (0.7616) acc_x 84.3750 (80.0000) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/31] time 0.178 (0.185) data 0.101 (0.109) loss_u loss_u 0.9380 (0.8892) acc_u 9.3750 (13.1250) lr 1.6129e-03 eta 0:00:04
epoch [60/200] batch [10/31] time 0.195 (0.186) data 0.118 (0.109) loss_u loss_u 0.9219 (0.9056) acc_u 12.5000 (10.6250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/31] time 0.183 (0.185) data 0.105 (0.108) loss_u loss_u 0.9175 (0.8990) acc_u 12.5000 (11.2500) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/31] time 0.166 (0.183) data 0.089 (0.106) loss_u loss_u 0.8267 (0.8952) acc_u 18.7500 (11.7188) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [25/31] time 0.173 (0.181) data 0.095 (0.104) loss_u loss_u 0.9233 (0.8911) acc_u 6.2500 (12.2500) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [30/31] time 0.160 (0.180) data 0.082 (0.103) loss_u loss_u 0.8730 (0.8904) acc_u 15.6250 (12.3958) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 542
confident_label rate tensor(0.3929, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 635
clean true:601
clean false:34
clean_rate:0.9464566929133859
noisy true:473
noisy false:508
after delete: len(clean_dataset) 635
after delete: len(noisy_dataset) 981
epoch [61/200] batch [5/19] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.7295 (0.8359) acc_x 84.3750 (77.5000) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [10/19] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.6309 (0.8097) acc_x 93.7500 (78.4375) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [15/19] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.9141 (0.8169) acc_x 71.8750 (79.1667) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/30] time 0.190 (0.183) data 0.114 (0.106) loss_u loss_u 0.8784 (0.9064) acc_u 12.5000 (11.2500) lr 1.6004e-03 eta 0:00:04
epoch [61/200] batch [10/30] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8672 (0.9008) acc_u 15.6250 (11.8750) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/30] time 0.170 (0.181) data 0.093 (0.104) loss_u loss_u 0.9033 (0.9074) acc_u 15.6250 (11.4583) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/30] time 0.185 (0.181) data 0.108 (0.105) loss_u loss_u 0.8657 (0.9100) acc_u 15.6250 (11.0938) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/30] time 0.169 (0.181) data 0.092 (0.104) loss_u loss_u 0.9185 (0.9158) acc_u 9.3750 (10.2500) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [30/30] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8945 (0.9076) acc_u 12.5000 (11.1458) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 577
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:571
clean false:38
clean_rate:0.9376026272577996
noisy true:468
noisy false:539
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [62/200] batch [5/19] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.8330 (0.7571) acc_x 78.1250 (79.3750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [10/19] time 0.208 (0.185) data 0.132 (0.108) loss_x loss_x 0.7168 (0.7650) acc_x 84.3750 (78.1250) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [15/19] time 0.182 (0.185) data 0.106 (0.109) loss_x loss_x 0.8154 (0.7314) acc_x 68.7500 (78.9583) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/31] time 0.183 (0.185) data 0.107 (0.108) loss_u loss_u 0.8857 (0.9006) acc_u 12.5000 (10.6250) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/31] time 0.181 (0.184) data 0.105 (0.108) loss_u loss_u 0.8447 (0.8836) acc_u 25.0000 (14.3750) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/31] time 0.183 (0.184) data 0.107 (0.108) loss_u loss_u 0.9067 (0.8844) acc_u 12.5000 (14.3750) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/31] time 0.182 (0.184) data 0.106 (0.108) loss_u loss_u 0.8760 (0.8879) acc_u 21.8750 (14.5312) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [25/31] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.8975 (0.8831) acc_u 12.5000 (14.8750) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [30/31] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.8730 (0.8876) acc_u 12.5000 (14.2708) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 557
confident_label rate tensor(0.3812, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 616
clean true:576
clean false:40
clean_rate:0.935064935064935
noisy true:483
noisy false:517
after delete: len(clean_dataset) 616
after delete: len(noisy_dataset) 1000
epoch [63/200] batch [5/19] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.9458 (0.7649) acc_x 78.1250 (81.2500) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [10/19] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.6265 (0.6971) acc_x 87.5000 (83.1250) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [15/19] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 1.0371 (0.7220) acc_x 78.1250 (82.5000) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/31] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9258 (0.9159) acc_u 9.3750 (10.6250) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/31] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8354 (0.8976) acc_u 18.7500 (12.1875) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/31] time 0.184 (0.184) data 0.108 (0.108) loss_u loss_u 0.8613 (0.8935) acc_u 12.5000 (12.5000) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/31] time 0.181 (0.184) data 0.105 (0.107) loss_u loss_u 0.8467 (0.8912) acc_u 12.5000 (12.1875) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [25/31] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.8335 (0.8853) acc_u 25.0000 (13.2500) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [30/31] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.8311 (0.8795) acc_u 18.7500 (14.2708) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3800, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 614
clean true:580
clean false:34
clean_rate:0.9446254071661238
noisy true:485
noisy false:517
after delete: len(clean_dataset) 614
after delete: len(noisy_dataset) 1002
epoch [64/200] batch [5/19] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.8364 (0.8082) acc_x 81.2500 (76.8750) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [10/19] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.4705 (0.7907) acc_x 84.3750 (78.1250) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [15/19] time 0.185 (0.178) data 0.108 (0.101) loss_x loss_x 0.5317 (0.7285) acc_x 87.5000 (80.6250) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/31] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8550 (0.8694) acc_u 18.7500 (17.5000) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/31] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9292 (0.9004) acc_u 9.3750 (12.8125) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/31] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9390 (0.8928) acc_u 6.2500 (13.1250) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/31] time 0.188 (0.183) data 0.111 (0.106) loss_u loss_u 0.8979 (0.9006) acc_u 9.3750 (11.7188) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [25/31] time 0.182 (0.183) data 0.106 (0.106) loss_u loss_u 0.9150 (0.9013) acc_u 6.2500 (11.5000) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [30/31] time 0.176 (0.183) data 0.099 (0.106) loss_u loss_u 0.9399 (0.8993) acc_u 3.1250 (11.7708) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 582
confident_label rate tensor(0.3899, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 630
clean true:590
clean false:40
clean_rate:0.9365079365079365
noisy true:444
noisy false:542
after delete: len(clean_dataset) 630
after delete: len(noisy_dataset) 986
epoch [65/200] batch [5/19] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.3977 (0.6822) acc_x 90.6250 (83.7500) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/19] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 0.6597 (0.6982) acc_x 75.0000 (80.9375) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/19] time 0.183 (0.184) data 0.106 (0.108) loss_x loss_x 0.7373 (0.7123) acc_x 68.7500 (78.1250) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/30] time 0.181 (0.183) data 0.104 (0.107) loss_u loss_u 0.7539 (0.8541) acc_u 25.0000 (15.0000) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/30] time 0.171 (0.182) data 0.093 (0.106) loss_u loss_u 0.9053 (0.8916) acc_u 9.3750 (11.2500) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/30] time 0.189 (0.183) data 0.112 (0.106) loss_u loss_u 0.8530 (0.8884) acc_u 18.7500 (11.8750) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/30] time 0.174 (0.181) data 0.096 (0.104) loss_u loss_u 0.9468 (0.8931) acc_u 6.2500 (11.7188) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [25/30] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9438 (0.8961) acc_u 3.1250 (11.3750) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [30/30] time 0.184 (0.181) data 0.106 (0.103) loss_u loss_u 0.9268 (0.9015) acc_u 6.2500 (10.9375) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 598
confident_label rate tensor(0.3769, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 609
clean true:563
clean false:46
clean_rate:0.9244663382594417
noisy true:455
noisy false:552
after delete: len(clean_dataset) 609
after delete: len(noisy_dataset) 1007
epoch [66/200] batch [5/19] time 0.181 (0.183) data 0.104 (0.105) loss_x loss_x 1.1553 (0.6393) acc_x 71.8750 (82.5000) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/19] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.7686 (0.6621) acc_x 78.1250 (81.2500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/19] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.7871 (0.7013) acc_x 78.1250 (80.6250) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/31] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.9097 (0.8648) acc_u 15.6250 (17.5000) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/31] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.8735 (0.8717) acc_u 12.5000 (16.5625) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/31] time 0.231 (0.184) data 0.154 (0.107) loss_u loss_u 0.8936 (0.8752) acc_u 12.5000 (16.2500) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/31] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8940 (0.8828) acc_u 12.5000 (14.8438) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [25/31] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8652 (0.8840) acc_u 15.6250 (14.6250) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [30/31] time 0.179 (0.184) data 0.102 (0.107) loss_u loss_u 0.8555 (0.8795) acc_u 15.6250 (14.5833) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 586
confident_label rate tensor(0.3688, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 596
clean true:555
clean false:41
clean_rate:0.9312080536912751
noisy true:475
noisy false:545
after delete: len(clean_dataset) 596
after delete: len(noisy_dataset) 1020
epoch [67/200] batch [5/18] time 0.183 (0.184) data 0.107 (0.107) loss_x loss_x 0.3311 (0.5536) acc_x 90.6250 (85.0000) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/18] time 0.170 (0.181) data 0.093 (0.105) loss_x loss_x 0.8994 (0.7050) acc_x 75.0000 (82.8125) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [15/18] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 0.6904 (0.7303) acc_x 84.3750 (82.0833) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/31] time 0.179 (0.182) data 0.102 (0.105) loss_u loss_u 0.9346 (0.9092) acc_u 9.3750 (11.8750) lr 1.5225e-03 eta 0:00:04
epoch [67/200] batch [10/31] time 0.181 (0.182) data 0.105 (0.105) loss_u loss_u 0.9419 (0.8827) acc_u 6.2500 (14.3750) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [15/31] time 0.163 (0.181) data 0.086 (0.104) loss_u loss_u 0.8345 (0.8959) acc_u 25.0000 (12.9167) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/31] time 0.182 (0.181) data 0.106 (0.104) loss_u loss_u 0.8120 (0.8905) acc_u 21.8750 (13.2812) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/31] time 0.187 (0.181) data 0.110 (0.105) loss_u loss_u 0.9399 (0.8865) acc_u 3.1250 (13.7500) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [30/31] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8511 (0.8830) acc_u 18.7500 (13.9583) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.3775, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 610
clean true:575
clean false:35
clean_rate:0.9426229508196722
noisy true:488
noisy false:518
after delete: len(clean_dataset) 610
after delete: len(noisy_dataset) 1006
epoch [68/200] batch [5/19] time 0.185 (0.183) data 0.109 (0.106) loss_x loss_x 0.6553 (0.8238) acc_x 81.2500 (75.6250) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [10/19] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.6694 (0.7182) acc_x 81.2500 (78.7500) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [15/19] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 1.1230 (0.6969) acc_x 68.7500 (79.7917) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/31] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9263 (0.8757) acc_u 9.3750 (14.3750) lr 1.5090e-03 eta 0:00:04
epoch [68/200] batch [10/31] time 0.183 (0.181) data 0.105 (0.105) loss_u loss_u 0.9932 (0.8977) acc_u 0.0000 (11.5625) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [15/31] time 0.192 (0.182) data 0.114 (0.105) loss_u loss_u 0.9658 (0.8942) acc_u 3.1250 (11.6667) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/31] time 0.190 (0.183) data 0.113 (0.106) loss_u loss_u 0.9180 (0.8956) acc_u 9.3750 (11.5625) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [25/31] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.9287 (0.8983) acc_u 9.3750 (11.2500) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [30/31] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.8516 (0.8933) acc_u 18.7500 (11.8750) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 546
confident_label rate tensor(0.3880, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 627
clean true:588
clean false:39
clean_rate:0.937799043062201
noisy true:482
noisy false:507
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 989
epoch [69/200] batch [5/19] time 0.168 (0.177) data 0.092 (0.100) loss_x loss_x 0.6870 (0.6794) acc_x 75.0000 (83.7500) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/19] time 0.182 (0.179) data 0.105 (0.103) loss_x loss_x 0.7754 (0.7135) acc_x 75.0000 (80.9375) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/19] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.7686 (0.7176) acc_x 78.1250 (81.0417) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/30] time 0.176 (0.179) data 0.099 (0.102) loss_u loss_u 0.9751 (0.9168) acc_u 3.1250 (10.0000) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/30] time 0.211 (0.181) data 0.134 (0.104) loss_u loss_u 0.9141 (0.9078) acc_u 6.2500 (10.3125) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/30] time 0.182 (0.181) data 0.105 (0.104) loss_u loss_u 0.9629 (0.9131) acc_u 3.1250 (9.5833) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/30] time 0.181 (0.181) data 0.105 (0.105) loss_u loss_u 0.9238 (0.9018) acc_u 12.5000 (11.4062) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/30] time 0.190 (0.182) data 0.114 (0.105) loss_u loss_u 0.9141 (0.8954) acc_u 9.3750 (12.0000) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [30/30] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.8994 (0.8928) acc_u 12.5000 (12.1875) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.3787, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 612
clean true:579
clean false:33
clean_rate:0.946078431372549
noisy true:477
noisy false:527
after delete: len(clean_dataset) 612
after delete: len(noisy_dataset) 1004
epoch [70/200] batch [5/19] time 0.182 (0.188) data 0.106 (0.111) loss_x loss_x 0.5962 (0.7252) acc_x 81.2500 (78.1250) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [10/19] time 0.162 (0.178) data 0.085 (0.101) loss_x loss_x 1.0283 (0.7778) acc_x 71.8750 (79.6875) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [15/19] time 0.171 (0.178) data 0.094 (0.101) loss_x loss_x 1.1621 (0.8136) acc_x 84.3750 (80.0000) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/31] time 0.185 (0.176) data 0.107 (0.099) loss_u loss_u 0.9141 (0.8591) acc_u 9.3750 (16.8750) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [10/31] time 0.177 (0.177) data 0.099 (0.100) loss_u loss_u 0.9326 (0.8645) acc_u 9.3750 (15.9375) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/31] time 0.183 (0.178) data 0.106 (0.100) loss_u loss_u 0.8848 (0.8872) acc_u 12.5000 (12.9167) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/31] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9321 (0.8821) acc_u 9.3750 (13.2812) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [25/31] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.9160 (0.8840) acc_u 12.5000 (13.3750) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [30/31] time 0.185 (0.180) data 0.108 (0.102) loss_u loss_u 0.8579 (0.8823) acc_u 15.6250 (13.6458) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.3880, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 627
clean true:598
clean false:29
clean_rate:0.9537480063795853
noisy true:482
noisy false:507
after delete: len(clean_dataset) 627
after delete: len(noisy_dataset) 989
epoch [71/200] batch [5/19] time 0.168 (0.171) data 0.091 (0.094) loss_x loss_x 1.1621 (0.6338) acc_x 78.1250 (86.8750) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/19] time 0.173 (0.170) data 0.096 (0.093) loss_x loss_x 0.5356 (0.6082) acc_x 84.3750 (86.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [15/19] time 0.183 (0.173) data 0.107 (0.096) loss_x loss_x 0.3694 (0.6095) acc_x 90.6250 (85.8333) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/30] time 0.175 (0.176) data 0.098 (0.099) loss_u loss_u 0.8936 (0.8965) acc_u 12.5000 (13.7500) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/30] time 0.182 (0.177) data 0.105 (0.099) loss_u loss_u 0.9351 (0.9045) acc_u 6.2500 (11.5625) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/30] time 0.164 (0.178) data 0.088 (0.100) loss_u loss_u 0.9194 (0.9082) acc_u 9.3750 (11.2500) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/30] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.9023 (0.9032) acc_u 12.5000 (11.8750) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/30] time 0.170 (0.177) data 0.092 (0.100) loss_u loss_u 0.8481 (0.8974) acc_u 18.7500 (12.5000) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [30/30] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.9565 (0.8945) acc_u 3.1250 (12.5000) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 563
confident_label rate tensor(0.3911, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 632
clean true:593
clean false:39
clean_rate:0.9382911392405063
noisy true:460
noisy false:524
after delete: len(clean_dataset) 632
after delete: len(noisy_dataset) 984
epoch [72/200] batch [5/19] time 0.175 (0.176) data 0.098 (0.099) loss_x loss_x 0.9087 (0.8896) acc_x 78.1250 (80.6250) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [10/19] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.6294 (0.8466) acc_x 84.3750 (80.0000) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [15/19] time 0.182 (0.179) data 0.106 (0.102) loss_x loss_x 0.7886 (0.7780) acc_x 78.1250 (81.4583) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/30] time 0.171 (0.176) data 0.093 (0.099) loss_u loss_u 0.9658 (0.9318) acc_u 3.1250 (9.3750) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [10/30] time 0.158 (0.175) data 0.081 (0.098) loss_u loss_u 0.8916 (0.8959) acc_u 15.6250 (13.7500) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [15/30] time 0.186 (0.176) data 0.109 (0.099) loss_u loss_u 0.9253 (0.8901) acc_u 9.3750 (14.1667) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/30] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8462 (0.8906) acc_u 18.7500 (13.7500) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/30] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.9395 (0.8921) acc_u 6.2500 (13.3750) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [30/30] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8364 (0.8949) acc_u 18.7500 (12.7083) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.4016, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 649
clean true:611
clean false:38
clean_rate:0.9414483821263482
noisy true:487
noisy false:480
after delete: len(clean_dataset) 649
after delete: len(noisy_dataset) 967
epoch [73/200] batch [5/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.5898 (0.8066) acc_x 81.2500 (78.1250) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [10/20] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.3999 (0.7001) acc_x 84.3750 (81.5625) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [15/20] time 0.163 (0.181) data 0.086 (0.104) loss_x loss_x 0.5415 (0.6746) acc_x 87.5000 (83.1250) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [20/20] time 0.186 (0.182) data 0.109 (0.106) loss_x loss_x 1.0078 (0.6874) acc_x 65.6250 (82.3438) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/30] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8774 (0.8858) acc_u 18.7500 (13.7500) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [10/30] time 0.186 (0.182) data 0.109 (0.105) loss_u loss_u 0.8540 (0.8848) acc_u 15.6250 (13.1250) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/30] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8970 (0.9049) acc_u 12.5000 (10.4167) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [20/30] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.7939 (0.9000) acc_u 21.8750 (11.0938) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [25/30] time 0.177 (0.182) data 0.100 (0.105) loss_u loss_u 0.8477 (0.8972) acc_u 18.7500 (11.5000) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [30/30] time 0.178 (0.181) data 0.101 (0.104) loss_u loss_u 0.8940 (0.8955) acc_u 12.5000 (11.9792) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.3874, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 626
clean true:582
clean false:44
clean_rate:0.9297124600638977
noisy true:481
noisy false:509
after delete: len(clean_dataset) 626
after delete: len(noisy_dataset) 990
epoch [74/200] batch [5/19] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.6440 (0.7476) acc_x 87.5000 (82.5000) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [10/19] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.6084 (0.6417) acc_x 87.5000 (84.3750) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [15/19] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 1.2158 (0.6840) acc_x 62.5000 (81.6667) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/30] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8755 (0.8998) acc_u 12.5000 (10.0000) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/30] time 0.190 (0.183) data 0.113 (0.106) loss_u loss_u 0.9409 (0.8995) acc_u 6.2500 (10.3125) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [15/30] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.7808 (0.8926) acc_u 31.2500 (11.8750) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [20/30] time 0.169 (0.181) data 0.093 (0.105) loss_u loss_u 0.9419 (0.8982) acc_u 6.2500 (11.2500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [25/30] time 0.184 (0.181) data 0.106 (0.105) loss_u loss_u 0.9731 (0.8917) acc_u 3.1250 (12.1250) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [30/30] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.8525 (0.8861) acc_u 18.7500 (13.0208) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.3973, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 642
clean true:603
clean false:39
clean_rate:0.9392523364485982
noisy true:481
noisy false:493
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 974
epoch [75/200] batch [5/20] time 0.158 (0.178) data 0.081 (0.102) loss_x loss_x 0.7988 (0.6365) acc_x 81.2500 (84.3750) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [10/20] time 0.172 (0.178) data 0.095 (0.102) loss_x loss_x 0.8530 (0.7740) acc_x 84.3750 (82.1875) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [15/20] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.4453 (0.7111) acc_x 87.5000 (82.5000) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [20/20] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 0.6694 (0.6999) acc_x 81.2500 (81.8750) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/30] time 0.165 (0.176) data 0.088 (0.099) loss_u loss_u 0.9131 (0.9275) acc_u 9.3750 (8.7500) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/30] time 0.174 (0.175) data 0.097 (0.099) loss_u loss_u 0.8779 (0.9060) acc_u 15.6250 (11.2500) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/30] time 0.180 (0.176) data 0.103 (0.099) loss_u loss_u 0.9351 (0.9045) acc_u 9.3750 (11.2500) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [20/30] time 0.183 (0.176) data 0.106 (0.100) loss_u loss_u 0.9058 (0.9063) acc_u 9.3750 (10.6250) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [25/30] time 0.183 (0.177) data 0.107 (0.101) loss_u loss_u 0.9214 (0.8951) acc_u 9.3750 (12.0000) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [30/30] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.8867 (0.8957) acc_u 15.6250 (11.9792) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.3830, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 619
clean true:590
clean false:29
clean_rate:0.9531502423263328
noisy true:494
noisy false:503
after delete: len(clean_dataset) 619
after delete: len(noisy_dataset) 997
epoch [76/200] batch [5/19] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.3308 (0.7157) acc_x 90.6250 (81.8750) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [10/19] time 0.180 (0.181) data 0.104 (0.105) loss_x loss_x 0.7803 (0.7316) acc_x 81.2500 (81.5625) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [15/19] time 0.182 (0.182) data 0.104 (0.105) loss_x loss_x 0.4758 (0.7003) acc_x 90.6250 (82.2917) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/31] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.9170 (0.8808) acc_u 9.3750 (14.3750) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/31] time 0.162 (0.181) data 0.085 (0.104) loss_u loss_u 0.8306 (0.8671) acc_u 18.7500 (15.6250) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/31] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.8555 (0.8661) acc_u 15.6250 (15.8333) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [20/31] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8979 (0.8737) acc_u 12.5000 (15.1562) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [25/31] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8862 (0.8754) acc_u 9.3750 (14.7500) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [30/31] time 0.188 (0.182) data 0.111 (0.105) loss_u loss_u 0.9551 (0.8814) acc_u 3.1250 (13.8542) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.3818, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 617
clean true:581
clean false:36
clean_rate:0.9416531604538088
noisy true:484
noisy false:515
after delete: len(clean_dataset) 617
after delete: len(noisy_dataset) 999
epoch [77/200] batch [5/19] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.5791 (0.6826) acc_x 87.5000 (81.2500) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [10/19] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.6729 (0.7076) acc_x 84.3750 (80.9375) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [15/19] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.3965 (0.6312) acc_x 87.5000 (82.9167) lr 1.3827e-03 eta 0:00:00
epoch [77/200] batch [5/31] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8779 (0.9281) acc_u 12.5000 (8.1250) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [10/31] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.9082 (0.8984) acc_u 12.5000 (11.8750) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/31] time 0.187 (0.183) data 0.109 (0.106) loss_u loss_u 0.9194 (0.8913) acc_u 12.5000 (12.9167) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [20/31] time 0.181 (0.183) data 0.105 (0.106) loss_u loss_u 0.9600 (0.8917) acc_u 3.1250 (12.6562) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/31] time 0.184 (0.183) data 0.106 (0.106) loss_u loss_u 0.8354 (0.8834) acc_u 18.7500 (13.5000) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [30/31] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.7993 (0.8824) acc_u 21.8750 (13.4375) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 546
confident_label rate tensor(0.3954, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 639
clean true:600
clean false:39
clean_rate:0.9389671361502347
noisy true:470
noisy false:507
after delete: len(clean_dataset) 639
after delete: len(noisy_dataset) 977
epoch [78/200] batch [5/19] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.6089 (0.6816) acc_x 78.1250 (81.2500) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [10/19] time 0.182 (0.181) data 0.106 (0.105) loss_x loss_x 0.3779 (0.6310) acc_x 93.7500 (82.5000) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [15/19] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 1.3652 (0.7368) acc_x 65.6250 (80.0000) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [5/30] time 0.187 (0.182) data 0.109 (0.106) loss_u loss_u 0.9102 (0.8940) acc_u 12.5000 (13.1250) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [10/30] time 0.185 (0.182) data 0.108 (0.106) loss_u loss_u 0.8022 (0.8653) acc_u 21.8750 (16.2500) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [15/30] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8486 (0.8637) acc_u 18.7500 (16.8750) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [20/30] time 0.169 (0.182) data 0.091 (0.105) loss_u loss_u 0.8975 (0.8720) acc_u 15.6250 (15.9375) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [25/30] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8994 (0.8839) acc_u 12.5000 (14.2500) lr 1.3681e-03 eta 0:00:00
epoch [78/200] batch [30/30] time 0.167 (0.180) data 0.089 (0.103) loss_u loss_u 0.9731 (0.8864) acc_u 6.2500 (13.9583) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 553
confident_label rate tensor(0.3892, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 629
clean true:594
clean false:35
clean_rate:0.9443561208267091
noisy true:469
noisy false:518
after delete: len(clean_dataset) 629
after delete: len(noisy_dataset) 987
epoch [79/200] batch [5/19] time 0.176 (0.194) data 0.099 (0.118) loss_x loss_x 0.5117 (0.7558) acc_x 84.3750 (82.5000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [10/19] time 0.181 (0.185) data 0.103 (0.109) loss_x loss_x 0.3027 (0.7115) acc_x 87.5000 (82.5000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [15/19] time 0.178 (0.180) data 0.101 (0.104) loss_x loss_x 0.7441 (0.6755) acc_x 75.0000 (82.9167) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [5/30] time 0.159 (0.175) data 0.083 (0.098) loss_u loss_u 0.9263 (0.8708) acc_u 6.2500 (15.6250) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/30] time 0.184 (0.176) data 0.106 (0.100) loss_u loss_u 0.8154 (0.8580) acc_u 21.8750 (16.8750) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [15/30] time 0.185 (0.177) data 0.108 (0.101) loss_u loss_u 0.8838 (0.8695) acc_u 12.5000 (15.0000) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [20/30] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9102 (0.8878) acc_u 9.3750 (12.6562) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [25/30] time 0.186 (0.179) data 0.108 (0.102) loss_u loss_u 0.8350 (0.8932) acc_u 18.7500 (12.1250) lr 1.3535e-03 eta 0:00:00
epoch [79/200] batch [30/30] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8989 (0.8914) acc_u 9.3750 (12.1875) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 540
confident_label rate tensor(0.3843, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 621
clean true:580
clean false:41
clean_rate:0.9339774557165862
noisy true:496
noisy false:499
after delete: len(clean_dataset) 621
after delete: len(noisy_dataset) 995
epoch [80/200] batch [5/19] time 0.159 (0.176) data 0.082 (0.100) loss_x loss_x 1.0400 (0.8117) acc_x 65.6250 (76.8750) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [10/19] time 0.184 (0.180) data 0.107 (0.104) loss_x loss_x 0.4258 (0.6513) acc_x 87.5000 (82.8125) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [15/19] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 1.3242 (0.7084) acc_x 68.7500 (82.0833) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/31] time 0.170 (0.182) data 0.092 (0.106) loss_u loss_u 0.8188 (0.8701) acc_u 21.8750 (16.8750) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/31] time 0.184 (0.181) data 0.107 (0.104) loss_u loss_u 0.8867 (0.8816) acc_u 15.6250 (15.3125) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [15/31] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9243 (0.8796) acc_u 9.3750 (15.8333) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [20/31] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.9160 (0.8737) acc_u 9.3750 (15.7812) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/31] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8525 (0.8723) acc_u 18.7500 (15.7500) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [30/31] time 0.162 (0.181) data 0.084 (0.104) loss_u loss_u 0.8237 (0.8750) acc_u 21.8750 (15.5208) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.4010, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 648
clean true:608
clean false:40
clean_rate:0.9382716049382716
noisy true:473
noisy false:495
after delete: len(clean_dataset) 648
after delete: len(noisy_dataset) 968
epoch [81/200] batch [5/20] time 0.173 (0.169) data 0.096 (0.092) loss_x loss_x 0.3923 (0.6645) acc_x 87.5000 (83.1250) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [10/20] time 0.158 (0.169) data 0.082 (0.093) loss_x loss_x 0.8008 (0.6426) acc_x 81.2500 (83.7500) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [15/20] time 0.180 (0.170) data 0.103 (0.093) loss_x loss_x 0.7812 (0.6707) acc_x 78.1250 (82.7083) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [20/20] time 0.170 (0.169) data 0.093 (0.093) loss_x loss_x 0.4641 (0.6858) acc_x 87.5000 (82.0312) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [5/30] time 0.179 (0.171) data 0.102 (0.094) loss_u loss_u 0.8936 (0.9007) acc_u 9.3750 (11.8750) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/30] time 0.171 (0.171) data 0.094 (0.094) loss_u loss_u 0.8608 (0.8827) acc_u 15.6250 (13.4375) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [15/30] time 0.185 (0.172) data 0.108 (0.095) loss_u loss_u 0.9380 (0.8834) acc_u 9.3750 (13.7500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [20/30] time 0.184 (0.174) data 0.107 (0.097) loss_u loss_u 0.8389 (0.8833) acc_u 18.7500 (13.5938) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [25/30] time 0.169 (0.173) data 0.091 (0.096) loss_u loss_u 0.9648 (0.8811) acc_u 3.1250 (13.8750) lr 1.3239e-03 eta 0:00:00
epoch [81/200] batch [30/30] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.9614 (0.8838) acc_u 6.2500 (13.5417) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.4004, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 647
clean true:605
clean false:42
clean_rate:0.9350850077279753
noisy true:483
noisy false:486
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 969
epoch [82/200] batch [5/20] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.7129 (0.7225) acc_x 81.2500 (83.1250) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [10/20] time 0.170 (0.177) data 0.094 (0.101) loss_x loss_x 0.6099 (0.7045) acc_x 87.5000 (82.8125) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [15/20] time 0.159 (0.171) data 0.083 (0.095) loss_x loss_x 0.5415 (0.7290) acc_x 84.3750 (81.8750) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [20/20] time 0.162 (0.169) data 0.086 (0.093) loss_x loss_x 0.5088 (0.7281) acc_x 90.6250 (82.5000) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [5/30] time 0.171 (0.171) data 0.094 (0.095) loss_u loss_u 0.9629 (0.8842) acc_u 6.2500 (12.5000) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [10/30] time 0.160 (0.170) data 0.083 (0.093) loss_u loss_u 0.9067 (0.8934) acc_u 9.3750 (11.2500) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [15/30] time 0.166 (0.169) data 0.090 (0.093) loss_u loss_u 0.9219 (0.8975) acc_u 6.2500 (10.8333) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [20/30] time 0.183 (0.169) data 0.106 (0.092) loss_u loss_u 0.8462 (0.8904) acc_u 15.6250 (11.4062) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [25/30] time 0.170 (0.170) data 0.093 (0.093) loss_u loss_u 0.9072 (0.8923) acc_u 12.5000 (11.3750) lr 1.3090e-03 eta 0:00:00
epoch [82/200] batch [30/30] time 0.183 (0.171) data 0.105 (0.094) loss_u loss_u 0.9038 (0.8907) acc_u 12.5000 (11.9792) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 537
confident_label rate tensor(0.3998, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 646
clean true:606
clean false:40
clean_rate:0.9380804953560371
noisy true:473
noisy false:497
after delete: len(clean_dataset) 646
after delete: len(noisy_dataset) 970
epoch [83/200] batch [5/20] time 0.181 (0.186) data 0.105 (0.110) loss_x loss_x 1.2754 (0.7507) acc_x 53.1250 (75.0000) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [10/20] time 0.172 (0.179) data 0.096 (0.103) loss_x loss_x 1.4336 (0.8309) acc_x 71.8750 (77.8125) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [15/20] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5596 (0.8026) acc_x 87.5000 (78.9583) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [20/20] time 0.166 (0.180) data 0.090 (0.104) loss_x loss_x 0.7007 (0.7919) acc_x 84.3750 (79.3750) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/30] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8257 (0.8990) acc_u 18.7500 (10.0000) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [10/30] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.8516 (0.8940) acc_u 15.6250 (10.9375) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/30] time 0.180 (0.178) data 0.103 (0.101) loss_u loss_u 0.9019 (0.9067) acc_u 12.5000 (9.5833) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [20/30] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9014 (0.8992) acc_u 12.5000 (10.9375) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [25/30] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.8115 (0.8969) acc_u 21.8750 (11.2500) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [30/30] time 0.181 (0.179) data 0.105 (0.102) loss_u loss_u 0.8379 (0.8902) acc_u 18.7500 (12.3958) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 548
confident_label rate tensor(0.3923, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 634
clean true:595
clean false:39
clean_rate:0.9384858044164038
noisy true:473
noisy false:509
after delete: len(clean_dataset) 634
after delete: len(noisy_dataset) 982
epoch [84/200] batch [5/19] time 0.185 (0.181) data 0.108 (0.104) loss_x loss_x 0.8276 (0.7364) acc_x 78.1250 (78.7500) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [10/19] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.8828 (0.7418) acc_x 71.8750 (78.4375) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [15/19] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.9360 (0.7027) acc_x 75.0000 (78.9583) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [5/30] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8457 (0.8771) acc_u 18.7500 (12.5000) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/30] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8950 (0.8742) acc_u 15.6250 (14.6875) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [15/30] time 0.181 (0.182) data 0.105 (0.106) loss_u loss_u 0.8794 (0.8768) acc_u 15.6250 (13.9583) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [20/30] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8608 (0.8789) acc_u 15.6250 (13.5938) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [25/30] time 0.172 (0.181) data 0.094 (0.104) loss_u loss_u 0.8936 (0.8788) acc_u 12.5000 (13.7500) lr 1.2790e-03 eta 0:00:00
epoch [84/200] batch [30/30] time 0.181 (0.180) data 0.103 (0.104) loss_u loss_u 0.8857 (0.8835) acc_u 12.5000 (13.2292) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.3973, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 642
clean true:602
clean false:40
clean_rate:0.9376947040498442
noisy true:496
noisy false:478
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 974
epoch [85/200] batch [5/20] time 0.221 (0.197) data 0.144 (0.120) loss_x loss_x 0.9092 (0.6733) acc_x 75.0000 (79.3750) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [10/20] time 0.181 (0.189) data 0.104 (0.113) loss_x loss_x 0.8169 (0.6386) acc_x 78.1250 (80.6250) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [15/20] time 0.158 (0.185) data 0.081 (0.109) loss_x loss_x 0.6362 (0.6610) acc_x 81.2500 (80.2083) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [20/20] time 0.158 (0.183) data 0.081 (0.106) loss_x loss_x 0.7671 (0.6590) acc_x 81.2500 (80.7812) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [5/30] time 0.161 (0.181) data 0.084 (0.105) loss_u loss_u 0.8706 (0.8839) acc_u 12.5000 (11.2500) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [10/30] time 0.168 (0.179) data 0.092 (0.103) loss_u loss_u 0.8364 (0.8959) acc_u 21.8750 (11.2500) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [15/30] time 0.170 (0.178) data 0.092 (0.101) loss_u loss_u 0.8486 (0.8848) acc_u 18.7500 (12.7083) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [20/30] time 0.175 (0.176) data 0.097 (0.099) loss_u loss_u 0.8926 (0.8871) acc_u 15.6250 (12.6562) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [25/30] time 0.192 (0.176) data 0.115 (0.099) loss_u loss_u 0.9736 (0.8907) acc_u 0.0000 (11.8750) lr 1.2639e-03 eta 0:00:00
epoch [85/200] batch [30/30] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.8950 (0.8903) acc_u 9.3750 (11.9792) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.3979, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 643
clean true:608
clean false:35
clean_rate:0.9455676516329704
noisy true:515
noisy false:458
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 973
epoch [86/200] batch [5/20] time 0.182 (0.187) data 0.106 (0.111) loss_x loss_x 1.0996 (0.7692) acc_x 78.1250 (81.2500) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [10/20] time 0.183 (0.187) data 0.106 (0.110) loss_x loss_x 0.2610 (0.7133) acc_x 90.6250 (81.2500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [15/20] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.8208 (0.6919) acc_x 62.5000 (79.7917) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [20/20] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.8091 (0.7054) acc_x 81.2500 (80.3125) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [5/30] time 0.182 (0.185) data 0.106 (0.108) loss_u loss_u 0.8105 (0.8834) acc_u 21.8750 (13.1250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [10/30] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9229 (0.8829) acc_u 12.5000 (13.7500) lr 1.2487e-03 eta 0:00:03
epoch [86/200] batch [15/30] time 0.182 (0.184) data 0.105 (0.107) loss_u loss_u 0.9575 (0.8771) acc_u 3.1250 (13.9583) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [20/30] time 0.174 (0.183) data 0.098 (0.106) loss_u loss_u 0.9702 (0.8789) acc_u 3.1250 (13.7500) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [25/30] time 0.170 (0.181) data 0.094 (0.104) loss_u loss_u 0.8745 (0.8735) acc_u 21.8750 (14.3750) lr 1.2487e-03 eta 0:00:00
epoch [86/200] batch [30/30] time 0.171 (0.181) data 0.095 (0.104) loss_u loss_u 0.8594 (0.8812) acc_u 12.5000 (13.4375) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.3973, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 642
clean true:597
clean false:45
clean_rate:0.9299065420560748
noisy true:492
noisy false:482
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 974
epoch [87/200] batch [5/20] time 0.172 (0.170) data 0.096 (0.094) loss_x loss_x 0.2847 (0.6777) acc_x 93.7500 (82.5000) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [10/20] time 0.180 (0.173) data 0.104 (0.097) loss_x loss_x 0.7588 (0.6879) acc_x 78.1250 (81.5625) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [15/20] time 0.172 (0.172) data 0.095 (0.096) loss_x loss_x 0.4907 (0.7156) acc_x 87.5000 (81.4583) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [20/20] time 0.180 (0.171) data 0.104 (0.094) loss_x loss_x 0.5303 (0.6965) acc_x 84.3750 (81.7188) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [5/30] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.8340 (0.8678) acc_u 21.8750 (15.0000) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [10/30] time 0.182 (0.175) data 0.105 (0.099) loss_u loss_u 0.8335 (0.8531) acc_u 18.7500 (16.8750) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [15/30] time 0.172 (0.177) data 0.094 (0.100) loss_u loss_u 0.9097 (0.8666) acc_u 6.2500 (14.7917) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [20/30] time 0.182 (0.175) data 0.105 (0.099) loss_u loss_u 0.9580 (0.8741) acc_u 3.1250 (14.8438) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [25/30] time 0.160 (0.175) data 0.083 (0.099) loss_u loss_u 0.8818 (0.8800) acc_u 15.6250 (14.1250) lr 1.2334e-03 eta 0:00:00
epoch [87/200] batch [30/30] time 0.162 (0.175) data 0.086 (0.098) loss_u loss_u 0.9414 (0.8837) acc_u 12.5000 (13.8542) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.4047, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 654
clean true:602
clean false:52
clean_rate:0.9204892966360856
noisy true:482
noisy false:480
after delete: len(clean_dataset) 654
after delete: len(noisy_dataset) 962
epoch [88/200] batch [5/20] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.4497 (0.7175) acc_x 90.6250 (82.5000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [10/20] time 0.182 (0.184) data 0.106 (0.108) loss_x loss_x 0.6416 (0.6168) acc_x 87.5000 (84.3750) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [15/20] time 0.181 (0.183) data 0.105 (0.107) loss_x loss_x 0.9194 (0.6806) acc_x 68.7500 (82.5000) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [20/20] time 0.179 (0.182) data 0.103 (0.106) loss_x loss_x 1.0107 (0.6862) acc_x 65.6250 (81.8750) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/30] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.9302 (0.9262) acc_u 6.2500 (8.7500) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/30] time 0.177 (0.182) data 0.101 (0.106) loss_u loss_u 0.8896 (0.9018) acc_u 15.6250 (11.8750) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [15/30] time 0.184 (0.182) data 0.107 (0.106) loss_u loss_u 0.8545 (0.8901) acc_u 12.5000 (12.5000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [20/30] time 0.183 (0.182) data 0.107 (0.106) loss_u loss_u 0.9331 (0.8924) acc_u 9.3750 (12.3438) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [25/30] time 0.181 (0.182) data 0.104 (0.106) loss_u loss_u 0.9565 (0.8913) acc_u 3.1250 (12.3750) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [30/30] time 0.174 (0.182) data 0.097 (0.105) loss_u loss_u 0.9219 (0.8932) acc_u 15.6250 (12.7083) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4041, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 653
clean true:613
clean false:40
clean_rate:0.9387442572741195
noisy true:478
noisy false:485
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 963
epoch [89/200] batch [5/20] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6499 (0.6784) acc_x 81.2500 (81.2500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [10/20] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.5781 (0.6586) acc_x 87.5000 (83.7500) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [15/20] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.7427 (0.6410) acc_x 71.8750 (82.7083) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [20/20] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 0.6475 (0.6572) acc_x 87.5000 (82.3438) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [5/30] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.8389 (0.8690) acc_u 18.7500 (15.0000) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [10/30] time 0.176 (0.176) data 0.098 (0.099) loss_u loss_u 0.9263 (0.8725) acc_u 12.5000 (15.0000) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [15/30] time 0.187 (0.177) data 0.109 (0.100) loss_u loss_u 0.9893 (0.8812) acc_u 0.0000 (13.7500) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [20/30] time 0.188 (0.179) data 0.110 (0.101) loss_u loss_u 0.9058 (0.8835) acc_u 9.3750 (13.4375) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [25/30] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.9263 (0.8860) acc_u 6.2500 (13.1250) lr 1.2028e-03 eta 0:00:00
epoch [89/200] batch [30/30] time 0.191 (0.180) data 0.114 (0.103) loss_u loss_u 0.7969 (0.8820) acc_u 28.1250 (13.9583) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.3985, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 644
clean true:606
clean false:38
clean_rate:0.9409937888198758
noisy true:480
noisy false:492
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 972
epoch [90/200] batch [5/20] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 0.7661 (0.9306) acc_x 90.6250 (79.3750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [10/20] time 0.187 (0.183) data 0.110 (0.106) loss_x loss_x 0.7368 (0.8133) acc_x 81.2500 (79.6875) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [15/20] time 0.161 (0.179) data 0.085 (0.102) loss_x loss_x 0.8833 (0.7824) acc_x 81.2500 (79.1667) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [20/20] time 0.182 (0.180) data 0.106 (0.103) loss_x loss_x 0.4583 (0.7316) acc_x 90.6250 (80.9375) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [5/30] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8394 (0.9123) acc_u 15.6250 (8.7500) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [10/30] time 0.178 (0.181) data 0.100 (0.104) loss_u loss_u 0.8242 (0.8983) acc_u 21.8750 (11.5625) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [15/30] time 0.176 (0.180) data 0.098 (0.104) loss_u loss_u 0.9116 (0.9000) acc_u 12.5000 (11.4583) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [20/30] time 0.187 (0.180) data 0.110 (0.103) loss_u loss_u 0.8818 (0.8917) acc_u 18.7500 (12.6562) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [25/30] time 0.178 (0.180) data 0.101 (0.103) loss_u loss_u 0.9116 (0.8923) acc_u 9.3750 (12.6250) lr 1.1874e-03 eta 0:00:00
epoch [90/200] batch [30/30] time 0.168 (0.179) data 0.092 (0.102) loss_u loss_u 0.7935 (0.8858) acc_u 25.0000 (13.4375) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 547
confident_label rate tensor(0.3967, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 641
clean true:597
clean false:44
clean_rate:0.9313572542901716
noisy true:472
noisy false:503
after delete: len(clean_dataset) 641
after delete: len(noisy_dataset) 975
epoch [91/200] batch [5/20] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.5942 (0.5895) acc_x 87.5000 (85.6250) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [10/20] time 0.171 (0.178) data 0.094 (0.102) loss_x loss_x 0.7031 (0.6883) acc_x 81.2500 (81.5625) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [15/20] time 0.189 (0.177) data 0.112 (0.101) loss_x loss_x 0.3589 (0.6341) acc_x 93.7500 (83.1250) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [20/20] time 0.163 (0.174) data 0.086 (0.097) loss_x loss_x 0.8594 (0.6852) acc_x 84.3750 (82.3438) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [5/30] time 0.181 (0.175) data 0.105 (0.098) loss_u loss_u 0.8550 (0.8505) acc_u 15.6250 (16.2500) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [10/30] time 0.160 (0.174) data 0.083 (0.097) loss_u loss_u 0.8965 (0.8737) acc_u 9.3750 (14.0625) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [15/30] time 0.188 (0.176) data 0.112 (0.099) loss_u loss_u 0.9082 (0.8815) acc_u 9.3750 (12.9167) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [20/30] time 0.180 (0.176) data 0.102 (0.099) loss_u loss_u 0.8945 (0.8804) acc_u 12.5000 (13.1250) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [25/30] time 0.185 (0.176) data 0.107 (0.099) loss_u loss_u 0.8799 (0.8830) acc_u 12.5000 (12.8750) lr 1.1719e-03 eta 0:00:00
epoch [91/200] batch [30/30] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.8511 (0.8820) acc_u 15.6250 (13.1250) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.4022, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 650
clean true:603
clean false:47
clean_rate:0.9276923076923077
noisy true:477
noisy false:489
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 966
epoch [92/200] batch [5/20] time 0.173 (0.180) data 0.097 (0.103) loss_x loss_x 0.2871 (0.6188) acc_x 96.8750 (86.2500) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [10/20] time 0.180 (0.179) data 0.103 (0.103) loss_x loss_x 0.8867 (0.7236) acc_x 81.2500 (82.1875) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [15/20] time 0.159 (0.177) data 0.082 (0.101) loss_x loss_x 0.8994 (0.7146) acc_x 78.1250 (81.8750) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [20/20] time 0.186 (0.177) data 0.108 (0.100) loss_x loss_x 0.3743 (0.6950) acc_x 90.6250 (81.5625) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/30] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.8921 (0.9028) acc_u 12.5000 (11.2500) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [10/30] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.8711 (0.9072) acc_u 15.6250 (10.3125) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [15/30] time 0.178 (0.175) data 0.100 (0.098) loss_u loss_u 0.8472 (0.9028) acc_u 15.6250 (10.8333) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [20/30] time 0.186 (0.175) data 0.108 (0.098) loss_u loss_u 0.8369 (0.9033) acc_u 18.7500 (10.7812) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [25/30] time 0.182 (0.176) data 0.104 (0.099) loss_u loss_u 0.8501 (0.8997) acc_u 18.7500 (11.6250) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [30/30] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.8999 (0.8893) acc_u 9.3750 (12.8125) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.4084, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 660
clean true:612
clean false:48
clean_rate:0.9272727272727272
noisy true:471
noisy false:485
after delete: len(clean_dataset) 660
after delete: len(noisy_dataset) 956
epoch [93/200] batch [5/20] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.3840 (0.6563) acc_x 87.5000 (80.0000) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [10/20] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.7754 (0.7402) acc_x 78.1250 (79.0625) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [15/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.9058 (0.7238) acc_x 78.1250 (79.3750) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [20/20] time 0.184 (0.182) data 0.108 (0.106) loss_x loss_x 0.5830 (0.7179) acc_x 90.6250 (80.0000) lr 1.1409e-03 eta 0:00:00
epoch [93/200] batch [5/29] time 0.185 (0.183) data 0.108 (0.106) loss_u loss_u 0.8726 (0.8788) acc_u 12.5000 (14.3750) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [10/29] time 0.184 (0.183) data 0.108 (0.106) loss_u loss_u 0.8462 (0.8829) acc_u 15.6250 (14.3750) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [15/29] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8550 (0.8840) acc_u 18.7500 (14.1667) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [20/29] time 0.184 (0.183) data 0.107 (0.107) loss_u loss_u 0.9434 (0.8857) acc_u 6.2500 (13.7500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [25/29] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9263 (0.8962) acc_u 9.3750 (12.3750) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.3973, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 642
clean true:603
clean false:39
clean_rate:0.9392523364485982
noisy true:479
noisy false:495
after delete: len(clean_dataset) 642
after delete: len(noisy_dataset) 974
epoch [94/200] batch [5/20] time 0.183 (0.183) data 0.107 (0.106) loss_x loss_x 0.3901 (0.5835) acc_x 87.5000 (82.5000) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [10/20] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.4814 (0.6277) acc_x 87.5000 (82.5000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [15/20] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.6147 (0.6011) acc_x 84.3750 (82.9167) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [20/20] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.3110 (0.6575) acc_x 90.6250 (81.7188) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [5/30] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.9253 (0.9126) acc_u 9.3750 (10.0000) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [10/30] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.7847 (0.8904) acc_u 21.8750 (11.8750) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [15/30] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.8638 (0.8848) acc_u 18.7500 (13.1250) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [20/30] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.8350 (0.8778) acc_u 18.7500 (14.2188) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [25/30] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8633 (0.8770) acc_u 18.7500 (14.6250) lr 1.1253e-03 eta 0:00:00
epoch [94/200] batch [30/30] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.9312 (0.8856) acc_u 9.3750 (13.6458) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 531
confident_label rate tensor(0.4028, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 651
clean true:602
clean false:49
clean_rate:0.9247311827956989
noisy true:483
noisy false:482
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 965
epoch [95/200] batch [5/20] time 0.185 (0.171) data 0.108 (0.094) loss_x loss_x 0.6538 (0.5524) acc_x 75.0000 (86.8750) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [10/20] time 0.176 (0.174) data 0.099 (0.098) loss_x loss_x 0.9976 (0.6521) acc_x 71.8750 (84.0625) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [15/20] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.9922 (0.6722) acc_x 75.0000 (82.9167) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [20/20] time 0.185 (0.179) data 0.109 (0.102) loss_x loss_x 0.9131 (0.6841) acc_x 78.1250 (82.6562) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [5/30] time 0.184 (0.180) data 0.108 (0.103) loss_u loss_u 0.8555 (0.8764) acc_u 15.6250 (15.0000) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/30] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.9644 (0.8858) acc_u 3.1250 (13.4375) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [15/30] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8516 (0.8936) acc_u 18.7500 (12.5000) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [20/30] time 0.178 (0.181) data 0.100 (0.104) loss_u loss_u 0.8389 (0.8969) acc_u 18.7500 (12.0312) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [25/30] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.7944 (0.8912) acc_u 21.8750 (12.8750) lr 1.1097e-03 eta 0:00:00
epoch [95/200] batch [30/30] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.7612 (0.8902) acc_u 28.1250 (13.1250) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.4066, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 657
clean true:610
clean false:47
clean_rate:0.928462709284627
noisy true:463
noisy false:496
after delete: len(clean_dataset) 657
after delete: len(noisy_dataset) 959
epoch [96/200] batch [5/20] time 0.160 (0.173) data 0.083 (0.096) loss_x loss_x 0.6187 (0.5478) acc_x 87.5000 (86.8750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [10/20] time 0.183 (0.175) data 0.106 (0.098) loss_x loss_x 0.9307 (0.6884) acc_x 87.5000 (83.7500) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [15/20] time 0.182 (0.179) data 0.106 (0.102) loss_x loss_x 0.8315 (0.6661) acc_x 84.3750 (82.7083) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [20/20] time 0.160 (0.178) data 0.084 (0.101) loss_x loss_x 1.2061 (0.6954) acc_x 68.7500 (81.2500) lr 1.0941e-03 eta 0:00:00
epoch [96/200] batch [5/29] time 0.166 (0.175) data 0.089 (0.098) loss_u loss_u 0.8862 (0.9048) acc_u 12.5000 (11.2500) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/29] time 0.170 (0.173) data 0.092 (0.097) loss_u loss_u 0.9272 (0.9040) acc_u 9.3750 (11.5625) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [15/29] time 0.163 (0.172) data 0.085 (0.095) loss_u loss_u 0.9307 (0.8971) acc_u 9.3750 (12.9167) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [20/29] time 0.194 (0.172) data 0.116 (0.095) loss_u loss_u 0.8633 (0.8931) acc_u 18.7500 (12.9688) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [25/29] time 0.175 (0.173) data 0.097 (0.096) loss_u loss_u 0.8467 (0.8930) acc_u 15.6250 (12.6250) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.3985, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 644
clean true:597
clean false:47
clean_rate:0.9270186335403726
noisy true:492
noisy false:480
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 972
epoch [97/200] batch [5/20] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.6362 (0.8052) acc_x 81.2500 (80.0000) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [10/20] time 0.184 (0.182) data 0.108 (0.105) loss_x loss_x 0.4958 (0.7028) acc_x 84.3750 (82.8125) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [15/20] time 0.180 (0.182) data 0.104 (0.106) loss_x loss_x 0.6748 (0.6697) acc_x 81.2500 (83.5417) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [20/20] time 0.160 (0.177) data 0.083 (0.100) loss_x loss_x 0.6665 (0.6717) acc_x 87.5000 (84.2188) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/30] time 0.200 (0.177) data 0.122 (0.100) loss_u loss_u 0.8477 (0.8751) acc_u 15.6250 (16.2500) lr 1.0785e-03 eta 0:00:04
epoch [97/200] batch [10/30] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.7896 (0.8703) acc_u 21.8750 (15.3125) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [15/30] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.9189 (0.8710) acc_u 9.3750 (15.2083) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [20/30] time 0.163 (0.179) data 0.085 (0.102) loss_u loss_u 0.9165 (0.8812) acc_u 9.3750 (13.7500) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [25/30] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.9092 (0.8847) acc_u 12.5000 (13.5000) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [30/30] time 0.158 (0.178) data 0.080 (0.101) loss_u loss_u 0.8755 (0.8818) acc_u 15.6250 (13.8542) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 540
confident_label rate tensor(0.3979, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 643
clean true:597
clean false:46
clean_rate:0.9284603421461898
noisy true:479
noisy false:494
after delete: len(clean_dataset) 643
after delete: len(noisy_dataset) 973
epoch [98/200] batch [5/20] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.4756 (0.7053) acc_x 87.5000 (82.5000) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [10/20] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.9214 (0.8011) acc_x 75.0000 (78.1250) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [15/20] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.6562 (0.7779) acc_x 84.3750 (78.9583) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [20/20] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.8481 (0.7570) acc_x 78.1250 (79.5312) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [5/30] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8457 (0.8786) acc_u 15.6250 (13.7500) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [10/30] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.8955 (0.8813) acc_u 12.5000 (13.7500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [15/30] time 0.181 (0.183) data 0.104 (0.106) loss_u loss_u 0.9390 (0.8951) acc_u 6.2500 (11.8750) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [20/30] time 0.195 (0.183) data 0.118 (0.106) loss_u loss_u 0.8535 (0.8939) acc_u 18.7500 (12.5000) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [25/30] time 0.177 (0.183) data 0.100 (0.106) loss_u loss_u 0.8940 (0.8896) acc_u 12.5000 (12.8750) lr 1.0628e-03 eta 0:00:00
epoch [98/200] batch [30/30] time 0.180 (0.183) data 0.103 (0.105) loss_u loss_u 0.8765 (0.8908) acc_u 12.5000 (12.3958) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 533
confident_label rate tensor(0.4165, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 673
clean true:620
clean false:53
clean_rate:0.9212481426448736
noisy true:463
noisy false:480
after delete: len(clean_dataset) 673
after delete: len(noisy_dataset) 943
epoch [99/200] batch [5/21] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.5200 (0.6365) acc_x 78.1250 (84.3750) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [10/21] time 0.179 (0.169) data 0.103 (0.093) loss_x loss_x 0.7549 (0.6553) acc_x 78.1250 (84.0625) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [15/21] time 0.160 (0.170) data 0.084 (0.093) loss_x loss_x 0.6304 (0.7087) acc_x 78.1250 (81.6667) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/21] time 0.163 (0.167) data 0.086 (0.091) loss_x loss_x 1.3809 (0.7328) acc_x 71.8750 (81.7188) lr 1.0471e-03 eta 0:00:00
epoch [99/200] batch [5/29] time 0.171 (0.169) data 0.094 (0.092) loss_u loss_u 0.9009 (0.8942) acc_u 12.5000 (11.8750) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/29] time 0.161 (0.168) data 0.084 (0.091) loss_u loss_u 0.8896 (0.9046) acc_u 12.5000 (10.9375) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [15/29] time 0.175 (0.169) data 0.097 (0.092) loss_u loss_u 0.8975 (0.9048) acc_u 9.3750 (11.4583) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [20/29] time 0.183 (0.171) data 0.105 (0.094) loss_u loss_u 0.9570 (0.9027) acc_u 3.1250 (11.4062) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [25/29] time 0.184 (0.172) data 0.107 (0.095) loss_u loss_u 0.8965 (0.9040) acc_u 12.5000 (11.1250) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 531
confident_label rate tensor(0.4072, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 658
clean true:611
clean false:47
clean_rate:0.9285714285714286
noisy true:474
noisy false:484
all clean rate:  [0.9256505576208178, 0.94375, 0.9470046082949308, 0.9667458432304038, 0.969047619047619, 0.9557522123893806, 0.958963282937365, 0.965675057208238, 0.9526748971193416, 0.9560439560439561, 0.9569672131147541, 0.9567901234567902, 0.950920245398773, 0.9493927125506073, 0.9558232931726908, 0.9560878243512974, 0.9674952198852772, 0.9404761904761905, 0.952286282306163, 0.9512195121951219, 0.9550561797752809, 0.9405204460966543, 0.9495327102803738, 0.9423423423423424, 0.9574468085106383, 0.9490566037735849, 0.9450757575757576, 0.9408602150537635, 0.9279112754158965, 0.9582577132486388, 0.9460869565217391, 0.9533213644524237, 0.9396709323583181, 0.9553072625698324, 0.9530685920577617, 0.9529616724738676, 0.9358288770053476, 0.9379310344827586, 0.9464285714285714, 0.9470899470899471, 0.9445407279029463, 0.9362068965517242, 0.946551724137931, 0.9500860585197934, 0.9439579684763573, 0.946843853820598, 0.9428571428571428, 0.9524617996604414, 0.95578231292517, 0.9359605911330049, 0.935042735042735, 0.9457627118644067, 0.9483648881239243, 0.9328859060402684, 0.9408783783783784, 0.9267515923566879, 0.9468267581475128, 0.9545454545454546, 0.9279869067103109, 0.9407894736842105, 0.9464566929133859, 0.9376026272577996, 0.935064935064935, 0.9446254071661238, 0.9365079365079365, 0.9244663382594417, 0.9312080536912751, 0.9426229508196722, 0.937799043062201, 0.946078431372549, 0.9537480063795853, 0.9382911392405063, 0.9414483821263482, 0.9297124600638977, 0.9392523364485982, 0.9531502423263328, 0.9416531604538088, 0.9389671361502347, 0.9443561208267091, 0.9339774557165862, 0.9382716049382716, 0.9350850077279753, 0.9380804953560371, 0.9384858044164038, 0.9376947040498442, 0.9455676516329704, 0.9299065420560748, 0.9204892966360856, 0.9387442572741195, 0.9409937888198758, 0.9313572542901716, 0.9276923076923077, 0.9272727272727272, 0.9392523364485982, 0.9247311827956989, 0.928462709284627, 0.9270186335403726, 0.9284603421461898, 0.9212481426448736, 0.9285714285714286]
after delete: len(clean_dataset) 658
after delete: len(noisy_dataset) 958
epoch [100/200] batch [5/20] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 0.4822 (0.6274) acc_x 81.2500 (81.8750) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [10/20] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.4705 (0.6363) acc_x 87.5000 (83.1250) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [15/20] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7007 (0.6886) acc_x 75.0000 (82.0833) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [20/20] time 0.163 (0.182) data 0.086 (0.106) loss_x loss_x 0.4246 (0.6470) acc_x 87.5000 (82.9688) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/29] time 0.183 (0.181) data 0.105 (0.105) loss_u loss_u 0.8779 (0.9003) acc_u 12.5000 (12.5000) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [10/29] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8550 (0.8883) acc_u 18.7500 (13.7500) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [15/29] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9062 (0.8936) acc_u 9.3750 (12.9167) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [20/29] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8647 (0.8963) acc_u 18.7500 (12.5000) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [25/29] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.8853 (0.8996) acc_u 12.5000 (12.1250) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4004, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 647
clean true:601
clean false:46
clean_rate:0.9289026275115919
noisy true:490
noisy false:479
after delete: len(clean_dataset) 647
after delete: len(noisy_dataset) 969
epoch [101/200] batch [5/20] time 0.182 (0.186) data 0.106 (0.110) loss_x loss_x 0.4985 (0.6401) acc_x 87.5000 (83.7500) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [10/20] time 0.184 (0.185) data 0.108 (0.109) loss_x loss_x 0.3992 (0.5528) acc_x 90.6250 (85.6250) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [15/20] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.5083 (0.5315) acc_x 84.3750 (85.8333) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [20/20] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 0.4927 (0.5730) acc_x 87.5000 (84.5312) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [5/30] time 0.186 (0.185) data 0.108 (0.108) loss_u loss_u 0.9146 (0.8808) acc_u 12.5000 (13.1250) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [10/30] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.8794 (0.8793) acc_u 12.5000 (13.4375) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [15/30] time 0.183 (0.184) data 0.106 (0.108) loss_u loss_u 0.8779 (0.8817) acc_u 15.6250 (13.5417) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [20/30] time 0.183 (0.184) data 0.106 (0.108) loss_u loss_u 0.8428 (0.8779) acc_u 15.6250 (13.9062) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [25/30] time 0.181 (0.184) data 0.104 (0.107) loss_u loss_u 0.9443 (0.8753) acc_u 6.2500 (14.1250) lr 1.0157e-03 eta 0:00:00
epoch [101/200] batch [30/30] time 0.177 (0.183) data 0.099 (0.106) loss_u loss_u 0.9189 (0.8762) acc_u 12.5000 (14.2708) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:622
clean false:46
clean_rate:0.9311377245508982
noisy true:469
noisy false:479
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [102/200] batch [5/20] time 0.185 (0.179) data 0.108 (0.102) loss_x loss_x 0.7368 (0.8567) acc_x 78.1250 (78.1250) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [10/20] time 0.162 (0.174) data 0.086 (0.097) loss_x loss_x 0.6685 (0.8223) acc_x 84.3750 (78.4375) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [15/20] time 0.180 (0.175) data 0.103 (0.098) loss_x loss_x 0.8745 (0.7231) acc_x 71.8750 (81.0417) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [20/20] time 0.177 (0.175) data 0.100 (0.099) loss_x loss_x 0.6768 (0.7399) acc_x 78.1250 (81.0938) lr 1.0000e-03 eta 0:00:00
epoch [102/200] batch [5/29] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.9048 (0.9022) acc_u 9.3750 (12.5000) lr 1.0000e-03 eta 0:00:04
epoch [102/200] batch [10/29] time 0.190 (0.175) data 0.113 (0.098) loss_u loss_u 0.9399 (0.9204) acc_u 6.2500 (10.0000) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [15/29] time 0.186 (0.176) data 0.109 (0.100) loss_u loss_u 0.8628 (0.9099) acc_u 12.5000 (10.4167) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [20/29] time 0.185 (0.177) data 0.108 (0.101) loss_u loss_u 0.8960 (0.9051) acc_u 9.3750 (11.2500) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [25/29] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.9116 (0.8968) acc_u 9.3750 (12.0000) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 508
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:626
clean false:42
clean_rate:0.937125748502994
noisy true:482
noisy false:466
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [103/200] batch [5/20] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.9736 (0.7019) acc_x 78.1250 (81.8750) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [10/20] time 0.161 (0.170) data 0.084 (0.093) loss_x loss_x 0.9438 (0.6734) acc_x 81.2500 (83.1250) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [15/20] time 0.173 (0.169) data 0.097 (0.092) loss_x loss_x 0.6685 (0.6358) acc_x 87.5000 (83.7500) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [20/20] time 0.173 (0.170) data 0.096 (0.093) loss_x loss_x 0.6011 (0.6540) acc_x 81.2500 (83.1250) lr 9.8429e-04 eta 0:00:00
epoch [103/200] batch [5/29] time 0.174 (0.172) data 0.096 (0.095) loss_u loss_u 0.7983 (0.8871) acc_u 25.0000 (14.3750) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [10/29] time 0.165 (0.171) data 0.088 (0.094) loss_u loss_u 0.7900 (0.8894) acc_u 21.8750 (12.8125) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [15/29] time 0.169 (0.171) data 0.092 (0.094) loss_u loss_u 0.8579 (0.8822) acc_u 15.6250 (13.3333) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [20/29] time 0.169 (0.171) data 0.092 (0.094) loss_u loss_u 0.8467 (0.8807) acc_u 18.7500 (13.5938) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [25/29] time 0.172 (0.171) data 0.095 (0.094) loss_u loss_u 0.9199 (0.8817) acc_u 9.3750 (13.8750) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 543
confident_label rate tensor(0.4041, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 653
clean true:607
clean false:46
clean_rate:0.9295558958652373
noisy true:466
noisy false:497
after delete: len(clean_dataset) 653
after delete: len(noisy_dataset) 963
epoch [104/200] batch [5/20] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.3142 (0.6928) acc_x 90.6250 (77.5000) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [10/20] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.6318 (0.7661) acc_x 84.3750 (79.3750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [15/20] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.4026 (0.7092) acc_x 87.5000 (80.2083) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [20/20] time 0.180 (0.181) data 0.103 (0.105) loss_x loss_x 0.8330 (0.7003) acc_x 75.0000 (80.6250) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [5/30] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.8315 (0.8409) acc_u 21.8750 (18.7500) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [10/30] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.7905 (0.8644) acc_u 25.0000 (16.2500) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [15/30] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.8438 (0.8758) acc_u 18.7500 (14.5833) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [20/30] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8955 (0.8800) acc_u 9.3750 (13.4375) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [25/30] time 0.190 (0.183) data 0.113 (0.106) loss_u loss_u 0.9121 (0.8818) acc_u 9.3750 (13.6250) lr 9.6859e-04 eta 0:00:00
epoch [104/200] batch [30/30] time 0.175 (0.182) data 0.098 (0.105) loss_u loss_u 0.8945 (0.8835) acc_u 9.3750 (13.4375) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 518
confident_label rate tensor(0.4028, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 651
clean true:614
clean false:37
clean_rate:0.9431643625192012
noisy true:484
noisy false:481
after delete: len(clean_dataset) 651
after delete: len(noisy_dataset) 965
epoch [105/200] batch [5/20] time 0.162 (0.168) data 0.085 (0.091) loss_x loss_x 0.8198 (0.6270) acc_x 78.1250 (85.0000) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [10/20] time 0.178 (0.170) data 0.101 (0.093) loss_x loss_x 0.6519 (0.6149) acc_x 78.1250 (83.7500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [15/20] time 0.168 (0.171) data 0.091 (0.094) loss_x loss_x 0.3572 (0.6247) acc_x 84.3750 (82.7083) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [20/20] time 0.181 (0.171) data 0.105 (0.094) loss_x loss_x 0.3655 (0.6214) acc_x 93.7500 (83.5938) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [5/30] time 0.182 (0.173) data 0.106 (0.097) loss_u loss_u 0.9233 (0.8932) acc_u 9.3750 (11.2500) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/30] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.8428 (0.8888) acc_u 18.7500 (12.1875) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [15/30] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9072 (0.8822) acc_u 9.3750 (13.1250) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [20/30] time 0.186 (0.178) data 0.109 (0.101) loss_u loss_u 0.8745 (0.8803) acc_u 15.6250 (13.7500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [25/30] time 0.182 (0.179) data 0.106 (0.102) loss_u loss_u 0.9292 (0.8861) acc_u 9.3750 (12.8750) lr 9.5289e-04 eta 0:00:00
epoch [105/200] batch [30/30] time 0.181 (0.179) data 0.105 (0.102) loss_u loss_u 0.8721 (0.8811) acc_u 18.7500 (13.7500) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 523
confident_label rate tensor(0.4171, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 674
clean true:622
clean false:52
clean_rate:0.9228486646884273
noisy true:471
noisy false:471
after delete: len(clean_dataset) 674
after delete: len(noisy_dataset) 942
epoch [106/200] batch [5/21] time 0.183 (0.169) data 0.107 (0.092) loss_x loss_x 0.9688 (0.6423) acc_x 75.0000 (83.1250) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [10/21] time 0.160 (0.168) data 0.084 (0.091) loss_x loss_x 0.3433 (0.5724) acc_x 90.6250 (83.7500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [15/21] time 0.168 (0.169) data 0.091 (0.092) loss_x loss_x 0.4812 (0.5781) acc_x 93.7500 (84.1667) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/21] time 0.175 (0.171) data 0.099 (0.095) loss_x loss_x 0.7773 (0.5719) acc_x 84.3750 (85.0000) lr 9.3721e-04 eta 0:00:00
epoch [106/200] batch [5/29] time 0.175 (0.173) data 0.098 (0.096) loss_u loss_u 0.8311 (0.8592) acc_u 25.0000 (16.8750) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [10/29] time 0.164 (0.172) data 0.087 (0.095) loss_u loss_u 0.9170 (0.8774) acc_u 12.5000 (16.2500) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [15/29] time 0.167 (0.171) data 0.091 (0.094) loss_u loss_u 0.9756 (0.8922) acc_u 3.1250 (13.7500) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [20/29] time 0.175 (0.171) data 0.098 (0.094) loss_u loss_u 0.8911 (0.8950) acc_u 12.5000 (13.1250) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [25/29] time 0.183 (0.172) data 0.106 (0.095) loss_u loss_u 0.8037 (0.8941) acc_u 21.8750 (12.7500) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.3985, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 644
clean true:591
clean false:53
clean_rate:0.9177018633540373
noisy true:480
noisy false:492
after delete: len(clean_dataset) 644
after delete: len(noisy_dataset) 972
epoch [107/200] batch [5/20] time 0.183 (0.181) data 0.107 (0.105) loss_x loss_x 1.0234 (0.7993) acc_x 78.1250 (81.2500) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [10/20] time 0.160 (0.176) data 0.083 (0.099) loss_x loss_x 0.4788 (0.7031) acc_x 90.6250 (83.4375) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [15/20] time 0.164 (0.172) data 0.088 (0.096) loss_x loss_x 0.5981 (0.7083) acc_x 84.3750 (82.5000) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [20/20] time 0.183 (0.173) data 0.107 (0.096) loss_x loss_x 0.4333 (0.7069) acc_x 87.5000 (82.1875) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/30] time 0.168 (0.173) data 0.091 (0.097) loss_u loss_u 0.8350 (0.8543) acc_u 18.7500 (15.6250) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [10/30] time 0.182 (0.173) data 0.104 (0.097) loss_u loss_u 0.8237 (0.8628) acc_u 18.7500 (15.3125) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [15/30] time 0.185 (0.175) data 0.107 (0.098) loss_u loss_u 0.8999 (0.8697) acc_u 12.5000 (14.3750) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [20/30] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.8120 (0.8696) acc_u 18.7500 (14.3750) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [25/30] time 0.185 (0.176) data 0.107 (0.100) loss_u loss_u 0.8574 (0.8721) acc_u 12.5000 (14.2500) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [30/30] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.8936 (0.8757) acc_u 12.5000 (13.7500) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 521
confident_label rate tensor(0.4109, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 664
clean true:613
clean false:51
clean_rate:0.9231927710843374
noisy true:482
noisy false:470
after delete: len(clean_dataset) 664
after delete: len(noisy_dataset) 952
epoch [108/200] batch [5/20] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.7847 (0.5838) acc_x 78.1250 (86.8750) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [10/20] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 1.1777 (0.6816) acc_x 65.6250 (82.8125) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [15/20] time 0.180 (0.177) data 0.104 (0.100) loss_x loss_x 0.4165 (0.7158) acc_x 90.6250 (81.2500) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [20/20] time 0.173 (0.174) data 0.096 (0.098) loss_x loss_x 0.7827 (0.7089) acc_x 75.0000 (81.0938) lr 9.0589e-04 eta 0:00:00
epoch [108/200] batch [5/29] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.8887 (0.8693) acc_u 12.5000 (15.0000) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [10/29] time 0.183 (0.177) data 0.107 (0.100) loss_u loss_u 0.8594 (0.8738) acc_u 15.6250 (14.3750) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [15/29] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.9116 (0.8782) acc_u 9.3750 (13.5417) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [20/29] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.8921 (0.8825) acc_u 12.5000 (13.1250) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [25/29] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.9434 (0.8874) acc_u 6.2500 (12.7500) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 677
clean true:633
clean false:44
clean_rate:0.9350073855243722
noisy true:472
noisy false:467
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 939
epoch [109/200] batch [5/21] time 0.171 (0.174) data 0.095 (0.097) loss_x loss_x 0.7524 (0.8304) acc_x 78.1250 (78.1250) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [10/21] time 0.174 (0.168) data 0.097 (0.091) loss_x loss_x 0.6138 (0.7577) acc_x 81.2500 (79.3750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [15/21] time 0.178 (0.169) data 0.102 (0.093) loss_x loss_x 0.8335 (0.7096) acc_x 75.0000 (79.3750) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/21] time 0.172 (0.171) data 0.095 (0.094) loss_x loss_x 0.6133 (0.6868) acc_x 87.5000 (80.6250) lr 8.9027e-04 eta 0:00:00
epoch [109/200] batch [5/29] time 0.182 (0.173) data 0.105 (0.097) loss_u loss_u 0.8213 (0.8654) acc_u 18.7500 (15.6250) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [10/29] time 0.183 (0.175) data 0.106 (0.098) loss_u loss_u 0.8545 (0.8725) acc_u 15.6250 (15.0000) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [15/29] time 0.176 (0.175) data 0.099 (0.098) loss_u loss_u 0.9155 (0.8785) acc_u 12.5000 (14.5833) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [20/29] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.8726 (0.8786) acc_u 15.6250 (14.6875) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [25/29] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.8667 (0.8846) acc_u 15.6250 (14.0000) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:626
clean false:42
clean_rate:0.937125748502994
noisy true:486
noisy false:462
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [110/200] batch [5/20] time 0.182 (0.196) data 0.105 (0.119) loss_x loss_x 0.2510 (0.4218) acc_x 90.6250 (88.1250) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [10/20] time 0.157 (0.177) data 0.080 (0.100) loss_x loss_x 0.4600 (0.5387) acc_x 90.6250 (85.0000) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [15/20] time 0.188 (0.179) data 0.111 (0.103) loss_x loss_x 0.6445 (0.5703) acc_x 84.3750 (85.2083) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [20/20] time 0.183 (0.180) data 0.107 (0.103) loss_x loss_x 0.4756 (0.6304) acc_x 90.6250 (84.3750) lr 8.7467e-04 eta 0:00:00
epoch [110/200] batch [5/29] time 0.182 (0.180) data 0.105 (0.104) loss_u loss_u 0.9575 (0.9280) acc_u 3.1250 (6.8750) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/29] time 0.180 (0.181) data 0.104 (0.104) loss_u loss_u 0.9424 (0.9192) acc_u 6.2500 (7.8125) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [15/29] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.9072 (0.9105) acc_u 9.3750 (9.7917) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [20/29] time 0.183 (0.181) data 0.105 (0.105) loss_u loss_u 0.7720 (0.9061) acc_u 28.1250 (10.6250) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [25/29] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8848 (0.8971) acc_u 12.5000 (11.5000) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.4140, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 669
clean true:626
clean false:43
clean_rate:0.9357249626307922
noisy true:503
noisy false:444
after delete: len(clean_dataset) 669
after delete: len(noisy_dataset) 947
epoch [111/200] batch [5/20] time 0.158 (0.169) data 0.081 (0.092) loss_x loss_x 0.9404 (0.6429) acc_x 65.6250 (81.2500) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [10/20] time 0.157 (0.165) data 0.081 (0.089) loss_x loss_x 0.8262 (0.6686) acc_x 81.2500 (82.1875) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [15/20] time 0.179 (0.166) data 0.101 (0.089) loss_x loss_x 1.0127 (0.7194) acc_x 71.8750 (81.0417) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [20/20] time 0.182 (0.171) data 0.106 (0.094) loss_x loss_x 0.3943 (0.6990) acc_x 87.5000 (81.7188) lr 8.5910e-04 eta 0:00:00
epoch [111/200] batch [5/29] time 0.184 (0.173) data 0.107 (0.096) loss_u loss_u 0.9258 (0.8993) acc_u 6.2500 (10.6250) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/29] time 0.175 (0.174) data 0.097 (0.097) loss_u loss_u 0.8813 (0.8989) acc_u 15.6250 (10.9375) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [15/29] time 0.183 (0.175) data 0.106 (0.097) loss_u loss_u 0.8989 (0.8859) acc_u 12.5000 (12.7083) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [20/29] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.8911 (0.8924) acc_u 12.5000 (12.5000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [25/29] time 0.183 (0.176) data 0.105 (0.099) loss_u loss_u 0.9380 (0.8948) acc_u 9.3750 (12.2500) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.4090, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 661
clean true:609
clean false:52
clean_rate:0.9213313161875946
noisy true:483
noisy false:472
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 955
epoch [112/200] batch [5/20] time 0.181 (0.192) data 0.104 (0.116) loss_x loss_x 0.8213 (0.7320) acc_x 71.8750 (79.3750) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [10/20] time 0.169 (0.178) data 0.093 (0.102) loss_x loss_x 0.6465 (0.6808) acc_x 81.2500 (81.2500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [15/20] time 0.169 (0.173) data 0.092 (0.097) loss_x loss_x 0.1807 (0.6648) acc_x 96.8750 (81.2500) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [20/20] time 0.166 (0.172) data 0.090 (0.095) loss_x loss_x 0.6289 (0.6891) acc_x 87.5000 (81.8750) lr 8.4357e-04 eta 0:00:00
epoch [112/200] batch [5/29] time 0.181 (0.173) data 0.103 (0.096) loss_u loss_u 0.9385 (0.8938) acc_u 9.3750 (12.5000) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/29] time 0.174 (0.174) data 0.097 (0.097) loss_u loss_u 0.8916 (0.8728) acc_u 12.5000 (15.0000) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [15/29] time 0.168 (0.173) data 0.091 (0.096) loss_u loss_u 0.8735 (0.8699) acc_u 12.5000 (15.0000) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [20/29] time 0.167 (0.173) data 0.090 (0.096) loss_u loss_u 0.8975 (0.8810) acc_u 12.5000 (13.7500) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [25/29] time 0.159 (0.172) data 0.081 (0.095) loss_u loss_u 0.9092 (0.8794) acc_u 12.5000 (13.8750) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 515
confident_label rate tensor(0.4177, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 675
clean true:631
clean false:44
clean_rate:0.9348148148148148
noisy true:470
noisy false:471
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 941
epoch [113/200] batch [5/21] time 0.195 (0.185) data 0.117 (0.108) loss_x loss_x 0.7466 (0.7628) acc_x 87.5000 (80.0000) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [10/21] time 0.161 (0.178) data 0.084 (0.101) loss_x loss_x 0.8081 (0.6525) acc_x 81.2500 (83.1250) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [15/21] time 0.184 (0.179) data 0.108 (0.103) loss_x loss_x 0.7886 (0.6696) acc_x 84.3750 (82.7083) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/21] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.3657 (0.7030) acc_x 90.6250 (81.5625) lr 8.2807e-04 eta 0:00:00
epoch [113/200] batch [5/29] time 0.185 (0.181) data 0.107 (0.104) loss_u loss_u 0.9146 (0.8984) acc_u 9.3750 (11.8750) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/29] time 0.181 (0.181) data 0.105 (0.105) loss_u loss_u 0.9106 (0.9045) acc_u 9.3750 (11.2500) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [15/29] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.8027 (0.8869) acc_u 25.0000 (13.1250) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [20/29] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.9653 (0.8907) acc_u 3.1250 (12.3438) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [25/29] time 0.172 (0.181) data 0.095 (0.104) loss_u loss_u 0.8848 (0.8951) acc_u 12.5000 (11.7500) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4177, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 675
clean true:624
clean false:51
clean_rate:0.9244444444444444
noisy true:486
noisy false:455
after delete: len(clean_dataset) 675
after delete: len(noisy_dataset) 941
epoch [114/200] batch [5/21] time 0.182 (0.181) data 0.105 (0.104) loss_x loss_x 0.1656 (0.5568) acc_x 96.8750 (85.6250) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [10/21] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.7539 (0.5867) acc_x 78.1250 (84.6875) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/21] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.8345 (0.6139) acc_x 71.8750 (83.1250) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/21] time 0.171 (0.179) data 0.093 (0.102) loss_x loss_x 0.5508 (0.6119) acc_x 84.3750 (83.1250) lr 8.1262e-04 eta 0:00:00
epoch [114/200] batch [5/29] time 0.185 (0.179) data 0.107 (0.102) loss_u loss_u 0.9370 (0.9128) acc_u 6.2500 (10.6250) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/29] time 0.166 (0.179) data 0.089 (0.101) loss_u loss_u 0.8877 (0.8934) acc_u 12.5000 (12.8125) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [15/29] time 0.168 (0.177) data 0.090 (0.100) loss_u loss_u 0.8442 (0.8883) acc_u 15.6250 (13.1250) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [20/29] time 0.164 (0.176) data 0.087 (0.098) loss_u loss_u 0.9668 (0.8854) acc_u 3.1250 (13.7500) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [25/29] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9277 (0.8952) acc_u 6.2500 (12.6250) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 560
confident_label rate tensor(0.4127, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 667
clean true:606
clean false:61
clean_rate:0.9085457271364318
noisy true:450
noisy false:499
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 949
epoch [115/200] batch [5/20] time 0.180 (0.172) data 0.104 (0.096) loss_x loss_x 0.3118 (0.4735) acc_x 96.8750 (91.8750) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [10/20] time 0.199 (0.175) data 0.122 (0.098) loss_x loss_x 0.7266 (0.5264) acc_x 81.2500 (87.1875) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [15/20] time 0.174 (0.174) data 0.097 (0.097) loss_x loss_x 0.8647 (0.5674) acc_x 78.1250 (86.4583) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [20/20] time 0.166 (0.174) data 0.089 (0.097) loss_x loss_x 0.7529 (0.6233) acc_x 75.0000 (84.3750) lr 7.9721e-04 eta 0:00:00
epoch [115/200] batch [5/29] time 0.181 (0.173) data 0.103 (0.096) loss_u loss_u 0.8872 (0.8835) acc_u 12.5000 (15.0000) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/29] time 0.170 (0.174) data 0.094 (0.097) loss_u loss_u 0.8516 (0.8878) acc_u 18.7500 (14.0625) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [15/29] time 0.182 (0.174) data 0.106 (0.097) loss_u loss_u 0.8564 (0.8820) acc_u 21.8750 (14.7917) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [20/29] time 0.184 (0.175) data 0.107 (0.098) loss_u loss_u 0.8823 (0.8747) acc_u 15.6250 (15.0000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [25/29] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.8545 (0.8746) acc_u 15.6250 (15.1250) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:651
clean false:49
clean_rate:0.93
noisy true:485
noisy false:431
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [116/200] batch [5/21] time 0.160 (0.179) data 0.083 (0.102) loss_x loss_x 0.5947 (0.8523) acc_x 84.3750 (75.6250) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [10/21] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 0.8071 (0.7523) acc_x 75.0000 (80.3125) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [15/21] time 0.179 (0.170) data 0.102 (0.093) loss_x loss_x 0.8320 (0.6829) acc_x 78.1250 (81.6667) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/21] time 0.159 (0.169) data 0.083 (0.093) loss_x loss_x 0.6147 (0.7211) acc_x 87.5000 (80.4688) lr 7.8186e-04 eta 0:00:00
epoch [116/200] batch [5/28] time 0.162 (0.168) data 0.084 (0.091) loss_u loss_u 0.9619 (0.9448) acc_u 3.1250 (5.0000) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [10/28] time 0.178 (0.169) data 0.100 (0.092) loss_u loss_u 0.8916 (0.9337) acc_u 12.5000 (7.1875) lr 7.8186e-04 eta 0:00:03
epoch [116/200] batch [15/28] time 0.179 (0.170) data 0.101 (0.093) loss_u loss_u 0.9648 (0.9256) acc_u 3.1250 (8.7500) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [20/28] time 0.188 (0.172) data 0.110 (0.095) loss_u loss_u 0.9473 (0.9170) acc_u 6.2500 (10.0000) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [25/28] time 0.179 (0.173) data 0.102 (0.096) loss_u loss_u 0.8984 (0.9095) acc_u 9.3750 (10.8750) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.4078, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 659
clean true:615
clean false:44
clean_rate:0.9332321699544764
noisy true:490
noisy false:467
after delete: len(clean_dataset) 659
after delete: len(noisy_dataset) 957
epoch [117/200] batch [5/20] time 0.175 (0.172) data 0.098 (0.095) loss_x loss_x 0.6665 (0.5519) acc_x 78.1250 (84.3750) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [10/20] time 0.181 (0.175) data 0.105 (0.098) loss_x loss_x 1.0137 (0.5991) acc_x 75.0000 (83.7500) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [15/20] time 0.181 (0.177) data 0.105 (0.100) loss_x loss_x 0.6802 (0.5893) acc_x 78.1250 (83.7500) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [20/20] time 0.199 (0.180) data 0.123 (0.103) loss_x loss_x 0.9810 (0.6163) acc_x 78.1250 (83.4375) lr 7.6655e-04 eta 0:00:00
epoch [117/200] batch [5/29] time 0.185 (0.181) data 0.108 (0.104) loss_u loss_u 0.7812 (0.8613) acc_u 25.0000 (15.0000) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [10/29] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.8613 (0.8686) acc_u 12.5000 (14.0625) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [15/29] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.8979 (0.8756) acc_u 9.3750 (13.5417) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [20/29] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.9331 (0.8827) acc_u 9.3750 (12.9688) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [25/29] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8125 (0.8791) acc_u 21.8750 (13.5000) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 688
clean true:634
clean false:54
clean_rate:0.9215116279069767
noisy true:491
noisy false:437
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 928
epoch [118/200] batch [5/21] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.6460 (0.5716) acc_x 87.5000 (85.0000) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [10/21] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.5664 (0.5375) acc_x 90.6250 (86.5625) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/21] time 0.172 (0.179) data 0.095 (0.103) loss_x loss_x 0.9146 (0.5871) acc_x 81.2500 (86.2500) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/21] time 0.170 (0.180) data 0.094 (0.103) loss_x loss_x 0.6919 (0.6232) acc_x 84.3750 (85.3125) lr 7.5131e-04 eta 0:00:00
epoch [118/200] batch [5/29] time 0.184 (0.179) data 0.108 (0.102) loss_u loss_u 0.8203 (0.8807) acc_u 21.8750 (13.7500) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/29] time 0.173 (0.179) data 0.095 (0.103) loss_u loss_u 0.9248 (0.9014) acc_u 12.5000 (11.5625) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [15/29] time 0.185 (0.178) data 0.108 (0.102) loss_u loss_u 0.8867 (0.9113) acc_u 12.5000 (10.6250) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [20/29] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9155 (0.8986) acc_u 9.3750 (12.0312) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [25/29] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.9048 (0.8936) acc_u 9.3750 (12.5000) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 530
confident_label rate tensor(0.4183, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 676
clean true:624
clean false:52
clean_rate:0.9230769230769231
noisy true:462
noisy false:478
after delete: len(clean_dataset) 676
after delete: len(noisy_dataset) 940
epoch [119/200] batch [5/21] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.7021 (0.7612) acc_x 81.2500 (80.6250) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [10/21] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6533 (0.7261) acc_x 84.3750 (81.8750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/21] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.5728 (0.7177) acc_x 84.3750 (82.0833) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/21] time 0.184 (0.183) data 0.108 (0.106) loss_x loss_x 0.3274 (0.6672) acc_x 90.6250 (83.1250) lr 7.3613e-04 eta 0:00:00
epoch [119/200] batch [5/29] time 0.177 (0.180) data 0.099 (0.103) loss_u loss_u 0.9360 (0.8932) acc_u 9.3750 (11.8750) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/29] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8794 (0.9033) acc_u 15.6250 (11.2500) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [15/29] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.7778 (0.8840) acc_u 21.8750 (13.1250) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [20/29] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9434 (0.8913) acc_u 3.1250 (11.8750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [25/29] time 0.170 (0.179) data 0.093 (0.102) loss_u loss_u 0.9111 (0.8974) acc_u 9.3750 (11.1250) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.4090, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 661
clean true:612
clean false:49
clean_rate:0.9258698940998488
noisy true:487
noisy false:468
after delete: len(clean_dataset) 661
after delete: len(noisy_dataset) 955
epoch [120/200] batch [5/20] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.7192 (0.6460) acc_x 84.3750 (84.3750) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [10/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.3611 (0.5703) acc_x 93.7500 (86.2500) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [15/20] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.4854 (0.5501) acc_x 84.3750 (86.2500) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [20/20] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7456 (0.5483) acc_x 78.1250 (86.4062) lr 7.2101e-04 eta 0:00:00
epoch [120/200] batch [5/29] time 0.159 (0.179) data 0.083 (0.102) loss_u loss_u 0.9131 (0.9262) acc_u 6.2500 (7.5000) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/29] time 0.174 (0.179) data 0.096 (0.103) loss_u loss_u 0.7661 (0.9043) acc_u 25.0000 (10.9375) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [15/29] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.8838 (0.8929) acc_u 12.5000 (11.6667) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [20/29] time 0.181 (0.179) data 0.104 (0.103) loss_u loss_u 0.8784 (0.8922) acc_u 15.6250 (12.3438) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [25/29] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.9253 (0.8887) acc_u 9.3750 (13.1250) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 528
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:612
clean false:56
clean_rate:0.9161676646706587
noisy true:476
noisy false:472
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [121/200] batch [5/20] time 0.158 (0.161) data 0.081 (0.084) loss_x loss_x 0.4062 (0.5745) acc_x 93.7500 (86.2500) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [10/20] time 0.181 (0.166) data 0.105 (0.089) loss_x loss_x 0.3281 (0.5649) acc_x 90.6250 (84.0625) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [15/20] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 0.7319 (0.5881) acc_x 84.3750 (84.7917) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [20/20] time 0.181 (0.171) data 0.105 (0.095) loss_x loss_x 0.3264 (0.5852) acc_x 93.7500 (84.6875) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/29] time 0.158 (0.171) data 0.080 (0.094) loss_u loss_u 0.8271 (0.8530) acc_u 21.8750 (19.3750) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/29] time 0.181 (0.170) data 0.104 (0.093) loss_u loss_u 0.9375 (0.8729) acc_u 6.2500 (16.2500) lr 7.0596e-04 eta 0:00:03
epoch [121/200] batch [15/29] time 0.181 (0.172) data 0.104 (0.095) loss_u loss_u 0.7510 (0.8568) acc_u 28.1250 (17.9167) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [20/29] time 0.183 (0.174) data 0.105 (0.097) loss_u loss_u 0.9180 (0.8677) acc_u 6.2500 (16.0938) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [25/29] time 0.183 (0.175) data 0.105 (0.098) loss_u loss_u 0.8491 (0.8755) acc_u 18.7500 (14.8750) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:623
clean false:45
clean_rate:0.9326347305389222
noisy true:497
noisy false:451
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [122/200] batch [5/20] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.4370 (0.6470) acc_x 93.7500 (83.7500) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [10/20] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.5874 (0.5921) acc_x 81.2500 (86.2500) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [15/20] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.5649 (0.5915) acc_x 90.6250 (85.2083) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [20/20] time 0.163 (0.175) data 0.087 (0.098) loss_x loss_x 0.8364 (0.6256) acc_x 81.2500 (85.0000) lr 6.9098e-04 eta 0:00:00
epoch [122/200] batch [5/29] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.8716 (0.8287) acc_u 18.7500 (20.6250) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/29] time 0.167 (0.176) data 0.089 (0.099) loss_u loss_u 0.9673 (0.8582) acc_u 6.2500 (16.8750) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [15/29] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.9863 (0.8730) acc_u 0.0000 (15.0000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [20/29] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9336 (0.8787) acc_u 6.2500 (14.0625) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [25/29] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.8921 (0.8762) acc_u 12.5000 (14.2500) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:642
clean false:51
clean_rate:0.9264069264069265
noisy true:484
noisy false:439
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [123/200] batch [5/21] time 0.166 (0.169) data 0.089 (0.092) loss_x loss_x 0.7358 (0.6238) acc_x 75.0000 (85.0000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [10/21] time 0.162 (0.165) data 0.086 (0.089) loss_x loss_x 0.3250 (0.6298) acc_x 87.5000 (83.7500) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [15/21] time 0.170 (0.166) data 0.093 (0.090) loss_x loss_x 0.5518 (0.5883) acc_x 93.7500 (85.4167) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [20/21] time 0.177 (0.169) data 0.100 (0.092) loss_x loss_x 0.3789 (0.5504) acc_x 87.5000 (86.0938) lr 6.7608e-04 eta 0:00:00
epoch [123/200] batch [5/28] time 0.183 (0.171) data 0.107 (0.094) loss_u loss_u 0.7588 (0.8903) acc_u 25.0000 (11.8750) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [10/28] time 0.184 (0.173) data 0.107 (0.097) loss_u loss_u 0.9629 (0.9017) acc_u 6.2500 (10.9375) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [15/28] time 0.184 (0.175) data 0.108 (0.098) loss_u loss_u 0.8618 (0.8845) acc_u 15.6250 (13.1250) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [20/28] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.9722 (0.8933) acc_u 3.1250 (11.7188) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [25/28] time 0.193 (0.177) data 0.115 (0.100) loss_u loss_u 0.9541 (0.8888) acc_u 6.2500 (12.5000) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4220, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 682
clean true:629
clean false:53
clean_rate:0.9222873900293255
noisy true:481
noisy false:453
after delete: len(clean_dataset) 682
after delete: len(noisy_dataset) 934
epoch [124/200] batch [5/21] time 0.182 (0.181) data 0.105 (0.105) loss_x loss_x 0.8032 (0.5584) acc_x 81.2500 (83.7500) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [10/21] time 0.178 (0.175) data 0.100 (0.098) loss_x loss_x 0.5117 (0.6230) acc_x 84.3750 (82.1875) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [15/21] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.4009 (0.5966) acc_x 90.6250 (83.5417) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/21] time 0.178 (0.179) data 0.101 (0.102) loss_x loss_x 1.0156 (0.6745) acc_x 75.0000 (82.3438) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/29] time 0.180 (0.179) data 0.103 (0.103) loss_u loss_u 0.9561 (0.9175) acc_u 3.1250 (8.7500) lr 6.6126e-04 eta 0:00:04
epoch [124/200] batch [10/29] time 0.189 (0.177) data 0.112 (0.100) loss_u loss_u 0.8623 (0.8963) acc_u 18.7500 (11.8750) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [15/29] time 0.184 (0.176) data 0.106 (0.099) loss_u loss_u 0.8799 (0.8950) acc_u 15.6250 (11.8750) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [20/29] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9370 (0.8990) acc_u 9.3750 (11.4062) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [25/29] time 0.193 (0.177) data 0.116 (0.100) loss_u loss_u 0.9375 (0.8959) acc_u 9.3750 (12.0000) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.4245, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 686
clean true:637
clean false:49
clean_rate:0.9285714285714286
noisy true:475
noisy false:455
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 930
epoch [125/200] batch [5/21] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.4114 (0.7499) acc_x 87.5000 (80.0000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [10/21] time 0.183 (0.182) data 0.107 (0.105) loss_x loss_x 0.4929 (0.7663) acc_x 87.5000 (79.0625) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/21] time 0.175 (0.181) data 0.099 (0.105) loss_x loss_x 0.6904 (0.7513) acc_x 84.3750 (79.3750) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/21] time 0.158 (0.180) data 0.081 (0.103) loss_x loss_x 0.7168 (0.7133) acc_x 84.3750 (80.9375) lr 6.4653e-04 eta 0:00:00
epoch [125/200] batch [5/29] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8506 (0.9143) acc_u 18.7500 (10.6250) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/29] time 0.175 (0.179) data 0.098 (0.102) loss_u loss_u 0.8218 (0.8941) acc_u 18.7500 (12.8125) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [15/29] time 0.181 (0.179) data 0.104 (0.102) loss_u loss_u 0.9043 (0.8955) acc_u 12.5000 (12.5000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [20/29] time 0.182 (0.179) data 0.105 (0.102) loss_u loss_u 0.8838 (0.8931) acc_u 15.6250 (12.9688) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [25/29] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8423 (0.8935) acc_u 18.7500 (12.5000) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 503
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 701
clean true:640
clean false:61
clean_rate:0.912981455064194
noisy true:473
noisy false:442
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 915
epoch [126/200] batch [5/21] time 0.167 (0.172) data 0.090 (0.096) loss_x loss_x 0.5918 (0.6456) acc_x 84.3750 (80.0000) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [10/21] time 0.161 (0.168) data 0.084 (0.091) loss_x loss_x 0.4128 (0.6521) acc_x 93.7500 (81.8750) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [15/21] time 0.183 (0.173) data 0.106 (0.097) loss_x loss_x 0.4988 (0.6586) acc_x 75.0000 (81.2500) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/21] time 0.180 (0.177) data 0.103 (0.100) loss_x loss_x 1.3232 (0.6932) acc_x 71.8750 (81.0938) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/28] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.8857 (0.8925) acc_u 12.5000 (11.8750) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/28] time 0.181 (0.178) data 0.105 (0.102) loss_u loss_u 0.8721 (0.9017) acc_u 12.5000 (10.3125) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [15/28] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.8379 (0.8905) acc_u 18.7500 (12.0833) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [20/28] time 0.182 (0.179) data 0.106 (0.103) loss_u loss_u 0.8848 (0.8893) acc_u 12.5000 (12.5000) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [25/28] time 0.183 (0.180) data 0.107 (0.103) loss_u loss_u 0.9028 (0.8918) acc_u 9.3750 (12.2500) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 691
clean true:638
clean false:53
clean_rate:0.9232995658465991
noisy true:473
noisy false:452
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 925
epoch [127/200] batch [5/21] time 0.180 (0.183) data 0.103 (0.106) loss_x loss_x 1.1279 (0.5969) acc_x 68.7500 (85.0000) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [10/21] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.5669 (0.5561) acc_x 90.6250 (87.1875) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [15/21] time 0.184 (0.181) data 0.108 (0.104) loss_x loss_x 0.2812 (0.5832) acc_x 87.5000 (85.4167) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [20/21] time 0.180 (0.181) data 0.103 (0.104) loss_x loss_x 0.8711 (0.5851) acc_x 71.8750 (84.8438) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/28] time 0.180 (0.181) data 0.103 (0.104) loss_u loss_u 0.9111 (0.9311) acc_u 9.3750 (8.1250) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [10/28] time 0.185 (0.181) data 0.109 (0.105) loss_u loss_u 0.9019 (0.9140) acc_u 9.3750 (10.0000) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [15/28] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.9292 (0.9158) acc_u 6.2500 (9.7917) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [20/28] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.8750 (0.9086) acc_u 12.5000 (10.7812) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [25/28] time 0.186 (0.183) data 0.108 (0.106) loss_u loss_u 0.9609 (0.9098) acc_u 3.1250 (10.3750) lr 6.1732e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.4226, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 683
clean true:641
clean false:42
clean_rate:0.9385065885797951
noisy true:485
noisy false:448
after delete: len(clean_dataset) 683
after delete: len(noisy_dataset) 933
epoch [128/200] batch [5/21] time 0.183 (0.192) data 0.107 (0.115) loss_x loss_x 0.6387 (0.6616) acc_x 84.3750 (85.0000) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/21] time 0.185 (0.188) data 0.108 (0.111) loss_x loss_x 0.9258 (0.5700) acc_x 68.7500 (85.9375) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/21] time 0.183 (0.186) data 0.107 (0.110) loss_x loss_x 0.5493 (0.6252) acc_x 90.6250 (84.5833) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [20/21] time 0.165 (0.182) data 0.088 (0.105) loss_x loss_x 0.5195 (0.6694) acc_x 90.6250 (83.5938) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/29] time 0.184 (0.184) data 0.106 (0.107) loss_u loss_u 0.9014 (0.9027) acc_u 9.3750 (11.2500) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [10/29] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.9155 (0.8897) acc_u 9.3750 (12.5000) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [15/29] time 0.172 (0.183) data 0.095 (0.106) loss_u loss_u 0.8428 (0.8898) acc_u 18.7500 (12.7083) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [20/29] time 0.172 (0.181) data 0.094 (0.104) loss_u loss_u 0.9365 (0.8943) acc_u 6.2500 (12.0312) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [25/29] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.8301 (0.8918) acc_u 25.0000 (12.6250) lr 6.0285e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.4158, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 672
clean true:622
clean false:50
clean_rate:0.9255952380952381
noisy true:489
noisy false:455
after delete: len(clean_dataset) 672
after delete: len(noisy_dataset) 944
epoch [129/200] batch [5/21] time 0.182 (0.186) data 0.105 (0.109) loss_x loss_x 0.2212 (0.6671) acc_x 96.8750 (83.7500) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [10/21] time 0.183 (0.190) data 0.106 (0.113) loss_x loss_x 0.3774 (0.6547) acc_x 84.3750 (83.7500) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/21] time 0.183 (0.188) data 0.107 (0.111) loss_x loss_x 0.5498 (0.5759) acc_x 90.6250 (85.8333) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/21] time 0.183 (0.187) data 0.107 (0.110) loss_x loss_x 0.5244 (0.5888) acc_x 87.5000 (85.4688) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/29] time 0.185 (0.186) data 0.109 (0.109) loss_u loss_u 0.9023 (0.9007) acc_u 12.5000 (11.2500) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [10/29] time 0.166 (0.185) data 0.088 (0.108) loss_u loss_u 0.9570 (0.8938) acc_u 3.1250 (12.1875) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [15/29] time 0.166 (0.183) data 0.088 (0.106) loss_u loss_u 0.8667 (0.8928) acc_u 12.5000 (12.2917) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [20/29] time 0.176 (0.181) data 0.099 (0.104) loss_u loss_u 0.8315 (0.8851) acc_u 18.7500 (13.4375) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [25/29] time 0.183 (0.181) data 0.105 (0.104) loss_u loss_u 0.8735 (0.8825) acc_u 18.7500 (13.7500) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 532
confident_label rate tensor(0.4146, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 670
clean true:615
clean false:55
clean_rate:0.917910447761194
noisy true:469
noisy false:477
after delete: len(clean_dataset) 670
after delete: len(noisy_dataset) 946
epoch [130/200] batch [5/20] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.4456 (0.5237) acc_x 87.5000 (87.5000) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [10/20] time 0.194 (0.184) data 0.118 (0.108) loss_x loss_x 0.7920 (0.6127) acc_x 78.1250 (84.6875) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [15/20] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.4153 (0.5902) acc_x 90.6250 (85.4167) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [20/20] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.5742 (0.6120) acc_x 84.3750 (84.6875) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/29] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8599 (0.8693) acc_u 18.7500 (16.8750) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [10/29] time 0.184 (0.183) data 0.106 (0.107) loss_u loss_u 0.7295 (0.8679) acc_u 34.3750 (16.5625) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [15/29] time 0.190 (0.185) data 0.112 (0.108) loss_u loss_u 0.9253 (0.8706) acc_u 9.3750 (15.8333) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [20/29] time 0.161 (0.183) data 0.083 (0.106) loss_u loss_u 0.8540 (0.8698) acc_u 15.6250 (15.7812) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [25/29] time 0.162 (0.181) data 0.085 (0.104) loss_u loss_u 0.9233 (0.8758) acc_u 9.3750 (14.7500) lr 5.7422e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 524
confident_label rate tensor(0.4208, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 680
clean true:621
clean false:59
clean_rate:0.913235294117647
noisy true:471
noisy false:465
after delete: len(clean_dataset) 680
after delete: len(noisy_dataset) 936
epoch [131/200] batch [5/21] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.7847 (0.7709) acc_x 78.1250 (80.0000) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [10/21] time 0.166 (0.173) data 0.089 (0.096) loss_x loss_x 0.3623 (0.6726) acc_x 90.6250 (83.4375) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [15/21] time 0.184 (0.173) data 0.107 (0.096) loss_x loss_x 0.4663 (0.6851) acc_x 90.6250 (82.5000) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/21] time 0.157 (0.173) data 0.080 (0.096) loss_x loss_x 0.4678 (0.6512) acc_x 90.6250 (83.7500) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/29] time 0.171 (0.172) data 0.093 (0.095) loss_u loss_u 0.9312 (0.8628) acc_u 6.2500 (15.6250) lr 5.6006e-04 eta 0:00:04
epoch [131/200] batch [10/29] time 0.183 (0.172) data 0.105 (0.095) loss_u loss_u 0.7871 (0.8703) acc_u 25.0000 (15.3125) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [15/29] time 0.175 (0.173) data 0.097 (0.096) loss_u loss_u 0.9370 (0.8641) acc_u 3.1250 (15.2083) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [20/29] time 0.174 (0.173) data 0.097 (0.096) loss_u loss_u 0.9429 (0.8784) acc_u 6.2500 (13.7500) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [25/29] time 0.185 (0.174) data 0.108 (0.097) loss_u loss_u 0.7998 (0.8798) acc_u 21.8750 (13.5000) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.4233, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 684
clean true:632
clean false:52
clean_rate:0.9239766081871345
noisy true:467
noisy false:465
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 932
epoch [132/200] batch [5/21] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.8027 (0.7500) acc_x 78.1250 (80.6250) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [10/21] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.7261 (0.6492) acc_x 78.1250 (82.8125) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/21] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.9580 (0.6493) acc_x 75.0000 (83.3333) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [20/21] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.7119 (0.6521) acc_x 87.5000 (83.5938) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/29] time 0.167 (0.183) data 0.090 (0.106) loss_u loss_u 0.8921 (0.8802) acc_u 12.5000 (15.0000) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [10/29] time 0.178 (0.181) data 0.102 (0.105) loss_u loss_u 0.8662 (0.8764) acc_u 18.7500 (14.6875) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [15/29] time 0.176 (0.180) data 0.100 (0.104) loss_u loss_u 0.8740 (0.8805) acc_u 12.5000 (14.1667) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [20/29] time 0.164 (0.179) data 0.086 (0.102) loss_u loss_u 0.9067 (0.8729) acc_u 9.3750 (14.5312) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [25/29] time 0.162 (0.178) data 0.085 (0.101) loss_u loss_u 0.9097 (0.8794) acc_u 6.2500 (13.6250) lr 5.4601e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:641
clean false:52
clean_rate:0.924963924963925
noisy true:481
noisy false:442
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [133/200] batch [5/21] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.5781 (0.5695) acc_x 87.5000 (85.6250) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [10/21] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.9766 (0.6490) acc_x 78.1250 (83.4375) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/21] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 1.0244 (0.6378) acc_x 71.8750 (83.5417) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/21] time 0.185 (0.183) data 0.108 (0.107) loss_x loss_x 0.3640 (0.6445) acc_x 93.7500 (83.4375) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/28] time 0.184 (0.184) data 0.108 (0.107) loss_u loss_u 0.9199 (0.8801) acc_u 9.3750 (13.7500) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/28] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.9126 (0.8938) acc_u 9.3750 (12.5000) lr 5.3207e-04 eta 0:00:03
epoch [133/200] batch [15/28] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8672 (0.8920) acc_u 15.6250 (12.5000) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [20/28] time 0.165 (0.181) data 0.089 (0.104) loss_u loss_u 0.9419 (0.8980) acc_u 6.2500 (12.0312) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [25/28] time 0.166 (0.179) data 0.089 (0.102) loss_u loss_u 0.8730 (0.8900) acc_u 15.6250 (13.0000) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 703
clean true:645
clean false:58
clean_rate:0.9174964438122333
noisy true:481
noisy false:432
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 913
epoch [134/200] batch [5/21] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.8555 (0.7385) acc_x 78.1250 (80.6250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [10/21] time 0.183 (0.181) data 0.106 (0.105) loss_x loss_x 0.5435 (0.7097) acc_x 87.5000 (80.9375) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [15/21] time 0.175 (0.177) data 0.099 (0.101) loss_x loss_x 0.2374 (0.6072) acc_x 93.7500 (83.3333) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/21] time 0.175 (0.178) data 0.099 (0.101) loss_x loss_x 0.7319 (0.6198) acc_x 81.2500 (82.9688) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/28] time 0.191 (0.178) data 0.113 (0.101) loss_u loss_u 0.8916 (0.9283) acc_u 18.7500 (9.3750) lr 5.1825e-04 eta 0:00:04
epoch [134/200] batch [10/28] time 0.183 (0.179) data 0.105 (0.102) loss_u loss_u 0.8315 (0.9179) acc_u 21.8750 (10.3125) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [15/28] time 0.185 (0.179) data 0.108 (0.103) loss_u loss_u 0.8682 (0.9195) acc_u 15.6250 (9.3750) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [20/28] time 0.181 (0.180) data 0.104 (0.103) loss_u loss_u 0.8862 (0.9109) acc_u 12.5000 (10.1562) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [25/28] time 0.176 (0.179) data 0.099 (0.102) loss_u loss_u 0.8657 (0.9072) acc_u 15.6250 (10.2500) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.4214, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 681
clean true:635
clean false:46
clean_rate:0.9324522760646109
noisy true:501
noisy false:434
after delete: len(clean_dataset) 681
after delete: len(noisy_dataset) 935
epoch [135/200] batch [5/21] time 0.161 (0.174) data 0.084 (0.098) loss_x loss_x 0.8286 (0.7535) acc_x 87.5000 (80.6250) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [10/21] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 0.4109 (0.6833) acc_x 87.5000 (83.7500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [15/21] time 0.179 (0.175) data 0.102 (0.098) loss_x loss_x 0.5356 (0.5971) acc_x 87.5000 (85.8333) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [20/21] time 0.179 (0.176) data 0.101 (0.099) loss_x loss_x 0.3552 (0.5755) acc_x 87.5000 (85.9375) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/29] time 0.177 (0.176) data 0.099 (0.099) loss_u loss_u 0.8906 (0.8744) acc_u 9.3750 (13.7500) lr 5.0454e-04 eta 0:00:04
epoch [135/200] batch [10/29] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.9077 (0.9097) acc_u 12.5000 (10.0000) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [15/29] time 0.201 (0.176) data 0.124 (0.099) loss_u loss_u 0.9136 (0.9040) acc_u 6.2500 (10.2083) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [20/29] time 0.173 (0.176) data 0.095 (0.099) loss_u loss_u 0.9126 (0.8951) acc_u 12.5000 (11.4062) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [25/29] time 0.157 (0.176) data 0.081 (0.098) loss_u loss_u 0.8818 (0.8911) acc_u 12.5000 (12.1250) lr 5.0454e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 502
confident_label rate tensor(0.4245, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 686
clean true:634
clean false:52
clean_rate:0.924198250728863
noisy true:480
noisy false:450
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 930
epoch [136/200] batch [5/21] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.8242 (0.7169) acc_x 81.2500 (83.7500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [10/21] time 0.183 (0.182) data 0.106 (0.106) loss_x loss_x 0.9019 (0.6847) acc_x 81.2500 (84.6875) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/21] time 0.189 (0.184) data 0.112 (0.107) loss_x loss_x 0.7603 (0.6690) acc_x 75.0000 (83.7500) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/21] time 0.183 (0.185) data 0.107 (0.109) loss_x loss_x 0.5161 (0.6832) acc_x 87.5000 (83.2812) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/29] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.9248 (0.9022) acc_u 6.2500 (10.6250) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/29] time 0.174 (0.185) data 0.097 (0.108) loss_u loss_u 0.7788 (0.8971) acc_u 25.0000 (11.8750) lr 4.9096e-04 eta 0:00:03
epoch [136/200] batch [15/29] time 0.178 (0.184) data 0.102 (0.107) loss_u loss_u 0.8843 (0.8957) acc_u 12.5000 (11.8750) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [20/29] time 0.182 (0.183) data 0.105 (0.107) loss_u loss_u 0.9321 (0.9013) acc_u 9.3750 (11.4062) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [25/29] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.9526 (0.8976) acc_u 3.1250 (11.8750) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 534
confident_label rate tensor(0.4127, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 667
clean true:613
clean false:54
clean_rate:0.9190404797601199
noisy true:469
noisy false:480
after delete: len(clean_dataset) 667
after delete: len(noisy_dataset) 949
epoch [137/200] batch [5/20] time 0.194 (0.186) data 0.117 (0.109) loss_x loss_x 0.5049 (0.5147) acc_x 81.2500 (86.8750) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [10/20] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.6270 (0.5795) acc_x 84.3750 (86.2500) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [15/20] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5918 (0.5884) acc_x 87.5000 (85.4167) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [20/20] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.3770 (0.6018) acc_x 93.7500 (85.4688) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/29] time 0.159 (0.182) data 0.082 (0.105) loss_u loss_u 0.9141 (0.9127) acc_u 9.3750 (10.6250) lr 4.7750e-04 eta 0:00:04
epoch [137/200] batch [10/29] time 0.165 (0.180) data 0.088 (0.104) loss_u loss_u 0.8745 (0.8932) acc_u 12.5000 (12.1875) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [15/29] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8682 (0.8891) acc_u 18.7500 (12.7083) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [20/29] time 0.161 (0.178) data 0.084 (0.101) loss_u loss_u 0.8760 (0.8824) acc_u 15.6250 (13.4375) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [25/29] time 0.166 (0.177) data 0.089 (0.100) loss_u loss_u 0.9082 (0.8824) acc_u 12.5000 (13.5000) lr 4.7750e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 695
clean true:636
clean false:59
clean_rate:0.9151079136690647
noisy true:489
noisy false:432
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 921
epoch [138/200] batch [5/21] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5659 (0.6724) acc_x 84.3750 (83.1250) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [10/21] time 0.180 (0.184) data 0.104 (0.107) loss_x loss_x 0.6816 (0.6464) acc_x 75.0000 (83.7500) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/21] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 1.0811 (0.6544) acc_x 71.8750 (83.1250) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [20/21] time 0.185 (0.185) data 0.109 (0.108) loss_x loss_x 0.6060 (0.6431) acc_x 84.3750 (83.7500) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/28] time 0.182 (0.185) data 0.106 (0.109) loss_u loss_u 0.8984 (0.9163) acc_u 12.5000 (10.0000) lr 4.6417e-04 eta 0:00:04
epoch [138/200] batch [10/28] time 0.181 (0.185) data 0.105 (0.109) loss_u loss_u 0.8794 (0.9098) acc_u 15.6250 (11.2500) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [15/28] time 0.188 (0.185) data 0.111 (0.108) loss_u loss_u 0.8843 (0.9061) acc_u 15.6250 (11.4583) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [20/28] time 0.183 (0.185) data 0.106 (0.108) loss_u loss_u 0.9028 (0.8991) acc_u 15.6250 (12.1875) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [25/28] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.8667 (0.8894) acc_u 15.6250 (13.1250) lr 4.6417e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 483
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 692
clean true:643
clean false:49
clean_rate:0.9291907514450867
noisy true:490
noisy false:434
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 924
epoch [139/200] batch [5/21] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.2700 (0.5922) acc_x 93.7500 (85.0000) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [10/21] time 0.178 (0.177) data 0.101 (0.101) loss_x loss_x 0.4346 (0.5981) acc_x 90.6250 (84.6875) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [15/21] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.7124 (0.6081) acc_x 84.3750 (83.9583) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [20/21] time 0.187 (0.180) data 0.110 (0.104) loss_x loss_x 0.2695 (0.5842) acc_x 93.7500 (85.1562) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/28] time 0.185 (0.181) data 0.109 (0.104) loss_u loss_u 0.9316 (0.8833) acc_u 9.3750 (15.0000) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [10/28] time 0.186 (0.182) data 0.108 (0.105) loss_u loss_u 0.7900 (0.8842) acc_u 25.0000 (13.7500) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [15/28] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.9346 (0.8830) acc_u 6.2500 (13.9583) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [20/28] time 0.173 (0.181) data 0.095 (0.104) loss_u loss_u 0.9336 (0.8945) acc_u 9.3750 (12.8125) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [25/28] time 0.168 (0.179) data 0.091 (0.102) loss_u loss_u 0.9697 (0.8928) acc_u 0.0000 (12.7500) lr 4.5098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 515
confident_label rate tensor(0.4233, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 684
clean true:628
clean false:56
clean_rate:0.9181286549707602
noisy true:473
noisy false:459
after delete: len(clean_dataset) 684
after delete: len(noisy_dataset) 932
epoch [140/200] batch [5/21] time 0.173 (0.181) data 0.096 (0.105) loss_x loss_x 0.9434 (0.5662) acc_x 75.0000 (86.2500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [10/21] time 0.178 (0.179) data 0.102 (0.102) loss_x loss_x 0.4658 (0.5930) acc_x 90.6250 (86.2500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [15/21] time 0.174 (0.177) data 0.097 (0.100) loss_x loss_x 0.5508 (0.6284) acc_x 87.5000 (84.5833) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [20/21] time 0.180 (0.176) data 0.103 (0.100) loss_x loss_x 0.7969 (0.6124) acc_x 78.1250 (84.5312) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/29] time 0.170 (0.177) data 0.093 (0.100) loss_u loss_u 0.9229 (0.8734) acc_u 9.3750 (15.6250) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [10/29] time 0.162 (0.176) data 0.085 (0.099) loss_u loss_u 0.9194 (0.8774) acc_u 6.2500 (13.7500) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [15/29] time 0.181 (0.176) data 0.103 (0.099) loss_u loss_u 0.8594 (0.8795) acc_u 18.7500 (13.7500) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [20/29] time 0.168 (0.176) data 0.091 (0.099) loss_u loss_u 0.8433 (0.8749) acc_u 15.6250 (13.9062) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [25/29] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.8999 (0.8795) acc_u 9.3750 (13.6250) lr 4.3792e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.4313, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 697
clean true:645
clean false:52
clean_rate:0.9253945480631277
noisy true:467
noisy false:452
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 919
epoch [141/200] batch [5/21] time 0.161 (0.175) data 0.084 (0.098) loss_x loss_x 0.7563 (0.6896) acc_x 75.0000 (79.3750) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [10/21] time 0.169 (0.171) data 0.093 (0.094) loss_x loss_x 0.3557 (0.6186) acc_x 93.7500 (83.4375) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [15/21] time 0.184 (0.172) data 0.107 (0.095) loss_x loss_x 0.6855 (0.5889) acc_x 81.2500 (83.7500) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/21] time 0.172 (0.175) data 0.094 (0.098) loss_x loss_x 0.6265 (0.5730) acc_x 75.0000 (84.0625) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/28] time 0.186 (0.177) data 0.108 (0.101) loss_u loss_u 0.9380 (0.8904) acc_u 6.2500 (12.5000) lr 4.2499e-04 eta 0:00:04
epoch [141/200] batch [10/28] time 0.188 (0.178) data 0.111 (0.102) loss_u loss_u 0.9048 (0.8932) acc_u 12.5000 (12.5000) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [15/28] time 0.161 (0.178) data 0.083 (0.101) loss_u loss_u 0.9692 (0.8860) acc_u 6.2500 (13.3333) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [20/28] time 0.159 (0.176) data 0.082 (0.099) loss_u loss_u 0.9229 (0.8857) acc_u 6.2500 (13.4375) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [25/28] time 0.170 (0.175) data 0.094 (0.098) loss_u loss_u 0.7876 (0.8837) acc_u 28.1250 (13.7500) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.4214, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 681
clean true:631
clean false:50
clean_rate:0.9265785609397944
noisy true:485
noisy false:450
after delete: len(clean_dataset) 681
after delete: len(noisy_dataset) 935
epoch [142/200] batch [5/21] time 0.178 (0.179) data 0.101 (0.101) loss_x loss_x 0.6577 (0.4605) acc_x 81.2500 (89.3750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [10/21] time 0.187 (0.178) data 0.109 (0.100) loss_x loss_x 0.5669 (0.5984) acc_x 78.1250 (85.0000) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [15/21] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 1.3164 (0.6739) acc_x 68.7500 (84.1667) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/21] time 0.184 (0.179) data 0.107 (0.102) loss_x loss_x 0.4912 (0.6463) acc_x 93.7500 (85.0000) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/29] time 0.184 (0.180) data 0.106 (0.102) loss_u loss_u 0.8325 (0.8598) acc_u 18.7500 (16.8750) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/29] time 0.185 (0.180) data 0.108 (0.103) loss_u loss_u 0.8931 (0.8599) acc_u 15.6250 (17.1875) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [15/29] time 0.194 (0.183) data 0.116 (0.105) loss_u loss_u 0.9321 (0.8601) acc_u 6.2500 (16.4583) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [20/29] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8770 (0.8667) acc_u 12.5000 (15.7812) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [25/29] time 0.182 (0.181) data 0.104 (0.104) loss_u loss_u 0.8413 (0.8717) acc_u 21.8750 (15.5000) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 506
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:643
clean false:50
clean_rate:0.9278499278499278
noisy true:467
noisy false:456
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [143/200] batch [5/21] time 0.180 (0.184) data 0.104 (0.108) loss_x loss_x 0.4570 (0.5584) acc_x 93.7500 (82.5000) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [10/21] time 0.179 (0.183) data 0.103 (0.106) loss_x loss_x 0.6074 (0.5029) acc_x 87.5000 (85.9375) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/21] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.9912 (0.5762) acc_x 78.1250 (85.0000) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/21] time 0.184 (0.183) data 0.106 (0.106) loss_x loss_x 0.3770 (0.5733) acc_x 90.6250 (85.0000) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/28] time 0.167 (0.181) data 0.090 (0.104) loss_u loss_u 0.8374 (0.8918) acc_u 18.7500 (11.8750) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/28] time 0.164 (0.179) data 0.087 (0.102) loss_u loss_u 0.8462 (0.8829) acc_u 21.8750 (14.0625) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [15/28] time 0.171 (0.177) data 0.093 (0.101) loss_u loss_u 0.9580 (0.8757) acc_u 6.2500 (14.7917) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [20/28] time 0.184 (0.178) data 0.106 (0.101) loss_u loss_u 0.9067 (0.8856) acc_u 9.3750 (13.4375) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [25/28] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.9136 (0.8840) acc_u 9.3750 (13.7500) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 516
confident_label rate tensor(0.4245, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 686
clean true:634
clean false:52
clean_rate:0.924198250728863
noisy true:466
noisy false:464
after delete: len(clean_dataset) 686
after delete: len(noisy_dataset) 930
epoch [144/200] batch [5/21] time 0.186 (0.166) data 0.109 (0.089) loss_x loss_x 0.8779 (0.5485) acc_x 78.1250 (83.7500) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [10/21] time 0.182 (0.174) data 0.105 (0.097) loss_x loss_x 0.5371 (0.6340) acc_x 90.6250 (83.4375) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [15/21] time 0.189 (0.177) data 0.106 (0.100) loss_x loss_x 0.4119 (0.5831) acc_x 90.6250 (84.3750) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [20/21] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.4973 (0.5683) acc_x 84.3750 (84.5312) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/29] time 0.183 (0.180) data 0.106 (0.103) loss_u loss_u 0.8730 (0.8666) acc_u 12.5000 (13.1250) lr 3.8709e-04 eta 0:00:04
epoch [144/200] batch [10/29] time 0.158 (0.178) data 0.082 (0.101) loss_u loss_u 0.8506 (0.8786) acc_u 21.8750 (12.8125) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [15/29] time 0.160 (0.175) data 0.083 (0.098) loss_u loss_u 0.8784 (0.8864) acc_u 15.6250 (12.2917) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [20/29] time 0.157 (0.174) data 0.081 (0.097) loss_u loss_u 0.9395 (0.8867) acc_u 9.3750 (12.5000) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [25/29] time 0.159 (0.173) data 0.082 (0.096) loss_u loss_u 0.9233 (0.8827) acc_u 6.2500 (13.1250) lr 3.8709e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 499
confident_label rate tensor(0.4257, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 688
clean true:635
clean false:53
clean_rate:0.9229651162790697
noisy true:482
noisy false:446
after delete: len(clean_dataset) 688
after delete: len(noisy_dataset) 928
epoch [145/200] batch [5/21] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.5352 (0.5254) acc_x 78.1250 (86.2500) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [10/21] time 0.181 (0.182) data 0.104 (0.105) loss_x loss_x 0.5361 (0.5078) acc_x 90.6250 (86.8750) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [15/21] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.8599 (0.5007) acc_x 71.8750 (86.2500) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [20/21] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.5044 (0.5230) acc_x 84.3750 (86.2500) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/29] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.8457 (0.8305) acc_u 15.6250 (20.0000) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [10/29] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.8423 (0.8547) acc_u 21.8750 (16.8750) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [15/29] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8882 (0.8724) acc_u 12.5000 (14.7917) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [20/29] time 0.184 (0.180) data 0.107 (0.102) loss_u loss_u 0.8901 (0.8782) acc_u 12.5000 (14.2188) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [25/29] time 0.171 (0.179) data 0.093 (0.102) loss_u loss_u 0.8530 (0.8842) acc_u 18.7500 (13.3750) lr 3.7476e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 492
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 691
clean true:639
clean false:52
clean_rate:0.9247467438494935
noisy true:485
noisy false:440
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 925
epoch [146/200] batch [5/21] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 1.0312 (0.6425) acc_x 81.2500 (86.2500) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [10/21] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.5493 (0.5944) acc_x 81.2500 (85.0000) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/21] time 0.173 (0.179) data 0.095 (0.102) loss_x loss_x 0.1987 (0.5731) acc_x 96.8750 (86.0417) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [20/21] time 0.175 (0.179) data 0.099 (0.102) loss_x loss_x 0.8633 (0.5577) acc_x 78.1250 (86.2500) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/28] time 0.169 (0.177) data 0.092 (0.100) loss_u loss_u 0.8413 (0.9021) acc_u 15.6250 (11.8750) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [10/28] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.9277 (0.9054) acc_u 6.2500 (10.6250) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [15/28] time 0.181 (0.177) data 0.105 (0.100) loss_u loss_u 0.8706 (0.8967) acc_u 15.6250 (11.6667) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [20/28] time 0.180 (0.177) data 0.104 (0.100) loss_u loss_u 0.8525 (0.8969) acc_u 18.7500 (11.7188) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [25/28] time 0.185 (0.177) data 0.108 (0.101) loss_u loss_u 0.8213 (0.8990) acc_u 21.8750 (11.5000) lr 3.6258e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.4313, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 697
clean true:645
clean false:52
clean_rate:0.9253945480631277
noisy true:490
noisy false:429
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 919
epoch [147/200] batch [5/21] time 0.157 (0.169) data 0.080 (0.093) loss_x loss_x 1.0439 (0.7354) acc_x 65.6250 (81.8750) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [10/21] time 0.169 (0.171) data 0.093 (0.094) loss_x loss_x 0.9497 (0.6852) acc_x 81.2500 (83.4375) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [15/21] time 0.182 (0.172) data 0.104 (0.096) loss_x loss_x 0.4260 (0.6128) acc_x 90.6250 (84.3750) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/21] time 0.168 (0.173) data 0.091 (0.097) loss_x loss_x 0.5796 (0.5847) acc_x 84.3750 (84.5312) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/28] time 0.186 (0.176) data 0.110 (0.099) loss_u loss_u 0.8765 (0.8578) acc_u 12.5000 (15.6250) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [10/28] time 0.181 (0.177) data 0.105 (0.100) loss_u loss_u 0.8804 (0.8785) acc_u 15.6250 (13.7500) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [15/28] time 0.161 (0.177) data 0.083 (0.101) loss_u loss_u 0.9155 (0.8819) acc_u 9.3750 (13.7500) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [20/28] time 0.173 (0.177) data 0.096 (0.101) loss_u loss_u 0.9150 (0.8839) acc_u 12.5000 (13.5938) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [25/28] time 0.180 (0.177) data 0.103 (0.100) loss_u loss_u 0.9048 (0.8899) acc_u 9.3750 (12.6250) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 699
clean true:647
clean false:52
clean_rate:0.9256080114449213
noisy true:482
noisy false:435
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 917
epoch [148/200] batch [5/21] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.6489 (0.6062) acc_x 84.3750 (85.0000) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [10/21] time 0.175 (0.181) data 0.098 (0.105) loss_x loss_x 0.5000 (0.6224) acc_x 93.7500 (84.6875) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [15/21] time 0.170 (0.177) data 0.093 (0.100) loss_x loss_x 0.4666 (0.5959) acc_x 87.5000 (84.7917) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [20/21] time 0.176 (0.177) data 0.099 (0.101) loss_x loss_x 0.4165 (0.5855) acc_x 90.6250 (85.3125) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/28] time 0.159 (0.178) data 0.081 (0.101) loss_u loss_u 0.9062 (0.8931) acc_u 9.3750 (11.2500) lr 3.3869e-04 eta 0:00:04
epoch [148/200] batch [10/28] time 0.184 (0.178) data 0.108 (0.101) loss_u loss_u 0.9077 (0.8969) acc_u 9.3750 (11.2500) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [15/28] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.8857 (0.8924) acc_u 12.5000 (11.8750) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [20/28] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.9287 (0.9014) acc_u 6.2500 (11.0938) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [25/28] time 0.178 (0.180) data 0.100 (0.103) loss_u loss_u 0.8774 (0.8900) acc_u 12.5000 (12.3750) lr 3.3869e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:648
clean false:59
clean_rate:0.9165487977369166
noisy true:492
noisy false:417
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [149/200] batch [5/22] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.7612 (0.6215) acc_x 75.0000 (81.8750) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/22] time 0.181 (0.183) data 0.104 (0.107) loss_x loss_x 0.8662 (0.5866) acc_x 81.2500 (84.0625) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/22] time 0.183 (0.183) data 0.106 (0.107) loss_x loss_x 0.3081 (0.5658) acc_x 90.6250 (84.7917) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [20/22] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.9365 (0.5792) acc_x 81.2500 (85.7812) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/28] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.8042 (0.8667) acc_u 21.8750 (14.3750) lr 3.2699e-04 eta 0:00:04
epoch [149/200] batch [10/28] time 0.183 (0.183) data 0.105 (0.106) loss_u loss_u 0.9575 (0.8905) acc_u 9.3750 (12.1875) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [15/28] time 0.181 (0.185) data 0.105 (0.108) loss_u loss_u 0.9517 (0.8988) acc_u 6.2500 (11.2500) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [20/28] time 0.182 (0.185) data 0.105 (0.108) loss_u loss_u 0.8823 (0.8984) acc_u 9.3750 (11.2500) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [25/28] time 0.182 (0.184) data 0.105 (0.108) loss_u loss_u 0.9419 (0.8954) acc_u 6.2500 (12.0000) lr 3.2699e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 509
confident_label rate tensor(0.4338, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 701
clean true:641
clean false:60
clean_rate:0.9144079885877318
noisy true:466
noisy false:449
after delete: len(clean_dataset) 701
after delete: len(noisy_dataset) 915
epoch [150/200] batch [5/21] time 0.159 (0.172) data 0.082 (0.095) loss_x loss_x 1.1836 (0.6572) acc_x 68.7500 (85.0000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [10/21] time 0.179 (0.173) data 0.102 (0.097) loss_x loss_x 0.4885 (0.6294) acc_x 84.3750 (84.6875) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [15/21] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.3176 (0.6054) acc_x 93.7500 (84.7917) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [20/21] time 0.169 (0.176) data 0.093 (0.099) loss_x loss_x 0.6348 (0.6157) acc_x 84.3750 (84.6875) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/28] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.9331 (0.8942) acc_u 3.1250 (11.2500) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [10/28] time 0.160 (0.176) data 0.083 (0.099) loss_u loss_u 0.8208 (0.8849) acc_u 21.8750 (13.4375) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [15/28] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8911 (0.8731) acc_u 15.6250 (15.0000) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [20/28] time 0.184 (0.179) data 0.108 (0.102) loss_u loss_u 0.9062 (0.8724) acc_u 12.5000 (15.1562) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [25/28] time 0.183 (0.179) data 0.107 (0.102) loss_u loss_u 0.8384 (0.8820) acc_u 18.7500 (13.8750) lr 3.1545e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:644
clean false:56
clean_rate:0.92
noisy true:479
noisy false:437
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [151/200] batch [5/21] time 0.175 (0.183) data 0.099 (0.106) loss_x loss_x 0.5952 (0.6828) acc_x 84.3750 (83.1250) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [10/21] time 0.167 (0.177) data 0.091 (0.100) loss_x loss_x 0.4180 (0.5794) acc_x 84.3750 (85.0000) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [15/21] time 0.169 (0.178) data 0.092 (0.101) loss_x loss_x 0.5493 (0.6192) acc_x 87.5000 (84.3750) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [20/21] time 0.182 (0.177) data 0.105 (0.100) loss_x loss_x 0.5176 (0.6065) acc_x 84.3750 (85.3125) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/28] time 0.177 (0.177) data 0.099 (0.100) loss_u loss_u 0.8574 (0.9010) acc_u 15.6250 (12.5000) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [10/28] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.8682 (0.9006) acc_u 15.6250 (11.8750) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [15/28] time 0.179 (0.176) data 0.101 (0.099) loss_u loss_u 0.8896 (0.8914) acc_u 12.5000 (12.9167) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [20/28] time 0.171 (0.176) data 0.094 (0.099) loss_u loss_u 0.8252 (0.8907) acc_u 25.0000 (13.1250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [25/28] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.9414 (0.9000) acc_u 6.2500 (11.8750) lr 3.0409e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 495
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 691
clean true:634
clean false:57
clean_rate:0.9175108538350217
noisy true:487
noisy false:438
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 925
epoch [152/200] batch [5/21] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.3687 (0.5322) acc_x 84.3750 (83.1250) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [10/21] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5928 (0.5044) acc_x 81.2500 (85.3125) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/21] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.6436 (0.5382) acc_x 90.6250 (85.0000) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [20/21] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.4690 (0.5598) acc_x 90.6250 (85.0000) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/28] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.8950 (0.8883) acc_u 15.6250 (13.7500) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [10/28] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8799 (0.8824) acc_u 12.5000 (13.7500) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [15/28] time 0.185 (0.183) data 0.107 (0.106) loss_u loss_u 0.9448 (0.8813) acc_u 6.2500 (13.9583) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [20/28] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.8940 (0.8825) acc_u 12.5000 (13.9062) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [25/28] time 0.184 (0.183) data 0.107 (0.106) loss_u loss_u 0.9380 (0.8804) acc_u 6.2500 (13.8750) lr 2.9289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 499
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 691
clean true:636
clean false:55
clean_rate:0.9204052098408104
noisy true:481
noisy false:444
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 925
epoch [153/200] batch [5/21] time 0.185 (0.184) data 0.109 (0.107) loss_x loss_x 0.3333 (0.4470) acc_x 93.7500 (90.0000) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [10/21] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 0.6602 (0.4836) acc_x 78.1250 (86.5625) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [15/21] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.3352 (0.5049) acc_x 93.7500 (86.0417) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [20/21] time 0.179 (0.179) data 0.102 (0.103) loss_x loss_x 0.6670 (0.4990) acc_x 87.5000 (86.8750) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/28] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.8862 (0.9076) acc_u 12.5000 (10.0000) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [10/28] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.9517 (0.9094) acc_u 3.1250 (9.6875) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [15/28] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.8867 (0.8984) acc_u 12.5000 (10.8333) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [20/28] time 0.174 (0.177) data 0.097 (0.100) loss_u loss_u 0.8315 (0.8928) acc_u 18.7500 (11.2500) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [25/28] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.9219 (0.8924) acc_u 9.3750 (11.5000) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 692
clean true:631
clean false:61
clean_rate:0.911849710982659
noisy true:484
noisy false:440
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 924
epoch [154/200] batch [5/21] time 0.171 (0.165) data 0.094 (0.089) loss_x loss_x 0.4185 (0.3561) acc_x 90.6250 (91.2500) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [10/21] time 0.169 (0.171) data 0.092 (0.094) loss_x loss_x 0.8647 (0.5227) acc_x 75.0000 (86.5625) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [15/21] time 0.182 (0.175) data 0.104 (0.098) loss_x loss_x 0.3545 (0.5163) acc_x 93.7500 (86.4583) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [20/21] time 0.181 (0.176) data 0.104 (0.099) loss_x loss_x 1.0068 (0.5734) acc_x 81.2500 (85.7812) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/28] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.8901 (0.8733) acc_u 15.6250 (15.6250) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [10/28] time 0.176 (0.176) data 0.100 (0.099) loss_u loss_u 0.9336 (0.8812) acc_u 9.3750 (13.7500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [15/28] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.7456 (0.8590) acc_u 28.1250 (16.6667) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [20/28] time 0.188 (0.175) data 0.111 (0.098) loss_u loss_u 0.9888 (0.8689) acc_u 0.0000 (15.6250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [25/28] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8613 (0.8657) acc_u 18.7500 (16.0000) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 465
confident_label rate tensor(0.4394, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 710
clean true:649
clean false:61
clean_rate:0.9140845070422535
noisy true:502
noisy false:404
after delete: len(clean_dataset) 710
after delete: len(noisy_dataset) 906
epoch [155/200] batch [5/22] time 0.173 (0.167) data 0.097 (0.090) loss_x loss_x 0.4226 (0.5764) acc_x 87.5000 (87.5000) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [10/22] time 0.179 (0.173) data 0.103 (0.097) loss_x loss_x 0.6021 (0.5782) acc_x 81.2500 (87.1875) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/22] time 0.182 (0.176) data 0.105 (0.100) loss_x loss_x 0.5591 (0.5899) acc_x 78.1250 (85.0000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [20/22] time 0.167 (0.176) data 0.090 (0.099) loss_x loss_x 0.7563 (0.6166) acc_x 78.1250 (84.5312) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/28] time 0.209 (0.176) data 0.132 (0.099) loss_u loss_u 0.8799 (0.8786) acc_u 9.3750 (12.5000) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [10/28] time 0.204 (0.178) data 0.127 (0.102) loss_u loss_u 0.8979 (0.8878) acc_u 12.5000 (12.1875) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [15/28] time 0.176 (0.178) data 0.099 (0.102) loss_u loss_u 0.8477 (0.8858) acc_u 18.7500 (12.7083) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [20/28] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8589 (0.8885) acc_u 15.6250 (12.5000) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [25/28] time 0.176 (0.179) data 0.098 (0.102) loss_u loss_u 0.9541 (0.8938) acc_u 3.1250 (11.8750) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 485
confident_label rate tensor(0.4381, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 708
clean true:652
clean false:56
clean_rate:0.9209039548022598
noisy true:479
noisy false:429
after delete: len(clean_dataset) 708
after delete: len(noisy_dataset) 908
epoch [156/200] batch [5/22] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.4968 (0.4681) acc_x 81.2500 (83.1250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/22] time 0.185 (0.187) data 0.109 (0.110) loss_x loss_x 0.6562 (0.5611) acc_x 81.2500 (82.1875) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/22] time 0.170 (0.182) data 0.093 (0.106) loss_x loss_x 0.6479 (0.5736) acc_x 84.3750 (82.5000) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [20/22] time 0.171 (0.180) data 0.095 (0.104) loss_x loss_x 0.5659 (0.5700) acc_x 90.6250 (84.0625) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/28] time 0.173 (0.178) data 0.097 (0.101) loss_u loss_u 0.8931 (0.8537) acc_u 12.5000 (16.2500) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [10/28] time 0.177 (0.178) data 0.100 (0.102) loss_u loss_u 0.8950 (0.8740) acc_u 6.2500 (13.7500) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [15/28] time 0.174 (0.177) data 0.098 (0.100) loss_u loss_u 0.9155 (0.8909) acc_u 9.3750 (11.8750) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [20/28] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9175 (0.8891) acc_u 9.3750 (12.0312) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [25/28] time 0.192 (0.176) data 0.115 (0.100) loss_u loss_u 0.8862 (0.8900) acc_u 9.3750 (12.2500) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.4251, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 687
clean true:629
clean false:58
clean_rate:0.9155749636098981
noisy true:477
noisy false:452
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 929
epoch [157/200] batch [5/21] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.6978 (0.6629) acc_x 87.5000 (82.5000) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [10/21] time 0.206 (0.180) data 0.130 (0.104) loss_x loss_x 0.9873 (0.7051) acc_x 75.0000 (83.4375) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [15/21] time 0.177 (0.176) data 0.100 (0.100) loss_x loss_x 0.8652 (0.7078) acc_x 84.3750 (82.5000) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [20/21] time 0.168 (0.176) data 0.091 (0.099) loss_x loss_x 0.6348 (0.6876) acc_x 84.3750 (81.8750) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/29] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.8169 (0.8571) acc_u 18.7500 (15.6250) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [10/29] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.7905 (0.8697) acc_u 21.8750 (13.7500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [15/29] time 0.171 (0.174) data 0.094 (0.097) loss_u loss_u 0.9517 (0.8752) acc_u 3.1250 (13.3333) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [20/29] time 0.179 (0.175) data 0.102 (0.098) loss_u loss_u 0.8296 (0.8710) acc_u 18.7500 (13.9062) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [25/29] time 0.169 (0.175) data 0.092 (0.098) loss_u loss_u 0.8931 (0.8794) acc_u 12.5000 (12.8750) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 509
confident_label rate tensor(0.4239, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 685
clean true:630
clean false:55
clean_rate:0.9197080291970803
noisy true:477
noisy false:454
after delete: len(clean_dataset) 685
after delete: len(noisy_dataset) 931
epoch [158/200] batch [5/21] time 0.178 (0.170) data 0.101 (0.093) loss_x loss_x 0.9414 (0.7352) acc_x 78.1250 (82.5000) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [10/21] time 0.159 (0.173) data 0.082 (0.096) loss_x loss_x 0.4653 (0.6039) acc_x 87.5000 (84.6875) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [15/21] time 0.169 (0.174) data 0.093 (0.097) loss_x loss_x 1.0195 (0.6407) acc_x 71.8750 (83.3333) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [20/21] time 0.184 (0.174) data 0.107 (0.097) loss_x loss_x 0.8428 (0.6244) acc_x 75.0000 (83.5938) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/29] time 0.181 (0.176) data 0.103 (0.099) loss_u loss_u 0.9023 (0.8855) acc_u 12.5000 (13.1250) lr 2.2949e-04 eta 0:00:04
epoch [158/200] batch [10/29] time 0.167 (0.177) data 0.090 (0.100) loss_u loss_u 0.9004 (0.8733) acc_u 12.5000 (15.0000) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [15/29] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.8647 (0.8839) acc_u 15.6250 (13.7500) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [20/29] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.8086 (0.8790) acc_u 18.7500 (13.9062) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [25/29] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.8145 (0.8719) acc_u 18.7500 (14.3750) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 512
confident_label rate tensor(0.4301, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 695
clean true:635
clean false:60
clean_rate:0.9136690647482014
noisy true:469
noisy false:452
after delete: len(clean_dataset) 695
after delete: len(noisy_dataset) 921
epoch [159/200] batch [5/21] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 0.2847 (0.5546) acc_x 96.8750 (87.5000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [10/21] time 0.181 (0.184) data 0.104 (0.108) loss_x loss_x 0.5889 (0.5366) acc_x 87.5000 (87.5000) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/21] time 0.182 (0.184) data 0.105 (0.107) loss_x loss_x 1.0518 (0.5723) acc_x 81.2500 (86.8750) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [20/21] time 0.169 (0.181) data 0.093 (0.105) loss_x loss_x 0.4414 (0.5398) acc_x 90.6250 (86.8750) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/28] time 0.168 (0.180) data 0.092 (0.103) loss_u loss_u 0.8877 (0.8803) acc_u 15.6250 (11.8750) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [10/28] time 0.161 (0.178) data 0.084 (0.102) loss_u loss_u 0.8682 (0.8839) acc_u 15.6250 (12.5000) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [15/28] time 0.200 (0.179) data 0.124 (0.102) loss_u loss_u 0.9536 (0.8915) acc_u 3.1250 (11.4583) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [20/28] time 0.180 (0.179) data 0.103 (0.102) loss_u loss_u 0.8335 (0.8827) acc_u 21.8750 (12.9688) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [25/28] time 0.161 (0.177) data 0.084 (0.101) loss_u loss_u 0.9434 (0.8886) acc_u 9.3750 (12.5000) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 694
clean true:637
clean false:57
clean_rate:0.9178674351585014
noisy true:474
noisy false:448
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 922
epoch [160/200] batch [5/21] time 0.183 (0.176) data 0.106 (0.100) loss_x loss_x 0.6011 (0.6399) acc_x 81.2500 (85.6250) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [10/21] time 0.168 (0.172) data 0.091 (0.095) loss_x loss_x 1.0020 (0.6322) acc_x 75.0000 (84.6875) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [15/21] time 0.158 (0.172) data 0.082 (0.096) loss_x loss_x 0.5649 (0.6875) acc_x 87.5000 (82.7083) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [20/21] time 0.187 (0.175) data 0.111 (0.098) loss_x loss_x 0.4546 (0.6461) acc_x 87.5000 (83.7500) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/28] time 0.183 (0.176) data 0.106 (0.100) loss_u loss_u 0.9458 (0.8780) acc_u 6.2500 (14.3750) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [10/28] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8940 (0.8905) acc_u 12.5000 (12.8125) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [15/28] time 0.185 (0.178) data 0.108 (0.102) loss_u loss_u 0.8857 (0.8864) acc_u 12.5000 (12.9167) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [20/28] time 0.182 (0.179) data 0.105 (0.103) loss_u loss_u 0.8584 (0.8788) acc_u 15.6250 (13.5938) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [25/28] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8047 (0.8774) acc_u 25.0000 (13.8750) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.4202, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 679
clean true:626
clean false:53
clean_rate:0.9219440353460973
noisy true:493
noisy false:444
after delete: len(clean_dataset) 679
after delete: len(noisy_dataset) 937
epoch [161/200] batch [5/21] time 0.184 (0.182) data 0.107 (0.106) loss_x loss_x 0.5068 (0.4296) acc_x 87.5000 (91.2500) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [10/21] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.5273 (0.4654) acc_x 81.2500 (88.7500) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [15/21] time 0.180 (0.182) data 0.104 (0.105) loss_x loss_x 0.7153 (0.5228) acc_x 75.0000 (86.4583) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [20/21] time 0.197 (0.181) data 0.120 (0.104) loss_x loss_x 0.5835 (0.5391) acc_x 87.5000 (86.0938) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/29] time 0.183 (0.182) data 0.105 (0.105) loss_u loss_u 0.8911 (0.8659) acc_u 9.3750 (14.3750) lr 2.0032e-04 eta 0:00:04
epoch [161/200] batch [10/29] time 0.176 (0.180) data 0.098 (0.104) loss_u loss_u 0.9023 (0.8667) acc_u 12.5000 (15.6250) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [15/29] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8452 (0.8698) acc_u 15.6250 (14.7917) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [20/29] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8975 (0.8750) acc_u 9.3750 (14.0625) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [25/29] time 0.188 (0.179) data 0.110 (0.102) loss_u loss_u 0.8965 (0.8759) acc_u 12.5000 (14.0000) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 692
clean true:633
clean false:59
clean_rate:0.9147398843930635
noisy true:469
noisy false:455
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 924
epoch [162/200] batch [5/21] time 0.178 (0.174) data 0.101 (0.097) loss_x loss_x 0.4766 (0.5393) acc_x 90.6250 (86.2500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [10/21] time 0.174 (0.177) data 0.097 (0.101) loss_x loss_x 0.6680 (0.6479) acc_x 81.2500 (82.1875) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [15/21] time 0.186 (0.176) data 0.110 (0.099) loss_x loss_x 0.4260 (0.6124) acc_x 90.6250 (83.7500) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [20/21] time 0.195 (0.178) data 0.118 (0.102) loss_x loss_x 0.4751 (0.6217) acc_x 87.5000 (83.5938) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/28] time 0.180 (0.180) data 0.103 (0.103) loss_u loss_u 0.9316 (0.9098) acc_u 6.2500 (10.6250) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [10/28] time 0.182 (0.180) data 0.106 (0.103) loss_u loss_u 0.9194 (0.8863) acc_u 9.3750 (13.1250) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [15/28] time 0.184 (0.180) data 0.107 (0.104) loss_u loss_u 0.8765 (0.8765) acc_u 12.5000 (13.7500) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [20/28] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9053 (0.8761) acc_u 9.3750 (13.4375) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [25/28] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9312 (0.8758) acc_u 6.2500 (13.7500) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 507
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:631
clean false:62
clean_rate:0.9105339105339105
noisy true:478
noisy false:445
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [163/200] batch [5/21] time 0.173 (0.174) data 0.096 (0.097) loss_x loss_x 0.2163 (0.5685) acc_x 93.7500 (86.2500) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [10/21] time 0.185 (0.173) data 0.109 (0.097) loss_x loss_x 0.4980 (0.6126) acc_x 78.1250 (85.9375) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [15/21] time 0.158 (0.173) data 0.081 (0.096) loss_x loss_x 1.0322 (0.5705) acc_x 78.1250 (86.8750) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [20/21] time 0.182 (0.174) data 0.105 (0.098) loss_x loss_x 0.6294 (0.5657) acc_x 81.2500 (85.6250) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/28] time 0.183 (0.177) data 0.105 (0.100) loss_u loss_u 0.8945 (0.8665) acc_u 12.5000 (13.7500) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [10/28] time 0.196 (0.178) data 0.118 (0.101) loss_u loss_u 0.9502 (0.8902) acc_u 6.2500 (11.8750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [15/28] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.8882 (0.8827) acc_u 15.6250 (13.5417) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [20/28] time 0.177 (0.177) data 0.099 (0.100) loss_u loss_u 0.8560 (0.8813) acc_u 15.6250 (13.4375) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [25/28] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.8384 (0.8842) acc_u 18.7500 (13.3750) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 470
confident_label rate tensor(0.4363, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 705
clean true:652
clean false:53
clean_rate:0.924822695035461
noisy true:494
noisy false:417
after delete: len(clean_dataset) 705
after delete: len(noisy_dataset) 911
epoch [164/200] batch [5/22] time 0.182 (0.183) data 0.105 (0.107) loss_x loss_x 0.6543 (0.4056) acc_x 81.2500 (88.7500) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/22] time 0.182 (0.183) data 0.106 (0.106) loss_x loss_x 0.6816 (0.5138) acc_x 84.3750 (86.2500) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/22] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.6924 (0.5390) acc_x 81.2500 (86.6667) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [20/22] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 0.2659 (0.5567) acc_x 93.7500 (85.7812) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/28] time 0.183 (0.183) data 0.106 (0.107) loss_u loss_u 0.9639 (0.9115) acc_u 3.1250 (10.0000) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [10/28] time 0.183 (0.184) data 0.105 (0.108) loss_u loss_u 0.8120 (0.8903) acc_u 18.7500 (12.8125) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [15/28] time 0.194 (0.185) data 0.118 (0.108) loss_u loss_u 0.8643 (0.8814) acc_u 15.6250 (13.3333) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [20/28] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9668 (0.8842) acc_u 6.2500 (13.2812) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [25/28] time 0.185 (0.185) data 0.108 (0.108) loss_u loss_u 0.9272 (0.8930) acc_u 6.2500 (11.8750) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 503
confident_label rate tensor(0.4189, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 677
clean true:624
clean false:53
clean_rate:0.9217134416543574
noisy true:489
noisy false:450
after delete: len(clean_dataset) 677
after delete: len(noisy_dataset) 939
epoch [165/200] batch [5/21] time 0.167 (0.179) data 0.091 (0.103) loss_x loss_x 1.0703 (0.6027) acc_x 75.0000 (84.3750) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [10/21] time 0.176 (0.179) data 0.099 (0.102) loss_x loss_x 0.4116 (0.6449) acc_x 84.3750 (82.5000) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [15/21] time 0.190 (0.180) data 0.114 (0.104) loss_x loss_x 0.3423 (0.5739) acc_x 87.5000 (84.5833) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/21] time 0.184 (0.183) data 0.107 (0.106) loss_x loss_x 0.3123 (0.5806) acc_x 93.7500 (84.8438) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/29] time 0.167 (0.181) data 0.090 (0.104) loss_u loss_u 0.8462 (0.8728) acc_u 18.7500 (15.0000) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [10/29] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9507 (0.8799) acc_u 9.3750 (14.6875) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [15/29] time 0.160 (0.179) data 0.083 (0.102) loss_u loss_u 0.8433 (0.8690) acc_u 18.7500 (15.8333) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [20/29] time 0.174 (0.178) data 0.098 (0.102) loss_u loss_u 0.8032 (0.8652) acc_u 21.8750 (15.6250) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [25/29] time 0.161 (0.177) data 0.084 (0.100) loss_u loss_u 0.9087 (0.8628) acc_u 9.3750 (16.1250) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.4425, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 715
clean true:651
clean false:64
clean_rate:0.9104895104895104
noisy true:469
noisy false:432
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 901
epoch [166/200] batch [5/22] time 0.179 (0.182) data 0.102 (0.105) loss_x loss_x 0.9106 (0.6677) acc_x 68.7500 (80.6250) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/22] time 0.171 (0.182) data 0.095 (0.105) loss_x loss_x 0.9937 (0.6422) acc_x 75.0000 (82.5000) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/22] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.6738 (0.6589) acc_x 87.5000 (83.3333) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [20/22] time 0.200 (0.180) data 0.123 (0.104) loss_x loss_x 0.4231 (0.6192) acc_x 84.3750 (83.7500) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/28] time 0.168 (0.180) data 0.092 (0.103) loss_u loss_u 0.9443 (0.9232) acc_u 6.2500 (9.3750) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [10/28] time 0.166 (0.179) data 0.089 (0.102) loss_u loss_u 0.8848 (0.9159) acc_u 15.6250 (10.0000) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [15/28] time 0.161 (0.178) data 0.083 (0.101) loss_u loss_u 0.8472 (0.9055) acc_u 15.6250 (11.0417) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [20/28] time 0.178 (0.177) data 0.101 (0.100) loss_u loss_u 0.8623 (0.8910) acc_u 18.7500 (13.1250) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [25/28] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8911 (0.8905) acc_u 15.6250 (13.1250) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:635
clean false:65
clean_rate:0.9071428571428571
noisy true:484
noisy false:432
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [167/200] batch [5/21] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.4575 (0.4354) acc_x 87.5000 (89.3750) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [10/21] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.3418 (0.5448) acc_x 93.7500 (86.8750) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [15/21] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 0.3960 (0.5596) acc_x 87.5000 (86.4583) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [20/21] time 0.181 (0.184) data 0.105 (0.107) loss_x loss_x 0.9170 (0.6057) acc_x 75.0000 (85.4688) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/28] time 0.174 (0.183) data 0.097 (0.107) loss_u loss_u 0.8438 (0.8457) acc_u 18.7500 (16.8750) lr 1.4736e-04 eta 0:00:04
epoch [167/200] batch [10/28] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.9595 (0.8782) acc_u 3.1250 (13.1250) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [15/28] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.7925 (0.8817) acc_u 21.8750 (13.1250) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [20/28] time 0.160 (0.180) data 0.083 (0.103) loss_u loss_u 0.8501 (0.8823) acc_u 15.6250 (13.2812) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [25/28] time 0.184 (0.181) data 0.106 (0.104) loss_u loss_u 0.8428 (0.8793) acc_u 18.7500 (13.7500) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.4313, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 697
clean true:636
clean false:61
clean_rate:0.9124820659971306
noisy true:484
noisy false:435
after delete: len(clean_dataset) 697
after delete: len(noisy_dataset) 919
epoch [168/200] batch [5/21] time 0.164 (0.178) data 0.088 (0.102) loss_x loss_x 0.7559 (0.6511) acc_x 81.2500 (84.3750) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [10/21] time 0.181 (0.175) data 0.105 (0.099) loss_x loss_x 0.5161 (0.6124) acc_x 84.3750 (84.6875) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [15/21] time 0.181 (0.177) data 0.104 (0.101) loss_x loss_x 0.2452 (0.5564) acc_x 96.8750 (87.0833) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [20/21] time 0.184 (0.178) data 0.107 (0.102) loss_x loss_x 0.2976 (0.5786) acc_x 93.7500 (85.4688) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/28] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.8726 (0.8562) acc_u 15.6250 (15.6250) lr 1.3926e-04 eta 0:00:04
epoch [168/200] batch [10/28] time 0.183 (0.181) data 0.106 (0.104) loss_u loss_u 0.9160 (0.8836) acc_u 9.3750 (12.8125) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [15/28] time 0.183 (0.181) data 0.106 (0.105) loss_u loss_u 0.8594 (0.8747) acc_u 18.7500 (14.1667) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [20/28] time 0.174 (0.181) data 0.096 (0.104) loss_u loss_u 0.9214 (0.8796) acc_u 6.2500 (13.4375) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [25/28] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.9038 (0.8824) acc_u 15.6250 (13.3750) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 699
clean true:634
clean false:65
clean_rate:0.9070100143061517
noisy true:489
noisy false:428
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 917
epoch [169/200] batch [5/21] time 0.166 (0.165) data 0.089 (0.088) loss_x loss_x 0.3564 (0.4829) acc_x 90.6250 (85.6250) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [10/21] time 0.184 (0.172) data 0.108 (0.095) loss_x loss_x 0.3394 (0.5868) acc_x 93.7500 (83.1250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [15/21] time 0.183 (0.176) data 0.106 (0.099) loss_x loss_x 0.3008 (0.5436) acc_x 93.7500 (85.2083) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [20/21] time 0.182 (0.177) data 0.106 (0.100) loss_x loss_x 0.5610 (0.5480) acc_x 87.5000 (85.0000) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/28] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.9062 (0.8893) acc_u 12.5000 (13.1250) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [10/28] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8843 (0.8914) acc_u 15.6250 (12.5000) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [15/28] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.8540 (0.8918) acc_u 18.7500 (12.2917) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [20/28] time 0.182 (0.179) data 0.104 (0.103) loss_u loss_u 0.9253 (0.8863) acc_u 9.3750 (13.2812) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [25/28] time 0.175 (0.179) data 0.098 (0.103) loss_u loss_u 0.9209 (0.8879) acc_u 9.3750 (12.8750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.4239, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 685
clean true:628
clean false:57
clean_rate:0.9167883211678832
noisy true:483
noisy false:448
after delete: len(clean_dataset) 685
after delete: len(noisy_dataset) 931
epoch [170/200] batch [5/21] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.7168 (0.6304) acc_x 78.1250 (80.0000) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [10/21] time 0.165 (0.179) data 0.089 (0.103) loss_x loss_x 0.5469 (0.6157) acc_x 87.5000 (82.1875) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [15/21] time 0.176 (0.179) data 0.100 (0.102) loss_x loss_x 0.6182 (0.6505) acc_x 84.3750 (81.8750) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [20/21] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.9160 (0.6288) acc_x 75.0000 (82.8125) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/29] time 0.179 (0.178) data 0.102 (0.101) loss_u loss_u 0.8950 (0.8544) acc_u 9.3750 (15.6250) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [10/29] time 0.159 (0.177) data 0.082 (0.100) loss_u loss_u 0.8081 (0.8628) acc_u 21.8750 (14.6875) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [15/29] time 0.174 (0.176) data 0.096 (0.099) loss_u loss_u 0.9136 (0.8658) acc_u 9.3750 (14.5833) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [20/29] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.9316 (0.8679) acc_u 9.3750 (14.2188) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [25/29] time 0.158 (0.175) data 0.082 (0.098) loss_u loss_u 0.8931 (0.8689) acc_u 12.5000 (14.2500) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 507
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:640
clean false:53
clean_rate:0.9235209235209235
noisy true:469
noisy false:454
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [171/200] batch [5/21] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.6426 (0.5444) acc_x 81.2500 (85.0000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [10/21] time 0.184 (0.186) data 0.108 (0.109) loss_x loss_x 0.6948 (0.5528) acc_x 81.2500 (84.6875) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/21] time 0.184 (0.185) data 0.108 (0.108) loss_x loss_x 0.9219 (0.6173) acc_x 68.7500 (82.0833) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [20/21] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.7017 (0.6006) acc_x 81.2500 (83.1250) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/28] time 0.184 (0.185) data 0.106 (0.108) loss_u loss_u 0.8286 (0.8803) acc_u 18.7500 (15.0000) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [10/28] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.9307 (0.8797) acc_u 6.2500 (15.0000) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [15/28] time 0.191 (0.185) data 0.112 (0.108) loss_u loss_u 0.7939 (0.8756) acc_u 21.8750 (15.8333) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [20/28] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.8550 (0.8785) acc_u 12.5000 (15.1562) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [25/28] time 0.185 (0.185) data 0.107 (0.108) loss_u loss_u 0.9395 (0.8771) acc_u 9.3750 (15.2500) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 486
confident_label rate tensor(0.4406, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 712
clean true:650
clean false:62
clean_rate:0.9129213483146067
noisy true:480
noisy false:424
after delete: len(clean_dataset) 712
after delete: len(noisy_dataset) 904
epoch [172/200] batch [5/22] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.7476 (0.7758) acc_x 84.3750 (81.2500) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/22] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7192 (0.7463) acc_x 81.2500 (81.5625) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/22] time 0.181 (0.183) data 0.104 (0.106) loss_x loss_x 0.5708 (0.6898) acc_x 87.5000 (82.7083) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [20/22] time 0.172 (0.181) data 0.095 (0.104) loss_x loss_x 0.8247 (0.6668) acc_x 78.1250 (83.5938) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/28] time 0.181 (0.181) data 0.104 (0.104) loss_u loss_u 0.9336 (0.9136) acc_u 6.2500 (8.1250) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [10/28] time 0.190 (0.182) data 0.113 (0.105) loss_u loss_u 0.9009 (0.9036) acc_u 9.3750 (10.0000) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [15/28] time 0.184 (0.182) data 0.108 (0.105) loss_u loss_u 0.9600 (0.9039) acc_u 6.2500 (10.6250) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [20/28] time 0.181 (0.182) data 0.104 (0.105) loss_u loss_u 0.8496 (0.8981) acc_u 18.7500 (11.5625) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [25/28] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8921 (0.8919) acc_u 12.5000 (12.5000) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 502
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:637
clean false:56
clean_rate:0.9191919191919192
noisy true:477
noisy false:446
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [173/200] batch [5/21] time 0.182 (0.182) data 0.106 (0.106) loss_x loss_x 0.6396 (0.7639) acc_x 90.6250 (83.7500) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [10/21] time 0.182 (0.182) data 0.105 (0.106) loss_x loss_x 0.5049 (0.6330) acc_x 81.2500 (85.6250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [15/21] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.5518 (0.6044) acc_x 84.3750 (86.2500) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [20/21] time 0.180 (0.182) data 0.103 (0.106) loss_x loss_x 1.0752 (0.6081) acc_x 75.0000 (86.2500) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/28] time 0.167 (0.180) data 0.090 (0.104) loss_u loss_u 0.7896 (0.8798) acc_u 25.0000 (13.7500) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [10/28] time 0.158 (0.177) data 0.082 (0.101) loss_u loss_u 0.8828 (0.8746) acc_u 12.5000 (13.7500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [15/28] time 0.181 (0.178) data 0.104 (0.101) loss_u loss_u 0.9229 (0.8812) acc_u 12.5000 (13.5417) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [20/28] time 0.185 (0.178) data 0.107 (0.101) loss_u loss_u 0.9170 (0.8864) acc_u 12.5000 (12.9688) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [25/28] time 0.167 (0.178) data 0.090 (0.101) loss_u loss_u 0.8950 (0.8868) acc_u 12.5000 (12.6250) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.4400, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 711
clean true:641
clean false:70
clean_rate:0.9015471167369902
noisy true:465
noisy false:440
after delete: len(clean_dataset) 711
after delete: len(noisy_dataset) 905
epoch [174/200] batch [5/22] time 0.180 (0.171) data 0.103 (0.094) loss_x loss_x 0.7959 (0.6647) acc_x 87.5000 (87.5000) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [10/22] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.4351 (0.5886) acc_x 93.7500 (88.1250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/22] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.8721 (0.5602) acc_x 75.0000 (87.5000) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [20/22] time 0.174 (0.176) data 0.097 (0.099) loss_x loss_x 1.0254 (0.5889) acc_x 71.8750 (86.4062) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/28] time 0.180 (0.176) data 0.103 (0.099) loss_u loss_u 0.9019 (0.8924) acc_u 12.5000 (11.2500) lr 9.5173e-05 eta 0:00:04
epoch [174/200] batch [10/28] time 0.160 (0.176) data 0.082 (0.098) loss_u loss_u 0.8750 (0.8875) acc_u 18.7500 (12.8125) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [15/28] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.8960 (0.8878) acc_u 15.6250 (12.9167) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [20/28] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.9556 (0.8988) acc_u 6.2500 (12.0312) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [25/28] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.7969 (0.8881) acc_u 31.2500 (13.2500) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.4270, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 690
clean true:637
clean false:53
clean_rate:0.9231884057971015
noisy true:482
noisy false:444
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 926
epoch [175/200] batch [5/21] time 0.159 (0.159) data 0.083 (0.082) loss_x loss_x 0.6606 (0.5739) acc_x 90.6250 (86.2500) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [10/21] time 0.175 (0.167) data 0.098 (0.091) loss_x loss_x 0.6260 (0.5527) acc_x 84.3750 (86.8750) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [15/21] time 0.197 (0.172) data 0.121 (0.096) loss_x loss_x 0.4146 (0.5039) acc_x 87.5000 (87.5000) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [20/21] time 0.205 (0.175) data 0.129 (0.099) loss_x loss_x 0.7490 (0.5010) acc_x 78.1250 (87.5000) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/28] time 0.183 (0.177) data 0.106 (0.101) loss_u loss_u 0.8613 (0.8918) acc_u 15.6250 (11.8750) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [10/28] time 0.180 (0.178) data 0.103 (0.101) loss_u loss_u 0.8726 (0.8775) acc_u 18.7500 (13.7500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [15/28] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.9136 (0.8825) acc_u 9.3750 (12.9167) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [20/28] time 0.196 (0.180) data 0.118 (0.103) loss_u loss_u 0.8652 (0.8802) acc_u 15.6250 (12.9688) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [25/28] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.7847 (0.8778) acc_u 25.0000 (13.3750) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 489
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 699
clean true:646
clean false:53
clean_rate:0.9241773962804005
noisy true:481
noisy false:436
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 917
epoch [176/200] batch [5/21] time 0.181 (0.183) data 0.105 (0.106) loss_x loss_x 0.1622 (0.5955) acc_x 96.8750 (86.8750) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [10/21] time 0.176 (0.182) data 0.100 (0.106) loss_x loss_x 0.2864 (0.5929) acc_x 90.6250 (85.6250) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/21] time 0.160 (0.175) data 0.084 (0.098) loss_x loss_x 0.3997 (0.5628) acc_x 93.7500 (87.2917) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [20/21] time 0.161 (0.171) data 0.084 (0.095) loss_x loss_x 0.3716 (0.5898) acc_x 87.5000 (86.4062) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/28] time 0.160 (0.169) data 0.082 (0.092) loss_u loss_u 0.9058 (0.9001) acc_u 9.3750 (10.6250) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/28] time 0.159 (0.168) data 0.082 (0.092) loss_u loss_u 0.8599 (0.8827) acc_u 15.6250 (12.5000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [15/28] time 0.182 (0.169) data 0.106 (0.093) loss_u loss_u 0.9600 (0.8924) acc_u 6.2500 (12.0833) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [20/28] time 0.224 (0.173) data 0.148 (0.096) loss_u loss_u 0.7114 (0.8801) acc_u 34.3750 (13.5938) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [25/28] time 0.186 (0.174) data 0.109 (0.097) loss_u loss_u 0.8945 (0.8739) acc_u 12.5000 (14.1250) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 514
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 691
clean true:634
clean false:57
clean_rate:0.9175108538350217
noisy true:468
noisy false:457
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 925
epoch [177/200] batch [5/21] time 0.176 (0.180) data 0.100 (0.104) loss_x loss_x 0.4824 (0.5327) acc_x 84.3750 (86.8750) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [10/21] time 0.187 (0.175) data 0.110 (0.099) loss_x loss_x 1.0361 (0.5610) acc_x 78.1250 (86.8750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [15/21] time 0.176 (0.179) data 0.100 (0.103) loss_x loss_x 0.4966 (0.5660) acc_x 87.5000 (85.8333) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [20/21] time 0.223 (0.182) data 0.146 (0.106) loss_x loss_x 0.4795 (0.5563) acc_x 87.5000 (86.0938) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/28] time 0.169 (0.182) data 0.092 (0.106) loss_u loss_u 0.9077 (0.8848) acc_u 9.3750 (12.5000) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [10/28] time 0.179 (0.182) data 0.103 (0.106) loss_u loss_u 0.9336 (0.8907) acc_u 9.3750 (12.1875) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [15/28] time 0.183 (0.182) data 0.107 (0.106) loss_u loss_u 0.8701 (0.8899) acc_u 15.6250 (11.8750) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [20/28] time 0.185 (0.182) data 0.109 (0.106) loss_u loss_u 0.8740 (0.8768) acc_u 15.6250 (13.4375) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [25/28] time 0.177 (0.182) data 0.100 (0.106) loss_u loss_u 0.8530 (0.8806) acc_u 18.7500 (13.2500) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 483
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 716
clean true:657
clean false:59
clean_rate:0.9175977653631285
noisy true:476
noisy false:424
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 900
epoch [178/200] batch [5/22] time 0.174 (0.167) data 0.096 (0.091) loss_x loss_x 0.5186 (0.6591) acc_x 90.6250 (84.3750) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [10/22] time 0.174 (0.176) data 0.096 (0.099) loss_x loss_x 0.4102 (0.6056) acc_x 90.6250 (84.0625) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/22] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.6079 (0.5641) acc_x 84.3750 (84.7917) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [20/22] time 0.188 (0.182) data 0.112 (0.106) loss_x loss_x 0.8174 (0.5725) acc_x 78.1250 (84.3750) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/28] time 0.161 (0.183) data 0.083 (0.106) loss_u loss_u 0.8589 (0.8975) acc_u 18.7500 (13.1250) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [10/28] time 0.160 (0.179) data 0.083 (0.102) loss_u loss_u 0.9595 (0.9063) acc_u 3.1250 (10.9375) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [15/28] time 0.179 (0.179) data 0.101 (0.102) loss_u loss_u 0.9351 (0.9025) acc_u 6.2500 (11.2500) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [20/28] time 0.187 (0.180) data 0.108 (0.103) loss_u loss_u 0.8569 (0.9002) acc_u 18.7500 (11.8750) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [25/28] time 0.182 (0.180) data 0.105 (0.103) loss_u loss_u 0.9219 (0.8894) acc_u 9.3750 (12.7500) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 525
confident_label rate tensor(0.4251, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 687
clean true:632
clean false:55
clean_rate:0.9199417758369723
noisy true:459
noisy false:470
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 929
epoch [179/200] batch [5/21] time 0.170 (0.174) data 0.093 (0.098) loss_x loss_x 0.7192 (0.6627) acc_x 78.1250 (81.2500) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [10/21] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.4297 (0.6441) acc_x 84.3750 (81.8750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [15/21] time 0.169 (0.173) data 0.092 (0.096) loss_x loss_x 0.6831 (0.6368) acc_x 81.2500 (81.8750) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [20/21] time 0.172 (0.173) data 0.095 (0.097) loss_x loss_x 0.2285 (0.5927) acc_x 96.8750 (83.1250) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/29] time 0.184 (0.174) data 0.106 (0.097) loss_u loss_u 0.8652 (0.8273) acc_u 15.6250 (19.3750) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [10/29] time 0.182 (0.175) data 0.105 (0.098) loss_u loss_u 0.8779 (0.8539) acc_u 12.5000 (16.8750) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [15/29] time 0.177 (0.175) data 0.098 (0.098) loss_u loss_u 0.8755 (0.8523) acc_u 15.6250 (17.0833) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [20/29] time 0.175 (0.175) data 0.098 (0.098) loss_u loss_u 0.8994 (0.8721) acc_u 9.3750 (14.8438) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [25/29] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.8989 (0.8775) acc_u 15.6250 (14.3750) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.4381, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 708
clean true:648
clean false:60
clean_rate:0.9152542372881356
noisy true:470
noisy false:438
after delete: len(clean_dataset) 708
after delete: len(noisy_dataset) 908
epoch [180/200] batch [5/22] time 0.185 (0.186) data 0.109 (0.110) loss_x loss_x 0.5317 (0.7239) acc_x 87.5000 (82.5000) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [10/22] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 0.8164 (0.5892) acc_x 84.3750 (85.0000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [15/22] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 0.2720 (0.5562) acc_x 93.7500 (85.2083) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [20/22] time 0.185 (0.185) data 0.108 (0.109) loss_x loss_x 1.1348 (0.5624) acc_x 71.8750 (84.8438) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/28] time 0.185 (0.186) data 0.108 (0.109) loss_u loss_u 0.7241 (0.8810) acc_u 31.2500 (12.5000) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/28] time 0.185 (0.187) data 0.108 (0.110) loss_u loss_u 0.9312 (0.9052) acc_u 9.3750 (10.3125) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/28] time 0.177 (0.186) data 0.099 (0.109) loss_u loss_u 0.8496 (0.9089) acc_u 12.5000 (10.0000) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/28] time 0.183 (0.186) data 0.106 (0.109) loss_u loss_u 0.8081 (0.9040) acc_u 25.0000 (10.9375) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [25/28] time 0.184 (0.186) data 0.106 (0.109) loss_u loss_u 0.7495 (0.8979) acc_u 31.2500 (11.7500) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.4350, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 703
clean true:643
clean false:60
clean_rate:0.914651493598862
noisy true:477
noisy false:436
after delete: len(clean_dataset) 703
after delete: len(noisy_dataset) 913
epoch [181/200] batch [5/21] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.6709 (0.5565) acc_x 84.3750 (86.8750) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/21] time 0.185 (0.180) data 0.108 (0.104) loss_x loss_x 0.3259 (0.5723) acc_x 96.8750 (87.8125) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/21] time 0.180 (0.179) data 0.104 (0.103) loss_x loss_x 0.4758 (0.5678) acc_x 90.6250 (87.2917) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [20/21] time 0.183 (0.178) data 0.106 (0.102) loss_x loss_x 0.5420 (0.5332) acc_x 81.2500 (87.5000) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/28] time 0.167 (0.178) data 0.089 (0.102) loss_u loss_u 0.8423 (0.8998) acc_u 18.7500 (10.6250) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/28] time 0.178 (0.178) data 0.101 (0.101) loss_u loss_u 0.9565 (0.8918) acc_u 3.1250 (11.5625) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/28] time 0.183 (0.178) data 0.107 (0.101) loss_u loss_u 0.9233 (0.8923) acc_u 9.3750 (11.6667) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/28] time 0.180 (0.178) data 0.104 (0.101) loss_u loss_u 0.8857 (0.8885) acc_u 15.6250 (12.1875) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/28] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.8784 (0.8897) acc_u 15.6250 (12.3750) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 691
clean true:632
clean false:59
clean_rate:0.914616497829233
noisy true:487
noisy false:438
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 925
epoch [182/200] batch [5/21] time 0.159 (0.174) data 0.082 (0.097) loss_x loss_x 0.4985 (0.5017) acc_x 84.3750 (87.5000) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/21] time 0.174 (0.175) data 0.097 (0.098) loss_x loss_x 0.3303 (0.4729) acc_x 96.8750 (88.4375) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/21] time 0.189 (0.175) data 0.112 (0.098) loss_x loss_x 0.3618 (0.4821) acc_x 87.5000 (87.2917) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [20/21] time 0.169 (0.174) data 0.092 (0.098) loss_x loss_x 0.2864 (0.5162) acc_x 87.5000 (86.8750) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/28] time 0.186 (0.174) data 0.107 (0.097) loss_u loss_u 0.8911 (0.9080) acc_u 12.5000 (11.8750) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/28] time 0.188 (0.176) data 0.111 (0.099) loss_u loss_u 0.8389 (0.8988) acc_u 15.6250 (12.5000) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/28] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.9614 (0.8954) acc_u 3.1250 (12.2917) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/28] time 0.183 (0.178) data 0.106 (0.101) loss_u loss_u 0.8799 (0.8887) acc_u 9.3750 (12.6562) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/28] time 0.188 (0.179) data 0.112 (0.102) loss_u loss_u 0.8711 (0.8790) acc_u 15.6250 (13.6250) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 501
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 714
clean true:653
clean false:61
clean_rate:0.9145658263305322
noisy true:462
noisy false:440
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 902
epoch [183/200] batch [5/22] time 0.179 (0.171) data 0.102 (0.094) loss_x loss_x 0.2637 (0.4551) acc_x 96.8750 (90.6250) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/22] time 0.176 (0.173) data 0.099 (0.096) loss_x loss_x 0.2920 (0.5322) acc_x 96.8750 (88.7500) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [15/22] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.6084 (0.5317) acc_x 90.6250 (88.9583) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [20/22] time 0.166 (0.174) data 0.090 (0.097) loss_x loss_x 0.4756 (0.5526) acc_x 81.2500 (87.8125) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/28] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.8652 (0.8939) acc_u 15.6250 (12.5000) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/28] time 0.188 (0.176) data 0.110 (0.099) loss_u loss_u 0.9805 (0.9063) acc_u 3.1250 (11.2500) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/28] time 0.185 (0.176) data 0.107 (0.099) loss_u loss_u 0.7441 (0.8896) acc_u 31.2500 (13.3333) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/28] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8765 (0.8909) acc_u 15.6250 (13.1250) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/28] time 0.174 (0.177) data 0.098 (0.100) loss_u loss_u 0.7900 (0.8870) acc_u 25.0000 (13.5000) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 468
confident_label rate tensor(0.4418, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 714
clean true:660
clean false:54
clean_rate:0.9243697478991597
noisy true:488
noisy false:414
after delete: len(clean_dataset) 714
after delete: len(noisy_dataset) 902
epoch [184/200] batch [5/22] time 0.184 (0.180) data 0.108 (0.104) loss_x loss_x 0.5044 (0.6152) acc_x 87.5000 (84.3750) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [10/22] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.6167 (0.6619) acc_x 87.5000 (82.5000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [15/22] time 0.168 (0.177) data 0.092 (0.101) loss_x loss_x 0.5825 (0.6211) acc_x 84.3750 (83.9583) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [20/22] time 0.171 (0.176) data 0.094 (0.100) loss_x loss_x 0.5620 (0.6375) acc_x 87.5000 (83.4375) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/28] time 0.178 (0.175) data 0.100 (0.099) loss_u loss_u 0.9727 (0.8998) acc_u 3.1250 (11.2500) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/28] time 0.159 (0.174) data 0.083 (0.097) loss_u loss_u 0.9365 (0.8970) acc_u 6.2500 (11.5625) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/28] time 0.188 (0.174) data 0.112 (0.097) loss_u loss_u 0.9038 (0.8928) acc_u 9.3750 (12.0833) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/28] time 0.181 (0.175) data 0.105 (0.098) loss_u loss_u 0.9028 (0.8891) acc_u 9.3750 (12.6562) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [25/28] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.8687 (0.8884) acc_u 15.6250 (12.6250) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 470
confident_label rate tensor(0.4455, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 720
clean true:657
clean false:63
clean_rate:0.9125
noisy true:489
noisy false:407
after delete: len(clean_dataset) 720
after delete: len(noisy_dataset) 896
epoch [185/200] batch [5/22] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.2839 (0.5483) acc_x 96.8750 (85.6250) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [10/22] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.6704 (0.5991) acc_x 81.2500 (85.6250) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [15/22] time 0.182 (0.184) data 0.106 (0.107) loss_x loss_x 0.4111 (0.6107) acc_x 87.5000 (83.3333) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [20/22] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 1.6768 (0.6466) acc_x 75.0000 (83.7500) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/28] time 0.183 (0.184) data 0.106 (0.107) loss_u loss_u 0.7925 (0.8504) acc_u 21.8750 (17.5000) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/28] time 0.186 (0.184) data 0.108 (0.107) loss_u loss_u 0.9033 (0.8724) acc_u 9.3750 (14.3750) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/28] time 0.184 (0.185) data 0.108 (0.108) loss_u loss_u 0.8740 (0.8794) acc_u 12.5000 (13.3333) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/28] time 0.166 (0.185) data 0.089 (0.108) loss_u loss_u 0.9023 (0.8871) acc_u 15.6250 (12.9688) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [25/28] time 0.182 (0.183) data 0.105 (0.106) loss_u loss_u 0.9341 (0.8897) acc_u 9.3750 (12.5000) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 509
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 706
clean true:646
clean false:60
clean_rate:0.9150141643059491
noisy true:461
noisy false:449
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 910
epoch [186/200] batch [5/22] time 0.166 (0.179) data 0.090 (0.102) loss_x loss_x 0.2900 (0.6474) acc_x 96.8750 (85.6250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/22] time 0.193 (0.179) data 0.116 (0.103) loss_x loss_x 0.5146 (0.5878) acc_x 84.3750 (85.6250) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [15/22] time 0.184 (0.179) data 0.107 (0.103) loss_x loss_x 0.4578 (0.5734) acc_x 90.6250 (85.6250) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [20/22] time 0.180 (0.180) data 0.103 (0.103) loss_x loss_x 0.6685 (0.5692) acc_x 84.3750 (86.0938) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/28] time 0.163 (0.179) data 0.085 (0.102) loss_u loss_u 0.8145 (0.8738) acc_u 21.8750 (14.3750) lr 3.1417e-05 eta 0:00:04
epoch [186/200] batch [10/28] time 0.172 (0.177) data 0.094 (0.100) loss_u loss_u 0.9600 (0.8641) acc_u 3.1250 (15.6250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/28] time 0.183 (0.177) data 0.106 (0.100) loss_u loss_u 0.8042 (0.8683) acc_u 18.7500 (15.0000) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/28] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.8765 (0.8726) acc_u 15.6250 (14.3750) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [25/28] time 0.188 (0.177) data 0.111 (0.101) loss_u loss_u 0.9033 (0.8705) acc_u 12.5000 (14.6250) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 480
confident_label rate tensor(0.4288, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 693
clean true:640
clean false:53
clean_rate:0.9235209235209235
noisy true:496
noisy false:427
after delete: len(clean_dataset) 693
after delete: len(noisy_dataset) 923
epoch [187/200] batch [5/21] time 0.184 (0.183) data 0.107 (0.107) loss_x loss_x 0.5146 (0.5185) acc_x 90.6250 (86.8750) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/21] time 0.166 (0.176) data 0.089 (0.099) loss_x loss_x 0.5757 (0.5477) acc_x 81.2500 (85.3125) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/21] time 0.171 (0.175) data 0.095 (0.098) loss_x loss_x 0.5337 (0.5351) acc_x 87.5000 (86.0417) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [20/21] time 0.182 (0.176) data 0.105 (0.099) loss_x loss_x 0.3447 (0.5356) acc_x 90.6250 (86.0938) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/28] time 0.182 (0.177) data 0.106 (0.101) loss_u loss_u 0.8804 (0.8810) acc_u 12.5000 (13.1250) lr 2.7630e-05 eta 0:00:04
epoch [187/200] batch [10/28] time 0.181 (0.178) data 0.104 (0.102) loss_u loss_u 0.8628 (0.8842) acc_u 18.7500 (13.1250) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/28] time 0.196 (0.180) data 0.120 (0.103) loss_u loss_u 0.8906 (0.8697) acc_u 12.5000 (15.0000) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/28] time 0.181 (0.180) data 0.105 (0.103) loss_u loss_u 0.8540 (0.8661) acc_u 15.6250 (15.0000) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [25/28] time 0.184 (0.181) data 0.108 (0.104) loss_u loss_u 0.8867 (0.8708) acc_u 12.5000 (14.5000) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.4381, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 708
clean true:655
clean false:53
clean_rate:0.9251412429378532
noisy true:470
noisy false:438
after delete: len(clean_dataset) 708
after delete: len(noisy_dataset) 908
epoch [188/200] batch [5/22] time 0.184 (0.184) data 0.108 (0.107) loss_x loss_x 0.5264 (0.4750) acc_x 84.3750 (86.2500) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [10/22] time 0.187 (0.179) data 0.110 (0.103) loss_x loss_x 0.3889 (0.5293) acc_x 84.3750 (85.3125) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [15/22] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.6143 (0.5249) acc_x 90.6250 (86.4583) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [20/22] time 0.182 (0.179) data 0.105 (0.103) loss_x loss_x 0.5972 (0.5212) acc_x 84.3750 (86.2500) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/28] time 0.159 (0.177) data 0.082 (0.101) loss_u loss_u 0.9365 (0.8778) acc_u 9.3750 (16.8750) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/28] time 0.182 (0.177) data 0.105 (0.100) loss_u loss_u 0.8984 (0.8784) acc_u 9.3750 (15.0000) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/28] time 0.168 (0.177) data 0.091 (0.100) loss_u loss_u 0.9316 (0.8878) acc_u 9.3750 (13.7500) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/28] time 0.160 (0.176) data 0.082 (0.099) loss_u loss_u 0.9307 (0.8934) acc_u 9.3750 (12.9688) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [25/28] time 0.179 (0.175) data 0.102 (0.099) loss_u loss_u 0.8608 (0.8901) acc_u 15.6250 (12.8750) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 691
clean true:633
clean false:58
clean_rate:0.9160636758321273
noisy true:487
noisy false:438
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 925
epoch [189/200] batch [5/21] time 0.159 (0.177) data 0.082 (0.100) loss_x loss_x 0.3977 (0.4254) acc_x 93.7500 (86.8750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/21] time 0.159 (0.168) data 0.083 (0.091) loss_x loss_x 0.3945 (0.4625) acc_x 90.6250 (87.5000) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/21] time 0.176 (0.167) data 0.099 (0.090) loss_x loss_x 0.2954 (0.5010) acc_x 93.7500 (87.9167) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [20/21] time 0.182 (0.169) data 0.106 (0.092) loss_x loss_x 0.7681 (0.5377) acc_x 84.3750 (86.7188) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/28] time 0.159 (0.171) data 0.081 (0.094) loss_u loss_u 0.8252 (0.8415) acc_u 18.7500 (18.7500) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [10/28] time 0.185 (0.171) data 0.107 (0.094) loss_u loss_u 0.8745 (0.8692) acc_u 15.6250 (15.6250) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/28] time 0.185 (0.173) data 0.107 (0.096) loss_u loss_u 0.8403 (0.8641) acc_u 15.6250 (15.6250) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/28] time 0.181 (0.174) data 0.105 (0.097) loss_u loss_u 0.8926 (0.8657) acc_u 12.5000 (15.1562) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [25/28] time 0.181 (0.176) data 0.105 (0.099) loss_u loss_u 0.8940 (0.8720) acc_u 12.5000 (14.5000) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 491
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 713
clean true:653
clean false:60
clean_rate:0.9158485273492286
noisy true:472
noisy false:431
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 903
epoch [190/200] batch [5/22] time 0.181 (0.185) data 0.104 (0.108) loss_x loss_x 0.3770 (0.4291) acc_x 90.6250 (86.8750) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [10/22] time 0.184 (0.184) data 0.107 (0.107) loss_x loss_x 0.5825 (0.4742) acc_x 84.3750 (86.8750) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [15/22] time 0.183 (0.184) data 0.106 (0.107) loss_x loss_x 0.5591 (0.4965) acc_x 84.3750 (86.2500) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [20/22] time 0.166 (0.181) data 0.090 (0.104) loss_x loss_x 0.3394 (0.4887) acc_x 93.7500 (86.4062) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/28] time 0.174 (0.179) data 0.096 (0.102) loss_u loss_u 0.8696 (0.8915) acc_u 18.7500 (12.5000) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/28] time 0.176 (0.177) data 0.100 (0.100) loss_u loss_u 0.8257 (0.8729) acc_u 18.7500 (14.6875) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/28] time 0.184 (0.177) data 0.107 (0.100) loss_u loss_u 0.8413 (0.8707) acc_u 18.7500 (14.7917) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/28] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.8809 (0.8755) acc_u 12.5000 (14.0625) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/28] time 0.174 (0.176) data 0.097 (0.099) loss_u loss_u 0.9058 (0.8850) acc_u 9.3750 (13.0000) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 484
confident_label rate tensor(0.4369, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 706
clean true:649
clean false:57
clean_rate:0.9192634560906515
noisy true:483
noisy false:427
after delete: len(clean_dataset) 706
after delete: len(noisy_dataset) 910
epoch [191/200] batch [5/22] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.3799 (0.4810) acc_x 90.6250 (88.7500) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/22] time 0.178 (0.175) data 0.101 (0.098) loss_x loss_x 0.3679 (0.5402) acc_x 90.6250 (87.5000) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [15/22] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 0.2261 (0.5413) acc_x 96.8750 (86.4583) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [20/22] time 0.186 (0.177) data 0.109 (0.100) loss_x loss_x 0.4646 (0.5378) acc_x 90.6250 (86.0938) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/28] time 0.181 (0.178) data 0.103 (0.101) loss_u loss_u 0.8794 (0.9060) acc_u 15.6250 (12.5000) lr 1.4891e-05 eta 0:00:04
epoch [191/200] batch [10/28] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.9272 (0.9128) acc_u 9.3750 (10.9375) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/28] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.9004 (0.9040) acc_u 12.5000 (12.0833) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/28] time 0.184 (0.180) data 0.106 (0.103) loss_u loss_u 0.9287 (0.9039) acc_u 9.3750 (12.3438) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/28] time 0.185 (0.180) data 0.107 (0.103) loss_u loss_u 0.8311 (0.8918) acc_u 15.6250 (13.1250) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 517
confident_label rate tensor(0.4276, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 691
clean true:630
clean false:61
clean_rate:0.9117221418234442
noisy true:469
noisy false:456
after delete: len(clean_dataset) 691
after delete: len(noisy_dataset) 925
epoch [192/200] batch [5/21] time 0.181 (0.183) data 0.104 (0.107) loss_x loss_x 0.7935 (0.5696) acc_x 75.0000 (86.2500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/21] time 0.167 (0.182) data 0.089 (0.106) loss_x loss_x 0.5879 (0.5165) acc_x 93.7500 (88.7500) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [15/21] time 0.183 (0.182) data 0.106 (0.105) loss_x loss_x 0.5425 (0.4879) acc_x 87.5000 (88.7500) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [20/21] time 0.179 (0.182) data 0.103 (0.105) loss_x loss_x 0.3638 (0.5129) acc_x 93.7500 (87.9688) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/28] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.9561 (0.8956) acc_u 6.2500 (11.8750) lr 1.2312e-05 eta 0:00:04
epoch [192/200] batch [10/28] time 0.183 (0.182) data 0.106 (0.105) loss_u loss_u 0.8530 (0.8838) acc_u 15.6250 (13.7500) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/28] time 0.180 (0.182) data 0.102 (0.105) loss_u loss_u 0.7974 (0.8819) acc_u 25.0000 (13.9583) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/28] time 0.184 (0.182) data 0.106 (0.105) loss_u loss_u 0.9834 (0.8912) acc_u 0.0000 (12.6562) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [25/28] time 0.183 (0.182) data 0.107 (0.105) loss_u loss_u 0.8574 (0.8834) acc_u 15.6250 (13.5000) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 494
confident_label rate tensor(0.4375, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 707
clean true:642
clean false:65
clean_rate:0.9080622347949081
noisy true:480
noisy false:429
after delete: len(clean_dataset) 707
after delete: len(noisy_dataset) 909
epoch [193/200] batch [5/22] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.8970 (0.6226) acc_x 75.0000 (82.5000) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [10/22] time 0.182 (0.182) data 0.106 (0.105) loss_x loss_x 0.8145 (0.5804) acc_x 78.1250 (84.6875) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [15/22] time 0.157 (0.177) data 0.081 (0.100) loss_x loss_x 0.7251 (0.5934) acc_x 75.0000 (85.2083) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [20/22] time 0.181 (0.176) data 0.105 (0.099) loss_x loss_x 0.3975 (0.6422) acc_x 87.5000 (84.3750) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/28] time 0.159 (0.175) data 0.083 (0.099) loss_u loss_u 0.8945 (0.8945) acc_u 9.3750 (11.8750) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/28] time 0.181 (0.176) data 0.105 (0.100) loss_u loss_u 0.9390 (0.8896) acc_u 6.2500 (11.8750) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/28] time 0.174 (0.177) data 0.096 (0.100) loss_u loss_u 0.8926 (0.8841) acc_u 18.7500 (12.9167) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/28] time 0.183 (0.177) data 0.106 (0.101) loss_u loss_u 0.8394 (0.8845) acc_u 18.7500 (12.9688) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/28] time 0.182 (0.178) data 0.106 (0.101) loss_u loss_u 0.8345 (0.8831) acc_u 18.7500 (13.2500) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 511
confident_label rate tensor(0.4270, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 690
clean true:634
clean false:56
clean_rate:0.9188405797101449
noisy true:471
noisy false:455
after delete: len(clean_dataset) 690
after delete: len(noisy_dataset) 926
epoch [194/200] batch [5/21] time 0.166 (0.170) data 0.090 (0.093) loss_x loss_x 0.8047 (0.6645) acc_x 84.3750 (83.1250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/21] time 0.181 (0.168) data 0.104 (0.091) loss_x loss_x 0.2729 (0.5179) acc_x 90.6250 (87.1875) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/21] time 0.172 (0.171) data 0.094 (0.094) loss_x loss_x 0.3506 (0.5151) acc_x 96.8750 (87.5000) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [20/21] time 0.168 (0.170) data 0.092 (0.094) loss_x loss_x 0.4939 (0.5340) acc_x 90.6250 (86.8750) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/28] time 0.175 (0.171) data 0.097 (0.094) loss_u loss_u 0.8843 (0.8833) acc_u 12.5000 (13.1250) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [10/28] time 0.180 (0.173) data 0.103 (0.096) loss_u loss_u 0.8701 (0.8701) acc_u 15.6250 (14.6875) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/28] time 0.183 (0.174) data 0.106 (0.097) loss_u loss_u 0.9272 (0.8776) acc_u 9.3750 (14.1667) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/28] time 0.183 (0.174) data 0.105 (0.097) loss_u loss_u 0.8511 (0.8743) acc_u 15.6250 (14.3750) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [25/28] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.9214 (0.8821) acc_u 9.3750 (13.3750) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 503
confident_label rate tensor(0.4282, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 692
clean true:636
clean false:56
clean_rate:0.9190751445086706
noisy true:477
noisy false:447
after delete: len(clean_dataset) 692
after delete: len(noisy_dataset) 924
epoch [195/200] batch [5/21] time 0.181 (0.184) data 0.105 (0.108) loss_x loss_x 0.8442 (0.5821) acc_x 81.2500 (85.6250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/21] time 0.183 (0.185) data 0.106 (0.108) loss_x loss_x 0.4080 (0.5210) acc_x 90.6250 (87.1875) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [15/21] time 0.182 (0.183) data 0.106 (0.107) loss_x loss_x 0.2825 (0.4996) acc_x 96.8750 (88.3333) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [20/21] time 0.183 (0.183) data 0.107 (0.107) loss_x loss_x 0.5859 (0.5129) acc_x 87.5000 (88.5938) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/28] time 0.185 (0.183) data 0.107 (0.107) loss_u loss_u 0.8423 (0.8715) acc_u 15.6250 (14.3750) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/28] time 0.183 (0.183) data 0.106 (0.106) loss_u loss_u 0.8101 (0.8655) acc_u 21.8750 (15.3125) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/28] time 0.183 (0.183) data 0.107 (0.106) loss_u loss_u 0.9121 (0.8767) acc_u 9.3750 (14.1667) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/28] time 0.168 (0.182) data 0.091 (0.106) loss_u loss_u 0.8486 (0.8774) acc_u 15.6250 (14.2188) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [25/28] time 0.181 (0.182) data 0.103 (0.105) loss_u loss_u 0.8877 (0.8755) acc_u 12.5000 (14.2500) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 508
confident_label rate tensor(0.4295, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 694
clean true:640
clean false:54
clean_rate:0.9221902017291066
noisy true:468
noisy false:454
after delete: len(clean_dataset) 694
after delete: len(noisy_dataset) 922
epoch [196/200] batch [5/21] time 0.181 (0.182) data 0.105 (0.105) loss_x loss_x 0.5474 (0.4750) acc_x 75.0000 (86.8750) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/21] time 0.182 (0.182) data 0.105 (0.105) loss_x loss_x 0.5317 (0.5296) acc_x 84.3750 (84.0625) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [15/21] time 0.165 (0.179) data 0.088 (0.102) loss_x loss_x 0.5767 (0.5465) acc_x 87.5000 (84.3750) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [20/21] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.4956 (0.5617) acc_x 87.5000 (84.6875) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/28] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.9155 (0.8698) acc_u 9.3750 (14.3750) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/28] time 0.160 (0.178) data 0.082 (0.101) loss_u loss_u 0.8296 (0.8818) acc_u 18.7500 (13.4375) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/28] time 0.162 (0.176) data 0.084 (0.099) loss_u loss_u 0.8760 (0.8697) acc_u 18.7500 (14.7917) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/28] time 0.165 (0.176) data 0.087 (0.098) loss_u loss_u 0.8765 (0.8753) acc_u 12.5000 (13.9062) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/28] time 0.184 (0.176) data 0.107 (0.098) loss_u loss_u 0.8042 (0.8776) acc_u 21.8750 (13.8750) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 490
confident_label rate tensor(0.4251, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 687
clean true:629
clean false:58
clean_rate:0.9155749636098981
noisy true:497
noisy false:432
after delete: len(clean_dataset) 687
after delete: len(noisy_dataset) 929
epoch [197/200] batch [5/21] time 0.181 (0.179) data 0.104 (0.102) loss_x loss_x 0.4622 (0.5740) acc_x 84.3750 (86.8750) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/21] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.7012 (0.5849) acc_x 78.1250 (84.6875) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/21] time 0.186 (0.182) data 0.108 (0.105) loss_x loss_x 0.7188 (0.5355) acc_x 84.3750 (86.2500) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [20/21] time 0.164 (0.180) data 0.087 (0.103) loss_x loss_x 0.6362 (0.5477) acc_x 81.2500 (86.0938) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/29] time 0.183 (0.179) data 0.106 (0.102) loss_u loss_u 0.8789 (0.8580) acc_u 15.6250 (16.8750) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/29] time 0.187 (0.179) data 0.110 (0.102) loss_u loss_u 0.8438 (0.8593) acc_u 21.8750 (16.5625) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/29] time 0.171 (0.177) data 0.093 (0.100) loss_u loss_u 0.7598 (0.8526) acc_u 34.3750 (17.2917) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/29] time 0.164 (0.176) data 0.087 (0.098) loss_u loss_u 0.8936 (0.8617) acc_u 12.5000 (16.0938) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [25/29] time 0.196 (0.177) data 0.119 (0.100) loss_u loss_u 0.8735 (0.8627) acc_u 15.6250 (15.7500) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 504
confident_label rate tensor(0.4325, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 699
clean true:648
clean false:51
clean_rate:0.927038626609442
noisy true:464
noisy false:453
after delete: len(clean_dataset) 699
after delete: len(noisy_dataset) 917
epoch [198/200] batch [5/21] time 0.172 (0.176) data 0.096 (0.100) loss_x loss_x 0.3916 (0.5437) acc_x 93.7500 (86.8750) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/21] time 0.182 (0.173) data 0.106 (0.096) loss_x loss_x 0.8428 (0.5257) acc_x 75.0000 (85.0000) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/21] time 0.181 (0.174) data 0.105 (0.097) loss_x loss_x 0.5615 (0.5443) acc_x 87.5000 (84.7917) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [20/21] time 0.162 (0.173) data 0.086 (0.097) loss_x loss_x 0.6885 (0.5616) acc_x 81.2500 (84.6875) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/28] time 0.182 (0.174) data 0.105 (0.098) loss_u loss_u 0.8940 (0.8789) acc_u 15.6250 (15.0000) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/28] time 0.158 (0.173) data 0.081 (0.096) loss_u loss_u 0.8555 (0.8705) acc_u 15.6250 (14.6875) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/28] time 0.183 (0.172) data 0.107 (0.095) loss_u loss_u 0.8428 (0.8743) acc_u 15.6250 (13.7500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/28] time 0.183 (0.174) data 0.105 (0.097) loss_u loss_u 0.9048 (0.8809) acc_u 9.3750 (13.5938) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [25/28] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.9536 (0.8834) acc_u 3.1250 (13.1250) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 497
confident_label rate tensor(0.4332, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 700
clean true:645
clean false:55
clean_rate:0.9214285714285714
noisy true:474
noisy false:442
after delete: len(clean_dataset) 700
after delete: len(noisy_dataset) 916
epoch [199/200] batch [5/21] time 0.188 (0.184) data 0.111 (0.108) loss_x loss_x 0.4500 (0.4856) acc_x 87.5000 (88.1250) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/21] time 0.190 (0.184) data 0.114 (0.108) loss_x loss_x 0.5562 (0.5969) acc_x 84.3750 (85.0000) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [15/21] time 0.190 (0.186) data 0.113 (0.109) loss_x loss_x 0.3503 (0.5686) acc_x 90.6250 (85.6250) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [20/21] time 0.182 (0.185) data 0.105 (0.108) loss_x loss_x 0.3765 (0.5469) acc_x 90.6250 (85.9375) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/28] time 0.184 (0.184) data 0.107 (0.108) loss_u loss_u 0.8320 (0.8533) acc_u 18.7500 (17.5000) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/28] time 0.185 (0.184) data 0.108 (0.107) loss_u loss_u 0.8442 (0.8589) acc_u 15.6250 (15.6250) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/28] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.9224 (0.8759) acc_u 9.3750 (13.9583) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/28] time 0.185 (0.184) data 0.107 (0.107) loss_u loss_u 0.8936 (0.8833) acc_u 15.6250 (13.4375) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/28] time 0.183 (0.184) data 0.104 (0.107) loss_u loss_u 0.9736 (0.8850) acc_u 3.1250 (13.3750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 502
confident_label rate tensor(0.4208, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 680
clean true:627
clean false:53
clean_rate:0.9220588235294118
noisy true:487
noisy false:449
after delete: len(clean_dataset) 680
after delete: len(noisy_dataset) 936
epoch [200/200] batch [5/21] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.1263 (0.5071) acc_x 100.0000 (88.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/21] time 0.184 (0.183) data 0.108 (0.107) loss_x loss_x 0.5630 (0.5129) acc_x 87.5000 (88.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [15/21] time 0.185 (0.184) data 0.108 (0.107) loss_x loss_x 0.5859 (0.5248) acc_x 81.2500 (87.0833) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [20/21] time 0.180 (0.183) data 0.104 (0.107) loss_x loss_x 0.4463 (0.5106) acc_x 90.6250 (87.0312) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/29] time 0.183 (0.183) data 0.107 (0.107) loss_u loss_u 0.8706 (0.8872) acc_u 12.5000 (12.5000) lr 4.9344e-07 eta 0:00:04
epoch [200/200] batch [10/29] time 0.190 (0.184) data 0.112 (0.107) loss_u loss_u 0.8584 (0.8657) acc_u 21.8750 (15.3125) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/29] time 0.185 (0.182) data 0.108 (0.105) loss_u loss_u 0.8652 (0.8719) acc_u 12.5000 (14.3750) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/29] time 0.176 (0.180) data 0.098 (0.104) loss_u loss_u 0.8628 (0.8726) acc_u 15.6250 (14.2188) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [25/29] time 0.158 (0.178) data 0.081 (0.101) loss_u loss_u 0.8911 (0.8722) acc_u 15.6250 (14.3750) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.50/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,602
* accuracy: 68.8%
* error: 31.2%
* macro_f1: 66.9%
Elapsed: 0:58:45
