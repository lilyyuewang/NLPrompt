***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/NLPrompt/rn50.yaml
dataset_config_file: configs/datasets/ucf101.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
opts: ['DATASET.NUM_SHOTS', '16', 'DATASET.NOISE_RATE', '0.25', 'DATASET.NOISE_TYPE', 'asym', 'DATASET.num_class', '101']
output_dir: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
resume: 
root: ~/datasets/nlprompt
seed: 1
source_domains: None
target_domains: None
trainer: NLPrompt
transforms: None
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 0
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  BEGIN_RATE: 0.3
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  CURRICLUM_EPOCH: 0
  CURRICLUM_MODE: linear
  NAME: UCF101
  NOISE_LABEL: True
  NOISE_RATE: 0.25
  NOISE_TYPE: asym
  NUM_LABELED: -1
  NUM_SHOTS: 16
  PMODE: logP
  REG_E: 0.01
  REG_FEAT: 1.0
  REG_LAB: 1.0
  ROOT: ~/datasets/nlprompt
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  USE_OT: True
  VAL_PERCENT: 0.1
  num_class: 101
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.25/seed1
RESUME: 
SEED: 1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: NLPrompt
  NLPROMPT:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 2.4.0
Is debug build: False
CUDA used to build PyTorch: 12.1
ROCM used to build PyTorch: N/A

OS: Ubuntu 24.04.2 LTS (x86_64)
GCC version: (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.39

Python version: 3.8.20 (default, Oct  3 2024, 15:24:27)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-6.14.0-29-generic-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A40
GPU 1: NVIDIA A40
GPU 2: NVIDIA A40
GPU 3: NVIDIA A40

Nvidia driver version: 575.64.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

CPU:
Architecture:                            x86_64
CPU op-mode(s):                          32-bit, 64-bit
Address sizes:                           46 bits physical, 57 bits virtual
Byte Order:                              Little Endian
CPU(s):                                  64
On-line CPU(s) list:                     0-63
Vendor ID:                               GenuineIntel
Model name:                              Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz
CPU family:                              6
Model:                                   106
Thread(s) per core:                      2
Core(s) per socket:                      16
Socket(s):                               2
Stepping:                                6
BogoMIPS:                                4800.00
Flags:                                   fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 intel_ppin ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb intel_pt avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local split_lock_detect wbnoinvd dtherm ida arat pln pts vnmi avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq la57 rdpid fsrm md_clear pconfig flush_l1d arch_capabilities
Virtualization:                          VT-x
L1d cache:                               1.5 MiB (32 instances)
L1i cache:                               1 MiB (32 instances)
L2 cache:                                40 MiB (32 instances)
L3 cache:                                48 MiB (2 instances)
NUMA node(s):                            2
NUMA node0 CPU(s):                       0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62
NUMA node1 CPU(s):                       1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63
Vulnerability Gather data sampling:      Vulnerable
Vulnerability Ghostwrite:                Not affected
Vulnerability Indirect target selection: Mitigation; Aligned branch/return thunks
Vulnerability Itlb multihit:             Not affected
Vulnerability L1tf:                      Not affected
Vulnerability Mds:                       Not affected
Vulnerability Meltdown:                  Not affected
Vulnerability Mmio stale data:           Mitigation; Clear CPU buffers; SMT vulnerable
Vulnerability Reg file data sampling:    Not affected
Vulnerability Retbleed:                  Not affected
Vulnerability Spec rstack overflow:      Not affected
Vulnerability Spec store bypass:         Mitigation; Speculative Store Bypass disabled via prctl
Vulnerability Spectre v1:                Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:                Mitigation; Enhanced / Automatic IBRS; IBPB conditional; PBRSB-eIBRS SW sequence; BHI SW loop, KVM SW loop
Vulnerability Srbds:                     Not affected
Vulnerability Tsx async abort:           Not affected

Versions of relevant libraries:
[pip3] flake8==3.7.9
[pip3] numpy==1.24.3
[pip3] torch==2.4.0
[pip3] torchaudio==2.4.0
[pip3] torchvision==0.19.0
[pip3] triton==3.0.0
[conda] blas                       1.0              mkl
[conda] libjpeg-turbo              2.0.0            h9bf148f_0                   pytorch
[conda] mkl                        2023.1.0         h213fc3f_46344
[conda] mkl-service                2.4.0            py38h5eee18b_1
[conda] mkl_fft                    1.3.8            py38h5eee18b_0
[conda] mkl_random                 1.2.4            py38hdb19cb5_0
[conda] numpy                      1.24.3           py38hf6e8229_1
[conda] numpy-base                 1.24.3           py38h060ed82_1
[conda] pytorch                    2.4.0            py3.8_cuda12.1_cudnn9.1.0_0  pytorch
[conda] pytorch-cuda               12.1             ha16c6d3_6                   pytorch
[conda] pytorch-mutex              1.0              cuda                         pytorch
[conda] torchaudio                 2.4.0            py38_cu121                   pytorch
[conda] torchtriton                3.0.0            py38                         pytorch
[conda] torchvision                0.19.0           py38_cu121                   pytorch
        Pillow (10.4.0)

Loading trainer: NLPrompt
Loading dataset: UCF101
Reading split from /home/convex/datasets/nlprompt/ucf101/split_zhou_UCF101.json
Loading preprocessed few-shot data from /home/convex/datasets/nlprompt/ucf101/split_fewshot/shot_16-seed_1.pkl
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
add noise 
Data loader size: 50
Data loader size: 5
Data loader size: 38
---------  ------
Dataset    UCF101
# classes  101
# train_x  1,616
# val      404
# test     3,783
---------  ------
Loading CLIP (backbone: RN50)
Building custom CLIP
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Turning off gradients in both the image and the text encoder
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/tensorboard)
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 1103
confident_label rate tensor(0.2401, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 388
clean true:377
clean false:11
clean_rate:0.9716494845360825
noisy true:136
noisy false:1092
after delete: len(clean_dataset) 388
after delete: len(noisy_dataset) 1228
epoch [1/200] batch [5/12] time 0.196 (0.207) data 0.117 (0.108) loss_x loss_x 2.7168 (2.6660) acc_x 50.0000 (46.2500) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [10/12] time 0.185 (0.198) data 0.108 (0.110) loss_x loss_x 2.0332 (2.4813) acc_x 62.5000 (54.3750) lr 1.0000e-05 eta 0:00:00
epoch [1/200] batch [5/38] time 0.192 (0.196) data 0.115 (0.111) loss_u loss_u 0.9478 (0.9530) acc_u 9.3750 (11.8750) lr 1.0000e-05 eta 0:00:06
epoch [1/200] batch [10/38] time 0.183 (0.195) data 0.106 (0.111) loss_u loss_u 0.9512 (0.9493) acc_u 12.5000 (12.5000) lr 1.0000e-05 eta 0:00:05
epoch [1/200] batch [15/38] time 0.185 (0.191) data 0.107 (0.109) loss_u loss_u 0.9307 (0.9428) acc_u 15.6250 (15.0000) lr 1.0000e-05 eta 0:00:04
epoch [1/200] batch [20/38] time 0.184 (0.190) data 0.106 (0.108) loss_u loss_u 0.8755 (0.9392) acc_u 25.0000 (14.8438) lr 1.0000e-05 eta 0:00:03
epoch [1/200] batch [25/38] time 0.182 (0.189) data 0.104 (0.108) loss_u loss_u 0.9453 (0.9386) acc_u 12.5000 (14.5000) lr 1.0000e-05 eta 0:00:02
epoch [1/200] batch [30/38] time 0.193 (0.189) data 0.116 (0.109) loss_u loss_u 0.8950 (0.9317) acc_u 15.6250 (15.8333) lr 1.0000e-05 eta 0:00:01
epoch [1/200] batch [35/38] time 0.184 (0.190) data 0.107 (0.109) loss_u loss_u 0.9268 (0.9309) acc_u 18.7500 (16.0714) lr 1.0000e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 972
confident_label rate tensor(0.2970, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 480
clean true:472
clean false:8
clean_rate:0.9833333333333333
noisy true:172
noisy false:964
after delete: len(clean_dataset) 480
after delete: len(noisy_dataset) 1136
epoch [2/200] batch [5/15] time 0.161 (0.167) data 0.084 (0.090) loss_x loss_x 1.0840 (1.5303) acc_x 81.2500 (70.0000) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [10/15] time 0.169 (0.168) data 0.092 (0.091) loss_x loss_x 0.8584 (1.3425) acc_x 75.0000 (70.3125) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [15/15] time 0.188 (0.171) data 0.110 (0.094) loss_x loss_x 0.8169 (1.2372) acc_x 78.1250 (70.8333) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [5/35] time 0.182 (0.173) data 0.105 (0.095) loss_u loss_u 0.8169 (0.8238) acc_u 21.8750 (24.3750) lr 2.0000e-03 eta 0:00:05
epoch [2/200] batch [10/35] time 0.176 (0.174) data 0.099 (0.097) loss_u loss_u 0.8657 (0.8341) acc_u 9.3750 (20.3125) lr 2.0000e-03 eta 0:00:04
epoch [2/200] batch [15/35] time 0.169 (0.174) data 0.092 (0.097) loss_u loss_u 0.8145 (0.8252) acc_u 21.8750 (21.4583) lr 2.0000e-03 eta 0:00:03
epoch [2/200] batch [20/35] time 0.184 (0.174) data 0.106 (0.096) loss_u loss_u 0.8037 (0.8184) acc_u 25.0000 (22.3438) lr 2.0000e-03 eta 0:00:02
epoch [2/200] batch [25/35] time 0.173 (0.174) data 0.096 (0.096) loss_u loss_u 0.7734 (0.8156) acc_u 25.0000 (22.6250) lr 2.0000e-03 eta 0:00:01
epoch [2/200] batch [30/35] time 0.174 (0.174) data 0.097 (0.097) loss_u loss_u 0.8652 (0.8113) acc_u 15.6250 (22.7083) lr 2.0000e-03 eta 0:00:00
epoch [2/200] batch [35/35] time 0.181 (0.175) data 0.104 (0.098) loss_u loss_u 0.7695 (0.8099) acc_u 34.3750 (23.0357) lr 2.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 770
confident_label rate tensor(0.4022, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 650
clean true:641
clean false:9
clean_rate:0.9861538461538462
noisy true:205
noisy false:761
after delete: len(clean_dataset) 650
after delete: len(noisy_dataset) 966
epoch [3/200] batch [5/20] time 0.171 (0.174) data 0.094 (0.097) loss_x loss_x 1.3223 (1.2386) acc_x 71.8750 (70.0000) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [10/20] time 0.165 (0.169) data 0.088 (0.092) loss_x loss_x 1.1680 (1.0839) acc_x 65.6250 (73.1250) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [15/20] time 0.175 (0.171) data 0.097 (0.094) loss_x loss_x 1.0625 (1.1123) acc_x 71.8750 (72.5000) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [20/20] time 0.183 (0.174) data 0.106 (0.097) loss_x loss_x 1.5244 (1.1799) acc_x 65.6250 (70.7812) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [5/30] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.8916 (0.8423) acc_u 15.6250 (19.3750) lr 1.9999e-03 eta 0:00:04
epoch [3/200] batch [10/30] time 0.219 (0.180) data 0.142 (0.102) loss_u loss_u 0.8608 (0.8407) acc_u 21.8750 (20.3125) lr 1.9999e-03 eta 0:00:03
epoch [3/200] batch [15/30] time 0.229 (0.186) data 0.150 (0.108) loss_u loss_u 0.8682 (0.8492) acc_u 15.6250 (18.9583) lr 1.9999e-03 eta 0:00:02
epoch [3/200] batch [20/30] time 0.209 (0.187) data 0.131 (0.109) loss_u loss_u 0.9199 (0.8489) acc_u 12.5000 (18.7500) lr 1.9999e-03 eta 0:00:01
epoch [3/200] batch [25/30] time 0.169 (0.186) data 0.091 (0.109) loss_u loss_u 0.8716 (0.8503) acc_u 18.7500 (18.7500) lr 1.9999e-03 eta 0:00:00
epoch [3/200] batch [30/30] time 0.183 (0.186) data 0.106 (0.108) loss_u loss_u 0.9053 (0.8555) acc_u 18.7500 (18.3333) lr 1.9999e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 748
confident_label rate tensor(0.4121, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 666
clean true:655
clean false:11
clean_rate:0.9834834834834835
noisy true:213
noisy false:737
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 950
epoch [4/200] batch [5/20] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 1.2393 (1.1662) acc_x 71.8750 (67.5000) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [10/20] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 1.0518 (1.1521) acc_x 68.7500 (69.6875) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [15/20] time 0.168 (0.175) data 0.089 (0.098) loss_x loss_x 0.8945 (1.1021) acc_x 78.1250 (68.9583) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [20/20] time 0.171 (0.174) data 0.094 (0.097) loss_x loss_x 0.9443 (1.0732) acc_x 78.1250 (70.4688) lr 1.9995e-03 eta 0:00:00
epoch [4/200] batch [5/29] time 0.166 (0.173) data 0.088 (0.096) loss_u loss_u 0.8164 (0.8048) acc_u 28.1250 (25.0000) lr 1.9995e-03 eta 0:00:04
epoch [4/200] batch [10/29] time 0.204 (0.175) data 0.126 (0.098) loss_u loss_u 0.8091 (0.8242) acc_u 25.0000 (21.5625) lr 1.9995e-03 eta 0:00:03
epoch [4/200] batch [15/29] time 0.187 (0.176) data 0.108 (0.099) loss_u loss_u 0.8208 (0.8262) acc_u 25.0000 (21.2500) lr 1.9995e-03 eta 0:00:02
epoch [4/200] batch [20/29] time 0.200 (0.177) data 0.122 (0.100) loss_u loss_u 0.9116 (0.8354) acc_u 9.3750 (20.1562) lr 1.9995e-03 eta 0:00:01
epoch [4/200] batch [25/29] time 0.243 (0.179) data 0.164 (0.101) loss_u loss_u 0.9185 (0.8445) acc_u 9.3750 (18.7500) lr 1.9995e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 726
confident_label rate tensor(0.4121, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 666
clean true:661
clean false:5
clean_rate:0.9924924924924925
noisy true:229
noisy false:721
after delete: len(clean_dataset) 666
after delete: len(noisy_dataset) 950
epoch [5/200] batch [5/20] time 0.174 (0.183) data 0.097 (0.106) loss_x loss_x 0.9272 (0.8821) acc_x 78.1250 (76.8750) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [10/20] time 0.186 (0.183) data 0.109 (0.106) loss_x loss_x 1.1064 (0.9150) acc_x 71.8750 (77.1875) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [15/20] time 0.171 (0.182) data 0.093 (0.105) loss_x loss_x 0.9893 (1.0028) acc_x 65.6250 (74.3750) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [20/20] time 0.170 (0.179) data 0.092 (0.102) loss_x loss_x 0.9326 (1.0143) acc_x 75.0000 (74.3750) lr 1.9989e-03 eta 0:00:00
epoch [5/200] batch [5/29] time 0.185 (0.178) data 0.106 (0.101) loss_u loss_u 0.7407 (0.8125) acc_u 28.1250 (22.5000) lr 1.9989e-03 eta 0:00:04
epoch [5/200] batch [10/29] time 0.172 (0.176) data 0.094 (0.099) loss_u loss_u 0.8628 (0.8423) acc_u 12.5000 (19.3750) lr 1.9989e-03 eta 0:00:03
epoch [5/200] batch [15/29] time 0.185 (0.178) data 0.107 (0.100) loss_u loss_u 0.8325 (0.8530) acc_u 21.8750 (17.7083) lr 1.9989e-03 eta 0:00:02
epoch [5/200] batch [20/29] time 0.177 (0.177) data 0.100 (0.100) loss_u loss_u 0.7939 (0.8458) acc_u 25.0000 (18.9062) lr 1.9989e-03 eta 0:00:01
epoch [5/200] batch [25/29] time 0.181 (0.177) data 0.102 (0.100) loss_u loss_u 0.8271 (0.8426) acc_u 21.8750 (18.8750) lr 1.9989e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 734
confident_label rate tensor(0.4134, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 668
clean true:661
clean false:7
clean_rate:0.9895209580838323
noisy true:221
noisy false:727
after delete: len(clean_dataset) 668
after delete: len(noisy_dataset) 948
epoch [6/200] batch [5/20] time 0.189 (0.188) data 0.112 (0.111) loss_x loss_x 0.7349 (0.8679) acc_x 78.1250 (73.7500) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [10/20] time 0.178 (0.184) data 0.102 (0.107) loss_x loss_x 0.7402 (0.9236) acc_x 84.3750 (74.6875) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [15/20] time 0.180 (0.182) data 0.103 (0.105) loss_x loss_x 0.8960 (0.9092) acc_x 78.1250 (76.0417) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [20/20] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.7891 (0.9072) acc_x 78.1250 (75.7812) lr 1.9980e-03 eta 0:00:00
epoch [6/200] batch [5/29] time 0.171 (0.180) data 0.093 (0.103) loss_u loss_u 0.7944 (0.8354) acc_u 31.2500 (20.6250) lr 1.9980e-03 eta 0:00:04
epoch [6/200] batch [10/29] time 0.190 (0.181) data 0.113 (0.104) loss_u loss_u 0.8818 (0.8620) acc_u 12.5000 (17.8125) lr 1.9980e-03 eta 0:00:03
epoch [6/200] batch [15/29] time 0.190 (0.182) data 0.112 (0.105) loss_u loss_u 0.8877 (0.8587) acc_u 15.6250 (17.9167) lr 1.9980e-03 eta 0:00:02
epoch [6/200] batch [20/29] time 0.198 (0.183) data 0.120 (0.105) loss_u loss_u 0.8633 (0.8444) acc_u 9.3750 (18.7500) lr 1.9980e-03 eta 0:00:01
epoch [6/200] batch [25/29] time 0.198 (0.183) data 0.120 (0.106) loss_u loss_u 0.7817 (0.8304) acc_u 18.7500 (19.7500) lr 1.9980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 712
confident_label rate tensor(0.4214, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 681
clean true:674
clean false:7
clean_rate:0.9897209985315712
noisy true:230
noisy false:705
after delete: len(clean_dataset) 681
after delete: len(noisy_dataset) 935
epoch [7/200] batch [5/21] time 0.203 (0.182) data 0.126 (0.106) loss_x loss_x 1.0654 (0.8658) acc_x 71.8750 (73.7500) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [10/21] time 0.177 (0.185) data 0.100 (0.109) loss_x loss_x 0.7607 (0.9008) acc_x 75.0000 (75.0000) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [15/21] time 0.169 (0.184) data 0.092 (0.108) loss_x loss_x 0.7793 (0.9472) acc_x 78.1250 (75.4167) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [20/21] time 0.160 (0.182) data 0.082 (0.106) loss_x loss_x 0.8374 (0.9191) acc_x 71.8750 (75.7812) lr 1.9969e-03 eta 0:00:00
epoch [7/200] batch [5/29] time 0.164 (0.177) data 0.087 (0.101) loss_u loss_u 0.7856 (0.8367) acc_u 28.1250 (19.3750) lr 1.9969e-03 eta 0:00:04
epoch [7/200] batch [10/29] time 0.159 (0.175) data 0.081 (0.098) loss_u loss_u 0.8496 (0.8402) acc_u 15.6250 (17.8125) lr 1.9969e-03 eta 0:00:03
epoch [7/200] batch [15/29] time 0.170 (0.175) data 0.093 (0.098) loss_u loss_u 0.7803 (0.8355) acc_u 25.0000 (18.7500) lr 1.9969e-03 eta 0:00:02
epoch [7/200] batch [20/29] time 0.187 (0.176) data 0.109 (0.099) loss_u loss_u 0.8228 (0.8326) acc_u 18.7500 (19.2188) lr 1.9969e-03 eta 0:00:01
epoch [7/200] batch [25/29] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.8066 (0.8306) acc_u 25.0000 (19.6250) lr 1.9969e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 675
confident_label rate tensor(0.4431, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 716
clean true:709
clean false:7
clean_rate:0.9902234636871509
noisy true:232
noisy false:668
after delete: len(clean_dataset) 716
after delete: len(noisy_dataset) 900
epoch [8/200] batch [5/22] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.8979 (0.9779) acc_x 75.0000 (73.7500) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [10/22] time 0.171 (0.172) data 0.094 (0.096) loss_x loss_x 0.7925 (0.9027) acc_x 84.3750 (75.9375) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [15/22] time 0.165 (0.172) data 0.088 (0.095) loss_x loss_x 0.9731 (0.9118) acc_x 68.7500 (75.0000) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [20/22] time 0.174 (0.171) data 0.098 (0.094) loss_x loss_x 1.1094 (0.9444) acc_x 71.8750 (74.3750) lr 1.9956e-03 eta 0:00:00
epoch [8/200] batch [5/28] time 0.178 (0.172) data 0.100 (0.094) loss_u loss_u 0.8071 (0.7959) acc_u 25.0000 (25.0000) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [10/28] time 0.166 (0.171) data 0.089 (0.094) loss_u loss_u 0.8169 (0.8178) acc_u 18.7500 (21.2500) lr 1.9956e-03 eta 0:00:03
epoch [8/200] batch [15/28] time 0.179 (0.172) data 0.102 (0.095) loss_u loss_u 0.8535 (0.8393) acc_u 21.8750 (18.5417) lr 1.9956e-03 eta 0:00:02
epoch [8/200] batch [20/28] time 0.185 (0.173) data 0.106 (0.095) loss_u loss_u 0.9014 (0.8390) acc_u 12.5000 (18.7500) lr 1.9956e-03 eta 0:00:01
epoch [8/200] batch [25/28] time 0.183 (0.174) data 0.105 (0.096) loss_u loss_u 0.8887 (0.8421) acc_u 12.5000 (18.7500) lr 1.9956e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 708
confident_label rate tensor(0.4307, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 696
clean true:691
clean false:5
clean_rate:0.992816091954023
noisy true:217
noisy false:703
after delete: len(clean_dataset) 696
after delete: len(noisy_dataset) 920
epoch [9/200] batch [5/21] time 0.172 (0.170) data 0.095 (0.093) loss_x loss_x 0.6768 (0.9395) acc_x 71.8750 (70.6250) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [10/21] time 0.187 (0.176) data 0.110 (0.099) loss_x loss_x 1.1426 (0.9144) acc_x 78.1250 (73.1250) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [15/21] time 0.194 (0.180) data 0.117 (0.103) loss_x loss_x 0.6499 (0.9546) acc_x 81.2500 (73.5417) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [20/21] time 0.188 (0.181) data 0.111 (0.104) loss_x loss_x 0.7710 (0.9388) acc_x 81.2500 (74.0625) lr 1.9940e-03 eta 0:00:00
epoch [9/200] batch [5/28] time 0.178 (0.180) data 0.100 (0.102) loss_u loss_u 0.7427 (0.7937) acc_u 37.5000 (26.8750) lr 1.9940e-03 eta 0:00:04
epoch [9/200] batch [10/28] time 0.173 (0.180) data 0.095 (0.102) loss_u loss_u 0.7129 (0.7945) acc_u 31.2500 (25.3125) lr 1.9940e-03 eta 0:00:03
epoch [9/200] batch [15/28] time 0.174 (0.179) data 0.095 (0.102) loss_u loss_u 0.8491 (0.8078) acc_u 18.7500 (23.1250) lr 1.9940e-03 eta 0:00:02
epoch [9/200] batch [20/28] time 0.175 (0.179) data 0.096 (0.102) loss_u loss_u 0.7446 (0.8126) acc_u 34.3750 (23.1250) lr 1.9940e-03 eta 0:00:01
epoch [9/200] batch [25/28] time 0.201 (0.180) data 0.122 (0.102) loss_u loss_u 0.8032 (0.8127) acc_u 18.7500 (23.2500) lr 1.9940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 693
confident_label rate tensor(0.4425, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 715
clean true:705
clean false:10
clean_rate:0.986013986013986
noisy true:218
noisy false:683
after delete: len(clean_dataset) 715
after delete: len(noisy_dataset) 901
epoch [10/200] batch [5/22] time 0.188 (0.188) data 0.111 (0.110) loss_x loss_x 1.0361 (0.9917) acc_x 71.8750 (73.1250) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [10/22] time 0.171 (0.183) data 0.094 (0.106) loss_x loss_x 1.1289 (0.9764) acc_x 68.7500 (74.6875) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [15/22] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.9614 (0.9828) acc_x 78.1250 (75.2083) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [20/22] time 0.176 (0.177) data 0.100 (0.100) loss_x loss_x 0.9248 (0.9648) acc_x 68.7500 (75.4688) lr 1.9921e-03 eta 0:00:00
epoch [10/200] batch [5/28] time 0.162 (0.176) data 0.084 (0.099) loss_u loss_u 0.8223 (0.8380) acc_u 21.8750 (21.2500) lr 1.9921e-03 eta 0:00:04
epoch [10/200] batch [10/28] time 0.178 (0.176) data 0.099 (0.099) loss_u loss_u 0.7891 (0.8319) acc_u 25.0000 (21.5625) lr 1.9921e-03 eta 0:00:03
epoch [10/200] batch [15/28] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.8462 (0.8356) acc_u 21.8750 (21.2500) lr 1.9921e-03 eta 0:00:02
epoch [10/200] batch [20/28] time 0.190 (0.177) data 0.113 (0.100) loss_u loss_u 0.8501 (0.8351) acc_u 18.7500 (20.6250) lr 1.9921e-03 eta 0:00:01
epoch [10/200] batch [25/28] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.8145 (0.8363) acc_u 18.7500 (20.1250) lr 1.9921e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 633
confident_label rate tensor(0.4635, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 749
clean true:742
clean false:7
clean_rate:0.9906542056074766
noisy true:241
noisy false:626
after delete: len(clean_dataset) 749
after delete: len(noisy_dataset) 867
epoch [11/200] batch [5/23] time 0.180 (0.180) data 0.103 (0.104) loss_x loss_x 0.9707 (0.9891) acc_x 78.1250 (73.1250) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [10/23] time 0.182 (0.181) data 0.106 (0.104) loss_x loss_x 0.8335 (0.9836) acc_x 75.0000 (73.4375) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [15/23] time 0.185 (0.182) data 0.109 (0.105) loss_x loss_x 0.8989 (0.9287) acc_x 71.8750 (75.2083) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [20/23] time 0.185 (0.183) data 0.108 (0.106) loss_x loss_x 1.3516 (1.0105) acc_x 62.5000 (73.2812) lr 1.9900e-03 eta 0:00:00
epoch [11/200] batch [5/27] time 0.189 (0.184) data 0.110 (0.107) loss_u loss_u 0.7769 (0.7906) acc_u 28.1250 (25.0000) lr 1.9900e-03 eta 0:00:04
epoch [11/200] batch [10/27] time 0.163 (0.183) data 0.085 (0.106) loss_u loss_u 0.8262 (0.8183) acc_u 18.7500 (22.8125) lr 1.9900e-03 eta 0:00:03
epoch [11/200] batch [15/27] time 0.182 (0.182) data 0.104 (0.105) loss_u loss_u 0.8960 (0.8404) acc_u 9.3750 (19.5833) lr 1.9900e-03 eta 0:00:02
epoch [11/200] batch [20/27] time 0.172 (0.182) data 0.095 (0.105) loss_u loss_u 0.8535 (0.8372) acc_u 18.7500 (20.0000) lr 1.9900e-03 eta 0:00:01
epoch [11/200] batch [25/27] time 0.172 (0.181) data 0.094 (0.103) loss_u loss_u 0.8652 (0.8397) acc_u 12.5000 (19.3750) lr 1.9900e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 677
confident_label rate tensor(0.4412, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 713
clean true:703
clean false:10
clean_rate:0.9859747545582047
noisy true:236
noisy false:667
after delete: len(clean_dataset) 713
after delete: len(noisy_dataset) 903
epoch [12/200] batch [5/22] time 0.162 (0.162) data 0.085 (0.085) loss_x loss_x 0.8486 (0.9422) acc_x 81.2500 (79.3750) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [10/22] time 0.175 (0.167) data 0.097 (0.090) loss_x loss_x 0.8872 (0.8890) acc_x 78.1250 (77.8125) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [15/22] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.6089 (0.8931) acc_x 81.2500 (78.1250) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [20/22] time 0.176 (0.175) data 0.098 (0.098) loss_x loss_x 0.8862 (0.9001) acc_x 71.8750 (77.1875) lr 1.9877e-03 eta 0:00:00
epoch [12/200] batch [5/28] time 0.189 (0.178) data 0.112 (0.100) loss_u loss_u 0.7388 (0.8106) acc_u 31.2500 (23.7500) lr 1.9877e-03 eta 0:00:04
epoch [12/200] batch [10/28] time 0.177 (0.178) data 0.099 (0.101) loss_u loss_u 0.8423 (0.8184) acc_u 15.6250 (21.8750) lr 1.9877e-03 eta 0:00:03
epoch [12/200] batch [15/28] time 0.165 (0.177) data 0.088 (0.100) loss_u loss_u 0.8403 (0.8188) acc_u 18.7500 (21.2500) lr 1.9877e-03 eta 0:00:02
epoch [12/200] batch [20/28] time 0.180 (0.178) data 0.103 (0.100) loss_u loss_u 0.8540 (0.8174) acc_u 18.7500 (21.4062) lr 1.9877e-03 eta 0:00:01
epoch [12/200] batch [25/28] time 0.176 (0.178) data 0.097 (0.101) loss_u loss_u 0.8867 (0.8177) acc_u 15.6250 (21.3750) lr 1.9877e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 659
confident_label rate tensor(0.4548, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 735
clean true:727
clean false:8
clean_rate:0.9891156462585035
noisy true:230
noisy false:651
after delete: len(clean_dataset) 735
after delete: len(noisy_dataset) 881
epoch [13/200] batch [5/22] time 0.161 (0.169) data 0.084 (0.092) loss_x loss_x 0.9971 (1.0975) acc_x 75.0000 (70.0000) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [10/22] time 0.176 (0.171) data 0.099 (0.094) loss_x loss_x 0.6851 (0.9659) acc_x 81.2500 (73.4375) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/22] time 0.184 (0.176) data 0.107 (0.099) loss_x loss_x 0.9575 (0.9141) acc_x 68.7500 (74.1667) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [20/22] time 0.177 (0.174) data 0.101 (0.097) loss_x loss_x 0.8184 (0.9366) acc_x 75.0000 (73.7500) lr 1.9851e-03 eta 0:00:00
epoch [13/200] batch [5/27] time 0.168 (0.174) data 0.091 (0.096) loss_u loss_u 0.8789 (0.8320) acc_u 15.6250 (21.8750) lr 1.9851e-03 eta 0:00:03
epoch [13/200] batch [10/27] time 0.176 (0.173) data 0.099 (0.096) loss_u loss_u 0.8262 (0.8387) acc_u 21.8750 (19.3750) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [15/27] time 0.166 (0.175) data 0.089 (0.097) loss_u loss_u 0.8481 (0.8321) acc_u 21.8750 (20.2083) lr 1.9851e-03 eta 0:00:02
epoch [13/200] batch [20/27] time 0.185 (0.175) data 0.108 (0.098) loss_u loss_u 0.7339 (0.8270) acc_u 34.3750 (20.7812) lr 1.9851e-03 eta 0:00:01
epoch [13/200] batch [25/27] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.7969 (0.8188) acc_u 25.0000 (21.6250) lr 1.9851e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 661
confident_label rate tensor(0.4462, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 721
clean true:711
clean false:10
clean_rate:0.986130374479889
noisy true:244
noisy false:651
after delete: len(clean_dataset) 721
after delete: len(noisy_dataset) 895
epoch [14/200] batch [5/22] time 0.180 (0.174) data 0.102 (0.097) loss_x loss_x 0.4739 (0.7011) acc_x 90.6250 (82.5000) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [10/22] time 0.184 (0.178) data 0.107 (0.101) loss_x loss_x 0.9536 (0.8488) acc_x 75.0000 (79.6875) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [15/22] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 1.2021 (0.8909) acc_x 68.7500 (78.1250) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [20/22] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.4736 (0.8421) acc_x 84.3750 (78.4375) lr 1.9823e-03 eta 0:00:00
epoch [14/200] batch [5/27] time 0.181 (0.185) data 0.104 (0.108) loss_u loss_u 0.8550 (0.8487) acc_u 18.7500 (16.8750) lr 1.9823e-03 eta 0:00:04
epoch [14/200] batch [10/27] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.8584 (0.8443) acc_u 15.6250 (16.5625) lr 1.9823e-03 eta 0:00:03
epoch [14/200] batch [15/27] time 0.170 (0.182) data 0.093 (0.105) loss_u loss_u 0.7827 (0.8321) acc_u 21.8750 (17.7083) lr 1.9823e-03 eta 0:00:02
epoch [14/200] batch [20/27] time 0.208 (0.182) data 0.131 (0.105) loss_u loss_u 0.8721 (0.8382) acc_u 18.7500 (17.3438) lr 1.9823e-03 eta 0:00:01
epoch [14/200] batch [25/27] time 0.182 (0.182) data 0.105 (0.105) loss_u loss_u 0.8779 (0.8238) acc_u 18.7500 (19.7500) lr 1.9823e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 634
confident_label rate tensor(0.4598, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 743
clean true:736
clean false:7
clean_rate:0.990578734858681
noisy true:246
noisy false:627
after delete: len(clean_dataset) 743
after delete: len(noisy_dataset) 873
epoch [15/200] batch [5/23] time 0.176 (0.177) data 0.099 (0.099) loss_x loss_x 0.8794 (0.7108) acc_x 81.2500 (81.8750) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/23] time 0.172 (0.175) data 0.094 (0.098) loss_x loss_x 0.7900 (0.8322) acc_x 78.1250 (77.8125) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [15/23] time 0.172 (0.175) data 0.095 (0.097) loss_x loss_x 0.4890 (0.8304) acc_x 90.6250 (77.5000) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [20/23] time 0.198 (0.176) data 0.121 (0.099) loss_x loss_x 1.2207 (0.9007) acc_x 81.2500 (77.5000) lr 1.9792e-03 eta 0:00:00
epoch [15/200] batch [5/27] time 0.167 (0.181) data 0.087 (0.103) loss_u loss_u 0.9019 (0.8167) acc_u 12.5000 (20.6250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [10/27] time 0.189 (0.181) data 0.110 (0.104) loss_u loss_u 0.8101 (0.7986) acc_u 25.0000 (23.1250) lr 1.9792e-03 eta 0:00:03
epoch [15/200] batch [15/27] time 0.185 (0.185) data 0.108 (0.107) loss_u loss_u 0.7905 (0.8128) acc_u 18.7500 (21.6667) lr 1.9792e-03 eta 0:00:02
epoch [15/200] batch [20/27] time 0.218 (0.185) data 0.140 (0.107) loss_u loss_u 0.8267 (0.8220) acc_u 21.8750 (20.7812) lr 1.9792e-03 eta 0:00:01
epoch [15/200] batch [25/27] time 0.192 (0.186) data 0.114 (0.109) loss_u loss_u 0.8276 (0.8262) acc_u 21.8750 (20.7500) lr 1.9792e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 622
confident_label rate tensor(0.4653, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 752
clean true:745
clean false:7
clean_rate:0.9906914893617021
noisy true:249
noisy false:615
after delete: len(clean_dataset) 752
after delete: len(noisy_dataset) 864
epoch [16/200] batch [5/23] time 0.188 (0.186) data 0.111 (0.109) loss_x loss_x 0.7832 (0.7531) acc_x 81.2500 (80.6250) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/23] time 0.163 (0.178) data 0.086 (0.101) loss_x loss_x 0.8335 (0.8559) acc_x 78.1250 (77.8125) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/23] time 0.165 (0.175) data 0.088 (0.098) loss_x loss_x 0.8071 (0.8516) acc_x 75.0000 (77.2917) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [20/23] time 0.180 (0.173) data 0.103 (0.096) loss_x loss_x 0.8081 (0.8478) acc_x 78.1250 (77.1875) lr 1.9759e-03 eta 0:00:00
epoch [16/200] batch [5/27] time 0.165 (0.173) data 0.086 (0.096) loss_u loss_u 0.8574 (0.8294) acc_u 15.6250 (20.0000) lr 1.9759e-03 eta 0:00:03
epoch [16/200] batch [10/27] time 0.174 (0.174) data 0.096 (0.097) loss_u loss_u 0.8691 (0.8410) acc_u 15.6250 (18.1250) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [15/27] time 0.173 (0.175) data 0.095 (0.097) loss_u loss_u 0.8022 (0.8253) acc_u 25.0000 (20.0000) lr 1.9759e-03 eta 0:00:02
epoch [16/200] batch [20/27] time 0.171 (0.174) data 0.093 (0.097) loss_u loss_u 0.7935 (0.8334) acc_u 28.1250 (19.6875) lr 1.9759e-03 eta 0:00:01
epoch [16/200] batch [25/27] time 0.187 (0.175) data 0.110 (0.097) loss_u loss_u 0.7271 (0.8304) acc_u 28.1250 (20.6250) lr 1.9759e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 625
confident_label rate tensor(0.4647, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 751
clean true:744
clean false:7
clean_rate:0.9906790945406125
noisy true:247
noisy false:618
after delete: len(clean_dataset) 751
after delete: len(noisy_dataset) 865
epoch [17/200] batch [5/23] time 0.185 (0.165) data 0.107 (0.088) loss_x loss_x 1.6143 (0.9499) acc_x 75.0000 (78.1250) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [10/23] time 0.178 (0.172) data 0.101 (0.095) loss_x loss_x 0.8706 (1.0168) acc_x 78.1250 (76.2500) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [15/23] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.7139 (0.8875) acc_x 75.0000 (77.5000) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [20/23] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 1.4492 (0.8841) acc_x 65.6250 (77.3438) lr 1.9724e-03 eta 0:00:00
epoch [17/200] batch [5/27] time 0.184 (0.179) data 0.107 (0.102) loss_u loss_u 0.8608 (0.7991) acc_u 12.5000 (21.2500) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [10/27] time 0.184 (0.180) data 0.107 (0.103) loss_u loss_u 0.8438 (0.8146) acc_u 15.6250 (20.6250) lr 1.9724e-03 eta 0:00:03
epoch [17/200] batch [15/27] time 0.186 (0.181) data 0.109 (0.104) loss_u loss_u 0.8604 (0.8112) acc_u 21.8750 (22.7083) lr 1.9724e-03 eta 0:00:02
epoch [17/200] batch [20/27] time 0.187 (0.181) data 0.108 (0.104) loss_u loss_u 0.8848 (0.8182) acc_u 9.3750 (21.2500) lr 1.9724e-03 eta 0:00:01
epoch [17/200] batch [25/27] time 0.188 (0.181) data 0.110 (0.104) loss_u loss_u 0.8330 (0.8245) acc_u 21.8750 (20.5000) lr 1.9724e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 637
confident_label rate tensor(0.4691, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 758
clean true:748
clean false:10
clean_rate:0.9868073878627969
noisy true:231
noisy false:627
after delete: len(clean_dataset) 758
after delete: len(noisy_dataset) 858
epoch [18/200] batch [5/23] time 0.185 (0.188) data 0.108 (0.110) loss_x loss_x 1.0352 (0.8777) acc_x 75.0000 (77.5000) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/23] time 0.178 (0.184) data 0.101 (0.107) loss_x loss_x 0.5249 (0.8167) acc_x 84.3750 (79.3750) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/23] time 0.161 (0.179) data 0.085 (0.102) loss_x loss_x 0.7124 (0.8944) acc_x 78.1250 (78.7500) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/23] time 0.169 (0.179) data 0.092 (0.101) loss_x loss_x 0.9443 (0.8839) acc_x 65.6250 (77.9688) lr 1.9686e-03 eta 0:00:00
epoch [18/200] batch [5/26] time 0.173 (0.176) data 0.096 (0.099) loss_u loss_u 0.7827 (0.7985) acc_u 21.8750 (23.7500) lr 1.9686e-03 eta 0:00:03
epoch [18/200] batch [10/26] time 0.173 (0.175) data 0.095 (0.098) loss_u loss_u 0.8198 (0.8080) acc_u 21.8750 (22.5000) lr 1.9686e-03 eta 0:00:02
epoch [18/200] batch [15/26] time 0.190 (0.176) data 0.114 (0.099) loss_u loss_u 0.8491 (0.8232) acc_u 15.6250 (20.0000) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [20/26] time 0.187 (0.177) data 0.110 (0.100) loss_u loss_u 0.8145 (0.8256) acc_u 21.8750 (20.1562) lr 1.9686e-03 eta 0:00:01
epoch [18/200] batch [25/26] time 0.176 (0.177) data 0.098 (0.100) loss_u loss_u 0.7573 (0.8213) acc_u 21.8750 (20.5000) lr 1.9686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 606
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 775
clean true:765
clean false:10
clean_rate:0.9870967741935484
noisy true:245
noisy false:596
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 841
epoch [19/200] batch [5/24] time 0.159 (0.177) data 0.081 (0.099) loss_x loss_x 1.0791 (0.8100) acc_x 71.8750 (76.8750) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/24] time 0.160 (0.169) data 0.083 (0.091) loss_x loss_x 1.0742 (0.7790) acc_x 65.6250 (77.1875) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/24] time 0.164 (0.168) data 0.087 (0.090) loss_x loss_x 0.8018 (0.7689) acc_x 78.1250 (78.5417) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/24] time 0.192 (0.170) data 0.115 (0.092) loss_x loss_x 1.0244 (0.8207) acc_x 75.0000 (77.3438) lr 1.9646e-03 eta 0:00:00
epoch [19/200] batch [5/26] time 0.186 (0.171) data 0.108 (0.094) loss_u loss_u 0.7573 (0.8556) acc_u 28.1250 (15.6250) lr 1.9646e-03 eta 0:00:03
epoch [19/200] batch [10/26] time 0.171 (0.172) data 0.094 (0.095) loss_u loss_u 0.8540 (0.8473) acc_u 18.7500 (18.4375) lr 1.9646e-03 eta 0:00:02
epoch [19/200] batch [15/26] time 0.178 (0.173) data 0.101 (0.096) loss_u loss_u 0.8066 (0.8394) acc_u 21.8750 (19.1667) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [20/26] time 0.191 (0.174) data 0.113 (0.097) loss_u loss_u 0.7676 (0.8323) acc_u 28.1250 (19.6875) lr 1.9646e-03 eta 0:00:01
epoch [19/200] batch [25/26] time 0.175 (0.174) data 0.098 (0.097) loss_u loss_u 0.7832 (0.8322) acc_u 28.1250 (20.0000) lr 1.9646e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 649
confident_label rate tensor(0.4604, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 744
clean true:732
clean false:12
clean_rate:0.9838709677419355
noisy true:235
noisy false:637
after delete: len(clean_dataset) 744
after delete: len(noisy_dataset) 872
epoch [20/200] batch [5/23] time 0.183 (0.185) data 0.107 (0.108) loss_x loss_x 1.3115 (0.9062) acc_x 68.7500 (75.6250) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [10/23] time 0.186 (0.185) data 0.108 (0.108) loss_x loss_x 0.7148 (0.8448) acc_x 75.0000 (75.9375) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [15/23] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.7051 (0.7942) acc_x 81.2500 (77.0833) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [20/23] time 0.185 (0.185) data 0.108 (0.108) loss_x loss_x 0.6489 (0.7951) acc_x 84.3750 (77.9688) lr 1.9603e-03 eta 0:00:00
epoch [20/200] batch [5/27] time 0.184 (0.185) data 0.107 (0.108) loss_u loss_u 0.8979 (0.8689) acc_u 12.5000 (14.3750) lr 1.9603e-03 eta 0:00:04
epoch [20/200] batch [10/27] time 0.175 (0.185) data 0.098 (0.108) loss_u loss_u 0.7524 (0.8408) acc_u 34.3750 (18.7500) lr 1.9603e-03 eta 0:00:03
epoch [20/200] batch [15/27] time 0.184 (0.184) data 0.107 (0.107) loss_u loss_u 0.7080 (0.8172) acc_u 37.5000 (22.0833) lr 1.9603e-03 eta 0:00:02
epoch [20/200] batch [20/27] time 0.174 (0.183) data 0.097 (0.106) loss_u loss_u 0.7646 (0.8181) acc_u 21.8750 (21.2500) lr 1.9603e-03 eta 0:00:01
epoch [20/200] batch [25/27] time 0.173 (0.183) data 0.096 (0.106) loss_u loss_u 0.6943 (0.8086) acc_u 34.3750 (22.1250) lr 1.9603e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.4796, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 775
clean true:765
clean false:10
clean_rate:0.9870967741935484
noisy true:249
noisy false:592
after delete: len(clean_dataset) 775
after delete: len(noisy_dataset) 841
epoch [21/200] batch [5/24] time 0.187 (0.187) data 0.110 (0.110) loss_x loss_x 0.6860 (0.7774) acc_x 81.2500 (78.7500) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/24] time 0.188 (0.187) data 0.111 (0.110) loss_x loss_x 0.9536 (0.7777) acc_x 75.0000 (79.0625) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/24] time 0.167 (0.184) data 0.090 (0.107) loss_x loss_x 0.5239 (0.7426) acc_x 84.3750 (80.0000) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/24] time 0.168 (0.181) data 0.090 (0.104) loss_x loss_x 1.1885 (0.7713) acc_x 75.0000 (79.0625) lr 1.9558e-03 eta 0:00:00
epoch [21/200] batch [5/26] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.8320 (0.8425) acc_u 34.3750 (21.8750) lr 1.9558e-03 eta 0:00:03
epoch [21/200] batch [10/26] time 0.177 (0.180) data 0.097 (0.102) loss_u loss_u 0.9014 (0.8401) acc_u 12.5000 (20.0000) lr 1.9558e-03 eta 0:00:02
epoch [21/200] batch [15/26] time 0.199 (0.180) data 0.122 (0.103) loss_u loss_u 0.7837 (0.8379) acc_u 21.8750 (19.7917) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [20/26] time 0.172 (0.179) data 0.093 (0.101) loss_u loss_u 0.8516 (0.8382) acc_u 15.6250 (19.5312) lr 1.9558e-03 eta 0:00:01
epoch [21/200] batch [25/26] time 0.221 (0.182) data 0.143 (0.105) loss_u loss_u 0.8330 (0.8383) acc_u 21.8750 (19.8750) lr 1.9558e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 652
confident_label rate tensor(0.4678, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 756
clean true:745
clean false:11
clean_rate:0.9854497354497355
noisy true:219
noisy false:641
after delete: len(clean_dataset) 756
after delete: len(noisy_dataset) 860
epoch [22/200] batch [5/23] time 0.175 (0.173) data 0.097 (0.096) loss_x loss_x 1.1973 (0.8867) acc_x 71.8750 (82.5000) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/23] time 0.169 (0.173) data 0.093 (0.096) loss_x loss_x 0.7148 (0.8616) acc_x 81.2500 (80.9375) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/23] time 0.165 (0.171) data 0.088 (0.094) loss_x loss_x 0.9629 (0.8711) acc_x 68.7500 (78.5417) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/23] time 0.163 (0.169) data 0.086 (0.092) loss_x loss_x 0.8862 (0.8675) acc_x 81.2500 (77.9688) lr 1.9511e-03 eta 0:00:00
epoch [22/200] batch [5/26] time 0.170 (0.170) data 0.093 (0.093) loss_u loss_u 0.8535 (0.8083) acc_u 12.5000 (20.0000) lr 1.9511e-03 eta 0:00:03
epoch [22/200] batch [10/26] time 0.173 (0.170) data 0.094 (0.093) loss_u loss_u 0.8306 (0.8015) acc_u 21.8750 (22.1875) lr 1.9511e-03 eta 0:00:02
epoch [22/200] batch [15/26] time 0.172 (0.171) data 0.094 (0.094) loss_u loss_u 0.8237 (0.8161) acc_u 18.7500 (20.0000) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [20/26] time 0.174 (0.173) data 0.096 (0.095) loss_u loss_u 0.7339 (0.8070) acc_u 31.2500 (21.7188) lr 1.9511e-03 eta 0:00:01
epoch [22/200] batch [25/26] time 0.193 (0.174) data 0.115 (0.097) loss_u loss_u 0.7798 (0.7993) acc_u 28.1250 (22.5000) lr 1.9511e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 607
confident_label rate tensor(0.4870, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 787
clean true:777
clean false:10
clean_rate:0.9872935196950444
noisy true:232
noisy false:597
after delete: len(clean_dataset) 787
after delete: len(noisy_dataset) 829
epoch [23/200] batch [5/24] time 0.168 (0.168) data 0.089 (0.090) loss_x loss_x 1.0430 (0.7382) acc_x 75.0000 (79.3750) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/24] time 0.174 (0.173) data 0.098 (0.095) loss_x loss_x 0.7563 (0.7048) acc_x 84.3750 (80.9375) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/24] time 0.168 (0.173) data 0.090 (0.096) loss_x loss_x 0.5127 (0.7142) acc_x 87.5000 (80.8333) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/24] time 0.185 (0.172) data 0.107 (0.095) loss_x loss_x 0.6772 (0.7471) acc_x 84.3750 (80.1562) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [5/25] time 0.166 (0.173) data 0.087 (0.096) loss_u loss_u 0.7427 (0.7858) acc_u 34.3750 (25.6250) lr 1.9461e-03 eta 0:00:03
epoch [23/200] batch [10/25] time 0.177 (0.173) data 0.100 (0.096) loss_u loss_u 0.8447 (0.8064) acc_u 15.6250 (21.8750) lr 1.9461e-03 eta 0:00:02
epoch [23/200] batch [15/25] time 0.174 (0.174) data 0.096 (0.096) loss_u loss_u 0.8403 (0.8066) acc_u 18.7500 (21.6667) lr 1.9461e-03 eta 0:00:01
epoch [23/200] batch [20/25] time 0.162 (0.173) data 0.085 (0.095) loss_u loss_u 0.7593 (0.8066) acc_u 25.0000 (22.0312) lr 1.9461e-03 eta 0:00:00
epoch [23/200] batch [25/25] time 0.173 (0.173) data 0.096 (0.095) loss_u loss_u 0.8457 (0.8093) acc_u 21.8750 (22.3750) lr 1.9461e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 602
confident_label rate tensor(0.4833, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 781
clean true:773
clean false:8
clean_rate:0.9897567221510883
noisy true:241
noisy false:594
after delete: len(clean_dataset) 781
after delete: len(noisy_dataset) 835
epoch [24/200] batch [5/24] time 0.186 (0.188) data 0.109 (0.111) loss_x loss_x 1.1807 (0.9748) acc_x 65.6250 (73.7500) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/24] time 0.187 (0.188) data 0.109 (0.110) loss_x loss_x 0.9629 (0.8824) acc_x 75.0000 (76.2500) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/24] time 0.187 (0.188) data 0.110 (0.110) loss_x loss_x 0.7690 (0.8814) acc_x 78.1250 (76.6667) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [20/24] time 0.197 (0.189) data 0.120 (0.111) loss_x loss_x 0.6802 (0.8435) acc_x 87.5000 (77.8125) lr 1.9409e-03 eta 0:00:00
epoch [24/200] batch [5/26] time 0.179 (0.188) data 0.101 (0.110) loss_u loss_u 0.8174 (0.7934) acc_u 18.7500 (23.1250) lr 1.9409e-03 eta 0:00:03
epoch [24/200] batch [10/26] time 0.172 (0.186) data 0.095 (0.108) loss_u loss_u 0.8350 (0.8037) acc_u 18.7500 (23.1250) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [15/26] time 0.175 (0.184) data 0.096 (0.106) loss_u loss_u 0.8457 (0.8156) acc_u 18.7500 (21.8750) lr 1.9409e-03 eta 0:00:02
epoch [24/200] batch [20/26] time 0.165 (0.182) data 0.087 (0.105) loss_u loss_u 0.7939 (0.8182) acc_u 28.1250 (21.8750) lr 1.9409e-03 eta 0:00:01
epoch [24/200] batch [25/26] time 0.188 (0.182) data 0.109 (0.104) loss_u loss_u 0.8027 (0.8158) acc_u 28.1250 (22.5000) lr 1.9409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 559
confident_label rate tensor(0.5000, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 808
clean true:796
clean false:12
clean_rate:0.9851485148514851
noisy true:261
noisy false:547
after delete: len(clean_dataset) 808
after delete: len(noisy_dataset) 808
epoch [25/200] batch [5/25] time 0.175 (0.169) data 0.098 (0.091) loss_x loss_x 1.2881 (1.1040) acc_x 68.7500 (70.0000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/25] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.6938 (0.8848) acc_x 84.3750 (75.3125) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/25] time 0.181 (0.177) data 0.104 (0.100) loss_x loss_x 1.0400 (0.8615) acc_x 68.7500 (76.6667) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/25] time 0.186 (0.179) data 0.108 (0.102) loss_x loss_x 1.1250 (0.8585) acc_x 65.6250 (77.5000) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [25/25] time 0.183 (0.179) data 0.106 (0.102) loss_x loss_x 0.5762 (0.8387) acc_x 87.5000 (77.8750) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [5/25] time 0.186 (0.181) data 0.108 (0.104) loss_u loss_u 0.7881 (0.8234) acc_u 21.8750 (22.5000) lr 1.9354e-03 eta 0:00:03
epoch [25/200] batch [10/25] time 0.184 (0.182) data 0.107 (0.105) loss_u loss_u 0.8770 (0.8334) acc_u 21.8750 (20.3125) lr 1.9354e-03 eta 0:00:02
epoch [25/200] batch [15/25] time 0.185 (0.182) data 0.107 (0.105) loss_u loss_u 0.8481 (0.8297) acc_u 18.7500 (20.8333) lr 1.9354e-03 eta 0:00:01
epoch [25/200] batch [20/25] time 0.171 (0.182) data 0.094 (0.105) loss_u loss_u 0.8516 (0.8337) acc_u 12.5000 (20.0000) lr 1.9354e-03 eta 0:00:00
epoch [25/200] batch [25/25] time 0.168 (0.182) data 0.090 (0.104) loss_u loss_u 0.8457 (0.8396) acc_u 18.7500 (19.2500) lr 1.9354e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 588
confident_label rate tensor(0.4882, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 789
clean true:776
clean false:13
clean_rate:0.9835234474017744
noisy true:252
noisy false:575
after delete: len(clean_dataset) 789
after delete: len(noisy_dataset) 827
epoch [26/200] batch [5/24] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 1.0186 (0.7175) acc_x 75.0000 (81.8750) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/24] time 0.192 (0.169) data 0.115 (0.092) loss_x loss_x 0.8398 (0.7069) acc_x 75.0000 (80.0000) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/24] time 0.164 (0.169) data 0.087 (0.092) loss_x loss_x 1.6738 (0.7684) acc_x 59.3750 (79.7917) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/24] time 0.168 (0.168) data 0.091 (0.091) loss_x loss_x 0.7188 (0.7493) acc_x 75.0000 (79.8438) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [5/25] time 0.187 (0.172) data 0.108 (0.095) loss_u loss_u 0.8457 (0.8076) acc_u 18.7500 (23.7500) lr 1.9298e-03 eta 0:00:03
epoch [26/200] batch [10/25] time 0.167 (0.172) data 0.090 (0.095) loss_u loss_u 0.8823 (0.8180) acc_u 15.6250 (20.9375) lr 1.9298e-03 eta 0:00:02
epoch [26/200] batch [15/25] time 0.166 (0.170) data 0.089 (0.093) loss_u loss_u 0.8149 (0.8095) acc_u 18.7500 (22.0833) lr 1.9298e-03 eta 0:00:01
epoch [26/200] batch [20/25] time 0.172 (0.171) data 0.094 (0.093) loss_u loss_u 0.7881 (0.7930) acc_u 25.0000 (23.5938) lr 1.9298e-03 eta 0:00:00
epoch [26/200] batch [25/25] time 0.184 (0.171) data 0.107 (0.094) loss_u loss_u 0.8037 (0.8105) acc_u 28.1250 (21.8750) lr 1.9298e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 592
confident_label rate tensor(0.4808, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 777
clean true:771
clean false:6
clean_rate:0.9922779922779923
noisy true:253
noisy false:586
after delete: len(clean_dataset) 777
after delete: len(noisy_dataset) 839
epoch [27/200] batch [5/24] time 0.179 (0.179) data 0.102 (0.102) loss_x loss_x 0.9351 (0.8246) acc_x 78.1250 (80.6250) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/24] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.9580 (0.7921) acc_x 68.7500 (80.6250) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/24] time 0.168 (0.174) data 0.091 (0.097) loss_x loss_x 0.5796 (0.8117) acc_x 84.3750 (80.2083) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/24] time 0.164 (0.172) data 0.087 (0.095) loss_x loss_x 0.8154 (0.8309) acc_x 81.2500 (80.0000) lr 1.9239e-03 eta 0:00:00
epoch [27/200] batch [5/26] time 0.179 (0.169) data 0.102 (0.092) loss_u loss_u 0.8052 (0.7849) acc_u 21.8750 (25.0000) lr 1.9239e-03 eta 0:00:03
epoch [27/200] batch [10/26] time 0.179 (0.171) data 0.102 (0.094) loss_u loss_u 0.8022 (0.7954) acc_u 18.7500 (23.1250) lr 1.9239e-03 eta 0:00:02
epoch [27/200] batch [15/26] time 0.185 (0.173) data 0.107 (0.095) loss_u loss_u 0.8716 (0.8008) acc_u 15.6250 (23.5417) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [20/26] time 0.174 (0.173) data 0.097 (0.096) loss_u loss_u 0.8198 (0.8017) acc_u 21.8750 (23.2812) lr 1.9239e-03 eta 0:00:01
epoch [27/200] batch [25/26] time 0.174 (0.174) data 0.097 (0.096) loss_u loss_u 0.8730 (0.8089) acc_u 15.6250 (22.0000) lr 1.9239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 595
confident_label rate tensor(0.4864, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 786
clean true:774
clean false:12
clean_rate:0.9847328244274809
noisy true:247
noisy false:583
after delete: len(clean_dataset) 786
after delete: len(noisy_dataset) 830
epoch [28/200] batch [5/24] time 0.170 (0.167) data 0.092 (0.090) loss_x loss_x 0.9038 (0.8055) acc_x 84.3750 (80.6250) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/24] time 0.185 (0.174) data 0.108 (0.096) loss_x loss_x 0.8921 (0.8618) acc_x 75.0000 (77.1875) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/24] time 0.179 (0.177) data 0.103 (0.100) loss_x loss_x 0.8584 (0.8478) acc_x 75.0000 (77.7083) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/24] time 0.173 (0.176) data 0.096 (0.099) loss_x loss_x 0.9204 (0.8411) acc_x 81.2500 (77.3438) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [5/25] time 0.169 (0.176) data 0.092 (0.099) loss_u loss_u 0.8232 (0.8262) acc_u 21.8750 (20.0000) lr 1.9178e-03 eta 0:00:03
epoch [28/200] batch [10/25] time 0.169 (0.174) data 0.090 (0.097) loss_u loss_u 0.7524 (0.7992) acc_u 34.3750 (24.3750) lr 1.9178e-03 eta 0:00:02
epoch [28/200] batch [15/25] time 0.178 (0.175) data 0.099 (0.097) loss_u loss_u 0.8892 (0.8117) acc_u 12.5000 (22.9167) lr 1.9178e-03 eta 0:00:01
epoch [28/200] batch [20/25] time 0.169 (0.176) data 0.092 (0.098) loss_u loss_u 0.8647 (0.8167) acc_u 15.6250 (22.0312) lr 1.9178e-03 eta 0:00:00
epoch [28/200] batch [25/25] time 0.182 (0.175) data 0.104 (0.098) loss_u loss_u 0.8799 (0.8202) acc_u 21.8750 (21.8750) lr 1.9178e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 615
confident_label rate tensor(0.4827, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 780
clean true:767
clean false:13
clean_rate:0.9833333333333333
noisy true:234
noisy false:602
after delete: len(clean_dataset) 780
after delete: len(noisy_dataset) 836
epoch [29/200] batch [5/24] time 0.186 (0.186) data 0.109 (0.109) loss_x loss_x 1.2607 (0.9772) acc_x 62.5000 (75.0000) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/24] time 0.162 (0.181) data 0.085 (0.104) loss_x loss_x 0.4299 (0.8696) acc_x 90.6250 (79.0625) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/24] time 0.176 (0.177) data 0.099 (0.100) loss_x loss_x 1.0078 (0.9097) acc_x 75.0000 (78.3333) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/24] time 0.176 (0.176) data 0.099 (0.099) loss_x loss_x 0.9053 (0.8944) acc_x 78.1250 (79.2188) lr 1.9114e-03 eta 0:00:00
epoch [29/200] batch [5/26] time 0.183 (0.177) data 0.105 (0.099) loss_u loss_u 0.8433 (0.8146) acc_u 18.7500 (21.8750) lr 1.9114e-03 eta 0:00:03
epoch [29/200] batch [10/26] time 0.179 (0.178) data 0.101 (0.100) loss_u loss_u 0.8740 (0.8011) acc_u 9.3750 (22.8125) lr 1.9114e-03 eta 0:00:02
epoch [29/200] batch [15/26] time 0.202 (0.178) data 0.124 (0.101) loss_u loss_u 0.7231 (0.7900) acc_u 31.2500 (24.1667) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [20/26] time 0.228 (0.179) data 0.151 (0.102) loss_u loss_u 0.7974 (0.7981) acc_u 21.8750 (23.1250) lr 1.9114e-03 eta 0:00:01
epoch [29/200] batch [25/26] time 0.181 (0.179) data 0.103 (0.101) loss_u loss_u 0.9004 (0.8040) acc_u 15.6250 (22.6250) lr 1.9114e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 593
confident_label rate tensor(0.4926, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 796
clean true:789
clean false:7
clean_rate:0.9912060301507538
noisy true:234
noisy false:586
after delete: len(clean_dataset) 796
after delete: len(noisy_dataset) 820
epoch [30/200] batch [5/24] time 0.170 (0.175) data 0.094 (0.097) loss_x loss_x 0.8262 (0.7311) acc_x 78.1250 (83.7500) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/24] time 0.165 (0.171) data 0.088 (0.094) loss_x loss_x 0.9302 (0.8307) acc_x 68.7500 (80.3125) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/24] time 0.168 (0.173) data 0.091 (0.096) loss_x loss_x 0.8364 (0.8772) acc_x 75.0000 (78.7500) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/24] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.9526 (0.8691) acc_x 75.0000 (78.5938) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [5/25] time 0.192 (0.172) data 0.115 (0.095) loss_u loss_u 0.7583 (0.8185) acc_u 31.2500 (23.1250) lr 1.9048e-03 eta 0:00:03
epoch [30/200] batch [10/25] time 0.170 (0.172) data 0.093 (0.095) loss_u loss_u 0.9072 (0.8415) acc_u 9.3750 (19.0625) lr 1.9048e-03 eta 0:00:02
epoch [30/200] batch [15/25] time 0.185 (0.174) data 0.107 (0.096) loss_u loss_u 0.7866 (0.8279) acc_u 31.2500 (20.6250) lr 1.9048e-03 eta 0:00:01
epoch [30/200] batch [20/25] time 0.175 (0.173) data 0.097 (0.096) loss_u loss_u 0.7441 (0.8287) acc_u 28.1250 (20.3125) lr 1.9048e-03 eta 0:00:00
epoch [30/200] batch [25/25] time 0.184 (0.174) data 0.106 (0.097) loss_u loss_u 0.8628 (0.8284) acc_u 15.6250 (20.3750) lr 1.9048e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 581
confident_label rate tensor(0.4845, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 783
clean true:774
clean false:9
clean_rate:0.9885057471264368
noisy true:261
noisy false:572
after delete: len(clean_dataset) 783
after delete: len(noisy_dataset) 833
epoch [31/200] batch [5/24] time 0.182 (0.177) data 0.104 (0.100) loss_x loss_x 0.7930 (1.0571) acc_x 78.1250 (76.2500) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/24] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.4817 (0.9499) acc_x 84.3750 (77.5000) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/24] time 0.169 (0.171) data 0.092 (0.094) loss_x loss_x 0.9629 (0.9392) acc_x 75.0000 (76.4583) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/24] time 0.180 (0.170) data 0.102 (0.093) loss_x loss_x 0.9951 (0.8929) acc_x 78.1250 (77.3438) lr 1.8980e-03 eta 0:00:00
epoch [31/200] batch [5/26] time 0.171 (0.169) data 0.094 (0.092) loss_u loss_u 0.8750 (0.8201) acc_u 15.6250 (21.2500) lr 1.8980e-03 eta 0:00:03
epoch [31/200] batch [10/26] time 0.170 (0.170) data 0.093 (0.092) loss_u loss_u 0.8638 (0.8210) acc_u 18.7500 (21.5625) lr 1.8980e-03 eta 0:00:02
epoch [31/200] batch [15/26] time 0.176 (0.170) data 0.098 (0.092) loss_u loss_u 0.7651 (0.8167) acc_u 28.1250 (21.8750) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [20/26] time 0.163 (0.170) data 0.084 (0.093) loss_u loss_u 0.8760 (0.8184) acc_u 15.6250 (21.7188) lr 1.8980e-03 eta 0:00:01
epoch [31/200] batch [25/26] time 0.168 (0.170) data 0.090 (0.093) loss_u loss_u 0.8228 (0.8159) acc_u 18.7500 (21.6250) lr 1.8980e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 571
confident_label rate tensor(0.4920, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 795
clean true:786
clean false:9
clean_rate:0.9886792452830189
noisy true:259
noisy false:562
after delete: len(clean_dataset) 795
after delete: len(noisy_dataset) 821
epoch [32/200] batch [5/24] time 0.167 (0.169) data 0.090 (0.092) loss_x loss_x 0.4954 (0.4758) acc_x 84.3750 (87.5000) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/24] time 0.164 (0.168) data 0.088 (0.091) loss_x loss_x 1.0605 (0.5633) acc_x 78.1250 (86.5625) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/24] time 0.170 (0.169) data 0.093 (0.092) loss_x loss_x 0.8394 (0.6685) acc_x 75.0000 (83.1250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/24] time 0.165 (0.169) data 0.088 (0.092) loss_x loss_x 0.8037 (0.6915) acc_x 84.3750 (82.8125) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [5/25] time 0.173 (0.171) data 0.095 (0.094) loss_u loss_u 0.8062 (0.7969) acc_u 21.8750 (21.8750) lr 1.8910e-03 eta 0:00:03
epoch [32/200] batch [10/25] time 0.177 (0.172) data 0.100 (0.095) loss_u loss_u 0.8169 (0.8160) acc_u 21.8750 (20.0000) lr 1.8910e-03 eta 0:00:02
epoch [32/200] batch [15/25] time 0.186 (0.173) data 0.108 (0.096) loss_u loss_u 0.8164 (0.8141) acc_u 18.7500 (20.6250) lr 1.8910e-03 eta 0:00:01
epoch [32/200] batch [20/25] time 0.182 (0.174) data 0.105 (0.097) loss_u loss_u 0.7847 (0.8060) acc_u 28.1250 (21.5625) lr 1.8910e-03 eta 0:00:00
epoch [32/200] batch [25/25] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.8428 (0.8092) acc_u 15.6250 (20.8750) lr 1.8910e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 547
confident_label rate tensor(0.5080, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 821
clean true:808
clean false:13
clean_rate:0.9841656516443362
noisy true:261
noisy false:534
after delete: len(clean_dataset) 821
after delete: len(noisy_dataset) 795
epoch [33/200] batch [5/25] time 0.179 (0.172) data 0.102 (0.095) loss_x loss_x 1.0127 (0.8454) acc_x 75.0000 (80.6250) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/25] time 0.171 (0.174) data 0.094 (0.097) loss_x loss_x 0.6289 (0.7503) acc_x 90.6250 (82.8125) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/25] time 0.182 (0.174) data 0.105 (0.097) loss_x loss_x 0.7456 (0.7402) acc_x 78.1250 (82.2917) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/25] time 0.188 (0.177) data 0.110 (0.100) loss_x loss_x 0.8027 (0.7704) acc_x 75.0000 (81.4062) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [25/25] time 0.187 (0.179) data 0.109 (0.102) loss_x loss_x 0.5459 (0.7668) acc_x 81.2500 (81.6250) lr 1.8838e-03 eta 0:00:00
epoch [33/200] batch [5/24] time 0.182 (0.180) data 0.103 (0.102) loss_u loss_u 0.7764 (0.8081) acc_u 31.2500 (23.1250) lr 1.8838e-03 eta 0:00:03
epoch [33/200] batch [10/24] time 0.165 (0.179) data 0.087 (0.101) loss_u loss_u 0.7339 (0.8071) acc_u 25.0000 (21.5625) lr 1.8838e-03 eta 0:00:02
epoch [33/200] batch [15/24] time 0.171 (0.177) data 0.094 (0.100) loss_u loss_u 0.7993 (0.8076) acc_u 25.0000 (21.8750) lr 1.8838e-03 eta 0:00:01
epoch [33/200] batch [20/24] time 0.162 (0.177) data 0.083 (0.099) loss_u loss_u 0.7832 (0.8118) acc_u 21.8750 (21.2500) lr 1.8838e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.5062, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 818
clean true:803
clean false:15
clean_rate:0.9816625916870416
noisy true:268
noisy false:530
after delete: len(clean_dataset) 818
after delete: len(noisy_dataset) 798
epoch [34/200] batch [5/25] time 0.182 (0.175) data 0.105 (0.098) loss_x loss_x 0.7500 (0.8222) acc_x 78.1250 (79.3750) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/25] time 0.186 (0.185) data 0.110 (0.108) loss_x loss_x 1.3438 (0.8710) acc_x 68.7500 (78.7500) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/25] time 0.167 (0.180) data 0.090 (0.103) loss_x loss_x 0.9473 (0.8059) acc_x 71.8750 (79.5833) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/25] time 0.169 (0.178) data 0.093 (0.101) loss_x loss_x 0.8589 (0.8757) acc_x 81.2500 (78.4375) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [25/25] time 0.169 (0.176) data 0.092 (0.099) loss_x loss_x 1.3770 (0.8627) acc_x 65.6250 (78.6250) lr 1.8763e-03 eta 0:00:00
epoch [34/200] batch [5/24] time 0.169 (0.175) data 0.091 (0.098) loss_u loss_u 0.8125 (0.8218) acc_u 21.8750 (20.6250) lr 1.8763e-03 eta 0:00:03
epoch [34/200] batch [10/24] time 0.173 (0.174) data 0.096 (0.097) loss_u loss_u 0.8438 (0.8210) acc_u 15.6250 (21.5625) lr 1.8763e-03 eta 0:00:02
epoch [34/200] batch [15/24] time 0.188 (0.174) data 0.110 (0.097) loss_u loss_u 0.7222 (0.8076) acc_u 31.2500 (22.7083) lr 1.8763e-03 eta 0:00:01
epoch [34/200] batch [20/24] time 0.164 (0.174) data 0.087 (0.097) loss_u loss_u 0.7568 (0.8106) acc_u 28.1250 (22.3438) lr 1.8763e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 536
confident_label rate tensor(0.5173, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 836
clean true:819
clean false:17
clean_rate:0.9796650717703349
noisy true:261
noisy false:519
after delete: len(clean_dataset) 836
after delete: len(noisy_dataset) 780
epoch [35/200] batch [5/26] time 0.185 (0.187) data 0.109 (0.110) loss_x loss_x 1.2119 (0.9830) acc_x 78.1250 (75.0000) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/26] time 0.187 (0.185) data 0.110 (0.108) loss_x loss_x 0.8931 (0.9203) acc_x 75.0000 (75.3125) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/26] time 0.181 (0.186) data 0.103 (0.109) loss_x loss_x 0.7388 (0.8952) acc_x 78.1250 (75.2083) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [20/26] time 0.181 (0.186) data 0.104 (0.109) loss_x loss_x 0.7368 (0.8351) acc_x 78.1250 (76.5625) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [25/26] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.6880 (0.8278) acc_x 78.1250 (76.8750) lr 1.8686e-03 eta 0:00:00
epoch [35/200] batch [5/24] time 0.180 (0.185) data 0.103 (0.108) loss_u loss_u 0.8164 (0.8123) acc_u 28.1250 (23.1250) lr 1.8686e-03 eta 0:00:03
epoch [35/200] batch [10/24] time 0.187 (0.184) data 0.110 (0.107) loss_u loss_u 0.8848 (0.8266) acc_u 15.6250 (21.2500) lr 1.8686e-03 eta 0:00:02
epoch [35/200] batch [15/24] time 0.179 (0.183) data 0.101 (0.106) loss_u loss_u 0.8564 (0.8363) acc_u 15.6250 (19.1667) lr 1.8686e-03 eta 0:00:01
epoch [35/200] batch [20/24] time 0.179 (0.183) data 0.101 (0.106) loss_u loss_u 0.7910 (0.8252) acc_u 28.1250 (20.1562) lr 1.8686e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 545
confident_label rate tensor(0.5142, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 831
clean true:820
clean false:11
clean_rate:0.98676293622142
noisy true:251
noisy false:534
after delete: len(clean_dataset) 831
after delete: len(noisy_dataset) 785
epoch [36/200] batch [5/25] time 0.188 (0.185) data 0.110 (0.107) loss_x loss_x 0.5190 (0.8370) acc_x 81.2500 (78.1250) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/25] time 0.166 (0.184) data 0.089 (0.107) loss_x loss_x 0.7886 (0.7969) acc_x 75.0000 (79.6875) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/25] time 0.176 (0.180) data 0.099 (0.103) loss_x loss_x 0.8262 (0.8173) acc_x 81.2500 (78.9583) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/25] time 0.175 (0.177) data 0.098 (0.100) loss_x loss_x 0.5771 (0.7966) acc_x 84.3750 (79.0625) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [25/25] time 0.171 (0.176) data 0.094 (0.099) loss_x loss_x 0.8276 (0.8256) acc_x 84.3750 (78.1250) lr 1.8607e-03 eta 0:00:00
epoch [36/200] batch [5/24] time 0.172 (0.175) data 0.095 (0.098) loss_u loss_u 0.7383 (0.8078) acc_u 28.1250 (21.8750) lr 1.8607e-03 eta 0:00:03
epoch [36/200] batch [10/24] time 0.181 (0.176) data 0.104 (0.099) loss_u loss_u 0.8887 (0.8136) acc_u 15.6250 (22.5000) lr 1.8607e-03 eta 0:00:02
epoch [36/200] batch [15/24] time 0.184 (0.177) data 0.106 (0.100) loss_u loss_u 0.9326 (0.8134) acc_u 6.2500 (22.7083) lr 1.8607e-03 eta 0:00:01
epoch [36/200] batch [20/24] time 0.184 (0.178) data 0.107 (0.101) loss_u loss_u 0.8213 (0.8059) acc_u 21.8750 (23.4375) lr 1.8607e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 535
confident_label rate tensor(0.5204, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 841
clean true:831
clean false:10
clean_rate:0.9881093935790726
noisy true:250
noisy false:525
after delete: len(clean_dataset) 841
after delete: len(noisy_dataset) 775
epoch [37/200] batch [5/26] time 0.182 (0.191) data 0.105 (0.114) loss_x loss_x 1.0039 (0.9549) acc_x 78.1250 (76.2500) lr 1.8526e-03 eta 0:00:04
epoch [37/200] batch [10/26] time 0.175 (0.181) data 0.098 (0.104) loss_x loss_x 0.7197 (0.8682) acc_x 84.3750 (76.8750) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/26] time 0.195 (0.182) data 0.118 (0.106) loss_x loss_x 0.9575 (0.8436) acc_x 71.8750 (78.1250) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [20/26] time 0.245 (0.185) data 0.168 (0.108) loss_x loss_x 0.7349 (0.8084) acc_x 71.8750 (78.4375) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [25/26] time 0.194 (0.184) data 0.117 (0.107) loss_x loss_x 1.1875 (0.8256) acc_x 65.6250 (77.8750) lr 1.8526e-03 eta 0:00:00
epoch [37/200] batch [5/24] time 0.181 (0.184) data 0.103 (0.106) loss_u loss_u 0.8159 (0.7918) acc_u 21.8750 (23.7500) lr 1.8526e-03 eta 0:00:03
epoch [37/200] batch [10/24] time 0.184 (0.184) data 0.106 (0.106) loss_u loss_u 0.8433 (0.8283) acc_u 21.8750 (20.6250) lr 1.8526e-03 eta 0:00:02
epoch [37/200] batch [15/24] time 0.187 (0.184) data 0.108 (0.107) loss_u loss_u 0.7490 (0.8189) acc_u 31.2500 (21.8750) lr 1.8526e-03 eta 0:00:01
epoch [37/200] batch [20/24] time 0.187 (0.184) data 0.108 (0.107) loss_u loss_u 0.8062 (0.8105) acc_u 28.1250 (22.9688) lr 1.8526e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 562
confident_label rate tensor(0.5043, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 815
clean true:804
clean false:11
clean_rate:0.9865030674846625
noisy true:250
noisy false:551
after delete: len(clean_dataset) 815
after delete: len(noisy_dataset) 801
epoch [38/200] batch [5/25] time 0.167 (0.184) data 0.090 (0.106) loss_x loss_x 0.6206 (0.6222) acc_x 84.3750 (84.3750) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/25] time 0.179 (0.183) data 0.102 (0.106) loss_x loss_x 0.4724 (0.7348) acc_x 87.5000 (82.5000) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/25] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 1.0566 (0.7214) acc_x 71.8750 (81.8750) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/25] time 0.168 (0.178) data 0.091 (0.101) loss_x loss_x 0.3335 (0.6742) acc_x 93.7500 (82.8125) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [25/25] time 0.170 (0.177) data 0.092 (0.100) loss_x loss_x 1.0332 (0.7420) acc_x 68.7500 (80.6250) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [5/25] time 0.172 (0.176) data 0.095 (0.099) loss_u loss_u 0.8618 (0.8143) acc_u 21.8750 (25.0000) lr 1.8443e-03 eta 0:00:03
epoch [38/200] batch [10/25] time 0.182 (0.176) data 0.105 (0.099) loss_u loss_u 0.7197 (0.7917) acc_u 37.5000 (26.5625) lr 1.8443e-03 eta 0:00:02
epoch [38/200] batch [15/25] time 0.185 (0.177) data 0.108 (0.100) loss_u loss_u 0.9048 (0.8044) acc_u 9.3750 (23.7500) lr 1.8443e-03 eta 0:00:01
epoch [38/200] batch [20/25] time 0.222 (0.179) data 0.145 (0.102) loss_u loss_u 0.9004 (0.8120) acc_u 9.3750 (22.1875) lr 1.8443e-03 eta 0:00:00
epoch [38/200] batch [25/25] time 0.169 (0.180) data 0.092 (0.102) loss_u loss_u 0.7998 (0.8076) acc_u 25.0000 (22.5000) lr 1.8443e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 505
confident_label rate tensor(0.5309, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 858
clean true:848
clean false:10
clean_rate:0.9883449883449883
noisy true:263
noisy false:495
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 758
epoch [39/200] batch [5/26] time 0.160 (0.163) data 0.082 (0.085) loss_x loss_x 0.3755 (0.6144) acc_x 87.5000 (83.1250) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/26] time 0.186 (0.175) data 0.108 (0.097) loss_x loss_x 0.5039 (0.6685) acc_x 90.6250 (82.1875) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/26] time 0.183 (0.178) data 0.106 (0.101) loss_x loss_x 0.6079 (0.6316) acc_x 84.3750 (83.1250) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/26] time 0.176 (0.180) data 0.098 (0.102) loss_x loss_x 0.4255 (0.6473) acc_x 90.6250 (82.9688) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [25/26] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.8882 (0.6424) acc_x 71.8750 (83.2500) lr 1.8358e-03 eta 0:00:00
epoch [39/200] batch [5/23] time 0.168 (0.178) data 0.091 (0.100) loss_u loss_u 0.7827 (0.8071) acc_u 28.1250 (20.6250) lr 1.8358e-03 eta 0:00:03
epoch [39/200] batch [10/23] time 0.198 (0.179) data 0.120 (0.101) loss_u loss_u 0.8682 (0.8324) acc_u 15.6250 (19.3750) lr 1.8358e-03 eta 0:00:02
epoch [39/200] batch [15/23] time 0.185 (0.179) data 0.108 (0.101) loss_u loss_u 0.8135 (0.8199) acc_u 18.7500 (20.2083) lr 1.8358e-03 eta 0:00:01
epoch [39/200] batch [20/23] time 0.175 (0.179) data 0.097 (0.101) loss_u loss_u 0.8384 (0.8156) acc_u 18.7500 (20.6250) lr 1.8358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 551
confident_label rate tensor(0.5210, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 842
clean true:828
clean false:14
clean_rate:0.9833729216152018
noisy true:237
noisy false:537
after delete: len(clean_dataset) 842
after delete: len(noisy_dataset) 774
epoch [40/200] batch [5/26] time 0.160 (0.167) data 0.082 (0.090) loss_x loss_x 1.2441 (0.8286) acc_x 65.6250 (78.1250) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/26] time 0.163 (0.170) data 0.086 (0.093) loss_x loss_x 0.3918 (0.8046) acc_x 87.5000 (77.5000) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/26] time 0.167 (0.169) data 0.090 (0.092) loss_x loss_x 1.2324 (0.8400) acc_x 65.6250 (76.6667) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/26] time 0.176 (0.171) data 0.099 (0.094) loss_x loss_x 0.6597 (0.8402) acc_x 84.3750 (77.1875) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [25/26] time 0.186 (0.172) data 0.110 (0.095) loss_x loss_x 0.7524 (0.8128) acc_x 87.5000 (78.2500) lr 1.8271e-03 eta 0:00:00
epoch [40/200] batch [5/24] time 0.182 (0.173) data 0.105 (0.096) loss_u loss_u 0.7969 (0.8402) acc_u 25.0000 (18.1250) lr 1.8271e-03 eta 0:00:03
epoch [40/200] batch [10/24] time 0.167 (0.174) data 0.090 (0.096) loss_u loss_u 0.6577 (0.8008) acc_u 37.5000 (21.8750) lr 1.8271e-03 eta 0:00:02
epoch [40/200] batch [15/24] time 0.176 (0.173) data 0.099 (0.096) loss_u loss_u 0.7354 (0.8015) acc_u 34.3750 (22.0833) lr 1.8271e-03 eta 0:00:01
epoch [40/200] batch [20/24] time 0.176 (0.173) data 0.097 (0.096) loss_u loss_u 0.7759 (0.8021) acc_u 28.1250 (22.1875) lr 1.8271e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 562
confident_label rate tensor(0.5111, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 826
clean true:817
clean false:9
clean_rate:0.9891041162227603
noisy true:237
noisy false:553
after delete: len(clean_dataset) 826
after delete: len(noisy_dataset) 790
epoch [41/200] batch [5/25] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.9102 (0.6044) acc_x 75.0000 (84.3750) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/25] time 0.160 (0.170) data 0.083 (0.093) loss_x loss_x 1.0869 (0.6621) acc_x 75.0000 (83.7500) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/25] time 0.159 (0.168) data 0.082 (0.091) loss_x loss_x 0.7466 (0.6170) acc_x 81.2500 (84.5833) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/25] time 0.186 (0.171) data 0.109 (0.094) loss_x loss_x 0.9448 (0.6347) acc_x 75.0000 (84.2188) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [25/25] time 0.213 (0.175) data 0.137 (0.098) loss_x loss_x 0.5073 (0.6440) acc_x 84.3750 (84.1250) lr 1.8181e-03 eta 0:00:00
epoch [41/200] batch [5/24] time 0.161 (0.175) data 0.083 (0.098) loss_u loss_u 0.8916 (0.7896) acc_u 9.3750 (23.1250) lr 1.8181e-03 eta 0:00:03
epoch [41/200] batch [10/24] time 0.167 (0.175) data 0.090 (0.098) loss_u loss_u 0.7432 (0.7885) acc_u 31.2500 (25.0000) lr 1.8181e-03 eta 0:00:02
epoch [41/200] batch [15/24] time 0.191 (0.175) data 0.112 (0.098) loss_u loss_u 0.7681 (0.7876) acc_u 25.0000 (25.2083) lr 1.8181e-03 eta 0:00:01
epoch [41/200] batch [20/24] time 0.159 (0.175) data 0.082 (0.098) loss_u loss_u 0.8525 (0.7994) acc_u 15.6250 (23.9062) lr 1.8181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 513
confident_label rate tensor(0.5309, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 858
clean true:848
clean false:10
clean_rate:0.9883449883449883
noisy true:255
noisy false:503
after delete: len(clean_dataset) 858
after delete: len(noisy_dataset) 758
epoch [42/200] batch [5/26] time 0.165 (0.180) data 0.088 (0.103) loss_x loss_x 1.1025 (0.7222) acc_x 65.6250 (78.7500) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/26] time 0.167 (0.172) data 0.090 (0.095) loss_x loss_x 0.9424 (0.7515) acc_x 75.0000 (79.0625) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/26] time 0.170 (0.170) data 0.093 (0.093) loss_x loss_x 0.5928 (0.6603) acc_x 84.3750 (80.8333) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/26] time 0.177 (0.172) data 0.100 (0.094) loss_x loss_x 0.3694 (0.6276) acc_x 87.5000 (82.6562) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [25/26] time 0.160 (0.171) data 0.083 (0.094) loss_x loss_x 0.5981 (0.6812) acc_x 81.2500 (81.2500) lr 1.8090e-03 eta 0:00:00
epoch [42/200] batch [5/23] time 0.166 (0.171) data 0.088 (0.093) loss_u loss_u 0.8750 (0.8249) acc_u 12.5000 (19.3750) lr 1.8090e-03 eta 0:00:03
epoch [42/200] batch [10/23] time 0.182 (0.171) data 0.104 (0.094) loss_u loss_u 0.7515 (0.8331) acc_u 34.3750 (19.3750) lr 1.8090e-03 eta 0:00:02
epoch [42/200] batch [15/23] time 0.194 (0.173) data 0.117 (0.096) loss_u loss_u 0.8496 (0.8279) acc_u 15.6250 (20.4167) lr 1.8090e-03 eta 0:00:01
epoch [42/200] batch [20/23] time 0.179 (0.174) data 0.102 (0.097) loss_u loss_u 0.8774 (0.8270) acc_u 15.6250 (20.9375) lr 1.8090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 550
confident_label rate tensor(0.5167, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 835
clean true:823
clean false:12
clean_rate:0.98562874251497
noisy true:243
noisy false:538
after delete: len(clean_dataset) 835
after delete: len(noisy_dataset) 781
epoch [43/200] batch [5/26] time 0.192 (0.182) data 0.115 (0.104) loss_x loss_x 0.7729 (0.8240) acc_x 81.2500 (79.3750) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/26] time 0.186 (0.175) data 0.108 (0.098) loss_x loss_x 0.4946 (0.7701) acc_x 90.6250 (79.6875) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/26] time 0.176 (0.174) data 0.097 (0.096) loss_x loss_x 0.7139 (0.7490) acc_x 81.2500 (80.8333) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/26] time 0.183 (0.175) data 0.107 (0.098) loss_x loss_x 0.6787 (0.7161) acc_x 78.1250 (81.2500) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [25/26] time 0.187 (0.177) data 0.111 (0.100) loss_x loss_x 0.5254 (0.7456) acc_x 84.3750 (80.7500) lr 1.7997e-03 eta 0:00:00
epoch [43/200] batch [5/24] time 0.174 (0.178) data 0.096 (0.101) loss_u loss_u 0.8525 (0.8054) acc_u 15.6250 (23.1250) lr 1.7997e-03 eta 0:00:03
epoch [43/200] batch [10/24] time 0.180 (0.182) data 0.103 (0.105) loss_u loss_u 0.7700 (0.8038) acc_u 21.8750 (24.0625) lr 1.7997e-03 eta 0:00:02
epoch [43/200] batch [15/24] time 0.170 (0.182) data 0.091 (0.105) loss_u loss_u 0.7485 (0.7965) acc_u 31.2500 (25.4167) lr 1.7997e-03 eta 0:00:01
epoch [43/200] batch [20/24] time 0.171 (0.181) data 0.093 (0.104) loss_u loss_u 0.8765 (0.7994) acc_u 12.5000 (25.0000) lr 1.7997e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.5446, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 880
clean true:865
clean false:15
clean_rate:0.9829545454545454
noisy true:251
noisy false:485
after delete: len(clean_dataset) 880
after delete: len(noisy_dataset) 736
epoch [44/200] batch [5/27] time 0.160 (0.178) data 0.083 (0.101) loss_x loss_x 0.5737 (0.6126) acc_x 87.5000 (86.8750) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/27] time 0.187 (0.172) data 0.111 (0.095) loss_x loss_x 1.3623 (0.7445) acc_x 71.8750 (83.1250) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/27] time 0.169 (0.177) data 0.093 (0.100) loss_x loss_x 1.1641 (0.8146) acc_x 59.3750 (80.0000) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [20/27] time 0.187 (0.176) data 0.109 (0.099) loss_x loss_x 1.0518 (0.8311) acc_x 71.8750 (78.4375) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [25/27] time 0.183 (0.177) data 0.103 (0.100) loss_x loss_x 0.5557 (0.7624) acc_x 90.6250 (80.2500) lr 1.7902e-03 eta 0:00:00
epoch [44/200] batch [5/23] time 0.173 (0.177) data 0.095 (0.099) loss_u loss_u 0.8364 (0.8036) acc_u 21.8750 (24.3750) lr 1.7902e-03 eta 0:00:03
epoch [44/200] batch [10/23] time 0.173 (0.177) data 0.096 (0.100) loss_u loss_u 0.8140 (0.7961) acc_u 25.0000 (24.6875) lr 1.7902e-03 eta 0:00:02
epoch [44/200] batch [15/23] time 0.170 (0.176) data 0.093 (0.099) loss_u loss_u 0.8257 (0.8122) acc_u 15.6250 (21.6667) lr 1.7902e-03 eta 0:00:01
epoch [44/200] batch [20/23] time 0.162 (0.176) data 0.085 (0.098) loss_u loss_u 0.8379 (0.8167) acc_u 21.8750 (21.0938) lr 1.7902e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 487
confident_label rate tensor(0.5452, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 881
clean true:868
clean false:13
clean_rate:0.985244040862656
noisy true:261
noisy false:474
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 735
epoch [45/200] batch [5/27] time 0.184 (0.184) data 0.107 (0.108) loss_x loss_x 0.3809 (0.7511) acc_x 87.5000 (79.3750) lr 1.7804e-03 eta 0:00:04
epoch [45/200] batch [10/27] time 0.190 (0.186) data 0.113 (0.109) loss_x loss_x 0.5347 (0.6933) acc_x 90.6250 (80.6250) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [15/27] time 0.187 (0.186) data 0.110 (0.109) loss_x loss_x 0.4790 (0.6325) acc_x 84.3750 (81.2500) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [20/27] time 0.184 (0.186) data 0.107 (0.109) loss_x loss_x 0.7607 (0.6320) acc_x 78.1250 (81.4062) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [25/27] time 0.185 (0.186) data 0.108 (0.109) loss_x loss_x 0.7568 (0.6319) acc_x 78.1250 (81.6250) lr 1.7804e-03 eta 0:00:00
epoch [45/200] batch [5/22] time 0.185 (0.186) data 0.107 (0.109) loss_u loss_u 0.8608 (0.8245) acc_u 18.7500 (21.8750) lr 1.7804e-03 eta 0:00:03
epoch [45/200] batch [10/22] time 0.159 (0.184) data 0.082 (0.107) loss_u loss_u 0.7583 (0.8207) acc_u 28.1250 (21.8750) lr 1.7804e-03 eta 0:00:02
epoch [45/200] batch [15/22] time 0.170 (0.183) data 0.092 (0.106) loss_u loss_u 0.7437 (0.8132) acc_u 25.0000 (22.0833) lr 1.7804e-03 eta 0:00:01
epoch [45/200] batch [20/22] time 0.176 (0.181) data 0.098 (0.104) loss_u loss_u 0.7378 (0.8101) acc_u 28.1250 (22.6562) lr 1.7804e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.5384, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 870
clean true:862
clean false:8
clean_rate:0.9908045977011494
noisy true:273
noisy false:473
after delete: len(clean_dataset) 870
after delete: len(noisy_dataset) 746
epoch [46/200] batch [5/27] time 0.166 (0.173) data 0.089 (0.097) loss_x loss_x 0.4316 (0.7345) acc_x 90.6250 (82.5000) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/27] time 0.187 (0.174) data 0.110 (0.097) loss_x loss_x 0.5117 (0.7273) acc_x 90.6250 (82.8125) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/27] time 0.160 (0.174) data 0.083 (0.098) loss_x loss_x 0.9570 (0.7627) acc_x 68.7500 (81.0417) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [20/27] time 0.175 (0.173) data 0.097 (0.095) loss_x loss_x 0.7329 (0.7505) acc_x 81.2500 (80.7812) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [25/27] time 0.185 (0.174) data 0.107 (0.097) loss_x loss_x 0.9604 (0.7403) acc_x 71.8750 (80.6250) lr 1.7705e-03 eta 0:00:00
epoch [46/200] batch [5/23] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.7393 (0.7765) acc_u 28.1250 (25.6250) lr 1.7705e-03 eta 0:00:03
epoch [46/200] batch [10/23] time 0.171 (0.174) data 0.092 (0.097) loss_u loss_u 0.8525 (0.7870) acc_u 15.6250 (24.0625) lr 1.7705e-03 eta 0:00:02
epoch [46/200] batch [15/23] time 0.163 (0.174) data 0.086 (0.096) loss_u loss_u 0.8228 (0.8057) acc_u 18.7500 (22.0833) lr 1.7705e-03 eta 0:00:01
epoch [46/200] batch [20/23] time 0.173 (0.173) data 0.095 (0.096) loss_u loss_u 0.8765 (0.8044) acc_u 18.7500 (22.0312) lr 1.7705e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.5464, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 883
clean true:865
clean false:18
clean_rate:0.9796149490373726
noisy true:258
noisy false:475
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 733
epoch [47/200] batch [5/27] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.8462 (0.6318) acc_x 81.2500 (83.7500) lr 1.7604e-03 eta 0:00:03
epoch [47/200] batch [10/27] time 0.168 (0.172) data 0.091 (0.095) loss_x loss_x 1.2354 (0.7841) acc_x 78.1250 (80.0000) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/27] time 0.159 (0.173) data 0.083 (0.096) loss_x loss_x 0.3538 (0.7134) acc_x 87.5000 (82.0833) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [20/27] time 0.185 (0.171) data 0.109 (0.094) loss_x loss_x 0.4612 (0.7646) acc_x 87.5000 (80.0000) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [25/27] time 0.180 (0.172) data 0.103 (0.095) loss_x loss_x 0.6777 (0.7372) acc_x 81.2500 (80.7500) lr 1.7604e-03 eta 0:00:00
epoch [47/200] batch [5/22] time 0.190 (0.174) data 0.112 (0.097) loss_u loss_u 0.8408 (0.8001) acc_u 15.6250 (21.2500) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [10/22] time 0.185 (0.175) data 0.108 (0.098) loss_u loss_u 0.9155 (0.8177) acc_u 9.3750 (19.3750) lr 1.7604e-03 eta 0:00:02
epoch [47/200] batch [15/22] time 0.180 (0.176) data 0.102 (0.099) loss_u loss_u 0.7339 (0.8251) acc_u 34.3750 (19.1667) lr 1.7604e-03 eta 0:00:01
epoch [47/200] batch [20/22] time 0.177 (0.176) data 0.100 (0.099) loss_u loss_u 0.8506 (0.8247) acc_u 15.6250 (19.2188) lr 1.7604e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 527
confident_label rate tensor(0.5266, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 851
clean true:838
clean false:13
clean_rate:0.9847238542890717
noisy true:251
noisy false:514
after delete: len(clean_dataset) 851
after delete: len(noisy_dataset) 765
epoch [48/200] batch [5/26] time 0.189 (0.174) data 0.111 (0.097) loss_x loss_x 0.1588 (0.6965) acc_x 96.8750 (83.1250) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/26] time 0.173 (0.179) data 0.095 (0.102) loss_x loss_x 1.2686 (0.7709) acc_x 68.7500 (79.3750) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/26] time 0.186 (0.178) data 0.109 (0.101) loss_x loss_x 0.5635 (0.8179) acc_x 81.2500 (78.5417) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/26] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 0.6519 (0.7730) acc_x 75.0000 (79.5312) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [25/26] time 0.162 (0.175) data 0.085 (0.097) loss_x loss_x 0.8789 (0.7535) acc_x 75.0000 (79.8750) lr 1.7501e-03 eta 0:00:00
epoch [48/200] batch [5/23] time 0.178 (0.175) data 0.099 (0.098) loss_u loss_u 0.9136 (0.7741) acc_u 9.3750 (23.7500) lr 1.7501e-03 eta 0:00:03
epoch [48/200] batch [10/23] time 0.180 (0.176) data 0.102 (0.098) loss_u loss_u 0.6250 (0.7797) acc_u 46.8750 (25.9375) lr 1.7501e-03 eta 0:00:02
epoch [48/200] batch [15/23] time 0.173 (0.176) data 0.096 (0.098) loss_u loss_u 0.8809 (0.7963) acc_u 12.5000 (23.7500) lr 1.7501e-03 eta 0:00:01
epoch [48/200] batch [20/23] time 0.188 (0.177) data 0.111 (0.099) loss_u loss_u 0.7715 (0.8060) acc_u 28.1250 (22.5000) lr 1.7501e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 515
confident_label rate tensor(0.5291, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 855
clean true:842
clean false:13
clean_rate:0.9847953216374269
noisy true:259
noisy false:502
after delete: len(clean_dataset) 855
after delete: len(noisy_dataset) 761
epoch [49/200] batch [5/26] time 0.164 (0.172) data 0.087 (0.095) loss_x loss_x 0.6665 (0.6599) acc_x 71.8750 (83.1250) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/26] time 0.187 (0.175) data 0.110 (0.098) loss_x loss_x 0.5093 (0.6204) acc_x 84.3750 (83.1250) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/26] time 0.162 (0.175) data 0.085 (0.098) loss_x loss_x 1.0068 (0.6496) acc_x 71.8750 (82.5000) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/26] time 0.175 (0.175) data 0.099 (0.098) loss_x loss_x 0.7358 (0.6690) acc_x 75.0000 (82.1875) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [25/26] time 0.164 (0.174) data 0.086 (0.097) loss_x loss_x 0.4482 (0.6542) acc_x 84.3750 (81.8750) lr 1.7396e-03 eta 0:00:00
epoch [49/200] batch [5/23] time 0.180 (0.175) data 0.102 (0.098) loss_u loss_u 0.8706 (0.8422) acc_u 18.7500 (18.7500) lr 1.7396e-03 eta 0:00:03
epoch [49/200] batch [10/23] time 0.178 (0.176) data 0.100 (0.099) loss_u loss_u 0.7827 (0.8333) acc_u 28.1250 (19.3750) lr 1.7396e-03 eta 0:00:02
epoch [49/200] batch [15/23] time 0.187 (0.177) data 0.110 (0.100) loss_u loss_u 0.7700 (0.8223) acc_u 28.1250 (21.0417) lr 1.7396e-03 eta 0:00:01
epoch [49/200] batch [20/23] time 0.210 (0.178) data 0.132 (0.101) loss_u loss_u 0.8472 (0.8248) acc_u 15.6250 (20.6250) lr 1.7396e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 508
confident_label rate tensor(0.5334, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 862
clean true:852
clean false:10
clean_rate:0.988399071925754
noisy true:256
noisy false:498
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 754
epoch [50/200] batch [5/26] time 0.172 (0.179) data 0.095 (0.102) loss_x loss_x 0.9639 (0.6821) acc_x 75.0000 (83.1250) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/26] time 0.177 (0.178) data 0.100 (0.101) loss_x loss_x 0.7729 (0.6104) acc_x 78.1250 (84.3750) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/26] time 0.170 (0.175) data 0.092 (0.098) loss_x loss_x 0.3267 (0.5839) acc_x 87.5000 (85.2083) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/26] time 0.184 (0.175) data 0.107 (0.098) loss_x loss_x 0.8237 (0.6760) acc_x 78.1250 (82.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [25/26] time 0.172 (0.176) data 0.095 (0.098) loss_x loss_x 0.8120 (0.6936) acc_x 84.3750 (82.1250) lr 1.7290e-03 eta 0:00:00
epoch [50/200] batch [5/23] time 0.186 (0.177) data 0.109 (0.100) loss_u loss_u 0.8604 (0.8344) acc_u 15.6250 (16.8750) lr 1.7290e-03 eta 0:00:03
epoch [50/200] batch [10/23] time 0.186 (0.178) data 0.110 (0.101) loss_u loss_u 0.8062 (0.8035) acc_u 25.0000 (22.5000) lr 1.7290e-03 eta 0:00:02
epoch [50/200] batch [15/23] time 0.172 (0.179) data 0.095 (0.101) loss_u loss_u 0.7100 (0.8001) acc_u 31.2500 (22.5000) lr 1.7290e-03 eta 0:00:01
epoch [50/200] batch [20/23] time 0.164 (0.177) data 0.087 (0.100) loss_u loss_u 0.7993 (0.7999) acc_u 21.8750 (22.6562) lr 1.7290e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.5322, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 860
clean true:844
clean false:16
clean_rate:0.9813953488372092
noisy true:262
noisy false:494
after delete: len(clean_dataset) 860
after delete: len(noisy_dataset) 756
epoch [51/200] batch [5/26] time 0.185 (0.179) data 0.109 (0.102) loss_x loss_x 0.9961 (0.8275) acc_x 78.1250 (81.2500) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/26] time 0.172 (0.177) data 0.094 (0.100) loss_x loss_x 0.3979 (0.6864) acc_x 93.7500 (82.8125) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/26] time 0.182 (0.176) data 0.106 (0.099) loss_x loss_x 0.5947 (0.7004) acc_x 87.5000 (82.5000) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/26] time 0.167 (0.176) data 0.089 (0.099) loss_x loss_x 0.7622 (0.6865) acc_x 84.3750 (82.5000) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [25/26] time 0.174 (0.176) data 0.098 (0.099) loss_x loss_x 1.1572 (0.6879) acc_x 68.7500 (82.2500) lr 1.7181e-03 eta 0:00:00
epoch [51/200] batch [5/23] time 0.196 (0.176) data 0.117 (0.099) loss_u loss_u 0.7388 (0.7641) acc_u 31.2500 (27.5000) lr 1.7181e-03 eta 0:00:03
epoch [51/200] batch [10/23] time 0.186 (0.177) data 0.109 (0.099) loss_u loss_u 0.7017 (0.7676) acc_u 34.3750 (26.5625) lr 1.7181e-03 eta 0:00:02
epoch [51/200] batch [15/23] time 0.170 (0.178) data 0.093 (0.100) loss_u loss_u 0.7935 (0.7721) acc_u 21.8750 (26.6667) lr 1.7181e-03 eta 0:00:01
epoch [51/200] batch [20/23] time 0.185 (0.178) data 0.109 (0.101) loss_u loss_u 0.9326 (0.7940) acc_u 12.5000 (24.5312) lr 1.7181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.5464, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 883
clean true:869
clean false:14
clean_rate:0.984144960362401
noisy true:254
noisy false:479
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 733
epoch [52/200] batch [5/27] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.7661 (0.8006) acc_x 87.5000 (81.8750) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/27] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 1.0488 (0.7804) acc_x 75.0000 (81.2500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [15/27] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.4473 (0.7754) acc_x 93.7500 (82.2917) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [20/27] time 0.186 (0.183) data 0.110 (0.106) loss_x loss_x 0.6084 (0.7435) acc_x 75.0000 (81.5625) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [25/27] time 0.186 (0.184) data 0.110 (0.107) loss_x loss_x 0.8428 (0.7480) acc_x 78.1250 (81.0000) lr 1.7071e-03 eta 0:00:00
epoch [52/200] batch [5/22] time 0.189 (0.182) data 0.110 (0.105) loss_u loss_u 0.6992 (0.7883) acc_u 34.3750 (23.7500) lr 1.7071e-03 eta 0:00:03
epoch [52/200] batch [10/22] time 0.179 (0.183) data 0.102 (0.106) loss_u loss_u 0.7373 (0.7792) acc_u 28.1250 (24.3750) lr 1.7071e-03 eta 0:00:02
epoch [52/200] batch [15/22] time 0.172 (0.182) data 0.094 (0.105) loss_u loss_u 0.8423 (0.7825) acc_u 15.6250 (23.3333) lr 1.7071e-03 eta 0:00:01
epoch [52/200] batch [20/22] time 0.177 (0.181) data 0.099 (0.104) loss_u loss_u 0.7720 (0.7836) acc_u 21.8750 (23.7500) lr 1.7071e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 477
confident_label rate tensor(0.5514, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 891
clean true:880
clean false:11
clean_rate:0.9876543209876543
noisy true:259
noisy false:466
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 725
epoch [53/200] batch [5/27] time 0.174 (0.184) data 0.097 (0.107) loss_x loss_x 0.7383 (0.6354) acc_x 84.3750 (83.7500) lr 1.6959e-03 eta 0:00:04
epoch [53/200] batch [10/27] time 0.176 (0.183) data 0.100 (0.106) loss_x loss_x 0.7373 (0.7417) acc_x 90.6250 (83.4375) lr 1.6959e-03 eta 0:00:03
epoch [53/200] batch [15/27] time 0.175 (0.179) data 0.098 (0.102) loss_x loss_x 1.1553 (0.7643) acc_x 71.8750 (81.8750) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [20/27] time 0.185 (0.179) data 0.107 (0.102) loss_x loss_x 0.8335 (0.7672) acc_x 87.5000 (82.0312) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [25/27] time 0.167 (0.178) data 0.090 (0.101) loss_x loss_x 0.4224 (0.7539) acc_x 93.7500 (81.8750) lr 1.6959e-03 eta 0:00:00
epoch [53/200] batch [5/22] time 0.161 (0.175) data 0.084 (0.098) loss_u loss_u 0.7554 (0.7614) acc_u 28.1250 (26.2500) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [10/22] time 0.178 (0.176) data 0.101 (0.099) loss_u loss_u 0.7812 (0.7855) acc_u 28.1250 (25.0000) lr 1.6959e-03 eta 0:00:02
epoch [53/200] batch [15/22] time 0.180 (0.176) data 0.103 (0.099) loss_u loss_u 0.8232 (0.7956) acc_u 21.8750 (24.1667) lr 1.6959e-03 eta 0:00:01
epoch [53/200] batch [20/22] time 0.166 (0.175) data 0.088 (0.098) loss_u loss_u 0.8408 (0.8003) acc_u 15.6250 (22.9688) lr 1.6959e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 510
confident_label rate tensor(0.5377, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 869
clean true:855
clean false:14
clean_rate:0.9838895281933256
noisy true:251
noisy false:496
after delete: len(clean_dataset) 869
after delete: len(noisy_dataset) 747
epoch [54/200] batch [5/27] time 0.183 (0.182) data 0.104 (0.105) loss_x loss_x 0.4724 (0.6260) acc_x 87.5000 (84.3750) lr 1.6845e-03 eta 0:00:04
epoch [54/200] batch [10/27] time 0.166 (0.180) data 0.089 (0.103) loss_x loss_x 0.9346 (0.6974) acc_x 81.2500 (81.2500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [15/27] time 0.179 (0.181) data 0.102 (0.104) loss_x loss_x 0.6860 (0.7198) acc_x 81.2500 (80.0000) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [20/27] time 0.175 (0.178) data 0.098 (0.101) loss_x loss_x 0.6392 (0.7044) acc_x 75.0000 (80.3125) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [25/27] time 0.169 (0.178) data 0.092 (0.101) loss_x loss_x 0.7969 (0.7728) acc_x 75.0000 (79.1250) lr 1.6845e-03 eta 0:00:00
epoch [54/200] batch [5/23] time 0.164 (0.177) data 0.086 (0.100) loss_u loss_u 0.8374 (0.7875) acc_u 18.7500 (23.7500) lr 1.6845e-03 eta 0:00:03
epoch [54/200] batch [10/23] time 0.168 (0.177) data 0.090 (0.099) loss_u loss_u 0.7168 (0.7840) acc_u 31.2500 (23.7500) lr 1.6845e-03 eta 0:00:02
epoch [54/200] batch [15/23] time 0.182 (0.177) data 0.105 (0.099) loss_u loss_u 0.7900 (0.7868) acc_u 25.0000 (23.7500) lr 1.6845e-03 eta 0:00:01
epoch [54/200] batch [20/23] time 0.174 (0.177) data 0.097 (0.099) loss_u loss_u 0.8398 (0.8016) acc_u 18.7500 (22.3438) lr 1.6845e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 481
confident_label rate tensor(0.5532, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 894
clean true:883
clean false:11
clean_rate:0.9876957494407159
noisy true:252
noisy false:470
after delete: len(clean_dataset) 894
after delete: len(noisy_dataset) 722
epoch [55/200] batch [5/27] time 0.169 (0.174) data 0.092 (0.097) loss_x loss_x 0.7065 (0.6255) acc_x 84.3750 (81.8750) lr 1.6730e-03 eta 0:00:03
epoch [55/200] batch [10/27] time 0.170 (0.173) data 0.092 (0.096) loss_x loss_x 0.4973 (0.6333) acc_x 87.5000 (82.5000) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/27] time 0.173 (0.172) data 0.096 (0.094) loss_x loss_x 0.6558 (0.6297) acc_x 78.1250 (82.7083) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [20/27] time 0.164 (0.172) data 0.086 (0.095) loss_x loss_x 0.6841 (0.6698) acc_x 75.0000 (81.5625) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [25/27] time 0.166 (0.172) data 0.089 (0.095) loss_x loss_x 0.7837 (0.6921) acc_x 81.2500 (81.0000) lr 1.6730e-03 eta 0:00:00
epoch [55/200] batch [5/22] time 0.184 (0.172) data 0.107 (0.095) loss_u loss_u 0.9375 (0.8433) acc_u 9.3750 (20.0000) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [10/22] time 0.180 (0.174) data 0.101 (0.096) loss_u loss_u 0.7817 (0.8482) acc_u 25.0000 (19.6875) lr 1.6730e-03 eta 0:00:02
epoch [55/200] batch [15/22] time 0.172 (0.174) data 0.095 (0.096) loss_u loss_u 0.7393 (0.8345) acc_u 28.1250 (20.0000) lr 1.6730e-03 eta 0:00:01
epoch [55/200] batch [20/22] time 0.179 (0.174) data 0.100 (0.096) loss_u loss_u 0.9111 (0.8241) acc_u 9.3750 (21.2500) lr 1.6730e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 482
confident_label rate tensor(0.5464, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 883
clean true:871
clean false:12
clean_rate:0.986409966024915
noisy true:263
noisy false:470
after delete: len(clean_dataset) 883
after delete: len(noisy_dataset) 733
epoch [56/200] batch [5/27] time 0.183 (0.180) data 0.106 (0.103) loss_x loss_x 0.8594 (0.6517) acc_x 75.0000 (80.6250) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/27] time 0.175 (0.176) data 0.099 (0.099) loss_x loss_x 0.5088 (0.6600) acc_x 84.3750 (81.5625) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/27] time 0.185 (0.178) data 0.107 (0.101) loss_x loss_x 0.9785 (0.6702) acc_x 78.1250 (81.6667) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [20/27] time 0.172 (0.178) data 0.096 (0.100) loss_x loss_x 0.7056 (0.6916) acc_x 81.2500 (81.0938) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [25/27] time 0.168 (0.177) data 0.091 (0.100) loss_x loss_x 1.4033 (0.7361) acc_x 56.2500 (79.6250) lr 1.6613e-03 eta 0:00:00
epoch [56/200] batch [5/22] time 0.184 (0.176) data 0.107 (0.099) loss_u loss_u 0.8979 (0.8206) acc_u 9.3750 (21.2500) lr 1.6613e-03 eta 0:00:03
epoch [56/200] batch [10/22] time 0.186 (0.177) data 0.108 (0.100) loss_u loss_u 0.7534 (0.8077) acc_u 34.3750 (23.4375) lr 1.6613e-03 eta 0:00:02
epoch [56/200] batch [15/22] time 0.182 (0.178) data 0.105 (0.101) loss_u loss_u 0.7773 (0.8078) acc_u 28.1250 (23.7500) lr 1.6613e-03 eta 0:00:01
epoch [56/200] batch [20/22] time 0.202 (0.179) data 0.125 (0.102) loss_u loss_u 0.8516 (0.8089) acc_u 15.6250 (22.9688) lr 1.6613e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 498
confident_label rate tensor(0.5334, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 862
clean true:852
clean false:10
clean_rate:0.988399071925754
noisy true:266
noisy false:488
after delete: len(clean_dataset) 862
after delete: len(noisy_dataset) 754
epoch [57/200] batch [5/26] time 0.189 (0.170) data 0.112 (0.093) loss_x loss_x 0.5698 (0.7590) acc_x 78.1250 (78.7500) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/26] time 0.184 (0.177) data 0.106 (0.100) loss_x loss_x 0.7188 (0.7093) acc_x 78.1250 (81.5625) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/26] time 0.184 (0.180) data 0.107 (0.103) loss_x loss_x 0.6499 (0.7014) acc_x 75.0000 (81.6667) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/26] time 0.172 (0.177) data 0.095 (0.100) loss_x loss_x 0.5581 (0.6788) acc_x 84.3750 (82.6562) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [25/26] time 0.166 (0.175) data 0.089 (0.098) loss_x loss_x 0.9785 (0.6885) acc_x 71.8750 (82.3750) lr 1.6494e-03 eta 0:00:00
epoch [57/200] batch [5/23] time 0.168 (0.173) data 0.090 (0.096) loss_u loss_u 0.7769 (0.7527) acc_u 25.0000 (29.3750) lr 1.6494e-03 eta 0:00:03
epoch [57/200] batch [10/23] time 0.164 (0.172) data 0.086 (0.095) loss_u loss_u 0.8428 (0.7886) acc_u 18.7500 (23.7500) lr 1.6494e-03 eta 0:00:02
epoch [57/200] batch [15/23] time 0.184 (0.174) data 0.106 (0.096) loss_u loss_u 0.7637 (0.7929) acc_u 28.1250 (23.7500) lr 1.6494e-03 eta 0:00:01
epoch [57/200] batch [20/23] time 0.209 (0.175) data 0.131 (0.098) loss_u loss_u 0.7900 (0.7948) acc_u 21.8750 (23.2812) lr 1.6494e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 496
confident_label rate tensor(0.5452, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 881
clean true:868
clean false:13
clean_rate:0.985244040862656
noisy true:252
noisy false:483
after delete: len(clean_dataset) 881
after delete: len(noisy_dataset) 735
epoch [58/200] batch [5/27] time 0.195 (0.192) data 0.118 (0.115) loss_x loss_x 0.4417 (0.7133) acc_x 90.6250 (80.6250) lr 1.6374e-03 eta 0:00:04
epoch [58/200] batch [10/27] time 0.190 (0.188) data 0.112 (0.110) loss_x loss_x 0.6821 (0.7244) acc_x 84.3750 (81.5625) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [15/27] time 0.178 (0.182) data 0.100 (0.104) loss_x loss_x 0.3450 (0.6878) acc_x 90.6250 (82.5000) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [20/27] time 0.222 (0.185) data 0.144 (0.108) loss_x loss_x 0.7236 (0.6848) acc_x 81.2500 (82.3438) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [25/27] time 0.167 (0.185) data 0.090 (0.108) loss_x loss_x 0.6509 (0.7068) acc_x 87.5000 (81.7500) lr 1.6374e-03 eta 0:00:00
epoch [58/200] batch [5/22] time 0.200 (0.183) data 0.123 (0.106) loss_u loss_u 0.7646 (0.8171) acc_u 28.1250 (22.5000) lr 1.6374e-03 eta 0:00:03
epoch [58/200] batch [10/22] time 0.173 (0.183) data 0.095 (0.106) loss_u loss_u 0.7280 (0.8092) acc_u 31.2500 (22.5000) lr 1.6374e-03 eta 0:00:02
epoch [58/200] batch [15/22] time 0.182 (0.181) data 0.105 (0.103) loss_u loss_u 0.8608 (0.8103) acc_u 15.6250 (21.8750) lr 1.6374e-03 eta 0:00:01
epoch [58/200] batch [20/22] time 0.176 (0.181) data 0.098 (0.103) loss_u loss_u 0.7871 (0.8035) acc_u 18.7500 (22.6562) lr 1.6374e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 458
confident_label rate tensor(0.5551, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 897
clean true:887
clean false:10
clean_rate:0.9888517279821628
noisy true:271
noisy false:448
after delete: len(clean_dataset) 897
after delete: len(noisy_dataset) 719
epoch [59/200] batch [5/28] time 0.181 (0.180) data 0.104 (0.103) loss_x loss_x 0.7783 (0.6586) acc_x 81.2500 (83.1250) lr 1.6252e-03 eta 0:00:04
epoch [59/200] batch [10/28] time 0.171 (0.179) data 0.094 (0.103) loss_x loss_x 0.7339 (0.6735) acc_x 78.1250 (81.8750) lr 1.6252e-03 eta 0:00:03
epoch [59/200] batch [15/28] time 0.170 (0.175) data 0.094 (0.099) loss_x loss_x 0.7368 (0.6245) acc_x 87.5000 (84.1667) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [20/28] time 0.172 (0.175) data 0.095 (0.098) loss_x loss_x 0.6606 (0.6117) acc_x 84.3750 (85.1562) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [25/28] time 0.188 (0.175) data 0.112 (0.098) loss_x loss_x 0.5415 (0.6004) acc_x 90.6250 (85.1250) lr 1.6252e-03 eta 0:00:00
epoch [59/200] batch [5/22] time 0.172 (0.175) data 0.094 (0.098) loss_u loss_u 0.8340 (0.8074) acc_u 18.7500 (23.7500) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [10/22] time 0.185 (0.176) data 0.108 (0.099) loss_u loss_u 0.7998 (0.8058) acc_u 21.8750 (22.1875) lr 1.6252e-03 eta 0:00:02
epoch [59/200] batch [15/22] time 0.158 (0.176) data 0.081 (0.099) loss_u loss_u 0.8179 (0.8302) acc_u 21.8750 (19.5833) lr 1.6252e-03 eta 0:00:01
epoch [59/200] batch [20/22] time 0.180 (0.175) data 0.103 (0.098) loss_u loss_u 0.7690 (0.8261) acc_u 28.1250 (20.6250) lr 1.6252e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 467
confident_label rate tensor(0.5575, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 901
clean true:890
clean false:11
clean_rate:0.9877913429522752
noisy true:259
noisy false:456
after delete: len(clean_dataset) 901
after delete: len(noisy_dataset) 715
epoch [60/200] batch [5/28] time 0.162 (0.164) data 0.085 (0.087) loss_x loss_x 0.8003 (0.7896) acc_x 84.3750 (80.6250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/28] time 0.173 (0.172) data 0.097 (0.095) loss_x loss_x 0.5337 (0.6595) acc_x 81.2500 (84.0625) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [15/28] time 0.170 (0.172) data 0.093 (0.095) loss_x loss_x 0.6748 (0.6304) acc_x 81.2500 (85.0000) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [20/28] time 0.181 (0.175) data 0.104 (0.098) loss_x loss_x 1.0039 (0.6934) acc_x 78.1250 (83.1250) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [25/28] time 0.187 (0.177) data 0.109 (0.100) loss_x loss_x 0.7314 (0.6901) acc_x 81.2500 (83.7500) lr 1.6129e-03 eta 0:00:00
epoch [60/200] batch [5/22] time 0.212 (0.180) data 0.134 (0.103) loss_u loss_u 0.7090 (0.7759) acc_u 34.3750 (25.6250) lr 1.6129e-03 eta 0:00:03
epoch [60/200] batch [10/22] time 0.172 (0.179) data 0.095 (0.102) loss_u loss_u 0.7944 (0.7936) acc_u 28.1250 (24.6875) lr 1.6129e-03 eta 0:00:02
epoch [60/200] batch [15/22] time 0.184 (0.179) data 0.106 (0.102) loss_u loss_u 0.7705 (0.8049) acc_u 28.1250 (23.3333) lr 1.6129e-03 eta 0:00:01
epoch [60/200] batch [20/22] time 0.171 (0.178) data 0.094 (0.101) loss_u loss_u 0.8149 (0.8132) acc_u 18.7500 (22.3438) lr 1.6129e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.5514, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 891
clean true:876
clean false:15
clean_rate:0.9831649831649831
noisy true:268
noisy false:457
after delete: len(clean_dataset) 891
after delete: len(noisy_dataset) 725
epoch [61/200] batch [5/27] time 0.187 (0.182) data 0.107 (0.104) loss_x loss_x 0.8179 (0.7237) acc_x 65.6250 (80.6250) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/27] time 0.184 (0.185) data 0.107 (0.108) loss_x loss_x 0.2235 (0.6104) acc_x 93.7500 (82.8125) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [15/27] time 0.187 (0.184) data 0.110 (0.107) loss_x loss_x 0.4456 (0.6006) acc_x 87.5000 (83.3333) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [20/27] time 0.189 (0.185) data 0.111 (0.108) loss_x loss_x 0.3999 (0.6115) acc_x 90.6250 (83.7500) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [25/27] time 0.170 (0.184) data 0.093 (0.107) loss_x loss_x 1.2090 (0.6722) acc_x 71.8750 (82.7500) lr 1.6004e-03 eta 0:00:00
epoch [61/200] batch [5/22] time 0.184 (0.183) data 0.108 (0.106) loss_u loss_u 0.7524 (0.7947) acc_u 28.1250 (23.7500) lr 1.6004e-03 eta 0:00:03
epoch [61/200] batch [10/22] time 0.178 (0.182) data 0.101 (0.105) loss_u loss_u 0.8726 (0.7965) acc_u 15.6250 (23.4375) lr 1.6004e-03 eta 0:00:02
epoch [61/200] batch [15/22] time 0.188 (0.182) data 0.110 (0.105) loss_u loss_u 0.7339 (0.7997) acc_u 31.2500 (22.9167) lr 1.6004e-03 eta 0:00:01
epoch [61/200] batch [20/22] time 0.167 (0.182) data 0.088 (0.105) loss_u loss_u 0.8779 (0.8154) acc_u 15.6250 (21.2500) lr 1.6004e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 476
confident_label rate tensor(0.5439, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 879
clean true:870
clean false:9
clean_rate:0.9897610921501706
noisy true:270
noisy false:467
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 737
epoch [62/200] batch [5/27] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 1.1504 (0.7362) acc_x 75.0000 (84.3750) lr 1.5878e-03 eta 0:00:04
epoch [62/200] batch [10/27] time 0.176 (0.181) data 0.099 (0.104) loss_x loss_x 0.8608 (0.7437) acc_x 75.0000 (82.8125) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [15/27] time 0.191 (0.181) data 0.113 (0.103) loss_x loss_x 0.4456 (0.6979) acc_x 87.5000 (83.5417) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [20/27] time 0.170 (0.181) data 0.093 (0.103) loss_x loss_x 1.0303 (0.7624) acc_x 75.0000 (81.4062) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [25/27] time 0.190 (0.181) data 0.111 (0.103) loss_x loss_x 0.6763 (0.7171) acc_x 84.3750 (82.5000) lr 1.5878e-03 eta 0:00:00
epoch [62/200] batch [5/23] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.8398 (0.8085) acc_u 15.6250 (20.0000) lr 1.5878e-03 eta 0:00:03
epoch [62/200] batch [10/23] time 0.190 (0.179) data 0.112 (0.102) loss_u loss_u 0.6641 (0.7980) acc_u 40.6250 (22.8125) lr 1.5878e-03 eta 0:00:02
epoch [62/200] batch [15/23] time 0.173 (0.179) data 0.095 (0.102) loss_u loss_u 0.7759 (0.7914) acc_u 28.1250 (23.7500) lr 1.5878e-03 eta 0:00:01
epoch [62/200] batch [20/23] time 0.190 (0.179) data 0.111 (0.102) loss_u loss_u 0.7905 (0.7862) acc_u 28.1250 (24.5312) lr 1.5878e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 493
confident_label rate tensor(0.5415, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 875
clean true:862
clean false:13
clean_rate:0.9851428571428571
noisy true:261
noisy false:480
after delete: len(clean_dataset) 875
after delete: len(noisy_dataset) 741
epoch [63/200] batch [5/27] time 0.174 (0.200) data 0.097 (0.123) loss_x loss_x 0.4111 (0.5284) acc_x 84.3750 (85.6250) lr 1.5750e-03 eta 0:00:04
epoch [63/200] batch [10/27] time 0.182 (0.191) data 0.104 (0.114) loss_x loss_x 0.8477 (0.5970) acc_x 81.2500 (84.3750) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [15/27] time 0.160 (0.184) data 0.083 (0.107) loss_x loss_x 0.6582 (0.6108) acc_x 78.1250 (83.1250) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [20/27] time 0.172 (0.182) data 0.095 (0.104) loss_x loss_x 0.4841 (0.5894) acc_x 84.3750 (83.5938) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [25/27] time 0.177 (0.181) data 0.100 (0.104) loss_x loss_x 0.8125 (0.5927) acc_x 75.0000 (83.1250) lr 1.5750e-03 eta 0:00:00
epoch [63/200] batch [5/23] time 0.169 (0.179) data 0.092 (0.102) loss_u loss_u 0.7549 (0.7779) acc_u 25.0000 (24.3750) lr 1.5750e-03 eta 0:00:03
epoch [63/200] batch [10/23] time 0.168 (0.178) data 0.091 (0.101) loss_u loss_u 0.7910 (0.7971) acc_u 28.1250 (23.4375) lr 1.5750e-03 eta 0:00:02
epoch [63/200] batch [15/23] time 0.186 (0.178) data 0.108 (0.101) loss_u loss_u 0.7251 (0.7854) acc_u 37.5000 (26.0417) lr 1.5750e-03 eta 0:00:01
epoch [63/200] batch [20/23] time 0.219 (0.178) data 0.141 (0.100) loss_u loss_u 0.8120 (0.7885) acc_u 25.0000 (25.6250) lr 1.5750e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 488
confident_label rate tensor(0.5421, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 876
clean true:862
clean false:14
clean_rate:0.9840182648401826
noisy true:266
noisy false:474
after delete: len(clean_dataset) 876
after delete: len(noisy_dataset) 740
epoch [64/200] batch [5/27] time 0.183 (0.183) data 0.106 (0.106) loss_x loss_x 0.7690 (0.6618) acc_x 81.2500 (82.5000) lr 1.5621e-03 eta 0:00:04
epoch [64/200] batch [10/27] time 0.169 (0.181) data 0.091 (0.104) loss_x loss_x 0.9082 (0.6457) acc_x 84.3750 (84.0625) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [15/27] time 0.183 (0.182) data 0.105 (0.105) loss_x loss_x 1.0117 (0.6614) acc_x 68.7500 (82.7083) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [20/27] time 0.184 (0.182) data 0.107 (0.105) loss_x loss_x 0.2839 (0.6673) acc_x 93.7500 (81.7188) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [25/27] time 0.185 (0.182) data 0.108 (0.105) loss_x loss_x 0.7075 (0.6459) acc_x 84.3750 (81.8750) lr 1.5621e-03 eta 0:00:00
epoch [64/200] batch [5/23] time 0.189 (0.183) data 0.112 (0.106) loss_u loss_u 0.9058 (0.7844) acc_u 9.3750 (23.1250) lr 1.5621e-03 eta 0:00:03
epoch [64/200] batch [10/23] time 0.187 (0.183) data 0.109 (0.106) loss_u loss_u 0.7148 (0.7972) acc_u 34.3750 (23.1250) lr 1.5621e-03 eta 0:00:02
epoch [64/200] batch [15/23] time 0.186 (0.183) data 0.109 (0.106) loss_u loss_u 0.6924 (0.7898) acc_u 34.3750 (23.9583) lr 1.5621e-03 eta 0:00:01
epoch [64/200] batch [20/23] time 0.171 (0.184) data 0.093 (0.107) loss_u loss_u 0.8081 (0.7874) acc_u 18.7500 (24.6875) lr 1.5621e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 443
confident_label rate tensor(0.5668, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 916
clean true:903
clean false:13
clean_rate:0.9858078602620087
noisy true:270
noisy false:430
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 700
epoch [65/200] batch [5/28] time 0.177 (0.181) data 0.099 (0.104) loss_x loss_x 0.2703 (0.5906) acc_x 93.7500 (85.6250) lr 1.5490e-03 eta 0:00:04
epoch [65/200] batch [10/28] time 0.183 (0.181) data 0.106 (0.104) loss_x loss_x 0.4963 (0.5351) acc_x 81.2500 (85.9375) lr 1.5490e-03 eta 0:00:03
epoch [65/200] batch [15/28] time 0.171 (0.177) data 0.094 (0.100) loss_x loss_x 0.3906 (0.5581) acc_x 87.5000 (85.2083) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [20/28] time 0.175 (0.175) data 0.098 (0.098) loss_x loss_x 0.7041 (0.6035) acc_x 87.5000 (84.5312) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [25/28] time 0.182 (0.177) data 0.104 (0.099) loss_x loss_x 0.5493 (0.6199) acc_x 87.5000 (84.1250) lr 1.5490e-03 eta 0:00:00
epoch [65/200] batch [5/21] time 0.185 (0.178) data 0.108 (0.101) loss_u loss_u 0.7407 (0.7971) acc_u 25.0000 (20.6250) lr 1.5490e-03 eta 0:00:02
epoch [65/200] batch [10/21] time 0.169 (0.179) data 0.091 (0.102) loss_u loss_u 0.7266 (0.8055) acc_u 31.2500 (21.5625) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [15/21] time 0.183 (0.178) data 0.105 (0.101) loss_u loss_u 0.8257 (0.8184) acc_u 15.6250 (20.4167) lr 1.5490e-03 eta 0:00:01
epoch [65/200] batch [20/21] time 0.185 (0.179) data 0.108 (0.102) loss_u loss_u 0.8311 (0.8178) acc_u 28.1250 (21.0938) lr 1.5490e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 459
confident_label rate tensor(0.5693, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 920
clean true:905
clean false:15
clean_rate:0.9836956521739131
noisy true:252
noisy false:444
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 696
epoch [66/200] batch [5/28] time 0.188 (0.184) data 0.111 (0.107) loss_x loss_x 1.0117 (0.7311) acc_x 84.3750 (81.8750) lr 1.5358e-03 eta 0:00:04
epoch [66/200] batch [10/28] time 0.175 (0.183) data 0.098 (0.106) loss_x loss_x 0.9741 (0.6923) acc_x 75.0000 (83.1250) lr 1.5358e-03 eta 0:00:03
epoch [66/200] batch [15/28] time 0.172 (0.178) data 0.093 (0.101) loss_x loss_x 0.8296 (0.6970) acc_x 78.1250 (81.6667) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [20/28] time 0.183 (0.177) data 0.106 (0.100) loss_x loss_x 0.8071 (0.7344) acc_x 81.2500 (81.0938) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [25/28] time 0.170 (0.178) data 0.093 (0.101) loss_x loss_x 0.9785 (0.7137) acc_x 65.6250 (81.0000) lr 1.5358e-03 eta 0:00:00
epoch [66/200] batch [5/21] time 0.172 (0.177) data 0.095 (0.100) loss_u loss_u 0.7466 (0.7785) acc_u 28.1250 (25.6250) lr 1.5358e-03 eta 0:00:02
epoch [66/200] batch [10/21] time 0.191 (0.178) data 0.113 (0.100) loss_u loss_u 0.8784 (0.7882) acc_u 12.5000 (23.7500) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [15/21] time 0.179 (0.179) data 0.101 (0.102) loss_u loss_u 0.8374 (0.8047) acc_u 21.8750 (22.0833) lr 1.5358e-03 eta 0:00:01
epoch [66/200] batch [20/21] time 0.186 (0.179) data 0.109 (0.102) loss_u loss_u 0.8101 (0.8077) acc_u 21.8750 (22.6562) lr 1.5358e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 472
confident_label rate tensor(0.5476, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 885
clean true:873
clean false:12
clean_rate:0.9864406779661017
noisy true:271
noisy false:460
after delete: len(clean_dataset) 885
after delete: len(noisy_dataset) 731
epoch [67/200] batch [5/27] time 0.173 (0.178) data 0.095 (0.100) loss_x loss_x 0.4744 (0.5733) acc_x 90.6250 (87.5000) lr 1.5225e-03 eta 0:00:03
epoch [67/200] batch [10/27] time 0.162 (0.170) data 0.085 (0.093) loss_x loss_x 0.6948 (0.6068) acc_x 84.3750 (85.9375) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/27] time 0.178 (0.171) data 0.101 (0.094) loss_x loss_x 0.9595 (0.7028) acc_x 75.0000 (82.2917) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [20/27] time 0.171 (0.172) data 0.095 (0.095) loss_x loss_x 0.8730 (0.7092) acc_x 78.1250 (82.9688) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [25/27] time 0.185 (0.174) data 0.107 (0.097) loss_x loss_x 0.9028 (0.7097) acc_x 68.7500 (82.1250) lr 1.5225e-03 eta 0:00:00
epoch [67/200] batch [5/22] time 0.166 (0.174) data 0.089 (0.097) loss_u loss_u 0.7715 (0.7844) acc_u 25.0000 (24.3750) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [10/22] time 0.173 (0.173) data 0.096 (0.096) loss_u loss_u 0.7056 (0.7926) acc_u 37.5000 (23.4375) lr 1.5225e-03 eta 0:00:02
epoch [67/200] batch [15/22] time 0.186 (0.174) data 0.109 (0.097) loss_u loss_u 0.7676 (0.7929) acc_u 31.2500 (24.1667) lr 1.5225e-03 eta 0:00:01
epoch [67/200] batch [20/22] time 0.186 (0.175) data 0.108 (0.097) loss_u loss_u 0.7324 (0.7920) acc_u 31.2500 (24.3750) lr 1.5225e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 500
confident_label rate tensor(0.5439, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 879
clean true:866
clean false:13
clean_rate:0.9852104664391353
noisy true:250
noisy false:487
after delete: len(clean_dataset) 879
after delete: len(noisy_dataset) 737
epoch [68/200] batch [5/27] time 0.174 (0.171) data 0.097 (0.094) loss_x loss_x 0.6934 (0.6437) acc_x 71.8750 (79.3750) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/27] time 0.180 (0.174) data 0.103 (0.097) loss_x loss_x 0.5986 (0.7057) acc_x 78.1250 (79.3750) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/27] time 0.185 (0.177) data 0.108 (0.100) loss_x loss_x 0.8345 (0.7314) acc_x 81.2500 (80.4167) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [20/27] time 0.188 (0.176) data 0.111 (0.099) loss_x loss_x 1.0986 (0.7159) acc_x 75.0000 (81.8750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [25/27] time 0.188 (0.179) data 0.111 (0.102) loss_x loss_x 0.4778 (0.7208) acc_x 90.6250 (81.8750) lr 1.5090e-03 eta 0:00:00
epoch [68/200] batch [5/23] time 0.170 (0.180) data 0.092 (0.102) loss_u loss_u 0.8062 (0.7783) acc_u 21.8750 (24.3750) lr 1.5090e-03 eta 0:00:03
epoch [68/200] batch [10/23] time 0.186 (0.180) data 0.108 (0.103) loss_u loss_u 0.8042 (0.8052) acc_u 25.0000 (22.1875) lr 1.5090e-03 eta 0:00:02
epoch [68/200] batch [15/23] time 0.188 (0.183) data 0.111 (0.105) loss_u loss_u 0.8218 (0.7905) acc_u 18.7500 (24.3750) lr 1.5090e-03 eta 0:00:01
epoch [68/200] batch [20/23] time 0.175 (0.183) data 0.097 (0.106) loss_u loss_u 0.8159 (0.7880) acc_u 21.8750 (24.3750) lr 1.5090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.5761, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 931
clean true:917
clean false:14
clean_rate:0.9849624060150376
noisy true:257
noisy false:428
after delete: len(clean_dataset) 931
after delete: len(noisy_dataset) 685
epoch [69/200] batch [5/29] time 0.171 (0.176) data 0.093 (0.098) loss_x loss_x 0.4661 (0.6902) acc_x 87.5000 (82.5000) lr 1.4955e-03 eta 0:00:04
epoch [69/200] batch [10/29] time 0.164 (0.171) data 0.087 (0.094) loss_x loss_x 0.6963 (0.7750) acc_x 78.1250 (79.3750) lr 1.4955e-03 eta 0:00:03
epoch [69/200] batch [15/29] time 0.187 (0.173) data 0.110 (0.096) loss_x loss_x 0.8066 (0.7304) acc_x 81.2500 (80.4167) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [20/29] time 0.181 (0.174) data 0.104 (0.097) loss_x loss_x 0.6260 (0.7304) acc_x 84.3750 (81.2500) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [25/29] time 0.190 (0.174) data 0.113 (0.097) loss_x loss_x 0.6807 (0.7074) acc_x 87.5000 (82.0000) lr 1.4955e-03 eta 0:00:00
epoch [69/200] batch [5/21] time 0.176 (0.176) data 0.098 (0.098) loss_u loss_u 0.7412 (0.8103) acc_u 31.2500 (20.6250) lr 1.4955e-03 eta 0:00:02
epoch [69/200] batch [10/21] time 0.177 (0.177) data 0.099 (0.099) loss_u loss_u 0.7974 (0.7927) acc_u 21.8750 (23.4375) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [15/21] time 0.189 (0.177) data 0.112 (0.099) loss_u loss_u 0.8413 (0.7882) acc_u 18.7500 (24.3750) lr 1.4955e-03 eta 0:00:01
epoch [69/200] batch [20/21] time 0.187 (0.178) data 0.110 (0.100) loss_u loss_u 0.9004 (0.8012) acc_u 9.3750 (22.8125) lr 1.4955e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 462
confident_label rate tensor(0.5619, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 908
clean true:894
clean false:14
clean_rate:0.9845814977973568
noisy true:260
noisy false:448
after delete: len(clean_dataset) 908
after delete: len(noisy_dataset) 708
epoch [70/200] batch [5/28] time 0.190 (0.198) data 0.112 (0.121) loss_x loss_x 0.6348 (0.6587) acc_x 84.3750 (85.0000) lr 1.4818e-03 eta 0:00:04
epoch [70/200] batch [10/28] time 0.179 (0.188) data 0.099 (0.110) loss_x loss_x 0.7866 (0.6340) acc_x 84.3750 (85.3125) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [15/28] time 0.167 (0.187) data 0.089 (0.109) loss_x loss_x 0.7090 (0.6249) acc_x 84.3750 (85.8333) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [20/28] time 0.182 (0.183) data 0.105 (0.106) loss_x loss_x 0.6597 (0.6261) acc_x 81.2500 (84.6875) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [25/28] time 0.172 (0.183) data 0.096 (0.106) loss_x loss_x 0.6348 (0.6659) acc_x 84.3750 (83.8750) lr 1.4818e-03 eta 0:00:00
epoch [70/200] batch [5/22] time 0.164 (0.180) data 0.087 (0.103) loss_u loss_u 0.7544 (0.7861) acc_u 28.1250 (23.1250) lr 1.4818e-03 eta 0:00:03
epoch [70/200] batch [10/22] time 0.179 (0.179) data 0.101 (0.102) loss_u loss_u 0.8745 (0.8034) acc_u 18.7500 (21.5625) lr 1.4818e-03 eta 0:00:02
epoch [70/200] batch [15/22] time 0.173 (0.180) data 0.096 (0.102) loss_u loss_u 0.8623 (0.8008) acc_u 12.5000 (22.5000) lr 1.4818e-03 eta 0:00:01
epoch [70/200] batch [20/22] time 0.174 (0.179) data 0.097 (0.102) loss_u loss_u 0.8179 (0.8006) acc_u 21.8750 (22.6562) lr 1.4818e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 470
confident_label rate tensor(0.5563, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 899
clean true:884
clean false:15
clean_rate:0.9833147942157954
noisy true:262
noisy false:455
after delete: len(clean_dataset) 899
after delete: len(noisy_dataset) 717
epoch [71/200] batch [5/28] time 0.178 (0.177) data 0.101 (0.100) loss_x loss_x 0.7310 (0.7401) acc_x 84.3750 (79.3750) lr 1.4679e-03 eta 0:00:04
epoch [71/200] batch [10/28] time 0.176 (0.179) data 0.098 (0.102) loss_x loss_x 1.1475 (0.6944) acc_x 62.5000 (80.3125) lr 1.4679e-03 eta 0:00:03
epoch [71/200] batch [15/28] time 0.186 (0.182) data 0.109 (0.105) loss_x loss_x 0.5151 (0.6974) acc_x 87.5000 (80.6250) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [20/28] time 0.166 (0.178) data 0.090 (0.101) loss_x loss_x 0.3250 (0.6798) acc_x 87.5000 (80.7812) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [25/28] time 0.170 (0.176) data 0.093 (0.099) loss_x loss_x 0.6445 (0.6687) acc_x 84.3750 (81.8750) lr 1.4679e-03 eta 0:00:00
epoch [71/200] batch [5/22] time 0.167 (0.174) data 0.088 (0.097) loss_u loss_u 0.7891 (0.8082) acc_u 21.8750 (21.8750) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [10/22] time 0.173 (0.175) data 0.096 (0.098) loss_u loss_u 0.8979 (0.8148) acc_u 12.5000 (21.2500) lr 1.4679e-03 eta 0:00:02
epoch [71/200] batch [15/22] time 0.190 (0.175) data 0.110 (0.098) loss_u loss_u 0.6851 (0.8094) acc_u 37.5000 (22.5000) lr 1.4679e-03 eta 0:00:01
epoch [71/200] batch [20/22] time 0.190 (0.176) data 0.112 (0.098) loss_u loss_u 0.7944 (0.7955) acc_u 28.1250 (24.0625) lr 1.4679e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 441
confident_label rate tensor(0.5718, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 924
clean true:915
clean false:9
clean_rate:0.9902597402597403
noisy true:260
noisy false:432
after delete: len(clean_dataset) 924
after delete: len(noisy_dataset) 692
epoch [72/200] batch [5/28] time 0.179 (0.183) data 0.102 (0.105) loss_x loss_x 0.5708 (0.5671) acc_x 84.3750 (83.1250) lr 1.4540e-03 eta 0:00:04
epoch [72/200] batch [10/28] time 0.186 (0.187) data 0.109 (0.109) loss_x loss_x 0.7021 (0.6465) acc_x 84.3750 (84.0625) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [15/28] time 0.583 (0.211) data 0.496 (0.133) loss_x loss_x 0.3071 (0.6348) acc_x 90.6250 (83.3333) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [20/28] time 0.254 (0.221) data 0.092 (0.125) loss_x loss_x 0.7852 (0.6406) acc_x 78.1250 (83.5938) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [25/28] time 0.258 (0.231) data 0.094 (0.122) loss_x loss_x 0.4014 (0.6136) acc_x 90.6250 (84.1250) lr 1.4540e-03 eta 0:00:00
epoch [72/200] batch [5/21] time 0.296 (0.239) data 0.127 (0.117) loss_u loss_u 0.7500 (0.7619) acc_u 28.1250 (26.8750) lr 1.4540e-03 eta 0:00:03
epoch [72/200] batch [10/21] time 0.265 (0.244) data 0.099 (0.116) loss_u loss_u 0.8745 (0.8011) acc_u 15.6250 (22.8125) lr 1.4540e-03 eta 0:00:02
epoch [72/200] batch [15/21] time 0.165 (0.242) data 0.088 (0.114) loss_u loss_u 0.7754 (0.8015) acc_u 31.2500 (23.1250) lr 1.4540e-03 eta 0:00:01
epoch [72/200] batch [20/21] time 0.268 (0.243) data 0.100 (0.113) loss_u loss_u 0.7588 (0.7986) acc_u 25.0000 (23.4375) lr 1.4540e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 467
confident_label rate tensor(0.5582, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 902
clean true:891
clean false:11
clean_rate:0.9878048780487805
noisy true:258
noisy false:456
after delete: len(clean_dataset) 902
after delete: len(noisy_dataset) 714
epoch [73/200] batch [5/28] time 0.332 (0.286) data 0.169 (0.123) loss_x loss_x 0.5103 (0.7439) acc_x 87.5000 (80.6250) lr 1.4399e-03 eta 0:00:06
epoch [73/200] batch [10/28] time 0.267 (0.282) data 0.105 (0.119) loss_x loss_x 0.8232 (0.7738) acc_x 71.8750 (79.6875) lr 1.4399e-03 eta 0:00:05
epoch [73/200] batch [15/28] time 0.283 (0.269) data 0.120 (0.117) loss_x loss_x 0.6128 (0.7288) acc_x 81.2500 (80.8333) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [20/28] time 0.265 (0.269) data 0.107 (0.114) loss_x loss_x 0.7349 (0.7340) acc_x 78.1250 (80.9375) lr 1.4399e-03 eta 0:00:02
epoch [73/200] batch [25/28] time 0.246 (0.267) data 0.082 (0.110) loss_x loss_x 0.6299 (0.7056) acc_x 84.3750 (81.1250) lr 1.4399e-03 eta 0:00:00
epoch [73/200] batch [5/22] time 0.266 (0.265) data 0.100 (0.106) loss_u loss_u 0.8159 (0.7837) acc_u 18.7500 (25.6250) lr 1.4399e-03 eta 0:00:04
epoch [73/200] batch [10/22] time 0.175 (0.264) data 0.097 (0.107) loss_u loss_u 0.8389 (0.7950) acc_u 21.8750 (24.3750) lr 1.4399e-03 eta 0:00:03
epoch [73/200] batch [15/22] time 0.265 (0.260) data 0.099 (0.106) loss_u loss_u 0.8228 (0.8132) acc_u 18.7500 (22.5000) lr 1.4399e-03 eta 0:00:01
epoch [73/200] batch [20/22] time 0.269 (0.261) data 0.102 (0.105) loss_u loss_u 0.7969 (0.8026) acc_u 21.8750 (23.4375) lr 1.4399e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 427
confident_label rate tensor(0.5718, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 924
clean true:917
clean false:7
clean_rate:0.9924242424242424
noisy true:272
noisy false:420
after delete: len(clean_dataset) 924
after delete: len(noisy_dataset) 692
epoch [74/200] batch [5/28] time 0.272 (0.269) data 0.107 (0.105) loss_x loss_x 0.3579 (0.6276) acc_x 87.5000 (81.8750) lr 1.4258e-03 eta 0:00:06
epoch [74/200] batch [10/28] time 0.265 (0.252) data 0.101 (0.104) loss_x loss_x 0.4414 (0.5890) acc_x 84.3750 (82.5000) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [15/28] time 0.256 (0.255) data 0.090 (0.102) loss_x loss_x 0.2786 (0.5835) acc_x 87.5000 (83.5417) lr 1.4258e-03 eta 0:00:03
epoch [74/200] batch [20/28] time 0.272 (0.262) data 0.107 (0.106) loss_x loss_x 0.7334 (0.6244) acc_x 81.2500 (82.6562) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [25/28] time 0.272 (0.264) data 0.107 (0.106) loss_x loss_x 0.5527 (0.6411) acc_x 81.2500 (82.2500) lr 1.4258e-03 eta 0:00:00
epoch [74/200] batch [5/21] time 0.263 (0.259) data 0.099 (0.105) loss_u loss_u 0.8481 (0.8536) acc_u 18.7500 (16.2500) lr 1.4258e-03 eta 0:00:04
epoch [74/200] batch [10/21] time 0.321 (0.262) data 0.159 (0.107) loss_u loss_u 0.7637 (0.8239) acc_u 25.0000 (20.3125) lr 1.4258e-03 eta 0:00:02
epoch [74/200] batch [15/21] time 0.270 (0.267) data 0.105 (0.110) loss_u loss_u 0.7964 (0.8160) acc_u 25.0000 (21.2500) lr 1.4258e-03 eta 0:00:01
epoch [74/200] batch [20/21] time 0.294 (0.267) data 0.125 (0.110) loss_u loss_u 0.7275 (0.8166) acc_u 31.2500 (21.7188) lr 1.4258e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 454
confident_label rate tensor(0.5588, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 903
clean true:895
clean false:8
clean_rate:0.991140642303433
noisy true:267
noisy false:446
after delete: len(clean_dataset) 903
after delete: len(noisy_dataset) 713
epoch [75/200] batch [5/28] time 0.251 (0.268) data 0.088 (0.104) loss_x loss_x 0.6738 (0.5550) acc_x 78.1250 (86.2500) lr 1.4115e-03 eta 0:00:06
epoch [75/200] batch [10/28] time 0.275 (0.270) data 0.112 (0.106) loss_x loss_x 0.3059 (0.5744) acc_x 96.8750 (85.6250) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [15/28] time 0.290 (0.258) data 0.124 (0.104) loss_x loss_x 0.8770 (0.6215) acc_x 75.0000 (84.3750) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [20/28] time 0.248 (0.259) data 0.083 (0.104) loss_x loss_x 0.6274 (0.6299) acc_x 81.2500 (83.5938) lr 1.4115e-03 eta 0:00:02
epoch [75/200] batch [25/28] time 0.259 (0.260) data 0.092 (0.102) loss_x loss_x 0.4292 (0.6002) acc_x 84.3750 (84.3750) lr 1.4115e-03 eta 0:00:00
epoch [75/200] batch [5/22] time 0.183 (0.257) data 0.106 (0.101) loss_u loss_u 0.8872 (0.8204) acc_u 12.5000 (21.8750) lr 1.4115e-03 eta 0:00:04
epoch [75/200] batch [10/22] time 0.248 (0.255) data 0.085 (0.099) loss_u loss_u 0.7275 (0.8067) acc_u 28.1250 (23.4375) lr 1.4115e-03 eta 0:00:03
epoch [75/200] batch [15/22] time 0.257 (0.255) data 0.095 (0.099) loss_u loss_u 0.7935 (0.8206) acc_u 18.7500 (21.0417) lr 1.4115e-03 eta 0:00:01
epoch [75/200] batch [20/22] time 0.269 (0.256) data 0.106 (0.100) loss_u loss_u 0.7705 (0.8160) acc_u 28.1250 (22.0312) lr 1.4115e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 451
confident_label rate tensor(0.5693, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 920
clean true:907
clean false:13
clean_rate:0.9858695652173913
noisy true:258
noisy false:438
after delete: len(clean_dataset) 920
after delete: len(noisy_dataset) 696
epoch [76/200] batch [5/28] time 0.301 (0.314) data 0.135 (0.148) loss_x loss_x 0.5591 (0.5704) acc_x 84.3750 (86.2500) lr 1.3971e-03 eta 0:00:07
epoch [76/200] batch [10/28] time 0.338 (0.310) data 0.171 (0.144) loss_x loss_x 0.6406 (0.6546) acc_x 87.5000 (84.6875) lr 1.3971e-03 eta 0:00:05
epoch [76/200] batch [15/28] time 0.273 (0.286) data 0.107 (0.132) loss_x loss_x 0.7031 (0.6449) acc_x 78.1250 (84.5833) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [20/28] time 0.297 (0.287) data 0.131 (0.130) loss_x loss_x 0.5112 (0.6343) acc_x 87.5000 (84.6875) lr 1.3971e-03 eta 0:00:02
epoch [76/200] batch [25/28] time 0.279 (0.287) data 0.113 (0.128) loss_x loss_x 1.0010 (0.6645) acc_x 81.2500 (84.2500) lr 1.3971e-03 eta 0:00:00
epoch [76/200] batch [5/21] time 0.302 (0.285) data 0.132 (0.124) loss_u loss_u 0.8203 (0.7563) acc_u 21.8750 (28.7500) lr 1.3971e-03 eta 0:00:04
epoch [76/200] batch [10/21] time 0.274 (0.281) data 0.109 (0.122) loss_u loss_u 0.8701 (0.7839) acc_u 15.6250 (25.0000) lr 1.3971e-03 eta 0:00:03
epoch [76/200] batch [15/21] time 0.279 (0.280) data 0.113 (0.121) loss_u loss_u 0.8330 (0.7781) acc_u 21.8750 (26.0417) lr 1.3971e-03 eta 0:00:01
epoch [76/200] batch [20/21] time 0.288 (0.281) data 0.122 (0.121) loss_u loss_u 0.8267 (0.7991) acc_u 21.8750 (23.7500) lr 1.3971e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.5817, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 940
clean true:927
clean false:13
clean_rate:0.9861702127659574
noisy true:267
noisy false:409
after delete: len(clean_dataset) 940
after delete: len(noisy_dataset) 676
epoch [77/200] batch [5/29] time 0.180 (0.249) data 0.104 (0.119) loss_x loss_x 0.7476 (0.5988) acc_x 78.1250 (85.0000) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [10/29] time 0.304 (0.268) data 0.140 (0.121) loss_x loss_x 1.2598 (0.6930) acc_x 62.5000 (81.8750) lr 1.3827e-03 eta 0:00:05
epoch [77/200] batch [15/29] time 0.293 (0.277) data 0.126 (0.124) loss_x loss_x 0.6069 (0.7207) acc_x 87.5000 (80.8333) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [20/29] time 0.266 (0.276) data 0.106 (0.120) loss_x loss_x 0.7148 (0.7220) acc_x 81.2500 (80.6250) lr 1.3827e-03 eta 0:00:02
epoch [77/200] batch [25/29] time 0.172 (0.272) data 0.095 (0.118) loss_x loss_x 1.0527 (0.7359) acc_x 68.7500 (80.6250) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [5/21] time 0.264 (0.271) data 0.105 (0.116) loss_u loss_u 0.8086 (0.8561) acc_u 15.6250 (15.6250) lr 1.3827e-03 eta 0:00:04
epoch [77/200] batch [10/21] time 0.292 (0.273) data 0.128 (0.117) loss_u loss_u 0.8779 (0.8348) acc_u 12.5000 (19.0625) lr 1.3827e-03 eta 0:00:03
epoch [77/200] batch [15/21] time 0.349 (0.277) data 0.182 (0.119) loss_u loss_u 0.8057 (0.8170) acc_u 21.8750 (21.0417) lr 1.3827e-03 eta 0:00:01
epoch [77/200] batch [20/21] time 0.256 (0.275) data 0.094 (0.117) loss_u loss_u 0.7803 (0.8075) acc_u 28.1250 (22.1875) lr 1.3827e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 434
confident_label rate tensor(0.5749, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 929
clean true:915
clean false:14
clean_rate:0.984930032292788
noisy true:267
noisy false:420
after delete: len(clean_dataset) 929
after delete: len(noisy_dataset) 687
epoch [78/200] batch [5/29] time 0.334 (0.287) data 0.169 (0.124) loss_x loss_x 0.8066 (0.7071) acc_x 75.0000 (80.6250) lr 1.3681e-03 eta 0:00:06
epoch [78/200] batch [10/29] time 0.246 (0.280) data 0.107 (0.127) loss_x loss_x 0.3711 (0.6932) acc_x 90.6250 (81.5625) lr 1.3681e-03 eta 0:00:05
epoch [78/200] batch [15/29] time 0.274 (0.279) data 0.108 (0.122) loss_x loss_x 0.7153 (0.7158) acc_x 87.5000 (82.0833) lr 1.3681e-03 eta 0:00:03
epoch [78/200] batch [20/29] time 0.272 (0.278) data 0.107 (0.119) loss_x loss_x 0.7559 (0.6821) acc_x 81.2500 (82.8125) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [25/29] time 0.272 (0.276) data 0.108 (0.116) loss_x loss_x 0.7534 (0.7094) acc_x 81.2500 (82.0000) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [5/21] time 0.184 (0.274) data 0.107 (0.115) loss_u loss_u 0.8057 (0.7849) acc_u 25.0000 (25.0000) lr 1.3681e-03 eta 0:00:04
epoch [78/200] batch [10/21] time 0.270 (0.272) data 0.110 (0.114) loss_u loss_u 0.9004 (0.8033) acc_u 12.5000 (23.1250) lr 1.3681e-03 eta 0:00:02
epoch [78/200] batch [15/21] time 0.281 (0.272) data 0.118 (0.114) loss_u loss_u 0.7861 (0.7931) acc_u 21.8750 (23.9583) lr 1.3681e-03 eta 0:00:01
epoch [78/200] batch [20/21] time 0.276 (0.273) data 0.110 (0.113) loss_u loss_u 0.7979 (0.7995) acc_u 21.8750 (23.4375) lr 1.3681e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.5792, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 936
clean true:923
clean false:13
clean_rate:0.9861111111111112
noisy true:261
noisy false:419
after delete: len(clean_dataset) 936
after delete: len(noisy_dataset) 680
epoch [79/200] batch [5/29] time 0.293 (0.277) data 0.130 (0.114) loss_x loss_x 0.7051 (0.9294) acc_x 81.2500 (78.1250) lr 1.3535e-03 eta 0:00:06
epoch [79/200] batch [10/29] time 0.264 (0.273) data 0.100 (0.110) loss_x loss_x 0.5771 (0.7700) acc_x 84.3750 (80.6250) lr 1.3535e-03 eta 0:00:05
epoch [79/200] batch [15/29] time 0.284 (0.260) data 0.098 (0.107) loss_x loss_x 0.5967 (0.7569) acc_x 81.2500 (80.2083) lr 1.3535e-03 eta 0:00:03
epoch [79/200] batch [20/29] time 0.286 (0.261) data 0.122 (0.105) loss_x loss_x 0.9429 (0.7391) acc_x 81.2500 (80.4688) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [25/29] time 0.258 (0.261) data 0.094 (0.104) loss_x loss_x 0.5703 (0.7224) acc_x 87.5000 (81.0000) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [5/21] time 0.261 (0.262) data 0.095 (0.102) loss_u loss_u 0.7842 (0.8000) acc_u 31.2500 (25.0000) lr 1.3535e-03 eta 0:00:04
epoch [79/200] batch [10/21] time 0.259 (0.262) data 0.090 (0.101) loss_u loss_u 0.7373 (0.8070) acc_u 31.2500 (23.7500) lr 1.3535e-03 eta 0:00:02
epoch [79/200] batch [15/21] time 0.259 (0.256) data 0.097 (0.099) loss_u loss_u 0.8130 (0.8075) acc_u 25.0000 (23.3333) lr 1.3535e-03 eta 0:00:01
epoch [79/200] batch [20/21] time 0.288 (0.257) data 0.126 (0.100) loss_u loss_u 0.7466 (0.8070) acc_u 31.2500 (23.2812) lr 1.3535e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 451
confident_label rate tensor(0.5712, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 923
clean true:909
clean false:14
clean_rate:0.9848320693391116
noisy true:256
noisy false:437
after delete: len(clean_dataset) 923
after delete: len(noisy_dataset) 693
epoch [80/200] batch [5/28] time 0.266 (0.237) data 0.109 (0.090) loss_x loss_x 0.7397 (0.6565) acc_x 78.1250 (81.2500) lr 1.3387e-03 eta 0:00:05
epoch [80/200] batch [10/28] time 0.260 (0.250) data 0.097 (0.094) loss_x loss_x 1.1357 (0.7067) acc_x 75.0000 (80.3125) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [15/28] time 0.272 (0.254) data 0.110 (0.096) loss_x loss_x 0.3240 (0.7058) acc_x 87.5000 (79.7917) lr 1.3387e-03 eta 0:00:03
epoch [80/200] batch [20/28] time 0.253 (0.246) data 0.091 (0.095) loss_x loss_x 0.6304 (0.6815) acc_x 75.0000 (80.3125) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [25/28] time 0.359 (0.257) data 0.201 (0.104) loss_x loss_x 0.2434 (0.6679) acc_x 96.8750 (81.3750) lr 1.3387e-03 eta 0:00:00
epoch [80/200] batch [5/21] time 0.268 (0.262) data 0.104 (0.106) loss_u loss_u 0.8047 (0.7915) acc_u 21.8750 (22.5000) lr 1.3387e-03 eta 0:00:04
epoch [80/200] batch [10/21] time 0.267 (0.262) data 0.107 (0.105) loss_u loss_u 0.8081 (0.7848) acc_u 25.0000 (23.4375) lr 1.3387e-03 eta 0:00:02
epoch [80/200] batch [15/21] time 0.159 (0.260) data 0.082 (0.104) loss_u loss_u 0.8906 (0.7934) acc_u 12.5000 (23.3333) lr 1.3387e-03 eta 0:00:01
epoch [80/200] batch [20/21] time 0.274 (0.258) data 0.111 (0.105) loss_u loss_u 0.8101 (0.7856) acc_u 25.0000 (24.6875) lr 1.3387e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.5829, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 942
clean true:929
clean false:13
clean_rate:0.9861995753715499
noisy true:267
noisy false:407
after delete: len(clean_dataset) 942
after delete: len(noisy_dataset) 674
epoch [81/200] batch [5/29] time 0.288 (0.296) data 0.127 (0.132) loss_x loss_x 0.9375 (0.6576) acc_x 78.1250 (83.1250) lr 1.3239e-03 eta 0:00:07
epoch [81/200] batch [10/29] time 0.254 (0.277) data 0.090 (0.115) loss_x loss_x 0.9146 (0.6526) acc_x 81.2500 (82.8125) lr 1.3239e-03 eta 0:00:05
epoch [81/200] batch [15/29] time 0.259 (0.273) data 0.093 (0.110) loss_x loss_x 0.6084 (0.6231) acc_x 75.0000 (82.2917) lr 1.3239e-03 eta 0:00:03
epoch [81/200] batch [20/29] time 0.257 (0.270) data 0.093 (0.107) loss_x loss_x 1.1738 (0.6514) acc_x 75.0000 (81.2500) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [25/29] time 0.184 (0.257) data 0.092 (0.104) loss_x loss_x 0.5259 (0.6447) acc_x 87.5000 (81.8750) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [5/21] time 0.255 (0.260) data 0.087 (0.104) loss_u loss_u 0.8467 (0.8010) acc_u 21.8750 (23.7500) lr 1.3239e-03 eta 0:00:04
epoch [81/200] batch [10/21] time 0.263 (0.261) data 0.096 (0.103) loss_u loss_u 0.8198 (0.8194) acc_u 21.8750 (21.8750) lr 1.3239e-03 eta 0:00:02
epoch [81/200] batch [15/21] time 0.273 (0.261) data 0.107 (0.103) loss_u loss_u 0.7363 (0.8133) acc_u 34.3750 (23.1250) lr 1.3239e-03 eta 0:00:01
epoch [81/200] batch [20/21] time 0.255 (0.261) data 0.087 (0.102) loss_u loss_u 0.7246 (0.8091) acc_u 28.1250 (23.1250) lr 1.3239e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 412
confident_label rate tensor(0.5835, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 943
clean true:930
clean false:13
clean_rate:0.9862142099681867
noisy true:274
noisy false:399
after delete: len(clean_dataset) 943
after delete: len(noisy_dataset) 673
epoch [82/200] batch [5/29] time 0.268 (0.272) data 0.104 (0.108) loss_x loss_x 0.3171 (0.6279) acc_x 90.6250 (84.3750) lr 1.3090e-03 eta 0:00:06
epoch [82/200] batch [10/29] time 0.283 (0.271) data 0.118 (0.107) loss_x loss_x 0.7798 (0.6546) acc_x 84.3750 (84.0625) lr 1.3090e-03 eta 0:00:05
epoch [82/200] batch [15/29] time 0.273 (0.258) data 0.106 (0.105) loss_x loss_x 0.7686 (0.6248) acc_x 71.8750 (83.7500) lr 1.3090e-03 eta 0:00:03
epoch [82/200] batch [20/29] time 0.253 (0.263) data 0.088 (0.107) loss_x loss_x 0.7666 (0.6885) acc_x 78.1250 (81.8750) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [25/29] time 0.272 (0.263) data 0.106 (0.106) loss_x loss_x 0.3730 (0.6721) acc_x 84.3750 (82.0000) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [5/21] time 0.237 (0.260) data 0.099 (0.105) loss_u loss_u 0.7690 (0.7866) acc_u 28.1250 (24.3750) lr 1.3090e-03 eta 0:00:04
epoch [82/200] batch [10/21] time 0.303 (0.261) data 0.139 (0.105) loss_u loss_u 0.8608 (0.7988) acc_u 15.6250 (22.1875) lr 1.3090e-03 eta 0:00:02
epoch [82/200] batch [15/21] time 0.261 (0.264) data 0.098 (0.106) loss_u loss_u 0.8887 (0.7976) acc_u 15.6250 (23.1250) lr 1.3090e-03 eta 0:00:01
epoch [82/200] batch [20/21] time 0.262 (0.264) data 0.093 (0.105) loss_u loss_u 0.8770 (0.8063) acc_u 9.3750 (21.8750) lr 1.3090e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 447
confident_label rate tensor(0.5644, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 912
clean true:900
clean false:12
clean_rate:0.9868421052631579
noisy true:269
noisy false:435
after delete: len(clean_dataset) 912
after delete: len(noisy_dataset) 704
epoch [83/200] batch [5/28] time 0.261 (0.251) data 0.096 (0.099) loss_x loss_x 0.5479 (0.6998) acc_x 84.3750 (84.3750) lr 1.2940e-03 eta 0:00:05
epoch [83/200] batch [10/28] time 0.253 (0.257) data 0.090 (0.099) loss_x loss_x 0.5107 (0.6718) acc_x 81.2500 (84.0625) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [15/28] time 0.254 (0.259) data 0.090 (0.099) loss_x loss_x 0.6069 (0.6494) acc_x 84.3750 (84.5833) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [20/28] time 0.302 (0.261) data 0.137 (0.101) loss_x loss_x 0.8110 (0.6896) acc_x 78.1250 (83.1250) lr 1.2940e-03 eta 0:00:02
epoch [83/200] batch [25/28] time 0.280 (0.262) data 0.116 (0.101) loss_x loss_x 0.7583 (0.6681) acc_x 84.3750 (84.0000) lr 1.2940e-03 eta 0:00:00
epoch [83/200] batch [5/22] time 0.262 (0.258) data 0.094 (0.102) loss_u loss_u 0.8228 (0.7288) acc_u 21.8750 (30.0000) lr 1.2940e-03 eta 0:00:04
epoch [83/200] batch [10/22] time 0.277 (0.259) data 0.108 (0.103) loss_u loss_u 0.7954 (0.7761) acc_u 25.0000 (25.3125) lr 1.2940e-03 eta 0:00:03
epoch [83/200] batch [15/22] time 0.289 (0.261) data 0.122 (0.103) loss_u loss_u 0.7920 (0.7778) acc_u 21.8750 (25.4167) lr 1.2940e-03 eta 0:00:01
epoch [83/200] batch [20/22] time 0.264 (0.263) data 0.095 (0.104) loss_u loss_u 0.9165 (0.7793) acc_u 6.2500 (25.3125) lr 1.2940e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 411
confident_label rate tensor(0.5854, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 946
clean true:936
clean false:10
clean_rate:0.9894291754756871
noisy true:269
noisy false:401
after delete: len(clean_dataset) 946
after delete: len(noisy_dataset) 670
epoch [84/200] batch [5/29] time 0.267 (0.249) data 0.106 (0.104) loss_x loss_x 0.6030 (0.8024) acc_x 84.3750 (79.3750) lr 1.2790e-03 eta 0:00:05
epoch [84/200] batch [10/29] time 0.265 (0.258) data 0.103 (0.105) loss_x loss_x 0.4526 (0.7256) acc_x 87.5000 (80.9375) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [15/29] time 0.279 (0.262) data 0.116 (0.107) loss_x loss_x 0.9116 (0.6769) acc_x 84.3750 (82.7083) lr 1.2790e-03 eta 0:00:03
epoch [84/200] batch [20/29] time 0.272 (0.268) data 0.108 (0.111) loss_x loss_x 0.6772 (0.6789) acc_x 84.3750 (82.3438) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [25/29] time 0.260 (0.270) data 0.099 (0.111) loss_x loss_x 0.5063 (0.6805) acc_x 93.7500 (82.6250) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [5/20] time 0.328 (0.270) data 0.160 (0.116) loss_u loss_u 0.7705 (0.8166) acc_u 28.1250 (20.6250) lr 1.2790e-03 eta 0:00:04
epoch [84/200] batch [10/20] time 0.298 (0.270) data 0.127 (0.114) loss_u loss_u 0.7832 (0.8136) acc_u 25.0000 (21.2500) lr 1.2790e-03 eta 0:00:02
epoch [84/200] batch [15/20] time 0.264 (0.270) data 0.096 (0.113) loss_u loss_u 0.7896 (0.8029) acc_u 28.1250 (22.5000) lr 1.2790e-03 eta 0:00:01
epoch [84/200] batch [20/20] time 0.281 (0.270) data 0.113 (0.112) loss_u loss_u 0.8174 (0.8091) acc_u 18.7500 (21.8750) lr 1.2790e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.5817, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 940
clean true:926
clean false:14
clean_rate:0.9851063829787234
noisy true:258
noisy false:418
after delete: len(clean_dataset) 940
after delete: len(noisy_dataset) 676
epoch [85/200] batch [5/29] time 0.271 (0.260) data 0.108 (0.103) loss_x loss_x 0.8408 (0.6570) acc_x 78.1250 (83.1250) lr 1.2639e-03 eta 0:00:06
epoch [85/200] batch [10/29] time 0.269 (0.259) data 0.108 (0.101) loss_x loss_x 0.4690 (0.6399) acc_x 93.7500 (84.0625) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [15/29] time 0.265 (0.257) data 0.103 (0.098) loss_x loss_x 0.6831 (0.6117) acc_x 84.3750 (84.7917) lr 1.2639e-03 eta 0:00:03
epoch [85/200] batch [20/29] time 0.248 (0.259) data 0.085 (0.100) loss_x loss_x 0.6821 (0.6282) acc_x 84.3750 (84.8438) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [25/29] time 0.261 (0.261) data 0.098 (0.101) loss_x loss_x 0.6118 (0.6617) acc_x 84.3750 (84.0000) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [5/21] time 0.260 (0.255) data 0.101 (0.101) loss_u loss_u 0.8140 (0.7922) acc_u 18.7500 (22.5000) lr 1.2639e-03 eta 0:00:04
epoch [85/200] batch [10/21] time 0.270 (0.256) data 0.103 (0.100) loss_u loss_u 0.7554 (0.7910) acc_u 25.0000 (23.7500) lr 1.2639e-03 eta 0:00:02
epoch [85/200] batch [15/21] time 0.274 (0.257) data 0.107 (0.100) loss_u loss_u 0.8188 (0.8092) acc_u 21.8750 (22.0833) lr 1.2639e-03 eta 0:00:01
epoch [85/200] batch [20/21] time 0.265 (0.257) data 0.104 (0.100) loss_u loss_u 0.7373 (0.7888) acc_u 34.3750 (24.3750) lr 1.2639e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 439
confident_label rate tensor(0.5749, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 929
clean true:912
clean false:17
clean_rate:0.9817007534983854
noisy true:265
noisy false:422
after delete: len(clean_dataset) 929
after delete: len(noisy_dataset) 687
epoch [86/200] batch [5/29] time 0.253 (0.298) data 0.090 (0.132) loss_x loss_x 0.5337 (0.6315) acc_x 84.3750 (83.1250) lr 1.2487e-03 eta 0:00:07
epoch [86/200] batch [10/29] time 0.259 (0.286) data 0.097 (0.122) loss_x loss_x 0.6812 (0.5901) acc_x 87.5000 (84.3750) lr 1.2487e-03 eta 0:00:05
epoch [86/200] batch [15/29] time 0.326 (0.286) data 0.162 (0.122) loss_x loss_x 0.6401 (0.6065) acc_x 84.3750 (83.9583) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [20/29] time 0.250 (0.280) data 0.086 (0.116) loss_x loss_x 1.1250 (0.6072) acc_x 78.1250 (84.2188) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [25/29] time 0.157 (0.272) data 0.080 (0.112) loss_x loss_x 0.9360 (0.6435) acc_x 71.8750 (83.5000) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [5/21] time 0.260 (0.268) data 0.095 (0.109) loss_u loss_u 0.7358 (0.7354) acc_u 34.3750 (30.6250) lr 1.2487e-03 eta 0:00:04
epoch [86/200] batch [10/21] time 0.269 (0.267) data 0.106 (0.108) loss_u loss_u 0.8203 (0.7740) acc_u 21.8750 (25.6250) lr 1.2487e-03 eta 0:00:02
epoch [86/200] batch [15/21] time 0.260 (0.269) data 0.095 (0.110) loss_u loss_u 0.7812 (0.7910) acc_u 18.7500 (23.5417) lr 1.2487e-03 eta 0:00:01
epoch [86/200] batch [20/21] time 0.185 (0.267) data 0.107 (0.109) loss_u loss_u 0.6997 (0.7951) acc_u 40.6250 (24.0625) lr 1.2487e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 430
confident_label rate tensor(0.5842, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 944
clean true:928
clean false:16
clean_rate:0.9830508474576272
noisy true:258
noisy false:414
after delete: len(clean_dataset) 944
after delete: len(noisy_dataset) 672
epoch [87/200] batch [5/29] time 0.274 (0.288) data 0.108 (0.123) loss_x loss_x 0.7676 (0.6199) acc_x 75.0000 (81.8750) lr 1.2334e-03 eta 0:00:06
epoch [87/200] batch [10/29] time 0.263 (0.278) data 0.105 (0.115) loss_x loss_x 0.6016 (0.6000) acc_x 81.2500 (82.8125) lr 1.2334e-03 eta 0:00:05
epoch [87/200] batch [15/29] time 0.267 (0.268) data 0.106 (0.112) loss_x loss_x 0.5132 (0.5723) acc_x 87.5000 (83.3333) lr 1.2334e-03 eta 0:00:03
epoch [87/200] batch [20/29] time 0.267 (0.268) data 0.109 (0.111) loss_x loss_x 0.4441 (0.5811) acc_x 90.6250 (83.9062) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [25/29] time 0.270 (0.269) data 0.110 (0.110) loss_x loss_x 0.6211 (0.6108) acc_x 87.5000 (83.6250) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [5/21] time 0.281 (0.270) data 0.120 (0.110) loss_u loss_u 0.8018 (0.8018) acc_u 21.8750 (21.2500) lr 1.2334e-03 eta 0:00:04
epoch [87/200] batch [10/21] time 0.186 (0.267) data 0.108 (0.110) loss_u loss_u 0.7891 (0.7939) acc_u 21.8750 (23.1250) lr 1.2334e-03 eta 0:00:02
epoch [87/200] batch [15/21] time 0.279 (0.267) data 0.111 (0.111) loss_u loss_u 0.7783 (0.8007) acc_u 28.1250 (22.9167) lr 1.2334e-03 eta 0:00:01
epoch [87/200] batch [20/21] time 0.267 (0.267) data 0.104 (0.110) loss_u loss_u 0.8428 (0.8033) acc_u 21.8750 (22.9688) lr 1.2334e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 469
confident_label rate tensor(0.5668, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 916
clean true:902
clean false:14
clean_rate:0.9847161572052402
noisy true:245
noisy false:455
after delete: len(clean_dataset) 916
after delete: len(noisy_dataset) 700
epoch [88/200] batch [5/28] time 0.269 (0.276) data 0.111 (0.113) loss_x loss_x 0.6758 (0.5433) acc_x 75.0000 (85.6250) lr 1.2181e-03 eta 0:00:06
epoch [88/200] batch [10/28] time 0.263 (0.275) data 0.105 (0.113) loss_x loss_x 0.7046 (0.5983) acc_x 75.0000 (83.7500) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [15/28] time 0.270 (0.272) data 0.107 (0.110) loss_x loss_x 0.5229 (0.5641) acc_x 84.3750 (84.5833) lr 1.2181e-03 eta 0:00:03
epoch [88/200] batch [20/28] time 0.264 (0.270) data 0.105 (0.107) loss_x loss_x 0.5923 (0.5778) acc_x 84.3750 (84.2188) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [25/28] time 0.195 (0.268) data 0.117 (0.109) loss_x loss_x 0.9155 (0.5868) acc_x 78.1250 (84.6250) lr 1.2181e-03 eta 0:00:00
epoch [88/200] batch [5/21] time 0.273 (0.263) data 0.107 (0.107) loss_u loss_u 0.7969 (0.7363) acc_u 21.8750 (28.7500) lr 1.2181e-03 eta 0:00:04
epoch [88/200] batch [10/21] time 0.278 (0.265) data 0.111 (0.108) loss_u loss_u 0.7212 (0.7566) acc_u 34.3750 (27.5000) lr 1.2181e-03 eta 0:00:02
epoch [88/200] batch [15/21] time 0.272 (0.266) data 0.106 (0.108) loss_u loss_u 0.6953 (0.7686) acc_u 40.6250 (27.2917) lr 1.2181e-03 eta 0:00:01
epoch [88/200] batch [20/21] time 0.275 (0.267) data 0.108 (0.108) loss_u loss_u 0.6250 (0.7650) acc_u 40.6250 (27.6562) lr 1.2181e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 414
confident_label rate tensor(0.5811, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 939
clean true:928
clean false:11
clean_rate:0.9882854100106496
noisy true:274
noisy false:403
after delete: len(clean_dataset) 939
after delete: len(noisy_dataset) 677
epoch [89/200] batch [5/29] time 0.276 (0.265) data 0.113 (0.102) loss_x loss_x 0.4531 (0.5670) acc_x 93.7500 (84.3750) lr 1.2028e-03 eta 0:00:06
epoch [89/200] batch [10/29] time 0.267 (0.263) data 0.102 (0.099) loss_x loss_x 0.7202 (0.5683) acc_x 78.1250 (85.6250) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [15/29] time 0.259 (0.262) data 0.094 (0.098) loss_x loss_x 0.3516 (0.5315) acc_x 93.7500 (86.0417) lr 1.2028e-03 eta 0:00:03
epoch [89/200] batch [20/29] time 0.266 (0.262) data 0.100 (0.098) loss_x loss_x 0.9194 (0.5409) acc_x 81.2500 (86.4062) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [25/29] time 0.186 (0.258) data 0.109 (0.098) loss_x loss_x 0.6538 (0.5742) acc_x 78.1250 (85.6250) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [5/21] time 0.277 (0.260) data 0.108 (0.100) loss_u loss_u 0.7578 (0.7768) acc_u 31.2500 (26.2500) lr 1.2028e-03 eta 0:00:04
epoch [89/200] batch [10/21] time 0.279 (0.262) data 0.110 (0.101) loss_u loss_u 0.7334 (0.7951) acc_u 31.2500 (24.0625) lr 1.2028e-03 eta 0:00:02
epoch [89/200] batch [15/21] time 0.276 (0.263) data 0.108 (0.102) loss_u loss_u 0.8213 (0.8002) acc_u 28.1250 (24.1667) lr 1.2028e-03 eta 0:00:01
epoch [89/200] batch [20/21] time 0.301 (0.266) data 0.133 (0.104) loss_u loss_u 0.7812 (0.7937) acc_u 28.1250 (24.8438) lr 1.2028e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.5823, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 941
clean true:929
clean false:12
clean_rate:0.9872476089266737
noisy true:269
noisy false:406
after delete: len(clean_dataset) 941
after delete: len(noisy_dataset) 675
epoch [90/200] batch [5/29] time 0.259 (0.280) data 0.093 (0.115) loss_x loss_x 0.7183 (0.6669) acc_x 71.8750 (81.2500) lr 1.1874e-03 eta 0:00:06
epoch [90/200] batch [10/29] time 0.258 (0.261) data 0.092 (0.111) loss_x loss_x 0.4353 (0.6232) acc_x 90.6250 (83.4375) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [15/29] time 0.264 (0.264) data 0.100 (0.110) loss_x loss_x 0.8574 (0.6805) acc_x 84.3750 (83.1250) lr 1.1874e-03 eta 0:00:03
epoch [90/200] batch [20/29] time 0.276 (0.265) data 0.112 (0.108) loss_x loss_x 0.5537 (0.7259) acc_x 84.3750 (81.8750) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [25/29] time 0.272 (0.261) data 0.097 (0.106) loss_x loss_x 0.5425 (0.7015) acc_x 84.3750 (81.7500) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [5/21] time 0.250 (0.263) data 0.089 (0.105) loss_u loss_u 0.7500 (0.8191) acc_u 25.0000 (20.6250) lr 1.1874e-03 eta 0:00:04
epoch [90/200] batch [10/21] time 0.261 (0.263) data 0.098 (0.104) loss_u loss_u 0.7607 (0.8090) acc_u 28.1250 (22.1875) lr 1.1874e-03 eta 0:00:02
epoch [90/200] batch [15/21] time 0.261 (0.258) data 0.098 (0.103) loss_u loss_u 0.8145 (0.7988) acc_u 21.8750 (23.3333) lr 1.1874e-03 eta 0:00:01
epoch [90/200] batch [20/21] time 0.272 (0.259) data 0.104 (0.103) loss_u loss_u 0.8228 (0.8023) acc_u 21.8750 (22.6562) lr 1.1874e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 432
confident_label rate tensor(0.5743, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 928
clean true:919
clean false:9
clean_rate:0.990301724137931
noisy true:265
noisy false:423
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 688
epoch [91/200] batch [5/29] time 0.258 (0.287) data 0.091 (0.121) loss_x loss_x 0.8672 (0.7562) acc_x 84.3750 (82.5000) lr 1.1719e-03 eta 0:00:06
epoch [91/200] batch [10/29] time 0.259 (0.262) data 0.092 (0.110) loss_x loss_x 0.5161 (0.6802) acc_x 87.5000 (83.7500) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [15/29] time 0.269 (0.263) data 0.103 (0.106) loss_x loss_x 0.9790 (0.6883) acc_x 68.7500 (82.9167) lr 1.1719e-03 eta 0:00:03
epoch [91/200] batch [20/29] time 0.252 (0.262) data 0.085 (0.103) loss_x loss_x 0.5259 (0.6883) acc_x 84.3750 (83.2812) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [25/29] time 0.272 (0.264) data 0.107 (0.104) loss_x loss_x 0.8755 (0.6568) acc_x 78.1250 (83.8750) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [5/21] time 0.264 (0.261) data 0.099 (0.104) loss_u loss_u 0.9795 (0.7928) acc_u 3.1250 (25.0000) lr 1.1719e-03 eta 0:00:04
epoch [91/200] batch [10/21] time 0.274 (0.262) data 0.107 (0.104) loss_u loss_u 0.7856 (0.7986) acc_u 25.0000 (23.7500) lr 1.1719e-03 eta 0:00:02
epoch [91/200] batch [15/21] time 0.253 (0.264) data 0.091 (0.106) loss_u loss_u 0.7998 (0.7883) acc_u 25.0000 (24.5833) lr 1.1719e-03 eta 0:00:01
epoch [91/200] batch [20/21] time 0.263 (0.264) data 0.094 (0.105) loss_u loss_u 0.8696 (0.7944) acc_u 12.5000 (23.5938) lr 1.1719e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 453
confident_label rate tensor(0.5656, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 914
clean true:899
clean false:15
clean_rate:0.9835886214442013
noisy true:264
noisy false:438
after delete: len(clean_dataset) 914
after delete: len(noisy_dataset) 702
epoch [92/200] batch [5/28] time 0.295 (0.281) data 0.130 (0.115) loss_x loss_x 0.6924 (0.5337) acc_x 81.2500 (85.0000) lr 1.1564e-03 eta 0:00:06
epoch [92/200] batch [10/28] time 0.266 (0.272) data 0.103 (0.109) loss_x loss_x 0.9971 (0.5867) acc_x 84.3750 (85.3125) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [15/28] time 0.268 (0.273) data 0.103 (0.110) loss_x loss_x 0.4841 (0.5951) acc_x 90.6250 (85.4167) lr 1.1564e-03 eta 0:00:03
epoch [92/200] batch [20/28] time 0.297 (0.273) data 0.132 (0.110) loss_x loss_x 0.7876 (0.6255) acc_x 81.2500 (83.9062) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [25/28] time 0.287 (0.272) data 0.126 (0.109) loss_x loss_x 0.4275 (0.5895) acc_x 93.7500 (85.1250) lr 1.1564e-03 eta 0:00:00
epoch [92/200] batch [5/21] time 0.339 (0.269) data 0.170 (0.109) loss_u loss_u 0.7593 (0.7925) acc_u 28.1250 (25.0000) lr 1.1564e-03 eta 0:00:04
epoch [92/200] batch [10/21] time 0.271 (0.270) data 0.105 (0.110) loss_u loss_u 0.8086 (0.8000) acc_u 25.0000 (24.0625) lr 1.1564e-03 eta 0:00:02
epoch [92/200] batch [15/21] time 0.300 (0.271) data 0.132 (0.110) loss_u loss_u 0.7573 (0.7812) acc_u 25.0000 (25.4167) lr 1.1564e-03 eta 0:00:01
epoch [92/200] batch [20/21] time 0.271 (0.271) data 0.104 (0.109) loss_u loss_u 0.7886 (0.7837) acc_u 31.2500 (25.6250) lr 1.1564e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 424
confident_label rate tensor(0.5829, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 942
clean true:929
clean false:13
clean_rate:0.9861995753715499
noisy true:263
noisy false:411
after delete: len(clean_dataset) 942
after delete: len(noisy_dataset) 674
epoch [93/200] batch [5/29] time 0.270 (0.287) data 0.106 (0.123) loss_x loss_x 0.5400 (0.5070) acc_x 84.3750 (85.6250) lr 1.1409e-03 eta 0:00:06
epoch [93/200] batch [10/29] time 0.273 (0.279) data 0.109 (0.117) loss_x loss_x 0.6191 (0.5830) acc_x 81.2500 (83.4375) lr 1.1409e-03 eta 0:00:05
epoch [93/200] batch [15/29] time 0.194 (0.261) data 0.104 (0.112) loss_x loss_x 0.3252 (0.5633) acc_x 93.7500 (84.3750) lr 1.1409e-03 eta 0:00:03
epoch [93/200] batch [20/29] time 0.268 (0.260) data 0.104 (0.107) loss_x loss_x 0.2661 (0.5630) acc_x 93.7500 (84.5312) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [25/29] time 0.253 (0.262) data 0.085 (0.107) loss_x loss_x 0.6704 (0.5698) acc_x 90.6250 (84.7500) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [5/21] time 0.280 (0.269) data 0.111 (0.111) loss_u loss_u 0.7168 (0.7665) acc_u 34.3750 (27.5000) lr 1.1409e-03 eta 0:00:04
epoch [93/200] batch [10/21] time 0.283 (0.266) data 0.112 (0.111) loss_u loss_u 0.8696 (0.7930) acc_u 15.6250 (23.4375) lr 1.1409e-03 eta 0:00:02
epoch [93/200] batch [15/21] time 0.260 (0.267) data 0.095 (0.109) loss_u loss_u 0.7539 (0.7938) acc_u 31.2500 (23.1250) lr 1.1409e-03 eta 0:00:01
epoch [93/200] batch [20/21] time 0.268 (0.268) data 0.099 (0.110) loss_u loss_u 0.7222 (0.7897) acc_u 34.3750 (23.9062) lr 1.1409e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 440
confident_label rate tensor(0.5786, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 935
clean true:921
clean false:14
clean_rate:0.9850267379679144
noisy true:255
noisy false:426
after delete: len(clean_dataset) 935
after delete: len(noisy_dataset) 681
epoch [94/200] batch [5/29] time 0.277 (0.280) data 0.112 (0.114) loss_x loss_x 0.6865 (0.5670) acc_x 84.3750 (82.5000) lr 1.1253e-03 eta 0:00:06
epoch [94/200] batch [10/29] time 0.274 (0.276) data 0.110 (0.111) loss_x loss_x 0.6069 (0.5693) acc_x 87.5000 (83.4375) lr 1.1253e-03 eta 0:00:05
epoch [94/200] batch [15/29] time 0.253 (0.273) data 0.094 (0.109) loss_x loss_x 1.0098 (0.5878) acc_x 75.0000 (83.5417) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [20/29] time 0.260 (0.271) data 0.095 (0.107) loss_x loss_x 0.4668 (0.5862) acc_x 90.6250 (84.0625) lr 1.1253e-03 eta 0:00:02
epoch [94/200] batch [25/29] time 0.282 (0.272) data 0.118 (0.108) loss_x loss_x 0.6338 (0.5805) acc_x 81.2500 (84.1250) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [5/21] time 0.273 (0.271) data 0.114 (0.111) loss_u loss_u 0.8335 (0.7783) acc_u 21.8750 (26.8750) lr 1.1253e-03 eta 0:00:04
epoch [94/200] batch [10/21] time 0.264 (0.273) data 0.095 (0.112) loss_u loss_u 0.8394 (0.7901) acc_u 21.8750 (25.3125) lr 1.1253e-03 eta 0:00:03
epoch [94/200] batch [15/21] time 0.303 (0.274) data 0.133 (0.113) loss_u loss_u 0.7759 (0.7922) acc_u 31.2500 (25.0000) lr 1.1253e-03 eta 0:00:01
epoch [94/200] batch [20/21] time 0.299 (0.277) data 0.130 (0.114) loss_u loss_u 0.7793 (0.7940) acc_u 25.0000 (24.5312) lr 1.1253e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 410
confident_label rate tensor(0.5866, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 948
clean true:931
clean false:17
clean_rate:0.9820675105485233
noisy true:275
noisy false:393
after delete: len(clean_dataset) 948
after delete: len(noisy_dataset) 668
epoch [95/200] batch [5/29] time 0.286 (0.269) data 0.128 (0.109) loss_x loss_x 0.5488 (0.7303) acc_x 90.6250 (82.5000) lr 1.1097e-03 eta 0:00:06
epoch [95/200] batch [10/29] time 0.247 (0.277) data 0.099 (0.119) loss_x loss_x 0.4460 (0.6259) acc_x 87.5000 (84.6875) lr 1.1097e-03 eta 0:00:05
epoch [95/200] batch [15/29] time 0.290 (0.272) data 0.127 (0.117) loss_x loss_x 0.8618 (0.6100) acc_x 75.0000 (83.9583) lr 1.1097e-03 eta 0:00:03
epoch [95/200] batch [20/29] time 0.270 (0.273) data 0.107 (0.116) loss_x loss_x 0.7739 (0.6490) acc_x 84.3750 (82.8125) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [25/29] time 0.323 (0.277) data 0.158 (0.118) loss_x loss_x 0.5239 (0.6203) acc_x 81.2500 (83.8750) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [5/20] time 0.176 (0.279) data 0.097 (0.121) loss_u loss_u 0.7417 (0.7599) acc_u 28.1250 (30.6250) lr 1.1097e-03 eta 0:00:04
epoch [95/200] batch [10/20] time 0.271 (0.277) data 0.102 (0.120) loss_u loss_u 0.8560 (0.7897) acc_u 15.6250 (25.9375) lr 1.1097e-03 eta 0:00:02
epoch [95/200] batch [15/20] time 0.276 (0.278) data 0.104 (0.119) loss_u loss_u 0.7393 (0.7951) acc_u 31.2500 (25.2083) lr 1.1097e-03 eta 0:00:01
epoch [95/200] batch [20/20] time 0.266 (0.276) data 0.095 (0.116) loss_u loss_u 0.7983 (0.7989) acc_u 21.8750 (24.5312) lr 1.1097e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.5743, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 928
clean true:916
clean false:12
clean_rate:0.9870689655172413
noisy true:274
noisy false:414
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 688
epoch [96/200] batch [5/29] time 0.260 (0.290) data 0.101 (0.130) loss_x loss_x 0.6367 (0.6816) acc_x 84.3750 (82.5000) lr 1.0941e-03 eta 0:00:06
epoch [96/200] batch [10/29] time 0.278 (0.278) data 0.117 (0.118) loss_x loss_x 0.6611 (0.6417) acc_x 84.3750 (85.9375) lr 1.0941e-03 eta 0:00:05
epoch [96/200] batch [15/29] time 0.253 (0.272) data 0.090 (0.112) loss_x loss_x 0.4727 (0.6541) acc_x 90.6250 (84.3750) lr 1.0941e-03 eta 0:00:03
epoch [96/200] batch [20/29] time 0.265 (0.271) data 0.103 (0.111) loss_x loss_x 0.4917 (0.6711) acc_x 87.5000 (83.9062) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [25/29] time 0.249 (0.262) data 0.088 (0.107) loss_x loss_x 0.5508 (0.6433) acc_x 84.3750 (84.2500) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [5/21] time 0.260 (0.264) data 0.095 (0.106) loss_u loss_u 0.8530 (0.7966) acc_u 18.7500 (22.5000) lr 1.0941e-03 eta 0:00:04
epoch [96/200] batch [10/21] time 0.264 (0.265) data 0.092 (0.106) loss_u loss_u 0.7690 (0.7815) acc_u 25.0000 (24.3750) lr 1.0941e-03 eta 0:00:02
epoch [96/200] batch [15/21] time 0.325 (0.267) data 0.158 (0.107) loss_u loss_u 0.7900 (0.7891) acc_u 28.1250 (24.1667) lr 1.0941e-03 eta 0:00:01
epoch [96/200] batch [20/21] time 0.185 (0.266) data 0.106 (0.107) loss_u loss_u 0.7783 (0.7896) acc_u 25.0000 (24.2188) lr 1.0941e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 406
confident_label rate tensor(0.5953, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 962
clean true:945
clean false:17
clean_rate:0.9823284823284824
noisy true:265
noisy false:389
after delete: len(clean_dataset) 962
after delete: len(noisy_dataset) 654
epoch [97/200] batch [5/30] time 0.272 (0.270) data 0.109 (0.109) loss_x loss_x 0.4482 (0.5994) acc_x 84.3750 (81.8750) lr 1.0785e-03 eta 0:00:06
epoch [97/200] batch [10/30] time 0.244 (0.262) data 0.086 (0.101) loss_x loss_x 0.4539 (0.5939) acc_x 90.6250 (82.1875) lr 1.0785e-03 eta 0:00:05
epoch [97/200] batch [15/30] time 0.249 (0.246) data 0.085 (0.096) loss_x loss_x 0.6680 (0.6169) acc_x 81.2500 (81.6667) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [20/30] time 0.307 (0.253) data 0.145 (0.100) loss_x loss_x 0.6099 (0.6371) acc_x 84.3750 (81.4062) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [25/30] time 0.271 (0.256) data 0.111 (0.102) loss_x loss_x 0.4077 (0.6179) acc_x 84.3750 (82.5000) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [30/30] time 0.280 (0.259) data 0.120 (0.103) loss_x loss_x 1.2139 (0.6240) acc_x 75.0000 (82.7083) lr 1.0785e-03 eta 0:00:00
epoch [97/200] batch [5/20] time 0.239 (0.259) data 0.132 (0.104) loss_u loss_u 0.7622 (0.7479) acc_u 28.1250 (28.1250) lr 1.0785e-03 eta 0:00:03
epoch [97/200] batch [10/20] time 0.285 (0.259) data 0.115 (0.105) loss_u loss_u 0.8599 (0.7933) acc_u 21.8750 (24.6875) lr 1.0785e-03 eta 0:00:02
epoch [97/200] batch [15/20] time 0.281 (0.262) data 0.110 (0.105) loss_u loss_u 0.8608 (0.8024) acc_u 18.7500 (23.5417) lr 1.0785e-03 eta 0:00:01
epoch [97/200] batch [20/20] time 0.274 (0.263) data 0.109 (0.106) loss_u loss_u 0.7583 (0.8010) acc_u 28.1250 (23.4375) lr 1.0785e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 414
confident_label rate tensor(0.5897, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 953
clean true:939
clean false:14
clean_rate:0.9853095487932844
noisy true:263
noisy false:400
after delete: len(clean_dataset) 953
after delete: len(noisy_dataset) 663
epoch [98/200] batch [5/29] time 0.263 (0.263) data 0.103 (0.102) loss_x loss_x 0.6562 (0.5123) acc_x 84.3750 (86.8750) lr 1.0628e-03 eta 0:00:06
epoch [98/200] batch [10/29] time 0.245 (0.263) data 0.082 (0.102) loss_x loss_x 0.4690 (0.5837) acc_x 84.3750 (85.0000) lr 1.0628e-03 eta 0:00:04
epoch [98/200] batch [15/29] time 0.261 (0.252) data 0.097 (0.100) loss_x loss_x 0.7124 (0.5708) acc_x 84.3750 (85.8333) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [20/29] time 0.260 (0.254) data 0.098 (0.100) loss_x loss_x 0.7319 (0.6378) acc_x 81.2500 (83.4375) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [25/29] time 0.271 (0.256) data 0.109 (0.100) loss_x loss_x 0.5039 (0.6585) acc_x 84.3750 (82.6250) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [5/20] time 0.274 (0.255) data 0.109 (0.101) loss_u loss_u 0.8496 (0.8161) acc_u 15.6250 (21.2500) lr 1.0628e-03 eta 0:00:03
epoch [98/200] batch [10/20] time 0.287 (0.259) data 0.117 (0.103) loss_u loss_u 0.8105 (0.8012) acc_u 18.7500 (22.8125) lr 1.0628e-03 eta 0:00:02
epoch [98/200] batch [15/20] time 0.272 (0.260) data 0.108 (0.103) loss_u loss_u 0.7490 (0.7942) acc_u 31.2500 (23.7500) lr 1.0628e-03 eta 0:00:01
epoch [98/200] batch [20/20] time 0.284 (0.262) data 0.115 (0.104) loss_u loss_u 0.6162 (0.7857) acc_u 43.7500 (24.5312) lr 1.0628e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.5823, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 941
clean true:927
clean false:14
clean_rate:0.9851222104144527
noisy true:263
noisy false:412
after delete: len(clean_dataset) 941
after delete: len(noisy_dataset) 675
epoch [99/200] batch [5/29] time 0.265 (0.271) data 0.104 (0.110) loss_x loss_x 0.5151 (0.4468) acc_x 87.5000 (87.5000) lr 1.0471e-03 eta 0:00:06
epoch [99/200] batch [10/29] time 0.240 (0.264) data 0.081 (0.103) loss_x loss_x 0.6689 (0.4470) acc_x 78.1250 (88.1250) lr 1.0471e-03 eta 0:00:05
epoch [99/200] batch [15/29] time 0.179 (0.256) data 0.102 (0.101) loss_x loss_x 0.5869 (0.5009) acc_x 81.2500 (86.0417) lr 1.0471e-03 eta 0:00:03
epoch [99/200] batch [20/29] time 0.269 (0.255) data 0.106 (0.102) loss_x loss_x 0.3970 (0.4976) acc_x 93.7500 (86.5625) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [25/29] time 0.266 (0.261) data 0.107 (0.107) loss_x loss_x 0.9282 (0.5464) acc_x 75.0000 (85.5000) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [5/21] time 0.271 (0.264) data 0.107 (0.107) loss_u loss_u 0.8809 (0.8356) acc_u 12.5000 (20.0000) lr 1.0471e-03 eta 0:00:04
epoch [99/200] batch [10/21] time 0.276 (0.265) data 0.109 (0.107) loss_u loss_u 0.8252 (0.7988) acc_u 25.0000 (23.4375) lr 1.0471e-03 eta 0:00:02
epoch [99/200] batch [15/21] time 0.297 (0.263) data 0.127 (0.107) loss_u loss_u 0.7402 (0.8020) acc_u 31.2500 (23.3333) lr 1.0471e-03 eta 0:00:01
epoch [99/200] batch [20/21] time 0.256 (0.262) data 0.084 (0.106) loss_u loss_u 0.7920 (0.7917) acc_u 28.1250 (24.2188) lr 1.0471e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 435
confident_label rate tensor(0.5712, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 923
clean true:911
clean false:12
clean_rate:0.9869989165763814
noisy true:270
noisy false:423
all clean rate:  [0.9716494845360825, 0.9833333333333333, 0.9861538461538462, 0.9834834834834835, 0.9924924924924925, 0.9895209580838323, 0.9897209985315712, 0.9902234636871509, 0.992816091954023, 0.986013986013986, 0.9906542056074766, 0.9859747545582047, 0.9891156462585035, 0.986130374479889, 0.990578734858681, 0.9906914893617021, 0.9906790945406125, 0.9868073878627969, 0.9870967741935484, 0.9838709677419355, 0.9870967741935484, 0.9854497354497355, 0.9872935196950444, 0.9897567221510883, 0.9851485148514851, 0.9835234474017744, 0.9922779922779923, 0.9847328244274809, 0.9833333333333333, 0.9912060301507538, 0.9885057471264368, 0.9886792452830189, 0.9841656516443362, 0.9816625916870416, 0.9796650717703349, 0.98676293622142, 0.9881093935790726, 0.9865030674846625, 0.9883449883449883, 0.9833729216152018, 0.9891041162227603, 0.9883449883449883, 0.98562874251497, 0.9829545454545454, 0.985244040862656, 0.9908045977011494, 0.9796149490373726, 0.9847238542890717, 0.9847953216374269, 0.988399071925754, 0.9813953488372092, 0.984144960362401, 0.9876543209876543, 0.9838895281933256, 0.9876957494407159, 0.986409966024915, 0.988399071925754, 0.985244040862656, 0.9888517279821628, 0.9877913429522752, 0.9831649831649831, 0.9897610921501706, 0.9851428571428571, 0.9840182648401826, 0.9858078602620087, 0.9836956521739131, 0.9864406779661017, 0.9852104664391353, 0.9849624060150376, 0.9845814977973568, 0.9833147942157954, 0.9902597402597403, 0.9878048780487805, 0.9924242424242424, 0.991140642303433, 0.9858695652173913, 0.9861702127659574, 0.984930032292788, 0.9861111111111112, 0.9848320693391116, 0.9861995753715499, 0.9862142099681867, 0.9868421052631579, 0.9894291754756871, 0.9851063829787234, 0.9817007534983854, 0.9830508474576272, 0.9847161572052402, 0.9882854100106496, 0.9872476089266737, 0.990301724137931, 0.9835886214442013, 0.9861995753715499, 0.9850267379679144, 0.9820675105485233, 0.9870689655172413, 0.9823284823284824, 0.9853095487932844, 0.9851222104144527, 0.9869989165763814]
after delete: len(clean_dataset) 923
after delete: len(noisy_dataset) 693
epoch [100/200] batch [5/28] time 0.257 (0.269) data 0.095 (0.109) loss_x loss_x 0.6270 (0.6000) acc_x 87.5000 (83.7500) lr 1.0314e-03 eta 0:00:06
epoch [100/200] batch [10/28] time 0.261 (0.265) data 0.101 (0.105) loss_x loss_x 0.3398 (0.5976) acc_x 90.6250 (83.7500) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [15/28] time 0.247 (0.260) data 0.086 (0.099) loss_x loss_x 0.7500 (0.6255) acc_x 71.8750 (82.2917) lr 1.0314e-03 eta 0:00:03
epoch [100/200] batch [20/28] time 0.268 (0.259) data 0.107 (0.098) loss_x loss_x 0.8242 (0.6286) acc_x 75.0000 (82.0312) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [25/28] time 0.248 (0.258) data 0.087 (0.097) loss_x loss_x 0.4880 (0.6101) acc_x 87.5000 (82.6250) lr 1.0314e-03 eta 0:00:00
epoch [100/200] batch [5/21] time 0.276 (0.258) data 0.112 (0.101) loss_u loss_u 0.7207 (0.7634) acc_u 31.2500 (26.8750) lr 1.0314e-03 eta 0:00:04
epoch [100/200] batch [10/21] time 0.257 (0.258) data 0.090 (0.100) loss_u loss_u 0.8315 (0.7705) acc_u 18.7500 (25.6250) lr 1.0314e-03 eta 0:00:02
epoch [100/200] batch [15/21] time 0.298 (0.262) data 0.135 (0.103) loss_u loss_u 0.6968 (0.7737) acc_u 31.2500 (25.4167) lr 1.0314e-03 eta 0:00:01
epoch [100/200] batch [20/21] time 0.266 (0.264) data 0.106 (0.104) loss_u loss_u 0.6992 (0.7757) acc_u 37.5000 (25.4688) lr 1.0314e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.5804, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 938
clean true:928
clean false:10
clean_rate:0.9893390191897654
noisy true:262
noisy false:416
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 678
epoch [101/200] batch [5/29] time 0.261 (0.269) data 0.098 (0.105) loss_x loss_x 0.4978 (0.5868) acc_x 90.6250 (85.0000) lr 1.0157e-03 eta 0:00:06
epoch [101/200] batch [10/29] time 0.254 (0.263) data 0.090 (0.099) loss_x loss_x 0.5093 (0.5571) acc_x 90.6250 (86.2500) lr 1.0157e-03 eta 0:00:04
epoch [101/200] batch [15/29] time 0.178 (0.247) data 0.083 (0.098) loss_x loss_x 0.3843 (0.5455) acc_x 87.5000 (85.8333) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [20/29] time 0.268 (0.250) data 0.109 (0.099) loss_x loss_x 0.6172 (0.5383) acc_x 87.5000 (86.0938) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [25/29] time 0.245 (0.251) data 0.088 (0.098) loss_x loss_x 0.7783 (0.5315) acc_x 81.2500 (86.5000) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [5/21] time 0.265 (0.249) data 0.101 (0.098) loss_u loss_u 0.7817 (0.8317) acc_u 25.0000 (19.3750) lr 1.0157e-03 eta 0:00:03
epoch [101/200] batch [10/21] time 0.258 (0.251) data 0.095 (0.098) loss_u loss_u 0.7900 (0.7816) acc_u 25.0000 (25.0000) lr 1.0157e-03 eta 0:00:02
epoch [101/200] batch [15/21] time 0.263 (0.254) data 0.105 (0.100) loss_u loss_u 0.8784 (0.7885) acc_u 18.7500 (24.5833) lr 1.0157e-03 eta 0:00:01
epoch [101/200] batch [20/21] time 0.268 (0.255) data 0.111 (0.101) loss_u loss_u 0.7944 (0.7884) acc_u 28.1250 (24.5312) lr 1.0157e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 419
confident_label rate tensor(0.5873, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 949
clean true:933
clean false:16
clean_rate:0.9831401475237092
noisy true:264
noisy false:403
after delete: len(clean_dataset) 949
after delete: len(noisy_dataset) 667
epoch [102/200] batch [5/29] time 0.250 (0.275) data 0.087 (0.113) loss_x loss_x 0.6978 (0.7131) acc_x 78.1250 (79.3750) lr 1.0000e-03 eta 0:00:06
epoch [102/200] batch [10/29] time 0.274 (0.276) data 0.111 (0.115) loss_x loss_x 0.4756 (0.7482) acc_x 87.5000 (79.6875) lr 1.0000e-03 eta 0:00:05
epoch [102/200] batch [15/29] time 0.185 (0.265) data 0.108 (0.109) loss_x loss_x 0.9238 (0.7319) acc_x 78.1250 (80.6250) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [20/29] time 0.265 (0.255) data 0.105 (0.105) loss_x loss_x 1.0586 (0.7270) acc_x 75.0000 (80.9375) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [25/29] time 0.272 (0.258) data 0.111 (0.106) loss_x loss_x 0.5532 (0.6754) acc_x 84.3750 (82.5000) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [5/20] time 0.275 (0.261) data 0.108 (0.106) loss_u loss_u 0.7583 (0.7712) acc_u 28.1250 (26.8750) lr 1.0000e-03 eta 0:00:03
epoch [102/200] batch [10/20] time 0.277 (0.261) data 0.109 (0.105) loss_u loss_u 0.8169 (0.7754) acc_u 18.7500 (26.5625) lr 1.0000e-03 eta 0:00:02
epoch [102/200] batch [15/20] time 0.180 (0.258) data 0.103 (0.105) loss_u loss_u 0.8755 (0.7839) acc_u 12.5000 (25.4167) lr 1.0000e-03 eta 0:00:01
epoch [102/200] batch [20/20] time 0.280 (0.258) data 0.110 (0.104) loss_u loss_u 0.8740 (0.7998) acc_u 9.3750 (23.2812) lr 1.0000e-03 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 422
confident_label rate tensor(0.5835, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 943
clean true:930
clean false:13
clean_rate:0.9862142099681867
noisy true:264
noisy false:409
after delete: len(clean_dataset) 943
after delete: len(noisy_dataset) 673
epoch [103/200] batch [5/29] time 0.274 (0.264) data 0.109 (0.100) loss_x loss_x 0.8721 (0.5575) acc_x 81.2500 (87.5000) lr 9.8429e-04 eta 0:00:06
epoch [103/200] batch [10/29] time 0.288 (0.270) data 0.126 (0.107) loss_x loss_x 0.5098 (0.5971) acc_x 90.6250 (86.8750) lr 9.8429e-04 eta 0:00:05
epoch [103/200] batch [15/29] time 0.261 (0.258) data 0.102 (0.107) loss_x loss_x 0.5747 (0.5907) acc_x 84.3750 (85.8333) lr 9.8429e-04 eta 0:00:03
epoch [103/200] batch [20/29] time 0.269 (0.261) data 0.108 (0.107) loss_x loss_x 0.9102 (0.5883) acc_x 75.0000 (85.1562) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [25/29] time 0.273 (0.266) data 0.115 (0.112) loss_x loss_x 0.6870 (0.5867) acc_x 75.0000 (84.2500) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [5/21] time 0.222 (0.269) data 0.101 (0.113) loss_u loss_u 0.8804 (0.8204) acc_u 12.5000 (20.6250) lr 9.8429e-04 eta 0:00:04
epoch [103/200] batch [10/21] time 0.288 (0.266) data 0.123 (0.112) loss_u loss_u 0.7871 (0.8148) acc_u 28.1250 (21.2500) lr 9.8429e-04 eta 0:00:02
epoch [103/200] batch [15/21] time 0.260 (0.267) data 0.100 (0.111) loss_u loss_u 0.6670 (0.7993) acc_u 34.3750 (22.9167) lr 9.8429e-04 eta 0:00:01
epoch [103/200] batch [20/21] time 0.252 (0.265) data 0.084 (0.108) loss_u loss_u 0.8169 (0.7978) acc_u 18.7500 (22.9688) lr 9.8429e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 423
confident_label rate tensor(0.5848, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 945
clean true:929
clean false:16
clean_rate:0.9830687830687831
noisy true:264
noisy false:407
after delete: len(clean_dataset) 945
after delete: len(noisy_dataset) 671
epoch [104/200] batch [5/29] time 0.253 (0.254) data 0.086 (0.091) loss_x loss_x 1.1182 (0.5625) acc_x 78.1250 (86.2500) lr 9.6859e-04 eta 0:00:06
epoch [104/200] batch [10/29] time 0.261 (0.239) data 0.085 (0.091) loss_x loss_x 0.4011 (0.5666) acc_x 90.6250 (84.6875) lr 9.6859e-04 eta 0:00:04
epoch [104/200] batch [15/29] time 0.273 (0.246) data 0.113 (0.094) loss_x loss_x 0.7100 (0.5711) acc_x 84.3750 (84.5833) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [20/29] time 0.284 (0.255) data 0.123 (0.101) loss_x loss_x 0.2440 (0.5734) acc_x 93.7500 (84.5312) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [25/29] time 0.265 (0.258) data 0.106 (0.103) loss_x loss_x 0.7134 (0.5669) acc_x 84.3750 (84.8750) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [5/20] time 0.264 (0.264) data 0.106 (0.107) loss_u loss_u 0.8477 (0.7861) acc_u 18.7500 (23.7500) lr 9.6859e-04 eta 0:00:03
epoch [104/200] batch [10/20] time 0.270 (0.259) data 0.109 (0.107) loss_u loss_u 0.7153 (0.7817) acc_u 31.2500 (24.6875) lr 9.6859e-04 eta 0:00:02
epoch [104/200] batch [15/20] time 0.254 (0.259) data 0.085 (0.105) loss_u loss_u 0.8115 (0.7848) acc_u 21.8750 (25.2083) lr 9.6859e-04 eta 0:00:01
epoch [104/200] batch [20/20] time 0.248 (0.258) data 0.086 (0.103) loss_u loss_u 0.8320 (0.7903) acc_u 15.6250 (24.3750) lr 9.6859e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 413
confident_label rate tensor(0.5910, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 955
clean true:937
clean false:18
clean_rate:0.981151832460733
noisy true:266
noisy false:395
after delete: len(clean_dataset) 955
after delete: len(noisy_dataset) 661
epoch [105/200] batch [5/29] time 0.320 (0.282) data 0.158 (0.120) loss_x loss_x 0.4558 (0.5344) acc_x 84.3750 (85.0000) lr 9.5289e-04 eta 0:00:06
epoch [105/200] batch [10/29] time 0.261 (0.276) data 0.096 (0.113) loss_x loss_x 0.8140 (0.5811) acc_x 81.2500 (84.3750) lr 9.5289e-04 eta 0:00:05
epoch [105/200] batch [15/29] time 0.235 (0.259) data 0.100 (0.110) loss_x loss_x 0.6479 (0.5622) acc_x 78.1250 (85.0000) lr 9.5289e-04 eta 0:00:03
epoch [105/200] batch [20/29] time 0.258 (0.261) data 0.094 (0.108) loss_x loss_x 0.9692 (0.6229) acc_x 78.1250 (83.2812) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [25/29] time 0.253 (0.263) data 0.087 (0.108) loss_x loss_x 0.7930 (0.6230) acc_x 75.0000 (83.7500) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [5/20] time 0.278 (0.267) data 0.110 (0.110) loss_u loss_u 0.7764 (0.7913) acc_u 28.1250 (23.7500) lr 9.5289e-04 eta 0:00:04
epoch [105/200] batch [10/20] time 0.341 (0.268) data 0.172 (0.109) loss_u loss_u 0.7456 (0.8096) acc_u 28.1250 (21.5625) lr 9.5289e-04 eta 0:00:02
epoch [105/200] batch [15/20] time 0.273 (0.264) data 0.111 (0.110) loss_u loss_u 0.8120 (0.7930) acc_u 18.7500 (23.1250) lr 9.5289e-04 eta 0:00:01
epoch [105/200] batch [20/20] time 0.270 (0.265) data 0.109 (0.110) loss_u loss_u 0.8237 (0.7956) acc_u 21.8750 (23.2812) lr 9.5289e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 419
confident_label rate tensor(0.5823, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 941
clean true:928
clean false:13
clean_rate:0.9861849096705633
noisy true:269
noisy false:406
after delete: len(clean_dataset) 941
after delete: len(noisy_dataset) 675
epoch [106/200] batch [5/29] time 0.273 (0.265) data 0.107 (0.104) loss_x loss_x 0.3562 (0.5508) acc_x 90.6250 (85.0000) lr 9.3721e-04 eta 0:00:06
epoch [106/200] batch [10/29] time 0.271 (0.265) data 0.108 (0.102) loss_x loss_x 0.8052 (0.5575) acc_x 84.3750 (85.9375) lr 9.3721e-04 eta 0:00:05
epoch [106/200] batch [15/29] time 0.181 (0.261) data 0.104 (0.104) loss_x loss_x 0.9604 (0.6001) acc_x 65.6250 (84.5833) lr 9.3721e-04 eta 0:00:03
epoch [106/200] batch [20/29] time 0.256 (0.261) data 0.090 (0.106) loss_x loss_x 0.4612 (0.5693) acc_x 90.6250 (85.4688) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [25/29] time 0.255 (0.261) data 0.090 (0.104) loss_x loss_x 0.8809 (0.5834) acc_x 81.2500 (85.2500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [5/21] time 0.285 (0.265) data 0.117 (0.106) loss_u loss_u 0.6592 (0.8164) acc_u 37.5000 (21.8750) lr 9.3721e-04 eta 0:00:04
epoch [106/200] batch [10/21] time 0.247 (0.265) data 0.081 (0.106) loss_u loss_u 0.7671 (0.7822) acc_u 28.1250 (24.6875) lr 9.3721e-04 eta 0:00:02
epoch [106/200] batch [15/21] time 0.197 (0.262) data 0.106 (0.107) loss_u loss_u 0.7715 (0.7680) acc_u 28.1250 (26.2500) lr 9.3721e-04 eta 0:00:01
epoch [106/200] batch [20/21] time 0.349 (0.266) data 0.182 (0.110) loss_u loss_u 0.7373 (0.7768) acc_u 28.1250 (25.4688) lr 9.3721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 397
confident_label rate tensor(0.5965, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 964
clean true:949
clean false:15
clean_rate:0.9844398340248963
noisy true:270
noisy false:382
after delete: len(clean_dataset) 964
after delete: len(noisy_dataset) 652
epoch [107/200] batch [5/30] time 0.265 (0.258) data 0.110 (0.098) loss_x loss_x 0.6533 (0.6840) acc_x 81.2500 (82.5000) lr 9.2154e-04 eta 0:00:06
epoch [107/200] batch [10/30] time 0.261 (0.263) data 0.098 (0.102) loss_x loss_x 0.8613 (0.7575) acc_x 78.1250 (80.0000) lr 9.2154e-04 eta 0:00:05
epoch [107/200] batch [15/30] time 0.284 (0.263) data 0.207 (0.108) loss_x loss_x 0.9800 (0.7439) acc_x 78.1250 (80.8333) lr 9.2154e-04 eta 0:00:03
epoch [107/200] batch [20/30] time 0.322 (0.272) data 0.158 (0.115) loss_x loss_x 0.4578 (0.6946) acc_x 90.6250 (82.1875) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [25/30] time 0.256 (0.272) data 0.092 (0.114) loss_x loss_x 0.9805 (0.6795) acc_x 78.1250 (82.6250) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [30/30] time 0.268 (0.271) data 0.109 (0.113) loss_x loss_x 0.5679 (0.6841) acc_x 75.0000 (82.7083) lr 9.2154e-04 eta 0:00:00
epoch [107/200] batch [5/20] time 0.277 (0.273) data 0.116 (0.113) loss_u loss_u 0.8223 (0.8146) acc_u 18.7500 (23.1250) lr 9.2154e-04 eta 0:00:04
epoch [107/200] batch [10/20] time 0.167 (0.272) data 0.089 (0.116) loss_u loss_u 0.8633 (0.8043) acc_u 15.6250 (23.4375) lr 9.2154e-04 eta 0:00:02
epoch [107/200] batch [15/20] time 0.292 (0.271) data 0.124 (0.114) loss_u loss_u 0.8330 (0.8112) acc_u 21.8750 (22.9167) lr 9.2154e-04 eta 0:00:01
epoch [107/200] batch [20/20] time 0.254 (0.271) data 0.087 (0.113) loss_u loss_u 0.8662 (0.8137) acc_u 15.6250 (22.3438) lr 9.2154e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 419
confident_label rate tensor(0.5743, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 928
clean true:917
clean false:11
clean_rate:0.9881465517241379
noisy true:280
noisy false:408
after delete: len(clean_dataset) 928
after delete: len(noisy_dataset) 688
epoch [108/200] batch [5/29] time 0.271 (0.275) data 0.111 (0.115) loss_x loss_x 0.1927 (0.5143) acc_x 96.8750 (85.0000) lr 9.0589e-04 eta 0:00:06
epoch [108/200] batch [10/29] time 0.271 (0.266) data 0.107 (0.118) loss_x loss_x 0.6548 (0.5108) acc_x 81.2500 (85.0000) lr 9.0589e-04 eta 0:00:05
epoch [108/200] batch [15/29] time 0.274 (0.268) data 0.108 (0.115) loss_x loss_x 0.7007 (0.5272) acc_x 84.3750 (86.4583) lr 9.0589e-04 eta 0:00:03
epoch [108/200] batch [20/29] time 0.278 (0.270) data 0.110 (0.113) loss_x loss_x 0.8286 (0.5305) acc_x 71.8750 (86.2500) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [25/29] time 0.270 (0.273) data 0.105 (0.115) loss_x loss_x 0.5933 (0.5476) acc_x 84.3750 (85.5000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [5/21] time 0.269 (0.269) data 0.106 (0.112) loss_u loss_u 0.7935 (0.8367) acc_u 21.8750 (18.7500) lr 9.0589e-04 eta 0:00:04
epoch [108/200] batch [10/21] time 0.258 (0.270) data 0.096 (0.112) loss_u loss_u 0.7827 (0.8137) acc_u 25.0000 (21.8750) lr 9.0589e-04 eta 0:00:02
epoch [108/200] batch [15/21] time 0.274 (0.271) data 0.110 (0.113) loss_u loss_u 0.8228 (0.7841) acc_u 21.8750 (25.0000) lr 9.0589e-04 eta 0:00:01
epoch [108/200] batch [20/21] time 0.257 (0.271) data 0.089 (0.112) loss_u loss_u 0.8013 (0.7849) acc_u 21.8750 (24.5312) lr 9.0589e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 397
confident_label rate tensor(0.5922, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 957
clean true:949
clean false:8
clean_rate:0.9916405433646813
noisy true:270
noisy false:389
after delete: len(clean_dataset) 957
after delete: len(noisy_dataset) 659
epoch [109/200] batch [5/29] time 0.260 (0.268) data 0.098 (0.107) loss_x loss_x 0.2294 (0.4383) acc_x 100.0000 (89.3750) lr 8.9027e-04 eta 0:00:06
epoch [109/200] batch [10/29] time 0.265 (0.265) data 0.106 (0.104) loss_x loss_x 0.7168 (0.5463) acc_x 81.2500 (86.2500) lr 8.9027e-04 eta 0:00:05
epoch [109/200] batch [15/29] time 0.216 (0.259) data 0.139 (0.104) loss_x loss_x 0.4773 (0.6068) acc_x 84.3750 (84.5833) lr 8.9027e-04 eta 0:00:03
epoch [109/200] batch [20/29] time 0.264 (0.261) data 0.101 (0.102) loss_x loss_x 0.4688 (0.5936) acc_x 87.5000 (84.3750) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [25/29] time 0.270 (0.266) data 0.106 (0.107) loss_x loss_x 0.4795 (0.5767) acc_x 84.3750 (84.6250) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [5/20] time 0.270 (0.268) data 0.100 (0.107) loss_u loss_u 0.8057 (0.7727) acc_u 25.0000 (26.8750) lr 8.9027e-04 eta 0:00:04
epoch [109/200] batch [10/20] time 0.268 (0.269) data 0.103 (0.107) loss_u loss_u 0.8584 (0.7898) acc_u 15.6250 (24.6875) lr 8.9027e-04 eta 0:00:02
epoch [109/200] batch [15/20] time 0.275 (0.264) data 0.106 (0.106) loss_u loss_u 0.8770 (0.8132) acc_u 15.6250 (21.6667) lr 8.9027e-04 eta 0:00:01
epoch [109/200] batch [20/20] time 0.260 (0.265) data 0.092 (0.106) loss_u loss_u 0.8745 (0.8077) acc_u 12.5000 (22.1875) lr 8.9027e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 408
confident_label rate tensor(0.5873, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 949
clean true:933
clean false:16
clean_rate:0.9831401475237092
noisy true:275
noisy false:392
after delete: len(clean_dataset) 949
after delete: len(noisy_dataset) 667
epoch [110/200] batch [5/29] time 0.279 (0.252) data 0.121 (0.106) loss_x loss_x 0.3120 (0.5161) acc_x 96.8750 (85.6250) lr 8.7467e-04 eta 0:00:06
epoch [110/200] batch [10/29] time 0.319 (0.264) data 0.158 (0.110) loss_x loss_x 0.6245 (0.5790) acc_x 81.2500 (84.0625) lr 8.7467e-04 eta 0:00:05
epoch [110/200] batch [15/29] time 0.256 (0.265) data 0.094 (0.108) loss_x loss_x 0.5723 (0.5917) acc_x 81.2500 (83.5417) lr 8.7467e-04 eta 0:00:03
epoch [110/200] batch [20/29] time 0.269 (0.270) data 0.108 (0.113) loss_x loss_x 0.3870 (0.5813) acc_x 96.8750 (84.5312) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [25/29] time 0.317 (0.272) data 0.153 (0.113) loss_x loss_x 0.5303 (0.5564) acc_x 87.5000 (85.2500) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [5/20] time 0.276 (0.269) data 0.111 (0.113) loss_u loss_u 0.8003 (0.7913) acc_u 21.8750 (23.1250) lr 8.7467e-04 eta 0:00:04
epoch [110/200] batch [10/20] time 0.320 (0.271) data 0.152 (0.115) loss_u loss_u 0.9102 (0.8257) acc_u 9.3750 (19.3750) lr 8.7467e-04 eta 0:00:02
epoch [110/200] batch [15/20] time 0.261 (0.271) data 0.096 (0.113) loss_u loss_u 0.7812 (0.8030) acc_u 21.8750 (22.7083) lr 8.7467e-04 eta 0:00:01
epoch [110/200] batch [20/20] time 0.285 (0.271) data 0.117 (0.112) loss_u loss_u 0.9092 (0.8083) acc_u 9.3750 (21.5625) lr 8.7467e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 429
confident_label rate tensor(0.5835, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 943
clean true:930
clean false:13
clean_rate:0.9862142099681867
noisy true:257
noisy false:416
after delete: len(clean_dataset) 943
after delete: len(noisy_dataset) 673
epoch [111/200] batch [5/29] time 0.268 (0.264) data 0.108 (0.103) loss_x loss_x 0.4270 (0.5533) acc_x 87.5000 (87.5000) lr 8.5910e-04 eta 0:00:06
epoch [111/200] batch [10/29] time 0.175 (0.252) data 0.098 (0.099) loss_x loss_x 0.8994 (0.5880) acc_x 81.2500 (85.0000) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [15/29] time 0.258 (0.252) data 0.099 (0.099) loss_x loss_x 0.4343 (0.5809) acc_x 90.6250 (84.3750) lr 8.5910e-04 eta 0:00:03
epoch [111/200] batch [20/29] time 0.258 (0.256) data 0.103 (0.102) loss_x loss_x 0.4265 (0.5659) acc_x 90.6250 (84.8438) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [25/29] time 0.259 (0.258) data 0.100 (0.103) loss_x loss_x 0.5781 (0.5740) acc_x 87.5000 (84.8750) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [5/21] time 0.297 (0.262) data 0.135 (0.107) loss_u loss_u 0.7080 (0.7702) acc_u 37.5000 (26.8750) lr 8.5910e-04 eta 0:00:04
epoch [111/200] batch [10/21] time 0.262 (0.264) data 0.097 (0.108) loss_u loss_u 0.7852 (0.7652) acc_u 25.0000 (27.8125) lr 8.5910e-04 eta 0:00:02
epoch [111/200] batch [15/21] time 0.269 (0.265) data 0.104 (0.107) loss_u loss_u 0.8516 (0.7878) acc_u 12.5000 (25.0000) lr 8.5910e-04 eta 0:00:01
epoch [111/200] batch [20/21] time 0.266 (0.263) data 0.097 (0.107) loss_u loss_u 0.7329 (0.7899) acc_u 31.2500 (24.5312) lr 8.5910e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 397
confident_label rate tensor(0.5916, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 956
clean true:945
clean false:11
clean_rate:0.9884937238493724
noisy true:274
noisy false:386
after delete: len(clean_dataset) 956
after delete: len(noisy_dataset) 660
epoch [112/200] batch [5/29] time 0.280 (0.287) data 0.117 (0.126) loss_x loss_x 0.5845 (0.4794) acc_x 90.6250 (88.1250) lr 8.4357e-04 eta 0:00:06
epoch [112/200] batch [10/29] time 0.268 (0.275) data 0.109 (0.120) loss_x loss_x 0.4590 (0.5126) acc_x 84.3750 (86.2500) lr 8.4357e-04 eta 0:00:05
epoch [112/200] batch [15/29] time 0.299 (0.277) data 0.142 (0.120) loss_x loss_x 0.6260 (0.5686) acc_x 75.0000 (84.1667) lr 8.4357e-04 eta 0:00:03
epoch [112/200] batch [20/29] time 0.269 (0.279) data 0.105 (0.120) loss_x loss_x 0.5166 (0.5586) acc_x 84.3750 (84.0625) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [25/29] time 0.169 (0.276) data 0.092 (0.120) loss_x loss_x 0.4465 (0.5714) acc_x 90.6250 (84.0000) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [5/20] time 0.274 (0.278) data 0.109 (0.121) loss_u loss_u 0.7290 (0.7884) acc_u 31.2500 (24.3750) lr 8.4357e-04 eta 0:00:04
epoch [112/200] batch [10/20] time 0.270 (0.279) data 0.107 (0.120) loss_u loss_u 0.8101 (0.7873) acc_u 25.0000 (24.6875) lr 8.4357e-04 eta 0:00:02
epoch [112/200] batch [15/20] time 0.187 (0.276) data 0.110 (0.119) loss_u loss_u 0.8232 (0.8004) acc_u 21.8750 (22.9167) lr 8.4357e-04 eta 0:00:01
epoch [112/200] batch [20/20] time 0.275 (0.277) data 0.110 (0.118) loss_u loss_u 0.7529 (0.7991) acc_u 28.1250 (23.1250) lr 8.4357e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 418
confident_label rate tensor(0.5854, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 946
clean true:930
clean false:16
clean_rate:0.9830866807610994
noisy true:268
noisy false:402
after delete: len(clean_dataset) 946
after delete: len(noisy_dataset) 670
epoch [113/200] batch [5/29] time 0.289 (0.280) data 0.127 (0.115) loss_x loss_x 0.5767 (0.6691) acc_x 90.6250 (83.7500) lr 8.2807e-04 eta 0:00:06
epoch [113/200] batch [10/29] time 0.278 (0.277) data 0.115 (0.114) loss_x loss_x 0.6289 (0.6608) acc_x 81.2500 (83.4375) lr 8.2807e-04 eta 0:00:05
epoch [113/200] batch [15/29] time 0.268 (0.276) data 0.105 (0.113) loss_x loss_x 0.4949 (0.6181) acc_x 90.6250 (84.7917) lr 8.2807e-04 eta 0:00:03
epoch [113/200] batch [20/29] time 0.281 (0.276) data 0.117 (0.112) loss_x loss_x 1.3018 (0.6395) acc_x 78.1250 (84.6875) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [25/29] time 0.263 (0.273) data 0.110 (0.110) loss_x loss_x 0.4038 (0.6261) acc_x 93.7500 (85.2500) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [5/20] time 0.276 (0.267) data 0.109 (0.108) loss_u loss_u 0.8242 (0.8112) acc_u 18.7500 (21.2500) lr 8.2807e-04 eta 0:00:04
epoch [113/200] batch [10/20] time 0.288 (0.269) data 0.120 (0.109) loss_u loss_u 0.7974 (0.8089) acc_u 25.0000 (21.5625) lr 8.2807e-04 eta 0:00:02
epoch [113/200] batch [15/20] time 0.259 (0.267) data 0.092 (0.106) loss_u loss_u 0.7197 (0.8018) acc_u 31.2500 (22.2917) lr 8.2807e-04 eta 0:00:01
epoch [113/200] batch [20/20] time 0.259 (0.267) data 0.090 (0.105) loss_u loss_u 0.8887 (0.7980) acc_u 12.5000 (22.8125) lr 8.2807e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 442
confident_label rate tensor(0.5817, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 940
clean true:925
clean false:15
clean_rate:0.9840425531914894
noisy true:249
noisy false:427
after delete: len(clean_dataset) 940
after delete: len(noisy_dataset) 676
epoch [114/200] batch [5/29] time 0.270 (0.274) data 0.109 (0.113) loss_x loss_x 1.2490 (0.6265) acc_x 65.6250 (81.8750) lr 8.1262e-04 eta 0:00:06
epoch [114/200] batch [10/29] time 0.267 (0.275) data 0.109 (0.114) loss_x loss_x 0.3630 (0.6099) acc_x 90.6250 (83.7500) lr 8.1262e-04 eta 0:00:05
epoch [114/200] batch [15/29] time 0.283 (0.261) data 0.122 (0.111) loss_x loss_x 0.6436 (0.5833) acc_x 81.2500 (84.1667) lr 8.1262e-04 eta 0:00:03
epoch [114/200] batch [20/29] time 0.288 (0.265) data 0.122 (0.111) loss_x loss_x 0.3545 (0.5675) acc_x 87.5000 (84.2188) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [25/29] time 0.280 (0.267) data 0.115 (0.111) loss_x loss_x 0.8218 (0.6088) acc_x 78.1250 (83.5000) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [5/21] time 0.276 (0.271) data 0.109 (0.112) loss_u loss_u 0.5952 (0.7210) acc_u 46.8750 (33.1250) lr 8.1262e-04 eta 0:00:04
epoch [114/200] batch [10/21] time 0.161 (0.267) data 0.083 (0.112) loss_u loss_u 0.8311 (0.7709) acc_u 21.8750 (26.2500) lr 8.1262e-04 eta 0:00:02
epoch [114/200] batch [15/21] time 0.279 (0.268) data 0.108 (0.112) loss_u loss_u 0.8462 (0.7833) acc_u 18.7500 (24.1667) lr 8.1262e-04 eta 0:00:01
epoch [114/200] batch [20/21] time 0.328 (0.270) data 0.157 (0.112) loss_u loss_u 0.7500 (0.7794) acc_u 28.1250 (24.6875) lr 8.1262e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 411
confident_label rate tensor(0.5854, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 946
clean true:933
clean false:13
clean_rate:0.9862579281183932
noisy true:272
noisy false:398
after delete: len(clean_dataset) 946
after delete: len(noisy_dataset) 670
epoch [115/200] batch [5/29] time 0.318 (0.302) data 0.157 (0.141) loss_x loss_x 0.3608 (0.4041) acc_x 87.5000 (89.3750) lr 7.9721e-04 eta 0:00:07
epoch [115/200] batch [10/29] time 0.289 (0.304) data 0.127 (0.142) loss_x loss_x 0.3374 (0.4765) acc_x 93.7500 (88.1250) lr 7.9721e-04 eta 0:00:05
epoch [115/200] batch [15/29] time 0.252 (0.276) data 0.084 (0.125) loss_x loss_x 0.6104 (0.5171) acc_x 90.6250 (87.2917) lr 7.9721e-04 eta 0:00:03
epoch [115/200] batch [20/29] time 0.261 (0.274) data 0.100 (0.120) loss_x loss_x 0.6860 (0.5116) acc_x 84.3750 (87.3438) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [25/29] time 0.289 (0.272) data 0.125 (0.116) loss_x loss_x 0.7397 (0.5634) acc_x 78.1250 (85.3750) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [5/20] time 0.316 (0.272) data 0.147 (0.113) loss_u loss_u 0.8179 (0.7840) acc_u 25.0000 (27.5000) lr 7.9721e-04 eta 0:00:04
epoch [115/200] batch [10/20] time 0.260 (0.273) data 0.141 (0.114) loss_u loss_u 0.7461 (0.7775) acc_u 28.1250 (27.1875) lr 7.9721e-04 eta 0:00:02
epoch [115/200] batch [15/20] time 0.269 (0.269) data 0.108 (0.113) loss_u loss_u 0.8042 (0.7918) acc_u 18.7500 (25.0000) lr 7.9721e-04 eta 0:00:01
epoch [115/200] batch [20/20] time 0.274 (0.269) data 0.107 (0.112) loss_u loss_u 0.7197 (0.7867) acc_u 34.3750 (25.4688) lr 7.9721e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 403
confident_label rate tensor(0.5860, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 947
clean true:935
clean false:12
clean_rate:0.9873284054910243
noisy true:278
noisy false:391
after delete: len(clean_dataset) 947
after delete: len(noisy_dataset) 669
epoch [116/200] batch [5/29] time 0.270 (0.277) data 0.112 (0.115) loss_x loss_x 0.6733 (0.5567) acc_x 75.0000 (85.0000) lr 7.8186e-04 eta 0:00:06
epoch [116/200] batch [10/29] time 0.261 (0.295) data 0.098 (0.135) loss_x loss_x 0.4641 (0.5368) acc_x 87.5000 (85.3125) lr 7.8186e-04 eta 0:00:05
epoch [116/200] batch [15/29] time 0.261 (0.291) data 0.098 (0.130) loss_x loss_x 0.8018 (0.6007) acc_x 75.0000 (84.3750) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [20/29] time 0.279 (0.278) data 0.114 (0.126) loss_x loss_x 0.4263 (0.5756) acc_x 93.7500 (85.3125) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [25/29] time 0.275 (0.278) data 0.108 (0.123) loss_x loss_x 0.9170 (0.5847) acc_x 75.0000 (84.7500) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [5/20] time 0.261 (0.279) data 0.089 (0.122) loss_u loss_u 0.7397 (0.7743) acc_u 28.1250 (23.1250) lr 7.8186e-04 eta 0:00:04
epoch [116/200] batch [10/20] time 0.280 (0.277) data 0.112 (0.118) loss_u loss_u 0.8120 (0.7837) acc_u 25.0000 (23.4375) lr 7.8186e-04 eta 0:00:02
epoch [116/200] batch [15/20] time 0.184 (0.274) data 0.107 (0.116) loss_u loss_u 0.8271 (0.7970) acc_u 21.8750 (22.0833) lr 7.8186e-04 eta 0:00:01
epoch [116/200] batch [20/20] time 0.273 (0.273) data 0.103 (0.115) loss_u loss_u 0.7852 (0.7865) acc_u 21.8750 (23.1250) lr 7.8186e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 426
confident_label rate tensor(0.5879, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 950
clean true:932
clean false:18
clean_rate:0.9810526315789474
noisy true:258
noisy false:408
after delete: len(clean_dataset) 950
after delete: len(noisy_dataset) 666
epoch [117/200] batch [5/29] time 0.252 (0.257) data 0.088 (0.096) loss_x loss_x 0.7222 (0.7129) acc_x 84.3750 (83.7500) lr 7.6655e-04 eta 0:00:06
epoch [117/200] batch [10/29] time 0.272 (0.262) data 0.112 (0.101) loss_x loss_x 0.7349 (0.5910) acc_x 81.2500 (85.3125) lr 7.6655e-04 eta 0:00:04
epoch [117/200] batch [15/29] time 0.264 (0.262) data 0.102 (0.101) loss_x loss_x 0.5474 (0.5626) acc_x 87.5000 (85.2083) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [20/29] time 0.252 (0.253) data 0.091 (0.100) loss_x loss_x 0.2681 (0.5763) acc_x 90.6250 (84.6875) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [25/29] time 0.277 (0.256) data 0.119 (0.102) loss_x loss_x 0.8042 (0.5797) acc_x 81.2500 (85.0000) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [5/20] time 0.267 (0.257) data 0.108 (0.101) loss_u loss_u 0.8408 (0.7855) acc_u 18.7500 (25.0000) lr 7.6655e-04 eta 0:00:03
epoch [117/200] batch [10/20] time 0.196 (0.256) data 0.106 (0.103) loss_u loss_u 0.5981 (0.7726) acc_u 43.7500 (26.5625) lr 7.6655e-04 eta 0:00:02
epoch [117/200] batch [15/20] time 0.262 (0.258) data 0.100 (0.103) loss_u loss_u 0.8804 (0.7936) acc_u 15.6250 (24.1667) lr 7.6655e-04 eta 0:00:01
epoch [117/200] batch [20/20] time 0.280 (0.260) data 0.109 (0.104) loss_u loss_u 0.7539 (0.7950) acc_u 31.2500 (24.0625) lr 7.6655e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 420
confident_label rate tensor(0.5879, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 950
clean true:930
clean false:20
clean_rate:0.9789473684210527
noisy true:266
noisy false:400
after delete: len(clean_dataset) 950
after delete: len(noisy_dataset) 666
epoch [118/200] batch [5/29] time 0.275 (0.266) data 0.113 (0.106) loss_x loss_x 0.4314 (0.5625) acc_x 84.3750 (85.6250) lr 7.5131e-04 eta 0:00:06
epoch [118/200] batch [10/29] time 0.290 (0.278) data 0.132 (0.118) loss_x loss_x 0.6836 (0.6060) acc_x 87.5000 (85.6250) lr 7.5131e-04 eta 0:00:05
epoch [118/200] batch [15/29] time 0.305 (0.279) data 0.146 (0.119) loss_x loss_x 0.5005 (0.5857) acc_x 87.5000 (85.6250) lr 7.5131e-04 eta 0:00:03
epoch [118/200] batch [20/29] time 0.311 (0.273) data 0.151 (0.121) loss_x loss_x 0.5420 (0.5951) acc_x 96.8750 (85.7812) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [25/29] time 0.265 (0.275) data 0.107 (0.121) loss_x loss_x 0.6997 (0.6038) acc_x 81.2500 (85.3750) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [5/20] time 0.287 (0.280) data 0.128 (0.123) loss_u loss_u 0.8213 (0.7702) acc_u 21.8750 (27.5000) lr 7.5131e-04 eta 0:00:04
epoch [118/200] batch [10/20] time 0.201 (0.276) data 0.109 (0.121) loss_u loss_u 0.7690 (0.7842) acc_u 21.8750 (23.7500) lr 7.5131e-04 eta 0:00:02
epoch [118/200] batch [15/20] time 0.269 (0.274) data 0.108 (0.120) loss_u loss_u 0.8369 (0.7910) acc_u 18.7500 (23.5417) lr 7.5131e-04 eta 0:00:01
epoch [118/200] batch [20/20] time 0.271 (0.276) data 0.106 (0.120) loss_u loss_u 0.7354 (0.7852) acc_u 34.3750 (24.3750) lr 7.5131e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 413
confident_label rate tensor(0.5928, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 958
clean true:942
clean false:16
clean_rate:0.9832985386221295
noisy true:261
noisy false:397
after delete: len(clean_dataset) 958
after delete: len(noisy_dataset) 658
epoch [119/200] batch [5/29] time 0.275 (0.267) data 0.114 (0.107) loss_x loss_x 0.5933 (0.4823) acc_x 81.2500 (87.5000) lr 7.3613e-04 eta 0:00:06
epoch [119/200] batch [10/29] time 0.269 (0.263) data 0.111 (0.103) loss_x loss_x 0.7114 (0.5915) acc_x 84.3750 (86.5625) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [15/29] time 0.261 (0.265) data 0.102 (0.105) loss_x loss_x 0.5454 (0.6369) acc_x 87.5000 (85.4167) lr 7.3613e-04 eta 0:00:03
epoch [119/200] batch [20/29] time 0.290 (0.264) data 0.130 (0.104) loss_x loss_x 0.7529 (0.6367) acc_x 84.3750 (85.3125) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [25/29] time 0.276 (0.262) data 0.108 (0.106) loss_x loss_x 0.4636 (0.6382) acc_x 87.5000 (84.8750) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [5/20] time 0.292 (0.269) data 0.126 (0.111) loss_u loss_u 0.9170 (0.8542) acc_u 12.5000 (15.6250) lr 7.3613e-04 eta 0:00:04
epoch [119/200] batch [10/20] time 0.273 (0.270) data 0.110 (0.112) loss_u loss_u 0.7363 (0.8091) acc_u 31.2500 (21.8750) lr 7.3613e-04 eta 0:00:02
epoch [119/200] batch [15/20] time 0.188 (0.267) data 0.111 (0.112) loss_u loss_u 0.7822 (0.8067) acc_u 25.0000 (22.5000) lr 7.3613e-04 eta 0:00:01
epoch [119/200] batch [20/20] time 0.278 (0.268) data 0.107 (0.112) loss_u loss_u 0.8145 (0.8120) acc_u 25.0000 (21.0938) lr 7.3613e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 419
confident_label rate tensor(0.5804, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 938
clean true:925
clean false:13
clean_rate:0.9861407249466951
noisy true:272
noisy false:406
after delete: len(clean_dataset) 938
after delete: len(noisy_dataset) 678
epoch [120/200] batch [5/29] time 0.260 (0.277) data 0.102 (0.113) loss_x loss_x 0.5488 (0.6597) acc_x 87.5000 (83.1250) lr 7.2101e-04 eta 0:00:06
epoch [120/200] batch [10/29] time 0.265 (0.272) data 0.104 (0.108) loss_x loss_x 0.5034 (0.6009) acc_x 84.3750 (83.4375) lr 7.2101e-04 eta 0:00:05
epoch [120/200] batch [15/29] time 0.285 (0.263) data 0.109 (0.109) loss_x loss_x 0.4216 (0.5817) acc_x 90.6250 (84.5833) lr 7.2101e-04 eta 0:00:03
epoch [120/200] batch [20/29] time 0.295 (0.264) data 0.137 (0.108) loss_x loss_x 0.8525 (0.6278) acc_x 78.1250 (83.4375) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [25/29] time 0.252 (0.264) data 0.088 (0.107) loss_x loss_x 0.4436 (0.5902) acc_x 87.5000 (84.5000) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [5/21] time 0.297 (0.266) data 0.131 (0.107) loss_u loss_u 0.6904 (0.7367) acc_u 34.3750 (29.3750) lr 7.2101e-04 eta 0:00:04
epoch [120/200] batch [10/21] time 0.289 (0.268) data 0.123 (0.109) loss_u loss_u 0.8711 (0.7594) acc_u 15.6250 (27.8125) lr 7.2101e-04 eta 0:00:02
epoch [120/200] batch [15/21] time 0.269 (0.265) data 0.108 (0.109) loss_u loss_u 0.7446 (0.7679) acc_u 28.1250 (26.4583) lr 7.2101e-04 eta 0:00:01
epoch [120/200] batch [20/21] time 0.270 (0.266) data 0.104 (0.109) loss_u loss_u 0.8506 (0.7816) acc_u 15.6250 (24.8438) lr 7.2101e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 388
confident_label rate tensor(0.6015, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 972
clean true:954
clean false:18
clean_rate:0.9814814814814815
noisy true:274
noisy false:370
after delete: len(clean_dataset) 972
after delete: len(noisy_dataset) 644
epoch [121/200] batch [5/30] time 0.267 (0.289) data 0.106 (0.124) loss_x loss_x 0.6191 (0.5738) acc_x 78.1250 (85.0000) lr 7.0596e-04 eta 0:00:07
epoch [121/200] batch [10/30] time 0.282 (0.281) data 0.117 (0.115) loss_x loss_x 0.6724 (0.5998) acc_x 84.3750 (83.7500) lr 7.0596e-04 eta 0:00:05
epoch [121/200] batch [15/30] time 0.266 (0.278) data 0.102 (0.113) loss_x loss_x 0.3013 (0.5439) acc_x 93.7500 (86.0417) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [20/30] time 0.262 (0.273) data 0.099 (0.109) loss_x loss_x 0.6323 (0.5289) acc_x 81.2500 (86.2500) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [25/30] time 0.190 (0.268) data 0.113 (0.109) loss_x loss_x 0.3306 (0.5213) acc_x 90.6250 (86.3750) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [30/30] time 0.278 (0.271) data 0.114 (0.112) loss_x loss_x 1.1289 (0.5466) acc_x 71.8750 (86.0417) lr 7.0596e-04 eta 0:00:00
epoch [121/200] batch [5/20] time 0.310 (0.274) data 0.145 (0.114) loss_u loss_u 0.8276 (0.8117) acc_u 18.7500 (21.2500) lr 7.0596e-04 eta 0:00:04
epoch [121/200] batch [10/20] time 0.281 (0.276) data 0.118 (0.116) loss_u loss_u 0.7939 (0.8141) acc_u 25.0000 (20.9375) lr 7.0596e-04 eta 0:00:02
epoch [121/200] batch [15/20] time 0.281 (0.279) data 0.118 (0.118) loss_u loss_u 0.8208 (0.7995) acc_u 18.7500 (22.2917) lr 7.0596e-04 eta 0:00:01
epoch [121/200] batch [20/20] time 0.176 (0.273) data 0.098 (0.115) loss_u loss_u 0.8081 (0.7966) acc_u 21.8750 (22.6562) lr 7.0596e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 417
confident_label rate tensor(0.5860, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 947
clean true:931
clean false:16
clean_rate:0.9831045406546991
noisy true:268
noisy false:401
after delete: len(clean_dataset) 947
after delete: len(noisy_dataset) 669
epoch [122/200] batch [5/29] time 0.274 (0.274) data 0.110 (0.111) loss_x loss_x 0.6479 (0.5822) acc_x 81.2500 (85.6250) lr 6.9098e-04 eta 0:00:06
epoch [122/200] batch [10/29] time 0.275 (0.288) data 0.112 (0.125) loss_x loss_x 0.7280 (0.5867) acc_x 78.1250 (84.6875) lr 6.9098e-04 eta 0:00:05
epoch [122/200] batch [15/29] time 0.337 (0.285) data 0.173 (0.123) loss_x loss_x 0.6401 (0.5739) acc_x 84.3750 (85.4167) lr 6.9098e-04 eta 0:00:03
epoch [122/200] batch [20/29] time 0.347 (0.285) data 0.183 (0.122) loss_x loss_x 0.3389 (0.5782) acc_x 90.6250 (85.6250) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [25/29] time 0.164 (0.274) data 0.087 (0.118) loss_x loss_x 0.8003 (0.5848) acc_x 78.1250 (85.3750) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [5/20] time 0.274 (0.279) data 0.109 (0.121) loss_u loss_u 0.7837 (0.7493) acc_u 21.8750 (29.3750) lr 6.9098e-04 eta 0:00:04
epoch [122/200] batch [10/20] time 0.310 (0.280) data 0.145 (0.121) loss_u loss_u 0.8286 (0.7712) acc_u 25.0000 (27.5000) lr 6.9098e-04 eta 0:00:02
epoch [122/200] batch [15/20] time 0.279 (0.279) data 0.110 (0.119) loss_u loss_u 0.6821 (0.7745) acc_u 34.3750 (26.4583) lr 6.9098e-04 eta 0:00:01
epoch [122/200] batch [20/20] time 0.187 (0.278) data 0.110 (0.120) loss_u loss_u 0.8413 (0.7776) acc_u 21.8750 (25.7812) lr 6.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 390
confident_label rate tensor(0.5910, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 955
clean true:945
clean false:10
clean_rate:0.9895287958115183
noisy true:281
noisy false:380
after delete: len(clean_dataset) 955
after delete: len(noisy_dataset) 661
epoch [123/200] batch [5/29] time 0.259 (0.240) data 0.099 (0.098) loss_x loss_x 0.3369 (0.4800) acc_x 90.6250 (86.8750) lr 6.7608e-04 eta 0:00:05
epoch [123/200] batch [10/29] time 0.266 (0.250) data 0.102 (0.097) loss_x loss_x 0.7812 (0.4994) acc_x 84.3750 (87.8125) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [15/29] time 0.277 (0.256) data 0.111 (0.100) loss_x loss_x 0.4016 (0.4726) acc_x 93.7500 (88.3333) lr 6.7608e-04 eta 0:00:03
epoch [123/200] batch [20/29] time 0.199 (0.256) data 0.122 (0.102) loss_x loss_x 0.8901 (0.5065) acc_x 71.8750 (86.8750) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [25/29] time 0.275 (0.262) data 0.114 (0.105) loss_x loss_x 0.6338 (0.5249) acc_x 84.3750 (86.3750) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [5/20] time 0.301 (0.269) data 0.135 (0.111) loss_u loss_u 0.7217 (0.8014) acc_u 34.3750 (23.1250) lr 6.7608e-04 eta 0:00:04
epoch [123/200] batch [10/20] time 0.269 (0.270) data 0.110 (0.111) loss_u loss_u 0.7178 (0.7822) acc_u 31.2500 (25.0000) lr 6.7608e-04 eta 0:00:02
epoch [123/200] batch [15/20] time 0.265 (0.271) data 0.107 (0.112) loss_u loss_u 0.7681 (0.7671) acc_u 25.0000 (26.0417) lr 6.7608e-04 eta 0:00:01
epoch [123/200] batch [20/20] time 0.274 (0.267) data 0.110 (0.111) loss_u loss_u 0.8276 (0.7761) acc_u 15.6250 (25.0000) lr 6.7608e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 400
confident_label rate tensor(0.5959, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 963
clean true:949
clean false:14
clean_rate:0.9854620976116303
noisy true:267
noisy false:386
after delete: len(clean_dataset) 963
after delete: len(noisy_dataset) 653
epoch [124/200] batch [5/30] time 0.254 (0.280) data 0.090 (0.117) loss_x loss_x 0.4333 (0.5440) acc_x 87.5000 (85.6250) lr 6.6126e-04 eta 0:00:06
epoch [124/200] batch [10/30] time 0.259 (0.274) data 0.095 (0.111) loss_x loss_x 1.0439 (0.6101) acc_x 68.7500 (82.5000) lr 6.6126e-04 eta 0:00:05
epoch [124/200] batch [15/30] time 0.227 (0.257) data 0.093 (0.108) loss_x loss_x 0.8042 (0.5979) acc_x 84.3750 (83.5417) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [20/30] time 0.252 (0.259) data 0.087 (0.106) loss_x loss_x 1.0117 (0.6152) acc_x 78.1250 (83.2812) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [25/30] time 0.263 (0.260) data 0.104 (0.105) loss_x loss_x 0.5078 (0.6118) acc_x 84.3750 (83.6250) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [30/30] time 0.261 (0.260) data 0.098 (0.104) loss_x loss_x 0.9648 (0.6228) acc_x 75.0000 (83.6458) lr 6.6126e-04 eta 0:00:00
epoch [124/200] batch [5/20] time 0.342 (0.263) data 0.175 (0.105) loss_u loss_u 0.7197 (0.7600) acc_u 34.3750 (28.1250) lr 6.6126e-04 eta 0:00:03
epoch [124/200] batch [10/20] time 0.193 (0.266) data 0.115 (0.109) loss_u loss_u 0.8452 (0.7934) acc_u 18.7500 (24.6875) lr 6.6126e-04 eta 0:00:02
epoch [124/200] batch [15/20] time 0.287 (0.266) data 0.122 (0.110) loss_u loss_u 0.6733 (0.7884) acc_u 34.3750 (25.4167) lr 6.6126e-04 eta 0:00:01
epoch [124/200] batch [20/20] time 0.325 (0.272) data 0.162 (0.115) loss_u loss_u 0.8823 (0.7867) acc_u 12.5000 (25.4688) lr 6.6126e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 394
confident_label rate tensor(0.5934, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 959
clean true:941
clean false:18
clean_rate:0.9812304483837331
noisy true:281
noisy false:376
after delete: len(clean_dataset) 959
after delete: len(noisy_dataset) 657
epoch [125/200] batch [5/29] time 0.273 (0.276) data 0.109 (0.112) loss_x loss_x 0.4158 (0.6527) acc_x 87.5000 (85.0000) lr 6.4653e-04 eta 0:00:06
epoch [125/200] batch [10/29] time 0.325 (0.284) data 0.160 (0.119) loss_x loss_x 0.2252 (0.5901) acc_x 96.8750 (86.5625) lr 6.4653e-04 eta 0:00:05
epoch [125/200] batch [15/29] time 0.271 (0.281) data 0.109 (0.117) loss_x loss_x 0.7612 (0.5728) acc_x 81.2500 (86.6667) lr 6.4653e-04 eta 0:00:03
epoch [125/200] batch [20/29] time 0.254 (0.278) data 0.092 (0.113) loss_x loss_x 0.8955 (0.6071) acc_x 71.8750 (85.3125) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [25/29] time 0.250 (0.268) data 0.083 (0.109) loss_x loss_x 0.6289 (0.5931) acc_x 87.5000 (85.7500) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [5/20] time 0.255 (0.267) data 0.085 (0.106) loss_u loss_u 0.8184 (0.7899) acc_u 21.8750 (25.6250) lr 6.4653e-04 eta 0:00:04
epoch [125/200] batch [10/20] time 0.261 (0.269) data 0.097 (0.107) loss_u loss_u 0.7856 (0.7818) acc_u 25.0000 (25.0000) lr 6.4653e-04 eta 0:00:02
epoch [125/200] batch [15/20] time 0.173 (0.264) data 0.093 (0.106) loss_u loss_u 0.7896 (0.7857) acc_u 25.0000 (25.4167) lr 6.4653e-04 eta 0:00:01
epoch [125/200] batch [20/20] time 0.265 (0.264) data 0.098 (0.105) loss_u loss_u 0.8916 (0.7925) acc_u 15.6250 (24.8438) lr 6.4653e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 389
confident_label rate tensor(0.6027, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 974
clean true:958
clean false:16
clean_rate:0.9835728952772074
noisy true:269
noisy false:373
after delete: len(clean_dataset) 974
after delete: len(noisy_dataset) 642
epoch [126/200] batch [5/30] time 0.270 (0.266) data 0.106 (0.103) loss_x loss_x 0.3914 (0.4362) acc_x 90.6250 (90.0000) lr 6.3188e-04 eta 0:00:06
epoch [126/200] batch [10/30] time 0.275 (0.267) data 0.112 (0.105) loss_x loss_x 0.1581 (0.3666) acc_x 100.0000 (91.2500) lr 6.3188e-04 eta 0:00:05
epoch [126/200] batch [15/30] time 0.185 (0.262) data 0.108 (0.106) loss_x loss_x 0.7158 (0.4318) acc_x 78.1250 (89.1667) lr 6.3188e-04 eta 0:00:03
epoch [126/200] batch [20/30] time 0.277 (0.266) data 0.114 (0.113) loss_x loss_x 0.8862 (0.4840) acc_x 65.6250 (87.0312) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [25/30] time 0.316 (0.270) data 0.153 (0.115) loss_x loss_x 0.5801 (0.5030) acc_x 84.3750 (86.6250) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [30/30] time 0.274 (0.273) data 0.111 (0.116) loss_x loss_x 0.7231 (0.5245) acc_x 81.2500 (85.8333) lr 6.3188e-04 eta 0:00:00
epoch [126/200] batch [5/20] time 0.328 (0.277) data 0.165 (0.119) loss_u loss_u 0.8359 (0.8130) acc_u 18.7500 (22.5000) lr 6.3188e-04 eta 0:00:04
epoch [126/200] batch [10/20] time 0.188 (0.274) data 0.111 (0.120) loss_u loss_u 0.7510 (0.7906) acc_u 31.2500 (25.0000) lr 6.3188e-04 eta 0:00:02
epoch [126/200] batch [15/20] time 0.275 (0.274) data 0.107 (0.119) loss_u loss_u 0.8428 (0.7908) acc_u 18.7500 (25.4167) lr 6.3188e-04 eta 0:00:01
epoch [126/200] batch [20/20] time 0.275 (0.275) data 0.117 (0.119) loss_u loss_u 0.8247 (0.7950) acc_u 21.8750 (25.0000) lr 6.3188e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 395
confident_label rate tensor(0.6064, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 980
clean true:963
clean false:17
clean_rate:0.9826530612244898
noisy true:258
noisy false:378
after delete: len(clean_dataset) 980
after delete: len(noisy_dataset) 636
epoch [127/200] batch [5/30] time 0.275 (0.260) data 0.109 (0.109) loss_x loss_x 0.5391 (0.6013) acc_x 84.3750 (85.6250) lr 6.1732e-04 eta 0:00:06
epoch [127/200] batch [10/30] time 0.270 (0.270) data 0.106 (0.113) loss_x loss_x 0.4941 (0.5831) acc_x 84.3750 (85.0000) lr 6.1732e-04 eta 0:00:05
epoch [127/200] batch [15/30] time 0.258 (0.273) data 0.096 (0.114) loss_x loss_x 0.5767 (0.5852) acc_x 84.3750 (85.4167) lr 6.1732e-04 eta 0:00:04
epoch [127/200] batch [20/30] time 0.241 (0.269) data 0.081 (0.110) loss_x loss_x 0.8281 (0.6348) acc_x 81.2500 (84.3750) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [25/30] time 0.247 (0.271) data 0.087 (0.111) loss_x loss_x 0.7944 (0.6388) acc_x 68.7500 (83.5000) lr 6.1732e-04 eta 0:00:01
epoch [127/200] batch [30/30] time 0.262 (0.262) data 0.097 (0.109) loss_x loss_x 0.4329 (0.6129) acc_x 87.5000 (84.3750) lr 6.1732e-04 eta 0:00:00
epoch [127/200] batch [5/19] time 0.270 (0.263) data 0.102 (0.107) loss_u loss_u 0.7471 (0.8172) acc_u 31.2500 (23.1250) lr 6.1732e-04 eta 0:00:03
epoch [127/200] batch [10/19] time 0.268 (0.266) data 0.104 (0.109) loss_u loss_u 0.7109 (0.8101) acc_u 34.3750 (24.3750) lr 6.1732e-04 eta 0:00:02
epoch [127/200] batch [15/19] time 0.351 (0.271) data 0.184 (0.113) loss_u loss_u 0.7554 (0.8072) acc_u 25.0000 (23.9583) lr 6.1732e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 379
confident_label rate tensor(0.6058, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 979
clean true:961
clean false:18
clean_rate:0.9816138917262512
noisy true:276
noisy false:361
after delete: len(clean_dataset) 979
after delete: len(noisy_dataset) 637
epoch [128/200] batch [5/30] time 0.250 (0.258) data 0.086 (0.098) loss_x loss_x 0.6948 (0.6211) acc_x 81.2500 (85.0000) lr 6.0285e-04 eta 0:00:06
epoch [128/200] batch [10/30] time 0.305 (0.268) data 0.144 (0.108) loss_x loss_x 0.6553 (0.5789) acc_x 87.5000 (85.9375) lr 6.0285e-04 eta 0:00:05
epoch [128/200] batch [15/30] time 0.270 (0.276) data 0.111 (0.115) loss_x loss_x 0.8062 (0.6187) acc_x 81.2500 (84.5833) lr 6.0285e-04 eta 0:00:04
epoch [128/200] batch [20/30] time 0.268 (0.276) data 0.105 (0.115) loss_x loss_x 0.8271 (0.6211) acc_x 81.2500 (84.3750) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [25/30] time 0.292 (0.267) data 0.133 (0.112) loss_x loss_x 0.4231 (0.6177) acc_x 87.5000 (83.8750) lr 6.0285e-04 eta 0:00:01
epoch [128/200] batch [30/30] time 0.258 (0.267) data 0.095 (0.112) loss_x loss_x 0.7173 (0.6423) acc_x 68.7500 (83.0208) lr 6.0285e-04 eta 0:00:00
epoch [128/200] batch [5/19] time 0.277 (0.274) data 0.110 (0.116) loss_u loss_u 0.8271 (0.8085) acc_u 25.0000 (23.1250) lr 6.0285e-04 eta 0:00:03
epoch [128/200] batch [10/19] time 0.266 (0.274) data 0.097 (0.115) loss_u loss_u 0.7207 (0.7977) acc_u 34.3750 (25.3125) lr 6.0285e-04 eta 0:00:02
epoch [128/200] batch [15/19] time 0.289 (0.275) data 0.121 (0.115) loss_u loss_u 0.7373 (0.7885) acc_u 31.2500 (25.6250) lr 6.0285e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 399
confident_label rate tensor(0.5965, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 964
clean true:947
clean false:17
clean_rate:0.9823651452282157
noisy true:270
noisy false:382
after delete: len(clean_dataset) 964
after delete: len(noisy_dataset) 652
epoch [129/200] batch [5/30] time 0.292 (0.281) data 0.133 (0.121) loss_x loss_x 0.7085 (0.5497) acc_x 78.1250 (85.0000) lr 5.8849e-04 eta 0:00:07
epoch [129/200] batch [10/30] time 0.251 (0.274) data 0.092 (0.114) loss_x loss_x 0.8838 (0.6365) acc_x 81.2500 (81.8750) lr 5.8849e-04 eta 0:00:05
epoch [129/200] batch [15/30] time 0.313 (0.267) data 0.151 (0.114) loss_x loss_x 0.4568 (0.6279) acc_x 90.6250 (82.2917) lr 5.8849e-04 eta 0:00:04
epoch [129/200] batch [20/30] time 0.285 (0.270) data 0.127 (0.115) loss_x loss_x 0.5576 (0.6131) acc_x 84.3750 (82.9688) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [25/30] time 0.260 (0.266) data 0.097 (0.111) loss_x loss_x 0.2673 (0.5862) acc_x 96.8750 (84.5000) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [30/30] time 0.254 (0.265) data 0.093 (0.108) loss_x loss_x 0.7080 (0.5823) acc_x 78.1250 (84.6875) lr 5.8849e-04 eta 0:00:00
epoch [129/200] batch [5/20] time 0.281 (0.264) data 0.120 (0.109) loss_u loss_u 0.7227 (0.8096) acc_u 34.3750 (22.5000) lr 5.8849e-04 eta 0:00:03
epoch [129/200] batch [10/20] time 0.272 (0.267) data 0.103 (0.111) loss_u loss_u 0.6953 (0.7833) acc_u 31.2500 (25.0000) lr 5.8849e-04 eta 0:00:02
epoch [129/200] batch [15/20] time 0.276 (0.267) data 0.105 (0.110) loss_u loss_u 0.7925 (0.7955) acc_u 21.8750 (23.7500) lr 5.8849e-04 eta 0:00:01
epoch [129/200] batch [20/20] time 0.276 (0.267) data 0.115 (0.109) loss_u loss_u 0.7427 (0.7887) acc_u 28.1250 (24.3750) lr 5.8849e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 371
confident_label rate tensor(0.6139, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 992
clean true:974
clean false:18
clean_rate:0.9818548387096774
noisy true:271
noisy false:353
after delete: len(clean_dataset) 992
after delete: len(noisy_dataset) 624
epoch [130/200] batch [5/31] time 0.270 (0.235) data 0.107 (0.108) loss_x loss_x 0.3567 (0.4229) acc_x 93.7500 (90.0000) lr 5.7422e-04 eta 0:00:06
epoch [130/200] batch [10/31] time 0.326 (0.270) data 0.167 (0.127) loss_x loss_x 0.8931 (0.5070) acc_x 84.3750 (86.5625) lr 5.7422e-04 eta 0:00:05
epoch [130/200] batch [15/31] time 0.276 (0.271) data 0.119 (0.122) loss_x loss_x 0.1890 (0.4765) acc_x 93.7500 (86.8750) lr 5.7422e-04 eta 0:00:04
epoch [130/200] batch [20/31] time 0.269 (0.270) data 0.107 (0.118) loss_x loss_x 0.3645 (0.4821) acc_x 90.6250 (86.2500) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [25/31] time 0.167 (0.263) data 0.091 (0.115) loss_x loss_x 0.7095 (0.4900) acc_x 84.3750 (86.3750) lr 5.7422e-04 eta 0:00:01
epoch [130/200] batch [30/31] time 0.257 (0.263) data 0.093 (0.113) loss_x loss_x 0.8916 (0.5192) acc_x 75.0000 (85.5208) lr 5.7422e-04 eta 0:00:00
epoch [130/200] batch [5/19] time 0.280 (0.264) data 0.112 (0.111) loss_u loss_u 0.7915 (0.7891) acc_u 25.0000 (24.3750) lr 5.7422e-04 eta 0:00:03
epoch [130/200] batch [10/19] time 0.285 (0.269) data 0.116 (0.114) loss_u loss_u 0.6929 (0.7951) acc_u 37.5000 (24.6875) lr 5.7422e-04 eta 0:00:02
epoch [130/200] batch [15/19] time 0.258 (0.269) data 0.091 (0.113) loss_u loss_u 0.9263 (0.8004) acc_u 12.5000 (23.9583) lr 5.7422e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 390
confident_label rate tensor(0.6021, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 973
clean true:959
clean false:14
clean_rate:0.9856115107913669
noisy true:267
noisy false:376
after delete: len(clean_dataset) 973
after delete: len(noisy_dataset) 643
epoch [131/200] batch [5/30] time 0.302 (0.268) data 0.138 (0.107) loss_x loss_x 0.3184 (0.5132) acc_x 93.7500 (82.5000) lr 5.6006e-04 eta 0:00:06
epoch [131/200] batch [10/30] time 0.269 (0.263) data 0.106 (0.102) loss_x loss_x 0.4431 (0.5143) acc_x 93.7500 (85.0000) lr 5.6006e-04 eta 0:00:05
epoch [131/200] batch [15/30] time 0.274 (0.263) data 0.111 (0.101) loss_x loss_x 0.8604 (0.5481) acc_x 75.0000 (84.7917) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [20/30] time 0.270 (0.263) data 0.110 (0.101) loss_x loss_x 0.3867 (0.5717) acc_x 90.6250 (84.5312) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [25/30] time 0.174 (0.257) data 0.097 (0.102) loss_x loss_x 0.6602 (0.5778) acc_x 78.1250 (84.8750) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [30/30] time 0.253 (0.259) data 0.090 (0.102) loss_x loss_x 0.4080 (0.5590) acc_x 90.6250 (85.7292) lr 5.6006e-04 eta 0:00:00
epoch [131/200] batch [5/20] time 0.255 (0.259) data 0.089 (0.101) loss_u loss_u 0.8574 (0.8342) acc_u 15.6250 (20.0000) lr 5.6006e-04 eta 0:00:03
epoch [131/200] batch [10/20] time 0.296 (0.261) data 0.131 (0.102) loss_u loss_u 0.7998 (0.8166) acc_u 21.8750 (20.3125) lr 5.6006e-04 eta 0:00:02
epoch [131/200] batch [15/20] time 0.268 (0.258) data 0.086 (0.103) loss_u loss_u 0.7324 (0.7978) acc_u 31.2500 (22.5000) lr 5.6006e-04 eta 0:00:01
epoch [131/200] batch [20/20] time 0.268 (0.261) data 0.098 (0.104) loss_u loss_u 0.8057 (0.7919) acc_u 21.8750 (23.1250) lr 5.6006e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 397
confident_label rate tensor(0.6046, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 977
clean true:962
clean false:15
clean_rate:0.984646878198567
noisy true:257
noisy false:382
after delete: len(clean_dataset) 977
after delete: len(noisy_dataset) 639
epoch [132/200] batch [5/30] time 0.272 (0.283) data 0.110 (0.120) loss_x loss_x 0.5674 (0.5441) acc_x 84.3750 (85.6250) lr 5.4601e-04 eta 0:00:07
epoch [132/200] batch [10/30] time 0.270 (0.284) data 0.109 (0.121) loss_x loss_x 0.8936 (0.5501) acc_x 78.1250 (87.1875) lr 5.4601e-04 eta 0:00:05
epoch [132/200] batch [15/30] time 0.258 (0.272) data 0.085 (0.119) loss_x loss_x 0.5425 (0.5507) acc_x 84.3750 (86.4583) lr 5.4601e-04 eta 0:00:04
epoch [132/200] batch [20/30] time 0.301 (0.273) data 0.139 (0.118) loss_x loss_x 0.4570 (0.5620) acc_x 87.5000 (86.0938) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [25/30] time 0.269 (0.274) data 0.108 (0.118) loss_x loss_x 0.7549 (0.5708) acc_x 81.2500 (85.8750) lr 5.4601e-04 eta 0:00:01
epoch [132/200] batch [30/30] time 0.271 (0.273) data 0.109 (0.117) loss_x loss_x 0.7402 (0.5924) acc_x 81.2500 (85.8333) lr 5.4601e-04 eta 0:00:00
epoch [132/200] batch [5/19] time 0.274 (0.271) data 0.112 (0.116) loss_u loss_u 0.8149 (0.8130) acc_u 21.8750 (22.5000) lr 5.4601e-04 eta 0:00:03
epoch [132/200] batch [10/19] time 0.275 (0.272) data 0.109 (0.115) loss_u loss_u 0.7749 (0.7916) acc_u 31.2500 (25.3125) lr 5.4601e-04 eta 0:00:02
epoch [132/200] batch [15/19] time 0.306 (0.273) data 0.139 (0.116) loss_u loss_u 0.7393 (0.7996) acc_u 25.0000 (23.5417) lr 5.4601e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 404
confident_label rate tensor(0.5990, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 968
clean true:951
clean false:17
clean_rate:0.9824380165289256
noisy true:261
noisy false:387
after delete: len(clean_dataset) 968
after delete: len(noisy_dataset) 648
epoch [133/200] batch [5/30] time 0.360 (0.301) data 0.199 (0.140) loss_x loss_x 0.3860 (0.5827) acc_x 93.7500 (85.6250) lr 5.3207e-04 eta 0:00:07
epoch [133/200] batch [10/30] time 0.272 (0.305) data 0.110 (0.145) loss_x loss_x 0.1552 (0.4822) acc_x 93.7500 (87.8125) lr 5.3207e-04 eta 0:00:06
epoch [133/200] batch [15/30] time 0.244 (0.289) data 0.083 (0.135) loss_x loss_x 0.4314 (0.4786) acc_x 87.5000 (87.2917) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [20/30] time 0.273 (0.288) data 0.116 (0.133) loss_x loss_x 0.5415 (0.5531) acc_x 87.5000 (85.9375) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [25/30] time 0.272 (0.290) data 0.109 (0.134) loss_x loss_x 0.3000 (0.5337) acc_x 93.7500 (86.7500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [30/30] time 0.185 (0.285) data 0.107 (0.131) loss_x loss_x 0.5918 (0.5667) acc_x 78.1250 (85.2083) lr 5.3207e-04 eta 0:00:00
epoch [133/200] batch [5/20] time 0.259 (0.280) data 0.093 (0.127) loss_u loss_u 0.9092 (0.7963) acc_u 12.5000 (23.1250) lr 5.3207e-04 eta 0:00:04
epoch [133/200] batch [10/20] time 0.258 (0.279) data 0.091 (0.124) loss_u loss_u 0.7812 (0.7885) acc_u 25.0000 (24.3750) lr 5.3207e-04 eta 0:00:02
epoch [133/200] batch [15/20] time 0.302 (0.280) data 0.136 (0.124) loss_u loss_u 0.6890 (0.7933) acc_u 34.3750 (23.7500) lr 5.3207e-04 eta 0:00:01
epoch [133/200] batch [20/20] time 0.270 (0.280) data 0.102 (0.123) loss_u loss_u 0.7095 (0.7891) acc_u 31.2500 (23.9062) lr 5.3207e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 392
confident_label rate tensor(0.5972, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 965
clean true:953
clean false:12
clean_rate:0.9875647668393782
noisy true:271
noisy false:380
after delete: len(clean_dataset) 965
after delete: len(noisy_dataset) 651
epoch [134/200] batch [5/30] time 0.274 (0.262) data 0.115 (0.100) loss_x loss_x 0.4341 (0.5499) acc_x 87.5000 (83.7500) lr 5.1825e-04 eta 0:00:06
epoch [134/200] batch [10/30] time 0.263 (0.262) data 0.101 (0.100) loss_x loss_x 0.3804 (0.5903) acc_x 93.7500 (85.3125) lr 5.1825e-04 eta 0:00:05
epoch [134/200] batch [15/30] time 0.252 (0.262) data 0.095 (0.100) loss_x loss_x 0.4138 (0.5271) acc_x 90.6250 (86.6667) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [20/30] time 0.323 (0.254) data 0.162 (0.104) loss_x loss_x 0.7656 (0.5409) acc_x 81.2500 (86.2500) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [25/30] time 0.281 (0.257) data 0.118 (0.106) loss_x loss_x 0.3428 (0.5163) acc_x 90.6250 (86.8750) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [30/30] time 0.274 (0.260) data 0.116 (0.107) loss_x loss_x 1.0762 (0.5369) acc_x 75.0000 (86.2500) lr 5.1825e-04 eta 0:00:00
epoch [134/200] batch [5/20] time 0.306 (0.266) data 0.143 (0.111) loss_u loss_u 0.9141 (0.8072) acc_u 12.5000 (23.1250) lr 5.1825e-04 eta 0:00:03
epoch [134/200] batch [10/20] time 0.186 (0.262) data 0.109 (0.110) loss_u loss_u 0.8213 (0.8048) acc_u 18.7500 (23.1250) lr 5.1825e-04 eta 0:00:02
epoch [134/200] batch [15/20] time 0.300 (0.263) data 0.131 (0.110) loss_u loss_u 0.8120 (0.7942) acc_u 21.8750 (23.9583) lr 5.1825e-04 eta 0:00:01
epoch [134/200] batch [20/20] time 0.342 (0.265) data 0.173 (0.111) loss_u loss_u 0.8213 (0.7916) acc_u 25.0000 (24.2188) lr 5.1825e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 382
confident_label rate tensor(0.6101, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 986
clean true:969
clean false:17
clean_rate:0.9827586206896551
noisy true:265
noisy false:365
after delete: len(clean_dataset) 986
after delete: len(noisy_dataset) 630
epoch [135/200] batch [5/30] time 0.276 (0.280) data 0.111 (0.116) loss_x loss_x 0.6738 (0.5830) acc_x 84.3750 (85.0000) lr 5.0454e-04 eta 0:00:06
epoch [135/200] batch [10/30] time 0.261 (0.276) data 0.096 (0.112) loss_x loss_x 0.2922 (0.5132) acc_x 93.7500 (87.5000) lr 5.0454e-04 eta 0:00:05
epoch [135/200] batch [15/30] time 0.258 (0.259) data 0.098 (0.107) loss_x loss_x 0.5430 (0.5013) acc_x 90.6250 (87.0833) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [20/30] time 0.263 (0.258) data 0.102 (0.104) loss_x loss_x 0.8843 (0.5591) acc_x 78.1250 (85.7812) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [25/30] time 0.263 (0.259) data 0.102 (0.103) loss_x loss_x 0.7939 (0.5851) acc_x 75.0000 (84.7500) lr 5.0454e-04 eta 0:00:01
epoch [135/200] batch [30/30] time 0.288 (0.259) data 0.125 (0.103) loss_x loss_x 0.3394 (0.5649) acc_x 90.6250 (85.1042) lr 5.0454e-04 eta 0:00:00
epoch [135/200] batch [5/19] time 0.275 (0.260) data 0.110 (0.103) loss_u loss_u 0.8213 (0.8068) acc_u 25.0000 (24.3750) lr 5.0454e-04 eta 0:00:03
epoch [135/200] batch [10/19] time 0.190 (0.261) data 0.112 (0.106) loss_u loss_u 0.8086 (0.8109) acc_u 21.8750 (22.8125) lr 5.0454e-04 eta 0:00:02
epoch [135/200] batch [15/19] time 0.257 (0.263) data 0.091 (0.106) loss_u loss_u 0.7812 (0.8062) acc_u 21.8750 (22.2917) lr 5.0454e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 395
confident_label rate tensor(0.5978, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 966
clean true:949
clean false:17
clean_rate:0.9824016563146998
noisy true:272
noisy false:378
after delete: len(clean_dataset) 966
after delete: len(noisy_dataset) 650
epoch [136/200] batch [5/30] time 0.271 (0.260) data 0.106 (0.095) loss_x loss_x 1.0146 (0.5675) acc_x 75.0000 (84.3750) lr 4.9096e-04 eta 0:00:06
epoch [136/200] batch [10/30] time 0.267 (0.265) data 0.104 (0.100) loss_x loss_x 0.5190 (0.5469) acc_x 84.3750 (84.3750) lr 4.9096e-04 eta 0:00:05
epoch [136/200] batch [15/30] time 0.493 (0.270) data 0.330 (0.117) loss_x loss_x 0.7305 (0.5537) acc_x 78.1250 (84.7917) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [20/30] time 0.265 (0.270) data 0.104 (0.115) loss_x loss_x 1.1309 (0.5920) acc_x 75.0000 (84.0625) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [25/30] time 0.262 (0.269) data 0.105 (0.113) loss_x loss_x 0.3140 (0.5630) acc_x 96.8750 (85.1250) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [30/30] time 0.258 (0.269) data 0.096 (0.112) loss_x loss_x 0.5630 (0.5560) acc_x 84.3750 (85.0000) lr 4.9096e-04 eta 0:00:00
epoch [136/200] batch [5/20] time 0.269 (0.268) data 0.103 (0.110) loss_u loss_u 0.7671 (0.7965) acc_u 28.1250 (25.6250) lr 4.9096e-04 eta 0:00:04
epoch [136/200] batch [10/20] time 0.168 (0.266) data 0.089 (0.109) loss_u loss_u 0.8276 (0.7779) acc_u 18.7500 (26.2500) lr 4.9096e-04 eta 0:00:02
epoch [136/200] batch [15/20] time 0.283 (0.265) data 0.118 (0.109) loss_u loss_u 0.7783 (0.7809) acc_u 28.1250 (26.0417) lr 4.9096e-04 eta 0:00:01
epoch [136/200] batch [20/20] time 0.288 (0.266) data 0.121 (0.109) loss_u loss_u 0.8979 (0.7858) acc_u 9.3750 (25.3125) lr 4.9096e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 374
confident_label rate tensor(0.6077, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 982
clean true:969
clean false:13
clean_rate:0.9867617107942973
noisy true:273
noisy false:361
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 634
epoch [137/200] batch [5/30] time 0.265 (0.269) data 0.099 (0.106) loss_x loss_x 0.6421 (0.4816) acc_x 81.2500 (87.5000) lr 4.7750e-04 eta 0:00:06
epoch [137/200] batch [10/30] time 0.271 (0.269) data 0.107 (0.105) loss_x loss_x 0.3921 (0.4784) acc_x 84.3750 (87.5000) lr 4.7750e-04 eta 0:00:05
epoch [137/200] batch [15/30] time 0.280 (0.258) data 0.095 (0.105) loss_x loss_x 0.5991 (0.5076) acc_x 87.5000 (86.4583) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [20/30] time 0.254 (0.259) data 0.090 (0.104) loss_x loss_x 0.2517 (0.5187) acc_x 90.6250 (85.7812) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [25/30] time 0.257 (0.260) data 0.094 (0.103) loss_x loss_x 0.4436 (0.5194) acc_x 84.3750 (86.3750) lr 4.7750e-04 eta 0:00:01
epoch [137/200] batch [30/30] time 0.246 (0.260) data 0.082 (0.102) loss_x loss_x 0.5278 (0.5347) acc_x 90.6250 (86.2500) lr 4.7750e-04 eta 0:00:00
epoch [137/200] batch [5/19] time 0.305 (0.261) data 0.140 (0.101) loss_u loss_u 0.8188 (0.7774) acc_u 15.6250 (25.0000) lr 4.7750e-04 eta 0:00:03
epoch [137/200] batch [10/19] time 0.272 (0.262) data 0.109 (0.102) loss_u loss_u 0.7915 (0.7987) acc_u 25.0000 (23.1250) lr 4.7750e-04 eta 0:00:02
epoch [137/200] batch [15/19] time 0.251 (0.258) data 0.088 (0.101) loss_u loss_u 0.7612 (0.8070) acc_u 28.1250 (22.0833) lr 4.7750e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 386
confident_label rate tensor(0.6077, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 982
clean true:964
clean false:18
clean_rate:0.9816700610997964
noisy true:266
noisy false:368
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 634
epoch [138/200] batch [5/30] time 0.249 (0.281) data 0.087 (0.118) loss_x loss_x 0.0949 (0.3417) acc_x 100.0000 (90.0000) lr 4.6417e-04 eta 0:00:07
epoch [138/200] batch [10/30] time 0.254 (0.269) data 0.092 (0.106) loss_x loss_x 0.5640 (0.4240) acc_x 84.3750 (88.4375) lr 4.6417e-04 eta 0:00:05
epoch [138/200] batch [15/30] time 0.268 (0.255) data 0.108 (0.103) loss_x loss_x 0.7217 (0.4818) acc_x 84.3750 (87.7083) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [20/30] time 0.263 (0.256) data 0.104 (0.101) loss_x loss_x 0.3748 (0.4941) acc_x 90.6250 (87.3438) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [25/30] time 0.261 (0.258) data 0.098 (0.102) loss_x loss_x 0.2107 (0.4807) acc_x 100.0000 (87.7500) lr 4.6417e-04 eta 0:00:01
epoch [138/200] batch [30/30] time 0.270 (0.260) data 0.107 (0.102) loss_x loss_x 0.6328 (0.5333) acc_x 78.1250 (86.0417) lr 4.6417e-04 eta 0:00:00
epoch [138/200] batch [5/19] time 0.182 (0.267) data 0.104 (0.110) loss_u loss_u 0.7661 (0.7915) acc_u 25.0000 (24.3750) lr 4.6417e-04 eta 0:00:03
epoch [138/200] batch [10/19] time 0.348 (0.270) data 0.190 (0.113) loss_u loss_u 0.7998 (0.8048) acc_u 21.8750 (23.4375) lr 4.6417e-04 eta 0:00:02
epoch [138/200] batch [15/19] time 0.278 (0.273) data 0.112 (0.116) loss_u loss_u 0.7397 (0.7925) acc_u 28.1250 (23.9583) lr 4.6417e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 368
confident_label rate tensor(0.6157, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 995
clean true:979
clean false:16
clean_rate:0.9839195979899498
noisy true:269
noisy false:352
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 621
epoch [139/200] batch [5/31] time 0.308 (0.318) data 0.144 (0.154) loss_x loss_x 0.3147 (0.4917) acc_x 90.6250 (86.8750) lr 4.5098e-04 eta 0:00:08
epoch [139/200] batch [10/31] time 0.205 (0.293) data 0.128 (0.138) loss_x loss_x 0.3838 (0.4525) acc_x 81.2500 (87.5000) lr 4.5098e-04 eta 0:00:06
epoch [139/200] batch [15/31] time 0.264 (0.286) data 0.098 (0.126) loss_x loss_x 0.8169 (0.4591) acc_x 78.1250 (87.9167) lr 4.5098e-04 eta 0:00:04
epoch [139/200] batch [20/31] time 0.268 (0.280) data 0.107 (0.119) loss_x loss_x 0.2898 (0.4496) acc_x 100.0000 (88.9062) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [25/31] time 0.289 (0.279) data 0.123 (0.118) loss_x loss_x 0.6357 (0.4803) acc_x 84.3750 (87.8750) lr 4.5098e-04 eta 0:00:01
epoch [139/200] batch [30/31] time 0.271 (0.279) data 0.106 (0.118) loss_x loss_x 0.7432 (0.5153) acc_x 81.2500 (86.7708) lr 4.5098e-04 eta 0:00:00
epoch [139/200] batch [5/19] time 0.279 (0.275) data 0.118 (0.117) loss_u loss_u 0.8408 (0.8120) acc_u 18.7500 (20.6250) lr 4.5098e-04 eta 0:00:03
epoch [139/200] batch [10/19] time 0.244 (0.273) data 0.082 (0.114) loss_u loss_u 0.7456 (0.8232) acc_u 28.1250 (19.6875) lr 4.5098e-04 eta 0:00:02
epoch [139/200] batch [15/19] time 0.264 (0.272) data 0.100 (0.113) loss_u loss_u 0.7178 (0.8174) acc_u 31.2500 (20.4167) lr 4.5098e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 373
confident_label rate tensor(0.6058, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 979
clean true:966
clean false:13
clean_rate:0.9867211440245148
noisy true:277
noisy false:360
after delete: len(clean_dataset) 979
after delete: len(noisy_dataset) 637
epoch [140/200] batch [5/30] time 0.301 (0.293) data 0.135 (0.129) loss_x loss_x 0.3315 (0.6476) acc_x 90.6250 (85.0000) lr 4.3792e-04 eta 0:00:07
epoch [140/200] batch [10/30] time 0.271 (0.282) data 0.104 (0.118) loss_x loss_x 0.5000 (0.6135) acc_x 87.5000 (84.6875) lr 4.3792e-04 eta 0:00:05
epoch [140/200] batch [15/30] time 0.305 (0.271) data 0.141 (0.118) loss_x loss_x 1.2021 (0.5945) acc_x 75.0000 (85.4167) lr 4.3792e-04 eta 0:00:04
epoch [140/200] batch [20/30] time 0.275 (0.273) data 0.109 (0.117) loss_x loss_x 0.7798 (0.6157) acc_x 78.1250 (83.9062) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [25/30] time 0.276 (0.279) data 0.111 (0.122) loss_x loss_x 0.5791 (0.6343) acc_x 84.3750 (83.7500) lr 4.3792e-04 eta 0:00:01
epoch [140/200] batch [30/30] time 0.280 (0.278) data 0.115 (0.120) loss_x loss_x 1.0957 (0.6345) acc_x 78.1250 (83.5417) lr 4.3792e-04 eta 0:00:00
epoch [140/200] batch [5/19] time 0.347 (0.279) data 0.182 (0.120) loss_u loss_u 0.8491 (0.7483) acc_u 15.6250 (29.3750) lr 4.3792e-04 eta 0:00:03
epoch [140/200] batch [10/19] time 0.265 (0.277) data 0.106 (0.121) loss_u loss_u 0.7734 (0.7765) acc_u 28.1250 (25.9375) lr 4.3792e-04 eta 0:00:02
epoch [140/200] batch [15/19] time 0.274 (0.280) data 0.108 (0.123) loss_u loss_u 0.7568 (0.7910) acc_u 31.2500 (24.1667) lr 4.3792e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 393
confident_label rate tensor(0.5947, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 961
clean true:949
clean false:12
clean_rate:0.9875130072840791
noisy true:274
noisy false:381
after delete: len(clean_dataset) 961
after delete: len(noisy_dataset) 655
epoch [141/200] batch [5/30] time 0.251 (0.243) data 0.086 (0.104) loss_x loss_x 0.5254 (0.6024) acc_x 84.3750 (86.8750) lr 4.2499e-04 eta 0:00:06
epoch [141/200] batch [10/30] time 0.254 (0.264) data 0.089 (0.112) loss_x loss_x 0.6279 (0.6113) acc_x 75.0000 (85.0000) lr 4.2499e-04 eta 0:00:05
epoch [141/200] batch [15/30] time 0.257 (0.267) data 0.091 (0.110) loss_x loss_x 0.3557 (0.6069) acc_x 93.7500 (86.0417) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [20/30] time 0.251 (0.265) data 0.086 (0.107) loss_x loss_x 0.5835 (0.5678) acc_x 81.2500 (86.5625) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [25/30] time 0.256 (0.264) data 0.090 (0.104) loss_x loss_x 0.4165 (0.5555) acc_x 87.5000 (86.5000) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [30/30] time 0.274 (0.260) data 0.111 (0.105) loss_x loss_x 1.1367 (0.5762) acc_x 68.7500 (85.6250) lr 4.2499e-04 eta 0:00:00
epoch [141/200] batch [5/20] time 0.250 (0.260) data 0.085 (0.103) loss_u loss_u 0.7280 (0.7717) acc_u 31.2500 (26.8750) lr 4.2499e-04 eta 0:00:03
epoch [141/200] batch [10/20] time 0.279 (0.262) data 0.121 (0.104) loss_u loss_u 0.7905 (0.7876) acc_u 21.8750 (25.6250) lr 4.2499e-04 eta 0:00:02
epoch [141/200] batch [15/20] time 0.269 (0.263) data 0.104 (0.104) loss_u loss_u 0.8179 (0.7955) acc_u 18.7500 (23.9583) lr 4.2499e-04 eta 0:00:01
epoch [141/200] batch [20/20] time 0.278 (0.264) data 0.113 (0.105) loss_u loss_u 0.7681 (0.8001) acc_u 25.0000 (23.2812) lr 4.2499e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 398
confident_label rate tensor(0.5996, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 969
clean true:955
clean false:14
clean_rate:0.9855521155830753
noisy true:263
noisy false:384
after delete: len(clean_dataset) 969
after delete: len(noisy_dataset) 647
epoch [142/200] batch [5/30] time 0.270 (0.274) data 0.107 (0.111) loss_x loss_x 0.5591 (0.5961) acc_x 87.5000 (86.2500) lr 4.1221e-04 eta 0:00:06
epoch [142/200] batch [10/30] time 0.266 (0.274) data 0.102 (0.111) loss_x loss_x 0.7295 (0.5466) acc_x 78.1250 (85.3125) lr 4.1221e-04 eta 0:00:05
epoch [142/200] batch [15/30] time 0.173 (0.260) data 0.092 (0.109) loss_x loss_x 0.3699 (0.5605) acc_x 87.5000 (84.1667) lr 4.1221e-04 eta 0:00:03
epoch [142/200] batch [20/30] time 0.258 (0.262) data 0.094 (0.107) loss_x loss_x 0.5591 (0.5618) acc_x 90.6250 (84.5312) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [25/30] time 0.246 (0.264) data 0.081 (0.107) loss_x loss_x 0.5464 (0.5781) acc_x 84.3750 (84.7500) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [30/30] time 0.282 (0.272) data 0.121 (0.114) loss_x loss_x 0.6846 (0.5735) acc_x 81.2500 (84.6875) lr 4.1221e-04 eta 0:00:00
epoch [142/200] batch [5/20] time 0.346 (0.275) data 0.180 (0.116) loss_u loss_u 0.8975 (0.7746) acc_u 12.5000 (26.2500) lr 4.1221e-04 eta 0:00:04
epoch [142/200] batch [10/20] time 0.274 (0.275) data 0.106 (0.117) loss_u loss_u 0.7886 (0.7896) acc_u 25.0000 (24.3750) lr 4.1221e-04 eta 0:00:02
epoch [142/200] batch [15/20] time 0.246 (0.277) data 0.083 (0.118) loss_u loss_u 0.8862 (0.7983) acc_u 9.3750 (23.1250) lr 4.1221e-04 eta 0:00:01
epoch [142/200] batch [20/20] time 0.256 (0.277) data 0.089 (0.118) loss_u loss_u 0.7979 (0.7876) acc_u 25.0000 (24.3750) lr 4.1221e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 392
confident_label rate tensor(0.5947, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 961
clean true:951
clean false:10
clean_rate:0.9895941727367326
noisy true:273
noisy false:382
after delete: len(clean_dataset) 961
after delete: len(noisy_dataset) 655
epoch [143/200] batch [5/30] time 0.252 (0.259) data 0.093 (0.096) loss_x loss_x 0.3584 (0.5388) acc_x 90.6250 (86.2500) lr 3.9958e-04 eta 0:00:06
epoch [143/200] batch [10/30] time 0.321 (0.270) data 0.156 (0.107) loss_x loss_x 0.5684 (0.5946) acc_x 84.3750 (85.6250) lr 3.9958e-04 eta 0:00:05
epoch [143/200] batch [15/30] time 0.261 (0.266) data 0.090 (0.114) loss_x loss_x 0.4536 (0.5571) acc_x 84.3750 (85.8333) lr 3.9958e-04 eta 0:00:03
epoch [143/200] batch [20/30] time 0.288 (0.270) data 0.124 (0.115) loss_x loss_x 0.3955 (0.5234) acc_x 84.3750 (85.9375) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [25/30] time 0.275 (0.271) data 0.110 (0.114) loss_x loss_x 0.7217 (0.5451) acc_x 81.2500 (85.7500) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [30/30] time 0.272 (0.271) data 0.108 (0.114) loss_x loss_x 0.2974 (0.5388) acc_x 93.7500 (85.8333) lr 3.9958e-04 eta 0:00:00
epoch [143/200] batch [5/20] time 0.301 (0.276) data 0.130 (0.116) loss_u loss_u 0.8506 (0.7560) acc_u 15.6250 (29.3750) lr 3.9958e-04 eta 0:00:04
epoch [143/200] batch [10/20] time 0.256 (0.270) data 0.091 (0.115) loss_u loss_u 0.8735 (0.7781) acc_u 12.5000 (25.3125) lr 3.9958e-04 eta 0:00:02
epoch [143/200] batch [15/20] time 0.258 (0.270) data 0.097 (0.113) loss_u loss_u 0.7305 (0.7735) acc_u 31.2500 (25.6250) lr 3.9958e-04 eta 0:00:01
epoch [143/200] batch [20/20] time 0.266 (0.269) data 0.104 (0.112) loss_u loss_u 0.7432 (0.7731) acc_u 28.1250 (25.6250) lr 3.9958e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 382
confident_label rate tensor(0.6058, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 979
clean true:963
clean false:16
clean_rate:0.9836567926455567
noisy true:271
noisy false:366
after delete: len(clean_dataset) 979
after delete: len(noisy_dataset) 637
epoch [144/200] batch [5/30] time 0.170 (0.245) data 0.093 (0.098) loss_x loss_x 0.4368 (0.4302) acc_x 87.5000 (88.1250) lr 3.8709e-04 eta 0:00:06
epoch [144/200] batch [10/30] time 0.272 (0.256) data 0.110 (0.098) loss_x loss_x 0.7119 (0.5426) acc_x 75.0000 (85.6250) lr 3.8709e-04 eta 0:00:05
epoch [144/200] batch [15/30] time 0.265 (0.257) data 0.106 (0.098) loss_x loss_x 0.5566 (0.5858) acc_x 87.5000 (85.4167) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [20/30] time 0.250 (0.256) data 0.087 (0.097) loss_x loss_x 0.3491 (0.5739) acc_x 90.6250 (85.9375) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [25/30] time 0.290 (0.259) data 0.126 (0.099) loss_x loss_x 0.1826 (0.5511) acc_x 100.0000 (86.7500) lr 3.8709e-04 eta 0:00:01
epoch [144/200] batch [30/30] time 0.271 (0.261) data 0.110 (0.101) loss_x loss_x 0.6411 (0.5622) acc_x 84.3750 (86.3542) lr 3.8709e-04 eta 0:00:00
epoch [144/200] batch [5/19] time 0.273 (0.255) data 0.106 (0.102) loss_u loss_u 0.8340 (0.7615) acc_u 21.8750 (30.6250) lr 3.8709e-04 eta 0:00:03
epoch [144/200] batch [10/19] time 0.284 (0.259) data 0.119 (0.104) loss_u loss_u 0.8193 (0.7872) acc_u 21.8750 (25.6250) lr 3.8709e-04 eta 0:00:02
epoch [144/200] batch [15/19] time 0.347 (0.264) data 0.180 (0.108) loss_u loss_u 0.8643 (0.7815) acc_u 15.6250 (26.0417) lr 3.8709e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 360
confident_label rate tensor(0.6182, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 999
clean true:987
clean false:12
clean_rate:0.987987987987988
noisy true:269
noisy false:348
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 617
epoch [145/200] batch [5/31] time 0.276 (0.276) data 0.113 (0.111) loss_x loss_x 0.2023 (0.4427) acc_x 93.7500 (88.7500) lr 3.7476e-04 eta 0:00:07
epoch [145/200] batch [10/31] time 0.261 (0.270) data 0.100 (0.107) loss_x loss_x 0.4041 (0.5283) acc_x 90.6250 (86.5625) lr 3.7476e-04 eta 0:00:05
epoch [145/200] batch [15/31] time 0.292 (0.271) data 0.133 (0.109) loss_x loss_x 0.7344 (0.5275) acc_x 84.3750 (86.2500) lr 3.7476e-04 eta 0:00:04
epoch [145/200] batch [20/31] time 0.271 (0.271) data 0.109 (0.108) loss_x loss_x 0.5498 (0.5236) acc_x 84.3750 (86.0938) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [25/31] time 0.265 (0.270) data 0.100 (0.107) loss_x loss_x 0.6655 (0.5043) acc_x 78.1250 (86.7500) lr 3.7476e-04 eta 0:00:01
epoch [145/200] batch [30/31] time 0.261 (0.261) data 0.101 (0.105) loss_x loss_x 0.2854 (0.4859) acc_x 96.8750 (87.3958) lr 3.7476e-04 eta 0:00:00
epoch [145/200] batch [5/19] time 0.280 (0.263) data 0.114 (0.106) loss_u loss_u 0.8882 (0.8191) acc_u 9.3750 (20.6250) lr 3.7476e-04 eta 0:00:03
epoch [145/200] batch [10/19] time 0.260 (0.264) data 0.098 (0.106) loss_u loss_u 0.6675 (0.7958) acc_u 40.6250 (23.1250) lr 3.7476e-04 eta 0:00:02
epoch [145/200] batch [15/19] time 0.264 (0.263) data 0.106 (0.104) loss_u loss_u 0.8335 (0.8021) acc_u 18.7500 (22.2917) lr 3.7476e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 345
confident_label rate tensor(0.6120, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 989
clean true:978
clean false:11
clean_rate:0.9888776541961577
noisy true:293
noisy false:334
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 627
epoch [146/200] batch [5/30] time 0.256 (0.285) data 0.090 (0.120) loss_x loss_x 0.5430 (0.5042) acc_x 81.2500 (86.2500) lr 3.6258e-04 eta 0:00:07
epoch [146/200] batch [10/30] time 0.260 (0.266) data 0.094 (0.113) loss_x loss_x 0.4431 (0.5163) acc_x 90.6250 (85.3125) lr 3.6258e-04 eta 0:00:05
epoch [146/200] batch [15/30] time 0.275 (0.268) data 0.109 (0.112) loss_x loss_x 0.4883 (0.5250) acc_x 87.5000 (86.8750) lr 3.6258e-04 eta 0:00:04
epoch [146/200] batch [20/30] time 0.284 (0.271) data 0.121 (0.112) loss_x loss_x 0.2223 (0.5169) acc_x 96.8750 (87.1875) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [25/30] time 0.255 (0.269) data 0.093 (0.109) loss_x loss_x 0.5562 (0.5177) acc_x 84.3750 (87.3750) lr 3.6258e-04 eta 0:00:01
epoch [146/200] batch [30/30] time 0.270 (0.271) data 0.106 (0.111) loss_x loss_x 0.7524 (0.5314) acc_x 78.1250 (86.6667) lr 3.6258e-04 eta 0:00:00
epoch [146/200] batch [5/19] time 0.283 (0.268) data 0.118 (0.111) loss_u loss_u 0.7881 (0.7699) acc_u 25.0000 (27.5000) lr 3.6258e-04 eta 0:00:03
epoch [146/200] batch [10/19] time 0.274 (0.269) data 0.111 (0.111) loss_u loss_u 0.8555 (0.7746) acc_u 18.7500 (25.9375) lr 3.6258e-04 eta 0:00:02
epoch [146/200] batch [15/19] time 0.276 (0.272) data 0.109 (0.113) loss_u loss_u 0.8843 (0.7945) acc_u 12.5000 (23.3333) lr 3.6258e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 390
confident_label rate tensor(0.6040, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 976
clean true:963
clean false:13
clean_rate:0.9866803278688525
noisy true:263
noisy false:377
after delete: len(clean_dataset) 976
after delete: len(noisy_dataset) 640
epoch [147/200] batch [5/30] time 0.258 (0.267) data 0.092 (0.101) loss_x loss_x 0.6660 (0.4426) acc_x 84.3750 (91.2500) lr 3.5055e-04 eta 0:00:06
epoch [147/200] batch [10/30] time 0.257 (0.267) data 0.094 (0.102) loss_x loss_x 0.3257 (0.4878) acc_x 93.7500 (90.0000) lr 3.5055e-04 eta 0:00:05
epoch [147/200] batch [15/30] time 0.296 (0.276) data 0.130 (0.112) loss_x loss_x 0.5869 (0.4920) acc_x 84.3750 (89.1667) lr 3.5055e-04 eta 0:00:04
epoch [147/200] batch [20/30] time 0.279 (0.281) data 0.115 (0.118) loss_x loss_x 0.7056 (0.5072) acc_x 78.1250 (87.3438) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [25/30] time 0.209 (0.275) data 0.090 (0.113) loss_x loss_x 0.6880 (0.5399) acc_x 84.3750 (86.5000) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [30/30] time 0.270 (0.267) data 0.106 (0.110) loss_x loss_x 0.6709 (0.5405) acc_x 84.3750 (86.1458) lr 3.5055e-04 eta 0:00:00
epoch [147/200] batch [5/20] time 0.264 (0.266) data 0.099 (0.108) loss_u loss_u 0.6919 (0.7616) acc_u 34.3750 (26.8750) lr 3.5055e-04 eta 0:00:03
epoch [147/200] batch [10/20] time 0.254 (0.265) data 0.087 (0.107) loss_u loss_u 0.8135 (0.7781) acc_u 21.8750 (25.0000) lr 3.5055e-04 eta 0:00:02
epoch [147/200] batch [15/20] time 0.274 (0.266) data 0.107 (0.106) loss_u loss_u 0.8232 (0.7834) acc_u 18.7500 (24.3750) lr 3.5055e-04 eta 0:00:01
epoch [147/200] batch [20/20] time 0.274 (0.267) data 0.107 (0.106) loss_u loss_u 0.7637 (0.7803) acc_u 31.2500 (25.4688) lr 3.5055e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 376
confident_label rate tensor(0.6077, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 982
clean true:969
clean false:13
clean_rate:0.9867617107942973
noisy true:271
noisy false:363
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 634
epoch [148/200] batch [5/30] time 0.271 (0.276) data 0.106 (0.113) loss_x loss_x 0.4294 (0.4683) acc_x 90.6250 (90.0000) lr 3.3869e-04 eta 0:00:06
epoch [148/200] batch [10/30] time 0.265 (0.269) data 0.101 (0.105) loss_x loss_x 0.5308 (0.4795) acc_x 84.3750 (88.7500) lr 3.3869e-04 eta 0:00:05
epoch [148/200] batch [15/30] time 0.175 (0.255) data 0.099 (0.104) loss_x loss_x 0.6089 (0.5153) acc_x 78.1250 (87.7083) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [20/30] time 0.269 (0.257) data 0.110 (0.104) loss_x loss_x 0.5518 (0.5251) acc_x 84.3750 (87.3438) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [25/30] time 0.273 (0.259) data 0.107 (0.104) loss_x loss_x 0.3813 (0.5288) acc_x 93.7500 (87.2500) lr 3.3869e-04 eta 0:00:01
epoch [148/200] batch [30/30] time 0.273 (0.261) data 0.107 (0.105) loss_x loss_x 0.6787 (0.5428) acc_x 78.1250 (86.5625) lr 3.3869e-04 eta 0:00:00
epoch [148/200] batch [5/19] time 0.269 (0.263) data 0.109 (0.105) loss_u loss_u 0.7417 (0.7768) acc_u 28.1250 (25.0000) lr 3.3869e-04 eta 0:00:03
epoch [148/200] batch [10/19] time 0.301 (0.266) data 0.139 (0.107) loss_u loss_u 0.7231 (0.7880) acc_u 31.2500 (24.0625) lr 3.3869e-04 eta 0:00:02
epoch [148/200] batch [15/19] time 0.279 (0.263) data 0.110 (0.108) loss_u loss_u 0.8091 (0.7877) acc_u 21.8750 (23.7500) lr 3.3869e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 374
confident_label rate tensor(0.6139, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 992
clean true:978
clean false:14
clean_rate:0.9858870967741935
noisy true:264
noisy false:360
after delete: len(clean_dataset) 992
after delete: len(noisy_dataset) 624
epoch [149/200] batch [5/31] time 0.179 (0.244) data 0.102 (0.103) loss_x loss_x 0.5586 (0.4712) acc_x 87.5000 (88.7500) lr 3.2699e-04 eta 0:00:06
epoch [149/200] batch [10/31] time 0.259 (0.245) data 0.098 (0.101) loss_x loss_x 0.3257 (0.4646) acc_x 93.7500 (88.4375) lr 3.2699e-04 eta 0:00:05
epoch [149/200] batch [15/31] time 0.263 (0.249) data 0.099 (0.099) loss_x loss_x 0.2952 (0.4795) acc_x 90.6250 (87.7083) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [20/31] time 0.267 (0.252) data 0.104 (0.099) loss_x loss_x 0.7363 (0.4753) acc_x 81.2500 (87.1875) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [25/31] time 0.278 (0.255) data 0.116 (0.100) loss_x loss_x 0.3247 (0.4816) acc_x 87.5000 (87.2500) lr 3.2699e-04 eta 0:00:01
epoch [149/200] batch [30/31] time 0.267 (0.256) data 0.103 (0.100) loss_x loss_x 0.5186 (0.4918) acc_x 87.5000 (87.0833) lr 3.2699e-04 eta 0:00:00
epoch [149/200] batch [5/19] time 0.262 (0.251) data 0.095 (0.098) loss_u loss_u 0.8936 (0.8146) acc_u 12.5000 (19.3750) lr 3.2699e-04 eta 0:00:03
epoch [149/200] batch [10/19] time 0.265 (0.252) data 0.097 (0.097) loss_u loss_u 0.7651 (0.7957) acc_u 31.2500 (22.5000) lr 3.2699e-04 eta 0:00:02
epoch [149/200] batch [15/19] time 0.270 (0.253) data 0.100 (0.097) loss_u loss_u 0.8159 (0.7942) acc_u 21.8750 (23.3333) lr 3.2699e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 360
confident_label rate tensor(0.6182, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 999
clean true:984
clean false:15
clean_rate:0.984984984984985
noisy true:272
noisy false:345
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 617
epoch [150/200] batch [5/31] time 0.267 (0.265) data 0.110 (0.105) loss_x loss_x 0.2620 (0.6082) acc_x 93.7500 (82.5000) lr 3.1545e-04 eta 0:00:06
epoch [150/200] batch [10/31] time 0.273 (0.251) data 0.106 (0.107) loss_x loss_x 0.5767 (0.5442) acc_x 90.6250 (85.9375) lr 3.1545e-04 eta 0:00:05
epoch [150/200] batch [15/31] time 0.271 (0.258) data 0.106 (0.108) loss_x loss_x 0.6338 (0.5846) acc_x 81.2500 (85.6250) lr 3.1545e-04 eta 0:00:04
epoch [150/200] batch [20/31] time 0.273 (0.258) data 0.108 (0.104) loss_x loss_x 0.5923 (0.5953) acc_x 81.2500 (84.6875) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [25/31] time 0.271 (0.260) data 0.107 (0.105) loss_x loss_x 0.4692 (0.5711) acc_x 90.6250 (85.0000) lr 3.1545e-04 eta 0:00:01
epoch [150/200] batch [30/31] time 0.275 (0.262) data 0.109 (0.105) loss_x loss_x 0.6611 (0.5777) acc_x 87.5000 (85.1042) lr 3.1545e-04 eta 0:00:00
epoch [150/200] batch [5/19] time 0.302 (0.262) data 0.132 (0.106) loss_u loss_u 0.9004 (0.8400) acc_u 12.5000 (18.7500) lr 3.1545e-04 eta 0:00:03
epoch [150/200] batch [10/19] time 0.274 (0.264) data 0.104 (0.106) loss_u loss_u 0.7246 (0.8271) acc_u 40.6250 (20.3125) lr 3.1545e-04 eta 0:00:02
epoch [150/200] batch [15/19] time 0.291 (0.266) data 0.120 (0.107) loss_u loss_u 0.8037 (0.7965) acc_u 21.8750 (23.3333) lr 3.1545e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 356
confident_label rate tensor(0.6139, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 992
clean true:977
clean false:15
clean_rate:0.9848790322580645
noisy true:283
noisy false:341
after delete: len(clean_dataset) 992
after delete: len(noisy_dataset) 624
epoch [151/200] batch [5/31] time 0.248 (0.260) data 0.088 (0.100) loss_x loss_x 0.7183 (0.6274) acc_x 78.1250 (83.7500) lr 3.0409e-04 eta 0:00:06
epoch [151/200] batch [10/31] time 0.257 (0.261) data 0.097 (0.101) loss_x loss_x 0.3113 (0.5418) acc_x 93.7500 (86.2500) lr 3.0409e-04 eta 0:00:05
epoch [151/200] batch [15/31] time 0.175 (0.251) data 0.098 (0.099) loss_x loss_x 0.8662 (0.5540) acc_x 75.0000 (85.4167) lr 3.0409e-04 eta 0:00:04
epoch [151/200] batch [20/31] time 0.260 (0.256) data 0.100 (0.102) loss_x loss_x 0.6489 (0.5506) acc_x 84.3750 (86.0938) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [25/31] time 0.249 (0.256) data 0.087 (0.101) loss_x loss_x 0.8574 (0.5748) acc_x 81.2500 (86.1250) lr 3.0409e-04 eta 0:00:01
epoch [151/200] batch [30/31] time 0.244 (0.256) data 0.081 (0.100) loss_x loss_x 0.5771 (0.5551) acc_x 84.3750 (86.4583) lr 3.0409e-04 eta 0:00:00
epoch [151/200] batch [5/19] time 0.271 (0.261) data 0.106 (0.103) loss_u loss_u 0.7905 (0.8198) acc_u 21.8750 (20.6250) lr 3.0409e-04 eta 0:00:03
epoch [151/200] batch [10/19] time 0.171 (0.260) data 0.093 (0.102) loss_u loss_u 0.6836 (0.7954) acc_u 34.3750 (23.7500) lr 3.0409e-04 eta 0:00:02
epoch [151/200] batch [15/19] time 0.314 (0.260) data 0.145 (0.104) loss_u loss_u 0.7681 (0.8067) acc_u 25.0000 (22.7083) lr 3.0409e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 359
confident_label rate tensor(0.6163, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 996
clean true:979
clean false:17
clean_rate:0.9829317269076305
noisy true:278
noisy false:342
after delete: len(clean_dataset) 996
after delete: len(noisy_dataset) 620
epoch [152/200] batch [5/31] time 0.274 (0.273) data 0.112 (0.111) loss_x loss_x 0.6245 (0.6585) acc_x 84.3750 (80.6250) lr 2.9289e-04 eta 0:00:07
epoch [152/200] batch [10/31] time 0.247 (0.263) data 0.088 (0.101) loss_x loss_x 0.4194 (0.6167) acc_x 93.7500 (82.8125) lr 2.9289e-04 eta 0:00:05
epoch [152/200] batch [15/31] time 0.177 (0.254) data 0.101 (0.101) loss_x loss_x 0.7314 (0.5630) acc_x 84.3750 (85.4167) lr 2.9289e-04 eta 0:00:04
epoch [152/200] batch [20/31] time 0.250 (0.256) data 0.086 (0.102) loss_x loss_x 0.3940 (0.5360) acc_x 90.6250 (85.6250) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [25/31] time 0.261 (0.258) data 0.096 (0.101) loss_x loss_x 0.7505 (0.5736) acc_x 87.5000 (85.0000) lr 2.9289e-04 eta 0:00:01
epoch [152/200] batch [30/31] time 0.263 (0.258) data 0.099 (0.101) loss_x loss_x 0.6968 (0.6002) acc_x 87.5000 (84.2708) lr 2.9289e-04 eta 0:00:00
epoch [152/200] batch [5/19] time 0.289 (0.261) data 0.120 (0.102) loss_u loss_u 0.8438 (0.7539) acc_u 15.6250 (26.8750) lr 2.9289e-04 eta 0:00:03
epoch [152/200] batch [10/19] time 0.262 (0.262) data 0.108 (0.103) loss_u loss_u 0.9009 (0.7996) acc_u 6.2500 (22.8125) lr 2.9289e-04 eta 0:00:02
epoch [152/200] batch [15/19] time 0.280 (0.263) data 0.112 (0.104) loss_u loss_u 0.9131 (0.8082) acc_u 9.3750 (22.2917) lr 2.9289e-04 eta 0:00:01
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 358
confident_label rate tensor(0.6126, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 990
clean true:977
clean false:13
clean_rate:0.9868686868686869
noisy true:281
noisy false:345
after delete: len(clean_dataset) 990
after delete: len(noisy_dataset) 626
epoch [153/200] batch [5/30] time 0.245 (0.229) data 0.080 (0.082) loss_x loss_x 0.2815 (0.5037) acc_x 93.7500 (88.1250) lr 2.8187e-04 eta 0:00:05
epoch [153/200] batch [10/30] time 0.261 (0.237) data 0.101 (0.083) loss_x loss_x 0.6362 (0.5266) acc_x 81.2500 (86.8750) lr 2.8187e-04 eta 0:00:04
epoch [153/200] batch [15/30] time 0.241 (0.241) data 0.077 (0.083) loss_x loss_x 0.5371 (0.5782) acc_x 93.7500 (85.8333) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [20/30] time 0.248 (0.241) data 0.082 (0.082) loss_x loss_x 0.3672 (0.5760) acc_x 84.3750 (85.4688) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [25/30] time 0.242 (0.237) data 0.081 (0.082) loss_x loss_x 0.6758 (0.5560) acc_x 78.1250 (86.0000) lr 2.8187e-04 eta 0:00:01
epoch [153/200] batch [30/30] time 0.242 (0.238) data 0.080 (0.081) loss_x loss_x 0.5400 (0.5470) acc_x 87.5000 (86.2500) lr 2.8187e-04 eta 0:00:00
epoch [153/200] batch [5/19] time 0.249 (0.240) data 0.081 (0.081) loss_u loss_u 0.8276 (0.8254) acc_u 18.7500 (21.2500) lr 2.8187e-04 eta 0:00:03
epoch [153/200] batch [10/19] time 0.166 (0.239) data 0.081 (0.081) loss_u loss_u 0.8403 (0.8126) acc_u 18.7500 (23.1250) lr 2.8187e-04 eta 0:00:02
epoch [153/200] batch [15/19] time 0.242 (0.239) data 0.079 (0.081) loss_u loss_u 0.8770 (0.8063) acc_u 15.6250 (23.7500) lr 2.8187e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 373
confident_label rate tensor(0.6145, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 993
clean true:979
clean false:14
clean_rate:0.9859013091641491
noisy true:264
noisy false:359
after delete: len(clean_dataset) 993
after delete: len(noisy_dataset) 623
epoch [154/200] batch [5/31] time 0.246 (0.247) data 0.081 (0.082) loss_x loss_x 0.5220 (0.7103) acc_x 87.5000 (81.8750) lr 2.7103e-04 eta 0:00:06
epoch [154/200] batch [10/31] time 0.158 (0.236) data 0.081 (0.081) loss_x loss_x 0.6489 (0.6823) acc_x 81.2500 (81.8750) lr 2.7103e-04 eta 0:00:04
epoch [154/200] batch [15/31] time 0.245 (0.240) data 0.081 (0.081) loss_x loss_x 0.6895 (0.6293) acc_x 84.3750 (83.5417) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [20/31] time 0.248 (0.241) data 0.082 (0.081) loss_x loss_x 0.6040 (0.6109) acc_x 81.2500 (83.9062) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [25/31] time 0.246 (0.242) data 0.081 (0.081) loss_x loss_x 0.3899 (0.5829) acc_x 87.5000 (84.6250) lr 2.7103e-04 eta 0:00:01
epoch [154/200] batch [30/31] time 0.247 (0.243) data 0.081 (0.081) loss_x loss_x 0.2888 (0.5899) acc_x 96.8750 (84.8958) lr 2.7103e-04 eta 0:00:00
epoch [154/200] batch [5/19] time 0.258 (0.246) data 0.088 (0.084) loss_u loss_u 0.8149 (0.7976) acc_u 21.8750 (21.2500) lr 2.7103e-04 eta 0:00:03
epoch [154/200] batch [10/19] time 0.261 (0.245) data 0.090 (0.085) loss_u loss_u 0.8081 (0.7856) acc_u 18.7500 (23.1250) lr 2.7103e-04 eta 0:00:02
epoch [154/200] batch [15/19] time 0.243 (0.245) data 0.080 (0.084) loss_u loss_u 0.7310 (0.7952) acc_u 31.2500 (22.2917) lr 2.7103e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 372
confident_label rate tensor(0.6132, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 991
clean true:975
clean false:16
clean_rate:0.9838546922300706
noisy true:269
noisy false:356
after delete: len(clean_dataset) 991
after delete: len(noisy_dataset) 625
epoch [155/200] batch [5/30] time 0.242 (0.244) data 0.079 (0.080) loss_x loss_x 0.9141 (0.6448) acc_x 65.6250 (80.0000) lr 2.6037e-04 eta 0:00:06
epoch [155/200] batch [10/30] time 0.244 (0.244) data 0.082 (0.081) loss_x loss_x 0.6743 (0.6383) acc_x 81.2500 (83.1250) lr 2.6037e-04 eta 0:00:04
epoch [155/200] batch [15/30] time 0.245 (0.244) data 0.080 (0.081) loss_x loss_x 0.5029 (0.6057) acc_x 84.3750 (84.7917) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [20/30] time 0.244 (0.236) data 0.080 (0.081) loss_x loss_x 0.5054 (0.6317) acc_x 87.5000 (83.9062) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [25/30] time 0.242 (0.237) data 0.079 (0.081) loss_x loss_x 0.4390 (0.6244) acc_x 84.3750 (83.7500) lr 2.6037e-04 eta 0:00:01
epoch [155/200] batch [30/30] time 0.243 (0.238) data 0.081 (0.081) loss_x loss_x 0.6768 (0.6268) acc_x 84.3750 (83.5417) lr 2.6037e-04 eta 0:00:00
epoch [155/200] batch [5/19] time 0.242 (0.239) data 0.081 (0.081) loss_u loss_u 0.7798 (0.8438) acc_u 25.0000 (18.7500) lr 2.6037e-04 eta 0:00:03
epoch [155/200] batch [10/19] time 0.256 (0.240) data 0.091 (0.081) loss_u loss_u 0.8193 (0.8465) acc_u 21.8750 (17.8125) lr 2.6037e-04 eta 0:00:02
epoch [155/200] batch [15/19] time 0.242 (0.241) data 0.081 (0.081) loss_u loss_u 0.7939 (0.8211) acc_u 31.2500 (20.8333) lr 2.6037e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 357
confident_label rate tensor(0.6157, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 995
clean true:982
clean false:13
clean_rate:0.9869346733668342
noisy true:277
noisy false:344
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 621
epoch [156/200] batch [5/31] time 0.161 (0.211) data 0.082 (0.080) loss_x loss_x 0.3013 (0.4006) acc_x 90.6250 (90.6250) lr 2.4989e-04 eta 0:00:05
epoch [156/200] batch [10/31] time 0.240 (0.227) data 0.080 (0.080) loss_x loss_x 0.6421 (0.4983) acc_x 78.1250 (87.1875) lr 2.4989e-04 eta 0:00:04
epoch [156/200] batch [15/31] time 0.243 (0.233) data 0.081 (0.080) loss_x loss_x 1.2422 (0.5571) acc_x 68.7500 (85.4167) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [20/31] time 0.245 (0.236) data 0.080 (0.080) loss_x loss_x 0.4155 (0.5676) acc_x 90.6250 (85.0000) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [25/31] time 0.245 (0.238) data 0.081 (0.080) loss_x loss_x 0.5234 (0.5694) acc_x 90.6250 (85.3750) lr 2.4989e-04 eta 0:00:01
epoch [156/200] batch [30/31] time 0.243 (0.239) data 0.080 (0.080) loss_x loss_x 0.3823 (0.5346) acc_x 90.6250 (86.3542) lr 2.4989e-04 eta 0:00:00
epoch [156/200] batch [5/19] time 0.245 (0.235) data 0.081 (0.080) loss_u loss_u 0.8276 (0.8296) acc_u 21.8750 (20.6250) lr 2.4989e-04 eta 0:00:03
epoch [156/200] batch [10/19] time 0.249 (0.237) data 0.079 (0.080) loss_u loss_u 0.7944 (0.8292) acc_u 25.0000 (20.3125) lr 2.4989e-04 eta 0:00:02
epoch [156/200] batch [15/19] time 0.243 (0.238) data 0.080 (0.080) loss_u loss_u 0.7490 (0.8078) acc_u 28.1250 (21.8750) lr 2.4989e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 378
confident_label rate tensor(0.6071, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 981
clean true:969
clean false:12
clean_rate:0.9877675840978594
noisy true:269
noisy false:366
after delete: len(clean_dataset) 981
after delete: len(noisy_dataset) 635
epoch [157/200] batch [5/30] time 0.215 (0.220) data 0.082 (0.081) loss_x loss_x 0.2871 (0.6110) acc_x 93.7500 (84.3750) lr 2.3959e-04 eta 0:00:05
epoch [157/200] batch [10/30] time 0.243 (0.231) data 0.080 (0.081) loss_x loss_x 0.3899 (0.5816) acc_x 93.7500 (84.6875) lr 2.3959e-04 eta 0:00:04
epoch [157/200] batch [15/30] time 0.242 (0.235) data 0.081 (0.081) loss_x loss_x 0.4868 (0.6135) acc_x 81.2500 (83.7500) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [20/30] time 0.244 (0.237) data 0.081 (0.080) loss_x loss_x 0.6069 (0.5948) acc_x 84.3750 (84.5312) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [25/30] time 0.242 (0.238) data 0.079 (0.080) loss_x loss_x 0.7119 (0.6037) acc_x 81.2500 (84.8750) lr 2.3959e-04 eta 0:00:01
epoch [157/200] batch [30/30] time 0.243 (0.239) data 0.080 (0.080) loss_x loss_x 0.5303 (0.5880) acc_x 84.3750 (85.4167) lr 2.3959e-04 eta 0:00:00
epoch [157/200] batch [5/19] time 0.161 (0.236) data 0.083 (0.080) loss_u loss_u 0.7759 (0.8497) acc_u 25.0000 (17.5000) lr 2.3959e-04 eta 0:00:03
epoch [157/200] batch [10/19] time 0.248 (0.238) data 0.079 (0.080) loss_u loss_u 0.7202 (0.8012) acc_u 31.2500 (23.1250) lr 2.3959e-04 eta 0:00:02
epoch [157/200] batch [15/19] time 0.250 (0.239) data 0.082 (0.080) loss_u loss_u 0.8013 (0.7892) acc_u 18.7500 (24.5833) lr 2.3959e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 374
confident_label rate tensor(0.6151, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 994
clean true:977
clean false:17
clean_rate:0.9828973843058351
noisy true:265
noisy false:357
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 622
epoch [158/200] batch [5/31] time 0.243 (0.244) data 0.082 (0.083) loss_x loss_x 0.6060 (0.4653) acc_x 87.5000 (87.5000) lr 2.2949e-04 eta 0:00:06
epoch [158/200] batch [10/31] time 0.242 (0.242) data 0.082 (0.082) loss_x loss_x 0.6128 (0.4918) acc_x 81.2500 (87.1875) lr 2.2949e-04 eta 0:00:05
epoch [158/200] batch [15/31] time 0.242 (0.243) data 0.080 (0.082) loss_x loss_x 0.6685 (0.5242) acc_x 84.3750 (86.4583) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [20/31] time 0.241 (0.237) data 0.081 (0.082) loss_x loss_x 0.6509 (0.5208) acc_x 81.2500 (87.0312) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [25/31] time 0.239 (0.238) data 0.080 (0.081) loss_x loss_x 0.6528 (0.5271) acc_x 87.5000 (87.3750) lr 2.2949e-04 eta 0:00:01
epoch [158/200] batch [30/31] time 0.241 (0.238) data 0.081 (0.081) loss_x loss_x 0.4048 (0.5317) acc_x 84.3750 (86.7708) lr 2.2949e-04 eta 0:00:00
epoch [158/200] batch [5/19] time 0.245 (0.239) data 0.081 (0.081) loss_u loss_u 0.8452 (0.7790) acc_u 18.7500 (26.2500) lr 2.2949e-04 eta 0:00:03
epoch [158/200] batch [10/19] time 0.249 (0.237) data 0.080 (0.081) loss_u loss_u 0.8628 (0.7942) acc_u 15.6250 (24.3750) lr 2.2949e-04 eta 0:00:02
epoch [158/200] batch [15/19] time 0.250 (0.238) data 0.079 (0.081) loss_u loss_u 0.7847 (0.7915) acc_u 25.0000 (24.5833) lr 2.2949e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 369
confident_label rate tensor(0.6120, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 989
clean true:973
clean false:16
clean_rate:0.9838220424671386
noisy true:274
noisy false:353
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 627
epoch [159/200] batch [5/30] time 0.247 (0.245) data 0.081 (0.081) loss_x loss_x 0.5308 (0.5885) acc_x 84.3750 (81.8750) lr 2.1957e-04 eta 0:00:06
epoch [159/200] batch [10/30] time 0.242 (0.245) data 0.078 (0.081) loss_x loss_x 0.6753 (0.6022) acc_x 81.2500 (84.0625) lr 2.1957e-04 eta 0:00:04
epoch [159/200] batch [15/30] time 0.246 (0.233) data 0.082 (0.081) loss_x loss_x 0.5425 (0.5646) acc_x 84.3750 (85.2083) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [20/30] time 0.242 (0.235) data 0.081 (0.081) loss_x loss_x 0.8325 (0.5325) acc_x 81.2500 (86.2500) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [25/30] time 0.241 (0.236) data 0.080 (0.081) loss_x loss_x 0.7041 (0.5270) acc_x 84.3750 (86.5000) lr 2.1957e-04 eta 0:00:01
epoch [159/200] batch [30/30] time 0.240 (0.237) data 0.079 (0.081) loss_x loss_x 0.3364 (0.5139) acc_x 90.6250 (87.1875) lr 2.1957e-04 eta 0:00:00
epoch [159/200] batch [5/19] time 0.243 (0.238) data 0.077 (0.080) loss_u loss_u 0.7378 (0.7923) acc_u 31.2500 (24.3750) lr 2.1957e-04 eta 0:00:03
epoch [159/200] batch [10/19] time 0.235 (0.239) data 0.081 (0.080) loss_u loss_u 0.8071 (0.7944) acc_u 25.0000 (24.3750) lr 2.1957e-04 eta 0:00:02
epoch [159/200] batch [15/19] time 0.244 (0.238) data 0.080 (0.080) loss_u loss_u 0.7905 (0.7902) acc_u 21.8750 (23.9583) lr 2.1957e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 368
confident_label rate tensor(0.6126, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 990
clean true:975
clean false:15
clean_rate:0.9848484848484849
noisy true:273
noisy false:353
after delete: len(clean_dataset) 990
after delete: len(noisy_dataset) 626
epoch [160/200] batch [5/30] time 0.245 (0.246) data 0.081 (0.081) loss_x loss_x 0.5049 (0.3473) acc_x 78.1250 (90.0000) lr 2.0984e-04 eta 0:00:06
epoch [160/200] batch [10/30] time 0.246 (0.244) data 0.081 (0.080) loss_x loss_x 0.1732 (0.4199) acc_x 96.8750 (88.7500) lr 2.0984e-04 eta 0:00:04
epoch [160/200] batch [15/30] time 0.245 (0.239) data 0.081 (0.081) loss_x loss_x 0.7622 (0.4829) acc_x 84.3750 (87.0833) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [20/30] time 0.245 (0.240) data 0.079 (0.080) loss_x loss_x 0.5078 (0.4936) acc_x 87.5000 (86.7188) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [25/30] time 0.247 (0.241) data 0.082 (0.081) loss_x loss_x 0.1558 (0.5233) acc_x 96.8750 (86.1250) lr 2.0984e-04 eta 0:00:01
epoch [160/200] batch [30/30] time 0.257 (0.243) data 0.093 (0.081) loss_x loss_x 0.7202 (0.5335) acc_x 78.1250 (85.9375) lr 2.0984e-04 eta 0:00:00
epoch [160/200] batch [5/19] time 0.255 (0.244) data 0.084 (0.082) loss_u loss_u 0.6768 (0.7705) acc_u 37.5000 (25.6250) lr 2.0984e-04 eta 0:00:03
epoch [160/200] batch [10/19] time 0.236 (0.244) data 0.081 (0.082) loss_u loss_u 0.8726 (0.7678) acc_u 15.6250 (26.5625) lr 2.0984e-04 eta 0:00:02
epoch [160/200] batch [15/19] time 0.239 (0.242) data 0.080 (0.082) loss_u loss_u 0.9170 (0.7888) acc_u 9.3750 (24.3750) lr 2.0984e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 364
confident_label rate tensor(0.6269, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1013
clean true:989
clean false:24
clean_rate:0.9763079960513327
noisy true:263
noisy false:340
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 603
epoch [161/200] batch [5/31] time 0.243 (0.242) data 0.078 (0.078) loss_x loss_x 0.5981 (0.5837) acc_x 84.3750 (84.3750) lr 2.0032e-04 eta 0:00:06
epoch [161/200] batch [10/31] time 0.246 (0.243) data 0.081 (0.079) loss_x loss_x 0.5464 (0.4931) acc_x 81.2500 (87.5000) lr 2.0032e-04 eta 0:00:05
epoch [161/200] batch [15/31] time 0.260 (0.239) data 0.084 (0.080) loss_x loss_x 0.6553 (0.5233) acc_x 84.3750 (86.0417) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [20/31] time 0.251 (0.241) data 0.087 (0.081) loss_x loss_x 0.6826 (0.5347) acc_x 87.5000 (86.5625) lr 2.0032e-04 eta 0:00:02
epoch [161/200] batch [25/31] time 0.245 (0.241) data 0.079 (0.081) loss_x loss_x 0.4509 (0.5349) acc_x 90.6250 (86.7500) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [30/31] time 0.246 (0.242) data 0.087 (0.081) loss_x loss_x 0.3438 (0.5069) acc_x 93.7500 (87.5000) lr 2.0032e-04 eta 0:00:00
epoch [161/200] batch [5/18] time 0.244 (0.243) data 0.079 (0.081) loss_u loss_u 0.7954 (0.8187) acc_u 25.0000 (20.6250) lr 2.0032e-04 eta 0:00:03
epoch [161/200] batch [10/18] time 0.254 (0.242) data 0.083 (0.081) loss_u loss_u 0.7954 (0.8154) acc_u 25.0000 (21.2500) lr 2.0032e-04 eta 0:00:01
epoch [161/200] batch [15/18] time 0.251 (0.243) data 0.080 (0.081) loss_u loss_u 0.7998 (0.8065) acc_u 21.8750 (21.8750) lr 2.0032e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 382
confident_label rate tensor(0.6095, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 985
clean true:970
clean false:15
clean_rate:0.9847715736040609
noisy true:264
noisy false:367
after delete: len(clean_dataset) 985
after delete: len(noisy_dataset) 631
epoch [162/200] batch [5/30] time 0.239 (0.245) data 0.080 (0.081) loss_x loss_x 0.3469 (0.6061) acc_x 96.8750 (88.7500) lr 1.9098e-04 eta 0:00:06
epoch [162/200] batch [10/30] time 0.247 (0.230) data 0.083 (0.081) loss_x loss_x 1.0771 (0.6226) acc_x 78.1250 (88.1250) lr 1.9098e-04 eta 0:00:04
epoch [162/200] batch [15/30] time 0.245 (0.235) data 0.080 (0.081) loss_x loss_x 0.6543 (0.5475) acc_x 84.3750 (88.3333) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [20/30] time 0.247 (0.238) data 0.080 (0.081) loss_x loss_x 0.5166 (0.5321) acc_x 90.6250 (88.4375) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [25/30] time 0.240 (0.239) data 0.080 (0.081) loss_x loss_x 0.1385 (0.5020) acc_x 100.0000 (89.1250) lr 1.9098e-04 eta 0:00:01
epoch [162/200] batch [30/30] time 0.243 (0.240) data 0.080 (0.081) loss_x loss_x 0.5298 (0.5222) acc_x 81.2500 (88.1250) lr 1.9098e-04 eta 0:00:00
epoch [162/200] batch [5/19] time 0.158 (0.239) data 0.080 (0.081) loss_u loss_u 0.8574 (0.8130) acc_u 15.6250 (22.5000) lr 1.9098e-04 eta 0:00:03
epoch [162/200] batch [10/19] time 0.249 (0.240) data 0.079 (0.081) loss_u loss_u 0.7949 (0.7986) acc_u 25.0000 (23.4375) lr 1.9098e-04 eta 0:00:02
epoch [162/200] batch [15/19] time 0.250 (0.241) data 0.080 (0.081) loss_u loss_u 0.8213 (0.7952) acc_u 18.7500 (24.1667) lr 1.9098e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 368
confident_label rate tensor(0.6071, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 981
clean true:964
clean false:17
clean_rate:0.9826707441386341
noisy true:284
noisy false:351
after delete: len(clean_dataset) 981
after delete: len(noisy_dataset) 635
epoch [163/200] batch [5/30] time 0.246 (0.245) data 0.083 (0.083) loss_x loss_x 0.6509 (0.5024) acc_x 87.5000 (87.5000) lr 1.8185e-04 eta 0:00:06
epoch [163/200] batch [10/30] time 0.246 (0.245) data 0.081 (0.082) loss_x loss_x 0.5337 (0.5672) acc_x 78.1250 (84.3750) lr 1.8185e-04 eta 0:00:04
epoch [163/200] batch [15/30] time 0.173 (0.234) data 0.081 (0.082) loss_x loss_x 0.6963 (0.5911) acc_x 78.1250 (84.3750) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [20/30] time 0.246 (0.237) data 0.080 (0.082) loss_x loss_x 0.6646 (0.5740) acc_x 87.5000 (85.7812) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [25/30] time 0.246 (0.239) data 0.080 (0.082) loss_x loss_x 0.7427 (0.5653) acc_x 81.2500 (86.0000) lr 1.8185e-04 eta 0:00:01
epoch [163/200] batch [30/30] time 0.246 (0.240) data 0.083 (0.082) loss_x loss_x 0.7217 (0.5750) acc_x 81.2500 (85.9375) lr 1.8185e-04 eta 0:00:00
epoch [163/200] batch [5/19] time 0.248 (0.241) data 0.083 (0.082) loss_u loss_u 0.6333 (0.7438) acc_u 40.6250 (28.7500) lr 1.8185e-04 eta 0:00:03
epoch [163/200] batch [10/19] time 0.250 (0.242) data 0.083 (0.082) loss_u loss_u 0.7173 (0.7664) acc_u 31.2500 (26.2500) lr 1.8185e-04 eta 0:00:02
epoch [163/200] batch [15/19] time 0.262 (0.241) data 0.080 (0.082) loss_u loss_u 0.8652 (0.7789) acc_u 12.5000 (25.0000) lr 1.8185e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 355
confident_label rate tensor(0.6114, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 988
clean true:974
clean false:14
clean_rate:0.9858299595141701
noisy true:287
noisy false:341
after delete: len(clean_dataset) 988
after delete: len(noisy_dataset) 628
epoch [164/200] batch [5/30] time 0.241 (0.242) data 0.081 (0.083) loss_x loss_x 0.6987 (0.4876) acc_x 81.2500 (88.7500) lr 1.7292e-04 eta 0:00:06
epoch [164/200] batch [10/30] time 0.244 (0.243) data 0.083 (0.082) loss_x loss_x 0.2223 (0.4610) acc_x 93.7500 (89.0625) lr 1.7292e-04 eta 0:00:04
epoch [164/200] batch [15/30] time 0.240 (0.242) data 0.080 (0.082) loss_x loss_x 0.2605 (0.4748) acc_x 96.8750 (88.9583) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [20/30] time 0.247 (0.239) data 0.083 (0.083) loss_x loss_x 0.5576 (0.5247) acc_x 81.2500 (87.6562) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [25/30] time 0.243 (0.240) data 0.079 (0.082) loss_x loss_x 0.5811 (0.5320) acc_x 84.3750 (87.0000) lr 1.7292e-04 eta 0:00:01
epoch [164/200] batch [30/30] time 0.248 (0.241) data 0.085 (0.082) loss_x loss_x 0.5059 (0.5199) acc_x 84.3750 (87.1875) lr 1.7292e-04 eta 0:00:00
epoch [164/200] batch [5/19] time 0.248 (0.242) data 0.082 (0.082) loss_u loss_u 0.7563 (0.7988) acc_u 31.2500 (23.1250) lr 1.7292e-04 eta 0:00:03
epoch [164/200] batch [10/19] time 0.246 (0.243) data 0.081 (0.082) loss_u loss_u 0.7842 (0.7780) acc_u 21.8750 (25.6250) lr 1.7292e-04 eta 0:00:02
epoch [164/200] batch [15/19] time 0.252 (0.243) data 0.083 (0.082) loss_u loss_u 0.7646 (0.7845) acc_u 25.0000 (24.3750) lr 1.7292e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 401
confident_label rate tensor(0.6033, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 975
clean true:962
clean false:13
clean_rate:0.9866666666666667
noisy true:253
noisy false:388
after delete: len(clean_dataset) 975
after delete: len(noisy_dataset) 641
epoch [165/200] batch [5/30] time 0.240 (0.224) data 0.080 (0.080) loss_x loss_x 0.4438 (0.5209) acc_x 93.7500 (88.1250) lr 1.6419e-04 eta 0:00:05
epoch [165/200] batch [10/30] time 0.239 (0.231) data 0.080 (0.080) loss_x loss_x 0.2563 (0.4483) acc_x 93.7500 (89.0625) lr 1.6419e-04 eta 0:00:04
epoch [165/200] batch [15/30] time 0.236 (0.234) data 0.080 (0.080) loss_x loss_x 0.9092 (0.5105) acc_x 75.0000 (86.6667) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [20/30] time 0.243 (0.236) data 0.083 (0.080) loss_x loss_x 0.7793 (0.5288) acc_x 78.1250 (86.0938) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [25/30] time 0.243 (0.234) data 0.079 (0.080) loss_x loss_x 0.6128 (0.5373) acc_x 90.6250 (85.8750) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [30/30] time 0.244 (0.235) data 0.084 (0.080) loss_x loss_x 0.2563 (0.5352) acc_x 96.8750 (86.1458) lr 1.6419e-04 eta 0:00:00
epoch [165/200] batch [5/20] time 0.249 (0.237) data 0.080 (0.080) loss_u loss_u 0.8408 (0.8116) acc_u 15.6250 (21.2500) lr 1.6419e-04 eta 0:00:03
epoch [165/200] batch [10/20] time 0.248 (0.237) data 0.080 (0.080) loss_u loss_u 0.6982 (0.7972) acc_u 31.2500 (22.1875) lr 1.6419e-04 eta 0:00:02
epoch [165/200] batch [15/20] time 0.257 (0.238) data 0.090 (0.081) loss_u loss_u 0.7881 (0.7934) acc_u 28.1250 (23.7500) lr 1.6419e-04 eta 0:00:01
epoch [165/200] batch [20/20] time 0.249 (0.239) data 0.082 (0.081) loss_u loss_u 0.7383 (0.7857) acc_u 28.1250 (24.3750) lr 1.6419e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 362
confident_label rate tensor(0.6077, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 982
clean true:971
clean false:11
clean_rate:0.9887983706720977
noisy true:283
noisy false:351
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 634
epoch [166/200] batch [5/30] time 0.243 (0.242) data 0.081 (0.081) loss_x loss_x 0.4045 (0.5434) acc_x 87.5000 (86.8750) lr 1.5567e-04 eta 0:00:06
epoch [166/200] batch [10/30] time 0.241 (0.242) data 0.079 (0.080) loss_x loss_x 0.6792 (0.5777) acc_x 81.2500 (85.9375) lr 1.5567e-04 eta 0:00:04
epoch [166/200] batch [15/30] time 0.247 (0.230) data 0.080 (0.080) loss_x loss_x 0.3101 (0.5620) acc_x 93.7500 (86.0417) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [20/30] time 0.243 (0.234) data 0.083 (0.080) loss_x loss_x 0.7007 (0.5574) acc_x 81.2500 (85.6250) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [25/30] time 0.246 (0.236) data 0.081 (0.080) loss_x loss_x 0.4297 (0.5565) acc_x 87.5000 (85.3750) lr 1.5567e-04 eta 0:00:01
epoch [166/200] batch [30/30] time 0.242 (0.237) data 0.079 (0.080) loss_x loss_x 0.6929 (0.5580) acc_x 87.5000 (85.1042) lr 1.5567e-04 eta 0:00:00
epoch [166/200] batch [5/19] time 0.245 (0.238) data 0.078 (0.080) loss_u loss_u 0.8501 (0.8191) acc_u 18.7500 (21.8750) lr 1.5567e-04 eta 0:00:03
epoch [166/200] batch [10/19] time 0.248 (0.239) data 0.079 (0.080) loss_u loss_u 0.8394 (0.8029) acc_u 18.7500 (23.1250) lr 1.5567e-04 eta 0:00:02
epoch [166/200] batch [15/19] time 0.174 (0.236) data 0.082 (0.080) loss_u loss_u 0.7275 (0.8075) acc_u 34.3750 (22.7083) lr 1.5567e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 343
confident_label rate tensor(0.6269, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1013
clean true:996
clean false:17
clean_rate:0.983218163869694
noisy true:277
noisy false:326
after delete: len(clean_dataset) 1013
after delete: len(noisy_dataset) 603
epoch [167/200] batch [5/31] time 0.242 (0.240) data 0.080 (0.080) loss_x loss_x 0.4834 (0.6409) acc_x 84.3750 (82.5000) lr 1.4736e-04 eta 0:00:06
epoch [167/200] batch [10/31] time 0.243 (0.241) data 0.081 (0.080) loss_x loss_x 0.4626 (0.6136) acc_x 87.5000 (84.3750) lr 1.4736e-04 eta 0:00:05
epoch [167/200] batch [15/31] time 0.241 (0.233) data 0.083 (0.081) loss_x loss_x 0.5312 (0.5957) acc_x 84.3750 (84.1667) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [20/31] time 0.242 (0.235) data 0.080 (0.080) loss_x loss_x 0.2908 (0.6223) acc_x 90.6250 (84.2188) lr 1.4736e-04 eta 0:00:02
epoch [167/200] batch [25/31] time 0.247 (0.234) data 0.082 (0.081) loss_x loss_x 0.6157 (0.6057) acc_x 84.3750 (84.7500) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [30/31] time 0.246 (0.236) data 0.082 (0.081) loss_x loss_x 0.7275 (0.6093) acc_x 78.1250 (84.5833) lr 1.4736e-04 eta 0:00:00
epoch [167/200] batch [5/18] time 0.249 (0.238) data 0.082 (0.081) loss_u loss_u 0.7129 (0.8159) acc_u 34.3750 (21.8750) lr 1.4736e-04 eta 0:00:03
epoch [167/200] batch [10/18] time 0.248 (0.239) data 0.080 (0.081) loss_u loss_u 0.8511 (0.8273) acc_u 18.7500 (20.3125) lr 1.4736e-04 eta 0:00:01
epoch [167/200] batch [15/18] time 0.248 (0.240) data 0.079 (0.081) loss_u loss_u 0.8442 (0.8160) acc_u 15.6250 (21.0417) lr 1.4736e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 362
confident_label rate tensor(0.6194, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1001
clean true:981
clean false:20
clean_rate:0.98001998001998
noisy true:273
noisy false:342
after delete: len(clean_dataset) 1001
after delete: len(noisy_dataset) 615
epoch [168/200] batch [5/31] time 0.251 (0.258) data 0.089 (0.096) loss_x loss_x 0.5273 (0.4437) acc_x 87.5000 (88.1250) lr 1.3926e-04 eta 0:00:06
epoch [168/200] batch [10/31] time 0.239 (0.251) data 0.079 (0.090) loss_x loss_x 0.7134 (0.5722) acc_x 78.1250 (85.6250) lr 1.3926e-04 eta 0:00:05
epoch [168/200] batch [15/31] time 0.246 (0.249) data 0.084 (0.088) loss_x loss_x 0.6328 (0.5469) acc_x 81.2500 (85.8333) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [20/31] time 0.237 (0.239) data 0.079 (0.086) loss_x loss_x 0.8511 (0.5833) acc_x 78.1250 (84.6875) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [25/31] time 0.240 (0.240) data 0.080 (0.085) loss_x loss_x 0.4475 (0.5428) acc_x 84.3750 (85.6250) lr 1.3926e-04 eta 0:00:01
epoch [168/200] batch [30/31] time 0.239 (0.240) data 0.080 (0.084) loss_x loss_x 0.7148 (0.5347) acc_x 71.8750 (85.4167) lr 1.3926e-04 eta 0:00:00
epoch [168/200] batch [5/19] time 0.248 (0.241) data 0.081 (0.084) loss_u loss_u 0.7427 (0.8207) acc_u 25.0000 (20.0000) lr 1.3926e-04 eta 0:00:03
epoch [168/200] batch [10/19] time 0.246 (0.242) data 0.079 (0.083) loss_u loss_u 0.7236 (0.8200) acc_u 31.2500 (21.5625) lr 1.3926e-04 eta 0:00:02
epoch [168/200] batch [15/19] time 0.244 (0.242) data 0.078 (0.083) loss_u loss_u 0.8428 (0.8082) acc_u 21.8750 (22.9167) lr 1.3926e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 382
confident_label rate tensor(0.6046, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 977
clean true:961
clean false:16
clean_rate:0.9836233367451381
noisy true:273
noisy false:366
after delete: len(clean_dataset) 977
after delete: len(noisy_dataset) 639
epoch [169/200] batch [5/30] time 0.241 (0.243) data 0.079 (0.079) loss_x loss_x 0.5640 (0.4946) acc_x 81.2500 (86.8750) lr 1.3137e-04 eta 0:00:06
epoch [169/200] batch [10/30] time 0.244 (0.243) data 0.081 (0.080) loss_x loss_x 0.5288 (0.4835) acc_x 84.3750 (86.2500) lr 1.3137e-04 eta 0:00:04
epoch [169/200] batch [15/30] time 0.244 (0.243) data 0.080 (0.081) loss_x loss_x 0.5522 (0.4353) acc_x 84.3750 (88.1250) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [20/30] time 0.245 (0.243) data 0.080 (0.080) loss_x loss_x 0.6772 (0.4518) acc_x 78.1250 (87.5000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [25/30] time 0.159 (0.240) data 0.081 (0.080) loss_x loss_x 0.3865 (0.4813) acc_x 90.6250 (86.6250) lr 1.3137e-04 eta 0:00:01
epoch [169/200] batch [30/30] time 0.251 (0.239) data 0.089 (0.082) loss_x loss_x 0.6665 (0.4958) acc_x 81.2500 (86.4583) lr 1.3137e-04 eta 0:00:00
epoch [169/200] batch [5/19] time 0.258 (0.242) data 0.091 (0.084) loss_u loss_u 0.8110 (0.7931) acc_u 18.7500 (24.3750) lr 1.3137e-04 eta 0:00:03
epoch [169/200] batch [10/19] time 0.249 (0.243) data 0.081 (0.084) loss_u loss_u 0.7759 (0.7881) acc_u 25.0000 (25.0000) lr 1.3137e-04 eta 0:00:02
epoch [169/200] batch [15/19] time 0.265 (0.245) data 0.103 (0.085) loss_u loss_u 0.8472 (0.7910) acc_u 21.8750 (24.3750) lr 1.3137e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 362
confident_label rate tensor(0.6120, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 989
clean true:976
clean false:13
clean_rate:0.9868554095045501
noisy true:278
noisy false:349
after delete: len(clean_dataset) 989
after delete: len(noisy_dataset) 627
epoch [170/200] batch [5/30] time 0.238 (0.241) data 0.079 (0.078) loss_x loss_x 0.2600 (0.5002) acc_x 96.8750 (89.3750) lr 1.2369e-04 eta 0:00:06
epoch [170/200] batch [10/30] time 0.243 (0.241) data 0.080 (0.078) loss_x loss_x 0.4722 (0.5248) acc_x 93.7500 (87.8125) lr 1.2369e-04 eta 0:00:04
epoch [170/200] batch [15/30] time 0.241 (0.241) data 0.078 (0.078) loss_x loss_x 1.1689 (0.6180) acc_x 75.0000 (86.4583) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [20/30] time 0.243 (0.233) data 0.078 (0.078) loss_x loss_x 0.4590 (0.6000) acc_x 84.3750 (86.0938) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [25/30] time 0.240 (0.235) data 0.077 (0.078) loss_x loss_x 1.0713 (0.5917) acc_x 75.0000 (86.2500) lr 1.2369e-04 eta 0:00:01
epoch [170/200] batch [30/30] time 0.237 (0.236) data 0.078 (0.078) loss_x loss_x 0.4460 (0.5688) acc_x 84.3750 (86.7708) lr 1.2369e-04 eta 0:00:00
epoch [170/200] batch [5/19] time 0.246 (0.237) data 0.079 (0.079) loss_u loss_u 0.8403 (0.8024) acc_u 18.7500 (21.8750) lr 1.2369e-04 eta 0:00:03
epoch [170/200] batch [10/19] time 0.243 (0.238) data 0.079 (0.078) loss_u loss_u 0.8354 (0.7930) acc_u 18.7500 (23.4375) lr 1.2369e-04 eta 0:00:02
epoch [170/200] batch [15/19] time 0.240 (0.239) data 0.077 (0.078) loss_u loss_u 0.6660 (0.7927) acc_u 37.5000 (23.1250) lr 1.2369e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 344
confident_label rate tensor(0.6262, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1012
clean true:995
clean false:17
clean_rate:0.983201581027668
noisy true:277
noisy false:327
after delete: len(clean_dataset) 1012
after delete: len(noisy_dataset) 604
epoch [171/200] batch [5/31] time 0.260 (0.263) data 0.101 (0.102) loss_x loss_x 0.4941 (0.5492) acc_x 84.3750 (86.2500) lr 1.1623e-04 eta 0:00:06
epoch [171/200] batch [10/31] time 0.259 (0.263) data 0.098 (0.101) loss_x loss_x 0.4072 (0.5095) acc_x 84.3750 (87.1875) lr 1.1623e-04 eta 0:00:05
epoch [171/200] batch [15/31] time 0.277 (0.256) data 0.101 (0.101) loss_x loss_x 0.3936 (0.4836) acc_x 87.5000 (87.9167) lr 1.1623e-04 eta 0:00:04
epoch [171/200] batch [20/31] time 0.271 (0.258) data 0.108 (0.101) loss_x loss_x 0.2507 (0.4715) acc_x 93.7500 (87.6562) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [25/31] time 0.264 (0.260) data 0.102 (0.102) loss_x loss_x 0.3513 (0.4845) acc_x 90.6250 (87.2500) lr 1.1623e-04 eta 0:00:01
epoch [171/200] batch [30/31] time 0.261 (0.261) data 0.102 (0.102) loss_x loss_x 0.7642 (0.4789) acc_x 78.1250 (87.3958) lr 1.1623e-04 eta 0:00:00
epoch [171/200] batch [5/18] time 0.265 (0.262) data 0.096 (0.101) loss_u loss_u 0.8291 (0.8293) acc_u 15.6250 (20.0000) lr 1.1623e-04 eta 0:00:03
epoch [171/200] batch [10/18] time 0.179 (0.258) data 0.101 (0.101) loss_u loss_u 0.8159 (0.8297) acc_u 25.0000 (20.0000) lr 1.1623e-04 eta 0:00:02
epoch [171/200] batch [15/18] time 0.246 (0.257) data 0.078 (0.099) loss_u loss_u 0.6553 (0.8099) acc_u 37.5000 (22.0833) lr 1.1623e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 374
confident_label rate tensor(0.6095, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 985
clean true:969
clean false:16
clean_rate:0.983756345177665
noisy true:273
noisy false:358
after delete: len(clean_dataset) 985
after delete: len(noisy_dataset) 631
epoch [172/200] batch [5/30] time 0.243 (0.226) data 0.079 (0.079) loss_x loss_x 1.3506 (0.7465) acc_x 68.7500 (80.6250) lr 1.0899e-04 eta 0:00:05
epoch [172/200] batch [10/30] time 0.246 (0.235) data 0.080 (0.080) loss_x loss_x 0.4868 (0.6124) acc_x 81.2500 (84.0625) lr 1.0899e-04 eta 0:00:04
epoch [172/200] batch [15/30] time 0.243 (0.238) data 0.079 (0.080) loss_x loss_x 0.4587 (0.5476) acc_x 93.7500 (85.6250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [20/30] time 0.246 (0.239) data 0.081 (0.080) loss_x loss_x 0.4231 (0.5641) acc_x 87.5000 (85.7812) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [25/30] time 0.244 (0.240) data 0.078 (0.080) loss_x loss_x 0.2338 (0.5393) acc_x 93.7500 (86.3750) lr 1.0899e-04 eta 0:00:01
epoch [172/200] batch [30/30] time 0.250 (0.237) data 0.083 (0.080) loss_x loss_x 0.6484 (0.5825) acc_x 84.3750 (85.3125) lr 1.0899e-04 eta 0:00:00
epoch [172/200] batch [5/19] time 0.249 (0.238) data 0.081 (0.080) loss_u loss_u 0.6880 (0.7849) acc_u 31.2500 (23.1250) lr 1.0899e-04 eta 0:00:03
epoch [172/200] batch [10/19] time 0.246 (0.239) data 0.080 (0.080) loss_u loss_u 0.8364 (0.7865) acc_u 18.7500 (24.0625) lr 1.0899e-04 eta 0:00:02
epoch [172/200] batch [15/19] time 0.159 (0.238) data 0.081 (0.080) loss_u loss_u 0.8691 (0.8080) acc_u 12.5000 (21.6667) lr 1.0899e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 371
confident_label rate tensor(0.6058, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 979
clean true:963
clean false:16
clean_rate:0.9836567926455567
noisy true:282
noisy false:355
after delete: len(clean_dataset) 979
after delete: len(noisy_dataset) 637
epoch [173/200] batch [5/30] time 0.239 (0.240) data 0.078 (0.079) loss_x loss_x 0.5557 (0.5322) acc_x 90.6250 (88.1250) lr 1.0197e-04 eta 0:00:06
epoch [173/200] batch [10/30] time 0.236 (0.240) data 0.078 (0.079) loss_x loss_x 0.7012 (0.5068) acc_x 84.3750 (88.1250) lr 1.0197e-04 eta 0:00:04
epoch [173/200] batch [15/30] time 0.154 (0.228) data 0.076 (0.079) loss_x loss_x 0.8218 (0.5212) acc_x 75.0000 (87.5000) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [20/30] time 0.242 (0.232) data 0.080 (0.079) loss_x loss_x 0.5557 (0.5383) acc_x 84.3750 (86.0938) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [25/30] time 0.243 (0.234) data 0.080 (0.079) loss_x loss_x 0.7158 (0.5640) acc_x 81.2500 (85.6250) lr 1.0197e-04 eta 0:00:01
epoch [173/200] batch [30/30] time 0.241 (0.236) data 0.078 (0.079) loss_x loss_x 0.8472 (0.5521) acc_x 78.1250 (85.5208) lr 1.0197e-04 eta 0:00:00
epoch [173/200] batch [5/19] time 0.255 (0.238) data 0.086 (0.080) loss_u loss_u 0.7817 (0.7804) acc_u 25.0000 (23.7500) lr 1.0197e-04 eta 0:00:03
epoch [173/200] batch [10/19] time 0.252 (0.240) data 0.087 (0.081) loss_u loss_u 0.8374 (0.7820) acc_u 18.7500 (25.6250) lr 1.0197e-04 eta 0:00:02
epoch [173/200] batch [15/19] time 0.259 (0.239) data 0.099 (0.081) loss_u loss_u 0.7827 (0.8060) acc_u 25.0000 (22.5000) lr 1.0197e-04 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 359
confident_label rate tensor(0.6157, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 995
clean true:981
clean false:14
clean_rate:0.985929648241206
noisy true:276
noisy false:345
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 621
epoch [174/200] batch [5/31] time 0.241 (0.240) data 0.079 (0.079) loss_x loss_x 0.6978 (0.7298) acc_x 87.5000 (83.1250) lr 9.5173e-05 eta 0:00:06
epoch [174/200] batch [10/31] time 0.240 (0.240) data 0.077 (0.079) loss_x loss_x 0.8159 (0.7491) acc_x 81.2500 (81.8750) lr 9.5173e-05 eta 0:00:05
epoch [174/200] batch [15/31] time 0.238 (0.240) data 0.077 (0.079) loss_x loss_x 0.9785 (0.7102) acc_x 78.1250 (82.5000) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [20/31] time 0.249 (0.233) data 0.087 (0.080) loss_x loss_x 0.3235 (0.6802) acc_x 93.7500 (83.1250) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [25/31] time 0.243 (0.235) data 0.082 (0.080) loss_x loss_x 0.5527 (0.6503) acc_x 81.2500 (83.7500) lr 9.5173e-05 eta 0:00:01
epoch [174/200] batch [30/31] time 0.242 (0.236) data 0.081 (0.080) loss_x loss_x 0.1975 (0.6416) acc_x 96.8750 (83.9583) lr 9.5173e-05 eta 0:00:00
epoch [174/200] batch [5/19] time 0.246 (0.234) data 0.080 (0.080) loss_u loss_u 0.8154 (0.8242) acc_u 21.8750 (21.2500) lr 9.5173e-05 eta 0:00:03
epoch [174/200] batch [10/19] time 0.246 (0.236) data 0.081 (0.080) loss_u loss_u 0.8257 (0.8083) acc_u 18.7500 (22.1875) lr 9.5173e-05 eta 0:00:02
epoch [174/200] batch [15/19] time 0.253 (0.237) data 0.083 (0.080) loss_u loss_u 0.7554 (0.7933) acc_u 25.0000 (23.7500) lr 9.5173e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 362
confident_label rate tensor(0.6126, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 990
clean true:974
clean false:16
clean_rate:0.9838383838383838
noisy true:280
noisy false:346
after delete: len(clean_dataset) 990
after delete: len(noisy_dataset) 626
epoch [175/200] batch [5/30] time 0.242 (0.241) data 0.080 (0.080) loss_x loss_x 0.5508 (0.4784) acc_x 84.3750 (89.3750) lr 8.8597e-05 eta 0:00:06
epoch [175/200] batch [10/30] time 0.237 (0.240) data 0.080 (0.081) loss_x loss_x 0.4536 (0.4474) acc_x 87.5000 (89.3750) lr 8.8597e-05 eta 0:00:04
epoch [175/200] batch [15/30] time 0.240 (0.240) data 0.081 (0.081) loss_x loss_x 0.4036 (0.4850) acc_x 90.6250 (88.7500) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [20/30] time 0.243 (0.240) data 0.081 (0.081) loss_x loss_x 0.3438 (0.4928) acc_x 93.7500 (88.1250) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [25/30] time 0.252 (0.242) data 0.092 (0.082) loss_x loss_x 0.3569 (0.5289) acc_x 87.5000 (87.1250) lr 8.8597e-05 eta 0:00:01
epoch [175/200] batch [30/30] time 0.182 (0.239) data 0.080 (0.083) loss_x loss_x 0.7417 (0.5381) acc_x 81.2500 (86.5625) lr 8.8597e-05 eta 0:00:00
epoch [175/200] batch [5/19] time 0.242 (0.240) data 0.081 (0.083) loss_u loss_u 0.8374 (0.8103) acc_u 21.8750 (22.5000) lr 8.8597e-05 eta 0:00:03
epoch [175/200] batch [10/19] time 0.246 (0.240) data 0.081 (0.083) loss_u loss_u 0.7861 (0.8018) acc_u 21.8750 (23.1250) lr 8.8597e-05 eta 0:00:02
epoch [175/200] batch [15/19] time 0.246 (0.241) data 0.084 (0.083) loss_u loss_u 0.7432 (0.8076) acc_u 28.1250 (22.0833) lr 8.8597e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 364
confident_label rate tensor(0.6151, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 994
clean true:978
clean false:16
clean_rate:0.9839034205231388
noisy true:274
noisy false:348
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 622
epoch [176/200] batch [5/31] time 0.239 (0.225) data 0.078 (0.081) loss_x loss_x 0.5732 (0.5822) acc_x 81.2500 (80.6250) lr 8.2245e-05 eta 0:00:05
epoch [176/200] batch [10/31] time 0.240 (0.233) data 0.081 (0.081) loss_x loss_x 0.6943 (0.5513) acc_x 81.2500 (84.0625) lr 8.2245e-05 eta 0:00:04
epoch [176/200] batch [15/31] time 0.243 (0.236) data 0.082 (0.081) loss_x loss_x 0.5474 (0.5014) acc_x 87.5000 (86.2500) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [20/31] time 0.241 (0.238) data 0.083 (0.082) loss_x loss_x 0.5498 (0.5127) acc_x 84.3750 (85.7812) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [25/31] time 0.242 (0.239) data 0.081 (0.082) loss_x loss_x 0.5620 (0.5222) acc_x 90.6250 (86.1250) lr 8.2245e-05 eta 0:00:01
epoch [176/200] batch [30/31] time 0.234 (0.239) data 0.078 (0.082) loss_x loss_x 0.6484 (0.5181) acc_x 84.3750 (86.2500) lr 8.2245e-05 eta 0:00:00
epoch [176/200] batch [5/19] time 0.243 (0.238) data 0.083 (0.082) loss_u loss_u 0.8022 (0.8231) acc_u 21.8750 (20.0000) lr 8.2245e-05 eta 0:00:03
epoch [176/200] batch [10/19] time 0.242 (0.238) data 0.081 (0.082) loss_u loss_u 0.8315 (0.8194) acc_u 18.7500 (21.2500) lr 8.2245e-05 eta 0:00:02
epoch [176/200] batch [15/19] time 0.241 (0.239) data 0.079 (0.081) loss_u loss_u 0.8672 (0.8045) acc_u 12.5000 (22.5000) lr 8.2245e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 372
confident_label rate tensor(0.6108, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 987
clean true:971
clean false:16
clean_rate:0.983789260385005
noisy true:273
noisy false:356
after delete: len(clean_dataset) 987
after delete: len(noisy_dataset) 629
epoch [177/200] batch [5/30] time 0.244 (0.243) data 0.077 (0.078) loss_x loss_x 0.3894 (0.5895) acc_x 90.6250 (86.2500) lr 7.6120e-05 eta 0:00:06
epoch [177/200] batch [10/30] time 0.237 (0.233) data 0.076 (0.078) loss_x loss_x 0.7183 (0.6761) acc_x 78.1250 (82.1875) lr 7.6120e-05 eta 0:00:04
epoch [177/200] batch [15/30] time 0.238 (0.235) data 0.078 (0.078) loss_x loss_x 0.4407 (0.6157) acc_x 93.7500 (83.7500) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [20/30] time 0.242 (0.236) data 0.083 (0.078) loss_x loss_x 0.4194 (0.6113) acc_x 87.5000 (83.7500) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [25/30] time 0.243 (0.237) data 0.080 (0.078) loss_x loss_x 0.3005 (0.5970) acc_x 93.7500 (84.3750) lr 7.6120e-05 eta 0:00:01
epoch [177/200] batch [30/30] time 0.244 (0.238) data 0.081 (0.079) loss_x loss_x 0.3638 (0.5788) acc_x 90.6250 (85.0000) lr 7.6120e-05 eta 0:00:00
epoch [177/200] batch [5/19] time 0.247 (0.239) data 0.081 (0.079) loss_u loss_u 0.7090 (0.7882) acc_u 34.3750 (25.0000) lr 7.6120e-05 eta 0:00:03
epoch [177/200] batch [10/19] time 0.251 (0.236) data 0.083 (0.079) loss_u loss_u 0.6758 (0.7633) acc_u 37.5000 (27.1875) lr 7.6120e-05 eta 0:00:02
epoch [177/200] batch [15/19] time 0.247 (0.235) data 0.079 (0.079) loss_u loss_u 0.8096 (0.7856) acc_u 28.1250 (25.0000) lr 7.6120e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 370
confident_label rate tensor(0.6132, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 991
clean true:976
clean false:15
clean_rate:0.9848637739656912
noisy true:270
noisy false:355
after delete: len(clean_dataset) 991
after delete: len(noisy_dataset) 625
epoch [178/200] batch [5/30] time 0.245 (0.244) data 0.081 (0.081) loss_x loss_x 0.2976 (0.5432) acc_x 93.7500 (88.7500) lr 7.0224e-05 eta 0:00:06
epoch [178/200] batch [10/30] time 0.244 (0.244) data 0.078 (0.080) loss_x loss_x 0.7300 (0.5417) acc_x 87.5000 (88.7500) lr 7.0224e-05 eta 0:00:04
epoch [178/200] batch [15/30] time 0.241 (0.244) data 0.079 (0.080) loss_x loss_x 0.6460 (0.5409) acc_x 81.2500 (88.1250) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [20/30] time 0.244 (0.236) data 0.082 (0.080) loss_x loss_x 0.5923 (0.5639) acc_x 81.2500 (86.8750) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [25/30] time 0.242 (0.238) data 0.080 (0.081) loss_x loss_x 0.2942 (0.5252) acc_x 96.8750 (87.7500) lr 7.0224e-05 eta 0:00:01
epoch [178/200] batch [30/30] time 0.241 (0.238) data 0.080 (0.081) loss_x loss_x 0.5991 (0.5263) acc_x 81.2500 (87.5000) lr 7.0224e-05 eta 0:00:00
epoch [178/200] batch [5/19] time 0.249 (0.239) data 0.084 (0.081) loss_u loss_u 0.8081 (0.7790) acc_u 21.8750 (25.0000) lr 7.0224e-05 eta 0:00:03
epoch [178/200] batch [10/19] time 0.248 (0.240) data 0.082 (0.081) loss_u loss_u 0.8809 (0.7954) acc_u 15.6250 (24.0625) lr 7.0224e-05 eta 0:00:02
epoch [178/200] batch [15/19] time 0.248 (0.241) data 0.083 (0.081) loss_u loss_u 0.7441 (0.7847) acc_u 28.1250 (25.0000) lr 7.0224e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 369
confident_label rate tensor(0.6077, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 982
clean true:968
clean false:14
clean_rate:0.9857433808553971
noisy true:279
noisy false:355
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 634
epoch [179/200] batch [5/30] time 0.246 (0.244) data 0.081 (0.080) loss_x loss_x 0.1965 (0.4085) acc_x 96.8750 (90.6250) lr 6.4556e-05 eta 0:00:06
epoch [179/200] batch [10/30] time 0.244 (0.244) data 0.078 (0.080) loss_x loss_x 0.6938 (0.4524) acc_x 81.2500 (89.0625) lr 6.4556e-05 eta 0:00:04
epoch [179/200] batch [15/30] time 0.154 (0.238) data 0.077 (0.079) loss_x loss_x 0.7671 (0.4558) acc_x 81.2500 (88.3333) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [20/30] time 0.237 (0.239) data 0.076 (0.079) loss_x loss_x 0.6738 (0.5023) acc_x 84.3750 (87.5000) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [25/30] time 0.244 (0.240) data 0.078 (0.079) loss_x loss_x 0.6963 (0.5115) acc_x 81.2500 (87.1250) lr 6.4556e-05 eta 0:00:01
epoch [179/200] batch [30/30] time 0.242 (0.240) data 0.077 (0.079) loss_x loss_x 0.8369 (0.4999) acc_x 84.3750 (87.3958) lr 6.4556e-05 eta 0:00:00
epoch [179/200] batch [5/19] time 0.244 (0.241) data 0.077 (0.079) loss_u loss_u 0.8447 (0.8216) acc_u 21.8750 (21.8750) lr 6.4556e-05 eta 0:00:03
epoch [179/200] batch [10/19] time 0.250 (0.242) data 0.083 (0.079) loss_u loss_u 0.8330 (0.8000) acc_u 21.8750 (24.0625) lr 6.4556e-05 eta 0:00:02
epoch [179/200] batch [15/19] time 0.157 (0.238) data 0.079 (0.079) loss_u loss_u 0.8818 (0.8018) acc_u 15.6250 (23.5417) lr 6.4556e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 357
confident_label rate tensor(0.6151, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 994
clean true:977
clean false:17
clean_rate:0.9828973843058351
noisy true:282
noisy false:340
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 622
epoch [180/200] batch [5/31] time 0.158 (0.157) data 0.081 (0.081) loss_x loss_x 0.7959 (0.5118) acc_x 84.3750 (89.3750) lr 5.9119e-05 eta 0:00:04
epoch [180/200] batch [10/31] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.6836 (0.4993) acc_x 81.2500 (88.4375) lr 5.9119e-05 eta 0:00:03
epoch [180/200] batch [15/31] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.3801 (0.4869) acc_x 87.5000 (88.5417) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [20/31] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.2363 (0.4739) acc_x 87.5000 (88.7500) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [25/31] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.4368 (0.4673) acc_x 93.7500 (88.6250) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [30/31] time 0.157 (0.158) data 0.079 (0.081) loss_x loss_x 0.3220 (0.4675) acc_x 90.6250 (88.6458) lr 5.9119e-05 eta 0:00:00
epoch [180/200] batch [5/19] time 0.157 (0.158) data 0.080 (0.081) loss_u loss_u 0.8208 (0.7831) acc_u 21.8750 (25.6250) lr 5.9119e-05 eta 0:00:02
epoch [180/200] batch [10/19] time 0.158 (0.158) data 0.081 (0.081) loss_u loss_u 0.8413 (0.7823) acc_u 18.7500 (25.3125) lr 5.9119e-05 eta 0:00:01
epoch [180/200] batch [15/19] time 0.158 (0.158) data 0.080 (0.081) loss_u loss_u 0.8550 (0.7792) acc_u 12.5000 (24.3750) lr 5.9119e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 334
confident_label rate tensor(0.6225, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1006
clean true:993
clean false:13
clean_rate:0.9870775347912525
noisy true:289
noisy false:321
after delete: len(clean_dataset) 1006
after delete: len(noisy_dataset) 610
epoch [181/200] batch [5/31] time 0.154 (0.155) data 0.077 (0.078) loss_x loss_x 0.3159 (0.4441) acc_x 93.7500 (88.1250) lr 5.3915e-05 eta 0:00:04
epoch [181/200] batch [10/31] time 0.155 (0.155) data 0.079 (0.078) loss_x loss_x 0.9365 (0.4799) acc_x 81.2500 (88.7500) lr 5.3915e-05 eta 0:00:03
epoch [181/200] batch [15/31] time 0.154 (0.155) data 0.077 (0.078) loss_x loss_x 0.4978 (0.4306) acc_x 90.6250 (89.7917) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [20/31] time 0.154 (0.155) data 0.077 (0.078) loss_x loss_x 0.5703 (0.4960) acc_x 81.2500 (87.6562) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [25/31] time 0.155 (0.156) data 0.078 (0.079) loss_x loss_x 0.6880 (0.4897) acc_x 78.1250 (87.6250) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [30/31] time 0.156 (0.155) data 0.079 (0.079) loss_x loss_x 0.2354 (0.4858) acc_x 90.6250 (87.5000) lr 5.3915e-05 eta 0:00:00
epoch [181/200] batch [5/19] time 0.159 (0.156) data 0.082 (0.079) loss_u loss_u 0.8394 (0.8080) acc_u 18.7500 (22.5000) lr 5.3915e-05 eta 0:00:02
epoch [181/200] batch [10/19] time 0.156 (0.156) data 0.078 (0.079) loss_u loss_u 0.8149 (0.8079) acc_u 21.8750 (22.8125) lr 5.3915e-05 eta 0:00:01
epoch [181/200] batch [15/19] time 0.156 (0.156) data 0.078 (0.079) loss_u loss_u 0.8013 (0.8074) acc_u 21.8750 (22.0833) lr 5.3915e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 351
confident_label rate tensor(0.6225, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1006
clean true:992
clean false:14
clean_rate:0.9860834990059643
noisy true:273
noisy false:337
after delete: len(clean_dataset) 1006
after delete: len(noisy_dataset) 610
epoch [182/200] batch [5/31] time 0.158 (0.156) data 0.081 (0.079) loss_x loss_x 0.6567 (0.5732) acc_x 87.5000 (86.2500) lr 4.8943e-05 eta 0:00:04
epoch [182/200] batch [10/31] time 0.158 (0.156) data 0.081 (0.079) loss_x loss_x 0.5723 (0.5452) acc_x 87.5000 (86.8750) lr 4.8943e-05 eta 0:00:03
epoch [182/200] batch [15/31] time 0.154 (0.156) data 0.077 (0.079) loss_x loss_x 0.6680 (0.5157) acc_x 81.2500 (86.8750) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [20/31] time 0.155 (0.156) data 0.078 (0.079) loss_x loss_x 0.6089 (0.5362) acc_x 87.5000 (86.8750) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [25/31] time 0.155 (0.156) data 0.078 (0.079) loss_x loss_x 0.4976 (0.5639) acc_x 90.6250 (86.3750) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [30/31] time 0.155 (0.156) data 0.078 (0.079) loss_x loss_x 0.5791 (0.5517) acc_x 84.3750 (86.4583) lr 4.8943e-05 eta 0:00:00
epoch [182/200] batch [5/19] time 0.156 (0.157) data 0.078 (0.080) loss_u loss_u 0.8975 (0.8002) acc_u 12.5000 (21.8750) lr 4.8943e-05 eta 0:00:02
epoch [182/200] batch [10/19] time 0.164 (0.157) data 0.086 (0.080) loss_u loss_u 0.7886 (0.7943) acc_u 21.8750 (22.5000) lr 4.8943e-05 eta 0:00:01
epoch [182/200] batch [15/19] time 0.160 (0.157) data 0.082 (0.080) loss_u loss_u 0.8213 (0.8011) acc_u 21.8750 (22.0833) lr 4.8943e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 350
confident_label rate tensor(0.6182, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 999
clean true:981
clean false:18
clean_rate:0.9819819819819819
noisy true:285
noisy false:332
after delete: len(clean_dataset) 999
after delete: len(noisy_dataset) 617
epoch [183/200] batch [5/31] time 0.154 (0.156) data 0.077 (0.079) loss_x loss_x 0.4780 (0.3727) acc_x 87.5000 (89.3750) lr 4.4207e-05 eta 0:00:04
epoch [183/200] batch [10/31] time 0.154 (0.156) data 0.077 (0.079) loss_x loss_x 0.6865 (0.4177) acc_x 81.2500 (90.0000) lr 4.4207e-05 eta 0:00:03
epoch [183/200] batch [15/31] time 0.157 (0.156) data 0.080 (0.079) loss_x loss_x 0.6250 (0.4627) acc_x 81.2500 (88.3333) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [20/31] time 0.161 (0.156) data 0.083 (0.079) loss_x loss_x 0.9048 (0.4689) acc_x 78.1250 (87.8125) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [25/31] time 0.156 (0.156) data 0.079 (0.079) loss_x loss_x 0.4753 (0.4493) acc_x 87.5000 (88.5000) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [30/31] time 0.152 (0.156) data 0.076 (0.079) loss_x loss_x 0.4631 (0.4619) acc_x 87.5000 (88.1250) lr 4.4207e-05 eta 0:00:00
epoch [183/200] batch [5/19] time 0.153 (0.156) data 0.076 (0.079) loss_u loss_u 0.9023 (0.8065) acc_u 9.3750 (21.8750) lr 4.4207e-05 eta 0:00:02
epoch [183/200] batch [10/19] time 0.158 (0.156) data 0.080 (0.079) loss_u loss_u 0.8711 (0.8203) acc_u 12.5000 (20.0000) lr 4.4207e-05 eta 0:00:01
epoch [183/200] batch [15/19] time 0.160 (0.156) data 0.082 (0.079) loss_u loss_u 0.7480 (0.8203) acc_u 31.2500 (20.0000) lr 4.4207e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 358
confident_label rate tensor(0.6170, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 997
clean true:980
clean false:17
clean_rate:0.9829488465396189
noisy true:278
noisy false:341
after delete: len(clean_dataset) 997
after delete: len(noisy_dataset) 619
epoch [184/200] batch [5/31] time 0.156 (0.158) data 0.079 (0.080) loss_x loss_x 0.6123 (0.6898) acc_x 84.3750 (83.1250) lr 3.9706e-05 eta 0:00:04
epoch [184/200] batch [10/31] time 0.155 (0.157) data 0.078 (0.080) loss_x loss_x 0.5430 (0.6189) acc_x 87.5000 (83.7500) lr 3.9706e-05 eta 0:00:03
epoch [184/200] batch [15/31] time 0.157 (0.157) data 0.080 (0.081) loss_x loss_x 0.3662 (0.5545) acc_x 87.5000 (84.7917) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [20/31] time 0.155 (0.158) data 0.078 (0.081) loss_x loss_x 0.5483 (0.5369) acc_x 81.2500 (85.7812) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [25/31] time 0.156 (0.157) data 0.079 (0.080) loss_x loss_x 0.5747 (0.5275) acc_x 87.5000 (85.8750) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [30/31] time 0.155 (0.157) data 0.077 (0.080) loss_x loss_x 0.3894 (0.5297) acc_x 84.3750 (85.8333) lr 3.9706e-05 eta 0:00:00
epoch [184/200] batch [5/19] time 0.156 (0.158) data 0.078 (0.081) loss_u loss_u 0.8423 (0.7664) acc_u 18.7500 (25.0000) lr 3.9706e-05 eta 0:00:02
epoch [184/200] batch [10/19] time 0.175 (0.158) data 0.097 (0.081) loss_u loss_u 0.7949 (0.7828) acc_u 25.0000 (23.7500) lr 3.9706e-05 eta 0:00:01
epoch [184/200] batch [15/19] time 0.160 (0.159) data 0.082 (0.081) loss_u loss_u 0.7769 (0.7904) acc_u 34.3750 (23.3333) lr 3.9706e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 360
confident_label rate tensor(0.6151, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 994
clean true:980
clean false:14
clean_rate:0.9859154929577465
noisy true:276
noisy false:346
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 622
epoch [185/200] batch [5/31] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.5449 (0.4981) acc_x 87.5000 (86.2500) lr 3.5443e-05 eta 0:00:04
epoch [185/200] batch [10/31] time 0.155 (0.157) data 0.078 (0.080) loss_x loss_x 0.4641 (0.5379) acc_x 84.3750 (86.2500) lr 3.5443e-05 eta 0:00:03
epoch [185/200] batch [15/31] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.3381 (0.5030) acc_x 87.5000 (86.6667) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [20/31] time 0.154 (0.157) data 0.077 (0.080) loss_x loss_x 0.4187 (0.5132) acc_x 90.6250 (86.7188) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [25/31] time 0.157 (0.157) data 0.080 (0.080) loss_x loss_x 0.6226 (0.5034) acc_x 87.5000 (87.0000) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [30/31] time 0.161 (0.157) data 0.085 (0.080) loss_x loss_x 0.6675 (0.4949) acc_x 84.3750 (87.6042) lr 3.5443e-05 eta 0:00:00
epoch [185/200] batch [5/19] time 0.159 (0.157) data 0.081 (0.080) loss_u loss_u 0.7603 (0.7962) acc_u 31.2500 (23.7500) lr 3.5443e-05 eta 0:00:02
epoch [185/200] batch [10/19] time 0.157 (0.157) data 0.079 (0.080) loss_u loss_u 0.7876 (0.8082) acc_u 28.1250 (21.8750) lr 3.5443e-05 eta 0:00:01
epoch [185/200] batch [15/19] time 0.160 (0.157) data 0.082 (0.080) loss_u loss_u 0.7993 (0.8094) acc_u 25.0000 (22.0833) lr 3.5443e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 376
confident_label rate tensor(0.6077, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 982
clean true:966
clean false:16
clean_rate:0.9837067209775967
noisy true:274
noisy false:360
after delete: len(clean_dataset) 982
after delete: len(noisy_dataset) 634
epoch [186/200] batch [5/30] time 0.156 (0.155) data 0.079 (0.078) loss_x loss_x 0.3135 (0.4731) acc_x 87.5000 (86.2500) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [10/30] time 0.155 (0.155) data 0.078 (0.078) loss_x loss_x 0.4697 (0.5037) acc_x 84.3750 (85.6250) lr 3.1417e-05 eta 0:00:03
epoch [186/200] batch [15/30] time 0.157 (0.156) data 0.080 (0.079) loss_x loss_x 0.3665 (0.4754) acc_x 90.6250 (86.8750) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [20/30] time 0.156 (0.156) data 0.079 (0.079) loss_x loss_x 0.3926 (0.4904) acc_x 90.6250 (86.7188) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [25/30] time 0.159 (0.156) data 0.082 (0.079) loss_x loss_x 0.6978 (0.5139) acc_x 81.2500 (86.1250) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [30/30] time 0.156 (0.156) data 0.079 (0.079) loss_x loss_x 0.7847 (0.5018) acc_x 81.2500 (86.4583) lr 3.1417e-05 eta 0:00:00
epoch [186/200] batch [5/19] time 0.160 (0.157) data 0.082 (0.080) loss_u loss_u 0.8535 (0.8056) acc_u 15.6250 (21.2500) lr 3.1417e-05 eta 0:00:02
epoch [186/200] batch [10/19] time 0.158 (0.157) data 0.081 (0.080) loss_u loss_u 0.7134 (0.7856) acc_u 31.2500 (23.4375) lr 3.1417e-05 eta 0:00:01
epoch [186/200] batch [15/19] time 0.157 (0.157) data 0.079 (0.080) loss_u loss_u 0.7627 (0.7910) acc_u 21.8750 (22.2917) lr 3.1417e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 381
confident_label rate tensor(0.6132, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 991
clean true:972
clean false:19
clean_rate:0.9808274470232089
noisy true:263
noisy false:362
after delete: len(clean_dataset) 991
after delete: len(noisy_dataset) 625
epoch [187/200] batch [5/30] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.3770 (0.4999) acc_x 84.3750 (86.2500) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [10/30] time 0.158 (0.158) data 0.080 (0.081) loss_x loss_x 0.8594 (0.5296) acc_x 81.2500 (86.2500) lr 2.7630e-05 eta 0:00:03
epoch [187/200] batch [15/30] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.2480 (0.5200) acc_x 87.5000 (85.8333) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [20/30] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.1937 (0.4893) acc_x 96.8750 (87.0312) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [25/30] time 0.160 (0.158) data 0.083 (0.081) loss_x loss_x 0.5933 (0.5030) acc_x 87.5000 (87.5000) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [30/30] time 0.159 (0.158) data 0.082 (0.081) loss_x loss_x 0.4434 (0.5106) acc_x 81.2500 (87.2917) lr 2.7630e-05 eta 0:00:00
epoch [187/200] batch [5/19] time 0.161 (0.158) data 0.083 (0.081) loss_u loss_u 0.7783 (0.8075) acc_u 25.0000 (22.5000) lr 2.7630e-05 eta 0:00:02
epoch [187/200] batch [10/19] time 0.160 (0.158) data 0.083 (0.081) loss_u loss_u 0.8545 (0.7951) acc_u 12.5000 (23.7500) lr 2.7630e-05 eta 0:00:01
epoch [187/200] batch [15/19] time 0.159 (0.158) data 0.082 (0.081) loss_u loss_u 0.7163 (0.7956) acc_u 34.3750 (23.7500) lr 2.7630e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 366
confident_label rate tensor(0.6157, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 995
clean true:979
clean false:16
clean_rate:0.9839195979899498
noisy true:271
noisy false:350
after delete: len(clean_dataset) 995
after delete: len(noisy_dataset) 621
epoch [188/200] batch [5/31] time 0.158 (0.157) data 0.081 (0.080) loss_x loss_x 0.7441 (0.4551) acc_x 84.3750 (87.5000) lr 2.4083e-05 eta 0:00:04
epoch [188/200] batch [10/31] time 0.156 (0.157) data 0.079 (0.080) loss_x loss_x 0.6533 (0.4614) acc_x 87.5000 (88.4375) lr 2.4083e-05 eta 0:00:03
epoch [188/200] batch [15/31] time 0.160 (0.158) data 0.082 (0.080) loss_x loss_x 0.8813 (0.4981) acc_x 78.1250 (87.7083) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [20/31] time 0.161 (0.158) data 0.083 (0.080) loss_x loss_x 0.4038 (0.4661) acc_x 93.7500 (89.2188) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [25/31] time 0.157 (0.158) data 0.079 (0.080) loss_x loss_x 0.5039 (0.4965) acc_x 81.2500 (88.2500) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [30/31] time 0.155 (0.158) data 0.078 (0.080) loss_x loss_x 0.5405 (0.4985) acc_x 87.5000 (88.1250) lr 2.4083e-05 eta 0:00:00
epoch [188/200] batch [5/19] time 0.158 (0.158) data 0.081 (0.080) loss_u loss_u 0.8457 (0.8125) acc_u 18.7500 (23.1250) lr 2.4083e-05 eta 0:00:02
epoch [188/200] batch [10/19] time 0.156 (0.158) data 0.079 (0.080) loss_u loss_u 0.8506 (0.7991) acc_u 15.6250 (23.7500) lr 2.4083e-05 eta 0:00:01
epoch [188/200] batch [15/19] time 0.157 (0.158) data 0.079 (0.080) loss_u loss_u 0.7583 (0.7912) acc_u 28.1250 (24.3750) lr 2.4083e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 368
confident_label rate tensor(0.6126, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 990
clean true:976
clean false:14
clean_rate:0.9858585858585859
noisy true:272
noisy false:354
after delete: len(clean_dataset) 990
after delete: len(noisy_dataset) 626
epoch [189/200] batch [5/30] time 0.157 (0.160) data 0.080 (0.083) loss_x loss_x 0.4543 (0.4135) acc_x 90.6250 (88.7500) lr 2.0777e-05 eta 0:00:04
epoch [189/200] batch [10/30] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.2211 (0.4479) acc_x 96.8750 (86.8750) lr 2.0777e-05 eta 0:00:03
epoch [189/200] batch [15/30] time 0.156 (0.158) data 0.079 (0.081) loss_x loss_x 0.5020 (0.4876) acc_x 78.1250 (85.8333) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [20/30] time 0.156 (0.158) data 0.079 (0.081) loss_x loss_x 0.6211 (0.5270) acc_x 78.1250 (85.3125) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [25/30] time 0.159 (0.158) data 0.081 (0.081) loss_x loss_x 0.7402 (0.5258) acc_x 81.2500 (86.1250) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [30/30] time 0.155 (0.157) data 0.077 (0.080) loss_x loss_x 0.5220 (0.5085) acc_x 87.5000 (86.7708) lr 2.0777e-05 eta 0:00:00
epoch [189/200] batch [5/19] time 0.157 (0.157) data 0.079 (0.080) loss_u loss_u 0.7549 (0.7856) acc_u 28.1250 (24.3750) lr 2.0777e-05 eta 0:00:02
epoch [189/200] batch [10/19] time 0.157 (0.157) data 0.079 (0.080) loss_u loss_u 0.7886 (0.8109) acc_u 25.0000 (22.1875) lr 2.0777e-05 eta 0:00:01
epoch [189/200] batch [15/19] time 0.161 (0.159) data 0.083 (0.082) loss_u loss_u 0.7070 (0.7969) acc_u 34.3750 (24.1667) lr 2.0777e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 378
confident_label rate tensor(0.6052, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 978
clean true:963
clean false:15
clean_rate:0.9846625766871165
noisy true:275
noisy false:363
after delete: len(clean_dataset) 978
after delete: len(noisy_dataset) 638
epoch [190/200] batch [5/30] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.5522 (0.4970) acc_x 84.3750 (85.0000) lr 1.7713e-05 eta 0:00:04
epoch [190/200] batch [10/30] time 0.159 (0.159) data 0.083 (0.082) loss_x loss_x 0.6108 (0.5441) acc_x 84.3750 (84.6875) lr 1.7713e-05 eta 0:00:03
epoch [190/200] batch [15/30] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.3257 (0.5351) acc_x 90.6250 (85.6250) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [20/30] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.4060 (0.5055) acc_x 96.8750 (86.5625) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [25/30] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.3962 (0.5164) acc_x 90.6250 (86.3750) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [30/30] time 0.161 (0.159) data 0.084 (0.082) loss_x loss_x 0.2725 (0.5206) acc_x 90.6250 (86.2500) lr 1.7713e-05 eta 0:00:00
epoch [190/200] batch [5/19] time 0.155 (0.159) data 0.078 (0.082) loss_u loss_u 0.7778 (0.7773) acc_u 25.0000 (25.0000) lr 1.7713e-05 eta 0:00:02
epoch [190/200] batch [10/19] time 0.157 (0.159) data 0.080 (0.082) loss_u loss_u 0.8691 (0.7761) acc_u 15.6250 (25.6250) lr 1.7713e-05 eta 0:00:01
epoch [190/200] batch [15/19] time 0.157 (0.159) data 0.079 (0.082) loss_u loss_u 0.7549 (0.7632) acc_u 25.0000 (26.6667) lr 1.7713e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 375
confident_label rate tensor(0.6095, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 985
clean true:966
clean false:19
clean_rate:0.9807106598984772
noisy true:275
noisy false:356
after delete: len(clean_dataset) 985
after delete: len(noisy_dataset) 631
epoch [191/200] batch [5/30] time 0.164 (0.159) data 0.087 (0.082) loss_x loss_x 0.8809 (0.6729) acc_x 71.8750 (80.0000) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [10/30] time 0.156 (0.158) data 0.079 (0.081) loss_x loss_x 0.4138 (0.6030) acc_x 90.6250 (83.7500) lr 1.4891e-05 eta 0:00:03
epoch [191/200] batch [15/30] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.8745 (0.6277) acc_x 78.1250 (83.9583) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [20/30] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.2252 (0.5949) acc_x 96.8750 (84.8438) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [25/30] time 0.160 (0.159) data 0.083 (0.082) loss_x loss_x 0.4365 (0.5855) acc_x 84.3750 (84.8750) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [30/30] time 0.161 (0.159) data 0.084 (0.082) loss_x loss_x 0.7544 (0.5824) acc_x 78.1250 (85.2083) lr 1.4891e-05 eta 0:00:00
epoch [191/200] batch [5/19] time 0.157 (0.159) data 0.079 (0.081) loss_u loss_u 0.6836 (0.7952) acc_u 31.2500 (21.2500) lr 1.4891e-05 eta 0:00:02
epoch [191/200] batch [10/19] time 0.160 (0.158) data 0.082 (0.081) loss_u loss_u 0.7437 (0.7889) acc_u 28.1250 (24.3750) lr 1.4891e-05 eta 0:00:01
epoch [191/200] batch [15/19] time 0.158 (0.158) data 0.081 (0.081) loss_u loss_u 0.8574 (0.7896) acc_u 15.6250 (24.1667) lr 1.4891e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 384
confident_label rate tensor(0.6040, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 976
clean true:961
clean false:15
clean_rate:0.9846311475409836
noisy true:271
noisy false:369
after delete: len(clean_dataset) 976
after delete: len(noisy_dataset) 640
epoch [192/200] batch [5/30] time 0.158 (0.160) data 0.081 (0.083) loss_x loss_x 0.6929 (0.4539) acc_x 84.3750 (89.3750) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [10/30] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.3445 (0.4983) acc_x 87.5000 (87.1875) lr 1.2312e-05 eta 0:00:03
epoch [192/200] batch [15/30] time 0.161 (0.159) data 0.084 (0.082) loss_x loss_x 0.1906 (0.4686) acc_x 96.8750 (88.3333) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [20/30] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.4175 (0.4905) acc_x 90.6250 (87.3438) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [25/30] time 0.162 (0.159) data 0.085 (0.082) loss_x loss_x 0.4087 (0.4956) acc_x 84.3750 (86.7500) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [30/30] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.7407 (0.4991) acc_x 81.2500 (86.6667) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [5/20] time 0.160 (0.159) data 0.082 (0.082) loss_u loss_u 0.8076 (0.7647) acc_u 21.8750 (27.5000) lr 1.2312e-05 eta 0:00:02
epoch [192/200] batch [10/20] time 0.159 (0.159) data 0.082 (0.082) loss_u loss_u 0.7036 (0.7637) acc_u 34.3750 (26.8750) lr 1.2312e-05 eta 0:00:01
epoch [192/200] batch [15/20] time 0.159 (0.159) data 0.081 (0.082) loss_u loss_u 0.6582 (0.7739) acc_u 40.6250 (26.6667) lr 1.2312e-05 eta 0:00:00
epoch [192/200] batch [20/20] time 0.161 (0.159) data 0.083 (0.082) loss_u loss_u 0.7764 (0.7729) acc_u 25.0000 (26.5625) lr 1.2312e-05 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 359
confident_label rate tensor(0.6176, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 998
clean true:982
clean false:16
clean_rate:0.9839679358717435
noisy true:275
noisy false:343
after delete: len(clean_dataset) 998
after delete: len(noisy_dataset) 618
epoch [193/200] batch [5/31] time 0.165 (0.159) data 0.088 (0.082) loss_x loss_x 0.4619 (0.6366) acc_x 93.7500 (85.0000) lr 9.9763e-06 eta 0:00:04
epoch [193/200] batch [10/31] time 0.179 (0.161) data 0.102 (0.084) loss_x loss_x 0.3167 (0.5406) acc_x 96.8750 (88.1250) lr 9.9763e-06 eta 0:00:03
epoch [193/200] batch [15/31] time 0.158 (0.162) data 0.081 (0.085) loss_x loss_x 0.9839 (0.5955) acc_x 81.2500 (86.2500) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [20/31] time 0.158 (0.161) data 0.081 (0.084) loss_x loss_x 0.6836 (0.5648) acc_x 87.5000 (87.0312) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [25/31] time 0.158 (0.160) data 0.081 (0.083) loss_x loss_x 0.3535 (0.5810) acc_x 90.6250 (87.5000) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [30/31] time 0.156 (0.161) data 0.079 (0.084) loss_x loss_x 0.8560 (0.5781) acc_x 78.1250 (87.2917) lr 9.9763e-06 eta 0:00:00
epoch [193/200] batch [5/19] time 0.156 (0.160) data 0.078 (0.083) loss_u loss_u 0.8076 (0.7579) acc_u 25.0000 (26.8750) lr 9.9763e-06 eta 0:00:02
epoch [193/200] batch [10/19] time 0.155 (0.160) data 0.078 (0.083) loss_u loss_u 0.8086 (0.7827) acc_u 21.8750 (24.0625) lr 9.9763e-06 eta 0:00:01
epoch [193/200] batch [15/19] time 0.157 (0.160) data 0.080 (0.083) loss_u loss_u 0.9062 (0.7759) acc_u 12.5000 (25.0000) lr 9.9763e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 369
confident_label rate tensor(0.6145, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 993
clean true:978
clean false:15
clean_rate:0.9848942598187311
noisy true:269
noisy false:354
after delete: len(clean_dataset) 993
after delete: len(noisy_dataset) 623
epoch [194/200] batch [5/31] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.7183 (0.5286) acc_x 84.3750 (85.6250) lr 7.8853e-06 eta 0:00:04
epoch [194/200] batch [10/31] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.5327 (0.4995) acc_x 87.5000 (86.8750) lr 7.8853e-06 eta 0:00:03
epoch [194/200] batch [15/31] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.5703 (0.4737) acc_x 87.5000 (87.9167) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [20/31] time 0.162 (0.159) data 0.085 (0.082) loss_x loss_x 0.1399 (0.4845) acc_x 100.0000 (88.2812) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [25/31] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.3254 (0.4682) acc_x 90.6250 (88.5000) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [30/31] time 0.155 (0.159) data 0.078 (0.082) loss_x loss_x 0.6484 (0.4670) acc_x 81.2500 (88.4375) lr 7.8853e-06 eta 0:00:00
epoch [194/200] batch [5/19] time 0.156 (0.159) data 0.078 (0.082) loss_u loss_u 0.8315 (0.7950) acc_u 18.7500 (23.1250) lr 7.8853e-06 eta 0:00:02
epoch [194/200] batch [10/19] time 0.161 (0.159) data 0.083 (0.082) loss_u loss_u 0.8604 (0.7933) acc_u 15.6250 (22.8125) lr 7.8853e-06 eta 0:00:01
epoch [194/200] batch [15/19] time 0.160 (0.160) data 0.082 (0.082) loss_u loss_u 0.7129 (0.7846) acc_u 34.3750 (23.7500) lr 7.8853e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 356
confident_label rate tensor(0.6238, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1008
clean true:993
clean false:15
clean_rate:0.9851190476190477
noisy true:267
noisy false:341
after delete: len(clean_dataset) 1008
after delete: len(noisy_dataset) 608
epoch [195/200] batch [5/31] time 0.162 (0.161) data 0.085 (0.084) loss_x loss_x 0.5659 (0.5498) acc_x 84.3750 (85.0000) lr 6.0390e-06 eta 0:00:04
epoch [195/200] batch [10/31] time 0.162 (0.161) data 0.085 (0.084) loss_x loss_x 0.5664 (0.5286) acc_x 84.3750 (85.3125) lr 6.0390e-06 eta 0:00:03
epoch [195/200] batch [15/31] time 0.158 (0.160) data 0.081 (0.083) loss_x loss_x 0.6885 (0.5575) acc_x 78.1250 (85.6250) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [20/31] time 0.158 (0.160) data 0.081 (0.082) loss_x loss_x 0.1953 (0.5622) acc_x 96.8750 (85.9375) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [25/31] time 0.155 (0.159) data 0.078 (0.082) loss_x loss_x 0.2539 (0.5755) acc_x 96.8750 (86.3750) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [30/31] time 0.156 (0.159) data 0.079 (0.082) loss_x loss_x 0.6182 (0.5671) acc_x 81.2500 (86.6667) lr 6.0390e-06 eta 0:00:00
epoch [195/200] batch [5/19] time 0.156 (0.159) data 0.078 (0.082) loss_u loss_u 0.8613 (0.8396) acc_u 12.5000 (16.8750) lr 6.0390e-06 eta 0:00:02
epoch [195/200] batch [10/19] time 0.159 (0.159) data 0.081 (0.082) loss_u loss_u 0.8228 (0.7959) acc_u 18.7500 (21.8750) lr 6.0390e-06 eta 0:00:01
epoch [195/200] batch [15/19] time 0.157 (0.159) data 0.079 (0.081) loss_u loss_u 0.8833 (0.8020) acc_u 12.5000 (21.4583) lr 6.0390e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 384
confident_label rate tensor(0.6151, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 994
clean true:974
clean false:20
clean_rate:0.9798792756539235
noisy true:258
noisy false:364
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 622
epoch [196/200] batch [5/31] time 0.161 (0.161) data 0.084 (0.083) loss_x loss_x 1.0332 (0.6142) acc_x 75.0000 (85.0000) lr 4.4380e-06 eta 0:00:04
epoch [196/200] batch [10/31] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.6030 (0.6265) acc_x 78.1250 (84.0625) lr 4.4380e-06 eta 0:00:03
epoch [196/200] batch [15/31] time 0.158 (0.159) data 0.080 (0.082) loss_x loss_x 0.3984 (0.5917) acc_x 93.7500 (85.4167) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [20/31] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.6260 (0.5879) acc_x 81.2500 (85.4688) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [25/31] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.3362 (0.5610) acc_x 93.7500 (86.1250) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [30/31] time 0.167 (0.159) data 0.089 (0.082) loss_x loss_x 0.4558 (0.5711) acc_x 93.7500 (86.3542) lr 4.4380e-06 eta 0:00:00
epoch [196/200] batch [5/19] time 0.159 (0.159) data 0.081 (0.082) loss_u loss_u 0.7852 (0.8049) acc_u 21.8750 (22.5000) lr 4.4380e-06 eta 0:00:02
epoch [196/200] batch [10/19] time 0.159 (0.159) data 0.081 (0.082) loss_u loss_u 0.8008 (0.7732) acc_u 18.7500 (25.6250) lr 4.4380e-06 eta 0:00:01
epoch [196/200] batch [15/19] time 0.157 (0.159) data 0.080 (0.082) loss_u loss_u 0.7471 (0.7905) acc_u 31.2500 (23.3333) lr 4.4380e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 349
confident_label rate tensor(0.6244, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1009
clean true:992
clean false:17
clean_rate:0.9831516352824579
noisy true:275
noisy false:332
after delete: len(clean_dataset) 1009
after delete: len(noisy_dataset) 607
epoch [197/200] batch [5/31] time 0.158 (0.158) data 0.081 (0.081) loss_x loss_x 0.5005 (0.4806) acc_x 93.7500 (87.5000) lr 3.0827e-06 eta 0:00:04
epoch [197/200] batch [10/31] time 0.157 (0.158) data 0.080 (0.081) loss_x loss_x 0.6318 (0.4892) acc_x 87.5000 (87.5000) lr 3.0827e-06 eta 0:00:03
epoch [197/200] batch [15/31] time 0.161 (0.158) data 0.084 (0.081) loss_x loss_x 0.8325 (0.5059) acc_x 87.5000 (87.9167) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [20/31] time 0.160 (0.158) data 0.083 (0.081) loss_x loss_x 0.6113 (0.5366) acc_x 87.5000 (86.8750) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [25/31] time 0.156 (0.158) data 0.079 (0.081) loss_x loss_x 0.6655 (0.5121) acc_x 78.1250 (87.3750) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [30/31] time 0.156 (0.158) data 0.079 (0.081) loss_x loss_x 0.4238 (0.5293) acc_x 87.5000 (86.8750) lr 3.0827e-06 eta 0:00:00
epoch [197/200] batch [5/18] time 0.157 (0.158) data 0.080 (0.081) loss_u loss_u 0.8721 (0.7912) acc_u 15.6250 (26.2500) lr 3.0827e-06 eta 0:00:02
epoch [197/200] batch [10/18] time 0.159 (0.158) data 0.082 (0.081) loss_u loss_u 0.8203 (0.7896) acc_u 21.8750 (25.6250) lr 3.0827e-06 eta 0:00:01
epoch [197/200] batch [15/18] time 0.158 (0.158) data 0.081 (0.081) loss_u loss_u 0.8418 (0.7949) acc_u 15.6250 (23.9583) lr 3.0827e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 360
confident_label rate tensor(0.6207, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 1003
clean true:988
clean false:15
clean_rate:0.9850448654037887
noisy true:268
noisy false:345
after delete: len(clean_dataset) 1003
after delete: len(noisy_dataset) 613
epoch [198/200] batch [5/31] time 0.158 (0.162) data 0.081 (0.085) loss_x loss_x 0.4167 (0.7385) acc_x 90.6250 (83.7500) lr 1.9733e-06 eta 0:00:04
epoch [198/200] batch [10/31] time 0.158 (0.161) data 0.081 (0.084) loss_x loss_x 0.6406 (0.5771) acc_x 84.3750 (87.1875) lr 1.9733e-06 eta 0:00:03
epoch [198/200] batch [15/31] time 0.159 (0.160) data 0.082 (0.083) loss_x loss_x 0.1533 (0.5120) acc_x 96.8750 (87.5000) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [20/31] time 0.159 (0.163) data 0.082 (0.086) loss_x loss_x 0.7329 (0.5132) acc_x 84.3750 (87.6562) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [25/31] time 0.156 (0.162) data 0.079 (0.085) loss_x loss_x 1.1367 (0.5814) acc_x 71.8750 (85.7500) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [30/31] time 0.157 (0.162) data 0.080 (0.085) loss_x loss_x 0.6704 (0.5569) acc_x 84.3750 (86.2500) lr 1.9733e-06 eta 0:00:00
epoch [198/200] batch [5/19] time 0.169 (0.162) data 0.091 (0.084) loss_u loss_u 0.8267 (0.8061) acc_u 18.7500 (21.2500) lr 1.9733e-06 eta 0:00:02
epoch [198/200] batch [10/19] time 0.160 (0.162) data 0.083 (0.084) loss_u loss_u 0.8706 (0.8126) acc_u 12.5000 (20.6250) lr 1.9733e-06 eta 0:00:01
epoch [198/200] batch [15/19] time 0.179 (0.162) data 0.102 (0.085) loss_u loss_u 0.6685 (0.7991) acc_u 37.5000 (22.5000) lr 1.9733e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 365
confident_label rate tensor(0.6151, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 994
clean true:976
clean false:18
clean_rate:0.9818913480885312
noisy true:275
noisy false:347
after delete: len(clean_dataset) 994
after delete: len(noisy_dataset) 622
epoch [199/200] batch [5/31] time 0.161 (0.160) data 0.084 (0.083) loss_x loss_x 0.5371 (0.5431) acc_x 81.2500 (84.3750) lr 1.1101e-06 eta 0:00:04
epoch [199/200] batch [10/31] time 0.162 (0.159) data 0.085 (0.082) loss_x loss_x 0.5469 (0.4839) acc_x 84.3750 (85.6250) lr 1.1101e-06 eta 0:00:03
epoch [199/200] batch [15/31] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.5088 (0.5061) acc_x 81.2500 (85.2083) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [20/31] time 0.159 (0.159) data 0.082 (0.082) loss_x loss_x 0.7129 (0.5371) acc_x 81.2500 (84.8438) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [25/31] time 0.156 (0.159) data 0.079 (0.082) loss_x loss_x 0.9136 (0.5533) acc_x 78.1250 (85.1250) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [30/31] time 0.154 (0.159) data 0.077 (0.082) loss_x loss_x 0.4138 (0.5541) acc_x 87.5000 (85.1042) lr 1.1101e-06 eta 0:00:00
epoch [199/200] batch [5/19] time 0.158 (0.158) data 0.081 (0.081) loss_u loss_u 0.7534 (0.7568) acc_u 31.2500 (29.3750) lr 1.1101e-06 eta 0:00:02
epoch [199/200] batch [10/19] time 0.157 (0.158) data 0.079 (0.081) loss_u loss_u 0.7285 (0.7684) acc_u 31.2500 (27.5000) lr 1.1101e-06 eta 0:00:01
epoch [199/200] batch [15/19] time 0.157 (0.158) data 0.079 (0.081) loss_u loss_u 0.8203 (0.7933) acc_u 18.7500 (24.3750) lr 1.1101e-06 eta 0:00:00
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
[OT_PL] Loading all features and outputs... Total samples: 1600
[OT_PL] Features shape: torch.Size([1600, 1024]), Outputs shape: torch.Size([1600, 101])
[OT_PL] Starting Sinkhorn computation... P shape: torch.Size([1600, 101]), budget: 1.0
[Sinkhorn] Starting: a.shape=torch.Size([1600]), b.shape=torch.Size([101]), P.shape=torch.Size([1600, 101]), reg=0.01, numItermax=1000
[Sinkhorn] Completed! coupling.shape=torch.Size([1600, 101])
[OT_PL] Sinkhorn computation completed!
before epoch:data num: 1616
before epoch:different number: 391
confident_label rate tensor(0.5978, device='cuda:0')
before: len(self.train) 1616
before: len of confident samples 966
clean true:951
clean false:15
clean_rate:0.984472049689441
noisy true:274
noisy false:376
after delete: len(clean_dataset) 966
after delete: len(noisy_dataset) 650
epoch [200/200] batch [5/30] time 0.160 (0.158) data 0.083 (0.081) loss_x loss_x 0.3757 (0.5220) acc_x 93.7500 (87.5000) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [10/30] time 0.162 (0.158) data 0.085 (0.081) loss_x loss_x 0.4011 (0.4595) acc_x 90.6250 (89.0625) lr 4.9344e-07 eta 0:00:03
epoch [200/200] batch [15/30] time 0.159 (0.158) data 0.082 (0.081) loss_x loss_x 0.7939 (0.4865) acc_x 78.1250 (88.1250) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [20/30] time 0.158 (0.159) data 0.081 (0.082) loss_x loss_x 0.5942 (0.4903) acc_x 84.3750 (87.9688) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [25/30] time 0.157 (0.159) data 0.080 (0.082) loss_x loss_x 0.6455 (0.5071) acc_x 75.0000 (87.1250) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [30/30] time 0.156 (0.159) data 0.079 (0.082) loss_x loss_x 0.8335 (0.5169) acc_x 84.3750 (87.1875) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [5/20] time 0.159 (0.159) data 0.081 (0.081) loss_u loss_u 0.7803 (0.7601) acc_u 28.1250 (28.7500) lr 4.9344e-07 eta 0:00:02
epoch [200/200] batch [10/20] time 0.155 (0.158) data 0.078 (0.081) loss_u loss_u 0.8574 (0.7745) acc_u 15.6250 (26.2500) lr 4.9344e-07 eta 0:00:01
epoch [200/200] batch [15/20] time 0.157 (0.158) data 0.079 (0.081) loss_u loss_u 0.7051 (0.7650) acc_u 34.3750 (27.2917) lr 4.9344e-07 eta 0:00:00
epoch [200/200] batch [20/20] time 0.156 (0.158) data 0.078 (0.081) loss_u loss_u 0.8516 (0.7696) acc_u 15.6250 (26.5625) lr 4.9344e-07 eta 0:00:00
Checkpoint saved to output/ucf101/NLPrompt/rn50_16shots/noise_asym_0.25/seed1/prompt_learner/model.pth.tar-200
after epoch: len(clean dataset) 1616
after epoch: len(noisy dataset) 1616
Finish training
Deploy the last-epoch model
Evaluate on the *test* set
=> result
* total: 3,783
* correct: 2,859
* accuracy: 75.6%
* error: 24.4%
* macro_f1: 74.6%
Elapsed: 1:16:35
